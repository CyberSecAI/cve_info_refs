=== Content from www.cisco.com_b16cfe75_20250115_123417.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Defense Orchestrator](/c/en/us/support/security/defense-orchestrator/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-orchestrator/products-installation-and-configuration-guides-list.html)
# Managing FDM Devices with Cisco Security Cloud Control

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Managing FDM-Managed Devices with Cisco Security
  Cloud Control](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/managing-ftd-with-cdo.html)
* [Basics of Security Cloud Control](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/basics-of-cisco-defense-orchestrator.html)
* [Onboard Devices and Services](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html)
* [Configuring FDM-Managed Devices](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html)
* [Monitoring and Reporting Change Logs, Workflows, and Jobs](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/monitoring-and-reporting.html)
* [Cisco Security Analytics and Logging](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/cisco-security-analytics-and-logging.html)
* [Integrating Security Cloud Control with Cisco Security Cloud Sign On](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/integrating-cdo-with-securex.html)
* [Terraform](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/m-cdo-terraform.html)
* [Troubleshooting](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/troubleshooting.html)
* [FAQ and Support](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/faq-and-support.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Managing FDM Devices with Cisco Security Cloud Control Chapter Title Configuring FDM-Managed Devices

* [PDF - Complete Book
  (15.68 MB)](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator.pdf)
  [PDF - This Chapter (6.73 MB)](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: January 10, 2025

## Chapter: Configuring FDM-Managed Devices

Chapter Contents

* [Configuring FDM-Managed Devices](#Cisco_Generic_Topic.dita_16f4a519-3a9c-4cad-bc9f-52a994927a22)
* [Interfaces](#Interfaces)
  + [Guidelines and Limitations for Firepower Interface Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration)
    - [Maximum Number of VLAN Members by Device Model](#Maximum_Number_of_VLAN_Members_by_Device_Model)
  + [Firepower Data Interfaces](#Firepower_Data_Interfaces)
  + [Management/Diagnostic Interface](#ManagementDiagnostic_Interface)
  + [Interface Settings](#Interface_Settings)
    - [Use of Security Zones in Firepower Interface Settings](#Use_of_Security_Zones_in_Firepower_Interface_Settings)
    - [Assign an FDM-Managed Device Interface to a Security Zone](#Assignan_FTD_Interface_to_a_Security_Zone)
      * [Assign a Firepower Interface to a Security Zone](#Assigna_FirepowerInterface_to_a_Security_Zone)
    - [Use of Auto-MDI/MDX in Firepower Interface Settings](#Use_of_AutoMDIMDX_in_Firepower_Interface_Settings)
    - [Use of MAC Addresses in Firepower Interface Settings](#Use_of_MAC_Addresses_in_Firepower_Interface_Settings)
    - [Use of MTU Settings in Firepower Interface Settings](#Use_of_MTU_Settings_in_Firepower_Interface_Settings)
  + [IPv6 Addressing for Firepower Interfaces](#IPv6_Addressing_for_Firepower_Interfaces)
  + [Configuring Firepower Interfaces](#Configuring_Firepower_Interfaces)
    - [Configure a Physical Firepower Interface](#Configure_a_Physical_Firepower_Interface)
      * [Procedure](#Procedure)
      * [Configure IPv4 Addressing for the Physical Interface](#Configure_IPv4Addressing_for_the_Physical_Interface)
      * [Configure IPv6 Addressing for the Physical Interface](#Configure_IPv6_Addressing_for_the_Physical_Interface)
      * [Enable the Physical Interface](#Enable_the_Physical_Interface)
    - [Configure Firepower VLAN Subinterfaces and 802.1Q Trunking](#Configure_Firepower_VLAN_Subinterfaces_and_821Q_Trunking)
      * [Procedure](#Procedure)
      * [Configure IPv4 Addressing for the Subinterface](#Configure_IPv4Addressing_for_the_Subinterface)
      * [Configure IPv6 Addressing for the Subinterface](#Configure_IPv6_Addressing_for_the_Subinterface)
      * [Enable the Physical Interface](#Enable_the_Physical_Interface)
    - [Configure Advanced Firepower Interface Options](#Procedure)
    - [Configure a Bridge Group](#Configure_a_Bridge_Group)
      * [Configure the Name of the Bridge Group Interface and Select the Bridge Group Members](#Configure_the_Name_of_the_Bridge_Group_Interface_and_Select_the_Bridge_Group_Members)
      * [Configure the IPv4 Address for the BVI](#Configure_the_IPv4Address_for_the_BVI)
      * [Configure the IPv6 Address for the BVI](#Configure_the_IPv6Address_for_the_BVI)
      * [Configure Advanced Interface Options](#Configure_Advanced_Interface_Options)
      * [Bridge Group Compatibility in FDM-Managed Configurations](#Bridge_Group_Compatibility_in_FTD_Configurations)
      * [Delete a Bridge Group](#Delete_a_Bridge_Group)
    - [Add an EtherChannel Interface for an FDM-Managed Device](#Add_an_EtherChannel_Interface_for_Firepower_Threat_Defense)
      * [Add an EtherChannel Interface](#Add_an_EtherChannelInterface)
    - [Edit Or Remove an EtherChannel Interface for FDM-Managed Device](#Edit_Or_Remove_an_EtherChannel_Interface_for_FTD)
      * [Edit an EtherChannel](#Edit_an_EtherChannel)
      * [Remove an EtherChannel Interface](#Remove_an_EtherChannelInterface)
    - [Add a Subinterface to an EtherChannel Interface](#Add_a_Subinterface_to_an_EtherChannel_Interface)
      * [Add a Subinterface to an EtherChannel Interface](#Add_a_Subinterface_to_an_EtherChannelInterface)
    - [Edit or Remove a Subinterface from an EtherChannel](#Edit_or_Remove_a_Subinterface_from_an_EtherChannel)
      * [Edit a Subinterface](#Edit_a_Subinterface)
      * [Remove a Subinterface from an EtherChannel](#Remove_a_Subinterface_from_an_EtherChannel)
    - [Add Interfaces to a Virtual FDM-Managed Device](#Add_Interfaces_to_a_Virtual_FTD)
    - [Switch Port Mode Interfaces for an FDM-Managed Device](#Switch_Port_Mode_Interfaces_for_an_FTD)
    - [Configure an FDM-Managed Device VLAN](#Configure_a_VLANInterface)
    - [Configure an FDM-Managed Device VLAN for Switch Port Mode](#Configure_an_FTD_VLAN_for_Switch_Port_Mode)
      * [Create a VLAN Interface for Switch Port Mode](#Create_a_VLANInterface_forSwitch_Port_Mode)
      * [Configure an Existing Physical Interface for Switch Port Mode](#Configure_an_Existing_Physical_Interface_for_Switch_Port_Mode)
* [Viewing and Monitoring Firepower Interfaces](#Viewing_Firepower_Interfaces)
  + [Monitoring Interfaces in the CLI](#Monitoring_Interfaces_in_the_CLI)

- [Synchronizing Interfaces Added to a Firepower Device using FXOS](#Cisco_Task_in_List_GUI.dita_ba4695d9-1258-4b17-8d1d-5ff7db6c7a69)
- [Routing](#Routing)
  * [About Static Routing and Default Routes](#About_Static_Routing_and_Default_Routes)
    + [Default Route](#Default_Route)
    + [Static Routes](#Static_Routes)
  * [The Routing Table and Route Selection](#The_Routing_Table_and_Route_Selection)
    + [How the Routing Table is Populated](#How_the_Routing_Table_is_Populated)
    + [How Forwarding Decisions are Made](#How_Forwarding_Decisions_are_Made)
  * [Configure Static and Default Routes for FDM-Managed Devices](#Configure_Static_and_Default_Routes_for_FTD_Devices)
    + [Procedure](#Procedure)
    + [Static Route Example](#Static_Route_Example)
      - [Route 1:](#ssk_pff_bpb)
      - [Route 2:](#dyz_sgf_bpb)
- [Monitoring Routing](#Monitoring_Routing)
- [Static Route Network Diagram](#Static_Route_Network_Diagram)
- [About Virtual Routing and Forwarding](#About_Virtual_Routing_and_Forwarding)
- [Objects](#Objects)
  * [Objects](#Objects)
    + [Object Types](#Object_Types)
    + [Shared Objects](#About_Shared_Objects)
    + [Object Overrides](#Object_Overrides)
    + [Unassociated Objects](#Cisco_Concept.dita_69ca0d7b-987a-4784-91d5-921153ac67c9)
    + [Compare Objects](#CompareObjects)
    + [Filters](#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457)
      - [Object Filters](#About_Object_Filters)
        * [Configure Object Filters](#Configure_Object_Filters)
        * [When to Exclude a Device from Filter Criteria](#When_to_Excludea_Device_from_Filter_Criteria)
  * [Unignore Objects](#Unignore_Objects)
  * [Deleting Objects](#Deleting_Objects)
    + [Delete a Single Object](#Delete_a_Single_Object)
    + [Delete a Group of Unused Objects](#Cisco_Task_in_List_GUI.dita_a24c863f-b291-4353-b9d7-c52871b881ea)
  * [Network Objects](#About_Network_Objects)
    + [Create or Edit a Firepower Network Object or Network Groups](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups)
      - [Create a Firepower Network Object](#Create_a_FirepowerNetwork_Object)
      - [Create a Firepower Network Group](#Create_a_FirepowerNetworkGroup)
      - [Edit a Firepower Network Object](#Edit_a_Firepower_Network_Object)
      - [Edit a Firepower Network Group](#Edit_a_Firepower_NetworkGroup)
      - [Add an Object Override](#Cisco_Task.dita_08e1fc0f-3310-4dac-84ce-c56a76c729dc)
      - [Edit Object Overrides](#EditObject_Overrides)
      - [Add Additional Values to a Shared Network Group](#Add_Additional_Values_to_a_Shared_Network_Group)
      - [Edit Additional Values in a Shared Network Group](#EditAdditional_Values_in_aShared_Network_Group)
      - [Deleting Network Objects and Groups in Security Cloud Control](#Cisco_Concept.dita_72c5bc7d-f8b9-498e-82cb-c4a81c0ac83f)
- [URL Objects](#Cisco_Concept.dita_a92f613b-e87e-4e4a-913d-50f9febe9234)
  * [Create or Edit an FDM-Managed URL Object](#Create_a_FirepowerURLObject)
  * [Create a Firepower URL Group](#Create_a_FirepowerURL_Group)
    + [Edit a Firepower URL Object or URL Group](#EditaFirepowerURL_Object_orURLGroup)
- [Application Filter Objects](#Application_Filter_Objects)
  * [Create and Edit a Firepower Application Filter Object](#Create_and_Edit_a_Firepower_Application_Filter_Object)
    + [Create a Firepower Application Filter Object](#Create_a_Firepower_Application_Filter_Object)
    + [Edit a Firepower Application Filter Object](#Edit_a_Firepower_Application_Filter_Object)
- [Geolocation Objects](#UpdateGeolocationDatabase)
  * [Create and Edit a Firepower Geolocation Filter Object](#Create_a_Geolocation_Object)
    + [Edit a Geolocation Object](#Edit_a_Geolocation_Object)
- [DNS Group Objects](#Cisco_Concept.dita_925432d7-66d2-4f93-bab6-8869fc832388)
  * [Create a DNS Group Object](#Create_a_DNS_Group_Object)
  * [Edit a DNS Group Object](#Edit_a_DNS_Group_Object)
  * [Delete a DNS Group Object](#Delete_a_DNS_Group_Object)
  * [Add a DNS Group Object as an FDM-Managed DNS Server](#Add_a_DNS_Group_Object_as_an_FTD_DNS_Server)
- [Certificate Objects](#Certificate_Objects)
  * [About Certificates](#About_Certificates)
  * [Certificate Types Used by Feature](#Certificate_Types_Used_by_Feature)
  * [Configuring Certificates](#Configuring_Certificates)
  * [Uploading Internal and Internal CA Certificates](#Uploading_Internal_and_Internal_CA_Certificates)
    + [Procedure](#Procedure)
  * [Uploading Trusted CA Certificates](#Uploading_Trusted_CA_Certificates)
    + [Procedure](#Procedure)
  * [Generating Self-Signed Internal and Internal CA Certificates](#Generating_SelfSigned_Internal_and_Internal_CA_Certificates)
    + [Procedure](#Procedure)
- [About IPsec Proposals](#Configuring_IPsec_Proposals)
  * [Managing an IKEv1 IPsec Proposal Object](#Managing_an_FTD_IKEv1_IPsec_Proposal_Object)
    + [Create or Edit an IKEv1 IPsec Proposal Object](#Create_or_Editan_FTDIKEv1_IPsecProposal_Object)
  * [Managing an IKEv2 IPsec Proposal Object](#Managing_an_FTD_IKEv2_IPsec_Proposal_Object)
    + [Create or Edit an IKEv2 IPsec Proposal Object](#Create_or_Edit_an_FTDIKEv2_IPsec_Proposal_Object)
- [About Global IKE Policies](#Configuring_the_Global_IKE_Policy)
  * [Managing IKEv1 Policies](#Managing_FTD_IKEv1_Policies)
    + [Create or Edit an IKEv1 Policy](#Create_or_Edit_an_FTD_IKEv1Policy)
  * [Managing IKEv2 Policies](#Managing_FTD_IKEv2_Policies)
    + [Create or Edit an IKEv2 Policy](#Create_or_Edit_an_FTDIKEv2Policy)
- [RA VPN Objects](#Cisco_Reference.dita_bd69c4dd-138c-4f89-b553-71f1aa33bf50)
- [Security Zone Object](#Security_Zone_Object)
  * [Create or Edit a Firepower Security Zone Object](#Create_or_Edit_a_Firepower_Security_Zone_Object)
    + [Create a Security Zone Object](#Create_a_Security_Zone_Object)
    + [Edit a Security Zone Object](#Edit_a_Security_Zone_Object)
- [Service Objects](#ASA_Service_Objects)
  * [Create and Edit Firepower Service Objects](#Create_a_FirepowerService_Object)
    + [Create a Firepower Service Group](#Create_a_FirepowerService_Group)
    + [Edit a Firepower Service Object or Service Group](#Edita_FirepowerService_Object_or_Service_Group)
- [Security Group Tag Group](#Cisco_Concept.dita_73428ed6-cd13-45f9-ae4f-711aa91a51b3)
  * [Security Group Tags](#FTD_Security_Group_Tags)
  * [Create an SGT Group](#Create_an_FTD_SGT_Group)
  * [Edit an SGT Group](#Edit_an_FTD_SGT_Group)
  * [Add an SGT Group to an Access Control Rule](#Add_an_FTDSGT_Group_to_an_Access_Control_Rule)
- [Syslog Server Objects](#Cisco_Concept.dita_8ad8638c-1934-4da0-834c-59b0d7a0df0b)
  * [Create and Edit Syslog Server Objects](#Create_Syslog_Server_Objects)
    + [Edit Syslog Server Objects](#Edit_Syslog_Server_Objects)
  * [Create a Syslog Server Object for Secure Logging Analytics (SaaS)](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging)
    + [Procedure](#Procedure)

- [Manage Security Policies in Security Cloud Control](#Cisco_Concept.dita_9644c92c-1c4a-4938-91e1-f871c909c20b)
- [FDM Policy Configuration](#FTD_Policy_Configuration)
  * [FDM-Managed Access Control Policy](#FTD_Access_Control_Policy)
    + [Read an FDM-Managed Access Control Policy](#Read_an_FTD_Access_Control_Policy)
    + [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy)
      - [Create or Edit an FDM-Managed Access Control Policy](#Create_or_Edit_an_FTDAccess_Control_Policy)
      - [Configuring Access Policy Settings](#Configuring_AccessPolicy_Settings)
        * [Procedure](#Cisco_Task_in_List_GUI.dita_678be31a-ea22-49b3-9822-59ffee600ef1)
      - [About TLS Server Identity Discovery](#About_TLS_Server_Identity_Discovery)
    + [Copy FDM-Managed Access Control Rules](#Copy_FTD_Access_Control_Rules)
      - [Copy Rules within the Device](#CopyRules_within_anFTD)
      - [Copy Rules from One FDM-Managed Device Policy to Another FDM-Managed Device Policy](#CopyRules_from_One_FTDPolicy_to_Another_FTD_Policy)
    + [Move FDM-Managed Access Control Rules](#Move_FTD_Access_Control_Rules)
      - [Move Rules within the Device](#Move_Rules_within_an_FTD)
      - [Move a Rule from One FDM-Managed Device Policy to Another FDM-Managed Device Policy](#Movea_Rule_from_One_FTDPolicy_to_Another_FTD_Policy)
    + [Behavior of Objects when Pasting Rules to Another Device](#Behavior_ofObjects_when_PastingRules_to_Another_FTD)
    + [Source and Destination Criteria in an FDM-Managed Access Control Rule](#Source_and_Destination_Criteria_in_an_FTD_Access_Control_Rule)
    + [URL Conditions in an FDM-Managed Access Control Rule](#URL_Conditions_in_an_FTD_Access_Control_Rule)
      - [Specifying a Reputation for a URL Category Used in a Rule](#Specifying_a_Reputation_for_a_URL_Category_Used_in_a_Rule)
    + [Intrusion Policy Settings in an FDM-Managed Access Control Rule](#Intrusion_Policy_Settings_in_an_FTD_Access_Control_Rule)
    + [File Policy Settings in an FDM-Managed Access Control Rule](#File_Policy_Settings_in_an_FTD_Access_Control_Rule)
    + [Logging Settings in an FDM-Managed Access Control Rule](#Logging_Settings_in_an_FTD_Access_Control_Rule)
      - [Procedure](#Procedure)
    + [Security Group Tags](#FTD_Security_Group_Tags)
      - [Create an SGT Group](#Create_an_FTD_SGT_Group)
      - [Edit an SGT Group](#Edit_an_FTD_SGT_Group)
      - [Add an SGT Group to an Access Control Rule](#Add_an_FTDSGT_Group_to_an_Access_Control_Rule)
    + [Application Criteria in an FDM-Managed Access Control Rule](#Application_Criteria_in_an_FTD_Access_Control_Rule)
    + [Intrusion, File, and Malware Inspection in FDM-Managed Access Control Policies](#Intrusion_File_and_Malware_Inspection_in_FTD_Access_Control_Policies)
    + [Custom IPS Policy in an FDM-Managed Access Control Rule](#Custom_IPS_Policy_in_an_FTD_Access_Control_Rule)
    + [TLS Server Identity Discovery in Firepower Threat Defense](#TLS_Server_IdentityDiscovery_in_Firepower_Threat_Defense)
      - [Enable the TLS Server Identity Discovery](#Enable_theTLS_Server_IdentityDiscovery)
- [Intrusion Prevention System](#Intrusion_Prevention_System)
  * [Threat Events](#Threat_Events)
  * [Firepower Intrusion Policy Signature Overrides](#Firepower_Intrusion_Policy_Signature_Overrides)
    + [Manage Signature Overrides](#Manage_Signature_Overrides)
    + [Create A Signature Override](#Create_A_Signature_Override)
    + [Remove A Signature Override](#Remove_ASignature_Override)
  * [Custom Firepower Intrusion Prevention System Policy](#Custom_Firepower_Intrusion_Prevention_System_Policy)
    + [Configure Firepower Custom IPS Policies](#Configure_Firepower_Custom_IPS_Policies)
      - [Create a Custom IPS Policy](#Create_a_Custom_IPSPolicy)
      - [Edit a Custom IPS Policy](#Edit_a_Custom_IPS_Policy)
      - [Edit Rule Groups in a Custom IPS Policy](#Edit_Rule_Groupsin_a_Custom_IPS_Policy)
      - [Delete a Custom IPS policy](#Delete_a_Custom_IPS_policy)
- [Security Intelligence Policy](#FTD_Security_Intelligence_Policy)
  * [Configure the Firepower Security Intelligence Policy](#Configure_the_Firepower_Security_Intelligence_Policy)
    + [Configure Firepower Security Intelligence Policy](#Procedure)
  * [Making Exceptions to the Firepower Security Intelligence Policy Blocked Lists](#Making_Exceptions_to_the_Firepower_Security_Intelligence_Policy_Blocked_Lists)
  * [Security Intelligence Feeds for Firepower Security Intelligence Policies](#Security_Intelligence_Feeds_for_Firepower_Security_Intelligence_Policies)
- [FDM-Managed Device Identity Policy](#FTD_Identity_Policy)
  * [How to Implement an Identity Policy](#How_to_Implement_a_Firepower_Identity_Policy)
    + [Procedure](#Procedure)
  * [Configure Identity Policies](#Configure_Identity_Policies)
    + [Procedure](#Procedure)
  * [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings)
    + [Procedure](#Procedure)
  * [Configure the Identity Policy Default Action](#Configure_the_Firepower_Identity_Policy_Default_Action)
    + [Procedure](#Procedure)
  * [Configure Identity Rules](#Configure_Identity_Rules)
    + [Procedure](#Procedure)
- [SSL Decryption Policy](#FTD_SSL_Decryption_Policy)
  * [How to Implement and Maintain the SSL Decryption Policy](#How_to_Implement_and_Maintain_the_SSL_Decryption_Policy)
    + [Procedure](#Procedure)
  * [About SSL Decryption](#About_SSL_Decryption)
    + [Why Implement SSL Decryption?](#Why_Implement_SSL_Decryption)
    + [Actions You Can Apply to Encrypted Traffic](#Actions_You_Can_Apply_to_Encrypted_Traffic)
    + [Automatically Generated SSL Decryption Rules](#Automatically_Generated_SSL_Decryption_Rules)
    + [Handling Undecryptable Traffic](#Handling_Undecryptable_Traffic)
    + [License Requirements for SSL Decryption Policies](#License_Requirements_for_SSL_Decryption_Policies)
    + [Guidelines for SSL Decryption](#Guidelines_for_SSL_Decryption)
  * [Configure SSL Decryption Policies](#Configure_SSL_Decryption_Policies)
    + [Procedure](#Procedure)
    + [Enable the SSL Decryption Policy](#Enable_the_SSL_Decryption_Policy)
      - [Procedure](#Procedure)
    + [Configure the Default SSL Decryption Action](#Configure_the_Default_SSL_Decryption_Action)
      - [Procedure](#Procedure)
    + [Configure SSL Decryption Rules](#Configure_SSL_Decryption_Rules)
      - [Procedure](#Procedure)
    + [Source/Destination Criteria for SSL Decryption Rules](#SourceDestination_Criteria_for_SSL_Decryption_Rules)
    + [URL Criteria for SSL Decryption Rules](#URL_Criteria_for_SSL_Decryption_Rules)
    + [User Criteria for SSL Decryption Rules](#User_Criteria_for_SSL_Decryption_Rules)
  * [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_Certificates_for_Known_Key_and_ReSign_Decryption)
  * [Downloading the CA Certificate for Decrypt Re-Sign Rules](#Downloading_the_CA_Certificate_for_Decrypt_ReSign_Rules)
    + [Procedure](#Procedure)
    + [Warning](#Warning)
- [Rulesets](#FTD_Rulesets)
  * [Configure Rulesets for a Device](#Configure_Rulesets_for_an_FTD)
    + [Create or Edit a Ruleset](#Create_or_Edit_a_Ruleset)
    + [Deploy a Ruleset to Multiple FDM-Managed Devices or Templates](#Deploy_a_Ruleset_toMultiple_FTD_Devices_or_Templates)
    + [Add Devices to a Ruleset from the Ruleset page](#Add_Devices_to_a_Rulesetfrom_the_Ruleset_page)
    + [Add Rulesets to a Device from the Device Policy page](#Add_Rulesets_to_a_Devicefrom_the_Device_Policy_page)
  * [Rulesets with FDM-Managed Templates](#FTD_Rulesets_with_FTD_Templates)
  * [Create Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)
  * [Impact of Out-of-Band Changes on Rulesets](#Impact_of_OutofBand_Changes_on_Rulesets)
  * [Impact of Discarding Staged Ruleset Changes](#Impact_of_Discarding_Staged_Ruleset_Changes)
  * [View Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
    + [View Rules from Device Policy Page](#View_Rules_from_DevicePolicy_Page)
    + [View Rulesets](#View_Rulesets)
    + [Search Rulesets](#SearchRulesets)
    + [View Jobs Associated with Rulesets](#View_Jobs_Associated_with_Rulesets)
  * [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
  * [Detach FDM-Managed Devices from a Selected Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)
  * [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)
    + [Delete Rules from a Ruleset](#Delete_Rules_from_a_Ruleset)
    + [Delete a Ruleset](#Delete_aRuleset)
  * [Remove a Ruleset From a Selected FDM-Managed Device](#Remove_a_Ruleset_From_a_Selected_FTD_device)
    + [Delete a Ruleset From a Selected FDM-Managed Device](#Delete_a_Ruleset_From_a_Selected_FTD_Device)
    + [Disassociate a Ruleset From a Selected FDM-Managed Device](#Disassociate_a_Ruleset_From_a_Selected_FTD_Device)
- [Adding Comments to Rules in Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets)
  * [Adding a Comment to a Rule](#Adding_a_Comment_to_a_Rule)
  * [Editing Comments about Rules in Policies and Rulesets](#Editing_Comments_about_Rules_in_FTD_Policies_and_Rulesets)
    + [Editing a comment on a rule in a policy](#Editing_a_comment_on_a_rule_in_a_policy)
    + [Editing a comment on a rule in a ruleset](#Editing_a_comment_on_a_rule_in_a_ruleset)
- [Network Address Translation](#Network_Address_Translation)
- [Order of Processing NAT Rules](#AboutNetwork_Address_Translation_NAT)
- [Network Address Translation Wizard](#Network_Address_Translation_Wizard)
  * [Create a NAT Rule by using the NAT Wizard](#Createa_NAT_Rule_by_using_the_NAT_Wizard)
- [Common Use Cases for NAT](#Cisco_Reference.dita_3cfd3b68-ef46-4429-a0ec-579088c24473)
  * [Enable a Server on the Inside Network to Reach the Internet Using a Public IP address](#Create_NAT_Rule)
  * [Enable Users on the Inside Network to Access the Internet Using the Outside Interface's Public IP Address](#Create_NAT_Rule)
  * [Make a Server on the Inside Network Available on a Specific Port of a Public IP Address](#Make_a_Server_on_the_Inside_Network_Available_on_a_Specific_Port_of_a_Public_IP_Address)
    + [NAT Incoming FTP Traffic to an FTP Server](#NAT_Incoming_FTP_Traffic_to_an_FTPServer)
    + [NAT Incoming HTTP Traffic to an HTTP Server](#NAT_Incoming_HTTP_Traffic_to_an_HTTP_Server)
    + [NAT Incoming SMTP Traffic to an SMTP Server](#NAT_Incoming_SMTP_Traffic_to_an_SMTP_Server)
  * [Translate a Range of Private IP Addresses to a Range of Public IP Addresses](#Translate_a_Range_of_Private_IP_Addresses_to_a_Range_of_Public_IP_Addresses)
    + [Translate a Pool of Inside Addresses to a Pool of Outside Addresses](#Translate_a_Pool_of_Inside_Addresses_to_a_Pool_of_Outside_Addresses)
  * [Prevent a Range of IP Addresses from Being Translated When Traversing the Outside Interface](#Prevent_a_Range_of_IP_Addresses_from_Being_Translated_When_Traversing_the_Outside_Interface)
    + [Create a Twice NAT Rule](#Create_a_Twice_NAT_Rule)
- [Manage Virtual Private Network Management in Security Cloud Control](#Cisco_Concept.dita_6d1ed39d-3d97-4f06-af00-5d2b0af6e3f1)
  * [Introduction to Site-to-Site Virtual Private Network](#SitetoSite_Virtual_Private_Network)
    + [Configure Site-to-Site VPN for an FDM-Managed Device](#Configuring_SitetoSite_VPN_for_an_FTD)
      - [Encryption and Hash Algorithms Used in VPN](#Encryption_and_Hash_Algorithms_Used_in_VPN)
      - [Create a Site-To-Site VPN](#Create_a_SiteToSite_VPN)
        * [Create a Site-To-Site VPN using the Simple Configuration](#Create_a_SiteToSite_VPN_using_the_Simple_Configuration)
        * [Create a Site-To-Site VPN using the Advanced Configuration](#Create_a_SiteToSite_VPN_using_the_Advanced_Configuration)
        * [Configure Networking for Protected Traffic Between the Site-To-Site Peers](#Configure_Networking_for_Protected_Traffic_Between_the_SiteToSite_Peers)
      - [Edit an Existing Security Cloud Control Site-To-Site VPN](#Edit_an_Existing_CDO_SiteToSite_VPN)
        * [Delete a Security Cloud Control Site-To-Site VPN Tunnel](#Delete_an_Existing_CDO_SiteToSite_VPN)
      - [Exempt Site-to-Site VPN Traffic from NAT](#Procedure)
    + [About Global IKE Policies](#Configuring_the_Global_IKE_Policy)
      - [Managing IKEv1 Policies](#Managing_FTD_IKEv1_Policies)
      - [Create an IKEv1 Policy](#Create_or_Edit_an_FTD_IKEv1Policy)
      - [Managing IKEv2 Policies](#Managing_FTD_IKEv2_Policies)
      - [Create an IKEv2 Policy](#Create_or_Edit_an_FTDIKEv2Policy)
    + [About IPsec Proposals](#Configuring_IPsec_Proposals)
      - [Managing an IKEv1 IPsec Proposal Object](#Managing_an_FTD_IKEv1_IPsec_Proposal_Object)
        * [Create an IKEv1 IPsec Proposal Object](#Create_or_Editan_FTDIKEv1_IPsecProposal_Object)
      - [Managing an IKEv2 IPsec Proposal Object](#Managing_an_FTD_IKEv2_IPsec_Proposal_Object)
        * [Create or Edit an IKEv2 IPsec Proposal Object](#Create_or_Edit_an_FTDIKEv2_IPsec_Proposal_Object)
  * [Monitor FDM-Managed Device Site-to-Site Virtual Private Networks](#Cisco_Concept.dita_69376aa9-2723-41e1-865a-34279cbec929)
    + [Check Site-to-Site VPN Tunnel Connectivity](#Check_SitetoSite_VPN_Tunnel_Connectivity)
    + [Site-To-Site VPN Dashboard](#virtual-private-network-dashboard)
    + [Identify VPN Issues](#Identify_VPN_Issues)
      - [Find VPN Tunnels with Missing Peers](#Find_VPN_Tunnels_with_Missing_Peers)
      - [Find VPN Peers with Encryption Key Issues](#FindVPN_Peers_with_Encryption_Key_Issues)
      - [Find Incomplete or Misconfigured Access Lists Defined for a Tunnel](#Find_Incomplete_or_MisconfiguredAccess_Lists_Defined_for_a_Tunnel)
      - [Find Issues in Tunnel Configuration](#Find_Issues_in_Tunnel_Configuration)
      - [Resolve Tunnel Configuration Issues](#Cisco_Task.dita_7ec52168-e8ac-4115-a850-9c9fa9f4b673)
    + [Search and Filter Site-to-Site VPN Tunnels](#Search_and_Filter_SitetoSite_VPN_Tunnels)
    + [Onboard an Unmanaged Site-to-Site VPN Peer](#Onboard_an_Unmanaged_VPN_Peer)
    + [View IKE Object Details of Site-To-Site VPN Tunnels](#View_IKE_Object_Details_of_SiteToSite_VPN_Tunnels)
    + [View Last Successful Site-to-Site VPN Tunnel Establishment Date](#View_Last_Successful_SitetoSite_VPN_Tunnel_Establishment_Date)
    + [View Site-to-Site VPN Tunnel Information](#SitetoSite_VPN_Table_View)
      - [Site-to-Site VPN Global View](#SitetoSite_VPN_Global_View)
      - [Site-to-Site VPN Tunnels Pane](#Tunnels_Pane)
- [Delete a Security Cloud Control Site-To-Site VPN Tunnel](#Delete_an_Existing_CDO_SiteToSite_VPN)
- [Introduction to Remote Access Virtual Private Network](#Related_Topics)
  * [Introduction to Remote Access Virtual Private Network](#Related_Topics)
    + [Configuring Remote Access VPN for an FDM-Managed Device](#Configuring_Remote_Access_VPN_for_an_FTD)
      - [Split Tunneling for RA VPN Users (Hair Pinning)](#Split_Tunneling_for_RA_VPN_Users_Hair_Pinning)
      - [Control User Permissions and Attributes Using RADIUS and Group Policies](#Control_User_Permissions_and_Attributes_Using_RADIUS_and_Group_Policies)
        * [Attributes Sent to the RADIUS Server](#Attributes_Sent_to_the_RADIUS_Server)
      - [Two-Factor Authentication](#Cisco_Concept.dita_1fffa0ef-389e-455c-9266-fa0b6dc83342)
        * [Duo Two-Factor Authentication Using RADIUS](#Cisco_Concept.dita_f9d4cf7c-74aa-4b89-813e-a4fa6491e14d)
          + [System Flow for Duo RADIUS Secondary Authentication](#Cisco_Concept.dita_86bfbab0-91ed-4ba6-9f68-cb438d9f4900)
          + [Configure Duo RADIUS Secondary Authentication](#Cisco_Concept.dita_ec739b3d-a874-48e8-8516-db1461ca41bd)
            - [Create a Duo Account](#Cisco_Task.dita_2e620750-04ad-41c6-abab-f9c20a97405a)
            - [Configure Device for Duo RADIUS Using Security Cloud Control](#Cisco_Task.dita_d9e25612-4929-4902-9c0a-bb924073143a)
              * [Duo Two-Factor Authentication using LDAP](#Cisco_Concept.dita_4b54700e-091b-4507-9102-cb02f3541027)
                + [System Flow for Duo LDAP Secondary Authentication](#Cisco_Concept.dita_378e73f9-f3bf-4531-b941-2a4ce3eb0ffd)
                + [Configure Duo LDAP Secondary Authentication](#Cisco_Concept.dita_c937c6bf-874c-438e-b498-2afeb5473abc)
                  - [Create a Duo Account](#Cisco_Task.dita_97f10b03-3735-42fb-8745-5cd823fdb555)
                  - [Upload a Trusted CA Certificate to an FDM-Managed Device](#Cisco_Task.dita_8561f652-5933-436a-9c3c-561ac30edaa8)
                  - [Configure FTD for Duo LDAP in Security Cloud Control](#Cisco_Task.dita_f1783de0-dffc-47ac-a048-f5285cd201fd)
                    * [End-to-End Remote Access VPN Configuration Process for an FDM-Managed Device](#Procedure)
                      + [Download AnyConnect Client Software Packages](#Download_AnyConnect_Client_Software_Packages)
                      + [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.4.0](#Upload_AnyConnect_Software_Packages_to_an_FTD_Version_64)
                      + [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.5 or Later](#Upload_AnyConnect_Software_Packages_to_an_FTD_Device_Running_FTD_Version_65_or_Later)
                        - [Configure Identity Sources for FDM-Managed Device](#Configure_Identity_Sources_for_FTD)
                          * [Create an FTD Active Directory Realm Object](#Create_an_FTD_Active_Directory_Realm_Object)
                          * [Edit an FTD Active Directory Realm Object](#Edit_an_FTD_Active_Directory_Realm_Object)
                            + [Create a RADIUS Server Object](#Create_aRADIUS_Server_Object)
                            + [Create a RADIUS Server Group](#Create_a_RADIUS_Server_Group)
                            + [Edit a Radius Server Object or Group](#Edit_a_Radius_Server_Object_or_Group)
                              - [Create New RA VPN Group Policies](#Procedure)
                                * [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration)
                                  + [Configure an RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile)
                                    - [Allow Traffic Through the Remote Access VPN](#Allow_Traffic_Through_the_Remote_Access_VPN)
                                    - [Upgrade AnyConnect Package on an FDM-Managed Device Running Version 6.4.0](#Upgrade_AnyConnect_Package_on_an_FTD_Version_64)
                                      * [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object)
                                    - [Guidelines and Limitations of Remote Access VPN for FDM-Managed Device](#Guidelines_and_Limitations_of_Remote_Access_VPN_for_FTD)
                                    - [How Users Can Install the AnyConnect Client Software on FDM-Managed Device](#Procedure)
                                      * [Distribute new AnyConnect Client Software version](#Distributenew_AnyConnect_Client_Software_version)
                                    - [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object)
                                    - [Licensing Requirements for Remote Access VPN](#Licensing_Requirements_for_Remote_Access_VPN)
                                    - [Maximum Concurrent VPN Sessions By Device Model](#Maximum_Concurrent_VPN_Sessions_By_Device_Model)
                                    - [RADIUS Change of Authorization](#RADIUS_Change_of_Authorization)
                                      * [Configure Change of Authorization on the FDM-Managed Device](#Configure_Change_of_Authorization_on_the_FTD_Device)
                                        + [Verify Remote Access VPN Configuration of FDM-Managed Device](#Procedure)
                                        + [View Remote Access VPN Configuration Details of FDM-Managed Device](#View_Remote_Access_VPN_Configuration_Details_of_FTD)
                                      * [Monitor Remote Access Virtual Private Network Sessions](#Monitoring_Remote_Access_Virtual_Private_Network)
                                        + [Monitor Live AnyConnect Remote Access VPN Sessions](#Cisco_Task.dita_0df079f7-8437-4832-896b-b35af8457872)
                                          - [View Live Remote Access VPN Data](#Cisco_Reference.dita_a9f03a0c-3e64-4a9f-bdfe-901425e09bc7)
                                        + [Monitor Historical AnyConnect Remote Access VPN Sessions](#Cisco_Task.dita_dde3b002-d30f-4ccf-b1f0-6285baf3465f)
                                          - [View Historical Remote Access VPN Data](#Cisco_Reference.dita_de126b3f-6429-4a74-82f6-1f85a279c14b)
                                        + [Search and Filter Remote Access VPN Sessions](#Search_and_Filter_Remote_Access_VPN_Sessions)
                                        + [Customize the Remote Access VPN Monitoring View](#Customize_the_Remote_Access_VPN_Monitoring_View)
                                        + [Export Remote Access VPN Sessions to a CSV File](#Export_RA_VPN_Sessions_to_a_CSV_File)
                                        + [Remote Access VPN Dashboard](#virtual-private-network-dashboard)
                                        + [Disconnect Remote Access VPN Sessions on FDM-Managed Device](#Disconnect_Active_Remote_Access_VPN_Sessions_on_FTD)
                          * [Templates](#Templates)
                            + [FDM-Managed Device Templates](#FTD_Templates)
                            + [Configure an FDM Template](#Configure_an_FTD_Template)
                              - [Create an FDM Template](#Create_anFTD_Template)
                              - [Edit an FDM-Managed Device Template](#Edit_an_FTD_Template)
                              - [Delete an FDM Template](#Delete_an_FTD_Template)
                            + [Apply an FDM Template](#Apply_an_FTD_Template)
                              - [Apply Template to an FDM-Managed Device](#Apply_Template_to_an_FTD)
                              - [Review Device and Networking Settings](#Review_Device_and_Networking_Settings)
                              - [Deploy Changes to the Device](#DeployChanges_to_the_Device)
                            + [Migrating an ASA Configuration to an FDM-Managed Device Template](#Migrating_an_ASA_Configuration_to_an_FTD_Template)
                          * [FDM-Managed High Availability](#About_High_Availability)
                            + [FDM-Managed High Availability Pair Requirements](#FTD_High_Availability_Pair_Requirements)
                            + [Create an FDM-Managed High Availability Pair](#Create_an_FTD_High_Availability_Pair)
                              - [Procedure](#Procedure)
                            + [FDM-Managed Devices in High Availability Page](#FTD_High_Availability_Page)
                              - [High Availability Management Page](#High_Availability_Management_Page)
                              - [Edit High Availability Failover Criteria](#Edit_High_Availability_Failover_Criteria)
                              - [Break an FDM-Managed High Availability Pairing](#Break_an_FTD_High_Availability_Pairing)
                                * [Break High Availability](#Break_High_Availability)
                                * [Break Out-of-Band High Availability](#BreakOutofBand_High_Availability)
                              - [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)
                              - [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
                              - [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
                              - [Failover and Stateful Link for FDM-Managed High Availability](#Failover_and_Stateful_Link_for_FTD_High_Availability)
                        - [FDM-Managed Device Settings](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed)
                          * [Configure an FDM-Managed Device's System Settings](#Configure_an_FTDDevices_System_Settings)
                          * [Configure Management Access](#Cisco_Concept.dita_6e295ca7-7371-49c8-8934-6ddbe2e442da)
                            + [Create Rules for Management Interfaces](#Cisco_Task_in_List_GUI.dita_ea786c6f-12be-411f-96e7-97d7a95ed70e)
                            + [Create Rules for Data Interfaces](#Cisco_Task_in_List_GUI.dita_7b342b5b-3eda-44c4-a368-653cfa25bc40)
                          * [Configure Logging Settings](#Configure_Logging_Settings)
                            + [Message Severity Levels](#Message_Severity_Levels)
                          * [Configure DHCP Servers](#Configure_DHCP_Servers)
                          * [Configure DNS Server](#Configure_DNS_Server)
                          * [Management Interface](#Management_Interface)
                          * [Hostname](#Hostname)
                          * [Configure NTP Server](#Configure_NTP_Server)
                          * [Configure URL Filtering](#Configure_URL_Filtering)
                          * [Cloud Services](#Cloud_Services)
                            + [Connecting to the Cisco Success Network](#Connecting_to_the_Cisco_Success_Network)
                            + [Sending Events to the Cisco Cloud](#Sending_Events_to_the_Cisco_Cloud)
                          * [Enabling or Disabling Web Analytics](#Enabling_or_Disabling_Web_Analytics)
                        - [Security Cloud Control Command Line Interface](#Using_the_CDO_Command_Line_Interface)
                          * [Using the Command Line Interface](#Using_theCLI_on_a_Single_Device)
                          * [Entering Commands in the Command Line Interface](#How_toentercommands)
                          * [Work with Command History](#Work_withCommand_History)
                        - [Bulk Command Line Interface](#About_the_Bulk_Command_Line_Interface)
                          * [Bulk CLI Interface](#Bulk_CLI_Interface)
                          * [Send Commands in Bulk](#Send_Commands_in_Bulk)
                          * [Work with Bulk Command History](#Workwith_Bulk_Command_History)
                          * [Work with Bulk Command Filters](#Workwith_Bulk_Command_Filters)
                            + [By Response Filter](#By_Response_Filter)
                            + [By Device Filter](#By_Device_Filter)
                      + [Command Line Interface Macros](#CLI_Macros_for_Managing_Devices)
                        - [Create a CLI Macro from a New Command](#Createa_CLI_Macro_from_a_New_Command)
                        - [Create a CLI Macro from CLI History or from an Existing CLI Macro](#Cisco_Task_in_List_GUI.dita_83757e8d-75a1-41cb-8382-6e0aab1d0ad2)
                        - [Run a CLI Macro](#Run_a_CLI_Macro)
                        - [Edit a CLI Macro](#Edit_a_CLI_Macro)
                        - [Delete a CLI Macro](#Delete_a_CLI_Macro)
                      + [Command Line Interface Documentation](#FTD_Command_Line_Interface_Documentation)
                      + [Export Security Cloud Control CLI Command Results](#Export_CLI_Command_Results)
                        - [Export CLI Command Results](#Export_CLI_Command_Results)
                        - [Export the Results of CLI Macros](#Export_the_Results_of_CLI_Macros)
                        - [Export the CLI Command History](#Export_the_CLI_Command_History)
                        - [Export the CLI Macro List](#Cisco_Task_in_List_GUI.dita_125c73ca-41f6-42e8-8ab7-516aefc82aa7)
                      + [Security Cloud Control Public API](#Cisco_Concept.dita_e72c97c4-ea44-4949-91d8-1e9283840897)
                      + [Create a REST API Macro](#Create_a_REST_API_Macro)
                        - [Using the API Tool](#Overview)
                        - [How to Enter a Secure Firewall Threat Defense REST API Request](#How_to_Enter_FTD_REST_API_Request)
                        - [About FTD REST API Macros](#About_FTD_REST_API_Macros)
                          * [Create a REST API Macro](#Create_a_REST_API_Macro)
                            + [Create a REST API Macro from a New Command](#Create_a_REST_API_Macro_from_a_New_Command)
                            + [Create a REST API Macro from History or from an Existing REST API Macro](#Create_a_REST_API_Macro_fromHistory_or_from_an_Existing_REST_API_Macro)
                          * [Run a REST API Macro](#Run_a_REST_API_Macro)
                          * [Edit a REST API Macro](#Edit_a_REST_API_Macro)
                          * [Delete a REST API Macro](#Delete_a_REST_API_Macro)
                    * [About Device Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)
                    * [Read All Device Configurations](#Read_All_Configurations)
                    * [Read Configuration Changes from FDM-Managed Device to Security Cloud Control](#Read_Configuration_Changes_from_FTD_to_CDO)
                      + [Discard Changes Procedure](#Discard_Changes_Procedure)
                      + [If Reverting Pending Changes Fails](#If_Reverting_Pending_Changes_Fails)
                      + [Review Conflict Procedure](#Review_Conflict_Procedure)
                      + [Accept Without Review Procedure](#Accept_Without_Review_Procedure)
                    * [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be)
                    * [Deploy Configuration Changes from Security Cloud Control to FDM-Managed Device](#Deploy_Configuration_Changes_from_CDO_to_FTD)
                    * [Deploy Changes to a Device](#Deploy_Changes_to_a_Single_FTD_Meraki_or_AWS_device)
                      + [Cancelling Changes](#Cancelling_Changes)
                      + [Discarding Changes](#Discarding_Changes)
                    * [Bulk Deploy Device Configurations](#Bulk_Deploy_Device_Configurations)
                    * [About Scheduled Automatic Deployments](#Scheduled_Deployments_for_Devices)
                      + [Schedule an Automatic Deployment](#Schedule_an_AutomaticDeployment)
                      + [Edit a Scheduled Deployment](#Edit_a_Scheduled_Deployment)
                      + [Delete a Scheduled Deployment](#Delete_a_Scheduled_Deployment)
                    * [Check for Configuration Changes](#Check_for_Configuration_Changes)
                    * [Discard Configuration Changes](#Discard_Changes)
                    * [Out-of-Band Changes on Devices](#OutofBand_Changes_on_Devices)
                    * [Synchronizing Configurations Between Security Cloud Control and Device](#Cisco_Concept.dita_ec3b7171-cc31-45fe-96fb-381b786045a0)
                    * [Conflict Detection](#Conflict_Detection)
                      + [Enable Conflict Detection](#EnableConflict_Detection)
                    * [Automatically Accept Out-of-Band Changes from your Device](#Automatically_Accept_OutofBand_Changes_from_your_Device)
                      + [Configure Auto-Accept Changes](#Configure_AutoAccept_Changes)
                      + [Disabling Auto-Accept Changes for All Devices on the Tenant](#Disabling_AutoAccept_Changes_for_All_Devices_on_the_Tenant)
                    * [Resolve Configuration Conflicts](#Resolve_Configuration_Conflicts)
                      + [Resolve the Not Synced Status](#ResolveNot_Synced_Status)
                      + [Resolve the Conflict Detected Status](#ResolveConflict_Detected_Status)
                    * [Schedule Polling for Device Changes](#Schedule_Polling)
                    * [Schedule a Security Database Update](#Cisco_Concept.dita_6d14fe36-f86d-44a9-86dc-ebc77367c11d)
                      + [Create a Scheduled Security Database Update](#Createa_Scheduled_Security_Database_Update)
                      + [Edit a Scheduled Security Database Update](#Edit_a_Scheduled_Security_Database_Update)
                    * [Update FDM-Managed Device Security Databases](#Update_the_Security_Databases)
                      + [Workflows](#Workflows)
Close

# Configuring FDM-Managed Devices

* [Interfaces](#Interfaces)
* [Synchronizing Interfaces Added to a Firepower Device using FXOS](#Cisco_Task_in_List_GUI.dita_ba4695d9-1258-4b17-8d1d-5ff7db6c7a69)
* [Routing](#Routing)
* [Objects](#Objects)
* [Manage Security Policies in Security Cloud Control](#Cisco_Concept.dita_9644c92c-1c4a-4938-91e1-f871c909c20b)
* [FDM Policy Configuration](#FTD_Policy_Configuration)
* [Manage Virtual Private Network Management in Security Cloud Control](#Cisco_Concept.dita_6d1ed39d-3d97-4f06-af00-5d2b0af6e3f1)
* [Templates](#Templates)
* [FDM-Managed High Availability](#About_High_Availability)
* [FDM-Managed Device Settings](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed)
* [Security Cloud Control Command Line Interface](#Using_the_CDO_Command_Line_Interface)
* [Bulk Command Line Interface](#About_the_Bulk_Command_Line_Interface)
* [Command Line Interface Macros](#CLI_Macros_for_Managing_Devices)
* [Command Line Interface Documentation](#FTD_Command_Line_Interface_Documentation)
* [Export Security Cloud Control CLI Command Results](#Export_CLI_Command_Results)
* [Security Cloud Control Public API](#Cisco_Concept.dita_e72c97c4-ea44-4949-91d8-1e9283840897)
* [Create a REST API Macro](#Create_a_REST_API_Macro)
* [About Device Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)
* [Read All Device Configurations](#Read_All_Configurations)
* [Read Configuration Changes from FDM-Managed Device to Security Cloud Control](#Read_Configuration_Changes_from_FTD_to_CDO)
* [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be)
* [Deploy Configuration Changes from Security Cloud Control to FDM-Managed Device](#Deploy_Configuration_Changes_from_CDO_to_FTD)
* [Deploy Changes to a Device](#Deploy_Changes_to_a_Single_FTD_Meraki_or_AWS_device)
* [Bulk Deploy Device Configurations](#Bulk_Deploy_Device_Configurations)
* [About Scheduled Automatic Deployments](#Scheduled_Deployments_for_Devices)
* [Check for Configuration Changes](#Check_for_Configuration_Changes)
* [Discard Configuration Changes](#Discard_Changes)
* [Out-of-Band Changes on Devices](#OutofBand_Changes_on_Devices)
* [Synchronizing Configurations Between Security Cloud Control and Device](#Cisco_Concept.dita_ec3b7171-cc31-45fe-96fb-381b786045a0)
* [Conflict Detection](#Conflict_Detection)
* [Automatically Accept Out-of-Band Changes from your Device](#Automatically_Accept_OutofBand_Changes_from_your_Device)
* [Resolve Configuration Conflicts](#Resolve_Configuration_Conflicts)
* [Schedule Polling for Device Changes](#Schedule_Polling)
* [Schedule a Security Database Update](#Cisco_Concept.dita_6d14fe36-f86d-44a9-86dc-ebc77367c11d)
* [Update FDM-Managed Device Security Databases](#Update_the_Security_Databases)

## Interfaces

You can use Security Cloud Control to configure and edit data interfaces or the management/diagnostic interface on an FDM-managed device.

At this time, Security Cloud Control can only configure routed interfaces and bridge groups. It does not support the configuration passive interfaces.

* [Guidelines and Limitations for Firepower Interface Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration)
* [Firepower Data Interfaces](#Firepower_Data_Interfaces)
* [Management/Diagnostic Interface](#ManagementDiagnostic_Interface)
* [Interface Settings](#Interface_Settings)
* [IPv6 Addressing for Firepower Interfaces](#IPv6_Addressing_for_Firepower_Interfaces)
* [Configuring Firepower Interfaces](#Configuring_Firepower_Interfaces)
* [Viewing and Monitoring Firepower Interfaces](#Viewing_Firepower_Interfaces)

### Guidelines and Limitations for Firepower Interface Configuration

When you use Security Cloud Control to configure the device, there are several limitations to interface configuration. If you need any of the following features,
you must use Firepower Management Center to configure the device.

#### Firewall

* Routed firewall mode only is supported. You cannot configure transparent firewall mode interfaces.
* Only physical firepower 1010 devices support interfaces configured for switch port mode. See [Switch Port Mode Interfaces for an FDM-Managed Device](#Switch_Port_Mode_Interfaces_for_an_FTD) for more information.

#### Passive

* At this time, Security Cloud Control does not identify passive interface mode in the interface table ad you cannot configure passive or ERSPAN interfaces. You
  must use the FDM-managed UI to configure and identify passive interfaces.

#### IPS-Only Mode

* You cannot configure interfaces to be inline (in an inline set), or inline tap, for IPS-only processing. IPS-only mode interfaces
  bypass many firewall checks and only support IPS security policy. In comparison, Firewall mode interfaces subject traffic
  to firewall functions such as maintaining flows, tracking flow states at both IP and TCP layers, IP defragmentation, and TCP
  normalization.
* Optionally, you can configure IPS functions for this firewall mode traffic according to your security policy.

#### EtherChannel

Security Cloud Control supports read, create, and abilities for devices running Version 6.5 and later. To create Etherchannel interfaces, see [Add an EtherChannel Interface for an FDM-Managed Device](#Add_an_EtherChannel_Interface_for_Firepower_Threat_Defense) for more information. To create

* You can configure up to 48 EtherChannels on physical Firepower devices, although how many interfaces can be active at a time
  depends on your device model. For device-specific limitations, see [Device-Specific Requirements](#Add_an_EtherChannel_Interface_for_Firepower_Threat_Defense__device_spec_limitation).
* All interfaces in the channel group must be the same media type and capacity, and must be set to the same speed and duplex.
  The media type can be either RJ-45 or SFP; SFPs of different types (copper and fiber) can be mixed. You cannot mix interface
  capacities (for example 1GB and 10GB interfaces) by setting the speed to be lower on the larger-capacity interface.
* The device to which you connect the EtherChannel must also support 802.3ad EtherChannels.
* The FDM-managed device does not support LACPDUs that are VLAN-tagged. If you enable native VLAN tagging on the neighboring
  switch using the Cisco IOS vlan dot1Q tag native command, then the FDM-managed device will drop the tagged LACPDUs. Be sure to disable native VLAN tagging on the neighboring switch.
* All FDM-managed device configuration refers to the logical EtherChannel interface instead of the member physical interfaces.

  | **Note** | ---   Interfaces set up as portchannels can only use physical interfaces, redundant interfaces, and subinterfaces are supported as bridge group member interfaces.   --- |
  | --- | --- |

#### Bridge Groups

At this time, Security Cloud Control supports the configuration of one bridge group. To determine if your device supports bridge groups, see [Bridge Group Compatibility in FDM-Managed Device Configurations](#Bridge_Group_Compatibility_in_FTD_Configurations) for more information.

When adding an interface to a bridge group, keep the following in mind:

* The interface must have a name.
* The interface cannot have any IPv4 or IPv6 addresses defined for it, either static or served through DHCP.
* BVI can have either VLAN interfaces or other routed interfaces as a member interface, but you cannot have both as member interfaces
  on a single BVI.
* BVI can have either VLAN interfaces or other routed interfaces as a member interface, but you cannot have both as member interfaces
  on a single BVI.
* The interface cannot be Point-to-Point Protocol over Ethernet (PPPoE)
* The interface cannot be associated with a security zone (if it is in a zone). You must delete any NAT rules for the interface
  before you can add it to a bridge group.
* Enable and disable the member interfaces individually. Thus, you can disable any unused interfaces without needing to remove
  them from the bridge group. The bridge group itself is always enabled.
* You can configure the interfaces that will be ******members****** of the bridge group. See [Configure a Bridge Group](#Configure_a_Bridge_Group) for interface requirements and creation.

#### Point-to-Point Protocol over Ethernet

* You cannot configure Point-to-Point Protocol over Ethernet (PPPoE) for IPv4. If the Internet interface is connected to a DSL,
  cable modem, or other connection to your ISP, and your ISP uses PPPoE to provide your IP address, you must use the FDM to
  configure these settings.

#### VLAN

To configure VLAN interfaces and VLAN members, see [Configure an FDM-Managed Device VLAN](#Configure_a_VLANInterface) for more information. To configure VLAN for switch port mode, see [Configure an FDM-Managed Device VLAN for Switch Port Mode](#Configure_an_FTD_VLAN_for_Switch_Port_Mode) for more information.

* The interface must be physical.
* The interface cannot be management-only.
* The interface cannot be associated as any other type of interface, including BVI, subinterfaces, another VLAN interface, EtherChannel,
  etc.
* The interface cannot be a BVI member or an etherchannel member.
* Device models support varying numbers of VLAN members. See [Maximum Number of VLAN Members by Device Model](#Maximum_Number_of_VLAN_Members_by_Device_Model) for more information.

  | **Note** | ---   To configure VLAN for your environment, see [Configure Firepower VLAN Subinterfaces and 802.1Q Trunking](#Configure_Firepower_VLAN_Subinterfaces_and_821Q_Trunking) for more information.   --- |
  | --- | --- |

#### Network Module Cards

Optional network module installations are limited to the ASA 5515-X, 5525-X, 5545-X, and 5555-X, and the Firepower 2100 series
devices.

* Cards are only discovered during bootstrap (that is, initial installation or reimage, or when switching between local/remove
  management). Security Cloud Control sets the correct defaults for speed and duplex for these interfaces. If you replace an optional card with one that changes
  the speed/duplex options for the interfaces, without changing the total number of interfaces available, reboot the device
  so that the system recognizes the correct speed/duplex values for the replaced interfaces. From an SSH or Console session
  with the device, enter the reboot command. Then, using Security Cloud Control, edit each physical interface that had capability changes and select valid speed and duplex options, as the system does not
  automatically correct your original settings. Deploy your changes right away to ensure correct system behavior.
* You cannot enable or disable network modules or perform breakout online insertion and removal (OIR) of interfaces on FDM-managed Secure Firewall 3100 series devices.
* | **Note** | ---   Replacing a card with one that changes the total number of interfaces, or removing interfaces that were referred to by other objects, can result in unexpected problems. If you need to make this kind of change, please first remove all references to the interfaces you will remove, such as security zone membership, VPN connections, and so forth. We also suggest you do a backup prior to making the change.   --- |
  | --- | --- |

#### Interfaces on Virtual FDM-Managed Devices

* You cannot add or remove interfaces without reinitializing a virtual FDM-managed device. You must execute these actions in an FDM-managed device.

  | **Note** | ---   If you replace interfaces with ones that have different speed/duplex capabilities, reboot the device so that the system recognizes the new speed/duplex values with the following procedure: from the device's CLI console, enter the reboot command. Then, in Security Cloud Control, edit each interface that had capability changes and select valid speed and duplex options, as the system does not automatically correct your original settings. Deploy your changes right away to ensure correct system behavior.   --- |
  | --- | --- |

* [Maximum Number of VLAN Members by Device Model](#Maximum_Number_of_VLAN_Members_by_Device_Model)

#### Maximum Number of VLAN Members by Device Model

The device model limits the maximum number of VLAN subinterfaces that you can configure. Note that you can configure subinterfaces
on data interfaces only, you cannot configure them on the management interface. The following table explains the limits for
each device model.

| Model | Maximum VLAN Subinterfaces |
| --- | --- |
| Firepower 1010 | 60 |
| Firepower 1120 | 512 |
| Firepower 1140, Firepower 1150 | 1024 |
| Firepower 2100 | 1024 |
| Secure Firewall 3100 | 1024 |
| Firepower 4100 | 1024 |
| Firepower 9300 | 1024 |
| ASA 5508-X | 50 |
| ASA 5515-X | 100 |
| ASA 5516-X | 100 |
| ASA 5525-X | 200 |
| ASA 5545-X | 300 |
| ASA 5555-X | 500 |
| ISA 3000 | 100 |

### Firepower Data Interfaces

Security Cloud Control supports configuring routed interfaces and bridge virtual interfaces on FDM-managed devices.

#### Routed Interfaces

Each Layer 3 routed interface (or subinterface) requires an IP address on a unique subnet. You would typically attach these
interfaces to switches, a port on another router, or to an ISP/WAN gateway.

You can assign a static address, or you can obtain one from a DHCP server. However, if the DHCP server provides an address
on the same subnet as a statically-defined interface on the device, the system will disable the DHCP interface. If an interface
that uses DHCP to get an address stops passing traffic, check whether the address overlaps the subnet for another interface
on the device.

You can configure both IPv6 and IPv4 addresses on a routed interface. Make sure you configure a default route for both IPv4
and IPv6. This task will need to be performed on the FDM-managed device using Firepower Device Manager. See "[Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version x.x.x](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)", **The Basics > Routing** for information about configuring a default route.

#### Bridge Groups and Bridge Virtual Interfaces

A bridge group is a group of interfaces that the FDM-managed device bridges instead of routes. Bridged interfaces belong to a bridge group, and all interfaces are on the same network.
The bridge group is represented by a Bridge Virtual Interface (BVI) that has an IP address on the bridge network. Interfaces
included in the bridge group are called "members."

You can route between routed interfaces and BVIs, if you name the BVI. In this case, the BVI acts as the gateway between member
interfaces and routed interfaces. If you do not name the BVI, traffic on the bridge group member interfaces cannot leave the
bridge group. Normally, you would name the interface so that you can route member interfaces to the Internet.

FDM-managed devices only support one bridge group, therefore, Security Cloud Control can only manage that one bridge group and cannot create additional bridge groups on the device. Security Cloud Control can only manage BVIs on FDM-managed devices installed directly on hardware, not on virtual FDM-managed device instances.

One use for a bridge group in routed mode is to use extra interfaces on the FDM-managed device instead of an external switch. You can attach endpoints directly to bridge group member interfaces. You can also attach
switches to add more endpoints to the same network as the BVI.

#### Passive Interfaces

Passive interfaces monitor traffic flowing across a network using a switch SPAN (Switched Port Analyzer) or mirror port. The
SPAN or mirror port allows for traffic to be copied from other ports on the switch. This function provides the system visibility
within the network without being in the flow of network traffic. When configured in a passive deployment, the system cannot
take certain actions such as blocking or shaping traffic. Passive interfaces receive all traffic unconditionally and no traffic
received on these interfaces is retransmitted.

At this time, Security Cloud Control has limited support for managing passive interfaces on the FDM-managed device:

* Passive interfaces must be configured on the FDM-managed device.
* Routed interfaces cannot be changed to passive interfaces and passives interfaces cannot be changed to routed interfaces using
  Security Cloud Control.
* Security Cloud Control does not identify passive interfaces in the interface table.

**Related Information:**

* [IPv6 Addressing for Firepower Interfaces](#IPv6_Addressing_for_Firepower_Interfaces)
* [Guidelines and Limitations for Firepower Interface Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration)
* [Configure a Physical Interface](#Configure_a_Physical_Firepower_Interface)

### Management/Diagnostic Interface

The physical port labeled Management (or for FDM-managed device virtual, the Management 0/0 virtual interface) actually has two separate interfaces associated with it.

* Management virtual interface-This IP address is used for system communication. This is the address the system uses for Smart Licensing and to retrieve
  database updates. You can open management sessions to it (Firepower Device Manager and CLI). You must configure a management
  address, which is defined on System Settings > Management Interface.
* Diagnostic physical interface-The physical Management port is actually named Diagnostic. You can use this interface to send syslog messages to an external
  syslog server. Configuring an IP address for the Diagnostic physical interface is optional. The only reason to configure the
  interface is if you want to use it for syslog. This interface appears, and is configurable, on the **Security Devices** > Interfaces page. The Diagnostic physical interface only allows management traffic, and does not allow through traffic.

(Hardware devices.) The recommended way to configure Management/Diagnostic is to not wire the physical port to a network.
Instead, configure the Management IP address only, and configure it to use the data interfaces as the gateway for obtaining
updates from the Internet. Then, open the inside interfaces to HTTPS/SSH traffic (by default, HTTPS is enabled) and open Firepower
Device Manager using the inside IP address. This task you must perform on Firepower Device Manager directly. See "Configuring
the Management Access List" in the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for instructions.

For FDM-managed device virtual, the recommended configuration is to attach Management0/0 to the same network as the inside interface, and
use the inside interface as the gateway. Do not configure a separate address for Diagnostic.

| **Note** | ---   **For special instructions on how to edit the Management interface see** [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for Firepower version 6.4 or higher. Open the guide and navigate to The Basic > Interfaces  > Management/Diagnostic Interface. Management interface configuration should be done on the Firepower Device Manager.   --- |
| --- | --- |

### Interface Settings

Use these topics to configure interface settings.

* [Use of Security Zones in Firepower Interface Settings](#Use_of_Security_Zones_in_Firepower_Interface_Settings)
* [Assign an FDM-Managed Device Interface to a Security Zone](#Assignan_FTD_Interface_to_a_Security_Zone)
* [Use of Auto-MDI/MDX in Firepower Interface Settings](#Use_of_AutoMDIMDX_in_Firepower_Interface_Settings)
* [Use of MAC Addresses in Firepower Interface Settings](#Use_of_MAC_Addresses_in_Firepower_Interface_Settings)
* [Use of MTU Settings in Firepower Interface Settings](#Use_of_MTU_Settings_in_Firepower_Interface_Settings)

#### Use of Security Zones in Firepower Interface Settings

Each interface can be assigned to a single security zone. You then apply your security policy based on zones. For example,
you can assign the inside interface to the inside zone; and the outside interface to the outside zone. You can configure your
access control policy to enable traffic to go from inside to outside, but not from outside to inside, for example.

Each zone has a mode, either routed or passive. This relates directly to the interface mode. You can add routed and passive
interfaces only to the same mode security zone.

Bridge Virtual Interfaces (BVIs) are not added to security zones. Only member interfaces are added to security zones.

You do not include the Diagnostic or Management interface in a zone. Zones apply to data interfaces only.

Security Cloud Control does not currently support the management, monitoring, or use of Virtual Tunnel Interface (VTI) tunnels on ASA or FDM-managed devices. Devices with configured VTI tunnels can be onboarded to Security Cloud Control but it ignores VTI interfaces. If a security zone or static route references a VTI, Security Cloud Control reads the security zone and static route without the VTI reference. Security Cloud Control support for VTI tunnels is coming soon.

See [Security Zone Object](#Security_Zone_Object) for more information about security zones.

#### Assign an FDM-Managed Device Interface to a Security Zone

##### Before you Begin

An interface has the following limitations when adding a security zone:

* The interface must have a name.
* The interface cannot be management-only. This option is enabled and disabled from the Advanced tab of the interface.
* You cannot assign a security zone to a bridge group interface.
* You cannot assign a security zone to an interface configured for switchport mode.
* Security Cloud Control does not currently support the management, monitoring, or use of Virtual Tunnel Interface (VTI) tunnels on ASA or FDM-managed devices. Devices with configured VTI tunnels can be onboarded to Security Cloud Control but it ignores VTI interfaces. If a security zone or static route references a VTI, Security Cloud Control reads the security zone and static route without the VTI reference. Security Cloud Control support for VTI tunnels is coming soon.

* [Assign a Firepower Interface to a Security Zone](#Assigna_FirepowerInterface_to_a_Security_Zone)

##### Assign a Firepower Interface to a Security Zone

Use the following procedure to associate a security zone to an existing
interface:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD device and select the FDM-managed device you want to modify. |
| **Step 4** | In the Management pane located to the right, click Interfaces. |
| **Step 5** | Select the interface you want to add a security zone to and click  Edit. |
| **Step 6** | Use the Security Zone drop-down menu and select the security zone you want associated with this interface.   | **Note** | If need to, ceate a new security zone from this drop-down menu by clicking Create New. | | --- | --- | |
| **Step 7** | Click Save. |
| **Step 8** | [Deploy Configuration Changes from Security Cloud Control to FDM-Managed Device](#Deploy_Configuration_Changes_from_CDO_to_FTD). |

---

**Related Information:**

* [Security Zone Object](#Security_Zone_Object)
* [Create or Edit a Firepower Security Zone Object](#Create_or_Edit_a_Firepower_Security_Zone_Object)
* [Guidelines and Limitations for Firepower Interface Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration)

#### Use of Auto-MDI/MDX in Firepower Interface Settings

For RJ-45 interfaces, the default auto-negotiation setting also includes the Auto-MDI/MDIX feature. Auto-MDI/MDIX eliminates
the need for crossover cabling by performing an internal crossover when a straight cable is detected during the auto-negotiation
phase. Either the speed or duplex must be set to auto-negotiate to enable Auto-MDI/MDIX for the interface. If you explicitly
set both the speed and duplex to a fixed value, thus disabling auto-negotiation for both settings, then Auto-MDI/MDIX is also
disabled. For Gigabit Ethernet, when the speed and duplex are set to 1000 and full, then the interface always auto-negotiates;
therefore Auto-MDI/MDIX is always enabled and you cannot disable it.

These settings are configured on the Advanced tab when editing an interface.

#### Use of MAC Addresses in Firepower Interface Settings

You can manually configure Media Access Control (MAC) addresses to override the default value.

For a high availability configuration, you can configure both the active and standby MAC address for an interface. If the
active unit fails over and the standby unit becomes active, the new active unit starts using the active MAC addresses to minimize
network disruption.

Active and standby MAC addresses are configured on the Advanced tab when configuring an interface.

##### Default MAC Addresses

Default MAC address assignments depend on the type of interface.

* Physical interfaces - The physical interface uses the burned-in MAC address.
* Subinterfaces - All subinterfaces of a physical interface use the same burned-in MAC address. You might want to assign unique MAC addresses
  to subinterfaces. For example, your service provider might perform access control based on the MAC address. Also, because
  IPv6 link-local addresses are generated based on the MAC address, assigning unique MAC addresses to subinterfaces allows for
  unique IPv6 link-local addresses.

#### Use of MTU Settings in Firepower Interface Settings

##### About the MTU

The MTU specifies the maximum frame payload size that the FDM-managed device can transmit on a given Ethernet interface. The MTU value is the frame size without Ethernet headers, VLAN tagging,
or other overhead. For example, when you set the MTU to 1500, the expected frame size is 1518 bytes including the headers,
or 1522 when using VLAN. Do not set the MTU value higher to accommodate these headers.

##### Path MTU Discovery

The FDM-managed device supports Path MTU Discovery (as defined in RFC 1191), which lets all devices in a network path between two hosts coordinate
the MTU so they can standardize on the lowest MTU in the path.

##### MTU and Fragmentation

For IPv4, if an outgoing IP packet is larger than the specified MTU, it is fragmented into 2 or more frames. Fragments are
reassembled at the destination (and sometimes at intermediate hops), and fragmentation can cause performance degradation.
For IPv6, packets are typically not allowed to be fragmented at all. Therefore, your IP packets should fit within the MTU
size to avoid fragmentation.

For UDP or ICMP, the application should take the MTU into account to avoid fragmentation.

| **Note** | ---   The FDM-managed device can receive frames larger than the configured MTU as long as there is room in memory.   --- |
| --- | --- |

##### MTU and Jumbo Frames

A larger MTU lets you send larger packets. Larger packets might be more efficient for your network. See the following guidelines:

* Matching MTUs on the traffic path: We recommend that you set the MTU on all
  FDM-managed device interfaces and other device interfaces along the traffic path to
  be the same. Matching MTUs prevents intermediate devices from fragmenting
  the packets.
* Accommodating jumbo frames: A jumbo frame is an Ethernet packet larger than
  the standard maximum of 1522 bytes (including Layer 2 header and VLAN
  header), up to 9216 bytes. You can set the MTU up to 9198 bytes to
  accommodate jumbo frames. The maximum is 9000 for FDM-managed virtual.

  | **Note** | ---   Increasing the MTU assigns more memory for jumbo frames, which might limit the maximum usage of other features, such as access rules. If you increase the MTU above the default 1500 on ASA 5500-X series devices or FDM-managed virtual, you must reboot the system. You do not need to reboot Firepower 2100 series devices, where jumbo frame support is always enabled.  Jumbo frame support is enabled by default on Firepower 3100 devices.   --- |
  | --- | --- |

### IPv6 Addressing for Firepower Interfaces

You can configure two types of unicast IPv6 addresses for Firepower physical interfaces.

* Global—The global address is a public address that you can use on the public network. For a bridge group, you configure the global
  address on the Bridge Virtual Interface (BVI), not on each member interface. You cannot specify any of the following as a
  global address.

  + Internally reserved IPv6 addresses: fd00::/56 (from=fd00:: to= fd00:0000:0000:00ff:ffff:ffff:ffff:ffff)
  + An unspecified address, such as ::/128
  + The loopback address, ::1/128
  + Multicast addresses, ff00::/8
  + Link-local addresses, fe80::/10
* Link-local—The link-local address is a private address that you can only use on the directly-connected network. Routers do not forward
  packets using link-local addresses; they are only for communication on a particular physical network segment. They can be
  used for address configuration or for the Network Discovery functions such as address resolution and neighbor discovery. Each
  interface must have its own address because the link-local address is only available on a segment, and is tied to the interface
  MAC address.

At a minimum, you need to configure a link-local address for IPv6 to operate. If you configure a global address, a link-local
address is automatically configured on the interface, so you do not also need to specifically configure a link-local address.
If you do not configure a global address, then you need to configure the link-local address, either automatically or manually.

### Configuring Firepower Interfaces

When you attach a cable to an interface connection (physically or virtually), you need to configure the interface. At minimum,
you need to name the interface and enable it for traffic to pass through it. If the interface is a member of a bridge group,
naming the interface is sufficient. If the interface is a bridge virtual interface (BVI), you need to assign the BVI an IP
address. If you intend to create VLAN subinterfaces rather than a single physical interface on a given port, you would typically
configure the IP addresses on the subinterface, not on the physical interface. VLAN subinterfaces let you divide a physical
interface into multiple logical interfaces that are tagged with different VLAN IDs.

The interface list shows the available interfaces, their names, addresses, and states. You can
change the state of an interface, on or off, or edit an interface, by selecting the
interface row and clicking Edit in the Actions pane. The list
shows the interface characteristics based on your configuration. Expand an interface row
to see subinterfaces or bridge group member.

* [Configure a Physical Firepower Interface](#Configure_a_Physical_Firepower_Interface)
* [Configure Firepower VLAN Subinterfaces and 802.1Q Trunking](#Configure_Firepower_VLAN_Subinterfaces_and_821Q_Trunking)
* [Configure Advanced Firepower Interface Options](#Procedure)
* [Configure a Bridge Group](#Configure_a_Bridge_Group)
* [Add an EtherChannel Interface for an FDM-Managed Device](#Add_an_EtherChannel_Interface_for_Firepower_Threat_Defense)
* [Edit Or Remove an EtherChannel Interface for FDM-Managed Device](#Edit_Or_Remove_an_EtherChannel_Interface_for_FTD)
* [Add a Subinterface to an EtherChannel Interface](#Add_a_Subinterface_to_an_EtherChannel_Interface)
* [Edit or Remove a Subinterface from an EtherChannel](#Edit_or_Remove_a_Subinterface_from_an_EtherChannel)
* [Add Interfaces to a Virtual FDM-Managed Device](#Add_Interfaces_to_a_Virtual_FTD)
* [Switch Port Mode Interfaces for an FDM-Managed Device](#Switch_Port_Mode_Interfaces_for_an_FTD)
* [Configure an FDM-Managed Device VLAN](#Configure_a_VLANInterface)
* [Configure an FDM-Managed Device VLAN for Switch Port Mode](#Configure_an_FTD_VLAN_for_Switch_Port_Mode)

**Related Information:**

* [Interfaces](#Interfaces)
* [Configure a Physical Firepower Interface](#Configure_a_Physical_Firepower_Interface)
* [Configure Advanced Firepower Interface Options](#Procedure)
* [Configure Firepower VLAN Subinterfaces and 802.1Q Trunking](#Configure_Firepower_VLAN_Subinterfaces_and_821Q_Trunking)
* [Configure a Switch Port Mode Interface for Firepower Threat Defense](#Configure_an_FTD_VLAN_for_Switch_Port_Mode)

#### Configure a Physical Firepower Interface

At a minimum, you must enable a physical interface to use it. You would also typically name it and configure IP addressing;
however, you would not configure IP addressing if you intend to create VLAN subinterfaces, if you are configuring a passive
mode interface, or if you intend to add the interface to a bridge group.

| **Note** | ---   You cannot configure IP addresses on bridge group member interfaces or passive interfaces, although you can modify advanced settings, that are not related to IPv6 addressing.   --- |
| --- | --- |

You can disable an interface to temporarily prevent transmission on the connected network. You do not need to remove the interface's
configuration. At this time, Security Cloud Control can only configure routed interfaces and bridge groups. Security Cloud Control lists passive interfaces but you cannot reconfigure them as active interfaces from Security Cloud Control.

| **Note** | ---   **Note**: Security Cloud Control does not support Point-to-Point Protocol over Ethernet (PPPoE) configurations for IPv4. Configuring this option in an FDM-managed devicemay cause isses in the Security Cloud Control UI; if you **must** configure PPPoE for your device, you must make the appropriate changes in an FDM-managed device.   --- |
| --- | --- |

* [Procedure](#Procedure)
* [Configure IPv4 Addressing for the Physical Interface](#Configure_IPv4Addressing_for_the_Physical_Interface)
* [Configure IPv6 Addressing for the Physical Interface](#Configure_IPv6_Addressing_for_the_Physical_Interface)
* [Enable the Physical Interface](#Enable_the_Physical_Interface)

##### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices and click the device whose interfaces you want to configure and click Interfaces in the Management pane on the right. |
| --- | --- |
| **Step 2** | On the Interfaces page, select the physical interface you want to configure. |
| **Step 3** | In the Actions pane on the right, click Edit. |
| **Step 4** | Give the physical interface a Logical Name and, optionally, a Description. Unless you configure subinterfaces, the interface should have a name.   | **Note** | If you change the name, the change is automatically reflected everywhere you used the old name, including security zones, syslog server objects, and DHCP server definitions. However, you cannot remove the name until you first remove all configurations that use the name, because you typically cannot use an unnamed interface for any policy or setting. | | --- | --- | |
| **Step 5** | Pick one of these options:   * If you intend to add sub-interfaces:   If you intend to configure subinterfaces for this physical interface, you are probably done. Click Save and continue with [Configure Firepower VLAN Subinterfaces and 802.1Q Trunking](#Configure_Firepower_VLAN_Subinterfaces_and_821Q_Trunking) ; otherwise, continue.   | **Note** | Even when configuring subinterfaces, it is valid to name the interface and supply IP addresses. This is not the typical setup, but if you know that is what you need, you can configure it. | | --- | --- |   * If you do not intend to add a sub-interface, continue with either or both, [Configure IPv4 Addressing for the Physical Interface](#Configure_IPv4Addressing_for_the_Physical_Interface) and [Configure IPv6 Addressing for the Physical Interface](#Configure_IPv6_Addressing_for_the_Physical_Interface). |

---

##### Configure IPv4 Addressing for the Physical Interface

| **Warning** | ---   After you configure and save a DHCP address pool, the DHCP address pool is bound to the interface's configured IP address(es). If you edit the interface's subnet mask after you configure a DHCP address pool, deployments to the FDM-managed device fail. Also, if you edit the DHCP address pool in the FDM-managed console and read the configuration from an FDM-managed device to Security Cloud Control, the read fails.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the "Editing Physical Interface" dialog, click the IPv4 Address tab. |
| --- | --- |
| **Step 2** | Select one of the following options from the Type field:   * Static-Choose this option if you want to assign an address that should not change. ​Enter in the interface's IP address and the   subnet mask for the network attached to the interface. For example, if you attach the 10.100.10.0/24 network, you could enter   10.100.10.1/24. Ensure that the address you enter is not the network ID or the broadcast address for the network and the address   is not already used on the network.    + Standby IP Address and Subnet Mask - If you configured high availability, and you are monitoring this interface for HA, also configure a standby IP address on     the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address,     the active unit cannot monitor the standby interface using network tests; it can only track the link state.   + (Optional) DHCP Address Pool - Enter a a single DHCP Server IP address, or an IP address range. The range of IP addresses must be on the same subnet as     the selected interface and cannot include: the IP address of the interface itself, the broadcast address, or the subnet network     address. Specify the start and end address for the pool, separated by a hyphen. To temporarily disable this DHCP server, edit     the server in the DHCP Servers section of the [Firepower Threat Defense Device Settings](#Configure_DHCP_Servers) page. * Dynamic (DHCP)-Choose this option if the address should be obtained from the DHCP server on the network. Change the following options if   necessary:    + Obtain Default Route-Whether to get the default route from the DHCP server. You would normally check this option.   + DHCP Route Metric-If you obtain the default route from the DHCP server, enter the administrative distance to the learned route, between 1 and     255.           | **Note** | If there is a DHCP server configured for the interface, you are shown the configuration. You can edit or delete the DHCP address pool. If you change the interface IP address to a different subnet, you must either delete the DHCP server, or configure an address pool on the new subnet, before you can save the interface changes. |     | --- | --- | |
| **Step 3** | Click Save if you are done or continue with one of these procedures:   * [Configure IPv6 Addressing for the Physical Interface](#Configure_IPv6_Addressing_for_the_Physical_Interface) if you intend to assign an IPv6 address to this interface as well as an IPv4 address. * [Configure Advanced Firepower Interface Options](#Procedure). The advanced settings have defaults that are appropriate for most networks. Edit them only if you are resolving network   issues. * If you saved the interface, and you don't want to continue advanced interface options, continue to [Enable the Physical Interface](#Enable_the_Physical_Interface). |

---

##### Configure IPv6 Addressing for the Physical Interface

###### Procedure

---

| **Step 1** | In the "Editing Physical Interface" dialog, click the IPv6 Address tab. |
| --- | --- |
| **Step 2** | State-To enable IPv6 processing and to automatically configure the link-local address when you do not configure the global address, click the State slider to enable it. The link-local address is generated based on the interface MAC addresses (Modified EUI-64 format).   | **Note** | Disabling IPv6 does not disable IPv6 processing on an interface that is configured with an explicit IPv6 address or that is enabled for auto configuration. | | --- | --- | |
| **Step 3** | Address Auto Configuration-Check this option to have the address automatically configured. IPv6 stateless autoconfiguration will generate a global IPv6 address only if the link on which the device resides has a router configured to provide IPv6 services, including the advertisement of an IPv6 global prefix for use on the link. If IPv6 routing services are not available on the link, you will get a link-local IPv6 address only, which you cannot access outside of the device's immediate network link. The link local address is based on the Modified EUI-64 interface ID.  Although RFC 4862 specifies that hosts configured for stateless autoconfiguration do not send Router Advertisement messages, the FDM-managed device does send Router Advertisement messages in this case. Select Suppress RA to suppress messages and conform to the RFC. |
| **Step 4** | Suppress RA-Check this box if you want to suppress router advertisements. The Firepower Threat Defense device can participate in router advertisements so that neighboring devices can dynamically learn a default router address. By default, router advertisement messages (ICMPv6 Type 134) are periodically sent out each IPv6 configured interface.  Router advertisements are also sent in response to router solicitation messages (ICMPv6 Type 133). Router solicitation messages are sent by hosts at system startup so that the host can immediately autoconfigure without needing to wait for the next scheduled router advertisement message.  You might want to suppress these messages on any interface for which you do not want the Firepower Threat Defense device to supply the IPv6 prefix (for example, the outside interface). |
| **Step 5** | Link-Local Address-If you want to use the address as link local only, enter it in the Link-Local Address field. Link local addresses are not accessible outside the local network. You cannot configure a link-local address on a bridge group interface.   | **Note** | A link-local address should start with FE8, FE9, FEA, or FEB, for example fe80::20d:88ff:feee:6a82. Note that we recommend automatically assigning the link-local address based on the Modified EUI-64 format. For example, if other devices enforce the use of the Modified EUI-64 format, then a manually-assigned link-local address may cause packets to be dropped. | | --- | --- | |
| **Step 6** | Standby Link-Local Address-Configure this address if the interface connects a high availability pair of devices. Enter the link-local address of the interface on the other FDM-managed device, to which this interfaces is connected. |
| **Step 7** | Static Address/Prefixâ€”If you do not use stateless autoconfiguration, enter the full static global IPv6 address and network prefix. For example, 2001:0DB8::BA98:0:3210/48. For more information on IPv6 addressing, see [IPv6 Addressing for Firepower Interfaces](#IPv6_Addressing_for_Firepower_Interfaces). |
| **Step 8** | Standby IP Address-If you configure high availability, and you are monitoring this interface for HA, also configure a standby IPv6 address on the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address, the active unit cannot monitor the standby interface using network tests; it can only track the link state. |
| **Step 9** | Click Save if you are done or continue with one of these procedures:   * [Configure Advanced Firepower Interface Options](#Procedure). The advanced settings have defaults that are appropriate for most networks. Edit them only if you are resolving network   issues. * If you saved the interface, and you don't want to continue advanced interface options, continue to [Enable the Physical Interface](#Enable_the_Physical_Interface). |

---

##### Enable the Physical Interface

###### Procedure

---

| **Step 1** | Select the interface you want to enable. |
| --- | --- |
| **Step 2** | Slide the State slider at the top right of the window, associated with the interface's logical name to blue. |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Configure Firepower VLAN Subinterfaces and 802.1Q Trunking

VLAN subinterfaces let you divide a physical interface into multiple logical interfaces that are tagged with different VLAN
IDs. An interface with one or more VLAN subinterfaces is automatically configured as an 802.1Q trunk. Because VLANs allow
you to keep traffic separate on a given physical interface, you can increase the number of interfaces available to your network
without adding additional physical interfaces or devices.

Create subinterfaces if you attach the physical interface to a trunk port on a switch. Create a subinterface for each VLAN
that can appear on the switch trunk port. If you attach the physical interface to an access port on the switch, there is no
point in creating a subinterface.

| **Note** | ---   You cannot configure IP addresses on bridge group member interfaces, although you can modify advanced settings as needed.   --- |
| --- | --- |

##### Before You Begin

Prevent untagged packets on the physical interface. If you use subinterfaces, you typically do not also want the physical interface to pass traffic, because the physical interface
passes untagged packets. Because the physical interface must be enabled for the subinterface to pass traffic, ensure that
the physical interface does not pass traffic by not naming the interface. If you want to let the physical interface pass untagged
packets, you can name the interface as usual.

* [Procedure](#Procedure)
* [Configure IPv4 Addressing for the Subinterface](#Configure_IPv4Addressing_for_the_Subinterface)
* [Configure IPv6 Addressing for the Subinterface](#Configure_IPv6_Addressing_for_the_Subinterface)
* [Enable the Physical Interface](#Enable_the_Physical_Interface)

##### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and click the device whose interfaces you want to configure. |
| **Step 4** | Click Interfaces in the Management pane at the right. |
| **Step 5** | On the Interfaces page, select the physical interface you want to configure and in the Actions pane at the right, click + New Subinterface.  Notice that the Parent Interface field shows the name of the physical interface for which you are creating this subinterface. You cannot change the parent interface after you create the subinterface. |
| **Step 6** | Give the subinterface a logical name and, optionally, a description. Without a logical name, the rest of the interface configuration is ignored.   | **Note** | If you change the name, the change is automatically reflected everywhere you used the old name, including security zones, syslog server objects, and DHCP server definitions. However, you cannot remove the name until you first remove all configurations that use the name, because you typically cannot use an unnamed interface for any policy or setting. | | --- | --- | |
| **Step 7** | Configure the VLAN ID and Subinterface ID:   * VLAN ID - Enter a VLAN ID between 1 and 4094 that will be used to tag the packets on this subinterface. * Subinterface ID - Enter the subinterface ID as an integer between 1 and 4294967295. The number of subinterfaces allowed [depends on your platform](#Maximum_Number_of_VLAN_Members_by_Device_Model). You cannot change the subinterace ID after you create the subinterface.   Continue with [Configure IPv4 Addressing for the Subinterface](#Configure_IPv4Addressing_for_the_Subinterface) and [Configure IPv6 Addressing for the Subinterface](#Configure_IPv6_Addressing_for_the_Subinterface). |

---

##### Configure IPv4 Addressing for the Subinterface

###### Procedure

---

| **Step 1** | In the "Adding Subinterface" dialog, click the IPv4 Address tab. |
| --- | --- |
| **Step 2** | Select one of the following options from the Type field:   * Static-Choose this option if you want to assign an address that should not change.  Enter in the interface's IP address and the subnet mask for the network attached to the interface. For example, if you attach the 10.100.10.0/24 network, you could enter 10.100.10.1/24.   Ensure that the address you enter is not the network ID or the broadcast address for the network and the address is not already   used on the network. * Enter a Standby IP Address and Subnet Mask only if this interface is being used in a high availability pair of devices. * Dynamic (DHCP)-Choose this option if the address should be obtained from the DHCP server on the network. Change the following options if   necessary:    + Obtain Default Route-Whether to get the default route from the DHCP server. You would normally check this option.   + DHCP Route Metric-If you obtain the default route from the DHCP server, enter the administrative distance to the learned route, between 1 and     255.  See [Configuring DHCP Server](#Configure_DHCP_Servers).           | **Note** | If there is a DHCP server configured for the interface, you are shown the configuration. You can edit or delete the DHCP address pool. If you change the interface IP address to a different subnet, you must either delete the DHCP server, or configure an address pool on the new subnet, before you can save the interface changes. |     | --- | --- | |
| **Step 3** | Click Create if you are done or continue with one of these procedures:   * Continue to "[Configure IPv6 Addressing for the Physical Interface](#Configure_IPv6_Addressing_for_the_Physical_Interface)" if you want to assign an IPv6 address to this interface as well as an IPv4 address. * [Configure Advanced Firepower Interface Options](#Procedure). The advanced settings have defaults that are appropriate for most networks. Edit them only if you are resolving network   issues. * If you created the subinterface, go to [Enable the Physical Interface](#Enable_the_Physical_Interface). |

---

##### Configure IPv6 Addressing for the Subinterface

###### Procedure

---

| **Step 1** | Click the IPv6 Address tab. |
| --- | --- |
| **Step 2** | Enable IPv6 processing-To enable IPv6 processing and to automatically configure the link-local address when you do not configure the global address, move the State slider to blue. The link-local address is generated based on the interface MAC addresses (Modified EUI-64 format).   | **Note** | Disabling IPv6 does not disable IPv6 processing on an interface that is configured with an explicit IPv6 address or that is enabled for auto configuration. | | --- | --- | |
| **Step 3** | Address Auto Configuration-Check this option to have the address automatically configured. IPv6 stateless auto configuration will generate a global IPv6 address only if the link on which the device resides has a router configured to provide IPv6 services, including the advertisement of an IPv6 global prefix for use on the link. If IPv6 routing services are not available on the link, you will get a link-local IPv6 address only, which you cannot access outside of the device's immediate network link. The link local address is based on the Modified EUI-64 interface ID. |
| **Step 4** | Suppress RA-Check this box if you want to suppress router advertisements. The Firepower Threat Defense device can participate in router advertisements so that neighboring devices can dynamically learn a default router address. By default, router advertisement messages (ICMPv6 Type 134) are periodically sent out each IPv6 configured interface.  Router advertisements are also sent in response to router solicitation messages (ICMPv6 Type 133). Router solicitation messages are sent by hosts at system startup so that the host can immediately autoconfigure without needing to wait for the next scheduled router advertisement message.  You might want to suppress these messages on any interface for which you do not want the Firepower Threat Defense device to supply the IPv6 prefix (for example, the outside interface). |
| **Step 5** | Link-Local Address-If you want to use the address as link local only, enter it in the Link-Local Address field. Link local addresses are not accessible outside the local network.   | **Note** | A link-local address should start with FE8, FE9, FEA, or FEB, for example fe80::20d:88ff:feee:6a82. Note that we recommend automatically assigning the link-local address based on the Modified EUI-64 format. For example, if other devices enforce the use of the Modified EUI-64 format, then a manually-assigned link-local address may cause packets to be dropped. | | --- | --- | |
| **Step 6** | Standby Link-Local Address-Configure this address if your interface connects a high availability pair of devices. |
| **Step 7** | Static Address/Prefix-If you do not use stateless autoconfiguration, enter the full static global IPv6 address and network prefix. For example, 2001:0DB8::BA98:0:3210/48. For more information on IPv6 addressing, see IPv6 Addressing, on page 136. |
| **Step 8** | Standby IP Address-If you configure high availability, and you are monitoring this interface for HA, also configure a standby IPv6 address on the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address, the active unit cannot monitor the standby interface using network tests; it can only track the link state. |
| **Step 9** | Click **Create** if you are done or continue with one of these procedures:   * Click the Advanced tab to [Configure Advanced Firepower Interface Options](#Procedure). The advanced settings have defaults that are appropriate for most networks. Edit them only if you are resolving network   issues. * If you created the subinterface, go to [Enable the Physical Interface](#Enable_the_Physical_Interface). |

---

##### Enable the Physical Interface

###### Procedure

---

| **Step 1** | To enable the subinterface, slide the State slider, associated with the subinterface's logical name to blue. |
| --- | --- |
| **Step 2** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Configure Advanced Firepower Interface Options

Advanced interface options have default settings that are appropriate for most
networks. Configure them only if you are resolving networking problems.

The following procedure assumes the interface is already defined. You can also edit
these settings while initially editing or creating the interface.

This procedure and all of the steps in it are optional.

**Limitations:**

* You cannot set MTU, duplex, or speed for the Management interface on a
  Firepower 2100 series device.
* The MTU of an unnamed interface **must** be set to 1500 bytes.

##### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and click the device whose interfaces you want to configure. |
| **Step 4** | Click Interfaces in the Management pane at the right. |
| **Step 5** | On the Interfaces page, select the physical interface you want to configure and in the Actions pane at the right, click Edit. |
| **Step 6** | Click the Advanced tab. |
| **Step 7** | Enable for HA Monitoring is automatically enabled. When this is enabled, the device includes the health of the interface as a factor when the HA pair decides whether to fail over to the peer unit in a high availability configuration. This option is ignored if you do not configure high availability. It is also ignored if you do not configure a name for the interface. |
| **Step 8** | To make a data interface management only, check Management Only.  A management only interface does not allow through traffic, so there is very little value in setting a data interface as a management only interface. You cannot change this setting for the Management/Diagnostic interface, which is always management only. |
| **Step 9** | Modify the IPv6 DHCP configuration settings.   * Enable DHCP for IPv6 address configuration - Whether to set the Managed Address Configuration flag in the IPv6 router advertisement packet. This flag informs IPv6 autoconfiguration   clients that they should use DHCPv6 to obtain addresses, in addition to the derived stateless autoconfiguration address. * Enable DHCP for IPv6 non-address configuration - Whether to set the Other Address Configuration flag in the IPv6 router advertisement packet. This flag informs IPv6 autoconfiguration   clients that they should use DHCPv6 to obtain additional information from DHCPv6, such as the DNS server address. |
| **Step 10** | Configure DAD Attempts - How often the interface performs Duplicate Address Detection (DAD), from 0 - 600. The default is 1. During the stateless auto configuration process, DAD verifies the uniqueness of new unicast IPv6 addresses before the addresses are assigned to interfaces. If the duplicate address is the link-local address of the interface, the processing of IPv6 packets is disabled on the interface. If the duplicate address is a global address, the address is not used. The interface uses neighbor solicitation messages to perform Duplicate Address Detection. Set the value to 0 to disable duplicate address detection (DAD) processing. |
| **Step 11** | Change the MTU (maximum transmission unit) to the desired value.  The default MTU is 1500 bytes. You can specify a value from 64 - 9198 (or 9000, for Firepower Threat Defense Virtual). Set a high value if you typically see jumbo frames on your network. See [MTU Settings in Interfaces](#Use_of_MTU_Settings_in_Firepower_Interface_Settings) for more information.   | **Note** | If you increase MTU above 1500 on ASA 5500-X series devices, ISA 3000 series devices, or Firepower Threat Defense Virtual, you must reboot the device. Log into the CLI and use the reboot command. You do not need to reboot the Firepower 2100 or Secure Firewall 3100 series devices, where jumbo frame support is always enabled. | | --- | --- | |
| **Step 12** | (Physical interface only.) Modify the speed and duplex settings.  The default is that the interface negotiates the best duplex and speed with the interface at the other end of the wire, but you can force a specific duplex or speed if necessary. The options listed are only those supported by the interface. Before setting these options for interfaces on a network module, please read [Limitations for Interface Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration).   * Duplex- Choose Auto , Half , Full , or   Default . Auto is the default when the interface supports it. For   example, you cannot select Auto for the SFP interfaces on a Firepower 2100 or Secure Firewall 3100 series device. Select Default to indicate that Firepower Device   Manager should not attempt to configure the setting.  Any existing configuration is left unchanged. * Speed- Choose Auto to have the interface negotiate the speed (this is the default), or pick a specific speed: 10 , 100 , 1000 ,   10000 Mbps. You can also select these special options:  Any existing configuration is left unchanged.  The type of interface limits the options you can select. For example, the SFP+ interfaces on a Firepower 2100 series device   support 1000 (1 Gbps) and 10000 (10 Gpbs) only, and the SFP interfaces support 1000 (1 Gbps) only, whereas GigabitEthernet   ports do not support 10000 (10 Gpbs). SPF interfaces on other devices might require No Negotiate . Consult the hardware documentation   for information on what the interfaces support. |
| **Step 13** | (Optional, recommended for subinterfaces and high availability units.) Configure the MAC address.  MAC Address-The Media Access Control in H.H.H format, where H is a 16-bit hexadecimal digit. For example, you would enter the MAC address 00-0C-F1-42-4C-DE as 000C.F142.4CDE. The MAC address must not have the multicast bit set, that is, the second hexadecimal digit from the left cannot be an odd number.)  Standby MAC Address-For use with high availability. If the active unit fails over and the standby unit becomes active, the new active unit starts using the active MAC addresses to minimize network disruption, while the old active unit uses the standby address. |
| **Step 14** | Click Create. |

---

#### Configure a Bridge Group

A bridge group is a virtual interface that groups one or more interfaces. The main reason to group interfaces is to create
a group of switched interfaces. Thus, you can attach workstations or other endpoint devices directly to the interfaces included
in the bridge group. You do not need to connect them through a separate physical switch, although you can also attach a switch
to a bridge group member.

The group members do not have IP addresses. Instead, all member interfaces share the IP address of the Bridge Virtual Interface
(BVI). If you enable IPv6 on the BVI, member interfaces are automatically assigned unique link-local addresses.

You typically configure a DHCP server on the bridge group interface (BVI), which provides IP addresses for any endpoints connected
through member interfaces. However, you can configure static addresses on the endpoints connected to the member interfaces
if you prefer. All endpoints within the bridge group must have IP addresses on the same subnet as the bridge group IP address.

| **Note** | ---   For ISA 3000, the device comes pre-configured with bridge group BVI, named inside, which includes all data interfaces except for the outside interface. Thus, the device is pre-configured with one port used for linking to the Internet or other upstream network, and all other ports enabled and available for direct connections to endpoints. If you want to use an inside interface for a new subnet, you must first remove the needed interfaces from BVI.   --- |
| --- | --- |

FDM-managed devices only support one bridge group; therefore, Security Cloud Control can only manage that one bridge group and cannot create additional bridge groups on the device.

After you create a bridge group on Security Cloud Control, you will not know the bridge group ID until after the configuration is deployed to the FDM-managed device. FDM-managed device assigns the bridge group ID, for example, BVI1. If the interface is deleted and a new bridge group is created, the
new bridge group receives an incremented number, for example, BVI2.

##### Before you Begin

Configure the interfaces that will be ***members*** of the bridge group. Specifically, each ***member*** interface must meet the following requirements:

* The interface must have a name.
* The interface cannot be configured as **management-only**.
* The interface cannot be configured for passive mode.
* The interface cannot be an EtherChannel interface or an EtherChannel subinterface.
* The interface cannot have any IPv4 or IPv6 addresses defined for it, either static or served through DHCP. If you need to
  remove the address from an interface that you are currently using, you might also need to remove other configurations for
  the interface, such as static routes, DHCP server, or NAT rules, that depend on the interface having an address. If you try
  to add an interface with an IP address to a bridge group, Security Cloud Control will warn you. If you continue to add the interface to the bridge group, Security Cloud Control will remove the IP address from the interface configuration.
* BVI can have either VLAN interfaces or other routed interfaces as a member interface, but you cannot have both as member interfaces
  on a single BVI.
* The interface cannot be Point-to-Point Protocol over Ethernet (PPPoE)
* The interface cannot be associated with a security zone (if it is in a zone). You must delete any NAT rules for the interface
  before you can add it to a bridge group.
* Enable and disable the member interfaces individually. Thus, you can disable any unused interfaces without needing to remove
  them from the bridge group. The bridge group itself is always enabled.
* Bridge groups do not support clustering.

| **Note** | ---   Bridge groups are not supported on Firepower 2100 devices in routed mode or on VMware with bridged ixgbevf interfaces.   --- |
| --- | --- |

* [Configure the Name of the Bridge Group Interface and Select the Bridge Group Members](#Configure_the_Name_of_the_Bridge_Group_Interface_and_Select_the_Bridge_Group_Members)
* [Configure the IPv4 Address for the BVI](#Configure_the_IPv4Address_for_the_BVI)
* [Configure the IPv6 Address for the BVI](#Configure_the_IPv6Address_for_the_BVI)
* [Configure Advanced Interface Options](#Configure_Advanced_Interface_Options)
* [Bridge Group Compatibility in FDM-Managed Configurations](#Bridge_Group_Compatibility_in_FTD_Configurations)
* [Delete a Bridge Group](#Delete_a_Bridge_Group)

##### Configure the Name of the Bridge Group Interface and Select the Bridge Group Members

In this procedure you give the bridge group interface (BVI) a name and select the interfaces to add to the bridge group:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you want to create a bridge group. |
| **Step 4** | Do one of the following:   * Select the BVI bridge group and click Edit in the Actions pane. * Click the plus button and select Bridge Group Interface.  | **Note** | You can create and configure a single bridge group. If you already have a bridge group defined, you should edit that group instead of trying to create a new one. If you need to create a new bridge group, you must first delete the existing bridge group. | | --- | --- | |
| **Step 5** | Configure the following:   * Logical Name-You must give the bridge group a name. It can be up to 48 characters. Alphabetic characters must be lower case. For example,   inside or outside. Without a name, the rest of the interface configuration is ignored.  | **Note** | If you change the name, the change is automatically reflected everywhere you used the old name, including security zones, syslog server objects, and DHCP server definitions. However, you cannot remove the name until you first remove all configurations that use the name, because you typically cannot use an unnamed interface for any policy or setting. | | --- | --- |   * (Optional) Description-The description can be up to 200 characters on a single line, without carriage returns. |
| **Step 6** | Click the Bridge Group Member tab. A bridge group can have up to 64 interfaces or subinterfaces to a single bridge group.   * Check an interface to add it to the bridge group. * Uncheck an interface you want to remove from the bridge group. |
| **Step 7** | Click Save.  The BVI now has a name and member interfaces. Continue with the following tasks to configure the bridge group interface. You are not performing these tasks for the member interfaces themselves:   * [Configure the IPv4 address information for the bridge group interface](#Configure_the_IPv4Address_for_the_BVI) if you are assigning an IPv4 address to the BVI. * [Configure the IPv6 address information for the bridge group interface](#Configure_the_IPv6Address_for_the_BVI) if you are assigning an IPv6 address to the BVI. * [Configure Advanced Interface Options](#Configure_Advanced_Interface_Options) for the bridge group interface. |

---

##### Configure the IPv4 Address for the BVI

###### Procedure

---

| **Step 1** | Select the device for which you want to create a bridge group. |
| --- | --- |
| **Step 2** | Select the BVI in the list of interfaces and click Edit in the Actions pane. |
| **Step 3** | Click the IPv4 Address tab to configure the IPv4 address. |
| **Step 4** | Select one of the following options from the Type field:   * Static-Choose this option if you want to assign an address that should not change. Type in the bridge group's IP address and the   subnet mask. All attached endpoints will be on this network. For models with a pre-configured bridge group, the default for   the BVI "inside" network is 192.168.1.1/24 (i.e. 255.255.255.0). Ensure that the address is not already used on the network.  If you configured high availability, and you are monitoring this interface for HA, also configure a standby IP address on   the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address,   the active unit cannot monitor the standby interface using network tests; it can only track the link state.       | **Note** | If there is a DHCP server configured for the interface, you are shown the configuration. You can edit or delete the DHCP address pool. If you change the interface IP address to a different subnet, you must either delete the DHCP server, or configure an address pool on the new subnet, before you can save the interface changes. See Configuring DHCP Server. |   | --- | --- | * Dynamic (DHCP)-Choose this option if the address should be obtained from the DHCP server on the network. This is not the typical option   for bridge groups, but you can configure it if needed. You cannot use this option if you configure high availability. Change   the following options if necessary:    + Route Metricâ€”If you obtain the default route from the DHCP server, the administrative distance to the learned route, between     1 and 255. The default is 1.   + Obtain Default Routeâ€”Check this option to get the default route from the DHCP server. You would normally select this option,     which is the default. |
| **Step 5** | Continue with one of the following procedures:   * [Configure the IPv6 Address for the BVI](#Configure_the_IPv6Address_for_the_BVI) if you are assigning an IPv4 address to the BVI. * Configure Advanced Interface Options. * Click Save and deploy the changes to the Firepower device. See [Deploy Configuration Changes from Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD) for more information. |

---

##### Configure the IPv6 Address for the BVI

###### Procedure

---

| **Step 1** | Click the IPv6 Address tab to configure IPv6 addressing for the BVI. |
| --- | --- |
| **Step 2** | Configure these aspects of IPv6 addressing: |
| **Step 3** | Enable IPv6 processing-To enable IPv6 processing and to automatically configure the link-local address when you do not configure the global address, slide the State slider to blue. The link local address is generated based on the interface MAC addresses (Modified EUI-64 format).   | **Note** | Disabling IPv6 does not disable IPv6 processing on an interface that is configured with an explicit IPv6 address or that is enabled for autoconfiguration. | | --- | --- | |
| **Step 4** | Suppress RA-Whether to suppress router advertisements. The Firepower Threat Defense device can participate in router advertisements so that neighboring devices can dynamically learn a default router address. By default, router advertisement messages (ICMPv6 Type 134) are periodically sent out each IPv6 configured interface.  Router advertisements are also sent in response to router solicitation messages (ICMPv6 Type 133). Router solicitation messages are sent by hosts at system startup so that the host can immediately auto-configure without needing to wait for the next scheduled router advertisement message.  You might want to suppress these messages on any interface for which you do not want the FDM-managed device to supply the IPv6 prefix (for example, the outside interface). |
| **Step 5** | Static Address/Prefix-If you do not use stateless auto configuration, enter the full static global IPv6 address and network prefix. For example, 2001:0DB8::BA98:0:3210/48. For more information on IPv6 addressing, see IPv6 Addressing. |
| **Step 6** | Standby IP Address-If you configure high availability, and you are monitoring this interface for HA, also configure a standby IPv6 address on the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address, the active unit cannot monitor the standby interface using network tests; it can only track the link state. |
| **Step 7** | Continue with one of the following procedures:   * Configure Advanced Interface Options. * Click Save and deploy the changes to the Firepower device. See [Deploy Configuration Changes from Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD) for more information. |

---

##### Configure Advanced Interface Options

You configure most advanced options on bridge group *member* interfaces, but some are available for the bridge group interface itself.

###### Procedure

---

| **Step 1** | The advanced settings have defaults that are appropriate for most networks. Edit them only if you are resolving network issues. |
| --- | --- |
| **Step 2** | Click OK. |
| **Step 3** | Click Save and deploy the changes to the Firepower device. See [Deploy Configuration Changes from Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD) for more information. |

---

###### What to do next

* Ensure that all member interfaces that you intend to use are enabled.
* Configure a DHCP server for the bridge group. See [Configure DHCP Server](#Configure_DHCP_Servers).
* Add the member interfaces to the appropriate security zones.
* Ensure that policies, such as identity, NAT, and access, supply the required services for the bridge group and member interfaces.

##### Bridge Group Compatibility in FDM-Managed Configurations

In various configurations, where you can specify an interface, sometimes you will be able to specify a bridge virtual interface
(BVI) and sometimes you will be able to specify a member of the bridge group. This table explains when a BVI can be used and
when a member interface can be used.

| Firepower Threat Defense Configuration Type | BVI can be used | BVI member can be used |
| --- | --- | --- |
| DHCP server | Yes | No |
| DNS Server | Yes | Yes |
| Management access | Yes | No |
| NAT (Network Address Translation) | No | Yes |
| Security Zone | No | Yes |
| Site-to-Site VPN access point | No | Yes |
| Syslog Server | Yes | No |

##### Delete a Bridge Group

When you delete a bridge group, its members become standard routed interfaces, and any NAT rules or security zone membership
are retained. You can edit the interfaces to give them IP addresses. If you need to create a new bridge group, you must first
delete the existing bridge group.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the device from which you want to delete the bridge group. |
| **Step 4** | Select the BVI bridge group and click Remove in the Actions pane. |
| **Step 5** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Add an EtherChannel Interface for an FDM-Managed Device

##### EtherChannel Interface Limitations

An EtherChannel, depending on the device model, can include multiple member
interfaces of the same media type and capacity and must be set to the same speed and
duplex. You cannot mix interface capacities (for example 1GB and 10GB interfaces) by
setting the speed to be lower on the larger-capacity interface. The Link Aggregation
Control Protocol (LACP) aggregates interfaces by exchanging the Link Aggregation
Control Protocol Data Units (LACPDUs) between two network devices.

EtherChannel interfaces have a number of limitations based on physical configuration and software versions. See the sections
below for more information.

##### General Interface Limitations

* EtherChannels are only available on devices running FDM-managed Version 6.5 and later.
* Security Cloud Control supports EtherChannel interface configuration on the following Firepower devices: 1010, 1120, 1140, 1150, 2110, 2120, 2130,
  2140, 3110, 3120, 3130, and 3140. For interface limitations per device model, see [Device-Specific Requirements](#Add_an_EtherChannel_Interface_for_Firepower_Threat_Defense__device_spec_limitation).
* All interfaces in the channel group must be the same media type and capacity, and must be set to the same speed and duplex.
  The media type can be either RJ-45 or SFP; SFPs of different types (copper and fiber) can be mixed. You cannot mix interface
  capacities (for example 1GB and 10GB interfaces) by setting the speed to be lower on the larger-capacity interface.
* The device to which you connect the EtherChannel must also support 802.3ad EtherChannels.
* The FDM-managed device does not support LACPDUs that are VLAN-tagged. If you enable native VLAN tagging on the neighboring switch using the
  Cisco IOS vlan dot1Q tag native command, then the FDM-managed device will drop the tagged LACPDUs. Be sure to disable native VLAN tagging on the neighboring switch.
* All FDM-managed device configuration refers to the logical EtherChannel interface instead of the member physical interfaces.
* Portchannel interfaces are displayed as physical interfaces.

##### Device-Specific Limitations

The following devices have specific interface limitations:

**1000 Series**

* Firepower 1010 supports up to 8 EtherChannel interfaces.
* Firepower 1120,1140,1150 supports up to 12 EtherChannel interfaces.
* 1000 series do not support LACP rate fast; LACP always uses the normal rate. This setting is not configurable.

**2100 Series**

* Firepower 2110 and 2120 models supports up to 12 EtherChannel interfaces.
* Firepower 2130 and 2140 models support up to 16 EtherChannel interfaces.
* 2100 series do not support LACP fast rate; LACP always uses the normal rate.
  This setting is not configurable.

**Secure Firewall 3100 Series**

* All Secure Firewall 3100 models support up to 16 EtherChannel interfaces.
* The Secure Firewall 3100 models support LACP fast rate.
* The Secure Firewall 3100 series models do not support enabling or disabling of network modules and
  breakout online insertion and removal (OIR) of interfaces.

**4100 Series and 9300 Series**

* You cannot create or configure EtherChannels on the 4100 and 9300 series. Etherchannels for these devices must be configured
  in the FXOS chassis.
* Etherchannels on the 4100 and 9300 series appear in Security Cloud Control as physical interfaces.

* [Add an EtherChannel Interface](#Add_an_EtherChannelInterface)

##### Add an EtherChannel Interface

Use the following procedure to add an EtherChannel to your FDM-managed device:

| **Note** | ---   If you want to immediately create another EtherChannel, check the Create another checkbox and then click Create.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Click the Devices tab. |
| --- | --- |
| **Step 2** | Click the FTD tab and select the device you want to add an EtherChannel to. |
| **Step 3** | In the Management pane located to the right, select Interfaces. |
| **Step 4** | Click the blue plus button  and select EtherChannel. |
| **Step 5** | (Optional) Enter a Logical Name. |
| **Step 6** | (Optional) Enter a description. |
| **Step 7** | Enter the EtherChannel ID.  For Firepower 1010 series, enter a value between 1 and 8.  For the Firepower 2100, 3100, 4100, and 9300 series, enter a value between 1 and 48. |
| **Step 8** | Click the drop-down button for Link Aggregation Control Protocol and select one of the two options:   * Active - Sends and receives LACP updates. An active EtherChannel can establish connectivity with either an active or a passive EtherChannel.   You should use the active mode unless you need to minimize the amount of LACP traffic. * On - The EtherChannel is always on, and LACP is not used. An on EtherChannel can only establish a connection with another EtherChannel that is also configured to be on. |
| **Step 9** | Search for and select the interfaces you want to include in the EtherChannel as memebers. You must include at least one interface.  Warning: If you add an EtherChannel interface as a member and it already has an IP address configured, Security Cloud Control removes the IP address of the member. |
| **Step 10** | Click Create. |

---

**Related Information:**

* [Edit or Remove an Etherchannel Interface for FTD](#Edit_Or_Remove_an_EtherChannel_Interface_for_FTD)
* [Add a Subinterface to an EtherChannel Interface](#Add_a_Subinterface_to_an_EtherChannel_Interface)
* [Edit or Remove a Subinterface from an EtherChannel](#Edit_or_Remove_a_Subinterface_from_an_EtherChannel)
* [Guidelines and Limitations for Firepower Interface Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration)
* [Assign a Firepower Interface to a Security Zone](#Assignan_FTD_Interface_to_a_Security_Zone)
* [Add an EtherChannel Interface for an FDM-Managed Device](#Add_an_EtherChannel_Interface_for_Firepower_Threat_Defense)

#### Edit Or Remove an EtherChannel Interface for FDM-Managed Device

Use the following procedures to either modify an existing EtherChannel interface, or remove an EtherChannel interface from
an FDM-managed device.

* [Edit an EtherChannel](#Edit_an_EtherChannel)
* [Remove an EtherChannel Interface](#Remove_an_EtherChannelInterface)

##### Edit an EtherChannel

Note that EtherChannels have several limitations you must be aware of when modifying. See [Guidelines and Limitations for Firepower Configuration](#Guidelines_and_Limitations_for_Firepower_Interface_Configuration__etherChannel) for more information.

| **Note** | ---   EtherChannels must have at least one member.   --- |
| --- | --- |

Use the following procedure to edit an existing EtherChannel:

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the threat defense associated with the Etherchannel you want to modify. |
| **Step 4** | In the Management pane located to the right, click Interfaces. |
| **Step 5** | On the Interfaces page, select the EtherChannel interface you want to edit. In the Actions pane located to the right, click the edit icon  . |
| **Step 6** | Modify any of the following items:   * Logical name. * State. * Description. * Security Zone assignment. * Link Aggregation Control Protocol status. * IP address configuration in either the IPv4, IPv6, or Advanced tabs. * EtherChannel members.  | **Warning** | If you add an EtherChannel interface as a member and it already has an IP address configured, Security Cloud Control removes the IP address of the member. | | --- | --- | |
| **Step 7** | Click Save. |

---

##### Remove an EtherChannel Interface

| **Note** | ---   EtherChannel interfaces associated with a high availability (HA) or any other configuration. You must manually remove the EtherChannel interface from all configurations before deleting it from Security Cloud Control.   --- |
| --- | --- |

Use the following procedure to remove an EtherChannel interface from an FDM-managed device:

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and the threat defense associated with the Etherchannel you want to delete. |
| **Step 4** | In the Management pane located to the right, select Interfaces. |
| **Step 5** | On the Interfaces page, select the EtherChannel interface you want to edit. In the Actions pane located to the right, click Remove. |
| **Step 6** | Confirm you want to delete the EtherChannel interface and click OK. |

---

#### Add a Subinterface to an EtherChannel Interface

##### EtherChannel Subinterfaces

The **Interfaces** page allows you to view which interfaces of a device have subinterfaces by expanding each interface. This expanded view also
shows you the unique logical name, enabled/disabled state, any associated security zones, and mode of the subinterface. The
interface type and mode of the subinterface is determined by the parent interface.

##### General Limitations

Security Cloud Control does not support subinterfaces for the following interface types:

* Interface configured for management-only.
* Interface configured for switch port mode.
* Passive interfaces.
* VLAN interfaces.
* Bridge virtual interfaces (BVI).
* Interfaces that are already a member of another EtherChannel interface.

You **can** create subinterfaces for the following:

* Bridge group members.
* EtherChannel interfaces.
* Physical interfaces.

* [Add a Subinterface to an EtherChannel Interface](#Add_a_Subinterface_to_an_EtherChannelInterface)

##### Add a Subinterface to an EtherChannel Interface

Use the following procedure to add a subinterface to an existing interface:

| **Note** | ---   If you want to immediately create another subinterface, check the Create another checkbox and then click Create.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the threat defense you want to add an EtherChannel to. In the Management pane located to the right, select Interfaces. |
| **Step 4** | Select the interface you want to group the subinterface under. In the Action pane located to the right, click the  button. |
| **Step 5** | (Optional) Enter a Logical Name. |
| **Step 6** | (Optional) Enter a description. |
| **Step 7** | (Optional) Assign a security zone to the subinterface. Note that you cannot assign a security zone if the subinterface does not have a logical name. |
| **Step 8** | Enter a VLAN ID. |
| **Step 9** | Enter the EtherChannel ID. Use a value between 1 and 48; use values between 1 and 8 for the Firepower 1010 series. |
| **Step 10** | Select the IPv4, IPv6, or Advanced tab to configure the IP address of the subinterface. |
| **Step 11** | Click Create. |

---

#### Edit or Remove a Subinterface from an EtherChannel

Use the following procedures to either modify an existing subinterface, or remove a subinterface from an Etherchannel interface.

| **Note** | ---   Subinterfaces and EtherChannel interfaces have a series of guidelines and limitations that may affect your configuration. See the [general subinterface limitations](#Add_a_Subinterface_to_an_EtherChannel_Interface__general_limitation) for more information.   --- |
| --- | --- |

* [Edit a Subinterface](#Edit_a_Subinterface)
* [Remove a Subinterface from an EtherChannel](#Remove_a_Subinterface_from_an_EtherChannel)

##### Edit a Subinterface

Use the following procedure to edit an existing subinterface associated with an EtherChannel interface:

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the threat defense associated with the EtherChannel and subinterface you want to edit. |
| **Step 4** | In the Management pane located to the right, select Interfaces. |
| **Step 5** | Locate and expand the Etherchannel interface that the subinterface is a member of. |
| **Step 6** | Select the desired subinterface you want to edit. In the Action pane located to the right, click the edit icon  . |
| **Step 7** | Modify any of the following items:   * Logical name. * State. * Description. * Security Zone assignment. * VLAN ID * IP address configuration in either the IPv4, IPv6, or Advanced tabs. |
| **Step 8** | Click Save. |

---

##### Remove a Subinterface from an EtherChannel

Use the following procedure to remove an existing subinterface from an EtherChannel interface:

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the threat defense associated with the EtherChannel and subinterface you want to edit. In the Management pane located to the right, select Interfaces. |
| **Step 4** | Locate and expand the Etherchannel interface that the subinterface is a member of. |
| **Step 5** | Select the desired subinterface you want to delete. |
| **Step 6** | In the Actions pane located to the right, click Remove. |
| **Step 7** | Confirm you want to delete the subinterface interface and click OK. |

---

#### Add Interfaces to a Virtual FDM-Managed Device

When you deploy a virtual FDM-managed device, you assign interfaces to the virtual machine. Then, from within an FDM-managed device, you configure those interfaces using the same methods you would use for a hardware device.

However, you cannot add more virtual interfaces to the virtual machine and then have FDM automatically recognize them. If
you need more physical-interface equivalents for a virtual FDM-managed device, you basically have to start over. You can either deploy a new virtual machine, or you can use the following procedure.

| **Caution** | ---   Adding interfaces to a virtual machine requires that you completely wipe out the virtual FDM-managedconfiguration. The only part of the configuration that remains intact is the management address and gateway settings.   --- |
| --- | --- |

Before You Begin

Do the following in an FDM-managed device:

* Examine the virtual FDM-managed device configuration and make notes on settings that you will want to replicate in the new virtual machine.
* Select Devices > Smart License > View Configuration and disable all feature licenses.

##### Procedure

---

| **Step 1** | Power off the virtual FDM-managed device. |
| --- | --- |
| **Step 2** | Using the virtual machine software, add the interfaces to the virtual FDM-managed device. For VMware, virtual appliances use e1000 (1 Gbit/s) interfaces by default. You can also use vmxnet3 or ixgbe (10 Gbit/s) interfaces |
| **Step 3** | Power on the virtual FDM-managed device. |
| **Step 4** | Open the virtual FDM-managed device console, delete the local manager, then enable the local manager. Deleting the local manager, then enabling it, resets the device configuration and gets the system to recognize the new interfaces. The management interface configuration does not get reset. The following SSH session shows the commands.  ``` > show managers Managed locally. > configure manager delete If you enabled any feature licenses, you must disable them in Firepower Device Manager before deleting the local manager. Otherwise, those licenses remain assigned to the device in Cisco Smart Software Manager. Do you want to continue[yes/no] yes DCHP Server Disabled > show managers No managers configured. > configure manager local >  ``` |
| **Step 5** | Open a browser session to an FDM-managed device, complete the device setup wizard, and configure the device. See the "Complete the Initial Configuration" section of the Getting Started chapter of [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version x.x.x](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), guide for more instructions. |

---

#### Switch Port Mode Interfaces for an FDM-Managed Device

For each physical Firepower 1010 interface, you can set its operation as a firewall interface or as a switch port. Switch
ports forward traffic at Layer 2, using the switching function in hardware. Switch ports on the same VLAN can communicate
with each other using hardware switching, and traffic is not subject to the FDM-managed device security policy. Access ports accept only untagged traffic, and you can assign them to a single VLAN. Trunk ports
accept untagged and tagged traffic, and can belong to more than one VLAN. For devices that have been reimaged to Version 6.4,
Ethernet 1/2 through 1/8 are configured as access switch ports on VLAN 1; devices that are manually upgraded to Version 6.4
(and later), the ethernet configuration maintains the configuration prior ot upgrading. Note that switch ports on the same
VLAN can communicate with each other using hardware switching, and traffic is not subject to the FDM-managed device security policy.

##### Access or Trunk

A physical interface configured as a switch port can be assigned as either an access port or a trunk port.

Access ports forward traffic to only one VLAN and accept only untagged traffic. We strongly recommend this option if you intend
to forward traffic to a single host or device. You must also specify the VLAN you would like to be associated with the interface,
otherwise it will default to VLAN 1.

Trunk ports forward traffic to multiple VLANs. You must assign one VLAN interface as the native trunk port and at least one
VLAN as an associated trunk port. You can select up to 20 interfaces to be associated with the switch port interface, which
enables traffic from different VLAN IDs to pass through the switch port interface. If an untagged traffic is passed through
the switch port then the traffic is tagged with the VLAN ID of the native VLAN interface. Note that the default Fiber Distributed
Data Interface (FDDI) & Token RING ID between 1002 and 1005 cannot be used for VLAN ID.

##### Change the Port Mode

If you select an interface that is configured for routed mode as a VLAN member, Security Cloud Control automatically converts the interface to switch port mode and configures the interface as an access port by default. As a
result the logical name and the associated static IP addresses are removed from the interface.

##### Configuration Limitations

Be aware of the following limitations:

* Only physical Firepower 1010 devices support switch port mode configuration. Virtual FDM-managed devices do not support switch port mode.
* The Firepower 1010 device allows a maximum of 60 VLANs.
* VLAN interfaces configured for switch port mode must be unnamed. This means the MTU **must** be configured to 1500 bytes.
* You **cannot** delete an interface configured as a switch port mode. You must manually change the interface mode from **switch port** mode to **routed** mode.
* Interfaces configured for switch port mode do not support IP addresses. If the interface is currently referenced in or configured
  for VPN, DHCP, or is associated with a static route, you **must** manually remove the IP address.
* You cannot use any member of the bridge group interface as a switch port.
* The MTU for a VLAN interface **must** be 1500 bytes. Unnamed VLAN interfaces do not support any other configuration.
* Switch port mode does not support the following:

  + Diagnostic interface.
  + Dynamic, multicast, or Equal-Cost Multi-Path (ECMP) routing.
  + Passive interfaces.
  + Port etherchannels, or using an interface that is a member of an etherchannel.
  + Subinterfaces.
  + Failover and state link.

##### High Availability and Switch Port Mode Interfaces

You should not use the switch port functionality when using High Availability. Because the switch ports operate in hardware,
they continue to pass traffic on both the active *and* the standby units. High Availability is designed to prevent traffic from passing through the standby unit, but this feature
does not extend to switch ports. In a normal High Availability network setup, active switch ports on both units will lead
to network loops. We suggest that you use external switches for any switching capability. Note that VLAN interfaces can be
monitored by failover, while switch ports cannot.

| **Note** | ---   You can only use a firewall interface as the failover link.   --- |
| --- | --- |

##### Switch Port Mode Configurations in Templates

You can create templates of devices with interfaces configured for switch port mode. Beware the following scenarios when mapping
interfaces from the template to a device:

* If a template interface does not contain any VLAN members prior to applying the template, Security Cloud Control automatically maps it to an available device interface that has the same properties.
* If a template interface that does not contain a VLAN member is mapped to a device interface that is configured as **N/A**, Security Cloud Control automatically creates an interface on the device the template is to be applied to
* If a template interface containing a VLAN member is mapped to a device interface that is not present, applying a template
  will **fail**.
* Templates do not support mapping more than one template interface to the same device interface.
* The template's management interface must be mapped to the device's management interface.

#### Configure an FDM-Managed Device VLAN

You must first configure a VLAN interface if you intend to configure subinterfaces or switch ports.

| **Note** | ---   An FDM-managed device supports a maximum of 60 VLAN interfaces.   --- |
| --- | --- |

##### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the desired device you want to create a VLAN on. |
| **Step 4** | In the Management pane at the right, click Interfaces. |
| **Step 5** | On the Interfaces page, click the  button. |
| **Step 6** | Configure the following:   * Parent Interface - The parent interface is the   physical interface to which you want to add the subinterface. You   cannot change the parent interface after you create the   subinterface. * (Optional) Logical Name-Set the name for the VLAN, up to 48 characters. Alphabetic characters must be lower case. If you do not want to route between   the VLAN and other VLANs or firewall interfaces, then leave the VLAN interface name empty.       | **Note** | If you do not enter a name, the MTU in the Advanced Options must be set to 1500. If you change the MTU to something other than 1500, the VLAN must be unnamed. |   | --- | --- | * (Optional) Description-The description can be up to 200 characters on a single line, without carriage returns. * (Optional) Security Zone - Assign the   subinterface to a security zone. Note that you cannot assign a   subinterface if it does not have a Logical Name. You ca also assign   a security zone after creating a subinterface. See [Use of Security Zones   in Firepower Interface Settings](#Use_of_Security_Zones_in_Firepower_Interface_Settings) for more information. * (Optional) VLAN ID-Enter the VLAN ID between 1 and 4070 that will be used to tag the packets on this subinterface.       | **Note** | ​​​​​​VLAN interfaces are routed by default. If you add this VLAN interface to a bridge group at a later date, Security Cloud Control automatically changes the mode to BridgeGroupMember. Similarly, if you change this VLAN interface to switch port mode, Security Cloud Control automatically changes the mode to Switch Port. |   | --- | --- | * (Optional) Subinterface ID - Enter the   subinterface ID as an integer between 1 and 4294967295. This ID is   appended to the interface ID; for example Ethernet1/1.100. You can   match the VLAN ID for convenience, but it is not required. You   cannot change the ID after you create the subinterface. |
| **Step 7** | Click the IPv4 Address tab and select one of the following options from the Type field:   * Static - Choose this option if you want to assign an address that should not change. Type in the interface's IP address and the subnet   mask for the network attached to the interface. For example, if you attach the 10.100.10.0/24 network, you could enter 10.100.10.1/24.   Ensure that the address is not already used on the network.  If you configured high availability, and you are monitoring this interface for HA, also configure a standby IP address on   the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address,   the active unit cannot monitor the standby interface using network tests; it can only track the link state.       | **Note** | If there is a DHCP server configured for the interface, you are shown the configuration. You can edit or delete the DHCP address pool. If you change the interface IP address to a different subnet, you must either delete the DHCP server, or configure an address pool on the new subnet, before you can save the interface changes. See [Configuring DHCP Server](#Configure_DHCP_Servers) for more information. |   | --- | --- | * Dynamic (DHCP)-Choose this option if the address should be obtained from the DHCP server on the network. You cannot use this option if you   configure high availability. Change the following options if necessary:    + Route Metric-If you obtain the default route from the DHCP server, the administrative distance to the learned route, between 1 and 255.     The default is 1.   + Obtain Default Route-Check this option to get the default route from the DHCP server. You would normally select this option, which is the default. * DHCP Address Pool - If there is a DHCP server   configured for the interface, you are shown the configuration. You   can edit or delete the DHCP address pool. If you change the   interface IP address to a different subnet, you must either delete   the DHCP server, or configure an address pool on the new subnet,   before you can save the interface changes. |
| **Step 8** | (Optional) Click the IPv6 Address tab and configure the following:   * State - To enable IPv6 processing and to   automatically configure the link-local address when you do not   configure the global address, slide the State slider to blue. The   link local address is generated based on the interface MAC addresses   (Modified EUI-64 format).       | **Note** | Disabling IPv6 does not disable IPv6 processing on an interface that is configured with an explicit IPv6 address or that is enabled for autoconfiguration. |   | --- | --- | * Address Auto Configuration - Check this option   to have the address automatically configured. IPv6 stateless   autoconfiguration will generate a global IPv6 address only if the   link on which the device resides has a router configured to provide   IPv6 services, including the advertisement of an IPv6 global prefix   for use on the link. If IPv6 routing services are not available on   the link, you will get a link-local IPv6 address only, which you   cannot access outside of the device's immediate network link. The   link local address is based on the Modified EUI-64 interface ID. * Suppress RA-Whether to suppress router advertisements. Threat   Defense can participate in router advertisements so that neighboring devices can dynamically learn a default router address. By default,   router advertisement messages (ICMPv6 Type 134) are periodically sent out each IPv6 configured interface.  Router advertisements are also sent in response to router solicitation messages (ICMPv6 Type 133). Router solicitation messages   are sent by hosts at system startup so that the host can immediately auto-configure without needing to wait for the next scheduled   router advertisement message.  We suggest suppressing these messages on any interface for which you do not want the FDM-managed device to supply the IPv6 prefix (for example, the outside interface). * Static Address/Prefix-If you do not use   stateless auto configuration, enter the full static global IPv6   address and network prefix. For example, 2001:0DB8::BA98:0:3210/48.   For more information on IPv6 addressing, see [IPv6 Addressing for   Firepower Interfaces](#IPv6_Addressing_for_Firepower_Interfaces). * Standby IP Address-If you configure high availability, and you are monitoring this interface for HA, also configure a standby IPv6 address on   the same subnet. The standby address is used by this interface on the standby device. If you do not set the standby IP address,   the active unit cannot monitor the standby interface using network tests; it can only track the link state. |
| **Step 9** | (Optional) Click the Advanced tab.   * Select Enable for HA Monitoring if you want the health of the interface to be a factor when the system decides whether to fail over to the peer unit in a   high availability configuration.  This option is ignored if you do not configure high availability. It is also ignored if you do not configure a name for the   interface. * Select Management Only to make a data interface management only.  A management only interface does not allow through traffic, so there is very little value in setting a data interface as management   only. You cannot change this setting for the Management/Diagnostic interface, which is always management only. * Modify the IPv6 Configuration settings.    + Enable DHCP for IPv6 address configuration-Whether to set the Managed Address Configuration flag in the IPv6 router advertisement packet. This flag informs IPv6 autoconfiguration     clients that they should use DHCPv6 to obtain addresses, in addition to the derived stateless autoconfiguration address.   + Enable DHCP for IPv6 non-address configuration-Whether to set the Other Address Configuration flag in the IPv6 router advertisement packet. This flag informs IPv6 autoconfiguration     clients that they should use DHCPv6 to obtain additional information from DHCPv6, such as the DNS server address.   + DAD Attempts-How often the interface performs Duplicate Address Detection (DAD), from 0 - 600. The default is 1. During the stateless     autoconfiguration process, DAD verifies the uniqueness of new unicast IPv6 addresses before the addresses are assigned to     interfaces. If the duplicate address is the link-local address of the interface, the processing of IPv6 packets is disabled     on the interface. If the duplicate address is a global address, the address is not used. The interface uses neighbor solicitation     messages to perform Duplicate Address Detection. Set the value to 0 to disable duplicate address detection (DAD) processing. * Change the MTU (maximum transmission unit) to the desired value.  The default MTU is 1500 bytes. You can specify a value from 64 - 9198 (or 9000 for virtual FDM-managed devices and 9184 for the Firepower 4100/9300). Set a high value if you typically see jumbo frames on your network.       | **Note** | If you increase MTU above 1500 on ASA 5500-X series devices, ISA 3000 series devices, or virtual FDM-managed devices, the VLAN must be unnamed and you must reboot the device. Log into the CLI and use the reboot command. If the device is configured for HA, you must also reboot the standby device. You do not need to reboot Firepower models, where jumbo frame support is always enabled. |   | --- | --- | * (Optional for subinterface and HA pairs) Configure the MAC address.  By default, the system uses the MAC address burned into the network interface card (NIC) for the interface. Thus, all subinterfaces   on an interface use the same MAC address, so you might want to create unique addresses per subinterface. Manually configured   active/standby MAC addresses are also recommended if you configure high availability. Defining the MAC addresses helps maintain   consistency in the network in the event of failover.    + MAC Address-The Media Access Control in H.H.H format, where H is a 16-bit hexadecimal digit. For example, you would enter the MAC address     00-0C-F1-42-4C-DE as 000C.F142.4CDE. The MAC address must not have the multicast bit set, that is, the second hexadecimal     digit from the left cannot be an odd number.)   + Standby MAC Address-For use with HA pairs. If the active unit fails over and the standby unit becomes active, the new active unit starts using     the active MAC addresses to minimize network disruption, while the old active unit uses the standby address. |
| **Step 10** | If you intend to create another subinterface for this device, check Create another prior to completing the subinterface configuration. |
| **Step 11** | (Optional) Activate the subinterface upon creation by toggling the State slider in the upper right corner of the pop-up window from grey to blue. |
| **Step 12** | Click OK. |
| **Step 13** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Configure an FDM-Managed Device VLAN for Switch Port Mode

Be sure to read the limitations for switch port mode prior to configuration; see [Switch Port Mode Interfaces for FTD](#Switch_Port_Mode_Interfaces_for_an_FTD) for more information.

| **Note** | ---   You can assign or edit a VLAN member to a physical interface at any time. Be sure to deploy the changes to the device after you confirm the new configuration.   --- |
| --- | --- |

* [Create a VLAN Interface for Switch Port Mode](#Create_a_VLANInterface_forSwitch_Port_Mode)
* [Configure an Existing Physical Interface for Switch Port Mode](#Configure_an_Existing_Physical_Interface_for_Switch_Port_Mode)

##### Create a VLAN Interface for Switch Port Mode

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want to configure interfaces for. |
| **Step 4** | In the Management pane on the right, click Interfaces. |
| **Step 5** | On the Interfaces page, click the  button and choose VLAN Interface. |
| **Step 6** | View the VLAN Members tab and select the desired physical interfaces.   | **Note** | If you chose to add a member that references a VLAN interface configured for either Access or Native Trunk, you can only select one VLAN as a member. Physical interfaces that references a VLAN interface configured for Associated Trunk supports up to 20 interfaces as members. | | --- | --- | |
| **Step 7** | Configure the rest of the VLAN interface, as described in [Configure a FDM-Managed Device VLAN](#Configure_a_VLANInterface). |
| **Step 8** | Click Save. Confirm that you want to reset the VLAN configuration and reassign an IP address to the interface. |
| **Step 9** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be)now the changes you made, or wait and deploy multiple changes at once. |

---

##### Configure an Existing Physical Interface for Switch Port Mode

###### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want to configure interfaces for. |
| **Step 4** | In the Management pane on the right, click Interfaces. |
| **Step 5** | On the Interfaces page, select the physical interface you want to modify. In the Action Pane on the right, click the edit icon . |
| **Step 6** | Interfaces configured for switch port mode do not support logical names. If the interface has a logical name, delete it. |
| **Step 7** | Locate the Mode and use the drop-down menu to select Switch Port. |
| **Step 8** | Configure the physical interface for switch port mode:   * (Optional) Check the Protected Port check box to set this switch port as protected, so you can prevent the switch port from communicating with other protected   switch ports on the same VLAN. You might want to prevent switch ports from communicating with each other if: the devices on   those switch ports are primarily accessed from other VLANs; you do not need to allow intra-VLAN access; and you want to isolate   the devices from each other in case of infection or other security breach. For example, if you have a DMZ that hosts three   web servers, you can isolate the web servers from each other if you apply this option to each switch port. The inside and   outside networks can both communicate with all three web servers, and vice versa, but the web servers cannot communicate with   each other. * For the Usage Type, select Access or Trunk. See [Switch Port Mode Interfaces for FTD](#Switch_Port_Mode_Interfaces_for_an_FTD) to determine which port type you need.    + If you select Trunk, you must select one VLAN interface as the Native Trunk     VLAN to forward untagged traffic and at least one **Associated VLAN** to forward tagged traffic. Click the  icon to view the existing physical interfaces. You can select up to 20 VLAN interfaces as associated VLANs.   + You can create a new VLAN interface set to Access mode by clicking C     reate new VLAN. |
| **Step 9** | Click Save. Confirm that you want to reset the VLAN configuration and reassign an IP address to the interface. |
| **Step 10** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

### Viewing and Monitoring Firepower Interfaces

To view firepower interfaces, follow these steps:

#### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and the device whose interfaces you want to view. |
| **Step 4** | Select Interfaces  in the Management pane on the right. |
| **Step 5** | In the Interfaces table, select an interface.   * If you expand the interface row, you see subinterface information. * On the right, you see detailed interface information. |

---

* [Monitoring Interfaces in the CLI](#Monitoring_Interfaces_in_the_CLI)

#### Monitoring Interfaces in the CLI

You can view some basic information, behavior, and statistics about interfaces by connecting to the device using SSH and running
the command below.

For an easy to connect to the device using SSH, onboard the FDM-managed device you want to monitor as an SSH device and then use the >\_ Command Line Interface in Security Cloud Control.

* `show interface` displays interface statistics and configuration information. This command has many keywords you can use to get to the information
  you need. Use ? as a keyword to see the available options.
* `show ipv6 interface` displays IPv6 configuration information about the interfaces.
* `show bridge-group` displays information about Bridge Virtual Interfaces (BVI), including member information and IP addresses.
* `show conn` displays information about the connections currently established through the interfaces.
* `show traffic` displays statistics about traffic flowing through each interface.
* `show ipv6 traffic` displays statistics about IPv6 traffic flowing through the device.
* `show dhcpd` displays statistics and other information about DHCP usage on the interfaces, particularly about the DHCP servers configured
  on interfaces.

## Synchronizing Interfaces Added to a Firepower Device using FXOS

If an interface is added to a Firepower device by using the Firepower eXtensible Operating System (FXOS) Chassis Manager,
on the Firepower 4100 series or 9300 series devices, Security Cloud Control does *not* recognize that configuration change and report a configuration conflict.

To see the newly added interface in Security Cloud Control, follow this procedure:

### Procedure

---

| **Step 1** | Log in to an FDM-managed device. |
| --- | --- |
| **Step 2** | From the FDM-managed main page, click **View All Interfaces** in the Interfaces panel. |
| **Step 3** | Click the **Scan Interfaces** button: |
| **Step 4** | Wait for the interfaces to scan, and then click **OK**. |
| **Step 5** | Deploy your changes on an FDM-managed device. |
| **Step 6** | Log in to Security Cloud Control as an Admin or SuperAdmin. |
| **Step 7** | In the left pane, click **Security Devices**. |
| **Step 8** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 9** | Click the FTD tab and select the device with the expected new interface configuration. |
| **Step 10** | Click **Check for Changes** to immediately compare the copy of the configuration on the device with the copy of the configuration stored on Security Cloud Control. Security Cloud Control will detect the interface change and report a "Conflict Detected" state on the Security Devices page for the device. |
| **Step 11** | Resolve the Conflict Detected by clicking **Review Conflict** and then accepting the out of band changes. |

---

## Routing

Routing is the act of moving information across a network from a source to a destination. Along the way, at least one intermediate
node is typically encountered. Routing involves two basic activities: determining optimal routing paths and transporting packets
through a network.

Using Security Cloud Control, you can define a default route, and other static routes, for your FDM-managed devices. The following topics explain routing basics and how to use Security Cloud Control to configure static routing on your FDM-managed device:

* [About Static Routing and Default Routes](#About_Static_Routing_and_Default_Routes)
* [The Routing Table and Route Selection](#The_Routing_Table_and_Route_Selection)
* [Configure Static and Default Routes](#Configure_Static_and_Default_Routes_for_FTD_Devices)
* [Monitoring Routing](#Monitoring_Routing)

* [About Static Routing and Default Routes](#About_Static_Routing_and_Default_Routes)
* [The Routing Table and Route Selection](#The_Routing_Table_and_Route_Selection)
* [Configure Static and Default Routes for FDM-Managed Devices](#Configure_Static_and_Default_Routes_for_FTD_Devices)
* [Monitoring Routing](#Monitoring_Routing)
* [Static Route Network Diagram](#Static_Route_Network_Diagram)
* [About Virtual Routing and Forwarding](#About_Virtual_Routing_and_Forwarding)

### About Static Routing and Default Routes

To route traffic to a non-connected host or network, you must define a route to that host or network. That defined route is
a static route. Consider also configuring a default route. A default route is for all traffic that is not routed by other
means to a default network gateway, typically the next hop router.

* [Default Route](#Default_Route)
* [Static Routes](#Static_Routes)

**Related Information:**

* [Default Route](#Default_Route)
* [Static Routes](#Static_Routes)

#### Default Route

If you do not know a route to a specific network, the simplest option is to configure a default route that sends all traffic
to an upstream router, relying on that router to route the traffic for you. A default route identifies the gateway IP address
to which the FDM-managed device sends all IP packets for which you did not define a static route. A default route is simply a static route with 0.0.0.0/0
(IPv4) or ::/0 (IPv6) as the destination IP address.

#### Static Routes

A static route is a route from one network to another network that you define and enter manually into the routing table. You
might want to use static routes in the following cases:

* Your network is small and stable and you can easily manage manually adding and changing routes between devices.
* Your networks use an unsupported router discovery protocol.
* You do not want the traffic or CPU overhead associated with routing protocols.
* In some cases, a default route is not enough. The default gateway might not be able to reach the destination network, so you
  must also configure more specific static routes. For example, if the default gateway is outside, then the default route cannot
  direct traffic to any inside networks that are not directly connected to the FDM-managed device.
* You are using a feature that does not support dynamic routing protocols.

##### **Limitations:**

* Security Cloud Control does not currently support the management, monitoring, or use of Virtual Tunnel Interface (VTI) tunnels on ASA or FDM-managed devices. Devices with configured VTI tunnels can be onboarded to Security Cloud Control but it ignores the VTI interfaces. If a security zone or static route references a VTI, Security Cloud Control reads the security zone and static route without the VTI reference. Security Cloud Control support for VTI tunnels is coming soon.
* FDM-managed device running on software version 7.0 or later allows configuring Equal-Cost Multi-Path (ECMP) traffic zones. When the FDM-managed device is onboarded to Security Cloud Control, it can read but cannot modify the ECMP configuration available in the global VRF routes because it does not allow a route
  to the same destination network with an identical metric value. You can create and modify ECMP traffic zones through FDM and
  then read it into Security Cloud Control. For more information on ECMP, see the "Equal-Cost Multi-Path (ECMP) Routing" section in the "Routing Basics and Static Routes"
  chapter of [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version 7.0 or later](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

### The Routing Table and Route Selection

When NAT translations (xlates) and rules do not determine the egress interface, the system uses the routing table to determine
the path for a packet.

Routes in the routing table include a metric called "administrative distance" that provides a relative priority to a given
route. If a packet matches more than one route entry, the one with the lowest distance is used. Directly connected networks
(those defined on an interface) have the distance 0, so they are always preferred. Static routes have a default distance of
1, but you can create them with any distance between 1-254.

Routes that identify a specific destination take precedence over the default route (the route whose destination is 0.0.0.0/0
or ::/0).

* [How the Routing Table is Populated](#How_the_Routing_Table_is_Populated)
* [How Forwarding Decisions are Made](#How_Forwarding_Decisions_are_Made)

#### How the Routing Table is Populated

The FDM-managed device routing table can be populated with statically defined routes and directly connected routes. It is possible that the
same route is entered in more than one manner. When two routes to the same destination are put into the routing table, the
one that remains in the routing table is determined as follows:

* If the two routes have different network prefix lengths (network masks), then both routes are considered unique and are entered
  into the routing table. The packet forwarding logic then determines which of the two to use.

For example, assume the following routes are entered in the routing table:

* 192.168.32.0/24
* 192.168.32.0/19

Even though the 192.168.32.0/24 route has the longer network prefix, both routes are installed in the routing table because
each of these routes has a different prefix length (subnet mask). They are considered different destinations and the packet
forwarding logic determines which route to use.

* If multiple paths to the same destination are entered in the routing table, the route with the better metric, as entered with
  the static route, is entered into the routing table.

Metrics are values associated with specific routes, ranking them from most preferred to least preferred. The parameters used
to determine the metrics differ for different routing protocols. The path with the lowest metric is selected as the optimal
path and installed in the routing table. If there are multiple paths to the same destination with equal metrics, load balancing
is done on these equal cost paths.

**Related Information:**

* [How Forwarding Decisions are Made](#How_Forwarding_Decisions_are_Made)

#### How Forwarding Decisions are Made

Forwarding decisions are made in this order:

* Use NAT translations (xlates) and rules to determine the egress interface. If the NAT rules do not determine the egress interface,
  the system uses the routing table to determine the path for a packet.
* If the destination does not match an entry in the routing table, the packet is forwarded through the interface specified for
  the default route. If a default route has not been configured, the packet is discarded.
* If the destination matches a single entry in the routing table, the packet is forwarded through the interface associated with
  that route.
* If the destination matches more than one entry in the routing table, then the packet is forwarded out of the interface associated
  with the route that has the longer network prefix length. For example, a packet destined for 192.168.32.1 arrives on an interface
  with the following routes in the routing table:
* 192.168.32.0/24 gateway 10.1.1.2
* 192.168.32.0/19 gateway 10.1.1.3

In this case, a packet destined to 192.168.32.1 is directed toward 10.1.1.2, because 192.168.32.1 falls within the 192.168.32.0/24
network. It also falls within the other route in the routing table, but 192.168.32.0/24 has the longer prefix within the routing
table (24 bits verses 19 bits). Longer prefixes are always preferred over shorter ones when forwarding a packet.

| **Note** | ---   Existing connections continue to use their established interfaces even if a new similar connection would result in different behavior due to a change in routes.   --- |
| --- | --- |

### Configure Static and Default Routes for FDM-Managed Devices

Define static routes on an FDM-managed device so it knows where to send packets bound for networks not directly connected to the interfaces on the system.

Consider creating a default route. This is the route for network 0.0.0.0/0. This route defines where to send packets whose
egress interface cannot be determined by existing NAT translations, static NAT rules, or other static routes.

You might need other static routes if the default gateway cannot be used to get to all networks. For example, the default
route is usually an upstream router on the outside interface. If there are additional inside networks that are not directly
connected to the device, and they cannot be accessed through the default gateway, you need static routes for each of those
inside networks.

You cannot define static routes for the networks that are directly connected to system interfaces. The system automatically
creates these routes.

* [Procedure](#Procedure)
* [Static Route Example](#Static_Route_Example)

#### Procedure

##### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD device and select the device on which you want to define static routes. |
| **Step 4** | In the Management pane at the right, click  Routing. |
| **Step 5** | On the Static Routing page, do one of the following:   * To add a new static route, click the plus button . * Click the edit icon for the route you want to edit.   If you no longer need a route, click the trash can icon for the route to delete it. |
| **Step 6** | Configure the route properties   * Protocol-Select whether the route is for an IPv4 or IPv6 address. * Interface-Select the interface through which you want to send traffic. The gateway address needs to be accessible through this interface. * Gateway-Select the network object that identifies the IP address for the gateway to the destination network. Traffic is sent to this   address. * Metric-The administrative distance for the route, between 1 and 254. The default is for static routes is 1. If there are additional   routers between the interface and the gateway, enter the number of hops as the administrative distance.  Administrative distance is a parameter used to compare routes. The lower the number, the higher precedence the route is given.   Connected routes (networks directly connected to an interface on the device) always take precedence over static routes. * Destination Network-Select the network object(s), that identifies the destination network, that contains the host(s), that uses the gateway in   this route.  To define a default route, use the pre-defined any-ipv4 or any-ipv6 network objects, or create an object for the 0.0.0.0/0 (IPv4) or ::/0 (IPv6) network. |
| **Step 7** | Click OK. |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Static Route Example

See the [Static Route Network Diagram](#Static_Route_Network_Diagram) for the addresses used in this example.

The goal is to create a static route that allows return traffic to the host at 20.30.1.2 in destination network 20.30.1.0/24.

The packet can take any path to reach the destination. When a network receives a packet on an interface, it determines where
to forward the packet for the best route to a destination.

| **Note** | ---   The DMZ does not have a static route as it is connected directly to the interface.   --- |
| --- | --- |

For example, consider the following two routes for reaching the destination.

##### Route 1:

###### Procedure

---

| **Step 1** | Packets come back to the outside interface, 209.165.201.0/27, looking for 20.30.1.2. |
| --- | --- |
| **Step 2** | We direct the packets to use the inside interface to get to the gateway 192.168.1.2, which is on the same network as the destination. |
| **Step 3** | From there, we identify the destination network by the gateway address for that network, 20.30.1.1. |
| **Step 4** | The IP address 20.30.1.2 is on the same subnet as 20.30.1.1. The router forwards the packet to the switch, the switch forwards the packet to 20.30.1.2.  Interface:Inside Destination\_N/W:20.30.1.0/24 Gateway: 192.168.1.2 Metric: 1 |

---

##### Route 2:

###### Procedure

---

| **Step 1** | Packets come back to the outside interface, 209.165.201.0/27, looking for 20.30.1.2. |
| --- | --- |
| **Step 2** | We direct the packets to use the internal interface to get to the gateway 192.168.50.20, which is multiple hops away from the destination network. |
| **Step 3** | From there, we identify the destination network by the gateway address for that network, 20.30.1.1. |
| **Step 4** | The IP address 20.30.1.2 is on the same subnet as 20.30.1.0. The router forwards the packet to the switch, the switch forwards the packet to 20.30.1.2.  Interface:Inside Destination\_N/W:20.30.1.0/24 Gateway: 192.168.50.20 Metric: 100  Here is what the completed Add Static Route table would like for these routes. |

---

### Monitoring Routing

To monitor and troubleshoot routing, open Firewall Device Manager for the device and open the CLI console or log into the device CLI using SSH and use the following commands:

* `show route` displays the routing table for the data interfaces, including routes
  for directly-connected networks.
* `show ipv6 route` displays the IPv6 routing table for the data interfaces,
  including routes for directly-connected networks.
* `show network` displays the configuration for the virtual management interface,
  including the management gateway. Routing through the virtual interface is not
  handled by the data interface routing table, unless you specify data-interfaces
  as the management gateway.
* `show network-static-routes` displays static routes configured for the virtual
  management interface using the `configure network static-routes`
  command. Normally, there will not be any static routes, as the management
  gateway suffices for management routing in most cases. These routes are not
  available to traffic on the data interfaces. This command is not available in
  the CLI console.

### Static Route Network Diagram

We refer to this network diagram when discussing [configuring static routes](#Configure_Static_and_Default_Routes_for_FTD_Devices):

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457549.jpg)

### About Virtual Routing and Forwarding

#### About VRF

Virtual routing and forwarding (VRF) allow multiple instances of a routing table to exist in a router. Firepower Version 6.6
introduces the ability to have a default VRF table and user-created VRF tables. A single VRF table can handle multiple types
of varying routing protocols, such as EX, OSPF, BGP, IGRP, etc. Each routing protocol within a VRF table is listed as an entry.
In addition to handling multiple types of common routing protocols, you can configure a routing protocol to reference an interface
from another VRF. This allows you to segment network paths without using multiple devices.

See [About Virtual Routers and Virtual Routing and Forwarding (VRF)](https://www.cisco.com/c/en/us/td/docs/security/firepower/660/fdm/fptd-fdm-config-guide-660/fptd-fdm-virtual-routers.html#id_99432) for more information.

#### VRF in Security Cloud Control

This feature is new to Firepower Version 6.6. When the FDM-managed device is onboarded to Security Cloud Control, the device routing page reads and supports only the VRFs defined on the global router of the FDM-managed device. To view the global VRF in Security Cloud Control, select the device from the Security Devices page and select Routing from the Management pane located to the right of the window. From here, you can view, modify, and delete the global VRF; note that Security Cloud Control retains the name of the VRF when reading the configuration from FDM.

Security Cloud Control
firewall device manager doesn't read VRFs configured in the user-defined virtual routers. You must create and manage VRF tables through firewall device manager.

For information on global and user-defined routes, see the "Managing Virtual Routers" section in the "Virtual Routers" chapter
of [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version 7.0 or later](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

## Objects

An object is a container of information that you can use in one or more security policies. Objects make it easy to maintain
policy consistency. You can create a single object, use it different policies, modify the object, and that change is propagated
to every policy that uses the object. Without objects, you would need to modify all the policies, individually, that require
the same change.

When you onboard a device, Security Cloud Control recognizes all the objects used by that device, saves them, and lists them on the Objects page. From the Objects page, you can edit existing objects and create new ones to use in your security policies.

Security Cloud Control calls an object used on multiple devices a **shared object** and identifies them in the Objects page with this badge ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453370.jpg).

Sometimes a shared object develops some "issue" and is no longer perfectly shared across multiple policies or devices:

* ****Duplicate objects**** are two or more objects on the same device with different names but the same values. These objects usually serve similar
  purposes and are used by different policies. Duplicate objects are identified by this issue icon: ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453368.jpg)
* ****Inconsistent objects**** are objects on two or more devices with the same name but different values. Sometimes users create objects in different configurations
  with same name and content but over time the values of these objects diverge which creates the inconsistency. Inconsistent
  objects are identified by this issue icon: ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453369.jpg)
* ****Unused objects**** are objects that exist in a device configuration but are not referenced by another object, an access-list, or a NAT rule.
  Unused objects are identified by this issue icon: ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453371.jpg)

You can also create objects for immediate use in rules or policies. You can create an object that is unassociated with any
rule or policy. When you use that unassociated object in a rule or policy, Security Cloud Control creates a copy of it and uses the copy.

You can view the objects managed by Security Cloud Control by navigating to the Objects menu or by viewing them in the details of a network policy.

Security Cloud Control allows you to manage network and service objects across supported devices from one location. With Security Cloud Control, you can manage objects in these ways:

* Search for and [filter all your objects](#About_Object_Filters) based on a variety of criteria.
* Find duplicate, unused, and inconsistent objects on your devices and consolidate, delete, or
  resolve those object issues.
* Find unassociated objects and delete them if they are unused.
* Discover shared objects that are common across devices.
* Evaluate the impact of changes to an object on a set of policies and devices before committing the change.
* Compare a set of objects and their relationships with different policies and devices.
* Capture objects in use by a device after it has been on-boarded to Security Cloud Control.

If you have issues with creating, editing, or reading objects from an onboarded device,
see [Troubleshoot Security Cloud Control](troubleshooting.html#CDO-Troubleshooting) for more information.

* [Object Types](#Object_Types)
* [Shared Objects](#About_Shared_Objects)
* [Object Overrides](#Object_Overrides)
* [Unassociated Objects](#Cisco_Concept.dita_69ca0d7b-987a-4784-91d5-921153ac67c9)
* [Compare Objects](#CompareObjects)
* [Filters](#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457)
* [Unignore Objects](#Unignore_Objects)
* [Deleting Objects](#Deleting_Objects)
* [Network Objects](#About_Network_Objects)
* [URL Objects](#Cisco_Concept.dita_a92f613b-e87e-4e4a-913d-50f9febe9234)
* [Application Filter Objects](#Application_Filter_Objects)
* [Geolocation Objects](#UpdateGeolocationDatabase)
* [DNS Group Objects](#Cisco_Concept.dita_925432d7-66d2-4f93-bab6-8869fc832388)
* [Certificate Objects](#Certificate_Objects)
* [About IPsec Proposals](#Configuring_IPsec_Proposals)
* [About Global IKE Policies](#Configuring_the_Global_IKE_Policy)
* [RA VPN Objects](#Cisco_Reference.dita_bd69c4dd-138c-4f89-b553-71f1aa33bf50)
* [Security Zone Object](#Security_Zone_Object)
* [Service Objects](#ASA_Service_Objects)
* [Security Group Tag Group](#Cisco_Concept.dita_73428ed6-cd13-45f9-ae4f-711aa91a51b3)
* [Syslog Server Objects](#Cisco_Concept.dita_8ad8638c-1934-4da0-834c-59b0d7a0df0b)
* [Objects](#Objects)

### Objects

An object is a container of information that you can use in one or more security policies. Objects make it easy to maintain
policy consistency. You can create a single object, use it different policies, modify the object, and that change is propagated
to every policy that uses the object. Without objects, you would need to modify all the policies, individually, that require
the same change.

When you onboard a device, Security Cloud Control recognizes all the objects used by that device, saves them, and lists them on the Objects page. From the Objects page, you can edit existing objects and create new ones to use in your security policies.

Security Cloud Control calls an object used on multiple devices a **shared object** and identifies them in the Objects page with this badge ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453370.jpg).

Sometimes a shared object develops some "issue" and is no longer perfectly shared across multiple policies or devices:

* ****Duplicate objects**** are two or more objects on the same device with different names but the same values. These objects usually serve similar
  purposes and are used by different policies. Duplicate objects are identified by this issue icon: ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453368.jpg)
* ****Inconsistent objects**** are objects on two or more devices with the same name but different values. Sometimes users create objects in different configurations
  with same name and content but over time the values of these objects diverge which creates the inconsistency. Inconsistent
  objects are identified by this issue icon: ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453369.jpg)
* ****Unused objects**** are objects that exist in a device configuration but are not referenced by another object, an access-list, or a NAT rule.
  Unused objects are identified by this issue icon: ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453371.jpg)

You can also create objects for immediate use in rules or policies. You can create an object that is unassociated with any
rule or policy. When you use that unassociated object in a rule or policy, Security Cloud Control creates a copy of it and uses the copy.

You can view the objects managed by Security Cloud Control by navigating to the Objects menu or by viewing them in the details of a network policy.

Security Cloud Control allows you to manage network and service objects across supported devices from one location. With Security Cloud Control, you can manage objects in these ways:

* Search for and [filter all your objects](#About_Object_Filters) based on a variety of criteria.
* Find duplicate, unused, and inconsistent objects on your devices and consolidate, delete, or
  resolve those object issues.
* Find unassociated objects and delete them if they are unused.
* Discover shared objects that are common across devices.
* Evaluate the impact of changes to an object on a set of policies and devices before committing the change.
* Compare a set of objects and their relationships with different policies and devices.
* Capture objects in use by a device after it has been on-boarded to Security Cloud Control.

If you have issues with creating, editing, or reading objects from an onboarded device,
see [Troubleshoot Security Cloud Control](troubleshooting.html#CDO-Troubleshooting) for more information.

#### Object Types

The following table describes the objects that you can create for your devices and manage using Security Cloud Control.

Table 1. FDM-Managed Device Object Types

| Object | Description |
| --- | --- |
| [Application Filter](#Application_Filter_Objects) | An application filter object defines the applications used in an IP connection, or a filter that defines applications by type, category, tag, risk, or business relevance. You can use these objects in policies to control traffic instead of using port specifications. |
| [AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object) | AnyConnect Client Profile objects are file objects and represent files used in configurations, typically for remote access VPN policies. They can contain an AnyConnect Client Profile and AnyConnect Client Image files. |
| [Certificate Filter](#Certificate_Objects) | Digital certificates provide digital identification for authentication. Certificates are used for SSL (Secure Socket Layer), TLS (Transport Layer Security), and DTLS (Datagram TLS) connections, such as HTTPS and LDAPS. |
| [DNS Group](#Cisco_Concept.dita_925432d7-66d2-4f93-bab6-8869fc832388) | DNS servers are needed to resolve fully-qualified domain names (FQDN), such as www.example.com, to IP addresses. You can configure different DNS group objects for management and data interfaces. |
| [Geolocation](#Create_a_Geolocation_Object) | A geolocation object defines countries and continents that host the device that is the source or destination of traffic. You can use these objects in policies to control traffic instead of using IP addresses. |
| [IKEv1 Policy](#Create_or_Edit_an_FTD_IKEv1Policy) | An IKEv1 policy object contain the parameters required for IKEv1 policies when defining VPN connections. |
| IKEv2 Policy | An IKEv2 policy objects contain the parameters required for IKEv2 policies when defining VPN connections. |
| IKEv1 IPSEC Proposal | IPsec Proposal objects configure the IPsec proposal used during IKE Phase 1 negotiations. The IPsec proposal defines the combination of security protocols and algorithms that secure traffic in an IPsec tunnel. |
| IKEv2 IPSEC Proposal | IPsec Proposal objects configure the IPsec proposal used during IKE Phase 2 negotiations. The IPsec proposal defines the combination of security protocols and algorithms that secure traffic in an IPsec tunnel. |
| [Network](#About_Network_Objects) | Network groups and network objects (collectively referred to as network objects) define the addresses of hosts or networks. |
| [Security Zone](#Security_Zone_Object) | A security zone is a grouping of interfaces. Zones divide the network into segments to help you manage and classify traffic. |
| [Service](#ASA_Service_Objects) | Service objects, service groups, and port groups are reusable components that contain protocols or ports considered part of the TCP/IP protocol suite. |
| [SGT Group](#Create_an_FTD_SGT_Group) | A SGT dynamic object identifies source or destination addresses based on an SGT assigned by ISE and can then be matched against incoming traffic. |
| [Syslog Server](#Cisco_Concept.dita_8ad8638c-1934-4da0-834c-59b0d7a0df0b) | A syslog server object identifies a server that can receive connection-oriented or diagnostic system log (syslog) messages. |
| [URL](#Cisco_Concept.dita_a92f613b-e87e-4e4a-913d-50f9febe9234) | Use URL objects and groups (collectively referred to as URL objects) to define the URL or IP addresses of web requests. You can use these objects to implement manual URL filtering in access control policies or blocking in Security Intelligence policies. |

#### Shared Objects

Security Cloud Control calls objects on multiple devices with the same name and same contents, shared objects. Shared objects are identified by this icon
![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453370.jpg)
 on the Objects page. Shared objects make it easy to maintain policies because you can modify an object in one place and that change affects
all the other policies that use that object. Without shared objects, you would need to modify all the policies individually
that require the same change.

When looking at a shared object, Security Cloud Control shows you the contents of the object in the object table. Shared objects have exactly the same contents. Security Cloud Control shows you a combined or "flattened" view of the elements of the object in the details pane. Notice that in the details pane,
the network elements are flattened into a simple list and not directly associated with a named object.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453504.jpg)

#### Object Overrides

An object override allows you to override the value of a shared network object on specific devices. Security Cloud Control uses the corresponding value for the devices that you specify when configuring the override. Although the objects are on
two or more devices with the same name but different values, Security Cloud Control doesn't identify them as **Inconsistent objects** only because these values are added as overrides.

You can create an object whose definition works for most devices, and then use overrides to specify modifications to the object
for the few devices that need different definitions. You can also create an object that needs to be overridden for all devices,
but its use allows you to create a single policy for all devices. Object overrides allow you to create a smaller set of shared
policies for use across devices without giving up the ability to alter policies when needed for individual devices.

For example, consider a scenario where you have a printer server in each of your offices, and you have created a printer server
object `print-server`. You have a rule in your ACL to deny printer servers from accessing the internet. The printer server object has a default
value that you want to change from one office to another. You can do this by using object overrides and maintain rule and
"printer-server" object consistent across all locations, although their values may be different.

![](/c/dam/en/us/td/i/400001-500000/470001-480000/471001-472000/471164.jpg)

| **Note** | ---   Security Cloud Control allows you to override objects associated with the rules in a ruleset. When you add a new object to a rule, you can override it only after you attach a device to the ruleset and save the changes. See [Configure Rulesets for an FTD](#Configure_Rulesets_for_an_FTD) for more information.   --- |
| --- | --- |

| **Note** | ---   If there are inconsistent objects, you can combine them into a single shared object with overrides. For more information, see [Resolve Inconsistent Object Issues](troubleshooting.html#Resolve_Inconsistent_Object_Issues).   --- |
| --- | --- |

#### Unassociated Objects

You can create objects for immediate use in rules or policies. You can also create an object that is unassociated with any
rule or policy. When you use that unassociated object in a rule or policy, Security Cloud Control creates a copy of it and uses the copy. The original unassociated object remains among the list of available objects until
it is either deleted by a nightly maintenance job, or you delete it.

Unassociated objects remain in Security Cloud Control as a copy to ensure that not all configurations are lost if the rule or policy associated with the object is deleted accidentally.

In the left pane, click Objects > ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453412.jpg) and check the **Unassociated** checkbox.

#### Compare Objects

##### Procedure

---

| **Step 1** | In the left pane, click Objects and choose an option. |
| --- | --- |
| **Step 2** | Filter the objects on the page to find the objects you want to compare. |
| **Step 3** | Click the Compare button . |
| **Step 4** | Select up to three objects to compare. |
| **Step 5** | View the objects, side-by-side, at the bottom of the screen.   * Click the up and down arrows in the Object Details title bar to see more or less of the Object Details. * Expand or collapse the Details and Relationships boxes to see more or less information. |
| **Step 6** | (Optional) The Relationships box shows how an object is used. It may be associated with a device or a policy. If the object is associated with a device, you can click the device name and then click View Configuration to see the configuration of the device. Security Cloud Control shows you the device's configuration file and highlights the entry for that object. |

---

#### Filters

You can use many different filters on the Security Devices and **Objects** pages to find the devices and objects you are looking for.

To filter, click ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453412.jpg) in the left-hand pane of the Security Devices, Policies, and Objects tabs:

The Security Devices filter allows you to filter by device type, hardware and software versions, snort version, configuration
status, connection states, conflict detection, and secure device connectors, and labels. You can apply filters to find devices
within a selected device type tab. You can use filters to find devices within the selected device type tab.

| **Note** | ---   When the FTD tab is opened, the filter pane provides filters to show FDM-managed devices based on the management application through which the devices are accessed from Security Cloud Control.   * FDM: Devices managed using FTD API or FDM. * FMC-FTD: Devices managed using Firepower Management Center. * FTD: Devices managed using FTD Management.  --- |
| --- | --- |

The object filter allows you to filter by device, issue type, shared objects, unassociated objects, and object type. You can
include system objects in your results or not. You can also use the search field to search for objects in the filter results
that contain a certain name, IP address, or port number.

The object type filter allows you to filter objects by type, such as network object, network group, URL object, URL group,
service object, and service group. The shared objects filter allows filtering objects having default values or override values.

When filtering devices and objects, you can combine your search terms to create several potential search strategies to find
relevant results.

In the following example, filters are applied to search objects that are "Issues (Used OR Inconsistent) AND Shared Objects
with Additional Values.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453425.jpg)

* [Object Filters](#About_Object_Filters)

##### Object Filters

To filter, click ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453412.jpg) in the left-hand pane of the Objects tab:

* Filter by Device: Lets you pick a specific device so that you can see objects found on the selected device.
* Issues: Lets you pick unused, duplicate, and inconsistent objects to view.
* Ignored Issues: Lets you view all the objects whose inconsistencies you had ignored.
* Shared Objects: Lets you view all the objects that Security Cloud Control has found to be shared on more than one device. You can choose to see shared objects with only default values or override
  values, or both.
* Unassociated Objects: Lets you view all the objects that are not associated with any rule or policy.
* Object Type: Lets you select an object type to see only those type of objects that you have selected, such as network objects, network
  groups, URL objects, URL groups, service objects, and service groups.

Sub filters – Within each main filter, there are sub-filters you can apply to further narrow down your selection. These sub-filters are
based on Object Type – Network, Service, Protocol, etc.

The selected filters in this filter bar would return objects that match the following criteria:

**\*** Objects that are on one of two devices. (Click Filter by
Device to specify the devices.) AND are

 **\* Inconsistent** objects AND are

 **\* Network** objectsOR **Service** objects AND

**\*** Have the word "**group**" in their object naming convention

Because Show System Objects is checked, the result would include both
system objects and user-defined objects.

###### Show System-Defined Objects Filter

Some devices come with pre-defined objects for common services. These system objects
are convenient because they are already made for you and you can use them in your
rules and policies. There can be many system objects in the objects table. System
objects cannot be edited or deleted.

Show System-Defined Objects is **off** by default. To display system objects in the object table, check Show System-Defined Objects in the filter bar. To hide system objects in the object table, leave Show System Objects unchecked in the filter bar.

If you hide system objects, they will not be included in your search and filtering
results. If you show system objects, they will be included in your object search and
filtering results.

* [Configure Object Filters](#Configure_Object_Filters)
* [When to Exclude a Device from Filter Criteria](#When_to_Excludea_Device_from_Filter_Criteria)

###### Configure Object Filters

You can filter on as few or as many criteria as you want. The more categories you filter by, the fewer results you should
expect.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Open the filter panel by clicking the filter icon  at the top of the page. Uncheck any filters that have been checked to make sure no objects are inadvertently filtered out. Additionally, look at the search field and delete any text that may have been entered in the search field. |
| **Step 3** | If you want to restrict your results to those found on particular devices:   1. Click Filter By Device. 2. Search all the devices or click a device tab to search for only devices of a certain kind. 3. Check the device you want to include in your filter criteria. 4. Click OK. |
| **Step 4** | Check Show System Objects to include system objects in your search results. Uncheck Show System Objects to exclude system objects from your search results. |
| **Step 5** | Check the object Issues you want to filter by. If you check more than one issue, objects in any of the categories you check are included in your filter results. |
| **Step 6** | Check Ignored issues if you want to see the object that had issues but was ignored by the administrator. |
| **Step 7** | Check the required filter in Shared Objects if you are filtering for objects shared between two or more devices.   * Default Values: Filters objects having only the default values. * Override Values: Filters objects having overridden values. * Additional Values: Filters objects having additional values. |
| **Step 8** | Check Unassociated if you are filtering for objects that are not part of any rule or policy. |
| **Step 9** | Check the Object Types you want to filter by. |
| **Step 10** | You can also add an object name, IP address, or port number to the Objects search field to find objects with your search criteria among the filtered results. |

---

###### When to Exclude a Device from Filter Criteria

When adding a device to filtering criteria, the results show you the objects on a device but not
the relationships of those objects to other devices. For example, assume **ObjectA**
is shared between ASA1 and ASA2. If you were to filter objects to find shared objects on
ASA1, you would find **ObjectA** but the Relationships pane
would only show you that the object is on ASA1.

To see all the devices to which an object is related, don't specify a device in your search criteria. Filter by the other
criteria and add search criteria if you choose to. Select an object that Security Cloud Control identifies and then look in the Relationships pane. You will see all the devices and policies the object is related to.

#### Unignore Objects

One way to resolve unused, duplicate, or inconsistent objects is to ignore them. You may decide that though an object is [unused](troubleshooting.html#Resolve_an_Unused_Object_Issue), a [duplicate](troubleshooting.html#Resolve_Duplicate_Object_Issues), or [inconsistent](troubleshooting.html#Resolve_Inconsistent_Object_Issues), there are valid reasons for that state and you choose to leave the object issue unresolved. At some point in the future,
you may want to resolve those ignored objects. As Security Cloud Control does not display ignored objects when you search for object issues, you will need to filter the object list for ignored objects
and then act on the results.

##### Procedure

---

| **Step 1** | In the left pane, click Objects and choose an option. |
| --- | --- |
| **Step 2** | [Filter and search for ignored objects](#About_Object_Filters). |
| **Step 3** | In the **Object** table, select the object you want to unignore. You can unignore one object at a time. |
| **Step 4** | Click Unignore in the details pane. |
| **Step 5** | Confirm your request. Now, when you filter your objects by issue, you should find the object that was previously ignored. |

---

#### Deleting Objects

You can delete a single object or mulitple objects.

* [Delete a Single Object](#Delete_a_Single_Object)
* [Delete a Group of Unused Objects](#Cisco_Task_in_List_GUI.dita_a24c863f-b291-4353-b9d7-c52871b881ea)

##### Delete a Single Object

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object you want to delete by using object filters and the search field, and select it. |
| **Step 3** | Review the Relationships pane. If the object is used in a policy or in an object group, you cannot delete the object until you remove it from that policy or group. |
| **Step 4** | In the Actions pane, click the Remove icon  . |
| **Step 5** | Confirm that you want to delete the object by clicking OK. |
| **Step 6** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made, or wait and deploy multiple changes at once. |

---

##### Delete a Group of Unused Objects

As you onboard devices and start resolving object issues, you find many unused
objects. You can delete up to 50 unused objects at a time.

###### Procedure

---

| **Step 1** | Use the Issues filter to find **unused** objects. You can also use the Device filter to find objects that are not associated with a device by selecting No Device. Once you have filtered the object list, the object checkboxes appear. |
| --- | --- |
| **Step 2** | Check the Select all checkbox in the object table header to select all the objects found by the filter that appear in the object table; or, check individual checkboxes for individual objects you want to delete. |
| **Step 3** | In the Actions pane, click the Remove icon . |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Network Objects

A network object can contain a host name, a network IP address, a range of IP addresses, a fully qualified domain name (FQDN), or a subnetwork
expressed in CIDR notation. Network groups are collections of network objects and other individual addresses or subnetworks you add to the group. Network objects and
network groups are used in access rules, network policies, and NAT rules. You can create, update, and delete network objects and network groups using Security Cloud Control.

Note that not all platforms support network objects, such as Cisco Merkai and Multicloud Defense; when you share dynamic objects, Security Cloud Control automatically translates the appropriate information from the originating platform or device into a set of usable information
that Security Cloud Control can use.

Table 2. Pemitted Values of Network Objects

| Device type | IPv4 / IPv6 | Single Address | Range of addresses | Fully Qualified Domain Name | Subnet using CIDR Notation |
| --- | --- | --- | --- | --- | --- |
| FTD | IPv4 and IPv6 | Yes | Yes | Yes | Yes |
| Multicloud Defense | IPv4 and IPv6 | Yes | Yes | Yes | Yes |

Table 3. Pemitted Contents of a Network Group

| Device type | IP Value | Network Object | Network Groups |
| --- | --- | --- | --- |
| FTD | No | Yes | Yes |
| Multicloud Defense | Yes | Yes | Yes |

##### Reusing Network Objects Across Products

If you have a Security Cloud Control tenant with a cloud-delivered Firewall
Management Center
and one or more on-premises management centers onboarded to your tenant:

* When you create a Secure Firewall Threat
  Defense, FDM-managed
  threat defense, ASA, or Meraki  network object or group, a copy of the object is also added to the objects list on the Objects page used when configuring cloud-delivered Firewall
  Management Center, and vice versa.
* When you create a Secure Firewall Threat
  Defense, FDM-managed
  threat defense, or ASA network object or group, an entry is created in the Devices with Pending Changes page for each On-Premises Firewall Management Center for which Discover & Manage Network Objects is enabled. From this list, you can choose and deploy the object to the on-premises management center on which you want to use the object and discard the ones that you do not want. Navigate , Administration > Firewall Management Center select the on-premises management center, and click Objects to see your objects in the On-Premises Firewall Management Center user interface and assign them to policies.

Changes you make to network objects or groups on either page apply to the object or group instance on both pages. Deleting
an object from one page also deletes the corresponding copy of the object from the other page.

**Exceptions**:

* If a network object of the same name already exists for cloud-delivered Firewall
  Management Center, the new Secure Firewall Threat
  Defense, FDM-managed
  threat defense, ASA, or Meraki  network object will not be replicated on the Objects page of Security Cloud Control.
* Network objects and groups in onboarded threat defense devices that are managed by on-premises Secure Firewall Management Center are not replicated and cannot be used in cloud-delivered Firewall
  Management Center.

  Note that for on-premises Secure Firewall Management Center instances that have been *migrated* to cloud-delivered Firewall
  Management Center, network objects and groups *are* replicated to the Security Cloud Control objects page if they are used in policies that were deployed to FTD devices.
* Sharing Network Objects between Security Cloud Control and cloud-delivered Firewall
  Management Center is automatically enabled on new tenants but must be requested for existing tenants. If your network objects are not being
  shared with cloud-delivered Firewall
  Management Center, [contact TAC](faq-and-support.html#Open_a_Support_Ticket_with_TAC) to have the features enabled on your tenant.
* Sharing network objects between Security Cloud Control and On-Premises Management Center is not automatically enabled on Security Cloud Control for new on-premises management centers onboarded to Security Cloud Control. If your network objects are not being shared with On-Premises Management Center, ensure Discover & Manage Network Objects toggle button is enabled for the on-premises management center in Settings or [contact TAC](faq-and-support.html#Open_a_Support_Ticket_with_TAC) to have the features enabled on your tenant.

##### Viewing Network Objects

Network objects you create using Security Cloud Control and those Security Cloud Control recognizes in an onboarded device's configuration are displayed on the Objects page. They are labeled with their object type.
This allows you to filter by object type to quickly find the object you are looking for.

When you select a network object on the Objects page, you see the object's values in the Details pane. The Relationships pane
shows you if the object is used in a policy and on what device the object is stored.

When you click on a network group you see the contents of that group. The network group is a conglomerate of all the values
given to it by the network objects.

* [Create or Edit a Firepower Network Object or Network Groups](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups)

**Related Information:**

* [Create or Edit a Firepower Network Object or Network Group](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups)

##### Create or Edit a Firepower Network Object or Network Groups

A Firepower network object can contain a hostname, an IP address, or a subnet address expressed in CIDR notation. Network groups are conglomerates of network objects and network groups that are used in access rules, network policies, and NAT rules. You
can create, read, update, and delete network objects and network groups using Security Cloud Control.

Firepower network objects and groups can be used by ASA, threat defense, FDM-managed, and Meraki devices. See [Reusing Network Objects Across Products](#About_Network_Objects__reusing_netw_obj).

| **Note** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  When you create an FTD, FDM, or ASA network object or group on the Objects page, a copy of the object is automatically added to the cloud-delivered Firewall Management Center and vice-versa. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the objects to the on-premises management center on which you want these objects.   --- |
| --- | --- |

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

Table 4. IP addresses that can be added to network objects

| Device type | IPv4 / IPv6 | Single Address | Range of addresses | Partially Qualified Domain Name (PQDN) | Subnet using CIDR Notation |
| --- | --- | --- | --- | --- | --- |
| Firepower | IPv4 / IPv6 | Yes | Yes | Yes | Yes |

* [Create a Firepower Network Object](#Create_a_FirepowerNetwork_Object)
* [Create a Firepower Network Group](#Create_a_FirepowerNetworkGroup)
* [Edit a Firepower Network Object](#Edit_a_Firepower_Network_Object)
* [Edit a Firepower Network Group](#Edit_a_Firepower_NetworkGroup)
* [Add an Object Override](#Cisco_Task.dita_08e1fc0f-3310-4dac-84ce-c56a76c729dc)
* [Edit Object Overrides](#EditObject_Overrides)
* [Add Additional Values to a Shared Network Group](#Add_Additional_Values_to_a_Shared_Network_Group)
* [Edit Additional Values in a Shared Network Group](#EditAdditional_Values_in_aShared_Network_Group)
* [Deleting Network Objects and Groups in Security Cloud Control](#Cisco_Concept.dita_72c5bc7d-f8b9-498e-82cb-c4a81c0ac83f)

**Related Information**:

* [Create a Firepower Network Object](#Create_a_FirepowerNetwork_Object)
* [Edit a Firepower Network Object](#Edit_a_Firepower_Network_Object)
* [Add Additional Values to a Shared Network Group](#Add_Additional_Values_to_a_Shared_Network_Group)
* [Edit Additional Values in a Shared Network Group](#EditAdditional_Values_in_aShared_Network_Group)

###### Create a Firepower Network Object

| **Note** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  When you create an FTD, FDM, or ASA network object or group on the Objects page, a copy of the object is automatically added to the cloud-delivered Firewall Management Center and vice-versa. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the objects to the on-premises management center on which you want these objects.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click the blue plus button  to create an object. |
| **Step 3** | Click FTD > Network. |
| **Step 4** | Enter an Object Name. |
| **Step 5** | Select Create a network object. |
| **Step 6** | In the Value section:   * Select eq and enter a single IP address, a subnet address expressed in CIDR notation, or a Partially Qualified Domain Name (PQDN). * Select range and enter an IP address range.  | **Note** | Do not set a host bit value. If you enter a host bit value other than 0, Security Cloud Control unsets it while creating the object, because the cloud-delivered Firewall Management Center only accepts IPv6 objects with host bits not set. | | --- | --- | |
| **Step 7** | Click Add.  Attention: The newly created network objects aren't associated with any FDM-managed device as they aren't part of any rule or policy. To see these objects, select the Unassociated objects category in object filters. For more information, see [Object Filters](#Configure_Object_Filters). Once you use the unassociated objects in a device's rule or policy, such objects are associated with that device. |

---

###### Create a Firepower Network Group

A network group can contain network objects and network groups. When you
create a new network group, you can search for existing objects by their name, IP
addresses, IP address range, or FQDN and add them to the network group. If the
object isn't present, you can instantly create that object in the same interface and
add it to the network group.

| **Note** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  When you create an FTD, FDM, or ASA network object or group on the Objects page, a copy of the object is automatically added to the cloud-delivered Firewall Management Center and vice-versa. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the objects to the on-premises management center on which you want these objects.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click the blue plus button  to create an object. |
| **Step 3** | Click FTD > Network. |
| **Step 4** | Enter an Object Name. |
| **Step 5** | Select Create a network group. |
| **Step 6** | In the Values field, enter a value or name. When you start typing, Security Cloud Control provides object names or values that match your entry. |
| **Step 7** | You can choose one of the existing objects shown or create a new one based on the name or value that you have entered. |
| **Step 8** | If Security Cloud Control finds a match, to choose an existing object, click Add to add the network object or network group to the new network group. |
| **Step 9** | If you have entered a value or object that is not present, you can perform one of the following:   * Click Add as New Object With This Name to create a new object with that name. Enter a value and click the checkmark to save it. * Click Add as New Object to create a new object. The object name and value are the same. Enter a name and click the checkmark to save it.   It's is possible to create a new object even though the value is already present. You can make changes to those objects and save them.  Note: You can click the edit icon to modify the details. Clicking the delete button doesn't delete the object itself; instead, it removes it from the network group. |
| **Step 10** | After adding the required objects, click Save to create a new network group. |
| **Step 11** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### Edit a Firepower Network Object

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object you want to edit by using object filters and search field. |
| **Step 3** | Select the network object and click the edit icon  in the Actions pane. |
| **Step 4** | Edit the values in the dialog box in the same fashion that you created them in "Create a Firepower Network Group".   | **Note** | Click the delete icon next to remove the object from the network group. | | --- | --- | |
| **Step 5** | Click Save. Security Cloud Control displays the devices that will be affected by the change. |
| **Step 6** | Click Confirm to finalize the change to the object and any devices affected by it. |

---

###### Edit a Firepower Network Group

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the network group you want to edit by using object filters and search field. |
| **Step 3** | Select the network group and click the edit icon  in the Actions pane. |
| **Step 4** | Change the object name and description if needed. |
| **Step 5** | If you want to change the objects or network groups that are already added to the network group, perform the following steps:   1. Click the edit icon  appearing beside the object name or network group to modify them. 2. Click the checkmark to save your changes. Note: You can click the remove icon to delete the value from a network group. |
| **Step 6** | If you want to add new network objects or network groups to this network group, you have to perform the following steps:   1. In the Values field, enter a new value or the name of an existing network object. When you start typing, Security Cloud Control provides object names or values that match your entry. You can choose one of the existing objects shown or create a new one    based on the name or value that you have entered. 2. If Security Cloud Control finds a match, to choose an existing object, click Add to add the network object or network group to the new network group. 3. If you have entered a value or object that is not present, you can perform one of the following:     * Click Add as New Object With This Name to create a new object with that name. Enter a value and click the checkmark to save it.    * Click Add as New Object to create a new object. The object name and value are the same. Enter a name and click the checkmark to save it.   It's is possible to create a new object even though the value is already present. You can make changes to those objects and save them. |
| **Step 7** | Click Save. Security Cloud Control displays the policies that will be affected by the change. |
| **Step 8** | Click Confirm to finalize the change to the object and any devices affected by it. |
| **Step 9** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### Add an Object Override

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object to which you want to add an override, using object filters and search field. |
| **Step 3** | Select the network object and click the edit icon  in the Actions pane. |
| **Step 4** | Enter the value in the Override Values dialog box and click + Add Value.   | **Important** | The override you are adding must have the same type of value that the object contains. For example, to a network object, you can configure an override only with a network value and not a host value. | | --- | --- | |
| **Step 5** | Once you see that the value is added, click the cell in the Devices column in Override Values. |
| **Step 6** | Click Add Devices, and choose the device to which you want the override to be added. The device you select must contain the object to which you are adding the override. |
| **Step 7** | Click Save. Security Cloud Control displays the devices that will be affected by the change. |
| **Step 8** | Click Confirm to finalize the addition of the override to the object and any devices affected by it.   | **Note** | You can add more than one override to an object. However, you must select a different device, which contains the object, each time you are adding an override. | | --- | --- | |
| **Step 9** | See [Object Overrides](#Object_Overrides) to know more about object overrides and [Edit Object Overrides](#EditObject_Overrides) to edit an existing override. |

---

###### Edit Object Overrides

You can modify the value of an existing override as long as the object is present on the device.

###### Procedure

---

| **Step 1** | In the Security Cloud Control navigation bar on the left, click Objects. |
| --- | --- |
| **Step 2** | Locate the object having override you want to edit by using object filters and search field. |
| **Step 3** | Select the object having override and click the edit icon  in the Actions pane. |
| **Step 4** | Modify the override value:   * Click the edit icon to modify the value. * Click on the cell in the Devices column in Override Values to assign new devices. You can select an already assigned device and click Remove Overrides to remove overrides on that device. * Click  arrow in Override Values to push and make it as the default value of the shared object. * Click the delete icon next to the override you want to remove. |
| **Step 5** | Click Save. Security Cloud Control displays the devices that will be affected by the change. |
| **Step 6** | Click Confirm to finalize the change to the object and any devices affected by it. |
| **Step 7** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### Add Additional Values to a Shared Network Group

The values in a shared network group that are present on all devices associated with it are called "default values". Security Cloud Control allows you to add "additional values" to the shared network group and assign those values to some devices associated with
that shared network group. When Security Cloud Control deploys the changes to the devices, it determines the contents and pushes the "default values" to all devices associated
with the shared network group and the "additional values" only to the specified devices.

For example, consider a scenario where you have four AD main servers in your head office that should be accessible from all
your sites. Therefore, you have created an object group named "Active-Directory" to use in all your sites. Now you want to
add two more AD servers to one of your branch offices. You can do this by adding their details as additional values specific
to that branch office on the object group "Active-Directory". These two servers do not participate in determining whether
the object "Active-Directory" is consistent or shared. Therefore, the four AD main servers are accessible from all your sites,
but the branch office (with two additional servers) can access two AD servers and four AD main servers.

| **Note** | ---   If there are inconsistent shared network groups, you can combine them into a single shared network group with additional values. See [Resolve Inconsistent Object Issues](troubleshooting.html#Resolve_Inconsistent_Object_Issues) for more information.   --- |
| --- | --- |

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the shared network group you want to edit by using object filters and search field. |
| **Step 3** | Click the edit icon  in the Actions pane.   * The Devices field shows the devices the shared network group is present. * The Usage field shows the rulesets associated with the shared network group. * The Default Values field specifies the default network objects and their values associated with the shared network group that was provided during   their creation. Next to this field, you can see the number of devices that contain this default value, and you can click to   see their names and device types. You can also see the rulesets associated with this value. |
| **Step 4** | In the Additional Values field, enter a value or name. When you start typing, Security Cloud Control provides object names or values that match your entry. |
| **Step 5** | You can choose one of the existing objects shown or create a new one based on the name or value that you have entered. |
| **Step 6** | If Security Cloud Control finds a match, to choose an existing object, click Add to add the network object or network group to the new network group. |
| **Step 7** | If you have entered a value or object that is not present, you can perform one of the following:   * Click Add as New Object With This Name to create a new object with that name. Enter a value and click the checkmark to save it. * Click Add as New Object to create a new object. The object name and value are the same. Enter a name and click the checkmark to save it.   It's is possible to create a new object even though the value is already present. You can make changes to those objects and save them. |
| **Step 8** | In the Devices column, click the cell associated with the newly added object and click Add Devices. |
| **Step 9** | Select the devices that you want and click OK. |
| **Step 10** | Click Save. Security Cloud Control displays the devices that will be affected by the change. |
| **Step 11** | Click Confirm to finalize the change to the object and any devices affected by it. |
| **Step 12** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### Edit Additional Values in a Shared Network Group

| **Caution** | ---   If cloud-delivered Firewall Management Center is deployed on your tenant:  Changes you make to the ASA, FDM, and FTD network objects and groups are reflected in the corresponding cloud-delivered Firewall Management Center network object or group. In addition, an entry is created in the Devices with Pending Changes page for each on-premises management center with Discover & Manage Network Objects enabled, from which you can choose and deploy the changes to the on-premises management center on which you have these objects.  Deleting a network object or group from either page deletes the object or group from both pages.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object having the override you want to edit by using object filters and search field. |
| **Step 3** | Click the edit icon  in the Actions pane. |
| **Step 4** | Modify the override value:   * Click the edit icon to modify the value. * Click the cell in the Devices column to assign new devices. You can select an already assigned device and click Remove Overrides to remove overrides on that device. * Click  arrow in Default Values to push and make it an additional value of the shared network group. All devices associated with the shared network group   are automatically assigned to it. * Click  arrow in Override Values to push and make it as default objects of the shared network group. * Click the delete icon next to remove the object from the network group. |
| **Step 5** | Click Save. Security Cloud Control displays the devices that will be affected by the change. |
| **Step 6** | Click Confirm to finalize the change to the object and any devices affected by it. |
| **Step 7** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### Deleting Network Objects and Groups in Security Cloud Control

If Cloud-delivered Firewall Management
Center is deployed on your tenant:

Deleting a network object or group from the Objects page deletes the replicated network object or group from the Objects page on the cloud-delivered Firewall
Management Center and vice-versa.

#### URL Objects

URL objects and URL groups are used by Firepower devices. Use URL objects and groups
(collectively referred to as URL objects) to define the URL or IP addresses of web
requests. You can use these objects to implement manual URL filtering in access control
policies or blocking in Security Intelligence policies. A URL object defines a single
URL or IP address, whereas a URL group defines more than one URL or IP address.

##### Before You Begin

When creating URL objects, keep the following points in mind:

* If you do not include a path (that is, there is no / character in the URL),
  the match is based on the server's hostname only. The hostname is considered
  a match if it comes after the :// separator, or after any dot in the
  hostname. For example, ign.com matches ign.com and www.ign.com, but it does
  not match verisign.com.
* If you include one or more / character, the entire URL string is used for a
  substring match, including the server name, path, and any query parameters.
  However, we recommend that you do not use manual URL filtering to block or
  allow individual web pages or parts of sites, as servers can be reorganized
  and pages moved to new paths. Substring matching can also lead to unexpected
  matches, where the string you include in the URL object also matches paths
  on unintended servers or strings within query parameters.
* The system disregards the encryption protocol (HTTP vs HTTPS). In other
  words, if you block a website, both HTTP and HTTPS traffic to that website
  is blocked, unless you use an application condition to target a specific
  protocol. When creating a URL object, you do not need to specify the
  protocol when creating an object. For example, use example.com rather than
  <http://example.com>.
* If you plan to use a URL object to match HTTPS traffic in an access control
  rule, create the object using the subject common name in the public key
  certificate used to encrypt the traffic. Also, the system disregards
  subdomains within the subject common name, so do not include subdomain
  information. For example, use example.com rather than www.example.com.

  However, please understand that the subject common name in the certificate
  might be completely unrelated to a web site's domain name. For example, the
  subject common name in the certificate for youtube.com is \*.google.com (this
  of course might change at any time). You will get more consistent results if
  you use the SSL Decryption policy to decrypt HTTPS traffic so that URL
  filtering rules work on decrypted traffic.

  | **Note** | ---   URL objects will not match HTTPS traffic if the browser resumes a TLS session because the certificate information is no longer available. So even if you carefully configure the URL object, you might get inconsistent results for HTTPS connections.   --- |
  | --- | --- |

* [Create or Edit an FDM-Managed URL Object](#Create_a_FirepowerURLObject)
* [Create a Firepower URL Group](#Create_a_FirepowerURL_Group)

##### Create or Edit an FDM-Managed URL Object

URL objects are reusable components that specify a URL or IP address.

To create a URL object, follow these steps:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > URL. |
| **Step 3** | Enter an object name and description. |
| **Step 4** | Select Create a URL object. |
| **Step 5** | Enter the specific URL or IP address for your object. |
| **Step 6** | Click Add. |

---

##### Create a Firepower URL Group

A URL group can be made up of one or more URL objects representing one or more URLs or IP addresses. The Firepower Device
Manager and Firepower Management Center also refer to these objects as "URL Objects."

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > URL. |
| **Step 3** | Enter an object name and description. |
| **Step 4** | Select Create a URL group. |
| **Step 5** | Add an existing object by clicking Add Object, selecting an object, and clicking Select. Repeat this step to add more objects. |
| **Step 6** | Click Add when you are done adding URL objects to the URL group. |

---

* [Edit a Firepower URL Object or URL Group](#EditaFirepowerURL_Object_orURLGroup)

###### Edit a Firepower URL Object or URL Group

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Filter the objects to find the object you want to edit and then select the object in the object table. |
| **Step 3** | In the details pane, click  to edit. |
| **Step 4** | Edit the values in the dialog box in the same fashion that you created them in the procedures above. |
| **Step 5** | Click Save. |
| **Step 6** | Security Cloud Control displays the policies that will be affected by the change. Click Confirm to finalize the change to the object and any policy affected by it. |

---

#### Application Filter Objects

Application filter objects are used by Firepower devices. An application filter object defines the applications used in an
IP connection, or a filter that defines applications by type, category, tag, risk, or business relevance. You can use these
objects in policies to control traffic instead of using port specifications.

Although you can specify individual applications, application filters simplify policy creation and administration. For example,
you could create an access control rule that identifies and blocks all high risk, low business relevance applications. If
a user attempts to use one of those applications, the session is blocked.

You can select applications and application filters directly in a policy without using application filter objects. However,
an object is convenient if you want to create several policies for the same group of applications or filters. The system includes
several pre-defined application filters, which you cannot edit or delete.

| **Note** | ---   Cisco frequently updates and adds additional application detectors via system and vulnerability database (VDB) updates. Thus, a rule blocking high risk applications can automatically apply to new applications without you having to update the rule manually.   --- |
| --- | --- |

| **Note** | ---   When an FDM-managed device is onboarded to Security Cloud Control, it converts the application filters to application filter objects without altering the rule defined in Access Rule or SSL Decryption. Because of a configuration change, the device's configuration status is changed to 'Not Synced' and requires configuration deployment from Security Cloud Control. In general, FDM does not convert the application filters to application filter objects until you manually save the filters.   --- |
| --- | --- |

* [Create and Edit a Firepower Application Filter Object](#Create_and_Edit_a_Firepower_Application_Filter_Object)

**Related Information:**

* [Create and Edit a Firepower Application Filter Object](#Create_and_Edit_a_Firepower_Application_Filter_Object)
* [Deleting Objects](#Deleting_Objects)

##### Create and Edit a Firepower Application Filter Object

An application filter object allows you to target hand-picked applications or a group of applications identified by the filters.
This application filter objects can be used in policies.

* [Create a Firepower Application Filter Object](#Create_a_Firepower_Application_Filter_Object)
* [Edit a Firepower Application Filter Object](#Edit_a_Firepower_Application_Filter_Object)

###### Create a Firepower Application Filter Object

To create an application filter object, follow this procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > Application Filter. |
| **Step 3** | Enter an object name for the object and optionally, a description. |
| **Step 4** | Click Add Filter and select the applications and filters to add to the object.  The initial list shows applications in a continually scrolling list. Click Advanced Filter to see the filter options and to get an easier view for selecting applications. Click Add when you have made your selections. You can repeat the process to add additional applications or filters.   | **Note** | Multiple selections within a single filter criteria have an OR relationship. For example, Risk is High OR Very High. The relationship between filters is AND, so Risk is High OR Very High, AND Business Relevance is Low OR Very Low. As you select filters, the list of applications in the display updates to show only those that meet the criteria. You can use these filters to help you find applications that you want to add individually, or to verify that you are selecting the desired filters to add to the rule. | | --- | --- |    Risks: The likelihood that the application is used for purposes that might be against your organization's security policy, from very low to very high.  Business Relevance: The likelihood that the application is used within the context of your organization's business operations, as opposed to recreationally, from very low to very high.  Types: The type of application.   * Application Protocol: Application protocols such as HTTP and SSH, which represent communications between hosts. * Client Protocol: Clients such as web browsers and email clients, which represent software running on the host. * Web Application: Web applications such as MPEG video and Facebook, which represent the content or requested URL for HTTP traffic.   Categories: A general classification for the application that describes its most essential function.  Tags: Additional information about the application, similar to category.  For encrypted traffic, the system can identify and filter traffic using only the applications tagged SSL Protocol. Applications without this tag can only be detected in unencrypted or decrypted traffic. Also, the system assigns the decrypted traffic tag to applications that the system can detect in decrypted traffic only, not encrypted or unencrypted.  Applications List (bottom of the display): This list updates as you select filters from the options above the list, so you can see the applications that currently match the filter. Use this list to verify that your filter is targeting the desired applications when you intend to add filter criteria to the rule. To add a specific application or applications to your object, select them from the filtered list. Once you select the applications, the filter will no longer apply. If you want the filter itself to be the object, do not select an application from the list. Then the object will represent ever application identified by the filter. |
| **Step 5** | Click OK to save your changes. |

---

###### Edit a Firepower Application Filter Object

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object you want to edit by using object filters and search field. |
| **Step 3** | Select the object you want to edit. |
| **Step 4** | Click the edit icon  in the Actions pane of the details panel. |
| **Step 5** | Edit the values in the dialog box in the same fashion that you created them in the procedures above. |
| **Step 6** | Click Save. |
| **Step 7** | Security Cloud Control displays the policies that will be affected by the change. Click Confirm to finalize the change to the object and any policy affected by it. |

---

**Related Information:**

* [Objects](#Objects)
* [Object Filters](#About_Object_Filters)
* [Delete a Firepower Object](#Deleting_Objects)

#### Geolocation Objects

A geolocation object defines countries and continents that host the device that is the source or destination of traffic. You
can use these objects in policies to control traffic instead of using IP addresses. For example, using geographical location,
you could easily restrict access to a particular country without needing to know all of the potential IP addresses used there.

You can typically select geographical locations directly in a policy without using geolocation objects. However, an object
is convenient if you want to create several policies for the same group of countries and continents.

##### Update Geolocation Database

To ensure that you are using up-to-date geographical location data to filter your traffic, Cisco strongly recommends that
you regularly update the geolocation database (GeoDB). At this time, this is not a task that you can perform using Security Cloud Control. See the following sections of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running to learn more about the GeoDB and how to update it.

* Updating System Databases and Feeds
* Updating System Databases

* [Create and Edit a Firepower Geolocation Filter Object](#Create_a_Geolocation_Object)

##### Create and Edit a Firepower Geolocation Filter Object

You can create a geolocation object by itself on the object page or when creating a security policy. This procedure creates
a geolocation object from the object page.

To create a geolocation object, follow these steps:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > Geolocation. |
| **Step 3** | Enter an object name for the object and optionally, a description. |
| **Step 4** | In the filter bar, start typing the name of a country or a region and you are presented with a list of possible matches. |
| **Step 5** | Check the country, countries, or regions that you want to add to the object. |
| **Step 6** | Click Add. |

---

* [Edit a Geolocation Object](#Edit_a_Geolocation_Object)

###### Edit a Geolocation Object

###### Procedure

---

| **Step 1** | In the left pane, choose Objects. |
| --- | --- |
| **Step 2** | Use the filter panes and search field to locate your object. |
| **Step 3** | In the Actions pane, click Edit. |
| **Step 4** | You can change the name of the object and add or remove countries and regions to your object. |
| **Step 5** | Click Save. |
| **Step 6** | You will be notified if any devices are impacted. Click Confirm. |
| **Step 7** | If a device or policy was impacted, open the Security Devices page and Preview and Deploy the changes to the device. |

---

#### DNS Group Objects

Domain Name System (DNS) groups define a list of DNS servers and some associated attributes. DNS servers are needed to resolve
fully-qualified domain names (FQDN), such as www.example.com, to IP addresses. You can configure different DNS group objects
for management and data interfaces.

FDM-managed devices must have a DNS server configured prior to creating a new DNS Group Object. You can either add a DNS Server to the [Firepower Threat Defense Device Settings](#Configure_DNS_Server) in Security Cloud Control or create a DNS server in firewall device manager and then sync the FDM-managed configuration to Security Cloud Control. To create or modify the DNS server settings in firewall device manager, see Configuring DNS for Data and Management Interfaces in the [Cisco Firepower Device Manager Configuration Guide](https://www.cisco.com/c/en/us/support/security/industrial-security-appliance-isa/products-installation-and-configuration-guides-list.html), Version 6.4. or later.

* [Create a DNS Group Object](#Create_a_DNS_Group_Object)
* [Edit a DNS Group Object](#Edit_a_DNS_Group_Object)
* [Delete a DNS Group Object](#Delete_a_DNS_Group_Object)
* [Add a DNS Group Object as an FDM-Managed DNS Server](#Add_a_DNS_Group_Object_as_an_FTD_DNS_Server)

##### Create a DNS Group Object

Use the following procedure to create a new DNS group object in Security Cloud Control:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > DNS Group. |
| **Step 3** | Enter an Object Name. |
| **Step 4** | (Optional) Add a description. |
| **Step 5** | Enter the IP address of a DNS server. You can add up to six DNS servers; click the Add DNS Server. If you want to remove a server address, click the delete icon.   | **Note** | The list is in priority order: the first server in the list is always used, and subsequent servers are used only if a response is not received from the servers above it. Although you can add up to six servers, only the first 3 servers listed will be used for the management interface. | | --- | --- | |
| **Step 6** | Enter the Domain Search Name. This domain is added to hostnames that are not fully-qualified, for example, serverA instead of serverA.example.com. |
| **Step 7** | Enter the amount of Retries. The number of times, from 0 to 10, to retry the list of DNS servers when the system does not receive a response. The default is 2. This setting applies to DNS groups used on the data interfaces only. |
| **Step 8** | Enter the Timeout value. The number of seconds, from 1 to 30, to wait before trying the next DNS server. The default is 2 seconds. Each time the system retries the list of servers, this timeout doubles. This setting applies to DNS groups used on the data interfaces only. |
| **Step 9** | Click Add. |

---

##### Edit a DNS Group Object

You can edit a DNS group object that was created in Security Cloud Control or in firewall device manager. Use the following procedure to edit an existing DNS group object:

###### Procedure

---

| **Step 1** | In the Security Cloud Control navigation bar on the left, click Objects. |
| --- | --- |
| **Step 2** | Locate the DNS Group Object you want to edit by using object filters and search field. |
| **Step 3** | Select the object and click the edit icon  in the Actions pane. |
| **Step 4** | Edit any of the following entries:   * Object Name. * Description. * DNS Server. You can edit, add, or remove DNS servers from this list. * Domain Search Name. * Retries. * Timeout. |
| **Step 5** | Click Save. |
| **Step 6** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

##### Delete a DNS Group Object

Use the following procedure to delete a DNS Group Object from Security Cloud Control:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the DNS Group Object you want to edit by using object filters and search field. |
| **Step 3** | Select the object and click the Remove icon . |
| **Step 4** | Confirm you want to delete the DNS group object and click Ok. |
| **Step 5** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

##### Add a DNS Group Object as an FDM-Managed DNS Server

You can add a DNS group object as the preferred DNS Group for either the Data Interface or the Management Interface. See [FDM-Managed Device Settings](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed) for more information.

#### Certificate Objects

Digital certificates provide digital identification for authentication. Certificates are used for SSL (Secure Socket Layer),
TLS (Transport Layer Security), and DTLS (Datagram TLS) connections, such as HTTPS and LDAPS.

See the About Certificates and Configuring Certificates following sections of the Resuable Objects chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running.

* [About Certificates](#About_Certificates)
* [Certificate Types Used by Feature](#Certificate_Types_Used_by_Feature)
* [Configuring Certificates](#Configuring_Certificates)
* [Uploading Internal and Internal CA Certificates](#Uploading_Internal_and_Internal_CA_Certificates)
* [Uploading Trusted CA Certificates](#Uploading_Trusted_CA_Certificates)
* [Generating Self-Signed Internal and Internal CA Certificates](#Generating_SelfSigned_Internal_and_Internal_CA_Certificates)

##### About Certificates

Digital certificates provide digital identification for authentication. A digital certificate includes information that identifies
a device or user, such as the name, serial number, company, department, or IP address. A digital certificate also includes
a copy of the public key for the user or device. Certificates are used for SSL (Secure Socket Layer), TLS (Transport Layer
Security), and DTLS (Datagram TLS) connections, such as HTTPS and LDAPS.

You can create the following types of certificate:

* Internal certificates—Internal identity certificates are certificates for specific systems or hosts. You can generate these yourself using the
  OpenSSL toolkit or get them from a Certificate Authority. You can also generate a self-signed certificate.

  The system comes with the following pre-defined internal certificates, which you can use as is or replace: DefaultInternalCertificate and DefaultWebServerCertificate
* Internal Certificate Authority (CA) certificates—Internal CA certificates are certificates that the system can use to sign other certificates. These certificates
  differ from internal identity certificates with respect to the basic constraints extension and the CA flag, which are enabled
  for CA certificates but disabled for identity certificates. You can generate these yourself using the OpenSSL toolkit or get
  them from a Certificate Authority. You can also generate a self-signed internal CA certificate. If you configure self-signed
  internal CA certificates, the CA runs on the device itself.

  The system comes with the following pre-defined internal CA certificate, which you can use as is or replace: NGFW-Default-InternalCA
* Trusted Certificate Authority (CA) certificates—A trusted CA certificate is used to sign other certificates. It is self-signed and called a root certificate.
  A certificate that is issued by another CA certificate is called a subordinate certificate.

  Certificate Authorities (CAs) are trusted authorities that "sign" certificates to verify their authenticity, thereby guaranteeing
  the identity of the device or user. CAs issue digital certificates in the context of a PKI, which uses public-key or private-key
  encryption to ensure security. A CA can be a trusted third party, such as VeriSign, or a private (in-house) CA that you establish
  within your organization. CAs are responsible for managing certificate requests and issuing digital certificates.

  The system includes many trusted CA certificates from third party Certificate Authorities. These are used by SSL decryption
  policies for Decrypt Re-Sign actions.

For more information, see the Certificate Types Used by Feature section of the Reusable Objects chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running.

##### Certificate Types Used by Feature

You need to create the right type of certificate for each feature. The following features require certificates.

Identity Policies (Captive Portal)—Internal Certificate

(Optional.) Captive portal is used in identity policies. Users must accept this certificate when authenticating to the device
for purposes of identifying themselves and receiving the IP address associated with their usernames. If you do not supply
a certificate, the device uses an automatically generated certificate.

SSL Decryption Policy—Internal, Internal CA, and Trusted CA Certificates.

(Required.) The SSL decryption policy uses certificates for the following purposes:

* Internal certificates are used for known key decryption rules.
* Internal CA certificates are used for decrypt re-sign rules when creating the session between the client and FDM-managed device.
* Trusted CA certificates

  + They are used indirectly for decrypt re-sign rules when creating the session between the FDM-managed device and server. Unlike the other certificates, you do not directly configure these certificates in the SSL decryption
    policy; they simply need to be uploaded to the system. The system includes a large number of trusted CA certificates, so you
    might not need to upload any additional certificates.
  + When creating an Active Directory Realm object and configuring the directory server to use encryption.

##### Configuring Certificates

Certificates used in identity policies or SSL decryption policies must be an X509 certificate in PEM or DER format. You can
use OpenSSL to generate certificates if needed, obtain them from a trusted Certificate Authority, or create self-signed certificates.

Use these procedures to configure certificate objects:

* [Uploading Internal and Internal CA Certificates](#Uploading_Internal_and_Internal_CA_Certificates)
* [Uploading Trusted CA Certificates](#Uploading_Trusted_CA_Certificates)
* [Generating Self-Signed Internal and Internal CA Certificate](#Generating_SelfSigned_Internal_and_Internal_CA_Certificates)
* To view or edit a certificate, click either the edit icon or the view icon for the certificate.
* To delete an unreferenced certificate, click the trash can icon (delete icon) for the certificate. See [Deleting Objects](#Deleting_Objects).

##### Uploading Internal and Internal CA Certificates

Internal identity certificates are certificates for specific systems or hosts. You can generate these yourself using the OpenSSL toolkit or get them from
a Certificate Authority. You can also generate a self-signed certificate.

Internal Certificate Authority (CA) certificates (Internal CA certificates) are certificates that the system can use to sign other certificates. These certificates differ
from internal identity certificates with respect to the basic constraints extension and the CA flag, which are enabled for
CA certificates but disabled for identity certificates. You can generate these yourself using the OpenSSL toolkit or get them
from a Certificate Authority. You can also generate a self-signed internal CA certificate. If you configure self-signed internal
CA certificates, the CA runs on the device itself.

For information on the features that use these certificates, see [Certificate Type Used by Feature](#Certificate_Types_Used_by_Feature).

* [Procedure](#Procedure)

###### Procedure

This procedure creates an internal or internal CA certificate by uploading a certificate file or pasting existing certificate
text into a text box. If you want to generate a self signed certificate, see [Generating Self-Signed Internal and Internal CA Certificates](#Generating_SelfSigned_Internal_and_Internal_CA_Certificates).

To create an internal or internal CA certificate object, or when adding a new certificate object to a policy, follow this
procedure:

###### Procedure

---

| **Step 1** | Do one of the following:   * Create the certificate object in the Objects page:    1. In the left pane, click Objects.   2. Click the plus button  and select FTD > Certificate * Click Create New Object when adding a new certificate object to a policy. |
| --- | --- |
| **Step 2** | Enter a Name for the certificate. The name is used in the configuration as an object name only, it does not become part of the certificate itself. |
| **Step 3** | In step 1, select Internal Certificate or Internal CA. |
| **Step 4** | In step 2, select Upload to upload the certificate file. |
| **Step 5** | In step 3, in the Server Certificate area, paste the certificate contents in the text box or upload the certificate file as explained in the wizard. If you paste the certificate into the text box, the certificate must include the BEGIN CERTIFICATE and END CERTIFICATE lines. For example: |

```
-----BEGIN CERTIFICATE-----
 MIICMTCCAZoCCQDdUV3NGK/cUjANBgkqhkiG9w0BAQsFADBdMQswCQYDVQQGEwJV
UzETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0
(...5 lines removed...)
shGJDReRYJQqilhHZrYTWZAYTrD7NQPHutK+ZiJng67cPgnNDuXEn55UwMOQoHBp
HMUwmhiGZlzJM8BpX2Js2yQ3ms30pr8rO+gPCPMCAwEAATANBgkqhkiG9w0BAQsF
AAOBgQCB02CebA6YjJCGr2CJZrQSeUwSveRBpmOuoqm98o2Z+5gJM5CkqgfxwCUn
RV7LRfQGFYd76V/5uor4Wx2ZCjqy6+zuQEm4ZxWNSZpA9UBixFXJCs9MBO4qkG5D
vlk3WYJfcgyJ10h4E4b0W2xiixBU+xoOTLRATnbKY36EWAG5cw==
-----END CERTIFICATE-----
```

| **Step 6** | In step 3, in the Certificate Key area, paste the key contents into the Certificate Key text box or upload the key file as explained in the wizard. If you paste the key into the text box, the key must include the BEGIN PRIVATE KEY or BEGIN RSA PRIVATE KEY and END PRIVATE KEY or END PRIVATE KEY lines.   | **Note** | The key cannot be encrypted. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 7** | Click Add. |

---

##### Uploading Trusted CA Certificates

A trusted Certificate Authority (CA) certificate is used to sign other certificates. It is self-signed and called a root certificate.
A certificate that is issued by another CA certificate is called a subordinate certificate.

For information on the features that use these certificates, see [Certificate Type Used by Feature](#Certificate_Types_Used_by_Feature).

Obtain a trusted CA certificate from an external certificate authority, or create one using your own internal CA, for example,
with OpenSSL tools. Then, use the following procedure to upload the certificate.

* [Procedure](#Procedure)

###### Procedure

###### Procedure

---

| **Step 1** | Do one of the following:   * Create the certificate object in the Objects page:    1. In the left pane, click Objects.   2. Click  > FTD > Certificate. * Click Create New Object when adding a new certificate object to a policy. |
| --- | --- |
| **Step 2** | Enter a Name for the certificate. The name is used in the configuration as an object name only, it does not become part of the certificate itself. |
| **Step 3** | In step 1, select External CA Certificate and click Continue. The wizard advances to step 3. |
| **Step 4** | In step 3, in the Certificate Contents area, paste the certificate contents in the text box or upload the certificate file as explained in the wizard.  The certificate must follow these guidelines:   * The name of the server in the certificate must match the server Hostname / IP Address. For example, if you use 10.10.10.250   as the IP address but ad.example.com in the certificate, the connection fails. * The certificate must be an X509 certificate in PEM or DER format. * The certificate you paste must include the BEGIN CERTIFICATE and END CERTIFICATE lines. For example:    ```   -----BEGIN CERTIFICATE-----   MIIFgTCCA2mgAwIBAgIJANvdcLnabFGYMA0GCSqGSIb3DQEBCwUAMFcxCzAJBgNV   BAYTAlVTMQswCQYDVQQIDAJUWDEPMA0GA1UEBwwGYXVzdGluMRQwEgYDVQQKDAsx   OTIuMTY4LjEuMTEUMBIGA1UEAwwLMTkyLjE2OC4xLjEwHhcNMTYxMDI3MjIzNDE3   WhcNMTcxMDI3MjIzNDE3WjBXMQswCQYDVQQGEwJVUzELMAkGA1UECAwCVFgxDzAN   BgNVBAcMBmF1c3RpbjEUMBIGA1UECgwLMTkyLjE2OC4xLjExFDASBgNVBAMMCzE5   Mi4xNjguMS4xMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA5NceYwtP   ES6Ve+S9z7WLKGX5JlF58AvH82GPkOQdrixn3FZeWLQapTpJZt/vgtAI2FZIK31h   (...20 lines removed...)   hbr6HOgKlOwXbRvOdksTzTEzVUqbgxt5Lwupg3b2ebQhWJz4BZvMsZX9etveEXDh   PY184V3yeSeYjbSCF5rP71fObG9Iu6+u4EfHp/NQv9s9dN5PMffXKieqpuN20Ojv   2b1sfOydf4GMUKLBUMkhQnip6+3W   -----END CERTIFICATE-----   ``` |
| **Step 5** | Click Add. |

---

##### Generating Self-Signed Internal and Internal CA Certificates

Internal identity certificates are certificates for specific systems or hosts. You can generate these yourself using the OpenSSL toolkit or get them from
a Certificate Authority. You can also generate a self-signed certificate.

Internal Certificate Authority (CA) certificates (Internal CA certificates) are certificates that the system can use to sign other certificates. These certificates differ
from internal identity certificates with respect to the basic constraints extension and the CA flag, which are enabled for
CA certificates but disabled for identity certificates. You can generate these yourself using the OpenSSL toolkit or get them
from a Certificate Authority. You can also generate a self-signed internal CA certificate. If you configure self-signed internal
CA certificates, the CA runs on the device itself.

You can also create these certificates using OpenSSL, or obtain them from a trusted CA, and upload them. For more information,
see [Uploading Internal and Internal CA Certificates](#Uploading_Internal_and_Internal_CA_Certificates).

For information on the features that use these certificates, see [Certificate Type Used by Feature](#Certificate_Types_Used_by_Feature).

| **Note** | ---   New self-signed certificates are generated with a 5-year validity term. Be sure to replace certificates before they expire.   --- |
| --- | --- |

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information.   --- |
| --- | --- |

* [Procedure](#Procedure)

###### Procedure

This procedure generates a self-signed certificate by entering the appropriate certificate field values in a wizard. If you
want to create an internal or internal CA certificate by uploading a certificate file, see [Uploading Internal and Internal CA Certificates](#Uploading_Internal_and_Internal_CA_Certificates).

To generate a self-signed certificate, follow this procedure:

###### Procedure

---

| **Step 1** | Do one of the following:   * Create the certificate object in the Objects page:    1. In the left pane, click Objects.   2. Click  > FTD > Certificate. * Click Create New Object when adding a new certificate object to a policy. |
| --- | --- |
| **Step 2** | Enter a Name for the certificate. The name is used in the configuration as an object name only, it does not become part of the certificate itself. |
| **Step 3** | In step 1, select Internal Certificate or Internal CA. |
| **Step 4** | In step 2, select Self-Signed to create the self-signed certificate in this step. |
| **Step 5** | Configure at least one of the following for the certificate subject and issuer information.   * Country (C)— Select the country code from the drop-down list. * State or Province (ST)— The state or province to include in the certificate. * Locality or City (L)— The locality to include in the certificate, such as the name of the city. * Organization (O)— The organization or company name to include in the certificate. * Organizational Unit (Department) (OU)— The name of the organization unit (for example, a department name) to include in the   certificate. * Common Name (CN)— The X.500 common name to include in the certificate. This could be the name of the device, web site, or   another text string. This element is usually required for successful connections. For example, you must include a CN in the   internal certificate used for remote access VPN. |
| **Step 6** | Click Add. |

---

#### About IPsec Proposals

IPsec is one of the most secure methods for setting up a VPN. IPsec provides data encryption at the IP packet level, offering
a robust security solution that is standards-based. With IPsec, data is transmitted over a public network through tunnels.
A tunnel is a secure, logical communication path between two peers. Traffic that enters an IPsec tunnel is secured by a combination
of security protocols and algorithms called a transform set. During the IPsec security association (SA) negotiation, peers
search for a transform set that is the same at both peers.

There are separate IPsec proposal objects based on the IKE version, IKEv1, or IKEv2:

* When you create an IKEv1 IPsec proposal, you select the mode in which IPsec operates, and define the required encryption and
  authentication types. You can select single options for the algorithms. If you want to support multiple combinations in a
  VPN, create and select multiple IKEv1 IPsec Proposal objects.
* When you create an IKEv2 IPsec proposal, you can select all of the encryption and hash algorithms allowed in a VPN. The system
  orders the settings from the most secure to the least secure and negotiates with the peer until a match is found. This allows
  you to potentially send a single proposal to convey all the allowed combinations instead of the need to send each allowed
  combination individually as with IKEv1.

The Encapsulating Security Protocol (ESP) is used for both IKEv1 and IKEv2 IPsec proposals. It provides authentication, encryption,
and antireplay services. ESP is IP protocol type 50.

| **Note** | ---   We recommend using both encryption and authentication on IPsec tunnels.   --- |
| --- | --- |

The following topics explain how to configure IPsec proposals for each IKE version:

* [Create and Edit IKEv1 IPsec Proposal Object](#Managing_an_FTD_IKEv1_IPsec_Proposal_Object)
* [Create and Edit IKEv2 IPsec Proposal Object](#Managing_an_FTD_IKEv2_IPsec_Proposal_Object)

* [Managing an IKEv1 IPsec Proposal Object](#Managing_an_FTD_IKEv1_IPsec_Proposal_Object)
* [Managing an IKEv2 IPsec Proposal Object](#Managing_an_FTD_IKEv2_IPsec_Proposal_Object)

##### Managing an IKEv1 IPsec Proposal Object

IPsec Proposal objects configure the IPsec proposal used during IKE Phase 2 negotiations. The IPsec proposal defines the combination
of security protocols and algorithms that secure traffic in an IPsec tunnel. There are separate objects for IKEv1 and IKEv2.
Currently, Security Cloud Control supports IKEv1 IPsec proposal objects.

The Encapsulating Security Protocol (ESP) is used for both IKEv1 and IKEv2 IPsec proposals. It provides authentication, encryption,
and anti-replay services. ESP is IP protocol type 50.

| **Note** | ---   We recommend using both encryption and authentication on IPsec tunnels.   --- |
| --- | --- |

* [Create or Edit an IKEv1 IPsec Proposal Object](#Create_or_Editan_FTDIKEv1_IPsecProposal_Object)
* [Create an IKEv1 IPsec Proposal Object](#Create_or_Editan_FTDIKEv1_IPsecProposal_Object)

**Related Tasks**
[Create an IKEv1 IPsec Proposal Object](#Create_or_Editan_FTDIKEv1_IPsecProposal_Object)

###### Create or Edit an IKEv1 IPsec Proposal Object

There are several pre-defined IKEv1 IPsec proposals. You can also create new
proposals to implement other combinations of security settings. You cannot edit or
delete system-defined objects.

The following procedure explains how you can create and edit objects directly through
the Objects page. You can also create IKEv1 IPsec Proposals objects while editing
the IKEv1 IPsec settings in a Site-to-Site VPN connection by clicking the
Create New IKEv1 Proposal link shown in the object
list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click  and select FTD > IKEv1 IPsec Proposal to create the new object. * In the object page, select the IPsec proposal you want to edit and   click Edit in the Actions pane at the   right. |
| **Step 3** | Enter an object name for the new object. |
| **Step 4** | Select the Mode in which the IKEv1 IPsec Proposal object operates.   * Tunnel mode encapsulates the entire IP   packet. The IPSec header is added between the original IP header and   a new IP header. This is the default. Use tunnel mode when the   firewall is protecting traffic to and from hosts positioned behind   the firewall. Tunnel mode is the normal way regular IPSec is   implemented between two firewalls (or other security gateways) that   are connected over an untrusted network, such as the Internet. * Transport mode encapsulates only the   upper-layer protocols of an IP packet. The IPSec header is inserted   between the IP header and the upper-layer protocol header (such as   TCP). Transport mode requires that both the source and destination   hosts support IPSec, and can only be used when the destination peer   of the tunnel is the final destination of the IP packet. Transport   mode is generally used only when protecting a Layer 2 or Layer 3   tunneling protocol such as GRE, L2TP, and DLSW. |
| **Step 5** | Select the ESP Encryption (Encapsulating Security Protocol encryption) algorithm for this proposal. For an explanation of the options, see [Deciding Which Encryption Algorithm to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__EncryptionAlgorithm). |
| **Step 6** | Select the ESP Hash or integrity algorithm to use for authentication. For an explanation of the options, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__HashAlgorithms). |
| **Step 7** | Click Add. |

---

##### Managing an IKEv2 IPsec Proposal Object

IPsec Proposal objects configure the IPsec proposal used during IKE Phase 2 negotiations. The IPsec proposal defines the combination
of security protocols and algorithms that secure traffic in an IPsec tunnel.

When you create an IKEv2 IPsec proposal, you can select all of the encryption and hash algorithms allowed in a VPN. The system
orders the settings from the most secure to the least secure and negotiates with the peer until a match is found. This allows
you to potentially send a single proposal to convey all the allowed combinations instead of the need to send each allowed
combination individually as with IKEv1.

* [Create or Edit an IKEv2 IPsec Proposal Object](#Create_or_Edit_an_FTDIKEv2_IPsec_Proposal_Object)

**Related Tasks**
[Create or Edit an IKEv2 IPsec Proposal Object](#Create_or_Edit_an_FTDIKEv2_IPsec_Proposal_Object)

###### Create or Edit an IKEv2 IPsec Proposal Object

There are several pre-defined IKEv2 IPsec proposals. You can also create new
proposals to implement other combinations of security settings. You cannot edit or
delete system-defined objects.

The following procedure explains how you can create and edit objects directly through
the Objects page. You can also create IKEv2 IPsec Proposals objects while editing
the IKEv2 IPsec settings in a VPN connection by clicking the Create New IPsec
Proposal link shown in the object list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click  and select FTD > IKEv2 IPsec Proposal to create the new object. * In the object page, select the IPsec proposal you want to edit and   click Edit in the Actions pane at the   right. |
| **Step 3** | Enter an object name for the new object. |
| **Step 4** | Configure the IKE2 IPsec proposal objects:   * Encryption—The Encapsulating Security Protocol (ESP) encryption algorithm for this proposal. Select all the algorithms that you want   to allow. The system negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed   upon. For an explanation of the options, see [Deciding Which Encryption Algorithm to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__EncryptionAlgorithm). * Integrity Hash—The hash or integrity algorithm to use for authentication. Select all the algorithms that you want to allow. The system negotiates   with the peer, starting from the strongest to the weakest algorithm until a match is agreed upon. For an explanation of the   options, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__HashAlgorithms). |
| **Step 5** | Click Add. |

---

#### About Global IKE Policies

Internet Key Exchange (IKE) is a key management protocol that is used to authenticate IPsec peers, negotiate and distribute
IPsec encryption keys, and automatically establish IPsec security associations (SAs).

The IKE negotiation comprises two phases. Phase 1 negotiates a security association between two IKE peers, which enables the
peers to communicate securely in Phase 2. During Phase 2 negotiation, IKE establishes SAs for other applications, such as
IPsec. Both phases use proposals when they negotiate a connection. An IKE proposal is a set of algorithms that two peers use
to secure the negotiation between them. IKE negotiation begins by each peer agreeing on a common (shared) IKE policy. This
policy states which security parameters are used to protect subsequent IKE negotiations.

IKE policy objects define the IKE proposals for these negotiations. The objects that you enable are the ones used when the
peers negotiate a VPN connection: you cannot specify different IKE policies per connection. The relative priority of each
object determines which of these policies are tried first, with the lower number being a higher priority. The connection is
not established if the negotiation fails to find a policy that both peers can support.

To define the global IKE policy, you select which objects to enable for each IKE version. If the pre-defined objects do not
satisfy your requirements, create new policies to enforce your security policy.

The following procedure explains how to configure the global policy through the Objects page. You can also enable, disable,
and create policies when editing a VPN connection by clicking Edit for the IKE Policy settings.

The following topics explain how to configure IKE policies for each version:

* [Configuring IKEv1 Policies](#Managing_FTD_IKEv1_Policies)
* [Configuring IKEv2 Policies](#Managing_FTD_IKEv2_Policies)

* [Managing IKEv1 Policies](#Managing_FTD_IKEv1_Policies)
* [Managing IKEv2 Policies](#Managing_FTD_IKEv2_Policies)
* [Create an IKEv1 Policy](#Create_or_Edit_an_FTD_IKEv1Policy)
* [Create an IKEv2 Policy](#Create_or_Edit_an_FTDIKEv2Policy)

##### Managing IKEv1 Policies

###### About IKEv1 Policy

Internet Key Exchange (IKE) version 1 policy objects contain the parameters required for IKEv1 policies when defining VPN
connections. IKE is a key management protocol that facilitates the management of IPsec-based communications. It is used to
authenticate IPsec peers, negotiate and distribute IPsec encryption keys, and automatically establish IPsec security associations
(SAs).

There are several pre-defined IKEv1 policies. If any suit your needs, simply enable them by clicking the State toggle. You
can also create new policies to implement other combinations of security settings. You cannot edit or delete system-defined
objects.

* [Create or Edit an IKEv1 Policy](#Create_or_Edit_an_FTD_IKEv1Policy)

**Related Tasks**
[Create an IKEv1 Policy](#Create_or_Edit_an_FTD_IKEv1Policy)

###### Create or Edit an IKEv1 Policy

The following procedure explains how you can create and edit objects directly through
the Objects page. You can also create an IKEv1 policy while editing the IKE settings
in a Site-to-Site VPN connection by clicking the Create New IKEv1
Policy link shown in the object list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click  and select FTD > IKEv1 Policy to create a new IKEv1 policy. * In the object page, select the IKEv1 policy you want to edit and   click Edit in the Actions pane at the   right. |
| **Step 3** | Enter an object name, up to 128 characters. |
| **Step 4** | Configure the IKEv1 properties.   * Priority—The relative priority of the IKE   policy, from 1 to 65,535. The priority determines the order of the   IKE policy compared by the two negotiating peers when attempting to   find a common security association (SA). If the remote IPsec peer   does not support the parameters selected in your highest priority   policy, it tries to use the parameters defined in the next lowest   priority. The lower the number, the higher the priority. * Encryption—The encryption algorithm used to   establish the Phase 1 security association (SA) for protecting Phase   2 negotiations. For an explanation of the options, see Deciding   Which Encryption Algorithm to Use. * Diffie-Hellman Group—The Diffie-Hellman group   to use for deriving a shared secret between the two IPsec peers   without transmitting it to each other. A larger modulus provides   higher security but requires more processing time. The two peers   must have a matching modulus group. For an explanation of the   options, see Deciding Which Diffie-Hellman Modulus Group to Use. * Lifetime—The lifetime of the security   association (SA), in seconds, from 120 to 2147483647 or blank. When   the lifetime is exceeded, the SA expires and must be renegotiated   between the two peers. As a general rule, the shorter the lifetime   (up to a point), the more secure your IKE negotiations will be.   However, with longer lifetimes, future IPsec security associations   can be set up more quickly than with shorter lifetimes. The default   is 86400. To specify an unlimited lifetime, enter no value (leave   the field blank). * Authentication—The method of authentication to use between the two peers. For more information, see [Deciding Which Authentication Method to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__Authenticationmethod).    + Preshared Key—Use the preshared key     that is defined on each device. These keys allow for a     secret key to be shared between two peers and to be used by     IKE during the authentication phase. If the peer is not     configured with the same preshared key, the IKE SA cannot be     established.   + Certificate—Use the device identity     certificates for the peers to identify each other. You must     obtain these certificates by enrolling each peer in a     Certificate Authority. You must also upload the trusted CA     root and intermediate CA certificates used to sign the     identity certificates in each peer. The peers can be     enrolled in the same or a different CA. You cannot use     self-signed certificates for either peer. * Hash—The hash algorithm for creating a message digest, which is used to ensure message integrity. For an explanation of the options,   see [Encryption and Hash Algorithms Used in VPN](#Encryption_and_Hash_Algorithms_Used_in_VPN). |
| **Step 5** | Click Add. |

---

##### Managing IKEv2 Policies

###### About IKEv2 Policy

Internet Key Exchange (IKE) version 2 policy objects contain the parameters required for IKEv2 policies when defining VPN
connections. IKE is a key management protocol that facilitates the management of IPsec-based communications. It is used to
authenticate IPsec peers, negotiate and distribute IPsec encryption keys, and automatically establish IPsec security associations
(SAs).

There are several pre-defined IKEv2 policies. If any suit your needs, simply enable them by clicking the State toggle. You
can also create new policies to implement other combinations of security settings. You cannot edit or delete system-defined
objects.

* [Create or Edit an IKEv2 Policy](#Create_or_Edit_an_FTDIKEv2Policy)

**Related Tasks**
[Create an IKEv2 Policy](#Create_or_Edit_an_FTDIKEv2Policy)

###### Create or Edit an IKEv2 Policy

The following procedure explains how you can create and edit objects directly through
the Objects page. You can also create an IKEv2 policy while editing the IKE settings
in a Site-to-Site VPN connection by clicking the Create New IKEv2
Policy link shown in the object list.

###### Procedure

---

| **Step 1** | In the Security Cloud Control navigation bar on the left, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click  and select FTD > IKEv2 Policy to create a new IKEv2 policy. * In the object page, select the IKEv2 policy you want to edit and   click Edit in the Actions pane at the   right. |
| **Step 3** | Enter an object name, up to 128 characters. |
| **Step 4** | Configure the IKEv2 properties.   * Priority—The relative priority of the IKE   policy, from 1 to 65,535. The priority determines the order of the   IKE policy compared by the two negotiating peers when attempting to   find a common security association (SA). If the remote IPsec peer   does not support the parameters selected in your highest priority   policy, it tries to use the parameters defined in the next lowest   priority. The lower the number, the higher the priority. * State—Whether the IKE policy is enabled or   disabled. Click the toggle to change the state. Only enabled   policies are used during IKE negotiations. * Encryption—The encryption algorithm used to establish the Phase 1 security association (SA) for protecting Phase 2 negotiations. Select   all algorithms that you want to allow, although you cannot include both mixed-mode (AES-GCM) and normal mode options in the   same policy. (Normal mode requires that you select an integrity hash, whereas mixed-mode prohibits a separate integrity hash   selection.) The system negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed   upon. For an explanation of the options, see [Deciding Which Encryption Algorithm to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__EncryptionAlgorithm). * Diffie-Hellman Group—The Diffie-Hellman group to use for deriving a shared secret between the two IPsec peers without transmitting it to each   other. A larger modulus provides higher security but requires more processing time. The two peers must have a matching modulus   group. Select all the algorithms that you want to allow. The system negotiates with the peer, starting from the strongest   to the weakest group until a match is agreed upon. For an explanation of the options, see [Deciding Which Diffie-Hellman Modulus Group to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__Diffie-Hellman). * Integrity Hash—The integrity portion of the hash algorithm for creating a message digest, which is used to ensure message integrity. Select   all the algorithms that you want to allow. The system negotiates with the peer, starting from the strongest to the weakest   algorithm until a match is agreed upon. The integrity hash is not used with the AES-GCM encryption options. For an explanation   of the options, see [Encryption and Hash Algorithms Used in VPN](#Encryption_and_Hash_Algorithms_Used_in_VPN). * Pseudo-Random Function (PRF) Hash—The pseudo-random function (PRF) portion of the hash algorithm, which is used as the algorithm to derive keying material   and hashing operations required for the IKEv2 tunnel encryption. In IKEv1, the Integrity and PRF algorithms are not separated,   but in IKEv2, you can specify different algorithms for these elements. Select all the algorithms that you want to allow. The   system negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed upon. For an   explanation of the options, see [Encryption and Hash Algorithms Used in VPN](#Encryption_and_Hash_Algorithms_Used_in_VPN). * Lifetime—The lifetime of the security   association (SA), in seconds, from 120 to 2147483647 or blank. When   the lifetime is exceeded, the SA expires and must be renegotiated   between the two peers. As a general rule, the shorter the lifetime   (up to a point), the more secure your IKE negotiations will be.   However, with longer lifetimes, future IPsec security associations   can be set up more quickly than with shorter lifetimes. The default   is 86400. To specify an unlimited lifetime, enter no value (leave   the field blank). |
| **Step 5** | Click Add. |

---

#### RA VPN Objects

#### Security Zone Object

A security zone is a grouping of interfaces. Zones divide the network into segments to help you manage and classify traffic.
You can define multiple zones, but a given interface can be in one zone only.

The Firepower system creates the following zones during initial configuration and they are displayed in Security Cloud Control's object page. You can edit zones to add or remove interfaces, or you can delete the zones if you no longer use them.

* inside\_zone-Includes the inside interface. This zone is intended to represent internal networks.
* outside\_zone-Includes the outside interface. This zone is intended to represent networks external to your control, such as the internet.

Typically, you would group interfaces by the role they play in your network. For example, you would place the interface that
connects to the internet in the outside\_zone security zone, and all of the interfaces for your internal networks in the inside\_zone security zone. Then, you could apply access control rules to traffic coming from the outside zone and going to the inside
zone.

Before creating zones, consider the access rules and other policies you want to apply to your networks. For example, you do
not need to put all internal interfaces into the same zone. If you have 4 internal networks, and you want to treat one differently
than the other three, you can create two zones rather than one. If you have an interface that should allow outside access
to a public web server, you might want to use a separate zone for the interface.

* [Create or Edit a Firepower Security Zone Object](#Create_or_Edit_a_Firepower_Security_Zone_Object)

**Related Information:**

* [Create or Edit a Firepower Security Zone Object](#Create_or_Edit_a_Firepower_Security_Zone_Object)
* [Assign a Firepower Interface to a Security Zone](#Assigna_FirepowerInterface_to_a_Security_Zone)
* [Deleting Objects](#Deleting_Objects)

##### Create or Edit a Firepower Security Zone Object

A security zone is a grouping of interfaces. Zones divide the network into segments to help you manage and classify traffic.
You can define multiple zones, but a given interface can be in one zone only. For more information see, [Security Zone Object](#Security_Zone_Object).

A security zone object is not associated with a device unless it is used in a rule for that device.

* [Create a Security Zone Object](#Create_a_Security_Zone_Object)
* [Edit a Security Zone Object](#Edit_a_Security_Zone_Object)

###### Create a Security Zone Object

To create a security zone object, follow these instructions:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > Security Zone to create the object. |
| **Step 3** | Give the object a name and, optionally, a description. |
| **Step 4** | Select the interfaces to put in the security zone. |
| **Step 5** | Click Add. |

---

###### Edit a Security Zone Object

After onboarding an FDM-managed device, you will find there are already at least two security zones, one is the inside\_zone and the other is the outside\_zone.
These zones can be edited or deleted. To edit any security zone object, follow these instructions:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Find the object you want to edit:   * If you know the name of the object, you can search for it in the Objects page:    + Filter the list by security zone.   + Enter the name of the object in the search field.   + Select the object. * If you know the object is associated with a device, you can search for it starting on the Security Devices page.    + In the left pane, click Security Devices.   + Click the Devices tab.   + Click the apporpriate tab.   + Use the device [filter](#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) and [search](basics-of-cisco-defense-orchestrator.html#To_use_search) bar to locate your device.   + Select the device.   + In the Management pane at the right, click      Objects.   + Use the object filter  and search bar to locate the object you are looking for.  | **Note** | If the security zone object you created is not associated with a rule in a policy for your device, it is considered "unassociated" and you will not see it among the search results for a device. | | --- | --- | |
| **Step 3** | Select the object. |
| **Step 4** | Click the Edit icon  in the Actions pane at the right. |
| **Step 5** | After editing any of the attributes of the object. Click Save. |
| **Step 6** | After clicking Save you receive a message explaining how these changes will affect other devices. Click Confirm to save the changes or Cancel. |

---

#### Service Objects

##### Firepower Service Objects

FTD service objects, service groups, and port groups are reusable components that contain protocols or ports considered part
of the IP protocol suite.

FTD service groups are collections of service objects. A service group may contain objects for one or more protocols. You
can use the objects and groups in security policies for purposes of defining network traffic matching criteria, for example,
to use access rules to allow traffic to specific TCP ports. The system includes several pre-defined objects for common services.
You can use these objects in your policies; however, you cannot edit or delete system-defined objects.

Firepower Device Manager and Firepower Management Center refer to service objects as port objects and service groups and port
groups.

See [Create and Edit Firepower Threat Defense Service Objects](#Create_a_FirepowerService_Object) for more information.

##### Protocol Objects

Protocol objects are a type of service object that contain less-commonly used or legacy protocols. Protocol objects are identified
by a name and [protocol number](https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml). Security Cloud Control recognizes these objects in ASA and Firepower (FDM-managed device) configurations and gives them their own filter of "Protocols" so you can find them easily.

See [Create and Edit Firepower Threat Defense Service Objects](#Create_a_FirepowerService_Object) for more information.

##### ICMP Objects

An Internet Control Message Protocol (ICMP) object is a service object specifically for ICMP and IPv6-ICMP messages. Security Cloud Control recognizes these objects in ASA and Firepower configurations when those devices are onboarded and Security Cloud Control gives them their own filter of "ICMP" so you can find the objects easily.

Using Security Cloud Control, you can rename or remove ICMP objects from an ASA configuration. You can use Security Cloud Control to create, update, and delete ICMP and ICMPv6 objects in a Firepower configuration.

| **Note** | ---   For the ICMPv6 protocol, AWS does not support choosing specific arguments. Only rules that allow all ICMPv6 messages are supported.  See [Create and Edit Firepower Threat Defense Service Objects](#Create_a_FirepowerService_Object) for more information.   --- |
| --- | --- |

* [Create and Edit Firepower Service Objects](#Create_a_FirepowerService_Object)

Related Information:

* [Deleting Objects](#Deleting_Objects)

##### Create and Edit Firepower Service Objects

To create a firepower service object, follow these steps:

firewall device manager (FDM-managed) service objects are reusable components that specify a TCP/IP protocol and a port. The firewall device manager, On-Premises Firewall Management Center and Cloud-delivered Firewall Management
Center refer to these objects as "Port Objects."

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD > Service. |
| **Step 3** | Enter an object name and description. |
| **Step 4** | Select Create a service object. |
| **Step 5** | Click the Service Type button and select the protocol for which you want to create an object. |
| **Step 6** | Configure the protocol as follows:   * TCP, UDP    + Select eq and then enter either a port number or a protocol name. For example, you could enter 80 as a port number or HTTP as the protocol     name.   + You can also select range and then enter a range of port numbers, for example, 1 65535 (to cover all ports). * ICMP, IPv6-ICMP-Select the ICMP Type. Select Any for the type to apply to all ICMP messages. For information on the types and codes, see the following pages:    + ICMP-[http://www.iana.org/assignments/icmp-parameters/icmp-parameters.xml](https://www.iana.org/assignments/icmp-parameters/icmp-parameters.xml)   + ICMPv6-[http://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xml](https://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xml) * Other-Select the desired protocol. |
| **Step 7** | Click Add. |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

* [Create a Firepower Service Group](#Create_a_FirepowerService_Group)
* [Edit a Firepower Service Object or Service Group](#Edita_FirepowerService_Object_or_Service_Group)

###### Create a Firepower Service Group

A service group can be made up of one or more service objects representing one or more protocols. The service objects need
to be created before they can be added to the group. The Firepower Device Manager and Firepower Management Center refer to
these objects as "Port Objects."

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD >  Service. |
| **Step 3** | Enter an object name and description. |
| **Step 4** | Select Create a service group. |
| **Step 5** | Add an object to the group by clicking Add Object.   * Click Create to create a new object as you did above in [Create a Firepower Service Object](#Create_a_FirepowerService_Object) above. * Click Choose to add an existing service object to the group. Repeat this step to add more objects. |
| **Step 6** | Click Add when you are done adding service objects to the service group. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

###### Edit a Firepower Service Object or Service Group

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Filter the objects to find the object you want to edit and then select the object in the object table. |
| **Step 3** | In the Actions pane, click Edit . |
| **Step 4** | Edit the values in the dialog box in the same fashion that you created them in the procedures above. |
| **Step 5** | Click Save. |
| **Step 6** | Security Cloud Control displays the policies that will be affected by the change. Click Confirm to finalize the change to the object and any policy affected by it. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

#### Security Group Tag Group

* [Security Group Tags](#FTD_Security_Group_Tags)
* [Create an SGT Group](#Create_an_FTD_SGT_Group)
* [Edit an SGT Group](#Edit_an_FTD_SGT_Group)
* [Add an SGT Group to an Access Control Rule](#Add_an_FTDSGT_Group_to_an_Access_Control_Rule)

##### Security Group Tags

###### About Security Group Tags

If you use Cisco Identity Services Engine (ISE) to define and use security group tag (SGT) for classifying traffic in a Cisco TrustSec network, you can write access control rules that use SGT as matching criteria.
Thus, you can block or allow access based on security group membership rather than IP addresses.

In ISE, you can create a SGT and assign host or network IP addresses to each tag. If you assign an SGT to a user's account,
the SGT is assigned to the user's traffic. After you configure FDM-managed device to connect to an ISE server and create the SGT, you can create SGT groups in Security Cloud Control and build access control rules around them. Note that you must configure ISE's SGT Exchange Protocol (SXP) mapping before
you can associate an SGT to an FDM-managed device. See Security Group Tag Exchange Protocol in the [Cisco Identity Services Engine Administrator Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/products-installation-guides-list.html) of the version you are currently running for more information.

When an FDM-managed device evaluates SGT as a traffic matching criteria for an access control rule, it uses the following priority:

1. The source SGT defined in the packet, if any. No destination matching is done using this technique. For the SGT to be in the
   packet, the switches and routers in the network must be configured to add them. See the ISE documentation for information
   on how to implement this method.
2. The SGT assigned to the user session, as downloaded from the ISE session directory. You need to enable the option to listen
   to session directory information for this kind of SGT matching, but this option is on by default when you first create the
   ISE identity source. The SGT can be matched to source or destination. Although not required, you would also normally set up
   a passive authentication identity rule, using the ISE identity source along with an AD realm, to collect user identity information.
3. The SGT-to-IP address mapping downloaded using SXP. If the IP address is within the range for an SGT, then the traffic matches
   the access control rule that uses the SGT. The SGT can be matched to source or destination.

   | **Note** | ---   You cannot use the information retrieved from ISE directly in an access control rule. Instead, you need to create SGT groups, which refer to the downloaded SGT information. Your SGT groups can refer to more than one SGT, so you can apply policy based on a relevant collections of tags if that is appropriate.   --- |
   | --- | --- |

###### Version Support

Security Cloud Control currently supports SGT and SGT groups on FDM-managed devices running Version 6.5 and later. an FDM-managed device allows you to configure and connect to an ISE server in Version 6.5 and later but not does not support SGT configuration
in the UI until Version 6.7.

From the FDM-managed UI, this means that an FDM-managed device running Version 6.5 or later can download SXP mappings of SGTs but cannot be manually added to objects or access control
rules. To make changes to the SGTs for devices running Version 6.5 or Version 6.6, you must use the ISE UI. If the device
running Version 6.5 is onboarded to Security Cloud Control, however, you can see the current SGTs associated with the device and create SGT groups.

###### SGT in Security Cloud Control

###### Security Group Tags

SGTs are read-only in Security Cloud Control. You cannot create or edit an SGT in Security Cloud Control. To create an SGT, see the [Cisco Identity Services Engine Administrator Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/products-installation-guides-list.html) of the version your are currently running.

###### SGT Groups

| **Note** | ---   An FDM-managed device refers to groups of SGTs as SGT dynamic objects. In Security Cloud Control, these lists of tags are currently called SGT groups. You can create an SGT group in Security Cloud Control without referring to the FDM-managed device or ISE UI.   --- |
| --- | --- |

Use SGT groups to identify source or destination addresses based on an SGT assigned by ISE. You can then use the objects in
access control rules for purposes of defining traffic matching criteria. You cannot use the information retrieved from ISE
directly in an access control rule. Instead, you need to create SGT groups, which refer to the downloaded SGT information.

Your SGT groups can refer to more than one SGT, so you can apply policy based on relevant collections of tags if that is appropriate.

In order to create an SGT group in Security Cloud Control, you must have at least one SGT already configured and SGT mappings from an ISE server configured for the FDM-managed console of the device you want to use. Note that if more than one FDM-managed device is associated with the same ISE server, an SGT or SGT group can be applied to more than one device. If a device is
not associated with an ISE server, you cannot include SGT objects in your access control rule, or apply an SGT group to that
device configuration.

###### SGT Groups in Rules

SGT groups can be added to access control rules; they appear as source or destination
network objects. For more information about how networks work in rules, see
[Source and Destination Criteria
in an FDM Access Control Rule](#Source_and_Destination_Criteria_in_an_FTD_Access_Control_Rule).

You can create an SGT group from the Objects page. See [Create an SGT Group](#Create_an_FTD_SGT_Group) for more information.

* [Create an SGT Group](#Create_an_FTD_SGT_Group)
* [Edit an SGT Group](#Edit_an_FTD_SGT_Group)
* [Add an SGT Group to an Access Control Rule](#Add_an_FTDSGT_Group_to_an_Access_Control_Rule)

##### Create an SGT Group

To create an SGT group that can be used for an access control rule, use the following procedure:

###### Before you begin

You must have the following configurations or environments configured prior to creating a security group tag (SGT) group:

* FDM-managed device must be running at least Version 6.5.
* You must configure the ISE identity source to subscribe to SXP mappings and enable deploy changes. To manage SXP mappings,
  see Configure Security Groups and SXP Publishing in ISE of the [Firepower Device Manager Configuration Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version you're using, Version 6.7 and later.
* All SGTs must be created in ISE. To create an SGT, see the [Cisco Identity Services Engine Configuration Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html#Configuration) of the version your are currently running.

###### Procedure

---

| **Step 1** | On the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD  > Network. |
| **Step 3** | Enter an Object Name. |
| **Step 4** | (Optional) Add a description. |
| **Step 5** | Click SGT and use the drop-down menu to check all the applicable SGTs you want included in the group. You can sort the list by SGT name. |
| **Step 6** | Click Save.   | **Note** | You cannot create or edit SGTs in Security Cloud Control, you can only add or remove them from an SGT group. To create or edit an SGT, see the [Cisco Identity Services Engine Configuration Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html#Configuration) of the version you are currently running. | | --- | --- | |

---

##### Edit an SGT Group

To edit an SGT group, use the following procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the SGT group you want to edit by using object filters and search field. |
| **Step 3** | Select the SGT group and click the edit icon  in the Actions pane. |
| **Step 4** | Modify the SGT group. Edit the name, description, or the SGTs associated with the group. |
| **Step 5** | Click Save.   | **Note** | You cannot create or edit SGTs in Security Cloud Control, you can only add or remove them from an SGT group. To create or edit an SGT, see the [Cisco Identity Services Engine Configuration Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html#Configuration) of the version you are currently running. | | --- | --- | |

---

##### Add an SGT Group to an Access Control Rule

To add an SGT group to an access control rule, use the following procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want to add the SGT group to. |
| **Step 4** | In theManagement pane, select Policy. |
| **Step 5** | Click the blue plus button  for either the Source or Destination objects and select SGT Groups. |
| **Step 6** | Locate the SGT group(s) you want to edit by using object filters and search field. |
| **Step 7** | Click Save. |
| **Step 8** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be).   | **Note** | If you need to create an additional SGT group, click Create New Object. Fill in the required information mentioned in [Create an FTD SGT Group](#Create_an_FTD_SGT_Group) and Add the SGT group to the rule. | | --- | --- | |

---

#### Syslog Server Objects

FDM-managed devices have a limited capacity to store events. To maximize storage for events, you can configure an external server. A
system log (syslog) server object identifies a server that can receive connection-oriented or diagnostic syslog messages.
If you have a syslog server set up for log collection and analysis, you can use the Security Cloud Control to create objects to define them and use the objects in the related policies.

* [Create and Edit Syslog Server Objects](#Create_Syslog_Server_Objects)
* [Create a Syslog Server Object for Secure Logging Analytics (SaaS)](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging)

##### Create and Edit Syslog Server Objects

To create a new syslog server object, follow these steps:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click the Create Object button . |
| **Step 3** | Select Syslog Server under FDM-managed device object types |
| **Step 4** | Configure the syslog server object properties:   * IP Address—Enter the IP address of the syslog server. * Protocol Type—Select the protocol that your syslog server uses to receive messages. If you select TCP, the system can recognize when the   syslog server is not available, and stops sending events until the server is available again. * Port Number—Enter a valid port number to use for syslog. If your syslog server uses default ports, enter 514 as the default UDP port   or 1470 as the default TCP port. If the server does not use default ports, enter the correct port number. The port must be   in the range 1025 to 65535. * Select an interface—Select which interface should be used for sending diagnostic syslog messages. Connection and intrusion events always use   the management interface. Your interface selection determines the IP address associated with syslog messages. Note that you   can only select one of the options listed below. You cannot select both. Select one of the following options:    + Data Interface—Use the data interface you select for diagnostic syslog messages. Select an interface from the generated list. If the server     is accessible through a bridge group member interface, select the bridge group interface (BVI). If it is accessible through     the Diagnostic interface (the physical management interface), we recommend that you select Management Interface instead of     this option. You cannot select a passive interface. For connection and intrusion syslog messages, the source IP address will     either be for the management interface, or for the gateway interface if you route through data interfaces.   + Management Interface—Use the virtual management interface for all types of syslog messages. The source IP address will either be for the management     interface, or for the gateway interface if you route through data interfaces. |
| **Step 5** | Click Add. |
| **Step 6** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

* [Edit Syslog Server Objects](#Edit_Syslog_Server_Objects)

###### Edit Syslog Server Objects

To edit an existing syslog server object, follow these steps:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the desired syslog server object and select it. You can filter  the object list by the syslog server object type. |
| **Step 3** | In the Actions pane, click Edit. |
| **Step 4** | Make the desired edits and click Save. |
| **Step 5** | Confirm the changes you made. |
| **Step 6** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

**Related Information:**

* [Deleting Objects](#Deleting_Objects)

##### Create a Syslog Server Object for Secure Logging Analytics (SaaS)

Create a syslog server object with the IP address, TCP port, or UDP port of the Secure Event Connector (SEC) you want to send
events to. You would create one syslog object for every SEC that you have onboarded to your tenant but you would only send
events from one rule to one syslog object representing one SEC.

###### Prerequisite

This task is part of a larger workflow. See [Implementing Secure Logging Analytics (SaaS) for FDM-Managed Devices](#Before_you_Begin) before you begin.

* [Procedure](#Procedure)

###### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click the Create Object button . |
| **Step 3** | Select Syslog Server under FDM-managed device object types. |
| **Step 4** | Configure the syslog server object properties. To find these properties of the SEC, from the navigation pane on the left, choose Tools & Services > Secure Connectors. Then select the Secure Event Connector you want to configure the syslog object for and look in the Details pane on the right.   * IP Address—Enter the IP address of the SEC. * Protocol Type—Select TCP or UDP. * Port Number—Enter port 10125 if you selected TCP or 10025 if you selected UDP. * Select an interface—Select the interface configured to reach the SEC.  | **Note** | FDM-managed device supports one syslog object per IP address so you will have to choose between using TCP and UDP. | | --- | --- | |
| **Step 5** | Click Add. |

---

###### What to do next

Continue with Step 3 of [Existing Security Cloud Control Customer Workflow to Implement Secure Logging Analytics (SaaS) and Send Events through the Secure Event Connector to the
Cisco Cloud](#Before_you_Begin__existing-wkflow-sec).

## Manage Security Policies in Security Cloud Control

Security policies examine network traffic with the ultimate goal of allowing the traffic to its intended destination or dropping
it if a security threat is identified. You can use Security Cloud Control to configure security policies on many different types of devices.

* [FDM Policy Configuration](#FTD_Policy_Configuration)
* [Network Address Translation](#Network_Address_Translation)

## FDM Policy Configuration

Security policies examine network traffic with the ultimate goal of allowing the traffic to its intended destination or dropping
it if a security threat is identified. Use Security Cloud Control to manage all the components of FDM-managed device's security policies.

* [FDM-Managed Access Control Policy](#FTD_Access_Control_Policy)
* [Intrusion Prevention System](#Intrusion_Prevention_System)
* [Security Intelligence Policy](#FTD_Security_Intelligence_Policy)
* [FDM-Managed Device Identity Policy](#FTD_Identity_Policy)
* [SSL Decryption Policy](#FTD_SSL_Decryption_Policy)
* [Rulesets](#FTD_Rulesets)
* [Adding Comments to Rules in Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets)
* [Network Address Translation](#Network_Address_Translation)
* [Order of Processing NAT Rules](#AboutNetwork_Address_Translation_NAT)
* [Network Address Translation Wizard](#Network_Address_Translation_Wizard)
* [Common Use Cases for NAT](#Cisco_Reference.dita_3cfd3b68-ef46-4429-a0ec-579088c24473)

### FDM-Managed Access Control Policy

You can use Security Cloud Control to manage the access control policy of an FDM-managed device. The access control policy controls access to network resources by evaluating network traffic against access control
rules. The FDM-managed device compares the criteria of the access control rules, in the order they appear in the access control policy, to the network
traffic. When all the traffic conditions in an access control rule are

* Trust—Allow traffic without further inspection of any kind.
* Allow—Allow the traffic subject to the intrusion and other inspection settings in the policy.
* Block—Drop the traffic unconditionally. The traffic is not inspected.

If none of the rules in the access control policy match the network traffic, the FDM-managed device takes the default action listed below the access control rules.

* [Read an FDM-Managed Access Control Policy](#Read_an_FTD_Access_Control_Policy)
* [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy)
* [Copy FDM-Managed Access Control Rules](#Copy_FTD_Access_Control_Rules)
* [Move FDM-Managed Access Control Rules](#Move_FTD_Access_Control_Rules)
* [Behavior of Objects when Pasting Rules to Another Device](#Behavior_ofObjects_when_PastingRules_to_Another_FTD)
* [Source and Destination Criteria in an FDM-Managed Access Control Rule](#Source_and_Destination_Criteria_in_an_FTD_Access_Control_Rule)
* [URL Conditions in an FDM-Managed Access Control Rule](#URL_Conditions_in_an_FTD_Access_Control_Rule)
* [Intrusion Policy Settings in an FDM-Managed Access Control Rule](#Intrusion_Policy_Settings_in_an_FTD_Access_Control_Rule)
* [File Policy Settings in an FDM-Managed Access Control Rule](#File_Policy_Settings_in_an_FTD_Access_Control_Rule)
* [Logging Settings in an FDM-Managed Access Control Rule](#Logging_Settings_in_an_FTD_Access_Control_Rule)
* [Security Group Tags](#FTD_Security_Group_Tags)
* [Application Criteria in an FDM-Managed Access Control Rule](#Application_Criteria_in_an_FTD_Access_Control_Rule)
* [Intrusion, File, and Malware Inspection in FDM-Managed Access Control Policies](#Intrusion_File_and_Malware_Inspection_in_FTD_Access_Control_Policies)
* [Custom IPS Policy in an FDM-Managed Access Control Rule](#Custom_IPS_Policy_in_an_FTD_Access_Control_Rule)
* [TLS Server Identity Discovery in Firepower Threat Defense](#TLS_Server_IdentityDiscovery_in_Firepower_Threat_Defense)

#### Read an FDM-Managed Access Control Policy

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device whose policy it is you want to read. |
| **Step 4** | In the Management pane at the right, select  Policy. |
| **Step 5** | To ensure that you see the whole policy, click Show All in the Filter panel. |
| **Step 6** | Toggle the rule column display to view the rules with more or fewer column. If you are used to viewing access control rules in an FDM-managed device, toggle the rule column display to show more columns.     Here is an example of how to read a rule in a policy. All traffic is evaluated against rule 1 first for a match. If the traffic matches rule 1, the action for that rule is applied to the traffic. Traffic that originates from the inside zone, AND originates from Africa OR Australia, AND originates from HTTP or HTTPS ports, AND arrives at the outside zone, AND arrives at the Aland Islands OR Albania, AND arrives at any port, AND arrives at ABC OR About.com is allowed to flow from the source to the destination. We can also see that an intrusion policy and a file policy are applied to the rule and that events from the rule are being logged. |

---

**Related Information:**

* [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy)

#### Configure the FDM Access Control Policy

FDM-managed devices have a single policy. A section of that policy has access control rules. For ease of discussion, we refer to the
section of the policy that has access control rules as the *access control policy*. After onboarding the FDM-managed device, you add rules to, or edit rules in, the access control policy.

If you are onboarding a new FDM-managed device, it may be that there are no rules in the policy that was imported. In that case, when you open the FDM Policy page,
you will see the message, "No results found." If you see that message, you can start adding rules to the FDM-Managed Device
Policy and then deploy them to the device from Security Cloud Control.

##### Tips Before you Begin

When adding conditions to access control rules, consider the following tips:

* You can create custom objects for some of the conditions at the time you add them to the rule. Look in the dialog boxes for
  a link to create custom objects.
* You can configure multiple conditions per rule. Traffic must match all the conditions in the rule for the rule to apply to
  traffic. For example, you can use a single rule to perform URL filtering for specific hosts or networks.
* For each condition in a rule, you can add up to 50 criteria. Traffic that matches any of a condition's criteria satisfies
  the condition. For example, you can use a single rule to apply application control for up to 50 applications or application
  filters. Thus, there is an OR relationship among the items in a single condition, but an AND relationship between condition
  types (for example, between source/destination and application).
* Some features require that you have enabled the appropriate Firepower licenses.
* Some editing tasks may not require you to enter the edit mode. From the policy page, you can modify a condition in the rule
  by clicking the + button within that condition column and select the desired object or element in the popup dialog box. You can also click
  the x on an object or element to remove it from the rule.

* [Create or Edit an FDM-Managed Access Control Policy](#Create_or_Edit_an_FTDAccess_Control_Policy)
* [Configuring Access Policy Settings](#Configuring_AccessPolicy_Settings)
* [About TLS Server Identity Discovery](#About_TLS_Server_Identity_Discovery)

##### Create or Edit an FDM-Managed Access Control Policy

Use this procedure to edit an FDM-managed access control policy using Cisco Security
Cloud Control:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and whose access control whose policy you want to edit. |
| **Step 4** | In the Management pane at the right, select  Policy. |
| **Step 5** | Do any of the following:   * To create a new rule, click the blue plus button . * To edit an existing rule, select the rule and click the edit icon  in the Actions pane. (Simple edits may also be performed inline without entering edit mode.) * To delete a rule you no longer need, select the rule and click the remove icon  in the Actions pane. * To move a rule within the policy, select the rule in the access control table and click the up or down arrow at the end of   the rule row to move the rule.   When editing or adding a rule, continue with the remaining steps in this procedure. |
| **Step 6** | In the Order field, select the position for the rule within the policy. Network traffic is evaluated against the list of rules in numerical order, 1 to "last."  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 7** | Enter the rule name. You can use alphanumeric characters, spaces, and these special characters: + . \_ - |
| **Step 8** | Select the action to apply if the network traffic is matched by the rule:   * Trust—Allow traffic without further inspection of any kind. * Allow—Allow the traffic subject to the intrusion and other inspection settings in the policy. * Block—Drop the traffic unconditionally. The traffic is not inspected. |
| **Step 9** | Define the traffic matching criteria by using any combination of attributes in the following tabs:   * Source—Click the Source tab and add or remove security zones (interfaces), networks (which include networks, continents, and custom geolocations),   or ports from which the network traffic originated. The default value is "Any." * Destination—Click the Destination tab and add or remove the security zones (interfaces), networks (which include networks, continents and custom geolocations),   or ports on which the traffic arrives. The default value is "Any." See [Source and Destination Criteria in an FDM Access Control Rule](#Source_and_Destination_Criteria_in_an_FTD_Access_Control_Rule). * Applications—Click the Application tab and add or remove a web application, or a filter that defines applications by type, category, tag, risk, or business   relevance. The default is any application. See [Application Criteria in an FDM Access Control Rule](#Application_Criteria_in_an_FTD_Access_Control_Rule) * URLs—Click the URL tab and add or remove a URL or URL category of a web request. The default is any URL. See [URL Conditions in an FDM Access Control Rule](#URL_Conditions_in_an_FTD_Access_Control_Rule) to learn how to fine-tune this condition using URL categories and reputation filters. * Users—Active Directory realm objects, special identities (failed authentication, guest, no authentication required, unknown), and   user groups added to the rule from firewall device manager are visible in the rule row but it is not yet editable in Security Cloud Control.       | **Caution** | Individual user-objects are not yet visible in an access control policy rule in Security Cloud Control. Log in to an FDM-managed device to see how an individual user-object may affect an access control policy rule. |   | --- | --- | |
| **Step 10** | (Optional, for rules with the Allow action) Click the Intrusion Policy tab to assign an intrusion inspection policy to inspect traffic for intrusions and exploits. See [Intrusion Policy Settings in an FDM Access Control Rule](#Intrusion_Policy_Settings_in_an_FTD_Access_Control_Rule).   1. To log Intrusion events generated by intrusion policy rules, see " [Configure Logging Settings](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed) " for the device. |
| **Step 11** | (Optional, for rules with the Allow action) Click the File Policy tab to assign a file policy that inspects traffic for files that contain malware and for files that should be blocked. See [File Policy Settings in an FDM Access Control Rule](#File_Policy_Settings_in_an_FTD_Access_Control_Rule).   1. To log file events enerated by file policy rules, see "[Configuring Logging Settings](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed)" for the device. |
| **Step 12** | (Optional) Click the logging tab to enable logging and collect connection events reported by the access control rule.  See [Logging Settings in an FDM Access Control Rule](#Logging_Settings_in_an_FTD_Access_Control_Rule) for more information on logging settings.  If you subscribe to Cisco Security Analytics and Logging, you can configure connection events in Security Cloud Control and send them to the Secure Event Connector (SEC) by [configuring a syslog object with the SEC's IP address and port](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging). See [Cisco Security Analytics and Logging](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_ae75b8a9-0b20-4170-a407-1138e0fa4ea6)  for more information about this feature. You would create one syslog object for every SEC that you have onboarded to your tenant, but you would only send events generated by one rule, to one syslog object, representing one SEC. |
| **Step 13** | Click Save. You are now done configuring a specific rule in the security policy. |
| **Step 14** | You can now configure the Default Action for the security policy as a whole. The Default Action defines what happens if network traffic does not match any of the rules in the access control policy, intrusion policy, or file/malware policy. |
| **Step 15** | Click the Default Action for the policy. |
| **Step 16** | Configure an intrusion policy as you did in step 9, above. |
| **Step 17** | Configure logging connection events generated by the Default Action.  If you subscribe to Cisco Security Analytics and Logging, you can send events generated by the default action to a Secure Event Connector (SEC) by [configuring a syslog object with the SEC's IP address and port](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging). See [Cisco Security Analytics and Logging](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_ae75b8a9-0b20-4170-a407-1138e0fa4ea6)  for more information about this feature. You would create one syslog object for every SEC that you have onboarded to your tenant, but you would only send events generated by rule to one syslog object, representing one SEC. |
| **Step 18** | (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets). |
| **Step 19** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### Configuring Access Policy Settings

You can configure settings that apply to the access policy, rather than to specific rules within the policy.

* [Procedure](#Cisco_Task_in_List_GUI.dita_678be31a-ea22-49b3-9822-59ffee600ef1)

###### Procedure

These settings apply to the access policy as a whole, rather than to specific rules
within the policy.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and whose access control whose policy you want to edit. |
| **Step 4** | In the Management pane at the right, select  Policy. |
| **Step 5** | Click the Settings icon and configure these settings:   * TLS Server Identity Discovery - TLS 1.3   certificates are encrypted. For traffic encrypted with TLS 1.3 to   match access rules that use application or URL filtering, the system   must decrypt the TLS 1.3 certificate. We recommend that you enable   this option to ensure encrypted connections are matched to the right   access control rule. The setting decrypts the certificate only; the   connection remains encrypted. Enabling this option is sufficient to   decrypt TLS 1.3 certificates; you do not need to create a   corresponding SSL decryption rule. Available for FDM-managed devices running   software version 6.7 or later. * Reputation Enforcement on DNS Traffic - Enable   this option to apply your URL filtering category and reputation   rules to DNS lookup requests. If the fully-qualified domain name   (FQDN) in the lookup request has a category and reputation that you   are blocking, the system blocks the DNS reply. Because the user does   not receive a DNS resolution, the user cannot complete the   connection. Use this option to apply URL category and reputation   filtering to non-web traffic. For more information, see DNS Request   Filtering. Available for FDM-managed devices running software version 7.0   and later. |
| **Step 6** | Click Save. |

---

##### About TLS Server Identity Discovery

Typically, the TLS 1.3 certificates are encrypted. For traffic encrypted with TLS 1.3 to match access rules that use application
or URL filtering, the system must decrypt the TLS 1.3 certificate. We recommend that you enable early application detection
and URL categorization to ensure encrypted connections are matched to the right access control rule. This setting decrypts
the certificate only; the connection remains encrypted.

| **Note** | ---   This feature is currently available for FDM-managed devices running on software version 6.7 or later.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and whose access control whose policy you want to edit. |
| **Step 4** | In the Management pane at the right, select  Policy. |
| **Step 5** | Click the settings button. |
| **Step 6** | Click the slider next to TLS Server Identity Discovery to enable early application detection and URL categorization for encrypted connections. |
| **Step 7** | Click Save. |

---

#### Copy FDM-Managed Access Control Rules

Use this procedure to copy access control rules by copying it from their current position and pasting them to a new position
in the same policy or by pasting them to the policy of a different FDM-managed device. You can paste the rule before or after other rules in the policy, so the rule evaluates that network traffic in its
proper order within the policy.

* [Copy Rules within the Device](#CopyRules_within_anFTD)
* [Copy Rules from One FDM-Managed Device Policy to Another FDM-Managed Device Policy](#CopyRules_from_One_FTDPolicy_to_Another_FTD_Policy)

##### Copy Rules within the Device

To copy rules within an FDM-managed device, follow this procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the FDM-managed device you whose policy it is you want to edit. |
| **Step 4** | In the Management pane on the right, click Policy. |
| **Step 5** | Select one or more access control rules you want to copy and click Copy in the Actions pane on the right. |
| **Step 6** | In the policy where you want to paste the rule(s), select the rule that your copied rule(s) should precede or follow and, in the Actions pane, click one fo the following options:   * Paste Beforeautomatically pastes one or more   copied rules above the selected rule, so the copied rule is ordered   above it. * Paste Afterautomatically pastes one or more   copied rules below the selected rule, so the copied rule is ordered   below it.   The paste operation can be performed multiple times at any required position.   | **Note** | When pasting rules within an FDM-managed device, if a rule with the same name exists, '- Copy' is appended to the original name. If the renamed name also exists, '- Copy n' is appended to the original name. For example, 'rule name - Copy 2'. | | --- | --- | |
| **Step 7** | Review your changes and [Deploy Configuration Changes from Cisco Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD) now or wait and deploy multiple changes at once. |

---

##### Copy Rules from One FDM-Managed Device Policy to Another FDM-Managed Device Policy

When copying rules from one FDM-managed device policy to another FDM-managed device policy, objects associated with those rules are copied to the new FDM-managed device as well.

Security Cloud Control validates some conditions when pasting the rules. For more information, see [Behavior of Objects when Pasting Rules to Another FTD](#Behavior_ofObjects_when_PastingRules_to_Another_FTD).

| **Important** | ---   Important: Security Cloud Control allows you to copy rules from one FDM-managed device to another FDM-managed device only if the same software versions on both devices are the same. If the software version is different, the "Rules could not be pasted because they are not compatible with the version of this device" error appears when you attempt to paste the rules. You can click the Details link to know the details.  To copy rules to another FDM-managed device, follow this procedure:   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want to copy the rule from. |
| **Step 4** | In the Management pane on the right, click Policy. |
| **Step 5** | Select one or more access control rules you want to copy and click Copy in the Actions pane on the right. |
| **Step 6** | Click Security Devices and navigate to the FDM-managed device you want to paste the rules to. |
| **Step 7** | In the Management pane on the right, click Policy. |
| **Step 8** | In the policy where you want to paste the rule(s) you just copied, select the rule that your copied rule(s) should precede or follow and, in the Actions pane, click Paste Before or Paste After. |
| **Step 9** | Select any access control rule you want for pasting the copied rules around it and in the Actions pane, click one of the following options:   * Paste Before automatically one or more rules   above the selected rule, so the copied rules evaluate network   traffic before the selected rule. * Paste After automatically one or more rules   below the selected rule, so the copied rules evaluate network   traffic after the selected rule.   The paste operation can be performed multiple times at any required position.   | **Note** | When pasting rules to another FDM-managed device, if a rule with the same name exists, '-Copy' is appended to the original name. If the renamed name also exists, '-Copy n' is appended to the original name. For example, 'rule name-Copy 2'. | | --- | --- | |
| **Step 10** | When you copy rules from one FDM-managed device to another, the Configuration Status of the destination device is in 'Not Synced' state. Review your changes and [Deploy Configuration Changes from Cisco Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD) now or wait and deploy multiple changes at once. |

---

**Related Information:**

* [Move FDM Access Control Rules](#Move_FTD_Access_Control_Rules)
* [Behavior of Objects when Pasting Rules to Another FTD](#Behavior_ofObjects_when_PastingRules_to_Another_FTD)

#### Move FDM-Managed Access Control Rules

Use this feature to move access control rules by cutting it from their current position in a policy and pasting them to a
new position in the same policy or to the policy of a different FDM-managed device. You can paste the rule before or after other rules in a policy, so the rule evaluates that network traffic in its
proper order within the policy.

* [Move Rules within the Device](#Move_Rules_within_an_FTD)
* [Move a Rule from One FDM-Managed Device Policy to Another FDM-Managed Device Policy](#Movea_Rule_from_One_FTDPolicy_to_Another_FTD_Policy)

##### Move Rules within the Device

To move rules within an FDM-managed device, follow this procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the FDM-managed device whose policy it is you want to edit. |
| **Step 4** | In the Management pane on the right, click Policy. |
| **Step 5** | Select one or more access control rules you want to move and click Cutin the Actions pane on the right. The selected rules are highlighted in yellow. Note: If you want to cancel your selection, select any rule and click Copy. |
| **Step 6** | In the policy where you want to paste the rule(s) you just cut, select the rule that the cut rule(s) should precede or follow and, in the Actions pane, click one of the following options:   * Paste Before automatically pastes one or more   rules above the selected rule, so the cut rules evaluate network   traffic before the selected rule. * Paste After automatically pastes one or more   rules below the selected rule, so the cut rules evaluate network   traffic after the selected rule.   The paste operation can be performed multiple times at any required position.   | **Note** | When pasting rules within an FDM-managed device, if a rule with the same name exists, '- Copy' is appended to the original name. If the renamed name also exists, '- Copy n' is appended to the original name. For example, 'rule name - Copy 2'. | | --- | --- | |
| **Step 7** | Review your changes and [Deploy Configuration Changes from Cisco Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD) now or wait and deploy multiple changes at once. |

---

##### Move a Rule from One FDM-Managed Device Policy to Another FDM-Managed Device Policy

When moving rules from one FDM-managed device policy to another FDM-managed device policy, objects associated with those rules are copied to the new FDM-managed device as well.

Security Cloud Control validates some conditions when pasting the rules. For more information on those conditions, see [Behavior of Objects when Pasting Rules to Another FTD](#Behavior_ofObjects_when_PastingRules_to_Another_FTD).

To move rules to another FDM-managed device, follow this procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the FDM-managed device you want to copy the rule from. |
| **Step 4** | In the Management pane on the right, click Policy. |
| **Step 5** | Select one or more access control rules you want to move and click Cut in the Actions pane on the right. |
| **Step 6** | Click Security Devices and navigate to the FDM-managed device you want to move one or more selected rules to. |
| **Step 7** | In the Management pane on the right, click Policy. |
| **Step 8** | In the policy where you want to paste the rule(s) you just cut, select the rule that your cut rule should precede or follow and, in the Actions pane, click Paste Before or Paste After.   * Paste Before automatically one or more rules above the selected rule, so the cut rules evaluate network traffic before the selected rule. * Paste After automatically one or more rules below the selected rule, so the cut rules evaluate network traffic after the selected rule.   The paste operation can be performed multiple times at any required position.   | **Note** | When pasting rules within an FDM-managed device, if a rule with the same name exists, '-Copy' is appended to the original name. If the renamed name also exists, '- Copy n' is appended to the original name. For example, 'rule name - Copy 2'. | | --- | --- | |
| **Step 9** | When you copy rules from one FDM-managed device to another, the Configuration Status of source and destination devices are in 'Not Synced' state. Review your changes and [Deploy Configuration Changes from Cisco Security Cloud Control to FDM-Managed Devices](#Deploy_Configuration_Changes_from_CDO_to_FTD) now or wait and deploy multiple changes at once. |

---

**Related Information:**

* [Copy FDM Access Control Rules](#Copy_FTD_Access_Control_Rules)
* [Behavior of Objects when Pasting Rules to Another FTD](#Behavior_ofObjects_when_PastingRules_to_Another_FTD)

#### Behavior of Objects when Pasting Rules to Another Device

If the rules you cut or copied contain objects, and you paste those rules into another FDM-managed device policy, Security Cloud Control copies the objects in those rules to the destination FDM-managed device when any of the following conditions are met:

For all types of objects (except security zone)

* The destination device does not contain the object; in that case, Security Cloud Control creates the object in the destination device first and then pastes the rule.
* The destination device contains the object with the same name and the same values as the source device.

For security zone objects

* The destination device contains the security zone object with the same name and the same interfaces as the source.
* The destination device does not contain the same security zone object and has interfaces for use on the destination.
* The destination device contains the security zone object, which is empty and has interfaces for use on the destination.

For objects with Active Directory (AD) realm

* Security Cloud Control pastes the rule with Active Directory (AD) realm objects only if the realm with the same name already present on the target
  device.

| **Important** | ---   The paste operation fails in the following conditions:   * If there are differences in the vulnerability, geolocation, intrusion, or URL databases between the two device versions, Security Cloud Control cannot paste the rules into the target device. You need to recreate the rules manually in the new device. * If the rule you are adding has a security zone that contains the interface of type 'management-only'.  --- |
| --- | --- |

**Related Information:**

* [Copy FDM Access Control Rule](#Copy_FTD_Access_Control_Rules)
* [Move FDM Access Control Rules](#Move_FTD_Access_Control_Rules)

#### Source and Destination Criteria in an FDM-Managed Access Control Rule

The Source and Destination criteria of an access rule define the security zones (interfaces) through which the traffic passes,
the IP addresses or the country or continent (geographical location) for the IP address, or the protocols and ports used in
the traffic. The default is any zone, address, geographical location, protocol, and port.

To modify the source or destination conditions in an access control rule you can edit the rule using the procedure in [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy). Simple edits may be performed without entering edit mode. From the policy page, you can modify a condition in the rule by
selecting the rule and clicking the + button within the source or destination condition column and selecting a new object or element in the popup dialog box. You
can also click the x on an object or element to remove it from the rule.

You can use the following criteria to identify the source and destination to match in the rule.

##### Source Zones, Destination Zones

The security zone objects that define the interfaces through which the traffic passes. You can define one, both, or neither
criteria: any criteria not specified applies to traffic on any interface.

* To match traffic leaving the device from an interface in the zone, add that zone to the Destination Zones.
* To match traffic entering the device from an interface in the zone, add that zone to the Source Zones.
* If you add both source and destination zone conditions to a rule, matching traffic must originate from one of the specified
  source zones and egress through one of the destination zones.

Use this criteria when the rule should apply based on where the traffic enters or exits the device. For example, if you want
to ensure that all traffic going to inside hosts gets intrusion inspection, you would select your inside zone as the Destination
Zones while leaving the source zone empty. To implement intrusion filtering in the rule, the rule action must be Allow, and
you must select an intrusion policy in the rule.

| **Note** | ---   You cannot mix passive and routed security zones in a single rule. In addition, you can specify passive security zones as source zones only, you cannot specify them as destination zones.   --- |
| --- | --- |

##### Source Networks, Destination Networks

The network objects or geographical locations that define the network addresses or locations of the traffic.

* To match traffic from an IP address or geographical location, configure the Source Networks.
* To match traffic to an IP address or geographical location, configure the Destination Networks.
* If you add both source and destination network conditions to a rule, matching traffic must originate from one of the specified
  IP addresses and be destined for one of the destination IP addresses.

When you add this criteria, you select from the following tabs:

* Network—Select the network objects or groups that define the source or destination IP addresses for the traffic you want to
  control. You can use objects that define the address using the fully-qualified domain name (FQDN); the address is determined
  through a DNS lookup.
* Geolocation—Select the geographical location to control traffic based on its source or destination country or continent. Selecting
  a continent selects all countries within the continent. Besides selecting geographical location directly in the rule, you
  can also select a geolocation object that you created to define the location. Using geographical location, you could easily
  restrict access to a particular country without needing to know all of the potential IP addresses used there.

| **Note** | ---   To ensure that you are using up-to-date geographical location data to filter your traffic, Cisco strongly recommends that you regularly update the geolocation database (GeoDB).   --- |
| --- | --- |

##### Source Ports, Destination Ports/Protocols

The port objects that define the protocols used in the traffic. For TCP/UDP, this can include ports. For ICMP, it can include
codes and types.

* To match traffic from a protocol or port, configure the Source Ports. Source ports can be TCP/UDP only.
* To match traffic to a protocol or port, configure the Destination Ports/Protocols. If you add only destination ports to a condition, you can add ports that use different transport protocols. ICMP and other
  non-TCP/UDP specifications are allowed in destination ports only; they are not allowed in source ports.
* To match traffic both originating from specific TCP/UDP ports and destined for specific TCP/UDP ports, configure both. If
  you add both source and destination ports to a condition, you can only add ports that share a single transport protocol, TCP
  or UDP. For example, you could target traffic from port TCP/80 to port TCP/8080.

#### URL Conditions in an FDM-Managed Access Control Rule

The URL conditions of an access control rule defines the URL used in a web request, or the category to which the requested
URL belongs. For category matches, you can also specify the relative reputation of sites to allow or block. The default is
to allow all URLs.

URL categories and reputations allow you to quickly create URL conditions for access control rules. For example, you could
block all Gaming sites, or all high risk Social Networking sites. If a user attempts to browse to any URL with that category
and reputation combination, the session is blocked.

Using category and reputation data also simplifies policy creation and administration. It grants you assurance that the system
will control web traffic as expected. Finally, because Cisco's threat intelligence is continually updated with new URLs, as
well as new categories and risks for existing URLs, you can ensure that the system uses up-to-date information to filter requested
URLs. Malicious sites that represent security threats such as malware, spam, botnets, and phishing may appear and disappear
faster than you can update and deploy new policies.

To modify the URL and URL Category conditions in an access control rule, you can edit the rule using the procedure in [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy). Simple edits may be performed without entering edit mode. From the policy page, you can modify a URL condition in the rule
by selecting the rule and clicking the + button within the URL condition column and selecting a new object, element, URL reputation, or URL category from the popup
dialog box. You can also click the x on an object or element to remove it from the rule.

Click the blue plus icon ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453385.jpg) and select URL objects, groups, or URL categories and click Save. You can click Create New Object if the URL object you require does not exist. See [Create or Edit FDM URL Objects](#Create_a_FirepowerURLObject) for more information about URL objects.

##### License Requirement for URL Filtering

To use URL filtering, you need to have the URL license enabled on your FDM-manageddevice.

* [Specifying a Reputation for a URL Category Used in a Rule](#Specifying_a_Reputation_for_a_URL_Category_Used_in_a_Rule)

##### Specifying a Reputation for a URL Category Used in a Rule

By default, all URLs in a URL category are treated by a rule the same way. For example, if you have a rule that blocks Social
Network URLs, you will block all of them regardless of reputation. You can adjust that setting so that you block only high-risk
Social Network sites. Likewise, you could allow all URLs from a URL category except the high-risk sites.

Use this procedure to use a reputation filter on a URL category in an access control rule:

###### Procedure

---

| **Step 1** | From the FDM Policy page, select the rule you want to edit. |
| --- | --- |
| **Step 2** | Click Edit. |
| **Step 3** | Click the URLs tab. |
| **Step 4** | Click the blue plus button  and select a URL Category. |
| **Step 5** | Click Apply Reputation to Selected Categories or the Any Reputation link on the URL Category you just picked. |
| **Step 6** | Uncheck the Any Reputation check box. |
| **Step 7** | Filter URLs by reputation:   * If the rule has a blocking action, slide the reputation slider to the right to block only the sites with the reputations marked   in red. For example, if you slide the slider to "Sites with Security Risks," a blocking rule would block "Sites with Security   Risks," "Suspicious Sites," and "High-Risk sites" but it would allow traffic from "Well-known Sites" and "Benign Sites." * If the rule has an allow action, slide the reputation slider to the right to allow only the sites with the reputations marked   in green. For example, if you slide the slider to "Benign Sites," the rule will allow traffic from "Well-Known Sites" and   "Benign Sites" but not allow traffic from "Sites with Security Risks," "Suspicious Sites," and "High-Risk sites." |
| **Step 8** | Click Save. |
| **Step 9** | Click Select. |
| **Step 10** | Click Save. |
| **Step 11** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Intrusion Policy Settings in an FDM-Managed Access Control Rule

Cisco delivers several intrusion policies with the Firepower system. These policies are designed by the Cisco Talos Security
Intelligence and Research Group, who set the intrusion and preprocessor rule states and advanced settings.

##### License and Action Requirements for Intrusion Policies

* Licenses-To add intrusion policies to a rule, you need to enable an license on the FDM-managed device
* Rule action-you can configure intrusion and file policies on rules that allow traffic only. Inspection is not performed on rules set to trust or block traffic. In addition, if the default action for the access control policy is allow, you can configure an intrusion policy but not a file policy.

##### Available Intrusion Policies for an Access Control Rule

For access control rules that allow traffic, you can select one of the following intrusion policies to inspect traffic for
intrusions and exploits. An intrusion policy examines decoded packets for attacks based on patterns, and can block or alter
malicious traffic.

The policies are listed from least to most secure:

* Connectivity over Security—This policy is built for organizations where connectivity (being able to get to all resources) takes precedence over network
  infrastructure security. The intrusion policy enables far fewer rules than those enabled in the Security over Connectivity
  policy. Only the most critical rules that block traffic are enabled. Select this policy if you want to apply some intrusion
  protection but you are fairly confident in the security of your network.
* Balanced Security and Connectivity—This policy is designed to balance overall network performance with network infrastructure security. This policy is appropriate
  for most networks. Select this policy for most situations where you want to apply intrusion prevention.
* Security over Connectivity—This policy is built for organizations where network infrastructure security takes precedence over user convenience. The
  intrusion policy enables numerous network anomaly intrusion rules that could alert on or drop legitimate traffic. Select this
  policy when security is paramount or for traffic that is high risk.
* Maximum Detection—This policy is built for organizations where network infrastructure security is given even more emphasis than is given by
  the Security Over Connectivity policy, with the potential for even greater operational impact. For example, the intrusion
  policy enables rules in a large number of threat categories including malware, exploit kit, old and common vulnerabilities,
  and known in-the-wild exploits. If you select this policy, carefully evaluate whether too much legitimate traffic is being
  dropped.

**Related Information**

* [Intrusion, File, and
  Malware Inspection in FDM Access Control Policies](#Intrusion_File_and_Malware_Inspection_in_FTD_Access_Control_Policies)

#### File Policy Settings in an FDM-Managed Access Control Rule

Use file policies to detect malicious software, or *malware*, using Advanced Malware Protection for Firepower (AMP for Firepower). You can also use file policies to perform file control,
which allows control over all files of a specific type regardless of whether the files contain malware.

AMP for Firepower uses the AMP cloud to retrieve dispositions for possible malware detected in network traffic, and to obtain
local malware analysis and file pre-classification updates. The management interface must have a path to the Internet to reach
the AMP cloud and perform malware lookups. When the device detects an eligible file, it uses the file's SHA-256 hash value
to query the AMP cloud for the file's disposition. The possible dispositions are:

* Malware—The AMP cloud categorized the file as malware. An archive file (e.g. a zip file) is marked as malware if any file
  within it is malware.
* Clean—The AMP cloud categorized the file as clean, containing no malware. An archive file is marked as clean if all files
  within it are clean.
* Unknown—The AMP cloud has not assigned a disposition to the file yet. An archive file is marked as unknown if any file within
  it is unknown.
* Unavailable—The system could not query the AMP cloud to determine the file's disposition. You may see a small percentage of
  events with this disposition; this is expected behavior. If you see a number of "unavailable" events in succession, ensure
  that the Internet connection for the management address is functioning correctly.

##### License and Action Requirements for File Policies

Licenses-To add file policies to a rule, you need to enable two licenses on the Firepower Device Manager:

* license
* Malware license

Rule action-You can configure file policies on rules that allow traffic only. Inspection is not performed on rules set to trust or block
traffic. In addition, if the default action for the access control policy is allow, you can configure an intrusion policy
but not a file policy.

##### Available File Policies for an Access Control Rule

* None—Do not evaluate transmitted files for malware and do no file-specific blocking. Select this option for rules where file transmissions
  are trusted or where they are unlikely (or impossible), or for rules where you are confident your application or URL filtering
  adequately protects your network.
* Block Malware All—Query the AMP cloud to determine if files traversing your network contain malware, then block files that represent threats.
* Cloud Lookup All—Query the AMP cloud to obtain and log the disposition of files traversing your network while still allowing their transmission.
* Block Office Document and PDF Upload, Block Malware Others—Block users from uploading Microsoft Office documents and PDFs. Additionally, query the AMP cloud to determine if files traversing
  your network contain malware, then block files that represent threats.
* Block Office Documents Upload, Block Malware Others—Block users from uploading Microsoft Office documents. Additionally, query the AMP cloud to determine if files traversing
  your network contain malware, then block files that represent threats.

**Releated Information:**

* [Intrusion Policy Settings
  in an FDM Access Control Rule](#Intrusion_Policy_Settings_in_an_FTD_Access_Control_Rule)

#### Logging Settings in an FDM-Managed Access Control Rule

##### Logging Settings for Access Control Rule

The logging settings for an access rule determine whether connection events are issued for traffic that matches the rule.

You should log connections according to the security and compliance needs of your organization. If your goal is to limit the
number of events you generate and improve performance, only enable logging for the connections critical to your analysis.
However, if you want a broad view of your network traffic for profiling purposes, you can enable logging for additional connections.

| **Caution** | ---   Logging blocked TCP connections during a Denial of Service (DoS) attack can affect system performance and overwhelm the database with multiple similar events. Before you enable logging for a Block rule, consider whether the rule is for an Internet-facing interface or other interface vulnerable to DoS attack.   --- |
| --- | --- |

* [Procedure](#Procedure)

##### Procedure

###### Procedure

---

| **Step 1** | [Create or edit the access control rule](#Configure_the_FTD_Access_Control_Policy) and click the Logging tab. |
| --- | --- |
| **Step 2** | Specify the log action:   * Log at Beginning and End of Connection—Issue events at the start and end of a connection. Because end-of-connection events contain everything that start-of-connection   events contain, plus all of the information that could be gleaned during the connection, Cisco recommends that you do not   select this option for traffic that you are allowing. Logging both events can impact system performance. However, this is   the only option allowed for blocked traffic. * Log at End of Connection—Select this option if you want to enable connection logging at the end of the connection, which is recommended for allowed   or trusted traffic. * Log None—Select this option to disable logging for the rule. This is the default.  | **Note** | When an intrusion policy, invoked by an access control rule, detects an intrusion and generates an intrusion event, the system automatically logs the end of the connection where the intrusion occurred, regardless of the logging configuration of the rule. For connections where an intrusion was blocked, the action for the connection in the connection log is Block, with a reason of Intrusion Block, even though to perform intrusion inspection you must use an Allow rule. | | --- | --- | |
| **Step 3** | Specify where to send connection events:  If you want to send a copy of the events to an external syslog server, select the server object that defines the syslog server. If the required object does not already exist, you will need to create one. See [Create and Edit Syslog Server Objects](#Create_Syslog_Server_Objects) for more information.  Because event storage on the device is limited, sending events to an external syslog server can provide more long-term storage and enhance your event analysis.  For [Cisco Security Analytics and Logging](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_ae75b8a9-0b20-4170-a407-1138e0fa4ea6)  subscribers:   * If you send events to the Cisco cloud through a Secure Event Connector (SEC), [specify an SEC as your syslog server](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging). You will then be able to see these events alongside file policy and malware policy connection events. * If you send events directly to the Cisco cloud without an SEC, specify when to log events (at the beginning or end of the   connection) but do not specify the SEC as the syslog server. |
| **Step 4** | File Events  Check Log Files if you want to enable logging of prohibited files or malware events. You must select a file policy in the rule to configure this option. The option is enabled by default if you select a file policy for the rule. We recommend you leave this option enabled.  When the system detects a prohibited file, it automatically logs one of the following types of event to the FDM-manageds internal buffer.   * File events, which represent detected or blocked files, including malware files. * Malware events, which represent detected or blocked malware files only. * Retrospective malware events, which are generated when the malware disposition for a previously detected file changes.   For connections where a file was blocked, the action for the connection in the connection log is Block even though to perform file and malware inspection you must use an Allow rule. The connection's Reason is either File Monitor (a file type or malware was detected), or Malware Block or File Block (a file was blocked) |
| **Step 5** | Click Save. |
| **Step 6** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Security Group Tags

##### About Security Group Tags

If you use Cisco Identity Services Engine (ISE) to define and use security group tag (SGT) for classifying traffic in a Cisco TrustSec network, you can write access control rules that use SGT as matching criteria.
Thus, you can block or allow access based on security group membership rather than IP addresses.

In ISE, you can create a SGT and assign host or network IP addresses to each tag. If you assign an SGT to a user's account,
the SGT is assigned to the user's traffic. After you configure FDM-managed device to connect to an ISE server and create the SGT, you can create SGT groups in Security Cloud Control and build access control rules around them. Note that you must configure ISE's SGT Exchange Protocol (SXP) mapping before
you can associate an SGT to an FDM-managed device. See Security Group Tag Exchange Protocol in the [Cisco Identity Services Engine Administrator Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/products-installation-guides-list.html) of the version you are currently running for more information.

When an FDM-managed device evaluates SGT as a traffic matching criteria for an access control rule, it uses the following priority:

1. The source SGT defined in the packet, if any. No destination matching is done using this technique. For the SGT to be in the
   packet, the switches and routers in the network must be configured to add them. See the ISE documentation for information
   on how to implement this method.
2. The SGT assigned to the user session, as downloaded from the ISE session directory. You need to enable the option to listen
   to session directory information for this kind of SGT matching, but this option is on by default when you first create the
   ISE identity source. The SGT can be matched to source or destination. Although not required, you would also normally set up
   a passive authentication identity rule, using the ISE identity source along with an AD realm, to collect user identity information.
3. The SGT-to-IP address mapping downloaded using SXP. If the IP address is within the range for an SGT, then the traffic matches
   the access control rule that uses the SGT. The SGT can be matched to source or destination.

   | **Note** | ---   You cannot use the information retrieved from ISE directly in an access control rule. Instead, you need to create SGT groups, which refer to the downloaded SGT information. Your SGT groups can refer to more than one SGT, so you can apply policy based on a relevant collections of tags if that is appropriate.   --- |
   | --- | --- |

##### Version Support

Security Cloud Control currently supports SGT and SGT groups on FDM-managed devices running Version 6.5 and later. an FDM-managed device allows you to configure and connect to an ISE server in Version 6.5 and later but not does not support SGT configuration
in the UI until Version 6.7.

From the FDM-managed UI, this means that an FDM-managed device running Version 6.5 or later can download SXP mappings of SGTs but cannot be manually added to objects or access control
rules. To make changes to the SGTs for devices running Version 6.5 or Version 6.6, you must use the ISE UI. If the device
running Version 6.5 is onboarded to Security Cloud Control, however, you can see the current SGTs associated with the device and create SGT groups.

##### SGT in Security Cloud Control

##### Security Group Tags

SGTs are read-only in Security Cloud Control. You cannot create or edit an SGT in Security Cloud Control. To create an SGT, see the [Cisco Identity Services Engine Administrator Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/products-installation-guides-list.html) of the version your are currently running.

##### SGT Groups

| **Note** | ---   An FDM-managed device refers to groups of SGTs as SGT dynamic objects. In Security Cloud Control, these lists of tags are currently called SGT groups. You can create an SGT group in Security Cloud Control without referring to the FDM-managed device or ISE UI.   --- |
| --- | --- |

Use SGT groups to identify source or destination addresses based on an SGT assigned by ISE. You can then use the objects in
access control rules for purposes of defining traffic matching criteria. You cannot use the information retrieved from ISE
directly in an access control rule. Instead, you need to create SGT groups, which refer to the downloaded SGT information.

Your SGT groups can refer to more than one SGT, so you can apply policy based on relevant collections of tags if that is appropriate.

In order to create an SGT group in Security Cloud Control, you must have at least one SGT already configured and SGT mappings from an ISE server configured for the FDM-managed console of the device you want to use. Note that if more than one FDM-managed device is associated with the same ISE server, an SGT or SGT group can be applied to more than one device. If a device is
not associated with an ISE server, you cannot include SGT objects in your access control rule, or apply an SGT group to that
device configuration.

##### SGT Groups in Rules

SGT groups can be added to access control rules; they appear as source or destination
network objects. For more information about how networks work in rules, see
[Source and Destination Criteria
in an FDM Access Control Rule](#Source_and_Destination_Criteria_in_an_FTD_Access_Control_Rule).

You can create an SGT group from the Objects page. See [Create an SGT Group](#Create_an_FTD_SGT_Group) for more information.

##### Create an SGT Group

To create an SGT group that can be used for an access control rule, use the following procedure:

###### Before you begin

You must have the following configurations or environments configured prior to creating a security group tag (SGT) group:

* FDM-managed device must be running at least Version 6.5.
* You must configure the ISE identity source to subscribe to SXP mappings and enable deploy changes. To manage SXP mappings,
  see Configure Security Groups and SXP Publishing in ISE of the [Firepower Device Manager Configuration Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version you're using, Version 6.7 and later.
* All SGTs must be created in ISE. To create an SGT, see the [Cisco Identity Services Engine Configuration Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html#Configuration) of the version your are currently running.

###### Procedure

---

| **Step 1** | On the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > FTD  > Network. |
| **Step 3** | Enter an Object Name. |
| **Step 4** | (Optional) Add a description. |
| **Step 5** | Click SGT and use the drop-down menu to check all the applicable SGTs you want included in the group. You can sort the list by SGT name. |
| **Step 6** | Click Save.   | **Note** | You cannot create or edit SGTs in Security Cloud Control, you can only add or remove them from an SGT group. To create or edit an SGT, see the [Cisco Identity Services Engine Configuration Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html#Configuration) of the version you are currently running. | | --- | --- | |

---

##### Edit an SGT Group

To edit an SGT group, use the following procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the SGT group you want to edit by using object filters and search field. |
| **Step 3** | Select the SGT group and click the edit icon  in the Actions pane. |
| **Step 4** | Modify the SGT group. Edit the name, description, or the SGTs associated with the group. |
| **Step 5** | Click Save.   | **Note** | You cannot create or edit SGTs in Security Cloud Control, you can only add or remove them from an SGT group. To create or edit an SGT, see the [Cisco Identity Services Engine Configuration Guide](https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html#Configuration) of the version you are currently running. | | --- | --- | |

---

##### Add an SGT Group to an Access Control Rule

To add an SGT group to an access control rule, use the following procedure:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want to add the SGT group to. |
| **Step 4** | In theManagement pane, select Policy. |
| **Step 5** | Click the blue plus button  for either the Source or Destination objects and select SGT Groups. |
| **Step 6** | Locate the SGT group(s) you want to edit by using object filters and search field. |
| **Step 7** | Click Save. |
| **Step 8** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be).   | **Note** | If you need to create an additional SGT group, click Create New Object. Fill in the required information mentioned in [Create an FTD SGT Group](#Create_an_FTD_SGT_Group) and Add the SGT group to the rule. | | --- | --- | |

---

#### Application Criteria in an FDM-Managed Access Control Rule

The Application criteria of an access rule defines the application used in an IP connection, or a filter that defines applications
by type, category, tag, risk, or business relevance. The default is any application.

Although you can specify individual applications in the rule, application filters simplify policy creation and administration.
For example, you could create an access control rule that identifies and blocks all high risk, low business relevance applications.
If a user attempts to use one of those applications, the session is blocked.

In addition, Cisco frequently updates and adds additional application detectors via system and vulnerability database (VDB)
updates. Thus, a rule blocking high risk applications can automatically apply to new applications without you having to update
the rule manually.

You can specify applications and filters directly in the rule, or create application filter objects that define those characteristics.
The specifications are equivalent, although using objects can make it easier to stay within the 50-items-per-criteria system
limit if you are creating a complex rule. See [Create and Edit a Firepower Application Filter Object](#Create_and_Edit_a_Firepower_Application_Filter_Object) for more information about creating an application filter object.

To modify the application and application filters used in a rule, you can edit the rule using the procedure in [Configure the FDM Access Control Policy](#FTD_Access_Control_Policy). Simple edits may be performed without entering edit mode. From the policy page, you can modify an application condition
in the rule by selecting the rule and clicking the + button within the application condition column and selecting a new object or element in the popup dialog box. You can also
click the x on an object or element to remove it from the rule.

#### Intrusion, File, and Malware Inspection in FDM-Managed Access Control Policies

Intrusion and file policies work together as the last line of defense before traffic is allowed to its destination:

* Intrusion policies govern the system's intrusion prevention capabilities.
* File policies govern the system's file control and AMP for Firepower capabilities.

All other traffic handling occurs before network traffic is examined for intrusions, prohibited files, and malware. By associating
an intrusion or file policy with an access control rule, you are telling the system that before it passes traffic that matches
the access control rule's conditions, you first want to inspect the traffic with an intrusion policy, a file policy, or both.

You can configure intrusion and file policies on rules that allow traffic only. Inspection is not performed on rules set to
trust or block traffic. In addition, if the default action for the access control policy is allow, you can configure an intrusion
policy but not a file policy.

For any single connection handled by an access control rule, file inspection occurs before intrusion inspection. That is,
the system does not inspect files blocked by a file policy for intrusions. Within file inspection, simple blocking by type
takes precedence over malware inspection and blocking. Until a file is detected and blocked in a session, packets from the
session may be subject to intrusion inspection.

| **Note** | ---   By default, the system disables intrusion and file inspection of encrypted payloads. This helps reduce false positives and improve performance when an encrypted connection matches an access control rule that has intrusion and file inspection configured. Inspection works with unencrypted traffic only.   --- |
| --- | --- |

**Related Information:**

* [Intrusion Policy Settings
  in an FDM Access Control Rule](#Intrusion_Policy_Settings_in_an_FTD_Access_Control_Rule)
* [File Policy Settings in
  an FDM Access Control Rule](#File_Policy_Settings_in_an_FTD_Access_Control_Rule)

#### Custom IPS Policy in an FDM-Managed Access Control Rule

You cannot have more than one instance of the same custom IPS policy associated to a single device.

| **Note** | ---   Associating an IPS policy with an access control rule means that passing traffic is submitted to deep packet inspection. The only supported rule action for an access control rule with an IPS policy is Allow.  Use the following procedure to associate a custom IPS policy to an FDM-managed device:   --- |
| --- | --- |

##### Procedure

---

| **Step 1** | Create a custom IPS policy. See [Create a Custom IPS Policy](#Configure_Firepower_Custom_IPS_Policies) for more information. |
| --- | --- |
| **Step 2** | In the left pane, click Policies > FDM > Policies. |
| **Step 3** | Scroll or filter through the list of FDM-managed device policies and select the policy you want to associate with a custom IPS policy. |
| **Step 4** | Click the blue plus button . |
| **Step 5** | In the Order field, select the position for the rule within the policy. Network traffic is evaluated against the list of rules in numerical order, 1 to "last." |
| **Step 6** | Enter the rule name. You can use alphanumeric characters, spaces, and these special characters: + . \_ - |
| **Step 7** | Select the Intrusion Policy tab. Expand the drop-down menu to see all the available intrusion policies and select the desired custom IPS policy. |
| **Step 8** | Define the traffic matching criteria by using any combination of attributes in the remaining tabs: Source/Destination, URLs, Applications, and File Policy. |
| **Step 9** | (Optional) Click the logging tab to enable logging and collect connection events reported by the access control rule. |
| **Step 10** | Click Save. |
| **Step 11** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### TLS Server Identity Discovery in Firepower Threat Defense

You can now perform improved URL filtering and application control on traffic with threat defense's unique TLS Server Identity Discovery that allows control and precision when it comes to your environment. You do not have
decrypt the traffic for this feature to work.

| **Note** | ---   Support for the Server Identity Discovery feature is limited to Version 6.7 and later.   --- |
| --- | --- |

* [Enable the TLS Server Identity Discovery](#Enable_theTLS_Server_IdentityDiscovery)

##### Enable the TLS Server Identity Discovery

Use the following procedure to enable, or disable, the TLS Server Identity Discovery feature for your FDM-managed access control policies:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device. |
| **Step 4** | In the Management pane located to the right, select Policy. |
| **Step 5** | Click the Access Policy Settings gear icon  in the upper right corner of the table . |
| **Step 6** | Slide the toggle to enable TLS Server Identity Discovery. |
| **Step 7** | Click Save. |

---

### Intrusion Prevention System

The Cisco Talos Intelligence Group (Talos) detects and correlates threats in real time and maintains a reputation disposition
on billions of files. The Cisco IOS Intrusion Prevention System (IPS) is an inline, deep-packet inspection feature that mitigates
attacks on your network by using the threat intelligence data from Talos to accurately identify, classify, and drop malicious
traffic in real time.

Security Cloud Control provides the ability to activate and tune the IPS feature on FDM-managed devices that run software versions 6.4.x.x through 6.6.0.x and 6.6.1.x.

| **Note** | ---   Security Cloud Control currently does not support IPS rule tuning on version 6.7.   --- |
| --- | --- |

On the Security Cloud Control menu bar, navigate Policies > Signature Overrides to
perform these tasks:

* Resolve inconsistencies in overrides across multiple devices.
* View and hide threat events.
* Override how a threat event is handled by changing the rule action.

* [Threat Events](#Threat_Events)
* [Firepower Intrusion Policy Signature Overrides](#Firepower_Intrusion_Policy_Signature_Overrides)
* [Custom Firepower Intrusion Prevention System Policy](#Custom_Firepower_Intrusion_Prevention_System_Policy)

**Related Information:**

* [Firepower Intrusion Policy Signature Overrides](#Firepower_Intrusion_Policy_Signature_Overrides)
* [Threat Events](#Threat_Events)
* [Troubleshoot Intrusion Prevention System](troubleshooting.html#Troubleshoot_Intrusion_Prevention_System)

#### Threat Events

A threat event report is a report of traffic that has been dropped, or that has generated an alert, after matching one of
Cisco Talos' intrusion policies. In most cases, there's no need to tune IPS rules. If necessary, you have the option to override
how an event is handled by changing the matching rule action in Security Cloud Control.

Note the following behaviors of the Threats page:

* Threat events that are displayed are not live. Devices are polled hourly for additional Threat events.
* Threat events that are not included in the [Live or Historical](cisco-security-analytics-and-logging.html#ViewLive_Events) view are not part of Cisco Security Analytics and Logging.
* To see Threat events that you've hidden from view, click the filter icon and check the view hidden option.
* If you are a subscriber to [Cisco Security Analytics and Logging](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_ae75b8a9-0b20-4170-a407-1138e0fa4ea6) , the events you see in Threat Events table do not contain events sent to the Secure Event Connector.

##### Procedure

---

| **Step 1** | In the left pane, click Insights & Reports > Firewall Threat Defense > Threats Dashboard (FDM). You can [filter](#About_Object_Filters) what events are shown and search by source IP address. |
| --- | --- |
| **Step 2** | Click on a threat event to expand the details panel on the right.   1. For more information on the rule, click the Rule Document URL in the Rule Details section. 2. To hide this event, check the toggle switch for Hide Events. The event handling continues as is, but you won't see it here, unless you click View Hidden or un-hide this event. 3. To edit rule overrides, click Tune Rule. When you change a rule action in Security Cloud Control, the override applies to all the pre-defined policies. This is different than in the FDM-managed device where each rule can be different from policy to policy.  | **Note** | Security Cloud Control provides the ability to tune rules on FDM-managed devices that run software versions 6.4.x.x through 6.6.0.x and 6.6.1.x. Security Cloud Control currently does not support rule tuning on FDM-managed Version 6.7. | | --- | --- |   * In the Override All devices pull-down, select an action and click Save.    + Drop-This choice creates an event when this rule matches traffic and then drops the connection. Use this action to tighten security     of certain rules. For example, specifying Drop would make security stricter when the Talos rule is matched even if the "Connectivity     over Security" policy is specified for the access control rule.   + Alert-This choice creates an event when this rule matches traffic, but it does not drop the connection. A use case for "Alert"     is when traffic is blocked, but the customer wants to allow, it and look at the alerts before disabling the rule.   + Disabled-This choice prevents traffic from being matched to the rule. No events are generated. The use case for "Disabled" is to stop     false positives in reports, or remove rules that do not apply to your environment, like disabling Apache httpd rules if you     don't use httpd.   + Default-This choice returns a rule to the default action it was assigned by Talos, for the intrusion policy it is listed in. For     example, when you return an intrusion rule to "Default" that may mean its action returns to "Alert" in the "Connectivity over     Security" policy and "Block" in the "Balanced Security and Connectivity" policy.  * To edit rule overrides by device, check the Advanced Options slider. This section shows you the configured rule action for each device, which you can change by checking the affected device,   selecting an override action, and clicking Save. * Affected Devices does not indicate the source devices. Instead, it shows the FDM-managed devices reporting the event.  | **Note** | * Click the refresh () button to refresh the table that shows threats based on the current search filters. * Click the export () button to download the current summary of the threats to a comma-separated value (.csv) file. You can open the .csv file   in a spreadsheet application such as Microsoft Excel to sort and filter the items on your list. Security Cloud Control exports the basic threat details to the file except for additional information such as time, source, and device. | | --- | --- | |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Firepower Intrusion Policy Signature Overrides

In most cases, there's no need to tune any IPS rules. If necessary, you have the option to override how an event is handled
by changing the matching rule action in Security Cloud Control. Security Cloud Control gives you options to resolve issues with the overrides.

* [Manage Signature Overrides](#Manage_Signature_Overrides)
* [Create A Signature Override](#Create_A_Signature_Override)
* [Remove A Signature Override](#Remove_ASignature_Override)

##### Manage Signature Overrides

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Signature Overrides. You can [filter](#About_Object_Filters)what devices and policy override policies are shown. You can also search for intrusion policies by name or intrusion rule SID. |
| --- | --- |
| **Step 2** | Click on the name of policy override policy to expand the details panel on the right. |
| **Step 3** | In the Issues  pane, a  badge indicates the overrides are inconsistent across the devices. You can see the INCONSISTENT field with the number of devices affected:   1. To ignore the issue, click Ignore. This doesn't change the issue but removes the indicator badge from the Issues column. 2. To resolve the issue, click Resolve. In the left panel, select the policies to compare and show their consistent and inconsistent overrides.     * To merge the policies together:       1. Click Resolve by Merging to combine them into a single policy with the same overrides on all its devices.      2. Click Confirm.    * To rename a policy:       1. In the policy's section, click Rename and give it a different name.      2. Click Confirm.    * To ignore a policy:       1. In the policy's section, click Ignore.      2. Click Confirm.    * To ignore all the inconsistencies, click Ignore All. |
| **Step 4** | If there are individual Talos intrusion rules that were changed on the device using an FDM-managed device you will see them in the Overrides pane. You can change the override action for an intrusion rule by clicking Tune link and choosing an override action. This action will be applied to that rule in all of the Talos intrusion policies it's used in. Note that if you choose to restore the default action rule (Default), you cannot tune the intrusion rule again until it is triggered by the environment.   * Connectivity over Security * Balanced Security and Connectivity * Security over Connectivity * Maximum Detection   For consistency across devices, the override action will be saved to every device associated with the intrusion override policy.  These are the effects of the override action:   * Drop-This choice creates an event when this rule matches traffic and then drops the connection. Use this action to tighten security   of certain rules. For example, specifying Drop would make security stricter when the Talos rule is matched even if the "Connectivity   over Security" policy is specified for the access control rule. * Alert-This choice creates an event when this rule matches traffic, but it does not drop the connection. A use case for "Alert"   is when traffic is blocked, but the customer wants to allow, it and look at the alerts before disabling the rule. * Disabled-This choice prevents traffic from being matched to the rule. No events are generated. The use case for "Disabled" is to stop   false positives in reports, or remove rules that do not apply to your environment, like disabling Apache httpd rules if you   don't use httpd. * Default-This choice is only applicable if the rule's default action is different in the Talos intrusion policy levels. For example,   when you return an intrusion rule to "Default" that may mean its action returns to "Alert" in the "Connectivity over Security"   policy and "Block" in the "Balanced Security and Connectivity" policy. * Edit rule overrides with the following options:    + Override for all devices - This option sets the required action to all the devices managed by Security Cloud Control. Select an option from the drop-down menu. If the rule has different override values for different intrusion override policies,     the drop-down option is "Multiple" by default.   + Edit rule overrides by device - check the Advanced Options slider and select the Overrides by Devices tab. This option shows you the configured rule action for each device, which you can change by checking the affected device,     selecting an override action, and clicking Save.   + Edit rule overrides by policy - check the Advanced Options slider and select the All Overrides tab. This section is only applicable if your tenant has more than one IPS policy configured. You can manage all IPs policies     from this page, including policies that have more than one device associated to it. |
| **Step 5** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### Create A Signature Override

You can only create signature overrides for IPS rules that are already triggered on an FDM-managed device. When you create a signature override in Security Cloud Control, the override is automatically applies the configured action (Drop, Alert, Disabled, Default) to all of the policy levels.

###### Procedure

---

| **Step 1** | In the left pane, click Insights & Reports > Firewall Threat Defense > Threats Dashboard (FDM). |
| --- | --- |
| **Step 2** | Select a threat from the table and expand it. In the Tune Actions pane, click Tune. |
| **Step 3** | Tune the rules as described in step 4 in the [Firepower Intrusion Policy Signature Overrides](#Firepower_Intrusion_Policy_Signature_Overrides) procedure. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### Remove A Signature Override

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Signature Overrides. |
| --- | --- |
| **Step 2** | Click on the name of override to expand the details panel on the right. |
| **Step 3** | Expand the Overrides pane and select the override you want to remove, then click Tune. |
| **Step 4** | Set the default action to Default. |
| **Step 5** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Custom Firepower Intrusion Prevention System Policy

##### About Custom IPS Policies

With the introduction of version 6.7, the improved Snort 3 processing engine allows
you to create and customize Intrusion Prevention System (IPS) policies using rules
provided by the Cisco Talos Intelligence Group (Talos). The best practice is to
create your own policy based on the provided Talos policy templates and change that
if you need to adjust rule actions.

| **Note** | ---   At this time, Security Cloud Control does not support custom IPS rules. You can create and modify custom IPS policies with rules that are provided by Talos, but you cannot create your own IPS rules and apply them to custom IPS policies.   --- |
| --- | --- |

The base templates include the same list of intrusion rules (also known as signatures), but they differ in the actions taken
for each rule. For example, a rule might be enabled in one policy, but disabled in another policy.For another example, you
may find that a particular rule is giving you too many false positives, where the rule is blocking traffic that you do not
want blocked; you can disable the rule without needing to switch to a less-secure intrusion policy. You could alternatively
change it to alert on matches without dropping traffic.

##### IPS Policy Base Template

The base templates include the same list
of intrusion rules (also known as signatures), but they differ in the actions taken
for each rule. For example, a rule might be enabled in one policy, but disabled in
another policy. For another example, you may find that a particular rule is giving
you too many false positives, where the rule is blocking traffic that you do not
want blocked; you can disable the rule without needing to switch to a less-secure
intrusion policy. You could alternatively change it to alert on matches without
dropping traffic.

The base templates provided are suggested configurations
based on the type of protection your network might need. You can use any of the
following templates as the base when you create a new policy:

| **Caution** | ---   Do **not** modify the default IPS policies provided with an FDM-managed device enabled with Snort 3. We **strongly** recommend creating new custom IPS policies based on the templates below, and to use a unique name for the new policy that is different from the names of the default IPS policies listed below. If you need to troubleshoot your policies, Cisco TAC can easily locate the custom policy and revert to a default policy; this keeps your network protected without losing your customized changes.   --- |
| --- | --- |

The base templates provided are suggested configurations based on the type of
protection your network might need. You can use any of the following templates as
the base when you create a new policy:

* Maximum Detection - These policies are built for
  networks where network infrastructure security is given even more emphasis
  than is given by the Security Over Connectivity policies, with the potential
  for even greater operational impact.
* Security Over Connectivity - These policies are built
  for networks where network infrastructure security takes precedence over
  user convenience. The intrusion policy enables numerous network anomaly
  intrusion rules that could alert on or drop legitimate traffic.
* Balanced Security and Connectivity - These policies
  are built for both speed and detection. Used together, they serve as a good
  starting point for most networks and deployment types.
* Connectivity Over Security - These policies are built
  for networks where connectivity, the ability to get to all resources, takes
  precedence over network infrastructure security. Only the most critical
  rules that block traffic are enabled.
* No Rules Active - The rules included in the policy are
  disabled by default.

| **Tip** | ---   The Maximum Detection base template requires a considerable amount of memory and CPU to work effectively. Security Cloud Control recommends deploying IPS policies using this template to models such as the 2100, 4100, or virtual device.  As new vulnerabilities become known, Talos releases intrusion rule updates. These rule updates can modify any Cisco-provided network analysis or intrusion policy, and may provide new and updated intrusion rules and preprocessor rules that are automatically applies to existing rules and policy settings. Rule updates might also delete rules from the existing template bases and provide new rule categories, as well as modify the default variable set.   --- |
| --- | --- |

##### IPS Policy Mode

By default, all intrusion policies operate in Prevention mode to implement an IPS. In the Prevention inspection mode, if a connection matches an intrusion rule whose action is to
drop traffic, the connection is actively blocked.

If you instead want to test the effect of the intrusion policy on your network, you
can change the mode to Detection, which implements an
Intrusion Detection System (IDS). In this inspection mode, drop rules are treat like
alert rules, where you are notified of matching connections, but the action result
becomes **Would Have Blocked**, and connections are never in fact blocked.

##### IPS Rule Group Security Level

Security Cloud Control allows you to modify the security level of the rule groups included in your
policy. Note that this security level is applied to all the rules in the rule group
and not to individual rules.

| **Note** | ---   Changes made a rule group's security level are automatically submitted and cannot be reverted. You do not have to click Save to submit security level modifications. You must manually change the security level back.   --- |
| --- | --- |

##### IPS Rule Action

Modify the actions of an individual rule or multiple rules within a rule group at any time. IPS rules can be set as the following
options:

* Disabled—Do not match traffic against this rule. No events are generated.
* Alert—Create an event when this rule matches traffic, but do not drop the connection.
* Drop—Create an event when this rule matches traffic, and also drop the connection.

##### FDM Templates and Custom IPS Policy

Templates derived from a device with Snort 3 enabled can only be applied to devices
that also have Snort 3 enabled. Due to the variability in rules supported and
processed by Snort 2 and Snort 3, a template configured with Snort 3 cannot fully
support and protect a device configured with Snort 2. See [Switching from Snort 2 to Snort
3](onboard-devices-and-services.html#Upgrade_to_Snort_3) for more information.

If you happen to use the ASA Migration tool to create an FDM template from an ASA configuration, we **strongly** recommend not configuring, or un-configuring any IPS policies. ASA devices do not support the Snort engine and migrating
IPS policies from an ASA configuration to an FDM-managed device configuration may cause issues. If you do use the ASA migration tool, we recommend creating custom IPS policies for
the device after creating and deploying the template.

See [FDM Templates](#FTD_Templates) for more information about templates.

##### Rulesets and Custom IPS Policy

Rulesets are not yet support on devices configured for Snort 3. The following
limitations apply:

* You cannot attach rulesets to Snort 3-enabled devices.
* You cannot create a ruleset from an existing device that has Snort 3
  installed.
* You cannot associate a custom IPS policy to a ruleset.

##### Prerequisites

You can view the available IPS policies from the Intrusion policies page, but you cannot create or modify custom IPS policies without the following prerequisites:

##### Device Support

* Firepower 1000 series
* Firepower 2100 series
* Firepower 4100 series
* Threat
  Defense virtual with AWS
* Threat
  Defense virtual with Azure

##### Software Support

Devices must be running at least version 6.7 and Snort 3.

If your device is running a version prior to 6.7, upgrade your device. See [Upgrade an FDM-Managed Device](onboard-devices-and-services.html#Upgrade_a_Single_FTD_Device) for more information.

If your device is running version 6.7 with Snort 2, please note that some intrusion rules in Snort 2.0 might not exist in
Snort 3.0. See [Switching from Snort 2 to Snort 3](onboard-devices-and-services.html#Upgrade_to_Snort_3) for more information.

| **Note** | ---   To find out what version of software version and Snort engine your device is running, simply locate and select the device on the Security Devices page and look at the Device Details   --- |
| --- | --- |

* [Configure Firepower Custom IPS Policies](#Configure_Firepower_Custom_IPS_Policies)

**Related Information:**

* [Configure Firepower Custom IPS Policies](#Configure_Firepower_Custom_IPS_Policies)
* [Custom IPS Policy in an FDM Access Control Rule](#Custom_IPS_Policy_in_an_FTD_Access_Control_Rule)

##### Configure Firepower Custom IPS Policies

Before you create or modify a custom IPS policy for your FDM-managed device in Security Cloud Control, be sure to read the [IPS prerequisites](#Custom_Firepower_Intrusion_Prevention_System_Policy).

At this time, Security Cloud Control does **not** support custom IPS rules. You can create and modify custom IPS policies with rules that are provided by Talos, but you cannot
create your own IPS rules and apply them to custom IPS policies.

If you experience issues creating or editing IPS policies in Security Cloud Control, see [Troubleshoot Intrusion Prevention System](troubleshooting.html#Troubleshoot_Intrusion_Prevention_System) for more information.

| **Note** | ---   You cannot delete or reorder the rules within a custom IPS policy's rule group.   --- |
| --- | --- |

* [Create a Custom IPS Policy](#Create_a_Custom_IPSPolicy)
* [Edit a Custom IPS Policy](#Edit_a_Custom_IPS_Policy)
* [Edit Rule Groups in a Custom IPS Policy](#Edit_Rule_Groupsin_a_Custom_IPS_Policy)
* [Delete a Custom IPS policy](#Delete_a_Custom_IPS_policy)

###### Create a Custom IPS Policy

Use the following procedure to create a new custom IPS policy with the IPS rules provided by Talos:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Intrusion Prevention. |
| --- | --- |
| **Step 2** | Click the blue plus button . |
| **Step 3** | Expand the drop-down menu of the Base Template. If your device is running version 7.2 with Snort 3, you must expand the drop-down and then click **Choose** to select the template.If the device is running version 7.1.x and earlier, simply expand the drop-down menu and select one of the following templates:   * Maximum Detection - These policies are built   for networks where network infrastructure security is given even   more emphasis than is given by the Security Over Connectivity   policies, with the potential for even greater operational   impact.       | **Tip** | The Maximum Detection base template requires a considerable amount of memory and CPU to work effectively. Security Cloud Control recommends deploying IPS policies using this template to models such as the 2100, 3100, 4100, or threat defense virtual. |   | --- | --- | * Security Over Connectivity - These policies   are built for networks where network infrastructure security takes   precedence over user convenience. The intrusion policy enables   numerous network anomaly intrusion rules that could alert on or drop   legitimate traffic. * Balanced Security and Connectivity - These   policies are built for both speed and detection. Used together, they   serve as a good starting point for most networks and deployment   types. * Connectivity Over Security - These policies   are built for networks where connectivity, the ability to get to all   resources, takes precedence over network infrastructure security.   Only the most critical rules that block traffic are enabled. * No Rules Active - The rules included in the   policy are disabled by default. |
| **Step 4** | Enter a Name for the policy. We **strongly** recommend using a name that is unique and different from the default base templates. If you ever need to troubleshoot your IPS policy, Cisco TAC can easily locate the custom policy and revert to a default policy; this keeps your network protected without losing your customized changes. |
| **Step 5** | (Optional) Enter a Description for the policy. |
| **Step 6** | Select the IPS Mode:   * Prevention - If a connection matches an intrusion rule whose action is to drop traffic, the connection is actively blocked. * Detection - If a connection matches an intrusion rule whose action is to drop traffic, the action result becomes Would Have Blocked and no action is taken. |
| **Step 7** | Click Save.  What's Next?  Add your IPS policy to an FDM-managed device access control rule. See [Custom IPS Policy in an FDM Access Control Rule](#Custom_IPS_Policy_in_an_FTD_Access_Control_Rule) for more information. |

---

###### Edit a Custom IPS Policy

You can edit an existing IPS policy if you have onboarded an FDM-managed device that already has an IPS policy, if you created an IPS policy in FDM and
Security Cloud Control reads the policy from the deployed configuration, or if you just created a new
IPS policy.

Use the following procedure to modify an existing custom IPS policy:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Intrusion Prevention. |
| --- | --- |
| **Step 2** | Identify the IPS policy you want to edit. Click Edit. |
| **Step 3** | At the top of the page, click the edit icon . |
| **Step 4** | Edit the following desired fields:   * Base Template. * Name. * Description. * IPS Mode. |
| **Step 5** | Click Save. |
| **Step 6** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Edit Rule Groups in a Custom IPS Policy

You can override the default action of a rule within a rule group. Use the following procedure to edit the rules contained
within the rule group

###### Procedure

---

| **Step 1** |  |
| --- | --- |
| **Step 2** | In the left pane, click Policies > FDM > Intrusion Prevention. |
| **Step 3** | Identify the IPS policy you want to edit. Click Edit. |
| **Step 4** | From the Rule Group tab located to the left, expand the desired rule group. From the expanded list, select the group. |
| **Step 5** | Edit the rule group:   1. Edit the Security Level of the entire rule group by selecting the security level bar. Manually drag the security level to the type of security you    want applied to the entire rule group. Click Submit 2. Edit the Rule Action of an individual rule by expanding the rule's drop-down menu located to the right. 3. Edit the Rule Action of multiple rules by selecting the checkboxes of the desired rules and expanding the drop-down menu located above the table    of rules. This selection impacts all selected rules. 4. Edit the Rule Action of all the rules by selecting the checkbox in the title row of the table and expanding the drop-down menu located above the    table of rules. This selection impacts all the rules in the rule group. |
| **Step 6** | Click Save at the top of the policy page. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Delete a Custom IPS policy

Use the following procedure to delete a custom IPS policy from Security Cloud Control:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Intrusion Prevention. |
| --- | --- |
| **Step 2** | Identify the IPS policy you want to edit. Click Delete. |
| **Step 3** | Click OK to delete the policy. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

### Security Intelligence Policy

#### About Security Intelligence

The Security Intelligence policy gives you an early opportunity to drop unwanted traffic based on source/destination IP address
or destination URL. The system drops the traffic on the blocked list before evaluating it with the access control policy,
thus reducing the amount of system resources used.

You can block traffic based on the following:

* Cisco Talos feeds—Cisco Talos provides access to regularly updated security intelligence feeds. Sites representing security threats such as
  malware, spam, botnets, and phishing appear and disappear faster than you can update and deploy custom configurations. The
  system downloads feed updates regularly, and thus new threat intelligence is available without requiring you to redeploy the
  configuration.

  | **Note** | ---   Cisco Talos feeds are updated by default every hour. You can change the update frequency, and even update the feeds on demand, by logging into Firepower Device Manager and navigating from the home page: Device > Updates > View Configuration.   --- |
  | --- | --- |
* Network and URL objects—If you know of specific IP addresses or URLs you want to block, you can create objects for them and add them to the Blocked
  list or the Allowed list.

You create separate blocked and allowed lists for IP addresses (networks) and URLs.

#### License Requirements for Security Intelligence

You must enable the license on the FDM-managed device to use Security Intelligence.

For more information, see the Security Intelligence Feed Categories section of the Security Policies chapter of the appropriate [Cisco FTD Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

* [Configure the Firepower Security Intelligence Policy](#Configure_the_Firepower_Security_Intelligence_Policy)
* [Making Exceptions to the Firepower Security Intelligence Policy Blocked Lists](#Making_Exceptions_to_the_Firepower_Security_Intelligence_Policy_Blocked_Lists)
* [Security Intelligence Feeds for Firepower Security Intelligence Policies](#Security_Intelligence_Feeds_for_Firepower_Security_Intelligence_Policies)

#### Configure the Firepower Security Intelligence Policy

The Security Intelligence policy gives you an early opportunity to drop unwanted traffic based on source/destination IP address
or destination URL. Any allowed connections are still evaluated by access control policies and might eventually be dropped.
You must enable the license to use Security Intelligence.

* [Configure Firepower Security Intelligence Policy](#Procedure)

##### Configure Firepower Security Intelligence Policy

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the FDM-managed device for which you are going to create or edit a security intelligence policy. |
| **Step 4** | In the Management pane at the right, click  Policy. |
| **Step 5** | In the FDM-managed device Policies page, click Security Intelligence in the policy bar. |
| **Step 6** | If the policy is not enabled, click the Security Intelligence slider to enable it or click Enable in the About Security Intelligence information box.   | **Note** | You can disable Security Intelligence at any time by clicking the Security Intelligence toggle off. Your configuration is preserved, so that when you enable the policy again you do not need to reconfigure it. | | --- | --- | |
| **Step 7** | Select the row for Blocked List. Notice that, depending on your table view, there are plus signs  in the networks, network objects, network feeds, URLs, URL objects, and URL feeds columns.   * In the Add Networks to Blocked List dialog box and Add URL Object to Blocked List dialog box, you can search for an existing object or create one to suit your needs. Check the object you want to block and   then click Select.       | **Note** | Security Intelligence ignores IP address blocks using a /0 netmask. This includes the any-ipv4 and any-ipv6 network objects. Do not select these objects for network block-listing. |   | --- | --- | * In the Add URL Objects to Blocked List and   Add Network Feeds to Blocked List dialog,   check a feed that you want to block and click   Select. You can read the description of   the feed by clicking the down arrow at the end of the feed row. They are also   described in [Security Intelligence Feed   Categories](#Security_Intelligence_Feeds_for_Firepower_Security_Intelligence_Policies). |
| **Step 8** | If you know there are networks, IP addresses, or URLs that are included in the any of the network groups, network feeds, URL objects, or URL feeds you specified in the previous step, that you want to make an exception for, click the row for the Allowed List. |
| **Step 9** | Select or create objects for the networks, IP addresses, and URLs that you want to make exceptions for. When you click Select or Add they are added to the Allowed List row. |
| **Step 10** | (Optional) To log events generated by the Security Intelligence policy:   1. Click the Logging Settings  icon to configure logging. If you enable logging, any    matches to blocked list entries are logged. Matches to exception entries    are not logged, although you get log messages if exempted connections    match access control rules with logging enabled. 2. Enable event logging by clicking the Connection Events Logging toggle. 3. Choose where to send your events:     * Clicking None saves events to your FDM-managed device. They are visible in the FDM Events viewer. Storage space on the FDM-managed device is very limited. It is best to store your connection events on a syslog server, by defining a syslog server object,      instead of choosing None.    * Clicking Create or Choose allows you to create or choose a syslog server, represented by a syslog server object, to send logging events to. Because      event storage on the device is limited, sending events to an external syslog server can provide more long-term storage and      enhance your event analysis.     If you have a subscription to Cisco Security Analytics and Logging, send events to a Secure Event Connector by [configuring a syslog object with the SEC's IP address and port](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging). See [Cisco Security Analytics and Logging](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_ae75b8a9-0b20-4170-a407-1138e0fa4ea6) for more information about this feature. |
| **Step 11** | (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets.](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets) |
| **Step 12** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Making Exceptions to the Firepower Security Intelligence Policy Blocked Lists

For each blocked list you create in a [Firepower security intelligence policy](#Configure_the_Firepower_Security_Intelligence_Policy), you can create an associated allowed list. The only purpose of the allowed list is to make an exception for IP addresses
or URLs that appear in the blocked list. That is, if you find an address or URL you need to use, and you know to be safe,
is in a feed configured on the blocked list, you can exempt that address or URL by putting in the allowed list. This way,
you don't need to remove an entire feed from the blocked list for the sake of one address or URL.

After passing through the security intelligence policy, allowed traffic is subsequently evaluated by the access control policy.
The ultimate decision on whether the connections are allowed or dropped is based on the access control rule the connections
match. The access rule also determines whether intrusion or malware inspection is applied to the connection.

#### Security Intelligence Feeds for Firepower Security Intelligence Policies

The following table describes the categories available in the Cisco Talos feeds. These categories can be entered in both the
network and URL blocked list.

| Category | Description |
| --- | --- |
| attackers | Active scanners and block-listed hosts known for outbound malicious activity. |
| bogon | Bogon networks and unallocated IP addresses. |
| bots | Sites that host binary malware droppers. |
| CnC | Sites that host command-and-control servers for botnets. |
| dga | Malware algorithms used to generate a large number of domain names acting as rendezvous points with their command-and-control servers. |
| exploitkit | Software kits designed to identify software vulnerabilities in clients. |
| malware | Sites that host malware binaries or exploit kits. |
| open\_proxy | Open proxies that allow anonymous web browsing. |
| open\_relay | Open mail relays that are known to be used for spam. |
| phishing | Sites that host phishing pages. |
| response | IP addresses and URLs that are actively participating in malicious or suspicious activity. |
| spam | Mail hosts that are known for sending spam. |
| suspicious | Files that appear to be suspicious and have characteristics that resemble known malware. |
| tor\_exit\_node | Tor exit nodes. |

### FDM-Managed Device Identity Policy

#### Identity Policy Overview

Use identity policies to collect user identity information from connections. You can then view usage based on user identity
in the dashboards, and configure access control based on user or user group. By linking network behavior, traffic, and events
directly to individual users and groups, the system can help you identify the source of policy breaches, attacks, or network
vulnerabilities.

For example, you can identify who owns the host targeted by an intrusion event, and who initiated an internal attack or port
scan. You can also identify high bandwidth users and users who are accessing undesirable web sites or applications.

You can then view usage based on user identity in the dashboards, and configure access control based on Active Directory (AD)
realm object (which matches all users on that AD), special identities (such as failed authentication, guest, no authentication
required, or unknown identity), or user groups.

You can obtain user identity using the following methods:

* Passive authentication—For all types of connections, obtain user identity from other authentication services without prompting
  for username and password.
* Active authentication—For HTTP connections only, prompt for username and password and authenticate against the specified identity
  source to obtain the user identity for the source IP address.

#### Establishing User Identity Through Passive Authentication

Passive authentication gathers user identity without prompting the user for username and password. The system obtains the
mappings from the identity sources you specify.

You can passively obtain user-to-IP address mappings from the following sources:

* Remote access VPN logins. The following user types are supported for passive identity:

  + User accounts defined in an external authentication server.
  + Local user accounts that are defined in FDM-managed device.
* Cisco Identity Services Engine (ISE); Cisco Identity Services Engine Passive Identity Connector (ISE PIC).

If a given user is identified through more than one source, the remote access VPN login identity takes precedence.

#### Establishing User Identity through Active Authentication

Authentication is the act of confirming the identity of a user.

With active authentication, when an HTTP traffic flow comes from an IP address for which the system has no user-identity mapping,
you can decide whether to authenticate the user who initiated the traffic flow against the directory configured for the system.
If the user successfully authenticates, the IP address is considered to have the identity of the authenticated user.

Failure to authenticate does not prevent network access for the user. Your access rules ultimately decide what access to provide
these users.

#### Dealing with Unknown Users

When you use an FDM-managed device to configure the directory server for the identity policy, FDM-managed downloads user and group membership information from the directory server. The Active Directory information is refreshed
every 24 hours at midnight or whenever you edit and save the directory configuration (even if you do not make any changes).

If a user succeeds in authenticating when prompted by an active authentication identity rule, but the user's name is not in
the downloaded user identity information, the user is marked as Unknown. You will not see the user's ID in identity-related
dashboards, nor will the user match group rules.

However, any access control rules for the Unknown user will apply. For example, if you block connections for Unknown users,
these users are blocked even though they succeeded in authenticating (meaning that the directory server recognizes the user
and the password is valid).

Thus, when you make changes to the directory server, such as adding or deleting users, or changing group membership, these
changes are not reflected in policy enforcement until the system downloads the updates from the directory.

If you do not want to wait until the daily midnight update, you can force an update by editing the directory realm information
(login to an FDM-managed device and navigate Objects > Identity Sources, then edit the realm ). Click OK, then deploy changes. The system will immediately download the updates.

| **Note** | ---   You can check whether new or deleted user information is on the FDM-managed system by logging in to an FDM-managed device and navigating Policies > Access Control, clicking the Add Rule (+) button, and looking at the list of users on the Users tab. If you cannot find a new user, or you can find a deleted user, then the system has old information   --- |
| --- | --- |

* [How to Implement an Identity Policy](#How_to_Implement_a_Firepower_Identity_Policy)
* [Configure Identity Policies](#Configure_Identity_Policies)
* [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings)
* [Configure the Identity Policy Default Action](#Configure_the_Firepower_Identity_Policy_Default_Action)
* [Configure Identity Rules](#Configure_Identity_Rules)

#### How to Implement an Identity Policy

If you want to manage identity policies for your FDM-managed device using Security Cloud Control you need to create identity sources first. You can configure the remaining settings using Security Cloud Control.

When configured correctly, you will be able to see usernames in the monitoring dashboards and events in FDM. You will also
be able to use user identity in access control and SSL decryption rules as a traffic-matching criteria.

| **Note** | ---   At this time, Security Cloud Control can not configure some of the components needed to implement identity policies such as remote access VPN and Cisco Identity Services Engine. These components must be configured in FDM, which is the local manager of the device. Some of the steps in the procedure below indicate that you must use FDM to configure some identity components to implement identity policies.   --- |
| --- | --- |

* [Procedure](#Procedure)

##### Procedure

The following procedure provides an overview of what you must configure to get identity policies to work:

###### Procedure

---

| **Step 1** | Create the AD identity realm. Whether you collect user identity actively or passively, you need to configure the Active Directory (AD) server that has the user identity information. See [Create and Edit a Firepower Threat Defense Active Directory Realm Object](#Create_an_FTD_Active_Directory_Realm_Object) for more information. |
| --- | --- |
| **Step 2** | If you want to use passive authentication identity rules, configure the passive identity sources using FDM.  You can configure any of the following, based on the services you are implementing in the device and the services available to you in your network.   * Remote access VPN—If you intend to support remote access VPN connections to the device, user logins can provide the identity   based on the AD server or on local users (those defined within an FDM-managed device). For information on configuring remote access VPN, see the Configuring Remote Acces VPNs chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor627)  for the version running on your device. * Cisco Identity Services Engine (ISE) or Cisco Identity Services   Engine Passive Identity Connector (ISE PIC)—If you use these   products, you can configure the device as a pxGrid subscriber, and   obtain user identity from ISE. See the Configure Identity Services   Engine chapter of the [Cisco Firepower Threat Defense   Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor627) for   instructions. |
| **Step 3** | Using Security Cloud Control, enable the identity policy and configure passive or active authentication. See [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings) for more information. |
| **Step 4** | Using Security Cloud Control, [Configure Identity Policy Default Action](#Configure_the_Firepower_Identity_Policy_Default_Action). If your intention is to use passive authentication only, you can set the default action to passive authentication and there is no need to create specific rules. |
| **Step 5** | Using Security Cloud Control, [Configuring Identity Rules](#Configure_Identity_Rules). Create rules that will collect passive or active user identities from the relevant networks. |
| **Step 6** | (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets). |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Configure Identity Policies

You can use identity policies to collect user identity information from connections. You can then
view usage based on user identity in the FDM dashboards, and configure
access control based on user or user group.

The following is an overview of how to configure the elements required to obtain user identity through identity policies:

* [Procedure](#Procedure)

##### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you are configuring an identity policy, and click  Policy in the Management pane at the right. |
| **Step 4** | Click Identity in the Policy bar. |
| **Step 5** | If you have not yet enabled an identity policy, read about passive and active authentication and click Enable. You are enabling an identity policy, *not* a passive authentication policy or an active authentication policy. The rules in the policy will specify active or passive authentication. |
| **Step 6** | Manage the identity policy:  After you configure identity settings, this page lists all rules in order. Rules are matched against traffic from top to bottom with the first match determining the action to apply. You can do the following from this page:   * To enable or disable the identity policy, click the identity toggle. See [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings) for more information. * To read the passive authentication settings, click the button next to the Passive Auth label on the identity bar. See [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings) for more information. * To enable active authentication, click the button next to the Active Auth label on the identity bar. See [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings) for more information. * To change the default action, click the default action button and select the desired action. See [Configure Identity Policy Default Action](#Configure_the_Firepower_Identity_Policy_Default_Action). * To move a rule in the table, select the rule and click the up or down arrow at the end of the rule's row in the rule table. * To move a rule in the table, select the rule and click the up or down arrow at the end of the rule's row in the rule table. * To configure rules:    + To create a new rule, click the plus  button.   + To edit an existing rule, select the rule and click Edit in the Actions pane. You can also selectively edit a rule property by clicking on the property in the table.   + To delete a rule you no longer need, select the rule and click Remove in the Actions pane.   For more information on creating and editing identity rules, see [Configuring Identity Rules](#Configure_Identity_Rules). |
| **Step 7** | (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets). |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Configure Identity Policy Settings

For identity policies to work, you must configure the sources that provide user identity information. The settings you must
configure differ based on the type of rules you configure: passive, active, or both.

| **Note** | ---   At this time, Security Cloud Control can not configure some of the components needed to implement identity policies such as active directory identity realms, remote access VPN, and Cisco Identity Services Engine. These components must be configured in FDM, which is the local manager of the device. Some of the steps in the procedure below indicate that you must use FDM to configure some identity components to implement identity policies.   --- |
| --- | --- |

* [Procedure](#Procedure)

##### Procedure

###### Before you begin

Ensure that time settings are consistent among the directory servers, FDM-managed device, and
clients. A time shift among these devices can prevent successful user
authentication. "Consistent" means that you can use different time zones, but the
time should be the same relative to those zones; for example, 10 AM PST = 1 PM
EST.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you are configuring an identity policy, and click  Policy in the Management pane at the right. |
| **Step 4** | Enable Identity policies by clicking the Identity toggle. Or, you can click the  button, review the descriptions of passive and active authentication and click Enable in the dialog. |
| **Step 5** | Read the Passive Authentication settings. Click the Passive Auth button on the identity bar.  The Passive Authentication button shows Enabled if you have configured remote access VPN or Cisco Identity Services engine using Firepower Device Manager.  You must have configured at least one passive identity source to create passive authentication rules. |
| **Step 6** | Configure Active Authentication. When an identity rule requires active authentication for a user, the user is redirected to the captive portal port on the interface through which they are connected and then they are prompted to authenticate.   1. Click the Active Auth button on the Identity bar. 2. If you have not already, enable SSL Description by clicking the Enable link. If you don't see the Enable link, skip to [step "c"](#Procedure__substep_ww3_m35_dpb).     1. From the Select Decrypt Re-Sign Certificate menu, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or click the menu and select Create or Choose to create a new certificate or select one you have already uploaded       to the FDM-managed device.  If you have not already installed the certificate in client browsers, click the download button  to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#Downloading_the_CA_Certificate_for_Decrypt_ReSign_Rules).               | **Note** | You are prompted for SSL Decryption settings only if you have not already configured the SSL decryption policy. To change these settings after enabling the identity policy, edit the SSL decryption policy settings. |       | --- | --- |    2. Click Save. 3. Click the Server Certificate menu to select (choose) the internal certificate to present to users during active authentication. If you have not already    created the required certificate, click Create. Users will have to accept the certificate if you do not upload a certificate that their browsers already trust. 4. In the Port field, enter the port number for the captive portal. The default is 885 (TCP). If you configure a different port, it must    be in the range 1025-65535.         | **Note** | For the HTTP Basic, HTTP Response Page, and NTLM authentication methods, the user is redirected to the captive portal using the IP address of the interface. However, for HTTP Negotiate, the user is redirected using the fully-qualified DNS name firewall-hostname.AD-domain-name . If you want to use HTTP Negotiate, you must also update your DNS server to map this name to the IP addresses of all inside interfaces where you are requiring active authentication. Otherwise, the redirection cannot complete, and users cannot authenticate. |    | --- | --- | 5. Click Save. |
| **Step 7** | Continue with [Configure the Identity Policy Default Action](#Configure_the_Firepower_Identity_Policy_Default_Action). |

---

#### Configure the Identity Policy Default Action

The identity policy has a default action, which is implemented for any connections that do not match any individual identity
rules.

In fact, having no rules is a valid configuration for your policy. If you intend to use passive authentication on all traffic
sources, then simply configure Passive Authentication as your default action.

* [Procedure](#Procedure)

##### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you are configuring an identity policy, and click  Policy in the Management pane at the right. |
| **Step 4** | Click Identity in the Policy bar. |
| **Step 5** | [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings) if you have not done so already. |
| **Step 6** | At the bottom of the screen, click the Default Action button and choose one of the following:   * Passive Auth—User identity will be determined using all configured passive identity sources for connections that do not match any identity   rules. If you do not configure any passive identity sources, using Passive Auth as the default is the same as using No Auth. * No Auth—User identity will not be determined for connections that do not match any identity rules. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Configure Identity Rules

Identity rules determine whether user identity information should be collected for matching traffic. You can configure No
Authentication if you do not want to collect user identity information for matching traffic.

Keep in mind that regardless of your rule configuration, active authentication is performed on HTTP traffic only. Thus, you
do not need to create rules to exclude non-HTTP traffic from active authentication. You can simply apply an active authentication
rule to all sources and destinations if you want to get user identity information for all HTTP traffic.

| **Note** | ---   Also keep in mind that a failure to authentication has no impact on network access. Identity policies collect user identity information only. You must use access rules if you want to prevent users who failed to authenticate from accessing the network.   --- |
| --- | --- |

* [Procedure](#Procedure)

##### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you are configuring an identity policy, and click  Policy in the Management pane at the right. |
| **Step 4** | Click Identity in the policy bar. |
| **Step 5** | Do any of the following:   * To create a new rule, click the plus  button. To understand identity source objects and how they could affect your rules, see [About Identity Sources](#Configure_Identity_Sources_for_FTD) for more information. * To edit an existing rule, click the rule you want to edit and click Edit in the Actions pane at the right. * To delete a rule you no longer need, click the rule you want to delete and click Remove in the Actions pane at the right. |
| **Step 6** | In Order, select where you want to insert the rule in the ordered list of rules.  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 7** | In Name, enter a name for the rule. |
| **Step 8** | Select the Action that the FDM-managed device should apply on a match and if necessary, an Active Directory (AD) Identity Source.  You must select the AD identity realm that includes the user accounts for passive and active authentication rules. choose one of the following:   * Passive Auth—Use passive authentication to determine user identity. All configured identity sources are shown. The rule automatically   uses all configured sources. * Active AuthUse active authentication to determine user identity. Active authentication is applied to HTTP traffic only. If any other   t—ype of traffic matches an identity policy that requires or allows active authentication, then active authentication will   not be attempted. * No Auth—Do not obtain user identity. Identity-based access rules will not be applied to this traffic. These users are marked as No   Authentication Required.  | **Note** | For both Passive Auth and Active Auth, you can opt to select an AD Realm identity source. If you do not have any identity source objects readily prepared, click Create new object to launch the identity source object wizard. See [Create and Edit a Firepower Threat Defense Active Directory Realm Object](#Create_or_Edit_an_FTD_Active_Directory_Realm_Object) for more information. | | --- | --- | |
| **Step 9** | (Active Authentication only.) Click the Active authentication tab and select the authentication method (Type) supported by your directory server:   * HTTP Basic—Authenticate   users using an unencrypted HTTP Basic   Authentication connection. Users log in to the   network using their browser's default   authentication popup window. This is the   default. * NTLM—Authenticate users   using an NT LAN Manager (NTLM) connection. This   selection is only available when you select an AD   realm. Users log in to the network using their   browser's default authentication popup window,   although you can configure Internet Explorer and   Firefox browsers to transparently authenticate   using their Windows domain login. That task is   done in FDM, see *[Cisco Firepower   Threat Defense Configuration Guide for Firepower   Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)* > Security Policies   > Identity Policies > Enabling   Transparent User Authentication for   instructions. * HTTP Negotiate—Allow the   device to negotiate the method between the user   agent (the application the user is using to   initiate the traffic flow) and the Active   Directory server. Negotiation results in the   strongest commonly supported method being used, in   order, NTLM, then basic. Users log in to the   network using their browser's default   authentication popup window. * HTTP Response PagePrompt   users to authenticate using a system-provided web   page. This is a form of HTTP Basic   authentication.  | **Note** | For the HTTP Basic, HTTP Response Page, and NTLM authentication methods, the user is redirected to the captive portal using the IP address of the interface. However, for HTTP Negotiate, the user is redirected using the fully-qualified DNS name *firewall-hostname.AD-domain-name* . If you want to use HTTP Negotiate, you must also update your DNS server to map this name to the IP addresses of all inside interfaces where you are requiring active authentication. Otherwise, the redirection cannot complete, and users cannot authenticate. | | --- | --- | |
| **Step 10** | (Active authentication only.) Select Fall Back as Guest > On/Off to determine whether users who fail active authentication are labeled as Guest users.  Users get 3 chances to successfully authenticate. If they fail, your selection for this option determines how the user is marked. You can deploy access rules based on these values.   * Fall Back as Guest > On—Users are marked as Guest. * Fall Back as Guest > Off—Users are marked as Failed Authentication. |
| **Step 11** | Define the traffic matching criteria on the Source and Destination tabs for Passive authentication, Active authentication, or No Authentication rule actions.  Keep in mind that active authentication will be attempted with HTTP traffic only. Therefore, there is no need to configure No Auth rules for non-HTTP traffic, and there is no point in creating Active Authentication rules for any non-HTTP traffic. However, passive authentication is valid for any type of traffic.  The Source/Destination criteria of an identity rule define the security zones (interfaces) through which the traffic passes, the IP addresses or the country or continent (geographical location) for the IP address, or the protocols and ports used in the traffic. The default is any zone, address, geographical location, protocol, and port.  To modify a condition, you click the  button within that condition, select the desired object or element, and click OK in the popup dialog box. If the criterion requires an object, you can click Create New Object if the object you require does not exist.  To remove an object from a condition, hover over the object and click the X.  You can configure the following traffic matching criteria.  Source Zones, Destination Zones  The security zone objects that define the interfaces through which the traffic passes. You can define one, both, or neither criteria: any criteria not specified applies to traffic on any interface.   * To match traffic leaving the device from an interface in the zone, add that zone to the Destination Zones. * To match traffic entering the device from an interface in the zone, add that zone to the Source Zones. * If you add both source and destination zone conditions to a rule, matching traffic must originate from one of the specified   source zones and egress through one of the destination zones.   Use this criteria when the rule should apply based on where the traffic enters or exits the device. For example, if you want to ensure that user identity is collected from all traffic originating from inside networks, select an inside zone as the Source Zones while leaving the destination zone empty.   | **Note** | You cannot mix passive and routed security zones in a single rule. In addition, you can specify passive security zones as source zones only, you cannot specify them as destination zones. | | --- | --- |   Source Networks, Destination Networks  The network objects or geographical locations that define the network addresses or locations of the traffic.   * To match traffic from an IP address or geographical location, configure the Source Networks. * To match traffic to an IP address or geographical location, configure the Destination Networks. * If you add both source and destination network conditions to a rule, matching traffic must originate from one of the specified   IP addresses and be destined for one of the destination IP addresses.   When you add this criteria, you select from the following tabs:   * Networkâ€”Select the network objects or groups that define the source or destination IP addresses for the traffic you want to control. * Country/Continent-Select the geographical location to control traffic based on its source or destination country or continent. Selecting a   continent selects all countries within the continent. Besides selecting geographical location directly in the rule, you can   also select a geolocation object that you created to define the location. Using geographical location, you could easily restrict   access to a particular country without needing to know all of the potential IP addresses used there. * Custom Geolocationâ€”Select (or create) a geolocation object that has exactly the countries and continents you specify.  | **Note** | To ensure you are using up-to-date geographical location data to filter your traffic, Cisco strongly recommends that you regularly update the geolocation database (GeoDB). See [Update Geolocation Database](#Create_a_Geolocation_Object) for more information. | | --- | --- |   Source Ports, Destination Ports/Protocols  The port objects that define the protocols used in the traffic. For TCP/UDP, this can include ports.   * To match traffic from a protocol or port, configure the Source Ports. Source ports can be TCP/UDP only. * To match traffic to a protocol or port, configure the Destination Ports/Protocols. * To match traffic both originating from specific TCP/UDP ports and destined for specific TCP/UDP ports, configure both. If   you add both source and destination ports to a condition, you can only add ports that share a single transport protocol, TCP   or UDP. For example, you could target traffic from port TCP/80 to port TCP/8080. |
| **Step 12** | Click Save. |
| **Step 13** | Return to the Security Devices page. |
| **Step 14** | Select the device to which you added these rules to the identity policy. |
| **Step 15** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

### SSL Decryption Policy

Some protocols, such as HTTPS, use Secure Sockets Layer (SSL) or its follow-on version, Transport Layer Security (TLS), to
encrypt traffic for secure transmissions. Because the system cannot inspect encrypted connections, you must apply SSL decryption
policy to decrypt them if you want to apply access rules that consider higher-layer traffic characteristics to make access
decisions.

| **Caution** | ---   Keep in mind that decrypting and then re-encrypting traffic adds a processing load on the device, which will reduce overall system performance.   --- |
| --- | --- |

Continue with these topics:

* [About SSL Decryption](#About_SSL_Decryption)
* [How to Implement and Maintain the SSL Decryption Policy](#How_to_Implement_and_Maintain_the_SSL_Decryption_Policy)
* [Configuring SSL Decryption Policies](#Configure_SSL_Decryption_Policies)
* [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_Certificates_for_Known_Key_and_ReSign_Decryption)
* [Downloading the CA Certificate for Decrypt Re-Sign Rules](#Downloading_the_CA_Certificate_for_Decrypt_ReSign_Rules)
* [Troubleshooting SSL Decryption Issues](troubleshooting.html#Troubleshooting_SSL_Decryption_Issues)

* [How to Implement and Maintain the SSL Decryption Policy](#How_to_Implement_and_Maintain_the_SSL_Decryption_Policy)
* [About SSL Decryption](#About_SSL_Decryption)
* [Configure SSL Decryption Policies](#Configure_SSL_Decryption_Policies)
* [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_Certificates_for_Known_Key_and_ReSign_Decryption)
* [Downloading the CA Certificate for Decrypt Re-Sign Rules](#Downloading_the_CA_Certificate_for_Decrypt_ReSign_Rules)

#### How to Implement and Maintain the SSL Decryption Policy

You can use SSL decryption policies to turn encrypted traffic into plain text traffic, so that you can then apply URL filtering,
intrusion and malware control, and other services that require deep packet inspection. If your policies allow the traffic,
the traffic is re-encrypted before it leaves the device.

The SSL decryption policy applies to encrypted traffic only. No unencrypted connections are evaluated against SSL decryption
rules.

Unlike some other security policies, you need to monitor and actively maintain the SSL decryption policy, because certificates
can expire or even be changed on destination servers. Additionally, changes in client software might alter your ability to
decrypt certain connections, because the decrypt re-sign action is indistinguishable from a man-in-the-middle attack.

The following procedure explains the end-to-end process of implementing and maintaining the SSL decryption policy.

* [Procedure](#Procedure)

##### Procedure

###### Procedure

---

| **Step 1** | If you will implement Decrypt Re-sign rules, create the required internal CA certificate.  You must use an internal Certificate Authority (CA) certificate. You have the following options. Because users must trust the certificate, either upload a certificate client browsers are already configured to trust, or ensure that the certificate you upload is added to the browser trust stores.   * Create a self-signed internal CA certificate, which is signed by the device itself. See *[Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)* > Reusable Objects > Certificates > Generating Self-Signed Internal and Internal CA Certificates. * Upload an internal CA certificate and key signed by an external trusted CA or by a CA inside your organization. See *[Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)* > Reusable Objects > Certificates > Uploading Internal and Internal CA Certificates. |
| --- | --- |
| **Step 2** | If you will implement Decrypt Known Key rules, collect the certificate and key from each of the internal servers.  You can use Decrypt Known Key only with servers that you control, because you must obtain the certificate and key from the server. Upload these certificates and keys as internal certificates (not internal CA certificates). See *[Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)* > Reusable Objects > Certificates > Uploading Internal and Internal CA Certificates. |
| **Step 3** | [Enable the SSL Decryption Policy](#Configure_SSL_Decryption_Policies).  When you enable the policy, you also configure some basic settings. |
| **Step 4** | [Configure the Defaullt SSL Decryption Action.](#Configure_the_Default_SSL_Decryption_Action)  If in doubt, select Do Not Decrypt as the default action. Your access control policy can still drop traffic that matches the default SSL decryption rule if appropriate. |
| **Step 5** | [Configure SSL Decryption Rules](#Configure_SSL_Decryption_Rules).  Identify traffic to decrypt and the type of decryption to apply. |
| **Step 6** | If you configure known key decryption, edit the SSL decryption policy settings to include those certificates. See [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_Certificates_for_Known_Key_and_ReSign_Decryption). |
| **Step 7** | If necessary, download the CA certificate used for Decrypt Re-sign rules and upload it to the browser on client workstations.  For information on downloading the certificate and distributing it to clients, see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#Downloading_the_CA_Certificate_for_Decrypt_ReSign_Rules). |
| **Step 8** | Periodically, update re-sign known key certificates.   * Re-sign certificate—Update this certificate before it expires. If you generate the certificate through Firepower Device Manager,   it is valid for 5 years. To determine when a certificate expires, click the view icon for the certificate from the Objects   page. * Known-key certificate—For any known-key decryption rules, you need to ensure that you have uploaded the destination server's   current certificate and key. Whenever the certificate and key changes on supported servers, you must also upload the new certificate   and key (as an internal certificate) and update the SSL decryption settings to use the new certificate. |
| **Step 9** | Upload missing trusted CA certificates for external servers.  The system includes a wide range of trusted CA root and intermediate certificates issued by third parties. These are needed when negotiating the connection between FDM-managed devices and the destination servers for decrypt re-sign rules.  Upload all certificates within a root CA's chain of trust to the list of trusted CA certificates, including the root CA certificate and all intermediate CA certificates. Otherwise, it is more difficult to detect trusted certificates issued by intermediate CAs. Upload certificates on the Objects > Certificates page. See See *[Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)* > Reusable Objects > Certificates > Uploading Trusted CA Certificates. |

---

#### About SSL Decryption

Normally, the access control policy determines if network connections should be allowed or blocked. However, if you enable
the SSL decryption policy, encrypted connections are first sent through the SSL decryption policy to determine if they should
be decrypted or blocked. Any connections that were not blocked, whether or not decrypted, then go through the access control
policy for a final allow/block decision.

| **Note** | ---   You must enable the SSL decryption policy in order to implement active authentication rules in the identity policy. If you enable SSL decryption to enable identity policies, but do not otherwise want to implement SSL decryption, select Do Not Decrypt for the default action in the SSL Decryption page and do not create additional SSL decryption rules. The identity policy automatically generates whatever rules it needs.   --- |
| --- | --- |

The following topics explain encrypted traffic flow management and decryption in more detail.

* [Why Implement SSL Decryption?](#Why_Implement_SSL_Decryption)
* [Automatically Generated SSL Decryption Rules](#Automatically_Generated_SSL_Decryption_Rules)
* [Handling Undecryptable Traffic](#Handling_Undecryptable_Traffic)

* [Why Implement SSL Decryption?](#Why_Implement_SSL_Decryption)
* [Actions You Can Apply to Encrypted Traffic](#Actions_You_Can_Apply_to_Encrypted_Traffic)
* [Automatically Generated SSL Decryption Rules](#Automatically_Generated_SSL_Decryption_Rules)
* [Handling Undecryptable Traffic](#Handling_Undecryptable_Traffic)
* [License Requirements for SSL Decryption Policies](#License_Requirements_for_SSL_Decryption_Policies)
* [Guidelines for SSL Decryption](#Guidelines_for_SSL_Decryption)

##### Why Implement SSL Decryption?

Encrypted traffic, such as HTTPS connections, cannot be inspected. Many connections are legitimately encrypted, such as connections
to banks and other financial institutions. Many web sites use encryption to protect privacy or sensitive data. For example,
your connection to Firepower Device Manager is encrypted. However, users can also hide undesirable traffic within encrypted
connections.

By implementing SSL decryption, you can decrypt connections, inspect them to ensure they do not contain threats or other undesirable
traffic, and then re-encrypt them before allowing the connection to proceed. (The decrypted traffic goes through your access
control policy and matches rules based on inspected characteristics of the decrypted connection, not on the encrypted characteristics.)
This balances your need to apply access control policies with the user's need to protect sensitive information.

You can also configure SSL decryption rules to block encrypted traffic of types you know you do not want on your network.

| **Caution** | ---   Keep in mind that decrypting and then re-encrypting traffic adds a processing load on the device, which will reduce overall system performance.   --- |
| --- | --- |

##### Actions You Can Apply to Encrypted Traffic

When configuring SSL decryption rules, you can apply the actions described in the following topics. These actions are also
available for the default action, which applies to any traffic that does not match an explicit rule.

* [Decrypt Re-Sign](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_yct_vr2_dpb)
* [Decrypt Known Key](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_gbc_xr2_dpb)
* [Do Not Decrypt](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_qy3_xr2_dpb)
* [Block](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_hhp_xr2_dpb)

| **Note** | ---   Any traffic that passes through the SSL decryption policy must then pass through the access control policy. Except for traffic you drop in the SSL decryption policy, the ultimate allow or drop decision rests with the access control policy.   --- |
| --- | --- |

###### Decrypt Re-Sign

If you elect to decrypt and re-sign traffic, the system acts as a man-in-the-middle.

For example, the user types in <https://www.cisco.com> in a browser. The traffic reaches the FDM-managed device, the device then negotiates with the user using the CA certificate specified in the rule and builds an SSL tunnel
between the user and the FDM-managed device. At the same time the device connects to <https://www.cisco.com> and creates an SSL tunnel between the server and the FDM-managed device.

Thus, the user sees the CA certificate configured for the SSL decryption rule instead of the certificate from www.cisco.com.
The user must trust the certificate to complete the connection. The FDM-managed device then performs decryption/re-encryption in both directions for traffic between the user and destination server.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453586.jpg)

| **Note** | ---   If the client does not trust the CA used to re-sign the server certificate, it warns the user that the certificate should not be trusted. To prevent this, import the CA certificate into the client trusted CA store. Alternatively, if your organization has a private PKI, you can issue an intermediate CA certificate signed by the root CA which is automatically trusted by all clients in the organization, then upload that CA certificate to the device.   --- |
| --- | --- |

If you configure a rule with the Decrypt Re-Sign action, the rule matches traffic based on the referenced internal CA certificate's
signature algorithm type, in addition to any configured rule conditions. Because you can select a single re-sign certificate
for the SSL decryption policy, this can limit traffic matching for resign rules.

For example, outgoing traffic encrypted with an elliptic curve (EC) algorithm matches a Decrypt Re-Sign rule only if the re-sign
certificate is an EC-based CA certificate. Similarly, traffic encrypted with an RSA algorithm matches Decrypt Re-Sign rules
only if the global re-sign certificate is RSA; outgoing traffic encrypted with an EC algorithm does not match the rule, even
if all other configured rule conditions match.

###### Decrypt Known Key

If you own the destination server, you can implement decryption with a known key. In this case, when the user opens a connection
to <https://www.cisco.com>, the user sees the actual certificate for www.cisco.com, even though it is the FDM-managed device that is presenting the certificate.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453585.jpg)

Your organization must be the owner of the domain and certificate. For the example of cisco.com the only possible way to have
the end user see Cisco's certificate would be if you actually own the domain cisco.com (i.e. you are Cisco Systems) and have
ownership of the cisco.com certificate signed by a public CA. You can only decrypt with known keys for sites that your organization
owns.

The main purpose of decrypting with a known key is to decrypt traffic heading to your HTTPS server to protect your servers
from external attacks. For inspecting client side traffic to external HTTPS sites, you must use decrypt re-sign as you do
not own the servers.

| **Note** | ---   To use known key decryption, you must upload the server's certificate and key as an internal identity certificate, and then add it to the list of known-key certificates in the SSL decryption policy settings. Then, you can deploy the rule for known-key decryption with the server's address as the destination address. For information on adding the certificate to the SSL decryption policy, see [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_SSL_Decryption_Policies).   --- |
| --- | --- |

###### Do Not Decrypt

If you elect to bypass decryption for certain types of traffic, no processing is done on the traffic. The encrypted traffic
proceeds to the access control policy, where it is allowed or dropped based on the access control rule it matches.

###### Block

You can simply block encrypted traffic that matches an SSL decryption rule. Blocking in the SSL decryption policy prevents
the connection from reaching the access control policy.

When you block an HTTPS connection, the user does not see the system default block response page. Instead, the user sees the
browser's default page for a secure connection failure. The error message does not indicate the site was blocked due to policy.
Instead, errors might indicate that there are no common encryption algorithms. It will not be obvious from this message that
you blocked the connection on purpose.

##### Automatically Generated SSL Decryption Rules

Whether you enable the SSL decryption policy, FDM-managed device automatically generates Decrypt Re-sign rules for each identity policy rule that implements active authentication.
This is required to enable active authentication for HTTPS connections.

When you enable the SSL decryption policy, you see these rules under the Identity Policy Active Authentication Rules heading.
These rules are grouped at the top of the SSL decryption policy. The rules are read only. You can change them only by altering
your identity policy

##### Handling Undecryptable Traffic

There are several characteristics that make a connection undecryptable. If a connection has any of the following characteristics,
the default action is applied to the connection regardless of any rule the connection would otherwise match. If you select
Block as your default action (rather than Do Not Decrypt), you might run into issues, including excessive drops of legitimate
traffic.

* Compressed session—Data compression was applied to the connection.
* SSLv2 session—The minimum supported SSL version is SSLv3.
* Unknown cipher suite—The system does not recognize the cipher suite for the connection.
* Unsupported cipher suite—The system does not support decryption based on the detected cipher suite.
* Session not cached—The SSL session has session reuse enabled, the client and server reestablished the session with the session
  identifier, and the system did not cache that session identifier.
* Handshake errors—An error occurred during the SSL handshake negotiation.
* Decryption errors—An error occurred during the decryption operation.
* Passive interface traffic—All traffic on passive interfaces (passive security zones) is undecryptable.

##### License Requirements for SSL Decryption Policies

You do not need a special license to use the SSL decryption policy.

However, you do need the URL license to create rules that use URL categories and reputations as match criteria. For information
on configuring licenses, see *[Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)*> Licensing the System > Enabling or Disabling Optional Licenses.

##### Guidelines for SSL Decryption

Keep the following in mind when configuring and monitoring SSL decryption policies:

* The SSL Decryption policy is bypassed for any connections that match access control rules set to trust or block if those rules:

  + Use security zone, network, geolocation, and port only as the traffic matching criteria.
  + Come before any other rules that require inspection, such as rules that match connections based on application or URL, or
    allow rules that apply intrusion or file inspection.
* When using URL category matching, note that there are cases where the login page for a site is in a different category than
  the site itself. For example, Gmail is in the "Web based email" category, whereas the login page is in the "Internet Portals"
  category. To get connections to these sites decrypted, you must include both categories in the rule.
* You cannot disable the SSL decryption policy if you have any active authentication rules. To disable the SSL decryption policy,
  you must either disable the identity policy, or delete any identity rules that use active authentication.

#### Configure SSL Decryption Policies

You can use SSL decryption policies to turn encrypted traffic into plain text traffic, so that you can then apply URL filtering,
intrusion and malware control, and other services that require deep packet inspection. If your policies allow the traffic,
the traffic is re-encrypted before it leaves the device.

The SSL decryption policy applies to encrypted traffic only. No unencrypted connections are evaluated against SSL decryption
rules.

| **Caution** | ---   Keep in mind that decrypting and then re-encrypting traffic adds a processing load on the device, which will reduce overall system performance.   --- |
| --- | --- |

| **Note** | ---   VPN tunnels are decrypted before the SSL decryption policy is evaluated, so the policy never applies to the tunnel itself. However, any encrypted connections within the tunnel are subject to evaluation by the SSL decryption policy.   --- |
| --- | --- |

The following procedure explains how to configure the SSL decryption policy. For an explanation of the end-to-end process
of creating and managing SSL decryption, see [How to Implement and Maintain the SSL Decryption Policy](#How_to_Implement_and_Maintain_the_SSL_Decryption_Policy).

* [Procedure](#Procedure)
* [Enable the SSL Decryption Policy](#Enable_the_SSL_Decryption_Policy)
* [Configure the Default SSL Decryption Action](#Configure_the_Default_SSL_Decryption_Action)
* [Configure SSL Decryption Rules](#Configure_SSL_Decryption_Rules)
* [Source/Destination Criteria for SSL Decryption Rules](#SourceDestination_Criteria_for_SSL_Decryption_Rules)
* [URL Criteria for SSL Decryption Rules](#URL_Criteria_for_SSL_Decryption_Rules)
* [User Criteria for SSL Decryption Rules](#User_Criteria_for_SSL_Decryption_Rules)

##### Procedure

###### Before you begin

The SSL decryption rules table contains two sections:

* **Identity Policy Active Authentication Rules**—If you enable the identity policy and create rules that use active authentication, the system automatically creates the SSL
  decryption rules needed to make those policies work. These rules are always evaluated before the SSL decryption rules you
  create yourself. You can alter these rules only indirectly, by making changes to the identity policy.
* **SSL Native Rules**—These are rules that you have configured. You can add rules to this section only.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want to create the SSL policy. |
| **Step 4** | Click Policy in the Management pane at the right. |
| **Step 5** | Click SSL Decryption in the policy bar. |
| **Step 6** | If you have not yet enabled the policy, click Enable SSL Decryption and configure policy settings, as described in [Enable the SSL Decryption Policy](#Enable_the_SSL_Decryption_Policy). |
| **Step 7** | Configure the default action for the policy. The safest choice is Do Not Decrypt. For more information, see Configure the Default SSL Decryption Action section of the Security Policies chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running. |
| **Step 8** | Manage the SSL decryption policy.  After you configure SSL decryption settings, this page lists all rules in order. Rules are matched against traffic from top to bottom with the first match determining the action to apply. You can do the following from this page:   * To disable the policy, click the SSL Decryption Policy toggle. You can re-enable it by clicking Enable SSL Decryption. * To edit policy settings, including the list of certificates used in   the policy, click the configuration button on the SSL toolbar:   . You can also download the certificate used with decrypt re-sign   rules so that you can distribute it to clients. See the following   sections of the Security Policies chapter in the [Cisco Firepower Threat Defense   Configuration Guide for Firepower Device Manager](https://app.smartsheet.com/sheets/xvjRhhJVhP3p9wVFFQ6xxfwrHPp3M2hj46wMG8P1?view=grid) of the   version your device is running:    + Configure Certificates for Known Key and Re-Sign Decryption   + Downloading the CA Certificate for Decrypt Re-Sign Rules * To configure rules:    + To create a new rule and log events it generates, click the blue plus button . See [Configure SSL Decryption Rules](#Configure_SSL_Decryption_Rules).   + To edit an existing rule, click the rule in the rule table and click Edit in the Actions pane. You can also selectively edit a rule property by clicking on the property in the table.   + To delete a rule you no longer need, click the rule in the rule table and click Remove in the Actions pane.   + To move a rule, hover over it in the rule table. At the end of the row use the up and down arrows to move its position with     the rule table.   + (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn     more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets). |
| **Step 9** | Continue to [Enable the SSL Decryption Policy](#Enable_the_SSL_Decryption_Policy). |

---

##### Enable the SSL Decryption Policy

Before you can configure SSL decryption rules, you must enable the policy and configure some basic settings. The following
procedure explains how to enable the policy directly. You can also enable it when you enable identity policies. Identity policies
require that you enable the SSL decryption policy.

* [Procedure](#Procedure)

###### Procedure

###### Before you begin

If you upgraded from a release that did not have SSL decryption policies, but you had configured the identity policy with
active authentication rules, the SSL decryption policy is already enabled. Ensure that you select the Decrypt Re-Sign certificate
you want to use, and optionally enable pre-defined rules.

Review [Configuring SSL Decryption Policies](#Configure_SSL_Decryption_Policies) if you have not already.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and the device for which you want to enable the SSL Decryption policy. |
| **Step 4** | Click Policy in the Management pane at the right. |
| **Step 5** | Click SSL Decryption in the policy bar. |
| **Step 6** | Click the SSL Decryption toggle in the SSL bar to enable the SSL Decryption policy.   * If this is the first time you enabled the policy, read the description of Decrypt Known-Key and Decrypt Re-Sign SSL decryption   and click enable. * If you have already configured the policy once and then disabled it, the policy is simply enabled again with your previous   settings and rules. You can click the SSL decryption configuration button [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_Certificates_for_Known_Key_and_ReSign_Decryption) and configure settings as described in . |
| **Step 7** | For Select Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create to add an FDM-managed device internal CA certificate.  If you have not already installed the certificate in client browsers, click the download button  to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules.](#Downloading_the_CA_Certificate_for_Decrypt_ReSign_Rules) |
| **Step 8** | Click Save. |
| **Step 9** | Continue with [Configure the Default SSL Decryption Action](#Configure_the_Default_SSL_Decryption_Action) to set the default action for the policy. |

---

##### Configure the Default SSL Decryption Action

If an encrypted connection does not match a specific SSL decryption rule, it is handled by the default action for the SSL
decryption policy.

* [Procedure](#Procedure)

###### Procedure

###### Before you begin

If you have not already, review these procedures and follow the procedures in them:

1. [Configuring SSL Decryption Policies](#Configure_SSL_Decryption_Policies)
2. [Enable the SSL Decryption Policy](#Enable_the_SSL_Decryption_Policy)

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you want to configure the default SSL decryption action. |
| **Step 4** | Click Policy in the Management pane at the right. |
| **Step 5** | Click SSL Decryption in the policy bar. |
| **Step 6** | Click the Default Action button. |
| **Step 7** | Select the action to apply to matching traffic:   * Do Not Decrypt—Allow the encrypted connection. The access control policy then evaluates the encrypted connection and drops or allows it   based on access control rules. * Block—Drop the connection immediately. The connection is not passed on to the access control policy. |
| **Step 8** | (Optional.) Configure logging for the default action. You must enable logging to capture events from SSL Decryption policies. Select from these options:   * At End of Connection—Generate an event at the conclusion of the connection.    + Send Connection Events Toâ€”If you want to send a copy of the events to an external syslog server, select the server object     that defines the syslog server. If the required object does not already exist, click Create New Syslog Server and create it.     (To disable logging to a syslog server, select Any from the server list.)  Because event storage on the device is limited, sending events to an external syslog server can provide more long term storage     and enhance your event analysis.  If you have a subscription to Cisco Security Analytics and Logging, [specify or create the syslog server using a Secure Event Connector's IP address and port](cisco-security-analytics-and-logging.html#Send_FTD_Events_to_CDO_Events_Logging). See [Cisco Security Analytics and Logging](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_ae75b8a9-0b20-4170-a407-1138e0fa4ea6) for more information about this feature. * No Logging—Do not generate any events. |
| **Step 9** | Click Save. |
| **Step 10** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### Configure SSL Decryption Rules

Use SSL decryption rules to determine how to handle encrypted connections. Rules in the SSL decryption policy are evaluated
from top to bottom. The rule applied to traffic is the first one where all the traffic criteria are matched.

You can create and edit rules in the SSL Native Rules section only.

| **Caution** | ---   Keep in mind that decrypting and then re-encrypting traffic adds a processing load on the device, which will reduce overall system performance.   --- |
| --- | --- |

| **Note** | ---   Traffic for your VPN connections (both site-to-site and remote access) is decrypted before the SSL decryption policy evaluates connections. Thus, SSL decryption rules are never applied to VPN connections, and you do not need to consider VPN connections when creating these rules. However, any use of encrypted connections within a VPN tunnel are evaluated. For example, an HTTPS connection to an internal server through an RA VPN connection is evaluated by SSL decryption rules, even though the RA VPN tunnel itself is not (because it is decrypted already)   --- |
| --- | --- |

* [Procedure](#Procedure)

###### Procedure

###### Before you begin

If you have not already, review [Configuring SSL Decryption Policies](#Configure_SSL_Decryption_Policies), [Enable the SSL Decryption Policy](#Enable_the_SSL_Decryption_Policy), and [Configure the Default SSL Decryption Action](#Configure_the_Default_SSL_Decryption_Action) to configure the SSL decryption policy your rules will be added to.

If you are creating a decrypt known-key rule, ensure that you upload the certificate and key for the destination server (as
an internal certificate) and also edit the SSL decryption policy settings to use the certificate. Known-key rules typically
specify the destination server in the destination network criteria of the rule. For more information, see [Configure Certificates for Known Key and Re-Sign Decryption](#Configure_Certificates_for_Known_Key_and_ReSign_Decryption).

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you want to enable the SSL Decryption policy. |
| **Step 4** | Click Policy in the Management pane at the right. |
| **Step 5** | Click SSL Decryption in the policy bar. |
| **Step 6** | Do any of the following:   * To create a new rule, click the blue plus  button. * To edit an existing rule, click the edit icon  for the rule. * To delete a rule you no longer need, click the remove icon  for the rule. |
| **Step 7** | In Order, select where you want to insert the rule in the numbered list of rules.  You can insert rules into the SSL Native Rules section only. The Identity Policy Active Authentication Rules are automatically generated from your identity policy and are read-only.  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 8** | In Name, enter a name for the rule.  The name cannot contain spaces. You can use alphanumeric characters and these special characters: + . \_ - |
| **Step 9** | Select the action to apply to matching traffic. For a detailed discussion of each option, see the following:   * [Decrypt Re-Sign](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_yct_vr2_dpb) * [Decrypt Known Key](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_gbc_xr2_dpb) * [Do Not Decrypt](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_qy3_xr2_dpb) * [Block](#Actions_You_Can_Apply_to_Encrypted_Traffic__section_hhp_xr2_dpb) |
| **Step 10** | Define the traffic matching criteria using any combination of the following tabs:   * Source/Destination—The security zones (interfaces) through which the traffic passes, the IP addresses or the country or continent (geographical   location) for the IP address, or the TCP ports used in the traffic. The default is any zone, address, geographical location,   and TCP port. See [Source/Destination Criteria for SSL Decryption Rules](#SourceDestination_Criteria_for_SSL_Decryption_Rules). * URL—The URL category of a web request. The default is that the URL category and reputation are not considered for matching purposes.   See [URL Criteria for SSL Decryption Rules.](#URL_Criteria_for_SSL_Decryption_Rules) * Application—The application, or a filter that defines applications by type, category, tag, risk, or business relevance. The default is   any encrypted application. See [Application Criteria for SSL Decryption Rules](#SourceDestination_Criteria_for_SSL_Decryption_Rules__section_zf5_wgf_dpb) . * Users—The user or user group. Your identity policies determine whether user and group information is available for traffic matching.   You must configure identity policies to use this criteria. See [User Criteria for SSL Decryption Rules](#User_Criteria_for_SSL_Decryption_Rules). * Advanced—The characteristics derived from the certificates used in the connection, such as SSL/TLS version and certificate status.   See [Advanced Criteria for SSL Decryption Rules](#User_Criteria_for_SSL_Decryption_Rules__section_ayf_2hf_dpb).   To modify a condition, you click the blue plus button  within that condition, select the desired object or element, and click Select in the popup dialog box. If the criterion requires an object, you can click Create New Object if the object you require does not exist. Click the x for an object or element to remove it from the policy.  When adding conditions to SSL decryption rules, consider the following tips:   * You can configure multiple conditions per rule. Traffic must match all the conditions in the rule for the rule to apply to   traffic. For example, you can use a single rule to decrypt traffic based on URL category. * For each condition in a rule, you can add up to 50 criteria. Traffic that matches any of a condition's criteria satisfies   the condition. For example, you can use a single rule to apply application control for up to 50 applications or application   filters. Thus, there is an OR relationship among the items in a single condition, but an AND relationship between condition   types (for example, between source/destination and application). * Matching URL category requires the URL license. |
| **Step 11** | (Optional.) Configure logging for the rule.  You must enable logging for traffic that matches the rule to be included in dashboard data or Event Viewer. Select from these options:   * No logging—Do not generate any events. * Send Connection Events To—If you want to send a copy of the events to an external syslog server, select the server object that defines the syslog server.   If the required object does not already exist, click Create and create it. (To disable logging to a syslog server, select Any from the server list.) * At End of Connection—Generate an event at the conclusion of the connection. Because event storage on the device is limited, sending events to   an external syslog server can provide more long term storage and enhance your event analysis.   If you have a subscription to Cisco Security Analytics and Logging, specify or [create a syslog server object](#Create_a_Syslog_Server_Object_for_Cisco_Security_Analytics_and_Logging) using a Secure Event Connector's IP address and port. See [Cisco Security Analytics and Logging](https://docs.defenseorchestrator.com/Configuration_Guides/Cisco_Security_Analytics_and_Logging/0020_Cisco_Security_Analytics_and_Logging_for_FTD_Devices) for more information. |
| **Step 12** | Click Save. |
| **Step 13** | (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets). |
| **Step 14** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### Source/Destination Criteria for SSL Decryption Rules

The Source/Destination criteria of an SSL decryption rule define the security zones (interfaces) through which the traffic
passes, the IP addresses or the country or continent (geographical location) for the IP address, or the TCP ports used in
the traffic. The default is any zone, address, geographical location, and any TCP port. TCP is the only protocol matched to
SSL decryption rules.

To modify a condition, you click the blue button ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453372.jpg) within that condition, select the desired object or element, and click **Select**. If the criterion requires an object, you can click **Create New Object** if the object you require does not exist. Click the **x** for an object or element to remove it from the policy.

Source Zones, Destination Zones

The security zone objects that define the interfaces through which the traffic passes. You can define one, both, or neither
criteria: any criteria not specified applies to traffic on any interface.

* To match traffic leaving the device from an interface in the zone, add that zone to the Destination Zones.
* To match traffic entering the device from an interface in the zone, add that zone to the Source Zones.
* If you add both source and destination zone conditions to a rule, matching traffic must originate from one of the specified
  source zones and egress through one of the destination zones.

Use this criteria when the rule should apply based on where the traffic enters or exits the device. For example, if you want
to ensure that all traffic going from outside hosts to inside hosts gets decrypted, you would select your outside zone as
the Source Zones and your inside zone as the Destination Zones.

Source Networks, Destination Networks

The network objects or geographical locations that define the network addresses or locations of the traffic.

* To match traffic from an IP address or geographical location, configure the Source Networks.
* To match traffic to an IP address or geographical location, configure the Destination Networks.

If you add both source and destination network conditions to a rule, matching traffic must originate from one of the specified
IP addresses and be destined for one of the destination IP addresses.

When you add this criteria, you select from the following menu options:

* **Network**—Select the network objects or groups that define the source or destination IP addresses for the traffic you want to control.

  | **Note** | ---   For Decrypt Known-Key rules, select an object with the IP address of the destination server that uses the certificate and key you uploaded.   --- |
  | --- | --- |
* **Country/Continent**—Select the geographical location to control traffic based on its source or destination country or continent. Selecting a
  continent selects all countries within the continent.
* **Custom** **Geolocation**-You can also select a geolocation object that you created to define the location. Using geographical location, you could
  easily restrict access to a particular country without needing to know all of the potential IP addresses used there.

Source Ports, Destination Ports/Protocols

The port objects that define the protocols used in the traffic. You can specify TCP protocol and ports only for SSL decryption
rules.

* To match traffic from a TCP port, configure the Source Ports.
* To match traffic to a TCP port, configure the Destination Ports/Protocols.

To match traffic both originating from specific TCP ports and destined for specific TCP ports, configure both. For example,
you could target traffic from port TCP/80 to port TCP/8080.

[Return to Step 9. "Define the traffic matching criteria"](#Procedure__step_k2t_yjf_dpb)

###### Application Criteria for SSL Decryption Rules

The Application criteria of an SSL decryption rule defines the application used in an IP connection, or a filter that defines
applications by type, category, tag, risk, or business relevance. The default is any application that has the SSL Protocol
tag. You cannot match SSL decryption rules to any non-encrypted application.

Although you can specify individual applications in the rule, application filters simplify policy creation and administration.
For example, you could create an SSL decryption rule that decrypts or blocks all high risk, low business relevance applications.
If a user attempts to use one of those applications, the session is decrypted or blocked.

In addition, Cisco frequently updates and adds additional application detectors via system and vulnerability database (VDB)
updates. Thus, a rule for high risk applications can automatically apply to new applications without you having to update
the rule manually.

You can specify applications and filters directly in the rule, or create application filter objects that define those characteristics.
The specifications are equivalent, although using objects can make it easier to stay within the 50-items-per-criteria system
limit if you are creating a complex rule.

To modify the application and filters list, you click the ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453372.jpg) button within the condition, select the desired applications or application filter objects, and click Select in the popup
dialog box and then click Save. Click the x for an application, filter, or object to remove it from the policy. Click the
Save As Filter link to save the combined criteria that is not already an object as a new application filter object.

For more information about the application criteria and how to configure advanced filters and select applications, see [Configuring Application Filter Objects](#Create_and_Edit_a_Firepower_Application_Filter_Object).

Consider the following tips when using application criteria in SSL decryption rules:

* The system can identify unencrypted applications that become encrypted using StartTLS. This includes such applications as
  SMTPS, POPS, FTPS, TelnetS, and IMAPS. In addition, it can identify certain encrypted applications based on the Server Name
  Indication in the TLS ClientHello message, or the server certificate subject distinguished name value.
* The system can identify the application only after the server certificate exchange. If traffic exchanged during the SSL handshake
  matches all other conditions in an SSL rule containing an application condition but the identification is not complete, the
  SSL policy allows the packet to pass. This behavior allows the handshake to complete so that applications can be identified.
  After the system completes its identification, the system applies the SSL rule action to the remaining session traffic that
  matches its application condition.

[Return to Step 9. "Define the traffic matching criteria"](#Procedure__step_k2t_yjf_dpb)

##### URL Criteria for SSL Decryption Rules

The URL criteria of an SSL decryption rule defines the category to which the URL in a web request belongs. You can also specify
the relative reputation of sites to decrypt, block, or allow without decryption. The default is to not match connections based
on URL categories.

For example, you could block all encrypted Gaming sites, or decrypt all high risk Social Networking sites. If a user attempts
to browse to any URL with that category and reputation combination, the session is blocked or decrypted.

To add URL criteria to an SSL decryption rule:

###### Procedure

---

| **Step 1** | Click the URL tab to add a URL category to an SSL Decryption rule. |
| --- | --- |
| **Step 2** | Search for and select the URL categories you want to block. |
| **Step 3** | By default, the traffic from URLs in the categories you pick will be decrypted by the SSL decryption rule no matter their security reputation. However, you can fine-tune the URL category or all the URL categories in your rule to exclude some sites from decryption based on reputation.   * To fine-tune the reputation of a single category in the URL:    1. Click the URL category after you selected it.   2. Uncheck Any Reputation.   3. Slide the green slider to the right to choose the URL reputation settings you want to exclude from the rule and click Save.  The reputations that the slider covers are excluded from the effect of the rule. For example, if you slide the green slider      to Benign Sites, Well Known Sites and Benign Sites are excluded from the effects of the SSL Decryption rule for the category      you chose. URLs deemed to be Sights with Security Risks, Suspicious Sites, and High Risk Sites will still be affected by the      rule for that URL category. * To fine-tune the reputation of all the URL categories you added to the rule:    1. After you have selected all the categories you want to include in the SSL Decryption rule, click Apply Reputation to Selected Categories.   2. Uncheck Any Reputation.   3. Slide the green slider to the right to choose the URL reputation settings you want to exclude from the rule and click Save.  The reputations that the slider covers are excluded from the effect of the rule. For example, if you slide the green slider      to Benign Sites, Well Known Sites and Benign Sites are excluded from the effects of the SSL Decryption rule for all the categories      you chose. URLs deemed to be Sights with Security Risks, Suspicious Sites, and High Risk Sites will still be affected by the      rule for all the URL categories. |
| **Step 4** | Click Select. |
| **Step 5** | Click Save.  [Return to Step 9. "Define the traffic matching criteria"](#Procedure__step_k2t_yjf_dpb) |

---

##### User Criteria for SSL Decryption Rules

The User criteria of an SSL decryption rule defines the user or user group for an IP connection. You must configure identity
policies and the associated directory server to include user or user group criteria in a rule.

Your identity policies determine whether user identity is collected for a particular connection. If identity is established,
the IP address of the host is associated with the identified user. Thus, traffic whose source IP address is mapped to a user
is considered to be from that user. IP packets themselves do not include user identity information, so this IP-address-to-user
mapping is the best approximation available.

Because you can add a maximum of 50 users or groups to a rule, selecting groups usually makes more sense than selecting individual
users. For example, you could create a rule that decrypts traffic to the Engineering group that comes from the outside network,
and create a separate rule that does not decrypt outgoing traffic from that group. Then, to make the rule apply to new engineers,
you only need to add the engineer to the Engineering group in the directory server.

To modify the users list, you click the + button within the condition and select the desired user groups and click Select.

[Return to Step 9. "Define the traffic matching criteria"](#Procedure__step_k2t_yjf_dpb)

###### Advanced Criteria for SSL Decryption Rules

The Advanced traffic matching criteria relate to characteristics derived from the certificates used in the connection. You
can configure any or all of the following options.

Certificate Properties

Traffic matches the certificate properties option of the rule if it matches any of the selected properties. You can configure
the following:

* Certificate Status: Whether the certificate is Valid or Invalid. Select Any (the default) if you do not care about certificate status. A certificate
  is considered valid if all of the following conditions are met, otherwise it is invalid:

  + The policy trusts the CA that issued the certificate.
  + The certificate's signature can be properly validated against the certificate's content.
  + The issuer CA certificate is stored in the policy's list of trusted CA certificates.
  + None of the policy's trusted CAs revoked the certificate.
  + The current date is between the certificate Valid From and Valid To dates.
* Self-Signed: Whether the server certificate contains the same subject and issuer distinguished name. Select one of the following:
* Self-Signing—The server certificate is self-signed.

  + CA-Signing—The server certificate is signed by a Certificate Authority. That is, the issuer and subject are not the same.
  + Any—Do not consider whether the certificate is self-signed as a match criteria.

Supported Version

The SSL/TLS version to match. The rule applies to traffic that uses the any of the selected versions only. The default is
all versions. Select from: SSLv3.0, TLSv1.0, TLSv1.1, TLSv1.2.

For example, if you wanted to permit TLSv1.2 connections only, you could create a block rule for the non-TLSv1.2 versions.
Traffic that uses any version not listed, such as SSL v2.0, is handled by the default action for the SSL decryption policy.

[Return to Step 9. "Define the traffic matching criteria"](#Procedure__step_k2t_yjf_dpb)

#### Configure Certificates for Known Key and Re-Sign Decryption

If you implement decryption, either by re-signing or using known keys, you need to identify the certificates that the SSL
decryption rules can use. Ensure that all certificates are valid and unexpired.

Especially for known-key decryption, you need to ensure that the system has the current certificate and key for each destination
server whose connections you are decrypting. With a decrypt known key rule, you use the actual certificate and key from the
destination server for decryption. Thus, you must ensure that the FDM-managed device has the current certificate and key at all times, or decryption will be unsuccessful.

Upload a new internal certificate and key whenever you change the certificate or key on the destination server in a known
key rule. Upload them as an internal certificate (not an internal CA certificate). You can upload the certificate during the
following procedure, or upload the certificate to the Objects  page by clicking the ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453372.jpg) button and selecting FTD > Certificate.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device for which you want to create the SSL policy and click Policy in the Management pane at the right. |
| **Step 4** | Click SSL Decryption in the policy bar. |
| **Step 5** | Click the certificate button  in the SSL decryption policy policy bar. |
| **Step 6** | In the SSL Decryption Configuration dialog, click the Select Decrypt Re-Sign Certificate menu and select or create the internal CA certificate to use for rules that implement decryption with re-signed certificates. You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded.  If you have not already installed the certificate in client browsers, click the download button  to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see the Downloading the CA Certificate for Decrypt Re-Sign Rules section of the Security Policies chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running |
| **Step 7** | For each rule that decrypts using a known key, upload the internal certificate and key for the destination server. |
| **Step 8** | Click  under Decrypt Known-Key Certificates. |
| **Step 9** | Select the internal identity certificate, or click Create New Internal Certificate to upload it now. |
| **Step 10** | Click Save. |
| **Step 11** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Downloading the CA Certificate for Decrypt Re-Sign Rules

If you decide to decrypt traffic, users must have the internal CA certificate that is used in the encryption process defined
as a Trusted Root Certificate Authority in their applications that use TLS/SSL. Typically if you generate a certificate, or
sometimes even if you import one, the certificate is not already defined as trusted in these applications. By default in most
web browsers, when users send HTTPS requests, they will see a warning message from the client application informing them that
there is a problem with the web site's security certificate. Usually, the error message says that the web site's security
certificate was not issued by a trusted certificate authority or the web site was certified by an unknown authority, but the
warning might also suggest there is a possible man-in-the-middle attack in progress. Some other client applications do not
show this warning message to users nor allow users to accept the unrecognized certificate.

You have the following options for providing users with the required certificate:

**Inform users to accept the root certificate**

You can inform the users in your organization what the new policies are at the company and tell them to accept the root certificate
supplied by the organization as a trusted source. Users should accept the certificate and save it in the Trusted Root Certificate
Authority storage area so that they are not prompted again the next time they access the site.

| **Note** | ---   The user needs to accept and trust the CA certificate that created the replacement certificate. If they instead simply trust the replacement server certificate, they will continue to see warnings for each different HTTPS site that they visit.   --- |
| --- | --- |

**Add the root certificate to client devices**

You can add the root certificate to all client devices on the network as a trusted root certificate authority. This way, the
client applications automatically accept transactions with the root certificate.

You can either make the certificate available to users by E-mailing it or placing it on a shared site, or you could incorporate
the certificate into your corporate workstation image and use your application update facilities to distribute it automatically
to users.

The following procedure explains how to download the internal CA certificate and install it on Windows clients.

* [Procedure](#Procedure)
* [Warning](#Warning)

##### Procedure

The process differs depending on the operating system and type of browser. For example, you can use the following process
for Internet Explorer and Chrome running on Windows. (For Firefox, install through the Tools > Options > Advanced page.)

Messages should indicate that the import was successful. You might see an intermediate dialog box warning you that Windows
could not validate the certificate if you generated a self-signed certificate rather than obtaining one from a well-known
third-party Certificate Authority.

You can now close out the Certificate and Internet Options dialog boxes.

###### Procedure

---

| **Step 1** | Download the certificate from Firepower Device Manager.   1. In the left pane, click Security Devices. 2. Click the Devices tab to locate the device or the Templates tab to locate the model device. 3. Click the FTD tab and select the device on which the certificate is stored. 4. Click Policy in the Management pane at the right. 5. Click SSL Decryption in the policy bar. 6. Click the SSL decryption configuration button  in the SSL decryption policy policy bar. 7. Click the Download button 8. Select a download location, optionally change the file name (but not the extension), and click Save. 9. You can now cancel out of the SSL Decryption Settings dialog box. |
| --- | --- |
| **Step 2** | Install the certificate in the Trusted Root Certificate Authority storage area in web browsers on client systems, or make it available for clients to install themselves. This procedure will be different for different browsers and operating systems. |

---

##### Warning

###### CA Certificates Configured Through FDM-Managed Devices

Security Cloud Control can manage multiple devices but is limited the in additional information that is saved when the device configuration is saved,
which may incur some issues when handling internal CA certificates. Security Cloud Control
does not save the cert or key information of CA certificates that are configured through the FDM-managed console; if you attempt to use a CA certificate that was configured in an FDM-managed device and apply it to an SSL policy that is deployed to a secondary device, Security Cloud Control creates a local copy of the CA certificate but does not and cannot copy the key information. As a result, neither Security Cloud Control or the secondary device have the key information and the CA certificate cannot be successfully deployed. This also means
that the download link for the local copy of the CA certificate is unavailable.

We strongly recommend configuring a separate CA certificate for any additional devices through an FDM-managed device, or creating CA certificates through the Security Cloud Control UI.

### Rulesets

#### About Rulesets

A ruleset is a collection of access control rules that can be shared with multiple FDM-managed devices. Any changes made to the rules of a ruleset affect the other managed devices that use this ruleset. An FDM-managed device can have device-specific (local) and shared (rulesets) rules. You can also create rulesets from existing rules in
an FDM-managed device.

| **Important** | ---   The "Rulesets" feature is currently available FDM-managed devices [version 6.5 or later](onboard-devices-and-services.html#Upgrade_a_Single_FTD_Device) and later. Also note that rulesets do not support devices enabled for Snort 3.  The following limitations apply:   * You cannot attach rulesets to Snort 3-enabled devices. * You cannot create a ruleset from an existing device that has Snort 3 installed. * You cannot associate a custom IPS policy with a ruleset.  --- |
| --- | --- |

#### Copy or Move Rules associated with Rulesets

It's possible to copy or move access control rules within a ruleset or across different rulesets. Also, you're allowed to
copy or move rules between local and rulesets. See [Copy FDM Access Control Rules](#Copy_FTD_Access_Control_Rules) and [Move FDM Access Control Rules](#Move_FTD_Access_Control_Rules) for more information.

#### Auto-Detect Existing Rulesets

When you onboard a device, Security Cloud Control auto-detects existing rulesets on them and tries to match them with the rules on the device. On a successful match, Security Cloud Control automatically attaches the rulesets to the newly onboarded device. However, if there are multiple ruleset matches for the
same set of rules on the device, none of them are attached, and you have to assign them manually.

* [Configure Rulesets for a Device](#Configure_Rulesets_for_an_FTD)
* [Rulesets with FDM-Managed Templates](#FTD_Rulesets_with_FTD_Templates)
* [Create Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)
* [Impact of Out-of-Band Changes on Rulesets](#Impact_of_OutofBand_Changes_on_Rulesets)
* [Impact of Discarding Staged Ruleset Changes](#Impact_of_Discarding_Staged_Ruleset_Changes)
* [View Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
* [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
* [Detach FDM-Managed Devices from a Selected Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)
* [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)
* [Remove a Ruleset From a Selected FDM-Managed Device](#Remove_a_Ruleset_From_a_Selected_FTD_device)

#### Configure Rulesets for a Device

Use the sections below to create and deploy a ruleset:

##### Procedure

---

| **Step 1** | [Create a ruleset](#Configure_Rulesets_for_an_FTD).   1. Create a new ruleset and assign rules to it. 2. Assign objects to the rules. 3. Set the priority of the ruleset. 4. Change the order of the rules if required. |
| --- | --- |
| **Step 2** | [Deploy a ruleset to multiple FDM-managed devices](#Configure_Rulesets_for_an_FTD).   1. Attach multiple devices to a ruleset. 2. Review and deploy the ruleset to the devices. |

---

* [Create or Edit a Ruleset](#Create_or_Edit_a_Ruleset)
* [Deploy a Ruleset to Multiple FDM-Managed Devices or Templates](#Deploy_a_Ruleset_toMultiple_FTD_Devices_or_Templates)
* [Add Devices to a Ruleset from the Ruleset page](#Add_Devices_to_a_Rulesetfrom_the_Ruleset_page)
* [Add Rulesets to a Device from the Device Policy page](#Add_Rulesets_to_a_Devicefrom_the_Device_Policy_page)

##### Create or Edit a Ruleset

You can create a ruleset and add new access control rules to it.

Use the following procedure to create a ruleset for multiple FDM-managed devices:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. |
| --- | --- |
| **Step 2** | Click the plus  button to create a new ruleset.   | **Note** | To edit an existing ruleset, select the ruleset and click the edit icon . | | --- | --- | |
| **Step 3** | Enter a name for the ruleset and then click Create. |
| **Step 4** | Create access control rules to add them to the ruleset. See [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy) for instructions.   | **Note** | Access Control rules in the rulesets don't support criteria for Users criteria. | | --- | --- | |
| **Step 5** | In the upper right corner of the window, select the ruleset's priority . The priority can be set when the device is not attached to the ruleset. This selection affects all of the rules included in this ruleset and how it is handled on the devices:   * Top- The ruleset is processed before all other rules on the device. Rules are ordered at the top of the rule list and are processed   first. No other ruleset can precede the rules in this policy. You can only have one top ruleset per device. * Bottom- The ruleset is processed after all other rules on the device. Other than the policy's default action, no other ruleset can   succeed rules in this policy. You can only have one bottom ruleset per device. By default, the priority is set to Bottom.   The Local Rules displays all the device-specific rules of the device.   | **Note** | The priority cannot be changed when a ruleset is attached to a device. You have to detach the device and change the priority. | | --- | --- | |
| **Step 6** | Click Save. You can create as many rules as you want. |
| **Step 7** | (Optional) For any rule that you created, you can select it and add a comment about it in the Add Comments field. To learn more about rule comments see, [Adding Comments to Rules in FTD Policies and Rulesets](#Adding_Comments_to_Rules_in_FTD_Policies_and_Rulesets).   | **Note** | * You can change the order of rules in a ruleset even if you have devices attached to the ruleset. Use the following procedure   to change the priority of the ruleset:    1. In the navigation pane, click Policies > Rulesets and select the ruleset you want to modify.   2. Select a rule that you want to move.   3. Hover the cursor inside the rule row and use the Move Up       or Move Down       arrow to move the rule to the desired order. * Security Cloud Control allows you to [override objects](#Object_Overrides) associated with the rules of a ruleset. When you add a new object to a rule, you can override it only after you attach a   device to the ruleset and save the changes. | | --- | --- | |

---

##### Deploy a Ruleset to Multiple FDM-Managed Devices or Templates

You must attach a ruleset to a device or template for the rules to be enforced. After reviewing the changes, you can deploy
the configuration on the device. When you apply a template to a new FDM-managed device, the ruleset included in the template is pushed to the device.

For more information, see [Rulesets with FDM Templates](#FTD_Rulesets_with_FTD_Templates).

Before you begin, consider the following information:

* You can only attach a ruleset to FDM-managed devices that are already onboarded to Security Cloud Control.
* A device can have only one bottom or top ruleset.
* After you attach or remove a device from a ruleset, the changes are staged in Security Cloud Control but not deployed, and the device becomes Not Synced with Security Cloud Control. Deploy the changes to the device by clicking the ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453403.jpg) icon from the top right corner of the screen.
* After you attach a device, the new rules associated with rulesets don't overwrite existing rules associated with the device.

You can associate rulesets with devices in two ways:

* Add devices to a Ruleset from the Ruleset page.
* Add Rulesets to a device from the Device Policy page.

##### Add Devices to a Ruleset from the Ruleset page

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. |
| --- | --- |
| **Step 2** | Select the ruleset you want to assign to FDM-managed devices and in the Actions pane, click Edit. |
| **Step 3** | On the top right corner, click the Device button  appearing beside Ruleset for. |
| **Step 4** | Select from the list of eligible FDM-managed devices. |
| **Step 5** | In the gear icon, select one of the following actions for the system to perform when it determines duplicate names between the rules in the ruleset and the device-specific rules:   * Fail on conflicting rules (default option): Security Cloud Control doesn't add the ruleset to the device. You need to manually rename the duplicate rules and then add the ruleset. * Rename conflicting rules: Security Cloud Control renames the conflicting rules present on the device (Local Rules). |
| **Step 6** | Click Save. The Attached Ruleset to Devices wizard is closed. |
| **Step 7** | Click Save in the upper right corner to save the changes made to the ruleset. Saving the ruleset stages the changes to Security Cloud Control.   | **Note** | Each time you modify a ruleset, you must click Save. By doing this operation, all changes are staged to Security Cloud Control. You have to deploy the changes manually. | | --- | --- | |
| **Step 8** | Click Confirm. Saving the ruleset stages the changes to Security Cloud Control. |
| **Step 9** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made, or wait and deploy multiple changes at once. If you [discard](#Discard_Changes) the staged ruleset changes on a device, see [Impact of Discarding Staged Ruleset Changes](#Impact_of_Discarding_Staged_Ruleset_Changes) for information. |

---

##### Add Rulesets to a Device from the Device Policy page

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device you want from the list. |
| **Step 4** | In the Management pane on the right, click Policy. |
| **Step 5** | Click the  button appearing in the upper right corner of the window. |
| **Step 6** | Select the rulesets that you want. |
| **Step 7** | In the gear icon, select one of the following actions for the system to perform when it determines duplicate names between the rules in the ruleset and the device-specific rules:   * Fail on conflicting rules (default option): Security Cloud Control doesn't add the ruleset to the device. You need to manually rename the duplicate rules and then add the ruleset. * Rename conflicting rules: Security Cloud Control renames the conflicting rules present on the device (Local Rules).  | **Note** | If there are no conflicting rules on the selected device, Security Cloud Control attaches the ruleset to the device without any changes. | | --- | --- | |
| **Step 8** | Click Attach Ruleset. The ruleset gets added to the device based on the priority of the ruleset. |
| **Step 9** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made, or wait and deploy multiple changes at once. If you [discard](#Discard_Changes) the staged ruleset changes on a device, see [Impact of Discarding Staged Ruleset Changes](#Impact_of_Discarding_Staged_Ruleset_Changes) for information. |

---

**Related Information:**

* [About Rulesets](#FTD_Rulesets)
* [FTD Rulesets with FDM Templates](#FTD_Rulesets_with_FTD_Templates)
* [Detach FDM-Managed Devices from a Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)
* [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)
* [Impact of Out-of-Band Changes on Rulesets](#Impact_of_OutofBand_Changes_on_Rulesets)
* [View FTD Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
* [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
* [Creating Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)

#### Rulesets with FDM-Managed Templates

Security Cloud Control allows you to assign the rulesets to FDM-managed templates.

* When you create a template from an FDM-managed device with rulesets, Security Cloud Control adds the template automatically to the rulesets that were present on the source device. You can manage the template from
  rulesets.
* When you apply a template with rulesets to a target FDM-managed device, Security Cloud Control adds the target device automatically to the rulesets, thereby manage the target device from rulesets.
* When a template with rulesets is applied to a target FDM-managed device which already has different rulesets, Security Cloud Control removes the existing rulesets from the target device and adds new rulesets associated with the template.

See [Deploy a Ruleset to Multiple FDM-Managed Devices or Templates](#Deploy_a_Ruleset_toMultiple_FTD_Devices_or_Templates) for more information.

**Related Information:**

* [About Rulesets](#FTD_Rulesets)
* [Configure Rulesets for an FTD](#Configure_Rulesets_for_an_FTD)
* [Creating Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)
* [Impact of Out-of-Band Changes on Rulesets](#Impact_of_OutofBand_Changes_on_Rulesets)
* [View FTD Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
* [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
* [Detach FDM-Managed Devices from a Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)
* [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)

#### Create Rulesets from Existing Device Rules

You're allowed to create rulesets by selecting existing rules in the FDM-managed device.

Use the following procedure to create a ruleset from existing device rules:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device that you want from the list. |
| **Step 4** | In the Management pane on the right, click Policy. The existing rules of the device appear. |
| **Step 5** | Perform the following based on your requirement:   1. To create Top rules, select consecutive rules starting from the first rule at the top. 2. To create Bottom rules, select consecutive rules that include the last rule at the bottom. |
| **Step 6** | In the Actions pane on the right, click Create Ruleset.   | **Note** | Your selection must include the first or last rule for the Create Ruleset link to be clickable. | | --- | --- | |
| **Step 7** | Specify a name in the Ruleset Name field and click Create. The corresponding ruleset is created in the device.  You can continue creating ruleset using the remaining rules in the device. |

---

#### Impact of Out-of-Band Changes on Rulesets

When you add new rules or make changes to the existing rules using the FDM-managed device, and you have enabled conflict detection in Security Cloud Control for your FDM-managed device, Security Cloud Control detects the out-of-band change and the device's configuration status shows Conflict Detected. [You can resolve this conflict by accepting or rejecting the changes](#Resolve_Configuration_Conflicts).

If you accept the device changes, Security Cloud Control overwrites the last know configuration with the new changes made on the device. The following changes take place:

* Rulesets that are impacted by the changes lose their relationship with devices.
* Rules associated with these rulesets are converted to local rules.

If you reject the device changes, Security Cloud Control rejects the new changes and replaces configuration on the device with the last synced configuration in Security Cloud Control.

**Related Information:**

* [About Rulesets](#FTD_Rulesets)
* [Configure Rulesets for an FTD](#Configure_Rulesets_for_an_FTD)
* [Creating Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)
* [Impact of Discarding Staged Ruleset ChangesEdit](#Impact_of_Discarding_Staged_Ruleset_Changes)
* [View FTD Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
* [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
* [Detach FDM-Managed Devices from a Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)
* [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)

#### Impact of Discarding Staged Ruleset Changes

When you add new rules to a ruleset or make changes to the existing rules associated with the ruleset using Security Cloud Control, it saves the changes you make to its own copy of the configuration file. Those changes are considered "pending" on Security Cloud Control until they are "deployed" to the device.

If you [discard](#Discard_Changes) the pending ruleset changes on the device, Security Cloud Control
**completely overwrites** its local copy of a device's configuration with the configuration stored on the device.

The following changes occur on the rulesets and the associated devices:

* Rulesets that are impacted by the changes lose their relationship with devices.
* Rules associated with these rulesets are converted to local rules.
* Security Cloud Control discards the new staged changes and retains the configuration present on the device.

**Related Information:**

* [About Rulesets](#FTD_Rulesets)
* [Configure Rulesets for an FTD](#Configure_Rulesets_for_an_FTD)
* [Creating Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)
* [Impact of Out-of-Band Changes on Rulesets](#Impact_of_OutofBand_Changes_on_Rulesets)
* [View FTD Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
* [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
* [Detach FDM-Managed Devices from a Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)
* [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)

#### View Rules and Rulesets

* [View Rules from Device Policy Page](#View_Rules_from_DevicePolicy_Page)
* [View Rulesets](#View_Rulesets)
* [Search Rulesets](#SearchRulesets)
* [View Jobs Associated with Rulesets](#View_Jobs_Associated_with_Rulesets)

##### View Rules from Device Policy Page

The FDM-managed device policy page shows individual (local) and shared rules (associated with rulesets).

Use the following procedure to view the FDM-managed device ruleset from the policy page:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device that you want. |
| **Step 4** | In the Management pane on the right, click Policy. You see the following rules based on the configuration you have made:   * Top Rules: Shows the mandatory shared rules which will be processed before all other rules on the device. * Local Rules: Shows device-specific rules which will be processed after mandatory rules on the device. * Bottom: Shows the default shared rules which will be processed after all other rules on the device.  | **Note** | You can edit the ruleset by going to the corresponding ruleset page. | | --- | --- |  1. On the top right corner of the ruleset header, click Go to ruleset     . 2. Make the required changes to the rules and click Save. The new changes are updated on all devices associated with the ruleset. |

---

##### View Rulesets

The Rulesets page shows all rulesets available in your tenant. It also provides information about devices associated with the rulesets.

Use the following procedure to view all rulesets from the Rulesets page:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click a ruleset to view its details. The Devices column shows the number of FDM-managed devices attached to each ruleset. |
| **Step 3** | In the Management pane, click Workflows. This page shows all the actions that you performed on the device. You can click Diagram to view a pictorial representation of the workflow. |

---

##### Search Rulesets

You can use the Filter by Device filter to select the devices for viewing the rulesets assigned to them.

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click the filter icon and click Filter by Device. |
| **Step 3** | Select one or more devices from the list and click OK.  You can see the rulesets based on the devices you have selected. |

---

##### View Jobs Associated with Rulesets

The Jobs page records actions when you apply ruleset to FDM-managed devices or remove them from FDM-managed devices. It also determines if the action was successful or failed.

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click a ruleset to view its details. |
| **Step 3** | In the Management pane, click Jobs. This page shows actions that you performed on the ruleset. |

---

#### Change Log Entries after Creating Rulesets

When Security Cloud Control detects a change on the ruleset, it creates a change log entry for every action performed on the ruleset.

Clicking the blue [Diff](monitoring-and-reporting.html#Viewing_ASA_Change_Log_Diffs) link in the change log entry row displays a side-by-side comparison of the changes in the context of the running configuration
file.

In the following example, the change log shows entries for a new ruleset with three rules added to the ruleset. It also shows
information about setting the ruleset's priority and the FDM-managed device attached to the ruleset.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457543.jpg)

| Number in Illustration | Explanation |
| --- | --- |
| 1 | The new ruleset "Ruleset\_3" is created at 11:03:18 A.M on Feb 25, 2020. |
| 2 | The new access rules "new\_rule\_1", "new\_rule\_3", and "new\_rule\_3" are created in the ruleset. |
| 3 | The ruleset's priority is set to "Mandatory". |
| 4 | The ruleset is attached to the "BGL\_FTD" device. |
| 5 | The ruleset changes are saved. |

#### Detach FDM-Managed Devices from a Selected Ruleset

Use the following procedure to detach devices from a ruleset:

##### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Select the ruleset you want to edit and click the Edit link in the Actions pane. |
| **Step 3** | On the top right corner, click the Device button appearing beside Ruleset for. |
| **Step 4** | Uncheck the devices that are currently attached to the ruleset, or click Clear to remove all devices at once. |
| **Step 5** | Click Save. |
| **Step 6** | Click Save in the upper right window to save the ruleset. Saving the policy stages the changes to Security Cloud Control. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made, or wait and deploy multiple changes at once. |

---

**Related Information:**

* [About Rulesets](#FTD_Rulesets)
* [Configure Rulesets for an FTD](#Configure_Rulesets_for_an_FTD)
* [Creating Rulesets from Existing Device Rules](#Create_Rulesets_from_Existing_Device_Rules)
* [Impact of Out-of-Band Changes on Rulesets](#Impact_of_OutofBand_Changes_on_Rulesets)
* [View FTD Rules and Rulesets](#View_FTD_Rules_and_Rulesets)
* [Change Log Entries after Creating Rulesets](#Change_Log_Entries_after_Creating_Rulesets)
* [Delete Rules and Rulesets](#Delete_Rules_and_Rulesets)

#### Delete Rules and Rulesets

* [Delete Rules from a Ruleset](#Delete_Rules_from_a_Ruleset)
* [Delete a Ruleset](#Delete_aRuleset)

##### Delete Rules from a Ruleset

You can delete a rule that you no longer need in the ruleset.

Use the following procedure to delete rules:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click Edit in the Actions pane. |
| **Step 3** | Select a rule that you want to delete and then click Remove under Actions. |
| **Step 4** | Click OK to confirm the deletion. |
| **Step 5** | Click Save in the upper right corner to save the changes made to the ruleset. Saving the ruleset stages the changes to Security Cloud Control. |
| **Step 6** | [Preview and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) your changes now or wait and deploy multiple changes at one time. |

---

##### Delete a Ruleset

You can delete a ruleset only after detaching all devices associated with it. See [Detach FDM-Managed Devices from a Ruleset](#Delete_Rules_and_Rulesets).

Use the following procedure to delete a ruleset:

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click Remove inside the ruleset row. |
| **Step 3** | Click Confirm to delete the ruleset permanently. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) your changes now or wait and deploy multiple changes at one time. |

---

* [About Rulesets](#FTD_Rulesets)
* [Configure Rulesets for an FTD](#Configure_Rulesets_for_an_FTD)
* [Detach FDM-Managed Devices from a Ruleset](#Detach_FTD_Devices_from_a_Selected_Ruleset)

#### Remove a Ruleset From a Selected FDM-Managed Device

There are two ways of removing a ruleset from a selected FDM-managed device, but their behaviors are
slightly different.

* [Delete a Ruleset from a Selected FDM-Managed Device](#Delete_a_Ruleset_From_a_Selected_FTD_Device): This feature deletes a Ruleset and its associated shared rules from a selected FDM-managed device.
* [Disassociate a Ruleset from a Selected FDM-Managed Device](#Disassociate_a_Ruleset_From_a_Selected_FTD_Device): This feature doesn't remove the shared rules. Instead, it converts the shared rules to local rules.

* [Delete a Ruleset From a Selected FDM-Managed Device](#Delete_a_Ruleset_From_a_Selected_FTD_Device)
* [Disassociate a Ruleset From a Selected FDM-Managed Device](#Disassociate_a_Ruleset_From_a_Selected_FTD_Device)

##### Delete a Ruleset From a Selected FDM-Managed Device

You can delete a ruleset and its associated shared rules from a selected FDM-managed device. The ruleset can also be [detached from an FDM-managed device](#Detach_FTD_Devices_from_a_Selected_Ruleset) from the ruleset page.

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device that you want from the list. |
| **Step 4** | Click the delete icon appearing on the top right corner of a ruleset. |
| **Step 5** | Click Confirm. |
| **Step 6** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made, or wait and deploy multiple changes at once. |

---

##### Disassociate a Ruleset From a Selected FDM-Managed Device

If you want to add a new device-specific rule to a ruleset in an FDM-managed device, you need to dissociate that ruleset from the FDM-managed device, which converts its associated shared rules to local rules. Then, you can add the rules that you want to local rules.

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. The rules available in your tenant are displayed. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the FTD tab and select the device that you want from the list. |
| **Step 4** | In the Management pane on the right, click Policy. |
| **Step 5** | Click the  icon appearing on the top right corner of a ruleset. |
| **Step 6** | Click Confirm. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made, or wait and deploy multiple changes at once. |

---

### Adding Comments to Rules in Policies and Rulesets

You can add comments to rules in FDM-managed device policies and rules in rulesets to document some characteristic of a rule. Rule comments are are only visible on Security Cloud Control; they are never written to the FDM-managed device nor are they visible in FDM.

Comments are added to rules after they are created and saved in Security Cloud Control. As rule comments are only a feature of Security Cloud Control, creating, changing, or deleting a rule comment does not change the configuration status of the device in Security Cloud Control to "Not Synced". You will not need to write changes from Security Cloud Control to the FDM-managed device to save a rule comment.

Comments associated with rules in an FDM-managed device policy can be viewed and edited on the device's policy page. Comments associated with rules in an FDM-managed device ruleset can be viewed and edited on the rulesets page. When a ruleset is used in a policy, any comments associated
with any of the rules in the ruleset are displayed in the comments area of the policy. The comments are read-only.

When you search for a string in policies, rulesets, or the change log, Security Cloud Control will search the comments associated with a rule for that string along with the other attributes and values of a rule.

When a comment for a rule is added or edited, that action is recorded in the Change log. Because rule comments are only recorded
and maintained in Security Cloud Control, they are labeled (Security Cloud Control-only change) in the change log.

| **Caution** | ---   If there is an out of band change to an FDM-managed device's configuration and Security Cloud Control reads that configuration into its database, the comments associated with any rules will be wiped out.   --- |
| --- | --- |

* [Adding a Comment to a Rule](#Adding_a_Comment_to_a_Rule)
* [Editing Comments about Rules in Policies and Rulesets](#Editing_Comments_about_Rules_in_FTD_Policies_and_Rulesets)

#### Adding a Comment to a Rule

##### Procedure

---

| **Step 1** | Open the policy or ruleset that contains the rule you want to comment on. |
| --- | --- |
| **Step 2** | Select the rule. |
| **Step 3** | Click Add Comment in the Add Comment area for the rule. |
| **Step 4** | Add a comment in the text box. |
| **Step 5** | Click Save. |

---

#### Editing Comments about Rules in Policies and Rulesets

* [Editing a comment on a rule in a policy](#Editing_a_comment_on_a_rule_in_a_policy)
* [Editing a comment on a rule in a ruleset](#Editing_a_comment_on_a_rule_in_a_ruleset)

##### Editing a comment on a rule in a policy

Use this procedure to edit a comment on a rule in an FDM-managed device policy.

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. |
| --- | --- |
| **Step 2** | Select the FDM-managed device policy with the Local Rule you are going to add a comment to. You are not able to add a comment to a rule in a ruleset within a policy. |
| **Step 3** | In the Comment pane, click the edit icon . |
| **Step 4** | Edit the comment and click save. You will see the comment change reflected in the Comment area immediately. |

---

##### Editing a comment on a rule in a ruleset

In order to see a change to a comment on a rule in a ruleset, reflected on the policy page, you have to make changes to the
comment and the rule in a specific order.

###### Procedure

---

| **Step 1** | In the left pane, click Policies > FDM > Rulesets. |
| --- | --- |
| **Step 2** | Select the ruleset with the rule you want to add a comment to. |
| **Step 3** | In the Actions pane, click Edit. |
| **Step 4** | Select the rule. |
| **Step 5** | In the Comment pane, click the edit icon . |
| **Step 6** | Edit the comment and click save. You will see the comment change reflected in the Comment area of the ruleset page immediately. |
| **Step 7** | Select the rule you are going to change and in the Actions pane, click Edit. |
| **Step 8** | Edit the rule and click the blue check button to save the change. |
| **Step 9** | At the top of the ruleset page, click Save to save the ruleset. The new comment for the rule in the ruleset will now be reflected on a policy page. |
| **Step 10** | To see the comment change in a policy page:   1. From the Security Cloud Control menu bar, select Policies > FTD/Meraki/AWS Policies. 2. Select an FDM-managed device policy that contains the ruleset you just edited. 3. Select the rule with the comment you just edited. You should see your new comment in the Comment pane. |

---

### Network Address Translation

Each computer and device within an IP network is assigned a unique IP address that identifies the host. Because of a shortage
of public IPv4 addresses, most of these IP addresses are private and not routable anywhere outside of the private company
network. RFC 1918 defines the private IP addresses you can use internally that should not be advertised:

* 10.0.0.0 through 10.255.255.255
* 172.16.0.0 through 172.31.255.255
* 192.168.0.0 through 192.168.255.255

One of the main functions of Network Address Translation (NAT) is to enable private IP networks to connect to the Internet.
NAT replaces a private IP address with a public IP address, translating the private addresses in the internal private network
into legal, routable addresses that can be used on the public Internet. In this way, NAT conserves public addresses because
it can be configured to advertise at a minimum only one public address for the entire network to the outside world.

Other functions of NAT include:

* Security-Keeping internal IP addresses hidden discourages direct attacks.
* IP routing solutions-Overlapping IP addresses are not a problem when you use NAT.
* Flexibility-You can change internal IP addressing schemes without affecting the public addresses available externally; for
  example, for a server accessible to the Internet, you can maintain a fixed IP address for Internet use, but internally, you
  can change the server address.
* Translating between IPv4 and IPv6 (Routed mode only)-If you want to connect an IPv6 network to an IPv4 network, NAT lets you
  translate between the two types of addresses.

You can use Security Cloud Control to create NAT rules for many different use cases. Use the NAT rule wizard or these topics to create different NAT rules:

### Order of Processing NAT Rules

Network Object NAT and twice NAT rules are stored in a single table that is divided into three sections. Section 1 rules are
applied first, then section 2, and finally section 3, until a match is found. For example, if a match is found in section
1, sections 2 and 3 are not evaluated. The following table shows the order of rules within each section.

Table 5. NAT Rule Table

| Table Section | Rule Type | Order of Rules within the Section |
| --- | --- | --- |
| Section 1 | Twice NAT (ASA)  Manual NAT (FTD) | Applied on a first match basis, in the order they appear in the configuration. Because the first match is applied, you must ensure that specific rules come before more general rules, or the specific rules might not be applied as desired. By default, twice NAT rules are added to section 1. |
| Section 2 | Network Object NAT (ASA)  Auto NAT (FTD) | If a match in section 1 is not found, section 2 rules are applied in the following order:   1. Static rules. 2. Dynamic rules.   Within each rule type, the following ordering guidelines are used:   1. Quantity of real IP addressesâ€”From smallest to largest. For example, an object with one address will be assessed before    an object with 10 addresses. 2. For quantities that are the same, then the IP address number is used, from lowest to highest. For example, 10.1.1.0 is assessed    before 11.1.1.0. 3. If the same IP address is used, then the name of the network object is used, in alphabetical order. For example, object "Arlington"    is assessed before object "Detroit." |
| Section 3 | Twice NAT (ASA)  Manual NAT (FTD) | If a match is still not found, section 3 rules are applied on a first match basis, in the order they appear in the configuration. This section should contain your most general rules. You must also ensure that any specific rules in this section come before general rules that would otherwise apply. |

For section 2 rules, for example, you have the following IP addresses defined within network objects:

* 192.168.1.0/24 (static)
* 192.168.1.0/24 (dynamic)
* 10.1.1.0/24 (static)
* 192.168.1.1/32 (static)
* 172.16.1.0/24 (dynamic) (object Detroit)
* 172.16.1.0/24 (dynamic) (object Arlington)

The resultant ordering would be:

* 192.168.1.1/32 (static)
* 10.1.1.0/24 (static)
* 192.168.1.0/24 (static)
* 172.16.1.0/24 (dynamic) (object Arlington)
* 172.16.1.0/24 (dynamic) (object Detroit)
* 192.168.1.0/24 (dynamic)

### Network Address Translation Wizard

The Network Address Translation (NAT) wizard helps you create NAT rules on your devices for these types of access:

* **Enable Internet Access for Internal Users**. You may use this NAT rule to allow users on an internal network to reach the internet.
* **Expose an Internal Server to the Internet**. You may use this NAT rule to allow people outside your network to reach an internal web or email server.

#### Prerequisites to "Enable Internet Access for Internal Users"

Before you create your NAT rule, gather this information:

* The interface that is closest to your users; this is usually called the "inside" interface.
* The interface closest to your Internet connection; this is usually called the "outside" interface.
* If you want to allow only specific users to reach the internet, you need the subnet addresses for those users.

#### Prerequisites to "Expose an Internal Server to the Internet"

Before you create your NAT rule, gather this information:

* The interface that is closest to your users; this is usually called the "inside" interface.
* The interface closest to your Internet connection; this is usually called the "outside" interface.
* The IP address of the server inside your network that you would like to translate to an internet-facing IP address.
* The public IP address you want the server to use.

#### What to do Next

See [Create a NAT Rule by using the NAT Wizard](#Createa_NAT_Rule_by_using_the_NAT_Wizard).

* [Create a NAT Rule by using the NAT Wizard](#Createa_NAT_Rule_by_using_the_NAT_Wizard)

#### Create a NAT Rule by using the NAT Wizard

##### Before you begin

See [Network Address Translation Wizard](#Network_Address_Translation_Wizard) for the prerequisites needed to create NAT rules
using the NAT wizard.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Use the [filter](#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) and [search](basics-of-cisco-defense-orchestrator.html#To_use_search) fields to find the device for which you want to create the NAT rule. |
| **Step 5** | In the Management area of the details panel, click NAT . |
| **Step 6** | Click  > NAT Wizard. |
| **Step 7** | Respond to the NAT Wizard questions and follow the on-screen instructions.   * The NAT Wizard creates rules with [Network Objects](#About_Network_Objects). Either select an existing object from the drop-down menu, or create a new object with the create button . * Before you can save the NAT rule, all IP addresses need to be defined as network objects. |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

### Common Use Cases for NAT

#### Twice NAT and Manual NAT

Here are some common tasks that can be achieved using "Network Object NAT", also known as "Auto NAT":

* [Enable a Server on the Inside Network to Reach the Internet Using a Public IP address](#Create_NAT_Rule)
* [Enable Users on the Inside Network to Access the Internet Using the Outside Interface's Public IP Address](#Create_NAT_Rule)
* [Make a Server on the Inside Network Available on a Specific Port of a Public IP Address](#Make_a_Server_on_the_Inside_Network_Available_on_a_Specific_Port_of_a_Public_IP_Address)
* [Translate a Range of Private IP Addresses to a Range of Public IP Addresses](#Translate_a_Range_of_Private_IP_Addresses_to_a_Range_of_Public_IP_Addresses)

#### Network Object NAT and Auto NAT

Here is a common task that can be achieved using "Twice NAT", also know as "Manual NAT":

* [Prevent a Range of IP Addresses from Being Translated When Traversing the Outside Interface](#Prevent_a_Range_of_IP_Addresses_from_Being_Translated_When_Traversing_the_Outside_Interface)

* [Enable a Server on the Inside Network to Reach the Internet Using a Public IP address](#Create_NAT_Rule)
* [Enable Users on the Inside Network to Access the Internet Using the Outside Interface's Public IP Address](#Create_NAT_Rule)
* [Make a Server on the Inside Network Available on a Specific Port of a Public IP Address](#Make_a_Server_on_the_Inside_Network_Available_on_a_Specific_Port_of_a_Public_IP_Address)
* [Translate a Range of Private IP Addresses to a Range of Public IP Addresses](#Translate_a_Range_of_Private_IP_Addresses_to_a_Range_of_Public_IP_Addresses)
* [Prevent a Range of IP Addresses from Being Translated When Traversing the Outside Interface](#Prevent_a_Range_of_IP_Addresses_from_Being_Translated_When_Traversing_the_Outside_Interface)

#### Enable a Server on the Inside Network to Reach the Internet Using a Public IP address

**Use Case**

Use this NAT strategy when you have a server with a private IP address that needs to be accessed from the internet and you
have enough public IP addresses to NAT one public IP address to the private IP address. If you have a limited number of public
IP addresses, see [Make a server on the inside network available to users on a specific port of a public IP address](#Make_a_Server_on_the_Inside_Network_Available_on_a_Specific_Port_of_a_Public_IP_Address) (that solution may be more suitable).

**Strategy**

Your server has a static, private IP address, and users outside your network have to be able to reach your server. Create
a network object NAT rule that translates the static private IP address to a static public IP address. After that, create
an access policy that allows traffic from that public IP address to reach the private IP address. Finally, deploy these changes
to your device.

##### Before you begin

Before you begin, create two network objects. Name one object *servername*\_inside and the other object *servername*\_outside. The *servername*\_inside network object should contain the private IP address of your server. The *servername*\_outside network object should contain the public IP address of your server. See [Create Network Objects](#About_Network_Objects) for instructions.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  > Network Object NAT. |
| **Step 7** | In section 1, Type, select Static. Click Continue. |
| **Step 8** | In section 2, Interfaces, choose inside for the source interface and outside for the destination interface. Click Continue. |
| **Step 9** | In section 3, Packets, perform these actions:   1. Expand the Original Address menu, click Choose, and select the servername\_inside object. 2. Expand the Translated Address menu, click Choose, and select the servername\_outside object. |
| **Step 10** | Skip section 4, Advanced. |
| **Step 11** | For an FDM-managed device, in section 5, Name, give the NAT rule a name. |
| **Step 12** | Click Save. |
| **Step 13** | For ASA, deploy a Network Policy rule or for FDM-managed device, deploy an access control policy rule to allow the traffic to flow from *servername*\_inside to *servername*\_outside. |
| **Step 14** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Enable Users on the Inside Network to Access the Internet Using the Outside Interface's Public IP Address

**Use Case**

Allow users and computers in your private network to connect to the internet by sharing the public address of your outside
interface.

**Strategy**

Create a port address translation (PAT) rule that allows all the users on your private network to share the outside interface
public IP address of your device.

After the private address is mapped to the public address and port number, the device records that mapping. When incoming
traffic bound for that public IP address and port is received, the device sends it back to the private IP address that requested
it.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  Network Object NAT. |
| **Step 7** | In section 1, Type, select Dynamic. Click Continue. |
| **Step 8** | In section 2, Interfaces, choose any for the source interface and outside for the destination interface. Click Continue. |
| **Step 9** | In section 3, Packets, perform these actions :   1. Expand the Original Address menu, click Choose and select the any-ipv4 or any-ipv6 object depending on your network configuration. 2. Expand the Translated Address menu, and select interface from the available list. Interface indicates to use the public address of the outside interface. |
| **Step 10** | For an FDM-managed device, in section 5, Name, enter a name for the NAT rule. |
| **Step 11** | Click Save. |
| **Step 12** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

**Entries in the ASA's Saved Configuration File**

Here are the entries that are created and appear in an ASA's saved configuration file as a result of this procedure.

| **Note** | ---   This does not apply to FDM-managed devices.   --- |
| --- | --- |

**Objects created by this procedure:**

```
object network any_network
subnet 0.0.0.0 0.0.0.0
```

**NAT rules created by this procedure:**

```
object network any_network
nat (any,outside) dynamic interface
```

#### Make a Server on the Inside Network Available on a Specific Port of a Public IP Address

##### Use Case

If you only have one public IP address, or a very limited number, you can create a network object NAT rule that translates
inbound traffic, bound for a static IP address and port, to an internal address. We have provided procedures for specific
cases, but you can use them as a model for other supported applications.

##### Prerequisites

Before you begin, create three separate network objects, one each for an FTP, HTTP, and SMTP server. For the sake of the following
procedures, we call these objects **ftp-server-object**, **http-server-object**, and **smtp-server-object**. See [Create Network Objects](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups) for instructions.

* [NAT Incoming FTP Traffic to an FTP Server](#NAT_Incoming_FTP_Traffic_to_an_FTPServer)
* [NAT Incoming HTTP Traffic to an HTTP Server](#NAT_Incoming_HTTP_Traffic_to_an_HTTP_Server)
* [NAT Incoming SMTP Traffic to an SMTP Server](#NAT_Incoming_SMTP_Traffic_to_an_SMTP_Server)

##### NAT Incoming FTP Traffic to an FTP Server

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  > Network Object NAT. |
| **Step 7** | In section 1, Type, select Static. Click Continue. |
| **Step 8** | In section 2, Interfaces, choose inside for the source interface and outside for the destination interface. Click Continue. |
| **Step 9** | In section 3, Packets, perform these actions:   * Expand the Original Address menu, click Choose, and select the ftp-server-object. * Expand the Translated Address menu, click Choose, and select the Interface. * Check Use Port Translation. * Select tcp, ftp, ftp. |
| **Step 10** | Skip section 4, Advanced. |
| **Step 11** | For an FDM-managed device, in section 5, Name, give the NAT rule a name. |
| **Step 12** | Click Save. The new rule is created in [section 2](#AboutNetwork_Address_Translation_NAT) of the NAT table. |
| **Step 13** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### NAT Incoming HTTP Traffic to an HTTP Server

If you only have one public IP address, or a very limited number, you can create a network object NAT rule that translates
inbound traffic, bound for a static IP address and port, to an internal address. We have provided procedures for specific
cases, but you can use them as a model for other supported applications.

###### Before you begin

Before you begin, create a network object for the http server. For the sake of this procedure, we will call the object, **http-object**. See [Create Network Objects](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups) for instructions.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  > Network Object NAT. |
| **Step 7** | In section 1, Type, select Static. Click Continue. |
| **Step 8** | In section 2, Interfaces, choose inside for the source interface and outside for the destination interface. Click Continue. |
| **Step 9** | In section 3, Packets, perform these actions:   * Expand the Original Address menu, click Choose, and select the http-object. * Expand the Translated Address menu, click Choose, and select the Interface. * Check Use Port Translation. * Select tcp, http, http. |
| **Step 10** | Skip section 4, Advanced. |
| **Step 11** | For an FDM-managed device, in section 5, Name, give the NAT rule a name. |
| **Step 12** | Click Save. The new rule is created in [section 2](#AboutNetwork_Address_Translation_NAT) of the NAT table. |
| **Step 13** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

##### NAT Incoming SMTP Traffic to an SMTP Server

If you only have one public IP address, or a very limited number, you can create a network object NAT rule that translates
inbound traffic, bound for a static IP address and port, to an internal address. We have provided procedures for specific
cases, but you can use them as a model for other supported applications.

###### Before you begin

Before you begin, create a network object for the smtp server. For the sake of this procedure, we will call the object, **smtp-object**. See [Create Network Objects](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups) for instructions.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  > Network Object NAT. |
| **Step 7** | In section 1, Type, select Static. Click Continue. |
| **Step 8** | In section 2, Interfaces, choose inside for the source interface and outside for the destination interface. Click Continue. |
| **Step 9** | In section 3, Packets, perform these actions:   * Expand the Original Address menu, click Choose, and select the smtp-server-object. * Expand the Translated Address menu, click Choose, and select the Interface. * Check Use Port Translation. * Select tcp, smtp, smtp. |
| **Step 10** | Skip section 4, Advanced. |
| **Step 11** | For an FDM-managed device, in section 5, Name, give the NAT rule a name. |
| **Step 12** | Click Save. The new rule is created in [section 2](#AboutNetwork_Address_Translation_NAT) of the NAT table. |
| **Step 13** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Translate a Range of Private IP Addresses to a Range of Public IP Addresses

##### Use Case

Use this approach if you have a group of specific device types, or user types, that need to have their IP addresses translated
to a specific range so that the receiving devices (the devices on the other end of the transaction) allow the traffic in.

* [Translate a Pool of Inside Addresses to a Pool of Outside Addresses](#Translate_a_Pool_of_Inside_Addresses_to_a_Pool_of_Outside_Addresses)

##### Translate a Pool of Inside Addresses to a Pool of Outside Addresses

###### Before you begin

Create a network object for the pool of private IP addresses you want to translate and create a network object for the pool
of public addresses you want to translate those private IP addresses into.

| **Note** | ---   For the ASA FTD, the network group that defines the pool of "translated address" cannot be a network object that defines a subnet.   --- |
| --- | --- |

When creating these address pools,  use [Create or Edit a Firepower Network Object or Network Group](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups) for instructions.

For the sake of the following procedure, we named the pool of private addresses, **inside\_pool** and name the pool of public addresses, **outside\_pool.**

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  > Network Object NAT. |
| **Step 7** | In section 1, Type, select Dynamic and click Continue. |
| **Step 8** | In section 2, Interfaces, set the source interface to inside and the destination interface to outside. Click Continue. |
| **Step 9** | In section 3, Packets, perform these tasks:   * For the Original Address, click Choose and then select the inside\_pool network object (or network group) you made in the prerequisites section above. * For the Translated Address, click Choose and then select the outside\_pool network object (or network group) you made in the prerequisites section above. |
| **Step 10** | Skip section 4, Advanced. |
| **Step 11** | For an FDM-managed device, in section 5, Name, give the NAT rule a name. |
| **Step 12** | Click Save. |
| **Step 13** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Prevent a Range of IP Addresses from Being Translated When Traversing the Outside Interface

##### Use Case

Use this Twice NAT use case to enable site-to-site VPN.

##### Strategy

You are translating a pool of IP addresses to itself so that the IP addresses in one location on the network arrives unchanged
in another.

* [Create a Twice NAT Rule](#Create_a_Twice_NAT_Rule)

##### Create a Twice NAT Rule

###### Before you begin

Create a network object or network group that defines the pool of IP addresses you are going to translate to itself. For the ASA, the range of addresses can be defined by a network object that uses an IP address range, a network object that
defines a subnet, or a network group object that includes all the addresses in the range. For the FTD, the range of addresses can be defined by a network object that defines a subnet or a network group object that
includes all the addresses in the range.

When creating the network objects or network groups, use [Create or Edit a Firepower
Network Object or Network Group](#Create_or_Edit_a_Firepower_Network_Object_or_Network_Groups) for instructions.

For the sake of the following procedure, we are going call the network object or network group, Site-to-Site-PC-Pool.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you want to create the NAT rule for. |
| **Step 5** | Click NAT in the Management pane at the right. |
| **Step 6** | Click  > Twice NAT.. |
| **Step 7** | In section 1, Type, select Static. Click Continue. |
| **Step 8** | In section 2, Interfaces, choose inside for the source interface and outside for the destination interface. Click Continue. |
| **Step 9** | In section 3, Packets, make these changes:   * Expand the Original Address menu, click Choose, and select the Site-to-Site-PC-Pool object you created in the prerequisites section. * Expand the Translated Address menu, click Choose, and select the Site-to-Site-PC-Pool object you created in the prerequisites section. |
| **Step 10** | Skip section 4, Advanced. |
| **Step 11** | For an FDM-managed device, in section 5, Name, give the NAT rule a name. |
| **Step 12** | Click Save. |
| **Step 13** | For an ASA, create a crypto map. See [CLI Book 3: Cisco ASA Series VPN CLI Configuration Guide](https://www.cisco.com/c/en/us/support/security/asa-5500-series-next-generation-firewalls/products-installation-and-configuration-guides-list.html) and review the chapter on LAN-to-LAN IPsec VPNs for more information on creating a crypto map. |
| **Step 14** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

## Manage Virtual Private Network Management in Security Cloud Control

A virtual private network (VPN) connection establishes a secure tunnel between endpoints over a public network such as the
Internet.

This section applies to Remote Access and Site-to-site VPNs on
FDM-managed device. It describes the Internet Protocol Security (IPsec) standards to build site-to-site VPNs connection on FTD. It also describes the SSL standards that are used to build and remote access VPN connections on FTD.

Security Cloud Control supports the following types of VPN connections:

* [Introduction to Site-to-Site Virtual Private Network](#SitetoSite_Virtual_Private_Network)
* [Remote Access Virtual Private Network](#Related_Topics)

For additional information about Virtual Private Networks, refer to the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

* [Introduction to Site-to-Site Virtual Private Network](#SitetoSite_Virtual_Private_Network)
* [Introduction to Remote Access Virtual Private Network](#Related_Topics)

### Introduction to Site-to-Site Virtual Private Network

A site-to-site VPN tunnel connects networks in different geographic locations. You can create site-to-site IPsec connections between managed devices and between managed devices and other Cisco or third-party
peers that comply with all relevant standards. These peers can have any mix of inside and outside IPv4 and IPv6 addresses. Site-to-site tunnels are built using the Internet Protocol Security (IPsec) protocol suite and Internet Key Exchange version
2 (IKEv2). After the VPN connection is established, the hosts behind the local gateway can connect to the hosts behind the
remote gateway through the secure VPN tunnel.

#### VPN Topology

To create a new site-to-site VPN topology you must provide a unique name, specify a topology type, choose the IKE version
that is used for IPsec IKEv1 or IKEv2, or both and authentication method. Once configured, you deploy the topology to FTD.

#### IPsec and IKE Protocols

In Security Cloud Control, site-to-site VPNs are configured based on IKE policies and IPsec proposals that are assigned to VPN topologies. Policies
and proposals are sets of parameters that define the characteristics of a site-to-site VPN, such as the security protocols
and algorithms that are used to secure traffic in an IPsec tunnel. Several policy types may be required to define a full configuration
image that can be assigned to a VPN topology.

#### Authentication VPN Tunnels

For authentication of VPN connections, configure a pre-shared key in the topology on each device. Pre-shared keys allow a
secret key, used during the IKE authentication phase, to be shared between two peers.

#### Virtual Tunnel Interface (VTI)

Security Cloud Control does not currently support the management, monitoring, or use of Virtual Tunnel Interface (VTI) tunnels on FTD. Devices with
configured VTI tunnels can be onboarded to Security Cloud Control but it ignores the VTI interfaces. If a security zone or static route references a VTI, Security Cloud Control reads the security zone and static route without the VTI reference.

#### About Extranet Devices

You can add non-Cisco or unmanaged Cisco devices to a VPN topology as "Extranet" devices with either static or dynamic IP
addresses.

* Non-Cisco Device: You cannot use Security Cloud Control to create and deploy configurations to non-Cisco devices.
* Unmanaged Cisco Device: Cisco device not managed by your organization, such as spokes in networks managed by other organizations
  within your company, or a connection to a service provider or partner's network.

* [Configure Site-to-Site VPN for an FDM-Managed Device](#Configuring_SitetoSite_VPN_for_an_FTD)
* [About Global IKE Policies](#Configuring_the_Global_IKE_Policy)
* [About IPsec Proposals](#Configuring_IPsec_Proposals)
* [Monitor FDM-Managed Device Site-to-Site Virtual Private Networks](#Cisco_Concept.dita_69376aa9-2723-41e1-865a-34279cbec929)
* [Delete a Security Cloud Control Site-To-Site VPN Tunnel](#Delete_an_Existing_CDO_SiteToSite_VPN)

**Related Information:**

* [Configure Site-to-Site VPN for an FDM-Managed Device](#Configuring_SitetoSite_VPN_for_an_FTD)
* [Monitoring ASA, FTD, and AWS Site-to-Site Virtual Private Network](#Cisco_Concept.dita_69376aa9-2723-41e1-865a-34279cbec929)

#### Configure Site-to-Site VPN for an FDM-Managed Device

Security Cloud Control supports these aspects of site-to-site VPN functionality on FDM-managed devices:

* Both IPsec IKEv1 & IKEv2 protocols are supported.
* Automatic or manual pre-shared keys for authentication.
* IPv4 and IPv6. All combinations of inside and outside are supported.
* IPsec IKEv2 site-to-site VPN topologies provide configuration settings to comply
  with Security Certifications.
* Static and dynamic interfaces.
* Support for the dynamic IP address for the extranet device as an
  endpoint.

##### Configure Site-to-Site VPN Connections with Dynamically Addressed Peers

Security Cloud Control allows you to create a site-to-site VPN connection between peers when one of the peers' VPN interface IP address is not known
or when the interface obtains its address from a DHCP server. Any dynamic peer whose preshared key, IKE settings, and IPsec
configurations match with another peer can establish a site-to-site VPN connection.

Consider two peers, A and B. The static peer is a device whose IP address of its VPN
interface is fixed and a dynamic peer is a device whose IP address of the VPN
interface is not known or has a temporary IP address.

The following use cases describe different scenarios for establishing a secure
site-to-site VPN connection with dynamically-addressed peers:

* A is a static peer, and B is a dynamic peer or conversely.
* A is a static peer, and B is a dynamic peer with a resolved IP address from
  the DHCP server or conversely. You can select Bind VPN to the
  assigned IP to establish the VPN connection between the IP
  address of the static peer and the DHCP assigned IP address of the dynamic
  peer.
* A and B are dynamic with resolved IP addresses from the DHCP server. In such
  a case, you must select Bind VPN to the assigned IP
  for at least one peer to establish the VPN connection between
  the IP address of the static peer and the DHCP assigned IP address of the
  dynamic peer.
* A is a dynamic peer, and B is an extranet device with a static or dynamic IP
  address.
* A is a dynamic peer with a resolved IP address from the DHCP server, and B is
  an Extranet device with a static or dynamic IP address. You can select
  Bind VPN to the assigned IP to establish the VPN
  connection between the IP address of the static peer and the DHCP assigned
  IP address of the dynamic peer.

| **Important** | ---   If you select Bind VPN to the assigned IP, the VPN binds statically to the DHCP assigned IP address. However, this dynamic interface can receive many new IP addresses after the peer restarts. Although the VPN tunnel updates the new IP address, the other peer is not updated with the new configuration. You must deploy the site-to-site configuration again for out-of-band changes on the other peer.   --- |
| --- | --- |

| **Note** | ---   If the IP address of the interface is changed by using a local manager like firewall device manager, the Configuration Status of that peer in Security Cloud Control shows "Conflict Detected". When you [resolve this out-of-band change](#Resolve_Configuration_Conflicts), the Configuration Status of the other peer changes to the "Not Synced" state. You must deploy the Security Cloud Control configuration to the device which is in "Not Synced" state.   --- |
| --- | --- |

Typically, the dynamic peer must be the one that initiates the connection as the
other peer would not know the IP address of the dynamic peer. When the remote peer
attempts to establish the connection, the other peer validates the connection using
the preshared key, IKE settings, and IPsec configurations.

Because the VPN connection is established only after the remote peer initiates the
connection, any outbound traffic that matches access control rules that allow
traffic in the VPN tunnel will be dropped until that connection is established. This
ensures that data does not leave your network without the appropriate encryption and
VPN protection.

| **Note** | ---   A site-to-site VPN connection cannot be configured in the following scenarios:   --- |
| --- | --- |

* If both peers have DHCP assigned IP addresses.

  + Workaround: You can configure a site-to-site
    VPN, if one of the peers has a resolved IP address from the DHCP
    server. In such a case, you must select Bind VPN to the
    assigned IP to configure site-to-site VPN.
* If a device has more than one dynamic peer connection.

  + Workaround: You can configure a site-to-site
    VPN by performing the following steps:

    - Consider three devices A, B, and C.
    - Configure site-to-site VPN connection between A (static peer)
      and B (dynamic peer).
    - Configure site-to-site VPN connection between A and C
      (dynamic peer) by creating an Extranet device. Assign the
      static VPN interface IP address of A to the Extranet device
      and establish a connection with C.

##### FDM-Managed Device Site-to-Site VPN Guidelines and Limitations

* Security Cloud Control does not support a crypto-acl to design the interesting traffic for S2S VPN. It only supports protected networks.
* Security Cloud Control does not currently support the management, monitoring, or use of Virtual Tunnel Interface (VTI) tunnels on ASA or FDM-managed devices. Devices with configured VTI tunnels can be onboarded to Security Cloud Control but it ignores the VTI interfaces. If a security zone or static route references a VTI, Security Cloud Control reads the security zone and static route without the VTI reference. Security Cloud Control support for VTI tunnels is coming soon.
* Whenever IKE ports 500/4500 are in use or when there are some PAT
  translations that are active, the site-to-site VPN cannot be configured on
  the same ports as it fails to start the service on those ports.
* Transport mode is not supported only tunnel mode. IPsec tunnel mode encrypts
  the entire original IP datagram which becomes the payload in a new IP
  packet. Use tunnel mode when the firewall is protecting traffic to and from
  hosts positioned behind a firewall. Tunnel mode is the normal way regular
  IPsec is implemented between two firewalls (or other security gateways) that
  are connected over an untrusted network, such as the Internet.
* For this release, only PTP topology is supported, containing one or more VPN
  tunnels. Point-to-point (PTP) deployments establish a VPN tunnel between two
  endpoints.

* [Encryption and Hash Algorithms Used in VPN](#Encryption_and_Hash_Algorithms_Used_in_VPN)
* [Create a Site-To-Site VPN](#Create_a_SiteToSite_VPN)
* [Edit an Existing Security Cloud Control Site-To-Site VPN](#Edit_an_Existing_CDO_SiteToSite_VPN)
* [Exempt Site-to-Site VPN Traffic from NAT](#Procedure)

**Related Information:**

* [Create a Site-To-Site VPN](#Create_a_SiteToSite_VPN)
* [Edit an Existing Security Cloud Control Site-To-Site VPN](#Edit_an_Existing_CDO_SiteToSite_VPN)
* [Encryption and Hash Algorithms Used in VPN](#Encryption_and_Hash_Algorithms_Used_in_VPN)
* [Exempting Site-to-Site VPN Traffic from
  NAT](#Procedure)

##### Encryption and Hash Algorithms Used in VPN

Because a VPN tunnel typically traverses a public network, most likely the Internet, you need to encrypt the connection to
protect the traffic. You define the encryption and other security techniques to apply using IKE policies and IPsec proposals.

If your device license allows you to apply strong encryption, there is a wide range of encryption and hash algorithms, and
Diffie-Hellman groups, from which to choose. However, as a general rule, the stronger the encryption that you apply to the
tunnel, the worse the system performance. Find a balance between security and performance that provides sufficient protection
without compromising efficiency.

We cannot provide specific guidance on which options to choose. If you operate within a larger corporation or other organization,
there might already be defined standards that you need to meet. If not, take the time to research the options.

The following topics explain the available options:

###### Deciding Which Encryption Algorithm to Use

When determining which encryption algorithms to use for the IKE policy or IPsec proposal, your choice is limited to algorithms
supported by the devices in the VPN.

For IKEv2, you can configure multiple encryption algorithms. The system orders the settings from the most secure to the least
secure and negotiates with the peer using that order. For IKEv1, you can select a single option only.

For IPsec proposals, the algorithm is used by the Encapsulating Security Protocol (ESP), which provides authentication, encryption,
and anti-replay services. ESP is IP protocol type 50. In IKEv1 IPsec proposals, the algorithm name is prefixed with ESP.

If your device license qualifies for strong encryption, you can choose from the following encryption algorithms. If you are
not qualified for strong encryption, you can select DES only.

* AES-GCM - (IKEv2 only.) Advanced Encryption Standard in Galois/Counter Mode is a block cipher mode of operation providing
  confidentiality and data-origin authentication and provides greater security than AES. AES-GCM offers three different key
  strengths: 128-, 192-, and 256-bit keys. A longer key provides higher security but a reduction in performance. GCM is a mode
  of AES that is required to support NSA Suite B. NSA Suite B is a set of cryptographic algorithms that devices must support
  to meet federal standards for cryptographic strength.
* AES-GMAC - (IKEv2 IPsec proposals only.) Advanced Encryption Standard Galois Message Authentication Code is a block cipher
  mode of operation providing only data-origin authentication. It is a variant of AES-GCM that allows data authentication without
  encrypting the data. AES-GMAC offers three different key strengths: 128-, 192-, and 256-bit keys.
* AES - Advanced Encryption Standard is a symmetric cipher algorithm that provides greater security than DES and is computationally
  more efficient than 3DES. AES offers three different key strengths: 128-, 192-, and 256-bit keys. A longer key provides higher
  security but a reduction in performance.
* DES - Data Encryption Standard, which encrypts using 56-bit keys, is a symmetric secret-key block algorithm. If your license
  account does not meet the requirements for export controls, this is your only option. It is faster than 3DES and uses fewer
  system resources, but it is also less secure. If you do not need strong data confidentiality, and if system resources or speed
  is a concern, choose DES.
* 3DES - Triple DES, which encrypts three times using 56-bit keys, is more secure than DES because it processes each block of
  data three times with a different key. However, it uses more system resources and is slower than DES.
* NULL - A null encryption algorithm provides authentication without encryption. This is typically used for testing purposes
  only.

###### Deciding Which Hash Algorithms to Use

In IKE policies, the hash algorithm creates a message digest, which is used to ensure message integrity. In IKEv2, the hash
algorithm is separated into two options, one for the integrity algorithm, and one for the pseudo-random function (PRF).

In IPsec proposals, the hash algorithm is used by the Encapsulating Security Protocol (ESP) for authentication. In IKEv2 IPsec
Proposals, this is called the integrity hash. In IKEv1 IPsec proposals, the algorithm name is prefixed with ESP-, and there
is also an -HMAC suffix (which stands for "hash method authentication code").

For IKEv2, you can configure multiple hash algorithms. The system orders the settings from the most secure to the least secure
and negotiates with the peer using that order. For IKEv1, you can select a single option only.

You can choose from the following hash algorithms:

* SHA (Secure Hash Algorithm) - Standard SHA (SHA-1) produces a 160-bit digest. SHA is more resistant to brute-force attacks
  than MD5. However, it is also more resource-intensive than MD5. For implementations that require the highest level of security,
  use the SHA hash algorithm.
* The following SHA-2 options, which are even more secure, are available for IKEv2 configurations. Choose one of these if you
  want to implement the NSA Suite B cryptography specification.

  + SHA-256 - Specifies the Secure Hash Algorithm SHA-2 with the 256-bit digest.
  + SHA-384 - Specifies the Secure Hash Algorithm SHA-2 with the 384-bit digest.
  + SHA-512 - Specifies the Secure Hash Algorithm SHA-2 with the 512-bit digest.
* MD5 (Message Digest 5) - Produces a 128-bit digest. MD5 uses less processing time for overall faster performance than SHA,
  but it is considered to be weaker than SHA.
* Null or None (NULL, ESP-NONE) - (IPsec Proposals only.) A null Hash Algorithm; this is typically used for testing purposes
  only. However, you should choose the null integrity algorithm if you select one of the AES-GCM/GMAC options as the encryption
  algorithm. Even if you choose a non-null option, the integrity hash is ignored for these encryption standards.

###### Deciding Which Diffie-Hellman Modulus Group to Use

You can use the following Diffie-Hellman key derivation algorithms to generate IPsec security association (SA) keys. Each
group has different size modules. A larger modulus provides higher security but requires more processing time. You must have
a matching modulus group on both peers.

If you select AES encryption, to support the large key sizes required by AES, you should use Diffie-Hellman (DH) Group 5 or
higher. IKEv1 policies do not support all of the groups listed below.

To implement the NSA Suite B cryptography specification, use IKEv2 and select one of the elliptic curves Diffie-Hellman (ECDH)
options: 19, 20, or 21. Elliptic curve options and groups that use 2048-bit modulus are less exposed to attacks such as Logjam.

For IKEv2, you can configure multiple groups. The system orders the settings from the most secure to the least secure and
negotiates with the peer using that order. For IKEv1, you can select a single option only.

* 2 - Diffie-Hellman Group 2: 1024-bit modular exponential (MODP) group. This option is no longer considered good protection.
* 5 - Diffie-Hellman Group 5: 1536-bit MODP group. Formerly considered good protection for 128-bit keys, this option is no longer
  considered good protection.
* 14 - Diffie-Hellman Group 14: 2048-bit modular exponential (MODP) group. Considered good protection for 192-bit keys.
* 19 - Diffie-Hellman Group 19: National Institute of Standards and Technology (NIST) 256-bit elliptic curve modulo a prime
  (ECP) group.
* 20 - Diffie-Hellman Group 20: NIST 384-bit ECP group.
* 21 - Diffie-Hellman Group 21: NIST 521-bit ECP group.
* 24 - Diffie-Hellman Group 24: 2048-bit MODP group with 256-bit prime order subgroup. This option is no longer recommended.

###### Deciding Which Authentication Method to Use

You can use the following methods to authenticate the peers in a site-to-site VPN connection.

###### Preshared Keys

Preshared keys are secret key strings configured on each peer in the connection. These keys are used by IKE during the authentication
phase. For IKEv1, you must configure the same preshared key on each peer. For IKEv2, you can configure unique keys on each
peer.

Preshared keys do not scale well compared to certificates. If you need to configure a large number of site-to-site VPN connections,
use the certificate method instead of the preshared key method.

##### Create a Site-To-Site VPN

You can create a site-to-site VPN by following one of the two methods: simple configuration and advanced configuration. In
a simple configuration, the default configuration is used for establishing the site-to-site VPN connection. You can modify
the configuration in the Advanced mode.

Each site-to-site VPN topology can include extranet devices that you do not manage in Security Cloud Control. An Extranet device can be any device (Cisco or third-party), which is not managed by Security Cloud Control.

For this release, only PTP topology is supported, containing one tunnel per site-to-site connection. Point-to-point (PTP)
deployments establish a VPN tunnel between two endpoints.

* [Create a Site-To-Site VPN using the Simple Configuration](#Create_a_SiteToSite_VPN_using_the_Simple_Configuration)
* [Create a Site-To-Site VPN using the Advanced Configuration](#Create_a_SiteToSite_VPN_using_the_Advanced_Configuration)
* [Configure Networking for Protected Traffic Between the Site-To-Site Peers](#Configure_Networking_for_Protected_Traffic_Between_the_SiteToSite_Peers)

**Related information**:

* [Create a Site-To-Site VPN using the Simple Configuration](#Create_a_SiteToSite_VPN_using_the_Simple_Configuration)
* [Create a Site-To-Site VPN using the Advanced Configuration](#Create_a_SiteToSite_VPN_using_the_Advanced_Configuration)
* [Configure Networking for Protected Traffic Between the Site-To-Site Peers](#Configure_Networking_for_Protected_Traffic_Between_the_SiteToSite_Peers)

###### Create a Site-To-Site VPN using the Simple Configuration

###### Procedure

---

| **Step 1** | In the left pane, choose Secure Connections > Site to Site VPN. |
| --- | --- |
| **Step 2** | Click  > **Site-to-Site VPN** with **FDM** label.   | **Note** | Alternatively, you can create the Site-to-Site VPN connection from the Security Devices page. | | --- | --- |  1. In the left pane, click Security Devices. 2. Select two FDM-managed devices that you want to configure. If you select an extranet device, specify the extranet device's IP address. 3. In the right-page, under Device Actions, click Create Site-to-Site VPN. |
| **Step 3** | Enter a unique topology Configuration Name. We recommend naming your topology to indicate that it is an FDM-managed device VPN, and its topology type. |
| **Step 4** | Choose the endpoint devices for this VPN deployment from Devices. |
| **Step 5** | If you choose an extranet device in Peer 2, select Static, and specify an IP address or select Dynamic for extranet devices with DHCP assigned IP. The IP Address displays the IP address for static interface or DHCP Assigned for the dynamic interface. |
| **Step 6** | Choose the VPN Access Interface for the for the endpoint devices.   | **Note** | If one or both endpoint devices have dynamic IP addresses, see [Configure Site-to-Site VPN Connections with Dynamically-Addressed Peers](#Configuring_SitetoSite_VPN_for_an_FTD__Dynamic) for additional instructions. | | --- | --- | |
| **Step 7** | Click the blue plus  button to add the Protected Networks for the participating devices. |
| **Step 8** | (Optional) Select NAT Exempt to exempt the VPN traffic from NAT policies on the local VPN access interface. It must be configured manually for individual peers. If you do not want NAT rules to apply to the local network, select the interface that hosts the local network. This option works only if the local network resides behind a single routed interface (not a bridge group member). If the local network is behind more than one routed interface or one or more bridge group members, you must manually create the NAT exempt rules. For information on manually creating the required rules, see [Exempting Site-to-Site VPN Traffic from NAT](#Procedure). |
| **Step 9** | Click Create VPN, and then click Finish. |
| **Step 10** | Perform the additional mandatory configuration. See [Configure networking for protected traffic between the Site-To-Site Peers](#Configure_Networking_for_Protected_Traffic_Between_the_SiteToSite_Peers).  The Site-To-Site VPN is configured. |

---

###### Create a Site-To-Site VPN using the Advanced Configuration

###### Procedure

---

|  |  |
| --- | --- |
| **Step 1** | In the left pane, choose Secure Connections > Site to Site VPN. |
| **Step 2** | Click  > **Site-to-Site VPN** with **FDM** label. |
| **Step 3** | In the Peer Devices section, specify the following device configurations:   1. Enter a unique topology Configuration Name. We recommend naming your topology to indicate that it is an FDM-managed devicee VPN, and its topology type. 2. Choose the endpoint devices for this VPN deployment from Devices. 3. If you choose an extranet device, select Static and specify an IP address or select Dynamic for extranet devices with DHCP assigned IP. The IP Address displays the IP address for static interface or DHCP Assigned for the dynamic interface. 4. Choose the VPN Access Interface for the endpoint devices.  | **Note** | If one or both endpoint devices have dynamic IP addresses, see [Configure Site-to-Site VPN Connections with Dynamically-Addressed Peers](#Configuring_SitetoSite_VPN_for_an_FTD__Dynamic) for additional instructions. | | --- | --- | |
| **Step 4** | Click the blue plus  button to add the Protected Networks for the participating devices. |
| **Step 5** | Click Advanced. |
| **Step 6** | In the IKE Settings section, choose the IKE versions to use during Internet Key Exchange (IKE) negotiations and specify the privacy configurations: For more information on the IKE policies, see the [About Global IKE Policies](#Configuring_the_Global_IKE_Policy).   | **Note** | IKE policies are global to a device and apply to all VPN tunnels associated with it. Therefore, adding or deleting policies affect all VPN tunnels in which this device is participating. | | --- | --- |  1. Select either or both options as appropriate.         | **Note** | By default, IKEV Version 2 is enabled and the IKEV2 POLICIES. |    | --- | --- | 2. Click the blue plus  button and select the IKEv2 policies.  Click Create New IKEv2 Policy to create new IKEv2 policies. Alternatively, in Security Cloud Control click Objects, then click  > IKEv2 Policy. For more information about creating new IKEv2 policies, see the [Configuring IKEv2 Policies](#Managing_FTD_IKEv2_Policies). To delete an existing IKEv2 Policy, hover-over the selected policy and click the x icon. 3. Click IKE Version 1 to enable it. 4. Click the blue plus  button and select the IKEv1 policies. Click Create New IKEv1 Policy to create new IKEv1 policies. Alternatively, you can go to the Security Cloud Control navigation bar and click Objects , then click > IKEv1 Policy. For more information about creating new IKEv1 policies, see the [Configuring IKEv1 Policies](#Managing_FTD_IKEv1_Policies). To delete an existing IKEv1 Policy, hover-over the selected policy and click the x icon. 5. Enter the Pre-Shared Key for the participating devices. Preshared keys are secret key strings configured on each peer in the connection. These keys    are used by IKE during the authentication phase.     * (IKEv2) Peer 1 Pre-shared Key, Peer 2 Pre-shared Key: For IKEv2, you can configure unique keys on each peer. Enter the Pre-shared Key. You can click the Show Override button and enter the appropriate pre-shared for the peer. The key can be 1-127, alphanumeric characters. The following table      describes the purpose of the pre-shared key for both peers.                                     |  | Local Pre-shared Key | Remote Peer Pre-shared Key |      | --- | --- | --- |      | **Peer 1** | Peer 1 Pre-shared Key | Peer 2 Pre-shared Key |      | **Peer 2** | Peer 2 Pre-shared Key | Peer 1 Pre-shared Key |    * (IKEv1) Pre-shared Key: For IKEv1, you must configure the same preshared key on each peer. The key can be 1-127, alphanumeric characters. In this      scenario, Peer 1 and Peer 2 use the same pre-shared key to encrypt and decrypt data. 6. Click Next. |
| **Step 7** | In the IPSec Settings section, specify the IPSec configurations. The corresponding IKEV proposals are available depending on the selection that is made in the IKE Settings step.  For more information on the IPSec settings, see the [About IPsec Proposals](#Configuring_IPsec_Proposals).   1. Click the blue plus  button and select the IKEv2 proposals. To delete an existing IKEv2 Proposal, hover-over the selected proposal and click the    x icon.         | **Note** | Click Create New IKEv2 Proposal to create new IKEv2 proposals. Alternatively, you can go to the Security Cloud Control navigation bar and click Objects, then click  > IKEv2 IPSec Proposal. |    | --- | --- |         For more information about creating new IKEv2 policies, see the [Configuring IPSec Proposals for IKEv2](#Managing_an_FTD_IKEv2_IPsec_Proposal_Object). 2. Choose the Diffie-Hellman Group for Perfect Forward Secrecy. For more information, see [Deciding Which Diffie-Hellman Modulus Group to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__Diffie-Hellman). 3. Click Create VPN. 4. Read the configuration and then click Finish if you're satisfied. 5. Perform the additional mandatory configuration. See [Configure networking for protected traffic between the Site-To-Site Peers](#Configure_Networking_for_Protected_Traffic_Between_the_SiteToSite_Peers). |

---

###### Configure Networking for Protected Traffic Between the Site-To-Site Peers

After completing the configuring of the Site-To-Site connection, make sure that you perform the following configuration for
VPN to function on all targeted devices.

###### Procedure

---

| **Step 1** | Configure AC policies:  Configure AC policies for permitting bidirectional traffic between the protected networks behind both peers. These policies help the packets to traverse to the intended destination without being dropped.   | **Note** | You must create AC policies for incoming and outgoing traffic on both peers. | | --- | --- |  1. In the Security Cloud Control navigation bar at the left, click Policies and select the option that you want. 2. Create policies for incoming and outgoing traffic on both peers. For more information on AC policy creation, see [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy).  The following example shows steps for creating AC policies on both peers.  Consider two FDM-managed devices 'FTD\_BGL\_972' and 'FTD\_BGL\_973' with Site-To-Site VPN connection between two protected networks 'boulder-network'    and 'sanjose-network' respectively.  *Creating the AC policy for permitting incoming traffic*:  The policy 'Permit\_incoming\_VPN\_traffic\_from\_973' is created on the 'FTD\_BGL\_972' device for allowing incoming traffic from    the peer ('FTD\_BGL\_973').       * Source Zone: Set the zone of the peer device from which the network traffic originates. In this example, the traffic is originating from      FTD\_BGL\_973 and reaching FTD\_BGL\_972.    * Source Network: Set the protected network of the peer device from which the network traffic originates. In this example, traffic is originating      from 'sanjose-network' which is the protected network behind the peer device (FTD\_BGL\_973).    * Destination Network: Set the protected network of the device on which the network traffic arrives. In this example, traffic is arriving at 'boulder-network'      which is the protected network behind the peer device (FTD\_BGL\_972). Note: The remaining fields can have the default value ("Any").    * Set Action to Allow for allowing the traffic subject to the intrusion and other inspection settings in the policy. *Creating the AC policy for permitting outgoing traffic*:  The policy 'Permit\_outgoing\_VPN\_traffic\_to\_973' is created on the 'FTD\_BGL\_972' device for permitting outgoing traffic to    the peer ('FTD\_BGL\_973').       * Source Network: Set the protected network of the peer device from which the network traffic originates. In this example, traffic is originating      from 'boulder-network' which is the protected network behind the peer device (FTD\_BGL\_972).    * Destination Zone: Set the zone of the peer device on which the network traffic arrives. In this example, the traffic is arriving from FTD\_BGL\_972      and reaching FTD\_BGL\_973.    * Destination Network: Set the protected network of the peer on which the network traffic arrives. In this example, traffic is arriving on 'sanjose-network'      which is the protected network behind the peer device (FTD\_BGL\_972). Note: The remaining fields can have the default value ("Any").    * Set Action to Allow for allowing the traffic subject to the intrusion and other inspection settings in the policy.   After creating AC policies on one device, you must create similar policies on its peer. |
| --- | --- | --- | --- |
| **Step 2** | If NAT is configured on either of the peer devices, you need to configure the NAT exempt rules manually. See [Exempting Site-to-Site VPN Traffic from NAT](#Procedure). |
| **Step 3** | Configure routing for receiving the return VPN traffic on each peer. For more information, see [Configure Routing](#Configure_Static_and_Default_Routes_for_FTD_Devices).   1. Gateway-Select the network object that identifies the IP address for the gateway to the destination network. Traffic is sent to this    address. 2. Interface-Select the interface through which you want to send traffic. In this example, the traffic is sent through 'outside' interface. 3. Destination Networks-Select one or network objects, that identify the destination network. In this example, the destination is 'sanjose-network'    which is behind peer (FTD\_BGL\_973).   After configuring routing settings on one device, you must configure similar settings on its peer. |

---

##### Edit an Existing Security Cloud Control Site-To-Site VPN

The advanced configuration wizard is used by default to modify an existing site-to-site VPN configuration.

###### Procedure

---

| **Step 1** | In the left pane, choose Secure Connections > Site to Site VPN. |
| --- | --- |
| **Step 2** | Select the desired site-to-site VPN tunnel that you want to edit. |
| **Step 3** | In the Actions pane, click Edit.   | **Note** | Alternatively, you can perform the following to edit the configuration:   1. Open the VPN page and click Global View button in the filter panel (for more information, see [Global View](#Search_and_Filter_SitetoSite_VPN_Tunnels)).  The illustration of all site-to-site VPN tunnels available across all devices appears.  To edit the configuration, one of the peers must be FDM-managed device. 2. Select a device by clicking the box. 3. Click View details to view its peers. 4. Click the peer device to view the tunnel details.  You can view the tunnel details, NAT information, and key exchange information pertaining to the device. 5. Click Edit in Tunnel Details. | | --- | --- | |
| **Step 4** | In the Peer Devices section, you can modify the following device configurations: Configuration Name, VPN Access Interface, and Protected Networks.   | **Note** | You cannot change the participating devices. | | --- | --- | |
| **Step 5** | In the IKE Settings section, you can modify the following IKEv2 policies configurations:   1. Click the blue plus  button for the respective device and select new IKEv2 policies. To delete an existing IKEv2 Policy, hover-over the selected    policy and click the x icon. 2. Modify the Pre-Shared Key for the participating devices. If the pre-shared keys are different for endpoint devices, click the blue settings  button and enter the appropriate pre-shared keys for the devices. 3. Click Next. |
| **Step 6** | In the IPSec Settings section, you can modify the following IPSec configurations:   1. Click the blue plus  button to select new IKEv2 proposals. To delete an existing IKEv2 Proposal, hover-over the selected proposal and click the    x icon. 2. Choose the Diffie-Hellman Group for Perfect Forward Secrecy. 3. Click Edit VPN, and then Finish. |

---

The Point to point VPN is modified and updated with all the changes you have made.

* [Delete a Security Cloud Control Site-To-Site VPN Tunnel](#Delete_an_Existing_CDO_SiteToSite_VPN)

###### Delete a Security Cloud Control Site-To-Site VPN Tunnel

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select the desired site-to-site VPN tunnel that you want to delete. |
| **Step 3** | In the Actions pane on the right, click Delete. |

---

The selected site-to-site VPN tunnel is deleted.

##### Exempt Site-to-Site VPN Traffic from NAT

When you have a site-to-site VPN connection defined on an interface, and you also have NAT rules for that interface, you can
optionally exempt the traffic on the VPN from the NAT rules. You might want to do this if the remote end of the VPN connection
can handle your internal addresses.

When you create the VPN connection, you can select the NAT Exempt option to create the rules automatically. However, this works only if your local protected network is connected through a
single routed interface (not a bridge group member). If instead, the local networks in the connection reside behind two or
more routed interfaces or one or more bridge group members, you need to configure the NAT exempt rules manually.

To exempt VPN traffic from NAT rules, you create an identity manual NAT rule for the local traffic when the destination is
the remote network. Then, apply NAT to the traffic when the destination is anything else (for example, the Internet). If you
have more than one interface for the local network, create rules for each interface. Also, consider the following suggestions:

* If there is more than one local network in the connection, create a network object group to hold the objects that define the
  networks.
* If you are including both IPv4 and IPv6 networks in the VPN, create separate identity NAT rules for each.

Consider the following example, which shows a site-to-site tunnel connecting the Boulder and San Jose offices. For traffic
that you want to go to the Internet (for example from 10.1.1.6 in Boulder to www.example.com), you need a public IP address
provided by NAT to access the Internet. The below example uses interface Port Address Translation (PAT) rules. However, for
traffic that you want to go over the VPN tunnel (for example from 10.1.1.6 in Boulder to 10.2.2.78 in San Jose), you do not
want to perform NAT; you need to exempt that traffic by creating an identity NAT rule. Identity NAT translates an address
to the same address.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457545.jpg)

The following example explains the configuration for Firewall1 (Boulder). The example assumes that the inside interface is
a bridge group, so you need to write the rules for each member interface. The process is the same if you have a single or
multiple routed inside interfaces.

| **Note** | ---   This example assumes IPv4 only. If the VPN also includes IPv6 networks, create parallel rules for IPv6. Note that you cannot implement IPv6 interface PAT, so you need to create a host object with a unique IPv6 address to use for PAT.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Create objects to define the various networks.   1. In the left pane, click Objects. 2. Click the blue plus button  to create an object. 3. Click FTD > Network. 4. Identify the Boulder inside network. 5. Enter an object name (for example, boulder-network). 6. Select Create a network object. 7. In the Value section:     * Select eq and enter a single IP address or a subnet address expressed in CIDR notation.    * Select range and enter an IP address range. For example, enter the network address as 10.1.1.0/24. 8. Click Add. 9. Click the blue plus button  to create an object. 10. Define the inside San Jose network. 11. Enter the object name (for example, san-jose). 12. Select Create a network object. 13. In the Value section:      * Select eq and enter a single IP address or a subnet address expressed in CIDR notation.     * Select range and enter an IP address range. For example, enter the network address as 10.1.1.0/24. 14. Click Add. |
| --- | --- |
| **Step 2** | Configure manual identity NAT for the Boulder network when going over the VPN to San Jose on Firewall1 (Boulder).   1. In the left pane, click Security Devices > All Devices. 2. Use the filter to find the device for which you want to create the    NAT rule. 3. In the Management area of the details panel, click NAT . 4. Click  > Twice NAT.     * In section 1, select Static. Click Continue.    * In section 2, select Source Interface = inside and Destination Interface = outside. Click Continue.    * In section 3, select Source Original Address = 'boulder-network' and Source Translated Address = 'boulder-network'.    * Select Use Destination.    * Select Destination Original Address = 'sanjose-network' and Source Translated Address = 'sanjose-network'. Note: Because you do not want to translate the destination address, you need to configure identity NAT for it by specifying the      same address for the original and translated destination addresses. Leave all of the port fields blank. This rule configures      identity NAT for both source and destination.    * Select Disable proxy ARP for incoming packets.    * Click Save.    * Repeat the process to create equivalent rules for each of the other inside interfaces. |
| **Step 3** | Configure manual dynamic interface PAT when going to the Internet for the inside Boulder network on Firewall1 (Boulder). Note: There might already be dynamic interface PAT rules for the inside interfaces, covering any IPv4 traffic, as these are created by default during initial configuration. However, the configuration is shown here for completeness. Before completing these steps, check whether a rule already exists that covers the inside interface and network, and skip this step if it does.   1. Click  > Twice NAT. 2. In section 1, select Dynamic. Click Continue. 3. In section 2, select Source Interface = inside and Destination Interface = outside. Click Continue. 4. In section 3, select Source Original Address = 'boulder-network' and Source Translated Address = 'interface'. 5. Click Save. 6. Repeat the process to create equivalent rules for each of the other inside interfaces. |
| **Step 4** | Deploy configuration changes to Security Cloud Control. For more information, see [Deploy Configuration Changes from Cisco Security Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD). |
| **Step 5** | If you are also managing Firewall2 (San Jose), you can configure similar rules for that device.   * The manual identity NAT rule would be for 'sanjose-network' when the destination is boulder-network. Create new interface   objects for the Firewall2 inside and outside networks. * The manual dynamic interface PAT rule would be for 'sanjose-network' when the destination is "any." |

---

#### About Global IKE Policies

Internet Key Exchange (IKE) is a key management protocol that is used to authenticate IPsec peers, negotiate and distribute
IPsec encryption keys, and automatically establish IPsec security associations (SAs).

The IKE negotiation comprises two phases. Phase 1 negotiates a security association between two IKE peers, which enables the
peers to communicate securely in Phase 2. During Phase 2 negotiation, IKE establishes SAs for other applications, such as
IPsec. Both phases use proposals when they negotiate a connection. An IKE proposal is a set of algorithms that two peers use
to secure the negotiation between them. IKE negotiation begins by each peer agreeing on a common (shared) IKE policy. This
policy states which security parameters are used to protect subsequent IKE negotiations.

IKE policy objects define the IKE proposals for these negotiations. The objects that you enable are the ones used when the
peers negotiate a VPN connection: you cannot specify different IKE policies per connection. The relative priority of each
object determines which of these policies are tried first, with the lower number being a higher priority. The connection is
not established if the negotiation fails to find a policy that both peers can support.

To define the global IKE policy, you select which objects to enable for each IKE version. If the pre-defined objects do not
satisfy your requirements, create new policies to enforce your security policy.

The following procedure explains how to configure the global policy through the Objects page. You can also enable, disable,
and create policies when editing a VPN connection by clicking Edit for the IKE Policy settings.

The following topics explain how to configure IKE policies for each version:

* [Configuring IKEv1 Policies](#Managing_FTD_IKEv1_Policies)
* [Configuring IKEv2 Policies](#Managing_FTD_IKEv2_Policies)

##### Managing IKEv1 Policies

###### About IKEv1 Policy

Internet Key Exchange (IKE) version 1 policy objects contain the parameters required for IKEv1 policies when defining VPN
connections. IKE is a key management protocol that facilitates the management of IPsec-based communications. It is used to
authenticate IPsec peers, negotiate and distribute IPsec encryption keys, and automatically establish IPsec security associations
(SAs).

There are several pre-defined IKEv1 policies. If any suit your needs, simply enable them by clicking the State toggle. You
can also create new policies to implement other combinations of security settings. You cannot edit or delete system-defined
objects.

##### Create an IKEv1 Policy

Internet Key Exchange (IKE) version 1 policy objects contain the parameters required for IKEv1 policies when defining VPN
connections. IKE is a key management protocol that facilitates the management of IPsec-based communications. It is used to
authenticate IPsec peers, negotiate and distribute IPsec encryption keys, and automatically establish IPsec security associations
(SAs).

There are several pre-defined IKEv1 policies. If any suit your needs, simply enable them by clicking the State toggle. You
can also create new policies to implement other combinations of security settings. You cannot edit or delete system-defined
objects.

The following procedure explains how you can create and edit objects directly through the Objects page. You can also create
an IKEv1 policy while editing the IKE settings in a Site-to-Site VPN connection by clicking the Create New IKEv1 Policy link shown in the object list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click the blue plus button  and select FDM > IKEv1 Policy to create a new IKEv1 policy. * In the object page, select the IKEv1 policy you want to edit and click Edit in the Actions pane at the right. |
| **Step 3** | Enter an object name, up to 128 characters. |
| **Step 4** | Configure the IKEv1 properties.   * Priority - The relative priority of the IKE policy, from 1 to 65,535. The priority determines the order of the IKE policy compared   by the two negotiating peers when attempting to find a common security association (SA). If the remote IPsec peer does not   support the parameters selected in your highest priority policy, it tries to use the parameters defined in the next lowest   priority. The lower the number, the higher the priority. * Encryption - The encryption algorithm used to establish the Phase 1 security association (SA) for protecting Phase 2 negotiations. For   an explanation of the options, see Deciding Which Encryption Algorithm to Use. * Diffie-Hellman Group - The Diffie-Hellman group to use for deriving a shared secret between the two IPsec peers without transmitting it to each   other. A larger modulus provides higher security but requires more processing time. The two peers must have a matching modulus   group. For an explanation of the options, see Deciding Which Diffie-Hellman Modulus Group to Use. * Lifetime - The lifetime of the security association (SA), in seconds, from 120 to 2147483647 or blank. When the lifetime is exceeded,   the SA expires and must be renegotiated between the two peers. As a general rule, the shorter the lifetime (up to a point),   the more secure your IKE negotiations will be. However, with longer lifetimes, future IPsec security associations can be set   up more quickly than with shorter lifetimes. The default is 86400. To specify an unlimited lifetime, enter no value (leave   the field blank). * Authentication - The method of authentication to use between the two peers. For more information, see [Deciding Which Authentication Method to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__Authenticationmethod).    + Preshared Key - Use the preshared key that is defined on each device. These keys allow for a secret key to be shared between two peers     and to be used by IKE during the authentication phase. If the peer is not configured with the same preshared key, the IKE     SA cannot be established.   + Certificate - Use the device identity certificates for the peers to identify each other. You must obtain these certificates by enrolling     each peer in a Certificate Authority. You must also upload the trusted CA root and intermediate CA certificates used to sign     the identity certificates in each peer. The peers can be enrolled in the same or a different CA. You cannot use self-signed     certificates for either peer. * Hash - The hash algorithm for creating a message digest, which is used to ensure message integrity. For an explanation of the   options, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__Diffie-Hellman). |
| **Step 5** | Click Add. |

---

##### Managing IKEv2 Policies

###### About IKEv2 Policy

Internet Key Exchange (IKE) version 2 policy objects contain the parameters required for IKEv2 policies when defining VPN
connections. IKE is a key management protocol that facilitates the management of IPsec-based communications. It is used to
authenticate IPsec peers, negotiate and distribute IPsec encryption keys, and automatically establish IPsec security associations
(SAs).

There are several pre-defined IKEv2 policies. If any suit your needs, simply enable them by clicking the State toggle. You
can also create new policies to implement other combinations of security settings. You cannot edit or delete system-defined
objects.

##### Create an IKEv2 Policy

Internet Key Exchange (IKE) version 2 policy objects contain the parameters required for IKEv2 policies when defining VPN
connections. IKE is a key management protocol that facilitates the management of IPsec-based communications. It is used to
authenticate IPsec peers, negotiate and distribute IPsec encryption keys, and automatically establish IPsec security associations
(SAs).

There are several pre-defined IKEv2 policies. If any suit your needs, simply enable them by clicking the State toggle. You
can also create new policies to implement other combinations of security settings. You cannot edit or delete system-defined
objects.

The following procedure explains how you can create and edit objects directly through the Objects page. You can also create
an IKEv2 policy while editing the IKE settings in a Site-to-Site VPN connection by clicking the Create New IKEv2 Policy link shown in the object list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click the blue plus button  and select FDM > IKEv2 Policy to create a new IKEv2 policy. * In the object page, select the IKEv2 policy you want to edit and click Edit in the Actions pane at the right. |
| **Step 3** | Enter an object name, up to 128 characters. |
| **Step 4** | Configure the IKEv2 properties.   * Priority - The relative priority of the IKE policy, from 1 to 65,535. The priority determines the order of the IKE policy compared   by the two negotiating peers when attempting to find a common security association (SA). If the remote IPsec peer does not   support the parameters selected in your highest priority policy, it tries to use the parameters defined in the next lowest   priority. The lower the number, the higher the priority. * State - Whether the IKE policy is enabled or disabled. Click the toggle to change the state. Only enabled policies are used during   IKE negotiations. * Encryption - The encryption algorithm used to establish the Phase 1 security association (SA) for protecting Phase 2 negotiations. Select   all algorithms that you want to allow, although you cannot include both mixed-mode (AES-GCM) and normal mode options in the   same policy. (Normal mode requires that you select an integrity hash, whereas mixed-mode prohibits a separate integrity hash   selection.) The system negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed   upon. For an explanation of the options, see [Deciding Which Encryption Algorithm to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__EncryptionAlgorithm). * Diffie-Hellman Group - The Diffie-Hellman group to use for deriving a shared secret between the two IPsec peers without transmitting it to each   other. A larger modulus provides higher security but requires more processing time. The two peers must have a matching modulus   group. Select all the algorithms that you want to allow. The system negotiates with the peer, starting from the strongest   to the weakest group until a match is agreed upon. For an explanation of the options, see [Deciding Which Diffie-Hellman Modulus Group to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__Diffie-Hellman). * Integrity Hash - The integrity portion of the hash algorithm for creating a message digest, which is used to ensure message integrity. Select   all the algorithms that you want to allow. The system negotiates with the peer, starting from the strongest to the weakest   algorithm until a match is agreed upon. The integrity hash is not used with the AES-GCM encryption options. For an explanation   of the options, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__HashAlgorithms). * Pseudo-Random Function (PRF) Hash - The pseudo-random function (PRF) portion of the hash algorithm, which is used as the algorithm to derive keying material   and hashing operations required for the IKEv2 tunnel encryption. In IKEv1, the Integrity and PRF algorithms are not separated,   but in IKEv2, you can specify different algorithms for these elements. Select all the algorithms that you want to allow. The   system negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed upon. For an   explanation of the options, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__HashAlgorithms). * Lifetime - The lifetime of the security association (SA), in seconds, from 120 to 2147483647 or blank. When the lifetime is exceeded,   the SA expires and must be renegotiated between the two peers. As a general rule, the shorter the lifetime (up to a point),   the more secure your IKE negotiations will be. However, with longer lifetimes, future IPsec security associations can be set   up more quickly than with shorter lifetimes. The default is 86400. To specify an unlimited lifetime, enter no value (leave   the field blank). |
| **Step 5** | Click Add. |

---

#### About IPsec Proposals

IPsec is one of the most secure methods for setting up a VPN. IPsec provides data encryption at the IP packet level, offering
a robust security solution that is standards-based. With IPsec, data is transmitted over a public network through tunnels.
A tunnel is a secure, logical communication path between two peers. Traffic that enters an IPsec tunnel is secured by a combination
of security protocols and algorithms called a transform set. During the IPsec security association (SA) negotiation, peers
search for a transform set that is the same at both peers.

There are separate IPsec proposal objects based on the IKE version, IKEv1, or IKEv2:

* When you create an IKEv1 IPsec proposal, you select the mode in which IPsec operates, and define the required encryption and
  authentication types. You can select single options for the algorithms. If you want to support multiple combinations in a
  VPN, create and select multiple IKEv1 IPsec Proposal objects.
* When you create an IKEv2 IPsec proposal, you can select all of the encryption and hash algorithms allowed in a VPN. The system
  orders the settings from the most secure to the least secure and negotiates with the peer until a match is found. This allows
  you to potentially send a single proposal to convey all the allowed combinations instead of the need to send each allowed
  combination individually as with IKEv1.

The Encapsulating Security Protocol (ESP) is used for both IKEv1 and IKEv2 IPsec proposals. It provides authentication, encryption,
and antireplay services. ESP is IP protocol type 50.

| **Note** | ---   We recommend using both encryption and authentication on IPsec tunnels.   --- |
| --- | --- |

The following topics explain how to configure IPsec proposals for each IKE version:

* [Create and Edit IKEv1 IPsec Proposal Object](#Managing_an_FTD_IKEv1_IPsec_Proposal_Object)
* [Create and Edit IKEv2 IPsec Proposal Object](#Managing_an_FTD_IKEv2_IPsec_Proposal_Object)

##### Managing an IKEv1 IPsec Proposal Object

IPsec Proposal objects configure the IPsec proposal used during IKE Phase 2 negotiations. The IPsec proposal defines the combination
of security protocols and algorithms that secure traffic in an IPsec tunnel. There are separate objects for IKEv1 and IKEv2.
Currently, Security Cloud Control supports IKEv1 IPsec proposal objects.

The Encapsulating Security Protocol (ESP) is used for both IKEv1 and IKEv2 IPsec proposals. It provides authentication, encryption,
and anti-replay services. ESP is IP protocol type 50.

| **Note** | ---   We recommend using both encryption and authentication on IPsec tunnels.   --- |
| --- | --- |

###### Create an IKEv1 IPsec Proposal Object

IPsec Proposal objects configure the IPsec proposal used during IKE Phase 2 negotiations. The IPsec proposal defines the combination
of security protocols and algorithms that secure traffic in an IPsec tunnel. There are separate objects for IKEv1 and IKEv2.
Currently,Security Cloud Control supports IKEv1 IPsec proposal objects.

The Encapsulating Security Protocol (ESP) is used for both IKEv1 and IKEv2 IPsec proposals. It provides authentication, encryption,
and anti-replay services. ESP is IP protocol type 50.

| **Note** | ---   We recommend using both encryption and authentication on IPsec tunnels.   --- |
| --- | --- |

There are several pre-defined IKEv1 IPsec proposals. You can also create new proposals to implement other combinations of
security settings. You cannot edit or delete system-defined objects.

The following procedure explains how you can create and edit objects directly through the Objects page. You can also create
IKEv1 IPsec Proposals objects while editing the IKEv1 IPsec settings in a Site-to-Site VPN connection by clicking the Create New IKEv1 Proposal link shown in the object list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click the blue plus button  and select FDM > IKEv1 IPsec Proposal to create the new object. * In the object page, select the IPsec proposal you want to edit and click Edit in the Actions pane at the right. |
| **Step 3** | Enter an object name for the new object. |
| **Step 4** | Select the Mode in which the IKEv1 IPsec Proposal object operates.   * Tunnel mode encapsulates the entire IP packet. The IPSec header is added between the original IP header and a new IP header. This is   the default. Use tunnel mode when the firewall is protecting traffic to and from hosts positioned behind the firewall. Tunnel   mode is the normal way regular IPSec is implemented between two firewalls (or other security gateways) that are connected   over an untrusted network, such as the Internet. * Transport mode encapsulates only the upper-layer protocols of an IP packet. The IPSec header is inserted between the IP header and the upper-layer   protocol header (such as TCP). Transport mode requires that both the source and destination hosts support IPSec, and can only   be used when the destination peer of the tunnel is the final destination of the IP packet. Transport mode is generally used   only when protecting a Layer 2 or Layer 3 tunneling protocol such as GRE, L2TP, and DLSW. |
| **Step 5** | Select the ESP Encryption (Encapsulating Security Protocol encryption) algorithm for this proposal. For more information, see [Deciding Which Encryption Algorithm to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__EncryptionAlgorithm). |
| **Step 6** | Select the ESP Hash or integrity algorithm to use for authentication. For more information, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__HashAlgorithms). |
| **Step 7** | Click Add. |

---

##### Managing an IKEv2 IPsec Proposal Object

IPsec Proposal objects configure the IPsec proposal used during IKE Phase 2 negotiations. The IPsec proposal defines the combination
of security protocols and algorithms that secure traffic in an IPsec tunnel.

When you create an IKEv2 IPsec proposal, you can select all of the encryption and hash algorithms allowed in a VPN. The system
orders the settings from the most secure to the least secure and negotiates with the peer until a match is found. This allows
you to potentially send a single proposal to convey all the allowed combinations instead of the need to send each allowed
combination individually as with IKEv1.

###### Create or Edit an IKEv2 IPsec Proposal Object

There are several pre-defined IKEv2 IPsec proposals. You can also create new proposals to implement other combinations of
security settings. You cannot edit or delete system-defined objects.

The following procedure explains how you can create and edit objects directly through the Objects page. You can also create
IKEv2 IPsec Proposals objects while editing the IKEv2 IPsec settings in a VPN connection by clicking the Create New IPsec
Proposal link shown in the object list.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Do one of these things:   * Click the blue plus button  and select FDM > IKEv2 IPsec Proposal to create the new object. * In the object page, select the IPsec proposal you want to edit and click Edit in the Actions pane at the right. |
| **Step 3** | Enter an object name for the new object. |
| **Step 4** | Configure the IKE2 IPsec proposal objects:   * Encryption - The Encapsulating Security Protocol (ESP) encryption algorithm for this proposal. Select all the algorithms that you want   to allow. The system negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed   upon. For an explanation of the options, see [Deciding Which Encryption Algorithm to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__EncryptionAlgorithm). * Integrity Hash - The hash or integrity algorithm to use for authentication. Select all the algorithms that you want to allow. The system   negotiates with the peer, starting from the strongest to the weakest algorithm until a match is agreed upon. For an explanation   of the options, see [Deciding Which Hash Algorithms to Use](#Encryption_and_Hash_Algorithms_Used_in_VPN__HashAlgorithms). |
| **Step 5** | Click Add. |

---

#### Monitor FDM-Managed Device Site-to-Site Virtual Private Networks

Security Cloud Control allows you to monitor, modify, and delete existing or newly created site-to-site VPN configurations on onboarded FDM-managed devices.

* [Check Site-to-Site VPN Tunnel Connectivity](#Check_SitetoSite_VPN_Tunnel_Connectivity)
* [Site-To-Site VPN Dashboard](#virtual-private-network-dashboard)
* [Identify VPN Issues](#Identify_VPN_Issues)
* [Search and Filter Site-to-Site VPN Tunnels](#Search_and_Filter_SitetoSite_VPN_Tunnels)
* [Onboard an Unmanaged Site-to-Site VPN Peer](#Onboard_an_Unmanaged_VPN_Peer)
* [View IKE Object Details of Site-To-Site VPN Tunnels](#View_IKE_Object_Details_of_SiteToSite_VPN_Tunnels)
* [View Last Successful Site-to-Site VPN Tunnel Establishment Date](#View_Last_Successful_SitetoSite_VPN_Tunnel_Establishment_Date)
* [View Site-to-Site VPN Tunnel Information](#SitetoSite_VPN_Table_View)

##### Check Site-to-Site VPN Tunnel Connectivity

Use the Check Connectivity button to trigger a real-time connectivity check against the tunnel to identify whether the tunnel is currently [active or idle](#Search_and_Filter_SitetoSite_VPN_Tunnels). Unless you click the on-demand connectivity check button, a check across all tunnels, available across all onboarded devices,
occurs once an hour.

| **Note** | ---  * Security Cloud Control runs this connectivity check command on the FTD to determine if a tunnel is active or idle:   ```   show vpn-sessiondb l2l sort ipaddress   ``` * Model ASA device(s) tunnels will always show as Idle.  --- |
| --- | --- |

To check tunnel connectivity from the VPN page:

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN. |
| --- | --- |
| **Step 2** | [Search and filter](#Search_and_Filter_SitetoSite_VPN_Tunnels) the list of tunnels for your site-to-site VPN tunnel and select it. |
| **Step 3** | In the Actions pane at the right, click Check Connectivity. |

---

##### Site-To-Site VPN Dashboard

Security Cloud Control provides a consolidated information about site-to-site VPN connections created in the tenant.

In the left pane, click Secure Connections > Site to Site VPN. The **Site-to-Site VPN** provides the information in the following widgets:

* **Sessions & Insights**: Displays a bar graph representing Active VPN Tunnels and Idle VPN Tunnels, each in appropriate colors.
* **Issues**: Shows the total number of tunnels detected with issues.
* **Pending Deploy**: Shows the total number of tunnels with pending deployment.

By clicking on a value in the pie chart or any link in the widget, the site-to-site VPN listing page is displayed with a filter
based on the selected value. For instance, in the **VPN Tunnel Status** widget, on clicking the **Active VPN Tunnels**, you will be directed to the site-to-site VPN listing page with the **Active** status filter applied, showing only the active tunnels.

##### Identify VPN Issues

Security Cloud Control can identify VPN issues on FTD. (This feature is not yet available for AWS VPC site-to-site VPN tunnels.) This article describes:

* [Find VPN Tunnels with Missing Peers](#Find_VPN_Tunnels_with_Missing_Peers)
* [Find VPN Peers with Encryption Key Issues](#FindVPN_Peers_with_Encryption_Key_Issues)
* [Find Incomplete or Misconfigured Access Lists Defined for a Tunnel](#Find_Incomplete_or_MisconfiguredAccess_Lists_Defined_for_a_Tunnel)
* [Find Issues in Tunnel Configuration](#Find_Issues_in_Tunnel_Configuration)

  [Resolve Tunnel Configuration Issues](#Cisco_Task.dita_7ec52168-e8ac-4115-a850-9c9fa9f4b673)

* [Find VPN Tunnels with Missing Peers](#Find_VPN_Tunnels_with_Missing_Peers)
* [Find VPN Peers with Encryption Key Issues](#FindVPN_Peers_with_Encryption_Key_Issues)
* [Find Incomplete or Misconfigured Access Lists Defined for a Tunnel](#Find_Incomplete_or_MisconfiguredAccess_Lists_Defined_for_a_Tunnel)
* [Find Issues in Tunnel Configuration](#Find_Issues_in_Tunnel_Configuration)
* [Resolve Tunnel Configuration Issues](#Cisco_Task.dita_7ec52168-e8ac-4115-a850-9c9fa9f4b673)

###### Find VPN Tunnels with Missing Peers

The "Missing IP Peer" condition is more likely to occur on ASA devices than FDM-managed devices.

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select Table View. |
| **Step 3** | Open the Filter panel by clicking the filter icon . |
| **Step 4** | Check Detected Issues. |
| **Step 5** | Select each device reporting an issue  and look in the Peers pane at the right. One peer name will be listed. Security Cloud Control reports the other peer name as, "[Missing peer IP.]" |

---

###### Find VPN Peers with Encryption Key Issues

Use this approach to locate VPN Peers with encryption key issues such as:

* IKEv1 or IKEv2 keys are invalid, missing, or mismatched
* Obsolete or low encryption tunnels

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select Table View. |
| **Step 3** | Open the Filter panel by clicking the filter icon . |
| **Step 4** | Select each device reporting an issue  and look in the Peers pane at the right. The peer information will show you both peers. |
| **Step 5** | Click on View Peers for one of the devices. |
| **Step 6** | Double-click the device reporting the issue in the Diagram View. |
| **Step 7** | Click Key Exchange in the Tunnel Details panel at the bottom. You will be able to view both devices and diagnose the key issue from that point. |

---

###### Find Incomplete or Misconfigured Access Lists Defined for a Tunnel

The "incomplete or misconfigured access-list" condition could only occur on ASA devices.

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select Table View. |
| **Step 3** | Open the Filter panel by clicking the filter icon . |
| **Step 4** | Select each device reporting an issue  and look in the Peers pane at the right. The peer information shows you both peers. |
| **Step 5** | Click on View Peers for one of the devices. |
| **Step 6** | Double-click the device reporting the issue in the Diagram View. |
| **Step 7** | Click **Tunnel Details** in the Tunnel Details panel at the bottom. You will see the message, "Network Policy: Incomplete" |

---

###### Find Issues in Tunnel Configuration

The tunnel configuration error can occur in the following scenarios:

* When the IP address of a site-to-site VPN interface changes, the "Peer IP Address Value has changed".
* When the IKE value of a VPN tunnel doesn't match the other VPN tunnel, the "IKE value Mismatch" message appears.

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select Table View. |
| **Step 3** | Open the Filter panel by clicking the filter icon . |
| **Step 4** | In the Tunnel Issues, click Detected Issues to view the VPN configuration reporting errors. You can view the configuration reporting issues . |
| **Step 5** | Select the VPN configuration reporting issues. |
| **Step 6** | In the Peers pane on the right, the  icon appears for the peer having the issue. Hover over the  icon to see the issue and resolution.  Next Step: [Resolve Tunnel Configuration Issues](#Cisco_Task.dita_7ec52168-e8ac-4115-a850-9c9fa9f4b673). |

---

###### Resolve Tunnel Configuration Issues

This procedure attempts to resolve these tunnel configuration issues:

* When the IP address of a site-to-site VPN interface changes, the "Peer IP Address Value has changed".
* When the IKE value of a VPN tunnel doesn’t match the other VPN tunnel, the "IKE value Mismatch" message appears.

See [Find Issues in Tunnel Configuration](#Find_Issues_in_Tunnel_Configuration) for more information.

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab and select the device associated with the VPN configuration reporting an issue. |
| **Step 4** | [Accept the device changes](#ResolveConflict_Detected_Status). |
| **Step 5** | In the left pane, click VPN > ASA/FDM Site-to-Site VPN to open the VPN page. |
| **Step 6** | Select the VPN configuration reporting this issue. |
| **Step 7** | In the Actions pane, click the Edit icon. |
| **Step 8** | Click Next in each step until you click the Finish button in step 4. |
| **Step 9** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

##### Search and Filter Site-to-Site VPN Tunnels

Use the filter sidebar ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453412.jpg) in combination with the search field to focus your search of VPN tunnels presented in the VPN tunnel diagram.

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Click the filter icon  to open the filter pane. |
| **Step 3** | Use these filters to refine your search:   * Filter by Device-Click Filter by Device, select the device type tab, and check the devices you want to find by filtering. * Tunnel Issues-Whether or not we have detected either side of the tunnel has issues. Some examples of a device having issues may be but not   limited to is: missing associated interface or peer IP address or access list, IKEv1 proposal mismatches, etc. (Detecting   tunnel issues is not yet available for AWS VPC VPN tunnels.) * Devices/Services-Filter by type of device. * Status–Tunnel status can be active or idle.    + Active-There is an open session where network packets are traversing the VPN tunnel or a successful session was established and     hasn’t been timed-out yet. Active can assist to indicate that tunnel is active and relevant.   + Idle - Security Cloud Control is unable to discover an open session for this tunnel. The tunnel may either be not in use or there is an issue with this     tunnel. * Onboarded - Devices could be managed by Security Cloud Control or not managed (unmanaged) by Security Cloud Control.    + Managed – Filter by devices that Security Cloud Control manages.   + Unmanaged – Filter by devices that Security Cloud Control does not manage. * Device Types - Whether or not either side of the tunnel is a live (connected device) or model device. |
| **Step 4** | You can also search the filtered results by device name or IP address by entering that information in the search bar. The search is case-insensitive. |

---

##### Onboard an Unmanaged Site-to-Site VPN Peer

Security Cloud Control will discover a site-to-site VPN tunnel when one of the peers is onboarded. If the second peer is not managed by Security Cloud Control, you can filter the list of VPN tunnels to find the unmanaged device and onboard it:

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select Table View. |
| **Step 3** | Open the filter panel by clicking . |
| **Step 4** | Check Unmanaged. |
| **Step 5** | Select a tunnel from the table from the results. |
| **Step 6** | In the Peers pane on the right, click Onboard Device and follow the instructions on the screen. |

---

**Related Information:**

* [Onboard Devices and Services](onboard-devices-and-services.html#Cisco_Generic_Topic.dita_8b6c26fa-03b9-413f-af92-3bbe687c30e4)
* [Onboard a Threat Defense Device](onboard-devices-and-services.html#Onboarding_an_FTD_to_CDO)

##### View IKE Object Details of Site-To-Site VPN Tunnels

You can view the details of the IKE objects configured on the peers/devices of the selected tunnel. These details appear in
a tree structure in a hierarchy based on the priority of the IKE policy object.

| **Note** | ---   Extranet devices don't show the IKE Objects details.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | In the VPN Tunnels page, click the name of the VPN tunnel that connects the peers. |
| **Step 3** | Under Relationships on the right, expand the object that you want to see its details. |

---

##### View Last Successful Site-to-Site VPN Tunnel Establishment Date

###### Procedure

---

| **Step 1** | [View IPsec Site-to-Site Virtual Private Network Tunnel Information](#SitetoSite_VPN_Table_View). |
| --- | --- |
| **Step 2** | Click the Tunnel Details pane. |
| **Step 3** | View the Last Seen Active field. |

---

##### View Site-to-Site VPN Tunnel Information

The site-to-site VPN table view is a complete listing of all site-to-site VPN tunnels available across all devices onboarded
to Security Cloud Control. A tunnel only exists once in this list. Clicking on a tunnel listed in the table provides an option in the right side bar
to navigate directly to a tunnel's peers for further investigation.

In cases where Security Cloud Control does not manage both sides of a tunnel, you can click [Onboard Device](#Onboard_an_Unmanaged_VPN_Peer) to open the main onboarding page an onboard the unmanaged peer. In cases where Security Cloud Control manages both side of a tunnel, the Peer 2 column contains the name of the managed device. However, in the case of an AWS
VPC, the Peer 2 column contains the IP address of the VPN gateway.

To view site-to-site VPN connections in the table view:

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Click the Table view button. |
| **Step 3** | Use [Search and Filter Site-to-Site VPN Tunnels](#Search_and_Filter_SitetoSite_VPN_Tunnels) to find a specific tunnel, or zoom into the Global View graphic to find the VPN gateway and its peers that you are looking for. |

---

* [Site-to-Site VPN Global View](#SitetoSite_VPN_Global_View)
* [Site-to-Site VPN Tunnels Pane](#Tunnels_Pane)

###### Site-to-Site VPN Global View

This is an example fo the global view. In the illustration, 'FTD\_BGL\_972' has a site-to-site connection with FTD\_BGL\_973 and
FTD\_BGL\_974 devices. ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453189.jpg)

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN. |
| --- | --- |
| **Step 2** | Click the Global view button. |
| **Step 3** | Use [Search and Filter Site-to-Site VPN Tunnels](#Search_and_Filter_SitetoSite_VPN_Tunnels) to find a specific tunnel, or zoom into the Global View graphic to find the VPN gateway and its peers that you are looking for. |
| **Step 4** | Select one of the peers represented in the Global View. |
| **Step 5** | Click View Details. |
| **Step 6** | Click the other end of the VPN tunnel and Security Cloud Control displays Tunnel Details, NAT Information, and Key Exchange information for that connection:   * **Tunnel Details**-Displays the name and connectivity information about the tunnel. Clicking the Refresh icon updates the connectivity information   for the tunnels. * **Tunnel Details specific to AWS connections**-Tunnel details for AWS site-to-site connections are slightly different than for other connections. For each connection from   the AWS VPC to your VPN gateway, AWS creates two VPN tunnels. This is for high availability.    + The name of the tunnel represents the name of the VPC your VPN gateway is connected to. The IP address named in the tunnel     is the IP address that your VPN gateway knows as the VPC.   + If the Security Cloud Control Connectivity status shows **active**, the AWS tunnel state is **Up**. If the Security Cloud Control Connectivity state is **inactive**, the AWS tunnel state is **Down**. * NAT Information-Displays the type of NAT rule being used, original and translated packet information, and provides links to the NAT table   to view the NAT rule for that tunnel. (Not yet available for AWS VPC site-to-site VPN.) * Key Exchange-Displays the cryptographic keys in use by the tunnel and key-exchange issues. (Not yet available for AWS VPC site-to-site   VPN.) |

---

###### Site-to-Site VPN Tunnels Pane

The Tunnels pane displays a list of all the tunnels associated with a particular VPN gateway. For site-to-site VPN connections
between your VPN gateway and an AWS VPC, the tunnels pane shows all the tunnels from your VPN gateway to the VPC. Since each
site-to-site VPN connection between your VPN gateway and an AWS VPC has two tunnels, you will see double the number of tunnels
you normally would for other devices.

###### VPN Gateway Details

Displays the number of peers connected to the VPN gateway and the IP address of the VPN gateway. This is only visible in the
VPN Tunnels page.

###### View Peer

After you select a site-to-site VPN peer pair, the peers pane lists the two devices in the pair and allows you to click View Peer for one of the devices. By clicking View Peer, you see any other site-to-site peer that device is associated with. This is visible in the Table view and in the Global
view.

#### Delete a Security Cloud Control Site-To-Site VPN Tunnel

##### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Site to Site VPN to open the VPN page. |
| --- | --- |
| **Step 2** | Select the desired site-to-site VPN tunnel that you want to delete. |
| **Step 3** | In the Actions pane on the right, click Delete. |

---

The selected site-to-site VPN tunnel is deleted.

### Introduction to Remote Access Virtual Private Network

Remote Access virtual Private Network (RA VPN) capability enables users to connect to your network from a location outside
the physical office premises. This means that they can use a computer or a supported iOS/Android device that is connected
to the internet and access your network resources securely. This feature is particularly useful for mobile workers who need
to connect from their home network or a public Wi-Fi network while ensuring that their data remains safe and protected.

* [Introduction to Remote Access Virtual Private Network](#Related_Topics)
* [Configuring Remote Access VPN for an FDM-Managed Device](#Configuring_Remote_Access_VPN_for_an_FTD)
* [Monitor Remote Access Virtual Private Network Sessions](#Monitoring_Remote_Access_Virtual_Private_Network)

**Related Information:**

* [Configuring Remote Access VPN for an FTD](#Configuring_Remote_Access_VPN_for_an_FTD)

#### Introduction to Remote Access Virtual Private Network

Remote Access virtual Private Network (RA VPN) capability enables users to connect to your network from a location outside
the physical office premises. This means that they can use a computer or a supported iOS/Android device that is connected
to the internet and access your network resources securely. This feature is particularly useful for mobile workers who need
to connect from their home network or a public Wi-Fi network while ensuring that their data remains safe and protected.

**Related Information:**

* [Configuring Remote Access VPN for an FTD](#Configuring_Remote_Access_VPN_for_an_FTD)

##### Configuring Remote Access VPN for an FDM-Managed Device

Security Cloud Control provides an intuitive user interface for configuring a new Remote Access Virtual Private Network (RA VPN). It also allows
you to quickly and easily configure RA VPN connection for multiple FDM-managed devices that are on board in Security Cloud Control. AnyConnect is the only client that is supported on endpoint devices for an RA VPN connectivity to FDM-managed devices.

When the AnyConnect client negotiates an SSL VPN connection with the FDM-managed device, it connects using Transport Layer Security (TLS) or Datagram Transport Layer Security (DTLS). DTLS avoids latency
and bandwidth problems associated with some SSL connections and improves the performance of real-time applications that are
sensitive to packet delays. The client and the FDM-managed device negotiate the TLS/DTLS version to use. DTLS is used if the client supports it.

Security Cloud Control supports the following aspects of RA VPN functionality on FDM-managed devices:

* SSL client-based remote access
* IPv4 and IPv6 addressing
* Shared RA VPN configuration across multiple FDM-managed devices

| **Important** | ---   If an onboarded FDM-managed device (running on software version 6.7 or later) contains RA VPN configuration with SAML server as the authentication source, Security Cloud Control doesn't populate the AAA details in the connection profile as it doesn't manage SAML server objects in the current release. Thus you can't manage such RA VPN configuration from Security Cloud Control. However, Security Cloud Control reads the RA VPN connection profile and associated trusted CA certificate and SAML server objects.   --- |
| --- | --- |

* [Split Tunneling for RA VPN Users (Hair Pinning)](#Split_Tunneling_for_RA_VPN_Users_Hair_Pinning)
* [Control User Permissions and Attributes Using RADIUS and Group Policies](#Control_User_Permissions_and_Attributes_Using_RADIUS_and_Group_Policies)
* [Two-Factor Authentication](#Cisco_Concept.dita_1fffa0ef-389e-455c-9266-fa0b6dc83342)
* [End-to-End Remote Access VPN Configuration Process for an FDM-Managed Device](#Procedure)
* [Guidelines and Limitations of Remote Access VPN for FDM-Managed Device](#Guidelines_and_Limitations_of_Remote_Access_VPN_for_FTD)
* [How Users Can Install the AnyConnect Client Software on FDM-Managed Device](#Procedure)
* [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object)
* [Licensing Requirements for Remote Access VPN](#Licensing_Requirements_for_Remote_Access_VPN)
* [Maximum Concurrent VPN Sessions By Device Model](#Maximum_Concurrent_VPN_Sessions_By_Device_Model)
* [RADIUS Change of Authorization](#RADIUS_Change_of_Authorization)
* [Verify Remote Access VPN Configuration of FDM-Managed Device](#Procedure)
* [View Remote Access VPN Configuration Details of FDM-Managed Device](#View_Remote_Access_VPN_Configuration_Details_of_FTD)

**Related Information:**

* [Control User Permissions and Attributes Using RADIUS and Group Policies](#Control_User_Permissions_and_Attributes_Using_RADIUS_and_Group_Policies)
* [End-to-End Remote Access VPN Configuration Process for an FDM-Managed Device](#Procedure)

  + [Download AnyConnect Client Software Packages](#Download_AnyConnect_Client_Software_Packages)
  + [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.4.0](#Upload_AnyConnect_Software_Packages_to_an_FTD_Version_64)
  + [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.5 or Later](#Upload_AnyConnect_Software_Packages_to_an_FTD_Device_Running_FTD_Version_65_or_Later)
  + [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object)
  + [Configure Identity Sources for FDM-Managed Device](#Configure_Identity_Sources_for_FTD)

    - [Create or Edit an Active Directory Realm Object](#Create_or_Edit_an_FTD_Active_Directory_Realm_Object)
    - [Create or Edit a RADIUS Server Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group)
  + [Create New RA VPN Group Policies](#Procedure)
  + [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration)
  + [Configure an RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile)
  + [Allow Traffic Through the Remote Access VPN](#Allow_Traffic_Through_the_Remote_Access_VPN)
  + [Upgrade AnyConnect Package on an FDM-Managed Device Running Version 6.4.0](#Upgrade_AnyConnect_Package_on_an_FTD_Version_64)
* [Guidelines and Limitations of Remote Access VPN for FDM-Managed Device](#Guidelines_and_Limitations_of_Remote_Access_VPN_for_FTD)
* [How Users Can Install the AnyConnect Client Software on FDM-Managed Device](#Procedure)
* [Licensing Requirements for Remote Access VPN](#Licensing_Requirements_for_Remote_Access_VPN)
* [Maximum Concurrent VPN Sessions By Device Model](#Maximum_Concurrent_VPN_Sessions_By_Device_Model)
* [RADIUS Change of Authorization](#RADIUS_Change_of_Authorization)

  + [Configure Change of Authorization on the FDM-Managed Device](#Configure_Change_of_Authorization_on_the_FTD_Device)
* [Split Tunneling for RA VPN Users (Hair Pinning)](#Split_Tunneling_for_RA_VPN_Users_Hair_Pinning)
* [Verify Remote Access VPN Configuration of FDM-Managed Device](#Procedure)
* [View Remote Access VPN Configuration Details of FDM-Managed Device](#View_Remote_Access_VPN_Configuration_Details_of_FTD)

###### Split Tunneling for RA VPN Users (Hair Pinning)

This article describes the split tunneling for RA VPN.

Typically, in remote access VPN, you might want the VPN users to access the Internet through your device. However, you can
allow your VPN users to access an outside network while they are connected to an RA VPN. This technique is called split tunneling
or hair pinning. The split tunnel allows VPN connectivity to a remote network across a secure tunnel, and it also allows connectivity
to a network outside the VPN tunnel. Split tunneling reduces the network load on the FDM-managed devices and increases the bandwidth on the outside interface.

To configure a split-tunnel list, you must create a Standard Access List or Extended Access List. Follow the instructions
explained in the How to Provide Internet Access on the Outside Interface for Remote Access VPN Users (Hair Pinning) section of Virtual Private Networks (VPN) chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running.

###### Control User Permissions and Attributes Using RADIUS and Group Policies

This article provides information on applying attributes to RA VPN connections from an external RADIUS server or a group
policy.

You can apply user authorization attributes (also called user entitlements or permissions) to RA VPN connections from an external
RADIUS server or from a group policy defined on the FDM-managed device. If the FDM-managed device receives attributes from the external AAA server that conflict with those configured on the group policy, then attributes
from the AAA server always take precedence.

The FDM-managed device applies attributes in the following order:

###### Procedure

---

| **Step 1** | User attributes defined on the external AAA server - The server returns these attributes after successful user authentication or authorization. |
| --- | --- |
| **Step 2** | Group policy configured on the FDM-managed device - If a RADIUS server returns the value of the RADIUS CLASS attribute IETF-Class-25 (OU= group-policy) for the user, the FDM-managed device places the user in the group policy of the same name and enforces any attributes in the group policy that are not returned by the server. |
| **Step 3** | Group policy assigned by the connection profile - The connection profile has the preliminary settings for the connection and includes a default group policy applied to the user before authentication. All users connecting to the FDM-managed device initially belong to this group, which provides any attributes that are missing from the user attributes returned by the AAA server, or the group policy assigned to the user. |

---

FDM-managed devices support RADIUS attributes with vendor ID 3076. If the RADIUS server you use does not have these attributes defined,
you must manually define them. To define an attribute, use the attribute name or number, type, value, and vendor code (3076).

The following topics explain the supported attributes based on whether the values are defined in the RADIUS server, or whether
they are values the system sends to the RADIUS server.

* [Attributes Sent to the RADIUS Server](#Attributes_Sent_to_the_RADIUS_Server)

###### Attributes Sent to the RADIUS Server

RADIUS attributes 146 and 150 are sent from the FDM-managed device to the RADIUS server for authentication and authorization requests. All the following attributes are sent from the
FDM-managed device to the RADIUS server for accounting start, interim-update, and stop requests.

Table 6. Attributes Secure Firewall Threat
Defense Sends to RADIUS

| Attribute | Attribute | Syntax, Type | Single or Multi-valued | Description or Value |
| --- | --- | --- | --- | --- |
| Client Type | 150 | Integer | Single | The type of client this is connecting to the VPN:  2= AnyConnect Client SSL VPN |
| Session Type | 151 | Integer | Single | The type of connection:  1 = AnyConnect Client SSL VPN |
| Tunnel Group Name | 146 | String | Single | The name of the connection profile that was used for establishing the session, as defined on the FDM-managed device. The name can be 1 - 253 characters. |

###### Attributes Received from the RADIUS Server

The following user authorization attributes are sent to the FDM-managed device from the RADIUS server.

| Attribute | Attribute Number | Syntax, Type | Single or Multi-valued | Description or Value |
| --- | --- | --- | --- | --- |
| Access-List-Inbound | 86 | String | Single | Both Access-List attributes take the name of an ACL that is configured on the FDM-managed device. Create these ACLs in firewall device manager using the Smart CLI Extended Access List object type (Log in to firewall device manager and select **Device** > **Advanced Configuration** > **Smart CLI** > **Objects**). These ACLs control traffic flow in the inbound (traffic entering the FDM-managed device) or outbound (traffic leaving the FDM-managed device) direction. |
| Access-List-Outbound | 87 | String | Single |
| Address-Pools | 217 | String | Single | The name of a network object defined on the FDM-managed device that identifies a subnet, which will be used as the address pool for clients connecting to the RA VPN. Define the network object on the **Objects** page. |
| Banner1 | 15 | String | Single | The banner to display when the user logs in. |
| Banner2 | 36 | String | Single | The second part of the banner to display when the user logs in. Banner2 is appended to Banner1. |
| Group-Policy | 25 | String | Single | The group policy to use in the connection. You must create the group policy on the RA VPN **Group Policy** page. You can use one of the following formats:   * *group policy name* * OU=*group policy name* * OU=*group policy name*; |
| Simultaneous-Logins | 2 | Integer | Single | The number of separate simultaneous connections the user can establish, 0 - 2147483647. |
| VLAN | 140 | Integer | Single | The VLAN on which to confine the user's connection, 0 - 4094. You must also configure this VLAN on a subinterface on the FDM-managed device. |

###### Two-Factor Authentication

You can configure two-factor authentication for the RA VPN. With two-factor authentication, the user must supply a username
and static password, plus an additional item such as a Duo passcode. Two-factor authentication differs from using a second
authentication source in that two-factor is configured on a single authentication source, with the relationship to the Duo
server tied to the primary authentication source. The exception is Duo LDAP, where you configure the Duo LDAP server as the
secondary authentication source.

* [Duo Two-Factor Authentication Using RADIUS](#Cisco_Concept.dita_f9d4cf7c-74aa-4b89-813e-a4fa6491e14d)
* [Duo Two-Factor Authentication using LDAP](#Cisco_Concept.dita_4b54700e-091b-4507-9102-cb02f3541027)

* [Duo Two-Factor Authentication Using RADIUS](#Cisco_Concept.dita_f9d4cf7c-74aa-4b89-813e-a4fa6491e14d)
* [Duo Two-Factor Authentication using LDAP](#Cisco_Concept.dita_4b54700e-091b-4507-9102-cb02f3541027)

###### Duo Two-Factor Authentication Using RADIUS

You can configure the Duo RADIUS server as the primary authentication source. This approach uses the Duo RADIUS Authentication
Proxy.

For the detailed steps to configure Duo, please see <https://duo.com/docs/cisco-firepower>.

You would then configure Duo to forward authentication requests directed to the proxy server to use another RADIUS server,
or a Microsoft Active Directory(AD) server, as the first authentication factor, and the Duo Cloud Service as the second factor.

When using this approach, the user must authenticate using a username that is configured on both the Duo Authentication Proxy
and the associated RADIUS/AD server, and the password for the username configured in the RADIUS/AD server, followed by one
of the following Duo codes:

*Duo-passcode*. For example, my-password,12345.

**push**. For example, *my-password*,**push**. Use **push** to tell Duo to send a push authentication to the Duo Mobile app, which the user must have already installed and registered.

**sms**. For example, *my-password*,**sms**. Use sms to tell Duo to send an SMS message with a new batch of passcodes to the user’s mobile device. The user’s authentication
attempt will fail when using sms. The user must then re-authenticate and enter the new passcode as the secondary factor.

**phone**. For example, *my-password*,**phone**. Use phone to tell Duo to perform phone callback authentication.

If the username and password are authenticated, the Duo Authentication Proxy contacts the Duo Cloud Service, which validates
that the request is from a valid configured proxy device and then pushes a temporary passcode to the mobile device of the
user as directed. When the user accepts this passcode, the session is marked authenticated by Duo and the RA VPN is established.

For a detailed explanation, see [How to Configure Two-Factor Authentication using Duo RADIUS](#Cisco_Concept.dita_5404d9eb-37cf-4885-95d3-4c9d13a7fb8c)

* [How to Configure Two-Factor Authentication using Duo RADIUS](#Cisco_Concept.dita_5404d9eb-37cf-4885-95d3-4c9d13a7fb8c)

###### How to Configure Two-Factor Authentication using Duo RADIUS

You can configure the Duo RADIUS server as the primary authentication source. This approach uses the Duo RADIUS Authentication
Proxy.

You would then configure Duo to forward authentication requests directed to the proxy server to use another RADIUS server,
or an AD server, as the first authentication factor, and the Duo Cloud Service as the second factor.

The following topics explain the configuration in more detail:

* [System Flow for Duo RADIUS Secondary Authentication](#Cisco_Concept.dita_86bfbab0-91ed-4ba6-9f68-cb438d9f4900)
* [Configure Device for Duo RADIUS Using Security Cloud Control](#Cisco_Task.dita_d9e25612-4929-4902-9c0a-bb924073143a)

* [System Flow for Duo RADIUS Secondary Authentication](#Cisco_Concept.dita_86bfbab0-91ed-4ba6-9f68-cb438d9f4900)
* [Configure Duo RADIUS Secondary Authentication](#Cisco_Concept.dita_ec739b3d-a874-48e8-8516-db1461ca41bd)

###### System Flow for Duo RADIUS Secondary Authentication

Following is an explanation of the system flow:![](/c/dam/en/us/td/i/400001-500000/450001-460000/458001-459000/458546.jpg)

1. The user makes a remote access VPN connection to the FDM-managed device and provides username associated with RADIUS/AD server, the password for the username configured in the RADIUS/AD
   server, followed by one of the DUO codes, Duo-password, push, SMS, or phone. For more information, [Duo Two-Factor Authentication Using RADIUS](#Cisco_Concept.dita_f9d4cf7c-74aa-4b89-813e-a4fa6491e14d)
2. FDM-managed device sends the authentication request to the Duo Authentication proxy.
3. Duo Authentication proxy authenticates this primary authentication attempt with the primary authentication server, which might
   be Active Directory or RADIUS.
4. If the credentials are authenticated, the Duo Authentication Proxy connection is established to Duo Security over TCP port
   443.
5. Duo then authenticates the user separately through push notification, text message with a passcode, or a telephone call. The
   user must complete this authentication successfully.
6. Duo authentication proxy receives the authentication response.
7. If the secondary authentication was successful, the FDM-managed device establishes a remote access VPN connection with the user’s AnyConnect client.

###### Configure Duo RADIUS Secondary Authentication

Duo Authentication proxy authenticates this primary authentication attempt with the primary authentication server, which might
be Active Directory or RADIUS.

* [Create a Duo Account](#Cisco_Task.dita_2e620750-04ad-41c6-abab-f9c20a97405a)
* [Configure Device for Duo RADIUS Using Security Cloud Control](#Cisco_Task.dita_d9e25612-4929-4902-9c0a-bb924073143a)

###### Create a Duo Account

Create a Duo account and obtain the integration key, secret key, and API hostname.

Following is an overview of the process. For details, please see the Duo web site,

###### Procedure

---

| **Step 1** | [Sign up for a Duo account](https://signup.duo.com/). |
| --- | --- |
| **Step 2** | Log in to the [Duo Admin Panel](https://admin.duosecurity.com/login?next=%2F) and navigate to Applications. |
| **Step 3** | Click Protect an Application and locate Cisco Firepower Threat Defense VPN in the applications list. |
| **Step 4** | Click Protect this Application to get your integration key, secret key, and API hostname. You'll need this information when configuring the proxy. For help, see the *Duo Getting Started* guide, <https://duo.com/docs/getting-started>. |
| **Step 5** | Install and configure the Duo Authentication Proxy. For instructions, see the "Install the Duo Authentication Proxy" section in <https://duo.com/docs/cisco-firepower>. |
| **Step 6** | Start the Authentication Proxy. For instructions, see the "Start the Proxy" section in <https://duo.com/docs/cisco-firepower>.  For enrolling new users in Duo, see <https://duo.com/docs/enrolling-users>. |

---

###### Configure Device for Duo RADIUS Using Security Cloud Control

###### Procedure

---

| **Step 1** | Configure FTD Radius Server Object.   1. In the left pane, click Objects. 2. Click > RA VPN Objects (ASA & FTD) > Identity Source. 3. Provide a name and set the Device Type as FTD. 4. Select Radius Server Group and click Continue. For details, see step 6 in [Create a RADIUS Server Group](#Create_a_RADIUS_Server_Group). 5. In the Radius Server section, click the Add button and click Create New Radius Server. See [Create a RADIUS Server Object](#Create_aRADIUS_Server_Object)  In the Server Name or IP Address field, enter your Duo Authentication Proxy server's fully-qualified hostname or IP address. 6. Once you have added the Duo RADIUS server to the group, click Add to create the new Duo RADIUS server group. |
| --- | --- |
| **Step 2** | Change the Remote Access VPN Authentication Method to Duo RADIUS.   1. In the left pane, click Secure Connections > Remote Access VPN > ASA & FDM. 2. Expand the VPN configuration and click on the connection profile to which you want to add Duo. 3. In the Actions pane on the right, click Edit. 4. Select the Authentication Type can be AAA or AAA and Client Certificate. 5. In the Primary Identity Source for User Authentication list, select the server group you created earlier. 6. You typically do not need to select an "Authorization Server" or "Accounting Server". 7. Click Continue. 8. In the Summary and Instructions step, click Done to save the configuration. |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Duo Two-Factor Authentication using LDAP

You can use the Duo LDAP server as the secondary authentication source along with a Microsoft Active Directory (AD) or RADIUS
server as the primary source. With Duo LDAP, the secondary authentication validates the primary authentication with a Duo
passcode, push notification, or phone call.

| **Note** | ---  The Duo two-factor authentication feature is available in Security Cloud Control for devices running Firepower Threat [version 6.5 or later](onboard-devices-and-services.html#Upgrade_a_Single_FTD_Device).  --- |
| --- | --- |

The FDM-managed device communicates with Duo LDAP using LDAPS over port TCP/636.

When using this approach, the user must authenticate using a username that is configured on both the AD/RADIUS server and
the Duo LDAP server. When prompted to log in by AnyConnect, the user provides the AD/RADIUS password in the primary Password
field, and for the Secondary Password, provides one of the following to authenticate with Duo. For more details, see the "Second
Password for Factor Selection" section in <https://guide.duo.com/anyconnect>.

* *Duo passcode*—Authenticate using a passcode, either generated with Duo Mobile, sent via SMS, generated by your hardware token, or provided
  by an administrator. For example, 1234567.
* **push**—Push a login request to your phone, if you have installed and activated the Duo Mobile app. Review the request and tap **Approve** to log in.
* **phone**—Authenticate using a phone callback.
* **sms**—Request a Duo passcode in a text message. The login attempt will fail. Log in again using the new passcode.

For a detailed explanation, see [How to Configure Two-Factor Authentication using Duo LDAP](#Cisco_Concept.dita_0830df7e-cb49-4d4e-a1df-fa33653cdeab).

* [How to Configure Two-Factor Authentication using Duo LDAP](#Cisco_Concept.dita_0830df7e-cb49-4d4e-a1df-fa33653cdeab)

###### How to Configure Two-Factor Authentication using Duo LDAP

You can use the Duo LDAP server as the secondary authentication source along with a Microsoft Active Directory (AD) or RADIUS
server as the primary source. With Duo LDAP, the secondary authentication validates the primary authentication with a Duo
passcode, push notification, or phone call..

The following topics explain the configuration in more detail:

* [System Flow for Duo LDAP Secondary Authentication](#Cisco_Concept.dita_378e73f9-f3bf-4531-b941-2a4ce3eb0ffd)
* [Configure Duo LDAP Secondary Authentication](#Cisco_Concept.dita_c937c6bf-874c-438e-b498-2afeb5473abc)

* [System Flow for Duo LDAP Secondary Authentication](#Cisco_Concept.dita_378e73f9-f3bf-4531-b941-2a4ce3eb0ffd)
* [Configure Duo LDAP Secondary Authentication](#Cisco_Concept.dita_c937c6bf-874c-438e-b498-2afeb5473abc)

###### System Flow for Duo LDAP Secondary Authentication

The following graphic shows how threat defense and Duo work together to provide two-factor authentication using LDAP.

Following is an explanation of the system flow:

![](/c/dam/en/us/td/i/400001-500000/450001-460000/458001-459000/458553.jpg)

1. The user makes a remote access VPN connection to the FDM-managed device and provides username and password.
2. FDM-managed device authenticates this primary authentication attempt with the primary authentication server, which might be Active Directory
   or RADIUS.
3. If the primary authentication works, FDM-managed device sends a request for secondary authentication to the Duo LDAP server.
4. Duo then authenticates the user separately, through push notification, text message with a passcode, or a telephone call.
   The user must complete this authentication successfully.
5. Duo responds to the FDM-managed device to indicate whether the user authenticated successfully.
6. If the secondary authentication was successful, the FDM-managed device establishes a remote access VPN connection with the user’s AnyConnect client.

###### Configure Duo LDAP Secondary Authentication

The following procedure explains the end-to-end process of configuring two-factor authentication, using Duo LDAP as the secondary
authentication source, for remote access VPN. You must have an account with Duo, and obtain some information from Duo, to
complete this configuration.

* [Create a Duo Account](#Cisco_Task.dita_97f10b03-3735-42fb-8745-5cd823fdb555)
* [Upload a Trusted CA Certificate to an FDM-Managed Device](#Cisco_Task.dita_8561f652-5933-436a-9c3c-561ac30edaa8)
* [Configure FTD for Duo LDAP in Security Cloud Control](#Cisco_Task.dita_f1783de0-dffc-47ac-a048-f5285cd201fd)

###### Create a Duo Account

Create a Duo account and obtain the integration key, secret key, and API hostname.

Following is an overview of the process. For details, please see the Duo web site,

###### Procedure

---

| **Step 1** | [Sign up for a Duo account](https://signup.duo.com/). |
| --- | --- |
| **Step 2** | Log in to the [Duo Admin Panel](https://admin.duosecurity.com/login?next=%2F) and navigate to Applications. |
| **Step 3** | Click Protect an Application and locate Cisco Firepower Threat Defense VPN in the applications list. |
| **Step 4** | Click Protect this Application to get your **Integration key**, **Secret key**, and **API hostname**. For help, see the *Duo Getting Started* guide, <https://duo.com/docs/getting-started>.  For enrolling new users in Duo, see <https://duo.com/docs/enrolling-users>. |

---

###### Upload a Trusted CA Certificate to an FDM-Managed Device

The FDM-managed device must have the trusted CA certificate needed to validate the connection to the Duo LDAP server. You can go directly
to <https://www.digicert.com/digicert-root-certificates.htm> and download either **DigiCertSHA2HighAssuranceServerCA** or **DigiCert High Assurance EV Root CA** and upload it using Firewall Device Manager (FDM).

###### Procedure

---

| **Step 1** | Access the firewall device manager page of the FDM-managed device, choose Objects > Certificates. |
| --- | --- |
| **Step 2** | Click + > Add Trusted CA Certificate. |
| **Step 3** | Enter a name for the certificate, for example, DigiCert\_High\_Assurance\_EV\_Root\_CA. (Spaces are not allowed.) |
| **Step 4** | Click Upload Certificate and select the file that you downloaded. |
| **Step 5** | Click OK. |
| **Step 6** | Onboard the device to Security Cloud Control if you haven't onboarded it already. |
| **Step 7** | [Read Configuration Changes from FTD to Security Cloud Control](#Read_All_Configurations). |

---

###### Configure FTD for Duo LDAP in Security Cloud Control

###### Procedure

---

| **Step 1** | Create a Duo LDAP identity source object for the Duo LDAP server.   1. In the Security Cloud Control navigation bar on the left, click Objects. 2. Click the  to create an object > RA VPN Objects (ASA & FTD) > Identity Source. 3. Enter a name for the object, for example, Duo-LDAP-server. 4. Select the **Device Type** as **FTD**. 5. Click Duo Ldap Identity Source and click Continue. 6. In the Edit Identity Source area, provide the following details:     * API Hostname: Enter the API Hostname that you obtained from your Duo account. The hostname should look like the following, with the X’s      replaced with your unique value: API-XXXXXXXX.DUOSECURITY.COM. Uppercase is not required.    * Port: Enter the TCP port to use for LDAPS. This should be 636 unless you have been told by Duo to use a different port. Note that      you must ensure that your access control list allows traffic to the Duo LDAP server through this port.    * Timeout: Enter the timeout, in seconds, to connect to the Duo server. The value can be 1-300 seconds. The default is 120. To use      the default, either enter 120 or delete the attribute line.    * Integration Key: Enter the integration key that you obtained from your Duo account.    * Secret Key: Enter the secret key that you obtained from your Duo account. This key will subsequently be masked.    * Interface used to connect to Duo Server: Select the interface that is used for connecting to Duo Server.       + Resolve via route lookup: Select this option to use the routing table to find the right path. For creating a routing table, see Routing.      + Manually choose interface: Select this option and choose one of the interfaces from the list. The default interface is the diagnostic interface, but        this will work only if you configure an IP address on the interface. Note: Ensure that the selected interface is present on        the same device you want to connect to Duo Server.      + Click Add. |
| --- | --- |
| **Step 2** | (optional) Use the AnyConnect Profile Editor to create a profile that specifies 60 seconds or more for authentication timeout.  You need to give users extra time to obtain the Duo passcode and complete the secondary authentication. We recommend at least 60 seconds. The following procedure explains how to configure the authentication timeout only and then upload the profile to FDM-managed device. If you want to change other settings, you can do so now.   1. If you have not already done so, download and install the AnyConnect profile editor package. You can find this in the Cisco    Software center (software.cisco.com) in the folder for your AnyConnect version. The base path at the time of this writing    is Downloads Home > Security > VPN and Endpoint Security Clients > Cisco VPN Clients > AnyConnect Secure Mobility Client. 2. Open the AnyConnect **VPN Profile Editor**. 3. Select **Preferences (Part 2)** in the table of contents, scroll to the end of the page, and change **Authentication Timeout** to 60 (or more). The following image is from the AnyConnect 4.7 VPN Profile Editor; previous or subsequent versions might    be different. 4. Choose **File** > **Save**, and save the profile XML file to your workstation with an appropriate name, for example, duo-ldap-profile.xml. 5. You can now close the **VPN Profile Editor** application. 6. In Security Cloud Control, [upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object). |
| **Step 3** | Create a group policy and select the AnyConnect profile in the policy.  The group policy that you assign to a user controls many aspects of the connection. The following procedure explains how to assign the profile XML file to the group. For more information, see [Create New FTD RA VPN Group Policies](#Procedure).   1. In the Security Cloud Control navigation bar on the left, click Objects. 2. To edit an existing group policy, use the **RA VPN Group Policy** filter to view only the existing group policies and modify the policy that you want and save it. 3. To create a new group policy, click RA VPN Objects (ASA & FTD) > RA VPN Group Policy. 4. On the General page, configure the following properties:     * Name — For a new profile, enter a name. For example, Duo-LDAP-group.    * AnyConnect Client Profiles — Select the AnyConnect client profile object that you created. 5. Click **Add** to save the object. 6. Click Secure Connections > Remote Access VPN > ASA & FDM. 7. Click the remote access VPN configuration that you want to update. 8. In the **Actions** pane on the right, click **Group Policies**. 9. Click **+** to select the group policies that you want to associate with the VPN configuration. 10. Click **Save** to save the group policy. |
| **Step 4** | Create or edit the remote access VPN connection profile to use for Duo-LDAP secondary authentication.  The following procedure just mentions the key changes to enable Duo-LDAP as the secondary authentication source and apply the AnyConnect client profile. For new connection profiles, you must configure the rest of the required fields. For this procedure, we assume you are editing an existing connection profile, and you simply must change these two settings.   1. On the Security Cloud Control navigation page, click **VPN** > **Remote Access VPN Configuration**. 2. Expand the remote access VPN configuration and click the connection profile that you want to update. 3. In the **Actions** pane on the right, click **Edit**. 4. Under **Primary Identity Source**, configure the following:     * Authentication Type — Choose either AAA Only or AAA and Client Certificate. You cannot configure two-factor authentication unless you use AAA.    * Primary Identity Source for User Authentication — Select your primary Active Directory or RADIUS server. Note that you can select a Duo-LDAP identity source as the primary      source. However, Duo-LDAP provides authentication services only, not identity services, so if you use it as a primary authentication      source, you will not see usernames associated with RA VPN connections in any dashboards, and you will not be able to write      access control rules for these users. (You can configure fallback to the local identity source if you want to.)    * Secondary Identity Source — Select the Duo-LDAP identity source.             | **Note** | If username in Primary Identity Source and Secondary Identity Source are the same, we recommend enabling Use Primary username for Secondary login in the Advanced options in the Connection Profile. Configuring this way allows the end-user to use a single username for both primary and secondary identity sources. |      | --- | --- | 5. Click **Continue**. 6. On the **Group Policy** page, select the group policy that you created or edited. 7. Click **Continue**. 8. Click **Done** to save your changes to the connection profile. |
| **Step 5** | [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### End-to-End Remote Access VPN Configuration Process for an FDM-Managed Device

This section provides the end-to-end procedure for configuring Remote Access Virtual Private Network (RA VPN) on an FDM-managed device onboarded to Security Cloud Control.

To enable remote access VPN for your clients, you need to configure several separate items. The following procedure provides
the end-to-end process.

###### Procedure

---

| **Step 1** | Enable two licenses.   * When you register the device, you must do so with a Smart Software Manager account that is enabled for export-controlled features.   The license must meet export control requirements before you can configure remote access VPN. You also cannot configure the   feature using the evaluation license. Your purchase of an FDM-managed device automatically includes an license. The license covers all features not covered by the optional licenses. It is a perpetual   license. The device must be registered to Secure Firewall   device manager. See the Registering the Device section in the Licensing the System chapter of the [Cisco Secure   Firewall Threat Defense Configuration Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running. * A license. For details, see [Licensing Requirements for Remote Access VPN](#Licensing_Requirements_for_Remote_Access_VPN).    + To enable the license, see the Enabling or     Disabling Optional Licenses section in the     Licensing the System chapter of the [Secure     Firewall Threat Defense Configuration     Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running. |
| --- | --- |
| **Step 2** | Configure Certificates.  Certificates are required to authenticate SSL connections between the clients and the device. You can use the pre-defined DefaultInternalCertificate for the VPN or create your own.  If you use an encrypted connection for the directory realm used for authentication, you must upload a trusted CA certificate. For more information on certificates and how to upload them, see [Configuring Certificates](#Configuring_Certificates). |
| **Step 3** | Configure the identity source used for authenticating remote users.  You can use the following sources to authenticate users attempting to connect to your network using RA VPN. Additionally, you can use client certificates for authentication, either alone or in conjunction with an identity source.   * Active Directory identity realm: As a primary authentication source.   The user accounts are defined in your Active Directory (AD) server.   See Configuring AD Identity Realms. See [Create and Edit an Active Directory   Realm Object](#Create_or_Edit_an_FTD_Active_Directory_Realm_Object). * RADIUS server group: As a primary or secondary authentication source,   and for authorization and accounting. See [Create or Edit a RADIUS Server   Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group). * Local Identity Source (the local user database): As a primary or fallback source. You can define users directly on the device   and not use an external server. If you use the local database as a fallback source, ensure that you define the same usernames/passwords   as the ones described in the external server.       | **Note** | You can create user accounts directly on the FDM-managed device only from Secure Firewall device manager. See [Configure Local Users](https://www.cisco.com/c/en/us/td/docs/security/firepower/640/fdm/fptd-fdm-config-guide-640/fptd-fdm-identity-sources.html#id_72907). |   | --- | --- | |
| **Step 4** | (Optional.) [Create New RA VPN Group Policies](#Procedure).  The group policy defines user-related attributes. You can configure group policies to provide differential access to resources based on group membership. Alternatively, use the default policy for all connections. |
| **Step 5** | [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration). |
| **Step 6** | [Configure an RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile). |
| **Step 7** | [Review and deploy configuration changes to the devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |
| **Step 8** | [Allow Traffic Through the Remote Access VPN](#Allow_Traffic_Through_the_Remote_Access_VPN). |
| **Step 9** | (Optional.) Enable the identity policy and configure a rule for passive authentication. If you enable passive user authentication, users who logged in through the remote access VPN will be shown in the dashboards, and they will also be available as traffic-matching criteria in policies. If you do not enable passive authentication, RA VPN users will be available only if they match an active authentication policy. You must enable the identity policy to get any username information in the dashboards or for traffic matching. See [Configure Identity Policies](#Configure_Identity_Policies). |

---

| **Important** | ---   If you change the Remote Access VPN configuration by using a local manager like Secure Firewall device manager, the Configuration Status of that device in Security Cloud Control shows "Conflict Detected". See [Out-of-Band Changes on an FDM-Managed Device](#OutofBand_Changes_on_Devices). You can [Resolve Configuration Conflicts](#Resolve_Configuration_Conflicts) on this FDM-managed device.   --- |
| --- | --- |

###### What to do next

Once the RA VPN configuration is downloaded to the FDM-managed devices, the users can connect to your network from a remote location using a
computer or other supported iOS or Android device connected to the Internet. You can
monitor live AnyConnect Remote Access Virtual Private Network (RA VPN) sessions from
all onboarded RA VPN head-ends in your tenant. See [Monitoring Remote Access Virtual Private
Network](#Monitoring_Remote_Access_Virtual_Private_Network).

* [Download AnyConnect Client Software Packages](#Download_AnyConnect_Client_Software_Packages)
* [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.4.0](#Upload_AnyConnect_Software_Packages_to_an_FTD_Version_64)
* [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.5 or Later](#Upload_AnyConnect_Software_Packages_to_an_FTD_Device_Running_FTD_Version_65_or_Later)
* [Configure Identity Sources for FDM-Managed Device](#Configure_Identity_Sources_for_FTD)
* [Create New RA VPN Group Policies](#Procedure)
* [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration)
* [Configure an RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile)
* [Allow Traffic Through the Remote Access VPN](#Allow_Traffic_Through_the_Remote_Access_VPN)
* [Upgrade AnyConnect Package on an FDM-Managed Device Running Version 6.4.0](#Upgrade_AnyConnect_Package_on_an_FTD_Version_64)
* [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object)

###### Download AnyConnect Client Software Packages

Before configuring a remote access VPN, you must download the AnyConnect software packages from <https://software.cisco.com/download/home/283000185> to your workstation. Ensure that you download the "AnyConnect Headend Deployment Package" for your desired operating systems.
Later, you can upload these packages to FDM-managed devices when defining the VPN.

Always download the latest AnyConnect version, to ensure that you have the latest features, bug fixes, and security patches.
Regularly update the packages on the device.

| **Note** | ---   You can upload one AnyConnect package per Operating System (OS): Windows, Mac, and Linux. You cannot upload multiple versions for a given OS type.   --- |
| --- | --- |

###### Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.4.0

You can upload the AnyConnect software packages to the FDM-managed devices version 6.4.0 using firewall device manager API explorer. A minimum of one AnyConnect software package must be present on the device to create an RA VPN connection.

| **Important** | ---   The procedure applies only to firewall device manager Version 6.4. If you are using firewall device manager Version 6.5 or later, use the Security Cloud Control interface to [upload the AnyConnect package](#Upload_AnyConnect_Software_Packages_to_an_FTD_Device_Running_FTD_Version_65_or_Later).   --- |
| --- | --- |

Use the following procedure to upload the AnyConnect package to firewall device manager Version 6.4.0:

###### Procedure

---

| **Step 1** | Download the AnyConnect packages from <https://software.cisco.com/download/home/283000185>.   * Make sure you accept the EULA and have K9 (encrypted image) privileges. * Select the "AnyConnect Headend Deployment Package" package for your operating system. The package name will be similar to,   "anyconnect-win-4.7.04056-webdeploy-k9.pkg. There are separate headend Webs Deploy packages for Windows, macOS, and Linux. |
| --- | --- |
| **Step 2** | Using a browser, open the home page of the system. For example, <https://ftd.example.com>. |
| **Step 3** | Log into Firewall Device Manager. |
| **Step 4** | Edit the URL to point to /#/api-explorer, for example, <https://ftd.example.com/#/api-explorer>. |
| **Step 5** | Scroll down and click Upload > /action/uploaddiskfile. |
| **Step 6** | In fileToUpload field**,** click Choose File and select the required AnyConnect package. You can upload the packages one at a time. |
| **Step 7** | Click Open. |
| **Step 8** | Scroll down and click TRY IT OUT!. Wait until the package uploads completely. In the Response Body, the API response appears in the following format.  { "version": null, "name": "691f47e1-90c7-11e9-a361-79e2452f0c57.pkg",  "fileName": "691f47e1-90c7-11e9-a361-79e2452f0c57.pkg",  "id": "691f47e1-90c7-11e9-a361-79e2452f0c57.pkg",  "type": "fileuploadstatus",  "links": {  "self":   https://ftd.example.com:972/api/fdm/...90d111e9-a361- cf32937ce0df.pkg   } } Record the fileName of the package from the response as you must enter the same string when performing the POST operation. In this example, the fileName is 691f47e1-90c7-11e9-a361-79e2452f0c57.pkg. |
| **Step 9** | Scroll up near the top of Threat Defense REST API page and click AnyConnectPackageFile  > POST /object/anyconnectpackagefiles. Perform a POST operation to the API providing the temp staged diskFilename and the OS type of the package file in the payload. This action creates the AnyConnect package file. |
| **Step 10** | In the body field, enter the package details in the following format only: { "platformType": "WINDOWS",  "diskFileName": "691f47e1-90c7-11e9-a361-79e2452f0c57.pkg",  "type": "anyconnectpackagefile",  "name": "AnyConnectWindowsBGL" }  1. In the platformType field, enter the OS platform as WINDOWS, MACOS, or LINUX. 2. In the diskFileName field, enter the fileName that you have recorded after uploading disk file. 3. In the name field, enter a name that you want for the package. 4. Click TRY IT OUT!.  In the Response Body field, the API response appears in the following format after a successful POST operation.   { "version": "ni7xeneslft3p",  "name": "AnyConnectWindowsBGL",  "description": null,  "diskFileName": "41d592e3-90ca-11e9-a361-6d05320a165d.pkg", "md5Checksum": "9bbe53dcf92e515d3ce5423048212488",  "platformType": "WINDOWS",  "id": "c9c9dfe3-9cd8-11e9-a361-23534f081c43",  "type": "anyconnectpackagefile",  "links": { "self":   "[https:/>/ftd.example.com:972...1-cf32937ce0df](https://bglgrp1224-pod.cisco.com:972/api/fdm/v3/object/anyconnectpackagefiles/7f8248c7-90d1-11e9-a361-cf32937ce0df)"   } } The AnyConnect package is created on firewall device manager. |
| **Step 11** | Click AnyConnectPackageFile > GET /object/anyconnectpackagefiles >  TRY IT OUT!.  The  Response Body shows all AnyConnect package files.  A sample response is shown below. {  "items": [  {  "version": "la4nwceqk2sg4",  "name": "AnyConnectWindowsBGL",  "description": null,  "diskFileName": "82f1e362-9cd8-11e9-a361-9758ba07962d.pkg",  "md5Checksum": "9bbe53dcf92e515d3ce5423048212488",  "platformType": "WINDOWS",  "id": "c9c9dfe3-9cd8-11e9-a361-23534f081c43",  "type": "anyconnectpackagefile",  "links": {  "self":  "[https://ftd.example.com:972...1-23534f081c43](https://bglgrp1224-pod.cisco.com:972/api/fdm/v3/object/anyconnectpackagefiles/c9c9dfe3-9cd8-11e9-a361-23534f081c43)"  }  }  ], |
| **Step 12** | Upload other AnyConnect packages for each OS type. Repeat steps from 4 to 10. |
| **Step 13** | Edit the URL to point to the web page, for example, [https://ftd.example.com](https://ftd.example.com/#/api-explorer) |
| **Step 14** | Click the Deploy Changes icon in the upper right of the web page. The icon is highlighted with a dot when there are undeployed changes. |
| **Step 15** | If you are satisfied with the changes, you can click Deploy Now to start the job immediately. The window will show that the deployment is in progress. You can close the window or wait for the deployment to complete. |

---

| **Note** | ---   To delete a package from the FDM-managed device, click AnyConnectPackageFile > Delete. In the objID field, type the package id and click TRY IT OUT!.   --- |
| --- | --- |

To complete a VPN connection, your users must install the AnyConnect client software on their workstation. For more information,
see [How Users Can Install the AnyConnect Client Software on FDM-Managed Device](#Procedure).

###### Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.5 or Later

If you're using an FDM-managed device, running [version 6.5 or later](onboard-devices-and-services.html#Upgrade_a_Single_FTD_Device), for configuring RA VPN, you can use the RA VPN wizard in Security Cloud Control to upload AnyConnect software packages to the device. In the RA VPN wizard, you must provide the URL of the remote HTTP or
HTTPS server where the AnyConnect packages are preloaded.

| **Note** | ---   You can upload the AnyConnect package using the [FDM API procedure](#Upload_AnyConnect_Software_Packages_to_an_FTD_Version_64) as well.   --- |
| --- | --- |

* [Upload an AnyConnect Package from Security Cloud Control Repository](#Cisco_Task.dita_bdd6d999-a480-4208-9163-5173032722ce)
* [Before you Begin](#Before_you_Begin)
* [Upload new AnyConnect Packages](#Upload_newAnyConnect_Packages)
* [Replace an Existing AnyConnect Package](#Replace_an_Existing_AnyConnect_Package)
* [Delete the AnyConnect Package](#Delete_theAnyConnectPackage)

###### Upload an AnyConnect Package from Security Cloud Control Repository

The remote access VPN Configuration wizard presents AnyConnect packages per operating system from the Security Cloud Control repository, which you can select and upload to device. Make sure that the device has access to the internet and proper DNS
configuration.

| **Note** | ---   If the desired package is unavailable in the presented list or the device has no access to the internet, you can upload the package using the server where the AnyConnect packages are preloaded.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Click on the field that corresponds to an operating system and select an AnyConnect package. |
| --- | --- |
| **Step 2** | Click  to upload the package. If the checksum doesn't match, the AnyConnect package upload fails. You can see the device's workflow tab for more details about the failure. |

---

###### Before you Begin

Make sure that you download the "AnyConnect Headend Deployment Package" for your desired operating systems. Always download
the latest AnyConnect version, to ensure that you have the latest features, bug fixes, and security patches. Regularly update
the packages on the device.

| **Note** | ---   You can upload one AnyConnect package per Operating System (OS): Windows, Mac, and Linux. You cannot upload multiple versions for a given OS type.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Download the AnyConnect packages from <https://software.cisco.com/download/home/283000185>.   * Make sure you accept the EULA and have K9 (encrypted image) privileges. * Select the "AnyConnect Headend Deployment Package" package for your operating system. The package name will be similar to   "anyconnect-win-4.7.04056-webdeploy-k9.pkg." There are separate headend packages for Windows, macOS, and Linux. |
| --- | --- |
| **Step 2** | Upload the AnyConnect packages to a remote HTTP or HTTPS server. Ensure that there is a network route from the FDM-managed device to the HTTP or HTTPS server.   | **Note** | If you are uploading the AnyConnect package to an HTTPS server, ensure that the following steps are performed: | | --- | --- |  * Upload the trusted CA certificate of that server on the FDM-managed device from firewall device manager. To upload the certificate, see the "Uploading Trusted CA Certificates" section in the "Certificates" chapter of [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version X.Y](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor613). * Install the trusted CA certificate on the HTTPS server. |
| **Step 3** | The remote server's URL must be a direct link without prompting for authentication. If the URL is pre-authenticated, the file can be downloaded by specifying the RA VPN wizard's URL. |
| **Step 4** | If the remote server IP address is NATed, you have to provide the NATed public IP address of the remote server location. |

---

###### Upload new AnyConnect Packages

Use the following procedure to upload a new AnyConnect packages to an FDM-managed device running Version 6.5.0:

###### Procedure

---

| **Step 1** | [Create an RA VPN Configuration from steps 1-4](#Create_an_FTD_RA_VPN_Configuration). |
| --- | --- |
| **Step 2** | In the AnyConnect Package Detected, you can upload separate packages for Windows, Mac, and Linux endpoints. |
| **Step 3** | In the corresponding platform field, specify the server's paths where the AnyConnect packages compatible for Windows, Mac, and Linux are pre-uploaded. Examples of server paths: 'http://<ip\_address>:port\_number/<folder\_name>/anyconnect-win-4.8.01090-webdeploy-k9.pkg', 'https://<ip\_address>:port\_number/<folder\_name>/anyconnect-linux64-4.7.03052-webdeploy-k9.pkg'. |
| **Step 4** | Click  to upload the package. Security Cloud Control validates if the path is reachable, and the specified filename is a valid package. When the validation is successful, the names of the AnyConnect packages appear. As you add more FDM-managed devices to the RA VPN configuration, you can upload the AnyConnect packages to them. |
| **Step 5** | Click OK. The AnyConnect packages are added to the RA VPN configuration. |
| **Step 6** | Continue to perform procedure in [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration) from here onwards. |

---

###### What to do next

To complete a VPN connection, users must install the AnyConnect client software on their workstation. For more information,
see [How Users Can Install the AnyConnect Client Software on FTD](#Procedure).

###### Replace an Existing AnyConnect Package

If the AnyConnect packages are already present on the devices, you can see them in the RA VPN wizard. You can see all the
available AnyConnect packages for an operating system in a drop-down list. You can select an existing package from the list
and replace it with a new one but can't add a new package to the list.

| **Note** | ---   If you want to replace an existing package with a new one, ensure that the new AnyConnect package is uploaded already to a server on the network that the FDM-managed device can reach.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Remote Access VPN > ASA & FDM. |
| --- | --- |
| **Step 2** | Select the RA VPN configuration to be modified, and under Actions, click Edit. |
| **Step 3** | In AnyConnect Packages Detected, click  icon appearing beside the existing AnyConnect package. If there are multiple versions of AnyConnect package for an operating system, select the package you want to replace from the list and click Edit. The existing package disappears from the corresponding field. |
| **Step 4** | Specify the server's path where the new AnyConnect package is preloaded and click  to upload the package. |
| **Step 5** | Click OK. The new AnyConnect package is added to the RA VPN configuration. |
| **Step 6** | Continue to [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration) from step 6 onwards. |

---

###### Delete the AnyConnect Package

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Remote Access VPN > ASA & FDM. |
| --- | --- |
| **Step 2** | Select the RA VPN configuration to be modified, and under Actions, click Edit. |
| **Step 3** | In AnyConnect Packages Detected, click  icon appearing beside the AnyConnect package that you want to delete. If there are multiple versions of AnyConnect package for an operating system, select the package you want to delete from the list. The existing package disappears from the corresponding field.   | **Note** | Click Cancel to stop the delete operation and retain the existing package. | | --- | --- | |
| **Step 4** | Click OK. The device's Configuration Status is in 'Not Synced' state.   | **Note** | If you want to undo the delete action at this stage, click Security Devices page and click Discard Changes to retain the existing AnyConnect package. | | --- | --- | |
| **Step 5** | [Review and deploy configuration changes to the devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be). |

---

###### Configure Identity Sources for FDM-Managed Device

Identity Sources, such as Microsoft AD realms and RADIUS Servers, are AAA servers and databases that define user accounts
for the people in your organization. You can use this information in a variety of ways, such as providing the user identity
associated with an IP address, or authenticating remote access VPN connections or access to Security Cloud Control.

Click Objects, then click ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453372.jpg) and choose > RA VPN Objects (ASA & FTD) > Identity Source to create your sources. You would then use these objects when you configure the services that require an identity source.
You can apply appropriate filters to search existing sources and manage them.

###### Active Directory Realms

Active Directory provides user account and authentication information. When you deploy a configuration that includes an AD
realm to an FDM-managed device, Security Cloud Control fetches users and groups from the AD server.

You can use this source for the following purposes:

* Remote Access VPN, as a primary identity source. You can use AD in conjunction with a RADIUS server.
* Identity policy, for active authentication and as the user identity source used with passive authentication.
* Identity rule, for active authentication for a user.

You can create access control rules with user identities. See [How to Implement an Identity Policy](#How_to_Implement_a_Firepower_Identity_Policy) for more information.

Security Cloud Control requests an updated list of user groups once every 24 hours. Because you can add a maximum of 50 users or groups to a rule,
selecting groups usually makes more sense than selecting individual users. For example, you could create a rule allowing the
Engineering group access to a development network, and create a subsequent rule that denies all other access to the network.
Then, to make the rule apply to new engineers, you only need to add the engineer to the Engineering group in the directory
server.

###### Active Directory Realms In Security Cloud Control

You configure the AD realm when you create an AD Identity object. The identity source
objects wizard assists in determining how to connect to the AD server and where the
AD server is located in the network.

| **Note** | ---   If you create an AD realm in Security Cloud Control, Security Cloud Control remembers the AD password when you create affiliate identity source objects and when you add those objects to an identity rule.   --- |
| --- | --- |

###### Active Directory Realms In FDM

You can point to AD realm objects that were created in FDM from the Security Cloud Control objects wizard. Note that Security Cloud Control does not read the AD password for AD realm objects that are created in FDM. You must manually enter the correct AD password in Security Cloud Control.

To configure an AD realm in firewall device managers, see the Configuring AD Identity Realms section of the Reusable Objects chapters of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running.

###### Supported Directory Servers

You can use AD on Windows Server 2008 and 2012.

Note the following about your server configuration:

* If you want to perform user control on user groups or on users within groups, you must configure user groups on the directory
  server. The system cannot perform user group control if the server organizes the users in a basic object hierarchy.
* The directory server must use the field names listed in the following table in order for the system to retrieve user metadata
  from the servers for that field:

| Metadata | Active Directory Field |
| --- | --- |
| LDAP user name | samaccountname |
| First name | givename |
| Last Name | sn |
| email address | mail  userprincipalname (if mail has no value) |
| Department | department  distinguishedname (if department has no value) |
| Telephone number | telephonenumber |

* [Determining the Directory Base DN](#Determining_the_Directory_Base_DN)
* [RADIUS Servers and Groups](#RADIUS_Servers_and_Groups)
* [Create or Edit an Active Directory Realm Object](#Create_or_Edit_an_FTD_Active_Directory_Realm_Object)
* [Create or Edit a RADIUS Server Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group)

###### Determining the Directory Base DN

When you configure directory properties, you need to specify the common base
Distinguished Name (DN) for users and groups. The base is defined in your directory
server and differs from network to network. You must enter the correct bases for
identity policies to work. If the base is wrong, the system cannot determine user or
group names, and thus identity-based policies will be inoperable.

| **Note** | ---   To get the correct bases, consult the administrator who is responsible for the directory servers.   --- |
| --- | --- |

For an active directory, you can determine the correct bases by logging into the AD
server as a domain administrator, and using the dsquery command
at a command prompt as follows to determine the bases:

User search base

Enter the dsquery user command with known username (partial or complete) to determine the base distinguished name. For example, the following command
uses the partial name "John\*" to return information for all users that start with "John."

C:\Users\Administrator>dsquery user -name "John\*"

"CN=John Doe,CN=Users,DC=csc-lab,DC=example,DC=com"

The base DN would be "DC=csc-lab,DC=example,DC=com."

Group search base

Enter the dsquery group command with a known group name to
determine the base DN. For example, the following command uses the group name Employees
to return the distinguished name:

C:\>dsquery group -name "Employees"

"CN=Employees,CN=Users,DC=csc-lab,DC=example,DC=com"

The group base DN would be "DC=csc-lab,DC=example,DC=com."

You can also use the ADSI Edit program to browse the AD structure (Start > Run > adsiedit.msc). In ADSI Edit, right click any object, such as an organizational unit
(OU), group, or user, and choose Properties to view the
distinguished name. You can then copy the string of DC values as the base.

To verify that you have the correct base:

###### Procedure

---

| **Step 1** | Click the Test Connection button in the directory properties to verify connectivity. Resolve any problems, and save the directory properties. |
| --- | --- |
| **Step 2** | Commit changes to the device. |
| **Step 3** | Create an access rule, select the Users tab, and try to add known user and group names from the directory. You should see auto-complete suggestions as you type for matching users and groups in the realm that contains the directory. If these suggestions appear in a drop-down list, then the system was able to query the directory successfully. If you see no suggestions, and you are certain the string you typed should appear in a user or group name, you need to correct the corresponding search base. |

---

###### What to do next

See [Create and Edit a Firepower Threat Defense Active Directory Realm Object](#Create_or_Edit_an_FTD_Active_Directory_Realm_Object) for more information.

###### RADIUS Servers and Groups

You can use RADIUS servers to authenticate and authorize administration users.

When you configure a feature to use RADIUS servers, you select a RADIUS group instead of individual servers. A RADIUS group
is a collection of RADIUS servers that are copies of each other. If a group has more than one server, they form a chain of
backup servers to provide redundancy in case one server becomes unavailable. But even if you have only one server, you must
create a one-member group to configure RADIUS support for a feature.

You can use this source for the following purposes:

* Remote Access VPN, as an identity source for authentication, and for authorization and accounting. You can use AD in conjunction
  with a RADIUS server.
* Identity policy, as a passive identity source to collect user identity from remote access VPN logins.

See [Create and Edit a Firepower Threat Defense RADIUS Server Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group) for more information.

**Related Information:**

* [Create an Active Directory Realm Object](#Create_or_Edit_an_FTD_Active_Directory_Realm_Object)
* [Create a RADIUS Server Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group)
* [Configure Identity Policies](#Configure_Identity_Policies)

###### Create or Edit an Active Directory Realm Object

###### About Active Directory Realm Objects

When you create or edit an identity source object such as an AD realm object, Security Cloud Control sends the configuration request to the FDM-managed devices through the SDC. The FDM-managed device then communicates with the configured AD realm.

Note that Security Cloud Control does not read the Directory Password for AD realms that are configured through the firewall device manager console. If you use an AD realm object that was originally created in firewall device manager, you must manually enter the Directory Password.

* [Create an FTD Active Directory Realm Object](#Create_an_FTD_Active_Directory_Realm_Object)
* [Edit an FTD Active Directory Realm Object](#Edit_an_FTD_Active_Directory_Realm_Object)

###### Create an FTD Active Directory Realm Object

Use the following procedure to create an object:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click , then click RA VPN Objects (ASA & FTD)  >  Identity Source. |
| **Step 3** | Enter an Object Name for the object. |
| **Step 4** | Select the Device Type is as FTD. |
| **Step 5** | In the first part of the wizard, select Active Directory Realm as the Identity Source Type. Click Continue. |
| **Step 6** | Configure the basic realm properties.   * Directory Username, Directory Password - The   distinguished username and password for a user with appropriate   rights to the user information you want to retrieve. For AD, the   user does not need elevated privileges. You can specify any user in   the domain. The username must be fully qualified; for example, [Administrator@example.com](http://www.administrator@example.com) (not simply   Administrator).       | **Note** | The system generates ldap-login-dn and ldap-login-password from this information. For example, [Administrator@example.com](http://www.administrator@example.com) is translated as cn=administrator,cn=users,dc=example,dc=com. Note that cn=users is always part of this translation, so you must configure the user you specify here under the common name "users" folder. |   | --- | --- | * Base Distinguished Name - The directory tree for searching or querying user and group information, that is, the common parent for users and groups.   For example, cn=users,dc=example,dc=com. * AD Primary Domain - The fully qualified AD   domain name that the device should join. For example,   example.com. |
| **Step 7** | Configure the directory server properties.   * Hostname/IP Address - The hostname or IP address of the directory server. If you use an encrypted connection to the server, you must enter the   fully-qualified domain name, not the IP address. * Port - The port number used for communications with the server. The default is 389. Use port 636 if you select LDAPS as the encryption   method. * Encryption - To use an encrypted connection for downloading user and group information, select the desired method,STARTTLS or LDAPS. The default is None, which means that user and group information is downloaded in clear text.    + STARTTLS negotiates the encryption method and uses the strongest method supported by the directory server. Use port 389. This option     is not supported if you use the realm for remote access VPN.   + LDAPS requires LDAP over SSL. Use port 636. * Trusted CA Certificate - If you select an encryption method, upload a Certificate Authority (CA) certificate to enable a trusted connection between   the system and the directory server. If you are using a certificate to authenticate, the name of the server in the certificate   must match the server Hostname / IP Address. For example, if you use 10.10.10.250 as the IP address but ad.example.com in   the certificate, the connection fails. |
| **Step 8** | (Optional) Use the Test button to validate the configuration. |
| **Step 9** | (Optional) Click Add another configuration to add multiple AD servers to the AD realm. The AD servers need to be duplicates of each other and support the same AD domain. Therefore, the basic realm properties such as Directory name, Directory Password, and Base Distinguished Name must be the same across all AD servers associated with that AD realm. |
| **Step 10** | Click Add. |
| **Step 11** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Edit an FTD Active Directory Realm Object

Note that you cannot change the Identity Source Type when editing an Identity source object. You must create a new object
with the correct type.

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object you want to edit by using object filters and search field. |
| **Step 3** | Select the object you want to edit. |
| **Step 4** | Click the edit icon  in the Actions pane of the details panel. |
| **Step 5** | Edit the values in the dialog box in the same fashion that you created in the procedures above. Expand the configuration bar listed below to edit or test the hostname/IP address or encryption information. |
| **Step 6** | Click Save. |
| **Step 7** | Security Cloud Control displays the policies that will be affected by the change. Click Confirm to finalize the change to the object and any policy affected by it. |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

**Related Information:**

* [Create and Edit an FTD Server Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group)
* [Configure Identity Policies](#Configure_Identity_Policies)
* [Configuring Identity Rules](#Configure_Identity_Rules)
* [Configure Identity Policy Settings](#Configure_Identity_Policy_Settings)

###### Create or Edit a RADIUS Server Object or Group

###### About RADIUS Server Objects or Groups

When you create or edit an identity source object such as a RADIUS server object or a group of RADIUS server objects, Security Cloud Control sends the configuration request to the FDM-managed devices through the SDC. The FDM-managed device then communicates with the configured AD realm.

* [Create a RADIUS Server Object](#Create_aRADIUS_Server_Object)
* [Create a RADIUS Server Group](#Create_a_RADIUS_Server_Group)
* [Edit a Radius Server Object or Group](#Edit_a_Radius_Server_Object_or_Group)

###### Create a RADIUS Server Object

RADIUS servers provide AAA (authentication, authorization, and accounting) services.

Use the following procedure to create an object:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click , then click RA VPN Objects (ASA & FTD)  >  Identity Source. |
| **Step 3** | Enter an Object name for the object. |
| **Step 4** | For the Device Type, select FTD. |
| **Step 5** | For the Identity Source type, select RADIUS Server. Click Continue. |
| **Step 6** | Edit the Identity Source configuration with the following properties:   * Server Name or IP Address - The fully-qualified host name (FQDN) or IP address of the server. * Authentication Port (Optional) - The port on which RADIUS authentication and authorization are performed. The default is 1812. * Timeout - The length of time, 1-300 seconds, that the system waits for a response from the server before sending the request to the   next server. The default is 10 seconds. * Enter the Server Secret Key(Optional) - The shared secret that is used to encrypt data between the Firepower Threat Defense device and the RADIUS server.   The key is a case-sensitive, alphanumeric string of up to 64 characters, with no spaces. The key must start with an alphanumeric   character or an underscore, and it can contain the special characters: $ & - \_ . + @. The string must match the one configured   on the RADIUS server. If you do not configure a secret key, the connection is not encrypted. |
| **Step 7** | If you have Cisco Identity Services Engine (ISE) already configured for your network and are using the server for remote access VPN Change of Authorization configuration, click the RA VPN Only link and configure the following:   * Redirect ACL - Select the extended Access Control List (ACL) to use for the RA VPN redirect ACL. If you do not have an extended ACL you   must create the required extended ACL object from a Smart CLI template in the FDM-managed device console. See the Configuring Smart CLI Objects section of the Advanced Configuration chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running. The purpose of the redirect ACL is to send initial traffic to ISE to assess the client   posture. The ACL should send HTTPS traffic to ISE, but not traffic that is already destined for ISE, or traffic that is directed   to a DNS server for name resolution. See the Configure Change of Authorization section of the Virtual Private Networks (VPN) chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)for the version your device is running. * Diagnostic Interface -Enabling this option allows the system to always use the "Diagnostic" interface to communicate with the server. If you leave   this disabled, Security Cloud Control will default to using the routing table to determine the which interface to use. |
| **Step 8** | Click Add. |
| **Step 9** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Create a RADIUS Server Group

A RADIUS server group contains one or more RADIUS server objects. The servers within a group must be copies of each other.
These servers form a chain of backup servers, so that if the first server is unavailable, the system can try the next server
in the list.

Use the following procedure to create an object group:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click , then click FTD >  Identity Source. |
| **Step 3** | Enter an Object name for the object. |
| **Step 4** | Select the Device Type as FTD. |
| **Step 5** | Select RADIUS Server Group as the Identity Source Type. Click Continue. |
| **Step 6** | Edit the Identity Source configuration with the following properties:   * Dead Time - Failed servers are reactivated only after all servers have failed. The dead time is how long to wait after the last server   fails before reactivating all servers. * Maximum Failed Attempts - The number of failed requests (that is, requests that do not get a response) sent to a RADIUS server in the group before   trying the next server. When the maximum number of failed attempts is exceeded, the system marks the server as Failed. For   a given feature, if you configured a fallback method using the local database, and all the servers in the group fail to respond,   then the group is considered to be unresponsive, and the fallback method is tried. The server group remains marked as unresponsive   for the duration of the dead time, so that additional AAA requests within that period do not attempt to contact the server   group, and the fallback method is used immediately. * Dynamic Authorization/Port (Optional) - If you enable RADIUS dynamic authorization or change of authorization (CoA) services for this RADIUS server   group, the group will be registered for CoA notification and listen on the specified port for CoA policy updates from Cisco   Identity Services Engine (ISE). Enable dynamic authorization only if you are using this server group in a remote access VPN   in conjunction with ISE. |
| **Step 7** | Select an AD realm that supported the RADIUS server from the drop-down menu. If you have not already created an AD realm, click Create from inside the drop-down menu. |
| **Step 8** | Click the Add button  to add existing RADIUS server objects. Optionally, you can create a new RADIUS server object from this window is necessary.   | **Note** | Add these objects in priority, as the first server in the list is used until it is unresponsive. FDM-managed device then defaults to the next server in the list. | | --- | --- | |
| **Step 9** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Edit a Radius Server Object or Group

Use the following procedure to edit a Radius server object or Radius server group:

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Locate the object you want to edit by using object filters and search field. |
| **Step 3** | Select the object you want to edit. |
| **Step 4** | Click the edit icon  in the Actions pane of the details panel. |
| **Step 5** | Edit the values in the dialog box in the same fashion that you created them in the procedures above. To edit or test the hostname/IP address or encryption information, expand the configuration bar. |
| **Step 6** | Click Save. |
| **Step 7** | Security Cloud Control displays the policies that will be affected by the change. Click Confirm to finalize the change to the object and any policy affected by it. |
| **Step 8** | [Review and Deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

###### Create New RA VPN Group Policies

A group policy is a set of user-oriented attribute/value pairs for remote access VPN connections. The connection profile uses
a group policy that sets terms for user connections after the tunnel is established. Group policies let you apply whole sets
of attributes to a user or a group of users, rather than having to specify each attribute individually for each user.

The system includes a default group policy named "DfltGrpPolicy". You can create additional group policies to provide the
services you require.

| **Note** | ---   You cannot add inconsistent group policy objects to RA VPN configuration. Resolve all inconsistencies before adding the group policy to the RA VPN Configuration.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | In the left pane, click Objects. |
| --- | --- |
| **Step 2** | Click  > RA VPN Objects (ASA & FTD)  > RA VPN Group Policy. |
| **Step 3** | Enter a name for the group policy. The name can be up to 64 characters and spaces are allowed. |
| **Step 4** | In the Device Type drop-down, select FTD. |
| **Step 5** | Do any of the following:   * Click the required tabs and configure the attributes on the page:    + [General Attributes](#General_Attributes)   + [AnyConnect Client Profiles](#General_Attributes__ftd_anyconnect_client_profiles)   + [Session Setting Attributes](#General_Attributes__ftd_session_setting)   + [Address Assignment Attributes](#General_Attributes__ftd_address_assignment)   + [Split Tunneling Attributes](#General_Attributes__ftd_split_tunnelling)   + [AnyConnect Attributes](#General_Attributes__ftd_anyconnect)   + [Traffic Filters Attributes](#General_Attributes__ftd_traffic_filters)   + [Windows Browser Proxy Attributes](#General_Attributes__ftd_windows_browser) |
| **Step 6** | Click Save to create the group policy. |

---

* [RA VPN Group Policy Attributes](#General_Attributes)

###### RA VPN Group Policy Attributes

The general attributes of a group policy define the name of the group and some other basic settings. The Name attribute is
the only required attribute.

* DNS Server: Select the DNS server group that defines the DNS servers clients should use for domain name resolution when connected to
  the VPN. If the group you need is not yet defined, click Create DNS Group and create it now.
* Banner: The banner text, or welcome message, to present to users at login. The default is no banner. The length can be up to 496
  characters. The AnyConnect client supports partial HTML. To ensure that the banner displays properly to remote users, use
  the <BR> tag to indicate line breaks.
* Default Domain: The default domain name for users in the RA VPN. For example, example.com. This domain is added to hostnames that are not
  fully-qualified, for example, serverA instead of serverA.example.com.
* AnyConnect Client Profiles: Click + and select the AnyConnect Client Profiles to use for this group. See [Configure and Upload AnyConnect Client Profiles](#Create_an_AnyConnectClient_Profile_Object). If you configure a fully-qualified domain name for the outside interface (in the connection profile), a default profile
  will be created for you. Alternatively, you can upload your client profile. Create these profiles using the Standalone AnyConnect
  Profile Editor, which you can download and install from software.cisco.com. If you do not select a client profile, the AnyConnect
  client uses default values for all options. The items in this list are AnyConnect Client Profile objects rather than the profiles
  themselves. You can create (and upload) new profiles by clicking Create New AnyConnect Client Profile in the drop-down list.

###### **AnyConnect Client Profiles**

This feature is supported on firewall device manager running software version 6.7 or later versions.

Cisco AnyConnect VPN client offers enhanced security through various built-in modules. These modules provide services such
as web security, network visibility into endpoint flows, and off-network roaming protection. Each client module includes a
client profile that includes a group of custom configurations as per your requirement.

You can select the AnyConnect VPN profile object and AnyConnect modules to be downloaded to clients when the VPN user downloads
the VPN AnyConnect client software.

1. Choose or create an AnyConnect VPN profile object. See [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object). Except for DART and Start Before Login modules, the AnyConnect VPN profile object must be selected.
2. Click Add Any Connect Client Module.

   The following AnyConnect modules are optional and you can configure these modules to be downloaded with VPN AnyConnect client
   software:

   * AMP Enabler — Deploys advanced malware protection (AMP) for endpoints.
   * DART — Captures a snapshot of system logs and other diagnostic information and creates a .zip file on your desktop so you can
     conveniently send troubleshooting information to Cisco TAC.
   * Feedback — Provides information about the features and modules customers have enabled and used.
   * ISE Posture — Uses the OPSWAT library to perform posture checks to assess an endpoint's compliance.
   * Network Access Manager — Provides 802.1X (Layer 2) and device authentication to access both wired and wireless networks.
   * Network Visibility — Enhances the enterprise administrator's ability to do capacity and service planning, auditing, compliance, and security
     analytics.
   * Start Before Login — Forces the user to connect to the enterprise infrastructure over a VPN connection before logging on to Windows by starting
     AnyConnect before the Windows login dialog box appears.
   * Umbrella Roaming Security — Provides DNS-layer security when no VPN is active.
   * Web Security — Analyzes the elements of a web page, allows acceptable content, and blocks malicious or unacceptable content based on a
     defined security policy.
3. In the Client Module list, select an AnyConnect module.
4. In the Profile list, choose or create a profile object containing an AnyConnect Client Profile.
5. Select Enable Module Download to enable endpoints to download the client module along with the profile. If not selected, the endpoints can download only
   the client profile.

###### Session Setting Attributes

The session settings of a group policy control how long users can connect through the VPN and how many separate connections
they can establish.

* Maximum Connection Time: The maximum length of time, in minutes, that users can stay connected to the VPN without logging out and reconnecting, from
  1- 4473924 or blank. The default is unlimited (blank), but the idle timeout still applies.
* Connection Time Alert Interval: If you specify a maximum connection time, the alert interval defines the amount of time before the maximum time is reached
  to display a warning to the user about the upcoming automatic disconnect. The user can choose to end the connection and reconnect
  to restart the timer. The default is 1 minute. You can specify 1 to 30 minutes.
* Idle Time: The length of time, in minutes, that the VPN connection can be idle before it is automatically closed, from 1-35791394.
  If there is no communication activity on the connection for this consecutive number of minutes, the system stops the connection.
  The default is 30 minutes.
* Idle Time Alert Interval: The amount of time before the idle time is reached to display a warning to the user about the upcoming automatic disconnect
  due to an idle session. Any activity resets the timer. The default is 1 minute. You can specify 1 to 30 minutes.
* Simultaneous Login Per User: The maximum number of simultaneous connections allowed for a user. The default is 3. You can specify 1 to 2147483647 connections.
  Allowing many simultaneous connections might compromise security and affect performance.

###### Address Assignment Attributes

The address assignment attributes of a group policy define the IP address pool for the group. The pool defined here overrides
the pool defined in any connection profile that uses this group. Leave these settings blank if you want to use the pool defined
in the connection profile.

* IPv4 Address Pool, IPv6 Address Pool: These options define the address pools for the remote endpoints. Clients are assigned an address from these pools based
  on the IP version they use to make the VPN connection. Select a network object that defines a subnet for each IP type you
  want to support. Leave the list empty if you do not want to support that IP version. For example, you could define an IPv4
  pool as 10.100.10.0/24. The address pool cannot be on the same subnet as the IP address for the outside interface. You can
  specify a list of up to six address pools to use for local address allocation. The order in which you specify the pools is
  significant. The system allocates addresses from these pools in the order in which the pools appear.
* DHCP Scope: If you configure DHCP servers for the address pool in the connection profile, the DHCP scope identifies the subnets to use
  for the pool for this group. The DHCP server must also have addresses in the same pool identified by the scope. The scope
  allows you to select a subset of the address pools defined in the DHCP server to use for this specific group. If you do not
  define a network scope, the DHCP server assigns IP addresses in the order of the address pools configured. It goes through
  the pools until it identifies an unassigned address. To specify a scope, select the network object that contains the network
  number host address. Click Create New Network if the object does not yet exist. For example, to tell the DHCP server to use addresses from the 192.168.5.0/24 subnet pool,
  select a network object that specifies 192.168.5.0 as a host address. You can use DHCP for IPv4 addressing only.

###### Split Tunneling Attributes

The split tunneling attributes of a group policy define how the system should handle traffic meant for the internal network
vs. externally-directed traffic. Split tunneling directs some network traffic through the VPN tunnel (encrypted) and the remaining
network traffic outside the VPN tunnel (unencrypted or in clear text).

* IPv4 Split Tunneling, IPv6 Split Tunneling: You can specify different options based on whether the traffic uses IPv4 or IPv6 addresses, but the options for each are
  the same. If you want to enable split tunneling, specify one of the options that require you to select network objects.

  + Allow all traffic over tunnel: Do no split tunneling. Once the user makes an RA VPN connection, all the user's traffic goes through the protected tunnel.
    This is the default. It is also considered the most secure option.
  + Allow specified traffic over the tunnel: Select the network objects that define destination network and host addresses. Any traffic to these destinations goes through
    the protected tunnel. The client routes traffic to any other destination to connections outside the tunnel (such as a local
    Wi-Fi or network connection).
  + Exclude networks specified below: Select the network objects that define destination network or host addresses. The client routes any traffic to these destinations
    to connections outside the tunnel. Traffic to any other destination goes through the tunnel.
* Split DNS - You can configure the system to send some DNS requests through the secure connection while allowing the client to send
  other DNS requests to the DNS servers configured on the client. You can configure the following DNS behavior:

  + Send DNS Request as per split tunnel policy: With this option, DNS requests are handled the same way as the split tunnel options are defined. If you enable split tunneling,
    DNS requests are sent based on the destination addresses. If you do not enable split tunneling, all DNS requests go over the
    protected connection.
  + Always send DNS requests over tunnel: Select this option if you enable split tunneling, but you want all DNS requests sent through the protected connection to
    the DNS servers defined for the group.
  + Send only specified domains over tunnel: Select this option if you want your protected DNS servers to resolve addresses for certain domains only. Then, specify those
    domains, separating domain names with commas. For example, example.com, example1.com. Use this option if you want your internal
    DNS servers to resolve names for internal domains, while external DNS servers handle all other Internet traffic.

###### AnyConnect Attributes

The AnyConnect attributes of a group policy define some SSL and connection settings used by the AnyConnect client for a remote
access VPN connection.

* SSL Settings

  + Enable Datagram Transport Layer Security (DTLS): Whether to allow the AnyConnect client to use two simultaneous tunnels: an SSL tunnel and a DTLS tunnel. Using DTLS avoids
    latency and bandwidth problems associated with some SSL connections and improves the performance of real-time applications
    that are sensitive to packet delays. If you do not enable DTLS, AnyConnect client users establishing SSL VPN connections connect
    with an SSL tunnel only.
  + DTLS Compression: Whether to compress Datagram Transport Layer Security (DTLS) connections for this group using LZS. DTLS Compression is disabled
    by default.
  + SSL Compression: Whether to enable data compression, and if so, the method of data compression to use, Deflate, or LZS. SSL Compression is Disabled by default. Data compression speeds up transmission rates but also increases the memory requirement and CPU usage for each
    user session. Therefore, SSL compression decreases the overall throughput of the device.
  + SSL Rekey Method, SSL Rekey Interval: The client can rekey the VPN connection, renegotiating the crypto keys and initialization vectors, to increase the security
    of the connection. Disable rekeying by selecting None. To enable rekey, select New Tunnel to create a new tunnel each time. (The Existing Tunnel option results in the same action as New Tunnel.) If you enable rekeying, also set the rekey interval, which is 4 minutes by default. You can set the interval to 4-10080
    minutes (1 week).
* Connection Settings

  + Ignore the DF (Don't Fragment) bit: Whether to ignore the Don't Fragment (DF) bit in packets that need fragmentation. Select this option to allow the forced
    fragmentation of packets that have the DF bit set, so that these packets can pass through the tunnel.
  + Client Bypass Protocol - Allows you to configure how the secure gateway manages IPv4 traffic (when it is expecting only IPv6 traffic), or how it
    manages IPv6 traffic (when it is expecting only IPv4 traffic).

    When the AnyConnect client makes a VPN connection to the headend, the headend assigns it an IPv4, IPv6, or both an IPv4 and
    IPv6 address. If the headend assigns the AnyConnect connection only an IPv4 address or only an IPv6 address, you can configure
    the Client Bypass Protocol to drop network traffic for which the headend did not assign an IP address (default, disabled,
    not checked), or allow that traffic to bypass the headend and be sent from the client unencrypted or "in the clear" (enabled,
    checked).

    For example, assume that the secure gateway assigns only an IPv4 address to an AnyConnect connection and the endpoint is dual-stacked.
    When the endpoint attempts to reach an IPv6 address, if Client Bypass Protocol is disabled, the IPv6 traffic is dropped; however,
    if Client Bypass Protocol is enabled, the IPv6 traffic is sent from the client in the clear.
  + MTU: The maximum transmission unit (MTU) size for SSL VPN connections established by the Cisco AnyConnect VPN Client. The default
    is 1406 bytes. The range is 576 to 1462 bytes.

    - Keepalive Messages Between AnyConnect and VPN Gateway: Whether to exchange keepalive messages between peers to demonstrate that they are available to send and receive data in
      the tunnel. Keepalive messages transmit at set intervals. The default interval is 20 seconds, and the valid range is 15 to
      600 seconds.
    - DPD on Gateway Side Interval, DPD on Client Side Interval: Enable Dead Peer Detection (DPD) to ensure that the VPN gateway or VPN client quickly detects when the peer is no longer
      responding. You can separately enable gateway or client DPD. The default interval is 30 seconds for sending DPD messages.
      The interval can be 5-3600 seconds.

###### Traffic Filters Attributes

The traffic filter attributes of a group policy define restrictions you want to place on users assigned to the group. You
can use these attributes instead of creating access control policy rules to restrict RA VPN users to specific resources, based
on host or subnet address and protocol, or VLAN. By default, RA VPN users are not restricted by the group policy from accessing
any destination on your protected network.

* Access List Filter: Restrict access using an extended access control list (ACL). Select the Smart CLI Extended ACL object. The extended ACL
  lets you filter based on source address, a destination address, and protocol (such as IP or TCP). ACLs are evaluated on a
  top-down, first-match basis, so ensure that you place specific rules before more general rules. There is an implicit "deny
  any" at the end of the ACL, so if you intend to deny access to a few subnets while allowing all other access, ensure that
  you include a "permit any" rule at the end of the ACL. Because you cannot create network objects while editing an extended
  ACL Smart CLI object, you should create the ACL before editing the group policy. Otherwise, you might need to simply create
  the object, then go back later to create the network objects and then all the access control entries that you need. To create
  the ACL, log in to firewall device manager, go to Device > Advanced Configuration > Smart CLI > Objects, create an object, and select Extended Access List as the object type.
* Restrict VPN to VLAN: Also called "VLAN mapping," this attribute specifies the egress VLAN interface for sessions to which this group policy applies.
  The system forwards all traffic from this group to the selected VLAN. Use this attribute to assign a VLAN to the group policy
  to simplify access control. Assigning a value to this attribute is an alternative to using an ACL to filter traffic on a session.
  Ensure that you specify a VLAN number that is defined on a subinterface on the device. Values range from 1 to 4094.

###### Windows Browser Proxy Attributes

The Windows browser proxy attributes of a group policy determine how, and whether, a proxy defined on the user's browser operates.

You can select one of the following values for Browser Proxy During VPN Session:

* No change in endpoint settings: Allow the user to configure (or not configure) a browser proxy for HTTP and use the proxy if it is configured.
* Disable browser proxy: Do not use the proxy defined for the browser, if any. No browser connections will go through the proxy.
* Auto detect settings: Enable the use of automatic proxy server detection in the browser for the client device.
* Use custom settings: Define a proxy that should be used by all client devices for HTTP traffic. Configure the following settings:

  + Proxy Server IP or Hostname, Port: The IP address, or hostname, of the proxy server, and the port used for proxy connections by the proxy server. The host
    and port combined cannot exceed 100 characters.
  + Browser Proxy Exemption List: Connections to the hosts/ports in the exemption list do not go through the proxy. Add all the host/port values for destinations
    that should not use the proxy. For example, [www.example.com](http://www.example.com/) port 80. Click Add proxy exemption to add items to the list. Click the trash can icon to delete items. The entire proxy exception list, combining all addresses
    and ports, cannot be longer than 255 characters.

###### Create an RA VPN Configuration

Security Cloud Control allows you to add one or more FDM-managed devices to the RA VPN configuration wizard and configure the VPN interfaces, access control, and NAT exemption settings associated
with the devices. Therefore, each RA VPN configuration can have connection profiles and group policies shared across multiple
FDM-managed devices that are associated with the RA VPN configuration. Further, you can enhance the configuration by creating connection
profiles and group policies.

You can either onboard an FDM-managed device that has already been configured with RA VPN settings or a new device without RA VPN settings. When you onboard an
FDM-managed device that already has RA VPN settings, Security Cloud Control automatically creates a "Default RA VPN Configuration" and associates the FDM-managed device with this configuration. Also, this default configuration can contain all the connection profile objects that are
defined on the device.

| **Important** | ---  * You are not allowed to add ASA and FDM-managed device in the same Remote Access VPN Configuration. * An FDM-managed device can't have more than one RA VPN Configuration.  --- |
| --- | --- |

###### Prerequisites

Before adding the FDM-managed devices to RA VPN configuration, the following prerequisites must be met:

* Make sure that the FDM-managed devices have the following:

  + A valid license. For more information, see [Licensing Requirements for Remote Access VPN](#Licensing_Requirements_for_Remote_Access_VPN).
  + For FDM Version 6.4.0, ensure that a minimum of one AnyConnect software package pre-uploaded to the device. For more information,
    see [Upload AnyConnect Software Packages to Firepower Threat Defense Devices version 6.4.0](#Upgrade_AnyConnect_Package_on_an_FTD_Version_64).
  + For FDM Version 6.5.0 and later, you can upload AnyConnect package using Security Cloud Control. For more information, see [Upload AnyConnect Software Packages to Firepower Threat Defense Devices version 6.5.0](#Upload_AnyConnect_Software_Packages_to_an_FTD_Device_Running_FTD_Version_65_or_Later).
  + There are no configuration deployments pending.
* FDM changes are synchronized to Security Cloud Control.

  1. In the left pane, click Security Devices and search for one or more FDM-managed devices to be synchronized.
  2. Select one or more devices and then click Check for changes. Security Cloud Control communicates with one or more FDM-managed devices to synchronize the changes.
* RA VPN configuration group policy objects are consistent.

  + Ensure that all inconsistent group policy objects are resolved as they cannot be added to the RA VPN configuration. Either
    address the issue or remove inconsistent group policy objects from the Objects page. For more information see, [Resolve Duplicate Object Issues](troubleshooting.html#Resolve_Duplicate_Object_Issues) and [Resolve Inconsistent Object Issues](troubleshooting.html#Resolve_Inconsistent_Object_Issues).
* RA VPN group policies of the FDM-managed device match RA VPN configuration group policies.

* [Procedure](#Procedure)
* [Modify RA VPN Configuration](#Modify_RA_VPN_Configuration)

###### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Remote Access VPN > ASA & FDM. |
| --- | --- |
| **Step 2** | Click the blue plus  button to create a new RA VPN configuration. |
| **Step 3** | Enter a name for the Remote Access VPN configuration. |
| **Step 4** | Click the blue plus  button to add FDM-managed devices to the configuration. You can add the device details and configure network traffic-related permissions that are associated with the device.   1. Provide the following device details:     * Device: Select an FDM-managed device that you want to add and click Select.             | **Important** | You are not allowed to add ASA and FDM-managed device in the same Remote Access VPN Configuration. |      | --- | --- |    * Certificate of Device Identity: Select the internal certificate used for establishing the identity of the device. This establishes the device identity for      AnyConnect clients when they make a connection to the device. Clients must accept this certificate to complete a secure VPN      connection. If you do not already have a certificate, click Create New Internal Certificate in the drop-down list. See [Generating Self-Signed Internal and Internal CA Certificates](#Generating_SelfSigned_Internal_and_Internal_CA_Certificates).    * Outside Interface: The interface to which users connect when making the remote access VPN connection. Although this is normally the outside      (internet-facing) interface, choose whichever interface is between the device and the end-users you are supporting with this      connection profile. To create a new subinterface, see [Configure Firepower VLAN Subinterfaces and 802.1Q Trunking](#Configure_Firepower_VLAN_Subinterfaces_and_821Q_Trunking).    * Fully Qualified Domain Name or IP for the Outside Interface: The name of the interface, for example, ravpn.example.com or the IP address must be provided. If you specify a name, the      system can create a client profile for you. Note: You are responsible for ensuring that the DNS servers used in the VPN and by clients can resolve this name to the outside      interface's IP address. Add the FQDN to the relevant DNS servers. 2. Click Continue to configure the traffic permissions.     * Bypass Access Control policy for decrypted traffic (sysopt permit-vpn): Decrypted traffic is subjected to Access Control Policy inspection by default. Enabling this option bypasses the decrypted      traffic option bypasses the access control policy inspection, but the VPN Filter ACL and the authorization ACL downloaded      from the AAA server are still applied to VPN traffic. Note that if you select this option, the system configures the sysopt      connection permit-vpn command, which is a global setting. This will also impact the behavior of site-to-site VPN connections.      If you do not select this option, it might be possible for external users to spoof IP addresses in your remote access VPN      address pool, and thus gain access to your network. This can happen because you will need to create access control rules that      allow your address pool to have access to internal resources. If you use access control rules, consider using user specifications      to control access, rather than source IP address alone. The downside of selecting this option is that the VPN traffic will      not be inspected, which means that intrusion and file protection, URL filtering, or other advanced features will not be applied      to the traffic. This also means that no connection events will be generated for the traffic, and thus statistical dashboards      will not reflect VPN connections.    * NAT Exempt: Enable NAT Exempt to exempt traffic to and from the remote access VPN endpoints from NAT translation. If you do not exempt      VPN traffic from NAT, ensure that the existing NAT rules for the outside and inside interfaces do not apply to the RA VPN      pool of addresses. NAT exempt rules are manual static identity NAT rules for a given source/destination interface and network      combination, but they are not reflected in the NAT policy, they are hidden. If you enable NAT Exempt, you must also configure      the following.       + Inside Interfaces: Select the interfaces for the internal networks remote users will be accessing. NAT rules are created for these interfaces.      + Inside Networks: Select the network objects that represent internal networks remote users will be accessing. The networks list must contain        the same IP types as the address pools you are supporting. |
| **Step 5** | Click **OK**.   * If you have onboarded an firewall device manager Version 6.4.0 device, the AnyConnect Packages Detected shows the AnyConnect packages available in the device. * If you have onboarded an firewall device manager Version 6.5.0 or later device, you must add the AnyConnect packages from the server where the AnyConnect packages are pre-uploaded.   See [Upload AnyConnect Software Packages to an FDM-Managed Device Running Version 6.5.0](#Upload_AnyConnect_Software_Packages_to_an_FTD_Device_Running_FTD_Version_65_or_Later) for instructions. |
| **Step 6** | Click OK. The device is added to the configuration. |

---

###### What to do next

| **Note** | ---   Select a configuration and under Actions, click the appropriate action:   --- |
| --- | --- |

* Group Policies to add or remove group policies.

  + Click + to select the required group policies. To create a new RA VPN group policy, see [Create New FTD RA VPN Group Policies](#Procedure).
* Remove to delete the selected RA VPN configuration.

###### Modify RA VPN Configuration

You can modify the name and the device details of an existing RA VPN configuration.

###### Procedure

---

| Select the configuration to be modified and under Actions, click Edit.   * Modify the name if required. * Click the blue plus  button to add a new device * Click  to perform the following on the FDM-managed device.    + Click Edit to modify the existing RA VPN configuration.   + Click Remove to remove the FDM-managed device from the RA VPN configuration. All connection profiles and RA VPN settings associated with that device except the     group policies are deleted. You can remove the group policies explicitly from the objects page. Note: You cannot remove the FDM-managed device if that is the only device using the configuration. Alternatively, you can remove the RA VPN configuration. |
| --- |

---

You can also search for remote access VPN configuration by typing the name of the configuration or device.

**Related Information:**

* [Configure an FTD RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile).
* [Review and deploy configuration changes to the devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be).
* [Allow Traffic Through the Remote Access VPN](#Allow_Traffic_Through_the_Remote_Access_VPN).

###### Configure an RA VPN Connection Profile

An RA VPN connection profile defines the characteristics that allow external users to create a
VPN connection to the system using the AnyConnect client. Each profile defines the AAA
servers and certificates used for authenticating users, the address pool for assigning
users IP addresses, and the group policies that define various user-oriented
attributes.

You can create multiple profiles within the RA VPN configuration if you need to provide variable services to different user
groups, or if you have various authentication sources. For example, if your organization merges with a different organization
that uses different authentication servers, you can create a profile for the new group that uses those authentication servers.

An RA VPN connection profile allows your users to connect to your inside networks when they are on external networks, such
as their home network. Create separate profiles to accommodate different authentication methods.

###### Before you begin

Before configuring the remote access (RA) VPN connection:

* The outside interface, the one that terminates remote access VPN connections, cannot also have a management access list that
  allows HTTPS connections. Delete any HTTPS rules from the outside interface before configuring RA VPN. See the "Configuring
  the Management Access List" section in the "System Settings" chapter of [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version X.Y](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor613).
* Create an RA VPN configuration. See [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration).

* [Procedure](#Procedure)
* [Configure AAA for a Connection Profile](#Configure_AAA_for_a_Connection_Profile)

###### Procedure

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Remote Access VPN > ASA & FDM. You can click a VPN configuration to view the summary information on how many connection profiles and group policies are currently configured. |
| --- | --- |
| **Step 2** | Click the connection profile and under Actions in the sidebar at the right, click Add Connection Profile. |
| **Step 3** | Configure the basic connection attributes.   * Connection Profile Name: The name for this connection, up to 50 characters without spaces. For example, MainOffice.       | **Note** | The name you enter here is what users will see in the connection list in the AnyConnect client. Choose a name that will make sense to your users. |   | --- | --- | * Group Alias, Group URL: Aliases contain alternate names or URLs for a specific connection profile. VPN users can choose an alias name in the AnyConnect   client in the list of connections when they connect to the FDM-managed device. The connection profile name is automatically added as a group alias. You can also configure the list of group URLs,   which your endpoints can select while initiating the Remote Access VPN connection. If users connect using the group URL, the   system will automatically use the connection profile that matches the URL. This URL would be used by clients who do not yet   have the AnyConnect client installed. Add as many group aliases and URLs as required. These aliases and URLs must be unique   across all connection profiles defined on the device. Group URLs must start with https://. * For example, you might have the alias Contractor and the group URL<https://ravpn.example.com/contractor>. Once the AnyConnect client is installed, the user would simply select the group alias in the AnyConnect VPN drop-down list   of connections. |
| **Step 4** | Configure the primary and optionally, secondary identity sources. These options determine how remote users authenticate to the device to enable the remote access VPN connection. The simplest approach is to use AAA only and then select an AD realm or use the LocalIdentitySource. You can use the following approaches for Authentication Type:   * AAA Only: Authenticate and authorize users based on username and password. For details, see [Configure AAA for a Connection Profile](#Configure_AAA_for_a_Connection_Profile). * Client Certificate Only: Authenticate users based on client device identity certificate. For details, see [Configure Certificate Authentication for a Connection Profile](#Configure_AAA_for_a_Connection_Profile__cca). * AAA and ClientCertificate: Use both username/password and client device identity certificate. |
| **Step 5** | Configure the address pool for clients. The address pool defines the IP addresses that the system can assign to remote clients when they establish a VPN connection. For more information, see [Configure Client Address Pool Assignment](#Configure_AAA_for_a_Connection_Profile__ccapool). |
| **Step 6** | Click Continue. |
| **Step 7** | Select the Group Policy to use for this profile from the list and click Select. The group policy sets terms for user connections after the tunnel is established. The system includes a default group policy named DfltGrpPolicy. You can create additional group policies to provide the services you require.   | **Note** | If the group policy you need does not yet exist, create the group policy on the Objects page and then associate the policy to the RA VPN configuration. For detailed information about group policies, see [Create New RA VPN Group Policies](#Procedure). | | --- | --- | |
| **Step 8** | Click Continue. |
| **Step 9** | Review the summary. First, verify that the summary is correct. You can see what end-users need to do to initially install the AnyConnect software and test that they can complete a VPN connection. Click  to copy the instructions to the clipboard, and then distribute them to your users. |
| **Step 10** | Click Done. |

---

###### What to do next

Ensure that traffic is allowed in the VPN tunnel, as explained in [Allow Traffic Through the Remote Access VPN](#Allow_Traffic_Through_the_Remote_Access_VPN).

###### Configure AAA for a Connection Profile

Authentication, Authorization, and Accounting (AAA) servers use username and password to determine if a user is allowed access
to the remote access VPN. If you use RADIUS servers, you can distinguish authorization levels among authenticated users, to
provide differential access to protected resources. You can also use RADIUS accounting services to keep track of usage.

When configuring AAA, you must configure a primary identity source. Secondary and fallback sources are optional. Use a secondary
source if you want to implement dual authentication, for example, using RSA tokens or DUO.

###### Primary Identity Source Options

* Primary Identity Source for User Authentication: The primary identity source used for authenticating remote users. End users must be defined in this source or the optional
  fallback source to complete a VPN connection. Select one of the following:

  + An Active Directory (AD) identity realm. If the realm you need does not yet exist, click Create New Identity Realm.
  + A RADIUS server group.
  + LocalIdentitySource (the local user database): You can define users directly on the device and not use an external server.
* Fallback Local Identity Source: If the primary source is an external server, you can select the LocalIdentitySource as a fallback in case the primary server
  is unavailable. If you use the local database as a fallback source, ensure that you define the same local usernames/passwords
  as the ones defined in the external server.
* Strip options: A realm is an administrative domain. Enabling the following options allows the authentication to be based on the username
  alone. You can enable any combination of these options. However, you must select both check boxes if your server cannot parse
  delimiters.

  + Strip Identity Source Server from Username: Whether to remove the identity source name from the username before passing the username on to the AAA server. For example,
    if you select this option and the user enters domain\username as the username, the domain is stripped off from the username
    and sent to AAA server for authentication. By default, this option is unchecked.
  + Strip Group from Username: Whether to remove the group name from the username before passing the username on to the AAA server. This option applies
    to names given in the username@domain format; the option strips the domain and @ sign. By default, this option is unchecked.

###### Secondary Identity Source

* Secondary Identity Source for User Authorization: The optional second identity source. If the user successfully authenticates with the primary source, the user is prompted
  to authenticate with the secondary source. You can select an AD realm, RADIUS server group, or the local identity source.
* Advanced options: Click the Advanced link and configure the following options:

  + Fallback Local Identity Source for Secondary: If the secondary source is an external server, you can select the LocalIdentitySource as a fallback in case the secondary
    server is unavailable. If you use the local database as a fallback source, ensure that you define the same local usernames/passwords
    as the ones defined in the secondary external server.
  + Use Primary Username for Secondary Login: By default, when using a secondary identity source, the system will prompt for both username and password for the secondary
    source. If you select this option, the system prompts for the secondary password only and uses the same username for the secondary
    source that was authenticated against the primary identity source. Select this option if you configure the same usernames
    in both the primary and secondary identity sources.

    - Username for Session Server: After successful authentication, the username is shown in events and statistical dashboards, is used for determining matches
      for a user- or group-based SSL decryption and access control rules and is used for accounting. Because you are using two authentication
      sources, you need to tell the system whether to use the Primary or Secondary username as the user identity. By default, the
      primary name is used.
    - Password Type: How to obtain the password for the secondary server. The default is Prompt, which means the user is asked to enter the password. Select Primary Identity Source Password to automatically use the password entered when the user authenticated to the primary server. Select Common Password to use the same password for every user, then enter that password in the Common Password field.
  + Authorization Server: The RADIUS server group that has been configured to authorize remote access, VPN users. After authentication is complete,
    authorization controls the services and commands available to each authenticated user. Authorization works by assembling a
    set of attributes that describe what the user is authorized to perform, their actual capabilities, and restrictions. Were
    you not to use authorization, authentication alone would provide the same access to all authenticated users. For information
    on configuring RADIUS for authorization, see [Control User Permissions and Attributes Using RADIUS and Group Policies](#Control_User_Permissions_and_Attributes_Using_RADIUS_and_Group_Policies). Note that if the system obtains authorization attributes from the RADIUS server that overlap those defined in the group
    policy, the RADIUS attributes override the group policy attributes.
  + Accounting Server: (Optional.) The RADIUS server group to use to account for the remote access VPN session. Accounting tracks the services
    users are accessing as well as the number of network resources they are consuming. The FDM-managed device reports user activity to the RADIUS server. Accounting information includes when sessions start and stop, usernames,
    the number of bytes that pass through the device for each session, the service used, and the duration of each session. You
    can then analyze the data for network management, client billing, or auditing. You can use accounting alone or together with
    authentication and authorization.

###### Configure Certificate Authentication for a Connection Profile

| **Note** | ---   This section is not applicable for Authentication Type as AAA Only.   --- |
| --- | --- |

You can use certificates installed on the client device to authenticate remote access VPN connections.

When using client certificates, you can still configure a secondary identity source, fallback source, and authorization and
accounting servers. These are AAA options; for details, see [Configure an RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile).

Following are the certificate-specific attributes. You can configure these attributes separately for primary and secondary
identity sources. Configuring a secondary source is optional.

* Username from Certificate: Select one of the following:

  + **Map Specific Field**: Use the certificate elements in the order of Primary Field and Secondary Field. The defaults are CN (Common Name) and OU (Organizational Unit). Select the options that work for your organization. The
    fields are combined to provide the username, and this is the name used in events, dashboards, and for matching purposes in
    SSL decryption and access control rules.
  + Use entire DN (distinguished name) as username: The system automatically derives the username from the DN fields. •
* Advanced options (not applicable for Authentication Type as Client Certificate Only): Click the Advanced link and configure the following options:

  + Prefill username from certificate on user login window: Whether to fill in the username field with the retrieved username when prompting the user to authenticate.
  + Hide username in login window: If you select the Prefill option, you can hide the username, which means the user cannot edit the username in the password prompt.

###### Configure Client Address Pool Assignment

There must be a way for the system to provide an IP address to endpoints that connect to the remote access VPN. The AAA server
can provide these addresses, a DHCP server, an IP address pool configured in the group policy, or an IP address pool configured
in the connection profile. The system tries these resources in that order and stops when it obtains an available address,
which it then assigns to the client. Thus, you can configure multiple options to create a failsafe in case of an unusual number
of concurrent connections.

Use one or more of the following methods to configure the address pool for a connection profile.

* IPv4 Address Pool and IPv4 Address Pool: First, create up to six network objects that specify subnets. You can configure separate pools for IPv4 and IPv6. Then,
  select these objects in the IPv4 Address Pool and IPv6 Address Pool options, either in the group policy or in the connection profile. You do not need to configure both IPv4 and IPv6, configure
  the addressing scheme you want to support. You also do not need to configure the pool in both the group policy and the connection
  profile. The group policy overrides the connection profile settings, so if you configure the pools in the group policy, leave
  the options empty in the connection profile. Note that the pools are used in the order in which you list them.
* DHCP Servers: First, configure a DHCP server with one or more IPv4 address ranges for the RA VPN (you cannot configure IPv6 pools using
  DHCP). Then, create a host network object with the IP address of the DHCP server. You can then select this object in the DHCP Servers attribute of the connection profile. You can configure more than one DHCP server. If the DHCP server has multiple address
  pools, you can use the DHCP Scope attribute in the group policy that you attach to the connection profile to select which pool to use. Create a host network
  object with the network address of the pool. For example, if the DHCP pool contains 192.168.15.0/24 and 192.168.16.0/24, setting
  the DHCP scope to 192.168.16.0 will ensure that an address from the 192.168.16.0/24 subnet will be selected.

###### Allow Traffic Through the Remote Access VPN

You can use one of the following techniques to enable traffic flow in the remote access VPN tunnel.

* Configure the sysopt connection permit-vpn command, which exempts traffic that matches the VPN connection from the access control policy. The default for this command
  is no sysopt connection permit-vpn, which means VPN traffic must also be allowed by the access control policy. This is the more secure method to allow traffic
  in the VPN because external users cannot spoof IP addresses in the remote access VPN address pool. The downside is that the
  VPN traffic will not be inspected, which means that intrusion and file protection, URL filtering, or other advanced features
  will not be applied to the traffic. This also means that no connection events will be generated for the traffic, and thus
  statistical dashboards will not reflect VPN connections. To configure this command, select the Bypass Access Control policy for decrypted traffic option in your RA VPN Configuration. See [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration).
* Create access control rules to allow connections from the remote access VPN address pool. This method ensures that VPN traffic
  is inspected, and advanced services can be applied to the connections. The downside is that it opens the possibility for external
  users to spoof IP addresses and thus gain access to your internal network. See [Configure the FDM Access Control Policy](#Configure_the_FTD_Access_Control_Policy).

###### Upgrade AnyConnect Package on an FDM-Managed Device Running Version 6.4.0

You can use Security Cloud Control to upgrade the AnyConnect package available on an FDM-managed device so that it can be distributed to RA VPN users.

The following are the major steps that are involved in upgrading the AnyConnect package:

###### Procedure

---

| **Step 1** | Use firewall device manager to remove the AnyConnect package and upload a later version of the package. Use one of these methods to accomplish this task.   * Remove the old package and upload the new package from the firewall device manager UI. * Remove the old package and upload the new package from the firewall device manager API explorer. |
| --- | --- |
| **Step 2** | Deploy firewall device manager changes to device. |
| **Step 3** | Read the new configuration information into Security Cloud Control. |
| **Step 4** | Verify the new package in the RA VPN connection profile. |

---

* [Prerequisites](#Prerequisites)
* [Upload your desired AnyConnect Package to Secure Firewall Threat Defense using Firewall Device Manager](#Upload_your_desired_AnyConnect_Package_to_FTD_using_FDM)
* [Verify the new package is referenced in the RA VPN connection profile](#Verify_the_new_package_is_referenced_in_the_RA_VPN_connection_profile)

###### Prerequisites

* A minimum of one RA VPN configuration with connection profile is already deployed to FDM-managed device.
* Download the AnyConnect package that you want from <https://software.cisco.com/download/home/283000185>. Cisco recommends upgrading to the latest available package.

###### Upload your desired AnyConnect Package to Secure Firewall Threat Defense using Firewall Device Manager

###### Procedure

---

| **Step 1** | Using a browser, open the home page of the system. For example, [https://ftd.example.com](https://ftd.example.com/). |
| --- | --- |
| **Step 2** | Log into Firewall Device Manager. |
| **Step 3** | Click View Configuration in the Device > Remote Access VPN group. The group shows summary information on how many connection profiles and group policies are currently configured. |
| **Step 4** | Click the view () button (View configuration button.) to open a summary of the connection profile and connection instructions.   | **Note** | You can edit any one of the connection profiles to upload the AnyConnect package to the FDM-managed device. | | --- | --- | |
| **Step 5** | Click the Edit button to make changes. |
| **Step 6** | Click Next until the Global Settings screen appears. The AnyConnect Package shows AnyConnect packages available on the FDM-managed device. |
| **Step 7** | Click 'X' button to remove the AnyConnect package which you want to replace. |
| **Step 8** | Click Upload Package and then click the OS that you want for uploading the compatible package. |
| **Step 9** | Select the package and click Open. You can see the package being uploaded on the Firewall device manager UI. |
| **Step 10** | Click Finish. The configuration is saved.   | **Note** | Alternatively, you can use the Firewall device manager API explorer to remove and upload a new AnyConnect package. | | --- | --- |  1. Edit the URL to point to /#/api-explorer, for example, <https://ftd.example.com/#/api-explorer>. 2. Delete a package from the FDM-managed device, click AnyConnectPackageFile > Delete. In the objID field, type the package id and click TRY IT OUT!. 3. Upload a new package by performing the steps that are described in the [Upload AnyConnect Software Packages to Firepower Threat Defense Devices](#Upload_AnyConnect_Software_Packages_to_an_FTD_Version_64) section. |
| **Step 11** | Click the Deploy Changes icon in the upper right of the web page. The icon is highlighted with a dot when there are undeployed changes. |
| **Step 12** | If you are satisfied with the changes, you can click Deploy Now to start the job immediately. The window shows that the deployment is in progress. You can close the window, or wait for the deployment to complete. |

---

###### Verify the new package is referenced in the RA VPN connection profile

###### Procedure

---

| **Step 1** | In the left pane, click Secure Connections > Remote Access VPN > ASA & FDM. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the FDM-managed device which has the upgraded AnyConnect package. This device would be reporting conflict. |
| **Step 4** | Accept the Out-of-band changes to overwrite the configuration and any pending changes stored on Security Cloud Control with the device's running configuration. For more information, see [Resolve "Conflict Detected Status."](#ResolveConflict_Detected_Status) |
| **Step 5** | View the new AnyConnect package by performing the following:   * Click VPN > Remote Access VPN. * Click the RA VPN configuration that is associated with this FDM-managed device. * Click Edit under Actions. The new package is displayed under Devices. |

---

###### Upload RA VPN AnyConnect Client Profile

The Remote Access VPN AnyConnect Client Profile is a group of configuration parameters stored in a file. There are different
AnyConnect client profiles containing configuration settings for the core client VPN functionality and for the optional client
modules Network Access Manager, AMP Enabler, ISE posture, Network Visibility, Customer Feedback Experience profiles, Umbrella
roaming security, and Web Security.

Security Cloud Control allows uploading of these profiles as objects which can be used in the group policy later.

* AnyConnect VPN Profile — AnyConnect client profiles are downloaded to clients along with the VPN AnyConnect client software. These profiles define
  many client-related options, such as auto-connect on startup and auto-reconnect, and whether the end-user can change the option
  from the AnyConnect client preferences and advanced settings. Security Cloud Control supports the XML file format.
* AMP Enabler Service Profile — The profile is used for the AnyConnect AMP Enabler. The AMP Enabler and this profile are pushed to the endpoints from FDM-managed device when a remote access VPN user connects to the VPN. Security Cloud Control supports XML and ASP file formats.
* Feedback Profile — You can add a Customer Experience Feedback profile and select this type to receive information about the features and modules
  customers have enabled and used. Security Cloud Control supports the FSP file format.
* ISE Posture Profile — Choose this option if you add a profile file for the AnyConnect ISE Posture module. Security Cloud Control supports XML and ISP file formats.
* Network Access Manager Service Profile — Configure and add the NAM profile file using the Network Access Manager profile editor. Security Cloud Control supports XML and NSP file formats.
* Network Visibility Service Profile — Profile file for AnyConnect Network Visibility module. You can create the profile using the NVM profile editor. Security Cloud Control supports XML and NVMSP file formats.
* Umbrella Roaming Security Profile — You must select this file type if you deploy the Umbrella Roaming Security module. Security Cloud Control supports XML and JSON file formats.
* Web Security Service Profile — Select this file type when you add a profile file for the Web security module. Security Cloud Control supports XML, WSO, and WSP file formats.

###### Before you begin

Use the suitable GUI-based AnyConnect profile editors to create the profiles you need. You can download the profile editors
from [Cisco Software Download Center](https://software.cisco.com/download/release.html?mdfid=286281283&flowid=72322&softwareid=282364313) in the AnyConnect Secure Mobility Client category and install the AnyConnect “Profile Editor - Windows / Standalone installer
(MSI).” The profile editor installer contains stand-alone versions of the profile editors. The installation file is for Windows
only and has the file name anyconnect-profileeditor-win-<version>-k9.msi, where <version> is the AnyConnect version. For example,
anyconnect-profileeditor-win-4.3.04027-k9.msi. You must also install Java JRE 1.6 (or higher) before installing the profile
editor.

Except for the Umbrella Roaming Security profile editor, this package contains all the profile editors required for creating
the modules. For detailed information, see the *AnyConnect Profile Editor* chapter in the appropriate release of the [Cisco AnyConnect Secure Mobility Client Administrator Guide](http://www.cisco.com/c/en/us/support/security/anyconnect-secure-mobility-client/products-installation-and-configuration-guides-list.html) for details. Download the Umbrella Roaming Security profile separately from the Umbrella dashboard. For detailed information,
see the "Download the AnyConnect Roaming Security Profile from the Umbrella Dashboard" section of the "Umbrella Roaming Security"
chapter in the [Cisco Umbrella User Guide](https://docs.umbrella.com/deployment-umbrella/docs/before-you-begin).

###### Procedure

---

| **Step 1** | In the left pane, choose Objects. |
| --- | --- |
| **Step 2** | Click the blue plus  button. |
| **Step 3** | Click RA VPN Objects (ASA & FDM) > AnyConnect Client Profile. |
| **Step 4** | In the Object Name field, enter a name for the AnyConnect client profile. |
| **Step 5** | Click Browse and select the file you created using the Profile Editor. |
| **Step 6** | Click Open to upload the profile. |
| **Step 7** | Click Add to add the object. |

---

**Related information:**

* Associate the client modules with the AnyConnect VPN profile in the RA VPN group policies window. See
  [Create New FTD RA VPN Group Policies](#Procedure).

  | **Note** | ---   The client module association is supported by all ASA versions and FDM running software version 6.7 or later.   --- |
  | --- | --- |

###### Guidelines and Limitations of Remote Access VPN for FDM-Managed Device

Keep the following guidelines and limitations in mind when configuring RA VPN.

* AnyConnect packages must be pre-loaded to FDM-Managed devices running Version 6.4.0 using firewall device manager.

| **Note** | ---   Upload AnyConnect package separately to the FDM-Managed device running Version 6.5.0 using the Remote Access VPN Configuration wizard in Cisco Security Cloud Control.   --- |
| --- | --- |

* Before configuring RA VPN from Security Cloud Control:

  + Register the license for the FDM-managed devices from firewall device manager.
  + Enable the license from firewall device manager with export-control.
* Security Cloud Control does not support the Extended Access List object. Configure the object using the Smart CLI in firewall device manager and then use in VPN filter and Change of Authorization (CoA) redirect ACL.
* The template you create from an FDM-managed device will not contain the RA VPN configuration.
* Device-specific overrides are required for IP pool objects and RADIUS identity sources.
* You cannot configure both firewall device manager access (HTTPS access in the management access-list) and AnyConnect remote access SSL VPN on the same interface for the same
  TCP port. For example, if you configure remote access SSL VPN on the outside interface, you cannot also open the outside interface
  for HTTPS connections on port 443. Because you cannot configure the port used by these features in firewall device manager, you cannot configure both features on the same interface.
* If you configure two-factor authentication using RADIUS and RSA tokens, the default authentication timeout of 12 seconds is
  too quick to allow successful authentication in most cases. Increase the authentication timeout value by creating a custom
  AnyConnect client profile and applying it to the RA VPN connection profile, as described in [Upload RA VPN AnyConnect Client Profile](#Create_an_AnyConnectClient_Profile_Object). We recommend an authentication timeout of at least 60 seconds so that users have enough time to authenticate and then paste
  the RSA token and for the round-trip verification of the token.

###### How Users Can Install the AnyConnect Client Software on FDM-Managed Device

Use firewall device manager APIs to upload the AnyConnect Client Software package to FDM-managed device to distribute to your users. See [Upload AnyConnect Software Packages to Firepower Threat Defense Devices](#Upload_AnyConnect_Software_Packages_to_an_FTD_Version_64).

To complete a VPN connection, your users must install the AnyConnect client software. You can use your existing software distribution
methods to install the software directly. Or, you can have users install the AnyConnect client directly from the FDM-managed device.

| **Note** | ---   Users must have Administrator rights on their workstations to install the software.   --- |
| --- | --- |

If you decide to have users initially install the software from the FDM-managed device, inform users to perform the following steps:

| **Note** | ---   Android and iOS users should download AnyConnect from the appropriate App Store.   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Using a web browser, open **https://***ravpn-address*, where *ravpn-address* is the IP address or hostname of the outside interface on which you are allowing VPN connections. You identify this interface when you configure the remote access VPN. The system prompts the user to log in. |
| --- | --- |
| **Step 2** | Log into the site. Users are authenticated using the directory server configured for the remote access VPN. Log in must be successful to continue. If the login is successful, the system determines if the user already has the required version of the AnyConnect client. If the AnyConnect client is absent from the user's computer or is down-level, the system automatically starts installing the AnyConnect software. When the installation is finished, AnyConnect completes the remote access VPN connection. |

---

* [Distribute new AnyConnect Client Software version](#Distributenew_AnyConnect_Client_Software_version)

###### Distribute new AnyConnect Client Software version

You can distribute the new version of AnyConnect client software to your users by uploading them to FDM-managed device without removing the old version. Once the AnyConnect client is uploaded successfully, you can remove the old version.

The AnyConnect client detects the new version on the next VPN connection the user makes. The system will automatically prompt
the user to download and install the updated client software. This automation simplifies software distribution for you and
your clients.

The following figure shows an example of an FDM-managed device with two versions of AnyConnect client software (AnyConnectWindows\_3.2\_BGL and AnyConnectWindows\_4.2\_BGL) for Windows OS.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453588.jpg)

###### Upload RA VPN AnyConnect Client Profile

The Remote Access VPN AnyConnect Client Profile is a group of configuration parameters stored in a file. There are different
AnyConnect client profiles containing configuration settings for the core client VPN functionality and for the optional client
modules Network Access Manager, AMP Enabler, ISE posture, Network Visibility, Customer Feedback Experience profiles, Umbrella
roaming security, and Web Security.

Security Cloud Control allows uploading of these profiles as objects which can be used in the group policy later.

* AnyConnect VPN Profile — AnyConnect client profiles are downloaded to clients along with the VPN AnyConnect client software. These profiles define
  many client-related options, such as auto-connect on startup and auto-reconnect, and whether the end-user can change the option
  from the AnyConnect client preferences and advanced settings. Security Cloud Control supports the XML file format.
* AMP Enabler Service Profile — The profile is used for the AnyConnect AMP Enabler. The AMP Enabler and this profile are pushed to the endpoints from FDM-managed device when a remote access VPN user connects to the VPN. Security Cloud Control supports XML and ASP file formats.
* Feedback Profile — You can add a Customer Experience Feedback profile and select this type to receive information about the features and modules
  customers have enabled and used. Security Cloud Control supports the FSP file format.
* ISE Posture Profile — Choose this option if you add a profile file for the AnyConnect ISE Posture module. Security Cloud Control supports XML and ISP file formats.
* Network Access Manager Service Profile — Configure and add the NAM profile file using the Network Access Manager profile editor. Security Cloud Control supports XML and NSP file formats.
* Network Visibility Service Profile — Profile file for AnyConnect Network Visibility module. You can create the profile using the NVM profile editor. Security Cloud Control supports XML and NVMSP file formats.
* Umbrella Roaming Security Profile — You must select this file type if you deploy the Umbrella Roaming Security module. Security Cloud Control supports XML and JSON file formats.
* Web Security Service Profile — Select this file type when you add a profile file for the Web security module. Security Cloud Control supports XML, WSO, and WSP file formats.

###### Before you begin

Use the suitable GUI-based AnyConnect profile editors to create the profiles you need. You can download the profile editors
from [Cisco Software Download Center](https://software.cisco.com/download/release.html?mdfid=286281283&flowid=72322&softwareid=282364313) in the AnyConnect Secure Mobility Client category and install the AnyConnect “Profile Editor - Windows / Standalone installer
(MSI).” The profile editor installer contains stand-alone versions of the profile editors. The installation file is for Windows
only and has the file name anyconnect-profileeditor-win-<version>-k9.msi, where <version> is the AnyConnect version. For example,
anyconnect-profileeditor-win-4.3.04027-k9.msi. You must also install Java JRE 1.6 (or higher) before installing the profile
editor.

Except for the Umbrella Roaming Security profile editor, this package contains all the profile editors required for creating
the modules. For detailed information, see the *AnyConnect Profile Editor* chapter in the appropriate release of the [Cisco AnyConnect Secure Mobility Client Administrator Guide](http://www.cisco.com/c/en/us/support/security/anyconnect-secure-mobility-client/products-installation-and-configuration-guides-list.html) for details. Download the Umbrella Roaming Security profile separately from the Umbrella dashboard. For detailed information,
see the "Download the AnyConnect Roaming Security Profile from the Umbrella Dashboard" section of the "Umbrella Roaming Security"
chapter in the [Cisco Umbrella User Guide](https://docs.umbrella.com/deployment-umbrella/docs/before-you-begin).

###### Procedure

---

| **Step 1** | In the left pane, choose Objects. |
| --- | --- |
| **Step 2** | Click the blue plus  button. |
| **Step 3** | Click RA VPN Objects (ASA & FDM) > AnyConnect Client Profile. |
| **Step 4** | In the Object Name field, enter a name for the AnyConnect client profile. |
| **Step 5** | Click Browse and select the file you created using the Profile Editor. |
| **Step 6** | Click Open to upload the profile. |
| **Step 7** | Click Add to add the object. |

---

**Related information:**

* Associate the client modules with the AnyConnect VPN profile in the RA VPN group policies window. See
  [Create New FTD RA VPN Group Policies](#Procedure).

  | **Note** | ---   The client module association is supported by all ASA versions and FDM running software version 6.7 or later.   --- |
  | --- | --- |

###### Licensing Requirements for Remote Access VPN

Enable (register) the license for the FDM-managed devices from firewall device manager to configure RA VPN connection. When you register the device, you must do so with a Smart Software Manager (SSM) account
that is enabled for export-controlled features. You also cannot configure the feature using the evaluation license.

Also, you must purchase and enable a license; it can be any of the following: . These licenses are treated the same for FDM-managed devices, although they are designed to allow different feature sets when used with ASA Software-based headends.

For more information about enabling license from firewall device manager, see the Licensing Requirements for Remote Access VPN section of the Remote Access VPN chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor531) for the version your device is running.

For more information, see the [*Cisco AnyConnect Ordering Guide*](https://www.cisco.com/c/en/us/products/collateral/security/anyconnect-og.html). There are also other data sheets available on [http://www.cisco.com/c/en/us/product...t-listing.html](https://www.cisco.com/c/en/us/products/security/anyconnect-secure-mobility-client/datasheet-listing.html).

To view the license status, perform the following:

###### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices device. |
| **Step 3** | Click the FTD tab and select a device that you want. |
| **Step 4** | In the Device Actions pane on the right, click Manage Licenses. If the license is valid, the Status  shows Enabled. |

---

###### Maximum Concurrent VPN Sessions By Device Model

There is a maximum limit to the number of concurrent remote access VPN sessions allowed on a device based on the device model.
This limit is designed, so that system performance does not degrade to unacceptable levels. Use these limits for capacity
planning.

| Device Model | Maximum Concurrent Remote Access VPN Sessions |
| --- | --- |
| Firepower 2110 | 1,500 |
| Firepower 2120 | 3,500 |
| Firepower 2130 | 7,500 |
| Firepower 2140 | 10,000 |
| Firepower Threat Defense Virtual | 250 |

###### RADIUS Change of Authorization

The RADIUS Change of Authorization (CoA) feature provides a mechanism to change the attributes of authentication, authorization,
and accounting (AAA) session after it is authenticated. A key challenge for RA VPNs is to secure the internal network against
compromised endpoints and to secure the endpoint itself when it is affected by viruses or malware, by remediating the attack
on the endpoint. There is a need to secure the endpoint and the internal network in all phases, that is, before, during, and
after the RA VPN session. The RADIUS CoA feature helps in achieving this goal.

If you use Cisco Identity Services Engine (ISE) RADIUS servers, you can configure Change of Authorization policy enforcement.
When a policy changes for a user or user group in AAA, ISE sends CoA messages to the FDM-managed device to reinitialize authentication and apply the new policy. An Inline Posture Enforcement Point (IPEP) is not required
to apply access control lists (ACLs) for each VPN session established with the FDM-managed device.

* [Configure Change of Authorization on the FDM-Managed Device](#Configure_Change_of_Authorization_on_the_FTD_Device)

**Related Information:**

* [Configure Change of Authorization on the FDM-Managed Device](#Configure_Change_of_Authorization_on_the_FTD_Device)

###### Configure Change of Authorization on the FDM-Managed Device

Most of the Change of Authorization policy is configured in the ISE server. However, you must configure the FDM-managed device to connect to ISE correctly.

###### Before you begin

If you use hostnames in any object, ensure that you configure DNS servers for use with the data interfaces, as explained in
Configuring DNS for Data and Management Interfaces section of the System Settings chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running.You typically need to configure DNS anyway to have a fully-functional system.

* [Procedure](#Procedure)

###### Procedure

###### Procedure

---

| **Step 1** | Log in to the firewall device manager for your FDM-managed device. |
| --- | --- |
| **Step 2** | Configure the extended access control list (ACL) for redirecting initial connections to ISE. The purpose of the redirect ACL is to send initial traffic to ISE so that ISE can assess the client posture. The ACL should send HTTPS traffic to ISE, but not traffic that is already destined for ISE, or traffic that is directed to a DNS server for name resolution. A sample redirect ACL might look like the following:  access-list redirect extended deny ip any host <ISE server IP>   access-list redirect extended deny ip any host <DNS server IP>   access-list redirect extended deny icmp any any   access-list redirect extended permit tcp any any eq www However, note that ACLs have an implicit "deny any any" as the last access control entry (ACE). In this example, the last ACE, which matches TCP port www (that is, port 80), will not match any traffic that matches the first 3 ACEs, so those are redundant. You could simply create an ACL with the last ACE and get the same results. Note that in a redirect ACL, the permit and deny actions simply determine which traffic matches the ACL, with permit matching and deny not matching. No traffic is actually dropped, denied traffic is simply not redirected to ISE. To create the redirect ACL, you need to configure a Smart CLI object.   1. Choose Device > Advanced Configuration > Smart CLI > Objects. 2. Click + to create a new object. 3. Enter a name for the ACL. For example, redirect. 4. For CLI Template, select Extended Access List. 5. Configure the following in the Template body:     * configure access-list-entry action = permit    * source-network = any-ipv4    * destination-network = any-ipv4    * configure permit port = any-source    * destination-port = HTTP    * configure logging = disabled  The ACE should look like the following: 6. Click OK.  This ACL will be configured the next time you deploy changes. You do not need to use the object in any other policy to force    deployment.         | **Note** | This ACL applies to IPv4 only. If you also want to support IPv6, simply add a second ACE with all the same attributes, except select any-ipv6 for the source and destination networks. You can also add the other ACEs to ensure traffic to the ISE or DNS server is not redirected. You will first need to create host network objects to hold the IP addresses of those servers. |    | --- | --- | |
| **Step 3** | Configure a RADIUS server group for dynamic authorization.  Perform the below steps by following the instructions provided in the [Create or Edit a Firepower Threat Defense RADIUS Server Object or Group](#Create_or_Edit_an_FTD_RADIUS_Server_Object_or_Group) section.   1. Create a RADIUS Server Object 2. Create a RADIUS Server Group |
| **Step 4** | Create a connection profile that uses this RADIUS server group. See [Configure an RA VPN Connection Profile](#Configure_an_FTD_RA_VPN_Connection_Profile). Use AAA Authentication (either only or with certificates), and select the server group in the Primary Identity Source for User Authentication, Authorization, and Accounting options. |

---

###### Verify Remote Access VPN Configuration of FDM-Managed Device

After you configure the remote access VPN and deploy the configuration to the device, verify that you can make remote connections.

###### Procedure

---

| **Step 1** | From an external network, establish a VPN connection using the AnyConnect client. Using a web browser, open https://*ravpn-address*, where *ravpn-address* is the IP address or hostname of the outside interface on which you are allowing VPN connections. If necessary, install the client software and complete the connection. See [How Users Can Install the AnyConnect Client Software on FTD](#Procedure). If you configured group URLs, also try those URLs. |
| --- | --- |
| **Step 2** | In the Security Devices page, select the device you want to verify and click Command Line Interface under Device Actions. |
| **Step 3** | Use the show vpn-sessiondb command to view summary information about current VPN sessions. |
| **Step 4** | The statistics should show your active AnyConnect Client session, and information on cumulative sessions, the peak concurrent number of sessions, and inactive sessions. Following is sample output from the command. |
| **Step 5** | Use the show vpn-sessiondb anyconnect command to view detailed information about current AnyConnect VPN sessions. Detailed information includes encryption used, bytes transmitted and received, and other statistics. If you use your VPN connection, you should see the bytes transmitted/received numbers change as you re-issue this command. |

---

###### View Remote Access VPN Configuration Details of FDM-Managed Device

###### Procedure

---

| **Step 1** | In the left pane, click VPN > Remote Access VPN Configuration. |
| --- | --- |
| **Step 2** | Click on a VPN configuration object present.  The group shows summary information on how many connection profiles and group policies are currently configured.   * Expand the RA VPN configuration to view all connection profiles associated with them.    + Click the add + button to add a new connection profile.   + Click the view button (  ) to open a summary of the connection profile and connection instructions. Under Actions, you can click Edit to modify the changes. * You can click one of the following options under Actions to perform additional tasks:    + Click Group Policies to assign/add group policies.   + Click a configuration object or connection profile that you no longer need and click Remove to delete. |

---

##### Monitor Remote Access Virtual Private Network Sessions

Remote access Virtual Private Network provides secure connections for remote users, such as mobile users or telecommuters.
Monitoring these connections provides important indicators of connection and user session performance at a glance. Security Cloud Control remote access VPN monitoring capabilities enable you to determine quickly whether remote access VPN problems exist and where
they exist. You can then apply this knowledge and use your network management tools to reduce or eliminate problems for your
network and users. You can also disconnect remote access VPN sessions as needed.

The Remote Access Virtual Private Monitoring page provides the following information:

* A list of active and historical sessions for up to a year.
* Shows intuitive graphical visuals to provide at-a-glance views from all active VPN headends managed by Security Cloud Control.
* The live session screen shows the most used operating system and VPN connection profile in the Security Cloud Control tenant. It also shows the average session duration and data uploaded and downloaded.
* Filtering capabilities to narrow your search based on criteria such as device type, device names, session length, and the
  amount of data transmitted and received.

* [Monitor Live AnyConnect Remote Access VPN Sessions](#Cisco_Task.dita_0df079f7-8437-4832-896b-b35af8457872)
* [Monitor Historical AnyConnect Remote Access VPN Sessions](#Cisco_Task.dita_dde3b002-d30f-4ccf-b1f0-6285baf3465f)
* [Search and Filter Remote Access VPN Sessions](#Search_and_Filter_Remote_Access_VPN_Sessions)
* [Customize the Remote Access VPN Monitoring View](#Customize_the_Remote_Access_VPN_Monitoring_View)
* [Export Remote Access VPN Sessions to a CSV File](#Export_RA_VPN_Sessions_to_a_CSV_File)
* [Remote Access VPN Dashboard](#virtual-private-network-dashboard)
* [Disconnect Remote Access VPN Sessions on FDM-Managed Device](#Disconnect_Active_Remote_Access_VPN_Sessions_on_FTD)

**Related Information:**

* [Monitor Live AnyConnect Remote Access VPN Sessions](#Cisco_Task.dita_0df079f7-8437-4832-896b-b35af8457872)
* [Monitor Historical AnyConnect Remote Access VPN Sessions](#Cisco_Task.dita_dde3b002-d30f-4ccf-b1f0-6285baf3465f)
* [Search and Filter RA VPN Sessions](#Search_and_Filter_Remote_Access_VPN_Sessions)
* [Customize the RA VPN Monitoring View](#Customize_the_Remote_Access_VPN_Monitoring_View)
* [Export RA VPN Sessions to a CSV File](#Export_RA_VPN_Sessions_to_a_CSV_File)
* [Disconnect Active RA VPN Sessions on FTD](#Disconnect_Active_Remote_Access_VPN_Sessions_on_FTD)

###### Monitor Live AnyConnect Remote Access VPN Sessions

You can monitor real-time data from active AnyConnect remote access VPN sessions on the devices. This data is automatically
refreshed every 10 minutes. If you want to retrieve the latest list of sessions at any point, you click the reload icon![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453565.jpg)appearing on the right corner of the screen.

###### Before you begin

* Onboard the remote access VPN head-ends to Security Cloud Control.
* Ensure that the connectivity status of the devices you want to monitor live data is "Online" on the **Security Devices** page.

###### Procedure

---

| **Step 1** | In the left pane, click Insights & Reports > Remote Access Monitoring. |
| --- | --- |
| **Step 2** | Click RA VPN. |
| **Step 3** | Click Live.  You can [search and filter RA VPN sessions](#Search_and_Filter_Remote_Access_VPN_Sessions) to narrow down your search based on criteria such as device type, session length, and upload and download data range.   | **Note** | The Data TX and Data RX information are not available for FTD. | | --- | --- | |

---

* [View Live Remote Access VPN Data](#Cisco_Reference.dita_a9f03a0c-3e64-4a9f-bdfe-901425e09bc7)

###### View Live Remote Access VPN Data

The live data is presented both in the dashboard and tabular form.

###### Dashboard View

You have to click the **Show Charts View** icon appearing at the top right corner of the screen to see the dashboard.

The dashboard provides at-a-glance views from all active VPN headends managed by Security Cloud Control.

* **Breakdown (All Devices)**: Shows a total number of live sessions. It
  also shows a pie chart that is divided into four arc lengths. It illustrates
  the percentage of VPN sessions of the top three devices with the highest
  number of sessions. The remaining arc length represents the aggregate of
  other devices.
* Shows most used operating system and connection profile in the Security Cloud Control tenant.
* Shows average session duration and data uploaded and downloaded.
* **Active Sessions by Country**: Shows an interactive heat map of the location of the users connected to your RA VPN headends.

  + Countries from which users have connected are shown in progressively darker shades of blue, depending on the relative proportion
    of the sessions established from that country — the darker the blue color means more sessions are established from that country.
  + The legend at the bottom of the map provides a scale that indicates the correlation between the number of sessions in a country
    and the shade of blue used to color the country.
  + Hover the mouse pointer on the map to see the country's name and the total number of active user sessions established from
    that country.
  + Hover the mouse pointer on the table to see the country's location and the total number of active user sessions on the map.

###### Tabular View

Click the **Show Tabular View** icon on the top right corner of the screen to view the data in tabular format.

The tabular form provides a complete list of VPN users connected presently.

* The **Location** column shows the location of all the users connected to
  the VPN headends by geolocating their public IP addresses. Click a row to
  view the user details. On clicking the location link in the left pane, the
  location of the user is shown on the Google map.

  | **Important** | ---   Security Cloud Control applies a standard filter to the live data and represents them on the dashboard. You can apply new filters only when tabular data is shown, since the custom filters are not supported in the visual dashboard view. Click **Clear** to remove all filters you have applied. You cannot remove the standard filter.   --- |
  | --- | --- |

You can use [Search and Filter RA VPN Sessions](#Search_and_Filter_Remote_Access_VPN_Sessions) functionalities to narrow down your search based on criteria such as device type, session length, and upload and download
data range. Note that a maximum of 10,000 results can be displayed at once.

A green dot with an **Active** label in the status column indicates an active VPN
user's session.

###### Monitor Historical AnyConnect Remote Access VPN Sessions

You can monitor the historical data from AnyConnect Remote Access VPN sessions recorded over the last three months.

###### Before you begin

* Onboard the RA VPN head-ends to Security Cloud Control.

###### Procedure

---

| **Step 1** | In the left pane, click Insights & Reports > Remote Access Monitoring. |
| --- | --- |
| **Step 2** | Click RA VPN. |
| **Step 3** | Click Historical.   * Remote Access VPN Session data is stored and available to query for 1   year. * You can use [Search and Filter RA   VPN Sessions](#Search_and_Filter_Remote_Access_VPN_Sessions) functionalities to narrow down your search   based on criteria such as device type, session length, and upload   and download data range. * The Data TX and Data RX   information are not available for Secure Firewall Threat   Defense. |

---

* [View Historical Remote Access VPN Data](#Cisco_Reference.dita_de126b3f-6429-4a74-82f6-1f85a279c14b)

###### View Historical Remote Access VPN Data

The historical data is presented both in the dashboard and tabular form.

###### Dashboard View

You have to click the **Show Charts View** icon appearing at the top right corner
of the screen to see the dashboard. You will see the dashboard view along with the
tabular view.

The dashboard provides at-a-glance views from all active VPN headends managed by Security Cloud Control. It provides a bar graph showing the VPN sessions recorded for all devices in the last 24 hours, 7 days, and 30 days. You
can select the duration from the drop-down. You can hover over on individual bars to see the date and the total number of
sessions on that day.

###### Tabular View

You have to click the **Show Tabular View** icon appearing at the top right corner
of the screen to see only the tabular view. The tabular form provides a complete
list of VPN users connected over the last year.

The **Location** column shows the location of all the users connected to the VPN
headends by geolocating their public IP addresses. Click a row to view the user
details. On clicking the location link in the left pane, the location of the user is
shown on the Google map.

| **Important** | ---   Security Cloud Control applies a standard filter to the historical data and represents them on the dashboard. You can apply new filters only when tabular data is shown, since the dashboard is not supported for custom filters. Clearing the newly applied filters relaunches the dashboard (On the screen, click **Clear** to remove manually applied filters). You cannot remove the standard filter.   --- |
| --- | --- |

You can use [Search and Filter RA VPN Sessions](#Search_and_Filter_Remote_Access_VPN_Sessions) functionalities to narrow down your search based on criteria such as session date and time range, session length, and upload
and download data range. Note that a maximum of 10,000 results can be displayed at once.

A green dot with an **Active** label in the status column indicates an active VPN
user's session.

###### Search and Filter Remote Access VPN Sessions

###### Search

Use the search bar functionality to find remote access VPN sessions. Start typing device name, IP address, or serial number
in the search bar, and remote access VPN sessions that fit the search criteria will be displayed. Search is not case-sensitive.

###### Filter

Use the filter sidebar to find remote access VPN sessions based on criteria such as session time range, session length, and
upload and download data range. The filter functionality is available to both live and historical views.

* **Filter by Devices**: Select one or all devices from the All Types tab to view sessions from selected devices. The window also categorizes the devices based on their type and displays them
  under the corresponding tabs.
* **Sessions Time Range** (Applicable only for historical data): View
  historical sessions from a specified date and time range. Note that you can
  view data recorded over the last three months.
* **Sessions Length**: View sessions based on a specified session's
  duration length. Set the time unit (hours, minutes, or seconds) and specify
  the minimum and maximum duration length by moving the slider. You can also
  specify the length in the provided fields.
* **Upload (TX)**: View sessions based on a specified amount of data
  uploaded or transferred to the secured network. Set the unit (GB, MB, or KB)
  and select the range by moving the slider accordingly. You can also specify
  the values in the available fields.
* **Download (RX)**: View sessions based on a specified amount of data
  downloaded or received from the secured network. Set the unit (GB, MB, or
  KB) and select the range by moving the slider accordingly. You can also
  specify the values in the available fields.

###### Customize the Remote Access VPN Monitoring View

You can modify the remote access VPN monitoring view in both live and historical modes to only include column headers that
apply to the view you want. Click the column filter icon ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453534.jpg) located to the right of the columns and select or deselect the columns you want.

Security Cloud Control remembers your selection the next time you sign in to Security Cloud Control.

###### Export Remote Access VPN Sessions to a CSV File

You can export the remote access VPN sessions of one or more devices to a comma-separated value (.csv) file. You can open
the .csv file in a spreadsheet application such as Microsoft Excel to sort and filter the items on your list. This information
helps you to analyze the remote access VPN sessions. Every time you export the sessions, Security Cloud Control creates a new .csv file, where the file created has a date and time in its name.

Security Cloud Control can export a maximum of 100,000 active sessions to the CSV file. If the total number of sessions from all devices exceeds
the maximum limit, you can use the **View By Device** filter and generate reports for individual devices.

###### Procedure

---

| **Step 1** | In the left pane, click Insights & Reports > Remote Access Monitoring. |
| --- | --- |
| **Step 2** | In the **View By Devices** area, select one of the following:   * **All Devices** to export active sessions from all devices listed   below it. * Click on a device that you want to export sessions of that device. |
| **Step 3** | Click the icon on the top right corner. Security Cloud Control exports the rules you see on the screen to a .csv file. |
| **Step 4** | Open the .csv file in a spreadsheet application to sort and filter the results. |

---

###### Remote Access VPN Dashboard

Security Cloud Control provides a consolidated information about remote access VPN connections from ASA, cloud-delivered Firewall
Management Center-managed threat defense, and FDM-managed devices.

In the left pane, click Secure Connections > Remote Access VPN.

###### Disconnect Remote Access VPN Sessions on FDM-Managed Device

Currently, it is not possible to terminate remote access VPN sessions on an FDM-managed device using the Security Cloud Control interface. Instead, you can connect to the Threat
Defense CLI using SSH and disconnect the desired user. You can perform this task on an online FDM-managed device onboarded to Security Cloud Control.

###### Procedure

---

| **Step 1** | Log on to Firewall device manager and use the device CLI as explained in the **Logging Into the Command Line Interface (CLI)** section of the "Getting Started" chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor16) for the version your device is running. |
| --- | --- |
| **Step 2** | Execute the `vpn-sessionsdb logoff {name}` command and replace **name** with the user name. This command terminates all sessions for the username that you specify. |

---

## Templates

Templates provide the means to develop a preferred and general use version of device
configuration files:

* Templates are created from an existing base configuration file.
* They support value parameters for easy customization of expected values, including IP addresses and port numbers.
* They are exportable, with parameter substitution, for use across multiple devices.

* [FDM-Managed Device Templates](#FTD_Templates)
* [Configure an FDM Template](#Configure_an_FTD_Template)
* [Apply an FDM Template](#Apply_an_FTD_Template)
* [Migrating an ASA Configuration to an FDM-Managed Device Template](#Migrating_an_ASA_Configuration_to_an_FTD_Template)

**Related Information**

* [FDM-Managed Device Templates](#FTD_Templates)

  + [Configure an FDM Template](#Configure_an_FTD_Template)
  + [Apply Template to an FDM-Managed Device](#Apply_Template_to_an_FTD)

### FDM-Managed Device Templates

**About FDM-Managed Device Templates**

Security Cloud Control allows you to create a FDM-managed device template of an onboarded FDM-managed device's configuration. When you are creating the template, select the parts (objects, policies, settings, interfaces, and
NAT) that you want to include in your FDM-managed device template. You can then modify that template and use it to configure other FDM-managed devices you manage. FDM-managed device templates are a way to promote policy consistency between your FDM-managed devices.

When creating the FDM-managed device template, you can opt to either create a complete or custom template:

* A complete template includes all parts of the FDM-managed device configuration and applies everything on other FDM-managed devices.
* A custom template includes only one or more parts of the FDM-managed device configuration that you select and applies only that part and its associated entities on other FDM-managed devices.

| **Important** | ---   The FDM-managed device template will not include certificate, Radius, AD, and RA VPN Objects.   --- |
| --- | --- |

#### How You Could Use FDM-Managed Device Templates

Here are some ways that you could use FDM-managed device templates:

* Configure one FDM-managed device by applying another FDM-managed device's configuration template to it. The template you apply may represent a "best practice" configuration that you want
  to use on all your FDM-managed devices.
* Use the template as a method to make the device configuration changes and simulate them in a lab environment to test its functionality
  before applying those changes to a live FDM-managed device.
* Parameterize the attributes of the interfaces and sub-interfaces when creating a template. You can change the parameterized
  values of interfaces and subinterfaces at the time of applying the template.

#### What You Will See in the Change Log

When you apply a template to a device, you overwrite the entire configuration of that device. The Security Cloud Control change log records every change that gets made as a result. So, change log entries will be very long after applying a template
to a device.

**Related Information:**

* [Configure FDM Templates](#Configure_an_FTD_Template)
* [Apply FDM Templates](#Apply_an_FTD_Template)

### Configure an FDM Template

#### Prerequisites

Before you create a FDM-managed device template, onboard to Security Cloud Control the FDM-managed device from which you will create the template. You can only create an FDM-managed device template from an onboarded FDM-managed device.

We strongly recommend using templates to configure brand new FDM-managed devices being added to your environment.

| **Note** | ---   When you create a template from an FDM-managed device, the RA VPN objects are not included in the template.   --- |
| --- | --- |

* [Create an FDM Template](#Create_anFTD_Template)
* [Edit an FDM-Managed Device Template](#Edit_an_FTD_Template)
* [Delete an FDM Template](#Delete_an_FTD_Template)

#### Create an FDM Template

When creating a template, if you select all parts, the template will include every aspect of that device's configuration;
it's management IP address, interface configurations, policy information, and so on.

If you select some of the parts, the custom template includes the following entities.

| Template Parts | Parts included in Custom Template |
| --- | --- |
| Access Rules | Includes access control rules and any related entities for those rules. For example, objects and interfaces (with sub-interfaces). |
| NAT Rules | Includes NAT rules and any related entities required for those NAT rules. For example, objects and interfaces (with sub-interfaces). |
| Settings | Includes system settings and any related entities required for those settings. For example, objects and interfaces (with sub-interfaces). |
| Interfaces | Includes interfaces and sub-interfaces. |
| Objects | Includes objects and any related entities required for those objects. For example, interfaces and sub-interfaces. |

Use this procedure to create an FDM-managed device template:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the FTD tab and select the device that you want from the list. |
| **Step 4** | Use the [filter](#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) or [search](basics-of-cisco-defense-orchestrator.html#To_use_search) field to find the FDM-managed device from which you want to create the template. |
| **Step 5** | In the Device Actions pane on the right, click Create Template. The Name Template provides the count of each part on the device. It also shows the count of sub-interfaces, if any. |
| **Step 6** | Select the parts that you want to include in the template. |
| **Step 7** | Enter a name for your template. |
| **Step 8** | Click Create Template. |
| **Step 9** | In the Parameterize Template area, you can perform the following:   * To parameterize an interface, hover (until you see curly braces) and click a cell corresponding to that interface. * To parameterize a sub-interface, expand the interface that has a sub-interface, and hover (until you see curly braces) and   click a cell corresponding to that sub-interface.   You can parameterize the following attributes to enable per-device customization.   * Logical Name * State * IP Address/Netmask  | **Note** | These attributes only support one value per parameter. | | --- | --- | |
| **Step 10** | Click Continue. |
| **Step 11** | Review the template and any parameterizations. Click Done to create the template.  The Security Devices page now displays the FDM-managed device template you just created.   | **Note** | After creating a template, in the Security Devices page, Security Cloud Control displays the corresponding template part icons to show the parts included in that template. This information also appears in the Device Details pane when you click the device or when you hover over the mouse pointer on the icon. | | --- | --- |   The following picture shows an example of a part icon to show that the template includes "access rules", "NAT rules", and "objects". |

---

#### Edit an FDM-Managed Device Template

Edit the template parameters with the following procedure:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Templates tab. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Use the Model/Template filter to find the template you want to modify. |
| **Step 5** | In the Device Actions pane on the right, click Edit Parameters. |
| **Step 6** | (Optional) make any changes to the parameters by directly editing the text box. |
| **Step 7** | Click Save.  You can edit the rest of the FDM-managed device template just as you would the configuration of a live FDM-managed device. You can edit your FDM-managed device template with the following configurations:   * [FDM-Managed Device Settings](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed) * [Virtual Private Network Management for FTD](#Cisco_Concept.dita_6d1ed39d-3d97-4f06-af00-5d2b0af6e3f1) * [Create an RA VPN Configuration](#Create_an_FTD_RA_VPN_Configuration) * [FDM Policy Configuration](#FTD_Policy_Configuration) * [Promote policy and configuration consistency](https://docs.defenseorchestrator.com/Welcome_to_Cisco_Defense_Orchestrator/0030_Managing_Firepower_Threat_Defense_with_Cisco_Defense_Orchestrator#Promote_Policy_and_Configuration_Consistency) |

---

#### Delete an FDM Template

You delete an FDM-managed device template just as you would remove an FDM-managed device from Security Cloud Control:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Templates tab. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Use the filter and search fields to find the FDM-managed device template you want to delete. |
| **Step 5** | In the Device Actions pane, click Remove . |
| **Step 6** | Read the warning message and click OK to delete the template. |

---

**Related Information:**

* [FDM Templates](#FTD_Templates)
* [Apply an FDM Template](#Apply_an_FTD_Template)

### Apply an FDM Template

Before applying a template, you can identify its contents by navigating to the Security Devices page and filter for Model/Template. Security Cloud Control displays the corresponding template part icons to show the parts included in that template. This information also appears
in the Device Details pane when you click the device or when you hover over the mouse pointer on the icon.

You can parameterize the following attributes to enable per-device customization, which means you can apply device-specific
values at the time of applying the template:

When applying the FDM-managed device template, you can change the parameterized values of interfaces and subinterfaces configured when creating the template.

#### Apply a Complete Template

Applying a complete FDM-managed device template to create a new FDM-managed device overwrites entirely any existing configuration on the FDM-managed device, including any staged changes that have not yet been deployed from Security Cloud Control to the device. Anything on the device that was not included in the template will be lost.

#### Apply a Custom Template

Applying a custom FDM-managed device template to other FDM-managed devices will retain or remove the existing configuration based on the template part. The following table provides the changes
that occur after applying the custom template on other FDM-managed devices.

| **Template Parts** | **After Applying Custom Template** |
| --- | --- |
| Access Rules | * New access control rules present in the custom template   overwrites any existing access control rules on the   device. * New objects and interfaces (with sub-interfaces), if any,   in the custom template are applied to the device without   deleting any existing objects and interfaces. |
| NAT Rules | * New NAT rules present in the custom template overwrites   any existing NAT rules on the device. * New objects and interfaces (with sub-interfaces), if any,   in the custom template are applied to the device without   deleting any existing objects and interfaces. |
| Settings | * New system settings from the custom template are applied   to the device without deleting any existing system   settings. * New objects and interfaces (with sub-interfaces), if any,   in the custom template are applied to the device without   deleting any existing objects and interfaces. |
| Interfaces | * New interfaces and sub-interfaces from the custom   template are applied to the device without deleting any   existing interfaces and sub-interfaces. * Security Cloud Control does not allow applying a template to a device where more interfaces are defined in the template than there are interfaces   on the device. |
| Objects | * New objects from the custom template are applied to the   device without deleting any existing objects. * New interfaces and sub-interfaces, if any, in the custom   template are applied to the device without deleting any   existing interfaces and sub-interfaces. |

#### Prerequisites

The following conditions must be met prior to applying a template:

* When using a template, be sure that any changes you have made to the template have been committed and that the template is
  in the "Synced" state on the Security Devices page.
* When using an FDM-managed device as a template, be sure that any changes on Security Cloud Control you intended to deploy to the device have been deployed and that there are no changes from the firewall device manager console that have not been deployed. The device must show a Synced state on the Security Devices page.

Applying the template to a device is a three-step process.

1. [Apply the template to the device](#Apply_an_FTD_Template__Apply_complete_template)
2. [Review device and network
   settings](#Review_Device_and_Networking_Settings)
3. [Deploy the changes to the device](#DeployChanges_to_the_Device)

* [Apply Template to an FDM-Managed Device](#Apply_Template_to_an_FTD)
* [Review Device and Networking Settings](#Review_Device_and_Networking_Settings)
* [Deploy Changes to the Device](#DeployChanges_to_the_Device)

#### Apply Template to an FDM-Managed Device

| **Important** | ---   Before you deploy the changes to the device, continue to the next procedure:   --- |
| --- | --- |

[Review Device and Networking Settings.](#Review_Device_and_Networking_Settings)

You can use [change request tracking](monitoring-and-reporting.html#About_Change_Request_Management) to apply a tracking label to your changes before you apply the template. Use the following procedure to apply an FDM-managed device template:

##### Procedure

---

| **Step 1** | (Optional) Before you begin, make a template of your FDM-managed device before you apply another template to it. This gives you a configuration backup you can reference when you need to reapply device and networking settings. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the Templates tab. |
| **Step 4** | Click the FTD tab. |
| **Step 5** | Use the filter and search field to find the FDM-managed device or template to which you are going to apply the template.   | **Note** | If you change the name of the template at this point, you are applying a full device configuration or template to *DeviceName*. Deploying this change to *DeviceName* will overwrite the entire configuration running on that device. | | --- | --- | |
| **Step 6** | In the device Actions pane on the right, click Apply Template. |
| **Step 7** | Click Select Template and select the desired template and click Continue. |
| **Step 8** | You can configure the following and click Continue appearing on each screen.   1. Map Interfaces: Confirm or change the mapping of interfaces between the template and the device. Note that you cannot have more than one template    interface mapped to a single device interface; if the interface configuration is not supported, you cannot continue and apply    the template.         | **Note** | Security Cloud Control does not allow applying a template to a device where more interfaces are defined in the template than there are interfaces on the device. |    | --- | --- | 2. Fill Parameters: Customize the interface or sub-interface parameter values for the device that you are applying the template to. 3. Review: Review the template configuration and click Apply Template when you are ready to overwrite the existing device configuration with the configuration in the template. |
| **Step 9** | Click [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once. |

---

#### Review Device and Networking Settings

When creating an FDM-managed device template, Security Cloud Control copies the entire device configuration into the template. So, things like the management IP address of the original device
are contained in the template. Review these device and network settings before you apply the template to a device:

##### Procedure

---

| **Step 1** | Review these FDM-managed device settings to ensure that they reflect the correct information for the new FDM-managed device:   * [Management Access](#Cisco_Concept.dita_7f5beba4-d5e1-4287-8126-2112d26357ed) * [Management Interface](#Management_Interface) * [Hostname](#Hostname) |
| --- | --- |
| **Step 2** | Review the [Firepower access control policy](#Configure_the_FTD_Access_Control_Policy) to ensure that rules reference the new FDM-managed device's IP addresses where appropriate. |
| **Step 3** | Review inside\_zone and outside\_zone security objects to ensure they reference the correct IP address for the new FDM-managed device. |
| **Step 4** | Review NAT policies to ensure they reference the correct IP addresses for the new FDM-managed device. |
| **Step 5** | Review Interface configurations to ensure that they reflect the correct configuration for the new FDM-managed device. |

---

#### Deploy Changes to the Device

[Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) now the changes you made, or wait and deploy multiple changes at once.

**Related Information:**

* [FDM Templates](#FTD_Templates)
* [Configure FDM Templates](#Configure_an_FTD_Template)

### Migrating an ASA Configuration to an FDM-Managed Device Template

| **Attention** | ---   Secure Firewall device manager (FDM) support and functionality is only available upon request. If you do not already have Firewall device manager support enabled on your tenant you cannot manage or deploy to FDM-managed devices. [Send a request to the support team](faq-and-support.html#Cisco_Concept.dita_92ad1f10-ddda-45fe-b4e9-ea9433046396) to enable this platform.   --- |
| --- | --- |

Security Cloud Control helps you migrate your ASA to an FDM-managed device. Security Cloud Control provides a wizard to help you migrate these elements of the ASA's running configuration to an FDM-managed device template:

* Access Control Rules (ACLs)
* Interfaces
* Network Address Translation (NAT) rules
* Network objects and network group objects
* Routes
* Service objects and service group objects
* Site-to-site VPN

Once these elements of the ASA running configuration have been migrated to an FDM-managed device template, you can then apply the FDM template to a new FDM-managed device that is managed by Security Cloud Control. The FDM-managed device adopts the configurations defined in the template, and so, the FDM-managed device is now configured with some aspects of the ASA's running configuration.

Other elements of the ASA running configuration are not migrated using this process. Those other elements are represented
in the FDM-managed device template by empty values. When the template is applied to an FDM-managed device, we apply values we migrated to the new FDM-managed device and ignore the empty values. Whatever other default values the new FDM-managed device has, it retains. Those other elements of the ASA running configuration that we did not migrate, will need to be recreated
on the FDM-managed device outside the migration process.

See [Migrating an ASA to an FDM-Managed Device Using Cisco Security
Cloud Control](https://www.cisco.com/c/en/us/td/docs/security/firepower/migration-tool/migration-guide-CDO/ASA2FTD_Using_CDO.html) for a full explanation of the process of migrating an ASA to an FDM-managed device using Security Cloud Control.

## FDM-Managed High Availability

**About High Availability**

A high availability (HA), or failover configuration, joins two devices into a primary/secondary setup so that if the primary
device fails, the secondary automatically takes over. Configuring high availability, also called failover, requires two identical
FDM-managed devices connected to each other through a dedicated failover link and, optionally, a state link. The health of the active
unit (hardware, interfaces, software, and environmental status) is monitored to determine if specific failover conditions
are met. If those conditions are met, failover occurs. This helps keep your network operation in case of a device failure
or during a maintenance period when the devices are upgrading. See the related articles below for more information.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457530.jpg)

The units form an active/standby pair, where the primary unit is the active unit and passes traffic. The secondary (standby)
unit does not actively pass traffic, but synchronizes configuration and other state information from the active unit. The
two units communicate over the failover link to determine the operating status of each unit.

| **Note** | ---   When you opt to accept changes from or deploy to an FDM-managed HA pair, you are communicating with the active device of the HA pair. This means that configurations and backups are pulled from the active device only.   --- |
| --- | --- |

### Certificate and High Availability Pairs

When you apply a certificate to an FDM-managed HA pair, Security Cloud Control only applies the certificate to the active device; only upon deploying the active device is the configuration, and the certificate,
synchronized with the standby device. If you apply a new certificate to the active device through FDM-managed, the active device and standby device may have two different certificates. This may cause issues in failover or failover
history, among other possible issues. The two devices must have the same certificate to function successfully. If you must
change the certificate through FDM-managed, then you must deploy changes and synchronize the certificate within the HA pair.

* [FDM-Managed High Availability Pair Requirements](#FTD_High_Availability_Pair_Requirements)
* [Create an FDM-Managed High Availability Pair](#Create_an_FTD_High_Availability_Pair)
* [FDM-Managed Devices in High Availability Page](#FTD_High_Availability_Page)

**Related Information:**

* [Failover and Stateful
  Link for FDM-Managed High Availability](#Failover_and_Stateful_Link_for_FTD_High_Availability)
* [FDM-Managed High Availability Pair Requirements](#FTD_High_Availability_Pair_Requirements)
* [Create an FDM-Managed High Availability Pair](#Create_an_FTD_High_Availability_Pair)
* [FDM-Managed High Availability Status Page](#FTD_High_Availability_Page)
* [Break FDM-Managed High Availability](#Break_an_FTD_High_Availability_Pairing)
* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
* [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)
* [Upgrade an FDM-Managed High Availability Pair](onboard-devices-and-services.html#Upgrade_an_FTD_High_Availability_Pair)
* [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)
* [Accept Configuration Changes from FTD to Security Cloud Control](#Read_Configuration_Changes_from_FTD_to_CDO)
* [Deploy Configuration Changes from Cisco Security
  Cloud Control to FTD](#Deploy_Configuration_Changes_from_CDO_to_FTD)

### FDM-Managed High Availability Pair Requirements

**High Availability Requirements**

There are several requirements you must establish before you create a high availability (HA) pair.

#### Physical and Virtual Device Requirements for HA

The following hardware requirements must be met:

* The devices must be the same hardware model.
* The devices must have the same modules installed. For example, if one has an optional network module, then you must install
  the same network module in the other device.
* The devices must have the same type and number of interfaces.
* To create an HA pair in Security Cloud Control, both devices must have management interfaces configured. If the devices have data interfaces configured, you must create
  the HA pair through the FDM-managed UI, and then onboard the pair to Security Cloud Control.

  | **Note** | ---   You **cannot** use an FDM-managed template in an HA pair.   --- |
  | --- | --- |

#### Software Requirements for HA

The following software requirements must be met for both physical and virtual FDM-managed devices:

* You have two standalone FDM-managed devices onboarded in the Security Cloud Control.
* The devices must run the exact same software version, which means the same major (first), minor (second), and maintenance
  (third) numbers. You can find the version inside the Device Details window on the **Security Devices** page, or you can use the show version command in the CLI.

  | **Note** | ---   Devices with different versions are allowed to join, but the configuration is not imported into the standby unit and failover is not functional until you upgrade the units to the same software version.   --- |
  | --- | --- |

* Both devices must be in local manager mode, that is, configured using FDM. If you can log into FDM on both devices, they are
  in local manager mode. You can also use the show managers command in the CLI to verify.
* You must complete the initial setup wizard for each device before onboarding to Security Cloud Control.
* Each device must have its own management IP address. The configuration for the management interface is not synchronized between
  the devices.
* The devices must have the same NTP configuration.
* You cannot configure any interface to obtain its address using DHCP. That is, all interfaces must have static IP addresses.

  **Note:** If you change any interface configurations, you must deploy the changes to the device before establishing HA.
* Both devices must be **synced**. If you have pending changes or conflicts detected, see [Resolve Configuration Conflicts](#Resolve_Configuration_Conflicts) and [Resolve Configuration Conflicts](#Resolve_Configuration_Conflicts) for more information.

  | **Note** | ---   When you opt to accept changes from or deploy to an FDM-managed HA pair, you are communicating with the active device of the HA pair. This means that configurations and backups are pulled from the active device only.   --- |
  | --- | --- |

#### Smart License Requirements for HA

The following license requirements must be met for both physical and virtual FDM-managed devices:

* Both devices in an HA pair must have either a registered license, or an evaluation license. If the devices are registered,
  they can be registered to different Cisco Smart Software Manager accounts, but the accounts must have the same state for the
  export-controlled functionality setting, either both enabled or both disabled. However, it does not matter if you have enabled
  different optional licenses on the devices.
* Both devices within the HA pair must have the same licenses during operation. It is possible to be in compliance on one device,
  but out of compliance on the other if there are insufficient licenses. If your Smart Licenses account does not include enough
  purchased entitlements, your account becomes Out-of-Compliance (even though one of the devices may be compliant) until you
  purchase the correct number of licenses.

Note that if the device is in evaluation mode, you must ensure that the registration status for Security Cloud Control is the same on the devices. You must also ensure that your selection for participation in the Cisco Success Network is the
same. For registered devices, the settings can be different on the units, but whatever is configured on the primary (active)
device will either register or unregister the secondary. An agreement to participate in the Cisco Success Network on the primary
implies an agreement for the secondary.

If you register the devices to accounts that have different settings for export controlled features, or try to create an HA
pair with one unit registered and the other in evaluation mode, the HA join might fail. If you configure an IPsec encryption
key with inconsistent settings for export controlled features, both devices will become active after you activate HA. This
will impact routing on the supported network segments, and you will have to manually break HA on the secondary unit to recover.

#### Cloud Services Configuration for HA

Both of the devices within an HA pair must have **Send Events to the Cisco Cloud** enabled. This feature is available in the FDM UI. Navigate to **System Settings** and click **Cloud Services** to enable this feature. Without this option enabled, the HA pair cannot form in Security Cloud Control and an event description error occurs. See the **Configuring Cloud Services** chapter of the [Firepower Device Manager Configuration Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) of the version you are running for more information.

### Create an FDM-Managed High Availability Pair

Before you create an FDM-managed HA pair in Security Cloud Control, you must first onboard two standalone FDM-managed devices that meet the requirements described in [FDM-Managed High Availability Pair Requirements](#FTD_High_Availability_Pair_Requirements).

| **Note** | ---   To create an HA pair in Security Cloud Control, both devices must have management interfaces configured. If the devices have data interfaces configure, you must create the HA pair through the FDM console, and then onboard the pair to Security Cloud Control.   --- |
| --- | --- |

Once you create an FDM-managed HA pair, the primary device is active and the secondary device is standby by default. All configuration changes or deployments are made through the primary device and the secondary device remains
in standby mode until the primary unit becomes unavailable.

Note that when you opt to accept configuration changes from or deploy to an FDM-managed HA pair, you are communicating with the active device of the HA pair. Any changes made to the primary device are transferred
over the link between the primary and the secondary device. Security Cloud Control deploys to and accepts changes only from the primary device; thusly, the **Security Devices** page displays a single entry for the pair. Once the deploy occurs, the primary device synchronized any configuration changes
to the secondary device.

Simi liar to how Security Cloud Control communicates with only the active device, when you schedule or opt to back up an FDM-managed HA pair, only the active device is eligible to back up.

| **Note** | ---   If the HA devices experience an issue during the creation process or the HA pair does not result with a healthy status, you must manually break the HA configuration before you attempt to create the pair again.   --- |
| --- | --- |

* [Procedure](#Procedure)

#### Procedure

Create an HA pair from two standalone FDM-managed devices with the following procedure:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD**tab and select the device you want to establish as the primary device.   | **Note** | Security Cloud Control does not support creating an HA pair with devices configured with DHCP. | | --- | --- | |
| **Step 4** | In the Management pane, click **High Availability**. |
| **Step 5** | Locate the area for the secondary device and click **Select Device**, then choose a device from the list of eligible devices. |
| **Step 6** | Configure the Failover link.   1. Click **Physical Interface**and select an interface from the    drop-down menu. 2. Select the appropriate **IP Type**. 3. Enter the **Primary IP** address. 4. Enter the **Secondary IP** address. 5. Enter the **Netmask**. By default, this value is 24. 6. If applicable, enter a valid **IPSec Encryption Key**. |
| **Step 7** | Configure the Stateful link. If you want to use the same configuration as the failover link, check the **The same as Failover Link** checkbox. If you want to use a different configuration, use the following procedure:   1. Click **Physical Interface** and select an interface from the    drop-down menu. Note that both the primary and secondary device    **must** have the same number of physical interfaces. 2. Select the appropriate **IP Type**. 3. Enter the **Primary IP** address. 4. Enter the **Secondary IP** address. 5. Enter the **Netmask**. By default, this value is 24. |
| **Step 8** | Click **Create** in the upper right corner of the screen to finish the wizard. Security Cloud Control immediately redirects you to the High Availability Status page. From this page you can monitor the status of the HA creation. Note that once the HA pair is created, the **Security Devices** page displays the pair as a single row. |
| **Step 9** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### FDM-Managed Devices in High Availability Page

The FDM-managed in High Availability (HA) management page is a multi-purpose page for FDM-managed devices. This page is only available for devices that are already configured as an HA pair. You can onboard an FDM-managed HA pair or you can create an FDM-managed HA pair from two standalone FDM-managed devices.

If you select a standalone FDM-managed device from the **Security Devices** page, this page acts as a wizard for creating an HA pair. At this time, you must have two FDM-managed devices onboarded to Security Cloud Control to create a pair. To create an FDM-managed HA pair in Security Cloud Control, see [Create an FDM-Managed High Availability Pair](#Create_an_FTD_High_Availability_Pair).

If you select an FDM-managed HA pair from the **Security Devices** page, this page acts as an overview page. From here you can view the HA configuration and the failover history, as well as
actionable items such as force a failover, edit the failover criteria, and remove the HA link.

* [High Availability Management Page](#High_Availability_Management_Page)
* [Edit High Availability Failover Criteria](#Edit_High_Availability_Failover_Criteria)
* [Break an FDM-Managed High Availability Pairing](#Break_an_FTD_High_Availability_Pairing)
* [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)
* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
* [Failover and Stateful Link for FDM-Managed High Availability](#Failover_and_Stateful_Link_for_FTD_High_Availability)

#### High Availability Management Page

To see the High Availability page, use the following procedure:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab and select a standlalone FDM-managed device **or** the active FDM-managed device of the FDM-managed HA pair. |
| **Step 4** | In the **Management** pane, click **High Availability**. |

---

**Related Information:**

* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Edit High Availability Failover Criteria](#Edit_High_Availability_Failover_Criteria)
* [Force an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)
* [Break FDM-Managed High Availability](#Break_an_FTD_High_Availability_Pairing)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)

#### Edit High Availability Failover Criteria

You can edit the failover criteria after the FDM-managed HA pair is created.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab and select the active device of the FDM-managed HA pair. |
| **Step 4** | In the Management pane, click **High Availability**. |
| **Step 5** | In the Failover Criteria window click **Edit**. |
| **Step 6** | Make any necessary changes and click **Save**. |
| **Step 7** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes now you made to the active device, or wait and deploy multiple changes at once. |

---

#### Break an FDM-Managed High Availability Pairing

When you break HA, the configured interfaces on the standby device are automatically disabled. The devices may experience
a disruption in traffic during this process. After the HA pair is successfully removed you will be redirected from the status
page to the High Availability page where you will have the option to create another HA pair with the same primary device.

| **Note** | ---   You cannot deploy to either of the devices until the HA pair is successfully removed.   --- |
| --- | --- |

##### Break HA with Management Interfaces

When you break HA for a pair that is configure with management interfaces, the break may take 10 minutes or longer to complete
and both devices go offline during this process. When the HA configuration is successfully removed, Security Cloud Control displays both units as standalone devices in the **Services & Devices** page.

##### Break HA with Data Interfaces

When you break HA for a pair that is configured with data interfaces, the break may take 20 minutes or more to complete and
both of the devices go offline. you must manually reconnect the active device after the HA configuration is removed.

The standby device retains the HA configuration, though, and will become unreachable since it has the same configuration as
the active device. You must manually reconfigure the IP interfaces outside of Security Cloud Control, and then re-onboard the device as a standalone.

* [Break High Availability](#Break_High_Availability)
* [Break Out-of-Band High Availability](#BreakOutofBand_High_Availability)

##### Break High Availability

Use the following procedure to remove the HA pairing of two FDM-managed devices:

###### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices and select the active device of the FDM-managed HA pair. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | In the Management pane, click **High Availability**. |
| **Step 5** | Click **Break High Availability**. |
| **Step 6** | Security Cloud Control removes the HA configuration and both devices are displayed as standalone devices in the **Security Devices** page. |
| **Step 7** | [Deploy Configuration Changes from Cisco Security Cloud Control to FDM-Managed Device](#Deploy_Configuration_Changes_from_CDO_to_FTD) to deploy the new configuration to both devices. |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made to the active device now, or wait and deploy multiple changes at once. |

---

##### Break Out-of-Band High Availability

If you break an FDM-managed HA pair using the FDM interface, the configuration status of the HA pair in Security Cloud Control changes to **Conflict Detected.** After you break HA, you must deploy the changes to the primary device through FDM-managed and then [resolve the Conflict Detected](#Resolve_Configuration_Conflicts) state in Security Cloud Control.

After the device is back in the Synced state, you can deploy configuration changes made in Security Cloud Control to the device.

We do **not** recommend reverting changes from Security Cloud Control after breaking HA using the FDM-managed interface.

**Related Information:**

* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
* [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)
* [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)

#### Force a Failover on an FDM-Managed High Availability Pair

Switch the active and standby devices within an FDM-managed HA pair by forcing a failover. Note
that if you recently applied a new certificate to the active device and have
**not** deployed changes, the standby device retains the original certificate
and failover will fail. The active and standby devices must have the same
certificate applied. Use the following procedure to manually force a failover:

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the active device of the FDM-managed HA pair. |
| **Step 5** | In the Management pane, click **High Availability**. |
| **Step 6** | Click the options icon . |
| **Step 7** | Click **Switch Mode**. The active device is now on standby, and the standby device is now active. |

---

**Related Information:**

* [Break FDM-Managed High Availability](#Break_an_FTD_High_Availability_Pairing)
* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
* [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)

#### FDM-Managed High Availability Failover History

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the active device of the FDM-managed HA pair. |
| **Step 5** | In the Management pane, click **High Availability**. |
| **Step 6** | Click **Failover History**. Security Cloud Control generates a window that details the failover history for both the primary and secondary device since the HA pair was formed.   | **Note** | Failover history is also displayed in the pair's change log, available from the **Security Devices** page. | | --- | --- | |

---

**Related Information:**

* [Break FDM-Managed High Availability](#Break_an_FTD_High_Availability_Pairing)
* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
* [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)

#### Refresh the FDM-Managed High Availability Status

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab and select the FDM-managed device or the FDM-managed HA pair. |
| **Step 4** | In the **Management** pane, click **High Availability**. |
| **Step 5** | Click the options icon . |
| **Step 6** | Click **Get Latest Status**. Security Cloud Control requests a health status from the primary device. |

---

**Related Information:**

* [Break FDM-Managed High Availability](#Break_an_FTD_High_Availability_Pairing)
* [FDM-Managed High Availability Failover History](#FTD_High_Availability_Failover_History)
* [Refresh the FDM-Managed High Availability Status](#Refresh_the_FTD_High_Availability_Status)
* [Force a Failover on an FDM-Managed High Availability Pair](#Force_a_Failover_on_an_FTD_High_Availability_Pair)

#### Failover and Stateful Link for FDM-Managed High Availability

##### Failover Link and (Optional) Stateful Link

The failover link is a dedicated connection between the two units. The stateful failover link is also a dedicated connection,
but you can either use the one failover link as a combined failover/state link, or you can create a separate, dedicated state
link. If you use just the failover link, the stateful information also goes over that link: you do not lose stateful failover
capability. By default, the communications on the failover and stateful failover links are plain text (unencrypted). You can
encrypt the communications for enhanced security by configuring an IPsec encryption key.

You can use any unused data physical interfaces as the failover link and optional dedicated state link. However, you cannot
select an interface that is currently configured with a name, or one that has subinterfaces. The failover and stateful failover
link interfaces are not configured as normal networking interfaces. They exist for failover communication only, and you cannot
use them for through traffic or management access. Because the configuration is synchronized between the devices, you must
select the same port number for each end of a link. For example, GigabitEthernet1/3 on both devices for the failover link.

| **Note** | ---   The FDM-managed device does not support sharing interfaces between user data and the failover link.   --- |
| --- | --- |

##### Failover Link

The two units in a failover pair constantly communicate over a failover link to determine the operating status of each unit
and to synchronize configuration changes. The following information is shared over the link:

* The unit state (active or standby)
* Hello messages (keep-alives)
* Network link status
* MAC address exchange
* Configuration replication and synchronization

You can use an unused data interface (physical, redundant, or EtherChannel) as the failover link; however, you cannot specify
an interface that is currently configured with a name. Do **not** use a subinterface as the failover link.

The failover link interface is not configured as a normal networking interface; it exists for failover communication only.
This interface can only be used for the failover link (and also for the state link).

##### Stateful Link

The active unit uses the state link to pass connection state information to the standby device. This means that the standby
unit can maintain certain types of connections without impacting the user. This information helps the standby unit maintain
existing connections when a failover occurs.

You can use a dedicated data interface (physical, redundant, or EtherChannel) for the state link. For an EtherChannel used
as the state link, to prevent out-of-order packets, only one interface in the EtherChannel is used. If that interface fails,
then the next interface in the EtherChannel is used.

Using a single link for both the failover and stateful failover links is the best way to conserve interfaces. However, you
must consider a dedicated interface for the state link and failover link, if you have a large configuration and a high traffic
network. We recommend that the bandwidth of the stateful failover link should match the largest bandwidth of the data interfaces
on the device.

## FDM-Managed Device Settings

* [Configure an FDM-Managed Device's System Settings](#Configure_an_FTDDevices_System_Settings)
* [Configure Management Access](#Cisco_Concept.dita_6e295ca7-7371-49c8-8934-6ddbe2e442da)
* [Configure Logging Settings](#Configure_Logging_Settings)
* [Configure DHCP Servers](#Configure_DHCP_Servers)
* [Configure DNS Server](#Configure_DNS_Server)
* [Management Interface](#Management_Interface)
* [Hostname](#Hostname)
* [Configure NTP Server](#Configure_NTP_Server)
* [Configure URL Filtering](#Configure_URL_Filtering)
* [Cloud Services](#Cloud_Services)
* [Enabling or Disabling Web Analytics](#Enabling_or_Disabling_Web_Analytics)

### Configure an FDM-Managed Device's System Settings

Use this procedure to configure settings on a single FDM-managed device:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab and select the FDM-managed device you want to configure the settings. To narrow down your search results and easily find the FDM-managed devices, you can make use of the filter button. |
| **Step 4** | In the Management pane at the right, click Settings. |
| **Step 5** | Click the System Settings tab. |
| **Step 6** | Edit any of these device settings:   * [Management Access](#Cisco_Concept.dita_6e295ca7-7371-49c8-8934-6ddbe2e442da) * [Logging](#Configure_Logging_Settings) * [DHCP Server](#Configure_DHCP_Servers) * [DNS Server](#Configure_DNS_Server) * [Hostname](#Hostname) * [NTP Server](#Configure_NTP_Server) * [URL Filtering](#Configure_URL_Filtering) * [Cloud Services](#Cloud_Services) * [Web Analytics](#Enabling_or_Disabling_Web_Analytics) |

---

### Configure Management Access

By default, you can reach the device's management address from any IP address. System
access is protected by username and password only. However, you can configure an access
list to allow connections from specific IP addresses or subnets only to provide another
level of protection.

You can also open data interfaces to allow an FDM-managed device or SSH connections to the CLI. You can then manage the device without using the management address. For example, you
could allow management access to the outside interface, so that you can configure the device remotely. The username and password
protects against unwanted connections. By default, HTTPS management access to data interfaces is enabled on the inside interface,
but it's disabled on the outside interface. For device models that have a default "inside" bridge group, this means that you
can make FDM-managed device connections through any data interface within the bridge group to the bridge group IP address (default is 192.168.1.1).
You can open a management connection only on the interface through which you enter the device.

| **Caution** | ---   If you constrain access to specific addresses, you can easily lock yourself out of the system. If you delete access for the IP address that you are currently using, and there's no entry for "any" address, you'll lose access to the system when you deploy the policy. Be mindful of this when configuring the access list.   --- |
| --- | --- |

* [Create Rules for Management Interfaces](#Cisco_Task_in_List_GUI.dita_ea786c6f-12be-411f-96e7-97d7a95ed70e)
* [Create Rules for Data Interfaces](#Cisco_Task_in_List_GUI.dita_7b342b5b-3eda-44c4-a368-653cfa25bc40)

#### Create Rules for Management Interfaces

Use the following procedure to create rules for managment interfaces:

##### Procedure

---

| **Step 1** | Click New Access in the Management Interface section.   * Protocol. Select whether the rule is for   HTTPS (port 443) or SSH (port 22). * Allowed Networks. Select the network object   that defines the IPv4 or IPv6 network or host that should be able to   access the system. To specify "any" address, select   any-ipv4 (0.0.0.0/0) and   any-ipv6(::/0). |
| --- | --- |
| **Step 2** | Click Save. |

---

#### Create Rules for Data Interfaces

Use the following procedure to create rules for data interfaces:

##### Procedure

---

| **Step 1** | Click New Access in the Data Interface section.   * Interface. Select the interface on which you   want to allow management access. * Protocol. Select whether the rule is for   HTTPS (port 443), SSH (port 22), or both. You cannot configure HTTPS   rules for the outside interface if it's used in a remote access VPN   connection profile. * Allowed Networks. Select the network object   that defines the IPv4 or IPv6 network or host that should be able to   access the system. To specify "any" address, select   any-ipv4 (0.0.0.0/0) and   any-ipv6 (::/0). |
| --- | --- |
| **Step 2** | Click Save. |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Configure Logging Settings

This procedure describes how to enable logging of [diagnostic (data) messages](cisco-security-analytics-and-logging.html#event-types-in-cdo__), [file](cisco-security-analytics-and-logging.html#event-types-in-cdo__file_events) and [malware](cisco-security-analytics-and-logging.html#event-types-in-cdo__malware_events) events, [intrusion](cisco-security-analytics-and-logging.html#event-types-in-cdo__intrustion_events) events, and console events. Connection events are not logged as a result of these settings; they are logged if connection
logging is configured on access rules, security intelligence policies, or SSL decryption rules.

#### Procedure

---

| **Step 1** | [Open an FDM-managed device's settings](#Configure_an_FTDDevices_System_Settings). |
| --- | --- |
| **Step 2** | On the System Settings page click Logging in the settings menu. |
| **Step 3** | Data logging. Slide the Data Logging slider to On to capture diagnostic logging syslog messages. Click the plus button  to specify the [syslog server object](#Cisco_Concept.dita_8ad8638c-1934-4da0-834c-59b0d7a0df0b) that represents the syslog server that you want to send the events to. (You can also create a syslog server object at this point.) Additionally, select the minimum level of [event severity](#Message_Severity_Levels) you want to log.  This will send data logging events for any type of syslog message, with your minimum chosen severity level, to the syslog server.   | **Note** | Security Cloud Control doesn't currently support creating a Custom Logging Filter for Data Logging. For finer control of which messages you send to the syslog server, we recommend you define this setting in an FDM-managed device. To do so, log on to an FDM-managed device, and navigate System Settings > Logging Settings. | | --- | --- |  | **Tip** | Do not enable data logging if you are a Cisco Security Analytics and Logging customer *unless* you forward the data logging events to a syslog server other than the [Secure Event Connector](cisco-security-analytics-and-logging.html#Cisco_Concept.dita_2ddcdbe1-3ae8-4906-9919-54434bfa3d57). Data events (diagnostic events) are not traffic events. Sending the data events to a different syslog server removes the burden on the SEC from analyzing and filtering them out. | | --- | --- | |
| **Step 4** | File/Malware Log Settings. Slide the slider to On to capture [file](cisco-security-analytics-and-logging.html#event-types-in-cdo__file_events) and [malware](cisco-security-analytics-and-logging.html#event-types-in-cdo__malware_events) events. Specify the [syslog server object](#Cisco_Concept.dita_8ad8638c-1934-4da0-834c-59b0d7a0df0b)  that represents the syslog server that you want to send the events to. You can also create a syslog server object at this point if you have not already.  File and malware events are generated at the same severity level. The minimum level of [event severity](#Message_Severity_Levels) you select will be assigned to all file and malware events.  File and malware events are reported when a file or malware policy in any access control rule has been triggered. This is not the same as a connection event. Note that the syslog settings for file and malware events are relevant only if you apply file or malware policies, which require the and Malware licenses.  For Cisco Security Analytics and Logging subscribers:   * If you send events to the Cisco cloud through a Secure Event Connector (SEC), specify an SEC as your syslog server. You will   then be able to see these events alongside file policy and malware policy connection events. * If you send events directly to the Cisco cloud without an SEC, you do not need to enable this setting. File and malware events   are sent if the access control rule is configured to send connection events. |
| **Step 5** | Intrusion Logging. Send [intrusion events](cisco-security-analytics-and-logging.html#event-types-in-cdo__intrustion_events) to a syslog server by specifying the [syslog server object](#Cisco_Concept.dita_8ad8638c-1934-4da0-834c-59b0d7a0df0b)  that represents the syslog server you want to send events to. You can also create a syslog server object at this point if you have not already.  Intrusion events are reported when an intrusion policy in any access control rule has been triggered. This is not the same as a connection event. Note that the syslog settings for intrusion events are relevant only if you apply intrusion policies, which require the license.  For Cisco Security Analytics and Logging subscribers:   * If you send events to the Cisco cloud through a Secure Event Connector (SEC), specify an SEC as your syslog server. You will   then be able to see these events alongside file policy and malware policy connection events. * If you send events directly to the Cisco cloud without an SEC, you do not need to enable this setting. Intrusion events are   sent to the Cisco cloud if the access control rule is configured to send connection events. |
| **Step 6** | Console Filter. Slide the slider to On to send data logging (diagnostic logging) events to a console rather than to a syslog server. Additionally, select the minimum level of event severity you want to log. This will send a data logging event for any type of syslog message, with your chosen severity level.  You will see these messages when you log into the CLI on the console port of your FDM-managed device. You can also see these logs in an SSH session to other FDM-managed device interfaces (including the management interface) by using the show console-output command. In addition, you can see these messages in real time in the diagnostic CLI by entering system support diagnostic-cli from the main CLI. |
| **Step 7** | Click Save. |
| **Step 8** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

* [Message Severity Levels](#Message_Severity_Levels)

#### Message Severity Levels

The following table lists the syslog message severity levels.

| Level Number | Severity Level | Description |
| --- | --- | --- |
| 0 | ****emergencies**** | System is unusable. |
| 1 | ****alert**** | Immediate action is needed. |
| 2 | ****critical**** | Critical conditions. |
| 3 | ****error**** | Error conditions. |
| 4 | ****warning**** | Warning conditions. |
| 5 | ****notification**** | Normal but significant conditions. |
| 6 | ****informational**** | Informational messages only. |
| 7 | ****debugging**** | Debugging messages only. |
| | **Note** |  | | --- | --- | | FDM-managed device does not generate syslog messages with a severity level of zero (emergencies). | |

### Configure DHCP Servers

A Dynamic Host Configuration Protocol (DHCP) server provides network configuration parameters, such as IP addresses, to DHCP
clients. You can configure a DHCP server on an interface to provide configuration parameters to DHCP clients on the attached
network.

An IPv4 DHCP client uses a broadcast rather than a multicast address to reach the server. The DHCP client listens for messages
on UDP port 68. The DHCP server listens for messages on UDP port 67. The DHCP server does not support BOOTP requests.

DHCP clients must be on the same network as the interface on which the server is enabled. There cannot be an intervening router
between the server and client, although there can be a switch.

| **Caution** | ---   Do not configure a DHCP server on a network that already has a DHCP server operating on it. The two servers will conflict with each other, and the results will be unpredictable.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | The section has two areas. Initially, the Configuration section shows the global parameters. The DHCP Servers area shows the interfaces on which you have configured a server, whether the server is enabled, and the address pool for the server. |
| --- | --- |
| **Step 2** | In the Configuration section, configure auto configuration and global settings. DHCP auto configuration enables the DHCP server to provide DHCP clients with DNS server, domain name, and WINS server information obtained from a DHCP client that's running on the specified interface. Typically, you would use auto configuration if you're obtaining an address using DHCP on the outside interface, but you could choose any interface that obtains its address through DHCP. If you cannot use auto configuration, you can manually define the required options.  1. Click the Enable Auto Configuration    slider to On if you want to use auto    configuration, and in the From    Interface pull-down, select the    interface that's obtaining its address through    DHCP. 2. If you do not enable auto configuration, or if    you want to override any of the automatically    configured settings, configure the following    global options. These settings are sent to DHCP    clients on all interfaces that host DHCP    server.     1. Primary WINS IP Address,       Secondary WINS IP Address.       The addresses of the Windows Internet Name Service       (WINS) servers that clients should use for NetBIOS       name resolution.    2. Primary DNS IP Address,       Secondary DNS IP Address.       The addresses of the Domain Name System (DNS)       servers that clients should use for domain name       resolution. Click Apply Umbrella       Settings if you want to populate the       DNS IP address fields with Cisco Umbrella DNS       servers. Clicking the button loads the appropriate       IP addresses into the fields. 3. Click Save. |
| **Step 3** | In the DHCP Servers section, either edit an existing server, or click New DHCP Server to add and configure a new server.   1. Configure the server properties:     1. Enable DHCP Server. Whether to enable the server. You can configure a server but keep it disabled until you are ready to use it.    2. Interface. Select the interface on which you will provide DHCP addresses to clients. The interface must have a static IP address; you       cannot be using DHCP to obtain the interface address if you want to run a DHCP server on the interface. For bridge groups,       you configure the DHCP server on the Bridge Virtual Interface (BVI), not the member interfaces, and the server operates on       all member interfaces. You cannot configure DHCP server on the Diagnostic interface, configure it on the Management interface       instead, on the Device > System Settings       **>**       Management Interface page.    3. Address Pool. Add the single IP address or an IP address range of a DHCP server. The range of IP addresses from lowest to highest that       the server is allowed to provide to clients that request an address. The range of IP addresses must be on the same subnet       as the selected interface and cannot include: the IP address of the interface itself, the broadcast address, or the subnet       network address. Specify the start and end address for the pool, separated by a hyphen. For example, 10.100.10.12-10.100.10.250. 2. Click OK. |
| **Step 4** | Click Save. |
| **Step 5** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Configure DNS Server

A Domain Name System (DNS) server is used to resolve hostnames to IP addresses. DNS servers are used by the management interface.

#### Procedure

---

| **Step 1** | In Primary, Secondary, Tertiary DNS IP Address, enter the IP addresses of up to three DNS servers in order of preference. The primary DNS server is used unless it cannot be contacted, in which case the secondary is tried, and finally the tertiary. Click Apply Umbrella Settings if you want to populate the DNS IP address fields with Cisco Umbrella DNS servers. Clicking the button loads the appropriate IP addresses into the fields. |
| --- | --- |
| **Step 2** | In Domain Search Name, enter the domain name for your network; for example, example.com. This domain gets appended to hostnames that are not fully qualified; for example, serverA becomes serverA.example.com. |
| **Step 3** | Click Save. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Management Interface

The management interface is a virtual interface attached to the physical management port. The physical port is named the Diagnostic
interface, which you can configure on the Interfaces page with the other physical ports. On virtual FDM-managed devices, this duality is maintained even though both interfaces are virtual.

The management interface has two uses:

* You can open web and SSH connections to the IP address and configure the device through the interface.
* The system obtains smart licensing and database updates through this IP address.

If you use the CLI setup wizard, you configure the management address and gateway for the device during initial system configuration.
If you use the FDM-managed setup wizard, the management address and gateway remain the defaults.

If necessary, you can change these addresses through an FDM-managed device. You can also change the management address and gateway in the CLI using the configure network ipv4 manual and configure network ipv6 manual commands.

You can define static addresses, or obtain an address through DHCP if another device on the management network is acting as
a DHCP server. By default, the management address is static, and a DHCP server runs on the port (except for Virtual FDM-Managed Device, which does not have a DHCP server). Thus, you can plug a device directly into the management port and get a DHCP
address for your workstation. This makes it easy to connect to and configure the device.

| **Caution** | ---   If you change the address to which you are currently connected, you will lose access to the FDM-managed device (or the CLI) when you save the changes, as they are applied immediately. You will need to reconnect to the device. Ensure that the new address is valid and available on the management network.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Configure the management IP address, network mask or IPv6 prefix, and gateway (if necessary) for IPv4, IPv6, or both. You must configure at least one set of properties. Leave one set blank to disable that addressing method. |
| --- | --- |
| **Step 2** | Select Type > DHCP to obtain the address and gateway through DHCP or IPv6 auto configuration. However, you cannot use DHCP if you are using the data interfaces as the gateway. In this case, you must use a static address. |
| **Step 3** | Click Save. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Hostname

You can change the device hostname.

#### Procedure

---

| **Step 1** | In the Firewall Hostname field, enter a new hostname for the device. |
| --- | --- |
| **Step 2** | Click Save. |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Configure NTP Server

Configure Network Time Protocol (NTP) servers to set the time on the system.

#### Procedure

---

| **Step 1** | Select whether you want to use your own (manual) or Cisco's time servers.   * New NTP Server. Enter the fully qualified domain name or IP address of the NTP server you want to use. For example, ntp1.example.com or   10.100.10.10. * Use Default. |
| --- | --- |
| **Step 2** | Click Save. |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Configure URL Filtering

The system obtains the URL category and reputation database from Cisco Collective Security Intelligence (CSI). These preferences
control database updates and how the system handles URLs with unknown category or reputation. You must enable the URL Filtering
license to set these preferences.

| **Caution** | ---   You can configure URL Filtering Preferences if you do not have a URL Smart License, but you need the smart license to deploy. You will be blocked from deploying until you add a URL Smart License.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Enable the applicable options:   * Click the Enable Automatic Updates slider On to automatically check for and download updated URL data, which includes category and reputation information. After   you deploy, the FDM-managed device checks for updates every 30 minutes. * Click the Query Cisco CSI for Unknown URLs slider to ON to check the Cisco CSI for updated information on URLs that do not have category and reputation data in the   local URL filtering database. * URL Time to Live is only in effect if you enable the Query Cisco CSI for Unknown URLs option. This determines how long to cache the category and reputation lookup values for a given URL. When the time to live   expires, the next attempted access of the URL results in a fresh category/reputation lookup. A shorter time results in more   accurate URL filtering, a longer time results in better performance for unknown URLs. The default selection is Never. |
| --- | --- |
| **Step 2** | Click Save. |
| **Step 3** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Cloud Services

Use the Cloud Services page to manage cloud-based services.

| **Note** | ---   Connecting to the Cisco Success Network and configuring which events are sent to the Cisco cloud are features that can be configured on FDM-managed devices running software versions 6.6 and higher.   --- |
| --- | --- |

* [Connecting to the Cisco Success Network](#Connecting_to_the_Cisco_Success_Network)
* [Sending Events to the Cisco Cloud](#Sending_Events_to_the_Cisco_Cloud)

#### Connecting to the Cisco Success Network

By enabling Cisco Success Network, you are providing usage information and statistics to Cisco that are essential for Cisco
to provide you with technical support. This information also allows Cisco to improve the product and to make you aware of
unused available features so that you can maximize the value of the product in your network.

When you enable the connection, your device establishes a secure connection to the Cisco Cloud so that your device can participate
in additional service offerings from Cisco such as technical support services, cloud management and monitoring services. Your
device will establish and maintain this secure connection at all times.

Before you begin

To enable Cisco Success Network the device must be enrolled with the cloud using an FDM-managed device. To enroll the device either register the device with Cisco Smart Software Manager (on the Smart Licensing page) or
enroll with Security Cloud Control by entering a registration key.

| **Attention** | ---   If you enable Cisco Success Network on the active unit in a high availability group, you are also enabling the connection on the standby unit.   --- |
| --- | --- |

##### Procedure

---

| **Step 1** | Click the Cloud Services tab. |
| --- | --- |
| **Step 2** | Click the Enabled slider for the Cisco Success Network feature to change the setting as appropriate. |
| **Step 3** | Click Save. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

#### Sending Events to the Cisco Cloud

You can send events to the Cisco cloud server. From there, various Cisco cloud services can access the events. You can then
use these cloud applications, such as Cisco Threat Response, to analyze the events and to evaluate threats that the device
might have encountered.

Before you begin

You must register the device with the Cisco Smart Software Manager before you can enable this service.

You can connect to the Cisco Threat Response at <https://visibility.amp.cisco.com/> in the US region, <https://visibility.amp.cisco.com/> in the EU region. You can watch videos about the use and benefits of the application on YouTube at <http://cs.co/CTRvideos>. For more information about using Cisco Threat Response with FTD, see Firepower and CTR Integration Guide, which you can find at <https://www.cisco.com/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html>.

##### Procedure

---

| **Step 1** | Click the Cloud Services tab. |
| --- | --- |
| **Step 2** | Click the Enabled slider for the Send Events to the Cisco Cloud option to change the setting as appropriate. |
| **Step 3** | When you are enabling the service, you are prompted to select the events to send to the cloud.   * File/Malware - For any file policies, you   have applied in any access control rule. * Intrusion Events - For any intrusion   policies, you have applied in any access control rule. * Connection Events - For access control rules   where you have enabled logging. When you select this option, you can   also elect to send All Connection Events, or only send the High   Priority connection events. High-priority connection events are   those related to connections that trigger intrusion, file, or   malware events, or that match Security Intelligence blocking   policies. |
| **Step 4** | Click Save. |
| **Step 5** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

### Enabling or Disabling Web Analytics

Enabling web analytics provides anonymous product usage information to Cisco based on page hits. The information includes
pages viewed, the time spent on a page, browser versions, product version, device hostname, and so forth. This information
can help Cisco determine feature usage patterns and help Cisco improve the product. All usage data is anonymous and no sensitive
data is transmitted. You can use Security Cloud Control to configure this feature on all versions of FDM-managed device.

Web analytics is enabled by default.

#### Procedure

---

| **Step 1** | Click the Web Analytics tab. |
| --- | --- |
| **Step 2** | Click the Enable slider for the Web Analytics feature to change the setting as appropriate. |
| **Step 3** | Click Save. |
| **Step 4** | [Review and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. |

---

## Security Cloud Control Command Line Interface

Security Cloud Control provides users with a command line interface (CLI) for managing , FDM-managed
threat defense
 devices. Users can send commands to a single device or to multiple devices simultaneously.

* [Using the Command Line Interface](#Using_theCLI_on_a_Single_Device)
* [Entering Commands in the Command Line Interface](#How_toentercommands)
* [Work with Command History](#Work_withCommand_History)

**Related Information:**

* For FTD CLI documentation, see [Cisco Firepower Threat Defense Command
  Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense/using_the_FTD_CLI.html). Note that FDM-managed devices have limited CLI functionality. These devices only have the
  following commands: `show, ping, traceroute, packet-tracer,
  failover, and shutdown.`

### Using the Command Line Interface

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Use the device tabs and filter button to find the device you want to manage using the command line interface (CLI). |
| **Step 4** | Select the device. |
| **Step 5** | In the Device Actions pane, click >\_Command Line Interface. |
| **Step 6** | Click the Command Line Interface tab. |
| **Step 7** | Enter your command, or commands, in the command pane and click Send. The device's response to the command(s) are displayed below in the "response pane."   | **Note** | If there are limitations on the commands you can run, those limitations are listed above the command pane. | | --- | --- | |

---

**Related Tasks**
[Entering Commands in the Command Line Interface](#How_toentercommands)

### Entering Commands in the Command Line Interface

A single command can be entered on a single line or several commands can be entered sequentially on several lines and Security Cloud Control will execute them in order. The following ASA example sends a batch of commands which creates three network objects and a network object group that contains those network
objects.
![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453392.jpg)

**Entering FDM-managed device Commands**: The CLI console uses the base Threat
Defense CLI. You cannot enter the diagnostic CLI, expert mode, or FXOS CLI (on models
that use FXOS) using the CLI console. Use SSH if you need to enter those other CLI
modes.

### Work with Command History

After you send a CLI command, Security Cloud Control records that command in the history pane on the Command Line Interface page. You can rerun the commands saved in the history pane or use the commands as a template:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices page. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Click >\_Command Line Interface. |
| **Step 5** | Click the clock icon  to expand the history pane if it is not already expanded. |
| **Step 6** | Select the command in the history pane that you want to modify or resend. |
| **Step 7** | Reuse the command as it is or edit it in the command pane and click Send. Security Cloud Control displays the results of the command in the response pane.   | **Note** | Security Cloud Control displays the `Done!` message in the response pane in two circumstances:   * After a command has executed successfully. * When the command has no results to return. For example, you may issue a show command with a regular expression searching for   a configuration entry. If there is no configuration entry that meets the criteria of the regular expression, Security Cloud Control returns `Done!`. | | --- | --- | |

---

## Bulk Command Line Interface

Security Cloud Control offers users the ability to manage Secure Firewall ASA, FDM-managed
Threat
Defense, SSH, and Cisco IOS devices using a command-line interface (CLI). Users can send commands to a single device or to multiple
devices of the same kind simultaneously. This section describes sending CLI commands to multiple devices at once.

* [Bulk CLI Interface](#Bulk_CLI_Interface)
* [Send Commands in Bulk](#Send_Commands_in_Bulk)
* [Work with Bulk Command History](#Workwith_Bulk_Command_History)
* [Work with Bulk Command Filters](#Workwith_Bulk_Command_Filters)

**Related Information:**

* For FDM-managed device documentation, Security Cloud Control supports only the base FTD CLI. These devices only have the following commands: `show, ping, traceroute, packet-tracer, failover, and shutdown`.

  For Threat
  Defense CLI documentation, see [Cisco Firepower Threat Defense Command
  Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense/using_the_FTD_CLI.html).

### Bulk CLI Interface

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453373.jpg)

| **Note** | ---   Security Cloud Control displays the **Done!** message in two circumstances:   * After a command has executed successfully without errors. * When the command has no results to return. For example, you may issue a show command with a regular expression searching for   a certain configuration entry. If there is no configuration entry that meets the criteria of the regular expression, Security Cloud Control returns **Done!**.  --- |
| --- | --- |

| Number | Description |
| --- | --- |
| 1 | Click the clock to expand or collapse the command history pane. |
| 2 | Command history. After you send a command, Security Cloud Control records the command in this history pane so you can return to it, select it, and run it again. |
| 3 | Command pane. Enter your commands at the prompt in this pane. |
| 4 | Response pane. Security Cloud Control displays the device's response to your command as well as Security Cloud Control messages. If the response was the same for more than one device, the response pane displays the message "Showing Responses for X devices." Click X devices and Security Cloud Control displays all the devices that returned the same response to the command.   | **Note** | Security Cloud Control displays the ****Done!**** message in two circumstances:   * After a command has executed successfully without errors. * When the command has no results to return. For example, you may issue a show command with a regular expression searching for   a certain configuration entry. If there is no configuration entry that meets the criteria of the regular expression, Security Cloud Control returns **Done!**. | | --- | --- | |
| 5 | My List tab displays the devices you selected from the **Security Devices** table and allows you to include or exclude devices you want to send a command to. |
| 6 | The Execution tab, highlighted in the figure above, displays the devices in the command that is selected in the history pane. In this example, the show run | grep user command is selected in the history pane and the Execution tab shows that it was sent to 10.82.109.160, 10.82.109.181, and 10.82.10.9.187. |
| 7 | Clicking the By Response tab shows you the list of responses generated by the command. Identical responses are grouped together in one row. When you select a row in the By Response tab, Security Cloud Control displays the response to that command in the response pane. |
| 8 | Clicking the By Device tab displays individual responses from each device. Clicking one of the devices in the list allows you to see the response to the command from a specific device. |

### Send Commands in Bulk

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate the devices. |
| **Step 3** | Select the appropriate device tab and use the filter button to find the devices you want to configure using the command line interface. |
| **Step 4** | Select the devices. |
| **Step 5** | in the Device Actions pane, click >\_Command Line Interface. |
| **Step 6** | You can check or uncheck devices you want to send the commands to in the My List field. |
| **Step 7** | Enter your commands in the command pane and click Send. The command output is displayed in the response pane, the command is logged in the Change Log, and the command Security Cloud Control records your command in the History pane in the Bulk CLI window. |

---

### Work with Bulk Command History

After you send a bulk CLI command, Security Cloud Control records that command in the [Bulk CLI page](#Bulk_CLI_Interface) history page. You can rerun the commands saved in the history pane or use the commands as a template. The commands in the
history pane are associated with the original devices on which they were run.

#### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate devices. |
| **Step 3** | Click the appropriate device type tab and click the filter icon to find the devies you want to configure. |
| **Step 4** | Select the devices. |
| **Step 5** | Click Command Line Interface. |
| **Step 6** | Select the command in the History pane that you want to modify or resend. Note that the command you pick is associated with specific devices and not necessarily the ones you chose in the first step. |
| **Step 7** | Look at the My List tab to make sure the command you intend to send will be sent to the devices you expect. |
| **Step 8** | Edit the command in the command pane and click Send. Security Cloud Control displays the results of the command in the response pane. |

---

### Work with Bulk Command Filters

After you run a bulk CLI command you can use the By Response filter and
the By Device filter to
continue to configure the devices.

* [By Response Filter](#By_Response_Filter)
* [By Device Filter](#By_Device_Filter)

#### By Response Filter

After running a bulk command, Security Cloud Control populates the **By Response** tab with a list of responses returned by the devices that were sent the command. Devices with identical responses are consolidated
in a single row. Clicking a row in the **By Response**  tab displays the response from the device(s) in the response pane. If the response pane shows a response for more than one
device, it displays the message "Showing Responses for X devices." Click X devices and Security Cloud Control displays all the devices that returned the same response to the command.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453375.jpg)

To send a command to the list of devices associated with a command response, follow this procedure:

##### Procedure

---

| **Step 1** | Click the command symbol in a row in the **By Response** tab. |
| --- | --- |
| **Step 2** | Review the command in the command pane and click Send to resend the command or click Clear to clear the command pane and enter a new command to send to the devices and then click Send. |
| **Step 3** | Review the responses you receive from your command. |
| **Step 4** | If you are confident that the running configuration file on the devices you chose reflects your change, type `write memory` in the command pane and click Send. This saves your running configuration to the startup configuration. |

---

#### By Device Filter

After running a bulk command, Security Cloud Control populates the the Execution tab and the By Device tab with the list of devices that were sent the command. Clicking a row in the By Device tab displays the response for each device.

To run a command on that same list of devices, follow this procedure:

##### Procedure

---

| **Step 1** | Click the By Device tab. |
| --- | --- |
| **Step 2** | Click >\_Execute a command on these devices. |
| **Step 3** | Click Clear to clear the command pane and enter a new command. |
| **Step 4** | In the My List pane, specify the list of devices you want to send the command to by checking or unchecking individual devices in the list. |
| **Step 5** | Click Send. The response to the command is displayed in the response pane. If the response pane shows a response for more than one device, it displays the message "Showing Responses for X devices." Click X devices and Security Cloud Control displays all the devices that returned the same response to the command. |
| **Step 6** | If you are confident that the running configuration file on the devices you chose reflects your change, type `write memory` in the command pane and click Send. |

---

## Command Line Interface Macros

A CLI macro is a fully-formed CLI command ready to use, or a template of a CLI command
you can modify before you run it. All macros can be run on one or more FTD devices
simultaneously.

Use CLI macros that resemble templates to run the same commands on multiple devices at
the same time. CLI macros promote consistency in your device configurations and
management. Use fully-formed CLI macros to get information about your devices. There are
different CLI macros that are immediately available for you to use on your FTD
devices.

You can create CLI macros for monitoring tasks that you perform frequently. See [Create a CLI Macro](#Createa_CLI_Macro_from_a_New_Command) for more information.

CLI macros are system-defined or user-defined. System-defined macros are provided by Security Cloud Control and can not be edited or deleted. User-defined macros are created by you and can be edited or deleted.

| **Note** | ---   You can only create macros for a device once it has been onboarded to Security Cloud Control.   --- |
| --- | --- |

Using the ASA as an example, if you want to find a particular user on one of your ASAs,
you could run this command:

```
show running-config | grep username
```

When you run the command, you would replace *username* with the username of the user
you are searching for. To make a macro out of this command, use the same command and put
curly braces around *username.*

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453389.jpg)

You can name your parameters anything you want. You can also create the same macro with
this parameter name:

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453390.jpg)

The parameter name can be descriptive and must use alphanumeric characters and
underlines. The command syntax, in this case the
```
show running-config | grep
```
part of the command, must use proper
CLI syntax for the device you are sending the command to.

* [Create a CLI Macro from a New Command](#Createa_CLI_Macro_from_a_New_Command)
* [Create a CLI Macro from CLI History or from an Existing CLI Macro](#Cisco_Task_in_List_GUI.dita_83757e8d-75a1-41cb-8382-6e0aab1d0ad2)
* [Run a CLI Macro](#Run_a_CLI_Macro)
* [Edit a CLI Macro](#Edit_a_CLI_Macro)
* [Delete a CLI Macro](#Delete_a_CLI_Macro)

### Create a CLI Macro from a New Command

#### Procedure

---

| **Step 1** | Before you create a CLI macro, test the command in Security Cloud Control's Command Line Interface to make sure the command syntax is correct and it returns reliable results.   | **Note** | * For FDM-managed devices, Security Cloud Control supports only the commands that can be run in FDM's CLI console: `show, ping, traceroute, packet-tracer, failover, reboot`, and `shutdown`. See [Cisco Firepower Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense/using_the_FTD_CLI.html) for a full description of the syntax of those commands. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the Devices tab to locate the device. |
| **Step 4** | Click the appropriate device type tab and select an online and synced device. |
| **Step 5** | Click >\_Command Line Interface. |
| **Step 6** | Click the CLI macro favorites star  to see what macros already exist. |
| **Step 7** | Click the the plus button . |
| **Step 8** | Give the macro a unique name. Provide a description and notes for the CLI macro if you wish. |
| **Step 9** | Enter the full command in the **Command** field. |
| **Step 10** | Replace the parts of the command that you would want to modify, when you run the command, with a parameter name surrounded by curly braces. |
| **Step 11** | Click Create. The macro you create is available for use on all the devices of that type, not just the one you initially specified.  To run the command see, [Running CLI Macros on your Device](#Run_a_CLI_Macro). |

---

### Create a CLI Macro from CLI History or from an Existing CLI Macro

In this procedure, you are going to create a user-defined macro from a command you
have already run, another user-defined macro, or from a system-defined macro.

#### Procedure

---

| **Step 1** | In the left pane, Security Devices.   | **Note** | If you want to create a user-defined macro from CLI history, select the device on which you ran the command. CLI macros are shared across devices on the same account but not CLI history. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab and select an online and synced device. |
| **Step 4** | Click >\_Command Line Interface. |
| **Step 5** | Find the command you want to make a CLI macro from and select it. Use one of these methods:   * Click the clock  to view the commands you have run on that device. Select the one   you want to turn into a macro and the command appears in the command   pane. * Click the CLI macro favorites star  to see what macros already exist. Select the user-defined or   system-defined CLI macro you want to change. The command appears in   the command pane. |
| **Step 6** | With the command in the command pane, click the CLI macro gold star . The command is now the basis for a new CLI macro. |
| **Step 7** | Give the macro a unique name. Provide a description and notes for the CLI macro if you wish. |
| **Step 8** | Review the command in the Command field and make the changes you want. |
| **Step 9** | Replace the parts of the command that you would want to modify, when you run the command, with a parameter name surrounded by curly braces. |
| **Step 10** | Click Create. The macro you create is available for use on all the devices of that type, not just the one you initially specified.  To run the command see, [Running CLI Macros](#Run_a_CLI_Macro). |

---

### Run a CLI Macro

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab and select one or more devices. |
| **Step 4** | Click >\_Command Line Interface. |
| **Step 5** | In the command panel, click the star . |
| **Step 6** | Select a CLI macro from the command panel. |
| **Step 7** | Run the macro one of two ways:   * If the macro has no parameters to define, click Send. The response to the command appears in the response pane. You're done. * If the macro contains parameters, such as the Configure DNS macro below, click >\_ View Parameters. |
| **Step 8** | In the Parameters pane, fill in the values for the parameters in the Parameters fields. |
| **Step 9** | Click Send. After Security Cloud Control has successfully, sent the command and updated the device's configuration, you receive the message, Done!   * For an FTD, the device's active configuration is updated. |
| **Step 10** | After you send the command you may see the message, "Some commands may have made changes to the running config" along with two links.    * Clicking Write to Disk saves the changes made by this command, and any other change that in the running config, to the device's startup config. * Clicking Dismiss, dismisses the message. |

---

### Edit a CLI Macro

You can edit user-defined CLI macros but not system-defined macros. Editing a CLI macro changes
it for all your FTD devices. Macros are not specific to a particular device.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select your device. |
| **Step 5** | Click Command Line Interface. |
| **Step 6** | Select the user-defined macro you want to edit. |
| **Step 7** | Click the edit icon in the macro label. |
| **Step 8** | Edit the CLI macro in the Edit Macro dialog box. |
| **Step 9** | Click Save.  See [Run CLI Macros](#Run_a_CLI_Macro) for instructions on how to run the CLI macro. |

---

### Delete a CLI Macro

You can delete user-defined CLI macros but not system-defined macros. Deleting a CLI macro deletes it for all your devices.
Macros are not specific to a particular device.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select your device. |
| **Step 5** | Click >\_Command Line Interface. |
| **Step 6** | Select the user-defined CLI macro you want to delete. |
| **Step 7** | Click the trash can icon  in the CLI macro label. |
| **Step 8** | Confirm you want to remove the CLI macro. |

---

## Command Line Interface Documentation

Security Cloud Control partially supports the command line interface of the FDM-managed device. We provide a terminal-like interface within Security Cloud Control for users to send commands to single devices and multiple devices simultaneously in command-and-response form. For commands
that are not supported in Security Cloud Control, access the device with a device GUI terminal, such as PuTTy or an SSH Client, and see the [CLI documentation](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense/using_the_FTD_CLI.html) for more commands.

## Export Security Cloud Control CLI Command Results

You can export the results of CLI commands issued to a standalone device, or several devices, to a comma separated value (.csv)
file so you can filter and sort the information in it however you like. You can export the CLI results of a single device,
or many devices at once. The exported information contains the following:

* Device
* Date
* User
* Command
* Output

* [Export CLI Command Results](#Export_CLI_Command_Results)
* [Export the Results of CLI Macros](#Export_the_Results_of_CLI_Macros)
* [Export the CLI Command History](#Export_the_CLI_Command_History)
* [Export the CLI Macro List](#Cisco_Task_in_List_GUI.dita_125c73ca-41f6-42e8-8ab7-516aefc82aa7)

### Export CLI Command Results

You can export the results of commands you have just executed in the command window to a .csv file:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device or devices so they are highlighted. |
| **Step 5** | In the Device Actions pane for the device, click >\_Command Line Interface. |
| **Step 6** | In the command line interface pane, enter a command and click Send to issue it to the device. |
| **Step 7** | To the right of the window of entered commands, click the export icon . |
| **Step 8** | Give the .csv file a descriptive name and save the file to your local file system. When reading the command output on the .csv file, expand all the cells to see all the results of the command. |

---

### Export the Results of CLI Macros

You can export the results of macros that have been executed in the command window. Use the following procedure to export
to a .csv file, the results of CLI macros executed on one or multiple devices:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device or devices so they are highlighted. |
| **Step 5** | In the Device Actions pane for the device, click >\_Command Line Interface. |
| **Step 6** | In the left pane of the CLI window, select the CLI macro favorites star . |
| **Step 7** | Click on the macro command you want to export. Fill in any appropriate parameters and click Send. |
| **Step 8** | To the right of the window of entered commands, click the export icon . |
| **Step 9** | Give the .csv file a descriptive name and save the file to your local file system. When reading the command output on the .csv file, expand all the cells to see all the results of the command. |

---

### Export the CLI Command History

Use the following procedure to export the CLI history of one or multiple devices to a .csv file:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device or devices so they are highlighted. |
| **Step 5** | In the Device Actions pane for the device, click >\_Command Line Interface. |
| **Step 6** | Click the Clock icon  to expand the history pane if it is not already expanded. |
| **Step 7** | To the right of the window of entered commands, click the export icon . |
| **Step 8** | Give the .csv file a descriptive name and save the file to your local file system. When reading the command output on the .csv file, expand all the cells to see all the results of the command. |

---

**Related Information:**

* [Security Cloud Control Command Line Interface](#Using_the_CDO_Command_Line_Interface)
* [Create a CLI Macro](#Createa_CLI_Macro_from_a_New_Command)
* [Delete a CLI Macro](#Delete_a_CLI_Macro)
* [Edit a CLI Macro](#Edit_a_CLI_Macro)
* [Run a CLI Macro](#Run_a_CLI_Macro)
* [FTD Command Line Interface Documentation](#FTD_Command_Line_Interface_Documentation)
* [Bulk Command Line Interface](#About_the_Bulk_Command_Line_Interface)

### Export the CLI Macro List

You can only export macros that have been executed ed in the command window. Use the
following procedure to export the CLI macros of one or multiple devices to a .csv
file:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device or devices so they are highlighted. |
| **Step 5** | In the Device Actions pane for the device, click >\_Command Line Interface. |
| **Step 6** | In the left pane of the CLI window, select the CLI macro favorites star . |
| **Step 7** | Click on the macro command you want to export. Fill in any appropriate parameters and click Send. |
| **Step 8** | To the right of the window of entered commands, click the export icon . |
| **Step 9** | Give the .csv file a descriptive name and save the file to your local file system. |

---

## Security Cloud Control Public API

Security Cloud Control has published its public API and provided you with documentation, examples, and a playground to try things out. The goal
of our public API is to provide you with a simple and effective way to perform a lot of what you would normally be able to
do in the Security Cloud Control UI, but in code.

To use this API, you will need to know GraphQL. Their official guide (<https://graphql.org/learn/>) provides a thorough, light read.

To find the full schema documentation, go to the [GraphQL Playground](https://edge.staging.cdo.cisco.com/api-explorer/playground-samples), and click the docs tab on the right side of the page.

You can launch the Security Cloud Control Public API by selecting it from the user menu.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453175.jpg)

## Create a REST API Macro

* [Using the API Tool](#Overview)
* [How to Enter a Secure Firewall Threat Defense REST API Request](#How_to_Enter_FTD_REST_API_Request)
* [About FTD REST API Macros](#About_FTD_REST_API_Macros)
* [Create a REST API Macro from a New Command](#Create_a_REST_API_Macro_from_a_New_Command)
* [Create a REST API Macro from History or from an Existing REST API Macro](#Create_a_REST_API_Macro_fromHistory_or_from_an_Existing_REST_API_Macro)

### Using the API Tool

Security Cloud Control provides the API Tool interface to execute the FDM-managed device REpresentational State Transfer (REST) Application Programming (API) requests
for performing advanced actions on an FDM-managed device. The REST API uses JavaScript Object Notation (JSON) format to represent
objects.

The interface provides system-defined or user-defined API macros. System-defined macros are
provided by Security Cloud Control and can not be edited or deleted. User-defined macros are created by you and can be
edited or deleted. You can use all the resource groups supported in the Secure Firewall
device manager API Explorer.

| **Note** | ---   Security Cloud Control supports only API endpoints that return JSON.   --- |
| --- | --- |

#### Assumption

It is assumed that you have a general knowledge of programming and a specific understanding of REST APIs and JSON. If you
are new to these technologies, please first read a general guide on REST APIs.

#### Supported Documents

* You can refer to the [Cisco Firepower Threat Defense REST API Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/ftd-api/guide/ftd-rest-api.html) for detailed information.
* You can also find reference information and examples online at [Cisco DevNet Site](https://developer.cisco.com/site/ftd-api-reference/).

#### Supported HTTP Methods

You can use the following HTTP methods only.

| **Important** | ---   A user with the [Read-Only](basics-of-cisco-defense-orchestrator.html#User_Roles) role can perform only the GET operation.   --- |
| --- | --- |

| Attribute | Description |
| --- | --- |
| GET | To read data from the device. |
| POST | To create new objects for a type of resource. For example, use POST to create a new network object. |
| PUT | To change the attributes of an existing resource. When using PUT, you must include the entire JSON object. You cannot selectively update individual attributes within an object. For example, use PUT to modify the address contained within an existing network object. |
| DELETE | To remove a resource that you, or another user, created. For example, use DELETE to remove a network object that you no longer use. |

**Related Information:**

* [How to Enter FTD REST API Request](#How_to_Enter_FTD_REST_API_Request)
* [About FTD REST API Macros](#About_FTD_REST_API_Macros)

  + [Create a REST API Macro](#Create_a_REST_API_Macro)
  + [Run a REST API Macro](#Run_a_REST_API_Macro)
  + [Edit a REST API Macro](#Edit_a_REST_API_Macro)
  + [Delete a REST API Macro](#Delete_a_REST_API_Macro)

### How to Enter a Secure Firewall Threat Defense REST API Request

You can select an FDM-managed device and specify a single command or execute commands that need additional parameters.

If you want to determine the syntax of a REST API request, log on to the device's API Explorer page, such as <https://ftd.example.com/#/api-explorer>, and click the required resource groups to see the syntax of the command to be executed. For example, <https://10.10.5.84/#/api-explorer>.

The following figure shows an example of a single REST API request in Security Cloud Control:

![](/c/dam/en/us/td/i/400001-500000/450001-460000/458001-459000/458135.jpg)

The following figure shows an example of a REST API request that needs additional parameters. You need manually specify the
data in the Request Body. If you want to determine the syntax of a command, log on to the device's API Explorer page.

| **Note** | ---   The device must be in the synced state to execute the POST request.   --- |
| --- | --- |

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453590.jpg)

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select an FDM-managed device you want to manage using the REST API, and in Device Actions on the right, click API Tool. |
| **Step 5** | Select the request method from the drop-down and type/api/fdm/latest/and then the command that you want to execute. If you are executing a POST or PUT command, enter the request body. |
| **Step 6** | Click Send. The Response Body shows the response of the executed command.   | **Important** | The POST request usually makes changes to the staged configuration on the device. Click Commit Changes in FDM to send the changes to the FDM-managed device. | | --- | --- | |

---

**Related Information:**

* [Using the API Tool](#Overview)
* [About FTD REST API Macros](#About_FTD_REST_API_Macros)

  + [Create a REST API Macro](#Create_a_REST_API_Macro)
  + [Run a REST API Macro](#Run_a_REST_API_Macro)
  + [Edit a REST API Macro](#Edit_a_REST_API_Macro)
  + [Delete a REST API Macro](#Delete_a_REST_API_Macro)

### About FTD REST API Macros

A REST API macro is a fully-formed REST API command ready to use, or a template of a REST API command you can modify before
you run it. All REST API macros can be run on one or more FDM-managed devices simultaneously.

Use REST API macros that resemble templates to run the same commands on multiple devices at the same time. REST API macros
promote consistency in your device configurations and management. Use fully-formed REST API macros to get information about
your devices. There are different REST API macros that are immediately available for you to use on your FDM-managed devices.

You can create REST API macros for tasks that you perform frequently. See [Create a REST API Macro](#Create_a_REST_API_Macro) for more information.

REST API macros are system-defined or user-defined. System-defined macros are provided by Security Cloud Control and can not be edited or deleted. User-defined macros are created by you and can be edited or deleted.

| **Note** | ---   You can only create macros for a device once it has been onboarded to Security Cloud Control.   --- |
| --- | --- |

* [Create a REST API Macro](#Create_a_REST_API_Macro)
* [Run a REST API Macro](#Run_a_REST_API_Macro)
* [Edit a REST API Macro](#Edit_a_REST_API_Macro)
* [Delete a REST API Macro](#Delete_a_REST_API_Macro)

**Related Information:**

* [Create a REST API Macro](#Create_a_REST_API_Macro)
* [Run a REST API Macro](#Run_a_REST_API_Macro)
* [Edit a REST API Macro](#Edit_a_REST_API_Macro)
* [Delete a REST API Macro](#Delete_a_REST_API_Macro)

#### Create a REST API Macro

##### Create a REST API Macro from a New Command

###### Procedure

---

| **Step 1** | Before you create a REST API macro, test the command in Security Cloud Control's REST API Interface to make sure the command syntax is correct and it returns reliable results.   | **Note** | You can only create macros for a device once it has been onboarded to Security Cloud Control. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | Select an FDM-managed device you want to manage using the REST API, and in Device Actions on the right, click API Tool. |
| **Step 3** | Click the REST API macro favorites star  to see what macros already exist. |
| **Step 4** | Click the plus button . |
| **Step 5** | Give the macro a unique name. Provide a description and notes for the REST API macro if you wish. |
| **Step 6** | Select a Request Method and enter the endpoint URL in the Request Endpoint field. See [Cisco Firepower Threat Defense REST API Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/ftd-api/guide/ftd-rest-api.html) for detailed information. |
| **Step 7** | Replace the parts of the command that you would want to modify, when you run the command, with a parameter name surrounded by curly braces. |
| **Step 8** | Click OK. The macro you create is available for use on all the devices of that type, not just the one you initially specified.  To run the command see, [Run a REST API Macro](#Run_a_REST_API_Macro). |

---

##### Create a REST API Macro from History or from an Existing REST API Macro

In this procedure, you are going to create a user-defined REST API macro from a command you have already executed, another
user-defined macro, or from a system-defined macro.

###### Procedure

---

| **Step 1** | Select an FDM-managed device you want to manage using the REST API, and in Device Actions on the right, click API Tool.   | **Note** | If you want to create a user-defined macro from REST API history, select the device on which you ran the command. REST API macros are shared across devices on the same account but not REST API history. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | Find the command you want to make an API macro from and select it. Use one of these methods:   * Click the clock  to view the commands you have run on that device. Double-click to select the one you want to turn into a macro and the command   appears in the command pane. * Click the API macro favorites star  to see what macros already exist. Select the user-defined or system-defined API macro you want to change. The command appears   in the command pane. |
| **Step 3** | With the command in the command pane, click the API macro gold star . The command is now the basis for a new API macro. |
| **Step 4** | Give the macro a unique name. Provide a description and notes for the API macro if you wish. |
| **Step 5** | Review the command in the Command field and make the changes you want. |
| **Step 6** | Replace the parts of the command that you would want to modify, when you run the command, with a parameter name surrounded by curly braces. |
| **Step 7** | Click Create. The macro you create is available for use on all the devices of that type, not just the one you initially specified.  To run the command see, [Run a REST API Macro](#Run_a_REST_API_Macro). |

---

**Related Information:**

[About FTD REST API Macros](#About_FTD_REST_API_Macros)

#### Run a REST API Macro

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Click API Tool in the Device Actions pane on the right. |
| **Step 5** | In the command panel, click the star  to view the REST API macros. |
| **Step 6** | Select a REST API macro from the command panel. |
| **Step 7** | Run the macro one of two ways:   * If the macro has no parameters to define, click Send. The response to the command appears in the response pane. You're done. * If the macro contains parameters, such as the Create Network Object macro below, click View Parameters. |
| **Step 8** | In the Parameters pane, fill in the values for the parameters in the Parameters fields. |
| **Step 9** | Click Send.   | **Note** | The FDM-managed device's active configuration is updated. | | --- | --- | |

---

**Related Information:**

[About FTD REST API Macros](#About_FTD_REST_API_Macros)

#### Edit a REST API Macro

You can edit user-defined REST API macros but not system-defined macros. Editing a REST API macro changes it for all your
FDM-managed devices. Macros are not specific to a particular device.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select an FDM-managed device you want to manage using the REST API, and in Device Actions on the right, click API Tool. |
| **Step 5** | Select the user-defined macro you want to edit. |
| **Step 6** | Click the edit icon in the macro label. |
| **Step 7** | Edit the REST API macro in the Edit Macro dialog box. |
| **Step 8** | Click Save.  See [Run a REST API Macro](#Run_a_REST_API_Macro) for instructions on how to run the REST API macro. |

---

**Related Information:**

[About FTD REST API Macro](#About_FTD_REST_API_Macros)

#### Delete a REST API Macro

You can delete user-defined REST API macros but not system-defined macros. Deleting a REST API macro deletes it for all your
devices. Macros are not specific to a particular device.

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select a device and in Device Actions on the right, click API Tool. |
| **Step 5** | Select the user-defined REST API macro you want to delete. |
| **Step 6** | Click the trash can icon  in the REST API macro label. |
| **Step 7** | Confirm you want to remove the REST API macro. |

---

**Related Infomration:**

[About FTD REST API Macro](#About_FTD_REST_API_Macros)

## About Device Configuration Changes

In order to manage a device, Security Cloud Control must have its own copy of the device's configuration stored in its local
database. When Security Cloud Control "reads" a configuration from a device it manages, it takes a copy of the device's
configuration and saves it. The first time Security Cloud Control reads and saves a copy of a device's configuration is when the device is
onboarded. These choices describe reading a configuration for different
purposes:

* Discard Changes: This action is available when a device's configuration status is "Not Synced." In the Not Synced state, there are changes
  to the device's configuration pending on Security Cloud Control. This option allows you to undo all pending changes. The pending changes are deleted and Security Cloud Control overwrites its copy of the configuration with copy of the configuration stored on the device.
* Check for Changes: This action is available if the device's configuration status is Synced. Clicking Checking for Changes directs Security Cloud Control to compare its copy of the device's configuration with the copy of the configuration stored on the device. If there is a
  difference, Security Cloud Control immediately overwrites its copy of the device's configuration with the copy stored on the device.
* Review Conflict and Accept Without Review: If you have enabled [Conflict Detection](https://docs.defenseorchestrator.com/Welcome_to_Cisco_Defense_Orchestrator/Basics_of_Cisco_Defense_Orchestrator/Synchronizing_Configurations_Between_Defense_Orchestrator_and_Device/0010_Conflict_Detection) on a device, Security Cloud Control checks for configuration changes made on the device every 10 minutes. If the copy of the configuration stored on the device
  has changed, Security Cloud Control notifies you by displaying the "Conflict Detected" configuration status.

  + Review Conflict: Click Review Conflict allows you to review changes made directly on a device and accept or reject them.
  + Accept Without Review: This action overwrites Security Cloud Control's copy of a device's configuration with the latest copy of the configuration stored on the device. Security Cloud Control does not prompt you to confirm the differences in the two copies of the configuration before taking the overwriting action.

Read All: This is a bulk operation. You can select more than one device, in any state, and click **Read All** to overwrite all the devices' configurations stored on Security Cloud Control with the configurations stored on the devices.

* Deploy Changes: As you make changes to a device's configuration, Security Cloud Control saves the changes you make to its own copy of the configuration. Those changes are "pending" on Security Cloud Control until they are deployed to the device. When there are changes to a device's configuration that have not been deployed to
  the device, the device is in the Not Synced configuration state.

  Pending configuration changes have no effect on the network traffic running through the device. Only after Security Cloud Control deploys the changes to the device do they have an effect. When Security Cloud Control deploys changes to the device's configuration, it only overwrites those elements of the configuration that were changed.
  It does not overwrite the entire configuration file stored on the device. Deployments can be initiated for a single device
  or on more than one device simultaneously.
* Discard All is an option that is only available after you click Preview and Deploy.... After clicking Preview and Deploy, Security Cloud Control shows you a preview of the pending changes in Security Cloud Control. Clicking Discard All deletes all pending changes from Security Cloud Control and does not deploy anything to the selected device(s). Unlike "Discard Changes" above, deleting the pending changes is the
  end of the operation.

| **Note** | ---   You can schedule deployments or recurring deployments. See [Schedule an Automatic Deployment](#Schedule_an_AutomaticDeployment) for more information.   --- |
| --- | --- |

## Read All Device Configurations

If a configuration change is made to a device outside of Security Cloud Control, the device's configuration stored on Security Cloud Control and the device's local copy of its configuration are no longer the same. You many want to overwrite Security Cloud Control's copy of the device's configuration with the configuration stored on the device to make the configurations the same again.
You can perform this task on many devices simultaneously using the Read All link.

See [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a) for more information about how Security Cloud Control manages the two copies of the device's configuration.

Here are three configuration statuses where clicking Read All will overwrite Security Cloud Control's copy of the device's configuration with the device's copy of the configuration.

* Conflict Detected-If conflict detection is enabled, Security Cloud Control polls the devices it manages every 10 minutes for changes made to their configurations. If Security Cloud Control finds that the configuration on the device has changed, Security Cloud Control displays a "Conflict detected" configuration status for the device.
* Synced-If the device is in a synced state, and you click Read All, Security Cloud Control immediately checks the devices to determine if there have been any changes made to its configurations directly. After clicking
  Read All, Security Cloud Control confirms your intent to overwrite its copy of the device's configuration and then Security Cloud Control performs the overwrite.
* Not Synced-If the device is in the Not Synced state, and you click Read All, Security Cloud Control warns you that there are pending changes made to to the device's configuration using Security Cloud Control and that proceeding with the Read All operation will delete those changes and then overwrite Security Cloud Control's copy of the configuration with the configuration on the device. This Read All functions like [Discard Changes](#Discard_Changes).

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | (Optional) Create a [change request label](monitoring-and-reporting.html#About_Change_Request_Management) to identify the results of this bulk action easily in the Change Log. |
| **Step 5** | Select the devices whose configurations you want to save Security Cloud Control. Notice that Security Cloud Control only provides command buttons for actions that can be applied to all the selected devices. |
| **Step 6** | Click Read All. |
| **Step 7** | Security Cloud Control warns you if there are configuration changes staged on Security Cloud Control, for any of the devices you selected, and asks if you want to continue with the bulk reading configurations action. Click Read All to continue. |
| **Step 8** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control.") for the progress of the Read All configurations operation. If you want more information about how individual actions in the bulk operation succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 9** | If you created and activated a change request label, remember to clear it so that you don't inadvertently associate other configuration changes with this event. |

---

**Related Information**

* [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)
* [Discard Changes](#Discard_Changes)
* [Check for Changes](#Check_for_Configuration_Changes)

## Read Configuration Changes from FDM-Managed Device to Security Cloud Control

### Why Does Security Cloud Control Read FDM-managed device Configurations?

In order to manage an FDM-managed device, Security Cloud Control must have its own stored copy of the FDM-managed device's configuration. When Security Cloud Control reads a configuration from an FDM-managed device, it takes a copy of the FDM-managed device's deployed configuration and saves it to its own database. The first time Security Cloud Control reads and saves a copy of the device's configuration file is when the device is onboarded. See [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a) for more information.

### Pending and Deployed Changes

Configuration changes made to the FDM-managed device directly through the Firepower Device Manager (FDM) or its CLI are referred to as staged changes on the FDM-managed device until they are deployed. A staged, or pending, change can be edited or deleted without having any affect on traffic
running through the FDM-managed device. Once the pending changes are deployed, however, they are enforced by the FDM-managed device and affect traffic running through the device.

### Conflict Detected

If you enable [Conflict Detection](#Conflict_Detection) on the device, Security Cloud Control checks for configuration changes every 10 minutes. If the copy of the configuration stored on the device has changed, Security Cloud Control notifies you by displaying the "Conflict Detected" configuration status. If you do **not** have Conflict Detection enabled, or a change has been made to the device's configuration within the 10 minute interval between
automatic polling, clicking **Check for Changes** prompts Security Cloud Control to immediately compare the copy of the configuration on the device with the copy of the configuration stored on Security Cloud Control. You can choose to **Review Conflict** to examine the differences between the device configuration and the configuration saved to Security Cloud Control, then select **Discard Changes** to remove the staged changes and revert to the saved configuration or confirm the changes. You can also choose to **Accept without Review**; this option takes the configuration and overwrites what is currently saved to Security Cloud Control.

* [Discard Changes Procedure](#Discard_Changes_Procedure)
* [If Reverting Pending Changes Fails](#If_Reverting_Pending_Changes_Fails)
* [Review Conflict Procedure](#Review_Conflict_Procedure)
* [Accept Without Review Procedure](#Accept_Without_Review_Procedure)

### Discard Changes Procedure

To discard configuration changes from the FDM-managed device, follow this procedure:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appopriate device type tab. |
| **Step 4** | Select the device whose configuration is set to Conflict Detected and gives you the link to Revert Pending Changes. The message explains that you can click the link to revert pending changes or you can log on to the device using the local manager FDM and deploy the changes first. You can use [filters](#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) to find the device in a conflict state.   | **Caution** | Clicking the Revert Pending Changes link deletes pending changes on FDM-managed device immediately. You are not given an opportunity to review the changes first. | | --- | --- | |
| **Step 5** | Review the changes on FDM before clicking Revert Pending Changes:   1. Open a browser window and enter https://<*IP\_address\_of\_the\_FTD*>. 2. Look for the deployment icon in FDM. It will have an orange circle indicating that there are changes ready to deploy . 3. Click the icon and review the pending changes:  * If the changes can be deleted, return to Security Cloud Control and click "Revert Pending Changes." At this point, the configuration on the FDM-managed device and the copy of the configuration on Security Cloud Control should be the same. You are done. * If you want to deploy the changes to the device, click Deploy Now. Now the deployed configuration on the FDM-managed device and the configuration on stored on Security Cloud Control are different. You can then return to Security Cloud Control and [poll the device for changes](#Check_for_Configuration_Changes). Security Cloud Control identifies identifies that there has been a change on the FDM-managed device, and gives you an opportunity to review the conflict. See [Conflict Detected-Review Conflict](#Conflict_Detection) to resolve that state. |

---

### If Reverting Pending Changes Fails

Changes to the system databases and security feeds can't be reverted by Security Cloud Control. Security Cloud Control recognizes that there are pending changes, attempts to revert them and then fails. To determine if the revert failure is
due to pending database updates or security feed updates, log into the device's FDM console. It will have an orange circle
indicating that there are changes ready to deploy ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453413.jpg). Click the deploy button to review the pending changes and deploy them or discard them as is appropriate.

### Review Conflict Procedure

To review configuration changes from the FDM-managed device, follow this procedure:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device whose configuration is marked Conflict Detected and gives you a link to Review Conflict in the Conflict Detected pane on the right. |
| **Step 5** | Click Review Conflict. |
| **Step 6** | Compare the two configurations presented to you. |
| **Step 7** | Take one of these actions:   * Click Accept to overwrite the last known configuration on Security Cloud Control with the one found on the device. Note: The entire configuration stored on Security Cloud Control will be completely overwritten by the configuration found on the device. * Click Reject to reject the changes made on the device and replace them with the last known configuration on Security Cloud Control. * Click Cancel to stop the action.  | **Note** | You can prompt Security Cloud Control to immediately check a device for an out-of-band change by clicking [Check for Changes](#Check_for_Configuration_Changes) while the device is in the Synced state. | | --- | --- | |

---

### Accept Without Review Procedure

To accept configuration changes from the FDM-managed device without reviewing, follow this procedure:

#### Procedure

---

| **Step 1** | In the left pane, click the Security Devices tab. |
| --- | --- |
| **Step 2** | Click the appopriate device type tab. |
| **Step 3** | Select the device whose configuration is marked Conflict Detected and gives you a link to Accept Without Review in the Conflict Detected pane on the right. |
| **Step 4** | Click Accept Without Review. Security Cloud Control accepts and overwrites the current configuration. |

---

**Related Information:**

* [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)
* [Check for Changes](#Conflict_Detection)
* [Discard Changes](#Discarding_Changes)

## Preview and Deploy Configuration Changes for All Devices

Security Cloud Control informs you when you have made a configuration change to a device on your tenant, but you have not deployed that change,
by displaying an orange dot on the Deploy icon ![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453403.jpg). The devices affected by these changes show the status "Not Synced" in the Devices and Services page. By clicking Deploy, you can review which devices have pending changes and deploy the changes to those devices.

| **Note** | ---   For every new FDM or FTD network object or group that you create and make changes to, Security Cloud Control creates an entry in this page for all on-premises management centers that are managed by Security Cloud Control.   --- |
| --- | --- |

This deployment method is available for all supported devices.

You can use this deployment method for single configuration changes or wait and deploy multiple changes at once.

### Procedure

---

| **Step 1** | In the top right corner of the screen, click the Deploy icon . |
| --- | --- |
| **Step 2** | Select the devices with changes you want to deploy. If a device has a yellow caution triangle, you can not deploy changes to that device. Hover your mouse over the yellow caution triangle to find out why you can't deploy changes to that device. |
| **Step 3** | (Optional) If you want to see more information about a pending change, click the View Detailed Changelog link to open the change log associated with that change. Click the Deploy icon to return to the Devices with Pending Changes page. |
| **Step 4** | (Optional) [Create a change request](monitoring-and-reporting.html#About_Change_Request_Management) to track your changes without leaving the Devices with Pending Changes page. |
| **Step 5** | Click Deploy Now to deploy the changes immediately to the devices you selected. You'll see the progress in the Active jobs indicator in the Jobs tray. |
| **Step 6** | (Optional) After the deployment has finished, click Jobs in the Security Cloud Control navigation bar. You will see a recent "Deploy Changes" job showing the results of the deployment. |
| **Step 7** | If you created a change request label, and you have no more configuration changes to associate with it, clear it. |

---

### What to do next

* [Schedule Automatic Deployments](#Scheduled_Deployments_for_Devices)
* [Deploy Configuration Changes from Security Cloud Control to FDM-Managed Device](#Deploy_Configuration_Changes_from_CDO_to_FTD)
* [Change Log Entries After Deploying to FDM-Managed Device](monitoring-and-reporting.html#Change_Log_Entries_after_Deploying_to_FTD)

## Deploy Configuration Changes from Security Cloud Control to FDM-Managed Device

### Why Does Security Cloud Control Deploy Changes to an FDM-Managed Device?

As you manage and make changes to a device's configuration with Security Cloud Control, Security Cloud Control saves the changes you make to its own copy of the configuration file. Those changes are considered staged on Security Cloud Control until they are deployed to the device. Staged configuration changes have no effect on the network traffic running through
the device. Only after Security Cloud Control deploys the changes to the device do they have an affect on the traffic running through the device. When Security Cloud Control deploys changes to the device's configuration, it only overwrites those elements of the configuration that were changed.
It does not not overwrite the entire configuration file stored on the device.

Like Security Cloud Control, FDM-managed device has the concept of pending changes and deployed changes. Pending changes on FDM-managed device are the equivalent of staged changes on Security Cloud Control. A pending change can be edited or deleted without having any affect on traffic running through the FDM-managed device. Once the pending changes are deployed, however, they are enforced by the FDM-managed device and affect traffic running through the device.

Because of FDM-managed devices two step process for editing configuration files, Security Cloud Control deploys changes to an FDM-managed device slightly differently than it does to other devices it manages. Security Cloud Control first deploys the changes to FDM-managed device and the changes are in the pending state. Then, Security Cloud Control deploys the changes on the devices and they become live. Now that the changes have been deployed, they are enforced and affect
traffic running through the FDM-managed device. This applies to both standalone and high availability (HA) devices.

Deployments can be initiated for a single device or on more than one device simultaneously. You can schedule individual deployments
or recurring deployments for a single device.

Two things will prevent Security Cloud Control from deploying changes to an FDM-managed device:

* If there are staged changes on the FDM-managed device. See [Conflict Detected](#Conflict_Detection) for more information on how to resolve this state.
* Security Cloud Control does not deploy changes if there are changes in the process of being deployed to the FDM-managed device.

### Scheduling Automatic Deployments

You can also configure your tenant to schedule deployments to a single device with pending changes [scheduling automatic deployments](#Scheduled_Deployments_for_Devices).

## Deploy Changes to a Device

### Procedure

---

| **Step 1** | After you make a configuration change for a device using Security Cloud Control and save it, that change is saved in Security Cloud Control instance of the device's configuration. |
| --- | --- |
| **Step 2** | In the navigation bar, click Security Devices. |
| **Step 3** | Click the Devices tab. |
| **Step 4** | Click the appropriate device type tab. You should see that the configuration status of the device you made changes to is now "Not synced." |
| **Step 5** | Deploy the changes using one of these methods:   * Select the device and in the Not Synced pane on the right, click Preview and Deploy. On the Pending Changes screen, review the changes. If you are satisfied with the pending version, click Deploy Now. After the changes are deployed successfully, you can view the [change log](monitoring-and-reporting.html#About_Change_Logs) to confirm what just happened. * Click the Deploy icon  at the top-right of the screen. See [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) for more information. |

---

* [Cancelling Changes](#Cancelling_Changes)
* [Discarding Changes](#Discarding_Changes)

### Cancelling Changes

If, when deploying a change from Security Cloud Control to a device, you click Cancel, the changes you made are not deployed to the device. The process is canceled. The changes you made are still pending on
Security Cloud Control and can be edited further before you finally deploy them to FDM-managed device.

### Discarding Changes

If, when previewing changes, you click Discard all, the changes you made, and any other changes any other user made but did not deploy to the device, are deleted. Security Cloud Control reverts its pending configuration to the last read or deployed configuration before any changes were made.

## Bulk Deploy Device Configurations

If you have made changes to multiple devices, for instance by editing a shared
object, you can apply those change to all of the affected devices at once:

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select all of the devices for which you have made configuration changes on Security Cloud Control. These devices should show "Not Synced" status. |
| **Step 5** | Deploy the changes using one of these methods:   * Click the  button at the top-right of the screen to view the Devices with Pending Changes window. This gives you a chance to review the pending changes on the devices you selected before you deploy them. Click Deploy Now to deploy the changes.       | **Note** | If you see a yellow warning triangle next to a device on the Devices with Pending Changes screen, you cannot deploy a change to that device. Hover your mouse over the warning triangle for information about why changes cannot be deployed to that device. |   | --- | --- | * Click Deploy All    on the details pane. Review any warnings and click OK. The bulk deployment starts immediately without a review of the changes. |
| **Step 6** | (Optional) Click the Jobs icon  in the navigation bar to view the results of the bulk deploy. |

---

**Related Information:**

* [Schedule an Automatic Deployment](#Schedule_an_AutomaticDeployment)

## About Scheduled Automatic Deployments

Using Security Cloud Control, you can make configuration changes to one or more of the devices it manages and then schedule the changes to be deployed
to those devices at a time that is convenient for you.

You can only schedule deployments if you [Enable the Option to Schedule Automatic Deployments](basics-of-cisco-defense-orchestrator.html#Enable_the_Option_to_Schedule_Automatic_Deployments) in the Tenant Settings tab of the Settings page. Once this option is enabled, you can create, edit, or delete scheduled deployments. A scheduled
deployment deploys all the staged changes saved on Security Cloud Control at the date and time set. You can also view and delete scheduled deployments from the Jobs page.

If there were changes made directly to the device that have not been [read](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a) to Security Cloud Control, the scheduled deployment will be skipped until that conflict is resolved. The Jobs page will list any instance where a scheduled
deployment fails. If Enable the Option to Schedule Automatic Deployments is turned off, all scheduled deployments are deleted.

| **Caution** | ---   If you schedule a new deployment for multiple devices, and some of those devices already have deployments scheduled, the new scheduled deployment overwrites the existing scheduled deployments.   --- |
| --- | --- |

| **Note** | ---   When you create a scheduled deployment, the schedule is created in your local time, not in the time zone of the device. Scheduled deployments *do not* automatically adjust for daylight savings time.   --- |
| --- | --- |

* [Schedule an Automatic Deployment](#Schedule_an_AutomaticDeployment)
* [Edit a Scheduled Deployment](#Edit_a_Scheduled_Deployment)
* [Delete a Scheduled Deployment](#Delete_a_Scheduled_Deployment)

### Schedule an Automatic Deployment

The deployment schedule can be a single event or a recurring event. You may find recurring automatic deployments a convenient
way to line up recurring deployments with your maintenance window. Follow this procedure to schedule a one-time or a recurring
deployment for a single device:

| **Note** | ---   If you schedule a deployment for a device that has an existing deployment scheduled, the new scheduled deployment overwrites the existing deployment.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select one ore more devices. |
| **Step 5** | In the Device Details pane, locate the Scheduled Deployments tab and click Schedule. |
| **Step 6** | Select when the deployment should occur.   * For a one-time deployment, click the Once on option to select a date and time from the calendar. * For a recurring deployment, click the Every option. You can choose either a daily or once a week deployment. Select the Day and Time the deployment should occur. |
| **Step 7** | Click Save. |

---

### Edit a Scheduled Deployment

Follow this procedure to edit a scheduled deployment:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select one or more devices. |
| **Step 5** | In the Device Details pane, locate the Scheduled Deployments tab and click Edit . |
| **Step 6** | Edit the recurrence, date, or time of a scheduled deployment. |
| **Step 7** | Click Save. |

---

### Delete a Scheduled Deployment

Follow this procedure to delete a scheduled deployment:

| **Note** | ---   If you schedule a deployment for multiple devices, and then change or delete the schedule for some of the devices, the original scheduled deployment for the remaining devices will be preserved.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select one or more devices. |
| **Step 5** | In the Device Details pane, locate the Scheduled Deployments tab and click Delete . |

---

#### What to do next

* [Reading, Discarding, Checking for, and Deploying Configuration Changes](#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a)
* [Read All Device Configurations](#Read_All_Configurations)
* [Deploy Configuration Changes from Security Cloud Control to FDM-Managed Device](#Deploy_Configuration_Changes_from_CDO_to_FTD)
* [Preview and Deploy Configuration Changes for All Devices](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be)

## Check for Configuration Changes

Check for Changes to determine if the device's configuration has been changed directly on the device and it is no longer the same as the copy
of the configuration stored on Security Cloud Control. You will see the this option when the device is in the "Synced" state.

To check changes:

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device, whose configuration you suspect may have been changed directly on the device. |
| **Step 5** | Click Check for Changes in the Synced pane on the right. |
| **Step 6** | The behavior that follows is slightly different depending on the device:   * For FTD   device if there has been a change to the device's configuration, you will receive the message:  `Reading the policy from the device. If there are active deployments on the device, reading will start after they are finished.`    + Click OK to continue. The configuration on the device will overwrite the stored configuration on Security Cloud Control.   + Click Cancel to cancel the action.  * For   device:  1. Compare the two configurations presented to you. Click Continue. The configuration labeled **Last Known Device Configuration** is the configuration stored on Security Cloud Control. The configuration labeled **Found on Device** is the configuration saved on the ASA. 2. Select either:     1. Reject the out-of-band changes to keep the "Last Known Device Configuration."    2. Accept the out-of-band changes to overwrite the device's configuration stored in Security Cloud Control with the configuration found on the device. 3. Click Continue. |

---

## Discard Configuration Changes

Click Discard Changes when you want to "undo" all the *undeployed* configuration changes you made to a device's configuration using Security Cloud Control. When you click Discard Changes, Security Cloud Control
*completely overwrites* its local copy of a device's configuration with the configuration stored on the device.

When you click Discard Changes, your device's configuration status is in a **Not Synced** state. After you discard your changes, the copy of the configuration on Security Cloud Control will be the same as the copy of the configuration on the device and the configuration status in Security Cloud Control will return to Synced.

To discard, or "undo," all of your undeployed configuration changes for a device:

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device you have been making configuration changes to. |
| **Step 5** | Click Discard Changes in the Not Synced pane on the right.   * For FDM-managed devices-Security Cloud Control warns you that "Pending changes on Security Cloud Control will be discarded and the Security Cloud Control configuration for this device will be replaced with the configuration currently running on the device." Click Continue to discard your changes. * For Meraki devices-Security Cloud Control deletes the change immediately. * For AWS devices-Security Cloud Control displays what you are about to delete. Click Accept or Cancel. |

---

## Out-of-Band Changes on Devices

Out-of-band changes refer to changes made directly on the device without using Security Cloud Control. These changes may be made using the device's command-line interface over an SSH connection or by using a local manager like
the Adaptive Security Device Manager (ASDM) for the ASA, the FDM for the FDM-managed device, or for an On-Premises Firewall Management Center on the On-Premises Firewall Management Center user interface. An out-of-band change causes a conflict between the device's configuration stored on Security Cloud Control and the configuration stored on the device itself.

### Detecting Out-of-Band Changes on Devices

If Conflict Detection is enabled for an ASA, or an FDM-managed device, a Cisco IOS device, or an On-Premises Firewall Management Center, Security Cloud Control checks the device every 10 minutes searching for any new changes made directly to the device's configuration outside of Security Cloud Control.

If Security Cloud Control finds that there are changes to the device's configuration that are not stored on Security Cloud Control, it changes the **Configuration Status** of that device to the "Conflict Detected" state.

When Security Cloud Control detects a conflict, one of two conditions is likely:

* There have been configuration changes made to the device directly that have not been saved to Security Cloud Control's database.
* In the case of an FDM-managed device, there may be "pending" configuration changes on the FDM-managed device that have not been deployed.
* In the case of an On-Premises Firewall Management Center, there may be changes made, for instance, to objects outside Security Cloud Control, which are pending to be synchronized with Security Cloud Control or changes made in Security Cloud Control which are pending to be deployed to the On-Premises Firewall Management Center.

## Synchronizing Configurations Between Security Cloud Control and Device

### About Configuration Conflicts

In the Security Devices page, you may see devices or services have the status "Synced," "Not Synced," or "Conflict Detected." To know the status
of an On-Premises Firewall Management Center that you manage using Security Cloud Control, navigate Administration > Firewall Management Center.

* When a device is **Synced**, the configuration on Security Cloud Control) and the configuration stored locally on the device are the same.
* When a device is **Not Synced**, the configuration stored in Security Cloud Control was changed and it is now different that the configuration stored locally on the device. Deploying your changes from Security Cloud Control to the device changes the configuration on the device to match Security Cloud Control's version.
* Changes made to devices outside of Security Cloud Control are called **out-of-band changes**. When out-of-band changes are made, you'll see the device state change to "Conflict Detected," if conflict detection is enabled
  for the device. Accepting the out-of-band changes, changes the configuration on Security Cloud Control to match the configuration on the device.

## Conflict Detection

When conflict detection is enabled, Security Cloud Control polls the device for the default interval to to determine if a change has been made to the device's configuration outside
of Security Cloud Control. If Security Cloud Control detects that a change was made, it changes the configuration status for the device to **Conflict Detected**. Changes made to a device outside of Security Cloud Control are called "out-of-band" changes.

In the case of an On-Premises Firewall Management Center that is managed by Security Cloud Control, if there are changes that are staged and the device is in Not Synced state, Security Cloud Control stops polling the device to check for changes. When there are changes made outside Security Cloud Control which are pending to be synchronized with Security Cloud Control and changes made in Security Cloud Control which are pending to be deployed to the on-premises management center, Security Cloud Control declares the on-premises management center to be in the Conflict Detected state.

Once this option is enabled, you can configure how often conflicts or OOB changes are detected per device. See [Schedule Polling for Device Changes](#Schedule_Polling) for more information.

* [Enable Conflict Detection](#EnableConflict_Detection)

### Enable Conflict Detection

Enabling conflict detection alerts you to instances where changes have been made to a device outside of Security Cloud Control.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab. |
| **Step 3** | Select the appropriate device type tab. |
| **Step 4** | Select the device or devices for which you want to enable conflict detection. |
| **Step 5** | In the Conflict Detection box at the right of the device table, select Enabled from the list. |

---

## Automatically Accept Out-of-Band Changes from your Device

You can configure Security Cloud Control to automatically accept any change made directly to a managed device by enabling auto-accept changes. Changes made directly
to a device without using Security Cloud Control are referred to as out-of-band changes. An out-of-band change creates a *conflict* between the device's configuration stored on Security Cloud Control and the configuration stored on the device itself.

The auto-accept changes feature is an enhancement to conflict detection. If you have auto-accept changes enabled on your device,
Security Cloud Control checks for changes every 10 minutes to determine if there have been any out-of-band changes made to the device's configuration.
If there have been configuration changes, Security Cloud Control automatically updates its local version of the device's configuration without prompting you.

Security Cloud Control will ***not*** automatically accept a configuration change if there are configuration changes made on Security Cloud Control that have not yet been deployed to the device. Follow the prompts on the screen to determine your next action.

To use auto-accept changes, you first enable the tenant to display the auto-accept option in the Conflict Detection menu on
the Security Devices page; then, you enable auto-accept changes for individual devices.

If you want Security Cloud Control to detect out-of-band changes but give you the option to accept or reject them manually, enable [Conflict Detection](#Conflict_Detection) instead.

* [Configure Auto-Accept Changes](#Configure_AutoAccept_Changes)
* [Disabling Auto-Accept Changes for All Devices on the Tenant](#Disabling_AutoAccept_Changes_for_All_Devices_on_the_Tenant)

### Configure Auto-Accept Changes

#### Procedure

---

| **Step 1** | Log in to Security Cloud Control using an account with Admin or Super Admin privileges. |
| --- | --- |
| **Step 2** | In the left pane, click Administration > General Settings. |
| **Step 3** | In the Tenant Settings area, click the toggle to Enable the option to auto-accept device changes. This enables the Auto-Accept Changes menu option to appear in the Conflict Detection menu on the Security Devices page. |
| **Step 4** | In the left pane, click Security Devices and select the device for which you want to automatically accept out-of-band changes. |
| **Step 5** | In the Conflict Detection menu, select Auto-Accept Changes in the drop-down menu. |

---

### Disabling Auto-Accept Changes for All Devices on the Tenant

#### Procedure

---

| **Step 1** | Log-in to Security Cloud Control using an account with Admin or Super Admin privileges. |
| --- | --- |
| **Step 2** | In left pane, click Administration > General Settings. |
| **Step 3** | In the Tenant Settings area, disable the "Enable the option to auto-accept device changes" by sliding the toggle to the left so it shows a grey X. This disables Auto-Accept Changes option in the Conflict Detection menu and disables the feature for every device on your tenant.   | **Note** | Disabling "Auto-Accept" will require you to review each device conflict before you can accept it into Security Cloud Control. This includes devices previously configured to auto-accept changes. | | --- | --- | |

---

## Resolve Configuration Conflicts

This section provides information about resolving configuration conflicts that occur on the device.

* [Resolve the Not Synced Status](#ResolveNot_Synced_Status)
* [Resolve the Conflict Detected Status](#ResolveConflict_Detected_Status)

### Resolve the Not Synced Status

Use the following procedure to resolve a device with a "Not Synced" Configuration Status:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices.   | **Note** | For an On-Premises Firewall Management Center, click Administration > Firewall Management Center and select the FMC that is in Not Synced state and continue from Step 5. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | Click the Devices tab to locate the device or the Templates tab to locate the model device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device reported as Not Synced. |
| **Step 5** | In the **Not synced** panel to the right, select either of the following:   * Preview and Deploy... -If you want to push the configuration change from Security Cloud Control to the device, [preview and deploy](#Cisco_Task.dita_ed6cc87b-cb1c-439b-8705-6427cb2f06be) the changes you made now, or wait and deploy multiple changes at once. * Discard Changes -If you do **not** want to push the configuration change from Security Cloud Control to the device, or you want to "undo" the configuration changes you started making on Security Cloud Control. This option overwrites the configuration stored in Security Cloud Control with the running configuration stored on the device. |

---

### Resolve the Conflict Detected Status

Security Cloud Control allows you to enable or disable conflict detection on each live device. If [Conflict Detection](#Conflict_Detection) is enabled and there was a change made to the device's configuration without using Security Cloud Control, the device's configuration status will show **Conflict Detected**.

To resolve a "Conflict Detected" status, follow this procedure:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices.   | **Note** | For an On-Premises Firewall Management Center, click Administration > Firewall Management Center and select the FMC that is in Not Synced state and continue from Step 5. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device reporting the conflict and click Review Conflict in the details pane on the right. |
| **Step 5** | In the Device Sync page, compare the two configurations by reviewing the highlighted differences.   * The panel labeled "Last Known Device Configuration" is the device configuration stored on Security Cloud Control. * The panel labeled "Found on Device" is the configuration stored in the running configuration on the ASA. |
| **Step 6** | Resolve the conflict by selecting one of the following:   * Accept Device changes: This will overwrite the configuration and any pending changes stored on Security Cloud Control with the device's running configuration.       | **Note** | As Security Cloud Control does not support deploying changes to the Cisco IOS devices outside of the command line interface, your only choice for a Cisco IOS device will be to select Accept Without Review when resolving the conflict. |   | --- | --- | * Reject Device Changes: This will overwrite the configuration stored on the device with the configuration stored on Security Cloud Control.  | **Note** | All configuration changes, rejected or accepted, are recorded in the change log. | | --- | --- | |

---

## Schedule Polling for Device Changes

If you have [Conflict Detection](#Conflict_Detection) enabled, or if you **Enable the option to auto-accept device changes** from the Settings page,Security Cloud Control polls the device for the default interval to determine if a change has been made to the device's configuration outside of
Security Cloud Control. You can customize how often Security Cloud Control polls for changes per device. These changes can be applied to more than one device.

If there is no selection configured for a device, the interval is automatically configured for "tenant default".

| **Note** | ---   Customizing the interval per device from the Security Devices page overrides the polling interval selected as the [Default Conflict Detection Interval](basics-of-cisco-defense-orchestrator.html#Default_Conflict_Detection_Interval) from the **General Settings** page.   --- |
| --- | --- |

After you enable Conflict Detection from the Security Devices page or Enable the option to auto-accept device changes from the Settings page, use the following procedure to schedule how often you want Security Cloud Control to poll your devices:

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the appropriate device type tab. |
| **Step 4** | Select the device or devices for which you want to enable conflict detection. |
| **Step 5** | In the same area as Conflict Detection, click the drop-down menu for Check every and select the desired polling interval: |

---

## Schedule a Security Database Update

This section provides information about scheduling a security database update on the device.

* [Create a Scheduled Security Database Update](#Createa_Scheduled_Security_Database_Update)
* [Edit a Scheduled Security Database Update](#Edit_a_Scheduled_Security_Database_Update)

### Create a Scheduled Security Database Update

Use the following procedure to create a scheduled task to check and update the security databases for an FDM-managed device:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select a device. |
| **Step 5** | In the Actions pane, locate the **Security Database Updates** section and click theadd + button.   | **Note** | If there is an existing scheduled task for the selected device, click the edit icon  to create a new task. Creating a new task will overwrite the existing one. | | --- | --- | |
| **Step 6** | Configure the scheduled task with the following:   * Frequency . Choose for the update to occur daily, weekly, or monthly. * Time. Choose the time of day. Note that the time displayed is UTC. * Select Days. Choose which day(s) of the week you want the update to occur. |
| **Step 7** | Click Save. |

---

The device's Configuration Status will change to "Updating Databases".

### Edit a Scheduled Security Database Update

Use the following procedure to edit an existing scheduled task to check and update the security databases for an FDM-managed device.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select a device. |
| **Step 5** | In the Actions pane, locate the **Security Database Updates** section and click the edit icon . |
| **Step 6** | Edit the scheduled task with the following:   * Frequency . Choose for the update to occur daily, weekly, or monthly. * Time. Choose the time of day. Note that the time displayed is UTC. * Select Days. Choose which day(s) of the week you want the update to occur. |
| **Step 7** | Click Save. |
| **Step 8** | The device's Configuration Status will change to "Updating Databases". |

---

## Update FDM-Managed Device Security Databases

By updating the security databases on an FDM-managed device, you are updating the following: SRUs (intrusion rules), security intelligence (SI), vulnerability databases (VDB),
and geolocation databases. If you opt into updating the security databases through the Security Cloud Control UI, note that **all**  of the mentioned databases are updated; you cannot select which databases you want to update.

Please note that security database updates cannot be reverted.

| **Note** | ---   When you update the security databases, some packets may be dropped or pass uninspected. We recommend you schedule your security database updates during a maintenance window.   --- |
| --- | --- |

### Update FDM-Managed Device Security Database While Onboarding

When you onboard an FDM-managed device to Security Cloud Control, part of the onboarding process allows you to **Enable **scheduled recurring updates for databases****. This option is checked by default. When enabled, Security Cloud Control immediately checks for and applies any security updates as well as automatically schedules the device to check for additional
updates. You are able to modify the date and time of the scheduled task after the device is onboarded.

We recommend enabling the automatic scheduler during the onboarding process to regularly check for and apply security database
updates. This way your device will always be up to date. To update the security databases while onboarding your FDM-managed device, see [Onboard an FDM-Managed Device with a Registration Key](onboard-devices-and-services.html#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key).

| **Note** | ---   If you onboard your device with the registration key method, the device must **not** be registered with a smart license. We recommend registering an license. As an alternative method, you can onboard your device using the device's [username, password, and IP address](onboard-devices-and-services.html#Onboarding_Procedure).   --- |
| --- | --- |

### Update FDM-Managed Device Security Database After Onboarding

After an FDM-managed device is onboarded to Security Cloud Control, you can configure a device to check for security database updates by scheduling an update. You can modify this scheduled
task at any time by selecting the device the update is scheduled for. See [Schedule a Security Database Update](#Cisco_Concept.dita_6d14fe36-f86d-44a9-86dc-ebc77367c11d) for more information.

* [Workflows](#Workflows)

### Workflows

#### Device licenses

Cisco Security
Cloud Control cannot update the security databases if there is no license. We recommend that your FDM-managed device has at least an license.

If you are onboarding a device that has no license, this does not inhibit Security Cloud Control from onboarding the device. Instead, the device will experience a **Connectivity** status of "insufficient licenses". To resolve this issue, you must apply the correct licenses through the FDM-managed device UI.

| **Note** | ---   If you onboard an FDM-managed device and opt in to schedule future security database updates and the device does **not** have a registered license, Security Cloud Control still creates the scheduled task but does not trigger the task until the appropriate licenses have been applied and the device is successfully synchronized.   --- |
| --- | --- |

#### Security database updates are pending in FDM

If you update the security databases through the FDM-managed device UI, and you have **conflict detection** enabled on your device, Security Cloud Control detects the pending update as a conflict.

| **Note** | ---   If you onboard your FDM-managed device and opt to schedule the updates, Security Cloud Control automatically updates the security databases as well as any other pending changes to the stored configuration during the next deploy. **does not have to be a configuration deploy**   --- |
| --- | --- |

#### Device has OOB changes, or staged changes, during a security database update

If you schedule a security database update for an FDM-managed device that has out of band (OOB) changes, or staged changes that have not been deployed, Security Cloud Control only checks and updates the security databases. Security Cloud Control does **not** deploy OOB or staged changes.

#### Device already has a scheduled task to update the security databases

Each device can only have one scheduled task. If the device already has a scheduled task to update the security databases,
creating a new one overwrites it. This applies to tasks that are created in either Security Cloud Control or an FDM-managed device.

#### No security database updates available

If there are no updates available, Security Cloud Control does not deploy anything to the device.

#### Security database updates for FDM-managed High Availability (HA) pair

Security database updates are applied only to the primary device of an HA pair.

**Related Information:**

* [Onboard an FDM-Managed Device with a Registration Key](onboard-devices-and-services.html#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device Using Username, Password, and IP Address](onboard-devices-and-services.html#Onboarding_Procedure)
* [Schedule a Security Database Update](#Cisco_Concept.dita_6d14fe36-f86d-44a9-86dc-ebc77367c11d)

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_b67f8bf9_20250115_193148.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 3.1 |
| Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Attack Vector AV: Local AV: Adjacent AV: Network AV: Physical  Select Attack Vector Parameters  Attack Complexity AC: Low AC: High  Select Attack Complexity Parameters  Privileges Required PR: None PR: Low PR: High  Select Privileges Required Parameters  User Interaction UI: Required UI: None  Select User Interaction Parameters  Scope S: Unchanged S: Changed  Select Scope Parameters  Confidentiality Impact C: Low C: High C: None  Select Confidentiality Impact Parameters  Integrity Impact I: None I: Low I: High  Select Integrity Impact Parameters  Availability Impact A: Low A: High A: None  Select Availability Impact Parameters    Base Score: 4.0 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploit Code Maturity E: Functional  E: High  E: Not Defined  E: Proof-of-Concept  E: Unproven   Select Exploit Code Maturity Parameters  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   Select Remediation Level Parameters  Report Confidence RC: Unknown  RC: Reasonable  RC: Not Defined  RC: Confirmed   Select Report Confidence Parameters     Temporal Score: 4.0 |
| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Confidentiality Requirement CR: Low  CR: Medium  CR: High  CR: Not Defined   Select Confidentiality Requirement Parameters  Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Select Integrity Requirement Parameters  Availability Requirement AR: Low  AR: Medium  AR: High  AR: Not Defined   Select Availability Requirement Parameters  Modified Attack Vector MAV: Local  MAV: Adjacent  MAV: Network  MAV: Physical  MAV: Not Defined   Select Modified Attack Vector Parameters  Modified Attack Complexity MAC: Low  MAC: High  MAC: Not Defined   Select Modified Attack Complexity Parameters  Modified Privileges Required MPR: None  MPR: Low  MPR: High  MPR: Not Defined   Select Modified Privileges Required Parameters  Modified User Interaction MUI: Required  MUI: None  MUI: Not Defined   Select Modified User Interaction Parameters  Modified Scope MS: Unchanged  MS: Changed  MS: Not Defined   Select Modified Scope Parameters  Modified Confidentiality MC: None  MC: Low  MC: High  MC: Not Defined   Select Modified Confidentiality Parameters  Modified Integrity MI: None  MI: Low  MI: High  MI: Not Defined   Select Modified Integrity Parameters  Modified Availability MA: None  MA: Low  MA: High  MA: Not Defined   Select Modified Availability Parameters    Environmental Score: 4.0 |
| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from www.cisco.com_226f8795_20250115_123402.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

# Support & Downloads

* [Worldwide - English](//www.cisco.com/c/en/us/support/index.html "Worldwide - English")
* [Arabic - عربي](//www.cisco.com/c/ar_ae/support/index.html "Arabic - عربي")
* [Brazil - Português](//www.cisco.com/c/pt_br/support/index.html "Brazil - Português")
* [Canada - Français](//www.cisco.com/c/fr_ca/support/index.html "Canada - Français")
* [China - 简体中文](//www.cisco.com/c/zh_cn/support/index.html "China - Chinese")
* [China - 繁體中文 (臺灣)](//www.cisco.com/c/zh_tw/support/index.html "Taiwan - Chinese")
* [Germany - Deutsch](//www.cisco.com/c/de_de/support/index.html "Germany - Deutsch")
* [Italy - Italiano](//www.cisco.com/c/it_it/support/index.html "Italy - Italiano")
* [Japan - 日本語](//www.cisco.com/c/ja_jp/support/index.html "Japan - Japanese")
* [Korea - 한국어](//www.cisco.com/c/ko_kr/support/index.html "Korea - Korean")
* [Latin America - Español](//www.cisco.com/c/es_mx/support/index.html "Latin America - Español")
* [Netherlands - Nederlands](//www.cisco.com/c/nl_nl/support/index.html "Netherlands - Nederlands")

Find Products and Downloads

* Helpful Links
* [Licensing Support](https://www.cisco.com/c/en/us/support/licensing/licensing-support.html)
* [Technology Support](https://www.cisco.com/c/en/us/tech/index.html)
* [Support for Cisco Acquisitions](https://www.cisco.com/c/en/us/support/web/acquisition-support.html)
* [Support Tools](https://www.cisco.com/c/en/us/support/web/tools-catalog.html)
* [Cisco Community](https://community.cisco.com/t5/technology-and-support/ct-p/technology-support)

When autocomplete results are available use up and down arrows to review and enter to select

## My Support

* View Open Cases ![Login Required](/etc/designs/cdc/fw/i/icon_lock_small.png)

  Log In
  [Create a Cisco Account](https://id.cisco.com/signin/register)

  [Benefits of a Cisco Account](//www.cisco.com/c/en/us/applicat/content/cdcrgstr/applications_overview.html)
* Software Downloads ![Login Required](/etc/designs/cdc/fw/i/icon_lock_small.png)

  Log In
  [Create a Cisco Account](https://id.cisco.com/signin/register)

  [Benefits of a Cisco Account](//www.cisco.com/c/en/us/applicat/content/cdcrgstr/applications_overview.html)

  [All Software Downloads](//software.cisco.com/download/navigator.html)
* Recently Viewed Products
* My Saved Content ![Login Required](/etc/designs/cdc/fw/i/icon_lock_small.png)
  Log In
  You can now save documents and other content for future use.
   [Log in](/c/login/index.html?referer=/c/en/us/support/index.html) to see your Saved Content.

* [![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback](https://ciscocx.qualtrics.com/jfe/form/SV_br4m3VYdhJreiii?Ref=)

## My Devices

[Log in to view or manage your My Devices inventory](https://cway.cisco.com/mydevices)

## Contact TAC by Phone

* Enterprise and Service Provider Products

  800-553-2447 US/Canada

  [Worldwide Phone Numbers](/c/en/us/support/web/tsd-cisco-worldwide-contacts.html)
* Small Business Products

  866-606-1866 US/Canada

  [Worldwide Phone Numbers](/c/en/us/support/web/tsd-cisco-small-business-support-center-contacts.html)

## Returns

* [Returns Portal](/c/en/us/support/returns/returns-portal.html)

## Products by Category

* [Switches](/c/en/us/support/switches/index.html)
* [Security](/c/en/us/support/security/index.html)
* [Routers](/c/en/us/support/routers/index.html)
* [Wireless](/c/en/us/support/wireless/index.html)

* [Unified Communications](/c/en/us/support/unified-communications/index.html)
* [Networking Software (IOS & NX-OS)](/c/en/us/support/ios-nx-os-software/index.html)
* [Collaboration Endpoints and Phones](/c/en/us/support/collaboration-endpoints/index.html)

See also: [All Products](/c/en/us/support/all-products.html) | [Technologies](/c/en/us/tech/index.html) |  [Acquisitions](/c/en/us/support/web/acquisition-support.html)

## Status Tools

* [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

  The Cisco Security portal provides actionable intelligence for security threats and vulnerabilities in Cisco products and services and third-party products.
* [Field Notices](/c/en/us/support/web/tsd-products-field-notice-summary.html)

  Get to know any significant issues, other than security vulnerability-related issues, that directly involve Cisco products and typically require an upgrade, workaround, or other customer action.

* [Cisco Cloud Status](/c/en/us/support/web/cloud-status.html)

  Check the current status of services and components for Cisco's cloud-based Webex, Security and IoT offerings.
* [Cisco Support Assistant](https://supportassistant.cisco.com/)

  The Cisco Support Assistant (formerly TAC Connect Bot) provides a self-service experience for common case inquiries and basic transactions without waiting in a queue.

## More Tools

* [Collaboration Solution Analyzer](https://cway.cisco.com/csa/)

  Suite of tools to assist you in the day to day operations of your Collaboration infrastructure.
* [Cisco CLI Analyzer](https://cway.cisco.com/cli/)

  The Cisco CLI Analyzer (formerly ASA CLI Analyzer) is a smart SSH client with internal TAC tools and knowledge integrated. It is designed to help troubleshoot and check the overall health of your Cisco supported software.

* [My Notifications](https://cway.cisco.com/mynotifications)

  My Notifications allows an user to subscribe and receive notifications for Cisco Security Advisories, End of Life Announcements, Field Notices, and Software & Bug updates for specific Cisco products and technologies.

[View All Tools](/c/en/us/support/web/tools-catalog.html)

## More Support

* [Partner Support](/c/en/us/partners/support-help.html)
* [Small Business Product Support](/c/en/us/support/smb/product-support/small-business.html)
* [Business Critical Services](/c/m/en_us/customer-experience/perform-transform/business-critical-services.html)

* [Customer Experience](/c/m/en_us/customer-experience/index.html)
* [DevNet Developer Support](https://developer.cisco.com/site/support/)
* [Cisco Trust Portal](https://trustportal.cisco.com/c/r/ctp/home.html)

## Cisco Communities

* [Cisco Community Home](https://community.cisco.com/t5/technology-and-support/ct-p/technology-support)
* [Partner Community](https://community.cisco.com/t5/for-partners/ct-p/2002j-partner-home)
* [Small Business Support Community](https://community.cisco.com/t5/small-business-support-community/ct-p/5541-small-business-support)
* [Webex Community](https://community.cisco.com/t5/webex/ct-p/product-adoption)
* [Cisco Insider User Group](https://community.cisco.com/t5/customer-connection/ct-p/ccp-home)

## Licenses

* [Traditional Licensing](https://slexui.cloudapps.cisco.com/SWIFT/LicensingUI/Quickstart)

  Generate and manage PAK-based and other device licenses, including demo licenses.
* [Smart Software Licensing](https://software.cisco.com/software/csws/ws/platform/home?locale=en_US#module/SmartLicensing)

  Track and manage Smart Software Licenses.

* [Enterprise Agreements](https://software.cisco.com/software/ea/agreements)

  Generate and manage licenses from Enterprise Agreements.
* [Licensing Support](/c/en/us/support/licensing/licensing-support.html)

  Solve common licensing issues on your own.

## Software and Downloads

* [Bug Search Tool](https://bst.cloudapps.cisco.com/bugsearch/?referring_site=shp)

  Find software bugs based on product, release and keyword.
* [Software Research](https://software.cisco.com/research/home)

  View Cisco suggestions for supported products.

* [Cisco Software Checker](https://tools.cisco.com/security/center/softwarechecker.x)

  Use the Cisco Software Checker to search for Cisco Security Advisories that apply to specific Cisco IOS, IOS XE, NX-OS and NX-OS in ACI Mode software releases.
* [Download Cisco Software](https://software.cisco.com/download/home)

  Get the latest updates, patches and releases of Cisco Software.

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_c619e4e7_20250115_123422.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Snort 3 Configuration Guide, Version 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [An Overview of Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/overview.html)
* [Migrate from Snort 2 to Snort 3](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html)
* Intrusion Detection and Prevention in Snort 3
  + [Get Started with Snort 3 Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/getting-started-intrusion.html)
  + [Tune Intrusion Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/tuning-intrusion-policies.html)
  + [Tailor Intrusion Protection for Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/tailoring-intrusion-protection.html)
* Advanced Network Analysis in Snort 3
  + [Get Started with Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/getting-started-network-analysis.html)
* Encrypted Visibility Engine for Snort 3
  + [Encrypted Visibility Engine](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/m_encrypted-visibility-engine.html)
* Elephant Flow Detection for Snort 3
  + [Elephant Flow Detection](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/m_access-elephant-flow.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Snort 3 Configuration Guide, Version 7.2 Chapter Title Migrate from Snort 2 to Snort 3

* [PDF - Complete Book
  (3.02 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72.pdf)
  [PDF - This Chapter (1.02 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: Migrate from Snort 2 to Snort 3

Chapter Contents

* [Migrate from Snort 2 to Snort 3](#ID-2247-00000004)
* [Snort 3 Inspection Engine](#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable)
* [Prerequisites for Network Analysis and Intrusion Policies](#Cisco_Reference.dita_07c3943c-4b4f-4090-adc2-9ea54c362fac)
* [How to Migrate from Snort 2 to Snort 3](#Cisco_Concept.dita_450b9d50-6826-448d-ba1e-7d1d542d2bfc)
  + [Prerequisites for Migrating from Snort 2 to Snort 3](#Cisco_Concept.dita_9af9711f-b412-450a-8c2c-4f73305775b5)
  + [Enable Snort 3 on an Individual Device](#ID-2247-00000297-enabledisable)
  + [Enable Snort 3 on Multiple Devices](#ID-2247-00000297-enablemultiple)
  + [Convert Snort 2 Custom IPS Rules to Snort 3](#Cisco_Concept.dita_1c32e696-b3a6-4a9a-b352-159bde531bbf)
    - [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3)
    - [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3)

- [View Snort 2 and Snort 3 Base Policy Mapping](#ID-2247-00000297-viewingbase)
- [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize)
- [Deploy Configuration Changes](#task_deploy_config_for_snort3)
Close

# Migrate from Snort 2 to Snort 3

Support for Snort 3 in threat
defense with management center begins in version 7.0. For new and reimaged devices, Snort 3 is the default inspection engine.

As part of threat defense upgrades to version 7.2+, you can automatically upgrade eligible devices from Snort 2 to Snort 3
when you deploy configurations. For devices that are ineligible for automatic upgrade because they use custom intrusion or
network analysis policies, you must manually upgrade to Snort 3 as described in this chapter.

* [Snort 3 Inspection Engine](#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable)
* [Prerequisites for Network Analysis and Intrusion Policies](#Cisco_Reference.dita_07c3943c-4b4f-4090-adc2-9ea54c362fac)
* [How to Migrate from Snort 2 to Snort 3](#Cisco_Concept.dita_450b9d50-6826-448d-ba1e-7d1d542d2bfc)
* [View Snort 2 and Snort 3 Base Policy Mapping](#ID-2247-00000297-viewingbase)
* [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize)
* [Deploy Configuration Changes](#task_deploy_config_for_snort3)

## Snort 3 Inspection Engine

Snort 3 is the default inspection engine for newly registered threat
defense devices of version 7.0 and later. However, for threat
defense devices of lower versions, Snort 2 is the default inspection engine. When you upgrade a managed threat
defense device to version 7.0 or later, the inspection engine remains on Snort 2. To use Snort 3 in upgraded threat
defenses of version 7.0 and later, you must explicitly enable it. When Snort 3 is enabled as the inspection engine of the device,
the Snort 3 version of the intrusion policy that is applied on the device (through the access control policies) is activated
and applied to all the traffic passing through the device.

You can switch Snort versions when required. Snort 2 and Snort 3 intrusion rules
are mapped and the mapping is system-provided. However, you may not find a
one-to-one mapping of all the intrusion rules in Snort 2 and Snort 3. If you
change the rule action for one rule in Snort 2, that change is not retained
if you switch to Snort 3 without synchronizing Snort 2 with Snort 3. For
more information on synchronization, see [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize).

## Prerequisites for Network Analysis and Intrusion Policies

To allow the Snort inspection engine to process traffic for intrusion and malware analysis, you must have the IPS license
enabled for the Threat Defense device.

You must be an Admin user to manage network analysis, intrusion policies, and perform migration tasks.

## How to Migrate from Snort 2 to Snort 3

Migrating from Snort 2 to Snort 3 requires you to switch the inspection engine of the threat
defense device from Snort 2 to Snort 3.

Depending on your requirements, the tasks to complete the migration of your device from Snort 2 to Snort 3 is listed in the
following table:

| Step | Task | Links to Procedures |
| --- | --- | --- |
| 1 | Enable Snort 3 | * [Enable Snort 3 on an Individual Device](#ID-2247-00000297-enabledisable) * [Enable Snort 3 on Multiple Devices](#ID-2247-00000297-enablemultiple) |
| 2 | Convert Snort 2 custom rules to Snort 3 | * [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3) * [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3) |
| 3 | Synchronize Snort 2 rules with Snort 3 | [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize) |

* [Prerequisites for Migrating from Snort 2 to Snort 3](#Cisco_Concept.dita_9af9711f-b412-450a-8c2c-4f73305775b5)
* [Enable Snort 3 on an Individual Device](#ID-2247-00000297-enabledisable)
* [Enable Snort 3 on Multiple Devices](#ID-2247-00000297-enablemultiple)
* [Convert Snort 2 Custom IPS Rules to Snort 3](#Cisco_Concept.dita_1c32e696-b3a6-4a9a-b352-159bde531bbf)

### Prerequisites for Migrating from Snort 2 to Snort 3

The following are the recommended prerequisites that you must consider before migrating your device from Snort 2 to Snort
3.

* Have a working knowledge of Snort. To learn about the Snort 3 architecture, see [Snort 3 Adoption](https://secure.cisco.com/secure-firewall/v7.2/docs/snort-3-adoption).
* Back up your management center. See [Backup the Management Center](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/admin/720/management-center-admin-72/tools-backup.html#Cisco_Concept.dita_d233b9dd-026b-4119-860f-2db5c9ece832).
* Back up your intrusion policy. See [Exporting Configurations](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/admin/720/management-center-admin-72/tools-import-export.html#ID-2229-0000009d).
* Clone your intrusion policy. To do this, you can use an existing policy as the base policy to create a copy of your intrusion
  policy. In the Intrusion Policies page, click Create Policy and choose an existing intrusion policy from the Base Policy dropdown list.

### Enable Snort 3 on an Individual Device

| **Important** | ---  During the deployment process, there could be a momentary traffic loss because the current inspection engine needs to be shut down.  --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Choose Devices > Device Management. |
| --- | --- |
| **Step 2** | Click the device to go to the device home page.   | **Note** | The device is marked as Snort 2 or Snort 3, showing the current version on the device. | | --- | --- | |
| **Step 3** | Click the Device tab. |
| **Step 4** | In the Inspection Engine section, click Upgrade.   | **Note** | In case you want to disable Snort 3, click Revert to Snort 2 in the Inspection Engine section. | | --- | --- | |
| **Step 5** | Click Yes. |

---

#### What to do next

Deploy the changes on the device. See, [Deploy Configuration Changes](#task_deploy_config_for_snort3).

The system converts your policy configurations during the deployment process to make
them compatible with the selected Snort version.

### Enable Snort 3 on Multiple Devices

To enable Snort 3 on multiple devices, ensure all the required threat
defense devices are on version 7.0 or later.

| **Important** | ---  During the deployment process, there could be a momentary traffic loss because the current inspection engine needs to be shut down.  --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Choose Devices > Device Management. |
| --- | --- |
| **Step 2** | Select all the devices on which you want to enable or disable Snort 3.   | **Note** | The devices are marked as Snort 2 or Snort 3, showing the current version on the device. | | --- | --- | |
| **Step 3** | Click Select Bulk Action drop-down list and choose Upgrade to Snort 3.   | **Note** | To disable Snort 3, click Downgrade to Snort 2. | | --- | --- | |
| **Step 4** | Click Yes. |

---

#### What to do next

Deploy the changes on the device. See, [Deploy Configuration Changes](#task_deploy_config_for_snort3).

The system converts your policy configurations during the deployment process to make
them compatible with the selected Snort version.

### Convert Snort 2 Custom IPS Rules to Snort 3

If you are using a rule set from a third-party vendor, contact that vendor to confirm that their rules successfully convert
to Snort 3 or to obtain a replacement rule set written natively for Snort 3. If you have custom rules that you have written
yourself, familiarize with writing Snort 3 rules prior to conversion, so you can update your rules to optimize Snort 3 detection
after conversion. See the links below to learn more about writing rules in Snort 3.

* <https://blog.snort.org/2020/08/how-rules-are-improving-in-snort-3.html>
* <https://blog.snort.org/2020/10/talos-transition-to-snort-3.html>

You can refer to other blogs at <https://blog.snort.org/> to learn more about Snort 3 rules.

See the following procedures to convert Snort 2 rules to Snort 3 rules using the system-provided tool.

* [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3)
* [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3)

| **Important** | ---   Snort 2 network analysis policy (NAP) settings *cannot* be copied to Snort 3 automatically. NAP settings have to be manually replicated in Snort 3.   --- |
| --- | --- |

* [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3)
* [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3)

#### Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3

##### Procedure

---

| **Step 1** | Choose Objects > Intrusion Rules . |
| --- | --- |
| **Step 2** | Click Snort 3 All Rules tab. |
| **Step 3** | Ensure All Rules is selected in the left pane. |
| **Step 4** | Click the Tasks drop-down list and choose:   * Convert Snort 2 rules and import—To automatically convert all the Snort 2 custom rules across all the intrusion policies to Snort 3 and import them into management center as Snort 3 custom rules. * Convert Snort 2 rules and download—To automatically convert all the Snort 2 custom rules across all the intrusion policies to Snort 3 and download them into   your local system. |
| **Step 5** | Click OK.   | **Note** | * If you selected Convert and import in the previous step, then all the converted rules are saved under a newly created rule group All Snort 2 Converted Global under Local Rules. * If you selected Convert and download in the previous step, then save the rules file locally. You can review the converted rules in the downloaded file and later   upload them by following the steps in [Add Custom Rules to Rule Groups](tuning-intrusion-policies.html#Cisco_Task.dita_a2d14eea-7bb4-45e6-a81a-14633b898b30). | | --- | --- |   Refer to the video [Converting Snort 2 Rules to Snort 3](https://www.youtube.com/watch?v=7vNNYG5_k3Q) for additional support and information. |

---

##### What to do next

Deploy configuration changes; see [Deploy Configuration Changes](#task_deploy_config_for_snort3).

#### Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3

##### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | In the Intrusion Policies tab, click Show Snort 3 Sync status. |
| **Step 3** | Click the Sync icon snort versions out-of-sync of the intrusion policy.   | **Note** | If the Snort 2 and the Snort 3 versions of the intrusion policy are synchronized, then the Sync icon is in green . It indicates that there are no custom rules to be converted. | | --- | --- | |
| **Step 4** | Read through the summary and click the Custom Rules tab. |
| **Step 5** | Choose:   * Import converted rules to this policy—To convert the Snort 2 custom rules in the intrusion policy to Snort 3 and import them into management center as Snort 3 custom rules. * Download converted rules—To convert the Snort 2 custom rules in the intrusion policy to Snort 3 and download them into your local system. You can   review the converted rules in the downloaded file and later upload the file by clicking the upload icon. |
| **Step 6** | Click Re-Sync. |

---

##### What to do next

Deploy configuration changes; see [Deploy Configuration Changes](#task_deploy_config_for_snort3).

## View Snort 2 and Snort 3 Base Policy Mapping

### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Ensure the Intrusion Policies tab is selected. |
| **Step 3** | Click IPS Mapping. |
| **Step 4** | In the IPS Policy Mapping dialog box, click View Mappings to view the Snort 3 to Snort 2 intrusion policy mapping. |
| **Step 5** | Click OK. |

---

## Synchronize Snort 2 Rules with Snort 3

To ensure that the Snort 2 version settings and custom rules are retained and carried over to Snort 3, the management center provides the synchronization functionality. Synchronization helps Snort 2 rule override settings and custom rules, which
you may have altered and added over the last few months or years, to be replicated on the Snort 3 version. This utility helps
to synchronize Snort 2 version policy configuration with Snort 3 version to start with similar coverage.

If the management center is upgraded from 6.7 or earlier to 7.0 or later version, the system synchronizes the configuration. If the management center is a fresh 7.0 or later version, you can upgrade to a higher version, and the system will not synchronize any content during
upgrade.

Before upgrading a device to Snort 3, if changes are made in Snort 2 version, you can use this utility to have the latest
synchronization from Snort 2 version to Snort 3 version so that you start with a similar coverage.

| **Note** | ---   On moving to Snort 3, it is recommended that you manage the Snort 3 version of the policy independently and do not use this utility as a regular operation.   --- |
| --- | --- |

| **Important** | ---  * Only the Snort 2 rule overrides and custom rules are copied to Snort 3   and not the other way around. You may not find a one-to-one mapping of   all the intrusion rules in Snort 2 and Snort 3.Your changes to rule   actions for rules that exist in both versions are synchronized when you   perform the following procedure. * Synchronization *does not* migrate the threshold and suppression settings of any custom or system-provided rules from Snort 2 to Snort 3.  --- |
| --- | --- |

### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Ensure the Intrusion Policies tab is selected. |
| **Step 3** | Click **Show Snort 3 Sync status**. |
| **Step 4** | Identify the intrusion policy that is out-of-sync. |
| **Step 5** | Click the Sync icon snort versions out-of-sync.   | **Note** | If the Snort 2 and the Snort 3 versions of the intrusion policy are synchronized, then the Sync icon is in green  . | | --- | --- | |
| **Step 6** | Read through the summary and download a copy of the summary if required. |
| **Step 7** | Click Re-Sync.   | **Note** | * The synchronized settings will be applicable on the Snort 3   intrusion engine only if it is applied on a device, and after a   successful deployment. * Snort 2 custom rules can be converted to Snort 3 using the   system-provided tool. If you have any Snort 2 custom rules click   the Custom Rules tab and follow the on-screen instructions to   convert the rules. For more information, see [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3). | | --- | --- | |

---

### What to do next

Deploy configuration changes; see [Deploy Configuration Changes](#task_deploy_config_for_snort3).

## Deploy Configuration Changes

After you change configurations, deploy them to the affected devices.

| **Note** | ---   This topic covers the basic steps involved in deploying configuration changes. We *strongly* recommend that you refer the Deploy Configuration Changes topic in the latest version of the Cisco Secure Firewall Management Center Configuration Guide to understand the prerequisites and implications of deploying the changes before proceeding with the steps.   --- |
| --- | --- |

| **Caution** | ---  When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic.  --- |
| --- | --- |

### Procedure

---

| **Step 1** | On the Secure Firewall Management Center menu bar, click Deploy and choose Deployment.  The GUI page lists the devices with out-of-date configurations having Pendingstatus.   * The Modified By column lists the users who have modified the policies or objects. Expand the device listing to view the users who have modified   the policies for each policy listing.       | **Note** | Usernames are not provided for deleted policies and objects. |   | --- | --- | * The Inspect Interruption column indicates if traffic inspection interruption might occur in the device during deployment.  If this column is blank for a device, it indicates that there will be no traffic inspection interruptions on that device during   deployment. * The Last Modified Time column specifies the last time you made configuration changes. * The Preview column allows you to preview the changes for the next deployment. * The Status column provides the status for each deployment. |
| --- | --- | --- | --- |
| **Step 2** | Identify and choose the devices on which you want to deploy configuration changes.   * Search—Search for the device name, type, domain, group, or status in the search box. * Expand—Click Expand Arrow   (expand arrow icon) to view device-specific configuration changes to be deployed. When you check a check box adjacent to a device, all the changes made to the device and listed under the device, are pushed   for deployment. However, you can use Policy selection    (policy selection icon) to select individual policies or specific configurations to deploy while withholding the remaining changes without deploying   them.       | **Note** | + When the status in the Inspect Interruption column indicates (Yes) that deploying will interrupt inspection, and perhaps traffic, on a threat   defense device, the expanded list indicates the specific configurations causing the interruption with the Inspect   Interruption (inspect interruption icon). + When there are changes to interface groups, security zones, or objects, the impacted devices are shown as out-of-date on the   management center. To ensure that these changes take effect, the policies with these interface groups, security zones, or objects, also need   to be deployed along with these changes. The impacted policies are shown as out-of-date on the Previewpage on the management center. |   | --- | --- | |
| **Step 3** | Click Deploy. |
| **Step 4** | If the system identifies errors or warnings in the changes to be deployed, it displays them in the Validation Messages  window. To view complete details, click the arrow icon before the warnings or errors.  You have the following choices:   * Deploy—Continue deploying without resolving warning conditions. You cannot proceed if the system identifies errors. * Close—Exit without deploying. Resolve the error and warning conditions, and attempt to deploy the configuration again. |

---

### What to do next

During deployment, if there is a deployment failure, there is a possibility that the failure may impact traffic. However,
it depends on certain conditions. If there are specific configuration changes in the deployment, the deployment failure may
lead to traffic being interrupted. For details, see the Deploy Configuration Changes topic in the latest version of the Cisco Secure Firewall Management Center Configuration Guide.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from docs.defenseorchestrator.com_a9036ec6_20250115_123403.html ===


* [Basics of Security Cloud Control](g-basics-of-cisco-defense-orchestrator.html)
* [Cisco AI Assistant User Guide](g_firewall-policy-assistant.html)
* [Onboard Secure Firewall Threat Defense Devices](g-chapterwrapper-for-olh-onboarding-ftd-devices.html)
* [Onboard ASA Devices](g-chapter-wrapper-for-olh-onboard-asa-devices.html)
* [Onboard an On-Premises Firewall Management Center](g-chapter-wrapper-for-olh-onboard-an-fmc.html)
* [Migrate On-Premises Management Center Managed Secure Firewall Threat Defense to Cloud-delivered Firewall Management Center](g-change-firewall-threat-defense-device-management-from-secure-firewall-management-center-to-cdo.html)
* [Onboard an Umbrella Organization](g-olh-onboard-an-umbrella-organization.html)
* [Onboard Security Cloud Control Integrations](g-chapterwrapper-for-olh-onboard-cisco-defense-orchestrator-integrations.html)
* [Onboard Meraki MX Devices](g-chapterwrapper-for-olh-onboard-meraki-mx-devices.html)
* [Onboard AWS Devices](g-chapterwrapper-for-olh-onboard-aws-devices.html)
* [Upgrade Devices and Services](c-upgrade-devices-and-services.html)
* [Managing On-Premises Firewall Management Center with Cisco Security Cloud Control](g-firepower-management-center-and-cdo.html)
* [Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management Center](g-about-the-cloud-delivered-firewall-management-center-in-cdo.html)
* [Managing FDM Devices with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-ftd-with-cisco-defense-orchestrator.html)
* [Managing ASA with Cisco Security Cloud Control](g-about-managing-asa-with-cisco-defense-orchestrator.html)
* [Migrating Firewalls with the Firewall Migration Tool in Security Cloud Control](g-chapterwrapper-for-olh-migrating-firewalls-with-the-cloud-firewall-migration-tool.html)
* [Managing Umbrella with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-umbrella-with-cisco-defense-orchestrator.html)
* [Managing Meraki with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-meraki-with-cisco-defense-orchestrator.html)
* [Managing IOS Devices with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-ios-devices-with-cisco-defense-orchestrator.html)
* [Managing AWS with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-aws-with-cisco-defense-orchestrator.html)
* [Managing SSH Devices with Cisco Security Cloud Control](g-about-managing-ssh-devices-with-cisco-defense-orchestrator.html)
* [Integrating Security Cloud Control with Cisco Security Cloud Sign On](g-integrating-cdo-with-securex.html)
* [Analyzing, Detecting, and Fixing Policy Anomalies Using Policy Analyzer and Optimizer](g-analyzing-detecting-and-fixing-policy-anomalies-using-policy-analyzer-and-optimizer.html)
* [Virtual Private Network Management](g-chapterwrapper-for-olh-virtual-private-network-management.html)
* [Cisco Security Analytics and Logging](g-cisco-security-analytics-and-logging.html)
* [FTD Dashboard](g-analytics-dashboard.html)
* [Cisco Secure Dynamic Attributes Connector](g_cisco-secure-dynamic-attributes-connector.html)
* [Troubleshooting](g-troubleshooting.html)
* [FAQ and Support](g-faq-and-support.html)
* [Security and Internet Access](g_security-internet-access-and-communication-ports.html)
* [Open Source and 3rd Party License Attribution](g-appwrapper-open-source-and-3rd-party-license-attribution.html)
* [Terraform](g-cdo-terraform.html)
Managing Security and Network Devices with Cisco Security Cloud Control Copyright Â© 2025, Cisco Systems, Inc. All rights reserved.

=== Content from sec.cloudapps.cisco.com_9526ab76_20250115_193151.html ===


PSIRT

# Cisco Security

## Cisco Security

| | The Page You Have Requested Is Not Available The Cisco Security that you are trying to access may have been relocated or removed.  If you typed the address, please verify that your entry was correct. Report a Broken Link Please use this form to report broken links on Cisco.com.  <<  Go Back to Previous Page |   Related LinksSolutions  * [Security Solutions](http://www.cisco.com/en/US/products/hw/vpndevc/solutions.html) * [E-mail Security](http://www.cisco.com/en/US/products/ps10154/index.html) * [Threat Control for Endpoints](http://www.cisco.com/en/US/netsol/ns681/index.html) * [Threat Control for Infrastructure](http://www.cisco.com/en/US/netsol/ns680/index.html)  Products & Services  * [Security Services](http://www.cisco.com/en/US/products/svcs/ps2961/ps2952/serv_group_home.html) * [Security Products](http://www.cisco.com/en/US/products/hw/vpndevc/index.html) * [Cisco IntelliShield Alert Manager](http://www.cisco.com/en/US/products/ps6834/serv_group_home.html)  About Cisco  * [Cisco Global Government Affairs](http://www.cisco.com/web/about/gov/index.html) * [High Tech Policy Blog](http://blogs.cisco.com/gov/) * [High Tech Policy Guide](http://www.cisco.com/web/about/gov/policy_guide.html) | | --- | --- | |
| --- | --- | --- |



=== Content from www.cisco.com_bd0a91a3_20250115_123429.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Configuration Guides](/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting
  Started](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-get-started.html)
* [Best Practices: Use Cases for Threat Defense](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-use-cases.html)
* [Licensing the
  System](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-license.html)
* System Monitoring
  + [Monitoring the
    Device](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-monitor.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-isa3000-alarms.html)
* Reusable Objects
  + [Objects](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-objects.html)
  + [Certificates](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-certificates.html)
  + [Identity Sources](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity-sources.html)
* The Basics
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-logical-devices.html)
  + [High Availability
    (Failover)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ha.html)
  + [Interfaces](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-interfaces.html)
* Routing
  + [Routing Basics and Static Routes](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-routing.html)
  + [Virtual Routers](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-virtual-routers.html)
  + [Route Maps and Other Objects for Route Tuning](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-route-maps.html)
  + [Open Shortest Path First (OSPF)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ospf.html)
  + [Enhanced Interior Gateway Routing Protocol (EIGRP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-eigrp.html)
  + [Border Gateway Protocol (BGP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-bgp.html)
* Security
  Policies
  + [SSL
    Decryption](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html)
  + [Identity
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity.html)
  + [Security
    Intelligence](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-sec-intel.html)
  + [Access
    Control](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-access.html)
  + [Intrusion
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html)
  + [Network Address
    Translation (NAT)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-nat.html)
* Virtual Private
  Networks (VPN)
  + [Site-to-Site
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-s2svpn.html)
  + [Remote Access
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ravpn.html)
* System
  Administration
  + [System
    Settings](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-system.html)
  + [System
    Management](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-mgmt.html)
* [Advanced
  Configuration](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-advanced.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3 Chapter Title Intrusion Policies

* [PDF - Complete Book
  (18.14 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.pdf)
  [PDF - This Chapter (1.31 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (10.41 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (22.06 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 14, 2023

## Chapter: Intrusion Policies

Chapter Contents

* [Intrusion Policies](#topic_1DD700B34ECA40579EC767CC06DBB783)
* [About Intrusion and Network Analysis Policies](#concept_D206F4ED94D94725B2524A2F09C1382D)
  + [System-Defined Network Analysis and Intrusion Policies](#concept_D681E8E136034A9AA863E8389C2A6C03)
  + [Inspection Mode: Prevention vs. Detection](#Cisco_Concept.dita_96f59526-cc5d-4aed-b712-13326d878c5c)
  + [Intrusion and Preprocessor Rules](#concept_07261DA975EA4A91B2BC15C81C19CB62)
    - [Intrusion Rule Attributes](#concept_C4C21B1BDF794F468738C9F836C6C87B)
    - [Default Intrusion Variable Set](#concept_AF54E757E6694EE4B08030A4EA1D737C)
    - [Generator Identifiers](#concept_821B9C87DA8744CB8E3C2375A1DB3C9B)
  + [Network Analysis Policies](#concept_B4CF7ED4D7084213B5D6B176E54FE6A2)
* [License Requirements for Intrusion Policies](#concept_35C1B310E74C40AE808B4DE432B1212F)
* [Applying Intrusion Policies in Access Control Rules](#task_B70596D90ED04906A3D378FC7A943EDB)
* [Switching Between Snort 2 and Snort 3](#id_120089)
* [Configuring Syslog for Intrusion Events](#task_3C0D47785EF24FCB88E6E671705E10E8)
* [Configuring the Network Analysis Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_49189b70-682c-4336-9620-fe104df820f6)
  + [Configuring Inspector and Binder Overrides](#Cisco_Task_in_List_GUI.dita_e6960060-5b51-419d-ac09-fb55545850b3)
  + [Downloading Overrides and the Schema](#Cisco_Task_in_List_GUI.dita_6d5ef939-3834-4b06-acdf-dff2d647758c)
  + [Uploading Overrides](#Cisco_Task_in_List_GUI.dita_e447172f-a47e-4032-8776-549b10eb8c6a)
* [Managing Intrusion Policies (Snort 3)](#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055)
  + [Configuring a Custom Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_577e0181-dbc9-492b-90b8-a4b59bd381f0)
  + [Viewing or Editing Intrusion Policy Properties (Snort 3)](#Cisco_Task_in_List_GUI.dita_6faed926-3676-491a-9639-25912f85d7b3)
  + [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a)
  + [Changing Intrusion Rule Actions (Snort 3)](#Cisco_Task_in_List_GUI.dita_54aef253-02ab-4044-88ea-cea05249686d)
  + [Managing Custom Intrusion Rules and Rule Groups](#Cisco_Task_in_List_GUI.dita_1704f9a7-4642-48db-a5db-1938d5494c4b)
    - [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864)
    - [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e)

- [Managing Intrusion Policies (Snort 2)](#concept_C0EB1AB846C945C38FE3940BBC8803F7)
  * [Configure the Inspection Mode for an Intrusion Policy (Snort 2)](#id_121662)
  * [Changing Intrusion Rule Actions (Snort 2)](#task_4D5DD40DDCE0426C8846E5684287E63B)
- [Monitoring Intrusion Policies](#concept_5A4F2289E52D4E9C8F35A38FE9137C9B)
- [Examples for Intrusion Policies](#concept_34AA9F063DBA418BA3FF055364B3C49D)
Close

# Intrusion Policies

The following topics explain intrusion policies and the closely
associated network analysis policies (NAP). Intrusion policies include rules
that check traffic for threats and block traffic that appears to be an attack.
Network analysis policies control traffic preprocessing, which prepares traffic
to be further inspected by normalizing traffic and identifying protocol
anomalies.

Because preprocessing and intrusion inspection are so closely related,
the network analysis and intrusion policies examining a single packet must
complement each other.

* [About Intrusion and Network Analysis Policies](#concept_D206F4ED94D94725B2524A2F09C1382D)
* [License Requirements for Intrusion Policies](#concept_35C1B310E74C40AE808B4DE432B1212F)
* [Applying Intrusion Policies in Access Control Rules](#task_B70596D90ED04906A3D378FC7A943EDB)
* [Switching Between Snort 2 and Snort 3](#id_120089)
* [Configuring Syslog for Intrusion Events](#task_3C0D47785EF24FCB88E6E671705E10E8)
* [Configuring the Network Analysis Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_49189b70-682c-4336-9620-fe104df820f6)
* [Managing Intrusion Policies (Snort 3)](#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055)
* [Managing Intrusion Policies (Snort 2)](#concept_C0EB1AB846C945C38FE3940BBC8803F7)
* [Monitoring Intrusion Policies](#concept_5A4F2289E52D4E9C8F35A38FE9137C9B)
* [Examples for Intrusion Policies](#concept_34AA9F063DBA418BA3FF055364B3C49D)

## About Intrusion and Network Analysis Policies

Network analysis and intrusion policies work together to detect and
prevent intrusion threats.

* A network analysis policy (NAP) governs how traffic is decoded and
  preprocessed so that it can be further evaluated, especially for anomalous
  traffic that might signal an intrusion attempt.
* An intrusion policy uses intrusion and preprocessor rules, which are
  collectively known as intrusion rules, to examine the decoded packets for
  attacks based on patterns. The rules can either prevent (drop) the threatening
  traffic and generate an event, or simply detect (alert) it and generate an
  event only.

As the system analyzes traffic, the network analysis decoding and
preprocessing phase occurs before and separately from the intrusion prevention
phase. Together, network analysis and intrusion policies provide broad and deep
packet inspection. They can help you detect, alert on, and protect against
network traffic that could threaten the availability, integrity, and
confidentiality of hosts and their data.

* [System-Defined Network Analysis and Intrusion Policies](#concept_D681E8E136034A9AA863E8389C2A6C03)
* [Inspection Mode: Prevention vs. Detection](#Cisco_Concept.dita_96f59526-cc5d-4aed-b712-13326d878c5c)
* [Intrusion and Preprocessor Rules](#concept_07261DA975EA4A91B2BC15C81C19CB62)
* [Network Analysis Policies](#concept_B4CF7ED4D7084213B5D6B176E54FE6A2)

### System-Defined Network Analysis and Intrusion Policies

The system includes several pairs of same-named network analysis and intrusion policies that complement and work with each
other. For example there are both NAP and intrusion policies named “Balanced Security and Connectivity,” which are meant to
be used together. The system-provided policies are configured by the Cisco Talos Intelligence Group
(Talos). For these policies, Talos sets the intrusion and preprocessor rule states and provides the initial configurations for preprocessors and other advanced
settings.

As new vulnerabilities become known, Talos releases intrusion rule updates. These rule updates can modify any system-provided network analysis or intrusion policy,
and can provide new and updated intrusion rules and preprocessor rules, modified states for existing rules, and modified default
policy settings. Rule updates might also delete rules from system-provided policies and provide new rule categories, as well
as modify the default variable set.

You can manually update the rules database, or configure a regular
update schedule. You must deploy an update for it to take effect. For more
information on updating system databases, see
[Updating System Databases](fptd-fdm-mgmt.html#id_11511).

The following are the system-provided policies:

Balanced Security and Connectivity network analysis and intrusion
policies

These policies are built for both speed and detection. Used
together, they serve as a good starting point for most networks and deployment
types. The system uses the Balanced Security and Connectivity network analysis
policy as the default.

Connectivity Over Security network analysis and intrusion policies

These policies are built for networks where connectivity, the
ability to get to all resources, takes precedence over network infrastructure
security. The intrusion policy enables far fewer rules than those enabled in
the Security over Connectivity policy. Only the most critical rules that block
traffic are enabled.

Security Over Connectivity network analysis and intrusion policies

These policies are built for networks where network infrastructure
security takes precedence over user convenience. The intrusion policy enables
numerous network anomaly intrusion rules that could alert on or drop legitimate
traffic.

Maximum Detection network analysis and intrusion policies

These policies are built for networks where network infrastructure
security is given even more emphasis than is given by the Security Over
Connectivity policies, with the potential for even greater operational impact.
For example, the intrusion policy enables rules in a large number of threat
categories including malware, exploit kit, old and common vulnerabilities, and
known in-the-wild exploits.

### Inspection Mode: Prevention vs. Detection

By default, all intrusion policies operate in Prevention mode to implement an Intrusion
Prevention System (IPS). In the Prevention inspection mode, if a connection matches an
intrusion rule whose action is to drop traffic, the connection is actively blocked.

If you instead want to test the effect of the intrusion policy on your network, you can
change the mode to Detection, which implements an Intrusion Detection System (IDS). In
this inspection mode, drop rules are treated like alert rules, where you are notified of
matching connections, but the action result becomes Would Have Blocked, and connections
are never in fact blocked.

You change the inspection mode per intrusion policy, so you can have a mix of prevention
and detection.

The Snort 3 network analysis policy (NAP) also has an
inspection mode. Unlike the intrusion policy, the NAP policy is global, so you must run
all NAP processing in either Prevention or Detection mode. You should use the same mode
you use for your intrusion policies. If you have a mix of Prevention and Detection
policies, select Prevention to match your most restrictive intrusion policies.

### Intrusion and Preprocessor Rules

An intrusion rule is a specified set of keywords and arguments that the
system uses to detect attempts to exploit vulnerabilities in your network. As
the system analyzes network traffic, it compares packets against the conditions
specified in each rule, and triggers the rule if the data packet meets all the
conditions specified in the rule.

The system includes the following types of rules created by Cisco Talos Intelligence Group
(Talos):

* Intrusion rules, which are subdivided into shared object rules and
  standard text rules
* Preprocessor rules, which are rules associated with preprocessors
  and packet decoder detection options in the network analysis policy. Most
  preprocessor rules are disabled by default.

The following topics explain intrusion rules in more depth.

* [Intrusion Rule Attributes](#concept_C4C21B1BDF794F468738C9F836C6C87B)
* [Default Intrusion Variable Set](#concept_AF54E757E6694EE4B08030A4EA1D737C)
* [Generator Identifiers](#concept_821B9C87DA8744CB8E3C2375A1DB3C9B)

#### Intrusion Rule Attributes

When you view an intrusion policy, you see a list of all the intrusion rules available for
identifying threats.

The list of rules for each policy is the same. The difference is in the action configured for each rule. Because there are
over 30,000 rules, scrolling through the list will take time. Rules are revealed as you scroll through the list.

Following are the
attributes that define each rule:

> (Signature
Description)

Click the > button in the left column to open the signature description. The description is the actual code used by the Snort inspection
engine to match traffic against the rule. Explaining the code is out of scope for this document, but it is explained in detail
in Management Center Configuration Guide; select the book for your software version from <http://www.cisco.com/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html>. Look for information on intrusion rule editing.

The signatures
contain variables for certain items. For more information, see
[Default Intrusion Variable Set](#concept_AF54E757E6694EE4B08030A4EA1D737C).

GID

Generator Identifier (ID). This number indicates which system component evaluates the rule
and generates events. A 1 indicates a standard text intrusion rule, a 3
indicates a shared object intrusion rule. (The difference in these rule
types is not meaningful for a device
manager user.) These are the main rules of interest when configuring an intrusion
policy. For information on the other GIDs, see [Generator Identifiers](#concept_821B9C87DA8744CB8E3C2375A1DB3C9B).

SID

Snort Identifier (ID), also called signature ID. Snort IDs lower than 1000000 were created by the Cisco Talos Intelligence Group
(Talos).

Action

The state of
this rule in the selected intrusion policy. For each rule, “(Default)” is added
to the action that is the default action for the rule within this policy. To
return a rule to its default setting, you select this action. Possible actions
are:

* Alert—Create an
  event when this rule matches traffic, but do not drop the connection.
* Drop—Create an
  event when this rule matches traffic, and also drop the connection.
* Disabled—Do not
  match traffic against this rule. No events are generated.

Status

For Snort 2 rules, Status is a separate column. If you change the default
action for a rule, this column shows “Overridden.” Otherwise, the column is
empty.

For Snort 3 rules, the “Overridden” status is shown at the bottom of the
Action attribute, if you changed it.

Message

This is the name
of the rule, which also appears in events triggered by the rule. The message
typically identifies the threat that the signature matches. You can search the
Internet for more information on each threat.

#### Default Intrusion Variable Set

The intrusion rule
signatures contain variables for certain items. Following are the default
values for the variables, with $HOME\_NET and $EXTERNAL\_NET being the most
commonly used variables. Note that the protocol is specified separately from
port numbers, so port variables are numbers only.

* $DNS\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $EXTERNAL\_NET =
  any IP address.
* $FILE\_DATA\_PORTS =
  $HTTP\_PORTS, 143, 110.
* $FTP\_PORTS = 21,
  2100, 3535.
* $GTP\_PORTS = 3386,
  2123, 2152.
* $HOME\_NET = any IP
  address.
* $HTTP\_PORTS = 144
  ports numbered: 36, 80-90, 311, 383, 443, 555, 591, 593, 631, 666, 801, 808,
  818, 901, 972, 1158, 1212, 1220, 1414, 1422, 1533, 1741, 1830, 1942, 2231,
  2301, 2381, 2578, 2809, 2980, 3029, 3037, 3057, 3128, 3443, 3507, 3702, 4000,
  4343, 4848, 5000, 5117, 5222, 5250, 5450, 5600, 5814, 6080, 6173, 6767, 6988,
  7000, 7001, 7005, 7071, 7080, 7144, 7145, 7510, 7770, 7777-7779, 8000, 8001,
  8008, 8014, 8015, 8020, 8028, 8040, 8060, 8080-8082, 8085, 8088, 8118, 8123,
  8161, 8180-8182, 8222, 8243, 8280, 8300, 8333, 8344, 8400, 8443, 8500, 8509,
  8787, 8800, 8888, 8899, 8983, 9000, 9002, 9060, 9080, 9090, 9091, 9111, 9290,
  9443, 9447, 9710, 9788, 9999, 10000, 11371, 12601, 13014, 15489, 19980, 23472,
  29991, 33300, 34412, 34443, 34444, 40007, 41080, 44449, 50000, 50002, 51423,
  53331, 55252, 55555, 56712.
* $HTTP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $ORACLE\_PORTS =
  any
* $SHELLCODE\_PORTS =
  180.
* $SIP\_PORTS = 5060,
  5061, 5600
* $SIP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SMTP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SNMP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SQL\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SSH\_PORTS = 22.
* $SSH\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $TELNET\_SERVERS =
  $HOME\_NET (meaning any IP address).

#### Generator Identifiers

The generator identifier (GID) identifies the subsystem that
evaluates an intrusion rule and generates events. Standard text intrusion rules
have a generator ID of 1, and shared
object intrusion rules have a generator ID of 3. There are also several sets of
rules for various preprocessors. The following table explains the GIDs.

Table 1. Generator IDs

| ID | Component |
| --- | --- |
| 1 | Standard Text Rule. |
| 2 | Tagged Packets.  (Rules for the Tag generator, which generates packets from a tagged session. ) |
| 3 | Shared Object Rule. |
| 102 | HTTP Decoder. |
| 105 | Back Orifice Detector. |
| 106 | RPC Decoder. |
| 116 | Packet Decoder. |
| 119, 120 | HTTP Inspect Preprocessor.  (GID 120 rules relate to server-specific HTTP traffic.) |
| 122 | Portscan Detector. |
| 123 | IP Defragmentor. |
| 124 | SMTP Decoder.  (Exploits against SMTP verbs.) |
| 125 | FTP Decoder. |
| 126 | Telnet Decoder. |
| 128 | SSH Preprocessor. |
| 129 | Stream Preprocessor. |
| 131 | DNS Preprocessor. |
| 133 | DCE/RPC Preprocessor. |
| 134 | Rule Latency, Packet Latency.  (Events for these rules are generated when rule latency suspends (SID 1) or re-enables (SID 2) a group of intrusion rules, or when the system stops inspecting a packet because the packet latency threshold is exceeded (SID 3).) |
| 135 | Rate-Based Attack Detector.  (Excessive connections to hosts on the network.) |
| 137 | SSL Preprocessor. |
| 138, 139 | Sensitive Data Preprocessor. |
| 140 | SIP Preprocessor. |
| 141 | IMAP Preprocessor. |
| 142 | POP Preprocessor. |
| 143 | GTP Preprocessor. |
| 144 | Modbus Preprocessor. |
| 145 | DNP3 Preprocessor. |

### Network Analysis Policies

Network analysis policies control traffic preprocessing. Preprocessors prepare traffic to be
further inspected by normalizing traffic and identifying protocol anomalies. Network
analysis-related preprocessing occurs after Security Intelligence drops and SSL
decryption, but before access control and intrusion or file inspection.

By default, the system uses the Balanced Security and Connectivity network analysis
policy to preprocess all traffic handled by the access control policy. However, if
you configure an intrusion policy on any access control rule, the system uses the
network analysis policy that matches the most aggressive intrusion policy applied.
For example, if you use both Security over Connectivity and Balanced policies in
your access control rules, the system uses the Security over Connectivity NAP for
all traffic. For Snort 3 custom intrusion
policies, this assignment is done according to the base template policy assigned
to the intrusion policy.

When using Snort 3, you can select a policy explicitly and optionally customize its
settings. We recommend that you select the policy whose name matches the intrusion
policy that you use for most traffic that goes through the device, whether you use
the intrusion policy directly, or you use it as the base policy in your custom
intrusion policies. You can then change the inspection mode, or adjust specific
inspector or binder settings to account for the traffic on your network.

In addition, consider whether you have enabled preprocessor rules in the intrusion
policy. If you enable rules that require a preprocessor, ensure that you also enable
the corresponding inspector in the NAP. For each inspector, you can also adjust the
attributes for the inspector, including the ports examined (the binders), to
customize inspector behavior for your network.

| **Note** | ---   If you are using Snort 2, the system uses the same-named NAP policy as the most restrictive intrusion policy you apply in any access control rule, and you cannot edit inspector or binder settings.   --- |
| --- | --- |

## License Requirements for Intrusion Policies

You must enable the **IPS** license to apply intrusion policies in access control rules. For information on configuring licenses, see [Enabling or Disabling Optional Licenses](fptd-fdm-license.html#id_12247).

No extra license is needed for network analysis policies.

## Applying Intrusion Policies in Access Control Rules

To apply intrusion
policies to network traffic, you select the policy within an access control
rule that allows traffic. You do not directly assign intrusion policies.

You can assign
different intrusion policies to provide variable intrusion protection based on
the relative risks of the networks you are protecting. For example, you might
use the more stringent Security over Connectivity policy for traffic between
your inside network and external networks. On the other hand, you might apply
the more lenient Connectivity over Security policy for traffic between inside
networks.

You can also
simplify your configuration by using the same policy for all networks. For
example, the Balanced Security and Connectivity policy is design to provide
good protection without excessively impacting connectivity.

### Procedure

---

| **Step 1** | Select Policies > Access Control. |
| --- | --- |
| **Step 2** | Either create a new rule, or edit an existing rule, that allows traffic.  If the default action is allow, you can also specify an intrusion policy in the default action.  You cannot apply intrusion policies to rules that trust or block traffic. |
| **Step 3** | Click the Intrusion Policy tab. |
| **Step 4** | Select Intrusion Policy > On and select the intrusion inspection policy to use on matching traffic. |

---

## Switching Between Snort 2 and Snort 3

Snort is the main inspection engine for the product. Although you can switch Snort
versions freely, some intrusion rules in Snort 2.0 might not exist in Snort 3.0, and
vice versa. If you changed the rule action for one of these rules, that change is
not preserved if you switch to Snort 3 and then back to Snort 2, or back again to
Snort 3. Your changes to rule actions for rules that exist in both versions are
preserved. Note that the mapping between rules in Snort 3 vs. Snort 2 can be
one-to-one or one-to-many, so preservation of changes is done on a best effort
basis.

If you change the Snort version, the system will perform an automatic deployment to implement the change. You can see the
progress in the Task list. The tasks are Snort Version Change and Automatic Deployment—Snort version toggle. Because of the
deployment and the fact that Snort must be stopped and restarted, all existing connections, including VPN, are dropped and
must be reestablished, which will cause a momentary traffic loss.

| **Note** | ---   If you try to switch Snort versions and the switch fails, you will have pending changes that you cannot discard, and a subsequent toggle attempt will not be allowed. If this happens, you must complete the switch using the ToggleInspectionEngine API, which you can use from the API Explorer. You must set the bypassPendingChangeValidation attribute to TRUE.   --- |
| --- | --- |

### Before you begin

To determine which Snort version is currently enabled, use this procedure, or choose Policies > Intrusion. Look for the Snort Version line above the
table. The current version is the first number in the complete version number. For
example, 2.9.17-95 is a Snort 2 version.

If the device is in an air-gapped network, consider manually uploading the latest
rules package for the new version before switching.

If you downgrade to 2.0, any custom intrusion policies that you created are converted
to the base policy used in the custom policy. As far as possible, rule action
overrides are retained. If more than one custom policy uses the same base policy,
the overrides of the custom policy that is used in the most access control policies
are retained, and the overrides for the other custom policies are lost. Access
control rules that used these "duplicate" policies will now use the base policy
created from your most-used custom policy. All custom policies are deleted. If you
want to preserve the custom policies so that you can import them later, after
switching back to Snort 3, use the threat
defense API to export the configuration.

In addition, a downgrade to 2.0 removes any NAP
customizations, and the system switches to use the most appropriate NAP based on the
intrusion policies used in access control rules.

Hostname redirect in active authentication also
requires Snort 3, and will be removed if you switch to Snort 2.

You must deploy any pending changes before you can switch Snort versions.

### Procedure

---

| **Step 1** | Choose Device, then click View Configuration in the Updates summary.  Look at the Intrusion Rule group. The current Snort version is indicated. |
| --- | --- |
| **Step 2** | In the Intrusion Rule group, you can change the Snort version by clicking Upgrade to Snort 3.0 or Downgrade to Snort 2.0. |
| **Step 3** | When prompted to confirm your action, select the option to get the latest intrusion rules package, then click Yes.  We recommend that you get the latest rules package. The system downloads packages for the active Snort version only, so it is unlikely that you have the latest package installed for the Snort version you are switching to.  You must wait until the task to switch versions completes before you can edit intrusion policies. |

---

## Configuring Syslog for Intrusion Events

You can configure an external syslog server for intrusion policies to
send intrusion events to your syslog server. You must configure the syslog
server on the intrusion policy to get intrusion events sent to the server.
Configuring a syslog server on an access rule sends connection events only to
the syslog server, not intrusion events.

If you select multiple syslog servers, events are
sent to each of the servers.

Intrusion events have the message ID 430001.

### Procedure

---

| **Step 1** | Select Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the Intrusion Policy Settings button (Gear/Settings button.) to configure syslog. |
| **Step 3** | Click the + button under Send Intrusion Events To and select the server objects that define the syslog servers. If the required objects do not already exist, click Create New Syslog Server and create them. |
| **Step 4** | Click OK. |

---

## Configuring the Network Analysis Policy (Snort 3)

The Network Analysis Policy (NAP) is applied to all allowed connections on the
device. The NAP determines which inspectors are enabled, and the values of the
attributes used by the inspectors. The binders determine the ports and protocols
that should be associated with the various inspectors.

Coordinate the NAP with the intrusion policies you apply in access control rules:

* If you use a single intrusion policy in your access control rules, select the
  same-named NAP. Then, make adjustments to inspectors and attributes based on
  the settings in your intrusion policy. For example, if you enable intrusion
  rules for a particular inspector, such as CIP, ensure that you enable that
  inspector in the NAP.
* If you use multiple intrusion policies, select the NAP that matches the most
  strict intrusion policy that you use.
* If you use custom intrusion policies, make your NAP selection based on the
  base intrusion policy for your custom intrusion policies.
* If you do not need to customize any inspectors or binders, consider
  configuring the system to automatically select the most appropriate NAP
  based on your intrusion policy usage. This is the default option.

### Before you begin

Unless you prevent it, the system regularly downloads LSP updates to the inspection
rules. These updates can add or remove inspectors and attributes, and change default
settings for attributes. If you have made overrides to removed inspectors, these
overrides are preserved and you will see warnings that the inspector is no longer
supported. In this case, delete the inspector and make any other flagged adjustments
to ensure your NAP is completely valid.

### Procedure

---

| **Step 1** | Choose Policies > Intrusion.  Verify that the Snort version shown above the table is 3.x. |
| --- | --- |
| **Step 2** | Click the Intrusion Policy Settings button (Gear/Settings button.). |
| **Step 3** | In Default Network Analysis Policy, select one of the following:   * Auto—Automatically select the NAP that matches   the most-used intrusion policy (or base policy for custom rules)   applied in access control rules. If you do not apply any intrusion   policies, the Balanced Security and Connectivity NAP is used. The   NAP is run in Prevention mode, and you cannot customize intrusion or   binder settings. The remainder of this procedure does not apply when   running in automatic mode. * Custom—Explicitly select the NAP that should   be used. Click the Edit link next to the   policy name to select a different policy. You can then select the   inspection mode, and customize inspector and binder settings, as   described in the following steps. |
| **Step 4** | In the Edit Network Analysis Policy dialog box, select the policy and configure its settings.   1. In Network Analysis Policy, select the policy    that should apply globally to all allowed connections. 2. Select the Inspection Mode.  The inspection mode determines how non-compliant traffic is handled.    Use the same inspection mode as you use in your intrusion policies    for optimal results.     * Prevention—Block any decoder,      normalization, or protocol anomalies based on the settings      in the policy. You must use this option if you enable the      SSL Decryption policy, or if you enable the TLS      Server Identity Discovery option in the      access control policy settings.    * Detection—Simply issue alerts for      decoder, normalization, or protocol anomalies. Do not block      any traffic. 3. (Optional.) Configure and manage overrides to the inspectors and    binders:     * To edit overrides, see [Configuring Inspector and Binder Overrides](#Cisco_Task_in_List_GUI.dita_e6960060-5b51-419d-ac09-fb55545850b3).    * To download the schema or overrides, see [Downloading Overrides and the Schema](#Cisco_Task_in_List_GUI.dita_6d5ef939-3834-4b06-acdf-dff2d647758c).    * To upload overrides, see [Uploading Overrides](#Cisco_Task_in_List_GUI.dita_e447172f-a47e-4032-8776-549b10eb8c6a).    * To reset all the overrides, click the Reset      Inspector/Binder Overrides link above the      NAP file. You are asked to confirm the reset. The deletion      is limited to inspectors or binders, as indicated in the      command name. For example, deleting all binder overrides      leaves your inspector overrides unchanged.    * To reverse all changes to the selected inspector, click      Reset Inspector to      Defaults.    * To filter the view so you see only those inspectors that have      overrides, click Show Only Overrides.      Click Show All Inspectors to remove      the filter. 4. Click OK. |

---

### Configuring Inspector and Binder Overrides

When you select a base NAP, you are selecting inspector settings contained in that
baseline policy. In most cases, these are the appropriate settings.

However, you can override the settings in the selected NAP. For example, you can
enable or disable individual inspectors, or change the value for an attribute or a
binder.

The following procedure explains how to configure overrides directly. Alternatively,
you can download the schema, make changes offline, then upload your overrides. You
can also upload the overrides you downloaded from another device.

#### Before you begin

Explaining each inspector, binder, and attribute is beyond the scope of this
document. For detailed information, including examples, see Snort 3 Inspector
Reference at <https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/snort3-inspectors/snort-3-inspector-reference.html>.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion, click the  Intrusion Policy Settings button (Gear/Settings button. ), select Custom for the NAP settings, then click the Edit link next to the policy name. |
| --- | --- |
| **Step 2** | Click the tab that contains the setting you want to change:   * Inspectors—The inspectors examine specific   types of traffic, such as FTP, for protocol anomalies. * Binders—The Binder inspector determines when a   service inspector needs to be used to inspect traffic. The   configurations in the binder inspector include the ports, hosts,   CIDRs, and services that define when another inspector in the   network analysis policy needs to inspect traffic. |
| **Step 3** | Edit the settings as needed.   * Use the following to control the view in the JSON editor:    + Use the Filter edit box to do a     full-text search of the JSON file.   + Click the Expand All Fields button     (Expand all fields) to open all of the folders in the JSON file.   + Click the Collapse All Fields (Collapse all fields) button to close all folders in the JSON file.   + Click the Undo Last Action (Undo last action) button to reverse your most recent change.   + Click the Redo (Redo) button to redo your last reversed change.   + Select Tree to see a formatted view of     the JSON file, which includes action menus, error flags, and     other features to guide your edits.   + Select Code to see the raw JSON file. * In Tree view, click the Menu (JSON menu) button to manipulate the contents of the file. You can:    + Insert attributes. Use Auto to have     the editor determine the appropriate data type. Otherwise,     add an Array, Object, or String. If you add an invalid     attribute, the system will mark the inspector or binder as     having a problem that you must resolve.   + Append attributes. This action does     the same as Insert, but puts the attribute at the end of the     section.   + Duplicate the selected attribute.   + Remove (delete) the selected     attribute. When editing an attribute, a popup message might     also provide a Delete command. * To enable an inspector that is currently disabled, or change the   setting of any Boolean attribute, click the checkbox in front of the   attribute value. For example, to enable an inspector, change the   enabled : false attribute to:    Enabled set to true. * To change the value of a string or numeric attribute, click in the   attribute and edit the value as needed. If your entry violates the   rules for the field, error messages explain the discrepancy. For   example, a numeric value indicates the valid range of values if you   enter a value outside the range. * To reset overrides:    + Click Reset Inspector/Binder Overrides     to remove all of your changes to all inspectors or binders     and return to default values. The deletion is limited to     inspectors or binders, as indicated in the command name. For     example, deleting all binder overrides leaves your inspector     overrides unchanged.   + Click Reset Inspector to     Defaults to reverse all changes to the     selected inspector only. * To filter the view so you see only those inspectors that have   overrides, click Show Only Overrides. Click   Show All Inspectors to remove the filter. * If an inspector is no longer supported, the inspector is flagged with   a message. Click the Delete Inspector link in   the message to remove the inspector. |
| **Step 4** | Click OK when finished. |

---

### Downloading Overrides and the Schema

You can download the NAP schema, or download the overrides you have configured for
the policy.

Downloading overrides is recommended whenever you change the base NAP, in case you
want to go back to your previous settings. In addition, you could use the JSON
editor on one device to implement the overrides you want to use on all devices,
download the overrides, then upload that override file to other devices.

Downloading the schema is useful if you want to edit the file offline, then upload
your overrides to this device or to multiple devices. You should copy/paste just the
sections you need to change, rather than upload the entire file, to ensure only
those changes you make are considered overrides.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion, click the  Intrusion Policy Settings button (Gear/Settings button. ), select Custom for the NAP settings, then click the Edit link next to the policy name. |
| --- | --- |
| **Step 2** | Do one of the following:   * To download the schema for the currently-select NAP, click the gear   icon (Gear/Settings button.) and select Download > Policy Schema. * To download the saved set of overrides, as they existed prior to the   current editing session, click the gear icon (Gear/Settings button.) and select Download > Last Saved Overrides. The file includes overridden attributes plus their   containing objects. * To download the overrides you have created in the current editing   session, click the gear icon (Gear/Settings button.) and select Download > Current Unsaved Overrides. The file includes overridden attributes plus their   containing objects. |

---

### Uploading Overrides

Rather than editing attributes using the embedded JSON editor, you can download the
NAP policy schema, edit the file offline, then upload the file. Any overrides
configured in the uploaded file are then applied to the selected NAP.

You can also upload a file you downloaded after configuring overrides on another
device.

By uploading your overrides, you can upload the same file to multiple devices and
easily apply the same overrides.

#### Before you begin

For overriding an inspector configuration in the network analysis policy, you should
upload only the changes that you require. You should not upload the entire
configuration because it makes the overrides sticky in nature and therefore, any
subsequent changes to the default values or configuration as part of the LSP updates
would not be applied. Ensure that your uploaded overrides are tightly focused on
just those attributes you want to change.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion, click the  Intrusion Policy Settings button (Gear/Settings button. ), select Custom for the NAP settings, then click the Edit link next to the policy name. |
| --- | --- |
| **Step 2** | Click the gear icon (Gear/Settings button.) and select Upload > Overrides. |
| **Step 3** | (Optional.) Click one of the Download links to save a copy of your existing overrides.  You can either download the last saved overrides (those made before the current editing session) or the current unsaved overrides (those made during the current editing session). |
| **Step 4** | Click Yes on the Confirm Upload Overrides dialog box to confirm you want to continue. |
| **Step 5** | Click Browse, or drag and drop, to select the JSON file that contains your overrides, and click OK. |

---

## Managing Intrusion Policies (Snort 3)

When you use Snort 3 as the inspection engine, you can create your own intrusion
policies and customize them for your purposes. The system comes with pre-defined
policies that are based on the same-named Cisco Talos Intelligence Group
(Talos)-defined policies. Although you can edit these policies, a better practice is to
create your own policy based on the underlying Talos policy and change that if you need to adjust rule actions.

Each of these pre-defined policies includes the same list of intrusion rules (also
known as signatures), but they differ in the actions taken for each rule. For
example, a rule might be enabled in one policy, but disabled in another policy.

If you find that a particular rule is giving you too many false positives, where the
rule is blocking traffic that you do not want blocked, you can disable the rule
without needing to switch to a less-secure intrusion policy. You could alternatively
change it to alert on matches without dropping traffic.

Conversely, if you know you need to protect against a specific attack, but the
related rule is disabled in your chosen intrusion policy, you can enable the rule
without changing to a more secure policy.

Use the intrusion related dashboards, and the Event Viewer (both on the
Monitoring page), to evaluate how intrusion rules are
impacting traffic. Keep in mind that you will see intrusion events and intrusion
data only for traffic that matches intrusion rules set to alert or drop; disabled
rules are not evaluated.

| **Note** | ---   If you switch to Snort 2, you cannot create custom policies, and the use of intrusion policies differs slightly. Instead of this topic, see [Managing Intrusion Policies (Snort 2)](#concept_C0EB1AB846C945C38FE3940BBC8803F7).   --- |
| --- | --- |

### Procedure

---

| **Step 1** | Choose Policies > Intrusion.  Verify that the Snort version shown above the table is 3.x. |
| --- | --- |
| **Step 2** | Do any of the following:   * Use the Search/Filter box to find a policy.   You can search by name only. * Click the gear icon (Gear/Settings button.) to enable logging to a syslog server. See [Configuring Syslog for Intrusion Events](#task_3C0D47785EF24FCB88E6E671705E10E8). * Click the gear icon (Gear/Settings button.) to configure the network analysis policy (NAP). See [Configuring the Network Analysis Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_49189b70-682c-4336-9620-fe104df820f6). * Click + to create a new policy. See [Configuring a Custom Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_577e0181-dbc9-492b-90b8-a4b59bd381f0). * Click the edit icon (edit icon) to see the properties and rules in the policy, and to edit them.   See [Viewing or Editing Intrusion Policy Properties (Snort 3)](#Cisco_Task_in_List_GUI.dita_6faed926-3676-491a-9639-25912f85d7b3). * Click the delete icon (delete icon) to delete a policy. |

---

* [Configuring a Custom Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_577e0181-dbc9-492b-90b8-a4b59bd381f0)
* [Viewing or Editing Intrusion Policy Properties (Snort 3)](#Cisco_Task_in_List_GUI.dita_6faed926-3676-491a-9639-25912f85d7b3)
* [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a)
* [Changing Intrusion Rule Actions (Snort 3)](#Cisco_Task_in_List_GUI.dita_54aef253-02ab-4044-88ea-cea05249686d)
* [Managing Custom Intrusion Rules and Rule Groups](#Cisco_Task_in_List_GUI.dita_1704f9a7-4642-48db-a5db-1938d5494c4b)

### Configuring a Custom Intrusion Policy (Snort 3)

You can create new intrusion policies to customize rule behavior if the pre-defined
policies do not fit your needs. In general, it is good practice to create custom
policies based on the pre-defined policies rather than to alter those policies. This
ensures you can easily implement one of the Cisco Talos defined policies if you find
that your customizations do not deliver the results that you need.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Do one of the following:   * To create a new policy, click +. * To edit an existing policy, click the edit icon (edit icon) for the policy. When you are shown the policy details, click the   Edit link in the policy properties   section at the top of the page. |
| **Step 3** | Enter a Name, and optionally, a description for the policy. |
| **Step 4** | Configure the Inspection Mode for the policy.   * Prevention—Intrusion rule actions are always   applied. Connections that match a drop rule are blocked. * Detection—Intrusion rules generate alerts   only. A connection that matches a drop rule will generate alert   messages, but the connection will not be blocked. |
| **Step 5** | Select the Base Template for the policy.  The base templates are provided by Cisco Talos. Click the info icon for each to see more information about the policies. Note that policy names can change, and new policies appear, when a new rules package gets installed.   * Maximum Detection (Cisco Talos)—This policy   places all emphasis on security. Network connectivity and throughput   is not guaranteed and false positives are likely. This policy should   only be used for high security areas and security monitors must be   prepared to investigate alerts to determine their validity. * Security Over Connectivity (Cisco Talos)—This   policy places an emphasis on security, at the possible expense of   network connectivity and throughput. Traffic is inspected more   deeply, more rules are evaluated, and both false positives and   increased latency are expected but within reason. * Balanced Security and Connectivity (Cisco   Talos)—(Default.) This policy attempts to strike the   delicate balance between network connectivity and throughput and the   needs of security. While not as strict as Security Over   Connectivity, this policy attempts to keep users secure while being   less obtrusive about normal traffic. * Connectivity Over Security (Cisco Talos)—This   policy places an emphasis on network connectivity and throughput, at   the possible expense of security. Traffic is inspected less deeply,   and fewer rules are evaluated. * No Rules Active (Cisco Talos)—This policy is a   basic policy that configures typical preprocessor settings but does   not have any rules or built-in alerts enabled. Use this policy as a   base if you want to ensure that only those policies you want to   apply are enabled. |
| **Step 6** | Click OK.  You are returned to the intrusion policy list. You can now view the new policy and adjust rule actions as needed. |

---

### Viewing or Editing Intrusion Policy Properties (Snort 3)

The Intrusion Policy page shows a list of the policies, including both pre-defined
and user-defined policies, and their descriptions. To edit a policy, you must first
view the policy's properties.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  The policy contains the following sections:   * Policy Name drop-down list.    + You can easily switch to a different policy by selecting it     from the drop-down list, or return to the list of policies     by clicking the back button (Go Back to Virtual Routers arrow.).   + You can delete this policy by clicking the delete icon next     to the policy name (delete icon). * General properties. This section shows the   intrusion mode, base policy, and description. Click   Edit to change these properties or the   policy name. * Rule Group table of contents. This list   displays all the rule groups that have active rules in the policy.   The groups have a hierarchy, with parent groups containing child   groups that organize subsets of rules within the larger parent   group. Each group is a logical collection of rules, and a given rule   can appear in more than one group.    + To add a group that currently has no active rules in the     policy, click + > Add Existing Rule Group and select the group. See [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a).   + To change the security level of a group, select the child     group in the list. The rule list changes to show the     security level at the top, with the rules in the group     listed below. Click the Edit link     next to the security level and select a new level. Click     View Description when editing to     get information about each security level. Note that     changing the level can change which rules are active, and     also the action for a given rule, with more secure levels     tending to have more active rules and more rules with the     Drop action. Click OK to confirm the     change. (Security Level     does not apply to custom rule groups.)      Changing the security level for an existing rule group.   + To remove all the rules in a group, select the child group in     the list. Then, click the Exclude     link to the far right of the group name and confirm that you     want to exclude the group. Excluding the group simply     disables all the rules in the group. It does not delete the     group.  However, if the group includes rules that are shared with     other groups that are enabled, the shared rules retain     whatever actions are applied by the still-active group. In     all cases, we retain your most aggressive setting for an     individual rule, regardless of group membership.   + To add a new custom rule group of custom rules, click + > Upload Custom Rules. For details, see [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864).   + To change the name or description of a custom rule group,     click Edit.   + To delete a custom rule group, click     Delete. For more information, see     [Managing Custom Intrusion Rules and Rule Groups](#Cisco_Task_in_List_GUI.dita_1704f9a7-4642-48db-a5db-1938d5494c4b).   + To add a new custom rule in a custom rule group, click     + above the rule table. See [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e).   + To edit, duplicate, delete, or manage group membership for a     custom rule, mouse over the right of the rule and click the     appropriate button or command. For more information, see     [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e). * List of rules. You can use the search field to   help you find rules using full-text search. You can also select   filtering items to search on any combination of GID or SID, show only user defined rules   (those you added),    show only those rules whose actions are overridden, or   simply show rules based on their actions (disabled, alert, drop).   The rules are lazy-loaded, so it will take quite a bit of time to   scroll through the entire unfiltered list. When filtering the list,   click the refresh button to reload the filtered view.    + To change the action for a rule, click the     Action cell for the rule and     select the new action, to Alert only,     to Block matching traffic, or to     Disable the rule. The default     action for each rule is indicated.   + To change the action for more than one rule at a time, click     the check box in the left column of the rules you want to     change, then select the new action from the     Action drop-down list above the     rules table. Click the check box in the GID:SID header to     select all the rules in the list. You can change up to 5000     rules at a time.   + To update the rules within a custom rule group, click     Upload Rule File. For more     information, see [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864).   + To get more information about a rule, click the link in the     GID:SID cell. The link takes you     to Snort.org.   + To change the rules listed, you can click a child group from     the rule group table of contents (not a parent group). You     can return to the all-rules list by clicking ALL     RULES at the top of the rule group list.   + To change the sorting order, click the table header for a     column. The default sorting for the rules is overridden     rules first, then drop rules, then alert rules.   + To see what changes where made in an intrusion rule (LSP)     update, select LSP Update in the     filter field, then select the updates whose changes you want     to see, and specify whether you want to see all changes, or     just additions or changes to the rules. |

---

### Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)

Intrusion rules are organized in local groups. There is a hierarchy to the groups,
with parent groups containing related child groups. The rules themselves appear in
child groups only: parent groups are simply an organizational construct. A given
rule can appear in more than one group.

Any custom rule groups you create are in the User
Defined Groups folder. Custom rule groups do not have a hierarchy.

The easiest way to add or remove rules in an intrusion policy is to add or remove
groups. Because the rules in a group are logically related, it is highly likely that
you will want to use most if not all rules within a given group.

The following procedure explains how to add groups and change the group’s security
level.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for the policy you want to change. |
| **Step 3** | (Adding groups.) If the group is not shown in the list of rule groups, click + > Add Existing Rule Group and do the following:   1. Find the child group.     * A check mark next to a parent group name indicates that all      child groups in the parent group are already selected.    * A minus mark next to a parent group name indicates that one      or more child group has no enabled rules for this policy.      These are the groups you can add.    * A check mark next to a child group name indicates the group      is already selected. 2. Select the group you want to add (that is, check its check box). 3. (Optional, does not apply to custom    rule groups.) Each group has a default security level depending    on the base policy used for the custom policy. If you want to change it,    click the security level icon, select a new level, and click    OK.  Level 1 is the least secure posture, emphasizing connectivity over    security, whereas level 4 is the most aggressive, providing maximum    security. You can click View Description to    see an explanation of each level as you select it.     Changing security level while adding a rule group. 4. Continue selecting (or deselecting) groups until you have made all of    your changes. 5. Click OK. |
| **Step 4** | (Removing groups.) If you want to disable all the rules within a group, you can use any of the following methods:   * Select the group, then click the Exclude link   to the far right of the group name, above the list of rules. * Use the method for adding a group, but instead, deselect the unwanted   group (that is, uncheck its check box), and click   OK. * You can delete a custom rule group to remove it entirely from the   system and from all intrusion policies that use it. Select the   group, then click Delete. |

---

### Changing Intrusion Rule Actions (Snort 3)

Each intrusion policy has the same rules. The difference is the action taken for each
rule can be different from policy to policy.

By changing the rule action, you can disable rules that are giving you too many false
positives, or you can change whether the rule alerts on or drops matching traffic.
You can also enable disabled rules to alert or drop matching traffic.

The easiest method to change rule actions is to change the security level of a rule
group. When you change a group's security level, the action of the rules within the
group change. This can mean that some rules become enabled (or disabled), or the
action can change between alert and drop, based on the security posture you select.
However, you can change an individual rule action if that is what you need.

| **Note** | ---   The default action for a given rule is based on the overall selection of group and severity. Changing the severity of the group, or excluding the group, can change the default action for the rule.   --- |
| --- | --- |

#### Before you begin

Custom rule groups do not have security levels. You cannot use the security level
technique to change rule actions for custom rules.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the view icon (View configuration button.) for the policy whose rule actions you want to change. |
| **Step 3** | (Recommended method.) Change the security level for a rule group.   1. Click the child rule group in the rule group list. 2. Above the list of rules, click Edit next to the    security level for the group.     Changing the security level for an existing rule group.        | **Note** | If you want to disable all the rules in the group, do not click Edit. Instead, click Exclude and confirm that you want to exclude the group. The group is not deleted, its rules are simply disabled. Skip the remaining steps. |    | --- | --- | 3. Select the new level for the group. Click View    Description to see an explanation of each level as you    pick it.  Level 1 is the least secure posture, emphasizing connectivity over    security, whereas level 4 is the most aggressive, providing maximum    security. 4. Click OK. |
| **Step 4** | (Manual method.) Change the action for one or more rule.   1. Find the rule whose action you want to change.  Use the Search/Filter box to search on strings    within the rule information. You can also select filtering items to    search on any combination of GID or SID, or simply show rules based    on their actions (disabled, alert, drop). The rules are lazy-loaded,    so it will take quite a bit of time to scroll through the entire    unfiltered list. When filtering the list, click the refresh button    to reload the filtered view.  Ideally, you can get the Snort identifier (SID) and generator    identifier (GID) from an event or from Cisco Technical Support, if    you are working with them on an issue. You can then search precisely    for the rule. 2. To change the action, do one of the following:     * Change one rule at a time—Click the      Action column for the rule and      select the required action:       + Alert—Create an event when        this rule matches traffic, but do not drop the        connection.      + Drop—Create an event when this        rule matches traffic, and also drop the connection.      + Disabled—Do not match traffic        against this rule. No events are generated.    * Change multiple rules at one time—Click the check boxes for      the rules you want to change, then click the      Bulk drop-down above the table      and pick the desired action. Click the check box in the      GID:SID header to select all the rules in the list. You can      change up to 5000 rules at a time. |

---

### Managing Custom Intrusion Rules and Rule Groups

The system comes with thousands of intrusion rules defined by Cisco Talos Intelligence Group
(Talos). If you know of additional attacks, you can create and upload custom intrusion
rules to screen for those attacks, and either alert or drop them. You can also
create, edit, and delete rules one at a time.

For uploaded rules, you create the rules offline using a text editor. We recommend
that you include a group of custom rules in each text file you upload. You can then
easily upload changes to your rules, and either merge new rules into your custom
rule groups, or replace your rules with new, edited copies.

Explaining how to create these rules is outside the scope of this document. For
detailed information on how to write intrusion rules for Snort, including how to
convert Snort 2 rules to Snort 3 format, see the guides on <https://snort.org/documents>. For
example, Rules Authors Introduction to Writing Snort 3 Rules at <https://snort.org/documents/rules-writers-guide-to-snort-3-rules>.

#### Before you begin

You create custom rule groups during the process of uploading custom rules, as
described in [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864), or when creating individual rules or
managing rule membership. After you create the group, you can manage the group and
its contents.

Note that custom groups are available for all intrusion policies, not just the policy
you were editing when you created the group. Thus, changes you make to a group are
made for all policies. For example, if you delete a custom rule group, it is deleted
from all policies and is no longer available for any of them.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  We recommend that you add custom rules to a custom intrusion policy rather than one of the built-in policies. |
| **Step 3** | Do any of the following:   * To create a group, click + > Upload Custom Rules. See [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864). * To edit a group’s name or description, select the group in the group   table of contents in the User Defined Groups folder. You can then   click Edit and make your changes. * To exclude the group and its rules from the policy, select the group   in the group table of contents in the User Defined Groups folder.   You can then click Exclude to remove the   group. * To delete the group from the system and all policies that use it,   select the group in the group table of contents in the User Defined   Groups folder. Then click Delete. Note that   if a rule exists only in the deleted group, it is also deleted from   the system. However, if a rule also exists in other custom rule   groups that you are not deleting, the rule will remain in those   groups. * To replace or update the rules in a group in bulk, select the group   in the group table of contents in the User Defined Groups folder.   Then, click Upload Rule File next to the   Action drop-down list above the group’s rule table. The process is   the same as that described in [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864). * To create and manage individual rules, and their assignment to rule   groups, see [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e). |

---

* [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864)
* [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e)

#### Uploading Custom Intrusion Rules

If you know of attacks that are not currently covered by other rules, you can create
and upload custom intrusion rules to screen for those attacks, and either alert or
drop them. The action of the imported rules must be either alert or drop, and the
default action for the rule is defined by the action in the imported file. Once
imported, you can change a rule action and disable a rule if necessary.

You must create these rules offline. In the device
manager, you are simply uploading a rules file, you are not configuring the rules directly. The rules file should be a text file.
You can use line returns to format the rules to be readable, or put a rule on a single line, and empty lines are allowed.
Rule format is explained at snort.org.

For example, an upload file of three rules could look like the following:

```

alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (
   msg: "My Custom Rule: EXPLOIT-KIT Styx exploit kit landing page request";
   flow:to_server,established;
   http_raw_uri;
   bufferlen:>100;
   http_uri;
   content:"/i.html?",depth 8; pcre:"/\/i\.html\?[a-z0-9]+\=[a-zA-Z0-9]{25}/";
   flowbits:set,styx_landing;
   metadata: copied from talos sid 29452;
   service:http;
   classtype:trojan-activity;
   gid:1;
   sid:1000000;
   rev:1;
)

alert tcp $HOME_NET 8811 -> $EXTERNAL_NET any (
   msg:"My Custom rule: MALWARE-BACKDOOR fear1.5/aciddrop1.0 runtime detection - initial connection";
   flow:to_client,established;
   flowbits:isset,Fear15_conn.2;
   content:"Drive",nocase;
   metadata:copied from talos sid 7710;
   classtype:trojan-activity;
   gid:1;
   sid:1000001;
   rev:1;
)

alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (
   msg:"My Custom Rule: INDICATOR-COMPROMISE download of a Office document with embedded PowerShell";
   flow:to_client,established;
   flowbits:isset,file.doc;
   file_data;
   content:"powershell.exe",fast_pattern,nocase;
   metadata:copied from talos sid 37244;
   classtype:trojan-activity;
   gid:1;
   sid:1000002;
   rev:1;
)
```

##### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  We recommend that you add custom rules to a custom intrusion policy rather than one of the built-in policies. |
| **Step 3** | Do one of the following:   * Above the list of groups, click + > Upload Custom Rules. * If you are uploading rules into a custom rule group that you already   created, you can select the custom rule group, then click   Upload Rule File next to the   Action drop-down list above the group’s   rule table. |
| **Step 4** | Click Browse and select your custom rule file, or drag and drop the file into the Upload File dialog box.  Wait for the upload to complete. |
| **Step 5** | Select how you want to handle conflicts:  A conflict occurs when a rule you are adding is the same as one already in the system. This should happen only if you are uploading the same rules or edited versions of rules that you previously uploaded.  Select one of these options:   | **Note** | Merge and Replace are basically the same thing. Uploaded rules must have higher revision numbers than the ones you already uploaded for any changes to be made to the existing rules. The only difference is that if the upload file is missing rules that are in the targeted custom rule group, the Replace option will delete those rules from the rule group. The Merge option will leave those "missing" rules in place. | | --- | --- |  * Merge—Any changed rules in the uploaded file   that also exist in the selected group will have those changes   merged, if the rule in the uploaded file has a higher revision   number. Any unchanged rules, or rules in the group that do not have   corresponding rules in the upload, will be left unchanged. Any new   rules in the upload will be added. This is the default option. * Replace—The rules in the uploaded file will   replace the rules in the selected group, if the revision number on   the uploaded rule is higher. Any existing rules not in the uploaded   file will be deleted from the group. Existing rules whose uploaded   version has a revision number that is the same or lower will be left   unchanged. Any new rules in the upload will be added. |
| **Step 6** | Click + and select the custom rule group for the uploaded rules.  If the custom rule group you want to use does not yet exist, click Create New Group and create it now. The new group needs a name and optionally, a description. Then, you can select the new group.  If you are replacing rules, you can select a single group only. If you are merging them, you can select multiple groups. |
| **Step 7** | Click OK.  The files are uploaded and placed in the new group. You should see a summary of how many rules were uploaded, and how many rules were updated, deleted, or ignored.  If there are errors in the file, the upload will fail. You can click the Download Error File link to get more information on the errors.  The group is automatically activated in this intrusion policy. The group and new rules are available to be added to other policies, but the group and rules are not automatically enabled in any other policy. For information on adding groups to other policies, see [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a). |

---

#### Configuring Individual Custom Intrusion Rules

You can configure custom intrusion rules one at a time rather than in bulk through
file uploads. This method works well when you need to make a quick adjustment to a
rule, or you need to create or modify just a few rules at a time.

When configuring intrusion rules, keep the following in mind:

* The GID for all custom rules should be 1.
* The SID for a rule must be unique across all rules in the system. It also
  must be one million (1000000) or higher.
* If you edit a rule, you must change the rule version. Normally, you increment
  the version number by 1.
* You can duplicate a Cisco Talos Intelligence Group
  (Talos) rule to create your own version of the rule, but you still must change
  the SID of the duplicate to make it unique.

The system will do some validity checking to ensure the rule is well formed, and you
will see error messages about any problems. However, the system cannot determine
whether the rule is sensible.

For detailed information on how to write intrusion rules for Snort, including how to
convert Snort 2 rules to Snort 3 format, see the guides on <https://snort.org/documents>. For
example, Rules Authors Introduction to Writing Snort 3 Rules at <https://snort.org/documents/rules-writers-guide-to-snort-3-rules>.

##### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  We recommend that you add custom rules to a custom intrusion policy rather than one of the built-in policies. |
| **Step 3** | Do one of the following:   * To add an intrusion rule, click the Add New Intrusion   Rule button (+) above the   rule table. When adding a rule, you must select one or more custom   rule groups to contain the new rule. You can create new groups while   adding the rule if necessary. * To add a rule by duplicating and editing an existing rule, mouse over   the right end of the rule and click the Duplicate (Copy connection summary to clipboard button.) button. The button appears only on mouse-over. For custom rules,   the Duplicate command is under the more   options (...) button. * To edit a custom rule, find the rule in a custom rule group and click   the edit (edit icon) button for the rule. Your edits apply across all groups in which   the rule resides. Make sure you increment the rule version number by   at least 1 when making changes. * To delete a custom rule, click the delete (delete icon) button for the rule. The rule is deleted from all rule groups   that contain it. If you just want to remove a rule from a group, use   the Manage Group Assignments option instead   of deleting the rule. * To change which groups contain the rule, click the more options   (...) button and select Manage   Group Assignments. You can then add or remove   groups. Your changes simply affect group membership, it does not   change the rule or delete it. |
| **Step 4** | For new rules and groups, add the rule to the policy.  When you create a new group when creating a new rule, or editing an existing rule, that group is not added to your policy automatically, nor is the rule enabled automatically. You are prompted to add the group to the policy you are editing. If you do not add the group while adding or editing the rule, you can add the group later using the following process:   1. Click + > Add Existing Rule Group above the group table of contents. 2. Find the group under the User Defined Groups folder, select it, and    click OK. 3. Select the group in the table of contents and verify that the new rule    is in the group and has the desired action. |

---

## Managing Intrusion Policies (Snort 2)

You can apply any of the pre-defined intrusion policies. Each of these policies includes the same
list of intrusion rules (also known as signatures), but they differ in the actions taken
for each rule. For example, a rule might be active in one policy, but disabled in
another policy.

If you find that a
particular rule is giving you too many false positives, where the rule is
blocking traffic that you do not want blocked, you can disable the rule without
needing to switch to a less-secure intrusion policy. You could alternatively
change it to alert on matches without dropping traffic.

Conversely, if you know you need to protect against a specific attack, but the related rule is disabled in your chosen intrusion
policy, you can enable the rule without changing to a more secure policy.

Use the intrusion
related dashboards, and the Event Viewer (both on the
Monitoring page), to evaluate how intrusion rules
are impacting traffic. Keep in mind that you will see intrusion events and
intrusion data only for traffic that matches intrusion rules set to alert or
drop; disabled rules are not evaluated.

The following topics
explain intrusion policies and rule tuning in more detail.

* [Configure the Inspection Mode for an Intrusion Policy (Snort 2)](#id_121662)
* [Changing Intrusion Rule Actions (Snort 2)](#task_4D5DD40DDCE0426C8846E5684287E63B)

### Configure the Inspection Mode for an Intrusion Policy (Snort 2)

By default, all intrusion policies operate in Prevention mode to implement an Intrusion Prevention System (IPS). In the Prevention
inspection mode, if a connection matches an intrusion rule whose action is to drop traffic, the connection is actively blocked.

If you instead want to test the effect of the intrusion policy on your network, you can change the mode to Detection, which
implements an Intrusion Detection System (IDS). In this inspection mode, drop rules are treat like alert rules, where you
are notified of matching connections, but the action result becomes Would Have Blocked, and connections are never in fact
blocked.

You change the inspection mode per intrusion policy, so you can have a mix of prevention and detection.

#### Procedure

---

| **Step 1** | Select Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the tab for the intrusion policy whose inspection mode you want to change.  The Inspection Mode is indicated above the rules table. |
| **Step 3** | Click the Edit link next to the inspection mode, change the mode for the policy, and click OK.  The options are:   * Prevention—Intrusion rule actions are always applied. Connections that match a drop rule are blocked. * Detection—Intrusion rules generate alerts only. A connection that matches a drop rule will generate alert messages, but the connection   will not be blocked. |

---

### Changing Intrusion Rule Actions (Snort 2)

Each pre-defined
intrusion policy has the same rules. The difference is the action taken for
each rule can be different from policy to policy.

By changing the rule action, you can disable rules that are giving you too many false positives, or you can change whether
the rule alerts on or drops matching traffic. You can also enable disabled rules to alert or drop matching traffic.

#### Procedure

---

| **Step 1** | Select Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the tab for the intrusion policy whose rule actions you want to change.  The pre-defined policies are:   * Connectivity   over Security * Balanced   Security and Connectivity * Security   over Connectivity * Maximum   Detection |
| **Step 3** | Find the rule whose action you want to change.  The rules are sorted with the overridden ones listed first, and sorted by action within the group of overridden rules. Otherwise, the rules are sorted by GID, then SID.  Use the search box to locate the rule you want to change. Ideally, you can get the Snort identifier (SID) and generator identifier (GID) from an event or from Cisco Technical Support, if you are working with them on an issue.  For detailed information about the elements of each rule, see [Intrusion Rule Attributes](#concept_C4C21B1BDF794F468738C9F836C6C87B).  To search the list:   1. Click in the    Search box to open the search attributes dialog box. 2. Enter a    combination of Generator ID (GID), Snort ID (SID), or rule    Action, and click    Search.  For example,    you could select    Action = Drop to see all the rules in the policy    that will drop matching connections. The text beside the search box indicates    how many rules match your criteria, for example, “8937 of 9416 rules found.”  To clear a    search criteria, click the x for the criteria in the search box. |
| **Step 4** | Click the Action column for the rule and select the required action:   * Alert—Create an   event when this rule matches traffic, but do not drop the connection. * Drop—Create an   event when this rule matches traffic, and also drop the connection. * Disabled—Do not   match traffic against this rule. No events are generated.   The default action for the rule is indicated by “(Default)” added to the action. If you change the default, the status column indicates “Overridden” for that rule. |

---

## Monitoring Intrusion Policies

You can find intrusion
policy statistics on the
Attackers and
Targets dashboards on the
Monitoring page. You must apply an intrusion policy
to at least one access control rule to see any information on these dashboards.
See
[Monitoring Traffic and System Dashboards](fptd-fdm-monitor.html#id_10212).

To see intrusion
events, select
Monitoring > Events, then click the
Intrusion tab. You can hover over an event and
click the
View Details link to get more information. From
the details page, you can click the
View IPS Rule to go to the rule in the relevant
intrusion policy, where you can change the rule action. This can help you
reduce the impact of false positives, where a rule is blocking too many good
connections, by changing the action from drop to alert. Conversely, you can
change an alert rule into a drop rule if you are seeing a lot of attack traffic
for a rule.

If you configure a syslog server for the intrusion policy, intrusion events have the message ID 430001.

## Examples for Intrusion Policies

The use case chapter
includes the following examples of implementing intrusion policies.

* [How to Block Threats](fptd-fdm-use-cases.html#id_25314)
* [How to Passively Monitor the Traffic on a Network](fptd-fdm-use-cases.html#task_B9870E6741394745B05165E6BB008F23)

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_7960becd_20250115_123401.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Configuration Guides](/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting
  Started](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-get-started.html)
* [Best Practices: Use Cases for Threat Defense](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-use-cases.html)
* [Licensing the
  System](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-license.html)
* System Monitoring
  + [Monitoring the
    Device](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-monitor.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-isa3000-alarms.html)
* Reusable Objects
  + [Objects](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-objects.html)
  + [Certificates](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-certificates.html)
  + [Identity Sources](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity-sources.html)
* The Basics
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-logical-devices.html)
  + [High Availability
    (Failover)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ha.html)
  + [Interfaces](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-interfaces.html)
* Routing
  + [Routing Basics and Static Routes](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-routing.html)
  + [Virtual Routers](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-virtual-routers.html)
  + [Route Maps and Other Objects for Route Tuning](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-route-maps.html)
  + [Open Shortest Path First (OSPF)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ospf.html)
  + [Enhanced Interior Gateway Routing Protocol (EIGRP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-eigrp.html)
  + [Border Gateway Protocol (BGP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-bgp.html)
* Security
  Policies
  + [SSL
    Decryption](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html)
  + [Identity
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity.html)
  + [Security
    Intelligence](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-sec-intel.html)
  + [Access
    Control](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-access.html)
  + [Intrusion
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html)
  + [Network Address
    Translation (NAT)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-nat.html)
* Virtual Private
  Networks (VPN)
  + [Site-to-Site
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-s2svpn.html)
  + [Remote Access
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ravpn.html)
* System
  Administration
  + [System
    Settings](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-system.html)
  + [System
    Management](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-mgmt.html)
* [Advanced
  Configuration](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-advanced.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3 Chapter Title SSL Decryption

* [PDF - Complete Book
  (18.14 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.pdf)
  [PDF - This Chapter (1.18 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (10.41 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (22.06 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 14, 2023

## Chapter: SSL Decryption

Chapter Contents

* [SSL Decryption](#topic_3E05DF8127124281AC1A8208FB4F0B2B)
* [About SSL Decryption](#concept_DF8743D3434644A49DB0D03D5865C955)
  + [Why Implement SSL Decryption?](#concept_9CE598D91E0E42A9A3BCA014053674A1)
  + [Actions You Can Apply to Encrypted Traffic](#concept_9C25DB275844450FAA2EA4E2D2DB93B5)
    - [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9)
    - [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061)
    - [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D)
    - [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057)
  + [Automatically Generated SSL Decryption Rules](#concept_97F27D8C3C88481F874E9C315B544185)
  + [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810)
* [License Requirements for SSL Decryption](#concept_CA331CC5D4C740F3BEB5C2765CE42074)
* [Guidelines for SSL Decryption](#concept_991745F245914B538F404B8AEA5EBFAF)
* [How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E)
* [Configuring SSL Decryption Policies](#task_A46EB67387764C209439122818AB7B43)
  + [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825)
  + [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316)
  + [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB)
    - [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B)
    - [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37)
    - [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC)
    - [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0)
    - [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD)
  + [Configure SSL Decryption Settings](#Cisco_Concept.dita_a8dbcdf0-6eb0-4ae3-bb1f-c833c58cb010)
    - [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)
    - [Configure Advanced and Undecryptable Traffic Settings](#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06)
  + [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378)
* [Example: Blocking Older SSL/TLS Versions from the Network](#id_106121)
* [Monitoring and Troubleshooting SSL Decryption](#concept_AA3515B3412145898E69AA30306BE0BC)
  + [Monitoring SSL Decryption](#concept_F6B5C308790C43ABA150C8E3F937A71C)
  + [Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)](#concept_9CE017AD0A384BB581E3EFB7CBC76573)

Close

# SSL Decryption

Some protocols, such as HTTPS, use
Secure Sockets Layer (SSL) or its follow-on version, Transport Layer Security
(TLS), to encrypt traffic for secure transmissions. Because the system cannot
inspect encrypted connections, you must decrypt them if you want to apply
access rules that consider higher-layer traffic characteristics to make access
decisions.

* [About SSL Decryption](#concept_DF8743D3434644A49DB0D03D5865C955)
* [License Requirements for SSL Decryption](#concept_CA331CC5D4C740F3BEB5C2765CE42074)
* [Guidelines for SSL Decryption](#concept_991745F245914B538F404B8AEA5EBFAF)
* [How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E)
* [Configuring SSL Decryption Policies](#task_A46EB67387764C209439122818AB7B43)
* [Example: Blocking Older SSL/TLS Versions from the Network](#id_106121)
* [Monitoring and Troubleshooting SSL Decryption](#concept_AA3515B3412145898E69AA30306BE0BC)

## About SSL Decryption

Normally, connections go through the access control policy to determine
if they are allowed or blocked. However, if you enable the SSL decryption
policy, encrypted connections are first sent through the SSL decryption policy
to determine if they should be decrypted or blocked. Any unblocked connections,
whether or not decrypted, then go through the access control policy for a final
allow/block decision.

| **Note** | ---   You must enable the SSL decryption policy in order to implement active authentication rules in the identity policy. If you enable SSL decryption to enable identity policies, but do not otherwise want to implement SSL decryption, select Do Not Decrypt for the default action and do not create additional SSL decryption rules. The identity policy automatically generates whatever rules it needs.   --- |
| --- | --- |

The following topics explain encrypted traffic flow management and
decryption in more detail.

* [Why Implement SSL Decryption?](#concept_9CE598D91E0E42A9A3BCA014053674A1)
* [Actions You Can Apply to Encrypted Traffic](#concept_9C25DB275844450FAA2EA4E2D2DB93B5)
* [Automatically Generated SSL Decryption Rules](#concept_97F27D8C3C88481F874E9C315B544185)
* [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810)

### Why Implement SSL Decryption?

Encrypted traffic, such as HTTPS connections, cannot be inspected.

Many connections are legitimately encrypted, such as connections to banks and other financial institutions. Many web sites
use encryption to protect privacy or sensitive data. For example, your connection to the device manager is encrypted.

However, users can also hide undesirable traffic within encrypted
connections.

By implementing SSL decryption, you can decrypt connections, inspect
them to ensure they do not contain threats or other undesirable traffic, and
then re-encrypt them before allowing the connection to proceed. (The decrypted
traffic goes through your access control policy and matches rules based on
inspected characteristics of the decrypted connection, not on the encrypted
characteristics.) This balances your need to apply access control policies with
the user’s need to protect sensitive information.

You can also configure SSL decryption rules to block encrypted traffic
of types you know you do not want on your network.

Keep in mind that decrypting and then re-encrypting traffic adds a
processing load on the device, which will reduce overall system performance.

### Actions You Can Apply to Encrypted Traffic

When configuring SSL decryption rules, you can apply the actions
described in the following topics. These actions are also available for the
default action, which applies to any traffic that does not match an explicit
rule.

| **Note** | ---   Any traffic that passes through the SSL decryption policy must then pass through the access control policy. Except for traffic you drop in the SSL decryption policy, the ultimate allow or drop decision rests with the access control policy.   --- |
| --- | --- |

* [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9)
* [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061)
* [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D)
* [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057)

#### Decrypt Re-Sign

If you elect to
decrypt and re-sign traffic, the system acts as a man-in-the-middle.

For example, the user
types in https://www.cisco.com in a browser. The traffic reaches the
threat
defense device, the device then negotiates with the user using the
CA certificate specified in the rule and builds an SSL tunnel between the user
and the
threat
defense device. At the same time the device connects to
https://www.cisco.com and creates an SSL tunnel between the server and the
threat
defense device.

Thus, the user sees
the CA certificate configured for the SSL decryption rule instead of the
certificate from www.cisco.com. The user must trust the certificate to complete
the connection. The
threat
defense device then performs decryption/re-encryption in both
directions for traffic between the user and destination server.

![Decryption using certificate re-signing.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420365.jpg)

| **Note** | ---   If the client does not trust the CA used to re-sign the server certificate, it warns the user that the certificate should not be trusted. To prevent this, import the CA certificate into the client trusted CA store. Alternatively, if your organization has a private PKI, you can issue an intermediate CA certificate signed by the root CA which is automatically trusted by all clients in the organization, then upload that CA certificate to the device.   --- |
| --- | --- |

If you configure a
rule with the Decrypt Re-Sign action, the rule matches traffic based on the
referenced internal CA certificate’s signature algorithm type, in addition to
any configured rule conditions. Because you can select a single re-sign
certificate for the SSL decryption policy, this can limit traffic matching for
resign rules.

For example, outgoing
traffic encrypted with an elliptic curve (EC) algorithm matches a Decrypt
Re-Sign rule only if the re-sign certificate is an EC-based CA certificate.
Similarly, traffic encrypted with an RSA algorithm matches Decrypt Re-Sign
rules only if the global re-sign certificate is RSA; outgoing traffic encrypted
with an EC algorithm does not match the rule, even if all other configured rule
conditions match.

#### Decrypt Known Key

If you own the
destination server, you can implement decryption with a known key. In this
case, when the user opens a connection to https://www.cisco.com, the user sees
the actual certificate for www.cisco.com, even though it is the
threat
defense device that is presenting the certificate.

![Decryption using known keys.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420366.jpg)

Your organization must
be the owner of the domain and certificate. For the example of cisco.com the
only possible way to have the end user see Cisco’s certificate would be if you
actually own the domain cisco.com (i.e. you are Cisco Systems) and have
ownership of the cisco.com certificate signed by a public CA. You can only
decrypt with known keys for sites that your organization owns.

The main purpose of
decrypting with a known key is to decrypt traffic heading to your HTTPS server
to protect your servers from external attacks. For inspecting client side
traffic to external HTTPS sites, you must use decrypt re-sign as you do not own
the servers.

| **Note** | ---   To use known key decryption, you must upload the server’s certificate and key as an internal identity certificate, and then add it to the list of known-key certificates in the SSL decryption policy settings. Then, you can write the rule for known-key decryption with the server’s address as the destination address. For information on adding the certificate to the SSL decryption policy, see [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA).   --- |
| --- | --- |

#### Do Not Decrypt

If you elect to bypass
decryption for certain types of traffic, no processing is done on the traffic.
The encrypted traffic proceeds to the access control policy, where it is
allowed or dropped based on the access control rule it matches.

#### Block

You can simply block
encrypted traffic that matches an SSL decryption rule. Blocking in the SSL
decryption policy prevents the connection from reaching the access control
policy.

When you block an
HTTPS connection, the user does not see the system default block response page.
Instead, the user sees the browser’s default page for a secure connection
failure. The error message does not indicate the site was blocked due to
policy. Instead, errors might indicate that there are no common encryption
algorithms. It will not be obvious from this message that you blocked the
connection on purpose.

### Automatically Generated SSL Decryption Rules

Whether you enable the
SSL decryption policy, the system automatically generates Decrypt Re-sign rules
for each identity policy rule that implements active authentication. This is
required to enable active authentication for HTTPS connections.

When you enable the
SSL decryption policy, you see these rules under the Identity Policy Active
Authentication Rules heading. These rules are grouped at the top of the SSL
decryption policy. The rules are read only. You can change them only by
altering your identity policy.

### Handling Undecryptable Traffic

There are several characteristics that make a connection undecryptable. If a connection has any of the following characteristics,
the default action is applied to the connection regardless of any rule the connection would otherwise match. If you select
Block as your default action (rather than Do Not Decrypt), you might run into issues, including excessive drops of legitimate
traffic. You can alter the default behavior, as explained in [Configure Advanced and Undecryptable Traffic Settings](#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06).

* Compressed
  session—Data compression was applied to the connection.
* SSLv2 session—The
  minimum supported SSL version is SSLv3.
* Unknown cipher
  suite—The system does not recognize the cipher suite for the connection.
* Unsupported cipher
  suite—The system does not support decryption based on the detected cipher
  suite.
* Session not
  cached—The SSL session has session reuse enabled, the client and server
  reestablished the session with the session identifier, and the system did not
  cache that session identifier.
* Handshake
  errors—An error occurred during the SSL handshake negotiation.
* Decryption
  errors—An error occurred during the decryption operation.
* Passive interface traffic—All traffic on passive interfaces (passive security zones) is undecryptable.

## License Requirements for SSL Decryption

You do not need a special license to use the SSL decryption policy.

However, you do need the URL license to create rules that use URL categories and reputations as match criteria. For information on configuring licenses,
see [Enabling or Disabling Optional Licenses](fptd-fdm-license.html#id_12247).

## Guidelines for SSL Decryption

Keep the following in
mind when configuring and monitoring SSL decryption policies:

* The SSL
  Decryption policy is bypassed for any connections that match access control
  rules set to trust or block if those rules:

  + Use security
    zone, network, geolocation, and port only as the traffic matching criteria.
  + Come before
    any other rules that require inspection, such as rules that match connections
    based on application or URL, or allow rules that apply intrusion or file
    inspection.
* When using URL category matching, note that there are cases where
  the login page for a site is in a different category than the site itself. For
  example, Gmail is in the “Web based email” category, whereas the login page is
  in the “Internet Portals” category. To get connections to these sites
  decrypted, you must include both categories in the rule.
* If a Vulnerability Database (VDB) update removes (deprecates) applications, you must make changes to any SSL decryption rules
  or application filters that use the application that was deleted. You cannot deploy changes until you fix these rules. In
  addition, you cannot install system software updates before fixing the issue. On the Application Filters object page, or the
  Application tab of the rule, these applications say “(Deprecated)” after the application name.
* You cannot disable the SSL decryption policy if you have any active authentication rules. To disable the SSL decryption policy,
  you must either disable the identity policy, or delete any identity rules that use active authentication.

## How to Implement and Maintain the SSL Decryption Policy

You can use SSL
decryption policies to turn encrypted traffic into plain text traffic, so that
you can then apply URL filtering, intrusion and malware control, and other
services that require deep packet inspection. If your policies allow the
traffic, the traffic is re-encrypted before it leaves the device.

The SSL decryption
policy applies to encrypted traffic only. No unencrypted connections are
evaluated against SSL decryption rules.

Unlike some other
security policies, you need to monitor and actively maintain the SSL decryption
policy, because certificates can expire or even be changed on destination
servers. Additionally, changes in client software might alter your ability to
decrypt certain connections, because the decrypt re-sign action is
indistinguishable from a man-in-the-middle attack.

The following
procedure explains the end-to-end process of implementing and maintaining the
SSL decryption policy.

### Procedure

---

| **Step 1** | If you will implement Decrypt Re-sign rules, create the required internal CA certificate.  You must use an internal Certificate Authority (CA) certificate. You have the following options. Because users must trust the certificate, either upload a certificate client browsers are already configured to trust, or ensure that the certificate you upload is added to the browser trust stores.   * Create a   self-signed internal CA certificate, which is signed by the device itself. See   [Generating Self-Signed Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_CB73ADE996FC43AF885ED0D4A5F83C97). * Upload an   internal CA certificate and key signed by an external trusted CA or by a CA   inside your organization. See   [Uploading Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_5CD7D9D1E8B3434AA5C550EF5497EF81). |
| --- | --- |
| **Step 2** | If you will implement Decrypt Known Key rules, collect the certificate and key from each of the internal servers.  You can use Decrypt Known Key only with servers that you control, because you must obtain the certificate and key from the server. Upload these certificates and keys as internal certificates (not internal CA certificates). See [Uploading Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_5CD7D9D1E8B3434AA5C550EF5497EF81). |
| **Step 3** | [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825).  When you enable the policy, you also configure some basic settings. |
| **Step 4** | [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316).  If in doubt, select Do Not Decrypt as the default action. Your access control policy can still drop traffic that matches the default SSL decryption rule if appropriate. |
| **Step 5** | [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB).  Identify traffic to decrypt and the type of decryption to apply. |
| **Step 6** | If you configure known key decryption, edit the SSL decryption policy settings to include those certificates. See [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA). |
| **Step 7** | If necessary, download the CA certificate used for Decrypt Re-sign rules and upload it to the browser on client workstations.  For information on downloading the certificate and distributing it to clients, see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 8** | Periodically, update re-sign and known key certificates.   * Re-sign certificate—Update this certificate before it expires. If you generate the certificate through the device   manager, it is valid for 5 years. To check the validity period for a certificate, select Objects > Certificates, find the certificate in the list, and click the information icon (View or info icon button.) for it in the Actions column. The information dialog box shows the validity period and some other characteristics. You can   also upload a replacement certificate from this page. * Known-key   certificate—For any known-key decryption rules, you need to ensure that you   have uploaded the destination server’s current certificate and key. Whenever   the certificate and key changes on supported servers, you must also upload the   new certificate and key (as an internal certificate) and update the SSL   decryption settings to use the new certificate. |
| **Step 9** | Upload missing trusted CA certificates for external servers.  The system includes a wide range of trusted CA root and intermediate certificates issued by third parties. These are needed when negotiating the connection between the threat defense and the destination servers for decrypt re-sign rules.  Upload all certificates within a root CA’s chain of trust to the list of trusted CA certificates, including the root CA certificate and all intermediate CA certificates. Otherwise, it is more difficult to detect trusted certificates issued by intermediate CAs. Upload certificates on the Objects > Certificates page. See [Uploading Trusted CA Certificates](fptd-fdm-certificates.html#task_CCECD443E93B4AE4B34CBA91BDF23013). |

---

## Configuring SSL Decryption Policies

You can use SSL
decryption policies to turn encrypted traffic into plain text traffic, so that
you can then apply URL filtering, intrusion and malware control, and other
services that require deep packet inspection. If your policies allow the
traffic, the traffic is re-encrypted before it leaves the device.

The SSL decryption
policy applies to encrypted traffic only. No unencrypted connections are
evaluated against SSL decryption rules.

| **Note** | ---   VPN tunnels are decrypted before the SSL decryption policy is evaluated, so the policy never applies to the tunnel itself. However, any encrypted connections within the tunnel are subject to evaluation by the SSL decryption policy.   --- |
| --- | --- |

The following
procedure explains how to configure the SSL decryption policy. For an
explanation of the end-to-end process of creating and managing SSL decryption,
see
[How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E).

### Before you begin

The SSL decryption
rules table contains two sections:

* Identity Policy Active
  Authentication Rules—If you enable the identity policy and create
  rules that use active authentication, the system automatically creates the SSL
  decryption rules needed to make those policies work. These rules are always
  evaluated before the SSL decryption rules you create yourself. You can alter
  these rules only indirectly, by making changes to the identity policy.
* SSL Native
  Rules—These are rules that you have configured. You can add rules
  to this section only.

### Procedure

---

| **Step 1** | Select Policies > SSL Decryption.  If you have not yet enabled the policy, click Enable SSL Decryption and configure policy settings, as described in [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825). |
| --- | --- |
| **Step 2** | Configure the default action for the policy.  The safest choice is Do Not Decrypt. For more information, see [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316). |
| **Step 3** | Manage the SSL decryption policy.  After you configure SSL decryption settings, this page lists all rules in order. Rules are matched against traffic from top to bottom with the first match determining the action to apply. You can do the following from this page:   * To disable   the policy, click the   SSL Decryption Policy toggle. You can re-enable it   by clicking   Enable SSL Decryption. * To edit policy settings, including the list of certificates used in the policy, click the SSL Decryption Settings button (Gear/Settings button.); see [Configure SSL Decryption Settings](#Cisco_Concept.dita_a8dbcdf0-6eb0-4ae3-bb1f-c833c58cb010). You can also download the certificate used with decrypt re-sign rules so that you can distribute it to clients. See the   following topics:    + [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)   + [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378) * To configure   rules:    + To     create a new rule, click the     + button. See     [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB).   + To edit     an existing rule, click the edit icon (edit icon)     for the rule (in the Actions column). You can also selectively edit a rule     property by clicking on the property in the table.   + To     delete a rule you no longer need, click the delete icon (delete icon)     for the rule (in the Actions column). * To move a   rule, edit it and select the new location from the   Order drop-down list. * If any rules have problems, for example, because of removed or changed URL categories, click the See Problem Rules link next to the search box to filter the table to show only those rules. Please edit and correct (or delete) these rules,   so that they will provide the service that you require. |

---

* [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825)
* [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316)
* [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB)
* [Configure SSL Decryption Settings](#Cisco_Concept.dita_a8dbcdf0-6eb0-4ae3-bb1f-c833c58cb010)
* [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378)

### Enable the SSL Decryption Policy

Before you can
configure SSL decryption rules, you must enable the policy and configure some
basic settings. The following procedure explains how to enable the policy
directly. You can also enable it when you enable identity policies. Identity
policies require that you enable the SSL decryption policy.

#### Before you begin

If you upgraded from
a release that did not have SSL decryption policies, but you had configured the
identity policy with active authentication rules, the SSL decryption policy is
already enabled. Ensure that you select the Decrypt Re-Sign certificate you
want to use, and optionally enable pre-defined rules.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click Enable SSL Decryption to configure the policy settings.   * If this is   the first time you enabled the policy, the SSL Decryption Configuration dialog   box opens. Proceed with the next steps. * If you have   already configured the policy once and then disabled it, the policy is simply   enabled again with your previous settings and rules. You can click the   SSL Decryption Settings button (Gear/Settings button.) and configure settings as described in   [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA). |
| **Step 3** | In Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create Internal CA to create it.  If you have not already installed the certificate in client browsers, click the download button (Download button.) to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 4** | (Optional.) Click + under Trusted CA Certificates and select the certificates or certificate groups that you want the policy to trust.  The default group, Cisco-Trusted-Authorities, includes all of the system-defined trusted CA certificates. If you uploaded additional certificates, you can add them here, or collect them in your own group and select the group here. You can either replace the Cisco-Trusted-Authorities group, or simply add your group. Users will be prompted to accept the certificate for any site whose certificate's signing authority is not represented in this list: access to the site is not blocked simply because the certificate is not trusted.  If you leave the list empty, or select only empty certificate groups, then the SSL decryption policy will trust any certificate. |
| **Step 5** | Select the initial SSL decryption rules.  The system includes the following pre-defined rule that you might find useful:   * Sensitive\_Data—This rule does not decrypt traffic   that matches web sites in the Financial Services or Health and Medicine URL   categories, which include banks, healthcare services, and so forth. You must   enable the URL license to implement this rule. |
| **Step 6** | Click Enable. |

---

### Configure the Default SSL Decryption Action

If an encrypted
connection does not match a specific SSL decryption rule, it is handled by the
default action for the SSL decryption policy.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click anywhere in the Default Action field. |
| **Step 3** | Select the action to apply to matching traffic.   * Do Not   Decrypt—Allow the encrypted connection. The access control policy   then evaluates the encrypted connection and drops or allows it based on access   control rules. * Block—Drop the   connection immediately. The connection is not passed on to the access control   policy. |
| **Step 4** | (Optional.) Configure logging for the default action.  You must enable logging for traffic that matches the default action to be included in dashboard data or Event Viewer. Select from these options:   * At End of   Connection—Generate an event at the conclusion of the connection.    + Send Connection Events To—If you want to send a copy     of the events to an external syslog server, select the server object that     defines the syslog server. If the required object does not already exist, click     Create New Syslog Server and create it. (To disable     logging to a syslog server, select     Any from the server list.)  Because     event storage on the device is limited, sending events to an external syslog     server can provide more long term storage and enhance your event analysis. * No Logging—Do not   generate any events. |
| **Step 5** | Click Save. |

---

### Configure SSL Decryption Rules

Use SSL decryption
rules to determine how to handle encrypted connections. Rules in the SSL
decryption policy are evaluated from top to bottom. The rule applied to traffic
is the first one where all the traffic criteria are matched.

You can create and
edit rules in the SSL Native Rules section only.

| **Note** | ---   Traffic for your VPN connections (both site-to-site and remote access) is decrypted before the SSL decryption policy evaluates connections. Thus, SSL decryption rules are never applied to VPN connections, and you do not need to consider VPN connections when creating these rules. However, any use of encrypted connections within a VPN tunnel are evaluated. For example, an HTTPS connection to an internal server through an RA VPN connection is evaluated by SSL decryption rules, even though the RA VPN tunnel itself is not (because it is decrypted already).   --- |
| --- | --- |

#### Before you begin

If you are
creating a decrypt known-key rule, ensure that you upload the certificate and
key for the destination server (as an internal certificate) and also edit the
SSL decryption policy settings to use the certificate. Known-key rules
typically specify the destination server in the destination network criteria of
the rule. For more information, see
[Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA).

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption.  If you have not configured any SSL decryption rules (other than the ones automatically generated for active authentication identity rules), you can add pre-defined rules by clicking Add Pre-Defined Rules. You are prompted to select the rules that you want. |
| --- | --- |
| **Step 2** | Do any of the following:   * To create a new rule, click   the   + button. * To edit an existing rule,   click the edit icon (edit icon)   for the rule.   To delete a rule you no longer need, click the delete icon (delete icon) for the rule. |
| **Step 3** | In Order, select where you want to insert the rule in the ordered list of rules.  You can insert rules into the SSL Native Rules section only. The Identity Policy Active Authentication Rules are automatically generated from your identity policy and are read-only.  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 4** | In Title, enter a name for the rule.  The name cannot contain spaces. You can use alphanumeric characters and these special characters: + . \_ - |
| **Step 5** | Select the action to apply to matching traffic.  For a detailed discussion of each option, see the following:   * [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9) * [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061) * [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D) * [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057) |
| **Step 6** | Define the traffic matching criteria using any combination of the following tabs:   * Source/Destination—The security zones (interfaces) through which the traffic passes, the IP addresses or the country or continent (geographical   location) for the IP address, or the TCP ports used in the traffic. The default is any zone, address, geographical location,   and TCP port. See [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B). * Application—The application, or a filter that defines applications by type, category, tag, risk, or business relevance. The default is   any encrypted application. See [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37). * URL—The URL   category of a web request. The default is that the URL category and reputation   are not considered for matching purposes. See   [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC). * Users—The identity source, user or user group. Your identity policies determine whether user and group information is available for traffic matching.   You must configure identity policies to use this criteria. See [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0). * Advanced—The   characteristics derived from the certificates used in the connection, such as   SSL/TLS version and certificate status. See   [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD).   To modify a condition, you click the + button within that condition, select the desired object or element, and click OK in the popup dialog box. If the criterion requires an object, you can click Create New Object if the object you require does not exist. Click the x for an object or element to remove it from the policy.  When adding conditions to SSL decryption rules, consider the following tips:   * You can   configure multiple conditions per rule. Traffic must match all the conditions   in the rule for the rule to apply to traffic. For example, you can use a single   rule to decrypt traffic based on URL category. * For each   condition in a rule, you can add up to 50 criteria. Traffic that matches any of   a condition's criteria satisfies the condition. For example, you can use a   single rule to apply application control for up to 50 applications or   application filters. Thus, there is an OR relationship among the items in a   single condition, but an AND relationship between condition types (for example,   between source/destination and application). * Matching URL category requires the URL filtering license. |
| **Step 7** | (Optional.) Configure logging for the rule.  You must enable logging for traffic that matches the rule to be included in dashboard data or Event Viewer. Select from these options:   * At End of   Connection—Generate an event at the conclusion of the connection.    + Send Connection Events To—If you want to send a copy     of the events to an external syslog server, select the server object that     defines the syslog server. If the required object does not already exist, click     Create New Syslog Server and create it. (To disable     logging to a syslog server, select Any from the server list.)  Because     event storage on the device is limited, sending events to an external syslog     server can provide more long term storage and enhance your event analysis. * No Logging—Do not   generate any events. |
| **Step 8** | Click OK. |

---

* [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B)
* [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37)
* [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC)
* [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0)
* [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD)

#### Source/Destination Criteria for SSL Decryption Rules

The Source/Destination
criteria of an SSL decryption rule define the security zones (interfaces)
through which the traffic passes, the IP addresses or the country or continent
(geographical location) for the IP address, or the TCP ports used in the
traffic. The default is any zone, address, geographical location, and any TCP
port. TCP is the only protocol matched to SSL decryption rules.

To modify a condition,
you click the
+ button within that condition, select the desired
object or element, and click
OK. If the criterion requires an object, you can
click
Create New
Object if the object you require does not
exist. Click the
x for an object or element to remove it from the
policy.

You can use the
following criteria to identify the source and destination to match in the rule.

Source Zones,
Destination Zones

The security
zone objects that define the interfaces through which the traffic passes. You
can define one, both, or neither criteria: any criteria not specified applies
to traffic on any interface.

* To match
  traffic leaving the device from an interface in the zone, add that zone to the
  Destination Zones.
* To match
  traffic entering the device from an interface in the zone, add that zone to the
  Source Zones.
* If you add
  both source and destination zone conditions to a rule, matching traffic must
  originate from one of the specified source zones and egress through one of the
  destination zones.

Use this
criteria when the rule should apply based on where the traffic enters or exits
the device. For example, if you want to ensure that all traffic going from
outside hosts to inside hosts gets decrypted, you would select your outside
zone as the
Source
Zones and your inside zone as the
Destination Zones.

Source Networks,
Destination Networks

The network
objects or geographical locations that define the network addresses or
locations of the traffic.

* To match
  traffic from an IP address or geographical location, configure the
  Source Networks.
* To match
  traffic to an IP address or geographical location, configure the
  Destination Networks.
* If you add
  both source and destination network conditions to a rule, matching traffic must
  originate from one of the specified IP addresses and be destined for one of the
  destination IP addresses.

When you add
this criteria, you select from the following tabs:

* Network—Select
  the network objects or groups that define the source or destination IP
  addresses for the traffic you want to control.

  | **Note** | ---   For Decrypt Known-Key rules, select an object with the IP address of the destination server that uses the certificate and key you uploaded.   --- |
  | --- | --- |
* Geolocation—Select the geographical location to
  control traffic based on its source or destination country or continent.
  Selecting a continent selects all countries within the continent. Besides
  selecting geographical location directly in the rule, you can also select a
  geolocation object that you created to define the location. Using geographical
  location, you could easily restrict access to a particular country without
  needing to know all of the potential IP addresses used there.

Source Ports,
Destination Ports/Protocols

The port objects
that define the protocols used in the traffic. You can specify TCP protocol and
ports only for SSL decryption rules.

* To match
  traffic from a TCP port, configure the
  Source Ports.
* To match
  traffic to a TCP port, configure the
  Destination Ports/Protocols.
* To match
  traffic both originating from specific TCP ports and destined for specific TCP
  ports, configure both. For example, you could target traffic from port TCP/80
  to port TCP/8080.

#### Application Criteria for SSL Decryption Rules

The Application
criteria of an SSL decryption rule defines the application used in an IP
connection, or a filter that defines applications by type, category, tag, risk,
or business relevance. The default is any application that has the SSL Protocol
tag. You cannot match SSL decryption rules to any non-encrypted application.

Although you can
specify individual applications in the rule, application filters simplify
policy creation and administration. For example, you could create an SSL
decryption rule that decrypts or blocks all high risk, low business relevance
applications. If a user attempts to use one of those applications, the session
is decrypted or blocked.

In addition, Cisco
frequently updates and adds additional application detectors via system and
vulnerability database (VDB) updates. Thus, a rule for high risk applications
can automatically apply to new applications without you having to update the
rule manually.

You can specify
applications and filters directly in the rule, or create application filter
objects that define those characteristics. The specifications are equivalent,
although using objects can make it easier to stay within the
50-items-per-criteria system limit if you are creating a complex rule.

To modify the
application and filters list, you click the
+ button within the condition, select the desired
applications or application filter objects, which are listed on separate tabs,
and click
OK in the popup dialog box. On either tab, you can
click
Advanced
Filter to select filter criteria or to help you search for specific
applications. Click the
x for an application, filter, or object to remove it
from the policy. Click the
Save As
Filter link to save the combined criteria that is not already an
object as a new application filter object.

For more information
about the application criteria and how to configure advanced filters and select
applications, see
[Configuring Application Filter Objects](fptd-fdm-objects.html#task_49CC5243743F4921AAF00CF6AB0264BE).

Consider the following
tips when using application criteria in SSL decryption rules.

* The system can
  identify unencrypted applications that become encrypted using StartTLS. This
  includes such applications as SMTPS, POPS, FTPS, TelnetS, and IMAPS. In
  addition, it can identify certain encrypted applications based on the Server
  Name Indication in the TLS ClientHello message, or the server certificate
  subject distinguished name value.
* The system can
  identify the application only after the server certificate exchange. If traffic
  exchanged during the SSL handshake matches all other conditions in an SSL rule
  containing an application condition but the identification is not complete, the
  SSL policy allows the packet to pass. This behavior allows the handshake to
  complete so that applications can be identified. After the system completes its
  identification, the system applies the SSL rule action to the remaining session
  traffic that matches its application condition.
* If a selected application was removed by a VDB update, “(Deprecated)” appears after the application name. You must remove
  these applications from the filter, or subsequent deployments and system software upgrades will be blocked.

#### URL Criteria for SSL Decryption Rules

The URL criteria of an
SSL decryption rule defines the category to which the URL in a web request
belongs. You can also specify the relative reputation of sites to decrypt,
block, or allow without decryption. The default is to not match connections
based on URL categories.

For example, you could block all encrypted Gambling sites, or decrypt untrusted Social Networking sites. If a user attempts to browse to any URL with that category and reputation combination, the session
is blocked or decrypted. For more information on URL category matching, see [Filtering URLs by Category and Reputation](fptd-fdm-access.html#concept_2190C5512921483CB9009A9FF5E3AE74).

Categories Tab

Click
+, select the desired categories, and click
OK. Click the
x for a category to remove it from the policy.

The default is
to apply the rule to all URLs in each selected category regardless of
reputation. To limit the rule based on reputation, click the down arrow for
each category, deselect the
Any checkbox, and then use the
Reputation slider to choose the reputation level.
The left of the reputation slider indicates sites that will be allowed without
decryption, the right side are sites that will be decrypted or blocked. How
reputation is used depends on the rule action:

* If the rule decrypts or blocks connections, selecting a reputation level also selects all reputations more severe than that
  level. For example, if you configure a rule to decrypt or block Questionable sites (level 2), it also automatically decrypts or blocks Untrusted (level 1) sites.
* If the rule allows connections without decryption (do not decrypt), selecting a reputation level also selects all reputations
  less severe than that level. For example, if you configure a rule to not decrypt Favorable sites (level 4), it also automatically does not decrypt Trusted (level 5) sites.

Select the Include Sites with
Unknown Reputation option to have URLs with unknown
reputation included in the reputation match. New sites typically are
unrated, and there can be other reasons a site's reputation is unknown or
cannot be determined.

Check the Category for a URL

You can check on the category and reputation for a particular URL. Enter the URL in the URL to Check box and click Go. You will be taken to an external website to see the results. If you disagree with a categorization, click the Submit a URL Category Dispute link and let us know.

#### User Criteria for SSL Decryption Rules

The User criteria of
an SSL decryption rule defines the user or user group for an IP connection. You
must configure identity policies and the associated directory server to include
user or user group criteria in a rule.

Your identity policies
determine whether user identity is collected for a particular connection. If
identity is established, the IP address of the host is associated with the
identified user. Thus, traffic whose source IP address is mapped to a user is
considered to be from that user. IP packets themselves do not include user
identity information, so this IP-address-to-user mapping is the best
approximation available.

Because you can add a maximum of 50 users or groups to a rule, selecting groups usually makes more sense than selecting individual
users. For example, you could create a rule that decrypts traffic to the Engineering group that comes from the outside network,
and create a separate rule that does not decrypt outgoing traffic from that group. Then, to make the rule apply to new engineers,
you only need to add the engineer to the Engineering group in the directory server.

You an also select identity sources to apply to all users within that source. Thus, if you support multiple Active Directory
domains, you can provide differential decryption based on the domain.

To modify the users
list, you click the
+ button within the condition and select the desired
users or user groups using one of the following techniques. Click the
x for a user or group to remove it from the policy.

* Identity Sources—Select an identity source, such as an AD realm or the local user database, to apply the rule to all users obtained from the
  selected sources. If the realm you need does not yet exist, click Create New Identity Realm and create it now.
* Groups—Select the desired user groups. Groups are available only if you configure groups in the directory server. If you select
  a group, the rule applies to any member of the group, including subgroups. If you want to treat a sub-group differently, you
  need to create a separate access rule for the sub-group and place it above the rule for the parent group in the access control
  policy.
* Users—Select individual users. The user name is prefixed with the identity source, such as Realm\username.

  There are some built-in users under the Special-Identities-Realm:

  + Failed
    Authentication—The user was prompted to authenticate, but failed to
    enter a valid username/password pair within the maximum number of allowed
    attempts. Failure to authenticate does not itself prevent the user from
    accessing the network, but you can write an access rule to limit network access
    for these users.
  + Guest—Guest users
    are like Failed Authentication users, except that your identity rule is
    configured to call these users Guest. Guest users were prompted to authenticate
    and failed to do so within the maximum number of attempts.
  + No Authentication
    Required—The user was not prompted to authentication, because the
    user's connections matched identity rules that specified no authentication.
  + Unknown—There is
    no user mapping for the IP address, and there is no record of failed
    authentication yet. Typically, this means that no HTTP traffic has yet been
    seen from that address.

#### Advanced Criteria for SSL Decryption Rules

The Advanced traffic
matching criteria relate to characteristics derived from the certificates used
in the connection. You can configure any or all of the following options.

Certificate
Properties

Traffic matches
the certificate properties option of the rule if it matches any of the selected
properties. You can configure the following:

Certificate
Status

Whether
the certificate is
Valid or
Invalid. Select
Any (the default) if you do not care about
certificate status.

A
certificate is considered valid if all of the following conditions are met,
otherwise it is invalid:

* The
  policy trusts the CA that issued the certificate.
* The
  certificate’s signature can be properly validated against the certificate’s
  content.
* The
  issuer CA certificate is stored in the policy’s list of trusted CA
  certificates.
* None
  of the policy’s trusted CAs revoked the certificate.
* The
  current date is between the certificate Valid From and Valid To dates.

Self-Signed

Whether
the server certificate contains the same subject and issuer distinguished name.
Select one of the following:

* Self-Signing—The server
  certificate is self-signed.
* CA-Signing—The server certificate
  is signed by a Certificate Authority. That is, the issuer and subject are not
  the same.
* Any—Do not consider whether the
  certificate is self-signed as a match criteria.

Supported Version

The SSL/TLS version to match. The rule applies to traffic that uses the any of the selected
versions only. The default is all versions. Select from: SSL
3.0, TLS 1.0, TLS
1.1, TLS 1.2, TLS 1.3.

For example, if you wanted to permit TLSv1.2/3
connections only, you could create a block rule for the lower versions.

You must be using Snort 3 to match TLS 1.3 connections.

Traffic that
uses any version not listed, such as SSL v2.0, is handled by the default action
for the SSL decryption policy.

### Configure SSL Decryption Settings

You must configure the certificate settings if you have any rules that decrypt traffic. You can also modify settings to change
how decryption is applied to encrypted traffic. The following topics explain the options.

* [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)
* [Configure Advanced and Undecryptable Traffic Settings](#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06)

#### Configure Certificates for Known Key and Re-Sign Decryption

If you implement
decryption, either by re-signing or using known keys, you need to identify the
certificates that the SSL decryption rules can use. Ensure that all
certificates are valid and unexpired.

Especially for
known-key decryption, you need to ensure that the system has the current
certificate and key for each destination server whose connections you are
decrypting. With a decrypt known key rule, you use the actual certificate and
key from the destination server for decryption. Thus, you must ensure that the
threat
defense device has the current certificate and key at all times, or
decryption will be unsuccessful.

Upload a new
internal certificate and key whenever you change the certificate or key on the
destination server in a known key rule. Upload them as an internal certificate
(not an internal CA certificate). You can upload the certificate during the
following procedure, or go to the
Objects > Certificates page and upload it there.

##### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the SSL Decryption Settings button (Gear/Settings button.).  If necessary, select the Basic tab. |
| **Step 3** | In Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create Internal CA to create it.  If you have not already installed the certificate in client browsers, click the download button (Download button.) to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 4** | For each rule that decrypts using a known key, upload the internal certificate and key for the destination server.   1. Click    + under    Decrypt Known-Key Certificates. 2. Select the    internal identity certificate, or click    Create New Internal Certificate to upload it now. 3. Click    OK. |
| **Step 5** | (Optional.) Click + under Trusted CA Certificates and select the certificates or certificate groups that you want the policy to trust.  The default group, Cisco-Trusted-Authorities, includes all of the system-defined trusted CA certificates. Following are the main cases where you might want to change this setting:   * You want to use trusted CA certificates that are not in the default group. You would then   select both the default group and your new group in the SSL   decryption policy settings. You might do this if you have uploaded   additional trusted CA certificates. * You want to use a more limited list of trusted CA certificates than what is in the default   group. You would then create a group that has a complete list of   trusted certificates, not just your delta, and select it as the sole   group in the SSL decryption policy settings.   Users will be prompted to accept the certificate for any site whose certificate's signing authority is not represented in this list: access to the site is not blocked simply because the certificate is not trusted.  If you leave the list empty, or select only empty certificate groups, then the SSL decryption policy will trust any certificate. |
| **Step 6** | Click Save. |

---

#### Configure Advanced and Undecryptable Traffic Settings

You can configure advanced decryption settings, and settings for undecryptable traffic, if you do not want to use the default
behavior.

##### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the SSL Decryption Settings button (Gear/Settings button.). |
| **Step 3** | On the Advanced tab, select whether to enable TLS 1.3 Decryption.  If you enable TLS 1.3 decryption, you must also select the TLS 1.3 option on the advanced tab of each rule that should apply to TLS 1.3. You must be running Snort 3 to decrypt TLS 1.3. |
| **Step 4** | On the Undecryptable Actions tab, modify how the system handles connections that match rules that implement decryption, but for the cases where the connection cannot be decrypted.  The default is to apply the same action as the default action to these connections. The exception is decryption errors, for which your options are to block or block with reset only.  For descriptions of these categories, see [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810). |
| **Step 5** | Click OK. |

---

### Downloading the CA Certificate for Decrypt Re-Sign Rules

If you decide to
decrypt traffic, users must have the internal CA certificate that is used in
the encryption process defined as a Trusted Root Certificate Authority in their
applications that use TLS/SSL. Typically if you generate a certificate, or
sometimes even if you import one, the certificate is not already defined as
trusted in these applications. By default in most web browsers, when users send
HTTPS requests, they will see a warning message from the client application
informing them that there is a problem with the web site’s security
certificate. Usually, the error message says that the web site’s security
certificate was not issued by a trusted certificate authority or the web site
was certified by an unknown authority, but the warning might also suggest there
is a possible man-in-the-middle attack in progress. Some other client
applications do not show this warning message to users nor allow users to
accept the unrecognized certificate.

You have the
following options for providing users with the required certificate:

Inform users to
accept the root certificate

You can inform
the users in your organization what the new policies are at the company and
tell them to accept the root certificate supplied by the organization as a
trusted source. Users should accept the certificate and save it in the Trusted
Root Certificate Authority storage area so that they are not prompted again the
next time they access the site.

| **Note** | ---   The user needs to accept and trust the CA certificate that created the replacement certificate. If they instead simply trust the replacement server certificate, they will continue to see warnings for each different HTTPS site that they visit.   --- |
| --- | --- |

Add the root certificate to client devices

You can add the root certificate to all client devices on the network as a trusted root certificate authority. This way, the
client applications automatically accept transactions with the root certificate.

You can either
make the certificate available to users by E-mailing it or placing it on a
shared site, or you could incorporate the certificate into your corporate
workstation image and use your application update facilities to distribute it
automatically to users.

The following
procedure explains how to download the internal CA certificate and install it
on Windows clients.

#### Procedure

---

| **Step 1** | Download the certificate from the device manager.   1. Select Policies > SSL Decryption. 2. Click the SSL Decryption Settings button (Gear/Settings button.). 3. Click the Download button (Download button.). 4. Select a download location, optionally change the file name (but not the extension), and click Save.  You can now cancel out of the SSL Decryption Settings dialog box. |
| --- | --- |
| **Step 2** | Install the certificate in the Trusted Root Certificate Authority storage area in web browsers on client systems, or make it available for clients to install themselves.  The process differs depending on the operating system and type of browser. For example, you can use the following process for Internet Explorer and Chrome running on Windows. (For Firefox, install through the Tools > Options > Advanced page.)   1. From the    Start menu, select    Control    Panel > Internet Options. 2. Select the    Content tab. 3. Click the    Certificates button to open the Certificates dialog    box. 4. Select the    Trusted Root Certificate Authorities tab. 5. Click    Import, and follow the wizard to locate and select    the downloaded file (<uuid>\_internalCA.crt) and add it to the Trusted    Root Certificate Authorities store. 6. Click    Finish.  Messages    should indicate that the import was successful. You might see an intermediate    dialog box warning you that Windows could not validate the certificate if you    generated a self-signed certificate rather than obtaining one from a well-known    third-party Certificate Authority.  You can now    close out the Certificate and Internet Options dialog boxes. |

---

## Example: Blocking Older SSL/TLS Versions from the Network

Some organizations are required to prevent the use of older versions of SSL or TLS either by government regulation or company
policy. You can use the SSL Decryption policy to block traffic that uses an SSL/TLS version that you prohibit. Consider placing
this rule at the top of the SSL Decryption policy to ensure that you catch the prohibited traffic immediately.

The following example blocks all SSL 3.0 and TLS 1.0 connections.

### Before you begin

This procedure assumes you have already enabled the SSL Decryption policy as explained in [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825).

### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the + button to create a new rule. |
| **Step 3** | In Order, select 1 to place the rule at the top of the policy, or select the number most suitable for your network.  The default is to add the rule at the end of the policy. |
| **Step 4** | In Title, enter a name for the rule, for example, Block\_SSL3.0\_and\_TLS1.0. |
| **Step 5** | In Action, select Block. This will immediately drop any traffic that matches the rule. |
| **Step 6** | Leave the default values for all options on the following tabs: Source/Destination, Applications, URLs, Users. |
| **Step 7** | Click the Advanced tab and under Supported Versions, leave SSL 3.0 and TLS 1.0 selected, but uncheck TLS 1.1, TLS 1.2, TLS 1.3. |
| **Step 8** | (Optional) Click the Logging tab and select At End of Connection if you want to dashboards and events to reflect blocked connections. You can also select an external syslog server if you are using one. |
| **Step 9** | Click OK.  You can now deploy the policy. Once deployed, any SSL 3.0 or TLS 1.0 connection that goes through the system will be dropped.   | **Note** | SSL 2.0 connections are handled by the default action for the policy. If you want to ensure these are also dropped, change the default action to Block. | | --- | --- | |

---

### What to do next

If you implement this rule, we have the following recommendations:

* For any type of decrypt rule, leave the default settings on the Advanced tab, where all SSL/TLS options are selected. By applying
  to all versions, the handshake process is simplified. However, your initial block rule will still prevent SSL 3.0 and TLS
  1.0 connections.
* We normally recommend that you use Do Not Decrypt as the default action for the policy. However, because SSL 2.0 connections
  are always handled by the default action, you might want to use Block instead. However, if you want to apply Do Not Decrypt
  as the default action for all decryptable traffic, create a Do Not Decrypt rule at the end of the policy where you accept
  all default values for traffic matching criteria. This rule would match any supported TLS connection that does not match an
  earlier rule in the table, and act as the default for those TLS versions.

## Monitoring and Troubleshooting SSL Decryption

The following topics explain how to
monitor and troubleshoot SSL decryption policies.

* [Monitoring SSL Decryption](#concept_F6B5C308790C43ABA150C8E3F937A71C)
* [Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)](#concept_9CE017AD0A384BB581E3EFB7CBC76573)

### Monitoring SSL Decryption

You can view
information about decryption in the dashboards and events for traffic that
matches rules (or the default action) for which you enabled logging.

#### SSL Decryption Dashboard

To evaluate overall
decryption statistics, view the
Monitoring > SSL
Decryption dashboard. The dashboard shows the
following information:

* Percentage of
  encrypted versus plain text traffic.
* How much
  encrypted traffic is decrypted per SSL rules.

#### Events

In addition to the
dashboard, the event viewer (Monitoring > Events) includes SSL information for
encrypted traffic. Following are some tips in evaluating events:

* For connections
  that were dropped because they matched an SSL rule (or default action) that
  blocked matching traffic, the
  Action should be “Block,” and the
  Reason should indicate “SSL Block.”
* The
  SSL
  Actual Action field indicates the actual action that the system
  applied to the connection. This can differ from the
  SSL
  Expected Action, which indicates the action defined on the matching
  rule. For example, a connection might match a rule that applies decryption, but
  could not be decrypted for some reason.

### Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)

Some apps for smart phones and other devices use a technique called SSL (or Certificate Authority) pinning. The SSL pinning
technique embeds the hash of the original server certificate inside the app itself. As a result, when the app receives the
resigned certificate from the threat
defense device, the hash validation fails and the connection is aborted.

The primary symptom is that users cannot connect to the web site using
the site’s app, but they can connect using the web browser, even when using the
browser on the same device where the app fails. For example, users cannot use
the Facebook iOS or Android app, but they can point Safari or Chrome at
https://www.facebook.com and make a successful connection.

Because SSL pinning is specifically used to avoid man-in-the-middle
attacks, there is no workaround. You must choose between the following options:

* Support app users, in which case you cannot decrypt any traffic to
  the site. Create a Do Not Decrypt rule for the site’s application (on the
  Application tab for the SSL Decryption rule) and ensure that the rule comes
  before any Decrypt Re-sign rule that would apply to the connections.
* Force users to use browsers only. If you must decrypt traffic to the
  site, you will need to inform users that they cannot use the site’s app when
  connecting through your network, that they must use their browsers only.

#### More Details

If a site works in a browser but not in an app on the same device, you
are almost certainly looking at an instance of SSL pinning. However, if you
want to delve deeper, you can use connection events to identify SSL pinning in
addition to the browser test.

There are two ways an app might deal with hash validation failures:

* Group 1 apps, such as Facebook, send an SSL ALERT Message as soon
  as it receives the SH, CERT, SHD message from the server. The Alert is usually
  an “Unknown CA (48)” alert indicating SSL Pinning. A TCP Reset is sent
  following the Alert message. You should see the following symptoms in the event
  details:

  + SSL Flow Flags include ALERT\_SEEN.
  + SSL Flow Flags do not include APP\_DATA\_C2S or APP\_DATA\_S2C.
  + SSL Flow Messages typically are: CLIENT\_HELLO, SERVER\_HELLO,
    SERVER\_CERTIFICATE, SERVER\_KEY\_EXCHANGE, SERVER\_HELLO\_DONE.
* Group 2 apps, such as Dropbox, do not send any alerts. Instead
  they wait until the handshake is done and then send a TCP Reset. You should see
  the following symptoms in the event:

  + SSL Flow Flags do not include ALERT\_SEEN, APP\_DATA\_C2S, or
    APP\_DATA\_S2C.
  + SSL Flow Messages typically are: CLIENT\_HELLO, SERVER\_HELLO,
    SERVER\_CERTIFICATE, SERVER\_KEY\_EXCHANGE, SERVER\_HELLO\_DONE,
    CLIENT\_KEY\_EXCHANGE, CLIENT\_CHANGE\_CIPHER\_SPEC, CLIENT\_FINISHED,
    SERVER\_CHANGE\_CIPHER\_SPEC, SERVER\_FINISHED.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_cf985588_20250115_123426.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

#### Cisco Security

# Cisco Security Advisories

 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
- Vulnerabilities
- Filter By Product

 Quick Search

 [*Advanced Search*](/security/center/Search.x)

| Advisory | Impact | CVE | Last Updated | Version |
| --- | --- | --- | --- | --- |
|  | {{SeverityDrpDwnValue}}   All   Critical   High   Medium   Low   Informational  Done |  | Most Recent 2025 Jan 2024 Dec 2024 Nov 2024 Oct 2024 Sep 2024 Aug 2024 Jul 2024 Jun 2024 May 2024 Apr 2024 Mar 2024 Feb |  |
|
 | [{{list.title}}](%7B%7Blist.url%7D%7D) | {{list.severity}}-- | ...  {{list.cve}} | {{list.lastPublished | date :'yyyy MMM dd' : 'UTC'}} | {{list.version}} {{list.version+'.0'}} | | --- | --- | --- | --- | --- | | CVE:      ...  {{list.cve}}       Publication ID:{{ list.identifier }}  Version: {{list.version}} {{list.version+'.0'}}  First Published:{{ list.firstPublished | date :'yyyy MMM dd HH:mm' : 'UTC'}} GMT   Workaround:{{ list.workarounds }}  Affects Cisco Products:{{ list.affectedCiscoProducts }}No   Summary: | | | | | | | | | |
| {{message}} | | | | |
| Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }} | | | | |
| --- | --- | --- | --- | --- |
| Items per page:   Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }}   |  < Prev  {{opt}}   Next > | | | | |

### Select at least one checkbox to view vulnerabilities that affect Cisco products

 Remove All

 [*Advanced Search*](/security/center/Search.x)
Add a Product

 [*Advanced Search*](/security/center/Search.x)

| Advisory | Impact | CVE | Last Updated | Version |
| --- | --- | --- | --- | --- |
|  | {{prdFltrSvrDrpDwnValue}}   All   Critical   High   Medium   Low   Informational  Done |  | Most Recent 2025 Jan 2024 Dec 2024 Nov 2024 Oct 2024 Sep 2024 Aug 2024 Jul 2024 Jun 2024 May 2024 Apr 2024 Mar 2024 Feb |  |
| | [{{list.title}}](%7B%7Blist.url%7D%7D) | {{list.severity}}-- | ...  {{list.cve}} | {{list.lastPublished | date :'yyyy MMM dd' : 'UTC' }} | {{list.version}} {{list.version+'.0'}} | | --- | --- | --- | --- | --- | | CVE:      ...  {{list.cve}}       Publication ID:{{ list.identifier }}  Version: {{list.version}} {{list.version+'.0'}}  First Published:{{ list.firstPublished | date :'yyyy MMM dd HH:mm' : 'UTC' }} GMT   Workaround:{{ list.workarounds }}  Affects Cisco Products:{{ list.affectedCiscoProducts }}No   Summary: | | | | | | | | | |
| {{message}} | | | | |
| Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }} | | | | |
| --- | --- | --- | --- | --- |
| Items per page:   Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }}   |  < Prev  {{opt}}   Next > | | | | |

### Add a product to see all related advisories

##### Do you really want to delete all products?

 OK
 Cancel

To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy.](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html) This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.

Cisco Security Advisories and other Cisco security content are provided on an "as is" basis and do not imply any kind of guarantee or warranty. Your use of the information in these publications or linked material is at your own risk. Cisco reserves the right to change or update this content without notice at any time.

![](https://sec.cloudapps.cisco.com/security/center/Resources/images/on.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/off.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/trash-can.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/trash-can-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/searchtag-icon-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/searchtag-clear-icon-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-dark-down.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-dark-up.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/delete-icon.png)

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)



=== Content from www.cisco.com_4837fffe_20250115_123428.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [Install and Upgrade Guides](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/products-installation-guides-list.html)
# Cisco Secure Firewall ASA Upgrade Guide

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Planning Your Upgrade](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html)
* [Upgrade the ASA](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/asa-appliance-asav.html)
* [Downgrade the ASA](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/downgrade.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall ASA Upgrade Guide Chapter Title Planning Your Upgrade

* [PDF - Complete Book
  (2.92 MB)](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade.pdf)
  [PDF - This Chapter (1.45 MB)](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: September 6, 2024

## Chapter: Planning Your Upgrade

Chapter Contents

* [Planning Your Upgrade](#id_58684)
* [Important Guidelines Before You Upgrade](#id_58681)
  + [ASA Upgrade Guidelines](#id_47465)
    - [Version-Specific Guidelines and Migrations](#id_28407)
      * [9.22 Guidelines](#reference_vhz_k1p_2bc)
      * [9.20 Guidelines](#reference_sg1_cfr_ryb)
      * [9.19 Guidelines](#reference_ufy_bvb_w5b)
      * [9.18 Guidelines](#reference_jt1_mnq_3tb)
      * [9.17 Guidelines](#reference_atw_r5v_wpb)
      * [9.16 Guidelines](#reference_ljp_k1w_wpb)
      * [9.15 Guidelines](#reference_rql_v5v_wpb)
      * [9.14 Guidelines](#reference_dsk_w5v_wpb)
      * [9.13 Guidelines](#reference_ecm_x5v_wpb)
      * [9.12 Guidelines](#reference_qql_gyg_kgb)
      * [9.10 Guidelines](#reference_pgh_5q1_sgb)
      * [9.9 Guidelines](#reference_djr_jcy_1cb)
      * [9.8 Guidelines](#reference_xp4_bhv_zz)
      * [9.7 Guidelines](#id_28718)
      * [9.6 Guidelines](#id_28718)
      * [9.5 Guidelines and Migration](#id_28718)
      * [9.4 Guidelines and Migration](#id_28718)
        + [9.3 Guidelines and Migration](#id_47473)
        + [9.2 Guidelines and Migration](#reference_nxf_5ts_bz)
          - [9.1 Guidelines and Migration](#reference_rkb_zm1_cz)
          - [9.0 Guidelines and Migration](#reference_ckl_4n1_cz)
          - [8.4 Guidelines and Migration](#reference_v1n_h41_cz)
          - [8.3 Guidelines and Migration](#reference_xvt_541_cz)
* [Clustering Guidelines](#id_47469)
* [Failover Guidelines](#id_47468)
* [Additional Guidelines](#id_30935)

- [FXOS Upgrade Guidelines](#concept_svt_h1k_ddb)
- [ASA Upgrade Checklist](#id_59005)
- [Compatibility](#id_59003)
  * [ASA and ASDM Compatibility Per Model](#id_59039)
    + [ASA 9.20 and 9.19](#reference_xy4_5xz_l5b)
    + [ASA 9.18 to 9.17](#reference_ncw_ppb_fxb)
    + [ASA 9.16 to 9.15](#reference_upj_nkl_x4b)
    + [ASA 9.14 to 9.13](#reference_ftp_45n_nhb)
    + [ASA 9.12 to 9.5](#id_59423)
  * [Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)
  * [Radware DefensePro Compatibility](#id_59121)
- [Upgrade Path](#id_58680)
  * [Upgrade Path: ASA Appliances](#ID-2152-0000000a)
  * [Upgrade Path: ASA on Firepower 2100 in Platform Mode](#asa-on-firepower-2100-in-platform-mode-upgrade-path)
  * [Upgrade Path: ASA Logical Devices for the Firepower 4100/9300](#Cisco_Reference.dita_d121649b-6d91-4619-b00d-bd1faefaa6fa)
- [Download the Software from Cisco.com](#id_58682)
  * [Download ASA Software](#ID-2152-0000008d)
  * [Download FXOS for the Firepower 4100/9300](#ID-2152-0000008d)
- [Back Up Your Configurations](#id_58690)
Close

# Planning Your Upgrade

Before upgrading the Secure Firewall ASA, you should perform the following preparation:

* Check the upgrade path for the current version to the target version; ensure you plan for any intermediate versions required
  for each operating system.
* Check for guidelines and limitations that affect your intermediate and target versions, or that affect failover and clustering
  zero downtime upgrading.
* Download all software packages required from Cisco.com.
* Back up your configurations, especially if there is a configuration migration.

The following topics explain how to upgrade your ASA.

* [Important Guidelines Before You Upgrade](#id_58681)
* [ASA Upgrade Checklist](#id_59005)
* [Compatibility](#id_59003)
* [Upgrade Path](#id_58680)
* [Download the Software from Cisco.com](#id_58682)
* [Back Up Your Configurations](#id_58690)

## Important Guidelines Before You Upgrade

Check for upgrade guidelines and limitations, and configuration migrations for each operating system.

* [ASA Upgrade Guidelines](#id_47465)
* [FXOS Upgrade Guidelines](#concept_svt_h1k_ddb)

### ASA Upgrade Guidelines

Before you upgrade, check for migrations and any other guidelines.

* [Version-Specific Guidelines and Migrations](#id_28407)
* [Clustering Guidelines](#id_47469)
* [Failover Guidelines](#id_47468)
* [Additional Guidelines](#id_30935)

#### Version-Specific Guidelines and Migrations

Depending on your current version, you might experience one or more configuration migrations, and have to consider configuration
guidelines for all versions between the starting version and the ending version when you upgrade.

* [9.22 Guidelines](#reference_vhz_k1p_2bc)
* [9.20 Guidelines](#reference_sg1_cfr_ryb)
* [9.19 Guidelines](#reference_ufy_bvb_w5b)
* [9.18 Guidelines](#reference_jt1_mnq_3tb)
* [9.17 Guidelines](#reference_atw_r5v_wpb)
* [9.16 Guidelines](#reference_ljp_k1w_wpb)
* [9.15 Guidelines](#reference_rql_v5v_wpb)
* [9.14 Guidelines](#reference_dsk_w5v_wpb)
* [9.13 Guidelines](#reference_ecm_x5v_wpb)
* [9.12 Guidelines](#reference_qql_gyg_kgb)
* [9.10 Guidelines](#reference_pgh_5q1_sgb)
* [9.9 Guidelines](#reference_djr_jcy_1cb)
* [9.8 Guidelines](#reference_xp4_bhv_zz)
* [9.7 Guidelines](#id_28718)
* [9.6 Guidelines](#id_28718)
* [9.5 Guidelines and Migration](#id_28718)
* [9.4 Guidelines and Migration](#id_28718)
* [9.3 Guidelines and Migration](#id_47473)
* [9.2 Guidelines and Migration](#reference_nxf_5ts_bz)
* [9.1 Guidelines and Migration](#reference_rkb_zm1_cz)
* [9.0 Guidelines and Migration](#reference_ckl_4n1_cz)
* [8.4 Guidelines and Migration](#reference_v1n_h41_cz)
* [8.3 Guidelines and Migration](#reference_xvt_541_cz)

##### 9.22 Guidelines

* **Smart licensing default transport changed in 9.22**—In 9.22, the smart licensing
  default transport changed from Smart Call Home to Smart Transport. You can
  configure the ASA to use Smart Call Home if necessary using the
  transport type callhome  command. When you
  upgrade to 9.22, the transport is automatically changed Smart Transport. If
  you downgrade, the transport is set back to Smart Call Home, and if you want
  to use Smart Transport, you need to specify transport type
  smart .

##### 9.20 Guidelines

* **OSPF redistribute commands that specify a route-map that matches a
  prefix-list will be removed in 9.20(2)**—When you upgrade to 9.20(2),
  OSPF **redistribute** commands where the specified **route-map** uses
  a **match ip address prefix-list** will be removed from the
  configuration. Although prefix lists have never been supported, the parser
  still accepted the command. Before upgrading, you should reconfigure OSPF to
  use route maps that specify an ACL in the **match ip address** command.

##### 9.19 Guidelines

* **ASDM 7.19(1) requires Oracle Java version 8u261 or later**—Before you
  upgrade to ASDM 7.19, be sure to update Oracle Java (if used) to version
  8u261 or later. This version supports TLSv1.3, which is required to upgrade
  the ASDM Launcher. OpenJRE is not affected.

##### 9.18 Guidelines

* **ASDM signed-image support in 9.18(2)/7.18(1.152) and later**—The ASA now validates
  whether the ASDM image is a Cisco digitally signed image. If you try to run
  an older ASDM image with an ASA version with this fix, ASDM will be blocked
  and the message “%ERROR: Signature not valid for file disk0:/<filename>”
  will be displayed at the ASA CLI. ASDM release 7.18(1.152) and later are
  backwards compatible with all ASA versions, even those without this fix.
  ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **9.18(1) upgrade issue if you enabled HTTPS/ASDM (with HTTPS authentication) and SSL on
  the same interface with the same port**—If you enable both SSL
  (**webvpn** > **enable**
  *interface*) and HTTPS/ASDM (http ) access on
  the same interface, you can access AnyConnect from
  **https://***ip\_address* and ASDM from
  **https://***ip\_address***/admin**, both on port 443.
  However, if you also enable HTTPS authentication (**aaa authentication http
  console**), then you must specify a different port for ASDM access
  starting in 9.18(1). Make sure you change the port before you upgrade using
  the http  command. ([CSCvz92016](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz92016))
* **ASDM Upgrade Wizard**—Due to ASD API migration, you must use ASDM 7.18 or later to
  upgrade to ASA 9.18 or later. Because ASDM is backwards compatible with
  earlier ASA versions, you can upgrade ASDM to 7.18 or later for any ASA
  version.

##### 9.17 Guidelines

* **ASDM signed-image support in 9.17(1.13)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **No support for Clientless SSL VPN in 9.17(1) and later**—Clientless SSL VPN is no
  longer supported.

  + **webvpn**—The following subcommands are removed:

    - **apcf**
    - **java-trustpoint**
    - **onscreen-keyboard**
    - **port-forward**
    - **portal-access-rule**
    - **rewrite**
    - **smart-tunnel**
  + **group-policy webvpn**—The following subcommands are removed:

    - **port-forward**
    - **smart-tunnel**
    - **ssl-clientless**
* **ASDM Upgrade Wizard**—Due to an internal change, starting in March 2022 the upgrade
  wizard will no longer work with pre-ASDM 7.17(1.152) versions. You must
  manually upgrade to 7.17(1.152) to use the wizard.

##### 9.16 Guidelines

* **ASDM signed-image support in 9.16(3.19)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **SNMPv3 users using MD5 hashing and DES encryption are no longer supported, and the users
  will be removed when you upgrade to 9.16(1)**—Be sure to change any
  user configuration to higher security algorithms using the
  snmp-server user  command before you
  upgrade.
* **SSH host key action required in 9.16(1)**—In addition to RSA, we added
  support for the EDDSA and ECDSA host keys for SSH. The ASA tries to use keys
  in the following order if they exist: EDDSA, ECDSA, and then RSA. When you
  upgrade to 9.16(1), the ASA will fall back to using the existing RSA key.
  However, we recommend that you generate higher-security keys as soon as
  possible using the crypto key generate {eddsa |
  ecdsa}  command. Moreover, if you explicitly
  configure the ASA to use the RSA key with the ssh key-exchange
  hostkey rsa  command, you must generate a key that is
  2048 bits or higher. For upgrade compatibility, the ASA will use smaller RSA
  host keys only when the default host key setting is used. RSA support will
  be removed in a later release.
* **In 9.16 and later, certificates with RSA keys are not compatible with
  ECDSA ciphers**—When you use the ECDHE\_ECDSA cipher group, configure
  the trustpoint with a certificate that contains an ECDSA-capable key.
* ssh version
  **command removed in 9.16(1)**—This command has been removed. Only SSH
  version 2 is supported.
* **When you upgrade to 9.16 or later, you might see a different certificate
  serial number**—In 9.16, the ASA started using OpenSSL, which causes
  negative values in certificates to be computed differently, so you may see a
  different serial number after upgrading. This change does not affect
  operation. (CSCvv30338)
* **SAMLv1 feature removed in 9.16(1)**—Support for SAMLv1 was removed.
* **No support for DH groups 2, 5, and 24 in 9.16(1)**—Support has been
  removed for the DH groups 2, 5, and 24 in SSL DH group configuration. The
  ssl dh-group command has been updated to remove
  the command options group2, group5, and
  group24.

##### 9.15 Guidelines

* **No support in ASA 9.15(1) and later for the ASA 5525-X, ASA 5545-X, and
  ASA 5555-X**—ASA 9.14(x) is the last supported version. For the ASA
  FirePOWER module, the last supported version is 6.6.
* **Cisco announces the feature deprecation for Clientless SSL VPN effective with ASA version
  9.17(1)**—Limited support will continue on releases prior to
  9.17(1).
* **For the Firepower 1010, invalid VLAN IDs can cause problems**—Before you
  upgrade to 9.15(1), make sure you are not using a VLAN for switch ports in
  the range 3968 to 4047. These IDs are for internal use only, and 9.15(1)
  includes a check to make sure you are not using these IDs. For example, if
  these IDs are in use after upgrading a failover pair, the failover pair will
  go into a suspended state. See [CSCvw33057](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw33057) for more information.
* **SAMLv1 feature deprecation**—Support for SAMLv1 is deprecated.
* **Low-Security Cipher Removal in ASA 9.15(1)**—Support for the following
  less secure ciphers used by IKE and IPsec have been removed:

  + Diffie-Hellman groups: 2 and 24
  + Encryption algorithms: DES, 3DES, AES-GMAC, AES-GMAC-192,
    AES-GMAC-256, NULL, ESP-3DES, ESP-DES, ESP-MD5-HMAC
  + Hash algorithms: MD5

  | **Note** | ---   Low-security SSH and SSL ciphers have not yet been removed.   --- |
  | --- | --- |

  Before you upgrade from an earlier version of ASA to Version 9.15(1), you
  must update your VPN configuration to use the ciphers supported in 9.15(1),
  or else the old configuration will be rejected. When the configuration is
  rejected, one of the following actions will occur, depending on the
  command:

  + The command will use the default cipher.
  + The command will be removed.

  Fixing your configuration before upgrading is especially important for
  clustering or failover deployments. For example, if the secondary unit is
  upgraded to 9.15(1), and the removed ciphers are synced to this unit from
  the primary, then the secondary unit will reject the configuration. This
  rejection might cause unexpected behavior, like failure to join the
  cluster.

  **IKEv1**: The following subcommands are removed:

  + **crypto ikev1 policy**
    *priority*:

    - **hash md5**
    - **encryption 3des**
    - **encryption des**
    - **group 2**

  **IKEv2**: The following subcommands are removed:

  + **crypto ikev2 policy**
    *priority*:

    - **prf md5**
    - **integrity md5**
    - **group 2**
    - **group 24**
    - **encryption 3des**
    - **encryption des**
    - **encryption null**

  **IPsec**: The following subcommands are removed:

  + **crypto ipsec ikev1 transform-set *name* esp-3des esp-des
    esp-md5-hmac**
  + **crypto ipsec ikev2 ipsec-proposal *name***

    - **protocol esp integrity md5**
    - **protocol esp encryption 3des aes-gmac aes-gmac- 192
      aes-gmac -256 des**
  + **crypto ipsec profile *name***

    - **set pfs group2 group24**

  **Crypto Map**: The following subcommands are removed:

  + **crypto map *name sequence* set pfs group2**
  + **crypto map *name sequence* set pfs group24**
  + **crypto map *name sequence* set ikev1 phase1-mode aggressive
    group2**
* **Re-introduction of CRL Distribution Point configuration**—The static CDP
  URL configuration option, that was removed in 9.13(1), was re-introduced in
  the  match-certificate  command.
* **Restoration of bypass certificate validity checks option**—The option to
  bypass revocation checking due to connectivity problems with the CRL or OCSP
  server was restored.

  The following subcommands were restored:

  + **revocation-check crl none**
  + **revocation-check ocsp none**
  + **revocation-check crl ocsp none**
  + **revocation-check ocsp crl none**

##### 9.14 Guidelines

* **ASDM signed-image support in 9.14(4.14)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **ASDM Cisco.com Upgrade Wizard failure on Firepower 1000 and 2100 in
  Appliance mode**—The ASDM Cisco.com Upgrade Wizard does not work for
  upgrading to 9.14 (Tools > Check for ASA/ASDM
  Updates). The wizard can upgrade ASDM from 7.13 to 7.14, but the
  ASA image upgrade is grayed out. ([CSCvt72183](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvt72183)) As a workaround, use one of the following
  methods:

  + Use Tools > Upgrade Software from Local
    Computer for both ASA and ASDM. Note that the ASDM
    image (7.14(1)) in the 9.14(1) bundle also has the bug [CSCvt72183](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvt72183); you should download the newer 7.14(1.46)
    image to enable correct functioning of the wizard.
  + Use Tools > Check for ASA/ASDM Updates to
    upgrade to ASDM 7.14 (the version will be 7.14(1.46); then use the
    new ASDM to upgrade the ASA image. Note that you may see a
    Fatal Installation Error; in this case,
    click OK. You must then set the boot image
    manually on the Configuration > Device Management  > System Image/Configuration > Boot Image/Configuration screen. Save the configuration and reload the
    ASA.
* **For Failover pairs in 9.14(1)+, the ASA no longer shares SNMP client
  engine data with its peer.**
* **No support in ASA 9.14(1)+ for cnatAddrBindNumberOfEntries and
  cnatAddrBindSessionCount OIDs ([CSCvy22526](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy22526))**.
* **Upgrade issue for 9.14(4)24 and RADIUS challenges for AnyConnect mobile
  users**—To restore RADIUS functionality, upgrade to 9.18(4)22 or
  later.
* **Upgrading the Firepower 2100 in Platform mode**—When you upgrade to 9.14
  or later, if your EtherChannel (port-channel) was disabled at the time of
  upgrade, then you will need to manually enable both the EtherChannel and its
  member interfaces after upgrade.
* **Downgrade issue for the Firepower 2100 in Platform mode from 9.13/9.14 to
  9.12 or earlier**—For a Firepower 2100 with a fresh installation of
  9.13 or 9.14 that you converted to Platform mode: If you downgrade to 9.12
  or earlier, you will not be able to configure new interfaces or edit
  existing interfaces in FXOS (note that 9.12 and earlier only supports
  Platform mode). You either need to restore your version to 9.13 or later, or
  you need to clear your configuration using the FXOS erase configuration
  command. This problem does not occur if you originally upgraded to 9.13 or
  9.14 from an earlier release; only fresh installations are affected, such as
  a new device or a re-imaged device. ([CSCvr19755](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvr19755))
* **The tls-proxy  keyword, and support for
  SCCP/Skinny encrypted inspection, was removed** from the
  inspect skinny  command.
* **ASDM Upgrade Wizard**—Due to an internal change, the wizard is only
  supported using ASDM 7.10(1) and later; also, due to an image naming change,
  you must use ASDM 7.12(1) or later to upgrade to ASA 9.10(1) and later.
  Because ASDM is backwards compatible with earlier ASA releases, you can
  upgrade ASDM no matter which ASA version you are running. Note that ASDM
  7.13 and 7.14 did not support the ASA 5512-X, 5515-X, 5585-X, or ASASM; you
  must upgrade to ASDM 7.13(1.101) or 7.14(1.48) to restore ASDM support.

##### 9.13 Guidelines

* **ASAv requires 2GB memory in 9.13(1) and later**—Beginning with 9.13(1),
  the minimum memory requirement for the ASAv is 2GB. If your current ASAv
  runs with less than 2GB of memory, you cannot upgrade to 9.13(1) from an
  earlier version. You must adjust the memory size before upgrading. See the
  [ASAv Getting Started Guide](https://www.cisco.com/go/asa-quick) for information about
  the resource allocations (vCPU and memory) supported in version 9.13(1).
* **Downgrade issue for the Firepower 2100 in Platform mode from 9.13 to 9.12
  or earlier**—For a Firepower 2100 with a fresh installation of 9.13
  that you converted to Platform mode: If you downgrade to 9.12 or earlier,
  you will not be able to configure new interfaces or edit existing interfaces
  in FXOS (note that 9.12 and earlier only supports Platform mode). You either
  need to restore your version to 9.13, or you need to clear your
  configuration using the FXOS erase configuration command. This problem does
  not occur if you originally upgraded to 9.13 from an earlier release; only
  fresh installations are affected, such as a new device or a re-imaged
  device. (CSCvr19755)
* **Cluster control link MTU change in 9.13(1)**—Starting in 9.13(1), many
  cluster control packets are larger than they were in previous releases. The
  recommended MTU for the cluster control link has always been 1600 or
  greater, and this value is appropriate. However, if you set the MTU to 1600
  but then failed to match the MTU on connecting switches (for example, you
  left the MTU as 1500 on the switch), then you will start seeing the effects
  of this mismatch with dropped cluster control packets. Be sure to set all
  devices on the cluster control link to the same MTU, specifically 1600 or
  higher.
* **Beginning with 9.13(1), the ASA establishes an LDAP/SSL connection only if
  one of the following certification criteria is satisfied**:

  + The LDAP server certificate is trusted (exists in a trustpoint or the
    ASA trustpool) and is valid.
  + A CA certificate from servers issuing chain is trusted (exists in a
    trustpoint or the ASA trustpool) and all subordinate CA certificates
    in the chain are complete and valid.
* **Local CA server is removed in 9.13(1)**—When the ASA is configured as
  local CA server, it can issue digital certificates, publish Certificate
  Revocation Lists (CRLs), and securely revoke issued certificates. This
  feature has become obsolete and hence the crypto ca
  server  command is removed.
* **Removal of CRL Distribution Point commands**—The static CDP URL
  configuration commands, namely crypto-ca-trustpoint
  crl  and crl url  were removed
  with other related logic. The CDP URL was moved to match certificate
  command.

  | **Note** | ---   The CDP URL configuration was enhanced to allow multiple instances of the CDP override for a single map (refer [CSCvu05216](https://tools.cisco.com/bugsearch/bug/CSCvu05216)).   --- |
  | --- | --- |
* **Removal of bypass certificate validity checks option**—The option to
  bypass revocation checking due to connectivity problems with the CRL or OCSP
  server was removed.

  The following subcommands are removed:

  + **revocation-check crl none**
  + **revocation-check ocsp none**
  + **revocation-check crl ocsp none**
  + **revocation-check ocsp crl none**

  Thus, after an upgrade, any revocation-check command that is no longer
  supported will transition to the new behavior by ignoring the trailing
  none.

  | **Note** | ---   These commands were restored later (refer [CSCtb41710](https://tools.cisco.com/bugsearch/bug/CSCtb41710)).   --- |
  | --- | --- |
* **Low-Security Cipher Deprecation**— Several encryption ciphers used by
  the ASA IKE, IPsec, and SSH modules are considered insecure and have been
  deprecated. They will be removed in a later release.

  IKEv1: The following subcommands are deprecated:

  + **crypto ikev1 policy**
    *priority*:

    - **hash md5**
    - **encryption 3des**
    - **encryption des**
    - **group 2**
    - **group 5**

  IKEv2: The following subcommands are deprecated:

  + **crypto ikev2 policy**
    *priority*

    - **integrity md5**
    - **prf md5**
    - **group 2**
    - **group 5**
    - **group 24**
    - **encryption 3des**
    - **encryption des** (this command is still available when
      you have the DES encryption license only)
    - **encryption null**

  IPsec: The following commands are deprecated:

  + **crypto ipsec ikev1 transform-set *name* esp-3des esp-des
    esp-md5-hmac**
  + **crypto ipsec ikev2 ipsec-proposal *name***

    - **protocol esp integrity md5**
    - **protocol esp encryption 3des aes-gmac aes-gmac- 192
      aes-gmac -256 des**
  + **crypto ipsec profile *name***

    - **set pfs group2 group5 group24**

  SSH: The following commands are deprecated:

  + **ssh cipher integrity custom hmac-sha1-96:hmac-md5:
    hmac-md5-96**
  + **ssh key-exchange group dh-group1-sha1**

  SSL: The following commands are deprecated:

  + **ssl dh-group group2**
  + **ssl dh-group group5**
  + **ssl dh-group group24**

  Crypto Map: The following commands are deprecated:

  + **crypto map *name sequence* set pfs group2**
  + **crypto map *name sequence* set pfs group5**
  + **crypto map *name sequence* set pfs group24**
  + **crypto map *name sequence* set ikev1 phase1-mode aggressive
    group2**
  + **crypto map *name sequence* set ikev1 phase1-mode aggressive
    group5**
* **In 9.13(1), Diffie-Hellman Group 14 is now the default** for the
  group  command under crypto
  ikev1 policy , ssl dh-group ,
  and crypto ikev2 policy for IPsec PFS using
  crypto map set pfs , crypto
  ipsec profile , crypto dynamic-map set
  pfs , and crypto map set ikev1
  phase1-mode . The former default Diffie-Hellman group
  was Group 2.

  When you upgrade from a pre-9.13(1) release, if you need to use the old
  default (Diffie-Hellman Group 2), then you must *manually* configure
  the DH group as **group 2** or else your tunnels will default to Group
  14. Because group 2 will be removed in a future release, you should move
  your tunnels to group 14 as soon as
  possible.

##### 9.12 Guidelines

* **ASDM signed-image support in 9.12(4.50)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* ASDM Upgrade Wizard—Due to an internal change, the wizard is only supported using ASDM 7.10(1) and later; also, due to an
  image naming change, you must use ASDM 7.12(1) or later to upgrade to ASA 9.10(1) and later. Because ASDM is backwards compatible
  with earlier ASA releases, you can upgrade ASDM no matter which ASA version you are running.
* SSH security improvements and new defaults in 9.12(1)—See the following SSH security improvements:

  + SSH version 1 is no longer supported; only version 2 is supported. The ssh version 1  command will be migrated to ssh version 2 .
  + Diffie-Hellman Group 14 SHA256 key exchange support. This setting is now the default (ssh key-exchange group dh-group14-sha256 ). The former default was Group 1 SHA1. Make sure that your SSH client supports Diffie-Hellman Group 14 SHA256. If it does
    not, you may see an error such as "Couldn't agree on a key exchange algorithm." For example, OpenSSH supports Diffie-Hellman
    Group 14 SHA256.
  + HMAC-SHA256 integrity cipher support. The default is now the high security set of ciphers (hmac-sha1 and hmac-sha2-256 as
    defined by the ssh cipher integrity high  command). The former default was the medium set.
* The NULL-SHA TLSv1 cipher is deprecated and removed in 9.12(1)—Because NULL-SHA doesn't offer encryption and is no longer
  considered secure against modern threats, it will be removed when listing supported ciphers for TLSv1 in the output of tls-proxy  mode commands/options and show ssl ciphers all . The ssl cipher tlsv1 all  and ssl cipher tlsv1 custom NULL-SHA  commands will also be deprecated and removed.
* The default trustpool is removed in 9.12(1)—In order to comply with PSB requirement, SEC-AUT-DEFROOT, the "default" trusted
  CA bundle is removed from the ASA image. As a result, crypto ca trustpool import default  and crypto ca trustpool import clean default  commands are also removed along with other related logic. However, in existing deployments, certificates that were previously
  imported using these command will remain in place.
* The ssl encryption  command is removed in 9.12(1)—In 9.3(2) the deprecation was announced and replaced by ssl cipher . In 9.12(1), ssl encryption  is removed and no longer supported.

##### 9.10 Guidelines

* Due to an internal change, the ASDM Upgrade wizard is only supported using ASDM 7.10(1) and later; also, due to an image naming
  change, you must use ASDM 7.12(1) or later to upgrade to ASA 9.10(1) and later. Because ASDM is backwards compatible with
  earlier ASA releases, you can upgrade ASDM no matter which ASA version you are running.

##### 9.9 Guidelines

* ASA 5506-X memory issues with large configurations on 9.9(2) and later—If you upgrade to 9.9(2) or later, parts of a very
  large configuration might be rejected due to insufficient memory with the following message: "ERROR: Insufficient memory to
  install the rules". One option is to enter the **object-group-search access-control** command to improve memory usage for ACLs; your performance might be impacted, however. Alternatively, you can downgrade to
  9.9(1).

##### 9.8 Guidelines

* **ASDM signed-image support in 9.8(4.45)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* Before upgrading to 9.8(2) or later, FIPS mode requires the failover key to
  be at least 14 characters—Before you upgrade to to 9.8(2) or later in FIPS
  mode, you must change the failover key  or
  failover ipsec pre-shared-key  to be at
  least 14 characters long. If your failover key is too short, when you
  upgrade the first unit, the failover key will be rejected, and both units
  will become active until you set the failover key to a valid value.
* Do not upgrade to 9.8(1) for ASAv on Amazon Web Services--Due to [CSCve56153](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCve56153), you should not upgrade to 9.8(1). After upgrading, the ASAv becomes unreachable. Upgrade to 9.8(1.5) or later instead.

##### 9.7 Guidelines

* Upgrade issue with 9.7(1) to 9.7(1.x) and later for VTI and VXLAN VNI—If you configure both Virtual Tunnel Interfaces (VTIs)
  and VXLAN Virtual Network Identifier (VNI) interfaces, then you cannot perform a zero downtime upgrade for failover; connections
  on these interface types will not replicate to the standby unit until both units are on the same version. (CSCvc83062)

##### 9.6 Guidelines

* (ASA 9.6(2) through 9.7(x)) Upgrade impact when using SSH public key authentication—Due to updates to SSH authentication,
  additional configuration is required to enable SSH public key authentication; as a result, existing SSH configurations using
  public key authentication no longer work after upgrading. Public key authentication is the default for the ASAv on Amazon
  Web Services (AWS), so AWS users will see this issue. To avoid loss of SSH connectivity, you can update your configuration
  *before* you upgrade. Or you can use ASDM after you upgrade (if you enabled ASDM access) to fix the configuration.

  | **Note** | ---   The original behavior was restored in 9.8(1).   --- |
  | --- | --- |

  Sample original
  configuration for a username "admin":

  ```

  username admin nopassword privilege 15
  username admin attributes
    ssh authentication publickey 55:06:47:eb:13:75:fc:5c:a8:c1:2c:bb:
    07:80:3a:fc:d9:08:a9:1f:34:76:31:ed:ab:bd:3a:9e:03:14:1e:1b hashed

  ```

  To use the
  ssh
  authentication  command, before you upgrade, enter the following
  commands:

  ```

  aaa authentication ssh console LOCAL
  username admin password <password> privilege 15

  ```

  We recommend
  setting a password for the username as opposed to keeping the
  nopassword
  keyword, if present. The
  nopassword
  keyword means that
  *any*
  password can be entered, not that
  *no*
  password can be entered. Prior to 9.6(2), the
  aaa  command was
  not required for SSH public key authentication, so the
  nopassword
  keyword was not triggered. Now that the
  aaa  command is
  required, it automatically also allows regular password authentication for a
  username  if the
  password  (or
  nopassword )
  keyword is present.

  After you
  upgrade, the
  username
  command no longer requires the
  password  or
  nopassword
  keyword; you can require that a user cannot enter a password. Therefore, to
  force public key authentication only, re-enter the
  username
  command:

  ```

  username admin privilege 15

  ```
* Upgrade impact when upgrading the ASA on the Firepower 9300— Due to license entitlement naming changes on the back-end, when
  you upgrade to ASA 9.6(1)/FXOS 1.1(4), the startup configuration may not parse correctly upon the initial reload; configuration
  that corresponds to add-on entitlements is rejected.

  For a standalone ASA, after the unit reloads with the new version,
  wait until all the entitlements are processed and are in an "Authorized" state
  (**show license all** or
  **Monitoring > Properties > Smart License**), and simply
  reload again (**reload** or
  **Tools > System Reload**)
  *without* saving the configuration. After the reload, the
  startup configuration will be parsed correctly.

  For a failover pair if you have any add-on entitlements, follow
  the upgrade procedure in the FXOS release notes, but reset failover after you
  reload each unit (failover reset  or
  **Monitoring > Properties > Failover > Status**,
  **Monitoring > Failover > System**, or
  **Monitoring > Failover > Failover Group**, and then
  click
  Reset Failover).

  For a cluster, follow the upgrade procedure in the FXOS release
  notes; no additional action is required.

##### 9.5 Guidelines and Migration

* 9.5(2) New Carrier License—The new Carrier license replaces the existing GTP/GPRS license, and also includes support for SCTP
  and Diameter inspection. For the Firepower 9300 ASA security module, the feature mobile-sp  command will automatically migrate to the feature carrier  command.
* 9.5(2) E-mail proxy commands deprecated—In ASA Version 9.5(2), the e-mail proxy commands (imap4s , pop3s , smtps ) and subcommands are no longer supported.
* 9.5(2) CSD commands deprecated or migrated—In ASA Version 9.5(2), the CSD commands (csd image , show webvpn csd image , show webvpn csd , show webvpn csd hostscan , show webvpn csd hostscan image ) are no longer supported.

  The following CSD commands will migrate: csd enable  migrates to hostscan enable ; csd hostscan image  migrates to hostscan image .
* 9.5(2) Select AAA commands deprecated—In ASA Version 9.5(2), these AAA commands and subcommands (override-account-disable , authentication crack ) are no longer supported.
* 9.5(1) We deprecated the following command: timeout gsn
* ASA 5508-X and 5516-X upgrade issue when upgrading to 9.5(x) or later—Before you upgrade to ASA Version 9.5(x) or later, if
  you never enabled jumbo frame reservation then you must check the maximum memory footprint. Due to a manufacturing defect,
  an incorrect software memory limit might have been applied. If you upgrade to 9.5(x) or later before performing the below
  fix, then your device will crash on bootup; in this case, you must downgrade to 9.4 using ROMMON ([Load an Image for the ASA 5500-X Series Using ROMMON](http://www.cisco.com/c/en/us/td/docs/security/asa/asa95/configuration/general/asa-95-general-config/admin-swconfig.html#ID-2152-000008e5)), perform the below procedure, and then upgrade again.

  1. Enter the following command to check for the failure condition:

     ```

     ciscoasa# show memory detail | include Max memory footprint
     Max memory footprint        =    456384512
     Max memory footprint        =            0
     Max memory footprint        =    456384512

     ```

     If a value less than **456,384,512** is returned for “Max memory footprint,” then the failure condition is present, and you must complete the remaining steps
     before you upgrade. If the memory shown is 456,384,512 or greater, then you can skip the rest of this procedure and upgrade
     as normal.
  2. Enter global configuration mode:

     ```

     ciscoasa# configure terminal
     ciscoasa(config)#

     ```
  3. Temporarily enable jumbo frame reservation:

     ```

     ciscoasa(config)# jumbo-frame reservation
     WARNING: This command will take effect after the running-config
     is saved and the system has been rebooted. Command accepted.
     INFO: Interface MTU should be increased to avoid fragmenting
     jumbo frames during transmit

     ```

     | **Note** | ---   Do not reload the ASA.   --- |
     | --- | --- |
  4. Save the configuration:

     ```

     ciscoasa(config)# write memory
     Building configuration...
     Cryptochecksum: b511ec95 6c90cadb aaf6b306 41579572
     14437 bytes copied in 1.320 secs (14437 bytes/sec)
     [OK]

     ```
  5. Disable jumbo frame reservation:

     ```

     ciscoasa(config)# no jumbo-frame reservation
     WARNING: This command will take effect after the running-config is saved and
     the system has been rebooted. Command accepted.
     ```

     | **Note** | ---   Do not reload the ASA.   --- |
     | --- | --- |
  6. Save the configuration again:

     ```

     ciscoasa(config)# write memory
     Building configuration...
     Cryptochecksum: b511ec95 6c90cadb aaf6b306 41579572
     14437 bytes copied in 1.320 secs (14437 bytes/sec)
     [OK]

     ```
  7. You can now upgrade to Version 9.5(x) or later.

##### 9.4 Guidelines and Migration

* 9.4(1) Unified
  Communications Phone Proxy and Intercompany Media Engine Proxy are
  deprecated—In ASA Version 9.4, the Phone Proxy and IME Proxy are no longer
  supported.

##### 9.3 Guidelines and Migration

* 9.3(2) Transport Layer Security (TLS) version 1.2 support—We now support TLS version 1.2 for secure message transmission for
  ASDM, Clientless SSVPN, and AnyConnect VPN. We introduced or modified the following commands: ssl client-version, ssl server-version,
  ssl cipher, ssl trust-point, ssl dh-group. We deprecated the following command: ssl encryption
* 9.3(1) Removal of AAA Windows NT domain authentication—We removed NTLM support for remote access VPN users. We deprecated
  the following command: aaa-server protocol nt

##### 9.2 Guidelines and Migration

###### Auto Update Server certificate verification

9.2(1) Auto Update Server certificate verification enabled by default. The Auto Update Server certificate verification is
now enabled by default; for new configurations, you must explicitly disable certificate verification. If you are upgrading
from an earlier release, and you did not enable certificate verification, then certificate verification is not enabled, and
you see the following warning:

`WARNING: The certificate provided by the auto-update servers will not be verified. In order to verify this certificate please
use the verify-certificate option.`

The configuration will be migrated to explicitly configure no verification:

auto-update server no-verification

###### Upgrade impact for ASDM login

Upgrade impact for ASDM login when upgrading from a pre-9.2(2.4) release to 9.2(2.4) or later. If you upgrade from a pre-9.2(2.4)
release to ASA Version 9.2(2.4) or later and you use command authorization and ASDM-defined user roles, users with Read Only
access will not be able to log in to ASDM. You must change the more  command either before or after you upgrade to be at privilege level 5; only Admin level users can make this change. Note
that ASDM version 7.3(2) and later includes the more  command at level 5 for defined user roles, but preexisting configurations need to be fixed manually.

**ASDM:**

1. Choose Configuration > Device Management > Users/AAA > AAA Access > Authorization, and click Configure Command Privileges.
2. Select more, and click Edit.

   ![](/c/dam/en/us/td/i/400001-500000/410001-420000/413001-414000/413949.jpg)
3. Change the Privilege Level to 5, and click OK.
4. Click OK, and then Apply.

**CLI:**

`ciscoasa(config)# privilege cmd level 5 mode exec command more`

##### 9.1 Guidelines and Migration

* Maximum MTU Is Now 9198 Bytes—If your MTU was set to a value higher than 9198, then the MTU is automatically lowered when
  you upgrade. In some cases, this MTU change can cause an MTU mismatch; be sure to set any connecting equipment to use the
  new MTU value. The maximum MTU that the ASA can use is 9198 bytes (check for your model’s exact limit at the CLI help). This
  value does not include the Layer 2 header. Formerly, the ASA let you specify the maximum MTU as 65535 bytes, which was inaccurate
  and could cause problems.

##### 9.0 Guidelines and Migration

* **IPv6 ACL Migration**—IPv6 ACLs (ipv6 access-list ) will be migrated to extended ACLs (access-list extended ); IPv6 ACLs are no longer supported.

  If IPv4 and IPv6 ACLs are applied on the same direction of an interface (access-group  command), then the ACLs are merged:

  + If both IPv4 and IPv6 ACLs are not used anywhere other than the access-group, then the name of the IPv4 ACL is used for the
    merged ACL; the IPv6 access-list is removed.
  + If at least one of the ACLs is used in another feature, then a new ACL is created with the name *IPv4-ACL-name\_IPv6-ACL-name*; the in-use ACL(s) continue to be used for other features. ACLs not in use are removed. If the IPv6 ACL is in use for another
    feature, it is migrated to an extended ACL of the same name.
* **ACL Any Keyword Migration**—Now that ACLs support both IPv4 and IPv6, the any  keyword now represents “all IPv4 and IPv6 traffic.” Any existing ACLs that use the any  keyword will be changed to use the any4  keyword, which denotes “all IPv4 traffic.”

  In addition, a separate keyword was introduced to designate “all IPv6 traffic”: any6 .

  The any4  and any6  keywords are not available for all commands that use the any  keyword. For example, the NAT feature uses only the any  keyword; any represents IPv4 traffic or IPv6 traffic depending on the context within the specific NAT command.
* **Static NAT-with-port-translation Requirement Before Upgrading**—In Version 9.0 and later, static NAT-with-port-translation rules limit access to the destination IP address for the specified
  port only. If you try to access the destination IP address on a different port not covered by a NAT rule, then the connection
  is blocked. This behavior is also true for Twice NAT. Moreover, traffic that does not match the source IP address of the Twice
  NAT rule will be dropped if it matches the destination IP address, regardless of the destination port. Therefore, before you
  upgrade, you must add additional rules for all other traffic allowed to the destination IP address.

  For example, you have the following Object NAT rule to translate HTTP traffic to the inside server between port 80 and port
  8080:

  ```

  object network my-http-server
    host 10.10.10.1
    nat (inside,outside) static 192.168.1.1 80 8080

  ```

  If you want any other services to reach the server, such as FTP, then you must explicitly allow them:

  ```

  object network my-ftp-server
    host 10.10.10.1
    nat (inside,outside) static 192.168.1.1 ftp ftp

  ```

  Or, to allow traffic to other ports of the server, you can add a general static NAT rule that will match all other ports:

  ```

  object network my-server-1
    host 10.10.10.1
    nat (inside,outside) static 192.168.1.1

  ```

  For Twice NAT, you have the following rule to allow HTTP traffic from 192.168.1.0/24 to the inside server and translate between
  port 80 and port 8080:

  ```

  object network my-real-server
    host 10.10.10.1
  object network my-mapped-server
    host 192.168.1.1
  object network outside-real-hosts
    subnet 192.168.1.0 255.255.255.0
  object network outside-mapped-hosts
    subnet 10.10.11.0 255.255.255.0
  object service http-real
    service tcp destination eq 80
  object service http-mapped
    service tcp destination eq 8080
  object service ftp-real
    service tcp destination eq 21
  nat (outside,inside) source static outside-real-hosts outside-mapped-hosts destination static my-mapped-server my-real-server service http-mapped http-real

  ```

  If you want the outside hosts to reach another service on the inside server, add another NAT rule for the service, for example
  FTP:

  ```

  nat (outside,inside) source static outside-real-hosts outside-mapped-hosts destination static my-mapped-server my-real-server ftp-real ftp-real

  ```

  If you want other source addresses to reach the inside server on any other ports, you can add another NAT rule for that specific
  IP address or for any source IP address. Make sure the general rule is ordered after the specific rule.

  ```

  nat (outside,inside) source static any any destination static my-mapped-server my-real-server

  ```

##### 8.4 Guidelines and Migration

* Configuration Migration for Transparent Mode—In 8.4, all transparent mode interfaces now belong to a bridge group. When you
  upgrade to 8.4, the existing two interfaces are placed in bridge group 1, and the management IP address is assigned to the
  Bridge Group Virtual Interface (BVI). The functionality remains the same when using one bridge group. You can now take advantage
  of the bridge group feature to configure up to four interfaces per bridge group and to create up to eight bridge groups in
  single mode or per context.

  | **Note** | ---   Note In 8.3 and earlier, as an unsupported configuration, you could configure a management interface without an IP address, and you could access the interface using the device management address. In 8.4, the device management address is assigned to the BVI, and the management interface is no longer accessible using that IP address; the management interface requires its own IP address.   --- |
  | --- | --- |
* When upgrading to 8.4(2) from 8.3(1), 8.3(2), and 8.4(1), all identity NAT configurations will now include the no-proxy-arp  and route-lookup  keywords, to maintain existing functionality. The unidirectional  keyword is removed.

##### 8.3 Guidelines and Migration

See the following guide that describes the configuration migration process when you upgrade from a pre-8.3 version of the
Cisco ASA 5500 operating system (OS) to Version 8.3:

[Cisco ASA 5500 Migration to Version 8.3](http://www.cisco.com/c/en/us/td/docs/security/asa/asa83/upgrading/migrating.html)

#### Clustering Guidelines

There are no special requirements for Zero Downtime Upgrades for ASA clustering with the following exceptions.

| **Note** | ---   Zero Downtime *Downgrades* are not officially supported with clustering.   --- |
| --- | --- |

* Firepower 4100/9300 Failover and
  Clustering hitless upgrade requirements for flow offload—Due to bug fixes in the flow
  offload feature, some combinations of FXOS and ASA do not support flow offload (see the
  [compatibility
  table](#id_59069)). Flow offload is disabled by default for ASA. To
  perform a Failover or Clustering hitless upgrade when using flow offload, you need to
  follow the below upgrade paths to ensure that you are always running a compatible
  combination when upgrading to FXOS 2.3.1.130 or later:

  1. Upgrade ASA to 9.8(3) or later
  2. Upgrade FXOS to 2.3.1.130 or later
  3. Upgrade ASA to your final version

  For example, you are on FXOS 2.2.2.26/ASA 9.8(1), and you want to upgrade to FXOS 2.6.1/ASA 9.12(1), then you can:

  1. Upgrade ASA to 9.8(4)
  2. Upgrade FXOS to 2.6.1
  3. Upgrade ASA to 9.12(1)
* Firepower 4100/9300 Cluster Upgrade
  to FXOS 2.3/ASA 9.9(2)—Data units on ASA 9.8 and
  earlier cannot rejoin a cluster where the control
  unit is on FXOS 2.3/9.9(2) or later; they will
  join after you upgrade the ASA version to 9.9(2)+
  [[CSCvi54844](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvi54844)].
* Distributed Site-to-Site VPN—Distributed Site-to-Site VPN sessions on a failed unit require up to 30 minutes to stabilize
  on other units. During this time, additional unit failures might result in lost sessions. Therefore, during a cluster upgrade,
  to avoid traffic loss, follow these steps. Refer to the FXOS/ASA cluster upgrade procedure so you can integrate these steps
  into your upgrade task.

  | **Note** | ---   Zero Downtime Upgrade is not supported with Distributed Site-to-Site VPN when upgrading from 9.9(1) to 9.9(2) or later. In 9.9(2), due to Active Session Redistribution enhancements, you cannot run some units on 9.9(2) and other units on 9.9(1).   --- |
  | --- | --- |

  1. On the
     chassis *without* the control unit, disable
     clustering on one module using the ASA
     console.

     cluster group
     name

     no enable

     If you are upgrading FXOS on the chassis as well as ASA, save the configuration so clustering will be disabled after the chassis
     reboots:

     write memory
  2. Wait for the cluster to stabilize; verify all backup sessions have been created.

     show cluster vpn-sessiondb summary
  3. Repeat steps 1 and 2 for each module on this chassis.
  4. Upgrade FXOS on the chassis using the FXOS CLI or Firepower Chassis Manager.
  5. After the chassis comes online, update the ASA image on each module using the FXOS CLI or Firepower Chassis Manager.
  6. After the modules come online, re-enable clustering on each module at the ASA console.

     cluster group
     name

     enable

     write memory
  7. Repeat steps
     1 through 6 on the second chassis, being sure to
     disable clustering on the data units first, and
     then finally the control unit.

     A new control
     unit will be chosen from the upgraded chassis.
  8. After the
     cluster has stabilized, redistribute active
     sessions among all modules in the cluster using
     the ASA console on the control unit.

     cluster redistribute vpn-sessiondb
* Upgrade issue for 9.9(1) and later with clustering—9.9(1) and later includes an improvement in the backup distribution. You
  should perform your upgrade to 9.9(1) or later as follows to take advantage of the new backup distribution method; otherwise
  upgraded units will continue to use the old method.

  1. Remove all secondary units from the cluster (so the cluster consists only of the primary unit).
  2. Upgrade 1 secondary unit, and rejoin the cluster.
  3. Disable clustering on the primary unit; upgrade it, and rejoin the cluster.
  4. Upgrade the remaining secondary units, and join them back to the cluster, one at a time.
* Firepower 4100/9300 Cluster Upgrade
  to ASA 9.8(1) and earlier—When you disable
  clustering on a data unit (no
  enable ), which is part of the
  upgrade process, traffic directed to that unit can
  drop for up to three seconds before traffic is
  redirected to a new owner [[CSCvc85008](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvc85008)].
* Zero Downtime Upgrade may not be supported when upgrading to the following releases with the fix for [CSCvb24585](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvb24585). This fix moved 3DES from the default (medium) SSL ciphers to the low cipher set. If you set a custom cipher that only includes
  3DES, then you may have a mismatch if the other side of the connection uses the default (medium) ciphers that no longer include
  3DES.

  + 9.1(7.12)
  + 9.2(4.18)
  + 9.4(3.12)
  + 9.4(4)
  + 9.5(3.2)
  + 9.6(2.4)
  + 9.6(3)
  + 9.7(1)
  + 9.8(1)
* Upgrade issues for fully-qualified domain name (FQDN) ACLs—Due to [CSCuv92371](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuv92371), ACLs containing FQDNs might result in incomplete ACL replication to secondary units in a cluster or failover pair. This
  bug is present in 9.1(7), 9.5(2), 9.6(1), and some interim releases. We suggest that you upgrade to a version that includes
  the fix for CSCuy34265: 9.1(7.6) or later, 9.5(3) or later, 9.6(2) or later. However, due to the nature of configuration replication,
  zero downtime upgrade is not available. See [CSCuy34265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuy34265) for more information about different methods of upgrading.
* Firepower Threat Defense Version 6.1.0 clusters do not support inter-site clustering (you can configure inter-site features
  using FlexConfig starting in 6.2.0). If you deployed or re-deployed a 6.1.0 cluster in FXOS 2.1.1, and you entered a value
  for the (unsupported) site ID, then you must remove the site ID (set it to **0**) on each unit in FXOS before you upgrade to 6.2.3. Otherwise, the units will not be able to rejoin the cluster after the
  upgrade. If you already upgraded, change the site ID to **0** on each unit to resolve the issue. See the FXOS configuration guide to view or change the site ID
* Upgrade to 9.5(2) or later
  (CSCuv82933)—Before you upgrade the control unit,
  if you enter show cluster
  info , the upgraded data units show
  as “DEPUTY\_BULK\_SYNC”; other mismatched states are
  also shown. You can ignore this display; the
  status will show correctly when you upgrade all
  units.
* Upgrade from 9.0(1) or 9.1(1) (CSCue72961)—Zero Downtime Upgrade is not supported.

#### Failover Guidelines

There are no special requirements for Zero Downtime Upgrades for failover with the following exceptions:

* For the Firepower 1010, invalid VLAN IDs can cause problems—Before you upgrade to
  9.15(1), make sure you are not using a VLAN for switch ports in the range 3968 to 4047.
  These IDs are for internal use only, and 9.15(1) includes a check to make sure you are
  not using these IDs. For example, if these IDs are in use after upgrading a failover
  pair, the failover pair will go into a suspended state. See [CSCvw33057](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw33057) for more information.
* Firepower 4100/9300 Failover and
  Clustering hitless upgrade requirements for flow offload—Due to bug fixes in the flow
  offload feature, some combinations of FXOS and ASA do not support flow offload (see the
  [compatibility
  table](#id_59069)). Flow offload is disabled by default for ASA. To
  perform a Failover or Clustering hitless upgrade when using flow offload, you need to
  follow the below upgrade paths to ensure that you are always running a compatible
  combination when upgrading to FXOS 2.3.1.130 or later:

  1. Upgrade ASA to 9.8(3) or later
  2. Upgrade FXOS to 2.3.1.130 or later
  3. Upgrade ASA to your final version

  For example, you are on FXOS 2.2.2.26/ASA 9.8(1), and you want to upgrade to FXOS 2.6.1/ASA 9.12(1), then you can:

  1. Upgrade ASA to 9.8(4)
  2. Upgrade FXOS to 2.6.1
  3. Upgrade ASA to 9.12(1)
* Upgrade issues with 8.4(6), 9.0(2) , and 9.1(2)—Due to CSCug88962, you cannot perform a Zero Downtime Upgrade to 8.4(6), 9.0(2),
  or 9.1(3). You should instead upgrade to 8.4(5) or 9.0(3). To upgrade 9.1(1), you cannot upgrade directly to the 9.1(3) release
  due to CSCuh25271, so there is no workaround for a Zero Downtime Upgrade; you must upgrade to 9.1(2) before you upgrade to
  9.1(3) or later.
* Upgrade issues for fully-qualified domain name (FQDN) ACLs—Due to [CSCuv92371](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuv92371), ACLs containing FQDNs might result in incomplete ACL replication to secondary units in a cluster or failover pair. This
  bug is present in 9.1(7), 9.5(2), 9.6(1), and some interim releases. We suggest that you upgrade to a version that includes
  the fix for CSCuy34265: 9.1(7.6) or later, 9.5(3) or later, 9.6(2) or later. However, due to the nature of configuration replication,
  zero downtime upgrade is not available. See [CSCuy34265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuy34265) for more information about different methods of upgrading.
* Upgrade issue with 9.7(1) to 9.7(1.x) and later for VTI and VXLAN VNI—If you configure
  both Virtual Tunnel Interfaces (VTIs) and VXLAN Virtual Network Identifier (VNI)
  interfaces, then you cannot perform a zero downtime upgrade for failover; connections on
  these interface types will not replicate to the standby unit until both units are on the
  same version. (CSCvc83062)
* Before upgrading to 9.8(2) or later, FIPS mode
  requires the failover key to be at least 14
  characters—Before you upgrade to to 9.8(2) or
  later in FIPS mode, you must change the
  failover key  or
  failover ipsec
  pre-shared-key  to be at least 14
  characters long. If your failover key is too
  short, when you upgrade the first unit, the
  failover key will be rejected, and both units will
  become active until you set the failover key to a
  valid value.
* Upgrade issue with GTP inspection—There could be some downtime during the upgrade, because the GTP data structures are not
  replicated to the new node.

#### Additional Guidelines

* Cisco ASA Clientless SSL VPN Portal Customization Integrity
  Vulnerability—Multiple vulnerabilities have been fixed for clientless SSL VPN
  in ASA software, so you should upgrade your software to a fixed version. See
  <http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20141008-asa>
  for details about the vulnerability and a list of fixed ASA versions. Also, if
  you ever ran an earlier ASA version that had a vulnerable configuration, then
  regardless of the version you are currently running, you should verify that the
  portal customization was not compromised. If an attacker compromised a
  customization object in the past, then the compromised object stays persistent
  after you upgrade the ASA to a fixed version. Upgrading the ASA prevents this
  vulnerability from being exploited further, but it will not modify any
  customization objects that were already compromised and are still present on
  the system.

### FXOS Upgrade Guidelines

Before you upgrade, read the release notes for each FXOS version in your chosen upgrade path. Release notes contain important
information about each FXOS release, including new features and changed functionality.

Upgrading may require configuration changes that you must address. For example, new hardware supported in an FXOS release
might also require that you update the FXOS firmware.

FXOS release notes are available here: <https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html>.

## ASA Upgrade Checklist

To plan your upgrade, use this checklist.

1. ASA model ([Upgrade Path: ASA Appliances](#ID-2152-0000000a)): \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

   Current ASA version ([Upgrade Path: ASA Appliances](#ID-2152-0000000a)): \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2. Check the ASA/ASDM compatibility per model ([ASA and ASDM Compatibility Per Model](#id_59039)).

   Target ASA version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

   Target ASDM version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3. Check the upgrade path for the Firepower 2100 in Platform mode ([Upgrade Path: ASA on Firepower 2100 in Platform Mode](#asa-on-firepower-2100-in-platform-mode-upgrade-path)). Are there intermediate versions
   required? Yes \_\_\_\_\_ No \_\_\_\_\_

   If yes, intermediate ASA version(s):
   \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
4. Download the target ASA/ASDM versions ([Download ASA Software](#ID-2152-0000008d)).

   | **Note** | ---   ASDM is included in the image package for all Firepower and Secure Firewall platforms.   --- |
   | --- | --- |
5. Is your ASA model a Firepower 4100 or 9300? Yes \_\_\_\_\_ No \_\_\_\_\_

   If yes:

   1. Current FXOS
      version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
   2. Check
      ASA/Firepower 4100 and 9300 compatibility ([Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)).

      Target FXOS version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
   3. Are there
      intermediate versions required? Yes \_\_\_\_\_ No \_\_\_\_\_

      If yes, intermediate FXOS versions: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

      Make sure you plan to upgrade the ASA in step with the FXOS upgrades to stay compatible.

      Intermediate ASA versions required to stay compatible during the upgrade: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
   4. Download the
      target and intermediate FXOS version ([Download FXOS for the Firepower 4100/9300](#ID-2152-0000008d)).

      Download the intermediate ASA versions ([Download ASA Software](#ID-2152-0000008d)).
   5. Do you use the Radware DefensePro decorator application? Yes \_\_\_\_\_ No \_\_\_\_\_

      If yes:

      1. Current DefensePro version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
      2. Check
         ASA/FXOS/DefensePro compatibility ([Radware DefensePro Compatibility](#id_59121)).

         Target DefensePro version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
      3. Download the target DefensePro version.
6. Check upgrade guidelines for each operating system.

   * [ASA Upgrade Guidelines](#id_47465).
   * FXOS guidelines: see the [FXOS Release Notes](https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html) for each intermediate and target version.
7. Back up your configurations. See the configuration guide for each operating system for backup methods.

## Compatibility

This section includes tables showing the compatibility between platforms, operating systems, and applications.

* [ASA and ASDM Compatibility Per Model](#id_59039)
* [Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)
* [Radware DefensePro Compatibility](#id_59121)

### ASA and ASDM Compatibility Per Model

The following tables list ASA and ASDM compatibility for current models. For older versions and models, see [Cisco ASA Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

* [ASA 9.20 and 9.19](#reference_xy4_5xz_l5b)
* [ASA 9.18 to 9.17](#reference_ncw_ppb_fxb)
* [ASA 9.16 to 9.15](#reference_upj_nkl_x4b)
* [ASA 9.14 to 9.13](#reference_ftp_45n_nhb)
* [ASA 9.12 to 9.5](#id_59423)

#### ASA 9.20 and 9.19

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.20(x) was the final version for the Firepower 2100 series. * ASA 9.18(x) was the final version for the Firepower 4110, 4120, 4140, 4150, and   Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.19(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.18 with ASA 9.19. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.20(1.5) with ASDM 7.20(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required.  --- |
| --- | --- |

Table 1. ASA and ASDM Compatibility: 9.20 and 9.19

| ASA | ASDM | ASA Model | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 |  | Firepower 2110  2120  2130  2140 | Secure Firewall 3105  3110  3120  3130  3140 | Firepower 4112  4115  4125  4145 | Secure Firewall 4215  Secure Firewall 4225  Secure Firewall 4245 | Firepower 9300 | ISA 3000 |
| **9.20(3)** | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(2) | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(1) | 7.20(1) | — | — | — | — | — | — | **YES** | — | — |
| **9.19(1)** | 7.19(1) | **YES** | **YES** |  | **YES** | **YES** | **YES** | — | **YES** | **YES** |

#### ASA 9.18 to 9.17

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.17(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.17 with ASA 9.18. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.17(1.2) with ASDM 7.17(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.17(1.13) and 9.18(2) and later requires ASDM 7.18(1.152) or later. The ASA now   validates whether the ASDM image is a Cisco digitally signed image. If you try to run   an older ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be   blocked and the message “%ERROR: Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 2. ASA and ASDM Compatibility: 9.18 to 9.17

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 |  | Firepower 2110  2120  2130  2140 | Secure Firewall 3110  3120  3130  3140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.18(4)** | 7.19(1)95 | **YES** | **YES** |  | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(3) | 7.18(1.152) | **YES** | **YES** |  | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(2) | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(1) | 7.18(1) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.17(1.13)** | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.17(1) | 7.17(1.155) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |

#### ASA 9.16 to 9.15

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.15(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.15 with ASA 9.16. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.16(1.15) with ASDM 7.16(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.16(3.19) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 3. ASA and ASDM Compatibility: 9.16 to 9.15

| ASA | ASDM | ASA Model | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.16(4)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3.19) | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(2) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(1) | 7.16(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.15(1)** | 7.15(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |

#### ASA 9.14 to 9.13

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASA 9.12(x) was the final version for the ASA 5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.13(1) can manage an ASA 5516-X on ASA 9.10(1).   ASDM 7.13(1) and ASDM 7.14(1) did not support ASA 5512-X, 5515-X, 5585-X, and ASASM;   you must upgrade to ASDM 7.13(1.101) or 7.14(1.48) to restore ASDM support. * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.13 with ASA 9.14. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.14(1.2) with ASDM 7.14(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.14(4.14) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 4. ASA and ASDM Compatibility: 9.14 to 9.13

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5525-X  5545-X  5555-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.14(4.14)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(4) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(3) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(2) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.30) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.6) | 7.14(1.48) | — | — | **YES** (+ASAv100) | — | — | — | — | — |
| 9.14(1) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.13(1)** | 7.13(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** (except 4112) | **YES** | **YES** |

#### ASA 9.12 to 9.5

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.12(x) was the final version for the ASA   5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all   previous ASA versions, unless otherwise stated.   For example, ASDM 7.12(1) can manage an ASA 5515-X   on ASA 9.10(1). * New ASA versions require the coordinating ASDM   version or a later version; you cannot use an old   version of ASDM with a new version of ASA. For   example, you cannot use ASDM 7.10 with ASA 9.12.   For ASA maintenance releases and interims, you can   continue to use the current ASDM version, unless   otherwise stated. For example, you can use ASA   9.12(1.15) with ASDM 7.12(1). If an ASA   maintenance release has significant new features,   then usually there will be a new ASDM version   required. * ASA 9.8(4.45) and 9.12(4.50) and later require   ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed   image. If you try to run an older ASDM image than   7.18(1.152) with an ASA version with this fix,   ASDM will be blocked and the message “%ERROR:   Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 5. ASA and ASDM Compatibility: 9.12 to 9.5

| ASA | ASDM | ASA Model | | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5512-X  5515-X  5525-X  5545-X  5555-X | ASA 5585-X | ASAv | ASASM | Firepower 2110  2120  2130  2140 | Firepower 4110  4120  4140  4150 | Firepower 4115  4125  4145 | Firepower 9300 | ISA 3000 |
| **9.12(4.50)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(4) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(3) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(2) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(1) | 7.12(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.10(1) | 7.10(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(2) | 7.9(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(1) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| **9.8(4.45)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(4) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(3) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(2) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(1.200) | No support | — | — | — | **YES** | — | — | — | — | — | — |
| 9.8(1) | 7.8(1) | **YES** | **YES** | **YES** | **YES** (+ASAv50) | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.7(1.4) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(4) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(3.1) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(2) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(1) | 7.6(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** (except 4150) | — | **YES** | **YES** |
| 9.5(3.9) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(2.200) | 7.5(2.153) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(2.2) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2.1) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2) | 7.5(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(1.200) | 7.5(1) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(1.5) | 7.5(1.112) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |
| 9.5(1) | 7.5(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |

### Firepower 4100/9300 Compatibility with ASA and Threat Defense

The following table lists compatibility between the ASA and threat
defense applications with the Firepower 4100/9300.

The **bold** versions listed below are specially-qualified companion releases. You
should use these software combinations whenever possible because Cisco performs enhanced
testing for these combinations.

For upgrading, see the following guidelines:

* FXOS—For 2.2.2 and later, you can upgrade directly to a higher
  version. When upgrading from versions earlier than 2.2.2, you need to upgrade to each
  intermediate version. Note that you cannot upgrade FXOS to a version that does not
  support your current logical device version. You will need to upgrade in steps:
  upgrade FXOS to the highest version that supports your current logical device; then
  upgrade your logical device to the highest version supported with that FXOS version.
  For example, if you want to upgrade from FXOS 2.2/ASA 9.8 to FXOS 2.13/ASA 9.19, you
  would have to perform the following upgrades:

  1. FXOS 2.2→FXOS 2.11 (the highest version that supports 9.8)
  2. ASA 9.8→ASA 9.17 (the highest version supported by 2.11)
  3. FXOS 2.11→FXOS 2.13
  4. ASA 9.17→ASA 9.19
* ASA—ASA lets you upgrade directly from your current version to any higher version,
  noting the FXOS requirements above.

| **Note** | ---   This section applies only to the Firepower 4100/9300. Other models utilize FXOS only as an underlying operating system that is included in the ASA and threat defense unified image bundles. For the Secure Firewall 3100 in multi-instance mode, see the Threat Defense compatibility guide.   --- |
| --- | --- |

| **Note** | ---   FXOS 2.8(1.125)+ and later versions do not support ASA 9.14(1) or 9.14(1.10) for ASA SNMP polls and traps; you must use 9.14(1.15)+. Other releases, such as 9.13 or 9.12, are not affected.   --- |
| --- | --- |

| **Note** | ---   FXOS 2.12/ASA 9.18/Threat Defense 7.2 was the final version for the Firepower 4110, 4120, 4140, 4150, and Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300.   --- |
| --- | --- |

Table 6. ASA or Threat Defense, and Firepower 4100/9300 Compatibility

| FXOS Version | Model | ASA Version | Threat Defense Version |
| --- | --- | --- | --- |
| 2.16 | Firepower 4112 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.14(1) | Firepower 4112 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.13 | Firepower 4112 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.12 | Firepower 4112 | **9.18** (recommended)  9.17  9.16  9.14 | **7.2** (recommended)  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.11 | Firepower 4112 | **9.17** (recommended)  9.16  9.14 | **7.1** (recommended)  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.17** (recommended)  9.16  9.14  9.12 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.17** (recommended)  9.16  9.14  9.12  9.8 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.10   | **Note** | For compatibility with 7.0.2+ and 9.16(3.11)+, you need FXOS 2.10(1.179)+. | | --- | --- | | Firepower 4112 | **9.16** (recommended)  9.14 | **7.0** (recommended)  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.16** (recommended)  9.14  9.12 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.16** (recommended)  9.14  9.12  9.8 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.9 | Firepower 4112 | 9.14 | 6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | 9.14  9.12 | 6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.14  9.12  9.8 | 6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.8 | Firepower 4112 | **9.14** | **6.6**   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- | |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.14** (recommended)  9.12   | **Note** | Firepower 9300 SM-56 requires ASA 9.12(2)+ | | --- | --- | | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.14** (recommended)  9.12  9.8 | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.157)   | **Note** | You can now run ASA 9.12+ and FTD 6.4+ on separate modules in the same Firepower 9300 chassis | | --- | --- | | Firepower 4145  Firepower 4125  Firepower 4115 | **9.12**   | **Note** | Firepower 9300 SM-56 requires ASA 9.12.2+ | | --- | --- | | **6.4** |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 | **6.4** (recommended)  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.131) | Firepower 9300 SM-48  Firepower 9300 SM-40 | **9.12** | Not supported |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.73) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | | **6.2.3** (recommended)   | **Note** | 6.2.3.16+ requires FXOS 2.3.1.157+ | | --- | --- | |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.66)  2.3(1.58) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | |  |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.2 | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.8** | Threat Defense versions are EoL |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |

### Radware DefensePro Compatibility

The following table lists the supported Radware DefensePro version for each security appliance and associated logical device.

Table 7. Radware DefensePro Compatibility

| FXOS Version | ASA | Threat Defense | Radware DefensePro | Security Appliance Models |
| --- | --- | --- | --- | --- |
| 2.16 | 9.22(1) | 7.6 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4112  Firepower 4115  Firepower 4125  Firepower 4145 |
| 2.14(1) | 9.20(1) | 7.4(1) | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4112  Firepower 4115  Firepower 4125  Firepower 4145 |
| 2.13.0 | 9.19(1) | 7.3 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4112  Firepower 4115  Firepower 4125  Firepower 4145 |
| 2.12.0 | 9.18(1) | 7.2 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.11.1 | 9.17(1) | 7.1 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.10.1 | 9.16(1) | 7.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.10.1 | 9.16(1) | 7.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.9.1 | 9.15(1) | 6.7.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.8.1 | 9.14(1) | 6.6.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.7(1) | 9.13(1) | 6.5 | 8.13.01.09-3 | Firepower 9300  Firepower 4110  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.6(1) | 9.12(1)  9.10(1) | 6.4.0  6.3.0 | 8.13.01.09-3 | Firepower 9300  Firepower 4110  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.4(1) | 9.9(2)  9.10(1) | 6.2.3  6.3 | 8.13.01.09-2 | Firepower 9300  Firepower 4110  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.3(1) | 9.9(1)  9.9(2) | 6.2.2  6.2.3 | 8.13.01.09-2 | Firepower 9300  Firepower 4110 (Firepower Threat Defense only)  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.2(2) | 9.8(1)  9.8(2)  9.8(3) | 6.2.0  6.2.2 | 8.10.01.17-2 | Firepower 9300  Firepower 4110 (Firepower Threat Defense only)  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.2(1) | 9.7(1)  9.8(1) | 6.2.0 | 8.10.01.17-2 | Firepower 9300  Firepower 4110 (Firepower Threat Defense only)  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.1(1) | 9.6(2)  9.6(3)  9.6(4)  9.7(1) | not supported | 8.10.01.16-5 | Firepower 9300  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.0(1) | 9.6(1)  9.6(2)  9.6(3)  9.6(4) | not supported | 8.10.01.16-5 | Firepower 9300  Firepower 4120  Firepower 4140  Firepower 4150 |
| 1.1(4) | 9.6(1) | not supported | 1.1(2.32-3) | 9300 |

## Upgrade Path

For each operating system that you are upgrading, check the supported upgrade path. In some cases, you may have to install
interim upgrades before you can upgrade to your final version.

* [Upgrade Path: ASA Appliances](#ID-2152-0000000a)
* [Upgrade Path: ASA on Firepower 2100 in Platform Mode](#asa-on-firepower-2100-in-platform-mode-upgrade-path)
* [Upgrade Path: ASA Logical Devices for the Firepower 4100/9300](#Cisco_Reference.dita_d121649b-6d91-4619-b00d-bd1faefaa6fa)

### Upgrade Path: ASA Appliances

To view your current version and model, use one of the following methods:

* ASDM: Choose Home > Device Dashboard > Device Information.
* CLI: Use the show version  command.

This table provides upgrade paths for ASA. Some older versions require an
intermediate upgrade before you can upgrade to a newer version. Recommended versions
are in **bold**.

Be sure to check the upgrade guidelines for each release between your starting
version and your ending version. You may need to change your configuration before
upgrading in some cases, or else you could experience an outage.  See [ASA Upgrade Guidelines](#id_47465).

For guidance on security issues on the ASA, and which releases contain fixes for each
issue, see the [ASA Security Advisories](https://tools.cisco.com/security/center/publicationListing.x).

| **Note** | ---   ASA 9.20 was the final version for the Firepower 2100.  ASA 9.18 was the final version for the Firepower 4110, 4120, 4140, 4150, and Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300.  ASA 9.16 was the final version for the ASA 5506-X, 5508-X, and 5516-X.  ASA 9.14 was the final version for the ASA 5525-X, 5545-X, and 5555-X.  ASA 9.12 was the final version for the ASA 5512-X, 5515-X, 5585-X, and ASASM.  ASA 9.2 was the final version for the ASA 5505.  ASA 9.1 was the final version for the ASA 5510, 5520, 5540, 5550, and 5580.   --- |
| --- | --- |

Table 8. Upgrade Path

| **Current Version** | **Interim Upgrade Version** | **Target Version** |
| --- | --- | --- |
| 9.20 | — | Any of the following:  → **9.22** |
| 9.19 | — | Any of the following:  → **9.22**  → **9.20** |
| 9.18 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19** |
| 9.17 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18** |
| 9.16 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17 |
| 9.15 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16** |
| 9.14 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16** |
| 9.13 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14 |
| 9.12 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14 |
| 9.10 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12 |
| 9.9 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12 |
| 9.8 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12 |
| 9.7 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.6 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.5 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.4 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.3 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.2 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.1(2), 9.1(3), 9.1(4), 9.1(5), 9.1(6), or 9.1(7.4) | — | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 9.1(1) | → 9.1(2) | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 9.0(2), 9.0(3), or 9.0(4) | — | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.6  → 9.1(7.4) |
| 9.0(1) | → 9.0(4) | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.6(1) | → 9.0(4) | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.5(1) | → 9.0(4) | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.4(5+) | — | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4)  → 9.0(4) |
| 8.4(1) through 8.4(4) | → 9.0(4) | → **9.12**  → 9.8  → 9.1(7.4) |
| 8.3 | → 9.0(4) | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.2 and earlier | → 9.0(4) | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4) |

### Upgrade Path: ASA on Firepower 2100 in Platform Mode

To view your current version and model, use one of the following methods:

* ASDM: Choose Home > Device Dashboard > Device Information.
* CLI: Use the show version  command.

This table provides upgrade paths for the ASA on the Firepower 2100 in Platform mode.
Some versions require an intermediate upgrade before you can upgrade to a newer
version. Recommended versions are in **bold**.

Be sure to check the upgrade guidelines for each release between your starting
version and your ending version. You may need to change your configuration before
upgrading in some cases, or else you could experience an outage.  See [ASA Upgrade Guidelines](#id_47465).

For guidance on security issues on the ASA, and which releases contain fixes for each
issue, see the [ASA Security Advisories](https://tools.cisco.com/security/center/publicationListing.x).

| **Note** | ---   ASA 9.20 was the final version for the Firepower 2100.   --- |
| --- | --- |

Table 9. Upgrade Path

| **Current Version** | **Interim Upgrade Version** | **Target Version** |
| --- | --- | --- |
| 9.19 | — | Any of the following:  → **9.20** |
| 9.18 | — | Any of the following:  → **9.20**  → **9.19** |
| 9.17 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.16 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18**  → 9.17 |
| 9.15 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16** |
| 9.14 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.15 |
| 9.13 | → 9.18 | Any of the following:  → **9.20**  → **9.19** |
| 9.13 | — | Any of the following:  → **9.18**  → 9.17  → **9.16**  → 9.15  → 9.14 |
| 9.12 | → 9.18 | Any of the following:  → **9.20**  → **9.19** |
| 9.12 | — | Any of the following:  → **9.18**  → 9.17  → **9.16**  → 9.15  → 9.14 |
| 9.10 | → 9.17 | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.10 | — | Any of the following:  → 9.17  → **9.16**  → 9.15  → 9.14  → 9.12 |
| 9.9 | → 9.17 | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.9 | — | Any of the following:  → 9.17  → **9.16**  → 9.15  → 9.14  → 9.12 |
| 9.8 | → 9.17 | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.8 | — | Any of the following:  → 9.17  → **9.16**  → 9.15  → 9.14  → 9.12 |

### Upgrade Path: ASA Logical Devices for the Firepower 4100/9300

To view your current version and model, use one of the following methods:

* Firepower Chassis Manager: Choose Overview, and look
  at the Model and Version
  fields at the top.
* CLI: For the version, use the show version  command,
  and look at the Package-Vers: field. For the model, enter scope
  chassis 1 , and then show
  inventory .

For upgrading, see the following guidelines:

* FXOS—For 2.2.2 and later, you can upgrade directly to a higher
  version. When upgrading from versions earlier than 2.2.2, you need to upgrade to each
  intermediate version. Note that you cannot upgrade FXOS to a version that does not
  support your current logical device version. You will need to upgrade in steps:
  upgrade FXOS to the highest version that supports your current logical device; then
  upgrade your logical device to the highest version supported with that FXOS version.
  For example, if you want to upgrade from FXOS 2.2/ASA 9.8 to FXOS 2.13/ASA 9.19, you
  would have to perform the following upgrades:

  1. FXOS 2.2→FXOS 2.11 (the highest version that supports 9.8)
  2. ASA 9.8→ASA 9.17 (the highest version supported by 2.11)
  3. FXOS 2.11→FXOS 2.13
  4. ASA 9.17→ASA 9.19
* ASA—ASA lets you upgrade directly from your current version to any higher version,
  noting the FXOS requirements above.

Table 10. ASA or Threat Defense, and Firepower 4100/9300 Compatibility

| FXOS Version | Model | ASA Version | Threat Defense Version |
| --- | --- | --- | --- |
| 2.16 | Firepower 4112 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.14(1) | Firepower 4112 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.13 | Firepower 4112 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.12 | Firepower 4112 | **9.18** (recommended)  9.17  9.16  9.14 | **7.2** (recommended)  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.11 | Firepower 4112 | **9.17** (recommended)  9.16  9.14 | **7.1** (recommended)  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.17** (recommended)  9.16  9.14  9.12 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.17** (recommended)  9.16  9.14  9.12  9.8 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.10   | **Note** | For compatibility with 7.0.2+ and 9.16(3.11)+, you need FXOS 2.10(1.179)+. | | --- | --- | | Firepower 4112 | **9.16** (recommended)  9.14 | **7.0** (recommended)  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.16** (recommended)  9.14  9.12 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.16** (recommended)  9.14  9.12  9.8 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.9 | Firepower 4112 | 9.14 | 6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | 9.14  9.12 | 6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.14  9.12  9.8 | 6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.8 | Firepower 4112 | **9.14** | **6.6**   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- | |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.14** (recommended)  9.12   | **Note** | Firepower 9300 SM-56 requires ASA 9.12(2)+ | | --- | --- | | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.14** (recommended)  9.12  9.8 | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.157)   | **Note** | You can now run ASA 9.12+ and FTD 6.4+ on separate modules in the same Firepower 9300 chassis | | --- | --- | | Firepower 4145  Firepower 4125  Firepower 4115 | **9.12**   | **Note** | Firepower 9300 SM-56 requires ASA 9.12.2+ | | --- | --- | | **6.4** |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 | **6.4** (recommended)  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.131) | Firepower 9300 SM-48  Firepower 9300 SM-40 | **9.12** | Not supported |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.73) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | | **6.2.3** (recommended)   | **Note** | 6.2.3.16+ requires FXOS 2.3.1.157+ | | --- | --- | |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.66)  2.3(1.58) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | |  |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.2 | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.8** | Threat Defense versions are EoL |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |

#### Note on Downgrades

Downgrade of FXOS images is not
officially supported. The only Cisco-supported method of
downgrading an image version of FXOS is to perform a
complete re-image of the device.

## Download the Software from Cisco.com

Download all software packages from Cisco.com before you start your upgrade. Depending on the operating system and whether
you are using CLI or GUI, you should place the images on a server or on your management computer. See each installation procedure
for details on supported file locations.

| **Note** | ---   A Cisco.com login and Cisco service contract are required.   --- |
| --- | --- |

* [Download ASA Software](#ID-2152-0000008d)
* [Download FXOS for the Firepower 4100/9300](#ID-2152-0000008d)

### Download ASA Software

If you are using the ASDM Upgrade Wizard, you do not have to
pre-download the software. If you are manually upgrading, for example for a
failover upgrade, download the images to your local computer.

For a CLI upgrade, you can put the software on many server types, including TFTP, HTTP, and FTP. See the copy  command in the [ASA command reference](https://www.cisco.com/c/en/us/td/docs/security/asa/asa-command-reference/A-H/cmdref1/c4.html#pgfId-2171368).

ASA software can be downloaded from Cisco.com. These tables include naming conventions and
information about ASA packages.

Table 11. Current Platforms

| ASA Model | Download Location | Packages |
| --- | --- | --- |
| ASA virtual | <http://www.cisco.com/go/asav-software> |  |
| **ASA Software (Upgrade)**  Choose Adaptive Security Appliance (ASA) Software > *version*. | The ASA virtual upgrade file has a filename like asa962-**smp-k8.bin**; use this upgrade file for all hypervisors. **Note:** The .zip (VMware), .vhdx (Hyper-V), and .qcow2 (KVM) files are only for initial deployment.   | **Note** | To upgrade the ASA virtual for public cloud services such as Amazon Web Services, you can download the above image from Cisco.com (which requires a Cisco.com login and Cisco service contract) and perform the upgrade as described in this guide. There is no way to obtain an *upgrade* image from the public cloud service. | | --- | --- | |
| **ASDM Software (Upgrade)**  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| **ASA Device Package for Cisco Application Policy Infrastructure Controller (APIC)**  Choose ASA for Application Centric Infrastructure (ACI) Device Packages > *version*. | For APIC 1.2(7) and later, choose either the Policy Orchestration with Fabric Insertion, or the Fabric Insertion-only package. The device package software file has a filename like asa-device-pkg-1.2.7.10**.zip**. To install the ASA device package, see the “Importing a Device Package” chapter of the [Cisco APIC Layer 4 to Layer 7 Services Deployment Guide](http://www.cisco.com/c/en/us/support/cloud-systems-management/application-policy-infrastructure-controller-apic/tsd-products-support-series-home.html). |
| Firepower 1000 | <http://www.cisco.com/go/asa-firepower-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp1k.9.13.1**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-7131**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-7131.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| Secure Firewall 3100 | <https://cisco.com/go/asa-secure-firewall-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp3k.9.17.1**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-7171**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-7171.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| Firepower 4100 | <http://www.cisco.com/go/firepower4100-software> |  |
| **ASA and ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes both ASA and ASDM. The ASA package has a filename like cisco-asa.9.6.2**.SPA.csp**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-762**.bin**.   | **Note** | When you upgrade the ASA bundle in FXOS, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-782.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| Secure Firewall 4200 | <https://cisco.com/go/asa-secure-firewall-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp4200.9.20.1**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-7201**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-7201.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| Firepower 9300 | <http://www.cisco.com/go/firepower9300-software> |  |
| **ASA and ASDM Software**  Choose Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes both ASA and ASDM. The ASA package has a filename like cisco-asa.9.6.2**.SPA.csp**. |
| **ASDM Software (Upgrade)**  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-762**.bin**.   | **Note** | When you upgrade the ASA bundle in FXOS, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-782.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| **REST API Software**  Choose Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| ASA Services Module | **ASDM Software**  <http://www.cisco.com/go/asdm-software>  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| ISA 3000 | <http://www.cisco.com/go/isa3000-software> |  |
| **ASA Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**lfbff-k8.SPA**. |
| **ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |

Table 12. Legacy Platforms

| ASA Model | Download Location | Packages |
| --- | --- | --- |
| ASA 5506-X, ASA 5508-X, and ASA 5516-X | <http://www.cisco.com/go/asa-firepower-sw> |  |
| **ASA Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**lfbff-k8.SPA**. |
| **ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html) |
| **ROMMON Software**  Choose your *model* > ASA Rommon Software > *version*. | The ROMMON software file has a filename like asa5500-firmware-1108**.SPA**. |
| ASA 5512-X, ASA 5515-X, ASA 5525-X, ASA 5545-X, and ASA 5555-X | <http://www.cisco.com/go/asa-software> |  |
| **ASA Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**smp-k8.bin**. |
| **ASDM Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html) |
| **ASA Device Package for Cisco Application Policy Infrastructure Controller (APIC)**  Choose your *model* > Software on Chassis > ASA for Application Centric Infrastructure (ACI) Device Packages > *version*. | For APIC 1.2(7) and later, choose either the Policy Orchestration with Fabric Insertion, or the Fabric Insertion-only package. The device package software file has a filename like asa-device-pkg-1.2.7.10**.zip**. To install the ASA device package, see the “Importing a Device Package” chapter of the [Cisco APIC Layer 4 to Layer 7 Services Deployment Guide](http://www.cisco.com/c/en/us/support/cloud-systems-management/application-policy-infrastructure-controller-apic/tsd-products-support-series-home.html). |
| ASA 5585-X | <http://www.cisco.com/go/asa-software> |  |
| **ASA Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**smp-k8.bin**. |
| **ASDM Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| **ASA Device Package for Cisco Application Policy Infrastructure Controller (APIC)**  Choose your *model* > Software on Chassis > ASA for Application Centric Infrastructure (ACI) Device Packages > *version*. | For APIC 1.2(7) and later, choose either the Policy Orchestration with Fabric Insertion, or the Fabric Insertion-only package. The device package software file has a filename like asa-device-pkg-1.2.7.10**.zip**. To install the ASA device package, see the “Importing a Device Package” chapter of the [Cisco APIC Layer 4 to Layer 7 Services Deployment Guide](http://www.cisco.com/c/en/us/support/cloud-systems-management/application-policy-infrastructure-controller-apic/tsd-products-support-series-home.html). |
| Firepower 2100 | <http://www.cisco.com/go/asa-firepower-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp2k.9.8.2**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-782**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-782.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| ASA Services Module | **ASA Software**  <http://www.cisco.com/go/asasm-software>  Choose your *version*. | The ASA software file has a filename like asa962-**smp-k8.bin**. |
| **ASDM Software**  <http://www.cisco.com/go/asdm-software>  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| ISA 3000 | <http://www.cisco.com/go/isa3000-software> |  |
| **ASA Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**lfbff-k8.SPA**. |
| **ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |

### Download FXOS for the Firepower 4100/9300

FXOS packages for the Firepower 4100/9300 are available on the Cisco Support & Download
site.

* Firepower 4100 series: <http://www.cisco.com/go/firepower4100-software>
* Firepower 9300: <http://www.cisco.com/go/firepower9300-software>

To find FXOS packages, select or search for your Firepower appliance model, then browse to the
Firepower Extensible Operating System download page for the target version.

| **Note** | ---   If you plan to use the CLI to upgrade FXOS, copy the upgrade package to a server that the Firepower 4100/9300 can access using SCP, SFTP, TFTP, or FTP.   --- |
| --- | --- |

Table 13. FXOS Packages for the Firepower 4100/9300

| **Package Type** | **Package** |
| --- | --- |
| FXOS image | fxos-k9.version**.SPA** |
| Recovery (kickstart) | fxos-k9-**kickstart**.version**.SPA** |
| Recovery (manager) | fxos-k9-**manager**.version**.SPA** |
| Recovery (system) | fxos-k9-**system**.version**.SPA** |
| MIBs | fxos-**mibs**-fp9k-fp4k.version**.zip** |
| Firmware: Firepower 4100 series | fxos-k9-fpr4k-**firmware**.version**.SPA** |
| Firmware: Firepower 9300 | fxos-k9-fpr9k-**firmware**.version**.SPA** |

## Back Up Your Configurations

We recommend that you back up your configurations and other critical files before you upgrade, especially if there is a configuration
migration. Each operating system has a different method to perform backups. Check the ASA, ASDM, ASA FirePOWER local management,
Firepower Management Center, and FXOS configuration guides for more information.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_bd8eb837_20250115_123358.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Compatibility Information](/c/en/us/support/security/firepower-ngfw/products-device-support-tables-list.html)
# Cisco Secure Firewall Threat Defense Compatibility Guide

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.pdf)
  (375.7 KB)

  View with Adobe Reader on a variety of devices

Updated:January 13, 2025

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

# Cisco Secure Firewall Threat Defense Compatibility Guide

---

## Contents

* [Cisco
  Secure
  Firewall Threat Defense
  Compatibility Guide](#id_56932)
* [Suggested Release: Version 7.4.2](#Cisco_Reference.dita_51152350-7ccd-44e0-90be-cec52bebb020)
* [Threat Defense Platform Summary](#Cisco_Reference.dita_3c3a7148-33f3-4668-834c-ba9eca097785)
* [Threat Defense Hardware](#Cisco_Reference.dita_6d37561b-cfbc-4ce9-b7c9-efbb294bf3df)
* [Firepower 1000/2100 Series](#id_60525)
* [Secure Firewall 1200 Series](#r_ftd-1200)
* [Secure Firewall 3100/4200 Series](#r_ftd-3100-4200)
* [Firepower 4100/9300](#reference_6DF211D8F60F423387D0316000333539)
* [ASA 5500-X Series and ISA 3000](#id_34136)
* [Threat Defense Virtual](#id_37873)
* [Threat Defense High Availability and Clustering](#r_ftd-ha-scalability)
* [Threat Defense Management](#d54e7569a1635)
* [On-Prem Management Center](#device-management-onprem)
* [Cloud-delivered Firewall Management Center](#device-management-cloud)
* [Device Manager](#device-management-fdm)
* [Bundled Components](#id_67425)
* [Integrated Products](#reference_FB6BAC2CFBF446D5BA2CDD0E81F51C41)
* [Browser Requirements](#Cisco_Concept.dita_18039f61-fd2b-4b9f-ae6c-9fb2fa886dfd)
* [End-of-Life Announcements](#id_85448)
* [Terminology and Branding](#reference_9C7ED89DF14645BDA166E80F7BDA5FB7)

**First Published: May 5, 2022**

**Last Updated: January 13, 2025**

# Cisco Secure Firewall Threat Defense Compatibility Guide

This guide provides software and hardware compatibility for Cisco Secure
Firewall Threat Defense. For related compatibility guides, see the following table.

| **Note** | ---   Not all software versions, especially patches, apply to all platforms. A quick way to tell if a version is supported is that its upgrade/installation packages are posted on the Cisco Support & Download site. If the site is "missing" an upgrade or installation package, that version is not supported. You can also check the release notes and [End-of-Life Announcements](#id_85448). If you feel a version is missing in error, contact Cisco TAC.   --- |
| --- | --- |

Table 1. Additional Resources

| **Description** | **Resources** |
| --- | --- |
| ***Sustaining bulletins*** provide support timelines for the Cisco Next Generation Firewall product line, including management platforms and operating systems. | [Cisco NGFW Product Line Software Release and Sustaining Bulletin](https://www.cisco.com/c/en/us/products/collateral/security/firewalls/bulletin-c25-743178.html) |
| ***Compatibility guides*** provide detailed compatibility information for supported hardware models and software versions, including bundled components and integrated products. | [Cisco Secure Firewall Management Center Compatibility Guide](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/management-center-compatibility.html)  [Cisco Firepower 4100/9300 FXOS Compatibility](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/compatibility/fxos-compatibility.html) |
| ***Release notes*** provide critical and release-specific information, including upgrade warnings and behavior changes. Release notes also contain quicklinks to upgrade and installation instructions. | [Cisco Secure Firewall Threat Defense Release Notes](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-release-notes-list.html)  [Cisco Firepower 4100/9300 FXOS Release Notes](https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html) |
| ***New Feature guides*** provide information on new and deprecated features by release. | [Cisco Secure Firewall Management Center New Features by Release](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/roadmap/management-center-new-features-by-release.html)  [Cisco Secure Firewall Device Manager New Features by Release](https://www.cisco.com/c/en/us/td/docs/security/firepower/roadmap/fdm-new-features/firepower-device-manager-new-features-by-release.html) |
| ***Documentation roadmaps*** provide links to currently available and legacy documentation. Try the roadmaps if what you are looking for is not listed above. | [Navigating the Cisco Secure Firewall Threat Defense Documentation](https://www.cisco.com/c/en/us/td/docs/security/firepower/roadmap/firepower-roadmap.html)  [Navigating the Cisco FXOS Documentation](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/roadmap/fxos-roadmap.html) |

## Suggested Release: Version 7.4.2

To take advantage of new features and resolved issues, we recommend you upgrade all
eligible appliances to at least the suggested release, including the latest patch.
On the Cisco Support & Download
site, the suggested release is marked with a gold star. In Version 7.2.6+/7.4.1+, the
management center notifies you when a new suggested release is available, and
indicates suggested releases on its product upgrades page.

### Suggested Releases for Older Appliances

If an appliance is too old to run the suggested release and you do not plan to
refresh the hardware right now, choose a major version then patch as far as
possible. Some major versions are designated *long-term* or *extra
long-term*, so consider one of those. For an explanation of these terms, see
[Cisco NGFW Product Line Software
Release and Sustaining Bulletin](https://www.cisco.com/c/en/us/products/collateral/security/firewalls/bulletin-c25-743178.html).

If you are interested in a hardware refresh, contact your Cisco representative or
partner contact.

## Threat Defense Platform Summary

These tables summarize the supported devices and on-prem (customer-deployed)
management methods for threat
defense.

| **Note** | ---   The cloud-delivered Firewall Management Center can manage threat defense 7.0.3 to 7.6.0 (except 7.1). For Security Cloud Control with device manager, you must be running at least threat defense 6.4.   --- |
| --- | --- |

### Threat Defense Hardware

Table 2. Secure Firewall Threat
Defense Hardware by Manager and Version

| **Device Platform** | **Device Versions: With On-Prem Management Center** | **Device Versions: With Device Manager** |
| --- | --- | --- |
| Firepower 1010, 1120, 1140 | 6.4+ | 6.4+ |
| Firepower 1010E | 7.2.3+  No support in 7.3 | 7.2.3+  No support in 7.3 |
| Firepower 1150 | 6.5+ | 6.5+ |
| Secure Firewall 1210, 1220 | 7.6+ | 7.6+ |
| Firepower 2110, 2120, 2130, 2140 | 6.2.1 to 7.4 | 6.2.1 to 7.4 |
| Secure Firewall 3105 | 7.3.1+ | 7.3.1+ |
| Secure Firewall 3110, 3120, 3130, 3140 | 7.1+ | 7.1+ |
| Firepower 4110, 4120, 4140 | 6.0.1 to 7.2 | 6.5 to 7.2 |
| Firepower 4150 | 6.1 to 7.2 | 6.5 to 7.2 |
| Firepower 4115, 4125, 4145 | 6.4+ | 6.5+ |
| Firepower 4112 | 6.6+ | 6.6+ |
| Secure Firewall 4215, 4225, 4245 | 7.4.0+ | — |
| Firepower 9300: SM-24, SM-36, SM-44 | 6.0.1 to 7.2 | 6.5 to 7.2 |
| Firepower 9300: SM-40, SM-48, SM-56 | 6.4+ | 6.5+ |
| ISA 3000 | 6.2.3+ | 6.2.3+ |
| ASA 5506-X, 5506H-X, 5506W-X | 6.0.1 to 6.2.3 | 6.1 to 6.2.3 |
| ASA 5508-X, 5516-X | 6.0.1 to 7.0 | 6.1 to 7.0 |
| ASA 5512-X | 6.0.1 to 6.2.3 | 6.1 to 6.2.3 |
| ASA 5515-X | 6.0.1 to 6.4 | 6.1 to 6.4 |
| ASA 5525-X, 5545-X, 5555-X | 6.0.1 to 6.6 | 6.1 to 6.6 |

### Threat Defense Virtual

Table 3. Threat Defense Virtual by Manager and Version

| **Device Platform** | **Device Versions: With On-Prem Management Center** | **Device Versions: With Device Manager** |
| --- | --- | --- |
| **Public Cloud** | | |
| AWS | 6.0.1+ | 6.6+ |
| Azure | 6.2+ | 6.5+ |
| GCP | 6.7+ | 7.2+ |
| OCI | 6.7+ | — |
| Megaport | 7.2.8+ | 7.2.8+ |
| **On-Prem/Private Cloud** | | |
| HyperFlex | 7.0+ | 7.0+ |
| KVM | 6.1+ | 6.2.3+ |
| Nutanix | 7.0+ | 7.0+ |
| OpenStack | 7.0+ | — |
| VMware 8.0 | 7.4.2+ | 7.4.2+ |
| VMware 7.0 | 7.0+ | 7.0+ |
| VMware 6.7 | 6.5+ | 6.5+ |
| VMware 6.5 | 6.2.3+ | 6.2.3+ |
| VMware 6.0 | 6.0 to 6.7 | 6.2.2 to 6.7 |
| VMware 5.5 | 6.0.1 to 6.2.3 | 6.2.2 to 6.2.3 |
| VMware 5.1 | 6.0.1 only | — |

## Threat Defense Hardware

### Firepower 1000/2100 Series

Firepower 1000/2100 series devices use the FXOS operating
system. Upgrading threat defense automatically upgrades FXOS. For information on bundled
FXOS versions, see [Bundled Components](#id_67425). These devices can also run ASA instead of threat defense; see [Cisco Secure Firewall ASA
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

Table 4. Firepower 1000/2100 Series Compatibility

| **Threat Defense** | **Firepower 1150** | **Firepower 1010E** | **Firepower 1010**  **Firepower 1120**  **Firepower 1140** | **Firepower 2110**  **Firepower 2120**  **Firepower 2130**  **Firepower 2140** |
| --- | --- | --- | --- | --- |
| 7.6 | **YES** | **YES** | **YES** | — |
| 7.4.1–7.4.x | **YES** | **YES** | **YES** | **YES** |
| 7.4.0 | — | — | — | — |
| 7.3 | **YES** | — | **YES** | **YES** |
| 7.2 | **YES** | **YES**  Requires 7.2.3+ | **YES** | **YES** |
| 7.1 | **YES** | — | **YES** | **YES** |
| 7.0 | **YES** | — | **YES** | **YES** |
| 6.7 | **YES** | — | **YES** | **YES** |
| 6.6 | **YES** | — | **YES** | **YES** |
| 6.5 | **YES** | — | **YES** | **YES** |
| 6.4 | — | — | **YES** | **YES** |
| 6.3 | — | — | — | **YES** |
| 6.2.3 | — | — | — | **YES** |
| 6.2.2 | — | — | — | **YES** |
| 6.2.1 | — | — | — | **YES** |

### Secure Firewall 1200 Series

Secure Firewall 1200 series devices use the FXOS operating system. Upgrading threat
defense automatically upgrades FXOS. For information on bundled FXOS versions, see
[Bundled Components](#id_67425). These devices can also run ASA instead of threat defense; see
[Cisco Secure Firewall ASA
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

Table 5. Secure Firewall 1200 Series Compatibility

| **Threat Defense** | **Secure Firewall 1210**  **Secure Firewall 1220** |
| --- | --- |
| 7.6 | **YES** |

### Secure Firewall 3100/4200 Series

Secure Firewall 3100/4200 series devices use the FXOS operating system. How FXOS is upgraded depends on
whether the device is in application mode or multi-instance mode. These devices can
also run ASA instead of threat defense; see [Cisco Secure Firewall ASA
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

#### Application Mode

In application mode, upgrading threat
defense automatically upgrades FXOS. For information on bundled FXOS versions, see [Bundled Components](#id_67425).

Table 6. Secure Firewall 3100/4200 Series Application Mode Compatibility

| **Threat Defense** | **Secure Firewall 4215**  **Secure Firewall 4225**  **Secure Firewall 4245** | **Secure Firewall 3105** | **Secure Firewall 3110**  **Secure Firewall 3120**  **Secure Firewall 3130**  **Secure Firewall 3140** |
| --- | --- | --- | --- |
| 7.6 | **YES** | **YES** | **YES** |
| 7.4.1–7.4.x | **YES** | **YES** | **YES** |
| 7.4.0 | **YES** | — | — |
| 7.3 | — | **YES** | **YES** |
| 7.2 | — | — | **YES** |
| 7.1 | — | — | **YES** |

#### Multi-Instance Mode

In multi-instance mode, you upgrade the chassis (FXOS and firmware) and threat
defense separately. However, one package contains both components. It is possible to
have a chassis-only upgrade or a threat defense-only upgrade. For information on
bundled FXOS versions, see [Bundled Components](#id_67425).

Although you can run older threat defense instances on a newer
FXOS, new features and resolved issues
often require a full upgrade.

Table 7. Secure Firewall 3100/4200 Series Multi-Instance Mode Compatibility

| **Threat Defense** | **Secure Firewall 4215**  **Secure Firewall 4225**  **Secure Firewall 4245** | **Secure Firewall 3110**  **Secure Firewall 3120**  **Secure Firewall 3130**  **Secure Firewall 3140** |
| --- | --- | --- |
| 7.6 | **YES** | **YES** |
| 7.4.1–7.4.x | — | **YES** |

### Firepower 4100/9300

For the Firepower 4100/9300, major threat
defense versions have a specially qualified and recommended companion FXOS version,
listed below in **bold**. Use these combinations whenever possible, because we
perform enhanced testing for them. Note that the table lists the minimum build for
each FXOS version, but in most cases we recommend the latest. For more information,
see the [Cisco Firepower 4100/9300 FXOS Release
Notes](https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html).

| **Note** | ---   Although we document that FXOS 2.14.1.163+ is required for threat defense 7.4.x, this is for reimaging to 7.4.2+. If you are already running an earlier FXOS 2.14.1 build, you can successfully upgrade to 7.4.2+ without upgrading FXOS ([CSCwf64429](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwf64429)).   --- |
| --- | --- |

These devices can also run ASA instead of threat
defense. With ASA 9.12+ and threat
defense 6.4.0+, you can run both ASA and threat
defense on separate modules in the same Firepower 9300 chassis. For more information, see
[Cisco Firepower 4100/9300 FXOS
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/compatibility/fxos-compatibility.html).

Table 8. Firepower 4100/9300 Compatibility

| **Threat Defense** | **FXOS** | **Firepower 9300** | | **Firepower 4100 Series** | | | |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **SM-24**  **SM-36**  **SM-44** | **SM-40**  **SM-48**  **SM-56** | **4110**  **4120**  **4140** | **4150** | **4112** | **4115**  **4125**  **4145** |
| 7.6 | **2.16.0.128+** | — | **YES** | — | — | **YES** | **YES** |
| 7.4.1–7.4.x | **2.14.1.163+**  2.16.0.128+ | — | **YES** | — | — | **YES** | **YES** |
| 7.4.0 | — | — | — | — | — | — | — |
| 7.3 | **2.13.0.198+**  2.14.1.163+  2.16.0.128+ | — | **YES** | — | — | **YES** | **YES** |
| 7.2 | **2.12.0.31+**  2.13.0.198+  2.14.1.163+  2.16.0.128+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 7.1 | **2.11.1.154+**  2.12.0.31+  2.13.0.198+  2.14.1.163+  2.16.0.128+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 7.0 | **2.10.1.159+**  2.11.1.154+  2.12.0.31+  2.13.0.198+  2.14.1.163+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 6.7 | **2.9.1.131+**  2.10.1.159+  2.11.1.154+  2.12.0.31+  2.13.0.198+  2.14.1.163+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 6.6 | **2.8.1.105+**  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+  2.13.0.198+  2.14.1.163+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 6.5 | **2.7.1.92+**  2.8.1.105+  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+ | **YES** | **YES** | **YES** | **YES** | — | **YES** |
| 6.4 | **2.6.1.157+**  2.7.1.92+  2.8.1.105+  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+ | **YES** | **YES** | **YES** | **YES** | — | **YES** |
| 6.3 | **2.4.1.214+**  2.6.1.157+  2.7.1.92+  2.8.1.105+  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+ | **YES** | — | **YES** | **YES** | — | — |
| 6.2.3 | **2.3.1.73+**  2.4.1.214+  2.6.1.157+  2.7.1.92+  2.8.1.105+   | **Note** | Firepower 6.2.3.16+ requires FXOS 2.3.1.157+. | | --- | --- | | **YES** | — | **YES** | **YES** | — | — |
| 6.2.2 | **2.2.2.x**  2.3.1.73+  2.4.1.214+  2.6.1.157+  2.7.1.92+ | **YES** | — | **YES** | **YES** | — | — |
| 6.2.1 | — | — | — | — | — | — | — |
| 6.2.0 | **2.1.1.x**, **2.2.1.x**, **2.2.2.x**  2.3.1.73+  2.4.1.214+  2.6.1.157+ | **YES** | — | **YES** | **YES** | — | — |
| 6.1 | **2.0.1.x**  2.1.1.x  2.3.1.73+ | **YES** | — | **YES** | **YES** | — | — |
| 6.0.1 | **1.1.4.x**  2.0.1.x | **YES** | — | **YES** | — | — | — |

### ASA 5500-X Series and ISA 3000

ASA 5500-X series and ISA 3000 devices use the ASA operating
system. Upgrading threat
defense automatically upgrades ASA. For information on the bundled ASA versions, see [Bundled Components](#id_67425).

Version 7.0 is the last major threat
defense release that supports ASA 5500-X series devices.

Table 9. ASA 5500-X Series and ISA 3000
Compatibility

| **Threat Defense** | **ISA 3000** | **ASA 5508-X**  **ASA 5516-X** | **ASA 5525-X**  **ASA 5545-X**  **ASA 5555-X** | **ASA 5515-X** | **ASA 5506-X**  **ASA 5506H-X**  **ASA 5506W-X**  **ASA 5512-X** |
| --- | --- | --- | --- | --- | --- |
| 7.6 | **YES** | — | — | — | — |
| 7.4.1–7.4.x | **YES** | — | — | — | — |
| 7.4.0 | — | — | — | — | — |
| 7.3 | **YES** | — | — | — | — |
| 7.2 | **YES** | — | — | — | — |
| 7.1 | **YES** | — | — | — | — |
| 7.0 | **YES** | **YES** | — | — | — |
| 6.7 | **YES** | **YES** | — | — | — |
| 6.6 | **YES** | **YES** | **YES** | — | — |
| 6.5 | **YES** | **YES** | **YES** | — | — |
| 6.4 | **YES** | **YES** | **YES** | **YES** | — |
| 6.3 | **YES** | **YES** | **YES** | **YES** | — |
| 6.2.3 | **YES** | **YES** | **YES** | **YES** | **YES** |
| 6.2.2 | — | **YES** | **YES** | **YES** | **YES** |
| 6.2.1 | — | — | — | — | — |
| 6.2.0 | — | **YES** | **YES** | **YES** | **YES** |
| 6.1 | — | **YES** | **YES** | **YES** | **YES** |
| 6.0.1 | — | **YES** | **YES** | **YES** | **YES** |

## Threat Defense Virtual

Table 10. Threat Defense Virtual Compatibility: Public Cloud

| **Threat Defense Virtual** | **Amazon Web Services (AWS)** | **Microsoft Azure (Azure)** | **Google Cloud Platform (GCP)** | Megaport Virtual Edge (Megaport) | **Oracle Cloud Infrastructure (OCI)** |
| --- | --- | --- | --- | --- | --- |
| 7.6 | **YES** | **YES** | **YES** | **YES** | **YES** |
| 7.4.1–7.4.x | **YES** | **YES** | **YES** | **YES** | **YES** |
| 7.4.0 | — | — | — | — | — |
| 7.3 | **YES** | **YES** | **YES** | **YES** | **YES** |
| 7.2 | **YES** | **YES** | **YES** | **YES**  Requires 7.2.8+ | **YES** |
| 7.1 | **YES** | **YES** | **YES** | — | **YES** |
| 7.0 | **YES** | **YES** | **YES** | — | **YES** |
| 6.7 | **YES** | **YES** | **YES** | — | **YES** |
| 6.6 | **YES** | **YES** | — | — | — |
| 6.6 | **YES** | **YES** | — | — | — |
| 6.4 | **YES** | **YES** | — | — | — |
| 6.3 | **YES** | **YES** | — | — | — |
| 6.2.3 | **YES** | **YES** | — | — | — |
| 6.2.2 | **YES** | **YES** | — | — | — |
| 6.2.1 | — | — | — | — | — |
| 6.2 | **YES** | **YES** | — | — | — |
| 6.1 | **YES** | — | — | — | — |
| 6.0.1 | **YES** | — | — | — | — |

Table 11. Threat Defense Virtual Compatibility: On-Prem/Private Cloud

| **Threat Defense Virtual** | **VMware vSphere/VMware ESXi** | **Cisco HyperFlex (HyperFlex)** | **Kernel-Based Virtual Machine (KVM)** | **Nutanix Enterprise Cloud (Nutanix)** | **OpenStack** |
| --- | --- | --- | --- | --- | --- |
| 7.6 | **YES**  VMware 6.5, 6.7, 7.0, 8.0 | **YES** | **YES** | **YES** | **YES** |
| 7.4.2–7.4.x | **YES**  VMware 6.5, 6.7, 7.0, 8.0 | **YES** | **YES** | **YES** | **YES** |
| 7.4.1 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.4.0 | — | — | — | — | — |
| 7.3 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.2 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.1 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.0 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 6.7 | **YES**  VMware 6.0, 6.5, 6.7 | — | **YES** | — | — |
| 6.6 | **YES**  VMware 6.0, 6.5, 6.7 | — | **YES** | — | — |
| 6.5 | **YES**  VMware 6.0, 6.5, 6.7 | — | **YES** | — | — |
| 6.4 | **YES**  VMware 6.0, 6.5 | — | **YES** | — | — |
| 6.3 | **YES**  VMware 6.0, 6.5 | — | **YES** | — | — |
| 6.2.3 | **YES**  VMware 5.5, 6.0, 6.5 | — | **YES** | — | — |
| 6.2.2 | **YES**  VMware 5.5, 6.0 | — | **YES** | — | — |
| 6.2.1 | — | — | — | — | — |
| 6.2.0 | **YES**  VMware 5.5, 6.0 | — | **YES** | — | — |
| 6.1 | **YES**  VMware 5.5, 6.0 | — | **YES** | — | — |
| 6.0.1 | **YES**  VMware 5.1, 5.5 | — | — | — | — |

## Threat Defense High Availability and Clustering

These tables list threat defense support for high availability and clustering. For
threat defense hardware, support differs depending on whether you are using
standalone devices (also called native instances or application mode) or container
instances (also called multi-instance mode). Threat defense virtual does not support
container instances.

### Standalone Devices

This table lists threat defense hardware support for high availability and clustering
with standalone devices. In management center deployments, all threat defense
hardware supports high availability. For device manager, high availability support
begins in Version 6.3 and clustering is not supported.

Table 12. Hardware Standalone Devices: High Availability and Clustering Support

| **Platform** | **High Availability** | **Clustering** |
| --- | --- | --- |
| Firepower 1000 | **YES** | — |
| Secure Firewall 1200 | **YES** | — |
| Firepower 2100 | **YES** | — |
| Secure Firewall 3100 | **YES** | 7.6+ (16 node)  7.1+ (8 node) |
| Secure Firewall 4200 | **YES** | 7.6+ (16 node)  7.4+ (8 node) |
| Firepower 4100 | **YES** | 7.2+ (16 node)  6.2+ (6 node) |
| Firepower 9300 | **YES** | 7.2+ (16 node)  6.2+ (6 node)  Intra-chassis clustering (3 node) is also supported in all versions. |
| ASA 5500-X | **YES** | — |
| ISA 3000 | **YES** | — |

This table lists threat defense virtual support for high availability (with
management center or device manager) and clustering (management center
only).

Table 13. Virtual Standalone Devices: High Availability and Clustering Support

| **Platform** | **High Availability** | **Clustering** |
| --- | --- | --- |
| **Public Cloud** | | |
| AWS | — | 7.2+ (16 node) |
| Azure | — | 7.3+ (16 node) |
| GCP | — | 7.3+ (16 node) |
| Megaport | 7.2.8+ | — |
| OCI | — | — |
| **On-Prem/Private Cloud** | | |
| HyperFlex | — | — |
| KVM | 7.3+ | 7.4.1+ (16 node)  7.2+ (4 node) |
| Nutanix | — | — |
| OpenStack | — | — |
| VMware | 6.7+ | 7.4.1+ (16 node)  7.2+ (4 node) |

### Container Instances

This table lists support for high availability and clustering with container
instances, which is available on select threat defense hardware in management center
deployments only.

Table 14. Container Instances: High Availability and Clustering Support

| **Platform** | **High Availability** | **Clustering** |
| --- | --- | --- |
| Secure Firewall 3100 series | 7.4.1+ | — |
| Secure Firewall 4200 series | 7.6+ | — |
| Firepower 4100 series | 6.3+ | 7.2+ (16 node)  6.6+ (6 node) |
| Firepower 9300 | 6.3+ | 7.2+ (16 node)  6.6+ (6 node)  Intra-chassis clustering (3 node) is also supported in Version 6.6+. |

Threat Defense Management

## On-Prem Management Center

All devices support remote management with a customer-deployed (*on-prem*)
management center.

Versions are major (A.x), maintenance (A.x.y), or patch (A.x.y.z). The management
center should run the same or newer version as its devices. New features and
resolved issues often require the latest version on both the management center and its devices, including patches. Upgrade the management center first—you will still be able to manage older devices, usually a few major
versions
back

| **Note** | ---   You cannot upgrade a device past the management center to a newer major or maintenance version. Although a patched device (fourth-digit) can be managed with an unpatched management center, fully patched deployments undergo enhanced testing.   --- |
| --- | --- |

Note
that in most cases you can upgrade an older device directly to the management center's major or maintenance version. However, sometimes you can manage an older
device that you cannot directly upgrade, even though the target version is
supported on the device. And rarely, there are issues with specific management center-device combinations. For release-specific requirements, see the release
notes.

Table 15. On-Prem Management
Center-Device Compatibility

| **Management Center Version** | **Oldest Device Version You Can Manage** |
| --- | --- |
| 7.6 | 7.1 |
| 7.4  Last support for NGIPS device management. | 7.0 |
| 7.3 | 6.7 |
| 7.2 | 6.6 |
| 7.1 | 6.5 |
| 7.0 | 6.4 |
| 6.7 | 6.3 |
| 6.6 | 6.2.3 |
| 6.5 | 6.2.3 |
| 6.4 | 6.1 |
| 6.3 | 6.1 |
| 6.2.3 | 6.1 |
| 6.2.2 | 6.1 |
| 6.2.1 | 6.1 |
| 6.2 | 6.1 |
| 6.1 | 5.4.0.2/5.4.1.1 |
| 6.0.1 | 5.4.0.2/5.4.1.1 |
| 6.0 | 5.4.0.2/5.4.1.1 |
| 5.4.1 | 5.4.1 for ASA FirePOWER on the ASA-5506-X series, ASA5508-X, and ASA5516-X.  5.3.1 for ASA FirePOWER on the ASA5512-X, ASA5515-X, ASA5525-X, ASA5545-X, ASA5555-X, and ASA-5585-X series.  5.3.0 for Firepower 7000/8000 series and legacy devices. |

## Cloud-delivered Firewall Management Center

The cloud-delivered Firewall Management Center can manage threat
defense devices running **Version 7.0.3 to 7.6.0 (except Version 7.1)**.

You can co-manage a cloud-managed device with a Version 7.2+ on-prem management center for event logging and analytics purposes only. Or, you can send security events
to the Cisco cloud with Security
Analytics and Logging (SaaS).

### Co-managing Devices with an Analytics Management Center

The cloud-delivered Firewall
Management Center supports a wider range of managed device versions than on-prem management
centers. This can cause issues if you use an on-prem management center for
analytics because devices can be "too old" or "too new" to co-manage.

You can be prevented from:

* Registering newer devices to the analytics management center because
  older devices are blocking the required management center upgrade.
* Upgrading co-managed devices to the latest release, because the analytics
  management center is "stuck" at an older release.
* Reverting device upgrade, if revert would take the device out of
  compatibility with the analytics management center.

For example, consider a scenario where you want to add co-managed Version 7.6.0
devices to a deployment that currently includes co-managed Version 7.0.x
devices. The cloud-delivered Firewall
Management Center can manage this full range of devices, but the on-prem analytics management
center cannot.

In order of preference, you can:

* Upgrade the Version 7.0.x devices to at least Version 7.2.0, upgrade the
  analytics management center to Version 7.6.0, then add the Version 7.6.0
  devices to both management centers.
* Remove the Version 7.0.x devices from the analytics management center,
  upgrade the analytics management center to Version 7.6.0, then add the
  Version 7.6.0 devices to both management centers.
* Leave the analytics management center as it is and do not add your
  Version 7.6.0 devices.

That is, your choices are:

* To get events from all devices, upgrade (or replace) the analytics
  management center and your older devices.
* To forgo events from older devices, upgrade (or replace) the analytics
  management center only.
* To forgo events from newer devices, leave the analytics management center
  at an older release.

## Device Manager

You can use device
manager to locally manage a single threat
defense device. Most models suppport local management.

Optionally, add Cisco Security Cloud Control to remotely manage multiple threat
defense devices, as an alternative to the management center. Although some configurations still require device
manager, Security Cloud Control allows you to establish and maintain consistent security policies across your threat
defense deployment.

## Bundled Components

These tables list the versions of various
components bundled with threat
defense. Use this information to identify open or resolved bugs in bundled components
that may affect your deployment.

Note that sometimes we release updated builds for select releases. If bundled
components change from build to build, we list the components in the *latest*
build. (In most cases, only the latest build is available for
download.)
For details on new builds and the issues they resolve, see the release notes for
your version.

### Operating Systems

ASA 5500-X series and ISA 3000 devices use the ASA operating system. Firepower
1000/2100, Secure Firewall 1200, and Secure Firewall 3100/4200 series devices use
the FXOS operating system. For the Firepower 4100/9300, see [Firepower 4100/9300](#reference_6DF211D8F60F423387D0316000333539).

Table 16.

| **Threat Defense** | **ASA** | **FXOS** |
| --- | --- | --- |
| 7.6.0 | 9.22(1.1) | 2.16.0.128 |
| 7.4.2.1 | 9.20.2.36 | 2.14.1.176 |
| 7.4.2 | 9.20(2.32) | 2.14.1.167 |
| 7.4.1.1 | 9.20(2.201) | 2.14.1.131 |
| 7.4.1 | 9.20(2.2) | 2.14.1.131 |
| 7.4.0 | 9.20(1.84) | 2.14.0.475 |
| 7.3.1.1 | 9.19(1.202) | 2.13.0.1022 |
| 7.3.1 | 9.19(1.200) | 2.13.0.1022 |
| 7.3.0 | 9.19(1) | 2.13.0.198 |
| 7.2.9 | 9.18(4.47) | 2.12.1.86 |
| 7.2.8.1 | 9.18(4.212) | 2.12.1.1703 |
| 7.2.8 | 9.18(4.210) | 2.12.1.73 |
| 7.2.7 | 9.18(4.201) | 2.12.1.73 |
| 7.2.6 | 9.18(4.22) | 2.12.1.73 |
| 7.2.5.2 | 9.18(3.61) | 2.12.0.530 |
| 7.2.5.1 | 9.18(3.60) | 2.12.0.530 |
| 7.2.5 | 9.18(3.53) | 2.12.0.519 |
| 7.2.4.1 | 9.18(3.53) | 2.12.0.519 |
| 7.2.4 | 9.18(3.39) | 2.12.0.499 |
| 7.2.3.1 | — | — |
| 7.2.3 | 9.18(2.219) | 2.12.0.1030 |
| 7.2.2 | 9.18(2.200) | 2.12.0.1104 |
| 7.2.1 | 9.18(2.4) | 2.12.0.442 |
| 7.2.0.1 | 9.18(1.200) | 2.12.0.31 |
| 7.2.0 | 9.18(1) | 2.12.0.31 |
| 7.1.0.3 | 9.17(1.24) | 2.11.1.191 |
| 7.1.0.2 | 9.17(1.201) | 2.11.1.1300 |
| 7.1.0.1 | 9.17(1.150) | 2.11.1.154 |
| 7.1.0 | 9.17(1.0) | 2.11.1.154 |
| 7.0.6.3 | 9.16(4.70) | 2.10.1.1633 |
| 7.0.6.2 | 9.16(4.57) | 2.10.1.1625 |
| 7.0.6.1 | 9.16(4.45) | 2.10.1.1614 |
| 7.0.6 | 9.16(4.35) | 2.10.1.1603 |
| 7.0.5.1 | — | — |
| 7.0.5 | 9.16(4.200) | 2.10.1.1400 |
| 7.0.4 | 9.16(3.18) | 2.10.1.208 |
| 7.0.3 | 9.16(3.201) | 2.10.1.1200 |
| 7.0.2.1 | 9.16(3.200) | 2.10.1.192 |
| 7.0.2 | 9.16(3.11) | 2.10.1.192 |
| 7.0.1.1 | 9.16(2.5) | 2.10.1.175 |
| 7.0.1 | 9.16(2.5) | 2.10.1.175 |
| 7.0.0.1 | 9.16(1.25) | 2.10.1.159 |
| 7.0.0 | 9.16(1) | 2.10.1.159 |
| 6.7.0.3 | 9.15(1.19) | 2.9.1.138 |
| 6.7.0.2 | 9.15(1.15) | 2.9.1.138 |
| 6.7.0.1 | 9.15(1.8) | 2.9.1.135 |
| 6.7.0 | 9.15(1) | 2.9.1.131 |
| 6.6.7.2 | 9.14(4.201) | 2.8.1.192 |
| 6.6.7.1 | 9.14(4.21) | 2.8.1.192 |
| 6.6.7 | 9.14(4.13) | 2.8.1.186 |
| 6.6.5.2 | 9.14(3.22) | 2.8.1.172 |
| 6.6.5.1 | 9.14(3.15) | 2.8.1.172 |
| 6.6.5 | 9.14(3.6) | 2.8.1.165 |
| 6.6.4 | 9.14(2.155) | 2.8.1.1148 |
| 6.6.3 | 9.14(2.151) | 2.8.1.1146 |
| 6.6.1 | 9.14(1.150) | 2.8.1.129 |
| 6.6.0.1 | 9.14(1.216) | 2.8.1.105 |
| 6.6.0 | 9.14(1.1) | 2.8.1.105 |
| 6.5.0.5 | 9.13(1.18) | 2.7.1.129 |
| 6.5.0.4 | 9.13(1.5) | 2.7.1.117 |
| 6.5.0.3 | 9.13(1.4) | 2.7.1.117 |
| 6.5.0.2 | 9.13(1.151) | 2.7.1.115 |
| 6.5.0.1 | 9.13(1.2) | 2.7.1.115 |
| 6.5.0 | 9.13(1) | 2.7.1.107 |
| 6.4.0.18 | 9.12(4.68) | 2.6.1.272 |
| 6.4.0.17 | 9.12(4.62) | 2.6.1.265 |
| 6.4.0.16 | 9.12(4.54) | 2.6.1.260 |
| 6.4.0.15 | 9.12(4.41) | 2.6.1.254 |
| 6.4.0.14 | 9.12(4.37) | 2.6.1.239 |
| 6.4.0.13 | 9.12(4.37) | 2.6.1.239 |
| 6.4.0.12 | 9.12(4.152) | 2.6.1.230 |
| 6.4.0.11 | 9.12(2.40) | 2.6.1.214 |
| 6.4.0.10 | 9.12(2.38) | 2.6.1.214 |
| 6.4.0.9 | 9.12(2.33) | 2.6.1.201 |
| 6.4.0.8 | 9.12(2.18) | 2.6.1.166 |
| 6.4.0.7 | 9.12(2.151) | 2.6.1.156 |
| 6.4.0.6 | 9.12(2.12) | 2.6.1.156 |
| 6.4.0.5 | 9.12(2.4) | 2.6.1.144 |
| 6.4.0.4 | 9.12(2.4) | 2.6.1.144 |
| 6.4.0.3 | 9.12(1.12) | 2.6.1.133 |
| 6.4.0.2 | 9.12(1.10) | 2.6.1.133 |
| 6.4.0.1 | 9.12(1.7) | 2.6.1.133 |
| 6.4.0 | 9.12(1.6) | 2.6.1.133 |
| 6.3.0.5 | 9.10(1.31) | 2.4.1.255 |
| 6.3.0.4 | 9.10(1.28) | 2.4.1.248 |
| 6.3.0.3 | 9.10(1.18) | 2.4.1.237 |
| 6.3.0.2 | 9.10(1.12) | 2.4.1.237 |
| 6.3.0.1 | 9.10(1.8) | 2.4.1.222 |
| 6.3.0 | 9.10(1.3) | 2.4.1.216 |
| 6.2.3.18 | 9.9(2.91) | 2.3.1.219 |
| 6.2.3.17 | 9.9(2.88) | 2.3.1.217 |
| 6.2.3.16 | 9.9(2.74) | 2.3.1.180 |
| 6.2.3.15 | 9.9(2.60) | 2.3.1.167 |
| 6.2.3.14 | 9.9(2.55) | 2.3.1.151 |
| 6.2.3.13 | 9.9(2.51) | 2.3.1.144 |
| 6.2.3.12 | 9.9(2.48) | 2.3.1.144 |
| 6.2.3.11 | 9.9(2.43) | 2.3.1.132 |
| 6.2.3.10 | 9.9(2.41) | 2.3.1.131 |
| 6.2.3.9 | 9.9(2.37) | 2.3.1.122 |
| 6.2.3.8 | 9.9(2.37) | 2.3.1.122 |
| 6.2.3.7 | 9.9(2.32) | 2.3.1.118 |
| 6.2.3.6 | 9.9(2.26) | 2.3.1.115 |
| 6.2.3.5 | 9.9(2.245) | 2.3.1.108 |
| 6.2.3.4 | 9.9(2.15) | 2.3.1.108 |
| 6.2.3.3 | 9.9(2.13) | 2.3.1.104 |
| 6.2.3.2 | 9.9(2.8) | 2.3.1.85 |
| 6.2.3.1 | 9.9(2.4) | 2.3.1.84 |
| 6.2.3 | 9.9(2) | 2.3.1.84 |
| 6.2.2.5 | 9.8(2.44) | 2.2.2.107 |
| 6.2.2.4 | 9.8(2.36) | 2.2.2.86 |
| 6.2.2.3 | 9.8(2.30) | 2.2.2.79 |
| 6.2.2.2 | 9.8(2.22) | 2.2.2.75 |
| 6.2.2.1 | 9.8(2.10) | 2.2.2.63 |
| 6.2.2 | 9.8(2.3) | 2.2.2.52 |
| 6.2.1 | 9.8(1) | 2.2.1.49 |
| 6.2.0.6 | 9.7(1.25) | — |
| 6.2.0.5 | 9.7(1.23) | — |
| 6.2.0.4 | 9.7(1.19) | — |
| 6.2.0.3 | 9.7(1.15) | — |
| 6.2.0.2 | 9.7(1.10) | — |
| 6.2.0.1 | 9.7(1.7) | — |
| 6.2.0 | 9.7(1.4) | — |
| 6.1.0.7 | 9.6(4.12) | — |
| 6.1.0.6 | 9.6(3.23) | — |
| 6.1.0.5 | 9.6(2.21) | — |
| 6.1.0.4 | 9.6(2.16) | — |
| 6.1.0.3 | 9.6(2.16) | — |
| 6.1.0.2 | 9.6(2.4) | — |
| 6.1.0.1 | 9.6(2.4) | — |
| 6.1.0 | 9.6(2) | — |
| 6.0.1.4 | 9.6(1.19) | — |
| 6.0.1.3 | 9.6(1.12) | — |
| 6.0.1.2 | 9.6(1.11) | — |
| 6.0.1.1 | 9.6(1) | — |
| 6.0.1 | 9.6(1) | — |
| 6.0.0.1 | 9.6(1) | — |
| 6.0.0 | 9.6(1) | — |

### Snort

Snort is the main inspection engine. Snort
3 is available in Version 6.7+ with device
manager, and Version 7.0+ with management center.

Table 17.

| **Threat Defense** | **Snort 2** | **Snort 3** |
| --- | --- | --- |
| 7.6.0 | 2.9.23-227 | 3.1.79.1-121 |
| 7.4.2.1 | 2.9.22-2000 | 3.1.53.201-112 |
| 7.4.2 | 2.9.22-2000 | 3.1.53.200-107 |
| 7.4.1.1 | 2.9.22-1103 | 3.1.53.100-56 |
| 7.4.1 | 2.9.22-1009 | 3.1.53.100-56 |
| 7.4.0 | 2.9.22-181 | 3.1.53.1-40 |
| 7.3.1.1 | 2.9.21-1109 | 3.1.36.101-2 |
| 7.3.1 | 2.9.21-1000 | 3.1.36.100-2 |
| 7.3.0 | 2.9.21-105 | 3.1.36.1-101 |
| 7.2.9 | 2.9.20-9000 | 3.1.21.900-7 |
| 7.2.8.1 | 2.9.20-8101 | 3.1.21.800-2 |
| 7.2.8 | 2.9.20-8005 | 3.1.21.800-2 |
| 7.2.7 | 2.9.20-6102 | 3.1.21.600-26 |
| 7.2.6 | 2.9.20-6102 | 3.1.21.600-26 |
| 7.2.5.2 | 2.9.20-5201 | 3.1.21.501-27 |
| 7.2.5.1 | 2.9.20-5100 | 3.1.21.501-26 |
| 7.2.5 | 2.9.20-5002 | 3.1.21.500-21 |
| 7.2.4.1 | 2.9.20-4103 | 3.1.21.401-6 |
| 7.2.4 | 2.9.20-4004 | 3.1.21.400-24 |
| 7.2.3.1 | 2.9.20-3100 | 3.1.21.100-7 |
| 7.2.3 | 2.9.20-3010 | 3.1.21.100-7 |
| 7.2.2 | 2.9.20-2001 | 3.1.21.100-7 |
| 7.2.1 | 2.9.20-1000 | 3.1.21.100-7 |
| 7.2.0.1 | 2.9.20-108 | 3.1.21.1-126 |
| 7.2.0 | 2.9.20-107 | 3.1.21.1-126 |
| 7.1.0.3 | 2.9.19-3000 | 3.1.7.3-210 |
| 7.1.0.2 | 2.9.19-2000 | 3.1.7.2-200 |
| 7.1.0.1 | 2.9.19-1013 | 3.1.7.2-200 |
| 7.1.0 | 2.9.19-92 | 3.1.7.1-108 |
| 7.0.6.3 | 2.9.18-6306 | 3.1.0.603-31 |
| 7.0.6.2 | 2.9.18-6201 | 3.1.0.602-26 |
| 7.0.6.1 | 2.9.18-6008 | 3.1.0.600-20 |
| 7.0.6 | 2.9.18-6008 | 3.1.0.600-20 |
| 7.0.5.1 | 2.9.18-5100 | — |
| 7.0.5 | 2.9.18-5002 | 3.1.0.500-7 |
| 7.0.4 | 2.9.18-4002 | 3.1.0.400-12 |
| 7.0.3 | 2.9.18-3005 | 3.1.0.300-3 |
| 7.0.2.1 | 2.9.18-2101 | 3.1.0.200-16 |
| 7.0.2 | 2.9.18-2022 | 3.1.0.200-16 |
| 7.0.1.1 | 2.9.18-1026 | 3.1.0.100-11 |
| 7.0.1 | 2.9.18-1026 | 3.1.0.100-11 |
| 7.0.0.1 | 2.9.18-1001 | 3.1.0.1-174 |
| 7.0.0 | 2.9.18-174 | 3.1.0.1-174 |
| 6.7.0.3 | 2.9.17-3014 | 3.0.1.4-129 |
| 6.7.0.2 | 2.9.17-2003 | 3.0.1.4-129 |
| 6.7.0.1 | 2.9.17-1006 | 3.0.1.4-129 |
| 6.7.0 | 2.9.17-200 | 3.0.1.4-129 |
| 6.6.7.2 | 2.9.16-7101 | — |
| 6.6.7.1 | 2.9.16-7100 | — |
| 6.6.7 | 2.9.16-7017 | — |
| 6.6.5.2 | 2.9.16-5204 | — |
| 6.6.5.1 | 2.9.16-5107 | — |
| 6.6.5 | 2.9.16-5034 | — |
| 6.6.4 | 2.9.16-4022 | — |
| 6.6.3 | 2.9.16-3033 | — |
| 6.6.1 | 2.9.16-1025 | — |
| 6.6.0.1 | 2.9.16-140 | — |
| 6.6.0 | 2.9.16-140 | — |
| 6.5.0.5 | 2.9.15-15510 | — |
| 6.5.0.4 | 2.9.15-15201 | — |
| 6.5.0.3 | 2.9.15-15201 | — |
| 6.5.0.2 | 2.9.15-15101 | — |
| 6.5.0.1 | 2.9.15-15101 | — |
| 6.5.0 | 2.9.15-7 | — |
| 6.4.0.18 | 2.9.14-28000 | — |
| 6.4.0.17 | 2.9.14-27005 | — |
| 6.4.0.16 | 2.9.14-26002 | — |
| 6.4.0.15 | 2.9.14-25006 | — |
| 6.4.0.14 | 2.9.14-24000 | — |
| 6.4.0.13 | 2.9.14-19008 | — |
| 6.4.0.12 | 2.9.14-18011 | — |
| 6.4.0.11 | 2.9.14-17005 | — |
| 6.4.0.10 | 2.9.14-16023 | — |
| 6.4.0.9 | 2.9.14-15906 | — |
| 6.4.0.8 | 2.9.14-15707 | — |
| 6.4.0.7 | 2.9.14-15605 | — |
| 6.4.0.6 | 2.9.14-15605 | — |
| 6.4.0.5 | 2.9.14-15507 | — |
| 6.4.0.4 | 2.9.12-15301 | — |
| 6.4.0.3 | 2.9.14-15301 | — |
| 6.4.0.2 | 2.9.14-15209 | — |
| 6.4.0.1 | 2.9.14-15100 | — |
| 6.4.0 | 2.9.14-15003 | — |
| 6.3.0.5 | 2.9.13-15503 | — |
| 6.3.0.4 | 2.9.13-15409 | — |
| 6.3.0.3 | 2.9.13-15307 | — |
| 6.3.0.2 | 2.9.13-15211 | — |
| 6.3.0.1 | 2.9.13-15101 | — |
| 6.3.0 | 2.9.13-15013 | — |
| 6.2.3.18 | 2.9.12-1813 | — |
| 6.2.3.17 | 2.9.12-1605 | — |
| 6.2.3.16 | 2.9.12-1605 | — |
| 6.2.3.15 | 2.9.12-1513 | — |
| 6.2.3.14 | 2.9.12-1401 | — |
| 6.2.3.13 | 2.9.12-1306 | — |
| 6.2.3.12 | 2.9.12-1207 | — |
| 6.2.3.11 | 2.9.12-1102 | — |
| 6.2.3.10 | 2.9.12-902 | — |
| 6.2.3.9 | 2.9.12-806 | — |
| 6.2.3.8 | 2.9.12-804 | — |
| 6.2.3.7 | 2.9.12-704 | — |
| 6.2.3.6 | 2.9.12-607 | — |
| 6.2.3.5 | 2.9.12-506 | — |
| 6.2.3.4 | 2.9.12-383 | — |
| 6.2.3.3 | 2.9.12-325 | — |
| 6.2.3.2 | 2.9.12-270 | — |
| 6.2.3.1 | 2.9.12-204 | — |
| 6.2.3 | 2.9.12-136 | — |
| 6.2.2.5 | 2.9.11-430 | — |
| 6.2.2.4 | 2.9.11-371 | — |
| 6.2.2.3 | 2.9.11-303 | — |
| 6.2.2.2 | 2.9.11-273 | — |
| 6.2.2.1 | 2.9.11-207 | — |
| 6.2.2 | 2.9.11-125 | — |
| 6.2.1 | 2.9.11-101 | — |
| 6.2.0.6 | 2.9.10-301 | — |
| 6.2.0.5 | 2.9.10-255 | — |
| 6.2.0.4 | 2.9.10-205 | — |
| 6.2.0.3 | 2.9.10-160 | — |
| 6.2.0.2 | 2.9.10-126 | — |
| 6.2.0.1 | 2.9.10-98 | — |
| 6.2.0 | 2.9.10-42 | — |
| 6.1.0.7 | 2.9.9-312 | — |
| 6.1.0.6 | 2.9.9-258 | — |
| 6.1.0.5 | 2.9.9-225 | — |
| 6.1.0.4 | 2.9.9-191 | — |
| 6.1.0.3 | 2.9.9-159 | — |
| 6.1.0.2 | 2.9.9-125 | — |
| 6.1.0.1 | 2.9.9-92 | — |
| 6.1.0 | 2.9.9-330 | — |
| 6.0.1.4 | 2.9.8-490 | — |
| 6.0.1.3 | 2.9.8-461 | — |
| 6.0.1.2 | 2.9.8-426 | — |
| 6.0.1.1 | 2.9.8-383 | — |
| 6.0.1 | 2.9.8-224 | — |

### System Databases

The vulnerability database (VDB) is a database of known vulnerabilities to which
hosts may be susceptible, as well as fingerprints for operating systems, clients,
and applications. The system uses the VDB to help determine whether a particular
host increases your risk of compromise.

The geolocation database (GeoDB) is a database that you can leverage to view and
filter traffic based on geographical location.

Table 18.

| **Threat Defense** | **VDB** | **GeoDB** |
| --- | --- | --- |
| 7.6.0 | 4.5.0-392 | 2022-07-04-101 |
| 7.4.1 through 7.4.x | 4.5.0-376 | 2022-07-04-101 |
| 7.4.0 | 4.5.0-365 | 2022-07-04-101 |
| 7.3.0 through 7.3.x | 4.5.0-358 | 2022-07-04-101 |
| 7.2.0 through 7.2.x | 4.5.0-353 | 2022-05-11-103 |
| 7.1.0 | 4.5.0-346 | 2020-04-28-002 |
| 6.7.0 through 7.0.x | 4.5.0-338 | 2020-04-28-002 |
| 6.6.1 through 6.6.x | 4.5.0-336 | 2019-06-03-002 |
| 6.6.0 | 4.5.0-328 | 2019-06-03-002 |
| 6.5.0 | 4.5.0-309 | 2019-06-03-002 |
| 6.4.0 | 4.5.0-309 | 2018-07-09-002 |
| 6.3.0 | 4.5.0-299 | 2018-07-09-002 |
| 6.2.3 | 4.5.0-290 | 2017-12-12-002 |
| 6.0.1 through 6.2.2 | 4.5.0-271 | 2015-10-12-001 |

## Integrated Products

The Cisco products listed below may have other compatibility requirements, for
example, they may need to run on specific hardware, or on a specific operating
system. For that information, see the documentation for the appropriate
product.

| **Note** | ---   Whenever possible, we recommend you use the latest (newest) compatible version of each integrated product. This ensures that you have the latest features, bug fixes, and security patches.   --- |
| --- | --- |

### Identity Services and User Control

Note that with:

* Cisco ISE and ISE-PIC: We list the versions of ISE and ISE-PIC for which we
  provide enhanced compatibility testing, although other combinations may
  work.
* Cisco Firepower User Agent: Version 6.6 is the last management center release to support the user agent software as an identity source; this
  blocks upgrade to Version 6.7+.

  You can instead use the Passive Identity Agent with Microsoft Active Directory. For more information, see [User Control With the Passive Identity Agent](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/760/management-center-device-config-76/passive-identity-agent.html).
* Cisco TS Agent: Versions 1.0 and 1.1 are no longer available.

Table 19. Integrated Products: Identity Services/User Control

| **Management Center/Threat Defense** | **Cisco Identity Services Engine (ISE)** | | **Cisco Firepower User Agent** | **Cisco Terminal Services (TS) Agent** | **Passive Identity Agent** |
| --- | --- | --- | --- | --- | --- |
| **ISE** | **ISE-PIC** |
| Supported with... | Management center  Device manager | Management center  Device manager | Management center only | Management center only | Management center only |
| Cloud-delivered Firewall Management Center (no version) | 3.3  3.2  3.1 patch 2+  3.0 patch 6+  2.7 patch 2+  The pxGrid cloud identity source requires ISE 3.1 patch 3 or later. | 3.2  3.1  2.7 patch 2+ | — | 1.4 | 1.0 |
| 7.6 | 3.3 patch 2  3.2 patch 5  3.1 patch 2+ | 3.2  3.1 | — | 1.4 | 1.0 |
| 7.4 | 3.3  3.2  3.1 patch 2+  3.0 patch 6+ | 3.2  3.1 | — | 1.4 | — |
| 7.3 | 3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.2.4–7.2.x | 3.3  3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.2.0–7.2.3 | 3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.1 | 3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.0 | 3.2  3.1  3.0  2.7 patch 2+  2.6 patch 6+ | 3.2  3.1  2.7 patch 2+  2.6 patch 6+ | — | 1.4  1.3 | — |
| 6.7 | 3.0  2.7 patch 2+  2.6 patch 6+ | 2.7 patch 2+  2.6 patch 6+ | — | 1.4  1.3 | — |
| 6.6 | 3.0  2.7, any patch  2.6, any patch  2.4 | 2.7, any patch  2.6, any patch  2.4 | 2.5  2.4 | 1.4  1.3  1.2 | — |
| 6.5 | 2.6  2.4 | 2.6  2.4 | 2.5  2.4 | 1.4  1.3  1.2  1.1 | — |
| 6.4 | 2.4  2.3 patch 2  2.3 | 2.4  2.2 patch 1 | 2.5  2.4  2.3, no ASA FirePOWER | 1.4  1.3  1.2  1.1 | — |
| 6.3 | 2.4  2.3 patch 2  2.3 | 2.4  2.2 patch 1  2.4 | 2.4  2.3, no ASA FirePOWER | 1.2  1.1 | — |
| 6.2.3 | 2.3 patch 2  2.3  2.2 patch 5  2.2 patch 1  2.2 | 2.2 patch 1 | 2.4  2.3 | 1.2  1.1 | — |
| 6.2.2 | 2.3  2.2 patch 1  2.2  2.1 | 2.2 patch 1 | 2.3 | 1.2  1.1  1.0 | — |
| 6.2.1 | 2.1  2.0.1  2.0 | 2.2 patch 1 | 2.3 | 1.1  1.0 | — |
| 6.2.0 | 2.1  2.0.1  2.0  1.3 | — | 2.3 | — | — |
| 6.1 | 2.1  2.0.1  2.0  1.3 | — | 2.3 | — | — |
| 6.0.1 | 1.3 | — | 2.3 | — | — |

### Cisco Secure Dynamic Attributes Connector

The Cisco Secure
Dynamic Attributes Connector is a lightweight application that quickly and seamlessly updates firewall
policies on the management center based on cloud/virtual workload changes. For more information, see one of:

* On-prem connector: [Cisco Secure Dynamic Attributes
  Connector Configuration
  Guide](https://cisco.com/go/dyn-attr-conn-canonical)
* Cloud-delivered connector: Managing the Cisco Secure Dynamic Attributes Connector with Cisco Security Cloud Control chapters in [Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Security Cloud Control](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator.html)
* Bundled with the Secure Firewall Management Center: [Cisco Secure Firewall Management
  Center Device Configuration Guide](http://www.cisco.com/go/firepower-config)

Table 20. Integrated Products: Cisco Secure
Dynamic Attributes Connector

| **Management Center** | Cisco Secure Dynamic Attributes Connector | |
| --- | --- | --- |
| **On-Prem** | **Cloud-delivered (with Security Cloud Control)** |
| Cloud-delivered management center (no version) | 3.0  2.2  2.0 | **YES** |
| 7.1+ | 3.0  2.2  2.0  1.1 | **YES** |
| 7.0 | 3.0  2.2  2.0  1.1 | — |

The Cisco Secure
Dynamic Attributes Connector allows you to use service tags and categories from various cloud service platforms in security rules.

The following table shows supported connectors for the Cisco Secure
Dynamic Attributes Connector (CSDAC) provided with the Secure Firewall Management Center. For a list of supported connectors with the on-premises CSDAC, see the [Cisco Secure Dynamic Attributes
Connector Configuration
Guide](https://cisco.com/go/dyn-attr-conn-canonical).

Table 21. List of supported connectors by Cisco Secure
Dynamic Attributes Connector version and platform

| CSDAC version/platform | AWS | AWS Security Groups | AWS Service Tags | Azure | Azure Service Tags | Cisco Cyber Vision | Cisco Multicloud Defense | Generic text | GitHub | Google Cloud | Microsoft Office 365 | vCenter | Webex | Zoom |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Version 1.1 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | No | No | Yes | Yes | No | No |
| Version 2.0 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | No | Yes | Yes | Yes | No | No |
| Version 2.2 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | Yes | Yes | Yes | Yes | No | No |
| Version 2.3 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | Yes | Yes | Yes | Yes | Yes | Yes |
| Version 3.0 (on-premises) | Yes | Yes | Yes | Yes | Yes | Yes | No | Yes | Yes | Yes | Yes | Yes | Yes | Yes |
| Cloud-delivered (Cisco Security Cloud Control) | Yes | No | No | Yes | Yes | No | Yes | No | Yes | Yes | Yes | No | No | No |
| Secure Firewall Management Center 7.4.1 | Yes | No | No | Yes | Yes | No | No | Yes | Yes | Yes | Yes | Yes | Yes | Yes |
| Secure Firewall Management Center 7.6 | Yes | Yes | Yes | Yes | Yes | Yes | No | Yes | Yes | Yes | Yes | Yes | Yes | Yes |

### Threat Detection

Note that:

* Cisco Security Analytics and Logging (On Premises) requires the Security
  Analytics and Logging On Prem app for the Stealthwatch Management Console
  (SMC). For information on Stealthwatch Enterprise (SWE) requirements for the
  SMC, see [Cisco Security Analytics
  and Logging On Premises: Firepower Event Integration
  Guide](https://www.cisco.com/c/en/us/support/security/security-analytics-logging/products-installation-guides-list.html).
* Cisco SecureX integration, which was available with
  Version 6.4–7.4, has now reached end of support. For a replacement
  technology, contact your Cisco representative or partner contact.

Table 22. Integrated Products: Threat Detection

| **Management Center/Threat Defense** | **Cisco Security Analytics and Logging (SaaS)** | **Cisco Security Analytics and Logging (On Prem)** | **Cisco Secure Malware Analytics** | **Cisco Security Packet Analyzer** |
| --- | --- | --- | --- | --- |
| Supported with... | Management center  Device manager | Management center only | Management center only | Management center only |
| 6.5+ | **YES** | **YES** | **YES** | — |
| 6.4 | **YES**  Requires management center with threat defense 6.4. | **YES** | **YES** | **YES** |
| 6.3 | — | — | **YES** | **YES** |
| 6.1–6.2.3 | — | — | **YES** | — |

### Threat Defense Remote Access VPN

Remote access virtual private network (RA VPN) allows individual users to connect to
your network from a remote location using a computer or supported mobile device.
Keep in mind that newer threat defense features can require newer versions of the
client.

For more information, see the [Cisco Secure Client/AnyConnect Secure Mobility Client
configuration guides](https://www.cisco.com/c/en/us/support/security/anyconnect-secure-mobility-client/products-installation-and-configuration-guides-list.html).

Table 23. Integrated Products: Threat Defense RA VPN

| **Threat Defense** | Cisco Secure Client/Cisco AnyConnect Secure Mobility Client |
| --- | --- |
| 6.2.2+ | 4.0+ |

## Browser Requirements

### Browsers

We test with the latest versions of these popular browsers, running on currently
supported versions of macOS and Microsoft Windows:

Table 24. Browsers

| Browser | Device Manager Version |
| --- | --- |
| Google Chrome | Any |
| Mozilla Firefox | Any |
| Microsoft Edge (Windows only) | Version 6.7+ |
| Apple Safari | Not extensively tested. Feedback welcome. |

If you encounter issues with any other browser, or are running an operating system
that has reached end of life, we ask that you switch or upgrade. If you continue to
encounter issues or have feedback, contact Cisco TAC.

### Browser Settings and Extensions

Regardless of browser, keep JavaScript and
cookies enabled.
If you are using Microsoft Edge, do *not* enable IE mode.

Note that some browser extensions can prevent you from saving values in fields like
the certificate and key in PKI objects. These extensions include, but are not
limited to, Grammarly and Whatfix Editor. This happens because these extensions
insert characters (such as HTML) in the fields, which causes the system to see them
invalid. We recommend you disable these extensions while you’re logged into our
products.

### Screen Resolution

Table 25. Screen Resolution

| **Interface** | **Minimum Resolution** |
| --- | --- |
| Device manager | 1024 x 768 |
| Chassis manager for the Firepower 4100/9300 | 1024 x 768 |

### Securing Communications

When you first log in, the system uses a self-signed digital certificate to secure
web communications. Your browser should display an untrusted authority warning, but
also should allow you to add the certificate to the trust store. Although this will
allow you to continue, we do recommend that you replace the self-signed certificate
with a certificate signed by a globally known or internally trusted certificate
authority (CA).

To begin replacing the self-signed certificate on device manager, click
Device, then the System Settings > Management Access link, then the Management Web Server tab.
For detailed procedures, see the online help or the [Cisco
Secure Firewall Device Manager Configuration
Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

| **Note** | ---   If you do not replace the self-signed certificate:   * Google Chrome does not cache static content, such as images, CSS, or   JavaScript. Especially in low bandwidth environments, this can extend   page load times. * Mozilla Firefox can stop trusting the self-signed certificate when the   browser updates. If this happens, you can refresh Firefox, keeping in   mind that you will lose some settings; see Mozilla's *[Refresh Firefox](https://support.mozilla.org/en-US/kb/refresh-firefox-reset-add-ons-and-settings)* support   page.  --- |
| --- | --- |

### Browsing from a Monitored Network

Many browsers use Transport Layer Security (TLS) v1.3 by default. If you are using an
SSL policy to handle encrypted traffic, and people in your monitored network use
browsers with TLS v1.3 enabled, websites that support TLS v1.3 may fail to load.

| **Note** | ---   In Version 6.2.3 and earlier, websites that support TLS v1.3 always fail to load. As a workaround, you can configure managed devices to remove extension 43 (TLS 1.3) from ClientHello negotiation; see the software advisory titled: [*Failures loading websites using TLS 1.3 with SSL inspection enabled*](https://www.cisco.com/c/en/us/td/docs/security/firepower/SA/SW_Advisory_CSCvh22181.html). In Version 6.2.3.7+, you can specify when to downgrade; see the system support  commands in the [Cisco Secure Firewall Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense.html) after consulting with Cisco TAC.   --- |
| --- | --- |

## End-of-Life Announcements

The following tables provide end-of-life details. Dates that have passed
are in **bold**.

### Snort

If you are still using the Snort 2 inspection engine with threat defense, switch to Snort 3
now for improved detection and performance. It is available starting in threat defense
Version 6.7+ (with device manager) and Version 7.0+ (with management center). Snort 2 will
be deprecated in a future release. You will eventually be unable to upgrade
Snort 2 devices.

In management center deployments, upgrading to threat defense Version
7.2+ also upgrades eligible Snort 2 devices to Snort
3.
For devices that are ineligible because they use custom intrusion or network analysis
policies, manually upgrade Snort. See Migrate from Snort 2 to Snort 3 in the
[Cisco Secure Firewall
Management Center Snort 3 Configuration
Guide](https://www.cisco.com/go/fmc-snort3).

In device manager deployments, manually upgrade Snort. See Intrusion Policies
in the [Cisco
Secure Firewall Device Manager Configuration
Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

### Software

These major software versions have reached end of sale and/or end of
support. Versions that have reached end of support are removed from the Cisco Support & Download
site.

Table 26. Software EOL Announcements

| **Version** | **End of Sale** | End of Updates | **End of Support** | **Announcement** |
| --- | --- | --- | --- | --- |
| 7.1 | **2023-12-22** | **2024-12-21** | 2025-12-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 7.1.(x), Firepower Management Center (FMC) 7.1.(x), Adaptive Security Appliance(ASA) 9.17.(x) and Firepower eXtensible Operating System (FXOS) 2.11.(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-ftd-fmc-7-1x-fxos-2-11x-eol.html) |
| 6.7 | **2021-07-09** | **2022-07-09** | **2024-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.7, Firepower Management Center (FMC) 6.7 and Firepower eXtensible Operating System (FXOS) 2.9(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-744709.html) |
| 6.6 | **2022-03-02** | **2023-03-02** | 2025-03-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD/FTDv) 6.6(x), Firepower Management Center (FMC/FMCv) 6.6(x) and Firepower eXtensible Operating System (FXOS) 2.8(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-ftd-fmc-6-6x-fxos-2-8x-eol.html) |
| 6.5 | **2020-06-22** | **2021-06-22** | **2023-06-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.5(x), Firepower Management Center (FMC) 6.5(x) and Firepower eXtensible Operating System (FXOS) 2.7(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743795.html) |
| 6.4 | **2023-02-27** | **2024-02-27** | 2026-02-28 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.4(X), Firepower Management Center (FMC) 6.4(X) and Firepower eXtensible Operating System (FXOS) 2.6(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-threat-defense-6-4x-eol.html) |
| 6.3 | **2020-04-30** | **2021-04-30** | **2023-04-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.2.2, 6.3(x), Firepower eXtensible Operating System (FXOS) 2.4.1 and Firepower Management Center (FMC) 6.2.2 and 6.3(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743073.html) |
| 6.2.3 | **2022-02-04** | **2023-02-04** | 2025-02-28 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.2.3, Firepower Management Center (FMC) 6.2.3 and Firepower eXtensible Operating System (FXOS) 2.2(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-threat-defense-eol.html) |
| 6.2.2 | **2020-04-30** | **2021-04-30** | **2023-04-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.2.2, 6.3(x), Firepower eXtensible Operating System (FXOS) 2.4.1 and Firepower Management Center (FMC) 6.2.2 and 6.3(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743073.html) |
| 6.2.1 | **2019-03-05** | **2020-03-04** | **2022-03-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense versions 6.2.0 and 6.2.1](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-741309.html) |
| 6.2 | **2019-03-05** | **2020-03-04** | **2022-03-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense versions 6.2.0 and 6.2.1](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-741309.html) |
| 6.1 | **2019-11-22** | **2021-05-22** | **2023-05-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense versions 6.1, NGIPSv and NGFWv versions 6.1, Firepower Management Center 6.1 and Firepower eXtensible Operating System (FXOS) 2.0(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743170.html) |
| 6.0.1 | **2017-11-10** | **2018-11-10** | **2020-11-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Software Releases 5.4, 6.0 and 6.0.1 and Firepower Management Center Software Releases 5.4, 6.0 and 6.0.1](https://www.cisco.com/c/en/us/products/collateral/security/firepower-8000-series-appliances/eos-eol-notice-c51-739057.html) |

These software versions on still-supported branches have been removed
from the Cisco Support & Download
site.

| **Note** | ---   In Version 6.2.3+, uninstalling a patch (fourth-digit release) results in an appliance running the version you upgraded from. This means that you can end up running a deprecated version simply by uninstalling a later patch. Unless otherwise stated, do *not* remain at a deprecated version. Instead, we recommend you upgrade. If upgrade is impossible, uninstall the deprecated patch.   --- |
| --- | --- |

Table 27. Software Removed Versions

| **Version** | **Date Removed** | **Related Bugs and Additional Details** |
| --- | --- | --- |
| 7.2.6 | **2024-04-29** | [CSCwi63113](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwi63113): FTD Boot Loop with SNMP Enabled after reload/upgrade |
| 6.4.0.6 | **2019-12-19** | [CSCvr52109](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvr52109): FTD may not match correct Access Control rule following a deploy to multiple devices |
| 6.2.3.8 | **2019-01-07** | [CSCvn82378](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvn82378): Traffic through ASA/FTD might stop passing upon upgrading FMC to 6.2.3.8-51 |

### Hardware and Virtual Platforms

These platforms have reached end of sale and/or end of support.

Table 28. Threat Defense Hardware EOL Announcements

| **Platform** | **Last Device Version** | Last Mgmt. Center to Manage | **End of Sale** | **End of Support** | **Announcement** |
| --- | --- | --- | --- | --- | --- |
| Firepower 2110, 2120, 2130, 2140 | 7.4 | TBD | 2025-05-27 | 2030-05-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 2100 Series Security Appliances & 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-2100-series-sec-app-5-yr-sub-eol.html) |
| Firepower 4110 | 7.2 | TBD | **2024-07-31** | 2027-01-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4110 Series Security Appliances 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-4110-series-sec-app-subscript-eol.html) |
| **2022-01-31** | 2027-01-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4110 Series Security Appliances & 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-4110-series-security-appliances-eol.html) |
| ASA 5508-X, 5516-X | 7.0 | 7.4 | **2021-08-02** | 2026-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5508 and ASA5516 Series Security Appliance and 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-744798.html) |
| ASA 5525-X, 5545-X, 5555-X | 6.6 | 7.2 | **2020-09-04** | 2025-09-30 | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5525, ASA5545 & ASA5555 Series Security Appliance & 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-firepower-services/eos-eol-notice-c51-743545.html) |
| Firepower 4120, 4140, 4150 | 7.2 | TBD | **2024-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 1 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/fpr-9300-sm24-36-44-sec-app-1-yr-sub-eol.html) |
| **2022-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-41204050-fpr-9300-sm243644-series-eol.html) |
| **2020-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances/Modules & 5 YR Subscription](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743522.html) |
| Firepower 9300: SM-24, SM-36, SM-44 modules | 7.2 | TBD | **2024-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 1 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/fpr-9300-sm24-36-44-sec-app-1-yr-sub-eol.html) |
| **2022-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-41204050-fpr-9300-sm243644-series-eol.html) |
| **2020-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances/Modules & 5 YR Subscription](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743522.html) |
| ASA 5515-X | 6.4 | 7.0 | **2017-08-25** | **2022-08-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA 5512-X and ASA 5515-X](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-738644.html) |
| ASA 5506-X, 5506H-X, 5506W-X | 6.2.3 | 6.6 | **2021-08-02** | 2026-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance with ASA software](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-744797.html) |
| **2021-07-31** | **2022-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance 1 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-744793.html) |
| **2020-05-05** | **2022-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-743753.html) |
| **2018-09-30** | **2022-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-741287.html) |
| ASA 5512-X | 6.2.3 | 6.6 | **2017-08-25** | **2022-08-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA 5512-X and ASA 5515-X](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-738644.html) |

## Terminology and Branding

Table 29. Product Line

| **Current Name** | **Older Names** |
| --- | --- |
| Secure Firewall Threat Defense | Firepower  Firepower System  FireSIGHT System  Sourcefire 3D System |

Table 30. Devices

| **Current Name** | | **Older Names** |
| --- | --- | --- |
| Threat Defense | Secure Firewall Threat Defense | Firepower Threat Defense (FTD) |
| Secure Firewall Threat Defense Virtual | Firepower Threat Defense Virtual (FTDv) |
| Classic  NGIPS | ASA FirePOWER  ASA FirePOWER module  ASA with FirePOWER Services | — |
| 7000/8000 series | Series 3 |
| NGIPSv | virtual managed device |
| Legacy | Series 2 | — |
| Cisco NGIPS for Blue Coat X-Series | FireSIGHT Software for X-Series  Sourcefire Software for X-Series |

Table 31. Device Management

| **Current Name** | Older Names |
| --- | --- |
| Secure Firewall Management Center | Firepower Management Center (FMC)  FireSIGHT Management Center  FireSIGHT Defense Center  Defense Center |
| Secure Firewall Management Center Virtual | Firepower Management Center Virtual (FMCv)  FireFIGHT Virtual Management Center  FireSIGHT Virtual Defense Center  Virtual Defense Center |
| Cloud-delivered Firewall Management Center | — |
| Secure Firewall device manager | Firepower Device Manager (FDM) |
| Secure Firewall Adaptive Security Device Manager (ASDM) | Adaptive Security Device Manager (ASDM) |
| Secure Firewall chassis manager | Firepower Chassis Manager |
| Security Cloud Control | Cisco Defense Orchestrator (CDO) |

Table 32. Operating Systems

| **Current Name** | **Older Names** |
| --- | --- |
| Secure Firewall eXtensible Operating System (FXOS) | Firepower eXtensible Operating System (FXOS) |
| Secure Firewall Adaptive Security Appliance (ASA) Software | Adaptive Security Appliance (ASA) software |

Copyright © 2023, Cisco Systems, Inc. All rights reserved.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [3000 Series Industrial Security Appliances (ISA)](/c/en/us/support/security/industrial-security-appliance-isa/series.html)
* [ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [ASA 5500-X with FirePOWER Services](/c/en/us/support/security/asa-firepower-services/series.html)
* [Firepower 1000 Series](/c/en/us/support/security/firepower-1000-series/series.html)
* [Firepower 2100 Series](/c/en/us/support/security/firepower-2100-series/series.html)
* [Firepower 4100 Series](/c/en/us/support/security/firepower-4100-series/series.html)
* [Firepower 9300 Series](/c/en/us/support/security/firepower-9000-series/series.html)
* [Secure Firewall 1200 Series](/c/en/us/support/security/secure-firewall-1200-series/series.html)
* [Secure Firewall 3100 Series](/c/en/us/support/security/secure-firewall-3100-series/series.html)
* [Secure Firewall 4200 Series](/c/en/us/support/security/secure-firewall-4200-series/series.html)
* [Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Secure Firewall Threat Defense Virtual](/c/en/us/support/security/firepower-ngfw-virtual/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_f946a804_20250115_123356.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Defense Orchestrator](/c/en/us/support/security/defense-orchestrator/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-orchestrator/products-installation-and-configuration-guides-list.html)
# Managing FDM Devices with Cisco Security Cloud Control

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Managing FDM-Managed Devices with Cisco Security
  Cloud Control](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/managing-ftd-with-cdo.html)
* [Basics of Security Cloud Control](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/basics-of-cisco-defense-orchestrator.html)
* [Onboard Devices and Services](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html)
* [Configuring FDM-Managed Devices](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html)
* [Monitoring and Reporting Change Logs, Workflows, and Jobs](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/monitoring-and-reporting.html)
* [Cisco Security Analytics and Logging](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/cisco-security-analytics-and-logging.html)
* [Integrating Security Cloud Control with Cisco Security Cloud Sign On](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/integrating-cdo-with-securex.html)
* [Terraform](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/m-cdo-terraform.html)
* [Troubleshooting](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/troubleshooting.html)
* [FAQ and Support](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/faq-and-support.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Managing FDM Devices with Cisco Security Cloud Control Chapter Title Onboard Devices and Services

* [PDF - Complete Book
  (15.68 MB)](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator.pdf)
  [PDF - This Chapter (2.7 MB)](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: January 10, 2025

## Chapter: Onboard Devices and Services

Chapter Contents

* [Onboard Devices and Services](#Cisco_Generic_Topic.dita_8b6c26fa-03b9-413f-af92-3bbe687c30e4)
* [Onboard a Threat Defense Device](#Onboarding_an_FTD_to_CDO)
  + [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface)
    - [Manage an FDM-Managed Device from the Inside Interface](#Manage_FTD_from_the_InsideInterface)
  + [Managing an FDM-Managed Device from the Outside Interface](#About_Managing_FTD_from_the_Outside_Interface)
    - [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface)
  + [Onboard an FDM-Managed Device to Security Cloud Control](#Cisco_Concept.dita_d6daef95-4c3f-4b41-be5b-71699ca538fa)
    - [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_Procedure)
    - [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
      * [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD)
      * [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure)
    - [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key)
      * [Unregistering an FDM-Managed Device from Cisco Cloud Services](#Unregistering_anFTD_from_Cisco_Cloud_Services)
      * [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure)
    - [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number)
      * [Workflow and Prerequisites to Onboard the FDM-Managed Device Using Zero-Touch Provisioning](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number)
        + [Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning](#Onboarding_Procedure)
      * [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number)
    - [Onboard an FDM-Managed High Availability Pair](#Cisco_Concept.dita_5369ba64-fdc7-4637-a3d4-5235c9cd7d8f)
      * [Onboard an FDM-Managed High Availablity Pair with a Registration Key](#Before_You_Begin)
        + [Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5](#Onboard_an_FTD_HA_Pair_Running_Version_64_or_Version_65)
        + [Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later](#Onboard_an_FTD_HA_Pair_Running_Version_66_or_Version_67_and_later)
      * [Onboard an FDM-Managed High Availability Pair](#Cisco_Task.dita_4b81ad97-372f-4a17-9312-64c8dc973b37)
    - [Onboard an FTD Cluster](#onboard-an-ftd-cluster)
      * [Onboard a Clustered Secure Firewall Threat Defense Device](#onboard-a-ftd-cluster)
* [Applying or Updating a Smart License](#Applying_or_Updating_a_Smart_License)
  + [Smart-License an FDM-Managed Device When Onboarding Using a Registration Key](#SmartLicense_an_FTDDevice_When_OnboardingUsing_a_Registration_Key)
  + [Smart-License an FDM-Managed Device After Onboarding the Device Using a Registration Key or its Credentials](#SmartLicensean_FTDDevice_After_Onboarding_the_Device_Using_a_Registration_Key_or_its_Credentials)
  + [Updating an Existing Smart License of an FDM-Managed Device](#Updating_an_Existing_Smart_Licenseof_anFTDDevice)
  + [Change the Smart License Applied to an FDM-Managed Device Onboarded Using a Registration Key](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_a_Registration_Key)
  + [Change the Smart License Applied to an FDM-Managed Device Onboarded Using its Credentials](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_its_Credentials)
* [Security Cloud Control Support for DHCP Addressing of FDM-Managed Devices](#CDO_Support_for_DHCP_Addressing_of_FTD_Devices)
* [FDM-Managed Device Licensing Types](#FTD_Licensing_Types)
  + [Virtual FDM-Managed Device Tiered Licenses](#Cisco_Concept.dita_c59521f9-9d6c-4838-9b34-f4de7a69dc07)
  + [Viewing Smart-Licenses for a Device](#Viewing_SmartLicenses_for_a_Device)
  + [Enabling or Disabling Optional Licenses](#Before_you_Begin)
  + [Impact of Expired or Disabled Optional Licenses](#Impact_of_Expired_or_Disabled_Optional_Licenses)
* [Create and Import an Firewall Device Manager Model](#Create_and_Import_an_FTD_Model)
  + [Export FDM-Managed Device Configuration](#Export_FTD_Configuration)
  + [Import FDM-Managed Device Configuration](#Import_FTD_Configuration)

- [Delete a Device from Security Cloud Control](#Cisco_Task_in_List_GUI.dita_30250c0b-d78c-41b7-bdca-dca15c7d595d)
- [Import Configuration for Offline Device Management](#Cisco_Reference.dita_c8b96c27-74b5-4599-8331-096b9ad84150)
- [Backing Up FDM-Managed Devices](#Backing_Up_FTDs)
  * [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
    + [Procedure](#Procedure)
  * [Configure a Recurring Backup Schedule for a Single FDM-Managed Device](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
    + [Procedure](#Procedure)
  * [Download the Device Backup](#Procedure)
  * [Edit a Backup](#Edit_an_FTD_Backup)
  * [Delete a Backup](#Delete_an_FTDBackup)
  * [Managing Device Backup](#Managing_FTD_Backups)
  * [Restore a Backup to an FDM-Managed Device](#Procedure)
- [FDM Software Upgrade Paths](#Firepower_Software_Upgrade_Path)
  * [Other Upgrade Limitations](#Cisco_Task.dita_c9a8eb49-bab9-4b30-a756-0b39c58e83f1)
  * [4100 and 9300 Series Devices](#Cisco_Concept.dita_d0145adc-cabf-45b1-9197-8e3f1f0b1cb3)
- [FDM-Managed Device Upgrade Prerequisites](#FTD_Upgrade_Prerequisites)
- [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
  * [Upgrade A Single FDM-Managed Device with Images from Security Cloud Control's Repository](#Upgrade_A_Single_FTD_with_Images_from_CDOsRepository)
  * [Upgrade a Single FDM-Managed Device with Images from your own Repository](#Upgrade_a_Single_FTD_with_Images_from_your_ownRepository)
  * [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)
- [Bulk FDM-Managed Devices Upgrade](#Bulk_FTD_Upgrade)
  * [Upgrade Bulk FDM-Managed Devices with Images from Security Cloud Control's Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_CDOsRepository)
  * [Upgrade Bulk FDM-Managed Devices with Images from your own Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_your_ownRepository)
  * [Monitor the Bulk Upgrade Process](#Monitor_the_Bulk_Upgrade_Process)
- [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)
  * [Upgrade an FDM-Managed HA Pair with Images from Security Cloud Control's Repository](#Upgrade_an_FTD_HAPair_with_Images_from_CDOsRepository)
  * [Upgrade an FDM-Managed HA Pair with Images from your own Repository](#Upgrade_an_FTD_HAPair_with_Images_from_your_ownRepository)
  * [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)
- [Upgrade to Snort 3.0](#Upgrade_to_Snort_3)
  * [Upgrade the Device and the Intrusion Prevention Engine Simultaneously](#Upgrade_the_Device_and_the_Intrusion_Prevention_EngineSimultaneously)
  * [Upgrade the Intrusion Prevention Engine](#Upgrade_the_Intrusion_Prevention_Engine)
  * [Monitor the Upgrade Process](#Cisco_Concept.dita_734b576c-42ad-4612-ae33-5fbefcdbc912)
- [Revert From Snort 3.0 for FDM-Managed Device](#Revert_From_Snort_3_for_FTD)
  * [Revert From Snort 3.0](#Revert_From_Snort_3)
- [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update)
  * [Edit a Scheduled Security Database Update](#Edit_a_Scheduled_Security_Database_Update)
Close

# Onboard Devices and Services

You can onboard both live devices and model devices to Security Cloud Control. Model devices are uploaded configuration files that you can view and edit using Security Cloud Control.

Most live devices and services require an open HTTPS connection so that the Secure Device
Connector can connect Security Cloud Control to the device or service.

See [Secure Device Connector](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_e19faf6e-4e1b-4bb3-ad82-48a080430e8c) for more information on the SDC and its state.

This chapter covers the following sections:

* [Onboard a Threat Defense Device](#Onboarding_an_FTD_to_CDO)
* [Delete a Device from Security Cloud Control](#Cisco_Task_in_List_GUI.dita_30250c0b-d78c-41b7-bdca-dca15c7d595d)
* [Import Configuration for Offline Device Management](#Cisco_Reference.dita_c8b96c27-74b5-4599-8331-096b9ad84150)
* [Backing Up FDM-Managed Devices](#Backing_Up_FTDs)
* [FDM Software Upgrade Paths](#Firepower_Software_Upgrade_Path)
* [FDM-Managed Device Upgrade Prerequisites](#FTD_Upgrade_Prerequisites)
* [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
* [Bulk FDM-Managed Devices Upgrade](#Bulk_FTD_Upgrade)
* [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)
* [Upgrade to Snort 3.0](#Upgrade_to_Snort_3)
* [Revert From Snort 3.0 for FDM-Managed Device](#Revert_From_Snort_3_for_FTD)
* [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update)

## Onboard a Threat Defense Device

| **Attention** | ---   Secure Firewall device manager (FDM) support and functionality is only available upon request. If you do not already have Firewall device manager support enabled on your tenant you cannot manage or deploy to FDM-managed devices. [Send a request to the support team](faq-and-support.html#Cisco_Concept.dita_92ad1f10-ddda-45fe-b4e9-ea9433046396) to enable this platform.   --- |
| --- | --- |

There are different methods of onboarding a threat defense device. We recommend using the registration key method.

If you experience issues while onboarding a device, see [Troubleshoot FDM-Managed Device Onboarding Using Serial Number](troubleshooting.html#Cisco_Reference.dita_2c78ba62-d55a-4cef-8490-4d117af93f19) or [Failed Because of Insufficient License](troubleshooting.html#Failed_Because_of_Insufficient_License) for more information.

### Onboard a Threat Defense Device to Cloud-delivered Firewall Management Center

You can onboard threat defense devices running version 7.2 and later to the Cloud-delivered Firewall Management
Center. See [Onboard an FTD to the Cloud-Delivered Firewall Management Center](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-onboard-for-ftd-management.html) for more information.

### Onboard a Threat Defense Device with a Serial Number

This procedure is a simplified method of onboarding the Firepower 1000, Firepower 2100, Secure Firewall
1210/1220, or Secure Firewall 3100 series physical devices running supported versions of software. To onboard the device, you need the chassis serial number
or PCA serial number of the device and ensure that the device is added to a network that can reach the internet.

You can onboard new factory-shipped devices or already configured devices to Security Cloud Control.

See [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number) for more information.

### Onboard a Threat Defense Device with a Registration Key

We recommend onboarding threat defense devices with a registration key. This is beneficial if your device is assigned an IP address using DHCP. If that IP address
changes for some reason, your threat defense device remains connected to Security Cloud Control if you have onboarded it with a registration key.

* [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key)

### Onboard an Threat Defense Device Using Credentials

You can onboard a threat defense device using the device credentials and the IP address of the device's outside, inside, or management interface depending
on how the device is configured in your network. To onboard a device with credentials, see [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_Procedure). To onboard with an interface address, see  [Device Addressing](#Onboarding_an_FTD_to_CDO) later in this article.

Security Cloud Control needs HTTPS access to the device in order to manage it. How you allow HTTPS access to the device depends on how your device
is configured in your network and whether you onboard the device using a [Secure Device Connector](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_e19faf6e-4e1b-4bb3-ad82-48a080430e8c) or a Cloud Connector.

| **Note** | ---   If you connect to <https://us.manage.security.cisco.com> and you are using software version 6.4, you must onboard the threat defense device with this method. You cannot use the registration key method.   --- |
| --- | --- |

When using device credentials to connect Security Cloud Control to a device, it a best practice to download and deploy a Secure Device Connector (SDC) in your network to manage the communication
between Security Cloud Control and the device. Typically, these devices are non-perimeter based, do not have a public IP address, or have an open port to
the outside interface. The threat defense device, when onboarded with credentials, can be onboarded to Security Cloud Control using an SDC.

Note that customers also using the threat defense devie as the head-end for VPN connections will not be able to use the outside interface to manage their device.

### Onboard a Threat Defense Cluster

You can onboard a threat defense device that is clustered prior to onboarding to Security Cloud Control. Clustering lets you group multiple firewall threat defense units together as a single logical device that provides the convenience of a single device (management, integration into
a network) while achieving the increased throughput and redundancy of multiple devices.

See [Onboard a Clustered Secure Firewall Threat Defense Device](#onboard-a-ftd-cluster).

### FDM-Managed Device Configuration Prerequisites for Onboarding

### FDM-Managed Device Management

You can only onboard threat defense devices that are being managed by Secure Firewall
device manager (FDM). threat defense devices being managed by Secure Firewall Management Center cannot be managed by the cloud-delivered Firewall
Management Center.

If the device is not configured for local management, you must switch to local management before onboarding the device. See
the **Switching Between Local and Remote Management** chapter of the [Secure Firewall Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor854).

### Licensing

The device must have at least an license installed before it can be onboarded to Security Cloud Control although you can have a Smart License applied in some circumstances.

| Onboarding Method | Secure Firewall device manager Software Version | 90-day Evaluation licensed allowed? | Can the device already be smart-licensed before onboarding? | Can the device already be registered with Cisco Cloud Services before you onboarding? |
| --- | --- | --- | --- | --- |
| Credentials (user name and password) | 6.4 or later | Yes | Yes | Yes |
| Registration Key | 6.4 or 6.5 | Yes | No. Unregister the smart license and then onboard the device. | N/A |
| Registration Key | 6.6 or later | Yes | Yes | No. Unregister the device from Cisco Cloud Services and then onboard the device. |
| Zero-Touch Provisioning | 6.7 or later | Yes | Yes | Yes |
| Onboarding a device with a Serial Number | 6.7 or later | Yes | Yes | Yes |

See [Cisco Firepower System Feature Licenses for more information](https://www.cisco.com/c/en/us/td/docs/security/firepower/roadmap/firepower-licenseroadmap.html).

### Device Addressing

It is a best practice that the address you use to onboard the FDM-managed device is a static address. If the device's IP address is assigned by DHCP, it would be optimal to use a DDNS (dynamic domain
name system) to automatically update your device's domain name entry with the new IP address of the device if it changes.

| **Note** | ---   FDM-managed devices do not natively support DDNS; you must configure your own DDNS.   --- |
| --- | --- |

| **Important** | ---   If your device gets an IP address from a DHCP server, and you *do not* have a DDNS server updating the FDM-managed device's domain name entry with any new IP addresses, or your device receives a new address, you can [change the IP address Security Cloud Control maintains for the device](basics-of-cisco-defense-orchestrator.html#Changing_a_Devices_IP_Address_in_CDO) and then [reconnect the device](basics-of-cisco-defense-orchestrator.html#How_to_BulkReconnect_toDevices). Better still, onboard the device with a registration key.   --- |
| --- | --- |

* [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface)
* [Managing an FDM-Managed Device from the Outside Interface](#About_Managing_FTD_from_the_Outside_Interface)
* [Onboard an FDM-Managed Device to Security Cloud Control](#Cisco_Concept.dita_d6daef95-4c3f-4b41-be5b-71699ca538fa)
* [Applying or Updating a Smart License](#Applying_or_Updating_a_Smart_License)
* [Security Cloud Control Support for DHCP Addressing of FDM-Managed Devices](#CDO_Support_for_DHCP_Addressing_of_FTD_Devices)
* [FDM-Managed Device Licensing Types](#FTD_Licensing_Types)
* [Create and Import an Firewall Device Manager Model](#Create_and_Import_an_FTD_Model)

### Managing an FDM-Managed Device from the Inside Interface

Managing an FDM-managed device using the inside interface may be desirable if the dedicated MGMT interface is
assigned an address that is not routable within your organization; for example, it might
only be reachable from within your data center or lab.

Figure 1. Interface Addresses

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457521.jpg)

#### Remote Access VPN Requirement

If the FDM-managed device you manage with Security Cloud Control will be managing Remote Access VPN (RA VPN) connections, Security Cloud Control must manage the device using the inside interface.

#### What to do next:

Continue to [Manage an FDM-Managed Device from the Inside Interface](#Manage_FTD_from_the_InsideInterface) for the procedure for configuring the FDM-managed device.

* [Manage an FDM-Managed Device from the Inside Interface](#Manage_FTD_from_the_InsideInterface)

#### Manage an FDM-Managed Device from the Inside Interface

This configuration method:

* Assumes that the FDM-managed device has not been on-boarded to Security Cloud Control.
* Configures a data interface as the inside interface.
* Configures the inside interface to receive MGMT traffic (HTTPS).
* Allows the address of the cloud connector to reach the inside interface of
  the device.

##### Before you begin

Review the prerequisites for this configuration in these topics:

* [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface)
* [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC)

##### Procedure

---

| **Step 1** | Log in to the Secure Firewall device manager. |
| --- | --- |
| **Step 2** | In the System Settings menu, click Management Access. |
| **Step 3** | Click the Data Interfaces tab and click Create Data Interface.   1. In the Interface field, select the pre-named "inside" interface from the list of interfaces. 2. In the Protocols field, select HTTPS if it is not already. 3. In the ****Allowed Networks**** field, select the network    objects that represent the networks inside your organization that    will be allowed to access the inside address of the FDM-managed device. The IP address of the SDC or cloud connector should be    among the addresses allowed to access the inside address of the    device.  In the [Interface Addresses](#About_Managing_FTDfrom_the_InsideInterface__ftd-interf-addrss) diagram, the SDC's IP address, 192.168.1.10 should be able to reach 192.168.1.1. |
| **Step 4** | Deploy the change. You can now manage the device using the inside interface. |

---

##### What to do next

**What if you are using a Cloud Connector?**

Use the procedure
above and add these steps:

* Add a step to "NAT" the outside interface to (203.0.113.2) to the inside
  interface (192.168.1.1). See [Interface
  Addresses](#About_Managing_FTDfrom_the_InsideInterface__ftd-interf-addrss).
* In step 3c of the procedure above, your "Allowed Network" is a network
  group object containing the public IP addresses of the cloud
  connector.
* Add a step that creates an Access Control rule allowing access to the outside interface (203.0.113.2) from the public IP addresses
  of the cloud connector. See for a list of all the Cloud Connector IP addresses for the various Security Cloud Control regions.

**Onboard the FDM-Managed Device**

The recommended way of onboarding the FDM-managed device to Security Cloud Control is to use the registration token onboarding approach. After you configure the inside interface to allow management access
from the Cloud Connector to the FDM-managed device, onboard the FDM-managed device with the user name and password. See [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_an_FTD_to_CDO) for more information. You will connect using the IP address of the inside interface. In our scenario above, that address
is 192.168.1.1.

### Managing an FDM-Managed Device from the Outside Interface

Managing an cloud-delivered Firewall
Management Center device from the outside interface may be desirable if you have one public IP address assigned to a branch office and Security Cloud Control is managed using a Cloud Connector at another location.

Figure 2. Device Management on Outside Interface

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457522.jpg)

This configuration doesn't mean that the physical MGMT interface is no longer the device's management interface. If you were
in the office where the cloud-delivered Firewall
Management Center device was located, you would be able to connect to the address of the MGMT interface and manage the device directly.

#### Remote Access VPN Requirement

If the device you manage with cloud-delivered Firewall
Management Center will be managing Remote Access VPN (RA VPN) connections, cloud-delivered Firewall
Management Center will not be able to manage the cloud-delivered Firewall
Management Center device using the outside interface. See [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface) instead.

#### What to do next:

Continue to [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface) for the procedure for configuring the cloud-delivered Firewall
Management Center device.

* [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface)

#### Manage the FDM-Managed Device's Outside Interface

This configuration method:

1. Assumes that the FDM-managed device has not been on-boarded to Security Cloud Control.
2. Configures a data interface as the outside interface.
3. Configures management access on the outside interface.
4. Allows the public IP address of the cloud connector (after it has been NAT'd
   through the firewall) to reach the outside interface.

##### Before you begin

Review the prerequisites for this configuration in these topics:

* [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface)
* [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC)

##### Procedure

---

| **Step 1** | Log in to the Secure Firewall device manager. |
| --- | --- |
| **Step 2** | In the System Settings menu, click Management Access. |
| **Step 3** | Click the Data Interfaces tab and click Create Data Interface.   1. In the Interface field, select the pre-named "outside" interface from the list of interfaces. 2. In the Protocols field, select    HTTPS if it is not already. Security Cloud Control only needs HTTPS access. 3. In the Allowed Networks field, create a host    network object containing the public-facing IP address of the cloud    connector after it gets NAT'd through the firewall.  In the [Device Management from    Outside Interface](#About_Managing_FTD_from_the_Outside_Interface__ftd-mgmt-out-addrss) network diagram, the cloud connector's    IP address, 10.10.10.55, would be NAT'd to 203.0.113.2. For the    Allowed Network, you would create a host network object with the    value 203.0.113.2. |
| **Step 4** | Create an Access Control policy in Secure Firewall device manager that allows management traffic (HTTPS) from the public IP address of the SDC or cloud connector, to the outside interface of your FDM-managed device. In this scenario, the source address would be 203.0.113.2 and the source protocol would be HTTPS; the destination address would be 209.165.202.129 and the protocol would be HTTPS. |
| **Step 5** | Deploy the change. You can now manage the device using the outside interface. |

---

##### What to do next

**What if you are using a cloud connector?**

The process is very similar, except for two things:

* In step 3c of the procedure above, your "Allowed Network" is a network group object containing the public IP addresses of
  the cloud connector. See [Connecting Devices to Security Cloud Control Through the Cloud Connector](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC__cloud-connect-ip) for a list of Cloud Connector IP addresses for the various Security Cloud Control regions.
* In step 4 of the procedure above, you create an Access Control rule that
  allows access to the outside interface from the public IP addresses of the
  cloud connector.

The [registration token onboarding](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key) approach is the recommended way of onboarding the FDM-managed device to Security Cloud Control. After you configure the outside interface to allow management access from the cloud connector, onboard the FDM-managed device. You will connect using the IP address of the outside interface. In our scenario, that address is 209.165.202.129.

### Onboard an FDM-Managed Device to Security Cloud Control

Use the following procedures to onboard an FDM-managed to Security Cloud Control with the following methods.

* [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_Procedure)
* [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number)
* [Onboard an FDM-Managed High Availability Pair](#Cisco_Concept.dita_5369ba64-fdc7-4637-a3d4-5235c9cd7d8f)
* [Onboard an FTD Cluster](#onboard-an-ftd-cluster)

#### Onboard an FDM-Managed Device Using Username, Password, and IP Address

Use this procedure to onboard an FDM-managed device using only the device credentials and the device's Management IP address.
This is the simplest method of onboarding an FDM-managed device. However, the recommended way of onboarding an FDM-managed device to Security Cloud Control is by using a [registration key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key).

##### Before you begin

| **Important** | ---   Before you onboard an FDM-managed device to Security Cloud Control, read [Onboard an FDM-Managed Device](#Onboarding_an_FTD_to_CDO) and [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC). They provide the general device requirements and onboarding prerequisites needed to onboard a device.   --- |
| --- | --- |

* You need the following information to onboard an FDM-managed device using the credentials method:

  + The device credentials Security Cloud Control will use to connect to the device.
  + The device's IP address of the interface you are using to manage the
    device. This may be the Management interface, an inside interface,
    or the outside interface depending on how you have configured your
    network.
  + The device must be managed by Secure Firewall
    device manager and configured for local management in order for you to onboard
    it to Security Cloud Control. It cannot be managed by Secure Firewall Management
    Center.

| **Note** | ---   If you connect to <https://eu.manage.security.cisco.com> and your FDM-managed device is running software version 6.4, you must use this method. You can only onboard an FDM-managed device running software version 6.5+.   --- |
| --- | --- |

##### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**.   | **Important** | When you attempt to onboard an FDM-managed device, Security Cloud Control prompts you to read and accept the Secure Firewall Threat Defense End User License Agreement (EULA), which is a one-time activity for your tenant. Once you accept the EULA, Security Cloud Control won't prompt you again to accept it unless the EULA changes. | | --- | --- | |
| **Step 5** | In the onboarding wizard, click **Use Credentials**. |
| **Step 6** | In the Device Details step:   * Click the **Secure Device Connector** button and select a Secure Device Connector (SDC) installed in your network. If you would rather not use an SDC, Security Cloud Control can connect to your FDM-managed device using the Cloud Connector. Your choice depends on how you [connect Security Cloud Control to your managed devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC). * Enter the device name in the **Device Name** field. This could be   the hostname of the device or any other name you choose. * In the**Location** field, enter the IP address of the interface   you are using to manage the device, hostname, or fully qualified   domain name of the device. The default port is 443.  | **Important** | If you already have a SecureX or Cisco Threat Response (CTR) account, you will need to merge your Security Cloud Control tenant and SecureX/CTR account in order for your devices to be registered with SecureX. Your accounts can be merged through the SecureX portal. See [Merge Your Security Cloud Control and SecureX Accounts](https://cisco.com/go/merge-accounts)  for instructions. Until your accounts are merged, you will not be able to see your device’s events in SecureX or benefit from other SecureX features. | | --- | --- | |
| **Step 7** | In the **Database Updates** area, the **Immediately perform security updates, and enable recurring updates** is enabled by default. This option immediately triggers a security update as well as automatically schedules the device to check for additional updates every Monday at 2AM. See [Update FTD Security Databases](configuring-ftd-devices.html#Update_the_Security_Databases) and [Schedule a Security Database Update for more information](#Createa_Scheduled_Security_Database_Update).  Disabling this option does not affect any previously scheduled updates you may have configured through FDM.  Click **Next**. |
| **Step 8** | Enter the device administrator's username and password and click **Next**. |
| **Step 9** | If there are pending changes on the device's Secure Firewall device manager, you will be notified and you can revert the changes or log in to the manager and deploy the pending changes. If there are no pending changes on Secure Firewall device manager, you will not see a prompt. |
| **Step 10** | (Optional) Add a label the device. See [Labels and Label Groups](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_f15e9db8-94d5-4516-9107-1af22df49154) for more information. |

---

#### Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key

This procedure describes how to onboard an FDM-managed device using a registration key. This method is the recommended way of onboarding the FDM-managed device to Security Cloud Control and is beneficial if your FDM-managed device is assigned an IP address using DHCP. If that IP address changes for some reason, your FDM-managed device remains connected to Security Cloud Control. Additionally, your FDM-managed device can have an address on your local area network, and as long as it can access the outside network, it can be onboarded
to Security Cloud Control using this method.

| **Warning** | ---   If you already have a SecureX or Cisco Threat Response (CTR) account, you will need to merge your Security Cloud Control tenant and SecureX/CTR account in order for your devices to be registered with SecureX. Until your accounts are merged, you will not be able to see your device's events in SecureX or benefit from other SecureX features. We **strongly** recommend merging your accounts before you create a Security Cloud Control module in SecureX. Your accounts can be merged through the SecureX portal. See [Merge Accounts](https://admin.sse.itd.cisco.com/assets/static/online-help/index.html#!t_merge-your-cdo-and-securex-accounts.html) for instructions.   --- |
| --- | --- |

##### Before Onboarding

* For customers running version 6.4, this method of onboarding is only
  supported for the US region, <https://us.manage.security.cisco.com>.
* For customers running version 6.4, and connecting to the EU region, they must
  onboard their device using its [device username, password, and
  IP address](#Onboarding_Procedure).
* Customers running version 6.5 or later, and connecting either to the US, EU,
  or APJ regions can use this method of onboarding.
* Review [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC) for the networking
  requirements needed to connect Security Cloud Control to yourFDM-managed device.
* Make sure your device is managed by Secure Firewall
  device manager, not Secure Firewall Management Center.
* Devices running version 6.4 and 6.5 must not be registered with Cisco Smart Software Manager before onboarding them with a
  registration key. You will need to unregister the smart licenses of those FDM-managed devices before onboarding them to Security Cloud Control. See "Unregistering a Smart-licensed Firewall device manager" below.
* The device may be using a 90-day evaluation license.
* Log in to the FDM-managed device and make sure that there are no pending changes waiting on the device.
* Make sure DNS is configured properly on your FDM-managed device.
* Make sure the time services are configured properly on the FDM-managed device.
* Make sure the FDM-managed device shows the correct date and time otherwise the onboarding will fail.

##### What to do next

Do one of these two these things:

* Unregsiter your FDM-managed device from Cisco Smart Software Manager if it is already smart-licensed.
  **You must unregister the device from Cisco Smart Software Manager
  before you onboard it to Security Cloud Control with a registration Key.**Continue to [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD).
* If your device is not already smart-licensed, continue to [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure).

* [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD)
* [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure)

##### Unregister a Smart-licensed FDM-Managed Device

If the device you want to onboard is running version 6.4 or 6.5, and is already smart-licensed, the device is likely to be
registered with Cisco Smart Software Manager. **You must unregister the device from Cisco Smart Software Manager before you onboard it to Security Cloud Control with a registration Key.** When you unregister, the base license and all optional licenses associated with the device, are freed in your virtual account.

After unregistering the device, the current configuration and policies on the device continue to work as-is, but you cannot
make or deploy any changes.

###### Procedure

---

| **Step 1** | Log on to the device using the Secure Firewall device manager. |
| --- | --- |
| **Step 2** | Click the device icon in the upper tab. |
| **Step 3** | In the **Smart License** area, click **View Configuration**. |
| **Step 4** | Click the **Go to Cloud Services** gear menu and select **Unregister Device**. |
| **Step 5** | Read the warning and click **Unregister** to unregister the device. |

---

###### What to do next

If you unregistered your in order to onboard it to Security Cloud Control, continue to [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure)

##### Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key

To onboard an FDM-managed using a registration key, follow this procedure:

###### Before you begin

Review the prerequisites discussed in [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key).

###### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**.   | **Important** | When you attempt to onboard an FDM-managed device, Security Cloud Control prompts you to read and accept the Firepower Threat Defense End User License Agreement (EULA), which is a one-time activity in your tenant. Once you accept this agreement, Security Cloud Control doesn't prompt it again in subsequent FDM-managed onboarding. If the EULA agreement changes in the future, you must accept it again when prompted. | | --- | --- | |
| **Step 5** | On the **Onboard FTD Device** screen, click **Use Registration Key**. |
| **Step 6** | Enter the device name in the **Device Name** field. This could be the hostname of the device or any other name you choose. |
| **Step 7** | In the **Database Updates** area, the **Immediately perform security updates, and enable recurring updates** option is enabled by default. This option immediately triggers a security update as well as automatically schedules the device to check for additional updates every Monday at 2AM. See [Update FTD Security Databases](configuring-ftd-devices.html#Update_the_Security_Databases) and [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update) for more information.   | **Note** | Disabling this option does not affect any previously scheduled updates you may have configured through Secure Firewall device manager. | | --- | --- | |
| **Step 8** | In the **Create Registration Key** area, Security Cloud Control generates a registration key.   | **Note** | If you move away from the onboarding screen after the key is generated and before the device is fully onboarded, you will not be able to return to the onboarding screen; however, Security Cloud Control creates a placeholder for that device on the **Security Devices** page. When you select the device's placeholder, you will be able to see the key for that device in an action pane located to the right. | | --- | --- | |
| **Step 9** | Click the Copy icon  to copy the registration key.   | **Note** | You can skip copying the registration key and click **Next** to complete the place holder entry for the device and later, register the device. This option is useful when you're attempting to create the device first and later register it or if you're a Cisco partner installing a Proof of Value (POV) device in a customer network. | | --- | --- |   In the **Security Devices** page, you will see that the device is now in the connectivity state, "Unprovisioned". Copy the registration key appearing under **Unprovisioned** to Firewall device manager to complete the onboarding process. |
| **Step 10** | Log into the Secure Firewall device manager of the device you want to onboard to Security Cloud Control. |
| **Step 11** | In **System Settings**, click **Cloud Services**. |
| **Step 12** | In the Security Cloud Control tile, click **Get Started**. |
| **Step 13** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to.   | **Note** | This step is not applicable FDM-managed devices running version 6.4. | | --- | --- | |
| **Step 14** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 15** | Click **Register** and then **Accept** the Cisco Disclosure. |
| **Step 16** | Return to Security Cloud Control. Select all the licenses you want to apply to the device.  For more information, see [Applying or Updating a Smart License](#Applying_or_Updating_a_Smart_License). You can also click **Skip** to continue the onboarding with a 90-day evaluation license. |
| **Step 17** | Return to Security Cloud Control, open the **Security Devices** page and see that the device status progresses from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

#### Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key

This procedure describes how to onboard an FDM-managed device running Version 6.6+ using a registration key. This method is the recommended way of onboarding the FDM-managed device to Security Cloud Control and is beneficial if your FDM-managed device is assigned an IP address using DHCP. If that IP address changes for some reason, your FDM-managed device remains connected to Security Cloud Control. Additionally, your FDM-managed device can have an address on your local area network, and as long as it can access the outside network, it can be onboarded
to Security Cloud Control using this method.

| **Warning** | ---   If you already have a SecureX or Cisco Threat Response (CTR) account, you will need to merge your Security Cloud Control tenant and SecureX/CTR account in order for your devices to be registered with SecureX. Until your accounts are merged, you will not be able to see your device's events in SecureX or benefit from other SecureX features. We **strongly** recommend merging your accounts before you create a Security Cloud Control module in SecureX. Your accounts can be merged through the SecureX portal. See [Merge Accounts](https://admin.sse.itd.cisco.com/assets/static/online-help/index.html#!t_merge-your-cdo-and-securex-accounts.html) for instructions.   --- |
| --- | --- |

If you want to onboard an FDM-managed device running version 6.4 or 6.5, see [Onboard an FDM-Managed Device Running
Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key).

##### Before Onboarding

* This method of onboarding is currently available for version 6.6+ and to
  customers connecting to <https://us.manage.security.cisco.com>, <https://eu.manage.security.cisco.com>, or <https://apj.manage.security.cisco.com>.
* **Review**
  [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC) for the networking
  requirements needed to connect Security Cloud Control to your FDM-managed device.
* Make sure your device is managed by Secure Firewall
  device manager, not Secure Firewall Management Center.
* The device can be using a 90-day evaluation license or it can be
  smart-licensed. Devices running version 6.6+ can be onboarded to Security Cloud Control using a registration key without unregistering any installed smart
  licenses.
* The device cannot already be registered with Cisco Cloud Services. See
  "Unregistering an FDM-Managed Device from Cisco Cloud Services" below before onboarding.
* Log in to the device's Secure Firewall
  device manager UI and make sure that there are no pending changes waiting on the
  device.
* Make sure DNS is configured properly on your FDM-managed device.
* Make sure the time services are configured on the FDM-managed device.
* Make sure the FDM-managed device shows the correct date and time otherwise the onboarding will fail.

##### What to do next:

Do one of these things:

* If your FDM-managed device running verison 6.6+ is already registered with Cisco Cloud
  Services, you need to unregister the device before onboarding it. Continue
  to [Unregistering an FDM-Managed Device from Cisco Cloud Services](#Unregistering_anFTD_from_Cisco_Cloud_Services).
* If your device is not registered to Cisco Cloud Services, continue to [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure).

* [Unregistering an FDM-Managed Device from Cisco Cloud Services](#Unregistering_anFTD_from_Cisco_Cloud_Services)
* [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure)

##### Unregistering an FDM-Managed Device from Cisco Cloud Services

The following procedure is how to unregister the device from Cisco Cloud Services. Use
this method before you onboard and FDM-managed device to Security Cloud Control with a registration key.

| **Note** | ---   If you onboard a virtual FDM-managed device running version 7.0 or later, registering the virtual FDM-managed device to Security Cloud Control automatically resets the performance-tiered Smart Licensing selection to **Variable**, which is the default tier. You **must** manually re-select the tier that matches the license associated with the device through the Secure Firewall device manager UI after onboarding.   --- |
| --- | --- |

Use this procedure to check and make sure it is not registered to Cisco Cloud Services:

###### Procedure

---

| **Step 1** | Log on to the device using Secure Firewall device manager. |
| --- | --- |
| **Step 2** | Click the device icon in the upper tab. |
| **Step 3** | Expand the **System Settings** menu and then click **Cloud Services**. |
| **Step 4** | In the **Cloud Services** page, click the gear menu and select **Unregister Cloud Services**. |
| **Step 5** | Read the warning and click **Unregister** to unregister the device. |

---

###### What to do next

If you are trying to onboard a FDM-managed device running version 6.6 or later, continue to [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure).

##### Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key

To onboard an FDM-managed device using a registration key, follow this procedure:

###### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**.   | **Important** | When you attempt to onboard the FDM-managed device, Security Cloud Control prompts you to read and accept the End User License Agreement (EULA), which is a one-time activity in your tenant. Once you accept this agreement, Security Cloud Control doesn't prompt it again in subsequent onboarding. If the EULA agreement changes in the future, you must accept it again when prompted. | | --- | --- | |
| **Step 5** | On the **Onboard FTD Device** screen, click **Use Registration Key**. |
| **Step 6** | Enter the device name in the **Device Name** field. This could be the hostname of the device or any other name you choose. |
| **Step 7** | In the **Database Updates** area, the **Immediately perform security updates, and enable recurring updates** is enabled by default. This option immediately triggers a security update as well as automatically schedules the device to check for additional updates every Monday at 2AM. See [Update FTD Security Databases](configuring-ftd-devices.html#Update_the_Security_Databases) and [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update) for more information.   | **Note** | Disabling this option does not affect any previously scheduled updates you may have configured through Secure Firewall device manager. | | --- | --- | |
| **Step 8** | In the **Create Registration Key** step, Security Cloud Control generates a registration key.   | **Note** | If you move away from the onboarding screen after the key is generated and before the device is fully onboarded, you will not be able to return to the onboarding screen; however, Security Cloud Control creates a placeholder for that device on the **Security Devices** page. When you select the device's placeholder, you will be able to see the key for that device, on that page. | | --- | --- | |
| **Step 9** | Click the Copy icon  to copy the registration key.   | **Note** | You can skip copying the registration key and click **Next** to complete the place holder entry for the device and later, register the device. This option is useful when you're attempting to create the device first and register it later, or if you're a Cisco partner installing a Proof of Value (POV) device in a customer network. | | --- | --- |   In the **Security Devices** page, you will see that the device is now in the connectivity state, "Unprovisioned". Copy the registration key appearing under **Unprovisioned**to Firewall device manager to completethe onboarding process. |
| **Step 10** | Log into the Secure Firewall device manager of the device you are onboarding. |
| **Step 11** | Under **System Settings**, click **Cloud Services**. |
| **Step 12** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to. |
| **Step 13** | In the **Enrollment Type** area, click **Security Account** .   | **Note** | For devices running version 6.6, note that the Tenancy tab for Security Cloud Control is titled **Security Account** and you must manually enable Security Cloud Control in Secure Firewall device manager. | | --- | --- | |
| **Step 14** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 15** | For devices running version 6.7 or later in the Service Enrollment area, check **Enable Cisco Security Cloud Control**. |
| **Step 16** | Review the information about the Cisco Success Network Enrollment. If you do not want to participate, uncheck the **Enroll Cisco Success Network** checkbox. |
| **Step 17** | Click **Register** and then **Accept** the Cisco Disclosure. Secure Firewall device manager sends the registration request to Security Cloud Control. |
| **Step 18** | Return to Security Cloud Control, in the **Create Registration Key** area, click **Next**. |
| **Step 19** | Select all licenses you want to apply to the device. Click **Next**. |
| **Step 20** | Return to Security Cloud Control, open the **Security Devices** page and see that the device status progresses from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

#### Onboard an FDM-Managed Device using the Device's Serial Number

This procedure is a simplified method of setting up and onboarding the FDM-managed devices to Security Cloud Control. All you need is the chassis serial number or PCA serial number of the device. You can apply a smart license or use a 90-day
evaluation license when onboarding the device.

Ensure that you read through the use cases to understand the concepts before you perform the [onboarding steps](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number).

| **Important** | ---   These methods of onboarding FDM-managed devices are only available for devices running version 6.7 or higher.   --- |
| --- | --- |

**Use Cases**

* [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number): Onboarding a new factory-shipped FDM-managed device that is added to a network and reached from the Internet. The initial device setup wizard is not complete on the device.
* [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number): Onboarding an already configured FDM-managed device or an upgraded device that is already added to a network and reached from the Internet. The initial device setup wizard
  is complete on the device.

| **Important** | ---   If you want to use this method to onboard a device running on an older software version that is supported for your device, you need to perform a fresh installation (reimage) of the software on that device instead of an upgrade.   --- |
| --- | --- |

* [Workflow and Prerequisites to Onboard the FDM-Managed Device Using Zero-Touch Provisioning](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number)
* [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number)

**Related Information:**

* [Terminologies and Definitions](faq-and-support.html#Terminologies_and_Definitionsused_inLowTouch_Provisioning)
* [Troubleshoot FDM-Managed Device Onboarding using Serial Number](troubleshooting.html#Cisco_Reference.dita_2c78ba62-d55a-4cef-8490-4d117af93f19)

##### Workflow and Prerequisites to Onboard the FDM-Managed Device Using Zero-Touch Provisioning

Zero-Touch Provisioning is a feature that allows a new factory-shipped Firepower 1000, Firepower 2100, or Secure Firewall 3100 series device to be provisioned and configured automatically, eliminating most of the manual tasks involved with onboarding
the device to Security Cloud Control. The zero-touch provisioning is intended for remote offices or other locations where your employees are less experienced working with networking devices.

To use the zero-touch provisioning process, you must onboard the device to Security Cloud Control, connect it to a network that can reach the internet, and power on the device. See [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number) for more information.

| **Note** | ---   You can power-on the device before or after onboarding it to Security Cloud Control. **We recommend that you onboard the device to Security Cloud Control first and power-on the device and connect it to your branch network second.** When you onboard the device in Security Cloud Control, the device is associated with your Security Cloud Control tenant in the Cisco cloud and Security Cloud Control automatically syncs the device configuration.   --- |
| --- | --- |

You can also use this procedure to onboard a device purchased from an external vendor or onboard
a device already managed by another cloud tenant in a different region. However, if the
device is already registered to the external vendor's cloud tenant or a cloud tenant in
a different region, Security Cloud Control doesn't onboard the device but displays the "*Device serial number already
claimed*" error message. In such cases, the Security Cloud Control admin must unregister the device's serial number from its previous cloud tenant and
then claim the Security Cloud Control device in their own tenant. See [Device Serial Number Already
Claimed](troubleshooting.html#Cisco_Reference.dita_f367a3ac-3ee6-4479-b548-67d3db7204bf__device-already-claimed) in the troubleshooting chapter.

The device **Connectivity** status changes to "Online" and the **Configuration** status changes to "Synced". The FDM-managed device is onboarded to Security Cloud Control.

You can see the Status LED (Firepower 1010), SYS LED (Firepower 2100), or S LED Secure Firewall 3100) flashing green on the rear panel of the hardware. The device LED continues to flash in green when it's connected to the
cloud. If the device can't connect to the Cisco cloud or loses its connectivity after being connected, you can see the Status
LED (Firepower 1010), SYS LED (Firepower 2100), or M LED (Secure Firewall 3100) flashing alternate green and amber.

See this video: [Installing Your Cisco Firepower Firewall Using Zero-Touch Provisioning](https://www.youtube.com/watch?v=1Bkg12rZa44) video to understand the LED indicators.

| **Important** | ---   If you have logged into the FDM-managed device console, SSH, or Secure Firewall Threat Defense, you would have changed the device's password during your first login. You can still use the zero-touch provisioning process for onboarding the device using Security Cloud Control. After you log into Secure Firewall Threat Defense, ensure that you do not complete the device setup wizard step that configures the outside interface. If you complete this step, the device is unregistered from the cloud, and you cannot use the zero-touch provisioning process.   --- |
| --- | --- |

When you log into Secure
Firewall Threat Defense, you will see the following screen on the dashboard.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453587.jpg)

Without proceeding further on the Secure
Firewall Threat Defense UI, go to the serial number onboarding wizard and onboard the device. Here, you must select **Default Password Changed** because the device password has already been changed.

###### Prerequisites

###### Software and Hardware Requirements

The FDM-managed devices must be running software that supports serial-number-onboarding. Use the
following table as a guide:

Table 1. Hardward and Software Support

| Firewall Model Numbers that Support Zero-Touch Provisioning | Supported Firewall Software Version | Software Package |
| --- | --- | --- |
| Firepower 1000 series device models: 1010, 1120, 1140, 1150 | 6.7 or later | SF-F1K-TDx.x-K9 |
| Firepower 2100 series device models: 2110, 2120, 2130, 2140 | 6.7 or later | SF-F2K-TDx.x-K9 |
| Secure Firewall 3100 series device models: 3110, 3120, 3130, 3140 | 7.1 or later | SF-F3K-TDx.x-K9 |

Confirm the management platforms are running the correct version.

Table 2. Support FTD Manager Versions

| Manager | Supported Version |
| --- | --- |
| Secure Firewall Device Manager | 7.0 or later |
| On-Premises Firewall Management Center | 7.2 or later |
| Cloud-delivered Firewall Management Center | Not applicable |

###### Configuration Prerequisites for Hardware Installation

* **The network at the branch office cannot use the 192.168.1.0/24 address space.** The network
  on Ethernet 1/1 (outside) cannot use the 192.168.1.0/24 address space. The
  default IP address of the Ethernet 1/2 "inside" interface on the 1000 and
  2100 series devices running FDM 6.7 is 192.168.1.1 may conflict with the
  DHCP address allocated by your WAN modem if it's on that subnet.

  + **inside** - Ethernet 1/2, IP address 192.168.1.1
  + **outside** - Ethernet 1/1, IP address from DHCP or an address you
    specify during setup

  ![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457559.jpg)

  If you are unable to change the outside interface settings, use Secure Firewall
  device manager to change the subnet on the Ethernet 1/2 "inside" interface settings to avoid conflict. For example, you could change to
  the following subnet settings:

  + IP Address: 192.168.95.1
  + DHCP server range: 192.168.95.5-192.168.95.254

  To learn about the steps for configuring the physical interface, see the "[Secure Firewall Device Manager Configuration Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)". In the "Interfaces" chapter, see the "Configure a Physical Interface" section.
* The threat defense device must be installed and connected to the Cisco Cloud.
* The outside or management interface of the device must be connected to a network providing DHCP addressing. Typically, the
  device has a default DHCP client on the outside or management interface.

  | **Note** | ---   If the management interface is connected to a network having a DHCP server, it takes precedence over the outside interface for Linux stack initiated traffic.   --- |
  | --- | --- |
* Your outside or management interface needs to access to be able to access the following Security Services
  Exchange domains for the serial onboarding method.

  + Australia Region

    - api.aus.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.aus.sse.itd.cisco.com (currently only
      mx01.aus.sse.itd.cisco.com)
    - dex.aus.sse.itd.cisco.com (for customer success)
    - eventing-ingest.aus.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.aus.sse.itd.cisco.com (allows for device
      registration to the regional Cisco cloud)
  + APJ Region

    - api.apj.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.apj.sse.itd.cisco.com (currently only
      mx01.apj.sse.itd.cisco.com)
    - dex.apj.sse.itd.cisco.com (for customer success)
    - eventing-ingest.apj.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - [http://registration.apj.sse.itd.cisco.com](http://registration.apj.sse.itd.cisco.com/)
      (allows for device registration to the regional Cisco
      cloud)
  + EU Region

    - api.eu.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.eu.sse.itd.cisco.com (currently only
      mx01.eu.sse.itd.cisco.com)
    - dex.eu.sse.itd.cisco.com (for customer success)
    - eventing-ingest.eu.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.eu.sse.itd.cisco.com (allows for device
      registration to the regional Cisco cloud)
  + India Region

    - api.in.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.in.sse.itd.cisco.com (currently only
      mx01.in.sse.itd.cisco.com)
    - dex.in.sse.itd.cisco.com (for customer success)
    - eventing-ingest.in.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.in.sse.itd.cisco.com (allows for device
      registration to the regional Cisco cloud)
  + US Region

    - api-sse.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.sse.itd.cisco.com (currently only mx01.sse.itd.cisco.com)
    - dex.sse.itd.cisco.com (for customer success)
    - eventing-ingest.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.us.sse.itd.cisco.com (allows for device registration to the regional Cisco cloud)
* The outside interface of the device must have DNS access to Cisco Umbrella DNS.

###### Before Claiming the Device in Security Cloud Control

Before claiming the device in Security Cloud Control, make sure that you have the following information:

* Chassis serial number or PCA number of the threat defense device. You can find this information on the bottom of the hardware chassis or on the carton box in which your device is
  delivered. In the following example picture, you can see the serial number "\*\*\*\*\*\*\*X0R9" on the bottom of the Firepower 1010
  chassis.

  ![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457546.jpg)
* The default password of the device.
* A smart license generated from [Cisco Smart Software Manager](https://software.cisco.com/software/csws/ws/platform/home?locale=en_US&locale=en_US#SmartLicensing-Inventory) for using the additional capabilities. However, you can complete the device onboarding using a 90-day evaluation license
  and later apply the smart license.

* [Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning](#Onboarding_Procedure)

###### Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning

| **Caution** | ---   When the device is being onboarded in Security Cloud Control, we recommend that you not perform the device easy setup using the Secure Firewall device manager. This causes provisional error in Security Cloud Control.   --- |
| --- | --- |

###### Before you begin

* The threat defense device must not be prevously or currently managed by Firewall Device Manager or Management Center. If the device is currently managed by a
  platform, see [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number).
* If you onboard a device with the intention of managing it with an on-premises management center, the on-premises management center
  **must** be running version 7.4 and later.

###### Procedure

---

| **Step 1** | If you are onboarding a device purchased from an external vendor, you must reimage the device first. For more information, see the "Reimage Procedures" chapter of the [Cisco FXOS Troubleshooting Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/2100/troubleshoot_fxos/b_2100_CLI_Troubleshoot.html). |
| --- | --- |
| **Step 2** | Log in to Security Cloud Control. |
| **Step 3** | In the navigation pane, click Security Devices. |
| **Step 4** | Click the blue plus button  to **Onboard** a device. |
| **Step 5** | Click the **FTD** tile.   | **Important** | When you attempt to onboard a device, Security Cloud Control prompts you to read and accept the End User License Agreement (EULA), which is a one-time activity in your tenant. Once you accept this agreement, Security Cloud Control doesn't prompt it again in subsequent onboarding. If the EULA agreement changes in the future, you must accept it again when prompted. | | --- | --- | |
| **Step 6** | On the **Onboard FTD Device** screen, click **Use Serial Number**. |
| **Step 7** | In the **Select FMC** step, use the drop-down menu to select an on-premises management center that has already been onboarded to Security Cloud Control. Click **Next**.  The on-premises management center must be running version 7.4 or higher. If you do not have an on-premises management center onboarded, click +Onboard On-Prem FMC for the onboarding wizard. |
| **Step 8** | In the **Connection** step, enter the device's serial number and device name. Click **Next**. |
| **Step 9** | For zero-touch provisioning, the device must be brand new, or has been reimaged. For the **Password Reset**, be sure to select **Yes, this new device has never been logged into or configured for a manager**. Enter a new password and confirm the new password for the device, then click **Next**. |
| **Step 10** | For **Policy Assignment**, use the drop-down menu to select a access control policy to be deployed once the device is onboarded. If you do not have a customized policy, Security Cloud Control auto-selects the default access control policy. Click **Next**. |
| **Step 11** | Select all licenses you want to apply to the device. Click **Next**. |
| **Step 12** | (Optional) Add labels to the device. Security Cloud Control applies these labels once the device successfully onboards. |

---

###### What to do next

Security Cloud Control starts claiming the device, and you will see the **Claiming** message on the right. Security Cloud Control continuously polls for an hour to determine if the device is online and registered to the cloud. Once it's registered to
the cloud, Security Cloud Control starts the initial provisioning and onboards the device successfully. The device registration can be confirmed when the LED
status flashes green on the device. If the device can't connect to the Cisco cloud or lose its connectivity after being connected,
you can see the Status LED (Firepower 1000) or SYS LED (Firepower 2100) flashing alternate green and amber.

If the device is still not registered to the cloud within the first one hour, a time-out occurs, and now Security Cloud Control polls periodically for every 10 minutes to determine the device status and remain in **Claiming** state. When the device is turned on and connected to the cloud, you don't have to wait for 10 minutes to know its onboarding
status. You can click the **Check Status** link anytime to see the status. Security Cloud Control starts the initial provisioning and onboards the device successfully.

| **Important** | ---   Suppose you have already completed the device setup wizard (see [Onboard an Already Configured FDM-Managed Device](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number)), the device is unregistered from the cloud, and in this case, Security Cloud Control remains in **Claiming** state. You need to complete manual registration from Secure Firewall device manager to add it to Security Cloud Control. (In Secure Firewall device manager, go to **System Settings** > **Cloud Services** and select the **Auto-enroll with Tenancy from Cisco Security Cloud Control** option and click **Register**). Then, click **Check Status**.   --- |
| --- | --- |

##### Onboard a Configured FDM-Managed Device using the Device's Serial Number

This procedure is for devices that have already been configured for local management. Because the device setup wizard is completed
on an already configured FDM-managed device, the device is unregistered from the cloud, and you can't onboard such devices to Security Cloud Control using the zero-touch provisioning process.

If you device is brand new and has never been managed or configured, you can onboard the device with zero-touch provisioning. See [Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning](#Onboarding_Procedure) for more information.

| **Note** | ---   When the device is not connected to the Cisco cloud, you can see the Status LED (Firepower 1000), SYS LED (Firepower 2100), or M LED (Secure Firewall 3100) flashing alternate green and amber.   --- |
| --- | --- |

You may have completed the device setup wizard to perform the following tasks:

* The device must be running version 6.7 or later.
* Configure a static IP address on the management interface of the device. If
  the interfaces cannot obtain the necessary dynamic IP address, or the DHCP
  server does not provide the gateway route, you need to configure a static IP
  address.
* Obtain an address using PPPoE and configure the outside interface.
* Manage the device running version 6.7 or later device using Secure Firewall
  device manager or Secure Firewall Management Center.
* You have an active SecureX account. If you do not have a SecureX account, see [SecureX and Security Cloud Control](https://docs.defenseorchestrator.com/securex.html) for more information.
* Your Security Cloud Control and SecureX account are merged. See [Link Your Security Cloud Control and SecureX or Cisco XDR Tenant Accounts](https://admin.sse.itd.cisco.com/assets/static/online-help/index.html#!t_merge-your-cdo-and-securex-accounts.html) for more information.

| **Important** | ---   You can switch the manager of a Secure Firewall Threat Defense device from Secure Firewall device manager to Secure Firewall Management Center, or the other way. Perform the steps explained in the **Switching Between Local and Remote Management** section of the "System Management" chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor854) for the version the device runs.   --- |
| --- | --- |

If you want to onboard devices, perform the following:

###### Procedure

---

| **Step 1** | Review the prerequisites for onboarding here [Procedure for Onboarding FDM-Managed Device using Device Serial Number](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number). |
| --- | --- |
| **Step 2** | In the Secure Firewall device manager UI, navigate to System Settings > Cloud Services and select the Auto-enroll with Tenancy from **Cisco Security Cloud Control**option and click Register. |
| **Step 3** | Log in to Security Cloud Control. |
| **Step 4** | In the navigation pane, click Security Devices. |
| **Step 5** | Click the **FTD tile.** |
| **Step 6** | On the **Onboard FTD Device** screen, click **Use Serial Number**. |
| **Step 7** | In the **Select FMC** step, use the drop-down menu to select an on-premises management center that has already been onboarded to Security Cloud Control. Click **Next**.  The on-premises management center must be running version 7.4 or higher. If you do not have an on-premises management center onboarded, click +Onboard On-Prem FMC for the onboarding wizard. |
| **Step 8** | In the **Connection** step, enter the device's serial number and device name. Click **Next**. |
| **Step 9** | If the device is **not** brand new and has already been configured for management, select **Yes, this new device has never been logged into or configured for a manager** for the **Password Reset**. Click **Next**. |
| **Step 10** | For **Policy Assignment**, use the drop-down menu to select a access control policy to be deployed once the device is onboarded. If you do not have a customized policy, Security Cloud Control auto-selects the default access control policy. Click **Next**. |
| **Step 11** | Select all licenses you want to apply to the device. Click **Next**. |

---

Security Cloud Control changes the device **Connectivity** status changes to "Online" and the
**Configuration** status changes to the "Synced" state. The FDM-managed device is onboarded to Security Cloud Control. You can see the Status LED (Firepower 1000), SYS LED (Firepower 2100), or M LED flashing green on the rear panel of the hardware. The device LED
continues to flash in green when it's connected to Cisco Cloud. If the device can't
connect to the Cisco cloud or loses its connectivity after being connected, you can
see the same status LED flash alternate green and amber.

**Related Information:**

* [Terminologies and Definitions](faq-and-support.html#Terminologies_and_Definitionsused_inLowTouch_Provisioning)

#### Onboard an FDM-Managed High Availability Pair

To onboard an Secure Firewall Threat
Defense HA pair to Security Cloud Control, you must onboard each device of the pair individually. Once both peers of the pair are onboarded Security Cloud Control automatically combines them as a single entry in the **Seurity Devices** page. Onboard the devices using either the device login credentials or a registration key. We recommend onboarding **both** devices with the same method. Also be aware that if you onboard a device that is in standby mode first, Security Cloud Control disables the ability to deploy or read from that device. You can only read or deploy to the active device within an HA pair.

| **Note** | ---   Security Cloud Control strongly recommends onboarding devices with a registration key. Onboarding with a registration key is slightly different for Threat Defense devices running specific versions. See [Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5](#Onboard_an_FTD_HA_Pair_Running_Version_64_or_Version_65) and [Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later](#Onboard_an_FTD_HA_Pair_Running_Version_66_or_Version_67_and_later) for more information.   --- |
| --- | --- |

Before you onboard an Threat Defense HA pair to Security Cloud Control, review the following:

* Your HA pair is already formed prior to onboarding to Security Cloud Control.
* Both devices are in a healthy state. The pair could be either primary/active and
  secondary/standby **or** primary/standby and secondary/active modes.
  Unhealthy devices will not successfully sync to Security Cloud Control.
* Your HA pair is managed by Secure Firewall
  device manager, not Secure Firewall Management Center.
* Your cloud connector connects to Security Cloud Control at <https://us.manage.security.cisco.com>.

* [Onboard an FDM-Managed High Availablity Pair with a Registration Key](#Before_You_Begin)
* [Onboard an FDM-Managed High Availability Pair](#Cisco_Task.dita_4b81ad97-372f-4a17-9312-64c8dc973b37)

##### Onboard an FDM-Managed High Availablity Pair with a Registration Key

Be aware of the following prerequisites before you onboard an FDM-managed High Availability (HA) pair with a registration key:

* Onboarding devices that are running version 6.4 with a registration key is only
  supported for the US region (<https://us.manage.security.cisco.com>). To connect to the EU region (<https://eu.manage.security.cisco.com>) they must onboard their HA pair with username, password, and IP address.
* Customers running version 6.5 or later, and connecting either to the US, EU, or
  APJ regions can use this method of onboarding.
* Devices running version 6.4 and 6.5 must not be registered with Cisco Smart
  Software Manager before onboarding them with a registration key. You will need
  to unregister the smart licenses of those FDM-managed devices before onboarding them to Security Cloud Control. See [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD) for more information.

* [Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5](#Onboard_an_FTD_HA_Pair_Running_Version_64_or_Version_65)
* [Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later](#Onboard_an_FTD_HA_Pair_Running_Version_66_or_Version_67_and_later)

###### Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5

To onboard an FDM-managed HA pair running software version 6.4 or 6.5, you must onboard the devices one at a time. It does not matter if you onboard
the active or standby, the primary or secondary device.

| **Note** | ---   If you onboard either device of an HA pair with a registration key, you must onboard the other peer device in the same method.   --- |
| --- | --- |

Use the following steps for onboard an HA pair running Version 6.4 or 6.5:

###### Procedure

---

| **Step 1** | Onboard a peer device. See [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure) to onboard the first device within the pair. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the **Devices** tab to locate your device. |
| **Step 4** | Click the **FTD** tab. Once the device is synced, select the device so it is highlighted. In the action pane located directly below **Device Details**, click **Onboard Device**. |
| **Step 5** | Enter the **HA Peer Device Name** for the peer device that has already been onboarded. Click **Next**. |
| **Step 6** | If you provided a smart license for the first device, Security Cloud Control repopulates that license so you can use it for onboarding this current device. Click **Next**.   | **Note** | If you unregistered your device's Smart License to onboard your FDM-managed device, this is where you re-apply the smart license. | | --- | --- | |
| **Step 7** | Security Cloud Control automatically generates that registration key for the device you are preparing to onboarding. Click the Copy icon  to copy the registration key. |
| **Step 8** | Log into the Secure Firewall device manager UI of the device you are onboarding. |
| **Step 9** | In **System Settings**, click **Cloud Services**. |
| **Step 10** | In the Security Cloud Control tile, click **Get Started**. |
| **Step 11** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 12** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to.   | **Note** | This step is not applicable to the FDM-managed device running on version 6.4. | | --- | --- | |
| **Step 13** | Click **Register** and then **Accept** the Cisco Disclosure. |
| **Step 14** | Return to Security Cloud Control and, in the **Create Registration Key** area, click **Next**. |
| **Step 15** | Click **Go to Security Devices**. Security Cloud Control automatically onboards the device and combines them as a single entry. Similar to the first peer device you onboard, the device status changes from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

###### Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later

To onboard an FDM-managed HA pair running threat defense version 6.6 or 6.7, you must onboard the device one at a time. It does not matter if you onboard
the active or standby, the primary or secondary device.

| **Note** | ---   If you onboard either device of an HA pair with a registration key, you must onboard the other peer device in the same method.  Use the following steps for onboard an HA pair running version 6.6 or 6.7:   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Onboard a peer device. See [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key) |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the **Devices** tab to locate your device. |
| **Step 4** | Click the **FTD** tab. Once the device is synced, select the device so it is highlighted. In the action pane located directly below **Device Details**, click **Onboard Device**. |
| **Step 5** | Enter the HA Peer Device Name for the peer device that has already been onboarded. Click **Next**. |
| **Step 6** | If you provided a smart license for the first device, Security Cloud Control repopulates that license so you can use it for onboarding this current device. Click **Next**. |
| **Step 7** | Security Cloud Control automatically generates that registration key for the device you are preparing to onboarding. Click the Copy icon  to copy the registration key. |
| **Step 8** | Log into the Secure Firewall device manager UI of the device you want to onboard to Security Cloud Control. |
| **Step 9** | Under **System Settings**, click **Cloud Services**. |
| **Step 10** | In the **Enrollment Type** area, click **Security/Security Cloud Control Account**.   | **Note** | For devices running version 6.6, note that the Tenancy tab for Security Cloud Control is titled **Security Account** and you must manually enable Security Cloud Control in the Secure Firewall device manager UI. | | --- | --- | |
| **Step 11** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to. |
| **Step 12** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 13** | For devices running version 6.7 or later in the Service Enrollment area, check **Enable Cisco Security Cloud Control**. |
| **Step 14** | Review the information about the Cisco Success Network Enrollment. If you do not want to participate, uncheck the **Enroll Cisco Success Network** check box. |
| **Step 15** | Click **Register** and then **Accept** the Cisco Disclosure. FDM sends the registration request to Security Cloud Control. |
| **Step 16** | Return to Security Cloud Control, in the **Create Registration Key** area, click **Next**. |
| **Step 17** | In the **Smart License** area, you can apply a smart license to the FDM-managed device and click **Next**or you can click **Skip** to continue the onboarding with a 90-day evaluation license or if the device is already smart-licensed. For more information, see [Updating an Existing Smart License of an FDM-Managed Device](#Updating_an_Existing_Smart_Licenseof_anFTDDevice).   | **Note** | If your device is running version 6.6, you need to manually enable communication to Security Cloud Control. From the device's FDM-managed UI, navigate to System Settings > Cloud Services and, in the **Cisco Security Cloud Control** tile, click **Enable**. | | --- | --- | |
| **Step 18** | Return to Security Cloud Control, click **Go to Security Devices**. Security Cloud Control automatically onboards the device and combines them as a single entry. Similar to the first peer device you onboard, the device status changes from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

##### Onboard an FDM-Managed High Availability Pair

| **Note** | ---   Whichever method you onboard the first device of an HA pair with, you must onboard the other peer device in the same method.   --- |
| --- | --- |

To onboard an FDM-managed HA pair that has been created outside of Security Cloud Control, follow this procedure:

###### Procedure

---

| **Step 1** | Onboard one of the peer devices within the HA pair. Onboard the device with its [username](#Onboarding_Procedure), [registration key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key), or [serial number](#Onboarding_Procedure). |
| --- | --- |
| **Step 2** | Once the device is synced, in the **Security Devices** page, click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the device. In the action pane located directly below **Device Details**, click **Onboard Device**. |
| **Step 5** | In the pop-up window, enter the HA peer's device name and location. |
| **Step 6** | Click **Onboard Device**. Once both devices are successfully synced to Security Cloud Control, the HA pair is displayed as a single entity in the **Security Devices** page. |

---

#### Onboard an FTD Cluster

* [Onboard a Clustered Secure Firewall Threat Defense Device](#onboard-a-ftd-cluster)

##### Onboard a Clustered Secure Firewall Threat Defense Device

Onboard a threat defense device that has already been clustered with the following procedure:

###### Before you begin

The following devices support clustering:

* Secure Firewall 3100 devices
* Firepower 4100 devices
* Firepower 9300 devices
* Threat Defense Virtual device (AWS, Azure, VMware, KVM, GCP)

Note the following limitations for clustered devices:

* Devices must be running at least version 6.4.
* Devices must be managed by a physical or virtual Secure Firewall Management
  Center.
* Firepower 4100 and Firepower 9300 devices must be clustered through the device's chassis manager.
* Secure Firewall 3100 devices, KVM, and VMware environments must be clustered through the Secure Firewall Management Center UI.
* Azure, AWS, and GCP environment clusters must be created through their own environment and onboarded to Secure Firewall Management
  Center.

###### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**. |
| **Step 5** | Under **Management Mode**, be sure **FTD** is selected.  By selecting **FTD**, you are retaining Secure Firewall Management Center as the managing platform. If you select **FDM**, this switches the manager from Secure Firewall Management Center to a local manager such as the Firewall Device Manager or cloud-delivered Firewall Management Center. Note that Switching managers resets all existing policy configurations except for interface configurations and you must re-configure policies after you onboard the device. |
| **Step 6** | On the **Onboard FTD Device** screen, click **Use CLI Registration Key**. |
| **Step 7** | Enter the device name in the **Device Name** field. This could be the hostname of the device or any other name you choose. |
| **Step 8** | In the Policy Assignment step, use the drop-down menu to select an access control policy to deploy once the device is onboarded. If you have no policies configured, select the Default Access Control Policy. |
| **Step 9** | Specify whether the device you are onboarding is a physical or virtual device. If you are onboarding a virtual device, you must select the device's performance tier from the drop-down menu. |
| **Step 10** | Select the essentials licenses you want applied to the device. Click **Next**. |
| **Step 11** | Security Cloud Control generates a command with the registration key. Paste the entire registration key as is into the device's CLI. |
| **Step 12** | The device starts to onboard. As an optional step, you can add labels to your device to help sort and filter the **Security Devices** page. Enter a label and select the blue plus button. . |

---

###### What to do next

Once the device is sychronized, Security Cloud Control automatically detects that the device is clustered. From here, select the device you just onboarded from the **Security Devices** page and select any of the options listed under the Management pane located to the right. We strongly recommend the following
actions:

* If you did not already, create a custom access control policy to customize the security for your environment. See [FDM-Managed Access Control Policy](configuring-ftd-devices.html#FTD_Access_Control_Policy) for more information.
* Enable Cisco Security Analytics and Logging (SAL) to view events in the Security Cloud Control dashboard **or** register the device to an Secure Firewall Management Center for security analytics.

### Applying or Updating a Smart License

#### Applying a New Smart License to an FDM-Managed Device

Perform one of the following procedures to Smart License the FDM-managed device:

* Smart license an FDM-managed device when onboarding using a registration key.
* Smart license an FDM-managed device after onboarding the device using a registration key or the administrator's credentials.

| **Note** | ---   The FDM-managed device may be using a 90-day evaluation license, or the license could be unregistered.   --- |
| --- | --- |

* [Smart-License an FDM-Managed Device When Onboarding Using a Registration Key](#SmartLicense_an_FTDDevice_When_OnboardingUsing_a_Registration_Key)
* [Smart-License an FDM-Managed Device After Onboarding the Device Using a Registration Key or its Credentials](#SmartLicensean_FTDDevice_After_Onboarding_the_Device_Using_a_Registration_Key_or_its_Credentials)
* [Updating an Existing Smart License of an FDM-Managed Device](#Updating_an_Existing_Smart_Licenseof_anFTDDevice)
* [Change the Smart License Applied to an FDM-Managed Device Onboarded Using a Registration Key](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_a_Registration_Key)
* [Change the Smart License Applied to an FDM-Managed Device Onboarded Using its Credentials](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_its_Credentials)

#### Smart-License an FDM-Managed Device When Onboarding Using a Registration Key

##### Procedure

---

| **Step 1** | Log on to the [Cisco Smart Software Manager](https://software.cisco.com/software/csws/ws/platform/home?locale=en_US#SmartLicensing-Inventory) and generate a new Smart License key. Copy the newly generated key. You can watch the [Generate Smart Licensing](https://www.youtube.com/watch?v=8nSyUDEAJEE) video for more information. |
| --- | --- |
| **Step 2** | Begin onboarding an FDM-managed device using a registration key. For more information, see [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key) or [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key). |
| **Step 3** | In step 4 of the onboarding wizard, in the **Smart License here** box, paste the Smart License in the **Activate** field and click **Next**. |
| **Step 4** | Click **Go to Security Devices**. |
| **Step 5** | Click the **FTD** tab and see the progress of the onboarding process. The device starts synchronizing and applies the Smart License.  You should see that the device is now in the **Online** connectivity state. If the device is not in the online connectivity state, look in the Device Actions pane on the right and click Manage Licenses > Refresh Licenses to update the connectivity state. |
| **Step 6** | After applying the Smart License successfully to the FDM-managed device, click the **Manage Licenses**. The device status shows "**Connected**, **Sufficient License**." You can enable or disable the optional licenses. For more information, see [FDM-managed Device Smart Licensing Types](#FTD_Licensing_Types). |

---

#### Smart-License an FDM-Managed Device After Onboarding the Device Using a Registration Key or its Credentials

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate the device. |
| **Step 3** | Click the **FTD** tab and select the device that you want to license. |
| **Step 4** | In the **Device Actions** pane on the right, click **Manage Licenses**. |
| **Step 5** | Follow the on-screen instructions and enter the Smart License generated from Cisco Smart Software Manager. |
| **Step 6** | Paste the new license key in the box and click **Register Device**. After synchronizing with the device, the connectivity state changes to 'Online'. After applying the Smart License successfully to the FDM-managed device, the device status shows "**Connected**, **Sufficient License**." You can enable or disable the optional licenses. For more information, see [FDM-managed Device Smart Licensing Types](#FTD_Licensing_Types). |

---

#### Updating an Existing Smart License of an FDM-Managed Device

You can apply a new Smart License to an FDM-managed device which is Smart Licensed. Based on the method you have selected for onboarding your device, select the appropriate
procedure:

#### Change the Smart License Applied to an FDM-Managed Device Onboarded Using a Registration Key

##### Procedure

---

| **Step 1** | Remove the corresponding FDM-managed device from Security Cloud Control. |
| --- | --- |
| **Step 2** | Log into the Secure Firewall device manager for that device and unregister the Smart License. For more information, see [Unregister a Smart-licensedFDM-Managed Device](#Unregistering_a_Smartlicensed_FTD). |
| **Step 3** | In Security Cloud Control, onboard the FDM-managed device again using a registration key. For more information, see [Onboard an FDM-Managed Device with a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key). |
| **Step 4** | Click the **Devices** tab to locate the device. |
| **Step 5** | Click the tab. |
| **Step 6** | Apply the new Smart License during the onboarding process or by looking in the **Device Actions** pane on the right and clicking**Manage Licenses**. |

---

#### Change the Smart License Applied to an FDM-Managed Device Onboarded Using its Credentials

##### Procedure

---

| **Step 1** | Log into the Secure Firewall device manager for that device and unregister the Smart License. For more information, see [Onboard an FDM-Managed Device with a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key). |
| --- | --- |
| **Step 2** | Apply the new Smart License to the FDM-managed device in Secure Firewall device manager.   1. In the **Smart License** area, click **View    Configuration**. 2. Click **Register Now** and follow the onscreen instructions. |
| **Step 3** | In the left pane, click Security Devices page in Security Cloud Control, and then click the Devices tab. |
| **Step 4** | Click the **FTD** device. Check the FDM-managed device configuration for changes so that Security Cloud Control can make a copy of the FDM-managed device's deployed configuration and save it to the Security Cloud Control database. For more information, see [Reading, Discarding, Checking for, and Deploying Configuration Changes](configuring-ftd-devices.html#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a). |

---

### Security Cloud Control Support for DHCP Addressing of FDM-Managed Devices

What happens if the IP address used by my FDM-managed device changes?

Security Cloud Control has many Adaptive Security Appliance (ASA) and FDM-managed device customers who have onboarded devices using the IP address provided by their service provider using DHCP.

If the IP address of the device for any reason, whether that is a change in the static IP address or a change in the IP address
due to DHCP, you can [change the IP address that Security Cloud Control uses to connect to the device](basics-of-cisco-defense-orchestrator.html#Changing_a_Devices_IP_Address_in_CDO) and then reconnect the device.

The field, expressed concerns regarding the case of branch deployed FDM-managed devices managed by Security Cloud Control, a static IP is required on the outside interface of the FDM-managed device, which, in the view of some SE's, precludes using Security Cloud Control as a management solution when the FDM-managed device has a DHCP address configured for the outside interface.

However, this situation does not impact customers that have VPN tunnels to remote branch firewalls, and we know that a vast
majority of customers have Site to Site tunnels from their Branch Offices back to their datacenters. In the case that Site-to
-Site VPN is used to connect to the central site from devices, DHCP on the outside interface is not a concern since Security Cloud Control (and any management platform) can connect to the FW via its inside, statically addressed, interface (if so configured). This
is a recommended practice and we have Security Cloud Control customers with many (+1000) devices using this deployment mode.

Also, the fact that an interface IP address is being issued via DHCP does not preclude the customer from managing the device
using that IP. Again, this is not optimal, but the experience of periodically having to potentially change the IP address
in Security Cloud Control has not been seen as a hurdle to customers. This situation is not exclusive to Security Cloud Control and happens with any manager using the outside interface including ASDM, FDM or SSH.

### FDM-Managed Device Licensing Types

#### Smart License Types

The following table explains the licenses available for FDM-managed devices.

Your purchase of an FDM-managed device automatically includes a base license. All additional licenses are
optional.

| License | Duration | Granted Capabilities |
| --- | --- | --- |
| License (automatically included) | Perpetual | All features not covered by the subscription term licenses.  You must also specify whether to Allow export-controlled functionality on the products registered with this token. You can select this option only if your country meets export-control standards. This option controls your use of advanced encryption and the features that require advanced encryption. |
|  | Term-based | **Intrusion detection and prevention**-Intrusion policies analyze network traffic for intrusions and exploits and, optionally, drop offending packets.  **File control**-File policies detect and, optionally, block users from uploading (sending) or downloading (receiving) files of specific types. AMP for Firepower, which requires a Malware license, allows you to inspect and block files that contain malware. You must have the license to use any type of File policy.  **Security Intelligence filtering**-Drop selected traffic before the traffic is subjected to analysis by access control rules. Dynamic feeds allow you to drop connections based on the latest intelligence immediately. |
| Malware | Term-based | File policies that check for malware, which use Cisco Advanced Malware Protection (AMP) with AMP for Firepower (network-based Advanced Malware Protection) and Cisco Threat Grid.  File policies can detect and block malware in files transmitted over your network. |
| URL License | Term-based | Category and reputation-based URL filtering.  You can perform URL filtering on individual URLs without this license. |
|  | Term-based or perpetual based on the license type | Remote access VPN configuration. Your essentials license must allow export-controlled functionality to configure RA VPN. You select whether you meet export requirements when you register the device.  Firepower Device Manager can use any valid AnyConnect license. The available features do not differ based on the license type. If you have not already purchased one, see Licensing Requirements for Remote Access VPN.  Also, see the Cisco AnyConnect Ordering Guide,  [http://www.cisco.com/c/dam/en/us/products/collateral/security/anyconnect-og.pdf](https://www.cisco.com/c/en/us/products/collateral/security/anyconnect-og.html). |

* [Virtual FDM-Managed Device Tiered Licenses](#Cisco_Concept.dita_c59521f9-9d6c-4838-9b34-f4de7a69dc07)
* [Viewing Smart-Licenses for a Device](#Viewing_SmartLicenses_for_a_Device)
* [Enabling or Disabling Optional Licenses](#Before_you_Begin)
* [Impact of Expired or Disabled Optional Licenses](#Impact_of_Expired_or_Disabled_Optional_Licenses)

#### Virtual FDM-Managed Device Tiered Licenses

Version 7.0 introduces support for performance-tiered Smart Licensing for virtual FDM-Managed devices based on throughput requirements and RA VPN session limits. When the virtual
FDM-Managed device is licensed with one of the available performance licenses, two things occur:
session limits for RA VPNs are determined by the installed virtual FDM-Managed device platform entitlement tier, and enforced via a rate limiter.

Security Cloud Control
****does not**** fully support tiered smart licensing at this time; see the
following limitations:

* You cannot modify the tiered license through Security Cloud Control. You must make the changes in the Secure Firewall
  device manager UI.
* If you register a virtual FDM-Managed device to be managed by the cloud-delivered Firewall
  Management Center, the tiered license selection automatically resets to **Variable**, which
  is the default tier.
* If you onboard a virtual FDM-Managed device running version 7.0 or later, and select a license that is **not** a default license during the onboarding process, the tiered license selection automatically resets to **Variable**, which is the default tier.

We strongly recommend selecting a tier for your virtual FDM-Managed device license after onboarding your device to avoid the issues listed above. See  [Managing Smart Licenses](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/fdm/fptd-fdm-config-guide-700/fptd-fdm-license.html#id_12167) for more information.

#### Viewing Smart-Licenses for a Device

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select an FDM-managed device to view its current license status. |
| **Step 5** | In the **Device Actions** pane on the right, click Manage Licenses. The **Manage Licenses** screen provides the following information:   * **Smart License Agent status**: Shows whether you're using a   90-day evaluation license, or if you have registered with the Cisco   Smart Software Manager. The Smart License Agent status can be the   following:    + **"Connected," "Sufficient Licenses"** - The device has     contacted and registered successfully with the License     Authority, which has authorized the license entitlements for     the appliance. The device is now In-Compliance.   + **Out-of-Compliance** - There's no available license     entitlement for the device. Licensed features continue to     work. However, you can either purchase or free up extra     entitlements to become In-Compliance.   + **Authorization Expired** - The device hasn't communicated     with the Licensing Authority in 90 or more days. Licensed     features continue to work. In this state, the Smart License     Agent retries its authorization requests. If a retry     succeeds, the agent enters either an Out-of-Compliance or     Authorized state and begins a new Authorization Period. Try     manually synchronizing the device. * **License Registration**: Allows you to apply smart-license to an   already onboarded FDM-managed device. Once registered, you can see the status of the connection   to the Cisco Smart Software Manager and the status for each type of   license. * **License Status**: Shows the status of the optional licenses   available for your FDM-managed device. You can enable a license to use the   features controlled by the license. |

---

#### Enabling or Disabling Optional Licenses

You can enable (register) optional licenses on FDM-managed devices that are using a 90-day
evaluation license or a full license. You must enable a license to use the features
controlled by the license.

If you no longer want to use the features covered by an optional term license, you
can disable (release) the license. Disabling the license releases it in your Cisco
Smart Software Manager account so that you can apply it to another device.

In evaluation mode, you can also enable evaluation versions of the optional licenses
and perform all operations. In this mode, the licenses aren't registered with Cisco
Smart Software Manager until you register the device.

| **Note** | ---   You can't enable the license in evaluation mode.   --- |
| --- | --- |

##### Before you begin

Before disabling a license, ensure that you are not using it. Rewrite or delete any
policies that require the license.

For units operating in a high availability configuration, you enable or disable
licenses on the active unit only. The change is reflected in the standby unit the
next time you deploy the configuration when the standby unit requests (or frees) the
necessary licenses. When enabling licenses, you must ensure that your Cisco Smart
Software Manager account has sufficient licenses available, or you could have one
unit compliant while the other unit is non-compliant.

To enable or disable optional licenses, follow this procedure:

##### Procedure

---

| **Step 1** | In the Security Devices page, select the FDM-managed device that you want and click Manage Licenses in **Device Actions pane**, The **Manage Licenses** screen appears. |
| --- | --- |
| **Step 2** | Click the slider control for each optional license to enable or disable the license. The status of the license shows OK when enabled.   * **Enabled**: Registers the license with your Cisco Smart Software   Manager account and enable the controlled features. You can now   configure and deploy policies controlled by the license. * **Disabled**: Unregisters the license with your Cisco Smart   Software Manager account and disables the controlled features. You   cannot configure the features in new policies, nor can you deploy   policies that use the feature. |
| **Step 3** | Click **Save** to save the changes. |

---

#### Impact of Expired or Disabled Optional Licenses

If an optional license expires, you can continue using features that require the license. However, the license is marked out
of compliance, and you need to purchase the license and add it to your account to bring the license back into compliance.

If you disable an optional license, the system reacts as follows:

* **Malware license**: The system stops querying the AMP cloud and also stops acknowledging retrospective events sent from the AMP cloud. You cannot
  re-deploy existing access control policies if they include file policies that apply malware inspection. Note that for a very
  brief time after a Malware license is disabled, the system can use existing cached file dispositions. After the time window
  expires, the system assigns a disposition of Unavailable to those files.
* : The system no longer applies intrusion or file-control policies. For Security Intelligence policies, the system no longer
  applies the policy and stops downloading feed updates. You cannot re-deploy existing policies that require the license.
* **URL**: Access control rules with URL category conditions immediately stop filtering URLs, and the system no longer downloads updates
  to URL data. You cannot re-deploy existing access control policies if they include rules with category and reputation-based
  URL conditions.
* : You cannot edit the remote access VPN configuration, but you can remove it. Users can still connect using the RA VPN configuration.
  However, if you change the device registration so that the system is no longer export compliant, the remote access VPN configuration
  stops immediately, and no remote users can connect through the VPN.

### Create and Import an Firewall Device Manager Model

Security Cloud Control provides the ability to export the complete configuration of an FDM-managed device on a Security Cloud Control tenant to a JSON file format. You can then import this file to another tenant as an Firewall device manager model and apply it to a new device on that tenant. The feature is beneficial when you want to use an FDM-managed device's configuration on different tenants that you manage.

| **Note** | ---   If the FDM-managed device contains rulesets, the shared rules associated with the rulesets are modified as local rules when exporting the configuration. Later, when the model is imported to another tenant and applied to an FDM-managed device, you'll see the local rules in the device.   --- |
| --- | --- |

* [Export FDM-Managed Device Configuration](#Export_FTD_Configuration)
* [Import FDM-Managed Device Configuration](#Import_FTD_Configuration)

#### Export FDM-Managed Device Configuration

The export configuration functionality is unavailable if your FDM-managed device has the following configuration:

* High Availability
* Snort 3 enabled

##### Procedure

---

| **Step 1** | In the left pane, click **Security Devices**. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate the device or the **Templates** tab to locate the model device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select an FDM-managed device and in the **Device Actions** on the right pane, click **Export Configuration**. |

---

#### Import FDM-Managed Device Configuration

##### Procedure

---

| **Step 1** | In the **Security Devices** page, click the blue plus () button to import the configuration. |
| --- | --- |
| **Step 2** | Click **Import** to import configuration for offline management. |
| **Step 3** | Select the **Device Type** as **FTD**. |
| **Step 4** | Click **Browse** and select the configuration file (JSON format) to upload. |
| **Step 5** | Once the configuration is verified, you're prompted to label the device or service. See [Labels and Label Groups](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_f15e9db8-94d5-4516-9107-1af22df49154) for more information. |
| **Step 6** | After labeling your model device, you can view it in the **Security Devices** list.   | **Note** | Depending on the size of the configuration and the number of other devices or services, it may take some time for the configuration to be analyzed. | | --- | --- | |

---

## Delete a Device from Security Cloud Control

Use the following procedure to delete a device from Security Cloud Control:

### Procedure

---

| **Step 1** | Log into Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Locate the device you want to delete and check the device in the device row to select it. |
| **Step 4** | In the **Device Actions** panel located to the right, select Remove. |
| **Step 5** | When prompted, select OK to confirm the removal of the selected device. Select Cancel to keep the device onboarded.  Note that both devices in an FDM-managed HA pair must be deleted simultaenously. Click the FDM-managed HA pair name and not the individual peers. |

---

## Import Configuration for Offline Device Management

Importing a device's configuration for offline management allows you to review and optimize a device's configuration without
having to work on a live device in your network. Security Cloud Control also refers to these uploaded configuration files as "models."

You can import the configurations of these devices to Security Cloud Control:

* FDM-Managed Device. See [Create and Import an FDM-Managed Device Model](#Create_and_Import_an_FTD_Model).
* Cisco IOS devices like the Aggregation Services Routers (ASR) and Integrated Services Routers (ISRs).

## Backing Up FDM-Managed Devices

You can use Security Cloud Control to back up an FDM-managed device's system configuration so that you can restore the device to a previous state. Backups include the configuration only,
and not the system software. If you need to completely reimage the device, you need to reinstall the software, then you can
upload a backup and recover the configuration. Security Cloud Control saves the last 5 backups made for a device. When a new backup occurs, the oldest backup is deleted in order to store the
newest backup.

| **Note** | ---   The backup does not include the management IP address configuration. Thus, when you recover a backup file, the management address is not replaced from the backup copy. This ensures that any changes you made to the address are preserved, and also makes it possible to restore the configuration on a different device on a different network segment.   --- |
| --- | --- |

The configuration database is locked during backup. You cannot make configuration changes during a backup, although you can
view policies, dashboards, and so forth. During a restore, the system is completely unavailable.

To make backup schedules across your devices consistent, you can configure your own default
backup schedule. When you schedule a backup for a particular device, you can use your
own default settings or change them. You can schedule recurring backups with cadences
from daily to once a month and you can perform an on-demand backup. You can also
download backups and then use the Threat
Defense device manager to restore them.

**Requirements and best practice for backing up and restoring an FDM-managed device using Security Cloud Control**

* Security Cloud Control can backup FDM-managed devices running software version 6.5 and later.
* The FDM-managed device must be onboarded to Security Cloud Control using a registration key.
* You can restore a backup onto a replacement device only if the two devices are the same model and
  are running the same version of the software, including the build number, not
  just the same point release. For example, a backup of an FDM-managed device running software version 6.6.0-90 can only be restored to an FDM-managed device running 6.6.0-90. Do not use the backup and restore process to copy
  configurations between appliances. A backup file contains information that
  uniquely identifies an appliance, so that it cannot be shared in this
  manner.
* For the Secure Firewall Threat
  Defense backup functionality to work in Security Cloud Control, threat defense needs to access one of these Security Cloud Control URLs based on your tenant region.

  + edge.apj.cdo.cisco.com
  + edge.aus.cdo.cisco.com
  + edge.eu.cdo.cisco.com
  + edge.in.cdo.cisco.com
  + edge.us.cdo.cisco.com
* Ensure that port 443 has external and outbound access for the HTTPS protocol. If the port is blocked behind a firewall, the
  backup and restore process may fail.

**Best Practice**

The device you are going to backup should be in the Synced state in Security Cloud Control. Security Cloud Control backs up the configuration of the device *from the device* not from Security Cloud Control. So, if the device is in a Not Synced state, changes on Security Cloud Control will not be backed up. If the device is in a Conflict Detected state, those changes
will be backed up.

* [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
* [Configure a Recurring Backup Schedule for a Single FDM-Managed Device](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
* [Download the Device Backup](#Procedure)
* [Edit a Backup](#Edit_an_FTD_Backup)
* [Delete a Backup](#Delete_an_FTDBackup)
* [Managing Device Backup](#Managing_FTD_Backups)
* [Restore a Backup to an FDM-Managed Device](#Procedure)

**Related Information:**

* [Configure a Default Recurring Backup Schedule for all FDM-Managed Devices](basics-of-cisco-defense-orchestrator.html#Configure_a_Default_Recurring_Backup_Schedule)
* [Configure a Recurring Backup Schedule for a Single FDM-Managed Device](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
* [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
* [Download an FDM-Managed Device Backup](#Procedure)
* [Edit or Delete an FDM-Managed Device Backup](#Edit_an_FTD_Backup)
* [Restore a Backup to an FDM-Managed Device](#Procedure)

### Back up an FDM-Managed Device On-Demand

This procedure describes how to backup an FDM-managed device so that it can be restored if need be.

#### Before you Begin

Review these [requirements and best practices](#Backing_Up_FTDs) before you backup up an FDM-managed device.

* [Procedure](#Procedure)

#### Procedure

##### Procedure

---

| **Step 1** | (Optional) Create a [change request](monitoring-and-reporting.html#About_Change_Request_Management) for the backup. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the **Devices** tab. |
| **Step 4** | Click the **FTD** tab and select the device you want to backup. |
| **Step 5** | In the **Device Actions** pane on the right, click **Manage Backups**. |
| **Step 6** | Click **Backup Now**. The Device enters the Backing Up configuration state.  When the backup is done, the Security Cloud Control displays the device's configuration state it was in before the backup started. You can also open the change log page to look for a recent change log record with the description, "Backup completed successfully."  If you created a change request in step 1, you can also filter by that value to find the change log entry. |
| **Step 7** | If you created a change request in step 1, clear the change request value so you do not inadvertently associated more changes with the change request. |

---

### Configure a Recurring Backup Schedule for a Single FDM-Managed Device

#### Before you Begin

Review these [requirements and best practices](#Backing_Up_FTDs) before you backup up an FDM-managed device.

* [Procedure](#Procedure)

#### Procedure

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to backup. |
| **Step 4** | In the **Device Actions** pane on the right, click **Manage Backups**. |
| **Step 5** | In the **Device Backups** page, click **Set Recurring Backup** or click the schedule in the Recurring Backup field. Security Cloud Control presents the default backup schedule for all FDM-managed devices on your tenant. See [Configure a Default Recurring Backup Schedule for all FDM-Managed Devices](basics-of-cisco-defense-orchestrator.html#Configure_a_Default_Recurring_Backup_Schedule) for more information. |
| **Step 6** | Select the time of day, in 24-hour time, you want the backup to occur. Note that you schedule the time in Coordinated Universal Time (UTC) time. |
| **Step 7** | In the Frequency field, select daily, weekly, or monthly backup.   * Daily backups: Give the scheduled backup a name and a description. * Weekly backups: Check the days of the week on which you want the backup to occur. Give the scheduled backup time a name and   a description. * Monthly backups: Click in the Days of Month field and add whichever days of the month you want to the schedule the backup.   Note: If you enter day 31 but a month doesn't have 31 days in it, the backup will not take place. Give the scheduled backup   time a name and a description. |
| **Step 8** | Click **Save**. Notice that on the Device Backup page, the Recurring Backup field is replaced by the backup schedule you set and reflects your local time. |

---

### Download the Device Backup

This procedure describes how to download a .tar file containing a backup of an FDM-managed device.

#### Procedure

---

| **Step 1** | In the navigation bar, click**Inventory**. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and the device whose backup you want to download. |
| **Step 4** | In the Actions pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to download and, in its row, click the **Generate Download Link** button . The button changes to read, "Download Backup Image." |
| **Step 6** | The button now reads **Download Backup Image**. Do one of these things:   * If you are on a device that can also reach the Firewall device manager of the device you want to restore, click the**Download Backup Image** button and save the downloaded file. Save it with a name that you will remember. * If you are not on a device that can also reach the FDM of the device   you want to restore:    1. Right-click the **Download Backup Image** button and copy      the link address.             | **Important** | The link address expires 15 minutes after you click the Generate Download Link button. |      | --- | --- |   2. Open a browser on a device that will also reach the Firewall device manager of the Secure Firewall Threat      Defense you want to restore the image to.   3. Enter the download link into the browser address bar and      download the backup file to that device. Save it with a name      that you will remember. |

---

### Edit a Backup

This procedure allows you to edit the name or description of a successful FDM-managed device download.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to edit. |
| **Step 4** | In the Actions pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to edit and it's row, click the edit icon . |
| **Step 6** | Change the name or description of the backup. You can see the new information in the Device Backups page. |

---

### Delete a Backup

Security Cloud Control saves the last 5 backups made for a device. When a new backup occurs, the oldest backup is deleted in order to store the
newest backup. Deleting existing backups may help you manage which backups are kept and which are deleted.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to delete. |
| **Step 4** | In the Actions pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to delete and it's row, click the trash icon . |
| **Step 6** | Click **OK** to confirm. |

---

### Managing Device Backup

Backups of FDM-managed devices you produce using Security Cloud Control can be seen in the Device Backups page:

#### Procedure

---

| **Step 1** | In the left pane, click **Security Devices**. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Click the filter icon and check FDM under Devices/Services to see only FDM-managed devices in the device table. |
| **Step 5** | Select the device you want. |
| **Step 6** | In the **Device Actions** pane, click **Manage Backups**. You will see up to 5 of the latest backups made of that device. |

---

#### What to do next

See [Restore a Backup to an FDM-Managed Device](#Procedure) if you want to restore a backup.

### Restore a Backup to an FDM-Managed Device

Review this information before you restore a backup of an FDM-managed managed threat defense device.

* Review these [requirements and best practices](#Backing_Up_FTDs) before you restore
  a backup to an FDM-managed
  threat defense device.
* If the backup copy you want to restore is not already on the device, you must
  **upload** the backup first before restoring it.
* During a restore, the system is completely unavailable. After the backup is
  restored, the device reboots.
* This procedure assumes that you have an existing backup of the device ready
  to be restored to the device.
* You cannot restore a backup if the device is part of a high availability
  pair. You must first break HA from the Device > High Availability page,
  then you can restore the backup. If the backup includes the HA
  configuration, the device will rejoin the HA group. Do not restore the same
  backup on both units, because they would then both go active. Instead,
  restore the backup on the unit you want to go active first, then restore the
  equivalent backup on the other unit.

| **Note** | ---   The backup does not include the management IP address configuration. Thus, when you recover a backup file, the management address is not replaced from the backup copy. This ensures that any changes you made to the address are preserved, and also makes it possible to restore the configuration on a different device on a different network segment.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to restore. |
| **Step 4** | In the **Device Actions** pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to restore. In its row, click the **Generate Download Link** button .   | **Note** | The link address expires 15 minutes after you click the Generate Download Link button. | | --- | --- | |
| **Step 6** | The button now reads **Download Backup Image**. Do one of these things:   * If you are on a device that can also reach the Firewall device manager of the device you want to restore, click the **Download Backup Image**button and save the downloaded file. *Save it with a name that you will remember*. * If you are not on a device that can also reach the firewall device manager of the device you want to restore:    1. Right-click the **Download Backup Image** button and copy      the link address.   2. Open a browser on a device that will also reach the firewall device manager you want to restore the image to.   3. Enter the download link into the browser address bar and      download the backup file to that device. *Save it with a      name that you will remember*. |
| **Step 7** | Log on to Firewall device manager for the device you want to restore. |
| **Step 8** | Open version 6.5 or higher of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor932). Navigate to the System Management chapter, and search for **Restoring a Backup**. Follow those instructions to restore the image you just downloaded to your FDM-managed device.   | **Tip** | You will need to upload your image to firewall device manager in order to restore it. | | --- | --- | |
| **Step 9** | Follow the prompts in firewall device manager. When the restore starts, your browser is disconnected from firewall device manager. After the restore has finished, the device reboots. |

---

**Related Information:**

* [Backing Up FDM-Managed Devices](#Backing_Up_FTDs)
* [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
* [Create a Backup Schedule for an FTD](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
* [Download an FTD Backup](#Procedure)
* [Edit or Delete an FTD Backup](#Edit_an_FTD_Backup)

## FDM Software Upgrade Paths

### Upgrading FDM Versions

If you use Security Cloud Control to upgrade your FDM-managed firewalls, Security Cloud Control determines which version you can upgrade to and you will not need this topic. If you maintain your own repository of FDM
images and upgrade your FDM-managed devices using your own images, this topic explains what upgrade paths are available to
you.

You can upgrade an FDM-managed device directly from one major or maintenance version
to another; for example, Version 6.4.0 > 6.5.0, or Version 6.4.0 > 7.0.1. You do not
need to be running any specific patch level.

If direct upgrade is not possible, your upgrade path must include intermediate
versions, such as Version 6.4.0 > 7.0.0 > 7.1.0.

Table 3. Upgrade Paths for Major Releases

| Target Version | Oldest Release you can Upgrade to the Target Version |
| --- | --- |
| 7.3.x | 7.0.0 |
| 7.2.x | 6.6.0 |
| 7.1.x | 6.5.0 |
| 7.0.x | 6.4.0 |
| 6.7.x | 6.4.0 |
| 6.6.x | 6.4.0 |
| 6.5.0 | 6.4.0 |

### Patching FDM-Managed Devices

You cannot upgrade directly from a patch of one version to a patch of another
version, such as from Version 6.4.0.1 > 6.5.0.1. You must upgrade to the major
release first, and then patch that release. For example you must upgrade from
Version 6.4.0.1 > 6.5.0 > 6.5.0.1.

### Firepower Hotfixes

Security Cloud Control does not support hotfix updates or installations. If there is a hotfix available for your device model or software version,
we strongly recommend using the configured manager's dashboard or UI. After a hotfix is installed on the device, Security Cloud Control detects out of band configuration changes.

### Removing FDM Upgrades

You cannot use Security Cloud Control to remove or downgrade any release type, whether major, maintenance, or patch.

Starting with Secure Firewall Threat
Defense defense Version 6.7.0, you can use Firepower Device Manager or the FTD CLI to
revert a successfully upgraded device to its state just before the last major or
maintenance upgrade (also called a snapshot). Reverting after patching necessarily
removes patches as well. After reverting, you must reapply any configuration changes
you made between **upgrading** and reverting. **Note that to revert a major or
maintenance upgrade to FDM Version 6.5.0 through 6.6.x, you must reimage.**
See the "System Management" section of a *[Cisco Firepower Threat Defense Configuration
Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor219)* for more information.

### Removing FDM Patches

You cannot remove an FDM patch with either Security Cloud Control or FDM. To remove a patch, you must reimage to a major or maintenance release.

### Snort Upgrade

Snort is the main inspection engine for the product and is packaged into the Secure Firewall Threat
Defense software for your convenience. Version 6.7 introduces an update to the package
that you can upgrade to, or revert from, at any time. Although you can switch Snort
versions freely, some intrusion rules in Snort 2.0 might not exist in Snort 3.0, and
vice versa. We strongly recommend reading about the differences in the Firepower
Device Manager Configuration Guide for Version 6.7.0 for more information.

To proceed with upgrading your FDM-managed device to use Snort 3 or to revert from Snort 3 back to Snort 2 from the Security Cloud Control UI, see [Upgrade to Snort 3.0](#Upgrade_to_Snort_3) and [Revert From Snort 3.0 for FTD](#Revert_From_Snort_3_for_FTD) respectively.

* [Other Upgrade Limitations](#Cisco_Task.dita_c9a8eb49-bab9-4b30-a756-0b39c58e83f1)
* [4100 and 9300 Series Devices](#Cisco_Concept.dita_d0145adc-cabf-45b1-9197-8e3f1f0b1cb3)

### Other Upgrade Limitations

**2100 Series Devices**

Security Cloud Control can upgrade Firepower 2100 series devices only if they are running appliance mode.

* Firepower Threat Defense devices are always in appliance mode.

#### What to do next

See the "[Cisco Firepower 2100 Getting Started Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/quick_start/fp2100/firepower-2100-gsg/asa-platform.html)" for a more detailed discussion of these commands.

### 4100 and 9300 Series Devices

Security Cloud Control does not support the upgrade for the 4100 or 9300 series devices. You must upgrade these devices outside of Security Cloud Control.

**Related Information:**

* [FTD Upgrade Prerequisites](#FTD_Upgrade_Prerequisites)
* [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
* [Bulk FTD Upgrade](#Bulk_FTD_Upgrade)
* [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)

## FDM-Managed Device Upgrade Prerequisites

Security Cloud Control provides a wizard that helps you upgrade the Firewall device manager (FDM) images installed on an individual device or an HA pair.

The wizard guides you through the process of choosing compatible images, installs them, and reboots the device to complete
the upgrade. We secure the upgrade process by validating that the images you chose on Security Cloud Control are the ones copied to, and installed on, your FDM-managed device. We strongly recommend the FDM-managed devices you are upgrading have outbound access to the internet.

If your FDM-managed device does not have outbound access to the internet, you can download the image you want from Cisco.com, store them in your
own repository, provide the upgrade wizard with a custom URL to those images, and Security Cloud Control performs upgrades using those images. In this case, however, you determine what images you want to upgrade to. Security Cloud Control does not perform the image integrity check or disk-space check.

### Configuration Prerequisites

* DNS needs to be enabled on the FDM-managed device. See the "Configuring DNS" section
  of the **System Administration** chapter of the [Cisco Firepower Threat Defense Configuration Guide for
  Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running
  for more information.
* The FDM-managed device should be able to reach the internet if you use upgrade images from Security Cloud Control's image repository.
* The FDM-managed device has been successfully onboarded to Security Cloud Control.
* The FDM-managed device is reachable.
* The FDM-managed device is synced.

  + If you update a device that has pending changes in Security Cloud Control and you do not accept changes, pending changes are lost after the upgrade completes. Best practice is to deploy any pending
    changes before you upgrade..
  + If you have staged changes in firewall device manager and the device is not synced, the upgrade in Security Cloud Control will fail at an eligibility check.

### 4100 and 9300 Series Running FTD

Security Cloud Control does not support the upgrade for the 4100 or 9300 series devices. You must upgrade these devices outside of Security Cloud Control.

### Software and Hardware Requirements

Security Cloud Control is a cloud management platform. Software updates are released over time and are generally not dependent on hardware. See
[Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) for information about supported hardware types.

Devices running firewall device manager software have a recommended upgrade path for optimal performance. See  [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path) for more information.

### Upgrade Notes

You cannot deploy changes to a device while it is upgrading.

**Related Information:**

* [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path)
* [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
* [Bulk FDM-Managed Devices Upgrade](#Bulk_FTD_Upgrade)
* [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)

## Upgrade a Single FDM-Managed Device

### Before You Begin

Be sure to read through the [FTD Upgrade Prerequisites](#FTD_Upgrade_Prerequisites),  [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path), and the [Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) before you upgrade. This document covers any requirements and warnings you should know prior to upgrading to your desired
version of Firepower software.

* [Upgrade A Single FDM-Managed Device with Images from Security Cloud Control's Repository](#Upgrade_A_Single_FTD_with_Images_from_CDOsRepository)
* [Upgrade a Single FDM-Managed Device with Images from your own Repository](#Upgrade_a_Single_FTD_with_Images_from_your_ownRepository)
* [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)

### Upgrade A Single FDM-Managed Device with Images from Security Cloud Control's Repository

Use the following procedure to upgrade a standalone FDM-managed device using a software image that is stored in Security Cloud Control's repository:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device.. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the device you want to upgrade. |
| **Step 5** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 6** | In step 1, click **Use Security Cloud Control Image Repository** to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://cloudsso.cisco.com/as/authorization.oauth2?response_type=code&client_id=wam_prod_ac&redirect_uri=https%3A%2F%2Fwww.cisco.com%2Fpa%2Foidc%2Fcb&state=eyJ6aXAiOiJERUYiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2Iiwia2lkIjoiYzQiLCJzdWZmaXgiOiJMUERhdDEuMTYxNjE2NzQxNCJ9..l02iaNyeE0vXUpbt9qksTQ.ii9UNzSAFqwQ5YtIBmJ55ZgSlzkSZDhWuTAjDtoY_MSrKaiWPDAf8OBZW1u7xufP64YGohK6fi_d6dEGnrf70t3rBUXm3wP3X11LRYVGpDaxkhcwFtX9AfBmEMqHwjdsugHW54X7DpNP-vZy_oM8rz0VF8rssu8FQtNJW0_IS55aMDG0ZlPbrcZTIwfXrVGIepM4I0RZ9kwr0F1qLy3q9w.UW9FT-3LBSTXQXM8uRgP4g&nonce=7vzbmdhY0id5wGxxH_pP9kaHpr4lJNSv_6b93hH_pz0&acr_values=stdnomfa&scope=openid%20profile%20address%20email%20phone&vnd_pi_requested_resource=https%3A%2F%2Fwww.cisco.com%2Fc%2Flogin%2Findex.html%3Freferer%3D%2Fc%2Fen%2Fus%2Fsupport%2Fsecurity%2Ffirepower-ngfw%2Fproducts-installation-and-configuration-guides-list.html&vnd_pi_application_name=CDCprod-www), Version 6.4in for more information. |

---

### Upgrade a Single FDM-Managed Device with Images from your own Repository

Use the following procedure to upgrade a standalone FDM-managed device using a URL protocol to locate a software image:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device.. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the device you want to upgrade. |
| **Step 5** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 6** | In step 1, click **Specify Image URL** to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click Perform Upgrade when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://cloudsso.cisco.com/as/authorization.oauth2?response_type=code&client_id=wam_prod_ac&redirect_uri=https%3A%2F%2Fwww.cisco.com%2Fpa%2Foidc%2Fcb&state=eyJ6aXAiOiJERUYiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2Iiwia2lkIjoiYzQiLCJzdWZmaXgiOiJMUERhdDEuMTYxNjE2NzQxNCJ9..l02iaNyeE0vXUpbt9qksTQ.ii9UNzSAFqwQ5YtIBmJ55ZgSlzkSZDhWuTAjDtoY_MSrKaiWPDAf8OBZW1u7xufP64YGohK6fi_d6dEGnrf70t3rBUXm3wP3X11LRYVGpDaxkhcwFtX9AfBmEMqHwjdsugHW54X7DpNP-vZy_oM8rz0VF8rssu8FQtNJW0_IS55aMDG0ZlPbrcZTIwfXrVGIepM4I0RZ9kwr0F1qLy3q9w.UW9FT-3LBSTXQXM8uRgP4g&nonce=7vzbmdhY0id5wGxxH_pP9kaHpr4lJNSv_6b93hH_pz0&acr_values=stdnomfa&scope=openid%20profile%20address%20email%20phone&vnd_pi_requested_resource=https%3A%2F%2Fwww.cisco.com%2Fc%2Flogin%2Findex.html%3Freferer%3D%2Fc%2Fen%2Fus%2Fsupport%2Fsecurity%2Ffirepower-ngfw%2Fproducts-installation-and-configuration-guides-list.html&vnd_pi_application_name=CDCprod-www), Version 6.4in for more information. |

---

### Monitor the Upgrade Process

You can view the progress of your single device by selecting that device on the **Security Devices** page and clicking the upgrade button. Security Cloud Control takes you to the Device Upgrade page for that device.

If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information   --- |
| --- | --- |

## Bulk FDM-Managed Devices Upgrade

### Before You Begin

Be sure to read through the [FDM-Managed Device Upgrade Prerequisites](#FTD_Upgrade_Prerequisites), [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path),and the [Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) before you upgrade. This document covers any requirements and warnings you should know prior to upgrading to your desired
version of Firepower software.

| **Note** | ---   You can only bulk upgrade FDM-managed devices if they are all upgrading to the same software version.   --- |
| --- | --- |

* [Upgrade Bulk FDM-Managed Devices with Images from Security Cloud Control's Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_CDOsRepository)
* [Upgrade Bulk FDM-Managed Devices with Images from your own Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_your_ownRepository)
* [Monitor the Bulk Upgrade Process](#Monitor_the_Bulk_Upgrade_Process)

### Upgrade Bulk FDM-Managed Devices with Images from Security Cloud Control's Repository

Use the following procedure to upgrade multiple FDM-managed devices using a software image that is stored in Security Cloud Control's repository:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your devices. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Use the [filter](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) to narrow down the list of devices you may want to include in your bulk upgrade. |
| **Step 5** | From the filtered list of devices, select the devices you want to upgrade. |
| **Step 6** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 7** | On the Bulk Device Upgrade page, the devices that can be upgraded are presented to you. If any of the devices you chose are not upgradable, Security Cloud Control gives you a link to view the not upgradable devices. |
| **Step 8** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 9** | In step 1, click **Use Security Cloud Control Image Repository** to select the software image you want to upgrade to. You are only presented with choices that are compatible with the devices you can upgrade. Click **Continue**. |
| **Step 10** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 11** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrades while in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrades after it has started, Security Cloud Control does not deploy or poll for changes from the devices. Devices do not roll back to the previous configuration after a canceled upgrade, either. This may cause the devices to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 12** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 13** | Upgrade the system databases. You must do this step in Firewall device manager. See **Updating System Databases** in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), for the version your device is running. |

---

### Upgrade Bulk FDM-Managed Devices with Images from your own Repository

Use the following procedure to upgrade multiple FDM-managed devices using a URL protocol to locate a software image:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your devices. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Use the [filter](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) to narrow down the list of devices you may want to include in your bulk upgrade. |
| **Step 5** | From the filtered list of devices, select the devices you want to upgrade. |
| **Step 6** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 7** | On the Bulk Device Upgrade page, the devices that can be upgraded are presented to you. If any of the devices you chose are not upgradable, Security Cloud Control gives you a link to view the not upgradable devices. |
| **Step 8** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 9** | In step 1, click **Specify Image URL** to select the software image you want to upgrade to, and click **Continue**. |
| **Step 10** | In step 2, confirm your choices and decide whether you only want to download the images to your devices or copy the images, install them, and reboot the device. |
| **Step 11** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrades while in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrades after it has started, Security Cloud Control does not deploy or poll for changes from the devices and the devices do not roll back to the previous configuration. This may cause the devices to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 12** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the  [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 13** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), Version 6.4in for more information. |

---

### Monitor the Bulk Upgrade Process

You can view the progress of a single device that was included in the bulk upgrade by selecting that device on the **Security Devices** page and clicking the upgrade button. You can also view the progress details by clicking **Jobs** in the left pane and expanding the bulk operation.

If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.

## Upgrade an FDM-Managed High Availability Pair

Upgrade your HA pair without disrupting traffic; the standby device continues to handle traffic detection while the secondary
device is upgraded.

When you upgrade an HA pair, Security Cloud Control executes an eligibility check and copies or identifies the image location before starting the upgrade. The secondary device
in a high availability pair upgrades first, even if it is currently the active device; if the secondary device is the Security Cloud Control active device, the paired devices automatically switch roles for the upgrade process. Once the secondary devices successfully
upgrade, the devices switch roles, then the new standby device upgrades. When the upgrade completes, the devices are automatically
configured so the primary device is active and the secondary device is standby.

We do not recommend deploying to the HA pair during the upgrade process.

### Before You Begin

* Deploy all pending changes to the active device before upgrading.
* Ensure there are no tasks running during the upgrade.
* Both devices in the HA pair are healthy.
* Confirm you are ready to upgrade; you cannot rollback to a previous version in Security Cloud Control.
* Read through the [FTD Upgrade Prerequisites](#FTD_Upgrade_Prerequisites),  [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path), and the [Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) to review any requirements and warnings that may incur during the ugprade process.

* [Upgrade an FDM-Managed HA Pair with Images from Security Cloud Control's Repository](#Upgrade_an_FTD_HAPair_with_Images_from_CDOsRepository)
* [Upgrade an FDM-Managed HA Pair with Images from your own Repository](#Upgrade_an_FTD_HAPair_with_Images_from_your_ownRepository)
* [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)

### Upgrade an FDM-Managed HA Pair with Images from Security Cloud Control's Repository

Use the following procedure to upgrade an FDM-managed HA pair using a software image that is stored in Security Cloud Control's repository:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select the HA pair you want to upgrade. |
| **Step 5** | In the Device Actions pane, click Upgrade. |
| **Step 6** | In step 1, click Use **Security Cloud Control** Image Repository to select the software image you want to upgrade to, and click Continue. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click Perform Upgrade when you are ready. From the Security Devices page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click Abort Upgrade from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or poll changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in FDM. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), Version 6.4 in for more information. |

---

### Upgrade an FDM-Managed HA Pair with Images from your own Repository

Use the following procedure to upgrade an FDM-managed HA pair using a URL protocol to locate a software image:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the HA pair you want to upgrade. |
| **Step 5** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 6** | In step 1, click **Specify Image URL** to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or poll changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), Version 6.4 for more information. |

---

### Monitor the Upgrade Process

You can view the progress of your single device by selecting that device on the **Security Devices** page and clicking the upgrade button. Security Cloud Control takes you to the **Device Upgrade** page for that device.

During the upgrade, the system suspends HA while updating system libraries, which includes an automatic deployment, and may
not be in a healthy state for the entirety of the upgrade process. This is expected. The device is available for SSH connections
during the last part of this process, so if you log in shortly after applying an upgrade, you might see HA in suspended status.
If the system experiences issues during the upgrade process and the HA pair appears to be suspended, manually resume HA from
the Firewall device manager console of the active device.

| **Note** | ---   If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.   --- |
| --- | --- |

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information.   --- |
| --- | --- |

## Upgrade to Snort 3.0

Snort 3 is the latest snort engine, or a powerful preprocessor that uses Open Source
Intrusion Prevention System (IPS), available for Firepower Version 6.7 and later. The
snort engine uses a series of rules that help define malicious network activity and uses
those rules to find packets that match against them and generates alerts for users and
is ideally used as a packet sniffer, a packet logger, or, more traditionally, as a a
standalone network IPS.

With Snort 3, you can now create custom intrusion policies; every FDM-managed device running Snort 3 has a set of intrusion policies that are pre-defined from Cisco's Talos Intelligence Group (Talos).
Snort 3 makes it possible to change these default policies, although we strongly recommend building on top of the base for
a more robust policy.

You cannot create custom policies with Snort 2.

### Switching from Snort 2 to Snort 3

You can switch Snort versions freely, though some intrusion rules in Snort 2.0 might
not exist in Snort 3.0, and vice versa. If you changed the rule action for an
existing rule, that change is not preserved if you switch to Snort 3 and then back
to Snort 2, or back again to Snort 3. Your changes to rule actions for rules that
exist in both versions are preserved. Note that the mapping between rules in Snort 3
and Snort 2 can be one-to-one or one-to-many, so preservation of changes is done on
a best-effort basis.

If you choose to upgrade from Snort 2 to Snort 3, please note that upgrading the
snort engines is comparable to a system upgrade. We strongly recommend upgrading
during a maintenance window to minimize the interruption in traffic monitoring for
your network. See [Managing Intrusion Policies
(Snort3)](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/fdm/fptd-fdm-config-guide-670/fptd-fdm-intrusion.html#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055)in the *Firepower Device Manager Configuration
Guide* as to how switching snort versions will affect how rules process
traffic.

| **Tip** | ---   You can filter by Snort version on the **Security Devices** page, and the Details window of a selected device displays the current version running on the device.   --- |
| --- | --- |

### Snort 3 Limitations

**License Requirements**

To allow the snort engine to process traffic for intrusion and malware analysis, you must have the  **license** enabled for the FDM-managed device. To enable this license through Firewall device manager, log into the Firewall device manager UI and navigate to Device  > View Configuration >  Enable/Disable and enable the license.

**Hardware Support**

The following devices support Snort 3:

* FTD 1000 series
* FTD 2100 series
* FTD 4100 series
* FTD virutal with AWS
* FTD virtual with Azure
* ASA 5500-X Series with FTD

**Software Support**

Devices **must** be running at least Firewall device manager Version 6.7. Security Cloud Control supports Snort 3 functionality for devices running Version 6.7 and later.

For FTD 1000 and 2000 series, see [FXOS bundled support](https://www.cisco.com/c/en/us/td/docs/security/firepower/compatibility/firepower-compatibility.html#id_67425) for more information
on FXOS patch support.

**Configuration Limitations**

Security Cloud Control does not support upgrading to Snort 3 if your device has the following configurations:

* Device is not running at least Version 6.7.
* If a device has pending changes. Deploy any changes prior to upgrading.
* If a device is currently upgrading. Do not attempt to upgrade or deploy to
  the device until the device is synced.
* If a device is configured with a virtual router.

| **Note** | ---   If you upgrade or revert the Snort version, the system automatically deploys to implement the changes between Snort 2 intrusion policies and Snort 3 intrusion policies.   --- |
| --- | --- |

**Rulesets and Snort 3**

Note that Snort 3 does not have full feature support at this time. Security Cloud Control rulesets are not supported on Snort 3 devices. If you simultaneously upgrade a device to Firewall device manager 6.7 or higher, and from Snort 2 to Snort 3, any rulesets configured prior to the upgrade are broken up and the rules in them
are saved as individual rules.

For a full list of ruleset support in regards to devices configured for Snort 3, see
[Rulesets](configuring-ftd-devices.html#FTD_Rulesets).

* [Upgrade the Device and the Intrusion Prevention Engine Simultaneously](#Upgrade_the_Device_and_the_Intrusion_Prevention_EngineSimultaneously)
* [Upgrade the Intrusion Prevention Engine](#Upgrade_the_Intrusion_Prevention_Engine)
* [Monitor the Upgrade Process](#Cisco_Concept.dita_734b576c-42ad-4612-ae33-5fbefcdbc912)

### Upgrade the Device and the Intrusion Prevention Engine Simultaneously

Security Cloud Control allows you to upgrade the device to Version 6.7 and the Snort 3. Use the following procedure to upgrade the FDM-managed device:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device or devices you want to upgrade. |
| **Step 4** | In the **Devices Actions** pane located to the right, click **Upgrade**. |
| **Step 5** | Set the upgrade toggle to **FTD System Upgrade**. |
| **Step 6** | (Optional) If you want Security Cloud Control to perform the upgrade later, check the **Schedule Upgrade** check box. Click in the field to select a date and time in the future. |
| **Step 7** | In step 1, select your upgrade method. Either use the Security Cloud Control Image Repository and an image from your own repository:   * **Use Security Cloud Control Image Repository** - Click this option to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. * **Specify Image URL** - Click this option to select the software image that is currently stored in your own repository, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 8** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 9** | Check **Upgrade to Snort 3 Engine**. |
| **Step 10** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |

---

### Upgrade the Intrusion Prevention Engine

For devices that are already running Version 6.7 with Snort 2, use the following procedure to update just the Snort engine
to version 3:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device or devices you want to upgrade. |
| **Step 4** | In the **Device Actions** pane located to the right, click **Upgrade**. |
| **Step 5** | Set the upgrade toggle to **Intrusion Prevention Engine**. |
| **Step 6** | Click **Upgrade to Snort Engine 3.0**. |
| **Step 7** | From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status. |

---

### Monitor the Upgrade Process

| **Warning** | ---   If you decide to cancel the upgrade while it is in progress, click Abort Upgrade from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC.   --- |
| --- | --- |

You can view the progress of your single device by selecting that device on the **Security Devices** page and clicking the upgrade button. Security Cloud Control takes you to the **Device Upgrade**  page for that device.

If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information   --- |
| --- | --- |

## Revert From Snort 3.0 for FDM-Managed Device

Some intrusion rules in Snort 2.0 might not exist in Snort 3.0. If you
downgrade to 2.0, any custom intrusion policies that you created are converted to the
base policy used in the custom policy. As far as possible, rule action overrides are
retained. If more than one custom policy uses the same base policy, the overrides of the
custom policy that is used in the most access control policies are retained, and the
overrides for the other custom policies are lost. Access control rules that used
these"duplicate"policies will now use the base policy created from your most-used custom
policy. All custom policies are deleted.

Before you opt to revert from Snort 3.0, read [Managing Intrusion Policies (Snort2)](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/fdm/fptd-fdm-config-guide-670/fptd-fdm-intrusion.html#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055) of the *Firepower Device Manager Configuration Guide* and find out how switching snort engine versions will affect your current rules and policies.

| **Note** | ---   Reverting to version 2 does not uninstall the Firepower software version.   --- |
| --- | --- |

* [Revert From Snort 3.0](#Revert_From_Snort_3)

### Revert From Snort 3.0

If you change the Snort version,the system will perform an automatic deployment to implement the change. Note that you can
only revert individual devices from Snort 3.0 to version 2.

Use the following procedure to revert the intrusion prevention engine:

#### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and and click the device you want to revert. |
| **Step 4** | In the **Device Actions** pane located to the right, click **Upgrade**. |
| **Step 5** | Set the upgrade toggle to **Intrusion Prevention Engine**. |
| **Step 6** | In Step 1, confirm you want to revert from Snort version 3, and click **Revert to Snort Engine 2**. |
| **Step 7** | From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status. |

---

## Schedule a Security Database Update

Use the following procedure to create a scheduled task to check and update the security databases for an FDM-managed device:

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the desired FDM-managed device. |
| **Step 4** | In the Actions pane, locate the **Security Database Updates** section and click the add + button.   | **Note** | If there is an existing scheduled task for the selected device, click the edit icon to create a new task. Creating a new task will overwrite the existing one. | | --- | --- | |
| **Step 5** | Configure the scheduled task with the following:   * **Frequency** - Choose for the update to occur daily, weekly, or   monthly. * **Time** - Choose the time of day. Note that the time displayed is   UTC. * **Select Days** - Choose which day(s) of the week you want the   update to occur. |
| **Step 6** | Click **Save**. |
| **Step 7** | The device's Configuration Status will change to "Updating Databases". |

---

* [Edit a Scheduled Security Database Update](#Edit_a_Scheduled_Security_Database_Update)

### Edit a Scheduled Security Database Update

Use the following procedure to edit an existing scheduled task to check and update the security databases for an FDM-managed device

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the desired FDM-managed device. |
| **Step 4** | In the Actions pane, locate the **Database Updates** section and click the edit icon. |
| **Step 5** | Edit the scheduled task with the following:   * **Frequency** - Choose for the update to occur daily, weekly, or   monthly. * **Time** - Choose the time of day. Note that the time displayed is   UTC. * **Select Days** - Choose which day(s) of the week you want the   update to occur. |
| **Step 6** | Click **Save**. |
| **Step 7** | The device's Configuration Status will change to "Updating Databases". |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_d0e67799_20250115_123400.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Configuration Guides](/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting
  Started](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-get-started.html)
* [Best Practices: Use Cases for Threat Defense](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-use-cases.html)
* [Licensing the
  System](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-license.html)
* System Monitoring
  + [Monitoring the
    Device](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-monitor.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-isa3000-alarms.html)
* Reusable Objects
  + [Objects](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-objects.html)
  + [Certificates](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-certificates.html)
  + [Identity Sources](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity-sources.html)
* The Basics
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-logical-devices.html)
  + [High Availability
    (Failover)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ha.html)
  + [Interfaces](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-interfaces.html)
* Routing
  + [Routing Basics and Static Routes](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-routing.html)
  + [Virtual Routers](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-virtual-routers.html)
  + [Route Maps and Other Objects for Route Tuning](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-route-maps.html)
  + [Open Shortest Path First (OSPF)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ospf.html)
  + [Enhanced Interior Gateway Routing Protocol (EIGRP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-eigrp.html)
  + [Border Gateway Protocol (BGP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-bgp.html)
* Security
  Policies
  + [SSL
    Decryption](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html)
  + [Identity
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity.html)
  + [Security
    Intelligence](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-sec-intel.html)
  + [Access
    Control](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-access.html)
  + [Intrusion
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html)
  + [Network Address
    Translation (NAT)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-nat.html)
* Virtual Private
  Networks (VPN)
  + [Site-to-Site
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-s2svpn.html)
  + [Remote Access
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ravpn.html)
* System
  Administration
  + [System
    Settings](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-system.html)
  + [System
    Management](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-mgmt.html)
* [Advanced
  Configuration](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-advanced.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3 Chapter Title SSL Decryption

* [PDF - Complete Book
  (18.14 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.pdf)
  [PDF - This Chapter (1.18 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (10.41 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (22.06 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 14, 2023

## Chapter: SSL Decryption

Chapter Contents

* [SSL Decryption](#topic_3E05DF8127124281AC1A8208FB4F0B2B)
* [About SSL Decryption](#concept_DF8743D3434644A49DB0D03D5865C955)
  + [Why Implement SSL Decryption?](#concept_9CE598D91E0E42A9A3BCA014053674A1)
  + [Actions You Can Apply to Encrypted Traffic](#concept_9C25DB275844450FAA2EA4E2D2DB93B5)
    - [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9)
    - [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061)
    - [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D)
    - [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057)
  + [Automatically Generated SSL Decryption Rules](#concept_97F27D8C3C88481F874E9C315B544185)
  + [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810)
* [License Requirements for SSL Decryption](#concept_CA331CC5D4C740F3BEB5C2765CE42074)
* [Guidelines for SSL Decryption](#concept_991745F245914B538F404B8AEA5EBFAF)
* [How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E)
* [Configuring SSL Decryption Policies](#task_A46EB67387764C209439122818AB7B43)
  + [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825)
  + [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316)
  + [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB)
    - [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B)
    - [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37)
    - [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC)
    - [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0)
    - [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD)
  + [Configure SSL Decryption Settings](#Cisco_Concept.dita_a8dbcdf0-6eb0-4ae3-bb1f-c833c58cb010)
    - [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)
    - [Configure Advanced and Undecryptable Traffic Settings](#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06)
  + [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378)
* [Example: Blocking Older SSL/TLS Versions from the Network](#id_106121)
* [Monitoring and Troubleshooting SSL Decryption](#concept_AA3515B3412145898E69AA30306BE0BC)
  + [Monitoring SSL Decryption](#concept_F6B5C308790C43ABA150C8E3F937A71C)
  + [Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)](#concept_9CE017AD0A384BB581E3EFB7CBC76573)

Close

# SSL Decryption

Some protocols, such as HTTPS, use
Secure Sockets Layer (SSL) or its follow-on version, Transport Layer Security
(TLS), to encrypt traffic for secure transmissions. Because the system cannot
inspect encrypted connections, you must decrypt them if you want to apply
access rules that consider higher-layer traffic characteristics to make access
decisions.

* [About SSL Decryption](#concept_DF8743D3434644A49DB0D03D5865C955)
* [License Requirements for SSL Decryption](#concept_CA331CC5D4C740F3BEB5C2765CE42074)
* [Guidelines for SSL Decryption](#concept_991745F245914B538F404B8AEA5EBFAF)
* [How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E)
* [Configuring SSL Decryption Policies](#task_A46EB67387764C209439122818AB7B43)
* [Example: Blocking Older SSL/TLS Versions from the Network](#id_106121)
* [Monitoring and Troubleshooting SSL Decryption](#concept_AA3515B3412145898E69AA30306BE0BC)

## About SSL Decryption

Normally, connections go through the access control policy to determine
if they are allowed or blocked. However, if you enable the SSL decryption
policy, encrypted connections are first sent through the SSL decryption policy
to determine if they should be decrypted or blocked. Any unblocked connections,
whether or not decrypted, then go through the access control policy for a final
allow/block decision.

| **Note** | ---   You must enable the SSL decryption policy in order to implement active authentication rules in the identity policy. If you enable SSL decryption to enable identity policies, but do not otherwise want to implement SSL decryption, select Do Not Decrypt for the default action and do not create additional SSL decryption rules. The identity policy automatically generates whatever rules it needs.   --- |
| --- | --- |

The following topics explain encrypted traffic flow management and
decryption in more detail.

* [Why Implement SSL Decryption?](#concept_9CE598D91E0E42A9A3BCA014053674A1)
* [Actions You Can Apply to Encrypted Traffic](#concept_9C25DB275844450FAA2EA4E2D2DB93B5)
* [Automatically Generated SSL Decryption Rules](#concept_97F27D8C3C88481F874E9C315B544185)
* [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810)

### Why Implement SSL Decryption?

Encrypted traffic, such as HTTPS connections, cannot be inspected.

Many connections are legitimately encrypted, such as connections to banks and other financial institutions. Many web sites
use encryption to protect privacy or sensitive data. For example, your connection to the device manager is encrypted.

However, users can also hide undesirable traffic within encrypted
connections.

By implementing SSL decryption, you can decrypt connections, inspect
them to ensure they do not contain threats or other undesirable traffic, and
then re-encrypt them before allowing the connection to proceed. (The decrypted
traffic goes through your access control policy and matches rules based on
inspected characteristics of the decrypted connection, not on the encrypted
characteristics.) This balances your need to apply access control policies with
the user’s need to protect sensitive information.

You can also configure SSL decryption rules to block encrypted traffic
of types you know you do not want on your network.

Keep in mind that decrypting and then re-encrypting traffic adds a
processing load on the device, which will reduce overall system performance.

### Actions You Can Apply to Encrypted Traffic

When configuring SSL decryption rules, you can apply the actions
described in the following topics. These actions are also available for the
default action, which applies to any traffic that does not match an explicit
rule.

| **Note** | ---   Any traffic that passes through the SSL decryption policy must then pass through the access control policy. Except for traffic you drop in the SSL decryption policy, the ultimate allow or drop decision rests with the access control policy.   --- |
| --- | --- |

* [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9)
* [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061)
* [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D)
* [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057)

#### Decrypt Re-Sign

If you elect to
decrypt and re-sign traffic, the system acts as a man-in-the-middle.

For example, the user
types in https://www.cisco.com in a browser. The traffic reaches the
threat
defense device, the device then negotiates with the user using the
CA certificate specified in the rule and builds an SSL tunnel between the user
and the
threat
defense device. At the same time the device connects to
https://www.cisco.com and creates an SSL tunnel between the server and the
threat
defense device.

Thus, the user sees
the CA certificate configured for the SSL decryption rule instead of the
certificate from www.cisco.com. The user must trust the certificate to complete
the connection. The
threat
defense device then performs decryption/re-encryption in both
directions for traffic between the user and destination server.

![Decryption using certificate re-signing.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420365.jpg)

| **Note** | ---   If the client does not trust the CA used to re-sign the server certificate, it warns the user that the certificate should not be trusted. To prevent this, import the CA certificate into the client trusted CA store. Alternatively, if your organization has a private PKI, you can issue an intermediate CA certificate signed by the root CA which is automatically trusted by all clients in the organization, then upload that CA certificate to the device.   --- |
| --- | --- |

If you configure a
rule with the Decrypt Re-Sign action, the rule matches traffic based on the
referenced internal CA certificate’s signature algorithm type, in addition to
any configured rule conditions. Because you can select a single re-sign
certificate for the SSL decryption policy, this can limit traffic matching for
resign rules.

For example, outgoing
traffic encrypted with an elliptic curve (EC) algorithm matches a Decrypt
Re-Sign rule only if the re-sign certificate is an EC-based CA certificate.
Similarly, traffic encrypted with an RSA algorithm matches Decrypt Re-Sign
rules only if the global re-sign certificate is RSA; outgoing traffic encrypted
with an EC algorithm does not match the rule, even if all other configured rule
conditions match.

#### Decrypt Known Key

If you own the
destination server, you can implement decryption with a known key. In this
case, when the user opens a connection to https://www.cisco.com, the user sees
the actual certificate for www.cisco.com, even though it is the
threat
defense device that is presenting the certificate.

![Decryption using known keys.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420366.jpg)

Your organization must
be the owner of the domain and certificate. For the example of cisco.com the
only possible way to have the end user see Cisco’s certificate would be if you
actually own the domain cisco.com (i.e. you are Cisco Systems) and have
ownership of the cisco.com certificate signed by a public CA. You can only
decrypt with known keys for sites that your organization owns.

The main purpose of
decrypting with a known key is to decrypt traffic heading to your HTTPS server
to protect your servers from external attacks. For inspecting client side
traffic to external HTTPS sites, you must use decrypt re-sign as you do not own
the servers.

| **Note** | ---   To use known key decryption, you must upload the server’s certificate and key as an internal identity certificate, and then add it to the list of known-key certificates in the SSL decryption policy settings. Then, you can write the rule for known-key decryption with the server’s address as the destination address. For information on adding the certificate to the SSL decryption policy, see [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA).   --- |
| --- | --- |

#### Do Not Decrypt

If you elect to bypass
decryption for certain types of traffic, no processing is done on the traffic.
The encrypted traffic proceeds to the access control policy, where it is
allowed or dropped based on the access control rule it matches.

#### Block

You can simply block
encrypted traffic that matches an SSL decryption rule. Blocking in the SSL
decryption policy prevents the connection from reaching the access control
policy.

When you block an
HTTPS connection, the user does not see the system default block response page.
Instead, the user sees the browser’s default page for a secure connection
failure. The error message does not indicate the site was blocked due to
policy. Instead, errors might indicate that there are no common encryption
algorithms. It will not be obvious from this message that you blocked the
connection on purpose.

### Automatically Generated SSL Decryption Rules

Whether you enable the
SSL decryption policy, the system automatically generates Decrypt Re-sign rules
for each identity policy rule that implements active authentication. This is
required to enable active authentication for HTTPS connections.

When you enable the
SSL decryption policy, you see these rules under the Identity Policy Active
Authentication Rules heading. These rules are grouped at the top of the SSL
decryption policy. The rules are read only. You can change them only by
altering your identity policy.

### Handling Undecryptable Traffic

There are several characteristics that make a connection undecryptable. If a connection has any of the following characteristics,
the default action is applied to the connection regardless of any rule the connection would otherwise match. If you select
Block as your default action (rather than Do Not Decrypt), you might run into issues, including excessive drops of legitimate
traffic. You can alter the default behavior, as explained in [Configure Advanced and Undecryptable Traffic Settings](#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06).

* Compressed
  session—Data compression was applied to the connection.
* SSLv2 session—The
  minimum supported SSL version is SSLv3.
* Unknown cipher
  suite—The system does not recognize the cipher suite for the connection.
* Unsupported cipher
  suite—The system does not support decryption based on the detected cipher
  suite.
* Session not
  cached—The SSL session has session reuse enabled, the client and server
  reestablished the session with the session identifier, and the system did not
  cache that session identifier.
* Handshake
  errors—An error occurred during the SSL handshake negotiation.
* Decryption
  errors—An error occurred during the decryption operation.
* Passive interface traffic—All traffic on passive interfaces (passive security zones) is undecryptable.

## License Requirements for SSL Decryption

You do not need a special license to use the SSL decryption policy.

However, you do need the URL license to create rules that use URL categories and reputations as match criteria. For information on configuring licenses,
see [Enabling or Disabling Optional Licenses](fptd-fdm-license.html#id_12247).

## Guidelines for SSL Decryption

Keep the following in
mind when configuring and monitoring SSL decryption policies:

* The SSL
  Decryption policy is bypassed for any connections that match access control
  rules set to trust or block if those rules:

  + Use security
    zone, network, geolocation, and port only as the traffic matching criteria.
  + Come before
    any other rules that require inspection, such as rules that match connections
    based on application or URL, or allow rules that apply intrusion or file
    inspection.
* When using URL category matching, note that there are cases where
  the login page for a site is in a different category than the site itself. For
  example, Gmail is in the “Web based email” category, whereas the login page is
  in the “Internet Portals” category. To get connections to these sites
  decrypted, you must include both categories in the rule.
* If a Vulnerability Database (VDB) update removes (deprecates) applications, you must make changes to any SSL decryption rules
  or application filters that use the application that was deleted. You cannot deploy changes until you fix these rules. In
  addition, you cannot install system software updates before fixing the issue. On the Application Filters object page, or the
  Application tab of the rule, these applications say “(Deprecated)” after the application name.
* You cannot disable the SSL decryption policy if you have any active authentication rules. To disable the SSL decryption policy,
  you must either disable the identity policy, or delete any identity rules that use active authentication.

## How to Implement and Maintain the SSL Decryption Policy

You can use SSL
decryption policies to turn encrypted traffic into plain text traffic, so that
you can then apply URL filtering, intrusion and malware control, and other
services that require deep packet inspection. If your policies allow the
traffic, the traffic is re-encrypted before it leaves the device.

The SSL decryption
policy applies to encrypted traffic only. No unencrypted connections are
evaluated against SSL decryption rules.

Unlike some other
security policies, you need to monitor and actively maintain the SSL decryption
policy, because certificates can expire or even be changed on destination
servers. Additionally, changes in client software might alter your ability to
decrypt certain connections, because the decrypt re-sign action is
indistinguishable from a man-in-the-middle attack.

The following
procedure explains the end-to-end process of implementing and maintaining the
SSL decryption policy.

### Procedure

---

| **Step 1** | If you will implement Decrypt Re-sign rules, create the required internal CA certificate.  You must use an internal Certificate Authority (CA) certificate. You have the following options. Because users must trust the certificate, either upload a certificate client browsers are already configured to trust, or ensure that the certificate you upload is added to the browser trust stores.   * Create a   self-signed internal CA certificate, which is signed by the device itself. See   [Generating Self-Signed Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_CB73ADE996FC43AF885ED0D4A5F83C97). * Upload an   internal CA certificate and key signed by an external trusted CA or by a CA   inside your organization. See   [Uploading Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_5CD7D9D1E8B3434AA5C550EF5497EF81). |
| --- | --- |
| **Step 2** | If you will implement Decrypt Known Key rules, collect the certificate and key from each of the internal servers.  You can use Decrypt Known Key only with servers that you control, because you must obtain the certificate and key from the server. Upload these certificates and keys as internal certificates (not internal CA certificates). See [Uploading Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_5CD7D9D1E8B3434AA5C550EF5497EF81). |
| **Step 3** | [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825).  When you enable the policy, you also configure some basic settings. |
| **Step 4** | [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316).  If in doubt, select Do Not Decrypt as the default action. Your access control policy can still drop traffic that matches the default SSL decryption rule if appropriate. |
| **Step 5** | [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB).  Identify traffic to decrypt and the type of decryption to apply. |
| **Step 6** | If you configure known key decryption, edit the SSL decryption policy settings to include those certificates. See [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA). |
| **Step 7** | If necessary, download the CA certificate used for Decrypt Re-sign rules and upload it to the browser on client workstations.  For information on downloading the certificate and distributing it to clients, see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 8** | Periodically, update re-sign and known key certificates.   * Re-sign certificate—Update this certificate before it expires. If you generate the certificate through the device   manager, it is valid for 5 years. To check the validity period for a certificate, select Objects > Certificates, find the certificate in the list, and click the information icon (View or info icon button.) for it in the Actions column. The information dialog box shows the validity period and some other characteristics. You can   also upload a replacement certificate from this page. * Known-key   certificate—For any known-key decryption rules, you need to ensure that you   have uploaded the destination server’s current certificate and key. Whenever   the certificate and key changes on supported servers, you must also upload the   new certificate and key (as an internal certificate) and update the SSL   decryption settings to use the new certificate. |
| **Step 9** | Upload missing trusted CA certificates for external servers.  The system includes a wide range of trusted CA root and intermediate certificates issued by third parties. These are needed when negotiating the connection between the threat defense and the destination servers for decrypt re-sign rules.  Upload all certificates within a root CA’s chain of trust to the list of trusted CA certificates, including the root CA certificate and all intermediate CA certificates. Otherwise, it is more difficult to detect trusted certificates issued by intermediate CAs. Upload certificates on the Objects > Certificates page. See [Uploading Trusted CA Certificates](fptd-fdm-certificates.html#task_CCECD443E93B4AE4B34CBA91BDF23013). |

---

## Configuring SSL Decryption Policies

You can use SSL
decryption policies to turn encrypted traffic into plain text traffic, so that
you can then apply URL filtering, intrusion and malware control, and other
services that require deep packet inspection. If your policies allow the
traffic, the traffic is re-encrypted before it leaves the device.

The SSL decryption
policy applies to encrypted traffic only. No unencrypted connections are
evaluated against SSL decryption rules.

| **Note** | ---   VPN tunnels are decrypted before the SSL decryption policy is evaluated, so the policy never applies to the tunnel itself. However, any encrypted connections within the tunnel are subject to evaluation by the SSL decryption policy.   --- |
| --- | --- |

The following
procedure explains how to configure the SSL decryption policy. For an
explanation of the end-to-end process of creating and managing SSL decryption,
see
[How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E).

### Before you begin

The SSL decryption
rules table contains two sections:

* Identity Policy Active
  Authentication Rules—If you enable the identity policy and create
  rules that use active authentication, the system automatically creates the SSL
  decryption rules needed to make those policies work. These rules are always
  evaluated before the SSL decryption rules you create yourself. You can alter
  these rules only indirectly, by making changes to the identity policy.
* SSL Native
  Rules—These are rules that you have configured. You can add rules
  to this section only.

### Procedure

---

| **Step 1** | Select Policies > SSL Decryption.  If you have not yet enabled the policy, click Enable SSL Decryption and configure policy settings, as described in [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825). |
| --- | --- |
| **Step 2** | Configure the default action for the policy.  The safest choice is Do Not Decrypt. For more information, see [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316). |
| **Step 3** | Manage the SSL decryption policy.  After you configure SSL decryption settings, this page lists all rules in order. Rules are matched against traffic from top to bottom with the first match determining the action to apply. You can do the following from this page:   * To disable   the policy, click the   SSL Decryption Policy toggle. You can re-enable it   by clicking   Enable SSL Decryption. * To edit policy settings, including the list of certificates used in the policy, click the SSL Decryption Settings button (Gear/Settings button.); see [Configure SSL Decryption Settings](#Cisco_Concept.dita_a8dbcdf0-6eb0-4ae3-bb1f-c833c58cb010). You can also download the certificate used with decrypt re-sign rules so that you can distribute it to clients. See the   following topics:    + [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)   + [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378) * To configure   rules:    + To     create a new rule, click the     + button. See     [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB).   + To edit     an existing rule, click the edit icon (edit icon)     for the rule (in the Actions column). You can also selectively edit a rule     property by clicking on the property in the table.   + To     delete a rule you no longer need, click the delete icon (delete icon)     for the rule (in the Actions column). * To move a   rule, edit it and select the new location from the   Order drop-down list. * If any rules have problems, for example, because of removed or changed URL categories, click the See Problem Rules link next to the search box to filter the table to show only those rules. Please edit and correct (or delete) these rules,   so that they will provide the service that you require. |

---

* [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825)
* [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316)
* [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB)
* [Configure SSL Decryption Settings](#Cisco_Concept.dita_a8dbcdf0-6eb0-4ae3-bb1f-c833c58cb010)
* [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378)

### Enable the SSL Decryption Policy

Before you can
configure SSL decryption rules, you must enable the policy and configure some
basic settings. The following procedure explains how to enable the policy
directly. You can also enable it when you enable identity policies. Identity
policies require that you enable the SSL decryption policy.

#### Before you begin

If you upgraded from
a release that did not have SSL decryption policies, but you had configured the
identity policy with active authentication rules, the SSL decryption policy is
already enabled. Ensure that you select the Decrypt Re-Sign certificate you
want to use, and optionally enable pre-defined rules.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click Enable SSL Decryption to configure the policy settings.   * If this is   the first time you enabled the policy, the SSL Decryption Configuration dialog   box opens. Proceed with the next steps. * If you have   already configured the policy once and then disabled it, the policy is simply   enabled again with your previous settings and rules. You can click the   SSL Decryption Settings button (Gear/Settings button.) and configure settings as described in   [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA). |
| **Step 3** | In Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create Internal CA to create it.  If you have not already installed the certificate in client browsers, click the download button (Download button.) to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 4** | (Optional.) Click + under Trusted CA Certificates and select the certificates or certificate groups that you want the policy to trust.  The default group, Cisco-Trusted-Authorities, includes all of the system-defined trusted CA certificates. If you uploaded additional certificates, you can add them here, or collect them in your own group and select the group here. You can either replace the Cisco-Trusted-Authorities group, or simply add your group. Users will be prompted to accept the certificate for any site whose certificate's signing authority is not represented in this list: access to the site is not blocked simply because the certificate is not trusted.  If you leave the list empty, or select only empty certificate groups, then the SSL decryption policy will trust any certificate. |
| **Step 5** | Select the initial SSL decryption rules.  The system includes the following pre-defined rule that you might find useful:   * Sensitive\_Data—This rule does not decrypt traffic   that matches web sites in the Financial Services or Health and Medicine URL   categories, which include banks, healthcare services, and so forth. You must   enable the URL license to implement this rule. |
| **Step 6** | Click Enable. |

---

### Configure the Default SSL Decryption Action

If an encrypted
connection does not match a specific SSL decryption rule, it is handled by the
default action for the SSL decryption policy.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click anywhere in the Default Action field. |
| **Step 3** | Select the action to apply to matching traffic.   * Do Not   Decrypt—Allow the encrypted connection. The access control policy   then evaluates the encrypted connection and drops or allows it based on access   control rules. * Block—Drop the   connection immediately. The connection is not passed on to the access control   policy. |
| **Step 4** | (Optional.) Configure logging for the default action.  You must enable logging for traffic that matches the default action to be included in dashboard data or Event Viewer. Select from these options:   * At End of   Connection—Generate an event at the conclusion of the connection.    + Send Connection Events To—If you want to send a copy     of the events to an external syslog server, select the server object that     defines the syslog server. If the required object does not already exist, click     Create New Syslog Server and create it. (To disable     logging to a syslog server, select     Any from the server list.)  Because     event storage on the device is limited, sending events to an external syslog     server can provide more long term storage and enhance your event analysis. * No Logging—Do not   generate any events. |
| **Step 5** | Click Save. |

---

### Configure SSL Decryption Rules

Use SSL decryption
rules to determine how to handle encrypted connections. Rules in the SSL
decryption policy are evaluated from top to bottom. The rule applied to traffic
is the first one where all the traffic criteria are matched.

You can create and
edit rules in the SSL Native Rules section only.

| **Note** | ---   Traffic for your VPN connections (both site-to-site and remote access) is decrypted before the SSL decryption policy evaluates connections. Thus, SSL decryption rules are never applied to VPN connections, and you do not need to consider VPN connections when creating these rules. However, any use of encrypted connections within a VPN tunnel are evaluated. For example, an HTTPS connection to an internal server through an RA VPN connection is evaluated by SSL decryption rules, even though the RA VPN tunnel itself is not (because it is decrypted already).   --- |
| --- | --- |

#### Before you begin

If you are
creating a decrypt known-key rule, ensure that you upload the certificate and
key for the destination server (as an internal certificate) and also edit the
SSL decryption policy settings to use the certificate. Known-key rules
typically specify the destination server in the destination network criteria of
the rule. For more information, see
[Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA).

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption.  If you have not configured any SSL decryption rules (other than the ones automatically generated for active authentication identity rules), you can add pre-defined rules by clicking Add Pre-Defined Rules. You are prompted to select the rules that you want. |
| --- | --- |
| **Step 2** | Do any of the following:   * To create a new rule, click   the   + button. * To edit an existing rule,   click the edit icon (edit icon)   for the rule.   To delete a rule you no longer need, click the delete icon (delete icon) for the rule. |
| **Step 3** | In Order, select where you want to insert the rule in the ordered list of rules.  You can insert rules into the SSL Native Rules section only. The Identity Policy Active Authentication Rules are automatically generated from your identity policy and are read-only.  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 4** | In Title, enter a name for the rule.  The name cannot contain spaces. You can use alphanumeric characters and these special characters: + . \_ - |
| **Step 5** | Select the action to apply to matching traffic.  For a detailed discussion of each option, see the following:   * [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9) * [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061) * [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D) * [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057) |
| **Step 6** | Define the traffic matching criteria using any combination of the following tabs:   * Source/Destination—The security zones (interfaces) through which the traffic passes, the IP addresses or the country or continent (geographical   location) for the IP address, or the TCP ports used in the traffic. The default is any zone, address, geographical location,   and TCP port. See [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B). * Application—The application, or a filter that defines applications by type, category, tag, risk, or business relevance. The default is   any encrypted application. See [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37). * URL—The URL   category of a web request. The default is that the URL category and reputation   are not considered for matching purposes. See   [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC). * Users—The identity source, user or user group. Your identity policies determine whether user and group information is available for traffic matching.   You must configure identity policies to use this criteria. See [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0). * Advanced—The   characteristics derived from the certificates used in the connection, such as   SSL/TLS version and certificate status. See   [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD).   To modify a condition, you click the + button within that condition, select the desired object or element, and click OK in the popup dialog box. If the criterion requires an object, you can click Create New Object if the object you require does not exist. Click the x for an object or element to remove it from the policy.  When adding conditions to SSL decryption rules, consider the following tips:   * You can   configure multiple conditions per rule. Traffic must match all the conditions   in the rule for the rule to apply to traffic. For example, you can use a single   rule to decrypt traffic based on URL category. * For each   condition in a rule, you can add up to 50 criteria. Traffic that matches any of   a condition's criteria satisfies the condition. For example, you can use a   single rule to apply application control for up to 50 applications or   application filters. Thus, there is an OR relationship among the items in a   single condition, but an AND relationship between condition types (for example,   between source/destination and application). * Matching URL category requires the URL filtering license. |
| **Step 7** | (Optional.) Configure logging for the rule.  You must enable logging for traffic that matches the rule to be included in dashboard data or Event Viewer. Select from these options:   * At End of   Connection—Generate an event at the conclusion of the connection.    + Send Connection Events To—If you want to send a copy     of the events to an external syslog server, select the server object that     defines the syslog server. If the required object does not already exist, click     Create New Syslog Server and create it. (To disable     logging to a syslog server, select Any from the server list.)  Because     event storage on the device is limited, sending events to an external syslog     server can provide more long term storage and enhance your event analysis. * No Logging—Do not   generate any events. |
| **Step 8** | Click OK. |

---

* [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B)
* [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37)
* [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC)
* [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0)
* [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD)

#### Source/Destination Criteria for SSL Decryption Rules

The Source/Destination
criteria of an SSL decryption rule define the security zones (interfaces)
through which the traffic passes, the IP addresses or the country or continent
(geographical location) for the IP address, or the TCP ports used in the
traffic. The default is any zone, address, geographical location, and any TCP
port. TCP is the only protocol matched to SSL decryption rules.

To modify a condition,
you click the
+ button within that condition, select the desired
object or element, and click
OK. If the criterion requires an object, you can
click
Create New
Object if the object you require does not
exist. Click the
x for an object or element to remove it from the
policy.

You can use the
following criteria to identify the source and destination to match in the rule.

Source Zones,
Destination Zones

The security
zone objects that define the interfaces through which the traffic passes. You
can define one, both, or neither criteria: any criteria not specified applies
to traffic on any interface.

* To match
  traffic leaving the device from an interface in the zone, add that zone to the
  Destination Zones.
* To match
  traffic entering the device from an interface in the zone, add that zone to the
  Source Zones.
* If you add
  both source and destination zone conditions to a rule, matching traffic must
  originate from one of the specified source zones and egress through one of the
  destination zones.

Use this
criteria when the rule should apply based on where the traffic enters or exits
the device. For example, if you want to ensure that all traffic going from
outside hosts to inside hosts gets decrypted, you would select your outside
zone as the
Source
Zones and your inside zone as the
Destination Zones.

Source Networks,
Destination Networks

The network
objects or geographical locations that define the network addresses or
locations of the traffic.

* To match
  traffic from an IP address or geographical location, configure the
  Source Networks.
* To match
  traffic to an IP address or geographical location, configure the
  Destination Networks.
* If you add
  both source and destination network conditions to a rule, matching traffic must
  originate from one of the specified IP addresses and be destined for one of the
  destination IP addresses.

When you add
this criteria, you select from the following tabs:

* Network—Select
  the network objects or groups that define the source or destination IP
  addresses for the traffic you want to control.

  | **Note** | ---   For Decrypt Known-Key rules, select an object with the IP address of the destination server that uses the certificate and key you uploaded.   --- |
  | --- | --- |
* Geolocation—Select the geographical location to
  control traffic based on its source or destination country or continent.
  Selecting a continent selects all countries within the continent. Besides
  selecting geographical location directly in the rule, you can also select a
  geolocation object that you created to define the location. Using geographical
  location, you could easily restrict access to a particular country without
  needing to know all of the potential IP addresses used there.

Source Ports,
Destination Ports/Protocols

The port objects
that define the protocols used in the traffic. You can specify TCP protocol and
ports only for SSL decryption rules.

* To match
  traffic from a TCP port, configure the
  Source Ports.
* To match
  traffic to a TCP port, configure the
  Destination Ports/Protocols.
* To match
  traffic both originating from specific TCP ports and destined for specific TCP
  ports, configure both. For example, you could target traffic from port TCP/80
  to port TCP/8080.

#### Application Criteria for SSL Decryption Rules

The Application
criteria of an SSL decryption rule defines the application used in an IP
connection, or a filter that defines applications by type, category, tag, risk,
or business relevance. The default is any application that has the SSL Protocol
tag. You cannot match SSL decryption rules to any non-encrypted application.

Although you can
specify individual applications in the rule, application filters simplify
policy creation and administration. For example, you could create an SSL
decryption rule that decrypts or blocks all high risk, low business relevance
applications. If a user attempts to use one of those applications, the session
is decrypted or blocked.

In addition, Cisco
frequently updates and adds additional application detectors via system and
vulnerability database (VDB) updates. Thus, a rule for high risk applications
can automatically apply to new applications without you having to update the
rule manually.

You can specify
applications and filters directly in the rule, or create application filter
objects that define those characteristics. The specifications are equivalent,
although using objects can make it easier to stay within the
50-items-per-criteria system limit if you are creating a complex rule.

To modify the
application and filters list, you click the
+ button within the condition, select the desired
applications or application filter objects, which are listed on separate tabs,
and click
OK in the popup dialog box. On either tab, you can
click
Advanced
Filter to select filter criteria or to help you search for specific
applications. Click the
x for an application, filter, or object to remove it
from the policy. Click the
Save As
Filter link to save the combined criteria that is not already an
object as a new application filter object.

For more information
about the application criteria and how to configure advanced filters and select
applications, see
[Configuring Application Filter Objects](fptd-fdm-objects.html#task_49CC5243743F4921AAF00CF6AB0264BE).

Consider the following
tips when using application criteria in SSL decryption rules.

* The system can
  identify unencrypted applications that become encrypted using StartTLS. This
  includes such applications as SMTPS, POPS, FTPS, TelnetS, and IMAPS. In
  addition, it can identify certain encrypted applications based on the Server
  Name Indication in the TLS ClientHello message, or the server certificate
  subject distinguished name value.
* The system can
  identify the application only after the server certificate exchange. If traffic
  exchanged during the SSL handshake matches all other conditions in an SSL rule
  containing an application condition but the identification is not complete, the
  SSL policy allows the packet to pass. This behavior allows the handshake to
  complete so that applications can be identified. After the system completes its
  identification, the system applies the SSL rule action to the remaining session
  traffic that matches its application condition.
* If a selected application was removed by a VDB update, “(Deprecated)” appears after the application name. You must remove
  these applications from the filter, or subsequent deployments and system software upgrades will be blocked.

#### URL Criteria for SSL Decryption Rules

The URL criteria of an
SSL decryption rule defines the category to which the URL in a web request
belongs. You can also specify the relative reputation of sites to decrypt,
block, or allow without decryption. The default is to not match connections
based on URL categories.

For example, you could block all encrypted Gambling sites, or decrypt untrusted Social Networking sites. If a user attempts to browse to any URL with that category and reputation combination, the session
is blocked or decrypted. For more information on URL category matching, see [Filtering URLs by Category and Reputation](fptd-fdm-access.html#concept_2190C5512921483CB9009A9FF5E3AE74).

Categories Tab

Click
+, select the desired categories, and click
OK. Click the
x for a category to remove it from the policy.

The default is
to apply the rule to all URLs in each selected category regardless of
reputation. To limit the rule based on reputation, click the down arrow for
each category, deselect the
Any checkbox, and then use the
Reputation slider to choose the reputation level.
The left of the reputation slider indicates sites that will be allowed without
decryption, the right side are sites that will be decrypted or blocked. How
reputation is used depends on the rule action:

* If the rule decrypts or blocks connections, selecting a reputation level also selects all reputations more severe than that
  level. For example, if you configure a rule to decrypt or block Questionable sites (level 2), it also automatically decrypts or blocks Untrusted (level 1) sites.
* If the rule allows connections without decryption (do not decrypt), selecting a reputation level also selects all reputations
  less severe than that level. For example, if you configure a rule to not decrypt Favorable sites (level 4), it also automatically does not decrypt Trusted (level 5) sites.

Select the Include Sites with
Unknown Reputation option to have URLs with unknown
reputation included in the reputation match. New sites typically are
unrated, and there can be other reasons a site's reputation is unknown or
cannot be determined.

Check the Category for a URL

You can check on the category and reputation for a particular URL. Enter the URL in the URL to Check box and click Go. You will be taken to an external website to see the results. If you disagree with a categorization, click the Submit a URL Category Dispute link and let us know.

#### User Criteria for SSL Decryption Rules

The User criteria of
an SSL decryption rule defines the user or user group for an IP connection. You
must configure identity policies and the associated directory server to include
user or user group criteria in a rule.

Your identity policies
determine whether user identity is collected for a particular connection. If
identity is established, the IP address of the host is associated with the
identified user. Thus, traffic whose source IP address is mapped to a user is
considered to be from that user. IP packets themselves do not include user
identity information, so this IP-address-to-user mapping is the best
approximation available.

Because you can add a maximum of 50 users or groups to a rule, selecting groups usually makes more sense than selecting individual
users. For example, you could create a rule that decrypts traffic to the Engineering group that comes from the outside network,
and create a separate rule that does not decrypt outgoing traffic from that group. Then, to make the rule apply to new engineers,
you only need to add the engineer to the Engineering group in the directory server.

You an also select identity sources to apply to all users within that source. Thus, if you support multiple Active Directory
domains, you can provide differential decryption based on the domain.

To modify the users
list, you click the
+ button within the condition and select the desired
users or user groups using one of the following techniques. Click the
x for a user or group to remove it from the policy.

* Identity Sources—Select an identity source, such as an AD realm or the local user database, to apply the rule to all users obtained from the
  selected sources. If the realm you need does not yet exist, click Create New Identity Realm and create it now.
* Groups—Select the desired user groups. Groups are available only if you configure groups in the directory server. If you select
  a group, the rule applies to any member of the group, including subgroups. If you want to treat a sub-group differently, you
  need to create a separate access rule for the sub-group and place it above the rule for the parent group in the access control
  policy.
* Users—Select individual users. The user name is prefixed with the identity source, such as Realm\username.

  There are some built-in users under the Special-Identities-Realm:

  + Failed
    Authentication—The user was prompted to authenticate, but failed to
    enter a valid username/password pair within the maximum number of allowed
    attempts. Failure to authenticate does not itself prevent the user from
    accessing the network, but you can write an access rule to limit network access
    for these users.
  + Guest—Guest users
    are like Failed Authentication users, except that your identity rule is
    configured to call these users Guest. Guest users were prompted to authenticate
    and failed to do so within the maximum number of attempts.
  + No Authentication
    Required—The user was not prompted to authentication, because the
    user's connections matched identity rules that specified no authentication.
  + Unknown—There is
    no user mapping for the IP address, and there is no record of failed
    authentication yet. Typically, this means that no HTTP traffic has yet been
    seen from that address.

#### Advanced Criteria for SSL Decryption Rules

The Advanced traffic
matching criteria relate to characteristics derived from the certificates used
in the connection. You can configure any or all of the following options.

Certificate
Properties

Traffic matches
the certificate properties option of the rule if it matches any of the selected
properties. You can configure the following:

Certificate
Status

Whether
the certificate is
Valid or
Invalid. Select
Any (the default) if you do not care about
certificate status.

A
certificate is considered valid if all of the following conditions are met,
otherwise it is invalid:

* The
  policy trusts the CA that issued the certificate.
* The
  certificate’s signature can be properly validated against the certificate’s
  content.
* The
  issuer CA certificate is stored in the policy’s list of trusted CA
  certificates.
* None
  of the policy’s trusted CAs revoked the certificate.
* The
  current date is between the certificate Valid From and Valid To dates.

Self-Signed

Whether
the server certificate contains the same subject and issuer distinguished name.
Select one of the following:

* Self-Signing—The server
  certificate is self-signed.
* CA-Signing—The server certificate
  is signed by a Certificate Authority. That is, the issuer and subject are not
  the same.
* Any—Do not consider whether the
  certificate is self-signed as a match criteria.

Supported Version

The SSL/TLS version to match. The rule applies to traffic that uses the any of the selected
versions only. The default is all versions. Select from: SSL
3.0, TLS 1.0, TLS
1.1, TLS 1.2, TLS 1.3.

For example, if you wanted to permit TLSv1.2/3
connections only, you could create a block rule for the lower versions.

You must be using Snort 3 to match TLS 1.3 connections.

Traffic that
uses any version not listed, such as SSL v2.0, is handled by the default action
for the SSL decryption policy.

### Configure SSL Decryption Settings

You must configure the certificate settings if you have any rules that decrypt traffic. You can also modify settings to change
how decryption is applied to encrypted traffic. The following topics explain the options.

* [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)
* [Configure Advanced and Undecryptable Traffic Settings](#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06)

#### Configure Certificates for Known Key and Re-Sign Decryption

If you implement
decryption, either by re-signing or using known keys, you need to identify the
certificates that the SSL decryption rules can use. Ensure that all
certificates are valid and unexpired.

Especially for
known-key decryption, you need to ensure that the system has the current
certificate and key for each destination server whose connections you are
decrypting. With a decrypt known key rule, you use the actual certificate and
key from the destination server for decryption. Thus, you must ensure that the
threat
defense device has the current certificate and key at all times, or
decryption will be unsuccessful.

Upload a new
internal certificate and key whenever you change the certificate or key on the
destination server in a known key rule. Upload them as an internal certificate
(not an internal CA certificate). You can upload the certificate during the
following procedure, or go to the
Objects > Certificates page and upload it there.

##### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the SSL Decryption Settings button (Gear/Settings button.).  If necessary, select the Basic tab. |
| **Step 3** | In Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create Internal CA to create it.  If you have not already installed the certificate in client browsers, click the download button (Download button.) to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 4** | For each rule that decrypts using a known key, upload the internal certificate and key for the destination server.   1. Click    + under    Decrypt Known-Key Certificates. 2. Select the    internal identity certificate, or click    Create New Internal Certificate to upload it now. 3. Click    OK. |
| **Step 5** | (Optional.) Click + under Trusted CA Certificates and select the certificates or certificate groups that you want the policy to trust.  The default group, Cisco-Trusted-Authorities, includes all of the system-defined trusted CA certificates. Following are the main cases where you might want to change this setting:   * You want to use trusted CA certificates that are not in the default group. You would then   select both the default group and your new group in the SSL   decryption policy settings. You might do this if you have uploaded   additional trusted CA certificates. * You want to use a more limited list of trusted CA certificates than what is in the default   group. You would then create a group that has a complete list of   trusted certificates, not just your delta, and select it as the sole   group in the SSL decryption policy settings.   Users will be prompted to accept the certificate for any site whose certificate's signing authority is not represented in this list: access to the site is not blocked simply because the certificate is not trusted.  If you leave the list empty, or select only empty certificate groups, then the SSL decryption policy will trust any certificate. |
| **Step 6** | Click Save. |

---

#### Configure Advanced and Undecryptable Traffic Settings

You can configure advanced decryption settings, and settings for undecryptable traffic, if you do not want to use the default
behavior.

##### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the SSL Decryption Settings button (Gear/Settings button.). |
| **Step 3** | On the Advanced tab, select whether to enable TLS 1.3 Decryption.  If you enable TLS 1.3 decryption, you must also select the TLS 1.3 option on the advanced tab of each rule that should apply to TLS 1.3. You must be running Snort 3 to decrypt TLS 1.3. |
| **Step 4** | On the Undecryptable Actions tab, modify how the system handles connections that match rules that implement decryption, but for the cases where the connection cannot be decrypted.  The default is to apply the same action as the default action to these connections. The exception is decryption errors, for which your options are to block or block with reset only.  For descriptions of these categories, see [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810). |
| **Step 5** | Click OK. |

---

### Downloading the CA Certificate for Decrypt Re-Sign Rules

If you decide to
decrypt traffic, users must have the internal CA certificate that is used in
the encryption process defined as a Trusted Root Certificate Authority in their
applications that use TLS/SSL. Typically if you generate a certificate, or
sometimes even if you import one, the certificate is not already defined as
trusted in these applications. By default in most web browsers, when users send
HTTPS requests, they will see a warning message from the client application
informing them that there is a problem with the web site’s security
certificate. Usually, the error message says that the web site’s security
certificate was not issued by a trusted certificate authority or the web site
was certified by an unknown authority, but the warning might also suggest there
is a possible man-in-the-middle attack in progress. Some other client
applications do not show this warning message to users nor allow users to
accept the unrecognized certificate.

You have the
following options for providing users with the required certificate:

Inform users to
accept the root certificate

You can inform
the users in your organization what the new policies are at the company and
tell them to accept the root certificate supplied by the organization as a
trusted source. Users should accept the certificate and save it in the Trusted
Root Certificate Authority storage area so that they are not prompted again the
next time they access the site.

| **Note** | ---   The user needs to accept and trust the CA certificate that created the replacement certificate. If they instead simply trust the replacement server certificate, they will continue to see warnings for each different HTTPS site that they visit.   --- |
| --- | --- |

Add the root certificate to client devices

You can add the root certificate to all client devices on the network as a trusted root certificate authority. This way, the
client applications automatically accept transactions with the root certificate.

You can either
make the certificate available to users by E-mailing it or placing it on a
shared site, or you could incorporate the certificate into your corporate
workstation image and use your application update facilities to distribute it
automatically to users.

The following
procedure explains how to download the internal CA certificate and install it
on Windows clients.

#### Procedure

---

| **Step 1** | Download the certificate from the device manager.   1. Select Policies > SSL Decryption. 2. Click the SSL Decryption Settings button (Gear/Settings button.). 3. Click the Download button (Download button.). 4. Select a download location, optionally change the file name (but not the extension), and click Save.  You can now cancel out of the SSL Decryption Settings dialog box. |
| --- | --- |
| **Step 2** | Install the certificate in the Trusted Root Certificate Authority storage area in web browsers on client systems, or make it available for clients to install themselves.  The process differs depending on the operating system and type of browser. For example, you can use the following process for Internet Explorer and Chrome running on Windows. (For Firefox, install through the Tools > Options > Advanced page.)   1. From the    Start menu, select    Control    Panel > Internet Options. 2. Select the    Content tab. 3. Click the    Certificates button to open the Certificates dialog    box. 4. Select the    Trusted Root Certificate Authorities tab. 5. Click    Import, and follow the wizard to locate and select    the downloaded file (<uuid>\_internalCA.crt) and add it to the Trusted    Root Certificate Authorities store. 6. Click    Finish.  Messages    should indicate that the import was successful. You might see an intermediate    dialog box warning you that Windows could not validate the certificate if you    generated a self-signed certificate rather than obtaining one from a well-known    third-party Certificate Authority.  You can now    close out the Certificate and Internet Options dialog boxes. |

---

## Example: Blocking Older SSL/TLS Versions from the Network

Some organizations are required to prevent the use of older versions of SSL or TLS either by government regulation or company
policy. You can use the SSL Decryption policy to block traffic that uses an SSL/TLS version that you prohibit. Consider placing
this rule at the top of the SSL Decryption policy to ensure that you catch the prohibited traffic immediately.

The following example blocks all SSL 3.0 and TLS 1.0 connections.

### Before you begin

This procedure assumes you have already enabled the SSL Decryption policy as explained in [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825).

### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the + button to create a new rule. |
| **Step 3** | In Order, select 1 to place the rule at the top of the policy, or select the number most suitable for your network.  The default is to add the rule at the end of the policy. |
| **Step 4** | In Title, enter a name for the rule, for example, Block\_SSL3.0\_and\_TLS1.0. |
| **Step 5** | In Action, select Block. This will immediately drop any traffic that matches the rule. |
| **Step 6** | Leave the default values for all options on the following tabs: Source/Destination, Applications, URLs, Users. |
| **Step 7** | Click the Advanced tab and under Supported Versions, leave SSL 3.0 and TLS 1.0 selected, but uncheck TLS 1.1, TLS 1.2, TLS 1.3. |
| **Step 8** | (Optional) Click the Logging tab and select At End of Connection if you want to dashboards and events to reflect blocked connections. You can also select an external syslog server if you are using one. |
| **Step 9** | Click OK.  You can now deploy the policy. Once deployed, any SSL 3.0 or TLS 1.0 connection that goes through the system will be dropped.   | **Note** | SSL 2.0 connections are handled by the default action for the policy. If you want to ensure these are also dropped, change the default action to Block. | | --- | --- | |

---

### What to do next

If you implement this rule, we have the following recommendations:

* For any type of decrypt rule, leave the default settings on the Advanced tab, where all SSL/TLS options are selected. By applying
  to all versions, the handshake process is simplified. However, your initial block rule will still prevent SSL 3.0 and TLS
  1.0 connections.
* We normally recommend that you use Do Not Decrypt as the default action for the policy. However, because SSL 2.0 connections
  are always handled by the default action, you might want to use Block instead. However, if you want to apply Do Not Decrypt
  as the default action for all decryptable traffic, create a Do Not Decrypt rule at the end of the policy where you accept
  all default values for traffic matching criteria. This rule would match any supported TLS connection that does not match an
  earlier rule in the table, and act as the default for those TLS versions.

## Monitoring and Troubleshooting SSL Decryption

The following topics explain how to
monitor and troubleshoot SSL decryption policies.

* [Monitoring SSL Decryption](#concept_F6B5C308790C43ABA150C8E3F937A71C)
* [Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)](#concept_9CE017AD0A384BB581E3EFB7CBC76573)

### Monitoring SSL Decryption

You can view
information about decryption in the dashboards and events for traffic that
matches rules (or the default action) for which you enabled logging.

#### SSL Decryption Dashboard

To evaluate overall
decryption statistics, view the
Monitoring > SSL
Decryption dashboard. The dashboard shows the
following information:

* Percentage of
  encrypted versus plain text traffic.
* How much
  encrypted traffic is decrypted per SSL rules.

#### Events

In addition to the
dashboard, the event viewer (Monitoring > Events) includes SSL information for
encrypted traffic. Following are some tips in evaluating events:

* For connections
  that were dropped because they matched an SSL rule (or default action) that
  blocked matching traffic, the
  Action should be “Block,” and the
  Reason should indicate “SSL Block.”
* The
  SSL
  Actual Action field indicates the actual action that the system
  applied to the connection. This can differ from the
  SSL
  Expected Action, which indicates the action defined on the matching
  rule. For example, a connection might match a rule that applies decryption, but
  could not be decrypted for some reason.

### Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)

Some apps for smart phones and other devices use a technique called SSL (or Certificate Authority) pinning. The SSL pinning
technique embeds the hash of the original server certificate inside the app itself. As a result, when the app receives the
resigned certificate from the threat
defense device, the hash validation fails and the connection is aborted.

The primary symptom is that users cannot connect to the web site using
the site’s app, but they can connect using the web browser, even when using the
browser on the same device where the app fails. For example, users cannot use
the Facebook iOS or Android app, but they can point Safari or Chrome at
https://www.facebook.com and make a successful connection.

Because SSL pinning is specifically used to avoid man-in-the-middle
attacks, there is no workaround. You must choose between the following options:

* Support app users, in which case you cannot decrypt any traffic to
  the site. Create a Do Not Decrypt rule for the site’s application (on the
  Application tab for the SSL Decryption rule) and ensure that the rule comes
  before any Decrypt Re-sign rule that would apply to the connections.
* Force users to use browsers only. If you must decrypt traffic to the
  site, you will need to inform users that they cannot use the site’s app when
  connecting through your network, that they must use their browsers only.

#### More Details

If a site works in a browser but not in an app on the same device, you
are almost certainly looking at an instance of SSL pinning. However, if you
want to delve deeper, you can use connection events to identify SSL pinning in
addition to the browser test.

There are two ways an app might deal with hash validation failures:

* Group 1 apps, such as Facebook, send an SSL ALERT Message as soon
  as it receives the SH, CERT, SHD message from the server. The Alert is usually
  an “Unknown CA (48)” alert indicating SSL Pinning. A TCP Reset is sent
  following the Alert message. You should see the following symptoms in the event
  details:

  + SSL Flow Flags include ALERT\_SEEN.
  + SSL Flow Flags do not include APP\_DATA\_C2S or APP\_DATA\_S2C.
  + SSL Flow Messages typically are: CLIENT\_HELLO, SERVER\_HELLO,
    SERVER\_CERTIFICATE, SERVER\_KEY\_EXCHANGE, SERVER\_HELLO\_DONE.
* Group 2 apps, such as Dropbox, do not send any alerts. Instead
  they wait until the handshake is done and then send a TCP Reset. You should see
  the following symptoms in the event:

  + SSL Flow Flags do not include ALERT\_SEEN, APP\_DATA\_C2S, or
    APP\_DATA\_S2C.
  + SSL Flow Messages typically are: CLIENT\_HELLO, SERVER\_HELLO,
    SERVER\_CERTIFICATE, SERVER\_KEY\_EXCHANGE, SERVER\_HELLO\_DONE,
    CLIENT\_KEY\_EXCHANGE, CLIENT\_CHANGE\_CIPHER\_SPEC, CLIENT\_FINISHED,
    SERVER\_CHANGE\_CIPHER\_SPEC, SERVER\_FINISHED.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_39faa076_20250115_123408.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [Compatibility Information](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/products-device-support-tables-list.html)
# Cisco Secure Firewall ASA Compatibility

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/asa/compatibility/asamatrx.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/td/docs/security/asa/compatibility/asamatrx.pdf)
  (302.2 KB)

  View with Adobe Reader on a variety of devices

Updated:November 12, 2024

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

## Contents

* [Cisco Secure Firewall ASA Compatibility](#id_65770)
* [ASA and ASDM Compatibility Per Model](#id_65776)
* [ASA 9.22](#reference_onm_zhh_j1c)
* [ASA 9.20 and 9.19](#reference_xy4_5xz_l5b)
* [ASA 9.18 to 9.17](#reference_ncw_ppb_fxb)
* [ASA 9.16 to 9.15](#reference_upj_nkl_x4b)
* [ASA 9.14 to 9.13](#reference_ftp_45n_nhb)
* [ASA 9.12 to 9.5](#id_59423)
* [ASA and VPN Compatibility](#id_65801)
* [Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)
* [Firepower 1000/2100 and Secure Firewall 3100/4200 ASA and FXOS Bundle Versions](#id_65802)
* [ASA
  Virtual Hypervisor Compatibility](#id_65990)
* [Cisco Defense Orchestrator (CDO) Compatibility with the ASA](#Cisco_Reference.dita_b9a2ae6b-a69f-4bec-ae64-11893e462c96)
* [ASA REST API Compatibility](#id_65991)
* [Secure Firewall 3100 Network Module Compatibility](#Cisco_Reference.dita_d217ee8b-6b52-4c93-9c9f-5fbe54860bbb)
* [Secure Firewall 4200 Network Module Compatibility](#reference_lsn_mqw_txb)
* [Firepower 2100 Network Module Compatibility](#id_81530)
* [ASA and Threat Defense Clustering External Hardware Support](#id_66008)
* [ASA and Cisco Application Policy Infrastructure Controller (APIC) Compatibility](#id_66009)
* [End-of-Life Announcements](#id_66016)
* [Additional Resources](#Cisco_Reference.dita_046821cb-8138-4460-a455-afc073ab7be4)

**First Published: January 1, 2010**

# **Cisco Secure Firewall ASA Compatibility**

This document lists the Secure Firewall ASA software and
hardware compatibility and requirements.

## ASA and ASDM Compatibility Per Model

This section lists ASA and ASDM compatibility per model.

| **Note** | ---   For guidance on security issues on the ASA, and which releases contain fixes for each issue, see the [ASA Security Advisories](https://tools.cisco.com/security/center/publicationListing.x).   --- |
| --- | --- |

### ASA 9.22

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.20(x) was the final version for the Firepower 2100 series. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.22(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.20 with ASA 9.22. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.22(1.2) with ASDM 7.22(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required.  --- |
| --- | --- |

Table 1. ASA and ASDM Compatibility: 9.22

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  Firepower 1010E  1120  1140  1150 | Secure Firewall 1210CE  Secure Firewall 1210CP  Secure Firewall 1220CX | Secure Firewall 3105  3110  3120  3130  3140 | Firepower 4112  4115  4125  4145 | Secure Firewall 4215  Secure Firewall 4225  Secure Firewall 4245 | Firepower 9300 | ISA 3000 |
| **9.22(1.1)** | 7.22(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |

### ASA 9.20 and 9.19

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.20(x) was the final version for the Firepower 2100 series. * ASA 9.18(x) was the final version for the Firepower 4110, 4120, 4140, 4150, and   Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.19(1) can manage an ASA 5516-X on ASA   9.10(1). See the following   exceptions:    + For the Firepower 1010E, ASDM 7.19(1) is not supported. You must use 7.19(1.90)+     or 7.18(2.1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.18 with ASA 9.19. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.20(1.5) with ASDM 7.20(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required.  --- |
| --- | --- |

Table 2. ASA and ASDM Compatibility: 9.20 and 9.19

| ASA | ASDM | ASA Model | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 | Firepower 1010E | Firepower 2110  2120  2130  2140 | Secure Firewall 3105  3110  3120  3130  3140 | Firepower 4112  4115  4125  4145 | Secure Firewall 4215  Secure Firewall 4225  Secure Firewall 4245 | Firepower 9300 | ISA 3000 |
| **9.20(3)** | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(2) | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(1) | 7.20(1) | — | — | — | — | — | — | **YES** | — | — |
| **9.19(1)** | 7.19(1) | **YES** | **YES** | — | **YES** | **YES** | **YES** | — | **YES** | **YES** |

### ASA 9.18 to 9.17

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.17(1) can manage an ASA 5516-X on ASA   9.10(1). See the following   exceptions:    + For the Firepower 1010E, ASDM 7.19(1) is not supported. You must use 7.19(1.90)+     or 7.18(2.1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.17 with ASA 9.18. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.17(1.2) with ASDM 7.17(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.17(1.13) and 9.18(2) and later requires ASDM 7.18(1.152) or later. The ASA now   validates whether the ASDM image is a Cisco digitally signed image. If you try to run   an older ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be   blocked and the message “%ERROR: Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 3. ASA and ASDM Compatibility: 9.18 to 9.17

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 | Firepower 1010E | Firepower 2110  2120  2130  2140 | Secure Firewall 3110  3120  3130  3140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.18(4)** | 7.19(1)95 | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(3) | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(2.218) | 7.18(2.1) | — | — | **YES** | — | — | — | — | — |
| 9.18(2) | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(1) | 7.18(1) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.17(1.13)** | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.17(1) | 7.17(1.155) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |

### ASA 9.16 to 9.15

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.15(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.15 with ASA 9.16. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.16(1.15) with ASDM 7.16(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.16(3.19) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 4. ASA and ASDM Compatibility: 9.16 to 9.15

| ASA | ASDM | ASA Model | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.16(4)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3.19) | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(2) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(1) | 7.16(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.15(1)** | 7.15(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |

### ASA 9.14 to 9.13

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASA 9.12(x) was the final version for the ASA 5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.13(1) can manage an ASA 5516-X on ASA 9.10(1).   ASDM 7.13(1) and ASDM 7.14(1) did not support ASA 5512-X, 5515-X, 5585-X, and ASASM;   you must upgrade to ASDM 7.13(1.101) or 7.14(1.48) to restore ASDM support. * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.13 with ASA 9.14. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.14(1.2) with ASDM 7.14(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.14(4.14) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 5. ASA and ASDM Compatibility: 9.14 to 9.13

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5525-X  5545-X  5555-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.14(4.14)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(4) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(3) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(2) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.30) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.6) | 7.14(1.48) | — | — | **YES** (+ASAv100) | — | — | — | — | — |
| 9.14(1) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.13(1)** | 7.13(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** (except 4112) | **YES** | **YES** |

### ASA 9.12 to 9.5

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.12(x) was the final version for the ASA   5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all   previous ASA versions, unless otherwise stated.   For example, ASDM 7.12(1) can manage an ASA 5515-X   on ASA 9.10(1). * New ASA versions require the coordinating ASDM   version or a later version; you cannot use an old   version of ASDM with a new version of ASA. For   example, you cannot use ASDM 7.10 with ASA 9.12.   For ASA maintenance releases and interims, you can   continue to use the current ASDM version, unless   otherwise stated. For example, you can use ASA   9.12(1.15) with ASDM 7.12(1). If an ASA   maintenance release has significant new features,   then usually there will be a new ASDM version   required. * ASA 9.8(4.45) and 9.12(4.50) and later require   ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed   image. If you try to run an older ASDM image than   7.18(1.152) with an ASA version with this fix,   ASDM will be blocked and the message “%ERROR:   Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 6. ASA and ASDM Compatibility: 9.12 to 9.5

| ASA | ASDM | ASA Model | | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5512-X  5515-X  5525-X  5545-X  5555-X | ASA 5585-X | ASAv | ASASM | Firepower 2110  2120  2130  2140 | Firepower 4110  4120  4140  4150 | Firepower 4115  4125  4145 | Firepower 9300 | ISA 3000 |
| **9.12(4.50)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(4) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(3) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(2) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(1) | 7.12(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.10(1) | 7.10(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(2) | 7.9(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(1) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| **9.8(4.45)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(4) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(3) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(2) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(1.200) | No support | — | — | — | **YES** | — | — | — | — | — | — |
| 9.8(1) | 7.8(1) | **YES** | **YES** | **YES** | **YES** (+ASAv50) | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.7(1.4) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(4) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(3.1) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(2) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(1) | 7.6(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** (except 4150) | — | **YES** | **YES** |
| 9.5(3.9) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(2.200) | 7.5(2.153) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(2.2) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2.1) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2) | 7.5(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(1.200) | 7.5(1) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(1.5) | 7.5(1.112) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |
| 9.5(1) | 7.5(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |

## **ASA and VPN Compatibility**

For ASA and VPN compatibility, see [Supported VPN Platforms, Cisco ASA 5500 Series](https://www.cisco.com/en/US/docs/security/asa/compatibility/asa-vpn-compatibility.html).

## Firepower 4100/9300 Compatibility with ASA and Threat Defense

For the Firepower 4100/9300, you must maintain compatibility between FXOS and all ASA and
threat
defense logical devices. Upgrade FXOS before you upgrade the sofware. The **bold** versions
the the following table are specially-qualified (enhanced testing) companion releases. Use
these combinations whenever
possible.

Note that for other device models, the FXOS compatibility work is done for you. In most
cases, upgrading the software automatically upgrades
FXOS.
For the Secure Firewall 3100/4200 in multi-instance mode, the management center guides you through upgrading FXOS and then threat
defense.

To upgrade:

* FXOS: From FXOS 2.2.2 and later, you can upgrade directly to
  any higher version. When upgrading from versions earlier than 2.2.2, you need to
  upgrade to each intermediate version. Note that you cannot upgrade FXOS to a version
  that does not support your current logical device version. You will need to upgrade in
  steps: upgrade FXOS to the highest version that supports your current logical device;
  then upgrade your logical device to the highest version supported with that FXOS
  version. For example, if you want to upgrade from FXOS 2.2/ASA 9.8 to FXOS 2.13/ASA
  9.19, you would have to perform the following upgrades:

  1. FXOS 2.2→FXOS 2.11 (the highest version that supports 9.8)
  2. ASA 9.8→ASA 9.17 (the highest version supported by 2.11)
  3. FXOS 2.11→FXOS 2.13
  4. ASA 9.17→ASA 9.19
* Threat Defense: Interim upgrades may be required for threat
  defense, in addition to the FXOS requirements above. For the exact upgrade path, refer to the
  [management center upgrade guide](https://www.cisco.com/c/en/us/support/security/defense-center/products-installation-guides-list.html) for your version.
* ASA: ASA lets you upgrade directly from your current version to any higher version,
  noting the FXOS requirements above.

| **Note** | ---   FXOS 2.8(1.125)+ and later versions do not support ASA 9.14(1) or 9.14(1.10) for ASA SNMP polls and traps; you must use 9.14(1.15)+. Other releases, such as 9.13 or 9.12, are not affected.   --- |
| --- | --- |

Table 7. Firepower 4100/9300 Compatibility with ASA and Threat Defense

| FXOS Version | Model | ASA Version | Threat Defense Version |
| --- | --- | --- | --- |
| 2.16 | Firepower 4112 | **9.22** (recommended)  9.20  9.19  9.18  9.17 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.22** (recommended)  9.20  9.19  9.18  9.17 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.14(1) | Firepower 4112 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.13 | Firepower 4112 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.12 | Firepower 4112 | **9.18** (recommended)  9.17  9.16  9.14 | **7.2** (recommended)  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.11 | Firepower 4112 | **9.17** (recommended)  9.16  9.14 | **7.1** (recommended)  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.17** (recommended)  9.16  9.14  9.12 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.17** (recommended)  9.16  9.14  9.12  9.8 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.10   | **Note** | For compatibility with 7.0.2+ and 9.16(3.11)+, you need FXOS 2.10(1.179)+. | | --- | --- | | Firepower 4112 | **9.16** (recommended)  9.14 | **7.0** (recommended)  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.16** (recommended)  9.14  9.12 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.16** (recommended)  9.14  9.12  9.8 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.9 | Firepower 4112 | 9.14 | 6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | 9.14  9.12 | 6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.14  9.12  9.8 | 6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.8 | Firepower 4112 | **9.14** | **6.6**   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- | |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.14** (recommended)  9.12   | **Note** | Firepower 9300 SM-56 requires ASA 9.12(2)+ | | --- | --- | | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.14** (recommended)  9.12  9.8 | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.157)   | **Note** | You can now run ASA 9.12+ and FTD 6.4+ on separate modules in the same Firepower 9300 chassis | | --- | --- | | Firepower 4145  Firepower 4125  Firepower 4115 | **9.12**   | **Note** | Firepower 9300 SM-56 requires ASA 9.12.2+ | | --- | --- | | **6.4** |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 | **6.4** (recommended)  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.131) | Firepower 9300 SM-48  Firepower 9300 SM-40 | **9.12** | Not supported |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.73) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | | **6.2.3** (recommended)   | **Note** | 6.2.3.16+ requires FXOS 2.3.1.157+ | | --- | --- | |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.66)  2.3(1.58) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | |  |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.2 | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.8** | Threat Defense versions are EoL |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |

## Firepower 1000/2100 and Secure Firewall 3100/4200 ASA and FXOS Bundle Versions

Firepower 1000/2100 and Secure Firewall 3100/4200 platforms utilize FXOS as an
underlying operating system that is included in the ASA unified image bundles. The
following table lists the ASA and FXOS versions in each released bundle.

| **Note** | ---   You cannot install ASA or FXOS separately; you must install them both as part of the bundle.   --- |
| --- | --- |

Table 8. ASA Firepower 1000/2100 and Secure Firewall 3100/4200 ASA and FXOS Bundle Versions

| ASA Bundle Version | FXOS Version |
| --- | --- |
| 9.22(1) | 2.16(0.128) |
| 9.20(3) | 2.14(2.106) |
| 9.20(2) | 2.14(1.131) |
| 9.20(1) (Secure Firewall 4200 only) | 2.14(0.11) |
| 9.19(1) | 2.13(0.198) |
| 9.18(3) | 2.12(0.468) |
| 9.18(2) | 2.12(0.438) |
| 9.18(1) | 2.12(0.31) |
| 9.17(1) | 2.11(1.154) |
| 9.16(3) | 2.10(1.189) |
| 9.16(2) | 2.10(1.162) |
| 9.16(1) | 2.10(1.159) |
| 9.15(1) | 2.9(1.131) |
| 9.14(3) | 2.8(1.157) |
| 9.14(2) | 2.8(1.134) |
| 9.14(1.30) | 2.8(1.129) |
| 9.14(1) | 2.8(1.105) |
| 9.13(1) | 2.7(1.107) |
| 9.12(4) | 2.6(1.198) |
| 9.12(3) | 2.6(1.156) |
| 9.12(2) | 2.6(1.141) |
| 9.12(1) | 2.6(1.113) |
| 9.10(1) | 2.4(1.92) |
| 9.9(2) | 2.3(1.77) |
| 9.9(1) | 2.3(1.54) |
| 9.8(4) | 2.2(2.119) |
| 9.8(3) | 2.2(2.90) |
| 9.8(2) | 2.2(2.52) |

## **ASA Virtual Hypervisor Compatibility**

You can deploy the ASA
virtual on the following hypervisors.

| **Note** | ---   ASA virtual deployment on a platform using nested or multi-level hypervisor is not supported.   --- |
| --- | --- |

Table 9. ASA
Virtual Hypervisor Compatibility

| Hypervisor | Version and Details | ASA Virtual OS |
| --- | --- | --- |
| Amazon Web Services | **ASA 9.17 and later**  Amazon Web Services supports the following instance types:   * c5a.large, c5a.xlarge, c5a.2xlarge, c5a.4xlarge * c5d.large, c5d.xlarge, c5d.2xlarge, c5d.4xlarge * c5ad.large, c5ad.xlarge, c5ad.2xlarge, c5ad.4xlarge * m5n.large, m5n.xlarge, m5n.2xlarge, m5n.4xlarge * m5zn.large, m5zn.xlarge, m5zn.2xlarge   **ASA 9.14 and later**  Amazon Web Services supports the following instance types:   * c5.4xlarge * c5n.large, c5n.xlarge, c5n.2xlarge, c5n.4xlarge   **ASA 9.13 and later**   * ASAv50 support added. * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You can deploy the ASA   Virtual on a wide variety of Amazon Web Services instances   types such as:    + c5.large, c5.xlarge, c5.2xlarge, c4.2xlarge, c3.2xlarge, m4.2xlarge   **ASA 9.12 and earlier**  Amazon Web Services supports the ASAv10 and ASAv30 models on the following instance types:   * c3.large, c4.large, and m4.large instances (ASAv10) * c3.xlarge, c4.xlarge, and m4.xlarge instances (ASAv30)  | **Note** | The ASAv100 is not supported on Amazon Web Services. | | --- | --- | | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4(1.200), 9.4(2), 9.4(3), 9.4(4) |
| Kernel-based Virtual Machine (KVM) | * qemu-kvm, libvirt-bin, bridge-utils, virt-manager, genisoimage, virtinst, and virsh tools (part of KVM installation). * Linux Ubuntu 18.04 LTS host.  The ASA   Virtual has been extensively tested on an Ubuntu 18.04 LTS   host, but you can use other Linux distributions.   **ASA 9.14**   * ASAv100 support added.   **ASA 9.13**   * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You have greater   flexibility when you deploy the ASA   Virtual in a KVM private cloud environment.   **ASA 9.8**   * ASAv50 support added. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4  ASA 9.3(2.200), 9.3(3) |
| Microsoft Azure | **ASA 9.17 and later**  Microsoft Azure supports the following instance types:   * Standard\_D8s\_v3 * Standard\_D16s\_v3 * Standard\_F8s\_v2 * Standard\_F16s\_v2   **ASA 9.15 and later**  Microsoft Azure supports the following instance types:   * D5, DS5, D5\_v2, DS5\_v2, D16\_v3 * F16, F16s   **ASA 9.13 and later**   * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You can deploy the ASA   Virtual on a wide variety of Microsoft Azure instances types   such as.    + DS3, DS3\_v2, D4, D4\_v2, DS4, DS4\_v2, D8\_v3   + F4, F4s, F8, F8s * ASAv50 support added.   **ASA 9.12 and earlier**  Microsoft Azure supports the ASAv5, ASAv10, and ASAv30 models on the following instance types:   * Standard D3 instance * Standard D3\_v2 instance  | **Note** | The ASAv100 is not supported on Microsoft Azure. | | --- | --- | | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6(2), 9.6(3), 9.6(4)  ASA 9.5(2.200), 9.5(3) |
| Google Cloud Platform (GCP) | Google Cloud Platform (GCP) supports the ASA Virtual on the following GCP machine types:   * c2-standard-4 (ASAv5, ASAv10, and ASAv30) * c2-standard-8 (ASAv50) * c2-standard-16 (ASAv100) | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15 |
| OpenStack | OpenStack supports the ASA Virtual:   * Enabling OpenStack platform support for ASA   Virtual allows you to run ASA   Virtual on open source cloud platforms. * OpenStack uses a KVM hypervisor to manage virtual   resources. * ASA   Virtual devices are already supported on the KVM hypervisor.   Therefore, there is no extra addition of kernel packages   or drivers to enable OpenStack support. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16 |
| Oracle Cloud Infrastructure (OCI) | Oracle Cloud Infrastructure (OCI) supports the ASA Virtual on the following OCI shape types:   * VM.Standard2.4 (ASAv5, ASAv10, and ASAv30) * VM.Standard2.8 (ASAv50 and ASAv100) | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15 |
| VMware vSphere | 8.0:   * ESXi Server * (Optional) vCenter Server * vSphere Web Client, vSphere Client, or OVFTool for Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- | | ASA 9.22  ASA 9.20 |
| 7.0:   * ESXi Server * (Optional) vCenter Server * vSphere Web Client, vSphere Client, or OVFTool for Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- | | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16 |
| 6.0, 6.5, 6.7:   * ESXi Server * (Optional) vCenter Server * vSphere Web Client, vSphere Client, or OVFTool for   Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- |   **ASA 9.14**   * ASAv100 support added.   **ASA 9.13 and later**   * ASAv Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You have greater   flexibility when you deploy the ASA   Virtual in a VMware private cloud environment.   **ASA 9.8**   * ASAv50 support added. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14 (ASAv100 support added)  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8 (ASAv50 support added)  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4  ASA 9.3  ASA 9.2 |
| 5.x:   * ESXi Server * vCenter Server * vSphere Web Client or vSphere Client for Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot install the ASA Virtual directly on an ESXi host without using vCenter. | | --- | --- |  | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- | | ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4(1.200), 9.4(2), 9.4(3), 9.4(4) |
| * You can now install the ASA   Virtual directly on an ESXi host without using vCenter. * OVFTool support | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14 (ASAv100 support added)  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8 (ASAv50 support added)  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4(1.200), 9.4(2), 9.4(3), 9.4(4) |
| Microsoft Hyper-V | The Microsoft Hyper-V hypervisor supports the ASAv5, ASAv10, and ASAv30 models.   | **Note** | The ASAv50 and ASAv100 are not supported on Microsoft Hyper-V. | | --- | --- |   **ASA 9.13 and later**   * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You have greater   flexibility when you deploy the ASA   Virtual in a Microsoft Hyper-V private cloud environment. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5(1.200), 9.5(2), 9.5(3) |

## Cisco Defense Orchestrator (CDO) Compatibility with the ASA

CDO can manage all platforms running ASA 8.4 and later (see [ASA and ASDM Compatibility Per Model](#id_65776)), except for the ASA Services Module (ASASM), which is not
supported by CDO.

CDO can onboard an ASA running ASA 8.3 but cannot deploy changes to it or manage it
in any other way. Support is "read-only."

CDO does not support management of the ASA FirePOWER module, which runs a different
operating system from ASA. You can still use the ASA FirePOWER module in your
system, but you need to manage it separately with Firepower Management Center or
ASDM.

There may be a CDO feature that does not support all versions of ASA, such as ASA
upgrades from pre-9.12 versions. In those cases, the CDO documentation will list any
version exceptions with the prerequisites for that feature.

## ASA REST API Compatibility

This section lists ASA REST API and ASA compatibility.

| **Note** | ---   The REST API is not supported on newer hardware models and is no longer being developed. We recommend that you instead use the ASA HTTP interface for automation. See [Cisco Secure Firewall ASA HTTP Interface for Automation](https://www.cisco.com/c/en/us/td/docs/security/asa/misc/http-interface/asa-http-interface.html).   --- |
| --- | --- |

The ASA REST API is supported only on the following models starting with 9.3(2) and
ending with 9.16:

* ASA
  Virtual
* Firepower 9300
* ISA 3000
* Firepower 4110, 4120, 4140, 4150
* ASA 5585-X
* ASA 5525-X, 5545-X, 5555-X
* ASA 5512-X, 5515-X
* ASA 5506-X, 5506H-X, 5506W-X, 5508-X, 5516-X

  | **Note** | ---   The ASA 5506-X series does not support the REST API if you are running the FirePOWER module Version 6.0 or later. Disable the ASA REST API using the **no rest-api agent** command.   --- |
  | --- | --- |

## Secure Firewall 3100 Network Module Compatibility

Table 10. Secure Firewall 3100 Network Module Compatibility

| Modules Supported | Model | ASA OS |
| --- | --- | --- |
| 2-port 100-Gb QSFP+ network module (FPR3K-XNM-2X100G) | * Secure Firewall 3130 * Secure Firewall 3140 | 9.20(2) and later |
| * 6-port 1G SFP Hardware Bypass Network Module, SX   (multimode) (FPR3K-XNM-6X1SXF) * 6-port 10G SFP Hardware Bypass Network Module, SR   (multimode) (FPR3K-XNM-6X10SRF) * 6-port 10G SFP Hardware Bypass Network Module, LR (single   mode) (FPR3K-XNM-6X10LRF) * 8-port 1G Copper Hardware Bypass Network Module, RJ45   (copper) (FPR3K-XNM-8X1GF) | * Secure Firewall 3110 * Secure Firewall 3120 * Secure Firewall 3130 * Secure Firewall 3140 | 9.18(2) and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |
| * 6-port 25G SFP Hardware Bypass Network Module, SR   (multimode) (FPR3K-XNM-6X25SRF) * 6-port 25G Hardware Bypass Network Module, LR (single   mode) (FPR3K-XNM-6X25LRF) | * Secure Firewall 3130 * Secure Firewall 3140 | 9.18(2) and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |
| * 8-port 1-Gb copper hardware bypass network module, RJ45   copper (FPR3K-XNM-8X1GF) * 8-port 1/10-Gb SFP+ network module (FPR3K-XNM-8X10G) * 8-port 1/10/25-Gb ZSFP network module   (FPR3K-XNM-8X25G) | * Secure Firewall 3110 * Secure Firewall 3120 * Secure Firewall 3130 * Secure Firewall 3140 | 9.17 and later |
| 4-port 40-Gb QSFP+ network module (FPR3K-XNM-4X40G) | * Secure Firewall 3130 * Secure Firewall 3140 | 9.17 and later |

## Secure Firewall 4200 Network Module Compatibility

Table 11. Secure Firewall 4200 Network Module Compatibility

| Modules Supported | Model | ASA OS |
| --- | --- | --- |
| 4-port 200G QSFP+ network module (FPR4K-XNM-4X200G) | * Secure Firewall 4215 * Secure Firewall 4225 * Secure Firewall 4245 | 9.20 and later |
| * 8-port 1/10-Gb SFP+ network module (FPR4K-XNM-8X10G) * 8-port 1/10/25-Gb ZSFP network module   (FPR4K-XNM-8X25G) * 4-port 40-Gb QSFP+ network module (FPR4K-XNM-4X40G) * 2-port 100-Gb QSFP+ network module (FPR4K-XNM-2X100G)  * 6-port 1G SFP Hardware Bypass Network Module, SX   (multimode) (FPR4K-XNM-6X1SXF) * 8-port 1-Gb copper hardware bypass network module, RJ45   copper (FPR4K-XNM-8X1GF) * 6-port 10G SFP Hardware Bypass Network Module, SR   (multimode) (FPR4K-XNM-6X10SRF) * 6-port 10G SFP Hardware Bypass Network Module, LR (single   mode) (FPR4K-XNM-6X10LRF) * 6-port 25G SFP Hardware Bypass Network Module, SR   (multimode) (FPR4K-XNM-6X25SRF) * 6-port 25G Hardware Bypass Network Module, LR (single   mode) (FPR4K-XNM-6X25LRF) | * Secure Firewall 4215 * Secure Firewall 4225 * Secure Firewall 4245 | 9.20 and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |

## Firepower 2100 Network Module Compatibility

| **Note** | ---   If a network module is listed for multiple Firepower models, and the part number only differs in the model number (FPR*X*K-NM-*module*), then that module is compatible with the other Firepower models. For example, the FPR9K-NM-6X10SR-F module is compatible on the Firepower 2100 (FPR2K-NM-6X10SR-F) and Firepower 4100 (FPR4K-NM-6X10SR-F). See the [FXOS compatibility guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/compatibility/fxos-compatibility.html) for information about Firepower 4100 and 9300 network modules.   --- |
| --- | --- |

Table 12. Firepower 2100 Network Module Compatibility

| Modules Supported | Model | ASA OS |
| --- | --- | --- |
| * Firepower 6-port 1G SX FTW Network Module single-wide (FPR2K-NM-6X1SX-F) * Firepower 6-port 10G SR FTW Network Module single-wide (FPR2K-NM-6X10SR-F) * Firepower 6-port 10G LR FTW Network Module single-wide (FPR2K-NM-6X10LR-F) | Firepower 2130  Firepower 2140 | ASA 9.10 and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |
| Firepower 8-port 1G Network Module single-wide (FPR2K-NM-8X1G) | Firepower 2130  Firepower 2140 | ASA 9.10 and later |
| Firepower 8-port 10G Network Module single-wide (FPR2K-NM-8X10G) | Firepower 2130  Firepower 2140 | ASA 9.9 and later  ASA 9.8(2), 9.8(3) |

## ASA and Threat Defense Clustering External Hardware Support

Clustering will work with both Cisco and non-Cisco switches from other major
switching vendors with no known interoperability issues if they comply with the
following requirements and recommendations. Clustering is compatible with
technologies such as vPC (Nexus), VSS (Catalyst), and StackWise & StackWise
Virtual (Catalyst).

### Switch Requirements

* All third party switches must be compliant to the IEEE standard (802.3ad) Link Aggregation Control Protocol.
* EtherChannel bundling must be completed within 45 seconds when connected to Firepower devices and 33 seconds when connected
  to ASA devices.
* On the cluster control link, the switch must provide fully unimpeded unicast and broadcast connectivity at Layer 2 between
  all cluster members.
* On the cluster control link, the switch must not impose any limitations on IP addressing or the packet format above Layer
  2 headers.
* On the cluster control link, the switch interfaces must support jumbo frames and be configurable for an MTU above 1600.

### Switch Recommendations

* The switch should provide uniform traffic distribution over the EtherChannel's individual links.
* The switch should have an EtherChannel load-balancing algorithm that provides traffic symmetry.
* The EtherChannel load balance hash algorithm should be configurable using the 5-tuple, 4-tuple, or 2-tuple to calculate the
  hash.

| **Note** | ---   For the Firepower 9300 cluster, intra-chassis clustering can operate with any switch because Firepower 9300-to-switch connections use standard interface types.   --- |
| --- | --- |

| **Note** | ---   Some switches, such as the Nexus series, do not support LACP rate fast when performing in-service software upgrades (ISSUs), so we do not recommend using ISSUs with clustering.   --- |
| --- | --- |

## **ASA and Cisco Application Policy Infrastructure Controller (APIC) Compatibility**

The platforms supported include:

* ASA 5525-X, 5545-X, and 5555-X (8.6(x)—9.14(x))
* ASA 5512-X, 5515-X (8.6(x)—9.12(x))
* ASA 5585-X (8.4(x)—9.12(x))
* ASAv (9.2(x) and newer)
* Firepower 4100 and 9300 (9.6(x) and newer)
* Firepower 2100 (9.8(x) and newer)

The following table lists the supported ASA device packages, ASA versions, and APIC versions.

Table 13. ASA Device Package, ASA, and APIC Compatibility

| ASA Device Package Version | Integration Model | APIC Version | ASA Version |
| --- | --- | --- | --- |
| 1.3(12.4) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*)—5.0(2\*) | 8.4(x)—9.16(x) |
| 1.3(12.3) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*)—4.1(1\*) | 8.4(x)—9.12(x) |
| 1.3(11.22) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*)—4.0(1\*) | 8.4(x)—9.10(x) |
| 1.3(10.24) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*) | 8.4(x)—9.8(x) |
| 1.2(12.3) | Policy Orchestration  Fabric Insertion | 3.0(2\*) and older | 8.4(x)—9.16(x) |
| 1.2(12.2) | Policy Orchestration  Fabric Insertion | 3.0(2\*) and older | 8.4(x)—9.12(x) |
| 1.2(11.16) | Policy Orchestration  Fabric Insertion | 3.0(2\*) and older | 8.4(x)—9.10(1) |
| 1.2(10.26) | Policy Orchestration  Fabric Insertion | 3.0(2\*) | 8.4(x)—9.8(x) |
| 1.2(9.18) | Policy Orchestration  Fabric Insertion | 3.0(1\*) | 8.4(x)—9.8(x) |
| 1.2(8.9) | Policy Orchestration  Fabric Insertion | 2.2(2\*) | 8.4(x)—9.7(x) |
| 1.2(7.x) | Policy Orchestration  Fabric Insertion | 2.1(1\*) | 8.4(x)—9.6(2) |
| 1.2(6.15) | Policy Orchestration | 2.0(1\*) | 8.4(x)—9.5(2) |
| 1.2(5.21) | Policy Orchestration | 1.3(1\*) | 8.4(x)—9.5(1) |
| 1.2(5.5) | Policy Orchestration | 1.2(2\*) | 8.4(x)—9.4(x) |

| **Note** | ---   We do not recommend using any ASA device package older than 2016.   --- |
| --- | --- |

| **Note** | ---   Policy Orchestration = Service Policy Mode = Fully Managed Mode.   --- |
| --- | --- |

| **Note** | ---   Fabric Insertion = Customized ASA device package for L2-3 automation only.   --- |
| --- | --- |

## End-of-Life Announcements

For a list of all Cisco End-of-Life platforms, see [End-of-Sale and End-of-Life Products](https://www.cisco.com/c/en/us/products/eos-eol-listing.html).

See the following pages for ASA software and hardware End-of-Life announcements:

* Software—<https://www.cisco.com/c/en/us/products/security/asa-firepower-services/eos-eol-notice-listing.html>
* Hardware—<https://www.cisco.com/c/en/us/products/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-listing.html>

## Additional Resources

See the following additional resources:

* [Cisco’s Next Generation Firewall Product Line Software
  Release and Sustaining Bulletin](https://www.cisco.com/c/en/us/products/collateral/security/firewalls/bulletin-c25-743178.html)

Copyright © 2023, Cisco Systems, Inc. All rights reserved.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [3000 Series Industrial Security Appliances (ISA)](/c/en/us/support/security/industrial-security-appliance-isa/series.html)
* [ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [ASA 5500-X with FirePOWER Services](/c/en/us/support/security/asa-firepower-services/series.html)
* [Firepower 1000 Series](/c/en/us/support/security/firepower-1000-series/series.html)
* [Firepower 2100 Series](/c/en/us/support/security/firepower-2100-series/series.html)
* [Firepower 4100 Series](/c/en/us/support/security/firepower-4100-series/series.html)
* [Firepower 9300 Series](/c/en/us/support/security/firepower-9000-series/series.html)
* [Secure Firewall 1200 Series](/c/en/us/support/security/secure-firewall-1200-series/series.html)
* [Secure Firewall 3100 Series](/c/en/us/support/security/secure-firewall-3100-series/series.html)
* [Secure Firewall 4200 Series](/c/en/us/support/security/secure-firewall-4200-series/series.html)
* [Secure Firewall ASA](/c/en/us/support/security/adaptive-security-appliance-asa-software/series.html)
* [Secure Firewall ASA Virtual](/c/en/us/support/security/virtual-adaptive-security-appliance-firewall/series.html)
* [Secure Firewall ASDM](/c/en/us/support/security/adaptive-security-device-manager/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_bdbfd685_20250115_193151.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco Firepower Threat Defense Software Snort 3 Detection Engine Denial of Service Vulnerability Medium   Advisory ID:  cisco-sa-ftd-snort3-uAnUntcV  First Published: 2023 November 1 16:00 GMT  Version 1.0:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [Yes](#workarounds)   Cisco Bug IDs: [CSCwc59953](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc59953)     CVE-2023-20070     CWE-244       CVSS Score: [Base 4.0](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L/E:X/RL:X/RC:X       CVE-2023-20070     CWE-244       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-uAnUntcV/csaf/cisco-sa-ftd-snort3-uAnUntcV.json)   Email      Summary  * A vulnerability in the TLS 1.3 implementation of the Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to cause the Snort 3 detection engine to unexpectedly restart.  This vulnerability is due to a logic error in how memory allocations are handled during a TLS 1.3 session. Under specific, time-based constraints, an attacker could exploit this vulnerability by sending a crafted TLS 1.3 message sequence through an affected device. A successful exploit could allow the attacker to cause the Snort 3 detection engine to reload, resulting in a denial of service (DoS) condition. While the Snort detection engine reloads, packets going through the FTD device that are sent to the Snort detection engine will be dropped. The Snort detection engine will restart automatically. No manual intervention is required.  Cisco has released software updates that address this vulnerability. There are workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-uAnUntcV>  This advisory is part of the November 2023 release of the Cisco ASA, FTD, and FMC Security Advisory Bundled publication. For a complete list of the advisories and links to them, see [Cisco Event Response: November 2023 Semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985).  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected devices that were running a vulnerable release of Cisco FTD Software and for which both of the following conditions were true:    + The device was running Snort 3.   + The device was using an SSL policy with TLS 1.3 decryption enabled. For information about which Cisco software releases are vulnerable, see the [Fixed Software](#fs) section of this advisory. Determine Cisco FTD Software Snort Configuration To determine if Snort 3 is running on Cisco FTD Software, see [Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD)](https://www.cisco.com/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html). Snort 3 has to be active for this vulnerability to be exploited. Determine Cisco FTD Software SSL Policy Configuration SSL decryption policies are not configured by default.  **Determine Cisco FTD Software SSL Policy Configuration Using the FTD Software CLI**  To determine whether an SSL policy is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the **show ssl-policy-config** command.  If the command output shows **SSL policy not yet applied**, the device is not affected by this vulnerability, as shown in the following example:  ```   >show ssl-policy-configSSL policy not yet applied   ```  If the command output shows a policy, the device has an SSL policy applied and could be affected by this vulnerability if TLS 1.3 decryption is enabled, as shown in the following example:  ```   > show ssl-policy-config===================[ CSCwc59953 ]====================================[ Default Action ]=================Default Action            : Do Not Decrypt...   ```  **Determine Cisco FTD Software SSL Policy Configuration for Devices that Are Managed by Cisco Firepower Device Manager Software**  To determine whether an SSL policy is configured on a device that is managed by Cisco Firepower Device Manager (FDM) Software, complete the following steps:    1. Log in to the Cisco FTD Software web interface.   2. From the main menu, choose **Policies**.   3. Choose the **SSL Decryption** tab.   + If SSL decryption is not enabled, the device is not affected by this vulnerability.   + If a **Policy Name** is listed, the device could be affected by this vulnerability if TLS 1.3 Decryption is enabled. For detailed information about SSL decryption policies, see the [SSL Decryption](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html) chapter of the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager*.  **Determine Cisco FTD Software SSL Policy Configuration for Devices that Are Managed by Cisco Firepower Management Center Software**  To determine whether an SSL policy is configured on a device that is managed by Cisco Firepower Management Center (FMC) Software, complete the following steps:    1. Log in to the Cisco FMC Software web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Choose the appropriate Access Control Policy.   4. Click the **Edit** pencil icon.   5. Look in the **SSL Policy** area.      + If **None** is listed, the device is not affected by this vulnerability.      + If a **Policy Name** is listed, the device could be affected by this vulnerability if TLS 1.3 Decryption is enabled. For detailed information about SSL decryption policies, see the [SSL Policy](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html) chapter of the *Cisco Secure Firewall Management Center Configuration Guide*.  **Determine Cisco FTD Software SSL Policy Configuration for Devices that Are Managed by Cisco Defense Orchestrator**  To determine whether an SSL policy is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the Cisco Defense Orchestrator **Policies** menu, choose the **FTD Policies**.   3. From the FTD **Policies** menu, choose **Access Control.**   4. Choose the appropriate Access Control Policy.   5. Click the **Edit** pencil icon.   6. Look in the **Decryption Policy** area.   + If **None** is listed, the device is not affected by this vulnerability.   + If a **Policy Name** is listed, the device could be affected by this vulnerability if TLS 1.3 Decryption is enabled. For detailed information about Cisco Defense Orchestrator managed devices, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html)  For detailed information about SSL decryption policies for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the [Decryption Policies](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.html) chapter of *Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Defense Orchestrator*.  For detailed information about SSL decryption policies for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the [SSL Decryption Policy](https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD_SSL_Decryption_Policy) section of the *Managing FDM Devices with Cisco Defense Orchestrator* guide. Determine Cisco FTD Software TLS 1.3 Decryption Configuration The default setting for TLS 1.3 decryption varies by platform when an SSL policy is configured. Note that TLS 1.3 decryption for Cisco FDM controlled devices is not offered until Cisco FTD Release 7.3.0. TLS 1.3 decryption is offered in Cisco FTD Release 7.2.0 for devices that are managed by Cisco FMC and Cisco Defense Orchestrator.  These are the default settings for the platforms:    + TLS 1.3 decryption is not enabled by default for devices managed by Cisco FDM Software.   + TLS 1.3 decryption is not enabled by default for devices managed by Cisco FMC Software.   + TLS 1.3 decryption is enabled by default for devices managed by Cisco Discovery Orchestrator Software. **Determine Cisco FTD Software TLS 1.3 Decryption Configuration Using the FTD Software CLI**  To determine from the CLI whether TLS 1.3 decryption is configured on a device, log in to the Cisco FTD Software CLI and use the **grep tls13 /ngfw/var/sf/detection\_engines/\*/ssl/ssl.rules**command.    + If the output of the command shows **"tls13\_decryption" "false"**, the device is not affected by this vulnerability.   + If the output of the command shows nothing, the device is not affected by this vulnerability.   + If the output of command shows **"tls13\_decryption" "true"**, the device has an SSL policy applied and could be affected by this vulnerability if TLS 1.3 Decryption is enabled, as shown in the following example: ```   > expertadmin@ftd:~$admin@ftd:~$grep tls13 /ngfw/var/sf/detection_engines/*/ssl/ssl.rules                  "tls13_decryption" "true";   ```  **Determine Cisco FTD Software TLS 1.3 Decryption Configuration for Devices that Are Managed by Cisco FDM Software**  To determine whether TLS 1.3 Decryption is configured on a device that is managed by Cisco FDM Software, complete the following steps:    1. Log in to the Cisco FTD Software web interface.   2. From the main menu, choose **Policies**.   3. Choose the **SSL Decryption** tab.   4. Click the **SSL Decryption Settings** button.   5. Click on the **Advanced** tab.   + If the **TLS 1.3 Decryption** slider is not enabled, the device is not affected by this vulnerability.   + If the **TLS 1.3 TLS 1.3 Decryption** slider is enabled, the device is affected by this vulnerability. For detailed information about TLS 1.3 decryption, see the [Configure Advanced and Undecryptable Traffic Settings](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06) section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.  **Determine Cisco FTD Software TLS 1.3 Decryption Configuration for Devices that Are Managed by Cisco FMC Software**  To determine whether TLS 1.3 Decryption is configured on a device that is managed by Cisco FMC Software, complete the following steps:    1. Log in to the Cisco FMC Software web interface.   2. From the **Policies** menu, choose **SSL**.   3. Choose the appropriate SSL Policy.   4. Click the **Edit** pencil icon.   5. Click the **Advanced Settings** tab.      + If the **Enable TLS 1.3 Decryption** box is not checked, the device is not affected by this vulnerability.      + If the **Enable TLS 1.3 Decryption** box is checked, the device is affected by this vulnerability. For detailed information about TLS 1.3 decryption, see the [SSL Policy Advanced Options](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8) section in the Cisco Secure Firewall Management Center Configuration Guide.  **Determine Cisco FTD Software TLS 1.3 Decryption Configuration for Devices that Are Managed by Cisco Defense Orchestrator Software**  To determine whether TLS 1.3 Decryption is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the Cisco Defense Orchestrator **Policies** menu, choose **FTD Policies.**   3. From the FTD **Policies** menu, choose **Decryption**.   4. Choose the appropriate Decryption Policy.   5. Click the **Edit** pencil icon.   6. Click the **Advanced Settings** tab.      + If **Enable TLS 1.3 Decryption** is not enabled, the device is not affected by this vulnerability.      + If **Enable TLS 1.3 Decryption** is enabled, the device is affected by this vulnerability. For detailed information about devices that are managed by Cisco Defense Orchestrator, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html)  For detailed information about TLS 1.3 decryption, see the [Decryption Policy Advanced Options](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.html#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8) section of *Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Defense Orchestrator*.  For detailed information about TLS 1.3 decryption for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the [SSL Decryption Policy](https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD_SSL_Decryption_Policy) section of *Managing FDM Devices with Cisco Defense Orchestrator*.    Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Cisco has confirmed that this vulnerability does not affect the following products:    + Cisco Adaptive Security Appliance (ASA) Software   + Cisco FMC Software   + Open Source Snort 2   + Open Source Snort 3  Workarounds  * There are workarounds and mitigations that address this vulnerability. To remove the attack vector for this vulnerability, either of the following two options can be used. Only one of the two options needs to be applied.    + Revert to Snort 2   + Disable TLS 1.3 DecryptionReverting to Snort 2 Before downgrading, review the *Before you Begin* section in the [Switching Between Snort 2 and Snort 3](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id_120089) section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.  **Note:** Downgrading to Snort 2 will delete customer policies, NAP customizations, and Hostname redirect in active authentications. To discuss the effects of reverting on your deployment, contact the [Technical Assistance Center (TAC)](https://www.cisco.com/go/tac/).  **Reverting to Snort 2 for Cisco FTD devices managed by FDM Software**  To revert to Snort 2 on a device that is managed by Cisco FDM Software, complete the following steps:    1. Log in to the Cisco FTD Software web interface.   2. From the main menu, choose **Device**.   3. In the **Updates** area, choose **View Configuration**.   4. In the **Intrusion Rule** section, choose **Downgrade to 2.0.** After making the changes above, deploy changes to your Cisco FTD devices.  For detailed information about reverting to Snort 2, see the [Switching Between Snort 2 and Snort 3](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id_120089) section in the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager*.  **Reverting to Snort 2 for Cisco FTD devices managed by FMC Software**  To revert to Snort 2 on a device that is managed by Cisco FMC Software, complete the following steps:    1. Log in to the Cisco FMC Software web interface.   2. From the **Devices** menu, choose **Device Management**.   3. Choose the appropriate Cisco FTD device.   4. Click the **Edit** pencil icon.   5. Choose the **Device** tab.   6. In the **Inspection Engine** area, choose **Revert to Snort 2**. After making the changes above, deploy changes to your FTD devices.  For detailed information about reverting to Snort 2, see the [Snort 3 Inspection Engine](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable) chapter of the *Cisco Secure Firewall Management Center Snort 3 Configuration Guide.*  **Reverting to Snort 2 for Cisco FTD devices managed by Cisco Defense Orchestrator**  To revert to Snort 2 on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. In the navigation bar, click **Inventory.**   3. Click the **Devices** tab.   4. Click the **FTD** tab and click the device you want to revert.   5. In the **Device Actions** pane located to the right, click **Upgrade**.   6. Set the upgrade toggle to **Intrusion Prevention Engine.**   7. Click **Revert to Snort Engine 2.0.** After making the changes above, deploy changes to your Cisco FTD devices.  For detailed information about Cisco Defense Orchestrator managed devices, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html)  For detailed information about reverting to Snort 2 for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the [Snort 3 Inspection Engine](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable) chapter of the *Cisco Secure Firewall Management Center Snort 3 Configuration Guide.*  For detailed information about reverting to Snort 2 for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the [Revert From Snort 3.0 for FDM-Managed Device](https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert_From_Snort_3_for_FTD) section of the *Managing FDM Devices with Cisco Defense Orchestrator guide.* Disabling TLS 1.3 Decryption This mitigation can affect your client and server connections. When TLS 1.3 decryption is disabled, the TLS connection downgrades to TLS 1.2 while matching the decryption rule. The effects on the deployment will depend on the clients and servers that will connect through the Cisco FTD device. To discuss the effects this will have on your deployment, contact the [Technical Assistance Center (TAC)](https://www.cisco.com/go/tac/) .  **Disabling TLS 1.3 for Cisco FTD Software devices managed by FDM Software**  To disable TLS 1.3 Decryption on a device that is managed by Cisco FDM Software, complete the following steps:    1. Log in to the Cisco FTD Software web interface.   2. From the main menu, choose **Policies**.   3. Choose the **SSL Decryption** tab.   4. Click the **SSL Decryption Settings** button.   5. Click on the **Advanced** tab.   6. Disable the **TLS 1.3 Decryption** setting.   7. Click **OK.** After changing the policy above, deploy the new policy to your Cisco FTD devices.  For detailed information about TLS 1.3 decryption, see the [Configure Advanced and Undecryptable Traffic Settings](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html#Cisco_Task_in_List_GUI.dita_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06) section in the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.*  **Disabling TLS 1.3 for Cisco FTD Software devices managed by FMC Software**  To disable TLS 1.3 Decryption on a device that is managed by Cisco FMC Software, complete the following steps:    1. Log in to the Cisco FMC Software web interface.   2. From the **Policies** menu, choose **SSL**.   3. Choose the appropriate SSL Policy.   4. Click the **Edit** pencil icon.   5. Click the **Advanced Settings** tab.   6. Uncheck the **Enable TLS 1.3 Decryption** box.   7. Click **Save** to save your changes. After changing the policy above, deploy the new policy to your FTD devices.  For detailed information about TLS 1.3 decryption, see the [SSL Policy Advanced Options](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8) section in the *Cisco Secure Firewall Management Center Configuration Guide.*  **Disabling TLS 1.3 for Cisco FTD Software devices managed by Cisco Defense Orchestrator**  To disable TLS 1.3 Decryption on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the Cisco Defense Orchestrator **Policies** menu, choose **FTD Policies.**   3. From the FTD **Policies** menu, choose **Decryption**.   4. Choose the appropriate Decryption Policy.   5. Click the **Edit** pencil icon.   6. Click the **Advanced Settings** tab.   7. Disable **Enable TLS 1.3 Decryption**.   8. Click **Save**. After changing the policy above, deploy the new policy to your FTD devices.  For detailed information about devices managed by Cisco Defense Orchestrator, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html)  For detailed information about TLS 1.3 decryption, see the [Decryption Policy Advanced Options](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.html#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8) section of *Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Defense Orchestrator*.  For detailed information about TLS 1.3 decryption for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the [SSL Decryption Policy](https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD_SSL_Decryption_Policy) section of *Managing FDM Devices with Cisco Defense Orchestrator*.  While these workarounds and mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Cisco ASA, FMC, and FTD Software To help customers determine their exposure to vulnerabilities in Cisco ASA, FMC, and FTD Software, Cisco provides the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x). This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities that are described in all the advisories that the Software Checker identifies (“Combined First Fixed”).  To use the tool, go to the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x) page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:    1. Choose which advisories the tool will search-all advisories, only advisories with a Critical or High [Security Impact Rating (SIR)](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#asr), or only this advisory.   2. Choose the appropriate software.   3. Choose the appropriate platform.   4. Enter a release number-for example, **9.16.2.11** for Cisco ASA Software or **6.6.7** for Cisco FTD Software.   5. Click **Check**.  Only this advisoryAll Critical and High advisoriesAll advisoriesCisco ASA SoftwareCisco FMC SoftwareCisco FTD SoftwareAny Platform3000 Series Industrial Security Appliances (ISA)ASA 5500-X Series FirewallsASA Service ModuleAdaptive Security Virtual Appliance (ASAv)Firepower 1000 SeriesFirepower 2100 SeriesFirepower 4100 SeriesFirepower 9000 SeriesFirepower NGFW VirtualSecure Firewall 3100 SeriesFirepower Management Center Appliances    Additional Resources For help determining the best Cisco ASA, FTD, or FMC Software release, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.  [Cisco ASA Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html)[Cisco Secure Firewall ASA Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html)[Cisco Secure Firewall Threat Defense Compatibility Guide](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html)  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.  Source  * This vulnerability was found during the resolution of a Cisco TAC support case.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory  * [Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985)  URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-uAnUntcV>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.0 | Initial public release. | - | Final | 2023-NOV-01 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory  * [Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985) |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_5c35eaa5_20250115_193150.html ===
{
"document": {
"acknowledgments": [
{
"summary": "This vulnerability was found during the resolution of a Cisco TAC support case."
}
],
"category": "csaf\_security\_advisory",
"csaf\_version": "2.0",
"notes": [
{
"category": "summary",
"title": "Summary",
"text": "A vulnerability in the TLS 1.3 implementation of the Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to cause the Snort 3 detection engine to unexpectedly restart.\r\n\r\nThis vulnerability is due to a logic error in how memory allocations are handled during a TLS 1.3 session. Under specific, time-based constraints, an attacker could exploit this vulnerability by sending a crafted TLS 1.3 message sequence through an affected device. A successful exploit could allow the attacker to cause the Snort 3 detection engine to reload, resulting in a denial of service (DoS) condition. While the Snort detection engine reloads, packets going through the FTD device that are sent to the Snort detection engine will be dropped. The Snort detection engine will restart automatically. No manual intervention is required.\r\n\r\nCisco has released software updates that address this vulnerability. There are workarounds that address this vulnerability.\r\n\r\n\r\n\r\nThis advisory is part of the November 2023 release of the Cisco ASA, FTD, and FMC Security Advisory Bundled publication. For a complete list of the advisories and links to them, see Cisco Event Response: November 2023 Semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication [\"https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985\"]."
},
{
"category": "general",
"title": "Vulnerable Products",
"text": "At the time of publication, this vulnerability affected devices that were running a vulnerable release of Cisco FTD Software and for which both of the following conditions were true:\r\n\r\nThe device was running Snort 3.\r\nThe device was using an SSL policy with TLS 1.3 decryption enabled.\r\n\r\nFor information about which Cisco software releases are vulnerable, see the Fixed Software [\"#fs\"] section of this advisory.\r\n Determine Cisco FTD Software Snort Configuration\r\nTo determine if Snort 3 is running on Cisco FTD Software, see Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD) [\"https://www.cisco.com/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html\"]. Snort 3 has to be active for this vulnerability to be exploited.\r\n Determine Cisco FTD Software SSL Policy Configuration\r\nSSL decryption policies are not configured by default.\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration Using the FTD Software CLI\r\n\r\nTo determine whether an SSL policy is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the show ssl-policy-config command.\r\n\r\nIf the command output shows SSL policy not yet applied, the device is not affected by this vulnerability, as shown in the following example:\r\n\r\n\r\n>show ssl-policy-config\r\nSSL policy not yet applied\r\n\r\nIf the command output shows a policy, the device has an SSL policy applied and could be affected by this vulnerability if TLS 1.3 decryption is enabled, as shown in the following example:\r\n\r\n\r\n> show ssl-policy-config\r\n===================[ CSCwc59953 ]===================\r\n=================[ Default Action ]=================\r\nDefault Action : Do Not Decrypt\r\n...\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration for Devices that Are Managed by Cisco Firepower Device Manager Software\r\n\r\nTo determine whether an SSL policy is configured on a device that is managed by Cisco Firepower Device Manager (FDM) Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Policies.\r\nChoose the SSL Decryption tab.\r\nIf SSL decryption is not enabled, the device is not affected by this vulnerability.\r\nIf a Policy Name is listed, the device could be affected by this vulnerability if TLS 1.3 Decryption is enabled.\r\n\r\n\r\nFor detailed information about SSL decryption policies, see the SSL Decryption [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html\"] chapter of the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration for Devices that Are Managed by Cisco Firepower Management Center Software\r\n\r\nTo determine whether an SSL policy is configured on a device that is managed by Cisco Firepower Management Center (FMC) Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nLook in the SSL Policy area.\r\n\r\nIf None is listed, the device is not affected by this vulnerability.\r\nIf a Policy Name is listed, the device could be affected by this vulnerability if TLS 1.3 Decryption is enabled.\r\n\r\n\r\nFor detailed information about SSL decryption policies, see the SSL Policy [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html\"] chapter of the Cisco Secure Firewall Management Center Configuration Guide.\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration for Devices that Are Managed by Cisco Defense Orchestrator\r\n\r\nTo determine whether an SSL policy is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the Cisco Defense Orchestrator Policies menu, choose the FTD Policies.\r\nFrom the FTD Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nLook in the Decryption Policy area.\r\nIf None is listed, the device is not affected by this vulnerability.\r\nIf a Policy Name is listed, the device could be affected by this vulnerability if TLS 1.3 Decryption is enabled.\r\n\r\n\r\nFor detailed information about Cisco Defense Orchestrator managed devices, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about SSL decryption policies for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the Decryption Policies [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_decryption-policies.html\"] chapter of Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Defense Orchestrator.\r\n\r\nFor detailed information about SSL decryption policies for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the SSL Decryption Policy [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD\_SSL\_Decryption\_Policy\"] section of the Managing FDM Devices with Cisco Defense Orchestrator guide.\r\n Determine Cisco FTD Software TLS 1.3 Decryption Configuration\r\nThe default setting for TLS 1.3 decryption varies by platform when an SSL policy is configured. Note that TLS 1.3 decryption for Cisco FDM controlled devices is not offered until Cisco FTD Release 7.3.0. TLS 1.3 decryption is offered in Cisco FTD Release 7.2.0 for devices that are managed by Cisco FMC and Cisco Defense Orchestrator.\r\n\r\nThese are the default settings for the platforms:\r\n\r\nTLS 1.3 decryption is not enabled by default for devices managed by Cisco FDM Software.\r\nTLS 1.3 decryption is not enabled by default for devices managed by Cisco FMC Software.\r\nTLS 1.3 decryption is enabled by default for devices managed by Cisco Discovery Orchestrator Software.\r\n\r\nDetermine Cisco FTD Software TLS 1.3 Decryption Configuration Using the FTD Software CLI\r\n\r\nTo determine from the CLI whether TLS 1.3 decryption is configured on a device, log in to the Cisco FTD Software CLI and use the grep tls13 /ngfw/var/sf/detection\_engines/\*/ssl/ssl.rules command.\r\n\r\nIf the output of the command shows \"tls13\_decryption\" \"false\", the device is not affected by this vulnerability.\r\nIf the output of the command shows nothing, the device is not affected by this vulnerability.\r\nIf the output of command shows \"tls13\_decryption\" \"true\", the device has an SSL policy applied and could be affected by this vulnerability if TLS 1.3 Decryption is enabled, as shown in the following example:\r\n\r\n\r\n> expert\r\nadmin@ftd:~$\r\nadmin@ftd:~$grep tls13 /ngfw/var/sf/detection\_engines/\*/ssl/ssl.rules\r\n \"tls13\_decryption\" \"true\";\r\n\r\nDetermine Cisco FTD Software TLS 1.3 Decryption Configuration for Devices that Are Managed by Cisco FDM Software\r\n\r\nTo determine whether TLS 1.3 Decryption is configured on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Policies.\r\nChoose the SSL Decryption tab.\r\nClick the SSL Decryption Settings button.\r\nClick on the Advanced tab.\r\nIf the TLS 1.3 Decryption slider is not enabled, the device is not affected by this vulnerability.\r\nIf the TLS 1.3 TLS 1.3 Decryption slider is enabled, the device is affected by this vulnerability.\r\n\r\n\r\nFor detailed information about TLS 1.3 decryption, see the Configure Advanced and Undecryptable Traffic Settings [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html#Cisco\_Task\_in\_List\_GUI.dita\_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nDetermine Cisco FTD Software TLS 1.3 Decryption Configuration for Devices that Are Managed by Cisco FMC Software\r\n\r\nTo determine whether TLS 1.3 Decryption is configured on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Policies menu, choose SSL.\r\nChoose the appropriate SSL Policy.\r\nClick the Edit pencil icon.\r\nClick the Advanced Settings tab.\r\nIf the Enable TLS 1.3 Decryption box is not checked, the device is not affected by this vulnerability.\r\nIf the Enable TLS 1.3 Decryption box is checked, the device is affected by this vulnerability.\r\n\r\n\r\nFor detailed information about TLS 1.3 decryption, see the SSL Policy Advanced Options [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8\"] section in the Cisco Secure Firewall Management Center Configuration Guide.\r\n\r\nDetermine Cisco FTD Software TLS 1.3 Decryption Configuration for Devices that Are Managed by Cisco Defense Orchestrator Software\r\n\r\nTo determine whether TLS 1.3 Decryption is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the Cisco Defense Orchestrator Policies menu, choose FTD Policies.\r\nFrom the FTD Policies menu, choose Decryption.\r\nChoose the appropriate Decryption Policy.\r\nClick the Edit pencil icon.\r\nClick the Advanced Settings tab.\r\nIf Enable TLS 1.3 Decryption is not enabled, the device is not affected by this vulnerability.\r\nIf Enable TLS 1.3 Decryption is enabled, the device is affected by this vulnerability.\r\n\r\n\r\nFor detailed information about devices that are managed by Cisco Defense Orchestrator, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about TLS 1.3 decryption, see the Decryption Policy Advanced Options [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_decryption-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8\"] section of Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Defense Orchestrator.\r\n\r\nFor detailed information about TLS 1.3 decryption for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the SSL Decryption Policy [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD\_SSL\_Decryption\_Policy\"] section of Managing FDM Devices with Cisco Defense Orchestrator."
},
{
"category": "general",
"title": "Products Confirmed Not Vulnerable",
"text": "Only products listed in the Vulnerable Products [\"#vp\"] section of this advisory are known to be affected by this vulnerability.\r\n\r\nCisco has confirmed that this vulnerability does not affect the following products:\r\n\r\nCisco Adaptive Security Appliance (ASA) Software\r\nCisco FMC Software\r\nOpen Source Snort 2\r\nOpen Source Snort 3"
},
{
"category": "general",
"title": "Workarounds",
"text": "There are workarounds and mitigations that address this vulnerability. To remove the attack vector for this vulnerability, either of the following two options can be used. Only one of the two options needs to be applied.\r\n\r\nRevert to Snort 2\r\nDisable TLS 1.3 Decryption\r\n Reverting to Snort 2\r\nBefore downgrading, review the Before you Begin section in the Switching Between Snort 2 and Snort 3 [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nNote: Downgrading to Snort 2 will delete customer policies, NAP customizations, and Hostname redirect in active authentications. To discuss the effects of reverting on your deployment, contact the Technical Assistance Center (TAC) [\"https://www.cisco.com/go/tac/\"].\r\n\r\nReverting to Snort 2 for Cisco FTD devices managed by FDM Software\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Device.\r\nIn the Updates area, choose View Configuration.\r\nIn the Intrusion Rule section, choose Downgrade to 2.0.\r\n\r\nAfter making the changes above, deploy changes to your Cisco FTD devices.\r\n\r\nFor detailed information about reverting to Snort 2, see the Switching Between Snort 2 and Snort 3 [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nReverting to Snort 2 for Cisco FTD devices managed by FMC Software\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Devices menu, choose Device Management.\r\nChoose the appropriate Cisco FTD device.\r\nClick the Edit pencil icon.\r\nChoose the Device tab.\r\nIn the Inspection Engine area, choose Revert to Snort 2.\r\n\r\nAfter making the changes above, deploy changes to your FTD devices.\r\n\r\nFor detailed information about reverting to Snort 2, see the Snort 3 Inspection Engine [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable\"] chapter of the Cisco Secure Firewall Management Center Snort 3 Configuration Guide.\r\n\r\nReverting to Snort 2 for Cisco FTD devices managed by Cisco Defense Orchestrator\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nIn the navigation bar, click Inventory.\r\nClick the Devices tab.\r\nClick the FTD tab and click the device you want to revert.\r\nIn the Device Actions pane located to the right, click Upgrade.\r\nSet the upgrade toggle to Intrusion Prevention Engine.\r\nClick Revert to Snort Engine 2.0.\r\n\r\nAfter making the changes above, deploy changes to your Cisco FTD devices.\r\n\r\nFor detailed information about Cisco Defense Orchestrator managed devices, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about reverting to Snort 2 for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the Snort 3 Inspection Engine [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable\"] chapter of the Cisco Secure Firewall Management Center Snort 3 Configuration Guide.\r\n\r\nFor detailed information about reverting to Snort 2 for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the Revert From Snort 3.0 for FDM-Managed Device [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert\_From\_Snort\_3\_for\_FTD\"] section of the Managing FDM Devices with Cisco Defense Orchestrator guide.\r\n Disabling TLS 1.3 Decryption\r\nThis mitigation can affect your client and server connections. When TLS 1.3 decryption is disabled, the TLS connection downgrades to TLS 1.2 while matching the decryption rule. The effects on the deployment will depend on the clients and servers that will connect through the Cisco FTD device. To discuss the effects this will have on your deployment, contact the Technical Assistance Center (TAC) [\"https://www.cisco.com/go/tac/\"] .\r\n\r\nDisabling TLS 1.3 for Cisco FTD Software devices managed by FDM Software\r\n\r\nTo disable TLS 1.3 Decryption on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Policies.\r\nChoose the SSL Decryption tab.\r\nClick the SSL Decryption Settings button.\r\nClick on the Advanced tab.\r\nDisable the TLS 1.3 Decryption setting.\r\nClick OK.\r\n\r\nAfter changing the policy above, deploy the new policy to your Cisco FTD devices.\r\n\r\nFor detailed information about TLS 1.3 decryption, see the Configure Advanced and Undecryptable Traffic Settings [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html#Cisco\_Task\_in\_List\_GUI.dita\_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nDisabling TLS 1.3 for Cisco FTD Software devices managed by FMC Software\r\n\r\nTo disable TLS 1.3 Decryption on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Policies menu, choose SSL.\r\nChoose the appropriate SSL Policy.\r\nClick the Edit pencil icon.\r\nClick the Advanced Settings tab.\r\nUncheck the Enable TLS 1.3 Decryption box.\r\nClick Save to save your changes.\r\n\r\nAfter changing the policy above, deploy the new policy to your FTD devices.\r\n\r\nFor detailed information about TLS 1.3 decryption, see the SSL Policy Advanced Options [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8\"] section in the Cisco Secure Firewall Management Center Configuration Guide.\r\n\r\nDisabling TLS 1.3 for Cisco FTD Software devices managed by Cisco Defense Orchestrator\r\n\r\nTo disable TLS 1.3 Decryption on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the Cisco Defense Orchestrator Policies menu, choose FTD Policies.\r\nFrom the FTD Policies menu, choose Decryption.\r\nChoose the appropriate Decryption Policy.\r\nClick the Edit pencil icon.\r\nClick the Advanced Settings tab.\r\nDisable Enable TLS 1.3 Decryption.\r\nClick Save.\r\n\r\nAfter changing the policy above, deploy the new policy to your FTD devices.\r\n\r\nFor detailed information about devices managed by Cisco Defense Orchestrator, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about TLS 1.3 decryption, see the Decryption Policy Advanced Options [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_decryption-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8\"] section of Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Defense Orchestrator.\r\n\r\nFor detailed information about TLS 1.3 decryption for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the SSL Decryption Policy [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD\_SSL\_Decryption\_Policy\"] section of Managing FDM Devices with Cisco Defense Orchestrator.\r\n\r\nWhile these workarounds and mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment."
},
{
"category": "general",
"title": "Fixed Software",
"text": "When considering software upgrades [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes\"], customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories page [\"https://www.cisco.com/go/psirt\"], to determine exposure and a complete upgrade solution.\r\n\r\nIn all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.\r\nCisco ASA, FMC, and FTD Software\r\nTo help customers determine their exposure to vulnerabilities in Cisco ASA, FMC, and FTD Software, Cisco provides the Cisco Software Checker [\"https://sec.cloudapps.cisco.com/security/center/softwarechecker.x\"]. This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities that are described in all the advisories that the Software Checker identifies (“Combined First Fixed”).\r\n\r\nTo use the tool, go to the Cisco Software Checker [\"https://sec.cloudapps.cisco.com/security/center/softwarechecker.x\"] page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:\r\n\r\nChoose which advisories the tool will search—all advisories, only advisories with a Critical or High Security Impact Rating (SIR) [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#asr\"], or only this advisory.\r\nChoose the appropriate software.\r\nChoose the appropriate platform.\r\nEnter a release number—for example, 9.16.2.11 for Cisco ASA Software or 6.6.7 for Cisco FTD Software.\r\nClick Check.\r\n Only this advisoryAll Critical and High advisoriesAll advisoriesCisco ASA SoftwareCisco FMC SoftwareCisco FTD SoftwareAny Platform3000 Series Industrial Security Appliances (ISA)ASA 5500-X Series FirewallsASA Service ModuleAdaptive Security Virtual Appliance (ASAv)Firepower 1000 SeriesFirepower 2100 SeriesFirepower 4100 SeriesFirepower 9000 SeriesFirepower NGFW VirtualSecure Firewall 3100 SeriesFirepower Management Center Appliances\r\n\r\n\r\n\r\n\r\n Additional Resources\r\nFor help determining the best Cisco ASA, FTD, or FMC Software release, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.\r\n\r\nCisco ASA Compatibility [\"https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html\"]\r\nCisco Secure Firewall ASA Upgrade Guide [\"https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html\"]\r\nCisco Secure Firewall Threat Defense Compatibility Guide [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html\"]"
},
{
"category": "general",
"title": "Vulnerability Policy",
"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"http://www.cisco.com/web/about/security/psirt/security\_vulnerability\_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco."
},
{
"category": "general",
"title": "Exploitation and Public Announcements",
"text": "The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory."
},
{
"category": "general",
"title": "Source",
"text": "This vulnerability was found during the resolution of a Cisco TAC support case."
},
{
"category": "legal\_disclaimer",
"title": "Legal Disclaimer",
"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products."
}
],
"publisher": {
"category": "vendor",
"contact\_details": "psirt@cisco.com",
"issuing\_authority": "Cisco PSIRT",
"name": "Cisco",
"namespace": "https://wwww.cisco.com"
},
"references": [
{
"category": "self",
"summary": "Cisco Firepower Threat Defense Software Snort 3 Detection Engine Denial of Service Vulnerability",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-uAnUntcV"
},
{
"category": "external",
"summary": "Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication",
"url": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985"
},
{
"category": "external",
"summary": "Cisco Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
},
{
"category": "external",
"summary": "Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD)",
"url": "https://www.cisco.com/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html"
},
{
"category": "external",
"summary": "SSL Decryption",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html"
},
{
"category": "external",
"summary": "SSL Policy",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html"
},
{
"category": "external",
"summary": "Cisco Defense Orchestrator documentation.",
"url": "https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html"
},
{
"category": "external",
"summary": "Decryption Policies",
"url": "https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_decryption-policies.html"
},
{
"category": "external",
"summary": "SSL Decryption Policy",
"url": "https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD\_SSL\_Decryption\_Policy"
},
{
"category": "external",
"summary": "Configure Advanced and Undecryptable Traffic Settings",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html#Cisco\_Task\_in\_List\_GUI.dita\_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06"
},
{
"category": "external",
"summary": "SSL Policy Advanced Options",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8"
},
{
"category": "external",
"summary": "Decryption Policy Advanced Options",
"url": "https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_decryption-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8"
},
{
"category": "external",
"summary": "Switching Between Snort 2 and Snort 3",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089"
},
{
"category": "external",
"summary": " Technical Assistance Center (TAC)",
"url": "https://www.cisco.com/go/tac/"
},
{
"category": "external",
"summary": "Snort 3 Inspection Engine",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable"
},
{
"category": "external",
"summary": "Revert From Snort 3.0 for FDM-Managed Device",
"url": "https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert\_From\_Snort\_3\_for\_FTD"
},
{
"category": "external",
"summary": "considering software upgrades",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes"
},
{
"category": "external",
"summary": "Cisco Security Advisories page",
"url": "https://www.cisco.com/go/psirt"
},
{
"category": "external",
"summary": "Cisco Software Checker",
"url": "https://sec.cloudapps.cisco.com/security/center/softwarechecker.x"
},
{
"category": "external",
"summary": "Security Impact Rating (SIR)",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#asr"
},
{
"category": "external",
"summary": "Cisco ASA Compatibility",
"url": "https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html"
},
{
"category": "external",
"summary": "Cisco Secure Firewall ASA Upgrade Guide",
"url": "https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html"
},
{
"category": "external",
"summary": "Cisco Secure Firewall Threat Defense Compatibility Guide",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html"
},
{
"category": "external",
"summary": "Security Vulnerability Policy",
"url": "http://www.cisco.com/web/about/security/psirt/security\_vulnerability\_policy.html"
}
],
"title": "Cisco Firepower Threat Defense Software Snort 3 Detection Engine Denial of Service Vulnerability",
"tracking": {
"current\_release\_date": "2023-11-01T16:00:00+00:00",
"generator": {
"date": "2024-05-10T23:28:08+00:00",
"engine": {
"name": "TVCE"
}
},
"id": "cisco-sa-ftd-snort3-uAnUntcV",
"initial\_release\_date": "2023-11-01T16:00:00+00:00",
"revision\_history": [
{
"date": "2023-11-01T16:00:05+00:00",
"number": "1.0.0",
"summary": "Initial public release."
}
],
"status": "final",
"version": "1.0.0"
}
},
"product\_tree": {
"branches": [
{
"name": "Cisco",
"category": "vendor",
"branches": [
{
"name": "Cisco Firepower Threat Defense Software",
"category": "product\_family",
"branches": [
{
"name": "7.2",
"category": "product\_version",
"branches": [
{
"name": "7.2.0",
"category": "service\_pack",
"product": {
"name": "7.2.0",
"product\_id": "CSAFPID-287081"
}
},
{
"name": "7.2.0.1",
"category": "service\_pack",
"product": {
"name": "7.2.0.1",
"product\_id": "CSAFPID-290469"
}
}
]
}
]
},
{
"name": "Cisco Firepower 2100 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-277392"
}
},
{
"name": "Cisco Firepower 1000 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-277393"
}
},
{
"name": "Cisco 3000 Series Industrial Security Appliances (ISA)",
"category": "product\_name",
"product": {
"name": "Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-277438"
}
},
{
"name": "Cisco Firepower 9000 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-277440"
}
},
{
"name": "Cisco Firepower 4100 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-277441"
}
},
{
"name": "Cisco Secure Firewall Threat Defense Virtual",
"category": "product\_name",
"product": {
"name": "Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-277464"
}
},
{
"name": "Cisco Secure Firewall 3100 Series",
"category": "product\_name",
"product": {
"name": "Cisco Secure Firewall 3100 Series",
"product\_id": "CSAFPID-286865"
}
}
]
}
],
"relationships": [
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-287081:277392"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-287081:277393"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-287081:277438"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-287081:277440"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-287081:277441"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-287081:277464"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Secure Firewall 3100 Series",
"product\_id": "CSAFPID-287081:286865"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-286865"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-290469:277392"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-290469:277393"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-290469:277438"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-290469:277440"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-290469:277441"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-290469:277464"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Secure Firewall 3100 Series",
"product\_id": "CSAFPID-290469:286865"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-286865"
}
]
},
"vulnerabilities": [
{
"cve": "CVE-2023-20070",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCwc59953"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865"
]
},
"release\_date": "2023-11-01T16:00:00+00:00",
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865"
],
"url": "https://software.cisco.com"
},
{
"category": "workaround",
"details": "There are workarounds and mitigations that address this vulnerability. To remove the attack vector for this vulnerability, either of the following two options can be used. Only one of the two options needs to be applied.\r\n\r\nRevert to Snort 2\r\nDisable TLS 1.3 Decryption\r\n Reverting to Snort 2\r\nBefore downgrading, review the Before you Begin section in the Switching Between Snort 2 and Snort 3 [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nNote: Downgrading to Snort 2 will delete customer policies, NAP customizations, and Hostname redirect in active authentications. To discuss the effects of reverting on your deployment, contact the Technical Assistance Center (TAC) [\"https://www.cisco.com/go/tac/\"].\r\n\r\nReverting to Snort 2 for Cisco FTD devices managed by FDM Software\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Device.\r\nIn the Updates area, choose View Configuration.\r\nIn the Intrusion Rule section, choose Downgrade to 2.0.\r\n\r\nAfter making the changes above, deploy changes to your Cisco FTD devices.\r\n\r\nFor detailed information about reverting to Snort 2, see the Switching Between Snort 2 and Snort 3 [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nReverting to Snort 2 for Cisco FTD devices managed by FMC Software\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Devices menu, choose Device Management.\r\nChoose the appropriate Cisco FTD device.\r\nClick the Edit pencil icon.\r\nChoose the Device tab.\r\nIn the Inspection Engine area, choose Revert to Snort 2.\r\n\r\nAfter making the changes above, deploy changes to your FTD devices.\r\n\r\nFor detailed information about reverting to Snort 2, see the Snort 3 Inspection Engine [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable\"] chapter of the Cisco Secure Firewall Management Center Snort 3 Configuration Guide.\r\n\r\nReverting to Snort 2 for Cisco FTD devices managed by Cisco Defense Orchestrator\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nIn the navigation bar, click Inventory.\r\nClick the Devices tab.\r\nClick the FTD tab and click the device you want to revert.\r\nIn the Device Actions pane located to the right, click Upgrade.\r\nSet the upgrade toggle to Intrusion Prevention Engine.\r\nClick Revert to Snort Engine 2.0.\r\n\r\nAfter making the changes above, deploy changes to your Cisco FTD devices.\r\n\r\nFor detailed information about Cisco Defense Orchestrator managed devices, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about reverting to Snort 2 for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the Snort 3 Inspection Engine [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable\"] chapter of the Cisco Secure Firewall Management Center Snort 3 Configuration Guide.\r\n\r\nFor detailed information about reverting to Snort 2 for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the Revert From Snort 3.0 for FDM-Managed Device [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert\_From\_Snort\_3\_for\_FTD\"] section of the Managing FDM Devices with Cisco Defense Orchestrator guide.\r\n Disabling TLS 1.3 Decryption\r\nThis mitigation can affect your client and server connections. When TLS 1.3 decryption is disabled, the TLS connection downgrades to TLS 1.2 while matching the decryption rule. The effects on the deployment will depend on the clients and servers that will connect through the Cisco FTD device. To discuss the effects this will have on your deployment, contact the Technical Assistance Center (TAC) [\"https://www.cisco.com/go/tac/\"] .\r\n\r\nDisabling TLS 1.3 for Cisco FTD Software devices managed by FDM Software\r\n\r\nTo disable TLS 1.3 Decryption on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Policies.\r\nChoose the SSL Decryption tab.\r\nClick the SSL Decryption Settings button.\r\nClick on the Advanced tab.\r\nDisable the TLS 1.3 Decryption setting.\r\nClick OK.\r\n\r\nAfter changing the policy above, deploy the new policy to your Cisco FTD devices.\r\n\r\nFor detailed information about TLS 1.3 decryption, see the Configure Advanced and Undecryptable Traffic Settings [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html#Cisco\_Task\_in\_List\_GUI.dita\_5d1e9ebe-75f2-4849-a2e8-54cf31e95c06\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nDisabling TLS 1.3 for Cisco FTD Software devices managed by FMC Software\r\n\r\nTo disable TLS 1.3 Decryption on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Policies menu, choose SSL.\r\nChoose the appropriate SSL Policy.\r\nClick the Edit pencil icon.\r\nClick the Advanced Settings tab.\r\nUncheck the Enable TLS 1.3 Decryption box.\r\nClick Save to save your changes.\r\n\r\nAfter changing the policy above, deploy the new policy to your FTD devices.\r\n\r\nFor detailed information about TLS 1.3 decryption, see the SSL Policy Advanced Options [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8\"] section in the Cisco Secure Firewall Management Center Configuration Guide.\r\n\r\nDisabling TLS 1.3 for Cisco FTD Software devices managed by Cisco Defense Orchestrator\r\n\r\nTo disable TLS 1.3 Decryption on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the Cisco Defense Orchestrator Policies menu, choose FTD Policies.\r\nFrom the FTD Policies menu, choose Decryption.\r\nChoose the appropriate Decryption Policy.\r\nClick the Edit pencil icon.\r\nClick the Advanced Settings tab.\r\nDisable Enable TLS 1.3 Decryption.\r\nClick Save.\r\n\r\nAfter changing the policy above, deploy the new policy to your FTD devices.\r\n\r\nFor detailed information about devices managed by Cisco Defense Orchestrator, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about TLS 1.3 decryption, see the Decryption Policy Advanced Options [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_decryption-policies.html#Cisco\_Reference.dita\_9fb8dc41-d845-4470-8c77-2ce3910180b8\"] section of Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Defense Orchestrator.\r\n\r\nFor detailed information about TLS 1.3 decryption for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the SSL Decryption Policy [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html#FTD\_SSL\_Decryption\_Policy\"] section of Managing FDM Devices with Cisco Defense Orchestrator.\r\n\r\nWhile these workarounds and mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.",
"product\_ids": [
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865"
]
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 4.0,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L",
"version": "3.1"
},
"products": [
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865"
]
}
],
"title": "Cisco Firepower Threat Defense Software Snort 3 Detection Engine Denial of Service Vulnerability"
}
]
}

=== Content from www.cisco.com_8547858e_20250115_123426.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Device Configuration Guide, 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Getting Started with Device Configuration
  + [Device Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-device-management.html)
  + [Users](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-logical-devices.html)
  + [High Availability](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/high-availability.html)
  + [Clustering for the Secure Firewall 3100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-sec-fw-3100.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-firewall.html)
  + [Inline Sets and Passive Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000/2100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ecmp.html)
  + [OSPF](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-certs.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-monitoring.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-rules.html)
  + [URL Filtering](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-service-policies.html)
  + [Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-detection.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-content-restriction.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/network-malware-protection.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-overview.html)
  + [SSL Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html)
  + [TLS/SSL
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rules.html)
  + [TLS/SSL
    Rules and Policy Example](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rule-examples.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-realms.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-captive-portal.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-access-control.html)
  + [Getting Started with
    Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-get-start.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-adaptive-profiles.html)
* Threat Intelligence Director
  + [Secure Firewall Threat Intelligence Director](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-intelligence-director.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Device Configuration Guide, 7.2 Chapter Title SSL Policies

* [PDF - Complete Book
  (78.84 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72.pdf)
  [PDF - This Chapter (1.46 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: SSL Policies

Chapter Contents

* [SSL Policies](#ID-2253-00000004)
* [SSL Policies Overview](#concept_6696BC22D1DA4348962E4D4039215767)
* [SSL Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Requirements and Prerequisites for SSL Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create Basic SSL Policies](#ID-2253-00000099)
* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Manage SSL Policies](#ID-2253-00000021)

Close

# SSL Policies

The following topics provide an overview of SSL policy creation, configuration, management, and logging.

* [SSL Policies Overview](#concept_6696BC22D1DA4348962E4D4039215767)
* [SSL Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Requirements and Prerequisites for SSL Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create Basic SSL Policies](#ID-2253-00000099)
* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Manage SSL Policies](#ID-2253-00000021)

## SSL Policies Overview

An
SSL policy determines how the system handles encrypted traffic on your network. You can configure one or more SSL policies, associate an
SSL policy with an access control policy, then deploy the access control policy to a managed device. When the device detects a TCP handshake,
the access control policy first handles and inspects the traffic. If it subsequently identifies a TLS/SSL-encrypted session over the TCP connection, the SSL policy takes over, handling and decrypting the encrypted traffic.

| **Caution** | ---   *Snort 2 only*. Adding or removing an SSL policy restarts the Snort process when you deploy configuration changes, temporarily interrupting traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](get-started-deployment.html#concept_uc1_gtq_ty) for more information.   --- |
| --- | --- |

The simplest SSL policy, as shown in the following diagram, directs the device where it is deployed to handle encrypted traffic with a single default
action. You can set the default action to block decryptable traffic without further inspection, or to inspect undecrypted
decryptable traffic with access control. The system can then either allow or block the encrypted traffic. If the device detects
undecryptable traffic, it either blocks the traffic without further inspection or does not decrypt it, inspecting it with
access control.

![When an encrypted packet is detected by the system, first the SSL policy's undecryptable action policy is applied, followed by the policy's default action and so on](/c/dam/en/us/td/i/300001-400000/370001-380000/372001-373000/372912.jpg)

![When an encrypted packet is detected by the system, first the decryption policy's undecryptable action policy is applied, followed by the policy's default action and so on](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465003.jpg)

A more complex SSL policy can handle different types of undecryptable traffic with different actions, control traffic based on whether a certificate
authority (CA) issued or trusts the encryption certificate, and use TLS/SSL
rules to exert granular control over encrypted traffic logging and handling. These rules can be simple or complex, matching and
inspecting encrypted traffic using multiple criteria.

| **Note** | ---   Because TLS and SSL are often used interchangeably, we use the expression *TLS/SSL* to indicate that either protocol is being discussed. The SSL protocol has been deprecated by the IETF in favor of the more secure TLS protocol, so you can usually interpret *TLS/SSL* as referring to TLS only.  The exception is SSL policies. Because the management center configuration option is Policies > Access Control > SSL, we use the term *SSL policies* although these policies are used to define rules for TLS and SSL traffic.  For more information about SSL and TLS protocols, see a resource such as [SSL vs. TLS - What's the Difference?](https://www.globalsign.com/en/blog/ssl-vs-tls-difference/).   --- |
| --- | --- |

**Related Concepts**
[TLS/SSL Rule Conditions](encrypted-traffic-rules.html#ID-2254-00000164)

## SSL Policy Default Actions

The default action for an
SSL policy determines how the system handles decryptable encrypted traffic that does not match any non-monitor rule in the policy. When
you deploy an
SSL policy that does not contain any TLS/SSL
rules, the default action determines how all decryptable traffic on your network is handled. Note that the system does not perform
any kind of inspection on encrypted traffic blocked by the default action.

Table 1. SSL Policy Default Actions

| Default Action | Effect on Encrypted Traffic |
| --- | --- |
| Block | Block the TLS/SSL session without further inspection. |
| Block with reset | Block the TLS/SSL session without further inspection and reset the TCP connection. Choose this option if traffic uses a connectionless protocol like UDP. In that case, the connectionless protocol tries to reestablish the connection until it is reset.  This action also displays a connection reset error in the browser so the user is informed that the connection is blocked. |
| Do not decrypt | Inspect the encrypted traffic with access control. |

**Related Tasks**
[Create Basic SSL Policies](#ID-2253-00000099)

## Default Handling Options for Undecryptable Traffic

Table 2. Undecryptable Traffic Types

| Type | Description | Default Action | Available Action |
| --- | --- | --- | --- |
| Compressed Session | The TLS/SSL session applies a data compression method. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| SSLv2 Session | The session is encrypted with SSL version 2.  Note that traffic is decryptable if the ClientHello message is SSL 2.0, and the remainder of the transmitted traffic is SSL 3.0. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unknown Cipher Suite | The system does not recognize the cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unsupported Cipher Suite | The system does not support decryption based on the detected cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Session not cached | The TLS/SSL session has session reuse enabled, the client and server reestablished the session with the session identifier, and the system did not cache that session identifier. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Handshake Errors | An error occurred during TLS/SSL handshake negotiation. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Decryption Errors | An error occurred during traffic decryption. | Block | Block  Block with Reset |

When you first create an
SSL policy, logging connections that are handled by the default action is disabled by default. Because the logging settings for the
default action also apply to undecryptable traffic handling, logging connections handled by the undecryptable traffic actions
is disabled by default.

Note that if your browser uses certificate pinning to verify a server certificate, you cannot decrypt this traffic by re-signing
the server certificate. For more information, see [TLS/SSL Rule Guidelines and Limitations](encrypted-traffic-rules.html#id_65029).

**Related Tasks**
[Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

## SSL Policy Advanced Options

An
SSL policy 's Advanced Settings page has global settings that are applied to all managed devices that are configured for Snort 3 to which the policy is applied.

An
SSL policy advanced settings are all ignored on any managed device that runs:

* A version earlier than 7.1
* Snort 2

### Block flows requesting ESNI

Encrypted Server Name Indication (ESNI ([link to draft proposal](https://tools.ietf.org/html/draft-ietf-tls-esni))) is a way for a client to tell a TLS 1.3 server what the client is requesting. Because the SNI is encrypted, you can optionally
block these connections because the system cannot determine what the server is.

### Disable HTTP/3 advertisement

This option strips HTTP/3 ([RFC 9114](https://www.rfc-editor.org/rfc/rfc9114.html)) from the ClientHello in TCP connections. HTTP/3 is part of the QUIC transport protocol, not the TCP transport protocol.
Blocking clients from advertising HTTP/3 provides protection against attacks and evasion attempts potentially burried within
QUIC connections.

### Propagate untrusted server certificates to clients

This applies only to traffic matching a Decrypt - Resign rule action.

Enable this option to substitute the certificate authority (CA) on the managed device for the server's certificate in cases
where the server certificate is untrusted. An *untrusted* server certificate is one that is not listed as a trusted CA in the Secure Firewall Management
Center. (Objects > Object Management >  PKI >  Trusted CAs).

### Enable TLS 1.3 Decryption

Whether to apply decryption rules to TLS 1.3 connections. If you do not enable this option, the decryption rules apply to
TLS 1.2 or lower traffic only. See [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c).

## Requirements and Prerequisites for SSL Policies

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Create Basic SSL Policies

To configure an
SSL policy, you must give the policy a unique name and specify a default action.

### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Click New Policy. |
| **Step 4** | Give the policy a unique Name and, optionally, a Description. |
| **Step 5** | Specify the Default Action; see [SSL Policy Default Actions](#ID-2253-00000065). |
| **Step 6** | Configure logging options for the default actionas described in Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management Center Administration Guide](http://www.cisco.com/go/firepower-config) . |
| **Step 7** | Click Save. |

---

What To Do Next

* Set the default handling for undecryptable traffic; see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154).
* Configure logging options for default handling of undecryptable
  traffic; see Logging Connections with a Policy Default
  Action in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* Set advanced policy properties: [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the SSL policy with an access control policy as described in [Associating Other Policies with Access Control](access-policies.html#id_17609).
* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Set Default Handling for Undecryptable Traffic

You can set undecryptable traffic actions at the SSL policy level to handle certain types of encrypted traffic the system cannot decrypt or inspect. When you deploy an
SSL policy that contains no TLS/SSL
rules, the undecryptable traffic actions determine how all undecryptable encrypted traffic on your network is handled.

Depending on the type of undecryptable traffic, you can choose
to:

* Block the connection.
* Block the connection, then reset it. This option is preferrable for connectionless protocols like UDP, which keep trying to
  connect until the connection is blocked.
* Inspect the encrypted traffic with access control.
* Inherit the default action from the SSL policy.

### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Click Edit (edit icon) next to the name of the SSL policy. |
| **Step 4** | In the SSL policy editor, click Undecryptable Actions. |
| **Step 5** | For each field, choose either the SSL policy's default action or another action you want to take on the type of undecryptable traffic. See [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4) and [SSL Policy Default Actions](#ID-2253-00000065) for more information. |
| **Step 6** | Click Save to save the policy. |

---

### What to do next

* Configure default logging for connections handled by the undecryptable
  traffic actions; see Logging Connections with a Policy Default
  Action in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Manage SSL Policies

In the SSL policy editor, you can:

* Add, edit, delete, enable, disable, and organize TLS/SSL
  rules.
* Add trusted CA certificates.
* Determine the handling for encrypted traffic the system cannot decrypt.
* Log traffic that is handled by the default action and undecryptable traffic actions.
* Set advanced options.

Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the
last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing
each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor.
After 60 minutes, the system discards your changes.
### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Manage SSL policies:   * Compare—Click Compare Policies; see [Comparing policies](get-started-deployment.html#task_ABA1FE48DBBB44BC9FF40243FCC58BF6). * Copy—Click Copy  (copy icon). * Create—Click New Policy; see [Create Basic SSL Policies](#ID-2253-00000099). * Delete—Click Delete (delete icon). If the controls are dimmed, the configuration belongs to an ancestor domain, or you do not have permission to modify the   configuration. * Report—Click Report (Report icon); see [Generate Current Policy Reports](get-started-deployment.html#task_CCED983433824793AF09203FDAD1AF53). * Edit—Click Edit (edit icon). If View (View button) appears instead, the configuration belongs to an ancestor   domain, or you do not have permission to modify the   configuration. * To add trusted CA certificates to your SSL policy, see [Trusting External Certificate Authorities](encrypted-traffic-rules.html#ID-2255-00000623). * To configure how your SSL policy handles undecryptable traffic, see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154). * SSL policy advanced settings—See [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8). * Import/Export—See the section on importing and exporting the configuration in the [Secure Firewall Management Center and   Threat Defense Management Network   Administration](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/management-center-mgmt-nw/fmc-ftd-mgmt-nw.html). * To log connections for undecryptable traffic handling and traffic that does not match SSL rules, see Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config)   . * Deploy—Choose Deploy > Deployment; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B). |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_0235c3a2_20250115_123358.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Defense Orchestrator](/c/en/us/support/security/defense-orchestrator/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-orchestrator/products-installation-and-configuration-guides-list.html)
# Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Security Cloud Control

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
  + [Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-about-cloud-delivered-firewall-management-center.html)
  + [Cisco AI Assistant User Guide](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/ai-assistant-user-guide.html)
* Onboard Devices to Cloud-delivered Firewall Management Center
  + [Onboard an FTD to the Cloud-delivered Firewall Management Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/onboard-ftd-to-cdfmc.html)
  + [Migrate On-Premises Management Center Managed Secure
    Firewall Threat Defense to Cloud-delivered Firewall Management
    Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-migrate-ftd.html)
  + [Device Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-management.html)
  + [Device Management Using Device Templates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-templates.html)
  + [Device Settings](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-settings.html)
  + [Change Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-change-management.html)
  + [Users](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-deployment.html)
* System Settings
  + [System
    Configuration](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-config.html)
  + [Users](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-users.html)
  + [Updates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-updates.html)
  + [Licenses](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-licenses.html)
  + [Security Certifications Compliance](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-compliance.html)
* Optimize Firewall Performance with AIOps
  + [Introduction to AIOps Insights](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-optimize-firewall-performance-with-aiops.html)
* Health and Monitoring
  + [Health](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/health-health.html)
  + [Troubleshooting](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/health-troubleshoot.html)
* Tools
  + [Backup/Restore](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/backup-restore.html)
  + [Scheduling](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/tools-scheduling.html)
  + [Import/Export](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/tools-import-export.html)
* Reporting and Alerting
  + [External Alerting with Alert Responses](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/report-alert-responses.html)
  + [External Alerting for Intrusion Events](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/report-intrusion-events.html)
* Events and Assets
  + [Cisco Security Analytics and Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/security-analytics-and-logging.html)
  + [FTD Dashboard](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/analytics-dashboard.html)
  + [Connection
    Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/events-connection-logging.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-logical-devices.html)
  + [Multi-Instance Mode for the Secure Firewall 3100](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-multi-instance.html)
  + [High Availability](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-ha.html)
  + [Clustering for the Secure Firewall 3100/4200](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-sec-fw.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-firewall.html)
  + [About IPS Interfaces](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-ecmp.html)
  + [Bidirectional
    Forwarding Detection Routing](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_route-bfd.html)
  + [OSPF](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/objects-certs.html)
* SD-WAN
  + [SD-WAN Capabilities](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_sd-wan.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting in Security Cloud Control](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-vpn-troublehsooting.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-rules.html)
  + [Cisco Secure
    Dynamic Attributes Connector](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/cisco-secure-dynamic-attributes-connector.html)
  + [URL Filtering](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-service-policies.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-content-restriction.html)
  + [Zero Trust Access](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/zero-trust.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/network-malware-protection.html)
* Policy Tools
  + [Analyzing, Detecting, and Fixing Policy Anomalies Using Policy Analyzer and Optimizer](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-analyzing-detecting-and-fixing-policy-anomalies-using-policy-analyzer-and-optimizer.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-overview.html)
  + [Decryption Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-decrypt-policies.html)
  + [Decryption Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-decrypt-rules.html)
  + [Decryption Rules and Policy Example](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/decryption-rules-and-policy-example.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-realms.html)
  + [User Control with the Passive Identity Agent](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/passive-identity-agent.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-captive-portal.html)
  + [User Control with the pxGrid Cloud Identity Source](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/pxgrid-cloud-identity-source.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-access-control.html)
  + [Get Started with Snort 3 Network Analysis
    Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_getting_started_with_network_analysis_policies-1.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-adaptive-profiles.html)
* Reference
  + [FAQ and Support](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-faq-and-support.html)
  + [Secure Firewall Management Center Command Line Reference](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/reference-cli.html)
  + [Security, Internet
    Access, and Communication Ports](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/reference-ports.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.html) to Save Content

Available Languages

Download

Download Options

### Book Title Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Security Cloud Control Chapter Title Decryption Policies

* [PDF - Complete Book
  (96.84 MB)](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator.pdf)
  [PDF - This Chapter (1.55 MB)](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: September 21, 2023

## Chapter: Decryption Policies

Chapter Contents

* [Decryption Policies](#ID-2253-00000004)
* [About Decryption Policies](#Cisco_Concept.dita_dc5cbe07-af7b-48d5-8edb-78a1fe34591b)
* [Requirements and Prerequisites for Decryption Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create a Decryption Policy](#Cisco_Task_in_List_GUI.dita_e8211f87-a2f0-47b1-a792-f70541e85ca8)
  + [Create a Decryption Policy with Outbound Connection Protection](#Cisco_Task_in_List_GUI.dita_14c9ed19-9b2e-4734-82da-636d8488c64d)
    - [Upload an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_61c31e2c-48f3-4e6e-8e8a-3cc6a5905b1d)
    - [Generate an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_e5f30d7a-7fd1-4358-ad81-78eea166777c)
  + [Create a Decryption Policy with Inbound Connection Protection](#Cisco_Task_in_List_GUI.dita_f48db076-8088-4dd8-b542-3dd1a4b9bb57)
  + [Create a Decryption Policy with Other Rule Actions](#Cisco_Task_in_List_GUI.dita_ed1e150d-52f7-413f-b51b-bbfe0dc73562)
* [Decryption Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
  + [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
  + [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c)
* [Manage Decryption Policies](#ID-2253-00000021)

Close

# Decryption Policies

The following topics provide an overview of decryption policy creation, configuration, management, and logging.

* [About Decryption Policies](#Cisco_Concept.dita_dc5cbe07-af7b-48d5-8edb-78a1fe34591b)
* [Requirements and Prerequisites for Decryption Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create a Decryption Policy](#Cisco_Task_in_List_GUI.dita_e8211f87-a2f0-47b1-a792-f70541e85ca8)
* [Decryption Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Manage Decryption Policies](#ID-2253-00000021)

## About Decryption Policies

A
decryption policy determines how the system handles encrypted traffic on your network. You can configure one or more decryption
policies, associate a
decryption policy with an access control policy, then deploy the access control policy to a managed device. When the device detects a TCP handshake,
the access control policy first handles and inspects the traffic. If it subsequently identifies a TLS/SSL-encrypted session over the TCP connection, the decryption policy takes over, handling and decrypting the encrypted traffic.

You can create multiple rules at the same time, including rules for decrypting incoming traffic (Decrypt - Known Key rule action) and outgoing traffic (Decrypt - Resign rule action). To create a rule with a Do Not Decrypt or other rule action (such as Block or Monitor), create an empty decryption policy and add the rule afterward.

To get started, see [Create a Decryption Policy](#Cisco_Task_in_List_GUI.dita_e8211f87-a2f0-47b1-a792-f70541e85ca8).

Following is an example decryption policy with a Do Not Decrypt rule action:

![A Do Not Decrypt rule action passes the traffic through the firewall without trying to decrypt it; the access control policy then determines whether or not the traffic is inspected](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465003.jpg)

The simplest decryption policy, as shown in the following diagram, directs the device where it is deployed to handle encrypted traffic with a single default
action. You can set the default action to block decryptable traffic without further inspection, or to inspect undecrypted
decryptable traffic with access control. The system can then either allow or block the encrypted traffic. If the device detects
undecryptable traffic, it either blocks the traffic without further inspection or does not decrypt it, inspecting it with
access control.

## Requirements and Prerequisites for Decryption Policies

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Create a Decryption Policy

This topic discusses how to create a decryption policy and optionally one or more rules to protect internal or external servers.
You can also create a decryption policy without rules and add the rules later. Creating an empty policy is a good choice to
create rules with a Do Not Decrypt, Block, Block With Reset, or Monitor rule actions.

### Before you begin

Review your needs for decryption:

* Decryption is a way to expose network traffic to deep inspection; however, there are times you should *not* decrypt traffic: [When to Decrypt Traffic, When Not to Decrypt](m_encrypted-traffic-overview-2.html#id_101161).
* To protect *internal* servers by decrypting and optionally inspecting traffic, you must have the internal certificate for your internal server:
  [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).
* To protect *external* servers by decrypting and optionally inspecting traffic, you must upload an internal CA object that will be used to derypt
  ad resign the traffic: [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).

### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a name for the policy in the Name field and an optional description in the Description field.  A decryption policy can protect either outbound connections (Decrypt - Resign rule action) or inbound connectors (Decrypt - Known Key rule action)   The Outbound Connections tab page enables you to create Decrypt - Resign rules. These rules require an internal certificate that you can either create beforehand (using Objects > Object Management > PKI >  Internal CAs) or you can create them as part of the outbound connection rule.   the Inbound Connections tab page enables you to create Decrypt - Known Key rules. These rules require an internal certificate that you can either create beforehand (using Objects > Object Management > PKI >  Internal Certs) or you can create them as part of the inbound connection rule. |
| **Step 4** | Associate the decryption rule with an access control rule as discussed in [Associating Other Policies with Access Control](m_access-policies.html#id_17609). |
| **Step 5** |  |
| **Step 6** | Continue with one of the following sections. |

---

What To Do Next

* [Create a Decryption Policy with Outbound Connection Protection](#Cisco_Task_in_List_GUI.dita_14c9ed19-9b2e-4734-82da-636d8488c64d) (Decrypt - Resign)
* [Create a Decryption Policy with Inbound Connection Protection](#Cisco_Task_in_List_GUI.dita_f48db076-8088-4dd8-b542-3dd1a4b9bb57) (Decrypt - Known Key)
* [Create a Decryption Policy with Other Rule Actions](#Cisco_Task_in_List_GUI.dita_ed1e150d-52f7-413f-b51b-bbfe0dc73562)

* [Create a Decryption Policy with Outbound Connection Protection](#Cisco_Task_in_List_GUI.dita_14c9ed19-9b2e-4734-82da-636d8488c64d)
* [Create a Decryption Policy with Inbound Connection Protection](#Cisco_Task_in_List_GUI.dita_f48db076-8088-4dd8-b542-3dd1a4b9bb57)
* [Create a Decryption Policy with Other Rule Actions](#Cisco_Task_in_List_GUI.dita_ed1e150d-52f7-413f-b51b-bbfe0dc73562)

### Create a Decryption Policy with Outbound Connection Protection

This task discusses how to create a decryption policy with a rule that protects outbound connections; that is, the destination
server is outside your protected network. This type of rule has a Decrypt - Resign rule action.

When you create a decryption policy, you can create multiple rules at the same time, including multiple Decrypt - Known Key rules and multiple Decrypt - Resign rules.

**Threat Defense Feature History**:

7.4—This feature is added.

#### Before you begin

You must upload an internal certifcate authority (CA) for your outbound server before you can create a decryption policy that
protects outbound connections. You can do this in any of the following ways:

* Create an internal CA object by going to Objects > Object Management > PKI >  Internal CAs and referring to [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).
* At the time you create this decryption policy.

#### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Give the policy a unique Name and, optionally, a Description. |
| **Step 4** | Click the Outbound Connections tab. |
| **Step 5** | Upload or choose certificates for the rules.  The system creates one rule per certificate. |
| **Step 6** | (Optional.) Choose networks and ports.  For more information:   * [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164) * [Network Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab) * [Port Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_e2492043-1ba7-42e5-8aab-ca2d76816f08) |
| **Step 7** | Click Save. |

---

#### What to do next

* Add rule conditions: [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164)
* Add a default policy action: [Decryption Policy Default Actions](#ID-2253-00000065)
* Configure logging options for the default action.
* Set advanced policy properties: [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the decryption policy with an access control policy as described in [Associating Other Policies with Access Control](m_access-policies.html#id_17609).
* Deploy configuration changes.

* [Upload an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_61c31e2c-48f3-4e6e-8e8a-3cc6a5905b1d)
* [Generate an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_e5f30d7a-7fd1-4358-ad81-78eea166777c)

#### Upload an Internal CA for Outbound Protection

This task discusses how to upload an internal certificate authority when you create a decryption rule that protects outbound
connections. You can also upload the internal CA using Objects > Object Management as discussed in [Importing a CA Certificate and Private Key](m_objects-object-mgmt.html#ID-2243-00000b8b).

##### Before you begin

Make sure you have an internal certificate authority in one of the formats discussed in [Internal Certificate Authority Objects](m_objects-object-mgmt.html#ID-2243-00000b41).

##### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a name for the policy in the Name field and an optional description in the Description field. |
| **Step 4** | Click the Outbound Connections tab. |
| **Step 5** | From the Internal CA list, click Create New > Upload CA. |
| **Step 6** | Give the internal CA a Name. |
| **Step 7** | Paste or browse to locate the certificate and its private key in the provided fields. |
| **Step 8** | If the CA has a password, select the Encrypted check box and enter the password in the adjacent field. |

---

#### Generate an Internal CA for Outbound Protection

This task discusses how you can optionally generate an internal certificae authority when you create a decryption rule that
protects outbound connections. You can also perform these tasks using Objects > Object Management as discussed in [Uploading a Signed Certificate Issued in Response to a CSR](m_objects-object-mgmt.html#ID-2243-00000c32).

##### Before you begin

Make sure you understand the requirements for generating an internal certificate authority object as discussed in [Internal Certificate Authority Objects](m_objects-object-mgmt.html#ID-2243-00000b41).

##### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a name for the policy in the Name field and an optional description in the Description field. |
| **Step 4** | Click the Outbound Connections tab. |
| **Step 5** | From the Internal CA list, click Create New > Generate CA. |
| **Step 6** | Give the internal CA a Name and provide a two-letter Country Name. |
| **Step 7** | Click Self-Signed or CSR.  For more information about these options, see [Internal Certificate Authority Objects](m_objects-object-mgmt.html#ID-2243-00000b41). |
| **Step 8** | Enter the requested information in the provided fields. |
| **Step 9** | Click Save. |
| **Step 10** | If you chose CSR, after the signing request has been completed, click Install Certificate as follows:   1. Repeat the preceding steps in this procedure. 2. Edit the CA from the Internal CA list as follows. 3. Click Install Certificate. 4. Follow the prompts on your screen to complete the task. |

---

### Create a Decryption Policy with Inbound Connection Protection

This task discusses how to create a decryption policy with a rule that protects inbound connections; that is, the destination
server is inside your protected network. This type of rule has a Decrypt - Known Key rule action.

When you create a decryption policy, you can create multiple rules at the same time, including multiple Decrypt - Known Key rules and multiple Decrypt - Resign rules.

**Threat Defense Feature History**:

7.4—This feature is added.

#### Before you begin

You must upload an internal certificate for your internal server before you can create a decryption policy that protects inbound
connections. You can do this in any of the following ways:

* Create an internal certificate object by going to Objects > Object Management > PKI >  Internal Certs and referring to [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).
* At the time you create this decryption policy.

#### Procedure

---

| **Step 1** | Log in to CDO. |
| --- | --- |
| **Step 2** | Click Tools & Services >  Firewall Management Center >  Policies >  Policies >  Access Control >  Decryption. |
| **Step 3** | Click New Policy. |
| **Step 4** | Give the policy a unique Name and, optionally, a Description. |
| **Step 5** | Click the Inbound Connections tab. |
| **Step 6** | Upload or choose certificates for the rules.  The system creates one rule per certificate. |
| **Step 7** | (Optional.) Choose networks and ports.  For more information:   * [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164) * [Network Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab) * [Port Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_e2492043-1ba7-42e5-8aab-ca2d76816f08) |
| **Step 8** | Click Save. |

---

#### What to do next

* Add rule conditions: [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164)
* Add a default policy action: [Decryption Policy Default Actions](#ID-2253-00000065)
* Configure logging options for the default action .
* Set advanced policy properties: [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the decryption policy with an access control policy as described in [Associating Other Policies with Access Control](m_access-policies.html#id_17609).
* Deploy configuration changes.

### Create a Decryption Policy with Other Rule Actions

To create a decryption rule with a Do Not Decrypt, Block, Block With Reset, or Monitor rule action, create a decryption policy and edit the policy to add the rule.

When you create a decryption policy, you can create multiple rules at the same time, including multiple Decrypt - Known Key rules and multiple Decrypt - Resign rules.

#### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Give the policy a unique Name and, optionally, a Description. |
| **Step 4** | Click Edit (edit icon) next to the decryption policy name. |
| **Step 5** | Click Add Rule. |
| **Step 6** | Give the rule a Name. |
| **Step 7** | From the Action list, click a rule action and see one of the following sections for more information:   * [Decryption Rule Do Not Decrypt Action](m_decryption-rules.html#ID-2254-00000229) * [Decryption Rule Blocking Actions](m_decryption-rules.html#ID-2254-0000023e) * [Decryption Rule Monitor Action](m_decryption-rules.html#ID-2254-00000213) |
| **Step 8** | Click Save. |

---

#### What to do next

* Add rule conditions: [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164)
* Add a default policy action: [Decryption Policy Default Actions](#ID-2253-00000065)
* Configure logging options for the default action.
* Set advanced policy properties: [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the decryption policy with an access control policy as described in [Associating Other Policies with Access Control](m_access-policies.html#id_17609).
* Deploy configuration changes.

## Decryption Policy Default Actions

The default action for a
decryption policy determines how the system handles decryptable encrypted traffic that does not match any non-monitor rule in the policy. When
you deploy a
decryption policy that does not contain any decryption
rules, the default action determines how all decryptable traffic on your network is handled. Note that the system does not perform
any kind of inspection on encrypted traffic blocked by the default action.

To set the decryption policy default action:

1. Log in to the management center if you haven't already done so.
2. Click Policies > Access Control > Decryption.
3. Click Edit (![edit icon](/c/dam/en/us/td/i/400001-500000/440001-450000/442001-443000/442546.jpg)) next to the name of the decryption policy.
4. In the Default Action row, click one of the following actions from the list.

Table 1. Decryption Policy Default Actions

| Default Action | Effect on Encrypted Traffic |
| --- | --- |
| Block | Block the TLS/SSL session without further inspection. |
| Block with reset | Block the TLS/SSL session without further inspection and reset the TCP connection. Choose this option if traffic uses a connectionless protocol like UDP. In that case, the connectionless protocol tries to reestablish the connection until it is reset.  This action also displays a connection reset error in the browser so the user is informed that the connection is blocked. |
| Do not decrypt | Inspect the encrypted traffic with access control. |

**Related Tasks**
[Create Basic Decryption Policies](#ID-2253-00000099)

## Default Handling Options for Undecryptable Traffic

Table 2. Undecryptable Traffic Types

| Type | Description | Default Action | Available Action |
| --- | --- | --- | --- |
| Compressed Session | The TLS/SSL session applies a data compression method. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| SSLv2 Session | The session is encrypted with SSL version 2.  Note that traffic is decryptable if the ClientHello message is SSL 2.0, and the remainder of the transmitted traffic is SSL 3.0. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unknown Cipher Suite | The system does not recognize the cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unsupported Cipher Suite | The system does not support decryption based on the detected cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Session not cached | The TLS/SSL session has session reuse enabled, the client and server reestablished the session with the session identifier, and the system did not cache that session identifier. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Handshake Errors | An error occurred during TLS/SSL handshake negotiation. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Decryption Errors | An error occurred during traffic decryption. | Block | Block  Block with Reset |

When you first create a
decryption policy, logging connections that are handled by the default action is disabled by default. Because the logging settings for the
default action also apply to undecryptable traffic handling, logging connections handled by the undecryptable traffic actions
is disabled by default.

Note that if your browser uses certificate pinning to verify a server certificate, you cannot decrypt this traffic by re-signing
the server certificate. For more information, see [Decryption Rule Guidelines and Limitations](m_decryption-rules.html#id_65029).

* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

**Related Tasks**
[Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

### Set Default Handling for Undecryptable Traffic

You can set undecryptable traffic actions at the decryption policy level to handle certain types of encrypted traffic the system cannot decrypt or inspect. When you deploy a
decryption policy that contains no decryption
rules, the undecryptable traffic actions determine how all undecryptable encrypted traffic on your network is handled.

Depending on the type of undecryptable traffic, you can choose
to:

* Block the connection.
* Block the connection, then reset it. This option is preferrable for connectionless protocols like UDP, which keep trying to
  connect until the connection is blocked.
* Inspect the encrypted traffic with access control.
* Inherit the default action from the decryption policy.

#### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) next to the name of the decryption policy. |
| **Step 3** | In the decryption policy editor, click Undecryptable Actions. |
| **Step 4** | For each field, choose either the decryption policy's default action or another action you want to take on the type of undecryptable traffic. See [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4) and [Decryption Policy Default Actions](#ID-2253-00000065) for more information. |
| **Step 5** | Click Save to save the policy. |

---

#### What to do next

* Configure default logging for connections handled by the undecryptable
  traffic actions.
* Deploy configuration changes.

## Decryption Policy Advanced Options

A
decryption policy 's Advanced Settings tab page has global settings that are applied to all managed devices that are configured for Snort 3 to which the policy
is applied.

**Threat Defense Feature History**:

* 7.3—Enable adaptive TLS server identity probe added.
* 7.2—Enable TLS 1.3 decryption added.
* 7.2—Initial options.

A
decryption policy advanced settings are all ignored on any managed device that runs:

* A version earlier than 7.1
* Snort 2

Following is an example.

![decryption policy advanced options enable you to set version-dependent options such as enabling the TLS server identity probe](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465008.jpg)

### Block flows requesting ESNI

Encrypted Server Name Indication (ESNI ([link to draft proposal](https://tools.ietf.org/html/draft-ietf-tls-esni))) is a way for a client to tell a TLS 1.3 server what the client is requesting. Because the SNI is encrypted, you can optionally
block these connections because the system cannot determine what the server is.

### Disable HTTP/3 advertisement

This option strips HTTP/3 ([RFC 9114](https://www.rfc-editor.org/rfc/rfc9114.html)) from the ClientHello in TCP connections because:

* As stated in RFC 9114, HTTP/3 is part of the QUIC transport protocol, not the TCP transport protocol
* QUIC is not yet supported by the Firepower system
* Blocking clients from advertising HTTP/3 provides protection against attacks and evasion attempts

### Propagate untrusted server certificates to clients

This applies only to traffic matching a Decrypt - Resign rule action.

Enable this option to substitute the certificate authority (CA) on the managed device for the server's certificate in cases
where the server certificate is untrusted. An *untrusted* server certificate is one that is not listed as a trusted CA in the Secure Firewall Management
Center. (Objects > Object Management >  PKI >  Trusted CAs).

### Enable TLS 1.3 Decryption

(Snort 3 only.) Move the slider to enable Threat Defense devices managed by this Management
Center to decrypt TLS 1.3 traffic.

If the slider is moved to the disabled position, the system decrypts TLS 1.2 traffic only.

### Enable adaptive TLS server identity probe

Automatically enabled when TLS 1.3 decryption is enabled. A *probe* is a partial TLS connection with the server, the purpose of which is to obtain the server certificate and cache it. (If the
certificate is already cached, the probe is never established.)

If TLS 1.3 Server Identity Discovery is disabled on the access control policy with which the decryption policy is associated,
we attempt to use the Server Name Indication (SNI), which is not as reliable.

The adaptive TLS server identity probe occurs on any of the following conditions as opposed to on every connection as in earlier
releases:

* Certificate Issuer—Matched when the value of Issuer DNs in a decryption rule's DN rule condition is matched.

  For more information, see [Distinguished Name (DN) Rule Conditions](m_decryption-rules.html#Cisco_Reference.dita_6dbb2195-514d-49be-b5e7-367866e39eae).
* Certificate Status—Matched when any of the Cert Status conditions are matched in a decryption rule.

  For more information, see [Certificate Status Decryption Rule Conditions](m_decryption-rules.html#ID-2255-00000582).
* Internal/External Certificate—Internal certificates can be matched by the certificate used in Decrypt - Known Key rule actions; external certificates can be matched in Certificates rule conditions.

  For more information, see [Known Key Decryption (Incoming Traffic)](m_encrypted-traffic-overview-2.html#id_101162) and [Certificate Decryption Rule Conditions](m_decryption-rules.html#ID-2255-00000524).
* Application ID—Can be matched by Applications rule conditions in either an access control policy or a decryption policy.

  For more information, see [Application Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_eb009bfa-aee2-417d-8bb2-7d0f0bb2dadd).
* URL Category—Can be matched by URLs rule conditions in an access control policy.

  For more information, see [URL Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_08d17973-40f4-43f2-84a9-7d0acedf8301).

| **Note** | ---   Enable adaptive TLS server discovery mode is not supported on any Secure Firewall Threat Defense Virtual deployed to AWS. If you have any such managed devices managed by the Secure Firewall Management Center, the connection event PROBE\_FLOW\_DROP\_BYPASS\_PROXY  increments every time the device attempts to extract the server certificate.   --- |
| --- | --- |

### Related information

[TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c)

* [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c)

### TLS 1.3 Decryption Best Practices

#### Recommendation: When to enable advanced options

Both the decryption policy and the access control policy have advanced options that affect how traffic is handled, whether the traffic is being decrypted
or not.

The advanced options are:

* Decryption policy:

  + TLS 1.3 decryption
  + TLS adaptive server identity probe
* Access control policy: TLS 1.3 Server Identity Discovery

  The access control policy setting takes precedence over the decryption policy setting.

Use the following table to decide which option to enable:

| TLS adaptive server identity probe setting (decryption policy) | TLS 1.3 Server Identity Discovery setting (access control policy) | Result | Recommended when |
| --- | --- | --- | --- |
| Enabled | Disabled | Adaptive probe sent if decryption policy contains *any* rule conditions specified in [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8) *and* if the server certificate is not cached. | * You're not using application or URL conditions in access control rules * You're decrypting traffic |
| Enabled | Enabled | Probe is always sent if the server certificate is not cached. | Use only if your access control rules have URL or application conditions |
| Disabled | Enabled | Probe is always sent if the server certificate is not cached. | Not recommended. |
| Disabled | Disabled | Probe is never sent. | Very limited usefulness; use only if not decrypting traffic and not using application or URL conditions in the access control rule |

| **Note** | ---   A cached TLS server's certificate is available to all Snort instances on a particular threat defense. The cache can be cleared with a CLI command and is automatically cleared when the device is rebooted.   --- |
| --- | --- |

#### Reference

For more information, see the discussion of [TLS server identity discovery](https://secure.cisco.com/secure-firewall/v7.2/docs/ssl-policy#tls-server-identity-discovery) on secure.cisco.com.

## Manage Decryption Policies

In the decryption policy editor, you can:

* Add, edit, delete, enable, disable, and organize decryption
  rules.
* Add trusted CA certificates.
* Determine the handling for encrypted traffic the system cannot decrypt.
* Log traffic that is handled by the default action and undecryptable traffic actions.
* Set advanced options.

In a multidomain deployment, the system displays policies created in the current domain, which you can edit. It also displays
policies created in ancestor domains, which you cannot edit. To view and edit policies created in a lower domain, switch to
that domain.

Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the
last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing
each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor.
After 60 minutes, the system discards your changes.
### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Manage decryption policies:   * Compare—Click Compare Policies; see [Comparing policies](m_get-started-deployment.html#task_ABA1FE48DBBB44BC9FF40243FCC58BF6). * Copy—Click Copy  (copy icon). * Create—Click New Policy; see [Create Basic Decryption Policies](#ID-2253-00000099). * Delete—Click Delete (delete icon). If the controls are dimmed, the configuration belongs to an ancestor domain, or you do not have permission to modify the   configuration. * Report—Click Report (Report icon); see [Generating Current Policy Reports](m_get-started-deployment.html#task_CCED983433824793AF09203FDAD1AF53). * Edit—Click Edit (edit icon). If View (View button) appears instead, the configuration belongs to an ancestor   domain, or you do not have permission to modify the   configuration. * To add trusted CA certificates to your decryption policy, see [Trusting External Certificate Authorities](m_decryption-rules.html#ID-2255-00000623). * To configure how your decryption policy handles undecryptable traffic, see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154). * To log connections for undecryptable traffic handling and traffic that does not match SSL rules, see Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config). * Deploy—Choose Deploy > Deployment; see [Deploy Configuration Changes](m_get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B). |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_abe025ae_20250115_123359.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/%3Clocale%3E/support/index.html)
# My Notifications

Create custom subscriptions for Cisco products, series, or software to receive email alerts or consume RSS feeds when new announcements are released for the following notices:

* Cisco Security Advisories
* Field Notices
* End of Sale and End-of-Support Announcements
* Software Updates
* Updates to Known Bugs

[Log In to My Notifications](/c/login/index.html?referer=https://cway.cisco.com/mynotifications)![](/etc/designs/cdc/fw/i/icon_lock_small.png "Login Required")

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_0602071d_20250115_123406.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from www.cisco.com_3a04cfda_20250115_123423.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Defense Orchestrator](/c/en/us/support/security/defense-orchestrator/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-orchestrator/products-installation-and-configuration-guides-list.html)
# Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Security Cloud Control

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
  + [Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-about-cloud-delivered-firewall-management-center.html)
  + [Cisco AI Assistant User Guide](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/ai-assistant-user-guide.html)
* Onboard Devices to Cloud-delivered Firewall Management Center
  + [Onboard an FTD to the Cloud-delivered Firewall Management Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/onboard-ftd-to-cdfmc.html)
  + [Migrate On-Premises Management Center Managed Secure
    Firewall Threat Defense to Cloud-delivered Firewall Management
    Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-migrate-ftd.html)
  + [Device Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-management.html)
  + [Device Management Using Device Templates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-templates.html)
  + [Device Settings](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-settings.html)
  + [Change Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-change-management.html)
  + [Users](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-deployment.html)
* System Settings
  + [System
    Configuration](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-config.html)
  + [Users](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-users.html)
  + [Updates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-updates.html)
  + [Licenses](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-licenses.html)
  + [Security Certifications Compliance](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-compliance.html)
* Optimize Firewall Performance with AIOps
  + [Introduction to AIOps Insights](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-optimize-firewall-performance-with-aiops.html)
* Health and Monitoring
  + [Health](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/health-health.html)
  + [Troubleshooting](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/health-troubleshoot.html)
* Tools
  + [Backup/Restore](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/backup-restore.html)
  + [Scheduling](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/tools-scheduling.html)
  + [Import/Export](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/tools-import-export.html)
* Reporting and Alerting
  + [External Alerting with Alert Responses](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/report-alert-responses.html)
  + [External Alerting for Intrusion Events](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/report-intrusion-events.html)
* Events and Assets
  + [Cisco Security Analytics and Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/security-analytics-and-logging.html)
  + [FTD Dashboard](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/analytics-dashboard.html)
  + [Connection
    Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/events-connection-logging.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-logical-devices.html)
  + [Multi-Instance Mode for the Secure Firewall 3100](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-multi-instance.html)
  + [High Availability](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-ha.html)
  + [Clustering for the Secure Firewall 3100/4200](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-sec-fw.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-firewall.html)
  + [About IPS Interfaces](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-ecmp.html)
  + [Bidirectional
    Forwarding Detection Routing](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_route-bfd.html)
  + [OSPF](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/objects-certs.html)
* SD-WAN
  + [SD-WAN Capabilities](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_sd-wan.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting in Security Cloud Control](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-vpn-troublehsooting.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-rules.html)
  + [Cisco Secure
    Dynamic Attributes Connector](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/cisco-secure-dynamic-attributes-connector.html)
  + [URL Filtering](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-service-policies.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-content-restriction.html)
  + [Zero Trust Access](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/zero-trust.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/network-malware-protection.html)
* Policy Tools
  + [Analyzing, Detecting, and Fixing Policy Anomalies Using Policy Analyzer and Optimizer](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-analyzing-detecting-and-fixing-policy-anomalies-using-policy-analyzer-and-optimizer.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-overview.html)
  + [Decryption Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-decrypt-policies.html)
  + [Decryption Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-decrypt-rules.html)
  + [Decryption Rules and Policy Example](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/decryption-rules-and-policy-example.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-realms.html)
  + [User Control with the Passive Identity Agent](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/passive-identity-agent.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-captive-portal.html)
  + [User Control with the pxGrid Cloud Identity Source](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/pxgrid-cloud-identity-source.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-access-control.html)
  + [Get Started with Snort 3 Network Analysis
    Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_getting_started_with_network_analysis_policies-1.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-adaptive-profiles.html)
* Reference
  + [FAQ and Support](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-faq-and-support.html)
  + [Secure Firewall Management Center Command Line Reference](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/reference-cli.html)
  + [Security, Internet
    Access, and Communication Ports](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/reference-ports.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.html) to Save Content

Available Languages

Download

Download Options

### Book Title Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Security Cloud Control Chapter Title Decryption Policies

* [PDF - Complete Book
  (96.84 MB)](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator.pdf)
  [PDF - This Chapter (1.55 MB)](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_decryption-policies.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: September 21, 2023

## Chapter: Decryption Policies

Chapter Contents

* [Decryption Policies](#ID-2253-00000004)
* [About Decryption Policies](#Cisco_Concept.dita_dc5cbe07-af7b-48d5-8edb-78a1fe34591b)
* [Requirements and Prerequisites for Decryption Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create a Decryption Policy](#Cisco_Task_in_List_GUI.dita_e8211f87-a2f0-47b1-a792-f70541e85ca8)
  + [Create a Decryption Policy with Outbound Connection Protection](#Cisco_Task_in_List_GUI.dita_14c9ed19-9b2e-4734-82da-636d8488c64d)
    - [Upload an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_61c31e2c-48f3-4e6e-8e8a-3cc6a5905b1d)
    - [Generate an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_e5f30d7a-7fd1-4358-ad81-78eea166777c)
  + [Create a Decryption Policy with Inbound Connection Protection](#Cisco_Task_in_List_GUI.dita_f48db076-8088-4dd8-b542-3dd1a4b9bb57)
  + [Create a Decryption Policy with Other Rule Actions](#Cisco_Task_in_List_GUI.dita_ed1e150d-52f7-413f-b51b-bbfe0dc73562)
* [Decryption Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
  + [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
  + [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c)
* [Manage Decryption Policies](#ID-2253-00000021)

Close

# Decryption Policies

The following topics provide an overview of decryption policy creation, configuration, management, and logging.

* [About Decryption Policies](#Cisco_Concept.dita_dc5cbe07-af7b-48d5-8edb-78a1fe34591b)
* [Requirements and Prerequisites for Decryption Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create a Decryption Policy](#Cisco_Task_in_List_GUI.dita_e8211f87-a2f0-47b1-a792-f70541e85ca8)
* [Decryption Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Manage Decryption Policies](#ID-2253-00000021)

## About Decryption Policies

A
decryption policy determines how the system handles encrypted traffic on your network. You can configure one or more decryption
policies, associate a
decryption policy with an access control policy, then deploy the access control policy to a managed device. When the device detects a TCP handshake,
the access control policy first handles and inspects the traffic. If it subsequently identifies a TLS/SSL-encrypted session over the TCP connection, the decryption policy takes over, handling and decrypting the encrypted traffic.

You can create multiple rules at the same time, including rules for decrypting incoming traffic (Decrypt - Known Key rule action) and outgoing traffic (Decrypt - Resign rule action). To create a rule with a Do Not Decrypt or other rule action (such as Block or Monitor), create an empty decryption policy and add the rule afterward.

To get started, see [Create a Decryption Policy](#Cisco_Task_in_List_GUI.dita_e8211f87-a2f0-47b1-a792-f70541e85ca8).

Following is an example decryption policy with a Do Not Decrypt rule action:

![A Do Not Decrypt rule action passes the traffic through the firewall without trying to decrypt it; the access control policy then determines whether or not the traffic is inspected](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465003.jpg)

The simplest decryption policy, as shown in the following diagram, directs the device where it is deployed to handle encrypted traffic with a single default
action. You can set the default action to block decryptable traffic without further inspection, or to inspect undecrypted
decryptable traffic with access control. The system can then either allow or block the encrypted traffic. If the device detects
undecryptable traffic, it either blocks the traffic without further inspection or does not decrypt it, inspecting it with
access control.

## Requirements and Prerequisites for Decryption Policies

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Create a Decryption Policy

This topic discusses how to create a decryption policy and optionally one or more rules to protect internal or external servers.
You can also create a decryption policy without rules and add the rules later. Creating an empty policy is a good choice to
create rules with a Do Not Decrypt, Block, Block With Reset, or Monitor rule actions.

### Before you begin

Review your needs for decryption:

* Decryption is a way to expose network traffic to deep inspection; however, there are times you should *not* decrypt traffic: [When to Decrypt Traffic, When Not to Decrypt](m_encrypted-traffic-overview-2.html#id_101161).
* To protect *internal* servers by decrypting and optionally inspecting traffic, you must have the internal certificate for your internal server:
  [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).
* To protect *external* servers by decrypting and optionally inspecting traffic, you must upload an internal CA object that will be used to derypt
  ad resign the traffic: [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).

### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a name for the policy in the Name field and an optional description in the Description field.  A decryption policy can protect either outbound connections (Decrypt - Resign rule action) or inbound connectors (Decrypt - Known Key rule action)   The Outbound Connections tab page enables you to create Decrypt - Resign rules. These rules require an internal certificate that you can either create beforehand (using Objects > Object Management > PKI >  Internal CAs) or you can create them as part of the outbound connection rule.   the Inbound Connections tab page enables you to create Decrypt - Known Key rules. These rules require an internal certificate that you can either create beforehand (using Objects > Object Management > PKI >  Internal Certs) or you can create them as part of the inbound connection rule. |
| **Step 4** | Associate the decryption rule with an access control rule as discussed in [Associating Other Policies with Access Control](m_access-policies.html#id_17609). |
| **Step 5** |  |
| **Step 6** | Continue with one of the following sections. |

---

What To Do Next

* [Create a Decryption Policy with Outbound Connection Protection](#Cisco_Task_in_List_GUI.dita_14c9ed19-9b2e-4734-82da-636d8488c64d) (Decrypt - Resign)
* [Create a Decryption Policy with Inbound Connection Protection](#Cisco_Task_in_List_GUI.dita_f48db076-8088-4dd8-b542-3dd1a4b9bb57) (Decrypt - Known Key)
* [Create a Decryption Policy with Other Rule Actions](#Cisco_Task_in_List_GUI.dita_ed1e150d-52f7-413f-b51b-bbfe0dc73562)

* [Create a Decryption Policy with Outbound Connection Protection](#Cisco_Task_in_List_GUI.dita_14c9ed19-9b2e-4734-82da-636d8488c64d)
* [Create a Decryption Policy with Inbound Connection Protection](#Cisco_Task_in_List_GUI.dita_f48db076-8088-4dd8-b542-3dd1a4b9bb57)
* [Create a Decryption Policy with Other Rule Actions](#Cisco_Task_in_List_GUI.dita_ed1e150d-52f7-413f-b51b-bbfe0dc73562)

### Create a Decryption Policy with Outbound Connection Protection

This task discusses how to create a decryption policy with a rule that protects outbound connections; that is, the destination
server is outside your protected network. This type of rule has a Decrypt - Resign rule action.

When you create a decryption policy, you can create multiple rules at the same time, including multiple Decrypt - Known Key rules and multiple Decrypt - Resign rules.

**Threat Defense Feature History**:

7.4—This feature is added.

#### Before you begin

You must upload an internal certifcate authority (CA) for your outbound server before you can create a decryption policy that
protects outbound connections. You can do this in any of the following ways:

* Create an internal CA object by going to Objects > Object Management > PKI >  Internal CAs and referring to [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).
* At the time you create this decryption policy.

#### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Give the policy a unique Name and, optionally, a Description. |
| **Step 4** | Click the Outbound Connections tab. |
| **Step 5** | Upload or choose certificates for the rules.  The system creates one rule per certificate. |
| **Step 6** | (Optional.) Choose networks and ports.  For more information:   * [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164) * [Network Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab) * [Port Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_e2492043-1ba7-42e5-8aab-ca2d76816f08) |
| **Step 7** | Click Save. |

---

#### What to do next

* Add rule conditions: [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164)
* Add a default policy action: [Decryption Policy Default Actions](#ID-2253-00000065)
* Configure logging options for the default action.
* Set advanced policy properties: [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the decryption policy with an access control policy as described in [Associating Other Policies with Access Control](m_access-policies.html#id_17609).
* Deploy configuration changes.

* [Upload an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_61c31e2c-48f3-4e6e-8e8a-3cc6a5905b1d)
* [Generate an Internal CA for Outbound Protection](#Cisco_Task_in_List_GUI.dita_e5f30d7a-7fd1-4358-ad81-78eea166777c)

#### Upload an Internal CA for Outbound Protection

This task discusses how to upload an internal certificate authority when you create a decryption rule that protects outbound
connections. You can also upload the internal CA using Objects > Object Management as discussed in [Importing a CA Certificate and Private Key](m_objects-object-mgmt.html#ID-2243-00000b8b).

##### Before you begin

Make sure you have an internal certificate authority in one of the formats discussed in [Internal Certificate Authority Objects](m_objects-object-mgmt.html#ID-2243-00000b41).

##### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a name for the policy in the Name field and an optional description in the Description field. |
| **Step 4** | Click the Outbound Connections tab. |
| **Step 5** | From the Internal CA list, click Create New > Upload CA. |
| **Step 6** | Give the internal CA a Name. |
| **Step 7** | Paste or browse to locate the certificate and its private key in the provided fields. |
| **Step 8** | If the CA has a password, select the Encrypted check box and enter the password in the adjacent field. |

---

#### Generate an Internal CA for Outbound Protection

This task discusses how you can optionally generate an internal certificae authority when you create a decryption rule that
protects outbound connections. You can also perform these tasks using Objects > Object Management as discussed in [Uploading a Signed Certificate Issued in Response to a CSR](m_objects-object-mgmt.html#ID-2243-00000c32).

##### Before you begin

Make sure you understand the requirements for generating an internal certificate authority object as discussed in [Internal Certificate Authority Objects](m_objects-object-mgmt.html#ID-2243-00000b41).

##### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a name for the policy in the Name field and an optional description in the Description field. |
| **Step 4** | Click the Outbound Connections tab. |
| **Step 5** | From the Internal CA list, click Create New > Generate CA. |
| **Step 6** | Give the internal CA a Name and provide a two-letter Country Name. |
| **Step 7** | Click Self-Signed or CSR.  For more information about these options, see [Internal Certificate Authority Objects](m_objects-object-mgmt.html#ID-2243-00000b41). |
| **Step 8** | Enter the requested information in the provided fields. |
| **Step 9** | Click Save. |
| **Step 10** | If you chose CSR, after the signing request has been completed, click Install Certificate as follows:   1. Repeat the preceding steps in this procedure. 2. Edit the CA from the Internal CA list as follows. 3. Click Install Certificate. 4. Follow the prompts on your screen to complete the task. |

---

### Create a Decryption Policy with Inbound Connection Protection

This task discusses how to create a decryption policy with a rule that protects inbound connections; that is, the destination
server is inside your protected network. This type of rule has a Decrypt - Known Key rule action.

When you create a decryption policy, you can create multiple rules at the same time, including multiple Decrypt - Known Key rules and multiple Decrypt - Resign rules.

**Threat Defense Feature History**:

7.4—This feature is added.

#### Before you begin

You must upload an internal certificate for your internal server before you can create a decryption policy that protects inbound
connections. You can do this in any of the following ways:

* Create an internal certificate object by going to Objects > Object Management > PKI >  Internal Certs and referring to [PKI](m_objects-object-mgmt.html#ID-2243-00000b21).
* At the time you create this decryption policy.

#### Procedure

---

| **Step 1** | Log in to CDO. |
| --- | --- |
| **Step 2** | Click Tools & Services >  Firewall Management Center >  Policies >  Policies >  Access Control >  Decryption. |
| **Step 3** | Click New Policy. |
| **Step 4** | Give the policy a unique Name and, optionally, a Description. |
| **Step 5** | Click the Inbound Connections tab. |
| **Step 6** | Upload or choose certificates for the rules.  The system creates one rule per certificate. |
| **Step 7** | (Optional.) Choose networks and ports.  For more information:   * [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164) * [Network Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab) * [Port Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_e2492043-1ba7-42e5-8aab-ca2d76816f08) |
| **Step 8** | Click Save. |

---

#### What to do next

* Add rule conditions: [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164)
* Add a default policy action: [Decryption Policy Default Actions](#ID-2253-00000065)
* Configure logging options for the default action .
* Set advanced policy properties: [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the decryption policy with an access control policy as described in [Associating Other Policies with Access Control](m_access-policies.html#id_17609).
* Deploy configuration changes.

### Create a Decryption Policy with Other Rule Actions

To create a decryption rule with a Do Not Decrypt, Block, Block With Reset, or Monitor rule action, create a decryption policy and edit the policy to add the rule.

When you create a decryption policy, you can create multiple rules at the same time, including multiple Decrypt - Known Key rules and multiple Decrypt - Resign rules.

#### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Give the policy a unique Name and, optionally, a Description. |
| **Step 4** | Click Edit (edit icon) next to the decryption policy name. |
| **Step 5** | Click Add Rule. |
| **Step 6** | Give the rule a Name. |
| **Step 7** | From the Action list, click a rule action and see one of the following sections for more information:   * [Decryption Rule Do Not Decrypt Action](m_decryption-rules.html#ID-2254-00000229) * [Decryption Rule Blocking Actions](m_decryption-rules.html#ID-2254-0000023e) * [Decryption Rule Monitor Action](m_decryption-rules.html#ID-2254-00000213) |
| **Step 8** | Click Save. |

---

#### What to do next

* Add rule conditions: [Decryption Rule Conditions](m_decryption-rules.html#ID-2254-00000164)
* Add a default policy action: [Decryption Policy Default Actions](#ID-2253-00000065)
* Configure logging options for the default action.
* Set advanced policy properties: [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the decryption policy with an access control policy as described in [Associating Other Policies with Access Control](m_access-policies.html#id_17609).
* Deploy configuration changes.

## Decryption Policy Default Actions

The default action for a
decryption policy determines how the system handles decryptable encrypted traffic that does not match any non-monitor rule in the policy. When
you deploy a
decryption policy that does not contain any decryption
rules, the default action determines how all decryptable traffic on your network is handled. Note that the system does not perform
any kind of inspection on encrypted traffic blocked by the default action.

To set the decryption policy default action:

1. Log in to the management center if you haven't already done so.
2. Click Policies > Access Control > Decryption.
3. Click Edit (![edit icon](/c/dam/en/us/td/i/400001-500000/440001-450000/442001-443000/442546.jpg)) next to the name of the decryption policy.
4. In the Default Action row, click one of the following actions from the list.

Table 1. Decryption Policy Default Actions

| Default Action | Effect on Encrypted Traffic |
| --- | --- |
| Block | Block the TLS/SSL session without further inspection. |
| Block with reset | Block the TLS/SSL session without further inspection and reset the TCP connection. Choose this option if traffic uses a connectionless protocol like UDP. In that case, the connectionless protocol tries to reestablish the connection until it is reset.  This action also displays a connection reset error in the browser so the user is informed that the connection is blocked. |
| Do not decrypt | Inspect the encrypted traffic with access control. |

**Related Tasks**
[Create Basic Decryption Policies](#ID-2253-00000099)

## Default Handling Options for Undecryptable Traffic

Table 2. Undecryptable Traffic Types

| Type | Description | Default Action | Available Action |
| --- | --- | --- | --- |
| Compressed Session | The TLS/SSL session applies a data compression method. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| SSLv2 Session | The session is encrypted with SSL version 2.  Note that traffic is decryptable if the ClientHello message is SSL 2.0, and the remainder of the transmitted traffic is SSL 3.0. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unknown Cipher Suite | The system does not recognize the cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unsupported Cipher Suite | The system does not support decryption based on the detected cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Session not cached | The TLS/SSL session has session reuse enabled, the client and server reestablished the session with the session identifier, and the system did not cache that session identifier. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Handshake Errors | An error occurred during TLS/SSL handshake negotiation. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Decryption Errors | An error occurred during traffic decryption. | Block | Block  Block with Reset |

When you first create a
decryption policy, logging connections that are handled by the default action is disabled by default. Because the logging settings for the
default action also apply to undecryptable traffic handling, logging connections handled by the undecryptable traffic actions
is disabled by default.

Note that if your browser uses certificate pinning to verify a server certificate, you cannot decrypt this traffic by re-signing
the server certificate. For more information, see [Decryption Rule Guidelines and Limitations](m_decryption-rules.html#id_65029).

* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

**Related Tasks**
[Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

### Set Default Handling for Undecryptable Traffic

You can set undecryptable traffic actions at the decryption policy level to handle certain types of encrypted traffic the system cannot decrypt or inspect. When you deploy a
decryption policy that contains no decryption
rules, the undecryptable traffic actions determine how all undecryptable encrypted traffic on your network is handled.

Depending on the type of undecryptable traffic, you can choose
to:

* Block the connection.
* Block the connection, then reset it. This option is preferrable for connectionless protocols like UDP, which keep trying to
  connect until the connection is blocked.
* Inspect the encrypted traffic with access control.
* Inherit the default action from the decryption policy.

#### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) next to the name of the decryption policy. |
| **Step 3** | In the decryption policy editor, click Undecryptable Actions. |
| **Step 4** | For each field, choose either the decryption policy's default action or another action you want to take on the type of undecryptable traffic. See [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4) and [Decryption Policy Default Actions](#ID-2253-00000065) for more information. |
| **Step 5** | Click Save to save the policy. |

---

#### What to do next

* Configure default logging for connections handled by the undecryptable
  traffic actions.
* Deploy configuration changes.

## Decryption Policy Advanced Options

A
decryption policy 's Advanced Settings tab page has global settings that are applied to all managed devices that are configured for Snort 3 to which the policy
is applied.

**Threat Defense Feature History**:

* 7.3—Enable adaptive TLS server identity probe added.
* 7.2—Enable TLS 1.3 decryption added.
* 7.2—Initial options.

A
decryption policy advanced settings are all ignored on any managed device that runs:

* A version earlier than 7.1
* Snort 2

Following is an example.

![decryption policy advanced options enable you to set version-dependent options such as enabling the TLS server identity probe](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465008.jpg)

### Block flows requesting ESNI

Encrypted Server Name Indication (ESNI ([link to draft proposal](https://tools.ietf.org/html/draft-ietf-tls-esni))) is a way for a client to tell a TLS 1.3 server what the client is requesting. Because the SNI is encrypted, you can optionally
block these connections because the system cannot determine what the server is.

### Disable HTTP/3 advertisement

This option strips HTTP/3 ([RFC 9114](https://www.rfc-editor.org/rfc/rfc9114.html)) from the ClientHello in TCP connections because:

* As stated in RFC 9114, HTTP/3 is part of the QUIC transport protocol, not the TCP transport protocol
* QUIC is not yet supported by the Firepower system
* Blocking clients from advertising HTTP/3 provides protection against attacks and evasion attempts

### Propagate untrusted server certificates to clients

This applies only to traffic matching a Decrypt - Resign rule action.

Enable this option to substitute the certificate authority (CA) on the managed device for the server's certificate in cases
where the server certificate is untrusted. An *untrusted* server certificate is one that is not listed as a trusted CA in the Secure Firewall Management
Center. (Objects > Object Management >  PKI >  Trusted CAs).

### Enable TLS 1.3 Decryption

(Snort 3 only.) Move the slider to enable Threat Defense devices managed by this Management
Center to decrypt TLS 1.3 traffic.

If the slider is moved to the disabled position, the system decrypts TLS 1.2 traffic only.

### Enable adaptive TLS server identity probe

Automatically enabled when TLS 1.3 decryption is enabled. A *probe* is a partial TLS connection with the server, the purpose of which is to obtain the server certificate and cache it. (If the
certificate is already cached, the probe is never established.)

If TLS 1.3 Server Identity Discovery is disabled on the access control policy with which the decryption policy is associated,
we attempt to use the Server Name Indication (SNI), which is not as reliable.

The adaptive TLS server identity probe occurs on any of the following conditions as opposed to on every connection as in earlier
releases:

* Certificate Issuer—Matched when the value of Issuer DNs in a decryption rule's DN rule condition is matched.

  For more information, see [Distinguished Name (DN) Rule Conditions](m_decryption-rules.html#Cisco_Reference.dita_6dbb2195-514d-49be-b5e7-367866e39eae).
* Certificate Status—Matched when any of the Cert Status conditions are matched in a decryption rule.

  For more information, see [Certificate Status Decryption Rule Conditions](m_decryption-rules.html#ID-2255-00000582).
* Internal/External Certificate—Internal certificates can be matched by the certificate used in Decrypt - Known Key rule actions; external certificates can be matched in Certificates rule conditions.

  For more information, see [Known Key Decryption (Incoming Traffic)](m_encrypted-traffic-overview-2.html#id_101162) and [Certificate Decryption Rule Conditions](m_decryption-rules.html#ID-2255-00000524).
* Application ID—Can be matched by Applications rule conditions in either an access control policy or a decryption policy.

  For more information, see [Application Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_eb009bfa-aee2-417d-8bb2-7d0f0bb2dadd).
* URL Category—Can be matched by URLs rule conditions in an access control policy.

  For more information, see [URL Rule Conditions](m_interfaces-settings-qos.html#Cisco_Concept.dita_08d17973-40f4-43f2-84a9-7d0acedf8301).

| **Note** | ---   Enable adaptive TLS server discovery mode is not supported on any Secure Firewall Threat Defense Virtual deployed to AWS. If you have any such managed devices managed by the Secure Firewall Management Center, the connection event PROBE\_FLOW\_DROP\_BYPASS\_PROXY  increments every time the device attempts to extract the server certificate.   --- |
| --- | --- |

### Related information

[TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c)

* [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c)

### TLS 1.3 Decryption Best Practices

#### Recommendation: When to enable advanced options

Both the decryption policy and the access control policy have advanced options that affect how traffic is handled, whether the traffic is being decrypted
or not.

The advanced options are:

* Decryption policy:

  + TLS 1.3 decryption
  + TLS adaptive server identity probe
* Access control policy: TLS 1.3 Server Identity Discovery

  The access control policy setting takes precedence over the decryption policy setting.

Use the following table to decide which option to enable:

| TLS adaptive server identity probe setting (decryption policy) | TLS 1.3 Server Identity Discovery setting (access control policy) | Result | Recommended when |
| --- | --- | --- | --- |
| Enabled | Disabled | Adaptive probe sent if decryption policy contains *any* rule conditions specified in [Decryption Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8) *and* if the server certificate is not cached. | * You're not using application or URL conditions in access control rules * You're decrypting traffic |
| Enabled | Enabled | Probe is always sent if the server certificate is not cached. | Use only if your access control rules have URL or application conditions |
| Disabled | Enabled | Probe is always sent if the server certificate is not cached. | Not recommended. |
| Disabled | Disabled | Probe is never sent. | Very limited usefulness; use only if not decrypting traffic and not using application or URL conditions in the access control rule |

| **Note** | ---   A cached TLS server's certificate is available to all Snort instances on a particular threat defense. The cache can be cleared with a CLI command and is automatically cleared when the device is rebooted.   --- |
| --- | --- |

#### Reference

For more information, see the discussion of [TLS server identity discovery](https://secure.cisco.com/secure-firewall/v7.2/docs/ssl-policy#tls-server-identity-discovery) on secure.cisco.com.

## Manage Decryption Policies

In the decryption policy editor, you can:

* Add, edit, delete, enable, disable, and organize decryption
  rules.
* Add trusted CA certificates.
* Determine the handling for encrypted traffic the system cannot decrypt.
* Log traffic that is handled by the default action and undecryptable traffic actions.
* Set advanced options.

In a multidomain deployment, the system displays policies created in the current domain, which you can edit. It also displays
policies created in ancestor domains, which you cannot edit. To view and edit policies created in a lower domain, switch to
that domain.

Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the
last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing
each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor.
After 60 minutes, the system discards your changes.
### Procedure

---

| **Step 1** | Click Policies > Access Control > Decryption. |
| --- | --- |
| **Step 2** | Manage decryption policies:   * Compare—Click Compare Policies; see [Comparing policies](m_get-started-deployment.html#task_ABA1FE48DBBB44BC9FF40243FCC58BF6). * Copy—Click Copy  (copy icon). * Create—Click New Policy; see [Create Basic Decryption Policies](#ID-2253-00000099). * Delete—Click Delete (delete icon). If the controls are dimmed, the configuration belongs to an ancestor domain, or you do not have permission to modify the   configuration. * Report—Click Report (Report icon); see [Generating Current Policy Reports](m_get-started-deployment.html#task_CCED983433824793AF09203FDAD1AF53). * Edit—Click Edit (edit icon). If View (View button) appears instead, the configuration belongs to an ancestor   domain, or you do not have permission to modify the   configuration. * To add trusted CA certificates to your decryption policy, see [Trusting External Certificate Authorities](m_decryption-rules.html#ID-2255-00000623). * To configure how your decryption policy handles undecryptable traffic, see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154). * To log connections for undecryptable traffic handling and traffic that does not match SSL rules, see Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config). * Deploy—Choose Deploy > Deployment; see [Deploy Configuration Changes](m_get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B). |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_6bc878d7_20250115_123405.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from sec.cloudapps.cisco.com_85080164_20250115_123419.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x)

#### Cisco Security

# Cisco Software Checker

![](Resources/images/loader.gif)

![](Resources/images/loader.gif)

  1
  2
  3

### Select a Method

### A. Search By Release

* {{os}}

* {{::os}}

×

* {{v}}

* {{::v}}

* {{::v}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

### B. Use Show Version Command Output

* {{os}}

* {{::os}}

* {{v}}

* {{::v.nxOsPlatformDesc}}

![](Resources/images/reset.PNG "Reset Cisco NX-OS Software Release Show Version ")

### C. Upload a .txt file from your local system

* {{os}}

* {{::os}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

Use the Browse button to locate and upload a .txt file that contains one Cisco ASA Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco FMC Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco FTD Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco FXOS Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco IOS Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco IOS XE Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco NX-OS Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco ACI Software release per line.(max 50 releases)

 **Browse File**

![](Resources/images/reset.PNG "Reset Cisco NX-OS Software Release Show Version ")

No file chosen

---

Continue
Continue
Continue
Continue
Continue
Continue
Continue
Continue

Continue
Continue
Continue
Continue
Continue
Continue
Continue
Continue

Analyze And Continue

Upload And Continue
Continue

#### {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} Cisco IOS Cisco IOS XE Cisco NX-OS Software in ACI Mode Cisco Cisco ASA Cisco FMC Cisco FTD Software release(s) selected: for all Cisco NXOS Software Platforms for all Cisco Adaptive Security Appliance (ASA) Software Platforms for all Cisco Firepower Management Center (FMC) Software Platforms for all Cisco Firepower Threat Defense (FTD) Software Platforms for all Cisco FXOS Software Platforms

{{v}},
{{v}},
{{v}},
{{v}},
{{v}},
{{v}},
{{v}},
{{v}},

The maximum number of release selections is 50

 {{ v }}

 {{ v }}

#### Select Cisco Security Advisories Impact Rating

  All
  Critical
  High
  Medium
  Low
  Informational

#### Select Cisco Security Advisories that you are interested in searching

  All previously published Cisco Security Advisories

  Cisco Security Advisories that are included in the most recent Cisco IOS Software Security Advisory Bundled Publication (2024 Sep 25)

  Only the following Cisco Security Advisories

View/Edit Selections

Please select up to 150 number of advisories.

Continue
Continue
Back
Start Over

# Cisco Security Advisory Selection

* {{checkboxData.text}}
  + {{x.text}}
    - {{y.text}}

No advisories found for the selected impact.

 Cancel
 OK

#### {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} Cisco IOS Cisco IOS XE Cisco NX-OS Software in ACI Mode software release(s) for all Cisco Adaptive Security Appliance (ASA) Software Platforms for all Cisco Firepower Management Center (FMC) Software Platforms for all Cisco NXOS Software Platforms for all Cisco Firepower Threat Defense (FTD) Software Platforms for all Cisco FXOS Software Platforms Cisco ASA Cisco FMC Cisco FTD Cisco FXOS

  {{ v.name}}

The maximum number of release selections is 50

Please select up to 150 number of advisories.

First uncheck Security Advisory boxes and then click the Recalculate button

Recalculate
Back
Start Over

![](Resources/images/loader.gif)

| Check Your Cisco Software  Use the Cisco Software Checker to search for Cisco Security Advisories that apply to specific software releases of the following products: Cisco ASA, FMC, FTD, FXOS, IOS, IOS XE, NX-OS and NX-OS in ACI Mode. To use the tool, select a product, platform (as required) and one or more releases, enter the output of the show version command, or upload a text file that lists specific releases. Then narrow the check to certain advisories, if desired. The availability of security fixes after the End of Sale is defined in the product's End-of-Sale announcement, as explained in the [Cisco End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Additional information about Cisco software updates, vulnerability rating and scoring is available in the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This tool does not provide information about Cisco IOS XR Software or interim software builds. Also note that for Cisco ASA, FMC, FTD and FXOS Software, the tool only contains vulnerability information for Cisco Security Advisories first published from January, 2022 onward, and for NX-OS Software and NX-OS Software in ACI Mode from July, 2019 onward. |
| --- |

##### Results for all previously published {{ratings}} Cisco Security Advisories

##### {{ratings}} {{result}} from the latest Cisco IOS Software Security Advisory Bundled Publication ({{bundleDate1}}) Export Selected Export All

##### Results for all previously published {{ratings}} Cisco Security Advisories Export Selected Export All

##### Results for selected Cisco Security Advisories: Export Selected Export All

##### Show advisory list

{{selectedAdvisoriesAsString}}

##### Hide advisory list

Security Advisories That Affect This Release
![](/security/center/img/questionmark_dkgrey.gif)

Uncheck security advisory boxes and click the Recalculate button to omit advisories and redetermine vulnerability and First Fixed information.

The following results include the first fixed or not affected release that addresses all vulnerabilities in a security advisory. The availability of security fixes after the End of Sale is defined in the product's End of Sale bulletin, as explained in the [Cisco End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Please refer to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html) for additional information.

|  | TITLE | PUBLICATION DATE | IMPACT | FIRST FIXED OR NOT AFFECTED  The first release in the upgrade path that addresses all vulnerabilities detailed in the advisory. |
| --- | --- | --- | --- | --- |
|  | [{{v1.title}}](%7B%7Bv1.url%7D%7D "{{v1.identifier}}") This advisory does not affect all platforms. | {{v1.firstPublished | date :'yyyy MMM dd' : 'UTC'}} | {{v1.impact}} | {{v2}}  The first-fixed release for this advisory is not the same for all platforms. Search against individual platforms to determine the first-fixed release for each platform.  Some platforms do not have a first-fixed release for this advisory. Search against individual platforms to determine the first-fixed release for each platform.  [SMU available](%7B%7BgetSmuUrl%28v2.smuURL%29%7D%7D) |
| {{message}} | | | | |
| **COMBINED FIRST FIXED OR NOT AFFECTED**   The first release in the upgrade path that addresses all vulnerabilities in all selected advisories.    {{c1}}, | | | | |
| --- | --- | --- | --- | --- |
{{advValue}}
##### None of the specified Cisco Security Advisories affect the selected Cisco software release

Cisco Software Checker data is currently unavailable.

{{errorPage3}}

#### Security Check

![](Resources/images/captchaImages/loader.gif)

![](Resources/images/audio-on.svg)
![](Resources/images/audio-off.svg)
Your browser does not support the audio element.

Please enter the text correctly.

Can't read the security check? Try another.

---

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)



=== Content from www.cisco.com_a1089d3a_20250115_123353.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Device Configuration Guide, 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Getting Started with Device Configuration
  + [Device Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-device-management.html)
  + [Users](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-logical-devices.html)
  + [High Availability](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/high-availability.html)
  + [Clustering for the Secure Firewall 3100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-sec-fw-3100.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-firewall.html)
  + [Inline Sets and Passive Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000/2100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ecmp.html)
  + [OSPF](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-certs.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-monitoring.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-rules.html)
  + [URL Filtering](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-service-policies.html)
  + [Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-detection.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-content-restriction.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/network-malware-protection.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-overview.html)
  + [SSL Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html)
  + [TLS/SSL
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rules.html)
  + [TLS/SSL
    Rules and Policy Example](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rule-examples.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-realms.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-captive-portal.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-access-control.html)
  + [Getting Started with
    Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-get-start.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-adaptive-profiles.html)
* Threat Intelligence Director
  + [Secure Firewall Threat Intelligence Director](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-intelligence-director.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Device Configuration Guide, 7.2 Chapter Title SSL Policies

* [PDF - Complete Book
  (78.84 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72.pdf)
  [PDF - This Chapter (1.46 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: SSL Policies

Chapter Contents

* [SSL Policies](#ID-2253-00000004)
* [SSL Policies Overview](#concept_6696BC22D1DA4348962E4D4039215767)
* [SSL Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Requirements and Prerequisites for SSL Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create Basic SSL Policies](#ID-2253-00000099)
* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Manage SSL Policies](#ID-2253-00000021)

Close

# SSL Policies

The following topics provide an overview of SSL policy creation, configuration, management, and logging.

* [SSL Policies Overview](#concept_6696BC22D1DA4348962E4D4039215767)
* [SSL Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Requirements and Prerequisites for SSL Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create Basic SSL Policies](#ID-2253-00000099)
* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Manage SSL Policies](#ID-2253-00000021)

## SSL Policies Overview

An
SSL policy determines how the system handles encrypted traffic on your network. You can configure one or more SSL policies, associate an
SSL policy with an access control policy, then deploy the access control policy to a managed device. When the device detects a TCP handshake,
the access control policy first handles and inspects the traffic. If it subsequently identifies a TLS/SSL-encrypted session over the TCP connection, the SSL policy takes over, handling and decrypting the encrypted traffic.

| **Caution** | ---   *Snort 2 only*. Adding or removing an SSL policy restarts the Snort process when you deploy configuration changes, temporarily interrupting traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](get-started-deployment.html#concept_uc1_gtq_ty) for more information.   --- |
| --- | --- |

The simplest SSL policy, as shown in the following diagram, directs the device where it is deployed to handle encrypted traffic with a single default
action. You can set the default action to block decryptable traffic without further inspection, or to inspect undecrypted
decryptable traffic with access control. The system can then either allow or block the encrypted traffic. If the device detects
undecryptable traffic, it either blocks the traffic without further inspection or does not decrypt it, inspecting it with
access control.

![When an encrypted packet is detected by the system, first the SSL policy's undecryptable action policy is applied, followed by the policy's default action and so on](/c/dam/en/us/td/i/300001-400000/370001-380000/372001-373000/372912.jpg)

![When an encrypted packet is detected by the system, first the decryption policy's undecryptable action policy is applied, followed by the policy's default action and so on](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465003.jpg)

A more complex SSL policy can handle different types of undecryptable traffic with different actions, control traffic based on whether a certificate
authority (CA) issued or trusts the encryption certificate, and use TLS/SSL
rules to exert granular control over encrypted traffic logging and handling. These rules can be simple or complex, matching and
inspecting encrypted traffic using multiple criteria.

| **Note** | ---   Because TLS and SSL are often used interchangeably, we use the expression *TLS/SSL* to indicate that either protocol is being discussed. The SSL protocol has been deprecated by the IETF in favor of the more secure TLS protocol, so you can usually interpret *TLS/SSL* as referring to TLS only.  The exception is SSL policies. Because the management center configuration option is Policies > Access Control > SSL, we use the term *SSL policies* although these policies are used to define rules for TLS and SSL traffic.  For more information about SSL and TLS protocols, see a resource such as [SSL vs. TLS - What's the Difference?](https://www.globalsign.com/en/blog/ssl-vs-tls-difference/).   --- |
| --- | --- |

**Related Concepts**
[TLS/SSL Rule Conditions](encrypted-traffic-rules.html#ID-2254-00000164)

## SSL Policy Default Actions

The default action for an
SSL policy determines how the system handles decryptable encrypted traffic that does not match any non-monitor rule in the policy. When
you deploy an
SSL policy that does not contain any TLS/SSL
rules, the default action determines how all decryptable traffic on your network is handled. Note that the system does not perform
any kind of inspection on encrypted traffic blocked by the default action.

Table 1. SSL Policy Default Actions

| Default Action | Effect on Encrypted Traffic |
| --- | --- |
| Block | Block the TLS/SSL session without further inspection. |
| Block with reset | Block the TLS/SSL session without further inspection and reset the TCP connection. Choose this option if traffic uses a connectionless protocol like UDP. In that case, the connectionless protocol tries to reestablish the connection until it is reset.  This action also displays a connection reset error in the browser so the user is informed that the connection is blocked. |
| Do not decrypt | Inspect the encrypted traffic with access control. |

**Related Tasks**
[Create Basic SSL Policies](#ID-2253-00000099)

## Default Handling Options for Undecryptable Traffic

Table 2. Undecryptable Traffic Types

| Type | Description | Default Action | Available Action |
| --- | --- | --- | --- |
| Compressed Session | The TLS/SSL session applies a data compression method. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| SSLv2 Session | The session is encrypted with SSL version 2.  Note that traffic is decryptable if the ClientHello message is SSL 2.0, and the remainder of the transmitted traffic is SSL 3.0. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unknown Cipher Suite | The system does not recognize the cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unsupported Cipher Suite | The system does not support decryption based on the detected cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Session not cached | The TLS/SSL session has session reuse enabled, the client and server reestablished the session with the session identifier, and the system did not cache that session identifier. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Handshake Errors | An error occurred during TLS/SSL handshake negotiation. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Decryption Errors | An error occurred during traffic decryption. | Block | Block  Block with Reset |

When you first create an
SSL policy, logging connections that are handled by the default action is disabled by default. Because the logging settings for the
default action also apply to undecryptable traffic handling, logging connections handled by the undecryptable traffic actions
is disabled by default.

Note that if your browser uses certificate pinning to verify a server certificate, you cannot decrypt this traffic by re-signing
the server certificate. For more information, see [TLS/SSL Rule Guidelines and Limitations](encrypted-traffic-rules.html#id_65029).

**Related Tasks**
[Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

## SSL Policy Advanced Options

An
SSL policy 's Advanced Settings page has global settings that are applied to all managed devices that are configured for Snort 3 to which the policy is applied.

An
SSL policy advanced settings are all ignored on any managed device that runs:

* A version earlier than 7.1
* Snort 2

### Block flows requesting ESNI

Encrypted Server Name Indication (ESNI ([link to draft proposal](https://tools.ietf.org/html/draft-ietf-tls-esni))) is a way for a client to tell a TLS 1.3 server what the client is requesting. Because the SNI is encrypted, you can optionally
block these connections because the system cannot determine what the server is.

### Disable HTTP/3 advertisement

This option strips HTTP/3 ([RFC 9114](https://www.rfc-editor.org/rfc/rfc9114.html)) from the ClientHello in TCP connections. HTTP/3 is part of the QUIC transport protocol, not the TCP transport protocol.
Blocking clients from advertising HTTP/3 provides protection against attacks and evasion attempts potentially burried within
QUIC connections.

### Propagate untrusted server certificates to clients

This applies only to traffic matching a Decrypt - Resign rule action.

Enable this option to substitute the certificate authority (CA) on the managed device for the server's certificate in cases
where the server certificate is untrusted. An *untrusted* server certificate is one that is not listed as a trusted CA in the Secure Firewall Management
Center. (Objects > Object Management >  PKI >  Trusted CAs).

### Enable TLS 1.3 Decryption

Whether to apply decryption rules to TLS 1.3 connections. If you do not enable this option, the decryption rules apply to
TLS 1.2 or lower traffic only. See [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c).

## Requirements and Prerequisites for SSL Policies

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Create Basic SSL Policies

To configure an
SSL policy, you must give the policy a unique name and specify a default action.

### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Click New Policy. |
| **Step 4** | Give the policy a unique Name and, optionally, a Description. |
| **Step 5** | Specify the Default Action; see [SSL Policy Default Actions](#ID-2253-00000065). |
| **Step 6** | Configure logging options for the default actionas described in Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management Center Administration Guide](http://www.cisco.com/go/firepower-config) . |
| **Step 7** | Click Save. |

---

What To Do Next

* Set the default handling for undecryptable traffic; see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154).
* Configure logging options for default handling of undecryptable
  traffic; see Logging Connections with a Policy Default
  Action in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* Set advanced policy properties: [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the SSL policy with an access control policy as described in [Associating Other Policies with Access Control](access-policies.html#id_17609).
* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Set Default Handling for Undecryptable Traffic

You can set undecryptable traffic actions at the SSL policy level to handle certain types of encrypted traffic the system cannot decrypt or inspect. When you deploy an
SSL policy that contains no TLS/SSL
rules, the undecryptable traffic actions determine how all undecryptable encrypted traffic on your network is handled.

Depending on the type of undecryptable traffic, you can choose
to:

* Block the connection.
* Block the connection, then reset it. This option is preferrable for connectionless protocols like UDP, which keep trying to
  connect until the connection is blocked.
* Inspect the encrypted traffic with access control.
* Inherit the default action from the SSL policy.

### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Click Edit (edit icon) next to the name of the SSL policy. |
| **Step 4** | In the SSL policy editor, click Undecryptable Actions. |
| **Step 5** | For each field, choose either the SSL policy's default action or another action you want to take on the type of undecryptable traffic. See [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4) and [SSL Policy Default Actions](#ID-2253-00000065) for more information. |
| **Step 6** | Click Save to save the policy. |

---

### What to do next

* Configure default logging for connections handled by the undecryptable
  traffic actions; see Logging Connections with a Policy Default
  Action in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Manage SSL Policies

In the SSL policy editor, you can:

* Add, edit, delete, enable, disable, and organize TLS/SSL
  rules.
* Add trusted CA certificates.
* Determine the handling for encrypted traffic the system cannot decrypt.
* Log traffic that is handled by the default action and undecryptable traffic actions.
* Set advanced options.

Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the
last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing
each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor.
After 60 minutes, the system discards your changes.
### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Manage SSL policies:   * Compare—Click Compare Policies; see [Comparing policies](get-started-deployment.html#task_ABA1FE48DBBB44BC9FF40243FCC58BF6). * Copy—Click Copy  (copy icon). * Create—Click New Policy; see [Create Basic SSL Policies](#ID-2253-00000099). * Delete—Click Delete (delete icon). If the controls are dimmed, the configuration belongs to an ancestor domain, or you do not have permission to modify the   configuration. * Report—Click Report (Report icon); see [Generate Current Policy Reports](get-started-deployment.html#task_CCED983433824793AF09203FDAD1AF53). * Edit—Click Edit (edit icon). If View (View button) appears instead, the configuration belongs to an ancestor   domain, or you do not have permission to modify the   configuration. * To add trusted CA certificates to your SSL policy, see [Trusting External Certificate Authorities](encrypted-traffic-rules.html#ID-2255-00000623). * To configure how your SSL policy handles undecryptable traffic, see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154). * SSL policy advanced settings—See [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8). * Import/Export—See the section on importing and exporting the configuration in the [Secure Firewall Management Center and   Threat Defense Management Network   Administration](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/management-center-mgmt-nw/fmc-ftd-mgmt-nw.html). * To log connections for undecryptable traffic handling and traffic that does not match SSL rules, see Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config)   . * Deploy—Choose Deploy > Deployment; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B). |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_0c277382_20250115_123418.html ===


[Home](http://www.cisco.com/) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Event Response PageCisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication Doc ID:  ERP-74985  First Published: 2023 November 1 16:00 GMT  Last Updated:  2023 November 1 17:46 GMT  Version: 1.1       Summary  * Cisco released its semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication on November 1, 2023.  The November 1, 2023, release of the Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication includes 22 Cisco Security Advisories that describe 27 vulnerabilities in Cisco ASA, FMC, and FTD. Cisco has released software updates that address these vulnerabilities.  Details  * The following table identifies Cisco Security content that is associated with this bundled publication:       | Cisco Security Advisory | CVE ID | Security Impact Rating | CVSS Base Score |   | --- | --- | --- | --- |   | [Cisco Firepower Management Center Software Command Injection Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-cmd-inj-29MP49hN) | CVE-2023-20048 | Critical | 9.9 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software ICMPv6 Message Processing Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asa-icmpv6-t5TzqwNd) | CVE-2023-20086 | High | 8.6 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software Remote Access VPN Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asa-webvpn-dos-3GhZQBAS) | CVE-2023-20095 | High | 8.6 |   | [Cisco Firepower Threat Defense Software for Cisco Firepower 2100 Series Firewalls Inspection Rules Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-intrusion-dos-DfT7wyGC) | CVE-2023-20244 | High | 8.6 |   | [Cisco Firepower Threat Defense Software ICMPv6 with Snort 2 Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-icmpv6-dos-4eMkLuN) | CVE-2023-20083 | High | 8.6 |   | [Cisco Firepower Threat Defense Software and Firepower Management Center Software Code Injection Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-fmc-code-inj-wSHrgz8L) | CVE-2023-20063 | High | 8.2 |   | [Cisco Firepower Management Center Software Log API Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-logview-dos-AYJdeX55) | CVE-2023-20155 | High | 7.5 |   | [Cisco Firepower Management Center Software Command Injection Vulnerabilities](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-cmdinj-bTEgufOX) | CVE-2023-20219 CVE-2023-20220 | High | 7.2 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software AnyConnect SSL/TLS VPN Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ssl-dos-kxG8mpUA) | CVE-2023-20042 | Medium | 6.8 |   | [Cisco Firepower Management Center Software Arbitrary File Download Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-file-download-7js4ug2J) | CVE-2023-20114 | Medium | 6.5 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software SAML Assertion Hijack Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-saml-hijack-ttuQfyz) | CVE-2023-20264 | Medium | 6.1 |   | [Cisco Firepower Management Center Software Cross-Site Scripting Vulnerabilities](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-xss-sK2gkfvJ) | CVE-2023-20005 CVE-2023-20041 CVE-2023-20074 CVE-2023-20206 | Medium | 6.1 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software AnyConnect Access Control List Bypass Vulnerabilities](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ac-acl-bypass-bwd7q6Gb) | CVE-2023-20245 CVE-2023-20256 | Medium | 5.8 |   | [Cisco Firepower Threat Defense Software SMB Protocol Snort 3 Detection Engine Bypass and Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-smbsnort3-dos-pfOjOYUV) | CVE-2023-20270 | Medium | 5.8 |   | [Multiple Cisco Products Snort 3 Access Control Policy Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3acp-bypass-3bdR2BEh) | CVE-2023-20246 | Medium | 5.8 |   | [Multiple Cisco Products Snort FTP Inspection Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-ftd-zXYtnjOM) | CVE-2023-20071 | Medium | 5.8 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software Remote Access SSL VPN Multiple Certificate Authentication Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-multi-cert-dzA3h5PT) | CVE-2023-20247 | Medium | 5 |   | [Cisco Adaptive Security Appliance and Firepower Threat Defense Software VPN Web Client Services Client-Side Request Smuggling Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asa-webvpn-LOeKsNmO) | CVE-2022-20713 | Medium | 4.3 |   | [Cisco Firepower Threat Defense Software Snort 3 Detection Engine Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-uAnUntcV) | CVE-2023-20070 | Medium | 4 |   | [Cisco Firepower Threat Defense Software Snort 3 Geolocation IP Filter Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftdsnort3sip-bypass-LMz2ThKn) | CVE-2023-20267 | Medium | 4 |   | [Cisco Firepower Threat Defense Software SSL and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-8U4HHxH8) | CVE-2023-20031 | Medium | 4 |   | [Cisco Firepower Threat Defense Software SSL/TLS URL Category and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sa-ftd-snort3-urldos-OccFQTeX) | CVE-2023-20177 | Medium | 4 |        Related Resources [Cisco Security Vulnerability Policy](https://www.cisco.com/c/en/us/about/security-center/security-vulnerability-policy.html) [MITRE Common Vulnerabilities and Exposures](https://cve.mitre.org/) [Common Vulnerability Scoring System and the Security Impact Rating](https://www.cisco.com/c/en/us/about/security-center/security-vulnerability-policy.html#asr) [Common Vulnerability Scoring System Q & A](https://www.cisco.com/c/en/us/about/security-center/cvss-q-a.html) |   | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_53341f93_20250115_123407.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from bst.cloudapps.cisco.com_41b97697_20250115_193146.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from www.cisco.com_c28a717b_20250115_123426.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Troubleshooting TechNotes](/c/en/us/support/security/firepower-ngfw/products-tech-notes-list.html)
# Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD)

![](/etc/designs/cdc/fw/i/TAC_lg-icon.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.pdf)
  (955.1 KB)

  View with Adobe Reader on a variety of devices
* [ePub](/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.epub)
  (1.0 MB)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi (Kindle)](/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.mobi)
  (427.8 KB)

  View on Kindle device or Kindle app on multiple devices

Updated:July 17, 2024
Document ID:220415

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

## Contents

[Introduction](#toc-hId--2049551438)[Prerequisites](#toc-hId-437961395)[Requirements](#toc-hId-1128522869)[Components Used](#toc-hId--678931594)[Background Information](#toc-hId-1798078135)[Determine the Active Snort Version that Runs on FTD](#toc-hId--9376328)[FTD Command Line Interface (CLI)](#toc-hId-681185146)[FTD Managed by the Cisco FDM](#toc-hId--1126269317)[FTD Managed by the Cisco FMC](#toc-hId-666080037)[FTD Managed by the Cisco CDO](#toc-hId--1141374426)[Related Information](#toc-hId-1217055688)

##

## Introduction

This document describes steps to confirm the active snort version a Cisco FTD runs when it is managed by the Cisco FDM , the Cisco FMC, or the CDO.

## Prerequisites

### Requirements

Cisco recommends that you have knowledge of these topics:

* Cisco Firepower Management Center (FMC)
* Cisco Firepower Threat Defense (FTD)
* Cisco Firepower Device Manager (FDM)
* Cisco Defense Orchestrator (CDO)

### Components Used

The information in this document is based on these software and hardware versions:

* Cisco Firepower Threat Defense v6.7.0 and 7.0.0
* Cisco Firepower Management Center v6.7.0 and 7.0.0
* Cisco Defense Orchestrator

The information in this document was created from the devices in a specific lab environment. All of the devices used in this document started with a cleared (default) configuration. If your network is live, ensure that you understand the potential impact of any command.

##

## Background Information

SNORT® Intrusion Prevention System has officially launched Snort 3, a sweeping upgrade that features improvements and new features that enhance the performance, faster processing, improved scalability for your network, and a range of 200+ plugins so you can create a custom set-up for your network.

Advantages of Snort 3 include, but are not limited to:

* Improved performance
* Improved SMBv2 inspection
* New script detection capabilities
* HTTP/2 inspection
* Custom rule groups
* Syntax that makes custom intrusion rules easier to write.
* Reasons for why it would have dropped inline results in intrusion events.
* No Snort restarts when changes are deployed to the VDB, SSL policies, custom application detectors, captive portal identity sources, and TLS server identity discovery.
* Improved serviceability, due to Snort 3-specific telemetry data sent to Cisco Success Network, and to better troubleshooting logs.

The support for Snort 3.0 was introduced for the 6.7.0 Cisco Firepower Threat Defense (FTD), just when the FTD is managed through the Cisco Firepower Device Manager (FDM).

**Note**: For new 6.7.0 FTD deployments managed by FDM, Snort 3.0 is the default inspection engine. If you upgrade the FTD to 6.7 from an older release, then Snort 2.0 remains the active inspection engine, but you can switch to Snort 3.0.

**Note**: For this release, Snort 3.0 does not support virtual routers, time-based access control rules, or the decryption of TLS 1.1 or lower connections. Enable Snort 3.0 only if you do not need these features.

Then, Firepower version 7.0 introduced the Snort 3.0 support for the Firepower Threat Defense devices managed by both; the Cisco FDM and by the Cisco Firepower Management Center (FMC).

**Note**: For new 7.0 FTD deployments, Snort 3 is now the default inspection engine. Upgraded deployments continue to use Snort 2, but you can switch at any time.

**Caution**: You can freely switch back and forth between Snort 2.0 and 3.0, so you can revert your change if needed. Traffic is interrupted whenever you switch versions.

**Caution**: Before you switch to Snort 3, is strongly recommend you read and understand the [Firepower Management Center Snort 3 Configuration Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/snort3/config-guide/snort3-configuration-guide-v70.html). Pay special attention to feature limitations and migration instructions. Although the upgrade to Snort 3 is designed for minimal impact, features do not map exactly. The plan and preparation before the upgrade can help you make sure that traffic is handled as expected.

## Determine the Active Snort Version that Runs on FTD

### **FTD Command Line Interface (CLI)**

In order to determine the active snort version that runs on an FTD, log in to the FTD CLI and run the **show snort3 status** command:

Example 1: When there is no output displayed, then the FTD runs Snort 2.

> ```
> >show snort3 status
> >
> ```

Example 2: When the output shows, Currently running Snort 2, then the FTD runs Snort 2.

> ```
> >show snort3 status
> Currently running Snort 2
> ```

Example 3: When the output shows, Currently running Snort 3, then the FTD runs Snort 3.

> ```
> >show snort3 status
> Currently running Snort 3
> ```

### **FTD Managed by the Cisco FDM**

In order to determine the active snort version that runs on an FTD that is managed by the Cisco FDM, proceed with the next steps:

1. Log in to the Cisco FTD through the FDM web interface.
2. From the main menu, select **Policies**.
3. Then, select the **Intrusion** tab.
4. Look for the **Snort Version** or the **Inspection Engine** section to confirm the Snort version that is active in the FTD.

Example 1: The FTD runs snort version 2.

![FTD Runs Snort Version 2 FDM](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-00.png)

Example 2: The FTD runs snort version 3.

![FTD Runs Snort Version 3 FDM](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-01.png)

### **FTD Managed by the** **Cisco FMC**

In order to determine the active snort version that runs on an FTD that is managed by the Cisco FMC, proceed with the next steps:

1. Log in to the Cisco FMC web interface.
2. From the **Devices** menu, select **Device Management**.
3. Then, select the appropriate FTD device.
4. Click the **Edit** pencil icon.
5. Select the **Device** tab and look for the **Inspection Engine** section to confirm the snort version that is active in the FTD:

Example 1: The FTD runs snort version 2.

![FTD Runs Snort Version 2 FMC](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-02.png)

Example 2: The FTD runs snort version 3.

![FTD Runs Snort Version 3 FMC](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-03.png)

### **FTD Managed by the** **Cisco CDO**

In order to determine the active snort version that runs on an FTD that is managed by the Cisco Defense Orchestrator, proceed with the next steps:

1. Log in to the Cisco Defense Orchestrator web interface.
2. From the **Inventory** menu, select the appropriate FTD device.
3. In the **Device Details** section, look for **Snort Version**:

Example 1: The FTD runs snort version 2.

![FTD Runs Snort Version 2 CDO](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-04.png)

Example 2: The FTD runs snort version 3.

![FTD Runs Snort Version 3 CDO](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-05.png)

## Related Information

* [Cisco Firepower Release Notes, Version 6.7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/relnotes/firepower-release-notes-670/m_features_functionality.html)
* [Cisco Firepower Release Notes, Version 7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/relnotes/firepower-release-notes-700/features.html)
* [Snort 3 Website](https://snort.org/snort3)
* [Technical Support & Documentation - Cisco Systems](https://www.cisco.com/c/en/us/support/index.html)

### Revision History

| Revision | Publish Date | Comments |
| --- | --- | --- |
| 2.0 | 17-Jul-2024 | Added Alt Text. Updated Title, Introduction, and Formatting. |
| 1.0 | 23-Apr-2023 | Initial Release |

![TAC Authored](/etc/designs/cdc/fw/i/TAC_lg-icon.png)

### Contributed by Cisco Engineers

* Theresa GrantTechnical Consulting Engineer
* Amber HurstEngineering Program Manager
* Christian HernandeTechnical Consulting Engineer

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)

