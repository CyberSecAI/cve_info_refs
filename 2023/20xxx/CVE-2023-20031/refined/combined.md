=== Content from www.cisco.com_bd0a91a3_20250115_120534.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Configuration Guides](/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting
  Started](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-get-started.html)
* [Best Practices: Use Cases for Threat Defense](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-use-cases.html)
* [Licensing the
  System](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-license.html)
* System Monitoring
  + [Monitoring the
    Device](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-monitor.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-isa3000-alarms.html)
* Reusable Objects
  + [Objects](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-objects.html)
  + [Certificates](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-certificates.html)
  + [Identity Sources](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity-sources.html)
* The Basics
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-logical-devices.html)
  + [High Availability
    (Failover)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ha.html)
  + [Interfaces](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-interfaces.html)
* Routing
  + [Routing Basics and Static Routes](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-routing.html)
  + [Virtual Routers](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-virtual-routers.html)
  + [Route Maps and Other Objects for Route Tuning](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-route-maps.html)
  + [Open Shortest Path First (OSPF)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ospf.html)
  + [Enhanced Interior Gateway Routing Protocol (EIGRP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-eigrp.html)
  + [Border Gateway Protocol (BGP)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-bgp.html)
* Security
  Policies
  + [SSL
    Decryption](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ssl-decryption.html)
  + [Identity
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-identity.html)
  + [Security
    Intelligence](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-sec-intel.html)
  + [Access
    Control](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-access.html)
  + [Intrusion
    Policies](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html)
  + [Network Address
    Translation (NAT)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-nat.html)
* Virtual Private
  Networks (VPN)
  + [Site-to-Site
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-s2svpn.html)
  + [Remote Access
    VPN](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-ravpn.html)
* System
  Administration
  + [System
    Settings](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-system.html)
  + [System
    Management](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-mgmt.html)
* [Advanced
  Configuration](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-advanced.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Device Manager Configuration Guide, Version 7.3 Chapter Title Intrusion Policies

* [PDF - Complete Book
  (18.14 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.pdf)
  [PDF - This Chapter (1.31 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (10.41 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (22.06 MB)](/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 14, 2023

## Chapter: Intrusion Policies

Chapter Contents

* [Intrusion Policies](#topic_1DD700B34ECA40579EC767CC06DBB783)
* [About Intrusion and Network Analysis Policies](#concept_D206F4ED94D94725B2524A2F09C1382D)
  + [System-Defined Network Analysis and Intrusion Policies](#concept_D681E8E136034A9AA863E8389C2A6C03)
  + [Inspection Mode: Prevention vs. Detection](#Cisco_Concept.dita_96f59526-cc5d-4aed-b712-13326d878c5c)
  + [Intrusion and Preprocessor Rules](#concept_07261DA975EA4A91B2BC15C81C19CB62)
    - [Intrusion Rule Attributes](#concept_C4C21B1BDF794F468738C9F836C6C87B)
    - [Default Intrusion Variable Set](#concept_AF54E757E6694EE4B08030A4EA1D737C)
    - [Generator Identifiers](#concept_821B9C87DA8744CB8E3C2375A1DB3C9B)
  + [Network Analysis Policies](#concept_B4CF7ED4D7084213B5D6B176E54FE6A2)
* [License Requirements for Intrusion Policies](#concept_35C1B310E74C40AE808B4DE432B1212F)
* [Applying Intrusion Policies in Access Control Rules](#task_B70596D90ED04906A3D378FC7A943EDB)
* [Switching Between Snort 2 and Snort 3](#id_120089)
* [Configuring Syslog for Intrusion Events](#task_3C0D47785EF24FCB88E6E671705E10E8)
* [Configuring the Network Analysis Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_49189b70-682c-4336-9620-fe104df820f6)
  + [Configuring Inspector and Binder Overrides](#Cisco_Task_in_List_GUI.dita_e6960060-5b51-419d-ac09-fb55545850b3)
  + [Downloading Overrides and the Schema](#Cisco_Task_in_List_GUI.dita_6d5ef939-3834-4b06-acdf-dff2d647758c)
  + [Uploading Overrides](#Cisco_Task_in_List_GUI.dita_e447172f-a47e-4032-8776-549b10eb8c6a)
* [Managing Intrusion Policies (Snort 3)](#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055)
  + [Configuring a Custom Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_577e0181-dbc9-492b-90b8-a4b59bd381f0)
  + [Viewing or Editing Intrusion Policy Properties (Snort 3)](#Cisco_Task_in_List_GUI.dita_6faed926-3676-491a-9639-25912f85d7b3)
  + [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a)
  + [Changing Intrusion Rule Actions (Snort 3)](#Cisco_Task_in_List_GUI.dita_54aef253-02ab-4044-88ea-cea05249686d)
  + [Managing Custom Intrusion Rules and Rule Groups](#Cisco_Task_in_List_GUI.dita_1704f9a7-4642-48db-a5db-1938d5494c4b)
    - [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864)
    - [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e)

- [Managing Intrusion Policies (Snort 2)](#concept_C0EB1AB846C945C38FE3940BBC8803F7)
  * [Configure the Inspection Mode for an Intrusion Policy (Snort 2)](#id_121662)
  * [Changing Intrusion Rule Actions (Snort 2)](#task_4D5DD40DDCE0426C8846E5684287E63B)
- [Monitoring Intrusion Policies](#concept_5A4F2289E52D4E9C8F35A38FE9137C9B)
- [Examples for Intrusion Policies](#concept_34AA9F063DBA418BA3FF055364B3C49D)
Close

# Intrusion Policies

The following topics explain intrusion policies and the closely
associated network analysis policies (NAP). Intrusion policies include rules
that check traffic for threats and block traffic that appears to be an attack.
Network analysis policies control traffic preprocessing, which prepares traffic
to be further inspected by normalizing traffic and identifying protocol
anomalies.

Because preprocessing and intrusion inspection are so closely related,
the network analysis and intrusion policies examining a single packet must
complement each other.

* [About Intrusion and Network Analysis Policies](#concept_D206F4ED94D94725B2524A2F09C1382D)
* [License Requirements for Intrusion Policies](#concept_35C1B310E74C40AE808B4DE432B1212F)
* [Applying Intrusion Policies in Access Control Rules](#task_B70596D90ED04906A3D378FC7A943EDB)
* [Switching Between Snort 2 and Snort 3](#id_120089)
* [Configuring Syslog for Intrusion Events](#task_3C0D47785EF24FCB88E6E671705E10E8)
* [Configuring the Network Analysis Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_49189b70-682c-4336-9620-fe104df820f6)
* [Managing Intrusion Policies (Snort 3)](#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055)
* [Managing Intrusion Policies (Snort 2)](#concept_C0EB1AB846C945C38FE3940BBC8803F7)
* [Monitoring Intrusion Policies](#concept_5A4F2289E52D4E9C8F35A38FE9137C9B)
* [Examples for Intrusion Policies](#concept_34AA9F063DBA418BA3FF055364B3C49D)

## About Intrusion and Network Analysis Policies

Network analysis and intrusion policies work together to detect and
prevent intrusion threats.

* A network analysis policy (NAP) governs how traffic is decoded and
  preprocessed so that it can be further evaluated, especially for anomalous
  traffic that might signal an intrusion attempt.
* An intrusion policy uses intrusion and preprocessor rules, which are
  collectively known as intrusion rules, to examine the decoded packets for
  attacks based on patterns. The rules can either prevent (drop) the threatening
  traffic and generate an event, or simply detect (alert) it and generate an
  event only.

As the system analyzes traffic, the network analysis decoding and
preprocessing phase occurs before and separately from the intrusion prevention
phase. Together, network analysis and intrusion policies provide broad and deep
packet inspection. They can help you detect, alert on, and protect against
network traffic that could threaten the availability, integrity, and
confidentiality of hosts and their data.

* [System-Defined Network Analysis and Intrusion Policies](#concept_D681E8E136034A9AA863E8389C2A6C03)
* [Inspection Mode: Prevention vs. Detection](#Cisco_Concept.dita_96f59526-cc5d-4aed-b712-13326d878c5c)
* [Intrusion and Preprocessor Rules](#concept_07261DA975EA4A91B2BC15C81C19CB62)
* [Network Analysis Policies](#concept_B4CF7ED4D7084213B5D6B176E54FE6A2)

### System-Defined Network Analysis and Intrusion Policies

The system includes several pairs of same-named network analysis and intrusion policies that complement and work with each
other. For example there are both NAP and intrusion policies named “Balanced Security and Connectivity,” which are meant to
be used together. The system-provided policies are configured by the Cisco Talos Intelligence Group
(Talos). For these policies, Talos sets the intrusion and preprocessor rule states and provides the initial configurations for preprocessors and other advanced
settings.

As new vulnerabilities become known, Talos releases intrusion rule updates. These rule updates can modify any system-provided network analysis or intrusion policy,
and can provide new and updated intrusion rules and preprocessor rules, modified states for existing rules, and modified default
policy settings. Rule updates might also delete rules from system-provided policies and provide new rule categories, as well
as modify the default variable set.

You can manually update the rules database, or configure a regular
update schedule. You must deploy an update for it to take effect. For more
information on updating system databases, see
[Updating System Databases](fptd-fdm-mgmt.html#id_11511).

The following are the system-provided policies:

Balanced Security and Connectivity network analysis and intrusion
policies

These policies are built for both speed and detection. Used
together, they serve as a good starting point for most networks and deployment
types. The system uses the Balanced Security and Connectivity network analysis
policy as the default.

Connectivity Over Security network analysis and intrusion policies

These policies are built for networks where connectivity, the
ability to get to all resources, takes precedence over network infrastructure
security. The intrusion policy enables far fewer rules than those enabled in
the Security over Connectivity policy. Only the most critical rules that block
traffic are enabled.

Security Over Connectivity network analysis and intrusion policies

These policies are built for networks where network infrastructure
security takes precedence over user convenience. The intrusion policy enables
numerous network anomaly intrusion rules that could alert on or drop legitimate
traffic.

Maximum Detection network analysis and intrusion policies

These policies are built for networks where network infrastructure
security is given even more emphasis than is given by the Security Over
Connectivity policies, with the potential for even greater operational impact.
For example, the intrusion policy enables rules in a large number of threat
categories including malware, exploit kit, old and common vulnerabilities, and
known in-the-wild exploits.

### Inspection Mode: Prevention vs. Detection

By default, all intrusion policies operate in Prevention mode to implement an Intrusion
Prevention System (IPS). In the Prevention inspection mode, if a connection matches an
intrusion rule whose action is to drop traffic, the connection is actively blocked.

If you instead want to test the effect of the intrusion policy on your network, you can
change the mode to Detection, which implements an Intrusion Detection System (IDS). In
this inspection mode, drop rules are treated like alert rules, where you are notified of
matching connections, but the action result becomes Would Have Blocked, and connections
are never in fact blocked.

You change the inspection mode per intrusion policy, so you can have a mix of prevention
and detection.

The Snort 3 network analysis policy (NAP) also has an
inspection mode. Unlike the intrusion policy, the NAP policy is global, so you must run
all NAP processing in either Prevention or Detection mode. You should use the same mode
you use for your intrusion policies. If you have a mix of Prevention and Detection
policies, select Prevention to match your most restrictive intrusion policies.

### Intrusion and Preprocessor Rules

An intrusion rule is a specified set of keywords and arguments that the
system uses to detect attempts to exploit vulnerabilities in your network. As
the system analyzes network traffic, it compares packets against the conditions
specified in each rule, and triggers the rule if the data packet meets all the
conditions specified in the rule.

The system includes the following types of rules created by Cisco Talos Intelligence Group
(Talos):

* Intrusion rules, which are subdivided into shared object rules and
  standard text rules
* Preprocessor rules, which are rules associated with preprocessors
  and packet decoder detection options in the network analysis policy. Most
  preprocessor rules are disabled by default.

The following topics explain intrusion rules in more depth.

* [Intrusion Rule Attributes](#concept_C4C21B1BDF794F468738C9F836C6C87B)
* [Default Intrusion Variable Set](#concept_AF54E757E6694EE4B08030A4EA1D737C)
* [Generator Identifiers](#concept_821B9C87DA8744CB8E3C2375A1DB3C9B)

#### Intrusion Rule Attributes

When you view an intrusion policy, you see a list of all the intrusion rules available for
identifying threats.

The list of rules for each policy is the same. The difference is in the action configured for each rule. Because there are
over 30,000 rules, scrolling through the list will take time. Rules are revealed as you scroll through the list.

Following are the
attributes that define each rule:

> (Signature
Description)

Click the > button in the left column to open the signature description. The description is the actual code used by the Snort inspection
engine to match traffic against the rule. Explaining the code is out of scope for this document, but it is explained in detail
in Management Center Configuration Guide; select the book for your software version from <http://www.cisco.com/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html>. Look for information on intrusion rule editing.

The signatures
contain variables for certain items. For more information, see
[Default Intrusion Variable Set](#concept_AF54E757E6694EE4B08030A4EA1D737C).

GID

Generator Identifier (ID). This number indicates which system component evaluates the rule
and generates events. A 1 indicates a standard text intrusion rule, a 3
indicates a shared object intrusion rule. (The difference in these rule
types is not meaningful for a device
manager user.) These are the main rules of interest when configuring an intrusion
policy. For information on the other GIDs, see [Generator Identifiers](#concept_821B9C87DA8744CB8E3C2375A1DB3C9B).

SID

Snort Identifier (ID), also called signature ID. Snort IDs lower than 1000000 were created by the Cisco Talos Intelligence Group
(Talos).

Action

The state of
this rule in the selected intrusion policy. For each rule, “(Default)” is added
to the action that is the default action for the rule within this policy. To
return a rule to its default setting, you select this action. Possible actions
are:

* Alert—Create an
  event when this rule matches traffic, but do not drop the connection.
* Drop—Create an
  event when this rule matches traffic, and also drop the connection.
* Disabled—Do not
  match traffic against this rule. No events are generated.

Status

For Snort 2 rules, Status is a separate column. If you change the default
action for a rule, this column shows “Overridden.” Otherwise, the column is
empty.

For Snort 3 rules, the “Overridden” status is shown at the bottom of the
Action attribute, if you changed it.

Message

This is the name
of the rule, which also appears in events triggered by the rule. The message
typically identifies the threat that the signature matches. You can search the
Internet for more information on each threat.

#### Default Intrusion Variable Set

The intrusion rule
signatures contain variables for certain items. Following are the default
values for the variables, with $HOME\_NET and $EXTERNAL\_NET being the most
commonly used variables. Note that the protocol is specified separately from
port numbers, so port variables are numbers only.

* $DNS\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $EXTERNAL\_NET =
  any IP address.
* $FILE\_DATA\_PORTS =
  $HTTP\_PORTS, 143, 110.
* $FTP\_PORTS = 21,
  2100, 3535.
* $GTP\_PORTS = 3386,
  2123, 2152.
* $HOME\_NET = any IP
  address.
* $HTTP\_PORTS = 144
  ports numbered: 36, 80-90, 311, 383, 443, 555, 591, 593, 631, 666, 801, 808,
  818, 901, 972, 1158, 1212, 1220, 1414, 1422, 1533, 1741, 1830, 1942, 2231,
  2301, 2381, 2578, 2809, 2980, 3029, 3037, 3057, 3128, 3443, 3507, 3702, 4000,
  4343, 4848, 5000, 5117, 5222, 5250, 5450, 5600, 5814, 6080, 6173, 6767, 6988,
  7000, 7001, 7005, 7071, 7080, 7144, 7145, 7510, 7770, 7777-7779, 8000, 8001,
  8008, 8014, 8015, 8020, 8028, 8040, 8060, 8080-8082, 8085, 8088, 8118, 8123,
  8161, 8180-8182, 8222, 8243, 8280, 8300, 8333, 8344, 8400, 8443, 8500, 8509,
  8787, 8800, 8888, 8899, 8983, 9000, 9002, 9060, 9080, 9090, 9091, 9111, 9290,
  9443, 9447, 9710, 9788, 9999, 10000, 11371, 12601, 13014, 15489, 19980, 23472,
  29991, 33300, 34412, 34443, 34444, 40007, 41080, 44449, 50000, 50002, 51423,
  53331, 55252, 55555, 56712.
* $HTTP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $ORACLE\_PORTS =
  any
* $SHELLCODE\_PORTS =
  180.
* $SIP\_PORTS = 5060,
  5061, 5600
* $SIP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SMTP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SNMP\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SQL\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $SSH\_PORTS = 22.
* $SSH\_SERVERS =
  $HOME\_NET (meaning any IP address).
* $TELNET\_SERVERS =
  $HOME\_NET (meaning any IP address).

#### Generator Identifiers

The generator identifier (GID) identifies the subsystem that
evaluates an intrusion rule and generates events. Standard text intrusion rules
have a generator ID of 1, and shared
object intrusion rules have a generator ID of 3. There are also several sets of
rules for various preprocessors. The following table explains the GIDs.

Table 1. Generator IDs

| ID | Component |
| --- | --- |
| 1 | Standard Text Rule. |
| 2 | Tagged Packets.  (Rules for the Tag generator, which generates packets from a tagged session. ) |
| 3 | Shared Object Rule. |
| 102 | HTTP Decoder. |
| 105 | Back Orifice Detector. |
| 106 | RPC Decoder. |
| 116 | Packet Decoder. |
| 119, 120 | HTTP Inspect Preprocessor.  (GID 120 rules relate to server-specific HTTP traffic.) |
| 122 | Portscan Detector. |
| 123 | IP Defragmentor. |
| 124 | SMTP Decoder.  (Exploits against SMTP verbs.) |
| 125 | FTP Decoder. |
| 126 | Telnet Decoder. |
| 128 | SSH Preprocessor. |
| 129 | Stream Preprocessor. |
| 131 | DNS Preprocessor. |
| 133 | DCE/RPC Preprocessor. |
| 134 | Rule Latency, Packet Latency.  (Events for these rules are generated when rule latency suspends (SID 1) or re-enables (SID 2) a group of intrusion rules, or when the system stops inspecting a packet because the packet latency threshold is exceeded (SID 3).) |
| 135 | Rate-Based Attack Detector.  (Excessive connections to hosts on the network.) |
| 137 | SSL Preprocessor. |
| 138, 139 | Sensitive Data Preprocessor. |
| 140 | SIP Preprocessor. |
| 141 | IMAP Preprocessor. |
| 142 | POP Preprocessor. |
| 143 | GTP Preprocessor. |
| 144 | Modbus Preprocessor. |
| 145 | DNP3 Preprocessor. |

### Network Analysis Policies

Network analysis policies control traffic preprocessing. Preprocessors prepare traffic to be
further inspected by normalizing traffic and identifying protocol anomalies. Network
analysis-related preprocessing occurs after Security Intelligence drops and SSL
decryption, but before access control and intrusion or file inspection.

By default, the system uses the Balanced Security and Connectivity network analysis
policy to preprocess all traffic handled by the access control policy. However, if
you configure an intrusion policy on any access control rule, the system uses the
network analysis policy that matches the most aggressive intrusion policy applied.
For example, if you use both Security over Connectivity and Balanced policies in
your access control rules, the system uses the Security over Connectivity NAP for
all traffic. For Snort 3 custom intrusion
policies, this assignment is done according to the base template policy assigned
to the intrusion policy.

When using Snort 3, you can select a policy explicitly and optionally customize its
settings. We recommend that you select the policy whose name matches the intrusion
policy that you use for most traffic that goes through the device, whether you use
the intrusion policy directly, or you use it as the base policy in your custom
intrusion policies. You can then change the inspection mode, or adjust specific
inspector or binder settings to account for the traffic on your network.

In addition, consider whether you have enabled preprocessor rules in the intrusion
policy. If you enable rules that require a preprocessor, ensure that you also enable
the corresponding inspector in the NAP. For each inspector, you can also adjust the
attributes for the inspector, including the ports examined (the binders), to
customize inspector behavior for your network.

| **Note** | ---   If you are using Snort 2, the system uses the same-named NAP policy as the most restrictive intrusion policy you apply in any access control rule, and you cannot edit inspector or binder settings.   --- |
| --- | --- |

## License Requirements for Intrusion Policies

You must enable the **IPS** license to apply intrusion policies in access control rules. For information on configuring licenses, see [Enabling or Disabling Optional Licenses](fptd-fdm-license.html#id_12247).

No extra license is needed for network analysis policies.

## Applying Intrusion Policies in Access Control Rules

To apply intrusion
policies to network traffic, you select the policy within an access control
rule that allows traffic. You do not directly assign intrusion policies.

You can assign
different intrusion policies to provide variable intrusion protection based on
the relative risks of the networks you are protecting. For example, you might
use the more stringent Security over Connectivity policy for traffic between
your inside network and external networks. On the other hand, you might apply
the more lenient Connectivity over Security policy for traffic between inside
networks.

You can also
simplify your configuration by using the same policy for all networks. For
example, the Balanced Security and Connectivity policy is design to provide
good protection without excessively impacting connectivity.

### Procedure

---

| **Step 1** | Select Policies > Access Control. |
| --- | --- |
| **Step 2** | Either create a new rule, or edit an existing rule, that allows traffic.  If the default action is allow, you can also specify an intrusion policy in the default action.  You cannot apply intrusion policies to rules that trust or block traffic. |
| **Step 3** | Click the Intrusion Policy tab. |
| **Step 4** | Select Intrusion Policy > On and select the intrusion inspection policy to use on matching traffic. |

---

## Switching Between Snort 2 and Snort 3

Snort is the main inspection engine for the product. Although you can switch Snort
versions freely, some intrusion rules in Snort 2.0 might not exist in Snort 3.0, and
vice versa. If you changed the rule action for one of these rules, that change is
not preserved if you switch to Snort 3 and then back to Snort 2, or back again to
Snort 3. Your changes to rule actions for rules that exist in both versions are
preserved. Note that the mapping between rules in Snort 3 vs. Snort 2 can be
one-to-one or one-to-many, so preservation of changes is done on a best effort
basis.

If you change the Snort version, the system will perform an automatic deployment to implement the change. You can see the
progress in the Task list. The tasks are Snort Version Change and Automatic Deployment—Snort version toggle. Because of the
deployment and the fact that Snort must be stopped and restarted, all existing connections, including VPN, are dropped and
must be reestablished, which will cause a momentary traffic loss.

| **Note** | ---   If you try to switch Snort versions and the switch fails, you will have pending changes that you cannot discard, and a subsequent toggle attempt will not be allowed. If this happens, you must complete the switch using the ToggleInspectionEngine API, which you can use from the API Explorer. You must set the bypassPendingChangeValidation attribute to TRUE.   --- |
| --- | --- |

### Before you begin

To determine which Snort version is currently enabled, use this procedure, or choose Policies > Intrusion. Look for the Snort Version line above the
table. The current version is the first number in the complete version number. For
example, 2.9.17-95 is a Snort 2 version.

If the device is in an air-gapped network, consider manually uploading the latest
rules package for the new version before switching.

If you downgrade to 2.0, any custom intrusion policies that you created are converted
to the base policy used in the custom policy. As far as possible, rule action
overrides are retained. If more than one custom policy uses the same base policy,
the overrides of the custom policy that is used in the most access control policies
are retained, and the overrides for the other custom policies are lost. Access
control rules that used these "duplicate" policies will now use the base policy
created from your most-used custom policy. All custom policies are deleted. If you
want to preserve the custom policies so that you can import them later, after
switching back to Snort 3, use the threat
defense API to export the configuration.

In addition, a downgrade to 2.0 removes any NAP
customizations, and the system switches to use the most appropriate NAP based on the
intrusion policies used in access control rules.

Hostname redirect in active authentication also
requires Snort 3, and will be removed if you switch to Snort 2.

You must deploy any pending changes before you can switch Snort versions.

### Procedure

---

| **Step 1** | Choose Device, then click View Configuration in the Updates summary.  Look at the Intrusion Rule group. The current Snort version is indicated. |
| --- | --- |
| **Step 2** | In the Intrusion Rule group, you can change the Snort version by clicking Upgrade to Snort 3.0 or Downgrade to Snort 2.0. |
| **Step 3** | When prompted to confirm your action, select the option to get the latest intrusion rules package, then click Yes.  We recommend that you get the latest rules package. The system downloads packages for the active Snort version only, so it is unlikely that you have the latest package installed for the Snort version you are switching to.  You must wait until the task to switch versions completes before you can edit intrusion policies. |

---

## Configuring Syslog for Intrusion Events

You can configure an external syslog server for intrusion policies to
send intrusion events to your syslog server. You must configure the syslog
server on the intrusion policy to get intrusion events sent to the server.
Configuring a syslog server on an access rule sends connection events only to
the syslog server, not intrusion events.

If you select multiple syslog servers, events are
sent to each of the servers.

Intrusion events have the message ID 430001.

### Procedure

---

| **Step 1** | Select Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the Intrusion Policy Settings button (Gear/Settings button.) to configure syslog. |
| **Step 3** | Click the + button under Send Intrusion Events To and select the server objects that define the syslog servers. If the required objects do not already exist, click Create New Syslog Server and create them. |
| **Step 4** | Click OK. |

---

## Configuring the Network Analysis Policy (Snort 3)

The Network Analysis Policy (NAP) is applied to all allowed connections on the
device. The NAP determines which inspectors are enabled, and the values of the
attributes used by the inspectors. The binders determine the ports and protocols
that should be associated with the various inspectors.

Coordinate the NAP with the intrusion policies you apply in access control rules:

* If you use a single intrusion policy in your access control rules, select the
  same-named NAP. Then, make adjustments to inspectors and attributes based on
  the settings in your intrusion policy. For example, if you enable intrusion
  rules for a particular inspector, such as CIP, ensure that you enable that
  inspector in the NAP.
* If you use multiple intrusion policies, select the NAP that matches the most
  strict intrusion policy that you use.
* If you use custom intrusion policies, make your NAP selection based on the
  base intrusion policy for your custom intrusion policies.
* If you do not need to customize any inspectors or binders, consider
  configuring the system to automatically select the most appropriate NAP
  based on your intrusion policy usage. This is the default option.

### Before you begin

Unless you prevent it, the system regularly downloads LSP updates to the inspection
rules. These updates can add or remove inspectors and attributes, and change default
settings for attributes. If you have made overrides to removed inspectors, these
overrides are preserved and you will see warnings that the inspector is no longer
supported. In this case, delete the inspector and make any other flagged adjustments
to ensure your NAP is completely valid.

### Procedure

---

| **Step 1** | Choose Policies > Intrusion.  Verify that the Snort version shown above the table is 3.x. |
| --- | --- |
| **Step 2** | Click the Intrusion Policy Settings button (Gear/Settings button.). |
| **Step 3** | In Default Network Analysis Policy, select one of the following:   * Auto—Automatically select the NAP that matches   the most-used intrusion policy (or base policy for custom rules)   applied in access control rules. If you do not apply any intrusion   policies, the Balanced Security and Connectivity NAP is used. The   NAP is run in Prevention mode, and you cannot customize intrusion or   binder settings. The remainder of this procedure does not apply when   running in automatic mode. * Custom—Explicitly select the NAP that should   be used. Click the Edit link next to the   policy name to select a different policy. You can then select the   inspection mode, and customize inspector and binder settings, as   described in the following steps. |
| **Step 4** | In the Edit Network Analysis Policy dialog box, select the policy and configure its settings.   1. In Network Analysis Policy, select the policy    that should apply globally to all allowed connections. 2. Select the Inspection Mode.  The inspection mode determines how non-compliant traffic is handled.    Use the same inspection mode as you use in your intrusion policies    for optimal results.     * Prevention—Block any decoder,      normalization, or protocol anomalies based on the settings      in the policy. You must use this option if you enable the      SSL Decryption policy, or if you enable the TLS      Server Identity Discovery option in the      access control policy settings.    * Detection—Simply issue alerts for      decoder, normalization, or protocol anomalies. Do not block      any traffic. 3. (Optional.) Configure and manage overrides to the inspectors and    binders:     * To edit overrides, see [Configuring Inspector and Binder Overrides](#Cisco_Task_in_List_GUI.dita_e6960060-5b51-419d-ac09-fb55545850b3).    * To download the schema or overrides, see [Downloading Overrides and the Schema](#Cisco_Task_in_List_GUI.dita_6d5ef939-3834-4b06-acdf-dff2d647758c).    * To upload overrides, see [Uploading Overrides](#Cisco_Task_in_List_GUI.dita_e447172f-a47e-4032-8776-549b10eb8c6a).    * To reset all the overrides, click the Reset      Inspector/Binder Overrides link above the      NAP file. You are asked to confirm the reset. The deletion      is limited to inspectors or binders, as indicated in the      command name. For example, deleting all binder overrides      leaves your inspector overrides unchanged.    * To reverse all changes to the selected inspector, click      Reset Inspector to      Defaults.    * To filter the view so you see only those inspectors that have      overrides, click Show Only Overrides.      Click Show All Inspectors to remove      the filter. 4. Click OK. |

---

### Configuring Inspector and Binder Overrides

When you select a base NAP, you are selecting inspector settings contained in that
baseline policy. In most cases, these are the appropriate settings.

However, you can override the settings in the selected NAP. For example, you can
enable or disable individual inspectors, or change the value for an attribute or a
binder.

The following procedure explains how to configure overrides directly. Alternatively,
you can download the schema, make changes offline, then upload your overrides. You
can also upload the overrides you downloaded from another device.

#### Before you begin

Explaining each inspector, binder, and attribute is beyond the scope of this
document. For detailed information, including examples, see Snort 3 Inspector
Reference at <https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/snort3-inspectors/snort-3-inspector-reference.html>.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion, click the  Intrusion Policy Settings button (Gear/Settings button. ), select Custom for the NAP settings, then click the Edit link next to the policy name. |
| --- | --- |
| **Step 2** | Click the tab that contains the setting you want to change:   * Inspectors—The inspectors examine specific   types of traffic, such as FTP, for protocol anomalies. * Binders—The Binder inspector determines when a   service inspector needs to be used to inspect traffic. The   configurations in the binder inspector include the ports, hosts,   CIDRs, and services that define when another inspector in the   network analysis policy needs to inspect traffic. |
| **Step 3** | Edit the settings as needed.   * Use the following to control the view in the JSON editor:    + Use the Filter edit box to do a     full-text search of the JSON file.   + Click the Expand All Fields button     (Expand all fields) to open all of the folders in the JSON file.   + Click the Collapse All Fields (Collapse all fields) button to close all folders in the JSON file.   + Click the Undo Last Action (Undo last action) button to reverse your most recent change.   + Click the Redo (Redo) button to redo your last reversed change.   + Select Tree to see a formatted view of     the JSON file, which includes action menus, error flags, and     other features to guide your edits.   + Select Code to see the raw JSON file. * In Tree view, click the Menu (JSON menu) button to manipulate the contents of the file. You can:    + Insert attributes. Use Auto to have     the editor determine the appropriate data type. Otherwise,     add an Array, Object, or String. If you add an invalid     attribute, the system will mark the inspector or binder as     having a problem that you must resolve.   + Append attributes. This action does     the same as Insert, but puts the attribute at the end of the     section.   + Duplicate the selected attribute.   + Remove (delete) the selected     attribute. When editing an attribute, a popup message might     also provide a Delete command. * To enable an inspector that is currently disabled, or change the   setting of any Boolean attribute, click the checkbox in front of the   attribute value. For example, to enable an inspector, change the   enabled : false attribute to:    Enabled set to true. * To change the value of a string or numeric attribute, click in the   attribute and edit the value as needed. If your entry violates the   rules for the field, error messages explain the discrepancy. For   example, a numeric value indicates the valid range of values if you   enter a value outside the range. * To reset overrides:    + Click Reset Inspector/Binder Overrides     to remove all of your changes to all inspectors or binders     and return to default values. The deletion is limited to     inspectors or binders, as indicated in the command name. For     example, deleting all binder overrides leaves your inspector     overrides unchanged.   + Click Reset Inspector to     Defaults to reverse all changes to the     selected inspector only. * To filter the view so you see only those inspectors that have   overrides, click Show Only Overrides. Click   Show All Inspectors to remove the filter. * If an inspector is no longer supported, the inspector is flagged with   a message. Click the Delete Inspector link in   the message to remove the inspector. |
| **Step 4** | Click OK when finished. |

---

### Downloading Overrides and the Schema

You can download the NAP schema, or download the overrides you have configured for
the policy.

Downloading overrides is recommended whenever you change the base NAP, in case you
want to go back to your previous settings. In addition, you could use the JSON
editor on one device to implement the overrides you want to use on all devices,
download the overrides, then upload that override file to other devices.

Downloading the schema is useful if you want to edit the file offline, then upload
your overrides to this device or to multiple devices. You should copy/paste just the
sections you need to change, rather than upload the entire file, to ensure only
those changes you make are considered overrides.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion, click the  Intrusion Policy Settings button (Gear/Settings button. ), select Custom for the NAP settings, then click the Edit link next to the policy name. |
| --- | --- |
| **Step 2** | Do one of the following:   * To download the schema for the currently-select NAP, click the gear   icon (Gear/Settings button.) and select Download > Policy Schema. * To download the saved set of overrides, as they existed prior to the   current editing session, click the gear icon (Gear/Settings button.) and select Download > Last Saved Overrides. The file includes overridden attributes plus their   containing objects. * To download the overrides you have created in the current editing   session, click the gear icon (Gear/Settings button.) and select Download > Current Unsaved Overrides. The file includes overridden attributes plus their   containing objects. |

---

### Uploading Overrides

Rather than editing attributes using the embedded JSON editor, you can download the
NAP policy schema, edit the file offline, then upload the file. Any overrides
configured in the uploaded file are then applied to the selected NAP.

You can also upload a file you downloaded after configuring overrides on another
device.

By uploading your overrides, you can upload the same file to multiple devices and
easily apply the same overrides.

#### Before you begin

For overriding an inspector configuration in the network analysis policy, you should
upload only the changes that you require. You should not upload the entire
configuration because it makes the overrides sticky in nature and therefore, any
subsequent changes to the default values or configuration as part of the LSP updates
would not be applied. Ensure that your uploaded overrides are tightly focused on
just those attributes you want to change.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion, click the  Intrusion Policy Settings button (Gear/Settings button. ), select Custom for the NAP settings, then click the Edit link next to the policy name. |
| --- | --- |
| **Step 2** | Click the gear icon (Gear/Settings button.) and select Upload > Overrides. |
| **Step 3** | (Optional.) Click one of the Download links to save a copy of your existing overrides.  You can either download the last saved overrides (those made before the current editing session) or the current unsaved overrides (those made during the current editing session). |
| **Step 4** | Click Yes on the Confirm Upload Overrides dialog box to confirm you want to continue. |
| **Step 5** | Click Browse, or drag and drop, to select the JSON file that contains your overrides, and click OK. |

---

## Managing Intrusion Policies (Snort 3)

When you use Snort 3 as the inspection engine, you can create your own intrusion
policies and customize them for your purposes. The system comes with pre-defined
policies that are based on the same-named Cisco Talos Intelligence Group
(Talos)-defined policies. Although you can edit these policies, a better practice is to
create your own policy based on the underlying Talos policy and change that if you need to adjust rule actions.

Each of these pre-defined policies includes the same list of intrusion rules (also
known as signatures), but they differ in the actions taken for each rule. For
example, a rule might be enabled in one policy, but disabled in another policy.

If you find that a particular rule is giving you too many false positives, where the
rule is blocking traffic that you do not want blocked, you can disable the rule
without needing to switch to a less-secure intrusion policy. You could alternatively
change it to alert on matches without dropping traffic.

Conversely, if you know you need to protect against a specific attack, but the
related rule is disabled in your chosen intrusion policy, you can enable the rule
without changing to a more secure policy.

Use the intrusion related dashboards, and the Event Viewer (both on the
Monitoring page), to evaluate how intrusion rules are
impacting traffic. Keep in mind that you will see intrusion events and intrusion
data only for traffic that matches intrusion rules set to alert or drop; disabled
rules are not evaluated.

| **Note** | ---   If you switch to Snort 2, you cannot create custom policies, and the use of intrusion policies differs slightly. Instead of this topic, see [Managing Intrusion Policies (Snort 2)](#concept_C0EB1AB846C945C38FE3940BBC8803F7).   --- |
| --- | --- |

### Procedure

---

| **Step 1** | Choose Policies > Intrusion.  Verify that the Snort version shown above the table is 3.x. |
| --- | --- |
| **Step 2** | Do any of the following:   * Use the Search/Filter box to find a policy.   You can search by name only. * Click the gear icon (Gear/Settings button.) to enable logging to a syslog server. See [Configuring Syslog for Intrusion Events](#task_3C0D47785EF24FCB88E6E671705E10E8). * Click the gear icon (Gear/Settings button.) to configure the network analysis policy (NAP). See [Configuring the Network Analysis Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_49189b70-682c-4336-9620-fe104df820f6). * Click + to create a new policy. See [Configuring a Custom Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_577e0181-dbc9-492b-90b8-a4b59bd381f0). * Click the edit icon (edit icon) to see the properties and rules in the policy, and to edit them.   See [Viewing or Editing Intrusion Policy Properties (Snort 3)](#Cisco_Task_in_List_GUI.dita_6faed926-3676-491a-9639-25912f85d7b3). * Click the delete icon (delete icon) to delete a policy. |

---

* [Configuring a Custom Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_577e0181-dbc9-492b-90b8-a4b59bd381f0)
* [Viewing or Editing Intrusion Policy Properties (Snort 3)](#Cisco_Task_in_List_GUI.dita_6faed926-3676-491a-9639-25912f85d7b3)
* [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a)
* [Changing Intrusion Rule Actions (Snort 3)](#Cisco_Task_in_List_GUI.dita_54aef253-02ab-4044-88ea-cea05249686d)
* [Managing Custom Intrusion Rules and Rule Groups](#Cisco_Task_in_List_GUI.dita_1704f9a7-4642-48db-a5db-1938d5494c4b)

### Configuring a Custom Intrusion Policy (Snort 3)

You can create new intrusion policies to customize rule behavior if the pre-defined
policies do not fit your needs. In general, it is good practice to create custom
policies based on the pre-defined policies rather than to alter those policies. This
ensures you can easily implement one of the Cisco Talos defined policies if you find
that your customizations do not deliver the results that you need.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Do one of the following:   * To create a new policy, click +. * To edit an existing policy, click the edit icon (edit icon) for the policy. When you are shown the policy details, click the   Edit link in the policy properties   section at the top of the page. |
| **Step 3** | Enter a Name, and optionally, a description for the policy. |
| **Step 4** | Configure the Inspection Mode for the policy.   * Prevention—Intrusion rule actions are always   applied. Connections that match a drop rule are blocked. * Detection—Intrusion rules generate alerts   only. A connection that matches a drop rule will generate alert   messages, but the connection will not be blocked. |
| **Step 5** | Select the Base Template for the policy.  The base templates are provided by Cisco Talos. Click the info icon for each to see more information about the policies. Note that policy names can change, and new policies appear, when a new rules package gets installed.   * Maximum Detection (Cisco Talos)—This policy   places all emphasis on security. Network connectivity and throughput   is not guaranteed and false positives are likely. This policy should   only be used for high security areas and security monitors must be   prepared to investigate alerts to determine their validity. * Security Over Connectivity (Cisco Talos)—This   policy places an emphasis on security, at the possible expense of   network connectivity and throughput. Traffic is inspected more   deeply, more rules are evaluated, and both false positives and   increased latency are expected but within reason. * Balanced Security and Connectivity (Cisco   Talos)—(Default.) This policy attempts to strike the   delicate balance between network connectivity and throughput and the   needs of security. While not as strict as Security Over   Connectivity, this policy attempts to keep users secure while being   less obtrusive about normal traffic. * Connectivity Over Security (Cisco Talos)—This   policy places an emphasis on network connectivity and throughput, at   the possible expense of security. Traffic is inspected less deeply,   and fewer rules are evaluated. * No Rules Active (Cisco Talos)—This policy is a   basic policy that configures typical preprocessor settings but does   not have any rules or built-in alerts enabled. Use this policy as a   base if you want to ensure that only those policies you want to   apply are enabled. |
| **Step 6** | Click OK.  You are returned to the intrusion policy list. You can now view the new policy and adjust rule actions as needed. |

---

### Viewing or Editing Intrusion Policy Properties (Snort 3)

The Intrusion Policy page shows a list of the policies, including both pre-defined
and user-defined policies, and their descriptions. To edit a policy, you must first
view the policy's properties.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  The policy contains the following sections:   * Policy Name drop-down list.    + You can easily switch to a different policy by selecting it     from the drop-down list, or return to the list of policies     by clicking the back button (Go Back to Virtual Routers arrow.).   + You can delete this policy by clicking the delete icon next     to the policy name (delete icon). * General properties. This section shows the   intrusion mode, base policy, and description. Click   Edit to change these properties or the   policy name. * Rule Group table of contents. This list   displays all the rule groups that have active rules in the policy.   The groups have a hierarchy, with parent groups containing child   groups that organize subsets of rules within the larger parent   group. Each group is a logical collection of rules, and a given rule   can appear in more than one group.    + To add a group that currently has no active rules in the     policy, click + > Add Existing Rule Group and select the group. See [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a).   + To change the security level of a group, select the child     group in the list. The rule list changes to show the     security level at the top, with the rules in the group     listed below. Click the Edit link     next to the security level and select a new level. Click     View Description when editing to     get information about each security level. Note that     changing the level can change which rules are active, and     also the action for a given rule, with more secure levels     tending to have more active rules and more rules with the     Drop action. Click OK to confirm the     change. (Security Level     does not apply to custom rule groups.)      Changing the security level for an existing rule group.   + To remove all the rules in a group, select the child group in     the list. Then, click the Exclude     link to the far right of the group name and confirm that you     want to exclude the group. Excluding the group simply     disables all the rules in the group. It does not delete the     group.  However, if the group includes rules that are shared with     other groups that are enabled, the shared rules retain     whatever actions are applied by the still-active group. In     all cases, we retain your most aggressive setting for an     individual rule, regardless of group membership.   + To add a new custom rule group of custom rules, click + > Upload Custom Rules. For details, see [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864).   + To change the name or description of a custom rule group,     click Edit.   + To delete a custom rule group, click     Delete. For more information, see     [Managing Custom Intrusion Rules and Rule Groups](#Cisco_Task_in_List_GUI.dita_1704f9a7-4642-48db-a5db-1938d5494c4b).   + To add a new custom rule in a custom rule group, click     + above the rule table. See [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e).   + To edit, duplicate, delete, or manage group membership for a     custom rule, mouse over the right of the rule and click the     appropriate button or command. For more information, see     [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e). * List of rules. You can use the search field to   help you find rules using full-text search. You can also select   filtering items to search on any combination of GID or SID, show only user defined rules   (those you added),    show only those rules whose actions are overridden, or   simply show rules based on their actions (disabled, alert, drop).   The rules are lazy-loaded, so it will take quite a bit of time to   scroll through the entire unfiltered list. When filtering the list,   click the refresh button to reload the filtered view.    + To change the action for a rule, click the     Action cell for the rule and     select the new action, to Alert only,     to Block matching traffic, or to     Disable the rule. The default     action for each rule is indicated.   + To change the action for more than one rule at a time, click     the check box in the left column of the rules you want to     change, then select the new action from the     Action drop-down list above the     rules table. Click the check box in the GID:SID header to     select all the rules in the list. You can change up to 5000     rules at a time.   + To update the rules within a custom rule group, click     Upload Rule File. For more     information, see [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864).   + To get more information about a rule, click the link in the     GID:SID cell. The link takes you     to Snort.org.   + To change the rules listed, you can click a child group from     the rule group table of contents (not a parent group). You     can return to the all-rules list by clicking ALL     RULES at the top of the rule group list.   + To change the sorting order, click the table header for a     column. The default sorting for the rules is overridden     rules first, then drop rules, then alert rules.   + To see what changes where made in an intrusion rule (LSP)     update, select LSP Update in the     filter field, then select the updates whose changes you want     to see, and specify whether you want to see all changes, or     just additions or changes to the rules. |

---

### Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)

Intrusion rules are organized in local groups. There is a hierarchy to the groups,
with parent groups containing related child groups. The rules themselves appear in
child groups only: parent groups are simply an organizational construct. A given
rule can appear in more than one group.

Any custom rule groups you create are in the User
Defined Groups folder. Custom rule groups do not have a hierarchy.

The easiest way to add or remove rules in an intrusion policy is to add or remove
groups. Because the rules in a group are logically related, it is highly likely that
you will want to use most if not all rules within a given group.

The following procedure explains how to add groups and change the group’s security
level.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for the policy you want to change. |
| **Step 3** | (Adding groups.) If the group is not shown in the list of rule groups, click + > Add Existing Rule Group and do the following:   1. Find the child group.     * A check mark next to a parent group name indicates that all      child groups in the parent group are already selected.    * A minus mark next to a parent group name indicates that one      or more child group has no enabled rules for this policy.      These are the groups you can add.    * A check mark next to a child group name indicates the group      is already selected. 2. Select the group you want to add (that is, check its check box). 3. (Optional, does not apply to custom    rule groups.) Each group has a default security level depending    on the base policy used for the custom policy. If you want to change it,    click the security level icon, select a new level, and click    OK.  Level 1 is the least secure posture, emphasizing connectivity over    security, whereas level 4 is the most aggressive, providing maximum    security. You can click View Description to    see an explanation of each level as you select it.     Changing security level while adding a rule group. 4. Continue selecting (or deselecting) groups until you have made all of    your changes. 5. Click OK. |
| **Step 4** | (Removing groups.) If you want to disable all the rules within a group, you can use any of the following methods:   * Select the group, then click the Exclude link   to the far right of the group name, above the list of rules. * Use the method for adding a group, but instead, deselect the unwanted   group (that is, uncheck its check box), and click   OK. * You can delete a custom rule group to remove it entirely from the   system and from all intrusion policies that use it. Select the   group, then click Delete. |

---

### Changing Intrusion Rule Actions (Snort 3)

Each intrusion policy has the same rules. The difference is the action taken for each
rule can be different from policy to policy.

By changing the rule action, you can disable rules that are giving you too many false
positives, or you can change whether the rule alerts on or drops matching traffic.
You can also enable disabled rules to alert or drop matching traffic.

The easiest method to change rule actions is to change the security level of a rule
group. When you change a group's security level, the action of the rules within the
group change. This can mean that some rules become enabled (or disabled), or the
action can change between alert and drop, based on the security posture you select.
However, you can change an individual rule action if that is what you need.

| **Note** | ---   The default action for a given rule is based on the overall selection of group and severity. Changing the severity of the group, or excluding the group, can change the default action for the rule.   --- |
| --- | --- |

#### Before you begin

Custom rule groups do not have security levels. You cannot use the security level
technique to change rule actions for custom rules.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the view icon (View configuration button.) for the policy whose rule actions you want to change. |
| **Step 3** | (Recommended method.) Change the security level for a rule group.   1. Click the child rule group in the rule group list. 2. Above the list of rules, click Edit next to the    security level for the group.     Changing the security level for an existing rule group.        | **Note** | If you want to disable all the rules in the group, do not click Edit. Instead, click Exclude and confirm that you want to exclude the group. The group is not deleted, its rules are simply disabled. Skip the remaining steps. |    | --- | --- | 3. Select the new level for the group. Click View    Description to see an explanation of each level as you    pick it.  Level 1 is the least secure posture, emphasizing connectivity over    security, whereas level 4 is the most aggressive, providing maximum    security. 4. Click OK. |
| **Step 4** | (Manual method.) Change the action for one or more rule.   1. Find the rule whose action you want to change.  Use the Search/Filter box to search on strings    within the rule information. You can also select filtering items to    search on any combination of GID or SID, or simply show rules based    on their actions (disabled, alert, drop). The rules are lazy-loaded,    so it will take quite a bit of time to scroll through the entire    unfiltered list. When filtering the list, click the refresh button    to reload the filtered view.  Ideally, you can get the Snort identifier (SID) and generator    identifier (GID) from an event or from Cisco Technical Support, if    you are working with them on an issue. You can then search precisely    for the rule. 2. To change the action, do one of the following:     * Change one rule at a time—Click the      Action column for the rule and      select the required action:       + Alert—Create an event when        this rule matches traffic, but do not drop the        connection.      + Drop—Create an event when this        rule matches traffic, and also drop the connection.      + Disabled—Do not match traffic        against this rule. No events are generated.    * Change multiple rules at one time—Click the check boxes for      the rules you want to change, then click the      Bulk drop-down above the table      and pick the desired action. Click the check box in the      GID:SID header to select all the rules in the list. You can      change up to 5000 rules at a time. |

---

### Managing Custom Intrusion Rules and Rule Groups

The system comes with thousands of intrusion rules defined by Cisco Talos Intelligence Group
(Talos). If you know of additional attacks, you can create and upload custom intrusion
rules to screen for those attacks, and either alert or drop them. You can also
create, edit, and delete rules one at a time.

For uploaded rules, you create the rules offline using a text editor. We recommend
that you include a group of custom rules in each text file you upload. You can then
easily upload changes to your rules, and either merge new rules into your custom
rule groups, or replace your rules with new, edited copies.

Explaining how to create these rules is outside the scope of this document. For
detailed information on how to write intrusion rules for Snort, including how to
convert Snort 2 rules to Snort 3 format, see the guides on <https://snort.org/documents>. For
example, Rules Authors Introduction to Writing Snort 3 Rules at <https://snort.org/documents/rules-writers-guide-to-snort-3-rules>.

#### Before you begin

You create custom rule groups during the process of uploading custom rules, as
described in [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864), or when creating individual rules or
managing rule membership. After you create the group, you can manage the group and
its contents.

Note that custom groups are available for all intrusion policies, not just the policy
you were editing when you created the group. Thus, changes you make to a group are
made for all policies. For example, if you delete a custom rule group, it is deleted
from all policies and is no longer available for any of them.

#### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  We recommend that you add custom rules to a custom intrusion policy rather than one of the built-in policies. |
| **Step 3** | Do any of the following:   * To create a group, click + > Upload Custom Rules. See [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864). * To edit a group’s name or description, select the group in the group   table of contents in the User Defined Groups folder. You can then   click Edit and make your changes. * To exclude the group and its rules from the policy, select the group   in the group table of contents in the User Defined Groups folder.   You can then click Exclude to remove the   group. * To delete the group from the system and all policies that use it,   select the group in the group table of contents in the User Defined   Groups folder. Then click Delete. Note that   if a rule exists only in the deleted group, it is also deleted from   the system. However, if a rule also exists in other custom rule   groups that you are not deleting, the rule will remain in those   groups. * To replace or update the rules in a group in bulk, select the group   in the group table of contents in the User Defined Groups folder.   Then, click Upload Rule File next to the   Action drop-down list above the group’s rule table. The process is   the same as that described in [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864). * To create and manage individual rules, and their assignment to rule   groups, see [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e). |

---

* [Uploading Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_878807ca-3cd2-4efd-ab6e-50a8a2959864)
* [Configuring Individual Custom Intrusion Rules](#Cisco_Task_in_List_GUI.dita_75af97a5-8671-4f83-9924-e48860433a3e)

#### Uploading Custom Intrusion Rules

If you know of attacks that are not currently covered by other rules, you can create
and upload custom intrusion rules to screen for those attacks, and either alert or
drop them. The action of the imported rules must be either alert or drop, and the
default action for the rule is defined by the action in the imported file. Once
imported, you can change a rule action and disable a rule if necessary.

You must create these rules offline. In the device
manager, you are simply uploading a rules file, you are not configuring the rules directly. The rules file should be a text file.
You can use line returns to format the rules to be readable, or put a rule on a single line, and empty lines are allowed.
Rule format is explained at snort.org.

For example, an upload file of three rules could look like the following:

```

alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (
   msg: "My Custom Rule: EXPLOIT-KIT Styx exploit kit landing page request";
   flow:to_server,established;
   http_raw_uri;
   bufferlen:>100;
   http_uri;
   content:"/i.html?",depth 8; pcre:"/\/i\.html\?[a-z0-9]+\=[a-zA-Z0-9]{25}/";
   flowbits:set,styx_landing;
   metadata: copied from talos sid 29452;
   service:http;
   classtype:trojan-activity;
   gid:1;
   sid:1000000;
   rev:1;
)

alert tcp $HOME_NET 8811 -> $EXTERNAL_NET any (
   msg:"My Custom rule: MALWARE-BACKDOOR fear1.5/aciddrop1.0 runtime detection - initial connection";
   flow:to_client,established;
   flowbits:isset,Fear15_conn.2;
   content:"Drive",nocase;
   metadata:copied from talos sid 7710;
   classtype:trojan-activity;
   gid:1;
   sid:1000001;
   rev:1;
)

alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (
   msg:"My Custom Rule: INDICATOR-COMPROMISE download of a Office document with embedded PowerShell";
   flow:to_client,established;
   flowbits:isset,file.doc;
   file_data;
   content:"powershell.exe",fast_pattern,nocase;
   metadata:copied from talos sid 37244;
   classtype:trojan-activity;
   gid:1;
   sid:1000002;
   rev:1;
)
```

##### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  We recommend that you add custom rules to a custom intrusion policy rather than one of the built-in policies. |
| **Step 3** | Do one of the following:   * Above the list of groups, click + > Upload Custom Rules. * If you are uploading rules into a custom rule group that you already   created, you can select the custom rule group, then click   Upload Rule File next to the   Action drop-down list above the group’s   rule table. |
| **Step 4** | Click Browse and select your custom rule file, or drag and drop the file into the Upload File dialog box.  Wait for the upload to complete. |
| **Step 5** | Select how you want to handle conflicts:  A conflict occurs when a rule you are adding is the same as one already in the system. This should happen only if you are uploading the same rules or edited versions of rules that you previously uploaded.  Select one of these options:   | **Note** | Merge and Replace are basically the same thing. Uploaded rules must have higher revision numbers than the ones you already uploaded for any changes to be made to the existing rules. The only difference is that if the upload file is missing rules that are in the targeted custom rule group, the Replace option will delete those rules from the rule group. The Merge option will leave those "missing" rules in place. | | --- | --- |  * Merge—Any changed rules in the uploaded file   that also exist in the selected group will have those changes   merged, if the rule in the uploaded file has a higher revision   number. Any unchanged rules, or rules in the group that do not have   corresponding rules in the upload, will be left unchanged. Any new   rules in the upload will be added. This is the default option. * Replace—The rules in the uploaded file will   replace the rules in the selected group, if the revision number on   the uploaded rule is higher. Any existing rules not in the uploaded   file will be deleted from the group. Existing rules whose uploaded   version has a revision number that is the same or lower will be left   unchanged. Any new rules in the upload will be added. |
| **Step 6** | Click + and select the custom rule group for the uploaded rules.  If the custom rule group you want to use does not yet exist, click Create New Group and create it now. The new group needs a name and optionally, a description. Then, you can select the new group.  If you are replacing rules, you can select a single group only. If you are merging them, you can select multiple groups. |
| **Step 7** | Click OK.  The files are uploaded and placed in the new group. You should see a summary of how many rules were uploaded, and how many rules were updated, deleted, or ignored.  If there are errors in the file, the upload will fail. You can click the Download Error File link to get more information on the errors.  The group is automatically activated in this intrusion policy. The group and new rules are available to be added to other policies, but the group and rules are not automatically enabled in any other policy. For information on adding groups to other policies, see [Adding or Removing Rule Groups in an Intrusion Policy (Snort 3)](#Cisco_Task_in_List_GUI.dita_2d4f4706-b442-4ed1-8d9f-73abb005f21a). |

---

#### Configuring Individual Custom Intrusion Rules

You can configure custom intrusion rules one at a time rather than in bulk through
file uploads. This method works well when you need to make a quick adjustment to a
rule, or you need to create or modify just a few rules at a time.

When configuring intrusion rules, keep the following in mind:

* The GID for all custom rules should be 1.
* The SID for a rule must be unique across all rules in the system. It also
  must be one million (1000000) or higher.
* If you edit a rule, you must change the rule version. Normally, you increment
  the version number by 1.
* You can duplicate a Cisco Talos Intelligence Group
  (Talos) rule to create your own version of the rule, but you still must change
  the SID of the duplicate to make it unique.

The system will do some validity checking to ensure the rule is well formed, and you
will see error messages about any problems. However, the system cannot determine
whether the rule is sensible.

For detailed information on how to write intrusion rules for Snort, including how to
convert Snort 2 rules to Snort 3 format, see the guides on <https://snort.org/documents>. For
example, Rules Authors Introduction to Writing Snort 3 Rules at <https://snort.org/documents/rules-writers-guide-to-snort-3-rules>.

##### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the edit icon (edit icon) for a policy.  We recommend that you add custom rules to a custom intrusion policy rather than one of the built-in policies. |
| **Step 3** | Do one of the following:   * To add an intrusion rule, click the Add New Intrusion   Rule button (+) above the   rule table. When adding a rule, you must select one or more custom   rule groups to contain the new rule. You can create new groups while   adding the rule if necessary. * To add a rule by duplicating and editing an existing rule, mouse over   the right end of the rule and click the Duplicate (Copy connection summary to clipboard button.) button. The button appears only on mouse-over. For custom rules,   the Duplicate command is under the more   options (...) button. * To edit a custom rule, find the rule in a custom rule group and click   the edit (edit icon) button for the rule. Your edits apply across all groups in which   the rule resides. Make sure you increment the rule version number by   at least 1 when making changes. * To delete a custom rule, click the delete (delete icon) button for the rule. The rule is deleted from all rule groups   that contain it. If you just want to remove a rule from a group, use   the Manage Group Assignments option instead   of deleting the rule. * To change which groups contain the rule, click the more options   (...) button and select Manage   Group Assignments. You can then add or remove   groups. Your changes simply affect group membership, it does not   change the rule or delete it. |
| **Step 4** | For new rules and groups, add the rule to the policy.  When you create a new group when creating a new rule, or editing an existing rule, that group is not added to your policy automatically, nor is the rule enabled automatically. You are prompted to add the group to the policy you are editing. If you do not add the group while adding or editing the rule, you can add the group later using the following process:   1. Click + > Add Existing Rule Group above the group table of contents. 2. Find the group under the User Defined Groups folder, select it, and    click OK. 3. Select the group in the table of contents and verify that the new rule    is in the group and has the desired action. |

---

## Managing Intrusion Policies (Snort 2)

You can apply any of the pre-defined intrusion policies. Each of these policies includes the same
list of intrusion rules (also known as signatures), but they differ in the actions taken
for each rule. For example, a rule might be active in one policy, but disabled in
another policy.

If you find that a
particular rule is giving you too many false positives, where the rule is
blocking traffic that you do not want blocked, you can disable the rule without
needing to switch to a less-secure intrusion policy. You could alternatively
change it to alert on matches without dropping traffic.

Conversely, if you know you need to protect against a specific attack, but the related rule is disabled in your chosen intrusion
policy, you can enable the rule without changing to a more secure policy.

Use the intrusion
related dashboards, and the Event Viewer (both on the
Monitoring page), to evaluate how intrusion rules
are impacting traffic. Keep in mind that you will see intrusion events and
intrusion data only for traffic that matches intrusion rules set to alert or
drop; disabled rules are not evaluated.

The following topics
explain intrusion policies and rule tuning in more detail.

* [Configure the Inspection Mode for an Intrusion Policy (Snort 2)](#id_121662)
* [Changing Intrusion Rule Actions (Snort 2)](#task_4D5DD40DDCE0426C8846E5684287E63B)

### Configure the Inspection Mode for an Intrusion Policy (Snort 2)

By default, all intrusion policies operate in Prevention mode to implement an Intrusion Prevention System (IPS). In the Prevention
inspection mode, if a connection matches an intrusion rule whose action is to drop traffic, the connection is actively blocked.

If you instead want to test the effect of the intrusion policy on your network, you can change the mode to Detection, which
implements an Intrusion Detection System (IDS). In this inspection mode, drop rules are treat like alert rules, where you
are notified of matching connections, but the action result becomes Would Have Blocked, and connections are never in fact
blocked.

You change the inspection mode per intrusion policy, so you can have a mix of prevention and detection.

#### Procedure

---

| **Step 1** | Select Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the tab for the intrusion policy whose inspection mode you want to change.  The Inspection Mode is indicated above the rules table. |
| **Step 3** | Click the Edit link next to the inspection mode, change the mode for the policy, and click OK.  The options are:   * Prevention—Intrusion rule actions are always applied. Connections that match a drop rule are blocked. * Detection—Intrusion rules generate alerts only. A connection that matches a drop rule will generate alert messages, but the connection   will not be blocked. |

---

### Changing Intrusion Rule Actions (Snort 2)

Each pre-defined
intrusion policy has the same rules. The difference is the action taken for
each rule can be different from policy to policy.

By changing the rule action, you can disable rules that are giving you too many false positives, or you can change whether
the rule alerts on or drops matching traffic. You can also enable disabled rules to alert or drop matching traffic.

#### Procedure

---

| **Step 1** | Select Policies > Intrusion. |
| --- | --- |
| **Step 2** | Click the tab for the intrusion policy whose rule actions you want to change.  The pre-defined policies are:   * Connectivity   over Security * Balanced   Security and Connectivity * Security   over Connectivity * Maximum   Detection |
| **Step 3** | Find the rule whose action you want to change.  The rules are sorted with the overridden ones listed first, and sorted by action within the group of overridden rules. Otherwise, the rules are sorted by GID, then SID.  Use the search box to locate the rule you want to change. Ideally, you can get the Snort identifier (SID) and generator identifier (GID) from an event or from Cisco Technical Support, if you are working with them on an issue.  For detailed information about the elements of each rule, see [Intrusion Rule Attributes](#concept_C4C21B1BDF794F468738C9F836C6C87B).  To search the list:   1. Click in the    Search box to open the search attributes dialog box. 2. Enter a    combination of Generator ID (GID), Snort ID (SID), or rule    Action, and click    Search.  For example,    you could select    Action = Drop to see all the rules in the policy    that will drop matching connections. The text beside the search box indicates    how many rules match your criteria, for example, “8937 of 9416 rules found.”  To clear a    search criteria, click the x for the criteria in the search box. |
| **Step 4** | Click the Action column for the rule and select the required action:   * Alert—Create an   event when this rule matches traffic, but do not drop the connection. * Drop—Create an   event when this rule matches traffic, and also drop the connection. * Disabled—Do not   match traffic against this rule. No events are generated.   The default action for the rule is indicated by “(Default)” added to the action. If you change the default, the status column indicates “Overridden” for that rule. |

---

## Monitoring Intrusion Policies

You can find intrusion
policy statistics on the
Attackers and
Targets dashboards on the
Monitoring page. You must apply an intrusion policy
to at least one access control rule to see any information on these dashboards.
See
[Monitoring Traffic and System Dashboards](fptd-fdm-monitor.html#id_10212).

To see intrusion
events, select
Monitoring > Events, then click the
Intrusion tab. You can hover over an event and
click the
View Details link to get more information. From
the details page, you can click the
View IPS Rule to go to the rule in the relevant
intrusion policy, where you can change the rule action. This can help you
reduce the impact of false positives, where a rule is blocking too many good
connections, by changing the action from drop to alert. Conversely, you can
change an alert rule into a drop rule if you are seeing a lot of attack traffic
for a rule.

If you configure a syslog server for the intrusion policy, intrusion events have the message ID 430001.

## Examples for Intrusion Policies

The use case chapter
includes the following examples of implementing intrusion policies.

* [How to Block Threats](fptd-fdm-use-cases.html#id_25314)
* [How to Passively Monitor the Traffic on a Network](fptd-fdm-use-cases.html#task_B9870E6741394745B05165E6BB008F23)

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_7c23aed0_20250115_120512.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Defense Orchestrator](/c/en/us/support/security/defense-orchestrator/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-orchestrator/products-installation-and-configuration-guides-list.html)
# Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Security Cloud Control

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Managing Cisco Secure Firewall Threat Defense with Cloud-delivered Firewall Management Center
  + [Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-about-cloud-delivered-firewall-management-center.html)
  + [Cisco AI Assistant User Guide](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/ai-assistant-user-guide.html)
* Onboard Devices to Cloud-delivered Firewall Management Center
  + [Onboard an FTD to the Cloud-delivered Firewall Management Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/onboard-ftd-to-cdfmc.html)
  + [Migrate On-Premises Management Center Managed Secure
    Firewall Threat Defense to Cloud-delivered Firewall Management
    Center](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-migrate-ftd.html)
  + [Device Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-management.html)
  + [Device Management Using Device Templates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-templates.html)
  + [Device Settings](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-device-settings.html)
  + [Change Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-change-management.html)
  + [Users](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/get-started-deployment.html)
* System Settings
  + [System
    Configuration](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-config.html)
  + [Users](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-users.html)
  + [Updates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-updates.html)
  + [Licenses](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-licenses.html)
  + [Security Certifications Compliance](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/system-compliance.html)
* Optimize Firewall Performance with AIOps
  + [Introduction to AIOps Insights](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-optimize-firewall-performance-with-aiops.html)
* Health and Monitoring
  + [Health](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/health-health.html)
  + [Troubleshooting](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/health-troubleshoot.html)
* Tools
  + [Backup/Restore](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/backup-restore.html)
  + [Scheduling](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/tools-scheduling.html)
  + [Import/Export](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/tools-import-export.html)
* Reporting and Alerting
  + [External Alerting with Alert Responses](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/report-alert-responses.html)
  + [External Alerting for Intrusion Events](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/report-intrusion-events.html)
* Events and Assets
  + [Cisco Security Analytics and Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/security-analytics-and-logging.html)
  + [FTD Dashboard](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/analytics-dashboard.html)
  + [Connection
    Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/events-connection-logging.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-logical-devices.html)
  + [Multi-Instance Mode for the Secure Firewall 3100](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-multi-instance.html)
  + [High Availability](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-ha.html)
  + [Clustering for the Secure Firewall 3100/4200](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-sec-fw.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-firewall.html)
  + [About IPS Interfaces](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-ecmp.html)
  + [Bidirectional
    Forwarding Detection Routing](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_route-bfd.html)
  + [OSPF](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/objects-certs.html)
* SD-WAN
  + [SD-WAN Capabilities](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_sd-wan.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting in Security Cloud Control](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/vpn-vpn-troublehsooting.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-rules.html)
  + [Cisco Secure
    Dynamic Attributes Connector](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/cisco-secure-dynamic-attributes-connector.html)
  + [URL Filtering](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-service-policies.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/access-content-restriction.html)
  + [Zero Trust Access](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/zero-trust.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/network-malware-protection.html)
* Policy Tools
  + [Analyzing, Detecting, and Fixing Policy Anomalies Using Policy Analyzer and Optimizer](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-analyzing-detecting-and-fixing-policy-anomalies-using-policy-analyzer-and-optimizer.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-overview.html)
  + [Decryption Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-decrypt-policies.html)
  + [Decryption Rules](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/encrypted-traffic-decrypt-rules.html)
  + [Decryption Rules and Policy Example](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/decryption-rules-and-policy-example.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-realms.html)
  + [User Control with the Passive Identity Agent](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/passive-identity-agent.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-captive-portal.html)
  + [User Control with the pxGrid Cloud Identity Source](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/pxgrid-cloud-identity-source.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-access-control.html)
  + [Get Started with Snort 3 Network Analysis
    Policies](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_getting_started_with_network_analysis_policies-1.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/advanced-nap-adaptive-profiles.html)
* Reference
  + [FAQ and Support](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-faq-and-support.html)
  + [Secure Firewall Management Center Command Line Reference](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/reference-cli.html)
  + [Security, Internet
    Access, and Communication Ports](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/reference-ports.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_get-started-deployment.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Security Cloud Control Chapter Title Configuration Deployment

* [PDF - Complete Book
  (96.84 MB)](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator.pdf)
  [PDF - This Chapter (1.29 MB)](/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_get-started-deployment.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: September 21, 2023

## Chapter: Configuration Deployment

Chapter Contents

* [Configuration Deployment](#topic_FD4270BD3512464AA509D2800FDE8D22)
* [Requirements and Prerequisites for Policy Management](#Cisco_Reference.dita_4f92cfc6-e127-4228-93ad-1028a57fdf33)
* [Policy Deployment](#concept_0CD8A576FD584C70BD305190E5125B14)
  + [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d)
  + [Restart Warnings for the Threat Defense Devices](#id_65425)
  + [Deployment Status](#dep_status_estimate_1)
  + [Deployment Estimate](#dep_status_estimate_1)
  + [Deployment Notes](#dep_notes)
  + [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825)
  + [Filter Support for Deployment](#dep_status_estimate_1)
  + [Selective Policy Deployment](#select_pol_dep_1)
  + [Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B)
  + [Redeploy Existing Configurations to a Device](#task_5BD82554DC514472B7FD37B149B8D280)
  + [View Deployment History](#task_view_dep_hist)
  + [View Deployment History Preview](#task_view_dep_hist_preview)
    - [HA Scenarios where Preview is not Supported](#HA_Preview_Unsupported)
  + [Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)
    - [Inspect Traffic During Policy Apply](#id_55284)
    - [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty)
    - [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7)
    - [Changes that Immediately Restart the Snort Process](#reference_ymy_2n3_my)

- [Policy Comparison](#concept_EFE7C694C0824988BC477ACDB692A5E0)
  * [Comparing Policies](#task_ABA1FE48DBBB44BC9FF40243FCC58BF6)
- [Policy Reports](#concept_FCCCA9931A4642DBB443FF0BD0D10DDB)
  * [Generating Current Policy Reports](#task_CCED983433824793AF09203FDAD1AF53)
- [Out-of-Date Policies](#ID-2176-0000043a)
- [Performance Considerations for Limited Deployments](#ID-2176-00000544)
  * [Discovery Without Intrusion Prevention](#ID-2176-00000563)
  * [Intrusion Prevention Without Discovery](#ID-2176-00000598)
- [History for Configuration Deployment](#Cisco_Reference.dita_2452b0e8-073e-4f05-ac53-a483e525f6ce)
Close

# Configuration Deployment

The following topics describe how to manage various policies on the Secure Firewall Management
Center:

* [Requirements and Prerequisites for Policy Management](#Cisco_Reference.dita_4f92cfc6-e127-4228-93ad-1028a57fdf33)
* [Policy Deployment](#concept_0CD8A576FD584C70BD305190E5125B14)
* [Policy Comparison](#concept_EFE7C694C0824988BC477ACDB692A5E0)
* [Policy Reports](#concept_FCCCA9931A4642DBB443FF0BD0D10DDB)
* [Out-of-Date Policies](#ID-2176-0000043a)
* [Performance Considerations for Limited Deployments](#ID-2176-00000544)
* [History for Configuration Deployment](#Cisco_Reference.dita_2452b0e8-073e-4f05-ac53-a483e525f6ce)

## Requirements and Prerequisites for Policy Management

### Model Support

Any.

### Supported Domains

Any

### User Roles

* Admin
* Network Admin
* Security Approver

## Policy Deployment

| **Caution** | ---   Do NOT push the management center deployments over a VPN tunnel that is terminating directly on the threat defense. Pushing the management center deployments can potentially inactivate the tunnel and disconnect the management center and the threat defense.  Recovering the device from this situation can be very disruptive and require executing the disaster recovery procedure. This procedure resets the threat defense configuration to factory defaults by changing manager from management center to local and configuring the device from beginning. For more information, see [Deploying the Management Center Policy Configuration over VPN Tunnel](#ID-2176-0000040d__section_pq5_jly_2tb).   --- |
| --- | --- |

After you configure your deployment, and any time you change that configuration, you must deploy the changes to affected devices.
You can view deployment status in the Message Center.

Deploying updates the following components:

* Device and interface configurations
* Device-related policies: NAT, VPN, QoS, platform settings
* Access control and related policies: DNS, file, identity, intrusion, network analysis, prefilter, SSL
* Network discovery policy
* Intrusion rule
  updates
* Configurations and objects associated with any of these elements

You can configure the system to deploy automatically by scheduling a deploy task or by setting the system to deploy when importing
intrusion rule updates. Automating policy deployment is especially useful if you allow intrusion rule updates to modify system-provided
base policies for intrusion and network analysis. Intrusion rule updates can also modify default values for the advanced preprocessing
and performance options in your access control policies.

In a multidomain deployment, you can deploy changes for any domain where your user account belongs:

* Switch to an ancestor domain to deploy changes to all subdomains at the same time.
* Switch to a leaf domain to deploy changes to only that domain.

* [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d)
* [Restart Warnings for the Threat Defense Devices](#id_65425)
* [Deployment Status](#dep_status_estimate_1)
* [Deployment Estimate](#dep_status_estimate_1)
* [Deployment Notes](#dep_notes)
* [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825)
* [Filter Support for Deployment](#dep_status_estimate_1)
* [Selective Policy Deployment](#select_pol_dep_1)
* [Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B)
* [Redeploy Existing Configurations to a Device](#task_5BD82554DC514472B7FD37B149B8D280)
* [View Deployment History](#task_view_dep_hist)
* [View Deployment History Preview](#task_view_dep_hist_preview)
* [Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

### Best Practices for Deploying Configuration Changes

The following are guidelines for deploying configuration changes.

#### Deploying the Management Center Policy Configuration over VPN Tunnel

You can deploy the management center policy configuration over a VPN tunnel, only if the deployment is for a device that does not terminate the tunnel. The management center to threat
defense management traffic should be its own secure transport SF tunnel and does not need to be over S2S VPN tunnel for any connectivity.

For policy-based VPN tunnel, choose the protected networks on both side to exclude the management center to threat
defense management traffic. For route-based VPN tunnel, configure the routing to exclude the management center to threat
defense management traffic to the VTI interface.

When you push the management center deployments over the VPN tunnel with the management traffic that is also passing through the tunnel, in the event of any
VPN misconfiguration, it inactivates the tunnel and results in disconnecting the management center and the threat
defense.

To reinstantiate the tunnel configuration, you can either:

* Remove the sensor from the threat
  defense and the management center (resulting in losing all of its configuration), and then add the sensor again to the management center.

  Or
* Contact Cisco TAC.

  | **Note** | ---   Reinstantiating the tunnel configuration requires overhauling of the system.   --- |
  | --- | --- |

#### Inline vs Passive Deployments

Do not apply inline configurations to devices deployed passively, and vice versa.

#### Time to Deploy and Memory Limitations

The time it takes to deploy depends on multiple factors, including (but not limited to):

* The configurations you send to the device. For example, if you dramatically increase the number of Security Intelligence entries
  you block, deploy can take longer.
* Device model and memory. On lower-memory devices, deploying can take longer.

Do not exceed the capability of your devices. If you exceed the maximum number of rules or policies supported by a target
device, the system displays a warning. The maximum depends on a number of factors—not only memory and the number of processors
on the device, but also on policy and rule complexity. For information on optimizing policies and rules, see [Best Practices for Access Control Rules](m_access-overview.html#ID-2176-000005b6).

#### Interruptions to Traffic Flow and Inspection During Deploy

When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying
some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption
or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).

For the threat
defense devices, the Inspect Interruption column in the Deploy dialog warns you when deploying might interrupt traffic flow or inspection. You can either proceed with,
cancel, or delay deployment; see [Restart Warnings for the Threat Defense Devices](#id_65425) for more information.

| **Caution** | ---   We *strongly* recommend you deploy in a maintenance window or at a time when interruptions will have the least impact.  --- |
| --- | --- |

#### Auto-Enabling Application Detectors

If you are performing application control but disable required detectors, the system automatically enables the appropriate
system-provided detectors upon policy deploy. If none exist, the system enables the most recently modified user-defined detector
for the application.

#### Asset Rediscovery with Network Discovery Policy Changes

When you deploy changes to a network discovery policy, the system deletes and then rediscovers MAC address, TTL, and hops
information from the network map for the hosts in your monitored networks. Also, the affected managed devices discard any
discovery data that has not yet been sent to the management center.

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

### Restart Warnings for the Threat Defense Devices

When you deploy, the Inspect Interruption column in the deploy page specifies whether a deployed configuration restarts the Snort process on the threat
defense device. When the traffic inspection engine referred to as *the Snort process* restarts, inspection is interrupted until the process resumes. Whether traffic is interrupted or passes without inspection
during the interruption depends on how the device handles traffic. Note that you can proceed with the deployment, cancel the
deployment and modify the configuration, or delay the deployment until a time when deploying would have the least impact on
your network.

When the Inspect Interruption column indicates Yes and you expand the device configuration listing, the system indicates any specific configuration type that would restart
the Snort process with an Inspect
Interruption (![inspect interruption icon](/c/dam/en/us/td/i/400001-500000/440001-450000/447001-448000/447700.jpg)). When you hover your mouse over the icon, a message informs you that deploying the configuration may interrupt traffic.

The following table summarizes how the deploy page displays inspection interruption warnings.

Table 1. Inspection Interruption Indicators

| Type | Inspect Interruption | Description |
| --- | --- | --- |
| Threat Defense | Inspect Interruption (inspect interruption icon)Yes | At least one configuration would interrupt inspection on the device if deployed, and might interrupt traffic depending on how the device handles traffic. You can expand the device configuration listing for more information. |
| -- | Deployed configurations will not interrupt traffic on the device. |
| Undetermined | The system cannot determine if a deployed configuration may interrupt traffic on the device.  Undetermined status is displayed before the first deployment after a software upgrade, or in some cases during a Support call. |
| Errors (error icon) | The system cannot determine the status due to an internal error.  Cancel the operation and click Deploy again to allow the system to redetermine the Inspect Interruption status. If the problem persists, contact Support. |
| sensor | -- | The device identified as *sensor* is not the threat defense device; the system does not determine if a deployed configuration may interrupt traffic on this device. |

For information on all configurations that restart the Snort process for all device types, see [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).

### Deployment Status

On the Deployment page, the Status column provides the deployment status for each device. If a deployment is in progress, then the live status of the deployment
progress is displayed, else one of the following statuses is displayed:

* Pending—Indicates that there are changes in the device that are to be deployed.
* Warnings or errors—Indicates that the pre-deployment checks have identified warnings or errors for the deployment, and you
  have not proceeded with the deployment. You can continue with the deployment if there are any warnings, but not if there are
  any errors.

  | **Note** | ---   The status column provides the warning or error status only for a single user session on the deployment page. If you navigate away from the page or refresh the page, the status changes to pending.   --- |
  | --- | --- |
* Failed—Indicates that the previous deployment attempt failed. Click on the status to view the details.
* In queue—Indicates that deployment is initiated, and the system is yet to start the deployment process.
* Completed—Indicates that deployment has completed successfully.

### Deployment Estimate

The Estimate link is available on the Deployment page after you select a device, a policy, or a configuration. Click the Estimate link to get an estimate of the deployment duration. The time duration is a rough estimate (having around 70% accuracy), and
the actual time taken for deployment may vary for a few scenarios. Refer to the deployment duration estimate for deployments
to a few the threat
defense devices. The estimate is dependable for deployments of up to 20 threat
defense devices.

When an estimate is not available, it indicates that the data is not available, since the first successful deployment on the
selected device is pending. This situation could occur after the management center reimage, version upgrade, or after a high availability failover.

| **Note** | ---   The estimate is incorrect and unreliable for bulk policy changes (in case of bulk policy migrations), and selective deployments because the estimate is based on the heuristic technique.   --- |
| --- | --- |

### Deployment Notes

Deployment notes are custom notes that a user can add as part of the deployment, and these notes are optional.

You can view the deployment notes in the Deployment History page. On the management center menu bar, click Deploy and then select Deployment History to view the Deployment Notes column for each job.

Use the Search option on the Deployment History page to search using job name, device name, user name, status, deployment notes, or 'Bookmarked' keyword.

### Deployment Preview

Preview provides a snapshot of all the policy and object changes to be deployed on the device. The policy changes include
the new policies, changes in the existing policies, and the deleted policies. The object changes include the added and modified
objects which are used in policies. The unused object changes are not displayed because they are not deployed on the device.

On the Deployment page, the Preview column provides a Preview (![preview icon](/c/dam/en/us/td/i/400001-500000/440001-450000/448001-449000/448387.jpg)) icon for each listed device. On clicking the preview icon, the management center displays a UI page listing all the policy and object changes. The left pane on the preview page lists all the different policy
types that have changed on the device, organized in a tree structure.

The Filter icon (![](/c/dam/en/us/td/i/400001-500000/450001-460000/454001-455000/454938.jpg)) provided on the Preview page provides an option to filter the policies at the user level and policy level. Click the Filter icon (![](/c/dam/en/us/td/i/400001-500000/450001-460000/454001-455000/454938.jpg)). Select the policy or user name, or both, and then click Apply to restrict the displayed listing to only the selected items. To view all the pending deployments, ensure that you click
the Filter icon (![](/c/dam/en/us/td/i/400001-500000/450001-460000/454001-455000/454938.jpg)) and select Reset.

The right pane lists all the additions, changes, or deletions in the policy, or the
object selected in the left pane. The two columns on the right pane provide the last
deployed configuration settings (in the Deployed Version column)
versus the changes that are due for deployment (in the Version on Firewall
Management Center column). The last deployed configuration settings are
derived from a snapshot of the last saved deployment in the management center and not from the device. The background colors of the settings are color-coded as per
the legend available on the top-right of the page.

The Modified By column lists the users who have modified, or added the configuration settings. At the policy level, the management center displays all the users who have modified the policy, and at the rule level, the management center displays only the last user who has modified the rule.

Deployment preview of changes to Security Intelligence, Geolocation, Sinkhole, and File List objects is supported. For an
explanation of these and other reusable objects supported in the management center, see [Object Management](m_objects-object-mgmt.html#ID-2243-00000004).

You can download a copy of the change log by clicking the Download as PDF button.

| **Note** | ---  * To preview the deploy changes, you require access from the REST API to the management center. To enable the REST API access, follow the steps in Enabling REST API Access in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config). * The preview does not show the reordering of rules across policies.  For DNS policies, reordered rules appear in the preview list as rule additions and deletions. For example, moving a rule from   position 1 to position 3 in the rule order is displayed as if the rule was deleted from position 1 and added as a new rule   in position 3. Similarly, when a rule is deleted, the rules under it are listed as edited rules as they have changed their   positions. The changes are displayed in the final order in which they appear in the policy. * The preview shows all the default values, even when they are not altered, along with the other configured settings when an   interface or a platform settings policy is added for the first time. Similarly, the high availability-related policies and   default values for settings are shown, even when they are not altered, in the first preview after a high availability pair   is configured or disrupted. * Preview is not supported for some objects. * Object additions and attribute changes are displayed in the preview only if the objects are associated with any device or   interface. Object deletions are not displayed. * Preview is not supported for the following policies:    + High availability   + Network discovery   + Network analysis   + Device settings * User information at rule level is not available for intrusion policies. * The management center displays the username as system for the following   operations:    + Rollback   + Upgrade   + Threat Defense backup and restore   + SRU update   + LSP update   + VDB update * If you change the management center name in System (system gear icon) > Configuration > Information, the deployment preview does not specify this change, yet it requires deploy. * To view changes due to an auto rollback, see [Edit Deployment Settings](m_get-started-device-management.html#Cisco_Task.dita_64c08939-55e7-458f-ab11-01f32685fcf1).  --- |
| --- | --- |

### Filter Support for Deployment

The Filter icon (![filter](/c/dam/en/us/td/i/400001-500000/450001-460000/454001-455000/454938.jpg)) provided on the Deployment page provides an option to filter the device listings that are pending deployment. The filter
icon provides options to filter the listings based on selected devices and user names. You can use the filter along with the
search option to narrow down to the required listing.

Click the Filter icon (![filter](/c/dam/en/us/td/i/400001-500000/450001-460000/454001-455000/454938.jpg)). Select the device or user name, or both, and then click Apply to restrict the displayed listing to only the selected items. To view all the pending deployments, ensure that you click
the Filter icon (![filter](/c/dam/en/us/td/i/400001-500000/450001-460000/454001-455000/454938.jpg)) and select Reset.

### Selective Policy Deployment

| **Caution** | ---   Do NOT push the management center deployments over a VPN tunnel that is terminating directly on the threat defense. Pushing the management center deployments can potentially inactivate the tunnel and disconnect the management center and the threat defense.  Recovering the device from this situation can be very disruptive and require executing the disaster recovery procedure. This procedure resets the threat defense configuration to factory defaults by changing manager from management center to local and configuring the device from beginning. For more information, see [Deploying the Management Center Policy Configuration over VPN Tunnel](#ID-2176-0000040d__section_pq5_jly_2tb).   --- |
| --- | --- |

The management center allows you to select a specific policy within the list of all the changes on the
device that are due for deployment and deploy only the selected policy. Selective
deployment is available only for the following policies:

* Access control policies
* Intrusion policies
* Malware and file policies
* DNS policies
* Identity policies
* SSL policies
* QoS policies
* Prefilter policies
* Network discovery
* NAT policies
* Routing policies
* VPN policies

On the deployment page, after you click Expand Arrow
(![expand arrow icon](/c/dam/en/us/td/i/400001-500000/440001-450000/448001-449000/448385.jpg)) to view device-specific configuration changes, Policy selection
 (![policy selection icon](/c/dam/en/us/td/i/400001-500000/440001-450000/447001-448000/447698.jpg)) icon is visible. The policy selection icon allows you to select individual policies
or configurations to deploy while withholding the remaining listed changes without
deploying them. You can also view the interdependent changes for a certain policy or
configuration using this option. The management center dynamically detects dependencies in-between policies (for example, between an access
control policy and an intrusion policy), and between the shared objects and the
policies. Interdependent changes are indicated using color-coded tags to identify a set
of interdependent deployment changes. When one of the deployment changes is selected,
the interdependent changes are automatically selected.

| **Note** | ---  * When the changes in shared objects are deployed, the impacted policies should also be deployed along with them. When you select   a shared object during deployment, the impacted policies are automatically selected. * Selective deployment is not supported for scheduled deployments and deployments using REST APIs. You can only opt for complete   deployment of all the changes in these cases. * The pre-deployment checks for warnings and errors are performed not only on the selected policies, but on all the policies   that are out-of-date. Therefore, the warnings or errors list shows the deselected policies as well. * Similarly, the Inspect Interruption column indication on the Deployment page considers all out-of-date policies and not just the selected policies. For information   on the Inspect Interruption column, see [Restart Warnings for the Threat Defense Devices](#id_65425).  --- |
| --- | --- |

There are certain limitations to selectively deploying policies. Follow the contents in the table below to understand when
selective policy deployment can be used.

Table 2. Limitations for Selective Deployment

| Type | Description | Scenarios |
| --- | --- | --- |
| Full deployment | Full deployment is necessary for specific deploy scenarios, and the management center does not support selective deployment in such scenarios. If you encounter an error in such scenarios, you may choose to proceed by selecting all the changes for deployment on the device. | Scenarios wherein a full deployment is required are:   * The first deployment after you have upgraded the threat   defense or the management center. * The first deployment after you have restored the threat   defense. * The first deployment after modifications in the threat   defense interface settings. * The first deployment after modifications in the virtual   router settings. * When the threat   defense device is moved to a new domain (global to sub-domain or   sub-domain to global). |
| Associated policy deployment | The management center identifies interdependent policies which are interlinked. When one of the interlinked policies is selected, the remaining interlinked policies are automatically selected. | Scenarios wherein an associated policy is automatically selected:   * When a new object is associated with an existing policy. * When an existing policy's object is modified.   Scenarios wherein multiple policies are automatically selected:   * When a new object is associated with an existing policy, and   the same object is already associated with other policies,   all the associated policies are automatically selected. * When a shared object is modified, all the associated policies   are automatically selected. |
| Interdependent policy changes (shown using color-coded tags) | The management center dynamically detects dependencies in-between policies, and between the shared objects and the policies. The interdependency of the objects or policies is shown using color-coded tags. | Scenarios wherein color-coded interdependent policies or objects are automatically selected:   * When all the out-of-date policies have interdependent   changes.  For example, when an access control policy, an intrusion   policy, and a NAT policy are out-of-date. Since access   control policy and NAT policy share an object, all policies   are selected together for deployment. * When all out-of-date policies share an object, and the object   is modified. |
| Access Policy Group specifications | Access Policy Group policies are listed together in the preview window under Access Policy Group when you click Show or Hide Policy  (Show or Hide Policy icon). | The scenarios and the expected behavior for Access Policy Group policies are:   * If the access control policy is out-of-date, all other   out-of-date policies under this group, except file policy   and intrusion policy, are selected when the access control   policy is selected for deployment.  However, if the access control policy is out-of-date,   intrusion and file policies can be individually selected or   deselected irrespective of whether the access control policy   is selected or not, unless there are any dependent changes.   For example, if a new intrusion policy is assigned to an   access control rule, it indicates that there are dependent   changes, then both the access control policy and the   intrusion policy will be automatically selected when either   of them is selected. * If no access control policy is out-of-date, other out-of-date   policies in this group can be selected and deployed   individually. |

### Deploy Configuration Changes

| **Caution** | ---   Do NOT push the management center deployments over a VPN tunnel that is terminating directly on the threat defense. Pushing the management center deployments can potentially inactivate the tunnel and disconnect the management center and the threat defense.  Recovering the device from this situation can be very disruptive and require executing the disaster recovery procedure. This procedure resets the threat defense configuration to factory defaults by changing manager from management center to local and configuring the device from beginning. For more information, see [Deploying the Management Center Policy Configuration over VPN Tunnel](#ID-2176-0000040d__section_pq5_jly_2tb).   --- |
| --- | --- |

After you change configurations, deploy them to the affected devices. We *strongly* recommend that you deploy in a maintenance window or at a time when any interruptions to traffic flow and inspection will
have the least impact.

| **Caution** | ---  When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).  --- |
| --- | --- |

#### Before you begin

* Review the guidelines described in [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).
* Be sure all managed devices use the same revision of the Security Zones object. If you have edited security zone objects:
  Do not deploy configuration changes to any device until you edit the zone setting for interfaces on *all* devices you want to sync. You must deploy to all managed devices at the same time.

| **Note** | ---  Policy deployment process fails if the sensor configuration is being read by the system during deployment. Executing commands such as `show running-config` from the sensor CLI disturbs the deployment, which results in deployment failure.  --- |
| --- | --- |

#### Procedure

---

| **Step 1** | On the management center menu bar, click Deploy check the check box of specific devices and then click Deploy or click Deploy All to deploy all the devices.  The GUI page lists the devices with out-of-date configurations having the pending status.   * The Modified By column lists the users who have modified the policies or objects. On expanding the device listing, you can view the users   who have modified the policies against each policy listing.       | **Note** | Usernames are not provided for deleted policies and objects. |   | --- | --- | * The Inspect Interruption column indicates if traffic inspection interruption may be caused in the device during deployment.  See [Restart Warnings for the Threat Defense Devices](#id_65425) for information to help you identify configurations that interrupt traffic inspection and might interrupt traffic when deployed   to the threat   defense devices.  If the entry is blank in this column for a device, then it indicates that there will be no traffic inspection interruptions   on that device during deployment. * The Last Modified Time column specifies when you last made the configuration changes. * The Preview column allows you to preview the changes for the next deployment. For more information, see [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825 "Deployment preview provides a snapshot of all the policy and object changes to be deployed on the device. The policy changes include the new policies, changes in the existing policies, and the deleted policies. The object changes include the added and modified objects which are used in policies."). * The Status column provides the status for each deployment. For more information, see [Deployment Status](#dep_status_estimate_1). |
| --- | --- | --- | --- |
| **Step 2** | Identify and choose the devices on which you want to deploy configuration changes.   * Search—Search for the device name, type, domain, group, or status in the search box. * Expand—Click Expand Arrow   (expand arrow icon) to view device-specific configuration changes to be deployed. By selecting the device check box, all the changes for the device, which are listed under the device, are pushed for deployment.   However, you can use the Policy selection    (policy selection icon) to select individual policies or configurations to deploy while withholding the remaining changes without deploying them.   For details, see [Selective Policy Deployment](#select_pol_dep_1).  Optionally, use Show or Hide Policy    (Show or Hide Policy icon) to selectively view or hide the associated unmodified policies.       | **Note** | + When the status in the Inspect Interruption column indicates (Yes) that deploying will interrupt inspection, and perhaps traffic, on the threat   defense device, the expanded list indicates the specific configurations causing the interruption with the Inspect   Interruption (inspect interruption icon). + When there are changes to interface groups, security zones, or objects, the impacted devices are shown as out-of-date on the   management center. To ensure that these changes take effect, the policies with these interface groups, security zones, or objects, also need   to be deployed along with these changes. The impacted policies are shown as out-of-date on the Preview page on the management center. |   | --- | --- | |
| **Step 3** | (Optional) Click Estimate to get a rough estimate of the deployment duration.  For more details, see [Deployment Estimate](#dep_status_estimate_1). |
| **Step 4** | Click Deploy. |
| **Step 5** | If the system identifies errors or warnings in the changes to be deployed, it displays them in the Validation Messages  window. To view complete details, click the arrow icon before the warnings or errors.  You have the following choices:   * Deploy—Continue deploying without resolving warning conditions. You cannot proceed if the system identifies errors. * Close—Exit without deploying. Resolve the error and warning conditions, and attempt to deploy the configuration again. |

---

#### What to do next

* (Optional) Monitor deployment status; see Viewing Deployment Messages in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* If deploy fails, see [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).
* During deployment, if there is a deployment failure due to any reason, there is a possibility that the failure may impact
  traffic. However, it depends on certain conditions. If there are specific configuration changes in the deployment, the deployment
  failure may lead to traffic being interrupted. See the following table to know what configuration changes may cause traffic
  interruption when deployment fails.

  | Configuration Changes | Exists? | Traffic Impacted? |
  | --- | --- | --- |
  | **Threat Defense Service** changes in an access control policy | Yes | Yes |
  | VRF | Yes | Yes |
  | Interface | Yes | Yes |
  | QoS | Yes | Yes |

  | **Note** | ---   The configuration changes interrupting traffic during deployment is valid only if both the management center and the threat defense are of version 6.2.3 or higher.   --- |
  | --- | --- |

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

### Redeploy Existing Configurations to a Device

You can force-deploy existing (unchanged) configurations to a single managed device. We *strongly* recommend you deploy in a maintenance window or at a time when any interruptions to traffic flow and inspection will have
the least impact.

| **Caution** | ---  When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).  --- |
| --- | --- |

#### Before you begin

Review the guidelines described in [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).

#### Procedure

---

| **Step 1** | Choose Devices > Device Management. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) next to the device where you want to force deployment.  In a multidomain deployment, if you are not in a leaf domain, the system prompts you to switch. |
| **Step 3** | Click Device. |
| **Step 4** | Click Edit (edit icon) next to the General section heading. |
| **Step 5** | Click Force Deploy (force deploy icon).   | **Note** | Force-deploy takes more time than the regular deployment because it involves the complete generation of the policy rules to be deployed on the threat defense. | | --- | --- | |
| **Step 6** | Click Deploy.  The system identifies any errors or warnings with the configurations you are deploying. You can click Proceed to continue without resolving warning conditions. However, you cannot proceed if the system identifies an error. |

---

#### What to do next

* (Optional) Monitor deployment status; see Viewing Deployment
  Messages in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* If deploy fails, see [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

### View Deployment History

#### Procedure

---

| **Step 1** | On the Secure Firewall Management Center menu bar, click Deploy and then select Deployment History.  A list of all the previous deployment and rollback jobs is displayed in reverse chronological order. |
| --- | --- |
| **Step 2** | Click Expand Arrow (expand arrow icon) next to the required deployment job to view the devices included in the job and their deployment statuses. |
| **Step 3** | (Optional) Click Transcript Details (transcript details icon) to view the commands sent to the device, and the responses received.  The transcript includes the following sections:   * **Snort Apply**—If there are any failures or responses from Snort-related policies, then the messages are displayed in this section. Normally,   the section is empty. * **CLI Apply**—This section covers features that are configured using commands that are sent to the device. * **Infrastructure Messages**—This section shows the status of different deployment modules.   In the **CLI Apply** section, the deployment transcript includes commands that are sent to the device, and any responses returned from the device. These responses can be informative messages or error messages. For failed deployments, look for messages that indicate errors with the commands. Examining these errors can be particularly helpful if you are using FlexConfig policies to configure customized features. These errors can help you correct the script in the FlexConfig object that is trying to configure the commands.   | **Note** | There is no distinction that is made in the transcript between commands that are sent for managed features and those generated from FlexConfig policies. | | --- | --- |   For example, the following sequence shows that management center sent commands to configure GigabitEthernet0/0 with the logical name *outside*. The device responded that it automatically set the security level to 0. Threat Defense does not use the security level for anything.  ```  ========= CLI APPLY =========  FMC >> interface GigabitEthernet0/0 FMC >>  nameif outside FTDv 192.168.0.152 >> [info] : INFO: Security level for "outside" set to 0 by default.   ``` |
| **Step 4** | (Optional) Click Preview (preview icon) to view the policy and object changes deployed on the device versus the previously deployed version.  The Modified By column lists the users who have modified the policies or objects. At the policy level, management center displays all the user names who have modified the policy. At the rule level, management center displays the last user who has modified the rule.  Additionally, to compare any two versions and view the change log, choose the required versions in the drop-down boxes and click the Show button. Click the Download as PDF button to download a copy of the change log.   | **Note** | Deployment history preview is not supported for certificate enrollments, HA operations, and failed deployments. | | --- | --- | |
| **Step 5** | (Optional) Against each deployment job, click the More (more icon) icon and execute other actions:   * Bookmark—To bookmark the deployment job. * Edit Deployment Notes—To edit your custom deployment notes that you added for a deployment job. * Generate Report—To generate a deployment report, which can be used for auditing. This report includes job properties with   preview and transcript information, and the report can be downloaded as a PDF file.    1. Click Generate Report to generate a deployment report.             Figure 1. Generate Report   2. In the Generate Report popup window, check the Email checkbox.   3. The report can also be sent through email if mail relay host is configured. If the mail      relay host in not configured, use the Edit (edit icon) icon to configure or modify the mail relay host.      For more information, see Configuring a Mail Relay Host and      Notification Address in the [Cisco Secure Firewall Management      Center Administration Guide](http://www.cisco.com/go/firepower-config).   4. In the Recipient List, you can enter multiple email adddresses, separated by semicolons.   5. Click Generate to generate the report, and this report is emailed to the recipients.   6. In the Notifications task tab, you can track the progress. After the report generation is complete, click the link in the      notification task tab to download the PDF report. |

---

### View Deployment History Preview

If you see a banner about an auto rolled back deployment,
see [Edit Deployment Settings](m_get-started-device-management.html#Cisco_Task.dita_64c08939-55e7-458f-ab11-01f32685fcf1) for more information.

#### Procedure

---

| **Step 1** | On the Secure Firewall Management Center menu bar, click Deploy and then select Deployment History.  A list of all the previous deployment and rollback jobs is displayed in reverse chronological order. |
| --- | --- |
| **Step 2** | Click Expand Arrow (expand arrow icon) next to the required deployment job to view the devices included in the job and their deployment statuses. |
| **Step 3** | (Optional) Click Preview (preview icon) to view the policy and object changes deployed on the device versus the previously deployed version.   1. To compare any two versions and view the change log, choose the required versions in the drop-down boxes and click the Show button. The drop-down boxes show the deployment job name and the end time of the deployment.         | **Note** | The drop-down boxes also show failed deployments. |    | --- | --- | 2. The Modified By column lists the users who have modified the policies or objects.     1. At the policy level, management center displays all the user names who have modified the policy.    2. At the rule level, management center displays the last user who has modified the rule. 3. You can also download a copy of the change log by clicking the Download as PDF button.   The Modified By column lists the users who have modified the policies or objects. At the policy level, management center displays all the user names who have modified the policy. At the rule level, management center displays the last user who has modified the rule.  Additionally, to compare any two versions and view the change log, choose the required versions in the drop-down boxes and click the Show button. Click the Download as PDF button to download a copy of the change log.   | **Note** | Deployment history preview is not supported for certificate enrollments, HA operations, and failed deployments. | | --- | --- |  | **Note** | * Deployment history preview is supported for all the deployments done in the management center 7.0 release only. Preview is not supported for deployments done prior to 7.0.  * When a device is registered, preview is not supported for the job history record that is created.  * In the deployment history, the last 10 successful deployments, the last 5 failed deployments, and last 5 rollback deployments   are captured. | | --- | --- | |

---

* [HA Scenarios where Preview is not Supported](#HA_Preview_Unsupported)

#### HA Scenarios where Preview is not Supported

Preview is not supported in the following HA scenarios:

* If a device was in standalone mode and if a chain is made, then an auto-deployment is triggered. For that particular job,
  preview is not supported. On hover over the Preview (![preview icon](/c/dam/en/us/td/i/400001-500000/440001-450000/448001-449000/448387.jpg)), a message is displayed that it is a HA bootstrap deployment, and no preview is supported.
* Configuration groups - Consider a flow in which a device was initially standalone. Subsequently, three deployments took place. In the fourth deployment,
  the device was a HA bootstrap deployement. After these, the user deploys devices 5, 6, and 7. The deployment 7 is an HA break
  deployment, and the user deploys devices 8, 9, and 10.

  In this flow, the preview between 3 and 5 is not supported because 4 was a HA deployment. Similarly, the preview between 8
  and 3 is also not supported. Preview is supported only from 3 to 1, 7,6, 5, 4, and 10, 9, and 8.
* If a device is broken (HA is broken) then the new device is considered as a fresh device.

### Snort Restart Scenarios

When the traffic inspection engine referred to as *the Snort process* on a managed device restarts, inspection is interrupted until the process resumes. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles
traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) for more information. Additionally, resource demands may result in a small number of packets dropping without inspection when you deploy, regardless
of whether the Snort process restarts.

Any of the scenarios in the following table cause the Snort process to restart.

Table 3. Snort Restart Scenarios

| Restart Scenario | More Information |
| --- | --- |
| Deploying a specific configuration that requires the Snort process to restart. | [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7) |
| Modifying a configuration that immediately restarts the Snort process. | [Changes that Immediately Restart the Snort Process](#reference_ymy_2n3_my) |
| Traffic-activation of the currently deployed Automatic Application Bypass (AAB) configuration. | [Configure Automatic Application Bypass](m_get-started-device-management.html#ID-2242-00000f1f) |
| Enabling or disabling "Logging connection events to RAM disk" feature. | See the section **Log to Ramdisk** in [Troubleshoot Drain of FMC Unprocessed Events](https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/216081-troubleshoot-drain-of-fmc-unprocessed-ev.html). |

* [Inspect Traffic During Policy Apply](#id_55284)
* [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty)
* [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7)
* [Changes that Immediately Restart the Snort Process](#reference_ymy_2n3_my)

**Related References**
[Access Control Policy Advanced Settings](m_access-policies.html#ID-2176-00000314)
[Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7)

#### Inspect Traffic During Policy Apply

Inspect traffic during policy apply is an advanced access control policy general setting that allows managed devices to inspect traffic while deploying configuration
changes; this is the case unless a configuration that you deploy requires the Snort process to restart. You can configure
this option as follows:

* Enabled — Traffic is inspected during the deployment unless certain configurations require the Snort process to restart.

  When the configurations you deploy do not require a Snort restart, the system initially uses the currently deployed access
  control policy to inspect traffic, and switches during deployment to the access control policy you are deploying.
* Disabled — Traffic is not inspected during the deployment. The Snort process always restarts when you deploy.

The following graphic illustrates how Snort restarts can occur when you enable or disable Inspect traffic during policy apply.

![](/c/dam/en/us/td/i/400001-500000/400001-410000/407001-408000/407766.jpg)

| **Caution** | ---   When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).   --- |
| --- | --- |

#### Snort Restart Traffic Behavior

The following tables explain how different devices handle traffic when the Snort process restarts.

Table 4. The Threat Defense and the Threat Defense Virtual Restart Traffic Effects

| Interface Configuration | Restart Traffic Behavior |
| --- | --- |
| inline: Snort Fail Open: Down: disabled | dropped |
| inline: Snort Fail Open: Down: enabled | passed without inspection  Some packets can be delayed in buffer for several seconds before the system recognizes that Snort is down. This delay can vary depending upon the load distribution. However, the buffered packets are eventually passed. |
| routed, transparent (including EtherChannel, redundant, subinterface): preserve-connection  enabled (configure snort preserve-connection enable ; default)  For more information, see [Cisco Secure Firewall Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense.html). | existing TCP/UDP flows: passed without inspection so long as at least one packet arrives while Snort is down  new TCP/UDP flows and all non-TCP/UDP flows: dropped  Note that the following traffic drops even when preserve-connection  is enabled:   * plaintext, passthrough prefilter tunnel traffic that   matches an Analyze rule action or an   Analyze all tunnel traffic    default policy action * connections that do not match an access control rule and   are instead handled by the default action. * decrypted TLS/SSL traffic * a safe search flow * a captive portal flow |
| routed, transparent (including EtherChannel, redundant, subinterface): preserve-connection  disabled (configure snort preserve-connection disable ) | dropped |
| inline: tap mode | egress packet immediately, copy bypasses Snort |
| passive | uninterrupted, not inspected |

| **Note** | ---  In addition to traffic handling when the Snort process is down while it restarts, traffic can also pass without inspection or drop when the Snort process is busy, depending on the configuration of the Snort Fail Open Busy option (see [Configure an Inline Set](m_interfaces-settings-ifcs-ips.html#task_0E963BC661AA45AF8E7E123430EAA1C4)). A device supports either the Failsafe option or the Snort Fail Open option, but not both.  --- |
| --- | --- |

| **Note** | ---  When the Snort process is busy but not down during configuration deployment, some packets may drop on routed, switched, or transparent interfaces if the total CPU load exceeds 60 percent.  --- |
| --- | --- |

| **Warning** | ---  Do not reboot the system while the Snort Rule Update is in progress.  --- |
| --- | --- |

Snort-busy drops happen when snort is not able to process the packets fast enough. Lina does not know whether Snort is busy
due to processing delay, or if is stuck or due to call blocking. When transmission queue is full, snort-busy drops occur.
Based on Transmission queue utilization, Lina will try to access if the queue is being serviced smoothly.

#### Configurations that Restart the Snort Process When Deployed or Activated

Deploying any of the following configurations except AAB restarts the Snort process as described. Deploying AAB does not cause
a restart, but excessive packet latency activates the currently deployed AAB configuration, causing a partial restart of the
Snort process.

##### Access Control Policy Advanced Settings

* Deploy when Inspect Traffic During Policy Apply is disabled.
* Add or remove an SSL policy.

##### File Policy

Deploy the first or last of any one of the following configurations; note that while otherwise
deploying these file policy configurations does not cause a restart, deploying
non-file-policy configurations can cause restarts.

* Take either of the following actions:

  + Enable or disable Inspect Archives when the deployed access control policy includes at least one file policy.
  + Add the first or remove the last file policy rule when Inspect Archives is enabled (note that at least one rule is required for Inspect Archives to be meaningful).
* Enable or disable Store files in a Detect Files or Block Files rule.
* Add the first or remove the last active file rule that combines the Malware Cloud Lookup or Block Malware rule action with an analysis option (Spero Analysis or MSEXE, Dynamic Analysis, or Local Malware Analysis) or a store files option (Malware,
  Unknown, Clean, or Custom).

Note that access control rules that deploy these file policy configurations to security zones or tunnel zones cause a restart
only when your configuration meets the following conditions:

* Source or destination security zones in your access control rule must match the security zones associated with interfaces
  on the target devices.
* Unless the destination zone in you access control rule is *any*, a source tunnel zone in the rule must match a tunnel zone assigned to a tunnel rule in the prefilter policy.

##### Identity Policy

* When SSL decryption is disabled (that is, when the access control policy does not include an SSL policy), add the first or
  remove the last active authentication rule.

  An active authentication rule has either an Active Authentication
  rule action, or a Passive Authentication rule action
  with Use active authentication if passive or VPN identity cannot
  be established selected.

##### Network Discovery

* Enable or disable non-authoritative, traffic-based user detection over the HTTP, FTP, or MDNS protocols, using the network
  discovery policy.

##### Device Management

* MTU: Change the highest MTU value among all non-management interfaces on a device.
* Automatic Application Bypass (AAB): The currently deployed AAB configuration activates when a malfunction of the Snort process
  or a device misconfiguration causes a single packet to use an excessive amount of processing time. The result is a partial
  restart of the Snort process to alleviate extremely high latency or prevent a complete traffic stall. This partial restart
  causes a few packets to pass without inspection, or drop, depending on how the device handles traffic.

##### Updates

* System update: Deploy configurations the first time after a software update that includes a new version of the Snort binary
  or data acquisition library (DAQ).
* VDB: For managed devices running Snort 2, deploying configurations the first time after installing a vulnerability database
  (VDB) update that includes changes applicable to managed devices will require a detection engine restart and may result in
  a temporary traffic interruption. For these, a message warns you when you select the management center to begin installing. The deploy dialog provides additional warnings for the threat
  defense devices when VDB changes are pending. VDB updates that apply only to the management center do not cause detection engine restarts, and you cannot deploy them.

  For managed devices running Snort 3, deploying configurations the first time after installing a vulnerability database (VDB)
  update may temporarily interrupt application detection, but there will be no traffic interruptions.

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

**Related Tasks**
[Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B)

#### Changes that Immediately Restart the Snort Process

The following changes immediately restart the Snort process without going through the deploy process. How the restart affects traffic depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) for more information.

* Take any of the following actions involving applications or application detectors:

  + Activate or deactivate a system or custom application detector.
  + Delete an activated custom detector.
  + Save and Reactivate an activated custom detector.
  + Create a user-defined application.

  A message warns you that continuing restarts the Snort process, and allows you to cancel; the restart occurs on any managed
  device in the current domain or in any of its child domains.
* Create or break a threat defense high availability pair—A message warns you that continuing to create a high availability pair restarts the Snort process
  on the primary and secondary devices and allows you to cancel.

## Policy Comparison

To review policy
changes for compliance with your organization's standards or to optimize system
performance, you can examine the differences between two policies or between a
saved policy and the running configuration.

You can compare the
following policy types:

* DNS
* File
* Health
* Identity
* Intrusion (Only Snort 2 policies)
* Network Analysis
* SSL

The comparison view
displays both policies in a side-by-side format. Differences between the two
policies are highlighted:

* Blue indicates
  that the highlighted setting is different in the two policies, and the
  difference is noted in red text.
* Green indicates
  that the highlighted setting appears in one policy but not the other.

* [Comparing Policies](#task_ABA1FE48DBBB44BC9FF40243FCC58BF6)

### Comparing Policies

You can compare policies only if you have access rights and any required licenses for
the specific policy, and you are in the correct domain for configuring the policy.

#### Procedure

---

| **Step 1** | Access the management page for the policy you want to compare:   * DNS—Policies > Access Control > DNS * File—Policies > Access Control > Malware & File * Health—System (system gear icon) > Health > Policy * Identity—Policies > Access Control > Identity * Intrusion—Policies > Access Control > Intrusion      | **Note** | You can compare only Snort 2 policies. |   | --- | --- | * Network Analysis—Policies > Access Control, then click Network Analysis   Policy or Policies  > Access Control > Intrusion, then click Network Analysis   Policies      | **Note** | If your custom user role limits access to the first path listed here, use the second path to access the policy. |   | --- | --- | * SSL—Policies > Access Control > Decryption |
| --- | --- | --- | --- | --- | --- |
| **Step 2** | Click Compare Policies. |
| **Step 3** | From the Compare Against drop-down list, choose the type of comparison you want to make:   * To compare two different policies, choose Other Policy. * To compare two revisions of the same policy, choose Other Revision. * To compare another policy to the currently active policy, choose Running Configuration. |
| **Step 4** | Depending on the comparison type you choose, you have the following choices:   * If you are comparing two different policies, choose the policies you want to compare from the Policy A and Policy B drop-down lists. * If you are comparing the running configuration to another policy, choose the second policy from the Policy B drop-down list. |
| **Step 5** | Click OK. |
| **Step 6** | Review the comparison results:   * Comparison Viewer—To use the comparison viewer to navigate individually through policy differences, click Previous or Next above the title bar. * Comparison Report—To generate a PDF report that lists the differences between the two policies, click Comparison Report. |

---

## Policy Reports

For most policies, you can generate
two kinds of reports. A report on a single policy provides details on the
policy's current saved configuration, while a comparison report lists only the
differences between two policies. You can generate a single-policy report for
all policy types except health.

| **Note** | ---   Intrusion policy reports combine the settings in the base policy with the settings of the policy layers, and make no distinction between which settings originated in the base policy or policy layer.   --- |
| --- | --- |

* [Generating Current Policy Reports](#task_CCED983433824793AF09203FDAD1AF53)

### Generating Current Policy Reports

You can generate policy reports only if you have access rights and any required
licenses for the specific policy, and you are in the correct domain for configuring
the policy.

#### Procedure

---

| **Step 1** | Access the management page for the policy for which you want to generate a report:   * Access Control—Policies > Access Control * DNS—Policies > Access Control > DNS * File—Policies > Access Control > Malware & File * Health—System (system gear icon) > Health > Policy * Identity—Policies > Access Control > Identity * Intrusion—Policies > Access Control > Intrusion * NAT—Devices > NAT * Network Analysis—Policies > Access Control, then click Network Analysis   Policy or Policies  > Access Control > Intrusion, then click Network Analysis   Policies      | **Note** | If your custom user role limits access to the first path listed here, use the second path to access the policy. |   | --- | --- | * SSL—Policies > Access Control > Decryption |
| --- | --- | --- | --- |
| **Step 2** | Click Report (Report icon) next to the policy for which you want to generate a report. |

---

## Out-of-Date Policies

The system
marks out-of-date policies with red status text that indicates how many of its
targeted devices need a policy update. To clear this status, you must re-deploy
the policy to the devices.

Configuration changes that require a policy re-deploy include:

* Modifying an access control policy: any changes to access
  control rules, the default action, policy targets, Security Intelligence
  filtering, advanced options including preprocessing, and so on.
* Modifying any of the policies that the access control policy
  invokes: the SSL policy, network analysis policies, intrusion policies, file
  policies, identity policies, or DNS policies.
* Changing any reusable object or configuration used in an access
  control policy or policies it invokes:

  + network, port,
    VLAN tag, URL, and geolocation objects
  + Security
    Intelligence lists and feeds
  + application
    filters or detectors
  + intrusion
    policy variable sets
  + file lists
  + decryption-related objects and security zones
* Updating the system software, intrusion rules, or the
  vulnerability database (VDB).

Keep in mind that you can change some of these configurations
from multiple places in the web interface. For example, you can modify security
zones using the object manager (Objects > Object Management),
but modifying an interface type in a device’s configuration (Devices > Device Management)
can also change a zone and require a policy re-deploy.

Note that the following updates do
**not** require policy re-deploy:

* automatic updates to Security Intelligence feeds and additions to the Security Intelligence global Block or Do Not Block list
  using the context menu
* automatic updates to URL filtering data
* scheduled geolocation database (GeoDB) updates

## Performance Considerations for Limited Deployments

Host, application, and user discovery data allow the system to
create a complete, up-to-the-minute profile of your network. The system can
also act as an intrusion detection and prevention system (IPS), analyzing
network traffic for intrusions and exploits and, optionally, dropping offending
packets.

Combining discovery and IPS gives context to your network
activity and allows you to take advantage of many features, including:

* impact flags and indications of compromise, which can tell you
  which of your hosts are vulnerable to a particular exploit, attack, or piece of
  malware
* adaptive profile updates and Cisco recommendations, which
  allow you to examine traffic differently depending on the destination host
* correlation, which allows you to respond to intrusions (and
  other events) differently depending on the affected host

However, if your organization is interested in performing only
IPS, or only discovery, there are a few configurations that can optimize the
performance of the system.

* [Discovery Without Intrusion Prevention](#ID-2176-00000563)
* [Intrusion Prevention Without Discovery](#ID-2176-00000598)

### Discovery Without Intrusion Prevention

The
*discovery* feature allows you to monitor network traffic and
determine the number and types of hosts (including network devices) on your
network, as well as the operating systems, active applications, and open ports
on those hosts. You can also configure managed devices to monitor user activity
on your network. You can use discovery data to perform traffic profiling,
assess network compliance, and respond to policy violations.

In a basic deployment (discovery and simple, network-based
access control only), you can improve a device’s performance by following a few
important guidelines when configuring its access control policy.

| **Note** | ---   You must use an access control policy, even if it simply allows all traffic. The network discovery policy can **only** examine traffic that the access control policy allows to pass.   --- |
| --- | --- |

First, make sure your access control policy does not require
complex processing and uses only simple, network-based criteria to handle
network traffic. You must implement
**all** of the following guidelines; misconfiguring any one of
these options eliminates the performance benefit:

* Do **not** use the Security Intelligence feature. Remove any populated global Block or Do Not Block list from the policy’s Security
  Intelligence configuration.
* Do
  **not** include access control rules with Monitor or Interactive
  Block actions. Use only Allow, Trust, and Block rules. Keep in mind that
  allowed traffic can be inspected by discovery; trusted and blocked traffic
  cannot.
* Do
  **not** include access control rules with application, user,
  URL, ISE attribute, or geolocation-based network conditions. Use only simple
  network-based conditions: zone, IP address, VLAN tag, and port.
* Do
  **not** include access control rules that perform file, malware,
  or intrusion inspection. In other words, do not associate a file policy or
  intrusion policy with any access control rule.
* In the Advanced settings for the access control policy, make sure that Intrusion Policy used before Access Control rule is determined is set to No Rules Active.
* Select
  Network Discovery Only as the policy’s default
  action. Do
  **not** choose a default action for the policy that performs
  intrusion inspection.

In conjunction with the access control policy, you can configure
and deploy the network discovery policy, which specifies the network segments,
ports, and zones that the system examines for discovery data, as well as
whether hosts, applications, and users are discovered on the segments, ports,
and zones.

**Related Concepts**
[Inspection of Packets That Pass Before Traffic Is Identified](m_advanced-nap-access-control.html#ID-2194-0000001f)

### Intrusion Prevention Without Discovery

Disabling discovery if you don't need it (for example, in an IPS-only deployment) can improve performance. To disable discovery
you must implement *all* of these changes:

* Delete *all* rules from your network discovery policy.
* Use *only* simple network-based conditions to perform access control: zone, IP address, VLAN tag, and port.

  Do *not* perform any kind of Security Intelligence, application, user, URL, or geolocation control. Although you can disable storage of discovery data, the system still must
  collect and examine it to implement those features.
* Disable network and URL-based Security Intelligence by deleting *all* Block and Do Not Block lists from your access control policy's Security Intelligence configuration, including the default
  Global lists.
* Disable DNS-based Security Intelligence by deleting or disabling *all* rules in the associated DNS policy, including the default Global Do-Not-Block List for DNS and Global Block List for DNS
  rules.

After you deploy, new discovery halts on target devices. The system gradually deletes information in the network map according
to your timeout preferences. Or, you can purge all discovery data immediately.

## History for Configuration Deployment

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_4837fffe_20250115_120531.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [Install and Upgrade Guides](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/products-installation-guides-list.html)
# Cisco Secure Firewall ASA Upgrade Guide

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Planning Your Upgrade](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html)
* [Upgrade the ASA](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/asa-appliance-asav.html)
* [Downgrade the ASA](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/downgrade.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall ASA Upgrade Guide Chapter Title Planning Your Upgrade

* [PDF - Complete Book
  (2.92 MB)](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade.pdf)
  [PDF - This Chapter (1.45 MB)](/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: September 6, 2024

## Chapter: Planning Your Upgrade

Chapter Contents

* [Planning Your Upgrade](#id_58684)
* [Important Guidelines Before You Upgrade](#id_58681)
  + [ASA Upgrade Guidelines](#id_47465)
    - [Version-Specific Guidelines and Migrations](#id_28407)
      * [9.22 Guidelines](#reference_vhz_k1p_2bc)
      * [9.20 Guidelines](#reference_sg1_cfr_ryb)
      * [9.19 Guidelines](#reference_ufy_bvb_w5b)
      * [9.18 Guidelines](#reference_jt1_mnq_3tb)
      * [9.17 Guidelines](#reference_atw_r5v_wpb)
      * [9.16 Guidelines](#reference_ljp_k1w_wpb)
      * [9.15 Guidelines](#reference_rql_v5v_wpb)
      * [9.14 Guidelines](#reference_dsk_w5v_wpb)
      * [9.13 Guidelines](#reference_ecm_x5v_wpb)
      * [9.12 Guidelines](#reference_qql_gyg_kgb)
      * [9.10 Guidelines](#reference_pgh_5q1_sgb)
      * [9.9 Guidelines](#reference_djr_jcy_1cb)
      * [9.8 Guidelines](#reference_xp4_bhv_zz)
      * [9.7 Guidelines](#id_28718)
      * [9.6 Guidelines](#id_28718)
      * [9.5 Guidelines and Migration](#id_28718)
      * [9.4 Guidelines and Migration](#id_28718)
        + [9.3 Guidelines and Migration](#id_47473)
        + [9.2 Guidelines and Migration](#reference_nxf_5ts_bz)
          - [9.1 Guidelines and Migration](#reference_rkb_zm1_cz)
          - [9.0 Guidelines and Migration](#reference_ckl_4n1_cz)
          - [8.4 Guidelines and Migration](#reference_v1n_h41_cz)
          - [8.3 Guidelines and Migration](#reference_xvt_541_cz)
* [Clustering Guidelines](#id_47469)
* [Failover Guidelines](#id_47468)
* [Additional Guidelines](#id_30935)

- [FXOS Upgrade Guidelines](#concept_svt_h1k_ddb)
- [ASA Upgrade Checklist](#id_59005)
- [Compatibility](#id_59003)
  * [ASA and ASDM Compatibility Per Model](#id_59039)
    + [ASA 9.20 and 9.19](#reference_xy4_5xz_l5b)
    + [ASA 9.18 to 9.17](#reference_ncw_ppb_fxb)
    + [ASA 9.16 to 9.15](#reference_upj_nkl_x4b)
    + [ASA 9.14 to 9.13](#reference_ftp_45n_nhb)
    + [ASA 9.12 to 9.5](#id_59423)
  * [Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)
  * [Radware DefensePro Compatibility](#id_59121)
- [Upgrade Path](#id_58680)
  * [Upgrade Path: ASA Appliances](#ID-2152-0000000a)
  * [Upgrade Path: ASA on Firepower 2100 in Platform Mode](#asa-on-firepower-2100-in-platform-mode-upgrade-path)
  * [Upgrade Path: ASA Logical Devices for the Firepower 4100/9300](#Cisco_Reference.dita_d121649b-6d91-4619-b00d-bd1faefaa6fa)
- [Download the Software from Cisco.com](#id_58682)
  * [Download ASA Software](#ID-2152-0000008d)
  * [Download FXOS for the Firepower 4100/9300](#ID-2152-0000008d)
- [Back Up Your Configurations](#id_58690)
Close

# Planning Your Upgrade

Before upgrading the Secure Firewall ASA, you should perform the following preparation:

* Check the upgrade path for the current version to the target version; ensure you plan for any intermediate versions required
  for each operating system.
* Check for guidelines and limitations that affect your intermediate and target versions, or that affect failover and clustering
  zero downtime upgrading.
* Download all software packages required from Cisco.com.
* Back up your configurations, especially if there is a configuration migration.

The following topics explain how to upgrade your ASA.

* [Important Guidelines Before You Upgrade](#id_58681)
* [ASA Upgrade Checklist](#id_59005)
* [Compatibility](#id_59003)
* [Upgrade Path](#id_58680)
* [Download the Software from Cisco.com](#id_58682)
* [Back Up Your Configurations](#id_58690)

## Important Guidelines Before You Upgrade

Check for upgrade guidelines and limitations, and configuration migrations for each operating system.

* [ASA Upgrade Guidelines](#id_47465)
* [FXOS Upgrade Guidelines](#concept_svt_h1k_ddb)

### ASA Upgrade Guidelines

Before you upgrade, check for migrations and any other guidelines.

* [Version-Specific Guidelines and Migrations](#id_28407)
* [Clustering Guidelines](#id_47469)
* [Failover Guidelines](#id_47468)
* [Additional Guidelines](#id_30935)

#### Version-Specific Guidelines and Migrations

Depending on your current version, you might experience one or more configuration migrations, and have to consider configuration
guidelines for all versions between the starting version and the ending version when you upgrade.

* [9.22 Guidelines](#reference_vhz_k1p_2bc)
* [9.20 Guidelines](#reference_sg1_cfr_ryb)
* [9.19 Guidelines](#reference_ufy_bvb_w5b)
* [9.18 Guidelines](#reference_jt1_mnq_3tb)
* [9.17 Guidelines](#reference_atw_r5v_wpb)
* [9.16 Guidelines](#reference_ljp_k1w_wpb)
* [9.15 Guidelines](#reference_rql_v5v_wpb)
* [9.14 Guidelines](#reference_dsk_w5v_wpb)
* [9.13 Guidelines](#reference_ecm_x5v_wpb)
* [9.12 Guidelines](#reference_qql_gyg_kgb)
* [9.10 Guidelines](#reference_pgh_5q1_sgb)
* [9.9 Guidelines](#reference_djr_jcy_1cb)
* [9.8 Guidelines](#reference_xp4_bhv_zz)
* [9.7 Guidelines](#id_28718)
* [9.6 Guidelines](#id_28718)
* [9.5 Guidelines and Migration](#id_28718)
* [9.4 Guidelines and Migration](#id_28718)
* [9.3 Guidelines and Migration](#id_47473)
* [9.2 Guidelines and Migration](#reference_nxf_5ts_bz)
* [9.1 Guidelines and Migration](#reference_rkb_zm1_cz)
* [9.0 Guidelines and Migration](#reference_ckl_4n1_cz)
* [8.4 Guidelines and Migration](#reference_v1n_h41_cz)
* [8.3 Guidelines and Migration](#reference_xvt_541_cz)

##### 9.22 Guidelines

* **Smart licensing default transport changed in 9.22**—In 9.22, the smart licensing
  default transport changed from Smart Call Home to Smart Transport. You can
  configure the ASA to use Smart Call Home if necessary using the
  transport type callhome  command. When you
  upgrade to 9.22, the transport is automatically changed Smart Transport. If
  you downgrade, the transport is set back to Smart Call Home, and if you want
  to use Smart Transport, you need to specify transport type
  smart .

##### 9.20 Guidelines

* **OSPF redistribute commands that specify a route-map that matches a
  prefix-list will be removed in 9.20(2)**—When you upgrade to 9.20(2),
  OSPF **redistribute** commands where the specified **route-map** uses
  a **match ip address prefix-list** will be removed from the
  configuration. Although prefix lists have never been supported, the parser
  still accepted the command. Before upgrading, you should reconfigure OSPF to
  use route maps that specify an ACL in the **match ip address** command.

##### 9.19 Guidelines

* **ASDM 7.19(1) requires Oracle Java version 8u261 or later**—Before you
  upgrade to ASDM 7.19, be sure to update Oracle Java (if used) to version
  8u261 or later. This version supports TLSv1.3, which is required to upgrade
  the ASDM Launcher. OpenJRE is not affected.

##### 9.18 Guidelines

* **ASDM signed-image support in 9.18(2)/7.18(1.152) and later**—The ASA now validates
  whether the ASDM image is a Cisco digitally signed image. If you try to run
  an older ASDM image with an ASA version with this fix, ASDM will be blocked
  and the message “%ERROR: Signature not valid for file disk0:/<filename>”
  will be displayed at the ASA CLI. ASDM release 7.18(1.152) and later are
  backwards compatible with all ASA versions, even those without this fix.
  ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **9.18(1) upgrade issue if you enabled HTTPS/ASDM (with HTTPS authentication) and SSL on
  the same interface with the same port**—If you enable both SSL
  (**webvpn** > **enable**
  *interface*) and HTTPS/ASDM (http ) access on
  the same interface, you can access AnyConnect from
  **https://***ip\_address* and ASDM from
  **https://***ip\_address***/admin**, both on port 443.
  However, if you also enable HTTPS authentication (**aaa authentication http
  console**), then you must specify a different port for ASDM access
  starting in 9.18(1). Make sure you change the port before you upgrade using
  the http  command. ([CSCvz92016](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz92016))
* **ASDM Upgrade Wizard**—Due to ASD API migration, you must use ASDM 7.18 or later to
  upgrade to ASA 9.18 or later. Because ASDM is backwards compatible with
  earlier ASA versions, you can upgrade ASDM to 7.18 or later for any ASA
  version.

##### 9.17 Guidelines

* **ASDM signed-image support in 9.17(1.13)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **No support for Clientless SSL VPN in 9.17(1) and later**—Clientless SSL VPN is no
  longer supported.

  + **webvpn**—The following subcommands are removed:

    - **apcf**
    - **java-trustpoint**
    - **onscreen-keyboard**
    - **port-forward**
    - **portal-access-rule**
    - **rewrite**
    - **smart-tunnel**
  + **group-policy webvpn**—The following subcommands are removed:

    - **port-forward**
    - **smart-tunnel**
    - **ssl-clientless**
* **ASDM Upgrade Wizard**—Due to an internal change, starting in March 2022 the upgrade
  wizard will no longer work with pre-ASDM 7.17(1.152) versions. You must
  manually upgrade to 7.17(1.152) to use the wizard.

##### 9.16 Guidelines

* **ASDM signed-image support in 9.16(3.19)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **SNMPv3 users using MD5 hashing and DES encryption are no longer supported, and the users
  will be removed when you upgrade to 9.16(1)**—Be sure to change any
  user configuration to higher security algorithms using the
  snmp-server user  command before you
  upgrade.
* **SSH host key action required in 9.16(1)**—In addition to RSA, we added
  support for the EDDSA and ECDSA host keys for SSH. The ASA tries to use keys
  in the following order if they exist: EDDSA, ECDSA, and then RSA. When you
  upgrade to 9.16(1), the ASA will fall back to using the existing RSA key.
  However, we recommend that you generate higher-security keys as soon as
  possible using the crypto key generate {eddsa |
  ecdsa}  command. Moreover, if you explicitly
  configure the ASA to use the RSA key with the ssh key-exchange
  hostkey rsa  command, you must generate a key that is
  2048 bits or higher. For upgrade compatibility, the ASA will use smaller RSA
  host keys only when the default host key setting is used. RSA support will
  be removed in a later release.
* **In 9.16 and later, certificates with RSA keys are not compatible with
  ECDSA ciphers**—When you use the ECDHE\_ECDSA cipher group, configure
  the trustpoint with a certificate that contains an ECDSA-capable key.
* ssh version
  **command removed in 9.16(1)**—This command has been removed. Only SSH
  version 2 is supported.
* **When you upgrade to 9.16 or later, you might see a different certificate
  serial number**—In 9.16, the ASA started using OpenSSL, which causes
  negative values in certificates to be computed differently, so you may see a
  different serial number after upgrading. This change does not affect
  operation. (CSCvv30338)
* **SAMLv1 feature removed in 9.16(1)**—Support for SAMLv1 was removed.
* **No support for DH groups 2, 5, and 24 in 9.16(1)**—Support has been
  removed for the DH groups 2, 5, and 24 in SSL DH group configuration. The
  ssl dh-group command has been updated to remove
  the command options group2, group5, and
  group24.

##### 9.15 Guidelines

* **No support in ASA 9.15(1) and later for the ASA 5525-X, ASA 5545-X, and
  ASA 5555-X**—ASA 9.14(x) is the last supported version. For the ASA
  FirePOWER module, the last supported version is 6.6.
* **Cisco announces the feature deprecation for Clientless SSL VPN effective with ASA version
  9.17(1)**—Limited support will continue on releases prior to
  9.17(1).
* **For the Firepower 1010, invalid VLAN IDs can cause problems**—Before you
  upgrade to 9.15(1), make sure you are not using a VLAN for switch ports in
  the range 3968 to 4047. These IDs are for internal use only, and 9.15(1)
  includes a check to make sure you are not using these IDs. For example, if
  these IDs are in use after upgrading a failover pair, the failover pair will
  go into a suspended state. See [CSCvw33057](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw33057) for more information.
* **SAMLv1 feature deprecation**—Support for SAMLv1 is deprecated.
* **Low-Security Cipher Removal in ASA 9.15(1)**—Support for the following
  less secure ciphers used by IKE and IPsec have been removed:

  + Diffie-Hellman groups: 2 and 24
  + Encryption algorithms: DES, 3DES, AES-GMAC, AES-GMAC-192,
    AES-GMAC-256, NULL, ESP-3DES, ESP-DES, ESP-MD5-HMAC
  + Hash algorithms: MD5

  | **Note** | ---   Low-security SSH and SSL ciphers have not yet been removed.   --- |
  | --- | --- |

  Before you upgrade from an earlier version of ASA to Version 9.15(1), you
  must update your VPN configuration to use the ciphers supported in 9.15(1),
  or else the old configuration will be rejected. When the configuration is
  rejected, one of the following actions will occur, depending on the
  command:

  + The command will use the default cipher.
  + The command will be removed.

  Fixing your configuration before upgrading is especially important for
  clustering or failover deployments. For example, if the secondary unit is
  upgraded to 9.15(1), and the removed ciphers are synced to this unit from
  the primary, then the secondary unit will reject the configuration. This
  rejection might cause unexpected behavior, like failure to join the
  cluster.

  **IKEv1**: The following subcommands are removed:

  + **crypto ikev1 policy**
    *priority*:

    - **hash md5**
    - **encryption 3des**
    - **encryption des**
    - **group 2**

  **IKEv2**: The following subcommands are removed:

  + **crypto ikev2 policy**
    *priority*:

    - **prf md5**
    - **integrity md5**
    - **group 2**
    - **group 24**
    - **encryption 3des**
    - **encryption des**
    - **encryption null**

  **IPsec**: The following subcommands are removed:

  + **crypto ipsec ikev1 transform-set *name* esp-3des esp-des
    esp-md5-hmac**
  + **crypto ipsec ikev2 ipsec-proposal *name***

    - **protocol esp integrity md5**
    - **protocol esp encryption 3des aes-gmac aes-gmac- 192
      aes-gmac -256 des**
  + **crypto ipsec profile *name***

    - **set pfs group2 group24**

  **Crypto Map**: The following subcommands are removed:

  + **crypto map *name sequence* set pfs group2**
  + **crypto map *name sequence* set pfs group24**
  + **crypto map *name sequence* set ikev1 phase1-mode aggressive
    group2**
* **Re-introduction of CRL Distribution Point configuration**—The static CDP
  URL configuration option, that was removed in 9.13(1), was re-introduced in
  the  match-certificate  command.
* **Restoration of bypass certificate validity checks option**—The option to
  bypass revocation checking due to connectivity problems with the CRL or OCSP
  server was restored.

  The following subcommands were restored:

  + **revocation-check crl none**
  + **revocation-check ocsp none**
  + **revocation-check crl ocsp none**
  + **revocation-check ocsp crl none**

##### 9.14 Guidelines

* **ASDM signed-image support in 9.14(4.14)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* **ASDM Cisco.com Upgrade Wizard failure on Firepower 1000 and 2100 in
  Appliance mode**—The ASDM Cisco.com Upgrade Wizard does not work for
  upgrading to 9.14 (Tools > Check for ASA/ASDM
  Updates). The wizard can upgrade ASDM from 7.13 to 7.14, but the
  ASA image upgrade is grayed out. ([CSCvt72183](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvt72183)) As a workaround, use one of the following
  methods:

  + Use Tools > Upgrade Software from Local
    Computer for both ASA and ASDM. Note that the ASDM
    image (7.14(1)) in the 9.14(1) bundle also has the bug [CSCvt72183](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvt72183); you should download the newer 7.14(1.46)
    image to enable correct functioning of the wizard.
  + Use Tools > Check for ASA/ASDM Updates to
    upgrade to ASDM 7.14 (the version will be 7.14(1.46); then use the
    new ASDM to upgrade the ASA image. Note that you may see a
    Fatal Installation Error; in this case,
    click OK. You must then set the boot image
    manually on the Configuration > Device Management  > System Image/Configuration > Boot Image/Configuration screen. Save the configuration and reload the
    ASA.
* **For Failover pairs in 9.14(1)+, the ASA no longer shares SNMP client
  engine data with its peer.**
* **No support in ASA 9.14(1)+ for cnatAddrBindNumberOfEntries and
  cnatAddrBindSessionCount OIDs ([CSCvy22526](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy22526))**.
* **Upgrade issue for 9.14(4)24 and RADIUS challenges for AnyConnect mobile
  users**—To restore RADIUS functionality, upgrade to 9.18(4)22 or
  later.
* **Upgrading the Firepower 2100 in Platform mode**—When you upgrade to 9.14
  or later, if your EtherChannel (port-channel) was disabled at the time of
  upgrade, then you will need to manually enable both the EtherChannel and its
  member interfaces after upgrade.
* **Downgrade issue for the Firepower 2100 in Platform mode from 9.13/9.14 to
  9.12 or earlier**—For a Firepower 2100 with a fresh installation of
  9.13 or 9.14 that you converted to Platform mode: If you downgrade to 9.12
  or earlier, you will not be able to configure new interfaces or edit
  existing interfaces in FXOS (note that 9.12 and earlier only supports
  Platform mode). You either need to restore your version to 9.13 or later, or
  you need to clear your configuration using the FXOS erase configuration
  command. This problem does not occur if you originally upgraded to 9.13 or
  9.14 from an earlier release; only fresh installations are affected, such as
  a new device or a re-imaged device. ([CSCvr19755](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvr19755))
* **The tls-proxy  keyword, and support for
  SCCP/Skinny encrypted inspection, was removed** from the
  inspect skinny  command.
* **ASDM Upgrade Wizard**—Due to an internal change, the wizard is only
  supported using ASDM 7.10(1) and later; also, due to an image naming change,
  you must use ASDM 7.12(1) or later to upgrade to ASA 9.10(1) and later.
  Because ASDM is backwards compatible with earlier ASA releases, you can
  upgrade ASDM no matter which ASA version you are running. Note that ASDM
  7.13 and 7.14 did not support the ASA 5512-X, 5515-X, 5585-X, or ASASM; you
  must upgrade to ASDM 7.13(1.101) or 7.14(1.48) to restore ASDM support.

##### 9.13 Guidelines

* **ASAv requires 2GB memory in 9.13(1) and later**—Beginning with 9.13(1),
  the minimum memory requirement for the ASAv is 2GB. If your current ASAv
  runs with less than 2GB of memory, you cannot upgrade to 9.13(1) from an
  earlier version. You must adjust the memory size before upgrading. See the
  [ASAv Getting Started Guide](https://www.cisco.com/go/asa-quick) for information about
  the resource allocations (vCPU and memory) supported in version 9.13(1).
* **Downgrade issue for the Firepower 2100 in Platform mode from 9.13 to 9.12
  or earlier**—For a Firepower 2100 with a fresh installation of 9.13
  that you converted to Platform mode: If you downgrade to 9.12 or earlier,
  you will not be able to configure new interfaces or edit existing interfaces
  in FXOS (note that 9.12 and earlier only supports Platform mode). You either
  need to restore your version to 9.13, or you need to clear your
  configuration using the FXOS erase configuration command. This problem does
  not occur if you originally upgraded to 9.13 from an earlier release; only
  fresh installations are affected, such as a new device or a re-imaged
  device. (CSCvr19755)
* **Cluster control link MTU change in 9.13(1)**—Starting in 9.13(1), many
  cluster control packets are larger than they were in previous releases. The
  recommended MTU for the cluster control link has always been 1600 or
  greater, and this value is appropriate. However, if you set the MTU to 1600
  but then failed to match the MTU on connecting switches (for example, you
  left the MTU as 1500 on the switch), then you will start seeing the effects
  of this mismatch with dropped cluster control packets. Be sure to set all
  devices on the cluster control link to the same MTU, specifically 1600 or
  higher.
* **Beginning with 9.13(1), the ASA establishes an LDAP/SSL connection only if
  one of the following certification criteria is satisfied**:

  + The LDAP server certificate is trusted (exists in a trustpoint or the
    ASA trustpool) and is valid.
  + A CA certificate from servers issuing chain is trusted (exists in a
    trustpoint or the ASA trustpool) and all subordinate CA certificates
    in the chain are complete and valid.
* **Local CA server is removed in 9.13(1)**—When the ASA is configured as
  local CA server, it can issue digital certificates, publish Certificate
  Revocation Lists (CRLs), and securely revoke issued certificates. This
  feature has become obsolete and hence the crypto ca
  server  command is removed.
* **Removal of CRL Distribution Point commands**—The static CDP URL
  configuration commands, namely crypto-ca-trustpoint
  crl  and crl url  were removed
  with other related logic. The CDP URL was moved to match certificate
  command.

  | **Note** | ---   The CDP URL configuration was enhanced to allow multiple instances of the CDP override for a single map (refer [CSCvu05216](https://tools.cisco.com/bugsearch/bug/CSCvu05216)).   --- |
  | --- | --- |
* **Removal of bypass certificate validity checks option**—The option to
  bypass revocation checking due to connectivity problems with the CRL or OCSP
  server was removed.

  The following subcommands are removed:

  + **revocation-check crl none**
  + **revocation-check ocsp none**
  + **revocation-check crl ocsp none**
  + **revocation-check ocsp crl none**

  Thus, after an upgrade, any revocation-check command that is no longer
  supported will transition to the new behavior by ignoring the trailing
  none.

  | **Note** | ---   These commands were restored later (refer [CSCtb41710](https://tools.cisco.com/bugsearch/bug/CSCtb41710)).   --- |
  | --- | --- |
* **Low-Security Cipher Deprecation**— Several encryption ciphers used by
  the ASA IKE, IPsec, and SSH modules are considered insecure and have been
  deprecated. They will be removed in a later release.

  IKEv1: The following subcommands are deprecated:

  + **crypto ikev1 policy**
    *priority*:

    - **hash md5**
    - **encryption 3des**
    - **encryption des**
    - **group 2**
    - **group 5**

  IKEv2: The following subcommands are deprecated:

  + **crypto ikev2 policy**
    *priority*

    - **integrity md5**
    - **prf md5**
    - **group 2**
    - **group 5**
    - **group 24**
    - **encryption 3des**
    - **encryption des** (this command is still available when
      you have the DES encryption license only)
    - **encryption null**

  IPsec: The following commands are deprecated:

  + **crypto ipsec ikev1 transform-set *name* esp-3des esp-des
    esp-md5-hmac**
  + **crypto ipsec ikev2 ipsec-proposal *name***

    - **protocol esp integrity md5**
    - **protocol esp encryption 3des aes-gmac aes-gmac- 192
      aes-gmac -256 des**
  + **crypto ipsec profile *name***

    - **set pfs group2 group5 group24**

  SSH: The following commands are deprecated:

  + **ssh cipher integrity custom hmac-sha1-96:hmac-md5:
    hmac-md5-96**
  + **ssh key-exchange group dh-group1-sha1**

  SSL: The following commands are deprecated:

  + **ssl dh-group group2**
  + **ssl dh-group group5**
  + **ssl dh-group group24**

  Crypto Map: The following commands are deprecated:

  + **crypto map *name sequence* set pfs group2**
  + **crypto map *name sequence* set pfs group5**
  + **crypto map *name sequence* set pfs group24**
  + **crypto map *name sequence* set ikev1 phase1-mode aggressive
    group2**
  + **crypto map *name sequence* set ikev1 phase1-mode aggressive
    group5**
* **In 9.13(1), Diffie-Hellman Group 14 is now the default** for the
  group  command under crypto
  ikev1 policy , ssl dh-group ,
  and crypto ikev2 policy for IPsec PFS using
  crypto map set pfs , crypto
  ipsec profile , crypto dynamic-map set
  pfs , and crypto map set ikev1
  phase1-mode . The former default Diffie-Hellman group
  was Group 2.

  When you upgrade from a pre-9.13(1) release, if you need to use the old
  default (Diffie-Hellman Group 2), then you must *manually* configure
  the DH group as **group 2** or else your tunnels will default to Group
  14. Because group 2 will be removed in a future release, you should move
  your tunnels to group 14 as soon as
  possible.

##### 9.12 Guidelines

* **ASDM signed-image support in 9.12(4.50)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* ASDM Upgrade Wizard—Due to an internal change, the wizard is only supported using ASDM 7.10(1) and later; also, due to an
  image naming change, you must use ASDM 7.12(1) or later to upgrade to ASA 9.10(1) and later. Because ASDM is backwards compatible
  with earlier ASA releases, you can upgrade ASDM no matter which ASA version you are running.
* SSH security improvements and new defaults in 9.12(1)—See the following SSH security improvements:

  + SSH version 1 is no longer supported; only version 2 is supported. The ssh version 1  command will be migrated to ssh version 2 .
  + Diffie-Hellman Group 14 SHA256 key exchange support. This setting is now the default (ssh key-exchange group dh-group14-sha256 ). The former default was Group 1 SHA1. Make sure that your SSH client supports Diffie-Hellman Group 14 SHA256. If it does
    not, you may see an error such as "Couldn't agree on a key exchange algorithm." For example, OpenSSH supports Diffie-Hellman
    Group 14 SHA256.
  + HMAC-SHA256 integrity cipher support. The default is now the high security set of ciphers (hmac-sha1 and hmac-sha2-256 as
    defined by the ssh cipher integrity high  command). The former default was the medium set.
* The NULL-SHA TLSv1 cipher is deprecated and removed in 9.12(1)—Because NULL-SHA doesn't offer encryption and is no longer
  considered secure against modern threats, it will be removed when listing supported ciphers for TLSv1 in the output of tls-proxy  mode commands/options and show ssl ciphers all . The ssl cipher tlsv1 all  and ssl cipher tlsv1 custom NULL-SHA  commands will also be deprecated and removed.
* The default trustpool is removed in 9.12(1)—In order to comply with PSB requirement, SEC-AUT-DEFROOT, the "default" trusted
  CA bundle is removed from the ASA image. As a result, crypto ca trustpool import default  and crypto ca trustpool import clean default  commands are also removed along with other related logic. However, in existing deployments, certificates that were previously
  imported using these command will remain in place.
* The ssl encryption  command is removed in 9.12(1)—In 9.3(2) the deprecation was announced and replaced by ssl cipher . In 9.12(1), ssl encryption  is removed and no longer supported.

##### 9.10 Guidelines

* Due to an internal change, the ASDM Upgrade wizard is only supported using ASDM 7.10(1) and later; also, due to an image naming
  change, you must use ASDM 7.12(1) or later to upgrade to ASA 9.10(1) and later. Because ASDM is backwards compatible with
  earlier ASA releases, you can upgrade ASDM no matter which ASA version you are running.

##### 9.9 Guidelines

* ASA 5506-X memory issues with large configurations on 9.9(2) and later—If you upgrade to 9.9(2) or later, parts of a very
  large configuration might be rejected due to insufficient memory with the following message: "ERROR: Insufficient memory to
  install the rules". One option is to enter the **object-group-search access-control** command to improve memory usage for ACLs; your performance might be impacted, however. Alternatively, you can downgrade to
  9.9(1).

##### 9.8 Guidelines

* **ASDM signed-image support in 9.8(4.45)/7.18(1.152) and later**—The ASA
  now validates whether the ASDM image is a Cisco digitally signed image. If
  you try to run an older ASDM image with an ASA version with this fix, ASDM
  will be blocked and the message “%ERROR: Signature not valid for file
  disk0:/<filename>” will be displayed at the ASA CLI. ASDM release
  7.18(1.152) and later are backwards compatible with all ASA versions, even
  those without this fix. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))
* Before upgrading to 9.8(2) or later, FIPS mode requires the failover key to
  be at least 14 characters—Before you upgrade to to 9.8(2) or later in FIPS
  mode, you must change the failover key  or
  failover ipsec pre-shared-key  to be at
  least 14 characters long. If your failover key is too short, when you
  upgrade the first unit, the failover key will be rejected, and both units
  will become active until you set the failover key to a valid value.
* Do not upgrade to 9.8(1) for ASAv on Amazon Web Services--Due to [CSCve56153](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCve56153), you should not upgrade to 9.8(1). After upgrading, the ASAv becomes unreachable. Upgrade to 9.8(1.5) or later instead.

##### 9.7 Guidelines

* Upgrade issue with 9.7(1) to 9.7(1.x) and later for VTI and VXLAN VNI—If you configure both Virtual Tunnel Interfaces (VTIs)
  and VXLAN Virtual Network Identifier (VNI) interfaces, then you cannot perform a zero downtime upgrade for failover; connections
  on these interface types will not replicate to the standby unit until both units are on the same version. (CSCvc83062)

##### 9.6 Guidelines

* (ASA 9.6(2) through 9.7(x)) Upgrade impact when using SSH public key authentication—Due to updates to SSH authentication,
  additional configuration is required to enable SSH public key authentication; as a result, existing SSH configurations using
  public key authentication no longer work after upgrading. Public key authentication is the default for the ASAv on Amazon
  Web Services (AWS), so AWS users will see this issue. To avoid loss of SSH connectivity, you can update your configuration
  *before* you upgrade. Or you can use ASDM after you upgrade (if you enabled ASDM access) to fix the configuration.

  | **Note** | ---   The original behavior was restored in 9.8(1).   --- |
  | --- | --- |

  Sample original
  configuration for a username "admin":

  ```

  username admin nopassword privilege 15
  username admin attributes
    ssh authentication publickey 55:06:47:eb:13:75:fc:5c:a8:c1:2c:bb:
    07:80:3a:fc:d9:08:a9:1f:34:76:31:ed:ab:bd:3a:9e:03:14:1e:1b hashed

  ```

  To use the
  ssh
  authentication  command, before you upgrade, enter the following
  commands:

  ```

  aaa authentication ssh console LOCAL
  username admin password <password> privilege 15

  ```

  We recommend
  setting a password for the username as opposed to keeping the
  nopassword
  keyword, if present. The
  nopassword
  keyword means that
  *any*
  password can be entered, not that
  *no*
  password can be entered. Prior to 9.6(2), the
  aaa  command was
  not required for SSH public key authentication, so the
  nopassword
  keyword was not triggered. Now that the
  aaa  command is
  required, it automatically also allows regular password authentication for a
  username  if the
  password  (or
  nopassword )
  keyword is present.

  After you
  upgrade, the
  username
  command no longer requires the
  password  or
  nopassword
  keyword; you can require that a user cannot enter a password. Therefore, to
  force public key authentication only, re-enter the
  username
  command:

  ```

  username admin privilege 15

  ```
* Upgrade impact when upgrading the ASA on the Firepower 9300— Due to license entitlement naming changes on the back-end, when
  you upgrade to ASA 9.6(1)/FXOS 1.1(4), the startup configuration may not parse correctly upon the initial reload; configuration
  that corresponds to add-on entitlements is rejected.

  For a standalone ASA, after the unit reloads with the new version,
  wait until all the entitlements are processed and are in an "Authorized" state
  (**show license all** or
  **Monitoring > Properties > Smart License**), and simply
  reload again (**reload** or
  **Tools > System Reload**)
  *without* saving the configuration. After the reload, the
  startup configuration will be parsed correctly.

  For a failover pair if you have any add-on entitlements, follow
  the upgrade procedure in the FXOS release notes, but reset failover after you
  reload each unit (failover reset  or
  **Monitoring > Properties > Failover > Status**,
  **Monitoring > Failover > System**, or
  **Monitoring > Failover > Failover Group**, and then
  click
  Reset Failover).

  For a cluster, follow the upgrade procedure in the FXOS release
  notes; no additional action is required.

##### 9.5 Guidelines and Migration

* 9.5(2) New Carrier License—The new Carrier license replaces the existing GTP/GPRS license, and also includes support for SCTP
  and Diameter inspection. For the Firepower 9300 ASA security module, the feature mobile-sp  command will automatically migrate to the feature carrier  command.
* 9.5(2) E-mail proxy commands deprecated—In ASA Version 9.5(2), the e-mail proxy commands (imap4s , pop3s , smtps ) and subcommands are no longer supported.
* 9.5(2) CSD commands deprecated or migrated—In ASA Version 9.5(2), the CSD commands (csd image , show webvpn csd image , show webvpn csd , show webvpn csd hostscan , show webvpn csd hostscan image ) are no longer supported.

  The following CSD commands will migrate: csd enable  migrates to hostscan enable ; csd hostscan image  migrates to hostscan image .
* 9.5(2) Select AAA commands deprecated—In ASA Version 9.5(2), these AAA commands and subcommands (override-account-disable , authentication crack ) are no longer supported.
* 9.5(1) We deprecated the following command: timeout gsn
* ASA 5508-X and 5516-X upgrade issue when upgrading to 9.5(x) or later—Before you upgrade to ASA Version 9.5(x) or later, if
  you never enabled jumbo frame reservation then you must check the maximum memory footprint. Due to a manufacturing defect,
  an incorrect software memory limit might have been applied. If you upgrade to 9.5(x) or later before performing the below
  fix, then your device will crash on bootup; in this case, you must downgrade to 9.4 using ROMMON ([Load an Image for the ASA 5500-X Series Using ROMMON](http://www.cisco.com/c/en/us/td/docs/security/asa/asa95/configuration/general/asa-95-general-config/admin-swconfig.html#ID-2152-000008e5)), perform the below procedure, and then upgrade again.

  1. Enter the following command to check for the failure condition:

     ```

     ciscoasa# show memory detail | include Max memory footprint
     Max memory footprint        =    456384512
     Max memory footprint        =            0
     Max memory footprint        =    456384512

     ```

     If a value less than **456,384,512** is returned for “Max memory footprint,” then the failure condition is present, and you must complete the remaining steps
     before you upgrade. If the memory shown is 456,384,512 or greater, then you can skip the rest of this procedure and upgrade
     as normal.
  2. Enter global configuration mode:

     ```

     ciscoasa# configure terminal
     ciscoasa(config)#

     ```
  3. Temporarily enable jumbo frame reservation:

     ```

     ciscoasa(config)# jumbo-frame reservation
     WARNING: This command will take effect after the running-config
     is saved and the system has been rebooted. Command accepted.
     INFO: Interface MTU should be increased to avoid fragmenting
     jumbo frames during transmit

     ```

     | **Note** | ---   Do not reload the ASA.   --- |
     | --- | --- |
  4. Save the configuration:

     ```

     ciscoasa(config)# write memory
     Building configuration...
     Cryptochecksum: b511ec95 6c90cadb aaf6b306 41579572
     14437 bytes copied in 1.320 secs (14437 bytes/sec)
     [OK]

     ```
  5. Disable jumbo frame reservation:

     ```

     ciscoasa(config)# no jumbo-frame reservation
     WARNING: This command will take effect after the running-config is saved and
     the system has been rebooted. Command accepted.
     ```

     | **Note** | ---   Do not reload the ASA.   --- |
     | --- | --- |
  6. Save the configuration again:

     ```

     ciscoasa(config)# write memory
     Building configuration...
     Cryptochecksum: b511ec95 6c90cadb aaf6b306 41579572
     14437 bytes copied in 1.320 secs (14437 bytes/sec)
     [OK]

     ```
  7. You can now upgrade to Version 9.5(x) or later.

##### 9.4 Guidelines and Migration

* 9.4(1) Unified
  Communications Phone Proxy and Intercompany Media Engine Proxy are
  deprecated—In ASA Version 9.4, the Phone Proxy and IME Proxy are no longer
  supported.

##### 9.3 Guidelines and Migration

* 9.3(2) Transport Layer Security (TLS) version 1.2 support—We now support TLS version 1.2 for secure message transmission for
  ASDM, Clientless SSVPN, and AnyConnect VPN. We introduced or modified the following commands: ssl client-version, ssl server-version,
  ssl cipher, ssl trust-point, ssl dh-group. We deprecated the following command: ssl encryption
* 9.3(1) Removal of AAA Windows NT domain authentication—We removed NTLM support for remote access VPN users. We deprecated
  the following command: aaa-server protocol nt

##### 9.2 Guidelines and Migration

###### Auto Update Server certificate verification

9.2(1) Auto Update Server certificate verification enabled by default. The Auto Update Server certificate verification is
now enabled by default; for new configurations, you must explicitly disable certificate verification. If you are upgrading
from an earlier release, and you did not enable certificate verification, then certificate verification is not enabled, and
you see the following warning:

`WARNING: The certificate provided by the auto-update servers will not be verified. In order to verify this certificate please
use the verify-certificate option.`

The configuration will be migrated to explicitly configure no verification:

auto-update server no-verification

###### Upgrade impact for ASDM login

Upgrade impact for ASDM login when upgrading from a pre-9.2(2.4) release to 9.2(2.4) or later. If you upgrade from a pre-9.2(2.4)
release to ASA Version 9.2(2.4) or later and you use command authorization and ASDM-defined user roles, users with Read Only
access will not be able to log in to ASDM. You must change the more  command either before or after you upgrade to be at privilege level 5; only Admin level users can make this change. Note
that ASDM version 7.3(2) and later includes the more  command at level 5 for defined user roles, but preexisting configurations need to be fixed manually.

**ASDM:**

1. Choose Configuration > Device Management > Users/AAA > AAA Access > Authorization, and click Configure Command Privileges.
2. Select more, and click Edit.

   ![](/c/dam/en/us/td/i/400001-500000/410001-420000/413001-414000/413949.jpg)
3. Change the Privilege Level to 5, and click OK.
4. Click OK, and then Apply.

**CLI:**

`ciscoasa(config)# privilege cmd level 5 mode exec command more`

##### 9.1 Guidelines and Migration

* Maximum MTU Is Now 9198 Bytes—If your MTU was set to a value higher than 9198, then the MTU is automatically lowered when
  you upgrade. In some cases, this MTU change can cause an MTU mismatch; be sure to set any connecting equipment to use the
  new MTU value. The maximum MTU that the ASA can use is 9198 bytes (check for your model’s exact limit at the CLI help). This
  value does not include the Layer 2 header. Formerly, the ASA let you specify the maximum MTU as 65535 bytes, which was inaccurate
  and could cause problems.

##### 9.0 Guidelines and Migration

* **IPv6 ACL Migration**—IPv6 ACLs (ipv6 access-list ) will be migrated to extended ACLs (access-list extended ); IPv6 ACLs are no longer supported.

  If IPv4 and IPv6 ACLs are applied on the same direction of an interface (access-group  command), then the ACLs are merged:

  + If both IPv4 and IPv6 ACLs are not used anywhere other than the access-group, then the name of the IPv4 ACL is used for the
    merged ACL; the IPv6 access-list is removed.
  + If at least one of the ACLs is used in another feature, then a new ACL is created with the name *IPv4-ACL-name\_IPv6-ACL-name*; the in-use ACL(s) continue to be used for other features. ACLs not in use are removed. If the IPv6 ACL is in use for another
    feature, it is migrated to an extended ACL of the same name.
* **ACL Any Keyword Migration**—Now that ACLs support both IPv4 and IPv6, the any  keyword now represents “all IPv4 and IPv6 traffic.” Any existing ACLs that use the any  keyword will be changed to use the any4  keyword, which denotes “all IPv4 traffic.”

  In addition, a separate keyword was introduced to designate “all IPv6 traffic”: any6 .

  The any4  and any6  keywords are not available for all commands that use the any  keyword. For example, the NAT feature uses only the any  keyword; any represents IPv4 traffic or IPv6 traffic depending on the context within the specific NAT command.
* **Static NAT-with-port-translation Requirement Before Upgrading**—In Version 9.0 and later, static NAT-with-port-translation rules limit access to the destination IP address for the specified
  port only. If you try to access the destination IP address on a different port not covered by a NAT rule, then the connection
  is blocked. This behavior is also true for Twice NAT. Moreover, traffic that does not match the source IP address of the Twice
  NAT rule will be dropped if it matches the destination IP address, regardless of the destination port. Therefore, before you
  upgrade, you must add additional rules for all other traffic allowed to the destination IP address.

  For example, you have the following Object NAT rule to translate HTTP traffic to the inside server between port 80 and port
  8080:

  ```

  object network my-http-server
    host 10.10.10.1
    nat (inside,outside) static 192.168.1.1 80 8080

  ```

  If you want any other services to reach the server, such as FTP, then you must explicitly allow them:

  ```

  object network my-ftp-server
    host 10.10.10.1
    nat (inside,outside) static 192.168.1.1 ftp ftp

  ```

  Or, to allow traffic to other ports of the server, you can add a general static NAT rule that will match all other ports:

  ```

  object network my-server-1
    host 10.10.10.1
    nat (inside,outside) static 192.168.1.1

  ```

  For Twice NAT, you have the following rule to allow HTTP traffic from 192.168.1.0/24 to the inside server and translate between
  port 80 and port 8080:

  ```

  object network my-real-server
    host 10.10.10.1
  object network my-mapped-server
    host 192.168.1.1
  object network outside-real-hosts
    subnet 192.168.1.0 255.255.255.0
  object network outside-mapped-hosts
    subnet 10.10.11.0 255.255.255.0
  object service http-real
    service tcp destination eq 80
  object service http-mapped
    service tcp destination eq 8080
  object service ftp-real
    service tcp destination eq 21
  nat (outside,inside) source static outside-real-hosts outside-mapped-hosts destination static my-mapped-server my-real-server service http-mapped http-real

  ```

  If you want the outside hosts to reach another service on the inside server, add another NAT rule for the service, for example
  FTP:

  ```

  nat (outside,inside) source static outside-real-hosts outside-mapped-hosts destination static my-mapped-server my-real-server ftp-real ftp-real

  ```

  If you want other source addresses to reach the inside server on any other ports, you can add another NAT rule for that specific
  IP address or for any source IP address. Make sure the general rule is ordered after the specific rule.

  ```

  nat (outside,inside) source static any any destination static my-mapped-server my-real-server

  ```

##### 8.4 Guidelines and Migration

* Configuration Migration for Transparent Mode—In 8.4, all transparent mode interfaces now belong to a bridge group. When you
  upgrade to 8.4, the existing two interfaces are placed in bridge group 1, and the management IP address is assigned to the
  Bridge Group Virtual Interface (BVI). The functionality remains the same when using one bridge group. You can now take advantage
  of the bridge group feature to configure up to four interfaces per bridge group and to create up to eight bridge groups in
  single mode or per context.

  | **Note** | ---   Note In 8.3 and earlier, as an unsupported configuration, you could configure a management interface without an IP address, and you could access the interface using the device management address. In 8.4, the device management address is assigned to the BVI, and the management interface is no longer accessible using that IP address; the management interface requires its own IP address.   --- |
  | --- | --- |
* When upgrading to 8.4(2) from 8.3(1), 8.3(2), and 8.4(1), all identity NAT configurations will now include the no-proxy-arp  and route-lookup  keywords, to maintain existing functionality. The unidirectional  keyword is removed.

##### 8.3 Guidelines and Migration

See the following guide that describes the configuration migration process when you upgrade from a pre-8.3 version of the
Cisco ASA 5500 operating system (OS) to Version 8.3:

[Cisco ASA 5500 Migration to Version 8.3](http://www.cisco.com/c/en/us/td/docs/security/asa/asa83/upgrading/migrating.html)

#### Clustering Guidelines

There are no special requirements for Zero Downtime Upgrades for ASA clustering with the following exceptions.

| **Note** | ---   Zero Downtime *Downgrades* are not officially supported with clustering.   --- |
| --- | --- |

* Firepower 4100/9300 Failover and
  Clustering hitless upgrade requirements for flow offload—Due to bug fixes in the flow
  offload feature, some combinations of FXOS and ASA do not support flow offload (see the
  [compatibility
  table](#id_59069)). Flow offload is disabled by default for ASA. To
  perform a Failover or Clustering hitless upgrade when using flow offload, you need to
  follow the below upgrade paths to ensure that you are always running a compatible
  combination when upgrading to FXOS 2.3.1.130 or later:

  1. Upgrade ASA to 9.8(3) or later
  2. Upgrade FXOS to 2.3.1.130 or later
  3. Upgrade ASA to your final version

  For example, you are on FXOS 2.2.2.26/ASA 9.8(1), and you want to upgrade to FXOS 2.6.1/ASA 9.12(1), then you can:

  1. Upgrade ASA to 9.8(4)
  2. Upgrade FXOS to 2.6.1
  3. Upgrade ASA to 9.12(1)
* Firepower 4100/9300 Cluster Upgrade
  to FXOS 2.3/ASA 9.9(2)—Data units on ASA 9.8 and
  earlier cannot rejoin a cluster where the control
  unit is on FXOS 2.3/9.9(2) or later; they will
  join after you upgrade the ASA version to 9.9(2)+
  [[CSCvi54844](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvi54844)].
* Distributed Site-to-Site VPN—Distributed Site-to-Site VPN sessions on a failed unit require up to 30 minutes to stabilize
  on other units. During this time, additional unit failures might result in lost sessions. Therefore, during a cluster upgrade,
  to avoid traffic loss, follow these steps. Refer to the FXOS/ASA cluster upgrade procedure so you can integrate these steps
  into your upgrade task.

  | **Note** | ---   Zero Downtime Upgrade is not supported with Distributed Site-to-Site VPN when upgrading from 9.9(1) to 9.9(2) or later. In 9.9(2), due to Active Session Redistribution enhancements, you cannot run some units on 9.9(2) and other units on 9.9(1).   --- |
  | --- | --- |

  1. On the
     chassis *without* the control unit, disable
     clustering on one module using the ASA
     console.

     cluster group
     name

     no enable

     If you are upgrading FXOS on the chassis as well as ASA, save the configuration so clustering will be disabled after the chassis
     reboots:

     write memory
  2. Wait for the cluster to stabilize; verify all backup sessions have been created.

     show cluster vpn-sessiondb summary
  3. Repeat steps 1 and 2 for each module on this chassis.
  4. Upgrade FXOS on the chassis using the FXOS CLI or Firepower Chassis Manager.
  5. After the chassis comes online, update the ASA image on each module using the FXOS CLI or Firepower Chassis Manager.
  6. After the modules come online, re-enable clustering on each module at the ASA console.

     cluster group
     name

     enable

     write memory
  7. Repeat steps
     1 through 6 on the second chassis, being sure to
     disable clustering on the data units first, and
     then finally the control unit.

     A new control
     unit will be chosen from the upgraded chassis.
  8. After the
     cluster has stabilized, redistribute active
     sessions among all modules in the cluster using
     the ASA console on the control unit.

     cluster redistribute vpn-sessiondb
* Upgrade issue for 9.9(1) and later with clustering—9.9(1) and later includes an improvement in the backup distribution. You
  should perform your upgrade to 9.9(1) or later as follows to take advantage of the new backup distribution method; otherwise
  upgraded units will continue to use the old method.

  1. Remove all secondary units from the cluster (so the cluster consists only of the primary unit).
  2. Upgrade 1 secondary unit, and rejoin the cluster.
  3. Disable clustering on the primary unit; upgrade it, and rejoin the cluster.
  4. Upgrade the remaining secondary units, and join them back to the cluster, one at a time.
* Firepower 4100/9300 Cluster Upgrade
  to ASA 9.8(1) and earlier—When you disable
  clustering on a data unit (no
  enable ), which is part of the
  upgrade process, traffic directed to that unit can
  drop for up to three seconds before traffic is
  redirected to a new owner [[CSCvc85008](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvc85008)].
* Zero Downtime Upgrade may not be supported when upgrading to the following releases with the fix for [CSCvb24585](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvb24585). This fix moved 3DES from the default (medium) SSL ciphers to the low cipher set. If you set a custom cipher that only includes
  3DES, then you may have a mismatch if the other side of the connection uses the default (medium) ciphers that no longer include
  3DES.

  + 9.1(7.12)
  + 9.2(4.18)
  + 9.4(3.12)
  + 9.4(4)
  + 9.5(3.2)
  + 9.6(2.4)
  + 9.6(3)
  + 9.7(1)
  + 9.8(1)
* Upgrade issues for fully-qualified domain name (FQDN) ACLs—Due to [CSCuv92371](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuv92371), ACLs containing FQDNs might result in incomplete ACL replication to secondary units in a cluster or failover pair. This
  bug is present in 9.1(7), 9.5(2), 9.6(1), and some interim releases. We suggest that you upgrade to a version that includes
  the fix for CSCuy34265: 9.1(7.6) or later, 9.5(3) or later, 9.6(2) or later. However, due to the nature of configuration replication,
  zero downtime upgrade is not available. See [CSCuy34265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuy34265) for more information about different methods of upgrading.
* Firepower Threat Defense Version 6.1.0 clusters do not support inter-site clustering (you can configure inter-site features
  using FlexConfig starting in 6.2.0). If you deployed or re-deployed a 6.1.0 cluster in FXOS 2.1.1, and you entered a value
  for the (unsupported) site ID, then you must remove the site ID (set it to **0**) on each unit in FXOS before you upgrade to 6.2.3. Otherwise, the units will not be able to rejoin the cluster after the
  upgrade. If you already upgraded, change the site ID to **0** on each unit to resolve the issue. See the FXOS configuration guide to view or change the site ID
* Upgrade to 9.5(2) or later
  (CSCuv82933)—Before you upgrade the control unit,
  if you enter show cluster
  info , the upgraded data units show
  as “DEPUTY\_BULK\_SYNC”; other mismatched states are
  also shown. You can ignore this display; the
  status will show correctly when you upgrade all
  units.
* Upgrade from 9.0(1) or 9.1(1) (CSCue72961)—Zero Downtime Upgrade is not supported.

#### Failover Guidelines

There are no special requirements for Zero Downtime Upgrades for failover with the following exceptions:

* For the Firepower 1010, invalid VLAN IDs can cause problems—Before you upgrade to
  9.15(1), make sure you are not using a VLAN for switch ports in the range 3968 to 4047.
  These IDs are for internal use only, and 9.15(1) includes a check to make sure you are
  not using these IDs. For example, if these IDs are in use after upgrading a failover
  pair, the failover pair will go into a suspended state. See [CSCvw33057](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw33057) for more information.
* Firepower 4100/9300 Failover and
  Clustering hitless upgrade requirements for flow offload—Due to bug fixes in the flow
  offload feature, some combinations of FXOS and ASA do not support flow offload (see the
  [compatibility
  table](#id_59069)). Flow offload is disabled by default for ASA. To
  perform a Failover or Clustering hitless upgrade when using flow offload, you need to
  follow the below upgrade paths to ensure that you are always running a compatible
  combination when upgrading to FXOS 2.3.1.130 or later:

  1. Upgrade ASA to 9.8(3) or later
  2. Upgrade FXOS to 2.3.1.130 or later
  3. Upgrade ASA to your final version

  For example, you are on FXOS 2.2.2.26/ASA 9.8(1), and you want to upgrade to FXOS 2.6.1/ASA 9.12(1), then you can:

  1. Upgrade ASA to 9.8(4)
  2. Upgrade FXOS to 2.6.1
  3. Upgrade ASA to 9.12(1)
* Upgrade issues with 8.4(6), 9.0(2) , and 9.1(2)—Due to CSCug88962, you cannot perform a Zero Downtime Upgrade to 8.4(6), 9.0(2),
  or 9.1(3). You should instead upgrade to 8.4(5) or 9.0(3). To upgrade 9.1(1), you cannot upgrade directly to the 9.1(3) release
  due to CSCuh25271, so there is no workaround for a Zero Downtime Upgrade; you must upgrade to 9.1(2) before you upgrade to
  9.1(3) or later.
* Upgrade issues for fully-qualified domain name (FQDN) ACLs—Due to [CSCuv92371](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuv92371), ACLs containing FQDNs might result in incomplete ACL replication to secondary units in a cluster or failover pair. This
  bug is present in 9.1(7), 9.5(2), 9.6(1), and some interim releases. We suggest that you upgrade to a version that includes
  the fix for CSCuy34265: 9.1(7.6) or later, 9.5(3) or later, 9.6(2) or later. However, due to the nature of configuration replication,
  zero downtime upgrade is not available. See [CSCuy34265](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuy34265) for more information about different methods of upgrading.
* Upgrade issue with 9.7(1) to 9.7(1.x) and later for VTI and VXLAN VNI—If you configure
  both Virtual Tunnel Interfaces (VTIs) and VXLAN Virtual Network Identifier (VNI)
  interfaces, then you cannot perform a zero downtime upgrade for failover; connections on
  these interface types will not replicate to the standby unit until both units are on the
  same version. (CSCvc83062)
* Before upgrading to 9.8(2) or later, FIPS mode
  requires the failover key to be at least 14
  characters—Before you upgrade to to 9.8(2) or
  later in FIPS mode, you must change the
  failover key  or
  failover ipsec
  pre-shared-key  to be at least 14
  characters long. If your failover key is too
  short, when you upgrade the first unit, the
  failover key will be rejected, and both units will
  become active until you set the failover key to a
  valid value.
* Upgrade issue with GTP inspection—There could be some downtime during the upgrade, because the GTP data structures are not
  replicated to the new node.

#### Additional Guidelines

* Cisco ASA Clientless SSL VPN Portal Customization Integrity
  Vulnerability—Multiple vulnerabilities have been fixed for clientless SSL VPN
  in ASA software, so you should upgrade your software to a fixed version. See
  <http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20141008-asa>
  for details about the vulnerability and a list of fixed ASA versions. Also, if
  you ever ran an earlier ASA version that had a vulnerable configuration, then
  regardless of the version you are currently running, you should verify that the
  portal customization was not compromised. If an attacker compromised a
  customization object in the past, then the compromised object stays persistent
  after you upgrade the ASA to a fixed version. Upgrading the ASA prevents this
  vulnerability from being exploited further, but it will not modify any
  customization objects that were already compromised and are still present on
  the system.

### FXOS Upgrade Guidelines

Before you upgrade, read the release notes for each FXOS version in your chosen upgrade path. Release notes contain important
information about each FXOS release, including new features and changed functionality.

Upgrading may require configuration changes that you must address. For example, new hardware supported in an FXOS release
might also require that you update the FXOS firmware.

FXOS release notes are available here: <https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html>.

## ASA Upgrade Checklist

To plan your upgrade, use this checklist.

1. ASA model ([Upgrade Path: ASA Appliances](#ID-2152-0000000a)): \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

   Current ASA version ([Upgrade Path: ASA Appliances](#ID-2152-0000000a)): \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2. Check the ASA/ASDM compatibility per model ([ASA and ASDM Compatibility Per Model](#id_59039)).

   Target ASA version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

   Target ASDM version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3. Check the upgrade path for the Firepower 2100 in Platform mode ([Upgrade Path: ASA on Firepower 2100 in Platform Mode](#asa-on-firepower-2100-in-platform-mode-upgrade-path)). Are there intermediate versions
   required? Yes \_\_\_\_\_ No \_\_\_\_\_

   If yes, intermediate ASA version(s):
   \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
4. Download the target ASA/ASDM versions ([Download ASA Software](#ID-2152-0000008d)).

   | **Note** | ---   ASDM is included in the image package for all Firepower and Secure Firewall platforms.   --- |
   | --- | --- |
5. Is your ASA model a Firepower 4100 or 9300? Yes \_\_\_\_\_ No \_\_\_\_\_

   If yes:

   1. Current FXOS
      version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
   2. Check
      ASA/Firepower 4100 and 9300 compatibility ([Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)).

      Target FXOS version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
   3. Are there
      intermediate versions required? Yes \_\_\_\_\_ No \_\_\_\_\_

      If yes, intermediate FXOS versions: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

      Make sure you plan to upgrade the ASA in step with the FXOS upgrades to stay compatible.

      Intermediate ASA versions required to stay compatible during the upgrade: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
   4. Download the
      target and intermediate FXOS version ([Download FXOS for the Firepower 4100/9300](#ID-2152-0000008d)).

      Download the intermediate ASA versions ([Download ASA Software](#ID-2152-0000008d)).
   5. Do you use the Radware DefensePro decorator application? Yes \_\_\_\_\_ No \_\_\_\_\_

      If yes:

      1. Current DefensePro version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
      2. Check
         ASA/FXOS/DefensePro compatibility ([Radware DefensePro Compatibility](#id_59121)).

         Target DefensePro version: \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
      3. Download the target DefensePro version.
6. Check upgrade guidelines for each operating system.

   * [ASA Upgrade Guidelines](#id_47465).
   * FXOS guidelines: see the [FXOS Release Notes](https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html) for each intermediate and target version.
7. Back up your configurations. See the configuration guide for each operating system for backup methods.

## Compatibility

This section includes tables showing the compatibility between platforms, operating systems, and applications.

* [ASA and ASDM Compatibility Per Model](#id_59039)
* [Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)
* [Radware DefensePro Compatibility](#id_59121)

### ASA and ASDM Compatibility Per Model

The following tables list ASA and ASDM compatibility for current models. For older versions and models, see [Cisco ASA Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

* [ASA 9.20 and 9.19](#reference_xy4_5xz_l5b)
* [ASA 9.18 to 9.17](#reference_ncw_ppb_fxb)
* [ASA 9.16 to 9.15](#reference_upj_nkl_x4b)
* [ASA 9.14 to 9.13](#reference_ftp_45n_nhb)
* [ASA 9.12 to 9.5](#id_59423)

#### ASA 9.20 and 9.19

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.20(x) was the final version for the Firepower 2100 series. * ASA 9.18(x) was the final version for the Firepower 4110, 4120, 4140, 4150, and   Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.19(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.18 with ASA 9.19. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.20(1.5) with ASDM 7.20(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required.  --- |
| --- | --- |

Table 1. ASA and ASDM Compatibility: 9.20 and 9.19

| ASA | ASDM | ASA Model | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 |  | Firepower 2110  2120  2130  2140 | Secure Firewall 3105  3110  3120  3130  3140 | Firepower 4112  4115  4125  4145 | Secure Firewall 4215  Secure Firewall 4225  Secure Firewall 4245 | Firepower 9300 | ISA 3000 |
| **9.20(3)** | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(2) | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(1) | 7.20(1) | — | — | — | — | — | — | **YES** | — | — |
| **9.19(1)** | 7.19(1) | **YES** | **YES** |  | **YES** | **YES** | **YES** | — | **YES** | **YES** |

#### ASA 9.18 to 9.17

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.17(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.17 with ASA 9.18. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.17(1.2) with ASDM 7.17(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.17(1.13) and 9.18(2) and later requires ASDM 7.18(1.152) or later. The ASA now   validates whether the ASDM image is a Cisco digitally signed image. If you try to run   an older ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be   blocked and the message “%ERROR: Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 2. ASA and ASDM Compatibility: 9.18 to 9.17

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 |  | Firepower 2110  2120  2130  2140 | Secure Firewall 3110  3120  3130  3140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.18(4)** | 7.19(1)95 | **YES** | **YES** |  | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(3) | 7.18(1.152) | **YES** | **YES** |  | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(2) | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(1) | 7.18(1) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.17(1.13)** | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.17(1) | 7.17(1.155) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |

#### ASA 9.16 to 9.15

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.15(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.15 with ASA 9.16. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.16(1.15) with ASDM 7.16(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.16(3.19) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 3. ASA and ASDM Compatibility: 9.16 to 9.15

| ASA | ASDM | ASA Model | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.16(4)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3.19) | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(2) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(1) | 7.16(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.15(1)** | 7.15(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |

#### ASA 9.14 to 9.13

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASA 9.12(x) was the final version for the ASA 5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.13(1) can manage an ASA 5516-X on ASA 9.10(1).   ASDM 7.13(1) and ASDM 7.14(1) did not support ASA 5512-X, 5515-X, 5585-X, and ASASM;   you must upgrade to ASDM 7.13(1.101) or 7.14(1.48) to restore ASDM support. * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.13 with ASA 9.14. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.14(1.2) with ASDM 7.14(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.14(4.14) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 4. ASA and ASDM Compatibility: 9.14 to 9.13

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5525-X  5545-X  5555-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.14(4.14)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(4) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(3) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(2) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.30) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.6) | 7.14(1.48) | — | — | **YES** (+ASAv100) | — | — | — | — | — |
| 9.14(1) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.13(1)** | 7.13(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** (except 4112) | **YES** | **YES** |

#### ASA 9.12 to 9.5

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.12(x) was the final version for the ASA   5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all   previous ASA versions, unless otherwise stated.   For example, ASDM 7.12(1) can manage an ASA 5515-X   on ASA 9.10(1). * New ASA versions require the coordinating ASDM   version or a later version; you cannot use an old   version of ASDM with a new version of ASA. For   example, you cannot use ASDM 7.10 with ASA 9.12.   For ASA maintenance releases and interims, you can   continue to use the current ASDM version, unless   otherwise stated. For example, you can use ASA   9.12(1.15) with ASDM 7.12(1). If an ASA   maintenance release has significant new features,   then usually there will be a new ASDM version   required. * ASA 9.8(4.45) and 9.12(4.50) and later require   ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed   image. If you try to run an older ASDM image than   7.18(1.152) with an ASA version with this fix,   ASDM will be blocked and the message “%ERROR:   Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 5. ASA and ASDM Compatibility: 9.12 to 9.5

| ASA | ASDM | ASA Model | | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5512-X  5515-X  5525-X  5545-X  5555-X | ASA 5585-X | ASAv | ASASM | Firepower 2110  2120  2130  2140 | Firepower 4110  4120  4140  4150 | Firepower 4115  4125  4145 | Firepower 9300 | ISA 3000 |
| **9.12(4.50)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(4) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(3) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(2) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(1) | 7.12(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.10(1) | 7.10(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(2) | 7.9(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(1) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| **9.8(4.45)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(4) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(3) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(2) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(1.200) | No support | — | — | — | **YES** | — | — | — | — | — | — |
| 9.8(1) | 7.8(1) | **YES** | **YES** | **YES** | **YES** (+ASAv50) | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.7(1.4) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(4) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(3.1) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(2) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(1) | 7.6(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** (except 4150) | — | **YES** | **YES** |
| 9.5(3.9) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(2.200) | 7.5(2.153) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(2.2) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2.1) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2) | 7.5(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(1.200) | 7.5(1) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(1.5) | 7.5(1.112) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |
| 9.5(1) | 7.5(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |

### Firepower 4100/9300 Compatibility with ASA and Threat Defense

The following table lists compatibility between the ASA and threat
defense applications with the Firepower 4100/9300.

The **bold** versions listed below are specially-qualified companion releases. You
should use these software combinations whenever possible because Cisco performs enhanced
testing for these combinations.

For upgrading, see the following guidelines:

* FXOS—For 2.2.2 and later, you can upgrade directly to a higher
  version. When upgrading from versions earlier than 2.2.2, you need to upgrade to each
  intermediate version. Note that you cannot upgrade FXOS to a version that does not
  support your current logical device version. You will need to upgrade in steps:
  upgrade FXOS to the highest version that supports your current logical device; then
  upgrade your logical device to the highest version supported with that FXOS version.
  For example, if you want to upgrade from FXOS 2.2/ASA 9.8 to FXOS 2.13/ASA 9.19, you
  would have to perform the following upgrades:

  1. FXOS 2.2→FXOS 2.11 (the highest version that supports 9.8)
  2. ASA 9.8→ASA 9.17 (the highest version supported by 2.11)
  3. FXOS 2.11→FXOS 2.13
  4. ASA 9.17→ASA 9.19
* ASA—ASA lets you upgrade directly from your current version to any higher version,
  noting the FXOS requirements above.

| **Note** | ---   This section applies only to the Firepower 4100/9300. Other models utilize FXOS only as an underlying operating system that is included in the ASA and threat defense unified image bundles. For the Secure Firewall 3100 in multi-instance mode, see the Threat Defense compatibility guide.   --- |
| --- | --- |

| **Note** | ---   FXOS 2.8(1.125)+ and later versions do not support ASA 9.14(1) or 9.14(1.10) for ASA SNMP polls and traps; you must use 9.14(1.15)+. Other releases, such as 9.13 or 9.12, are not affected.   --- |
| --- | --- |

| **Note** | ---   FXOS 2.12/ASA 9.18/Threat Defense 7.2 was the final version for the Firepower 4110, 4120, 4140, 4150, and Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300.   --- |
| --- | --- |

Table 6. ASA or Threat Defense, and Firepower 4100/9300 Compatibility

| FXOS Version | Model | ASA Version | Threat Defense Version |
| --- | --- | --- | --- |
| 2.16 | Firepower 4112 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.14(1) | Firepower 4112 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.13 | Firepower 4112 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.12 | Firepower 4112 | **9.18** (recommended)  9.17  9.16  9.14 | **7.2** (recommended)  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.11 | Firepower 4112 | **9.17** (recommended)  9.16  9.14 | **7.1** (recommended)  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.17** (recommended)  9.16  9.14  9.12 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.17** (recommended)  9.16  9.14  9.12  9.8 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.10   | **Note** | For compatibility with 7.0.2+ and 9.16(3.11)+, you need FXOS 2.10(1.179)+. | | --- | --- | | Firepower 4112 | **9.16** (recommended)  9.14 | **7.0** (recommended)  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.16** (recommended)  9.14  9.12 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.16** (recommended)  9.14  9.12  9.8 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.9 | Firepower 4112 | 9.14 | 6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | 9.14  9.12 | 6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.14  9.12  9.8 | 6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.8 | Firepower 4112 | **9.14** | **6.6**   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- | |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.14** (recommended)  9.12   | **Note** | Firepower 9300 SM-56 requires ASA 9.12(2)+ | | --- | --- | | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.14** (recommended)  9.12  9.8 | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.157)   | **Note** | You can now run ASA 9.12+ and FTD 6.4+ on separate modules in the same Firepower 9300 chassis | | --- | --- | | Firepower 4145  Firepower 4125  Firepower 4115 | **9.12**   | **Note** | Firepower 9300 SM-56 requires ASA 9.12.2+ | | --- | --- | | **6.4** |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 | **6.4** (recommended)  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.131) | Firepower 9300 SM-48  Firepower 9300 SM-40 | **9.12** | Not supported |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.73) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | | **6.2.3** (recommended)   | **Note** | 6.2.3.16+ requires FXOS 2.3.1.157+ | | --- | --- | |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.66)  2.3(1.58) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | |  |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.2 | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.8** | Threat Defense versions are EoL |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |

### Radware DefensePro Compatibility

The following table lists the supported Radware DefensePro version for each security appliance and associated logical device.

Table 7. Radware DefensePro Compatibility

| FXOS Version | ASA | Threat Defense | Radware DefensePro | Security Appliance Models |
| --- | --- | --- | --- | --- |
| 2.16 | 9.22(1) | 7.6 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4112  Firepower 4115  Firepower 4125  Firepower 4145 |
| 2.14(1) | 9.20(1) | 7.4(1) | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4112  Firepower 4115  Firepower 4125  Firepower 4145 |
| 2.13.0 | 9.19(1) | 7.3 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4112  Firepower 4115  Firepower 4125  Firepower 4145 |
| 2.12.0 | 9.18(1) | 7.2 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.11.1 | 9.17(1) | 7.1 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.10.1 | 9.16(1) | 7.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.10.1 | 9.16(1) | 7.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.9.1 | 9.15(1) | 6.7.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.8.1 | 9.14(1) | 6.6.0 | 8.13.01.09-3  8.22.2 | Firepower 9300  Firepower 4110  Firepower 4112  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.7(1) | 9.13(1) | 6.5 | 8.13.01.09-3 | Firepower 9300  Firepower 4110  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.6(1) | 9.12(1)  9.10(1) | 6.4.0  6.3.0 | 8.13.01.09-3 | Firepower 9300  Firepower 4110  Firepower 4115  Firepower 4120  Firepower 4125  Firepower 4140  Firepower 4145  Firepower 4150 |
| 2.4(1) | 9.9(2)  9.10(1) | 6.2.3  6.3 | 8.13.01.09-2 | Firepower 9300  Firepower 4110  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.3(1) | 9.9(1)  9.9(2) | 6.2.2  6.2.3 | 8.13.01.09-2 | Firepower 9300  Firepower 4110 (Firepower Threat Defense only)  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.2(2) | 9.8(1)  9.8(2)  9.8(3) | 6.2.0  6.2.2 | 8.10.01.17-2 | Firepower 9300  Firepower 4110 (Firepower Threat Defense only)  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.2(1) | 9.7(1)  9.8(1) | 6.2.0 | 8.10.01.17-2 | Firepower 9300  Firepower 4110 (Firepower Threat Defense only)  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.1(1) | 9.6(2)  9.6(3)  9.6(4)  9.7(1) | not supported | 8.10.01.16-5 | Firepower 9300  Firepower 4120  Firepower 4140  Firepower 4150 |
| 2.0(1) | 9.6(1)  9.6(2)  9.6(3)  9.6(4) | not supported | 8.10.01.16-5 | Firepower 9300  Firepower 4120  Firepower 4140  Firepower 4150 |
| 1.1(4) | 9.6(1) | not supported | 1.1(2.32-3) | 9300 |

## Upgrade Path

For each operating system that you are upgrading, check the supported upgrade path. In some cases, you may have to install
interim upgrades before you can upgrade to your final version.

* [Upgrade Path: ASA Appliances](#ID-2152-0000000a)
* [Upgrade Path: ASA on Firepower 2100 in Platform Mode](#asa-on-firepower-2100-in-platform-mode-upgrade-path)
* [Upgrade Path: ASA Logical Devices for the Firepower 4100/9300](#Cisco_Reference.dita_d121649b-6d91-4619-b00d-bd1faefaa6fa)

### Upgrade Path: ASA Appliances

To view your current version and model, use one of the following methods:

* ASDM: Choose Home > Device Dashboard > Device Information.
* CLI: Use the show version  command.

This table provides upgrade paths for ASA. Some older versions require an
intermediate upgrade before you can upgrade to a newer version. Recommended versions
are in **bold**.

Be sure to check the upgrade guidelines for each release between your starting
version and your ending version. You may need to change your configuration before
upgrading in some cases, or else you could experience an outage.  See [ASA Upgrade Guidelines](#id_47465).

For guidance on security issues on the ASA, and which releases contain fixes for each
issue, see the [ASA Security Advisories](https://tools.cisco.com/security/center/publicationListing.x).

| **Note** | ---   ASA 9.20 was the final version for the Firepower 2100.  ASA 9.18 was the final version for the Firepower 4110, 4120, 4140, 4150, and Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300.  ASA 9.16 was the final version for the ASA 5506-X, 5508-X, and 5516-X.  ASA 9.14 was the final version for the ASA 5525-X, 5545-X, and 5555-X.  ASA 9.12 was the final version for the ASA 5512-X, 5515-X, 5585-X, and ASASM.  ASA 9.2 was the final version for the ASA 5505.  ASA 9.1 was the final version for the ASA 5510, 5520, 5540, 5550, and 5580.   --- |
| --- | --- |

Table 8. Upgrade Path

| **Current Version** | **Interim Upgrade Version** | **Target Version** |
| --- | --- | --- |
| 9.20 | — | Any of the following:  → **9.22** |
| 9.19 | — | Any of the following:  → **9.22**  → **9.20** |
| 9.18 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19** |
| 9.17 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18** |
| 9.16 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17 |
| 9.15 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16** |
| 9.14 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16** |
| 9.13 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14 |
| 9.12 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14 |
| 9.10 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12 |
| 9.9 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12 |
| 9.8 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12 |
| 9.7 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.6 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.5 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.4 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.3 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.2 | — | Any of the following:  → **9.22**  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.14  → 9.12  → 9.8 |
| 9.1(2), 9.1(3), 9.1(4), 9.1(5), 9.1(6), or 9.1(7.4) | — | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 9.1(1) | → 9.1(2) | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 9.0(2), 9.0(3), or 9.0(4) | — | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.6  → 9.1(7.4) |
| 9.0(1) | → 9.0(4) | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.6(1) | → 9.0(4) | Any of the following:  → 9.14  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.5(1) | → 9.0(4) | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.4(5+) | — | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4)  → 9.0(4) |
| 8.4(1) through 8.4(4) | → 9.0(4) | → **9.12**  → 9.8  → 9.1(7.4) |
| 8.3 | → 9.0(4) | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4) |
| 8.2 and earlier | → 9.0(4) | Any of the following:  → **9.12**  → 9.8  → 9.1(7.4) |

### Upgrade Path: ASA on Firepower 2100 in Platform Mode

To view your current version and model, use one of the following methods:

* ASDM: Choose Home > Device Dashboard > Device Information.
* CLI: Use the show version  command.

This table provides upgrade paths for the ASA on the Firepower 2100 in Platform mode.
Some versions require an intermediate upgrade before you can upgrade to a newer
version. Recommended versions are in **bold**.

Be sure to check the upgrade guidelines for each release between your starting
version and your ending version. You may need to change your configuration before
upgrading in some cases, or else you could experience an outage.  See [ASA Upgrade Guidelines](#id_47465).

For guidance on security issues on the ASA, and which releases contain fixes for each
issue, see the [ASA Security Advisories](https://tools.cisco.com/security/center/publicationListing.x).

| **Note** | ---   ASA 9.20 was the final version for the Firepower 2100.   --- |
| --- | --- |

Table 9. Upgrade Path

| **Current Version** | **Interim Upgrade Version** | **Target Version** |
| --- | --- | --- |
| 9.19 | — | Any of the following:  → **9.20** |
| 9.18 | — | Any of the following:  → **9.20**  → **9.19** |
| 9.17 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.16 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18**  → 9.17 |
| 9.15 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16** |
| 9.14 | — | Any of the following:  → **9.20**  → **9.19**  → **9.18**  → 9.17  → **9.16**  → 9.15 |
| 9.13 | → 9.18 | Any of the following:  → **9.20**  → **9.19** |
| 9.13 | — | Any of the following:  → **9.18**  → 9.17  → **9.16**  → 9.15  → 9.14 |
| 9.12 | → 9.18 | Any of the following:  → **9.20**  → **9.19** |
| 9.12 | — | Any of the following:  → **9.18**  → 9.17  → **9.16**  → 9.15  → 9.14 |
| 9.10 | → 9.17 | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.10 | — | Any of the following:  → 9.17  → **9.16**  → 9.15  → 9.14  → 9.12 |
| 9.9 | → 9.17 | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.9 | — | Any of the following:  → 9.17  → **9.16**  → 9.15  → 9.14  → 9.12 |
| 9.8 | → 9.17 | Any of the following:  → **9.20**  → **9.19**  → **9.18** |
| 9.8 | — | Any of the following:  → 9.17  → **9.16**  → 9.15  → 9.14  → 9.12 |

### Upgrade Path: ASA Logical Devices for the Firepower 4100/9300

To view your current version and model, use one of the following methods:

* Firepower Chassis Manager: Choose Overview, and look
  at the Model and Version
  fields at the top.
* CLI: For the version, use the show version  command,
  and look at the Package-Vers: field. For the model, enter scope
  chassis 1 , and then show
  inventory .

For upgrading, see the following guidelines:

* FXOS—For 2.2.2 and later, you can upgrade directly to a higher
  version. When upgrading from versions earlier than 2.2.2, you need to upgrade to each
  intermediate version. Note that you cannot upgrade FXOS to a version that does not
  support your current logical device version. You will need to upgrade in steps:
  upgrade FXOS to the highest version that supports your current logical device; then
  upgrade your logical device to the highest version supported with that FXOS version.
  For example, if you want to upgrade from FXOS 2.2/ASA 9.8 to FXOS 2.13/ASA 9.19, you
  would have to perform the following upgrades:

  1. FXOS 2.2→FXOS 2.11 (the highest version that supports 9.8)
  2. ASA 9.8→ASA 9.17 (the highest version supported by 2.11)
  3. FXOS 2.11→FXOS 2.13
  4. ASA 9.17→ASA 9.19
* ASA—ASA lets you upgrade directly from your current version to any higher version,
  noting the FXOS requirements above.

Table 10. ASA or Threat Defense, and Firepower 4100/9300 Compatibility

| FXOS Version | Model | ASA Version | Threat Defense Version |
| --- | --- | --- | --- |
| 2.16 | Firepower 4112 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.22** (recommended)  9.20  9.19  9.18  9.17  9.16  9.14 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.14(1) | Firepower 4112 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.13 | Firepower 4112 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.12 | Firepower 4112 | **9.18** (recommended)  9.17  9.16  9.14 | **7.2** (recommended)  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.11 | Firepower 4112 | **9.17** (recommended)  9.16  9.14 | **7.1** (recommended)  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.17** (recommended)  9.16  9.14  9.12 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.17** (recommended)  9.16  9.14  9.12  9.8 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.10   | **Note** | For compatibility with 7.0.2+ and 9.16(3.11)+, you need FXOS 2.10(1.179)+. | | --- | --- | | Firepower 4112 | **9.16** (recommended)  9.14 | **7.0** (recommended)  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.16** (recommended)  9.14  9.12 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.16** (recommended)  9.14  9.12  9.8 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.9 | Firepower 4112 | 9.14 | 6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | 9.14  9.12 | 6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.14  9.12  9.8 | 6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.8 | Firepower 4112 | **9.14** | **6.6**   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- | |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.14** (recommended)  9.12   | **Note** | Firepower 9300 SM-56 requires ASA 9.12(2)+ | | --- | --- | | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.14** (recommended)  9.12  9.8 | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.157)   | **Note** | You can now run ASA 9.12+ and FTD 6.4+ on separate modules in the same Firepower 9300 chassis | | --- | --- | | Firepower 4145  Firepower 4125  Firepower 4115 | **9.12**   | **Note** | Firepower 9300 SM-56 requires ASA 9.12.2+ | | --- | --- | | **6.4** |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 | **6.4** (recommended)  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.131) | Firepower 9300 SM-48  Firepower 9300 SM-40 | **9.12** | Not supported |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.73) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | | **6.2.3** (recommended)   | **Note** | 6.2.3.16+ requires FXOS 2.3.1.157+ | | --- | --- | |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.66)  2.3(1.58) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | |  |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.2 | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.8** | Threat Defense versions are EoL |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |

#### Note on Downgrades

Downgrade of FXOS images is not
officially supported. The only Cisco-supported method of
downgrading an image version of FXOS is to perform a
complete re-image of the device.

## Download the Software from Cisco.com

Download all software packages from Cisco.com before you start your upgrade. Depending on the operating system and whether
you are using CLI or GUI, you should place the images on a server or on your management computer. See each installation procedure
for details on supported file locations.

| **Note** | ---   A Cisco.com login and Cisco service contract are required.   --- |
| --- | --- |

* [Download ASA Software](#ID-2152-0000008d)
* [Download FXOS for the Firepower 4100/9300](#ID-2152-0000008d)

### Download ASA Software

If you are using the ASDM Upgrade Wizard, you do not have to
pre-download the software. If you are manually upgrading, for example for a
failover upgrade, download the images to your local computer.

For a CLI upgrade, you can put the software on many server types, including TFTP, HTTP, and FTP. See the copy  command in the [ASA command reference](https://www.cisco.com/c/en/us/td/docs/security/asa/asa-command-reference/A-H/cmdref1/c4.html#pgfId-2171368).

ASA software can be downloaded from Cisco.com. These tables include naming conventions and
information about ASA packages.

Table 11. Current Platforms

| ASA Model | Download Location | Packages |
| --- | --- | --- |
| ASA virtual | <http://www.cisco.com/go/asav-software> |  |
| **ASA Software (Upgrade)**  Choose Adaptive Security Appliance (ASA) Software > *version*. | The ASA virtual upgrade file has a filename like asa962-**smp-k8.bin**; use this upgrade file for all hypervisors. **Note:** The .zip (VMware), .vhdx (Hyper-V), and .qcow2 (KVM) files are only for initial deployment.   | **Note** | To upgrade the ASA virtual for public cloud services such as Amazon Web Services, you can download the above image from Cisco.com (which requires a Cisco.com login and Cisco service contract) and perform the upgrade as described in this guide. There is no way to obtain an *upgrade* image from the public cloud service. | | --- | --- | |
| **ASDM Software (Upgrade)**  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| **ASA Device Package for Cisco Application Policy Infrastructure Controller (APIC)**  Choose ASA for Application Centric Infrastructure (ACI) Device Packages > *version*. | For APIC 1.2(7) and later, choose either the Policy Orchestration with Fabric Insertion, or the Fabric Insertion-only package. The device package software file has a filename like asa-device-pkg-1.2.7.10**.zip**. To install the ASA device package, see the “Importing a Device Package” chapter of the [Cisco APIC Layer 4 to Layer 7 Services Deployment Guide](http://www.cisco.com/c/en/us/support/cloud-systems-management/application-policy-infrastructure-controller-apic/tsd-products-support-series-home.html). |
| Firepower 1000 | <http://www.cisco.com/go/asa-firepower-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp1k.9.13.1**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-7131**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-7131.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| Secure Firewall 3100 | <https://cisco.com/go/asa-secure-firewall-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp3k.9.17.1**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-7171**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-7171.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| Firepower 4100 | <http://www.cisco.com/go/firepower4100-software> |  |
| **ASA and ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes both ASA and ASDM. The ASA package has a filename like cisco-asa.9.6.2**.SPA.csp**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-762**.bin**.   | **Note** | When you upgrade the ASA bundle in FXOS, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-782.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| Secure Firewall 4200 | <https://cisco.com/go/asa-secure-firewall-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp4200.9.20.1**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-7201**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-7201.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| Firepower 9300 | <http://www.cisco.com/go/firepower9300-software> |  |
| **ASA and ASDM Software**  Choose Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes both ASA and ASDM. The ASA package has a filename like cisco-asa.9.6.2**.SPA.csp**. |
| **ASDM Software (Upgrade)**  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-762**.bin**.   | **Note** | When you upgrade the ASA bundle in FXOS, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-782.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| **REST API Software**  Choose Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| ASA Services Module | **ASDM Software**  <http://www.cisco.com/go/asdm-software>  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| ISA 3000 | <http://www.cisco.com/go/isa3000-software> |  |
| **ASA Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**lfbff-k8.SPA**. |
| **ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |

Table 12. Legacy Platforms

| ASA Model | Download Location | Packages |
| --- | --- | --- |
| ASA 5506-X, ASA 5508-X, and ASA 5516-X | <http://www.cisco.com/go/asa-firepower-sw> |  |
| **ASA Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**lfbff-k8.SPA**. |
| **ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html) |
| **ROMMON Software**  Choose your *model* > ASA Rommon Software > *version*. | The ROMMON software file has a filename like asa5500-firmware-1108**.SPA**. |
| ASA 5512-X, ASA 5515-X, ASA 5525-X, ASA 5545-X, and ASA 5555-X | <http://www.cisco.com/go/asa-software> |  |
| **ASA Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**smp-k8.bin**. |
| **ASDM Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html) |
| **ASA Device Package for Cisco Application Policy Infrastructure Controller (APIC)**  Choose your *model* > Software on Chassis > ASA for Application Centric Infrastructure (ACI) Device Packages > *version*. | For APIC 1.2(7) and later, choose either the Policy Orchestration with Fabric Insertion, or the Fabric Insertion-only package. The device package software file has a filename like asa-device-pkg-1.2.7.10**.zip**. To install the ASA device package, see the “Importing a Device Package” chapter of the [Cisco APIC Layer 4 to Layer 7 Services Deployment Guide](http://www.cisco.com/c/en/us/support/cloud-systems-management/application-policy-infrastructure-controller-apic/tsd-products-support-series-home.html). |
| ASA 5585-X | <http://www.cisco.com/go/asa-software> |  |
| **ASA Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**smp-k8.bin**. |
| **ASDM Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Software on Chassis > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |
| **ASA Device Package for Cisco Application Policy Infrastructure Controller (APIC)**  Choose your *model* > Software on Chassis > ASA for Application Centric Infrastructure (ACI) Device Packages > *version*. | For APIC 1.2(7) and later, choose either the Policy Orchestration with Fabric Insertion, or the Fabric Insertion-only package. The device package software file has a filename like asa-device-pkg-1.2.7.10**.zip**. To install the ASA device package, see the “Importing a Device Package” chapter of the [Cisco APIC Layer 4 to Layer 7 Services Deployment Guide](http://www.cisco.com/c/en/us/support/cloud-systems-management/application-policy-infrastructure-controller-apic/tsd-products-support-series-home.html). |
| Firepower 2100 | <http://www.cisco.com/go/asa-firepower-sw> |  |
| **ASA, ASDM, and FXOS Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA package includes ASA, ASDM, and FXOS software. The ASA package has a filename like cisco-asa-fp2k.9.8.2**.SPA**. |
| **ASDM Software (Upgrade)**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | Use this image to upgrade to a later version of ASDM using your current ASDM or the ASA CLI. The ASDM software file has a filename like asdm-782**.bin**.   | **Note** | When you upgrade the ASA bundle, the ASDM image in the bundle replaces the previous ASDM bundle image on the ASA because they have the same name (**asdm.bin**). But if you manually chose a different ASDM image that you uploaded (for example, **asdm-782.bin**), then you continue to use that image even after a bundle upgrade. To make sure that you are running a compatible version of ASDM, you should either upgrade ASDM before you upgrade the bundle, or you should reconfigure the ASA to use the bundled ASDM image (**asdm.bin**) just before upgrading the ASA bundle. | | --- | --- | |
| ASA Services Module | **ASA Software**  <http://www.cisco.com/go/asasm-software>  Choose your *version*. | The ASA software file has a filename like asa962-**smp-k8.bin**. |
| **ASDM Software**  <http://www.cisco.com/go/asdm-software>  Choose Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| ISA 3000 | <http://www.cisco.com/go/isa3000-software> |  |
| **ASA Software**  Choose your *model* > Adaptive Security Appliance (ASA) Software > *version*. | The ASA software file has a filename like asa962-**lfbff-k8.SPA**. |
| **ASDM Software**  Choose your *model* > Adaptive Security Appliance (ASA) Device Manager > *version*. | The ASDM software file has a filename like asdm-762**.bin**. |
| **REST API Software**  Choose your *model* > Adaptive Security Appliance REST API Plugin > *version*. | The API software file has a filename like asa-restapi-132-**lfbff-k8.SPA**. To install the REST API, see the [API quick start guide](http://www.cisco.com/c/en/us/td/docs/security/asa/api/qsg-asa-api.html). |

### Download FXOS for the Firepower 4100/9300

FXOS packages for the Firepower 4100/9300 are available on the Cisco Support & Download
site.

* Firepower 4100 series: <http://www.cisco.com/go/firepower4100-software>
* Firepower 9300: <http://www.cisco.com/go/firepower9300-software>

To find FXOS packages, select or search for your Firepower appliance model, then browse to the
Firepower Extensible Operating System download page for the target version.

| **Note** | ---   If you plan to use the CLI to upgrade FXOS, copy the upgrade package to a server that the Firepower 4100/9300 can access using SCP, SFTP, TFTP, or FTP.   --- |
| --- | --- |

Table 13. FXOS Packages for the Firepower 4100/9300

| **Package Type** | **Package** |
| --- | --- |
| FXOS image | fxos-k9.version**.SPA** |
| Recovery (kickstart) | fxos-k9-**kickstart**.version**.SPA** |
| Recovery (manager) | fxos-k9-**manager**.version**.SPA** |
| Recovery (system) | fxos-k9-**system**.version**.SPA** |
| MIBs | fxos-**mibs**-fp9k-fp4k.version**.zip** |
| Firmware: Firepower 4100 series | fxos-k9-fpr4k-**firmware**.version**.SPA** |
| Firmware: Firepower 9300 | fxos-k9-fpr9k-**firmware**.version**.SPA** |

## Back Up Your Configurations

We recommend that you back up your configurations and other critical files before you upgrade, especially if there is a configuration
migration. Each operating system has a different method to perform backups. Check the ASA, ASDM, ASA FirePOWER local management,
Firepower Management Center, and FXOS configuration guides for more information.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_c28a717b_20250115_120529.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Troubleshooting TechNotes](/c/en/us/support/security/firepower-ngfw/products-tech-notes-list.html)
# Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD)

![](/etc/designs/cdc/fw/i/TAC_lg-icon.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.pdf)
  (955.1 KB)

  View with Adobe Reader on a variety of devices
* [ePub](/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.epub)
  (1.0 MB)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi (Kindle)](/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.mobi)
  (427.8 KB)

  View on Kindle device or Kindle app on multiple devices

Updated:July 17, 2024
Document ID:220415

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

## Contents

[Introduction](#toc-hId--2049551438)[Prerequisites](#toc-hId-437961395)[Requirements](#toc-hId-1128522869)[Components Used](#toc-hId--678931594)[Background Information](#toc-hId-1798078135)[Determine the Active Snort Version that Runs on FTD](#toc-hId--9376328)[FTD Command Line Interface (CLI)](#toc-hId-681185146)[FTD Managed by the Cisco FDM](#toc-hId--1126269317)[FTD Managed by the Cisco FMC](#toc-hId-666080037)[FTD Managed by the Cisco CDO](#toc-hId--1141374426)[Related Information](#toc-hId-1217055688)

##

## Introduction

This document describes steps to confirm the active snort version a Cisco FTD runs when it is managed by the Cisco FDM , the Cisco FMC, or the CDO.

## Prerequisites

### Requirements

Cisco recommends that you have knowledge of these topics:

* Cisco Firepower Management Center (FMC)
* Cisco Firepower Threat Defense (FTD)
* Cisco Firepower Device Manager (FDM)
* Cisco Defense Orchestrator (CDO)

### Components Used

The information in this document is based on these software and hardware versions:

* Cisco Firepower Threat Defense v6.7.0 and 7.0.0
* Cisco Firepower Management Center v6.7.0 and 7.0.0
* Cisco Defense Orchestrator

The information in this document was created from the devices in a specific lab environment. All of the devices used in this document started with a cleared (default) configuration. If your network is live, ensure that you understand the potential impact of any command.

##

## Background Information

SNORT® Intrusion Prevention System has officially launched Snort 3, a sweeping upgrade that features improvements and new features that enhance the performance, faster processing, improved scalability for your network, and a range of 200+ plugins so you can create a custom set-up for your network.

Advantages of Snort 3 include, but are not limited to:

* Improved performance
* Improved SMBv2 inspection
* New script detection capabilities
* HTTP/2 inspection
* Custom rule groups
* Syntax that makes custom intrusion rules easier to write.
* Reasons for why it would have dropped inline results in intrusion events.
* No Snort restarts when changes are deployed to the VDB, SSL policies, custom application detectors, captive portal identity sources, and TLS server identity discovery.
* Improved serviceability, due to Snort 3-specific telemetry data sent to Cisco Success Network, and to better troubleshooting logs.

The support for Snort 3.0 was introduced for the 6.7.0 Cisco Firepower Threat Defense (FTD), just when the FTD is managed through the Cisco Firepower Device Manager (FDM).

**Note**: For new 6.7.0 FTD deployments managed by FDM, Snort 3.0 is the default inspection engine. If you upgrade the FTD to 6.7 from an older release, then Snort 2.0 remains the active inspection engine, but you can switch to Snort 3.0.

**Note**: For this release, Snort 3.0 does not support virtual routers, time-based access control rules, or the decryption of TLS 1.1 or lower connections. Enable Snort 3.0 only if you do not need these features.

Then, Firepower version 7.0 introduced the Snort 3.0 support for the Firepower Threat Defense devices managed by both; the Cisco FDM and by the Cisco Firepower Management Center (FMC).

**Note**: For new 7.0 FTD deployments, Snort 3 is now the default inspection engine. Upgraded deployments continue to use Snort 2, but you can switch at any time.

**Caution**: You can freely switch back and forth between Snort 2.0 and 3.0, so you can revert your change if needed. Traffic is interrupted whenever you switch versions.

**Caution**: Before you switch to Snort 3, is strongly recommend you read and understand the [Firepower Management Center Snort 3 Configuration Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/snort3/config-guide/snort3-configuration-guide-v70.html). Pay special attention to feature limitations and migration instructions. Although the upgrade to Snort 3 is designed for minimal impact, features do not map exactly. The plan and preparation before the upgrade can help you make sure that traffic is handled as expected.

## Determine the Active Snort Version that Runs on FTD

### **FTD Command Line Interface (CLI)**

In order to determine the active snort version that runs on an FTD, log in to the FTD CLI and run the **show snort3 status** command:

Example 1: When there is no output displayed, then the FTD runs Snort 2.

> ```
> >show snort3 status
> >
> ```

Example 2: When the output shows, Currently running Snort 2, then the FTD runs Snort 2.

> ```
> >show snort3 status
> Currently running Snort 2
> ```

Example 3: When the output shows, Currently running Snort 3, then the FTD runs Snort 3.

> ```
> >show snort3 status
> Currently running Snort 3
> ```

### **FTD Managed by the Cisco FDM**

In order to determine the active snort version that runs on an FTD that is managed by the Cisco FDM, proceed with the next steps:

1. Log in to the Cisco FTD through the FDM web interface.
2. From the main menu, select **Policies**.
3. Then, select the **Intrusion** tab.
4. Look for the **Snort Version** or the **Inspection Engine** section to confirm the Snort version that is active in the FTD.

Example 1: The FTD runs snort version 2.

![FTD Runs Snort Version 2 FDM](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-00.png)

Example 2: The FTD runs snort version 3.

![FTD Runs Snort Version 3 FDM](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-01.png)

### **FTD Managed by the** **Cisco FMC**

In order to determine the active snort version that runs on an FTD that is managed by the Cisco FMC, proceed with the next steps:

1. Log in to the Cisco FMC web interface.
2. From the **Devices** menu, select **Device Management**.
3. Then, select the appropriate FTD device.
4. Click the **Edit** pencil icon.
5. Select the **Device** tab and look for the **Inspection Engine** section to confirm the snort version that is active in the FTD:

Example 1: The FTD runs snort version 2.

![FTD Runs Snort Version 2 FMC](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-02.png)

Example 2: The FTD runs snort version 3.

![FTD Runs Snort Version 3 FMC](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-03.png)

### **FTD Managed by the** **Cisco CDO**

In order to determine the active snort version that runs on an FTD that is managed by the Cisco Defense Orchestrator, proceed with the next steps:

1. Log in to the Cisco Defense Orchestrator web interface.
2. From the **Inventory** menu, select the appropriate FTD device.
3. In the **Device Details** section, look for **Snort Version**:

Example 1: The FTD runs snort version 2.

![FTD Runs Snort Version 2 CDO](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-04.png)

Example 2: The FTD runs snort version 3.

![FTD Runs Snort Version 3 CDO](/c/dam/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that-05.png)

## Related Information

* [Cisco Firepower Release Notes, Version 6.7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/relnotes/firepower-release-notes-670/m_features_functionality.html)
* [Cisco Firepower Release Notes, Version 7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/relnotes/firepower-release-notes-700/features.html)
* [Snort 3 Website](https://snort.org/snort3)
* [Technical Support & Documentation - Cisco Systems](https://www.cisco.com/c/en/us/support/index.html)

### Revision History

| Revision | Publish Date | Comments |
| --- | --- | --- |
| 2.0 | 17-Jul-2024 | Added Alt Text. Updated Title, Introduction, and Formatting. |
| 1.0 | 23-Apr-2023 | Initial Release |

![TAC Authored](/etc/designs/cdc/fw/i/TAC_lg-icon.png)

### Contributed by Cisco Engineers

* Theresa GrantTechnical Consulting Engineer
* Amber HurstEngineering Program Manager
* Christian HernandeTechnical Consulting Engineer

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_c619e4e7_20250115_120528.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Snort 3 Configuration Guide, Version 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [An Overview of Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/overview.html)
* [Migrate from Snort 2 to Snort 3](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html)
* Intrusion Detection and Prevention in Snort 3
  + [Get Started with Snort 3 Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/getting-started-intrusion.html)
  + [Tune Intrusion Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/tuning-intrusion-policies.html)
  + [Tailor Intrusion Protection for Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/tailoring-intrusion-protection.html)
* Advanced Network Analysis in Snort 3
  + [Get Started with Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/getting-started-network-analysis.html)
* Encrypted Visibility Engine for Snort 3
  + [Encrypted Visibility Engine](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/m_encrypted-visibility-engine.html)
* Elephant Flow Detection for Snort 3
  + [Elephant Flow Detection](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/m_access-elephant-flow.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Snort 3 Configuration Guide, Version 7.2 Chapter Title Migrate from Snort 2 to Snort 3

* [PDF - Complete Book
  (3.02 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72.pdf)
  [PDF - This Chapter (1.02 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: Migrate from Snort 2 to Snort 3

Chapter Contents

* [Migrate from Snort 2 to Snort 3](#ID-2247-00000004)
* [Snort 3 Inspection Engine](#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable)
* [Prerequisites for Network Analysis and Intrusion Policies](#Cisco_Reference.dita_07c3943c-4b4f-4090-adc2-9ea54c362fac)
* [How to Migrate from Snort 2 to Snort 3](#Cisco_Concept.dita_450b9d50-6826-448d-ba1e-7d1d542d2bfc)
  + [Prerequisites for Migrating from Snort 2 to Snort 3](#Cisco_Concept.dita_9af9711f-b412-450a-8c2c-4f73305775b5)
  + [Enable Snort 3 on an Individual Device](#ID-2247-00000297-enabledisable)
  + [Enable Snort 3 on Multiple Devices](#ID-2247-00000297-enablemultiple)
  + [Convert Snort 2 Custom IPS Rules to Snort 3](#Cisco_Concept.dita_1c32e696-b3a6-4a9a-b352-159bde531bbf)
    - [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3)
    - [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3)

- [View Snort 2 and Snort 3 Base Policy Mapping](#ID-2247-00000297-viewingbase)
- [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize)
- [Deploy Configuration Changes](#task_deploy_config_for_snort3)
Close

# Migrate from Snort 2 to Snort 3

Support for Snort 3 in threat
defense with management center begins in version 7.0. For new and reimaged devices, Snort 3 is the default inspection engine.

As part of threat defense upgrades to version 7.2+, you can automatically upgrade eligible devices from Snort 2 to Snort 3
when you deploy configurations. For devices that are ineligible for automatic upgrade because they use custom intrusion or
network analysis policies, you must manually upgrade to Snort 3 as described in this chapter.

* [Snort 3 Inspection Engine](#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable)
* [Prerequisites for Network Analysis and Intrusion Policies](#Cisco_Reference.dita_07c3943c-4b4f-4090-adc2-9ea54c362fac)
* [How to Migrate from Snort 2 to Snort 3](#Cisco_Concept.dita_450b9d50-6826-448d-ba1e-7d1d542d2bfc)
* [View Snort 2 and Snort 3 Base Policy Mapping](#ID-2247-00000297-viewingbase)
* [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize)
* [Deploy Configuration Changes](#task_deploy_config_for_snort3)

## Snort 3 Inspection Engine

Snort 3 is the default inspection engine for newly registered threat
defense devices of version 7.0 and later. However, for threat
defense devices of lower versions, Snort 2 is the default inspection engine. When you upgrade a managed threat
defense device to version 7.0 or later, the inspection engine remains on Snort 2. To use Snort 3 in upgraded threat
defenses of version 7.0 and later, you must explicitly enable it. When Snort 3 is enabled as the inspection engine of the device,
the Snort 3 version of the intrusion policy that is applied on the device (through the access control policies) is activated
and applied to all the traffic passing through the device.

You can switch Snort versions when required. Snort 2 and Snort 3 intrusion rules
are mapped and the mapping is system-provided. However, you may not find a
one-to-one mapping of all the intrusion rules in Snort 2 and Snort 3. If you
change the rule action for one rule in Snort 2, that change is not retained
if you switch to Snort 3 without synchronizing Snort 2 with Snort 3. For
more information on synchronization, see [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize).

## Prerequisites for Network Analysis and Intrusion Policies

To allow the Snort inspection engine to process traffic for intrusion and malware analysis, you must have the IPS license
enabled for the Threat Defense device.

You must be an Admin user to manage network analysis, intrusion policies, and perform migration tasks.

## How to Migrate from Snort 2 to Snort 3

Migrating from Snort 2 to Snort 3 requires you to switch the inspection engine of the threat
defense device from Snort 2 to Snort 3.

Depending on your requirements, the tasks to complete the migration of your device from Snort 2 to Snort 3 is listed in the
following table:

| Step | Task | Links to Procedures |
| --- | --- | --- |
| 1 | Enable Snort 3 | * [Enable Snort 3 on an Individual Device](#ID-2247-00000297-enabledisable) * [Enable Snort 3 on Multiple Devices](#ID-2247-00000297-enablemultiple) |
| 2 | Convert Snort 2 custom rules to Snort 3 | * [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3) * [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3) |
| 3 | Synchronize Snort 2 rules with Snort 3 | [Synchronize Snort 2 Rules with Snort 3](#ID-2247-00000297-synchronize) |

* [Prerequisites for Migrating from Snort 2 to Snort 3](#Cisco_Concept.dita_9af9711f-b412-450a-8c2c-4f73305775b5)
* [Enable Snort 3 on an Individual Device](#ID-2247-00000297-enabledisable)
* [Enable Snort 3 on Multiple Devices](#ID-2247-00000297-enablemultiple)
* [Convert Snort 2 Custom IPS Rules to Snort 3](#Cisco_Concept.dita_1c32e696-b3a6-4a9a-b352-159bde531bbf)

### Prerequisites for Migrating from Snort 2 to Snort 3

The following are the recommended prerequisites that you must consider before migrating your device from Snort 2 to Snort
3.

* Have a working knowledge of Snort. To learn about the Snort 3 architecture, see [Snort 3 Adoption](https://secure.cisco.com/secure-firewall/v7.2/docs/snort-3-adoption).
* Back up your management center. See [Backup the Management Center](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/admin/720/management-center-admin-72/tools-backup.html#Cisco_Concept.dita_d233b9dd-026b-4119-860f-2db5c9ece832).
* Back up your intrusion policy. See [Exporting Configurations](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/admin/720/management-center-admin-72/tools-import-export.html#ID-2229-0000009d).
* Clone your intrusion policy. To do this, you can use an existing policy as the base policy to create a copy of your intrusion
  policy. In the Intrusion Policies page, click Create Policy and choose an existing intrusion policy from the Base Policy dropdown list.

### Enable Snort 3 on an Individual Device

| **Important** | ---  During the deployment process, there could be a momentary traffic loss because the current inspection engine needs to be shut down.  --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Choose Devices > Device Management. |
| --- | --- |
| **Step 2** | Click the device to go to the device home page.   | **Note** | The device is marked as Snort 2 or Snort 3, showing the current version on the device. | | --- | --- | |
| **Step 3** | Click the Device tab. |
| **Step 4** | In the Inspection Engine section, click Upgrade.   | **Note** | In case you want to disable Snort 3, click Revert to Snort 2 in the Inspection Engine section. | | --- | --- | |
| **Step 5** | Click Yes. |

---

#### What to do next

Deploy the changes on the device. See, [Deploy Configuration Changes](#task_deploy_config_for_snort3).

The system converts your policy configurations during the deployment process to make
them compatible with the selected Snort version.

### Enable Snort 3 on Multiple Devices

To enable Snort 3 on multiple devices, ensure all the required threat
defense devices are on version 7.0 or later.

| **Important** | ---  During the deployment process, there could be a momentary traffic loss because the current inspection engine needs to be shut down.  --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Choose Devices > Device Management. |
| --- | --- |
| **Step 2** | Select all the devices on which you want to enable or disable Snort 3.   | **Note** | The devices are marked as Snort 2 or Snort 3, showing the current version on the device. | | --- | --- | |
| **Step 3** | Click Select Bulk Action drop-down list and choose Upgrade to Snort 3.   | **Note** | To disable Snort 3, click Downgrade to Snort 2. | | --- | --- | |
| **Step 4** | Click Yes. |

---

#### What to do next

Deploy the changes on the device. See, [Deploy Configuration Changes](#task_deploy_config_for_snort3).

The system converts your policy configurations during the deployment process to make
them compatible with the selected Snort version.

### Convert Snort 2 Custom IPS Rules to Snort 3

If you are using a rule set from a third-party vendor, contact that vendor to confirm that their rules successfully convert
to Snort 3 or to obtain a replacement rule set written natively for Snort 3. If you have custom rules that you have written
yourself, familiarize with writing Snort 3 rules prior to conversion, so you can update your rules to optimize Snort 3 detection
after conversion. See the links below to learn more about writing rules in Snort 3.

* <https://blog.snort.org/2020/08/how-rules-are-improving-in-snort-3.html>
* <https://blog.snort.org/2020/10/talos-transition-to-snort-3.html>

You can refer to other blogs at <https://blog.snort.org/> to learn more about Snort 3 rules.

See the following procedures to convert Snort 2 rules to Snort 3 rules using the system-provided tool.

* [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3)
* [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3)

| **Important** | ---   Snort 2 network analysis policy (NAP) settings *cannot* be copied to Snort 3 automatically. NAP settings have to be manually replicated in Snort 3.   --- |
| --- | --- |

* [Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3](#Cisco_Task.dita_9cea427d-5d46-4a47-8d71-11fad52fbd46_snort3)
* [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3)

#### Convert all Snort 2 Custom Rules across all Intrusion Policies to Snort 3

##### Procedure

---

| **Step 1** | Choose Objects > Intrusion Rules . |
| --- | --- |
| **Step 2** | Click Snort 3 All Rules tab. |
| **Step 3** | Ensure All Rules is selected in the left pane. |
| **Step 4** | Click the Tasks drop-down list and choose:   * Convert Snort 2 rules and import—To automatically convert all the Snort 2 custom rules across all the intrusion policies to Snort 3 and import them into management center as Snort 3 custom rules. * Convert Snort 2 rules and download—To automatically convert all the Snort 2 custom rules across all the intrusion policies to Snort 3 and download them into   your local system. |
| **Step 5** | Click OK.   | **Note** | * If you selected Convert and import in the previous step, then all the converted rules are saved under a newly created rule group All Snort 2 Converted Global under Local Rules. * If you selected Convert and download in the previous step, then save the rules file locally. You can review the converted rules in the downloaded file and later   upload them by following the steps in [Add Custom Rules to Rule Groups](tuning-intrusion-policies.html#Cisco_Task.dita_a2d14eea-7bb4-45e6-a81a-14633b898b30). | | --- | --- |   Refer to the video [Converting Snort 2 Rules to Snort 3](https://www.youtube.com/watch?v=7vNNYG5_k3Q) for additional support and information. |

---

##### What to do next

Deploy configuration changes; see [Deploy Configuration Changes](#task_deploy_config_for_snort3).

#### Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3

##### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | In the Intrusion Policies tab, click Show Snort 3 Sync status. |
| **Step 3** | Click the Sync icon snort versions out-of-sync of the intrusion policy.   | **Note** | If the Snort 2 and the Snort 3 versions of the intrusion policy are synchronized, then the Sync icon is in green . It indicates that there are no custom rules to be converted. | | --- | --- | |
| **Step 4** | Read through the summary and click the Custom Rules tab. |
| **Step 5** | Choose:   * Import converted rules to this policy—To convert the Snort 2 custom rules in the intrusion policy to Snort 3 and import them into management center as Snort 3 custom rules. * Download converted rules—To convert the Snort 2 custom rules in the intrusion policy to Snort 3 and download them into your local system. You can   review the converted rules in the downloaded file and later upload the file by clicking the upload icon. |
| **Step 6** | Click Re-Sync. |

---

##### What to do next

Deploy configuration changes; see [Deploy Configuration Changes](#task_deploy_config_for_snort3).

## View Snort 2 and Snort 3 Base Policy Mapping

### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Ensure the Intrusion Policies tab is selected. |
| **Step 3** | Click IPS Mapping. |
| **Step 4** | In the IPS Policy Mapping dialog box, click View Mappings to view the Snort 3 to Snort 2 intrusion policy mapping. |
| **Step 5** | Click OK. |

---

## Synchronize Snort 2 Rules with Snort 3

To ensure that the Snort 2 version settings and custom rules are retained and carried over to Snort 3, the management center provides the synchronization functionality. Synchronization helps Snort 2 rule override settings and custom rules, which
you may have altered and added over the last few months or years, to be replicated on the Snort 3 version. This utility helps
to synchronize Snort 2 version policy configuration with Snort 3 version to start with similar coverage.

If the management center is upgraded from 6.7 or earlier to 7.0 or later version, the system synchronizes the configuration. If the management center is a fresh 7.0 or later version, you can upgrade to a higher version, and the system will not synchronize any content during
upgrade.

Before upgrading a device to Snort 3, if changes are made in Snort 2 version, you can use this utility to have the latest
synchronization from Snort 2 version to Snort 3 version so that you start with a similar coverage.

| **Note** | ---   On moving to Snort 3, it is recommended that you manage the Snort 3 version of the policy independently and do not use this utility as a regular operation.   --- |
| --- | --- |

| **Important** | ---  * Only the Snort 2 rule overrides and custom rules are copied to Snort 3   and not the other way around. You may not find a one-to-one mapping of   all the intrusion rules in Snort 2 and Snort 3.Your changes to rule   actions for rules that exist in both versions are synchronized when you   perform the following procedure. * Synchronization *does not* migrate the threshold and suppression settings of any custom or system-provided rules from Snort 2 to Snort 3.  --- |
| --- | --- |

### Procedure

---

| **Step 1** | Choose Policies > Intrusion. |
| --- | --- |
| **Step 2** | Ensure the Intrusion Policies tab is selected. |
| **Step 3** | Click **Show Snort 3 Sync status**. |
| **Step 4** | Identify the intrusion policy that is out-of-sync. |
| **Step 5** | Click the Sync icon snort versions out-of-sync.   | **Note** | If the Snort 2 and the Snort 3 versions of the intrusion policy are synchronized, then the Sync icon is in green  . | | --- | --- | |
| **Step 6** | Read through the summary and download a copy of the summary if required. |
| **Step 7** | Click Re-Sync.   | **Note** | * The synchronized settings will be applicable on the Snort 3   intrusion engine only if it is applied on a device, and after a   successful deployment. * Snort 2 custom rules can be converted to Snort 3 using the   system-provided tool. If you have any Snort 2 custom rules click   the Custom Rules tab and follow the on-screen instructions to   convert the rules. For more information, see [Convert Snort 2 Custom Rules of a Single Intrusion Policy to Snort 3](#Cisco_Task.dita_3004ce74-1ec1-4d69-b217-80c2641ae7cb_snort3). | | --- | --- | |

---

### What to do next

Deploy configuration changes; see [Deploy Configuration Changes](#task_deploy_config_for_snort3).

## Deploy Configuration Changes

After you change configurations, deploy them to the affected devices.

| **Note** | ---   This topic covers the basic steps involved in deploying configuration changes. We *strongly* recommend that you refer the Deploy Configuration Changes topic in the latest version of the Cisco Secure Firewall Management Center Configuration Guide to understand the prerequisites and implications of deploying the changes before proceeding with the steps.   --- |
| --- | --- |

| **Caution** | ---  When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic.  --- |
| --- | --- |

### Procedure

---

| **Step 1** | On the Secure Firewall Management Center menu bar, click Deploy and choose Deployment.  The GUI page lists the devices with out-of-date configurations having Pendingstatus.   * The Modified By column lists the users who have modified the policies or objects. Expand the device listing to view the users who have modified   the policies for each policy listing.       | **Note** | Usernames are not provided for deleted policies and objects. |   | --- | --- | * The Inspect Interruption column indicates if traffic inspection interruption might occur in the device during deployment.  If this column is blank for a device, it indicates that there will be no traffic inspection interruptions on that device during   deployment. * The Last Modified Time column specifies the last time you made configuration changes. * The Preview column allows you to preview the changes for the next deployment. * The Status column provides the status for each deployment. |
| --- | --- | --- | --- |
| **Step 2** | Identify and choose the devices on which you want to deploy configuration changes.   * Search—Search for the device name, type, domain, group, or status in the search box. * Expand—Click Expand Arrow   (expand arrow icon) to view device-specific configuration changes to be deployed. When you check a check box adjacent to a device, all the changes made to the device and listed under the device, are pushed   for deployment. However, you can use Policy selection    (policy selection icon) to select individual policies or specific configurations to deploy while withholding the remaining changes without deploying   them.       | **Note** | + When the status in the Inspect Interruption column indicates (Yes) that deploying will interrupt inspection, and perhaps traffic, on a threat   defense device, the expanded list indicates the specific configurations causing the interruption with the Inspect   Interruption (inspect interruption icon). + When there are changes to interface groups, security zones, or objects, the impacted devices are shown as out-of-date on the   management center. To ensure that these changes take effect, the policies with these interface groups, security zones, or objects, also need   to be deployed along with these changes. The impacted policies are shown as out-of-date on the Previewpage on the management center. |   | --- | --- | |
| **Step 3** | Click Deploy. |
| **Step 4** | If the system identifies errors or warnings in the changes to be deployed, it displays them in the Validation Messages  window. To view complete details, click the arrow icon before the warnings or errors.  You have the following choices:   * Deploy—Continue deploying without resolving warning conditions. You cannot proceed if the system identifies errors. * Close—Exit without deploying. Resolve the error and warning conditions, and attempt to deploy the configuration again. |

---

### What to do next

During deployment, if there is a deployment failure, there is a possibility that the failure may impact traffic. However,
it depends on certain conditions. If there are specific configuration changes in the deployment, the deployment failure may
lead to traffic being interrupted. For details, see the Deploy Configuration Changes topic in the latest version of the Cisco Secure Firewall Management Center Configuration Guide.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_53341f93_20250115_120522.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from www.cisco.com_8547858e_20250115_120530.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Device Configuration Guide, 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Getting Started with Device Configuration
  + [Device Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-device-management.html)
  + [Users](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-logical-devices.html)
  + [High Availability](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/high-availability.html)
  + [Clustering for the Secure Firewall 3100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-sec-fw-3100.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-firewall.html)
  + [Inline Sets and Passive Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000/2100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ecmp.html)
  + [OSPF](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-certs.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-monitoring.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-rules.html)
  + [URL Filtering](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-service-policies.html)
  + [Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-detection.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-content-restriction.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/network-malware-protection.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-overview.html)
  + [SSL Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html)
  + [TLS/SSL
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rules.html)
  + [TLS/SSL
    Rules and Policy Example](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rule-examples.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-realms.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-captive-portal.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-access-control.html)
  + [Getting Started with
    Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-get-start.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-adaptive-profiles.html)
* Threat Intelligence Director
  + [Secure Firewall Threat Intelligence Director](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-intelligence-director.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Device Configuration Guide, 7.2 Chapter Title SSL Policies

* [PDF - Complete Book
  (78.84 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72.pdf)
  [PDF - This Chapter (1.46 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: SSL Policies

Chapter Contents

* [SSL Policies](#ID-2253-00000004)
* [SSL Policies Overview](#concept_6696BC22D1DA4348962E4D4039215767)
* [SSL Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Requirements and Prerequisites for SSL Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create Basic SSL Policies](#ID-2253-00000099)
* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Manage SSL Policies](#ID-2253-00000021)

Close

# SSL Policies

The following topics provide an overview of SSL policy creation, configuration, management, and logging.

* [SSL Policies Overview](#concept_6696BC22D1DA4348962E4D4039215767)
* [SSL Policy Default Actions](#ID-2253-00000065)
* [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4)
* [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8)
* [Requirements and Prerequisites for SSL Policies](#Cisco_Reference.dita_8c085c1c-d8e8-4aa6-bc62-d94df64488ec)
* [Create Basic SSL Policies](#ID-2253-00000099)
* [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)
* [Manage SSL Policies](#ID-2253-00000021)

## SSL Policies Overview

An
SSL policy determines how the system handles encrypted traffic on your network. You can configure one or more SSL policies, associate an
SSL policy with an access control policy, then deploy the access control policy to a managed device. When the device detects a TCP handshake,
the access control policy first handles and inspects the traffic. If it subsequently identifies a TLS/SSL-encrypted session over the TCP connection, the SSL policy takes over, handling and decrypting the encrypted traffic.

| **Caution** | ---   *Snort 2 only*. Adding or removing an SSL policy restarts the Snort process when you deploy configuration changes, temporarily interrupting traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](get-started-deployment.html#concept_uc1_gtq_ty) for more information.   --- |
| --- | --- |

The simplest SSL policy, as shown in the following diagram, directs the device where it is deployed to handle encrypted traffic with a single default
action. You can set the default action to block decryptable traffic without further inspection, or to inspect undecrypted
decryptable traffic with access control. The system can then either allow or block the encrypted traffic. If the device detects
undecryptable traffic, it either blocks the traffic without further inspection or does not decrypt it, inspecting it with
access control.

![When an encrypted packet is detected by the system, first the SSL policy's undecryptable action policy is applied, followed by the policy's default action and so on](/c/dam/en/us/td/i/300001-400000/370001-380000/372001-373000/372912.jpg)

![When an encrypted packet is detected by the system, first the decryption policy's undecryptable action policy is applied, followed by the policy's default action and so on](/c/dam/en/us/td/i/400001-500000/460001-470000/465001-466000/465003.jpg)

A more complex SSL policy can handle different types of undecryptable traffic with different actions, control traffic based on whether a certificate
authority (CA) issued or trusts the encryption certificate, and use TLS/SSL
rules to exert granular control over encrypted traffic logging and handling. These rules can be simple or complex, matching and
inspecting encrypted traffic using multiple criteria.

| **Note** | ---   Because TLS and SSL are often used interchangeably, we use the expression *TLS/SSL* to indicate that either protocol is being discussed. The SSL protocol has been deprecated by the IETF in favor of the more secure TLS protocol, so you can usually interpret *TLS/SSL* as referring to TLS only.  The exception is SSL policies. Because the management center configuration option is Policies > Access Control > SSL, we use the term *SSL policies* although these policies are used to define rules for TLS and SSL traffic.  For more information about SSL and TLS protocols, see a resource such as [SSL vs. TLS - What's the Difference?](https://www.globalsign.com/en/blog/ssl-vs-tls-difference/).   --- |
| --- | --- |

**Related Concepts**
[TLS/SSL Rule Conditions](encrypted-traffic-rules.html#ID-2254-00000164)

## SSL Policy Default Actions

The default action for an
SSL policy determines how the system handles decryptable encrypted traffic that does not match any non-monitor rule in the policy. When
you deploy an
SSL policy that does not contain any TLS/SSL
rules, the default action determines how all decryptable traffic on your network is handled. Note that the system does not perform
any kind of inspection on encrypted traffic blocked by the default action.

Table 1. SSL Policy Default Actions

| Default Action | Effect on Encrypted Traffic |
| --- | --- |
| Block | Block the TLS/SSL session without further inspection. |
| Block with reset | Block the TLS/SSL session without further inspection and reset the TCP connection. Choose this option if traffic uses a connectionless protocol like UDP. In that case, the connectionless protocol tries to reestablish the connection until it is reset.  This action also displays a connection reset error in the browser so the user is informed that the connection is blocked. |
| Do not decrypt | Inspect the encrypted traffic with access control. |

**Related Tasks**
[Create Basic SSL Policies](#ID-2253-00000099)

## Default Handling Options for Undecryptable Traffic

Table 2. Undecryptable Traffic Types

| Type | Description | Default Action | Available Action |
| --- | --- | --- | --- |
| Compressed Session | The TLS/SSL session applies a data compression method. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| SSLv2 Session | The session is encrypted with SSL version 2.  Note that traffic is decryptable if the ClientHello message is SSL 2.0, and the remainder of the transmitted traffic is SSL 3.0. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unknown Cipher Suite | The system does not recognize the cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Unsupported Cipher Suite | The system does not support decryption based on the detected cipher suite. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Session not cached | The TLS/SSL session has session reuse enabled, the client and server reestablished the session with the session identifier, and the system did not cache that session identifier. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Handshake Errors | An error occurred during TLS/SSL handshake negotiation. | Inherit default action | Do not decrypt  Block  Block with reset  Inherit default action |
| Decryption Errors | An error occurred during traffic decryption. | Block | Block  Block with Reset |

When you first create an
SSL policy, logging connections that are handled by the default action is disabled by default. Because the logging settings for the
default action also apply to undecryptable traffic handling, logging connections handled by the undecryptable traffic actions
is disabled by default.

Note that if your browser uses certificate pinning to verify a server certificate, you cannot decrypt this traffic by re-signing
the server certificate. For more information, see [TLS/SSL Rule Guidelines and Limitations](encrypted-traffic-rules.html#id_65029).

**Related Tasks**
[Set Default Handling for Undecryptable Traffic](#ID-2253-00000154)

## SSL Policy Advanced Options

An
SSL policy 's Advanced Settings page has global settings that are applied to all managed devices that are configured for Snort 3 to which the policy is applied.

An
SSL policy advanced settings are all ignored on any managed device that runs:

* A version earlier than 7.1
* Snort 2

### Block flows requesting ESNI

Encrypted Server Name Indication (ESNI ([link to draft proposal](https://tools.ietf.org/html/draft-ietf-tls-esni))) is a way for a client to tell a TLS 1.3 server what the client is requesting. Because the SNI is encrypted, you can optionally
block these connections because the system cannot determine what the server is.

### Disable HTTP/3 advertisement

This option strips HTTP/3 ([RFC 9114](https://www.rfc-editor.org/rfc/rfc9114.html)) from the ClientHello in TCP connections. HTTP/3 is part of the QUIC transport protocol, not the TCP transport protocol.
Blocking clients from advertising HTTP/3 provides protection against attacks and evasion attempts potentially burried within
QUIC connections.

### Propagate untrusted server certificates to clients

This applies only to traffic matching a Decrypt - Resign rule action.

Enable this option to substitute the certificate authority (CA) on the managed device for the server's certificate in cases
where the server certificate is untrusted. An *untrusted* server certificate is one that is not listed as a trusted CA in the Secure Firewall Management
Center. (Objects > Object Management >  PKI >  Trusted CAs).

### Enable TLS 1.3 Decryption

Whether to apply decryption rules to TLS 1.3 connections. If you do not enable this option, the decryption rules apply to
TLS 1.2 or lower traffic only. See [TLS 1.3 Decryption Best Practices](#Cisco_Reference.dita_f23753dd-8a26-4550-a919-f67db97a117c).

## Requirements and Prerequisites for SSL Policies

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Create Basic SSL Policies

To configure an
SSL policy, you must give the policy a unique name and specify a default action.

### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Click New Policy. |
| **Step 4** | Give the policy a unique Name and, optionally, a Description. |
| **Step 5** | Specify the Default Action; see [SSL Policy Default Actions](#ID-2253-00000065). |
| **Step 6** | Configure logging options for the default actionas described in Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management Center Administration Guide](http://www.cisco.com/go/firepower-config) . |
| **Step 7** | Click Save. |

---

What To Do Next

* Set the default handling for undecryptable traffic; see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154).
* Configure logging options for default handling of undecryptable
  traffic; see Logging Connections with a Policy Default
  Action in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* Set advanced policy properties: [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8).
* Associate the SSL policy with an access control policy as described in [Associating Other Policies with Access Control](access-policies.html#id_17609).
* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Set Default Handling for Undecryptable Traffic

You can set undecryptable traffic actions at the SSL policy level to handle certain types of encrypted traffic the system cannot decrypt or inspect. When you deploy an
SSL policy that contains no TLS/SSL
rules, the undecryptable traffic actions determine how all undecryptable encrypted traffic on your network is handled.

Depending on the type of undecryptable traffic, you can choose
to:

* Block the connection.
* Block the connection, then reset it. This option is preferrable for connectionless protocols like UDP, which keep trying to
  connect until the connection is blocked.
* Inspect the encrypted traffic with access control.
* Inherit the default action from the SSL policy.

### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Click Edit (edit icon) next to the name of the SSL policy. |
| **Step 4** | In the SSL policy editor, click Undecryptable Actions. |
| **Step 5** | For each field, choose either the SSL policy's default action or another action you want to take on the type of undecryptable traffic. See [Default Handling Options for Undecryptable Traffic](#ID-2253-000000d4) and [SSL Policy Default Actions](#ID-2253-00000065) for more information. |
| **Step 6** | Click Save to save the policy. |

---

### What to do next

* Configure default logging for connections handled by the undecryptable
  traffic actions; see Logging Connections with a Policy Default
  Action in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Manage SSL Policies

In the SSL policy editor, you can:

* Add, edit, delete, enable, disable, and organize TLS/SSL
  rules.
* Add trusted CA certificates.
* Determine the handling for encrypted traffic the system cannot decrypt.
* Log traffic that is handled by the default action and undecryptable traffic actions.
* Set advanced options.

Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the
last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing
each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor.
After 60 minutes, the system discards your changes.
### Procedure

---

| **Step 1** | Log in to the management center if you haven't already done so. |
| --- | --- |
| **Step 2** | Click Policies > Access Control > SSL. |
| **Step 3** | Manage SSL policies:   * Compare—Click Compare Policies; see [Comparing policies](get-started-deployment.html#task_ABA1FE48DBBB44BC9FF40243FCC58BF6). * Copy—Click Copy  (copy icon). * Create—Click New Policy; see [Create Basic SSL Policies](#ID-2253-00000099). * Delete—Click Delete (delete icon). If the controls are dimmed, the configuration belongs to an ancestor domain, or you do not have permission to modify the   configuration. * Report—Click Report (Report icon); see [Generate Current Policy Reports](get-started-deployment.html#task_CCED983433824793AF09203FDAD1AF53). * Edit—Click Edit (edit icon). If View (View button) appears instead, the configuration belongs to an ancestor   domain, or you do not have permission to modify the   configuration. * To add trusted CA certificates to your SSL policy, see [Trusting External Certificate Authorities](encrypted-traffic-rules.html#ID-2255-00000623). * To configure how your SSL policy handles undecryptable traffic, see [Set Default Handling for Undecryptable Traffic](#ID-2253-00000154). * SSL policy advanced settings—See [SSL Policy Advanced Options](#Cisco_Reference.dita_9fb8dc41-d845-4470-8c77-2ce3910180b8). * Import/Export—See the section on importing and exporting the configuration in the [Secure Firewall Management Center and   Threat Defense Management Network   Administration](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/management-center-mgmt-nw/fmc-ftd-mgmt-nw.html). * To log connections for undecryptable traffic handling and traffic that does not match SSL rules, see Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config)   . * Deploy—Choose Deploy > Deployment; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B). |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase2-stage.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_0ff5a3d7_20250115_120502.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Device Configuration Guide, 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Getting Started with Device Configuration
  + [Device Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-device-management.html)
  + [Users](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-logical-devices.html)
  + [High Availability](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/high-availability.html)
  + [Clustering for the Secure Firewall 3100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-sec-fw-3100.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-firewall.html)
  + [Inline Sets and Passive Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000/2100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ecmp.html)
  + [OSPF](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-certs.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-monitoring.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-rules.html)
  + [URL Filtering](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-service-policies.html)
  + [Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-detection.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-content-restriction.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/network-malware-protection.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-overview.html)
  + [SSL Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html)
  + [TLS/SSL
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rules.html)
  + [TLS/SSL
    Rules and Policy Example](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rule-examples.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-realms.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-captive-portal.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-access-control.html)
  + [Getting Started with
    Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-get-start.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-adaptive-profiles.html)
* Threat Intelligence Director
  + [Secure Firewall Threat Intelligence Director](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-intelligence-director.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Device Configuration Guide, 7.2 Chapter Title Access Control Policies

* [PDF - Complete Book
  (78.84 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72.pdf)
  [PDF - This Chapter (1.27 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: Access Control Policies

Chapter Contents

* [Access Control Policies](#ID-2176-00000004)
* [Access Control Policy Components](#ID-2176-00000027)
* [System-Created Access Control Policies](#Cisco_Reference.dita_33686019-b9a4-4e86-b5df-8a05e1b5c85a)
* [Requirements and Prerequisites for Access Control Policies](#Cisco_Reference.dita_10d15872-b6cb-4f48-9f5d-256328992dd0)
* [Managing Access Control Policies](#ID-2176-00000349)
  + [Creating a Basic Access Control Policy](#ID-2176-00000240)
  + [Editing an Access Control Policy](#ID-2176-0000028c)
  + [Locking an Access Control Policy](#Cisco_Task_in_List_GUI.dita_aa34a44f-7f8e-42dc-816f-13a4c4e68c1b)
  + [Managing Access Control Policy Inheritance](#task_BE64105A65EF48818499392E831EC638)
    - [Choosing a Base Access Control Policy](#task_E56A1F1516764E1796F458FAD391511D)
    - [Inheriting Access Control Policy Settings from the Base Policy](#task_F21A620007B64787A8FB6AA6F4953044)
    - [Locking Settings in Descendant Access Control Policies](#task_F42F7E3F0AB34A8C8D273F85F49046A8)
    - [Requiring an Access Control Policy in a Domain](#task_19B6B3BAE0154F6196C95FB4AA97AC9B)
  + [Setting Target Devices for an Access Control Policy](#ID-2176-000002e6)
  + [Logging Settings for Access Control Policies](#AC_Policy_Syslog_Settings)
  + [Access Control Policy Advanced Settings](#ID-2176-00000314)
    - [Associating Other Policies with Access Control](#id_17609)
  + [Viewing Rule Hit Counts](#id_92824)
* [History for Access Control Policies](#Cisco_Reference.dita_ee445615-2856-4202-9f60-5ee5da5fc69c)

Close

# Access Control Policies

The following topics describe how to work with access control policies:

* [Access Control Policy Components](#ID-2176-00000027)
* [System-Created Access Control Policies](#Cisco_Reference.dita_33686019-b9a4-4e86-b5df-8a05e1b5c85a)
* [Requirements and Prerequisites for Access Control Policies](#Cisco_Reference.dita_10d15872-b6cb-4f48-9f5d-256328992dd0)
* [Managing Access Control Policies](#ID-2176-00000349)
* [History for Access Control Policies](#Cisco_Reference.dita_ee445615-2856-4202-9f60-5ee5da5fc69c)

## Access Control Policy Components

Following are the main elements of an access control policy.

Name and Description

Each access control policy must have a unique name. A description is
optional.

Inheritance Settings

Policy inheritance allows you to create a hierarchy of access control policies. A parent (or *base*) policy defines and enforces default settings for its descendants.

A policy's inheritance settings allow you to select its base policy. You
can also lock settings in the current policy to force any descendants to
inherit them. Descendant policies can override unlocked settings.

Policy Assignment

Each access control policy identifies the devices that use it. Each device can be targeted by only one access control policy.

Rules

Access control rules provide a granular method of
handling network traffic. Rules in an access control policy are
numbered, starting at 1, including rules inherited from ancestor
policies. The system matches traffic to access control rules in top-down
order by ascending rule number.

Usually, the system handles network traffic
according to the *first* access control rule
where *all* the rule’s conditions match the
traffic. Conditions can be simple or complex, and their use often
depends on certain licenses.

Default Action

The default action determines how the system
handles and logs traffic that is not handled by any other access control
configuration. The default action can block or trust all traffic without
further inspection, or inspect traffic for intrusions and discovery
data.

Although an access control policy can inherit its default action from an
ancestor policy, you cannot enforce this inheritance.

Security Intelligence

Security Intelligence is a first line of defense
against malicious internet content. This feature allows you to block
connections based on the latest IP address, URL, and domain name
reputation intelligence. To ensure continual access to vital resources,
you can override Block list entries with custom Do Not Block list
entries.

HTTP Responses

When the system blocks a user’s website request,
you can either display a generic system-provided response page, or a
custom page. You can also display a page that warns users, but also
allows them to continue to the originally requested site.

Logging

Settings for access control policy logging allow
you to configure default syslog destinations for the current access
control policy. The settings are applicable to the access control policy
and all the included SSL, prefilter, and intrusion policies unless the
syslog destination settings are explicitly overridden with custom
settings in included rules and policies.

Advanced Access Control Options

Advanced access control policy settings typically
require little or no modification. Often, the default settings are
appropriate. Advanced settings you can modify include traffic
preprocessing, SSL inspection, identity, and various performance
options.

## System-Created Access Control Policies

Depending on your devices' initial configurations, system-provided policies can include:

* Default Access Control—Blocks all traffic without further inspection.
* Default Intrusion Prevention—Allows all traffic, but also inspects with the Balanced Security and Connectivity intrusion policy
  and default intrusion variable set.
* Default Network Discovery—Allows all traffic while inspecting it for discovery data but not intrusions or exploits.

## Requirements and Prerequisites for Access Control Policies

### Model Support

Any

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Managing Access Control Policies

You can edit system-provided access control policies and create custom
access control policies.

### Procedure

---

| **Step 1** | Choose Policies > Access Control. |
| --- | --- |
| **Step 2** | Manage access control policies:   * Create—Click New Policy; see [Creating a Basic Access Control Policy](#ID-2176-00000240). * Inheritance—Click Plus next to a policy with descendants to expand your view of the policy's hierarchy. * Edit—Click Edit (edit icon); see [Editing an Access Control Policy](#ID-2176-0000028c) * Delete—Click Delete (delete icon). You must remove any device assignments before deleting a policy. * Copy—Click Copy  (copy icon). Device assignments are not retained in the copy. * Report—Click Report (Report icon). * Lock or unlock a policy—See [Locking an Access Control Policy](#Cisco_Task_in_List_GUI.dita_aa34a44f-7f8e-42dc-816f-13a4c4e68c1b). |

---

* [Creating a Basic Access Control Policy](#ID-2176-00000240)
* [Editing an Access Control Policy](#ID-2176-0000028c)
* [Locking an Access Control Policy](#Cisco_Task_in_List_GUI.dita_aa34a44f-7f8e-42dc-816f-13a4c4e68c1b)
* [Managing Access Control Policy Inheritance](#task_BE64105A65EF48818499392E831EC638)
* [Setting Target Devices for an Access Control Policy](#ID-2176-000002e6)
* [Logging Settings for Access Control Policies](#AC_Policy_Syslog_Settings)
* [Access Control Policy Advanced Settings](#ID-2176-00000314)
* [Viewing Rule Hit Counts](#id_92824)

### Creating a Basic Access Control Policy

When you create a new access control policy, it contains default actions
and settings. After creating the policy, you are immediately placed in an edit
session so that you can adjust the policy to suit your requirements.

#### Procedure

---

| **Step 1** | Choose Policies > Access Control. |
| --- | --- |
| **Step 2** | Click New Policy. |
| **Step 3** | Enter a unique Name and, optionally, a Description. |
| **Step 4** | Optionally, choose a base policy from the Select Base Policy drop-down list.  If an access control policy is enforced on your domain, this step is not optional. You must choose the enforced policy or one of its descendants as the base policy.  If you select a base policy, the base policy defines the default action and you cannot select a new one in this dialog box. Logging for connections handled by the default action depends on the base policy. |
| **Step 5** | When you do not select a base policy, specify the initial Default Action:   * Block all traffic   creates a policy with the Access   Control: Block All Traffic default action. * Intrusion Prevention   creates a policy with the Intrusion   Prevention: Balanced Security and Connectivity   default action, associated with the default intrusion variable set. * Network Discovery   creates a policy with the Network   Discovery Only default action.   When you select a default action, logging of connections handled by the default action is initially disabled. You can enable it later when you edit the policy.   | **Tip** | If you want to trust all traffic by default, or if you chose a base policy and do not want to inherit the default action, you can change the default action later. | | --- | --- | |
| **Step 6** | Optionally, choose the Available Devices where you want to deploy the policy, then click Add to Policy (or drag and drop) to add the selected devices. To narrow the devices that appear, type a search string in the Search field.  If you want to deploy this policy immediately, you must perform this step. |
| **Step 7** | Click Save.  The new policy opens for edit. You can add rules to it and make other changes as needed. See [Editing an Access Control Policy](#ID-2176-0000028c) . |

---

### Editing an Access Control Policy

When you edit an access control policy, you should lock it
to ensure that your changes do not get overridden by another person who might edit
it simultaneously.

You can only edit access control policies that were created in the current domain.
Also, you cannot edit settings that are locked by an ancestor access control policy.

| **Note** | ---   If you do not lock the policy, consider the following: Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor. After 60 minutes, the system discards your changes.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | Choose Policies > Access Control. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) next to the access control policy you want to edit.  If View (View button) appears instead, the configuration belongs to an ancestor domain, or you do not have permission to modify the configuration. |
| **Step 3** | Optionally, click Try New UI Layout to switch to the user interface introduced in version 7.2.  The procedures will mention how to do actions in both the legacy UI (user interface), which was available in previous releases, and the new UI. Both interfaces configure the same policy, the difference is in presentation only.  You can return to the legacy UI by clicking Switch to Legacy UI. |
| **Step 4** | (Legacy UI.) Edit your access control policy.   | **Tip** | You can edit multiple rules at one time by shift-clicking or control-clicking multiple rules, then right-clicking and choosing Edit. Bulk editing is available for enabling and disabling rules, selecting rule action, and setting most inspection and logging settings. | | --- | --- |   Settings:   * Name and Description—Click either field and enter new information. * Default Action—Choose a value from the Default Action drop-down list. * Default Action Variable Set—To change the variable set associated with an Intrusion Prevention default action, click Variables    (variables icon). In the popup window that appears, select a new variable set and click OK. You can also click Edit (edit icon) to edit the selected variable set in a new window. For more information, see [Managing Variables](objects-object-mgmt.html#ID-2243-000006b4). * Default Action Logging—To configure logging for connections handled by the default action, click Logging (logging icon); see Logging Connections with a Policy Default Action in the [Cisco Secure Firewall Management   Center Administration Guide](http://www.cisco.com/go/firepower-config). * HTTP Responses—To specify what the user sees in a browser when the system blocks a website request, click HTTP Responses; see [Choosing HTTP Response Pages](access-url-filtering.html#ID-2189-0000041e). * Inheritance: Change Base Policy—To change the base access control policy for this policy, click Inheritance Settings; see [Choosing a Base Access Control Policy](#task_E56A1F1516764E1796F458FAD391511D). * Inheritance: Lock Settings in Descendants—To enforce this policy's settings in its descendant policies, click Inheritance Settings; see [Locking Settings in Descendant Access Control Policies](#task_F42F7E3F0AB34A8C8D273F85F49046A8). * Policy Assignment: Targets—To identify the managed devices targeted by this policy, click Policy Assignment; see [Setting Target Devices for an Access Control Policy](#ID-2176-000002e6). * Policy Assignment: Required in Domains—To enforce this policy in a subdomain, click Policy Assignment; see [Requiring an Access Control Policy in a Domain](#task_19B6B3BAE0154F6196C95FB4AA97AC9B). * Rules—To manage access control rules, and to inspect and block malicious traffic using intrusion and file policies, click   Rules; see [Create and Edit Access Control Rules](access-rules.html#ID-2190-00000090). * Rule Conflicts—To show rule conflict warnings, enable Show rule conflicts. Rule conflicts occur when a rule will never match traffic because an earlier rule always matches the traffic first. Because   determining rule conflicts is resource intensive, displaying them may take some time. For more information, see [Best Practices for Ordering Rules](access-overview.html#ID-2176-000005cc). * Security Intelligence—To immediately block connections based on the latest reputation intelligence using a Block list, click   Security Intelligence; see [Configure Security Intelligence](access-security-intelligence.html#ID-2192-00000098). * Advanced Options—To set preprocessing, SSL inspection, identity, performance, and other advanced options, click Advanced; see [Access Control Policy Advanced Settings](#ID-2176-00000314). * Warnings—To view a list of warnings or errors in your access control policy (and its descendant and associated policies),   click Show Warnings. Warnings and errors mark configurations that could adversely affect traffic analysis and flow or prevent the policy from   deploying. If there are no warnings, show warnings does not appear. To view rule conflict warnings, first enable Show rule conflicts. |
| **Step 5** | (New UI) Edit your access control policy.   | **Tip** | You can operate on multiple rules at one time by selecting their checkboxes in the left column, then selecting the action you want to perform from the Select Action drop-down list next to the search box. Bulk editing is available for enabling and disabling, copying, cloning, moving, deleting, and editing rules, or viewing hit counts or related events. | | --- | --- |   You can change the following settings or perform these actions:   * Name and Description—Click Edit (edit icon) next to the name, make your changes, and click Save. * Default Action—Choose a value from the Default Action drop-down list. * Default Action Settings—Click Cog (cog icon), make your changes, and click OK. You can configure settings for logging, the location of an external syslog server or SNMP trap server, and the variable   set associated with an intrusion prevention default action. * Associated Policies—To edit or change policies in the packet flow, click the policy type in the packet flow representation   below the policy name. You can select the Prefilter Rules, SSL, Security Intelligence, and Identity policies. When necessary, click Access Control to return to the access control rules. * Policy Assignment—To identify the managed devices targeted by this policy, or enforce this policy in a subdomain, click the   Targeted: x devices link. * Rules—To manage access control rules, and to inspect and block malicious traffic using intrusion and file policies, click   Add Rule, or right-click an existing rule and select Edit or another appropriate action. The actions are also available from the More (more icon) button for each rule. See [Create and Edit Access Control Rules](access-rules.html#ID-2190-00000090). * Layout—Use the Grid/Table View icon above the list of rules to change the layout. Grid view provides color-coded objects in an easy-to-see layout. Table   view provides a summary list so that you can see more rules at once. You can freely switch views without impacting the rules. * Columns (Table view only)—Click the Show/Hide Columns icon above the list of rules to select which information to show in the table. Click Hide Empty Columns to quickly remove all columns that have no information, that is, you are not using those conditions in any rule. Click Revert to Default to undo all of your customizations. * Hit Counts—To view statistics on how many connections matched each rule, click Analyze Hit Counts. * Additional Settings—To change additional settings for the policy, select one of the following options from the More drop-down arrow at the end of the packet flow line.    + Advanced Settings—To set preprocessing, SSL inspection, identity, performance, and other advanced options. See [Access Control Policy Advanced Settings](#ID-2176-00000314).   + HTTP Responses—To specify what the user sees in a browser when the system blocks a website request. See [Choosing HTTP Response Pages](access-url-filtering.html#ID-2189-0000041e).   + Inheritance Settings—To change the base access control policy for this policy, and to enforce this policy's settings in its descendant policies.     See [Choosing a Base Access Control Policy](#task_E56A1F1516764E1796F458FAD391511D) and [Locking Settings in Descendant Access Control Policies](#task_F42F7E3F0AB34A8C8D273F85F49046A8) .   + Logging—To set the default logging options for the policy. |
| **Step 6** | Click Save. |

---

#### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

### Locking an Access Control Policy

You can lock an access control policy to prevent other administrators from editing
it. Locking the policy ensures that your changes will not be invalidated if another
administrator edits the policy and saves changes before you save your changes.
Without locking, if multiple administrators edit the policy simultaneously, the
first person who saves changes wins, and all other users have their changes erased.

The lock is for the access control policy itself. The lock does not apply to objects
used in the policy. For example, another user can edit a network object that is used
in a locked access control policy. Your lock remains in place until you explicitly
unlock the policy, so you can log out and come back to your edits later.

When locked, other administrators have read-only access to the policy. However, other
administrators can assign a locked policy to a managed device.

#### Before you begin

Any user role that has permission to modify the access control policy has permission
to lock it, and to unlock a policy that was locked by another user.

However, the ability to unlock a policy that was locked by another administrator is
controlled by the following permission: Policies > Access Control > Access Control Policy > Modify Access Control Policy > Override Access Control Policy Lock.

If you are using custom roles, your organization might have limited your unlocking
abilities by not assigning this permission. Without this permission, only the
administrator who locks a policy can unlock it.

#### Procedure

---

| **Step 1** | Choose Policies > Access Control. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) next to the access control policy you want to lock or unlock.  The Lock Status column shows whether a policy is already locked, and if so, who locked it. An empty cell indicates that the policy is not locked.  If View (View button) appears instead, the configuration belongs to an ancestor domain, or you do not have permission to modify the configuration. Or, it is locked by another user. |
| **Step 3** | Click the lock icon next to the policy name to lock or unlock the policy.  Lock icon.  If the policy inherits settings from a parent policy, you must choose one of the following options when you click the lock icon.   * Lock/Unlock This Policy—The locking or   unlocking is for this policy only. * Lock/Unlock This Policy and Parents in the   Hierarchy—This policy and all parent policies are   locked or unlocked. If a parent policy is already locked by another   administrator, you will see a message and you will not be able to   lock that parent policy. When unlocking policies, if you have the   Override Access Control Policy Lock permission, all parent policies   are unlocked even if they were locked by other users. |

---

### Managing Access Control Policy Inheritance

Inheritance relates to using another policy as a base policy for an access control
policy. This allows you to use one policy to define some baseline characteristics
that can be applied to multiple policies. To understand how inheritance works, see
[Access Control Policy Inheritance](access-overview.html#concept_F5F96D819A084248AFAACE3BE64F99D8).

#### Procedure

---

| **Step 1** | Edit the access control policy whose inheritance settings you want to change; see [Editing an Access Control Policy](#ID-2176-0000028c). |
| --- | --- |
| **Step 2** | (Legacy UI.) Manage policy inheritance:   * Change Base Policy — To change the base access control policy for this policy, click Inheritance Settings and proceed as described in [Choosing a Base Access Control Policy](#task_E56A1F1516764E1796F458FAD391511D). * Lock Settings in Descendants — To enforce this policy's settings in its descendant policies, click Inheritance Settings and proceed as described in [Locking Settings in Descendant Access Control Policies](#task_F42F7E3F0AB34A8C8D273F85F49046A8) . * Required in Domains — To enforce this policy in a subdomain, click Policy Assignment and proceed as described in [Requiring an Access Control Policy in a Domain](#task_19B6B3BAE0154F6196C95FB4AA97AC9B). * Inherit Settings from Base Policy — To inherit settings from a base access control policy, click Security Intelligence, HTTP Responses, or Advanced and proceed as directed in [Inheriting Access Control Policy Settings from the Base Policy](#task_F21A620007B64787A8FB6AA6F4953044). |
| **Step 3** | (New UI) Manage policy inheritance:   * Change Base Policy — To change the base access control policy for this policy, select Inheritance Settings from the More drop-down arrow at the end of the packet flow line and proceed as described in [Choosing a Base Access Control Policy](#task_E56A1F1516764E1796F458FAD391511D). * Lock Settings in Descendants — To enforce this policy's settings in its descendant policies, select Inheritance Settings from the More drop-down arrow at the end of the packet flow line and proceed as described in [Locking Settings in Descendant Access Control Policies](#task_F42F7E3F0AB34A8C8D273F85F49046A8) . * Required in Domains — To enforce this policy in a subdomain, click the Targeted: x devices link and proceed as described in [Requiring an Access Control Policy in a Domain](#task_19B6B3BAE0154F6196C95FB4AA97AC9B). * Inherit Settings from Base Policy — To inherit settings from a base access control policy, click Security Intelligence, or select HTTP Responses or Advanced Settings from the drop-down arrow at the end of the packet flow line, and proceed as directed in [Inheriting Access Control Policy Settings from the Base Policy](#task_F21A620007B64787A8FB6AA6F4953044). |

---

#### Choosing a Base Access Control Policy

You can use one
access control policy as the base (parent) for another. By default, a child
policy inherits its settings from its base policy, though you can change
unlocked settings.

When you change the
base policy for the current access control policy, the system updates the
current policy with any locked settings from the new base policy.

##### Procedure

---

| **Step 1** | In the access control policy editor, click Inheritance Settings (Legacy UI). In the New UI, select Inheritance Settings from the More drop-down arrow at the end of the packet flow line. |
| --- | --- |
| **Step 2** | Choose a policy from the Select Base Policy drop-down list. |
| **Step 3** | Click Save. |

---

##### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

#### Inheriting Access Control Policy Settings from the Base Policy

A new child policy
inherits many settings from its base policy. If these settings are unlocked in
the base policy, you can override them.

If you later
reinherit the settings from the base policy, the system displays the base
policy's settings and dims the controls. However, the system saves the
overrides you made, and restores them if you disable inheritance again.

##### Procedure

---

| **Step 1** | In the access control policy editor, click Security Intelligence, HTTP Responses, or Advanced (Legacy UI). In the New UI, click Security Intelligence, or select HTTP Responses or Advanced Settings from the More drop-down arrow at the end of the packet flow line |
| --- | --- |
| **Step 2** | Check the Inherit from base policy check box for each setting you want to inherit.  If the controls are dimmed, settings are inherited from an ancestor policy, or you do not have permission to modify the configuration. |
| **Step 3** | Click Save. |

---

##### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

#### Locking Settings in Descendant Access Control Policies

Lock a setting in
an access control policy to enforce the setting in all descendant policies.
Descendant policies can override unlocked settings.

When you lock
settings, the system saves overrides already made in descendant polices so that
the overrides can be restored if you unlock settings again.

##### Procedure

---

| **Step 1** | In the access control policy editor, click Inheritance Settings (Legacy UI). In the New UI, select Inheritance Settings from the More drop-down arrow at the end of the packet flow line. |
| --- | --- |
| **Step 2** | In the Child Policy Inheritance Settings area, check the settings you want to lock.  If the controls are dimmed, settings are inherited from an ancestor policy, or you do not have permission to modify the configuration. |
| **Step 3** | Click OK to save the inheritance settings. |
| **Step 4** | Click Save to save the access control policy. |

---

##### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

#### Requiring an Access Control Policy in a Domain

You can require that every device in a domain use the same base access control policy or one
of its descendant policies. This procedure is relevant in a multi-domain deployment
only.

##### Procedure

---

| **Step 1** | In the access control policy editor, click Policy Assignments (Legacy UI). In the New UI, click the Targeted: x devices link. |
| --- | --- |
| **Step 2** | Click Required on Domains. |
| **Step 3** | Build your domain list:   * Add — Select the domains   where you want to enforce the current access control policy, then click   Add or drag and drop into the list of selected   domains. * Delete — Click Delete (delete icon) next to a leaf domain, or right-click an ancestor domain and choose Delete Selected. * Search — Type a search string in the search field. Click Clear (clear icon) to clear the search. |
| **Step 4** | Click OK to save the domain enforcement settings. |
| **Step 5** | Click Save to save the access control policy. |

---

##### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

### Setting Target Devices for an Access Control Policy

An access control policy specifies the devices that use it. Each device can be targeted by only one access control policy.

#### Procedure

---

| **Step 1** | In the access control policy editor, click Policy Assignments (Legacy UI). In the New UI, click the Targeted: x devices link. |
| --- | --- |
| **Step 2** | On Targeted Devices, build your target list:   * Add — Select one or more Available Devices, then click Add to Policy or drag and drop into the list of Selected Devices. * Delete — Click Delete (delete icon) next to a single device, or select multiple devices, right-click, then choose Delete Selected. * Search — Type a search string in the search field. Click Clear (clear icon) to clear the search.   Under Impacted Devices, the system lists the devices whose assigned access control policies are children of the current policy. Any change to the current policy affects these devices. |
| **Step 3** | Click OK to save your targeted device settings. |
| **Step 4** | Click Save to save the access control policy. |

---

#### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

### Logging Settings for Access Control Policies

You can configure default syslog destinations and syslog alert for the
access control policy. The settings are applicable to the access control policy and
all the included SSL/TLS decryption, prefilter, and intrusion policies unless the
syslog destination settings are explicitly overridden with custom settings in
included rules and policies.

Logging for connections handled by the default action is initially disabled.

IPS and File and Malware Settings are effective only after you have selected an
option at the top of the page for sending syslog messages generally.

#### Default Syslog Settings

* Send using specific syslog alert—If you select this option, the events are sent based on the selected syslog alert as configured using the instructions in
  Creating a Syslog Alert Response in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config). You can select the syslog alert from the list or add one by specifying the name, logging host, port, facility, and severity.
  For more information, see Facilities and Severities for Intrusion Syslog Alerts in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config). This option is applicable to all devices.

  When using this option, the system sends syslog messages to the server using the Management interface. Ensure there is a route
  from the Management interface to the syslog server, or messages will not arrive at the server.
* Use the syslog settings configured in the
  Threat Defense Platform Settings policy deployed on the device—If you
  select this option and select the severity, connection or intrusion events
  are sent with the selected severity to syslog collectors configured in
  Platform Settings. Using this option, you can unify the syslog configuration
  by configuring it in Platform Settings and reusing the settings in access
  control policy. Severity selected in this section is applied to all
  connection and intrusion events. The default severity is ALERT.

  This option is applicable only to Secure
  Firewall Threat Defense devices 6.3 and later.

#### IPS Settings

* Send Syslog messages for IPS events—Send IPS events as
  syslog messages. The defaults set above are used unless you override
  them.
* Show/Hide Overrides—If you want to use the default
  syslog destination and severity, leaves these options empty. Otherwise, you
  can set a different syslog server destination for IPS events, and change the
  severity of the events.

#### File and Malware Settings

* Send Syslog messages for File and Malware events—Send
  file and malware events as syslog messages. The defaults set above are used
  unless you override them.
* Show/Hide Overrides—If you want to use the default
  syslog destination and severity, leaves these options empty. Otherwise, you
  can set a different syslog server destination for file and malware events,
  and change the severity of the events.

### Access Control Policy Advanced Settings

Advanced access control policy settings typically require little or no
modification. The default settings are appropriate for most deployments. Note that
many of the advanced preprocessing and performance options in access control
policies may be modified by rule updates as described in Update Intrusion Rules in the [Cisco Secure Firewall Management
Center Administration Guide](http://www.cisco.com/go/firepower-config)
.

If View (![View button](/c/dam/en/us/td/i/400001-500000/450001-460000/452001-453000/452013.jpg)) appears instead, settings are inherited from an ancestor
policy, or you do not have permission to modify the
settings.

| **Caution** | ---   See [Configurations that Restart the Snort Process When Deployed or Activated](get-started-deployment.html#reference_F11C552688424DEF85ED145FA97283B7) for a list of advanced setting modifications that restart the Snort process, temporarily interrupting traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](get-started-deployment.html#concept_uc1_gtq_ty) for more information.   --- |
| --- | --- |

#### Inheriting Settings from a Parent Policy

If the access control policy has a base policy, you can elect to inherit settings from the base policy. Select Inherit from base policy for each setting group where you want to use the parent policy's settings. If inheritance has been configured so that these
settings are locked, you cannot configure unique settings for the policy, these settings are read-only.

If you are allowed to configure unique settings for the policy, you must deselect Inherit from base policy to make your edits.

#### General Settings

| Option | Description |
| --- | --- |
| Maximum URL characters to store in connection events | To customize the number of characters you store for each URL requested by your users. See Limiting Logging of Long URLs in the [Cisco Secure Firewall Management Center Administration Guide](http://www.cisco.com/go/firepower-config) for more information.  To customize the length of time before you re-block a website after a user bypasses an initial block, see [Setting the User Bypass Timeout for a Blocked Website](access-url-filtering.html#ID-2189-000003b4). |
| **Allow an Interactive Block to bypass blocking for (seconds)** | See [Setting the User Bypass Timeout for a Blocked Website](access-url-filtering.html#ID-2189-000003b4). |
| Retry URL cache miss lookup | The first time the system encounters a URL that does not have a locally stored category and reputation, it looks up that URL in the cloud and adds the result to the local data store, for faster processing of that URL in the future.  This setting determines what the system does when it needs to look up a URL's category and reputation in the cloud.  By default, this setting is enabled: The system momentarily delays the traffic while it checks the cloud for the URL's reputation and category, and uses the cloud verdict to handle the traffic.  If you disable this setting: When the system encounters a URL that is not in its local cache, the traffic is immediately passed and handled according to the rules configured for Uncategorized and reputationless traffic.  In passive deployments, the system does not retry the lookup, as it cannot hold packets. |
| Enable Threat Intelligence Director | Disable this option to stop publishing TID data to your configured devices. |
| Enable reputation enforcement on DNS traffic | This option is enabled by default, for improved URL filtering performance and efficacy. For details and additional instructions, see [DNS Filtering: Identify URL Reputation and Category During DNS Lookup](access-url-filtering.html#Cisco_Concept.dita_405e2fba-4c20-4874-822d-fa1e7079f928) and subtopics. |
| Inspect traffic during policy apply | To inspect traffic when you deploy configuration changes unless specific configurations require restarting the Snort process, ensure that Inspect traffic during policy apply is set to its default value (enabled).  When this option is enabled, resource demands could result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Scenarios](get-started-deployment.html#concept_33516C5D6B574B6888B1A05F956ABDF9) for more information. |

#### Associated Policies

Use advanced settings to associate subpolicies (decryption, identity, prefilter) with access control; see [Associating Other Policies with Access Control](#id_17609).

#### TLS Server Identity Discovery

The latest version of the Transport Layer Security (TLS) protocol 1.3, defined by [RFC 8446](https://tools.ietf.org/html/rfc8446), is the preferred protocol for many web servers to provide secure communications. Because the TLS 1.3 protocol encrypts the
server's certificate for additional security, and the certificate is needed to match application and URL filtering criteria
in access control rules, the Firepower System provides a way to extract the server certificate *without* decrypting the entire packet.

You can enable this feature, referred to as *TLS server identity discovery*, when you configure advanced settings for an access control policy.

When a new connection starts that will be affected by TLS server identity discovery, the threat
defense holds the original ClientHello packet to determine the identity of the server to which it connects before continuing. The
threat
defense device sends a specialized connection from the threat
defense to the server. The server's response includes the server certificate, the specialized connection is terminated, and the original
connection is evaluated as required by the access control policy.

TLS server identity discovery prioritizes the certificate's Common Name (CN) over the [Server Name Indication (SNI)](https://www.cloudflare.com/learning/ssl/what-is-sni/).

To enable TLS server identity discovery, click the Advanced tab, click
Edit (![edit icon](/c/dam/en/us/td/i/400001-500000/440001-450000/442001-443000/442546.jpg)) for the setting, and select Early application detection and URL
categorization.

![](/c/dam/en/us/td/i/400001-500000/440001-450000/446001-447000/446386.jpg)

We strongly recommend enabling it for any traffic you want to match on application or URL criteria, especially if you want
to perform deep inspection of that traffic. An
SSL policy is not required because *traffic is not decrypted* in the process of extracting the server certificate.

| **Note** | ---  * Because the certificate is decrypted, TLS server identity discovery can reduce performance depending on the hardware platform. * TLS server identity discovery is not supported in inline tap mode or passive mode deployments. * Enabling TLS server identity discovery is not supported on any Secure Firewall   Threat Defense Virtual deployed to AWS. If you have any such managed devices managed by the Secure Firewall Management   Center, the connection event PROBE\_FLOW\_DROP\_BYPASS\_PROXY  increments every time the device attempts to extract the server certificate. * TLS Server Identity Discovery also operates on TLS 1.2 sessions.  --- |
| --- | --- |

#### Network Analysis and Intrusion Policies

Advanced network analysis and intrusion policy settings allow you to:

* Specify the intrusion policy and associated variable set that are used to inspect packets that must pass before the system
  can determine exactly how to inspect that traffic.
* Change the access control policy’s default network analysis policy, which governs many preprocessing options.
* Use custom network analysis rules and network analysis policies to tailor preprocessing options to specific security zones,
  networks, and VLANs.

For more information, see [Advanced Access Control Settings for Network Analysis and Intrusion Policies](advanced-nap-access-control.html#ID-2194-00000004).

#### Threat Defense Service Policy

You can use the Threat Defense Service Policy to apply services to specific traffic classes. For example, you can use a service
policy to create a timeout configuration that is specific to a particular TCP application, as opposed to one that applies
to all TCP applications. This policy applies to threat defense devices only, and will be ignored for any other device type. The service policy rules are applied after the access control
rules. For more information, see [Service Policies](access-service-policies.html#id_71048).

#### File and Malware Settings

[Tuning File and Malware Inspection Performance and Storage](network-malware-protection.html#ID-2177-00000581) provides information on performance options for file
control and malware defense.

#### Portscan Threat Detection

Portscan detector is a threat detection mechanism designed to help you detect and prevent portscan activity in all types of
traffic to protect networks from eventual attacks. Portscan traffic can be detected efficiently in both allowed and denied
traffic. For more information, see [Threat Detection](threat-detection.html#Cisco_Generic_Topic.dita_9ac12175-7d61-4685-9563-955ac05f238c).

#### Elephant Flow Settings

Elephant flows are large, long duration, and fast flows that can cause duress for
Snort cores. There are two actions that can be applied on elephant flows to reduce
system stress, CPU hogging, packet drops, and so on. These actions are:

* Bypass any or all applications—This action bypasses flow from Snort
  inspection.
* Throttle—This action applies dynamic rate limit policy (10% reduction) on
  elephant flows.

#### Intelligent Application Bypass Settings

Intelligent Application Bypass (IAB) is an expert-level configuration that specifies applications to bypass or test for bypass
if traffic exceeds a combination of inspection performance and flow thresholds. For more information, see [Intelligent Application Bypass](access-intelligent-app-bypass.html#topic_A90B7295DF2544B6B66856097C1ABF89).

#### Transport/Network Layer Preprocessor Settings

Advanced transport and network preprocessor settings apply globally to all networks, zones, and VLANs where you deploy your
access control policy. You configure these advanced settings in an access control policy rather than in a network analysis
policy. For more information, see [Advanced Transport/Network Preprocessor Settings](advanced-nap-transport-preprocessors.html#ID-2169-00000017).

#### Detection Enhancement Settings

Advanced detection enhancement settings allow you to configure adaptive profiles so you can:

* Use file policies and applications in access control rules.
* Use service metadata in intrusion rules.
* In passive deployments, improve reassembly of packet fragments and TCP streams based on your network’s host operating systems.

For more information, see [Adaptive Profiles](advanced-nap-adaptive-profiles.html#ID-2173-00000004).

#### Performance Settings and Latency-Based Performance Settings

[About Intrusion Prevention Performance Tuning](intrusion-performance.html#ID-2177-00000196) provides information on improving the performance of your system as it analyzes traffic for attempted intrusions.

For information specific to latency-based performance settings, see [Packet and Intrusion Rule Latency Threshold Configuration](intrusion-performance.html#ID-2177-000002e0).

#### Encrypted Visibility Engine

For details about this feature, see the Encrypted Visibility Engine chapter in the [Cisco Secure Firewall
Management Center Snort 3 Configuration
Guide](https://www.cisco.com/go/fmc-snort3).

* [Associating Other Policies with Access Control](#id_17609)

#### Associating Other Policies with Access Control

Use an access control policy's advanced settings to associate one of each of the following subpolicies with the access control
policy:

* Prefilter policy—Performs early traffic handling using limited network (layer 4) outer-header criteria.
* SSL policy—Monitors, decrypts, blocks, or allows application layer protocol traffic encrypted with Secure Socket Layer (SSL)
  or Transport Layer Security (TLS).

  | **Caution** | ---   *Snort 2 only*. Adding or removing an SSL policy restarts the Snort process when you deploy configuration changes, temporarily interrupting traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](get-started-deployment.html#concept_uc1_gtq_ty) for more information.   --- |
  | --- | --- |
* Identity policy—Performs user identification based on the realm and authentication method associated with the traffic.

##### Before you begin

Before associating an SSL policy with an access control policy, review the information about TLS server identity discovery
in [Access Control Policy Advanced Settings](#ID-2176-00000314).

##### Procedure

---

| **Step 1** | In the access control policy editor, click the Advanced tab (Legacy UI). In the New UI, select Advanced Settings from the More drop-down arrow at the end of the packet flow line. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) in the appropriate Policy Settings area.  If View (View button) appears instead, settings are inherited from an ancestor policy, or you do not have permission to modify the settings. If the configuration is unlocked, uncheck Inherit from base policy to enable editing. |
| **Step 3** | Choose a policy from the drop-down list.  If you choose a user-created policy, you can click edit that appears to edit the policy. |
| **Step 4** | Click OK. |
| **Step 5** | Click Save to save the access control policy. |

---

##### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

### Viewing Rule Hit Counts

Hit count indicates the number of times a policy rule or default action has been matched to a connection. The hit count is
incremented only for the first packet of a connection that matches a rule. You can use this information to identify the efficacy
of your rules. Hit count information is available only for access control and prefilter rules applied to threat
defense devices.

| **Note** | ---  * The count persists through reboots and upgrades. * Counts are maintained by each unit in an HA pair or cluster   separately. * You will not be able to derive the hit count information from a device when deployment or a task is in progress on the device. * You can also see rule hit count information in the device CLI using the show rule hits  command. * If you have accessed the Hit Count page from the Access Control Policy page, you will not be able to view or edit prefilter   rules and vice-versa. * Hit counts are not available for rules that use the Monitor action.  --- |
| --- | --- |

#### Before you begin

If you use custom user roles, ensure that the roles include the following privileges:

* View Device, to see the hit counts.
* Modify Device, to refresh the hit counts.

#### Procedure

---

| **Step 1** | In the access control policy or prefilter policy editor , click Analyze Hit Counts on the top-right of the page. |
| --- | --- |
| **Step 2** | On the Hit Count page, select the device from the Select a device drop-down list.  If it is not the first time that you are generating hit counts for this device, the last fetched hit count information appears next to the drop-down box. Also, verify the Last Deployed time to confirm recent policy changes. |
| **Step 3** | Click Fetch Current Hit Count to get the hit count data, or Refresh if you had already gotten hit count data and you want fresh numbers. |
| **Step 4** | View and analyze the data.  You can do the following:   * Click Prefilter or AC Policy to switch between the hit counts for these policies. * Search for a specific rule by entering a search string in Filter box. * Broadly limit the list to Hit Rules or Never Hit Rules by selecting these options in the Filter by field. When viewing hit rules, you can further limit the list by selecting a time range in the In Last field (for example, in the last 1 day). * Change the displayed columns by clicking Cog (cog icon) and selecting the columns to show. * Click on a rule name to edit it, or click View (View button) in the last column to view the rule details. Clicking on the rule name highlights it in the policy page where you can edit   it. * Clear the hit count information (reset it to zero) for a rule by right-clicking the rule and selecting Clear Hit Count. You can select multiple rules by using Ctrl+click. You cannot undo this action. * Generate a comma-separated values report of the details on the page   by clicking Generate CSV on the bottom-left   of the page. |
| **Step 5** | Click Close to return to the policy page. |

---

## History for Access Control Policies

| Feature | Minimum Management Center | Minimum Threat Defense | Details |
| --- | --- | --- | --- |
| Access control policy locking. | 7.2 | Any | You can lock an access control policy to prevent other administrators from editing it. Locking the policy ensures that your changes will not be invalidated if another administrator edits the policy and saves changes before you save your changes. Any user who has permission to modify the access control policy has permission to lock it.  We added an icon to lock or unlock a policy next to the policy name while editing the policy. In addition, there is a new permission to allow users to unlock policies locked by other administrators: Override Access Control Policy Lock. This permission is enabled by default in the Administrator, Access Admin, and Network Admin roles. |
| Rule hit counts persist over reboot. | 7.2 | Any | Rebooting a managed device no longer resets access control rule hit counts to zero. Hit counts are reset only if you actively clear the counters. In addition, counts are maintained by each unit in an HA pair or cluster separately. You can use the show rule hits  command to see cumulative counters across the HA pair or cluster, or see the counts per node.  We modified the following device CLI command: show rule hits . |
| Usability improvements for the access control policy. | 7.2 | Any | There is a new user interface available for the access control policy. You can continue to use the legacy user interface, or you can try out the new user interface. The new interface has both a table and a grid view for the rules list, the ability to show or hide columns, enhanced search, infinite scroll, a clearer view of the packet flow related to policies associated with the access control policy, and a simplified add/edit dialog box for creating rules. You can freely switch back and forth between the legacy and new user interfaces while editing an access control policy. |
| DNS filtering | 7.0  6.7 (experimental) | Any | If URL filtering is enabled and configured, a new option to enhance category and reputation filtering efficacy is enabled by default for each new access control policy.  For more information, see [DNS Filtering: Identify URL Reputation and Category During DNS Lookup](access-url-filtering.html#Cisco_Concept.dita_405e2fba-4c20-4874-822d-fa1e7079f928) and subtopics. The Advanced tab of access control policy has a new option under General Settings: Enable reputation enforcement on DNS traffic. |
| TLS server identity discovery | 6.7 | Any | Enable access control policies to evaluate URL and application conditions when a client connects to a TLS 1.3-enabled server. TLS server identity discovery enables these conditions to be evaluated without decrypting traffic.  Enabling this feature can impact device performance, depending on model.  The Advanced tab page of access control policy has new options:   * Warning is displayed on the Advanced tab; moving the slider to the right enables TLS server identity discovery. * New option on the Advanced tab page: TLS Server Identity Discovery. |
| New Security Intelligence categories | — | Any | The following categories were introduced at about the time of the 6.6 release, but are not specific to 6.6:   * banking\_fraud * high\_risk * ioc * link\_sharing * malicious * newly\_seen * spyware |

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_cf985588_20250115_120529.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

#### Cisco Security

# Cisco Security Advisories

 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
 ![](https://sec.cloudapps.cisco.com/security/center/Resources/images/loader.gif)
- Vulnerabilities
- Filter By Product

 Quick Search

 [*Advanced Search*](/security/center/Search.x)

| Advisory | Impact | CVE | Last Updated | Version |
| --- | --- | --- | --- | --- |
|  | {{SeverityDrpDwnValue}}   All   Critical   High   Medium   Low   Informational  Done |  | Most Recent 2025 Jan 2024 Dec 2024 Nov 2024 Oct 2024 Sep 2024 Aug 2024 Jul 2024 Jun 2024 May 2024 Apr 2024 Mar 2024 Feb |  |
|
 | [{{list.title}}](%7B%7Blist.url%7D%7D) | {{list.severity}}-- | ...  {{list.cve}} | {{list.lastPublished | date :'yyyy MMM dd' : 'UTC'}} | {{list.version}} {{list.version+'.0'}} | | --- | --- | --- | --- | --- | | CVE:      ...  {{list.cve}}       Publication ID:{{ list.identifier }}  Version: {{list.version}} {{list.version+'.0'}}  First Published:{{ list.firstPublished | date :'yyyy MMM dd HH:mm' : 'UTC'}} GMT   Workaround:{{ list.workarounds }}  Affects Cisco Products:{{ list.affectedCiscoProducts }}No   Summary: | | | | | | | | | |
| {{message}} | | | | |
| Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }} | | | | |
| --- | --- | --- | --- | --- |
| Items per page:   Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }}   |  < Prev  {{opt}}   Next > | | | | |

### Select at least one checkbox to view vulnerabilities that affect Cisco products

 Remove All

 [*Advanced Search*](/security/center/Search.x)
Add a Product

 [*Advanced Search*](/security/center/Search.x)

| Advisory | Impact | CVE | Last Updated | Version |
| --- | --- | --- | --- | --- |
|  | {{prdFltrSvrDrpDwnValue}}   All   Critical   High   Medium   Low   Informational  Done |  | Most Recent 2025 Jan 2024 Dec 2024 Nov 2024 Oct 2024 Sep 2024 Aug 2024 Jul 2024 Jun 2024 May 2024 Apr 2024 Mar 2024 Feb |  |
| | [{{list.title}}](%7B%7Blist.url%7D%7D) | {{list.severity}}-- | ...  {{list.cve}} | {{list.lastPublished | date :'yyyy MMM dd' : 'UTC' }} | {{list.version}} {{list.version+'.0'}} | | --- | --- | --- | --- | --- | | CVE:      ...  {{list.cve}}       Publication ID:{{ list.identifier }}  Version: {{list.version}} {{list.version+'.0'}}  First Published:{{ list.firstPublished | date :'yyyy MMM dd HH:mm' : 'UTC' }} GMT   Workaround:{{ list.workarounds }}  Affects Cisco Products:{{ list.affectedCiscoProducts }}No   Summary: | | | | | | | | | |
| {{message}} | | | | |
| Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }} | | | | |
| --- | --- | --- | --- | --- |
| Items per page:   Showing {{parseInt(offset) + 1}} - {{ ( parseInt(limit) + parseInt(offset) ) < total ? ( parseInt(limit) + parseInt(offset) ) : total }} of {{ parseInt(total) }}   |  < Prev  {{opt}}   Next > | | | | |

### Add a product to see all related advisories

##### Do you really want to delete all products?

 OK
 Cancel

To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy.](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html) This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.

Cisco Security Advisories and other Cisco security content are provided on an "as is" basis and do not imply any kind of guarantee or warranty. Your use of the information in these publications or linked material is at your own risk. Cisco reserves the right to change or update this content without notice at any time.

![](https://sec.cloudapps.cisco.com/security/center/Resources/images/on.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/off.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/trash-can.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/trash-can-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/searchtag-icon-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/searchtag-clear-icon-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-dark-down.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-dark-up.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/caret-hover.png)
![](https://sec.cloudapps.cisco.com/security/center/Resources/images/delete-icon.png)

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)



=== Content from sec.cloudapps.cisco.com_d63d44b7_20250115_181748.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 3.1 |
| Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Attack Vector AV: Local AV: Adjacent AV: Network AV: Physical  Select Attack Vector Parameters  Attack Complexity AC: Low AC: High  Select Attack Complexity Parameters  Privileges Required PR: None PR: Low PR: High  Select Privileges Required Parameters  User Interaction UI: Required UI: None  Select User Interaction Parameters  Scope S: Unchanged S: Changed  Select Scope Parameters  Confidentiality Impact C: Low C: High C: None  Select Confidentiality Impact Parameters  Integrity Impact I: None I: Low I: High  Select Integrity Impact Parameters  Availability Impact A: Low A: High A: None  Select Availability Impact Parameters    Base Score: 4.0 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploit Code Maturity E: Functional  E: High  E: Not Defined  E: Proof-of-Concept  E: Unproven   Select Exploit Code Maturity Parameters  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   Select Remediation Level Parameters  Report Confidence RC: Unknown  RC: Reasonable  RC: Not Defined  RC: Confirmed   Select Report Confidence Parameters     Temporal Score: 4.0 |
| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Confidentiality Requirement CR: Low  CR: Medium  CR: High  CR: Not Defined   Select Confidentiality Requirement Parameters  Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Select Integrity Requirement Parameters  Availability Requirement AR: Low  AR: Medium  AR: High  AR: Not Defined   Select Availability Requirement Parameters  Modified Attack Vector MAV: Local  MAV: Adjacent  MAV: Network  MAV: Physical  MAV: Not Defined   Select Modified Attack Vector Parameters  Modified Attack Complexity MAC: Low  MAC: High  MAC: Not Defined   Select Modified Attack Complexity Parameters  Modified Privileges Required MPR: None  MPR: Low  MPR: High  MPR: Not Defined   Select Modified Privileges Required Parameters  Modified User Interaction MUI: Required  MUI: None  MUI: Not Defined   Select Modified User Interaction Parameters  Modified Scope MS: Unchanged  MS: Changed  MS: Not Defined   Select Modified Scope Parameters  Modified Confidentiality MC: None  MC: Low  MC: High  MC: Not Defined   Select Modified Confidentiality Parameters  Modified Integrity MI: None  MI: Low  MI: High  MI: Not Defined   Select Modified Integrity Parameters  Modified Availability MA: None  MA: Low  MA: High  MA: Not Defined   Select Modified Availability Parameters    Environmental Score: 4.0 |
| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from sec.cloudapps.cisco.com_181e036a_20250115_181749.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco Firepower Threat Defense Software SSL and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability Medium   Advisory ID:  cisco-sa-ftd-snort3-8U4HHxH8  First Published: 2023 November 1 16:00 GMT  Version 1.0:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [Yes](#workarounds)   Cisco Bug IDs: [CSCwc07015](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc07015)     CVE-2023-20031     CWE-244       CVSS Score: [Base 4.0](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N/E:X/RL:X/RC:X       CVE-2023-20031     CWE-244       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-8U4HHxH8/csaf/cisco-sa-ftd-snort3-8U4HHxH8.json)   Email      Summary  * A vulnerability in the SSL/TLS certificate handling of Snort 3 Detection Engine integration with Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to cause the Snort 3 detection engine to restart.  This vulnerability is due to a logic error that occurs when an SSL/TLS certificate that is under load is accessed when it is initiating an SSL connection. Under specific, time-based constraints, an attacker could exploit this vulnerability by sending a high rate of SSL/TLS connection requests to be inspected by the Snort 3 detection engine on an affected device. A successful exploit could allow the attacker to cause the Snort 3 detection engine to reload, resulting in either a bypass or a denial of service (DoS) condition, depending on device configuration. See the [Details](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr#details) section of this advisory for more information. The Snort detection engine will restart automatically. No manual intervention is required.  Cisco has released software updates that address this vulnerability. There are workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-8U4HHxH8>  This advisory is part of the November 2023 release of the Cisco ASA, FTD, and FMC Security Advisory Bundled publication. For a complete list of the advisories and links to them, see [Cisco Event Response: November 2023 Semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985).  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected Cisco FTD Software if it was running a vulnerable release and met all of the following conditions:    + The device was running Snort 3.   + At least one of the following conditions was true:     - TLS server identity discovery was enabled.     - An SSL policy was configured. For information about which Cisco software releases are vulnerable, see the [Fixed Software](#fs) section of this advisory. Determine Cisco FTD Software Snort Configuration To determine if Snort 3 is running on Cisco FTD Software, see [Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD)](https://www.cisco.com/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html). Snort 3 has to be active for this vulnerability to be exploited. Determine Cisco FTD Software TLS Server Identity Discovery Configuration TLS server identity discovery is disabled by default.  **Determine Cisco FTD Software TLS Server Identity Discovery Configuration Using the FTD Software CLI**  To determine whether TLS server identity discovery is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the **show access-control-config** command. Scroll down to the **Advanced Settings** section. If the command output shows **TLS Server Identity Discovery Enabled**, the device is affected by this vulnerability, as shown in the following example:  ```   > show  access-control-config   ===============[ Advanced Settings ]================   General Settings     Maximum URL Length                  : 1024     Interactive Block Bypass Timeout    : 600     SSL Policy                          : Certificate-Visibility-SSL-Policy     TLS Server Identity Discovery       : Enabled      ```  The following example shows that TLS server identity discovery is disabled:  ```   >show access-control-config   ===============[ Advanced Settings ]================   General Settings     Maximum URL Length                  : 1024     Interactive Block Bypass Timeout    : 600     TLS Server Identity Discovery       : Disabled      ```  **Note**: Due to [CSCvz06256](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz06256), this command will not show the TLS server identity discovery setting for the Cisco FTD 7.0 software train.  **Determine Cisco FTD Software TLS Server Identity Discovery Configuration for Devices Managed by Cisco Firepower Device Manager Software**  To determine whether TLS server identity discovery is configured on a device that is managed by Cisco Firepower Device Manager (FDM) Software, complete the following steps:    1. Log in to the Cisco FDM web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Click on the **Settings** gear icon.   4. Locate the **TLS Server Identity Discovery** setting.      + If the setting is enabled, the device is affected by this vulnerability.      + If the setting is disabled, the device might not be affected by this vulnerability. For detailed information about TLS server identity discovery, see the [Access Control](https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html) chapter of the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager*.  **Determine Cisco FTD Software TLS Server Identity Discovery Configuration for Devices Managed by Cisco Firepower Management Center Software**  To determine whether TLS server identity discovery is configured on a device that is managed by Cisco Firepower Management Center (FMC) Software, complete the following steps:    1. Log in to the Cisco FMC web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Choose the appropriate Access Control Policy.   4. Click the **Edit** pencil icon.   5. Click on the **Advanced** tab.   6. Locate the **TLS Server Identity Discovery** setting.      + If the setting is enabled, the device is affected by this vulnerability.      + If the setting is disabled, the device might not be affected by this vulnerability. For detailed information about TLS server identity discovery, see the [Access Control Policy](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html?bookSearch=true#ID-2176-00000314) chapter of the *Cisco Secure Firewall Management Center Device Configuration Guide*.  **Determine Cisco FTD Software TLS Server Identity Discovery Configuration for Cisco Defense Orchestrator Devices**  To determine whether TLS server identity discovery is configured on a device that is managed by Cisco Defense Orchestrator Software, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the Cisco Defense Orchestrator **Policies** menu, choose **FTD Policies**.   3. From the FTD **Policies** menu, choose **Access Control**.   4. Choose the appropriate Access Control Policy.   5. Click the **Edit** pencil icon.   6. Choose **More** and then Click on then **Advanced Settings**.   7. Locate the **TLS Server Identity Discovery** setting.      + If the setting is enabled, the device is affected by this vulnerability.      + If the setting is disabled, the device might not be affected by this vulnerability. For detailed information about TLS server identity discovery, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html) Determine Cisco FTD Software SSL Policy Configuration SSL decryption policies are not configured by default.  **Determine Cisco FTD Software SSL Policy Configuration Using the FTD Software CLI**  To determine whether an SSL policy is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the **show ssl-policy-config** command. If the command output shows a policy, the device has an SSL policy applied and is affected by this vulnerability, as shown in the following example:  ```   > show ssl-policy-config===================[ CSCwc07015 ]====================================[ Default Action ]=================Default Action            : Do Not Decrypt...   ```  In the following example, no SSL policy is applied:  ```   >show ssl-policy-configSSL policy not yet applied   ```  ```       ```  **Determine Cisco FTD Software SSL Policy Configuration for Devices Managed by Cisco FDM**  To determine whether an SSL policy is configured on a device that is managed by Cisco FDM Software, complete the following steps:    1. Log in to the Cisco FTD web interface.   2. From the main menu, choose **Policies**.   3. Choose the **SSL Decryption** tab.   + If a **Policy Name** is listed, the device is affected by this vulnerability.   + If SSL decryption is not enabled, the device might not affected by this vulnerability. For detailed information about SSL decryption policies, see the [SSL Decryption](https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.html) chapter of the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager*.  **Determine Cisco FTD Software SSL Policy Configuration for Devices Managed by Cisco FMC Software**  To determine whether an SSL policy is configured on a device that is managed by Cisco FMC Software, complete the following steps:    1. Log in to the Cisco FMC web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Choose the appropriate Access Control Policy.   4. Click the **Edit** pencil icon.   5. Look in the **SSL Policy** area.      + If a **Policy Name** is listed, the device is affected by this vulnerability.      + If **None** is listed, the device might not affected by this vulnerability. For detailed information about SSL decryption policies, see the [SSL Policy](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html) chapter of the *Cisco Secure Firewall Management Center Device Configuration Guide*.  **Determine Cisco FTD Software SSL Policy Configuration for Devices Managed by Cisco Defense Orchestrator**  To determine whether an SSL policy is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the Cisco Defense Orchestrator **Policies** menu, choose the **FTD Policies.**   3. From the FTD **Policies** menu, choose **Access Control**.   4. Choose the appropriate Access Control Policy.   5. Click the **Edit** pencil icon.   6. Look in the **Decryption Policy** area.   + If a **Policy Name** is listed, the device is affected by this vulnerability.   + If **None** is listed, the device is not affected by this vulnerability. For detailed information about devices managed by Cisco Defense Orchestrator, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html) Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Cisco has confirmed that this vulnerability does not affect the following products:    + Cisco Adaptive Security Appliance (ASA) Software   + Cisco FMC Software   + Open Source Snort 2   + Open Source Snort 3  Details  * The following Cisco FTD Software Snort 3 configuration parameters govern how traffic is handled if the Snort 3 process restarts, which could change how encrypted traffic is handled during an exploit of this vulnerability.    + Snort Fail Open   + Snort preserve-connection For additional information, see the Snort Restart Traffic Behavior section of the [Firepower Management Center Configuration Guide](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html#concept_uc1_gtq_ty) or the [Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Defense Orchestrator](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m_get-started-deployment.html?bookSearch=true#concept_uc1_gtq_ty) guide.  Workarounds  * There is a workaround and mitigations that address this vulnerability. To remove the attack vector for this vulnerability, either revert to Snort 2, or, if remaining on Snort 3, disable both TLS server identity discovery and any configured decryption policy. If either is enabled, the device is still vulnerable.  **Note:** For TLS server identity discovery to be enabled, a decryption policy does not need to be configured and associated with the access control policy. Reverting to Snort 2 Before reverting to Snort 2, review the *Before you Begin* section in the [Switching Between Snort 2 and Snort 3](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id_120089) section in the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager*.  **Note:** Downgrading to Snort 2 will delete customer policies, NAP customizations, and Hostname redirect in active authentications. To discuss the effects of reverting on your deployment, contact the [Technical Assistance Center (TAC)](https://www.cisco.com/go/tac/).  **Reverting to Snort 2 for Cisco FTD Devices by Using the CLI**  There is no option to revert to snort 2 by using the CLI.  **Reverting to Snort 2 for Cisco FTD Devices that Are Managed by FDM Software**  To revert to Snort 2 on a device that is managed by Cisco FDM Software, complete the following steps:    1. Log in to the Cisco FTD Software web interface.   2. From the main menu, choose **Device**.   3. In the **Updates** area, choose **View Configuration**.   4. In the **Intrusion Rule** section, choose **Downgrade to 2.0.** After making the changes above, deploy changes to your FTD devices.  For detailed information about reverting to Snort 2, see the [Switching Between Snort 2 and Snort 3](https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id_120089) section in the *Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager*.  **Reverting to Snort 2 for Cisco FTD Devices that Are Managed by FMC Software**  To revert to Snort 2 on a device that is managed by Cisco FMC Software, complete the following steps:    1. Log in to the Cisco FMC Software web interface.   2. From the **Devices** menu, choose **Device Management**.   3. Choose the appropriate Cisco FTD device.   4. Click the **Edit** pencil icon.   5. Choose the **Device** tab.   6. In the **Inspection Engine** area, choose **Revert to Snort 2**. After making the changes above, deploy changes to your FTD devices.  For detailed information about reverting to Snort 2, see the [Snort 3 Inspection Engine](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable) chapter of the *Cisco Secure Firewall Management Center Snort 3 Configuration Guide.*  **Reverting to Snort 2 for Cisco FTD devices that Are Managed by Cisco Defense Orchestrator**  To revert to Snort 2 on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. In the navigation bar, click **Inventory.**   3. Click the **Devices** tab.   4. Click the **FTD** tab and click the device you want to revert.   5. In the **Device Actions** pane located to the right, click **Upgrade**.   6. Set the upgrade toggle to **Intrusion Prevention Engine.**   7. Click **Revert to Snort Engine 2.0.** After making the changes above, deploy changes to your FTD devices.  For detailed information about devices managed by Cisco Defense Orchestrator, see the [Cisco Defense Orchestrator documentation.](https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html)  For detailed information about reverting to Snort 2 for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the [Snort 3 Inspection Engine](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept_D87B73A83ACA42CCA656F0041F9D860B-enabledisable) chapter of the *Cisco Secure Firewall Management Center Snort 3 Configuration Guide.*  For detailed information about reverting to Snort 2 for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the [Revert From Snort 3.0 for FDM-Managed Device](https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert_From_Snort_3_for_FTD) section of *Managing FDM Devices with Cisco Defense Orchestrator*. Mitigation for Devices that Are Managed by Cisco FDM Software For Cisco FTD devices that stay on Snort 3, both the TLS server identity discovery and SSL policy must be disabled to implement the workaround. Disabling only one item will leave the device vulnerable.  To disable the TLS server identity discovery for devices managed by Cisco FDM Software, do the following:    1. Log in to the Cisco FDM web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Click on the **Settings** gear icon.   4. If the **TLS Server Identity Discovery** setting is enabled, disable it and click **OK**. To disable the SSL Policy for devices managed by Cisco FDM Software, do the following:    1. Log in to the Cisco FDM web interface.   2. From the **Policies** menu, choose **SSL Decryption.**   3. If a policy name is present, disable SSL Decryption. After changing the policies above, deploy the new policies to your Cisco FTD devices.  For more information, see the [Access Control Chapter](https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html) of the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager. Mitigation for Devices that Are Managed by Cisco FMC Software Both the TLS server identity discovery and SSL policy must be disabled to implement the workaround. Disabling only one item will leave the device vulnerable.  To navigate to the correct configuration page to disable the policies for devices that are managed by Cisco FMC Software, do the following:    1. Log in to the Cisco FMC web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Choose the appropriate Access Control Policy.   4. Click the **Edit** pencil icon.   5. Click on the **Advanced** tab. To disable the TLS server identity discovery for devices that are managed by Cisco FMC Software, do the following:    1. Locate the **TLS Server Identity Discovery** setting.   2. If the setting is enabled, click the **Edit** pencil icon.   3. Uncheck the **Early application detection and URL categorization** box and choose **OK**.   4. Click **Save** to save the policy. To disable the SSL Policy for devices that are managed by Cisco FMC Software, do the following:    1. Locate the **SSL Policy Settings**.   2. If a policy name is present, click the **Edit** pencil icon.   3. In the Drop-down menu, choose **None** and then **OK**   4. Click **Save** to save the policy. After changing the policies above, deploy the new policies to your Cisco FTD devices.  For more information, see the [Access Control Chapter](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.html) of the Firepower Management Center Device Configuration Guide. Mitigation for Devices that Are Managed by Cisco Defense Orchestrator Both the TLS server identity discovery and SSL policy must be disabled to implement the workaround. Disabling only one item will leave the device vulnerable.  To navigate to the correct configuration page to disable the policies for devices that are managed by Cisco Defense Orchestrator Software, do the following:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the **CDO Policies** menu, choose **FTD Policies**.   3. From the **FTD Policies** menu, choose **Access Control**.   4. Choose the appropriate Access Control Policy.   5. Click the **Edit** pencil icon.   6. Choose **More** and then Click on then **Advanced Settings** To disable the TLS server identity discovery for devices that are managed by Cisco Defense Orchestrator software, do the following:    1. Locate the **TLS Server Identity Discovery** setting.   2. If the setting is enabled, click the **Edit** pencil icon.   3. Uncheck the **Early application detection and URL categorization** box and choose **OK**.   4. Click **Save** to save the policy To disable the SSL Policy for devices that are managed by Cisco Defense Orchestrator software, do the following:    1. Locate the **Decryption Policy Settings**.   2. If a policy name is present, click the **Edit** pencil icon   3. In the Drop-down menu, choose **None** and then **OK**.   4. Click **Save** to save the policy After changing the policies above, deploy the new policies to your Cisco Defense Orchestrator devices.  For more information, see the [Cisco Defense Orchestrator documentation](https://docs.defenseorchestrator.com/).  While these workarounds and mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Fixed ReleasesCisco ASA, FMC, and FTD Software To help customers determine their exposure to vulnerabilities in Cisco ASA, FMC, and FTD Software, Cisco provides the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x). This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities that are described in all the advisories that the Software Checker identifies (“Combined First Fixed”).  To use the tool, go to the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x) page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:    1. Choose which advisories the tool will search-all advisories, only advisories with a Critical or High [Security Impact Rating (SIR)](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#asr), or only this advisory.   2. Choose the appropriate software.   3. Choose the appropriate platform.   4. Enter a release number-for example, **9.16.2.11** for Cisco ASA Software or **6.6.7** for Cisco FTD Software.   5. Click **Check**.  Only this advisoryAll Critical and High advisoriesAll advisoriesCisco ASA SoftwareCisco FMC SoftwareCisco FTD SoftwareAny Platform3000 Series Industrial Security Appliances (ISA)ASA 5500-X Series FirewallsASA Service ModuleAdaptive Security Virtual Appliance (ASAv)Firepower 1000 SeriesFirepower 2100 SeriesFirepower 4100 SeriesFirepower 9000 SeriesFirepower NGFW VirtualSecure Firewall 3100 SeriesFirepower Management Center Appliances     For instructions on upgrading your FTD device, see [Cisco Firepower Management Center Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting_started.html). Additional Resources For help determining the best Cisco ASA, FTD, or FMC Software release, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.  [Cisco ASA Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html)[Cisco Secure Firewall ASA Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html)[Cisco Secure Firewall Threat Defense Compatibility Guide](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html)  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.  Source  * This vulnerability was found during the resolution of a Cisco TAC support case.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory  * [Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985)  URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-8U4HHxH8>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.0 | Initial public release. | - | Final | 2023-NOV-01 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory  * [Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985) |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_6bc878d7_20250115_120519.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from www.cisco.com_f89278e3_20250115_120501.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Configuration Guides](/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)
# Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version 7.1

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting
  Started](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-get-started.html)
* [Best Practices: Use Cases for FTD](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-use-cases.html)
* [Licensing the
  System](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-license.html)
* System Monitoring
  + [Monitoring the
    Device](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-monitor.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-isa3000-alarms.html)
* Reusable Objects
  + [Objects](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-objects.html)
  + [Certificates](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-certificates.html)
  + [Identity Sources](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-identity-sources.html)
* The Basics
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-logical-devices.html)
  + [High Availability
    (Failover)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ha.html)
  + [Interfaces](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-interfaces.html)
* Routing
  + [Routing Basics and Static Routes](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-routing.html)
  + [Virtual Routers](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-virtual-routers.html)
  + [Route Maps and Other Objects for Route Tuning](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-route-maps.html)
  + [Open Shortest Path First (OSPF)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ospf.html)
  + [Enhanced Interior Gateway Routing Protocol (EIGRP)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-eigrp.html)
  + [Border Gateway Protocol (BGP)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-bgp.html)
* Security
  Policies
  + [SSL
    Decryption](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.html)
  + [Identity
    Policies](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-identity.html)
  + [Security
    Intelligence](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-sec-intel.html)
  + [Access
    Control](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html)
  + [Intrusion
    Policies](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-intrusion.html)
  + [Network Address
    Translation (NAT)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-nat.html)
* Virtual Private
  Networks (VPN)
  + [Site-to-Site
    VPN](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-s2svpn.html)
  + [Remote Access
    VPN](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ravpn.html)
* System
  Administration
  + [System
    Settings](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-system.html)
  + [System
    Management](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-mgmt.html)
* [Advanced
  Configuration](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-advanced.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html) to Save Content

Available Languages

Download

Download Options

### Book Title Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version 7.1 Chapter Title Access Control

* [PDF - Complete Book
  (18.48 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710.pdf)
  [PDF - This Chapter (1.56 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (10.71 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (22.68 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 14, 2023

## Chapter: Access Control

Chapter Contents

* [Access Control](#topic_96A0CC92335B4F2CB60FAB309DF8EB64)
* [Best Practices for Access Control](#Cisco_Task_in_List_GUI.dita_580ffb68-71da-4bb9-a43e-72556ae9a818)
* [Access Control Overview](#concept_A2A9F13454874EE29D126502410853C9)
  + [Access Control Rules and the Default Action](#concept_621711DB8AFF4CD09EDE891B63B30673)
  + [Application Filtering](#concept_D9B6E873A8D74A3A959BCBA36C29451F)
    - [Application Control for Encrypted and Decrypted Traffic](#concept_28D9D3ECCAC8424ABF27B39DC3A92311)
    - [Filtering on Common Industrial Protocol (CIP) and Modbus Applications (ISA 3000)](#id_110363)
    - [Best Practices for Application Filtering](#concept_02DF0685418F419EA1CADA6693872521)
  + [URL Filtering](#concept_3FD55F41D0084FDB8E58869B8FFF65C9)
    - [Filtering URLs by Category and Reputation](#concept_2190C5512921483CB9009A9FF5E3AE74)
    - [Looking Up the Category and Reputation for a URL](#id_75010)
    - [Manual URL Filtering](#concept_BA45929BE1D543DAA1738FE58F5E4C0C)
    - [Filtering HTTPS Traffic](#concept_3DF15D5D32444D5DA55001A3D2BF4816)
    - [Comparing URL and Application Filtering](#concept_9B9F5E79222E41DB9ED37367A499BE6E)
    - [Best Practices for Effective URL Filtering](#concept_F6A0AA79F3F54EE7BBFA3646D00596A7)
    - [What the User Sees When You Block Web Sites](#id_40051)
  + [DNS Request Filtering](#Cisco_Concept.dita_8ecc19cf-1d41-4741-82cd-1bf5661deb22)
    - [Guidelines for DNS Request Filtering](#Cisco_Concept.dita_878ba506-40a2-456d-b855-c703c8cae058)
    - [Filtering DNS Requests Based on URL Category and Reputation](#Cisco_Task_in_List_GUI.dita_144597f9-f18a-47d8-a82e-35a4b93043d5)
  + [Intrusion, File, and Malware Inspection](#concept_A1DB99832FED44F0AAC7181CD11FECBD)
  + [Best Practices for Access Control Rule Order](#concept_F36CB276D40F4D9ABBBDB8E771DC32D4)
  + [NAT and Access Rules](#ID-2124-00000055)
  + [How Other Security Policies Impact Access Control](#concept_903B1EBDCA764E799E26B92F0CF8D608)
* [License Requirements for Access Control](#concept_EBC1B6EF994F4C78AF63C5EB39A248EF)
* [Guidelines and Limitations for Access Control Policies](#concept_AA0463A9912F4868B33694E7C0C5648A)
* [Configuring the Access Control Policy](#id_11408)
  + [Configuring the Default Action](#id_11412)
  + [Configuring Access Control Policy Settings](#Cisco_Task_in_List_GUI.dita_179d5e33-2993-4e74-bffe-b87d45bd8142)
  + [Configuring Access Control Rules](#task_68A29B520CFF46608A8E88D8DFE7AEC0)
    - [Source/Destination Criteria](#concept_BA8B7882112F45E09AD00B341C64B871)
    - [Application Criteria](#concept_1F51EAD7EE7D4107BCF4547CD8D0653B)
    - [URL Criteria](#concept_885AAC35D2A54D34A1A3B602121818E0)
    - [User Criteria](#id_12066)
    - [Intrusion Policy Settings](#concept_990E998E30CF44F2BBE8D32F6D242E00)
    - [File Policy Settings](#concept_AD893273F89D45FFA5846A9541E3084D)
    - [Logging Settings](#id_10392)

- [Monitoring Access Control Policies](#concept_5E21BDA8E18D469D8984F33F849886B6)
  * [Monitoring Access Control Statistics in the Dashboards](#id_92397)
  * [Examining Rule Hit Counts](#id_92394)
  * [Monitoring Syslog Messages for Access Control](#id_92396)
  * [Monitoring Access Control Policies in the CLI](#id_92395)
- [Examples for Access Control](#concept_3F8CFF15DAB142E4AAA8809C3D2CC4B8)
  * [How to Control Network Access Using TrustSec Security Group Tags](#id_111477)
    + [About Security Group Tags (SGT)](#id_111478)
    + [Configure Access Control Based on Security Group Tag (SGT)](#Cisco_Task_in_List_GUI.dita_96d60f09-ac6d-4d6a-b99d-2c014e0a7927)
      - [Configure Security Groups and SXP Publishing in ISE](#id_111604)
Close

# Access Control

The following topics explain access
control rules. These rules control which traffic is allowed to pass through the
device, and apply advanced services to the traffic, such as intrusion
inspection.

* [Best Practices for Access Control](#Cisco_Task_in_List_GUI.dita_580ffb68-71da-4bb9-a43e-72556ae9a818)
* [Access Control Overview](#concept_A2A9F13454874EE29D126502410853C9)
* [License Requirements for Access Control](#concept_EBC1B6EF994F4C78AF63C5EB39A248EF)
* [Guidelines and Limitations for Access Control Policies](#concept_AA0463A9912F4868B33694E7C0C5648A)
* [Configuring the Access Control Policy](#id_11408)
* [Monitoring Access Control Policies](#concept_5E21BDA8E18D469D8984F33F849886B6)
* [Examples for Access Control](#concept_3F8CFF15DAB142E4AAA8809C3D2CC4B8)

## Best Practices for Access Control

The access control policy is your primary tool for protecting your internal networks
and preventing your users from accessing undesirable external network resources,
such as inappropriate web sites. Thus, we recommend that you pay special attention
to this policy and fine-tune it to get the level of protection and connectivity that
you need.

The following procedure provides an overview of the basic things you should do with
the access control policy. This is an overview, and does not provide exhaustive
steps for performing each task.

To get to the access control policy, choose Policies > Access Control.

### Procedure

---

| **Step 1** | Configure the default action for the policy.  The default action handles connections that do not match the specific rules in the policy. By default, this action is Block, so that anything you miss in the rules is blocked. Thus, you simply need to write access control rules that allow desirable traffic. This is the traditional way to configure the access control policy.  You can do the opposite, where you allow traffic by default, and write rules that drop known undesirable traffic, so that you do not need to have rules for everything you want to allow. This makes it easy for new services to be used, but opens the risk that new undesirable traffic will get through before you notice it. |
| --- | --- |
| **Step 2** | Click the Access Policy Settings (Gear/Settings button.) button, and enable the TLS Server Identity Discovery option.  This option improves the initial application detection and URL category and reputation identification for TLS 1.3 connections. If you do not enable this option, TLS 1.3 traffic might not match your intended rules. This option can also improve the efficacy of decryption rules. |
| **Step 3** | Create as few access control rules as possible.  With traditional firewalls, you might end up with tens of thousands of rules for various combinations of IP address and port. With a next-generation firewall, you can use advanced inspection and avoid some of these detailed rules. The fewer rules you have, the faster the system can evaluate traffic, and the easier it will be for you to find and fix problems within your rule set. |
| **Step 4** | Enabling logging on your access control rules.  Statistics are collected for matching traffic only if you enable logging. Your monitoring dashboards will be inaccurate if you do not enable logging. |
| **Step 5** | Put very specific rules at the top of the policy, and ensure that specific rules are above any more general rule that would match the connections a specific rule would also match.  The policy is evaluated top-down, first match wins. Thus, if you put in a rule that blocks all traffic to a specific subnet, then follow it with a rule that allows access to a single IP address within the subnet, traffic to that address will not be allowed, because the first rule will block it.  In addition, place rules that target traffic based only on traditional criteria such as ingress/egress interface, and source/destination IP address, port, or Geolocation, ahead of rules that require deep inspection, such as those that apply to user criteria, URL filtering, or application filtering. Because these rules do not require inspection, putting them early can get you quicker access control decisions for matching connections.  For more suggestions, see [Best Practices for Access Control Rule Order](#concept_F36CB276D40F4D9ABBBDB8E771DC32D4). |
| **Step 6** | Pair Block and Allow rules to target subsets of traffic.  For example, it is likely that you want to allow a lot of HTTP/HTTPS traffic, yet block access to some undesirable sites such as pornography or gambling. You can accomplish this by creating the following rules and keeping them sequential within the policy (for example, rules 11 and 12).   * A URL filtering Block rule that targets undesirable URL categories,   applied to the inside security zone (source) and outside security   zone (destination), and any IP address, port, or Geolocation. For   example, Block Botnets, Child Abuse Content, Cryptojacking, DNS   Tunneling, Ebanking Fraud, Exploits, Extreme, Filter Avoidance,   Gambling, Hacking, Hate Speech, High Risk Sites and Locations,   Illegal Activities, Illegal Downloads, Illegal Drugs, Malicious   Sites, Malware Sites, Mobile Threats, P2P Malware Node, Phishing,   Pornography, Spam, Spyware and Adware. * An application filtering Allow rule for the HTTP and HTTPS   applications, applied to the inside security zone (source) and   outside security zone (destination), and any IP address, port, or   Geolocation. After the URL filtering rule blocks access to unwanted   web resources, this rule allows all other HTTP/HTTPS access. |
| **Step 7** | Use advanced next-generation firewall features to target traffic regardless of IP address or port.  Attackers or other bad actors can frequently change IP addresses and ports to evade traditional access control traffic-matching criteria. Instead, use the following next-generation features:   * User criteria—Configure the Identity policy to obtain information   about the user who is initiating the traffic. Ideally, your Active   Directory server organizes users into groups, and you can create   access control rules that allow or block traffic based on user group   membership. For example, allow Engineers to access your development   subnets, but implicitly block anyone who is not in the Engineers   group. Use groups rather than individual user names, so you do not   need to continually update the rules as people are added to the   network. * Application criteria—Use application filtering criteria to allow or   block types of applications. This, if a user changes ports for an   HTTP connection, the system can recognize that it is HTTP, even   though it isn't going to port 80. For more suggestions, see [Best Practices for Application Filtering](#concept_02DF0685418F419EA1CADA6693872521). * URL category and reputation criteria—Use URL filtering based on   category to dynamically allow or block sites based on the type of   site. Within the site type, or category, you can fine-tune your rule   based on whether the site has a reputation as a good actor or a bad   actor. By using category and reputation, you will not need to   constantly adjust your rules as sites change URLs, which you would   have to do if you tried to manually block sites by URL. For more   suggestions, see [Best Practices for Effective URL Filtering](#concept_F6A0AA79F3F54EE7BBFA3646D00596A7).  You can also apply URL   category/reputation filtering rules to the FQDN in a DNS lookup   request. The system can prevent the DNS response for blocked   category/reputation, effectively blocking the user’s connection   attempt. For details, see [Filtering DNS Requests Based on URL Category and Reputation](#Cisco_Task_in_List_GUI.dita_144597f9-f18a-47d8-a82e-35a4b93043d5). |
| **Step 8** | Apply intrusion inspection to all of your Allow rules.  One of the powerful aspects of next-generation firewalls is that you can apply intrusion inspection and access control using the same device. Apply an intrusion policy to each Allow rule, so that if an attack does enter your network through a normally benign path, you can catch it and drop the attacking connection.  If your default action is Allow, you can also apply intrusion protection for traffic that matches the default action. |
| **Step 9** | Also configure the Security Intelligence policy to block unwanted IP addresses and URLs.  The Security Intelligence policy is applied before the access control policy, so it can block unwanted connections before your access control rules are even evaluated. This can provide an early block and help you reduce the complexity of your access control rules. |
| **Step 10** | Consider implementing the SSL Decryption policy.  The system cannot perform deep inspection on encrypted traffic. If you configure the SSL Decryption policy, the access control policy is applied to a decrypted version of the traffic. Thus, deep inspection can identify attacks (using the intrusion policy), and rule matching is better because application and URL filtering can be applied more effectively. Any traffic that the access control policy allows is then re-encrypted before being sent out of the device, so the end user does not lose the protection of encryption. |
| **Step 11** | Enable object group search to simplify the deployment of your rules.  Enabling object group search reduces memory requirements for access control policies that include network objects. However, it is important to note that object group search might also decrease rule lookup performance and thus increase CPU utilization. You should balance the CPU impact against the reduced memory requirements for your specific access control policy. In most cases, enabling object group search provides a net operational improvement.  You can set this option using FlexConfig by issuing the object-group-searchaccess-control  command; use the no  form of the command in the negate template. |

---

## Access Control Overview

The following topics explain access
control policies.

* [Access Control Rules and the Default Action](#concept_621711DB8AFF4CD09EDE891B63B30673)
* [Application Filtering](#concept_D9B6E873A8D74A3A959BCBA36C29451F)
* [URL Filtering](#concept_3FD55F41D0084FDB8E58869B8FFF65C9)
* [DNS Request Filtering](#Cisco_Concept.dita_8ecc19cf-1d41-4741-82cd-1bf5661deb22)
* [Intrusion, File, and Malware Inspection](#concept_A1DB99832FED44F0AAC7181CD11FECBD)
* [Best Practices for Access Control Rule Order](#concept_F36CB276D40F4D9ABBBDB8E771DC32D4)
* [NAT and Access Rules](#ID-2124-00000055)
* [How Other Security Policies Impact Access Control](#concept_903B1EBDCA764E799E26B92F0CF8D608)

### Access Control Rules and the Default Action

Use the access control
policy to allow or block access to network resources. The policy consists of a
set of ordered rules, which are evaluated from top to bottom. The rule applied
to traffic is the first one where all the traffic criteria are matched.

You can control access
based on:

* Traditional
  network characteristics such as source and destination IP addresses, protocol,
  ports, and interfaces (in the form of security zones).
* The fully-qualified domain name (FQDN) of the source or destination (in the form of a network object). Traffic matching is
  based on the IP address returned for the name from a DNS lookup.
* The security group tag (SGT) assigned to the source or destination by the Cisco
  Identity Services Engine (ISE).
* The application
  that is being used. You can control access based on the specific application,
  or you can create rules that cover categories of applications, applications
  tagged with a particular characteristic, the type of application (client,
  server, web), or the application's risk or business relevance rating.
* The destination
  URL of a web request, including the generalized category of the URL. You can
  refine category matches based on the public reputation of the target site.
* The URL category and reputation of an FQDN in a DNS lookup request. You can block
  the DNS response for unwanted categories or poor reputations, effectively
  preventing the subsequent connection attempt.
* The user who is
  making the request, or the user groups to which the user belongs.

For unencrypted
traffic that you allow, you can apply IPS inspection to check for threats and
block traffic that appears to be an attack. You can also use file policies to
check for prohibited files or malware.

Any traffic that does
not match an access rule is handled by the access control
Default
Action. If you allow traffic by default, you can apply intrusion
inspection to the traffic. However, you cannot perform file or malware
inspection on traffic handled by the default action.

### Application Filtering

You can use access
control rules to filter traffic based on the application used in the
connection. The system can recognize a wide variety of applications, so that
you do not need to figure out how to block one web application without blocking
all web applications.

For some popular
applications, you can filter on different aspects of the application. For
example, you could create a rule that blocks Facebook Games without blocking
all of Facebook.

You can also create
rules based on general application characteristics, blocking or allowing entire
groups of applications by selecting risk or business relevance, type, category,
or tag.
**However, as you
select categories in an application filter, look over the list of matching
applications to ensure you are not including unintended applications.** For a
detailed explanation of the possible groupings, see
[Application Criteria](#concept_1F51EAD7EE7D4107BCF4547CD8D0653B).

* [Application Control for Encrypted and Decrypted Traffic](#concept_28D9D3ECCAC8424ABF27B39DC3A92311)
* [Filtering on Common Industrial Protocol (CIP) and Modbus Applications (ISA 3000)](#id_110363)
* [Best Practices for Application Filtering](#concept_02DF0685418F419EA1CADA6693872521)

#### Application Control for Encrypted and Decrypted Traffic

If an application uses encryption, the system might not be able to
identify the application.

The system can detect application traffic encrypted with StartTLS,
including SMTPS, POPS, FTPS, TelnetS, and IMAPS. In addition, it can identify
certain encrypted applications based on the Server Name Indication in the TLS
ClientHello message, or the subject distinguished name value from the server
certificate.

Use the application filters dialog box to determine if your application
requires decryption by selecting the following Tags, then examining the list of
applications.

* SSL Protocol—You do not need to decrypt
  traffic tagged as SSL Protocol. The system can recognize this traffic and apply
  your access control action. Access control rules for the listed applications
  should match to expected connections.
* Decrypted Traffic—The system can recognize this traffic only if you first decrypt the traffic. Configure SSL decryption rules for this traffic.

#### Filtering on Common Industrial Protocol (CIP) and Modbus Applications (ISA 3000)

You can enable the Common Industrial Protocl (CIP) and Modbus pre-processors on Cisco ISA 3000 devices, and filter on CIP and Modbus applications in access control rules. All CIP application names start with “CIP,” such
as CIP Write. There is only one application for Modbus.

To enable the pre-processors, you must go into expert mode in a CLI session (SSH or Console) and issue the following command
to enable one or both of these Supervisory Control and Data Acquisition (SCADA) applications.

sudo /usr/local/sf/bin/enable\_scada.sh {cip | modbus | both}

For example, to enable both pre-processors:

```

> expert
admin@firepower:~$ sudo /usr/local/sf/bin/enable_scada.sh both

```

| **Note** | ---   You must issue this command after every deployment. These pre-processors are disabled during deployment.   --- |
| --- | --- |

#### Best Practices for Application Filtering

Please keep the
following recommendations in mind when designing your application filtering
access control rules.

* To handle traffic
  referred by a web server, such as advertisement traffic, match the referred
  application rather than the referring application.
* Avoid combining
  application and URL criteria in the same rule, especially for encrypted
  traffic.
* If you write a
  rule for traffic that is tagged
  Decrypted Traffic, ensure that you have an SSL
  Decryption rule that will decrypt the matching traffic. These applications can
  be identified in decrypted connections only.
* TLS 1.3 encrpyts most handshake messages, so certificate information is not readily available. For traffic encrypted with
  TLS 1.3 to match access rules that use application or URL filtering effectively, the system must obtain a clear-text certificate
  for the server. We recommend that you enable TLS 1.3 Certificate Visibility in the access control settings. If you enable this option, the system checks whether a certificate for the site is stored
  in cache based on the IP address and Server Name Indication (SNI) in the client hello packet. If one is not available, the
  system uses a TLS 1.2 probe to obtain the certicate, which can then be used for application/URL category and reputation identification
  without decrypting the connection.
* The system can
  detect multiple types of Skype application traffic. To control Skype traffic,
  choose the Skype tag from the Application Filters list rather than selecting
  individual applications. This ensures that the system can detect and control
  all Skype traffic the same way.
* To control access to Zoho mail, select both the Zoho and Zoho Mail
  applications.

### URL Filtering

You can use access
control rules to filter traffic based on the URL used in an HTTP or HTTPS
connection. Note that URL filtering for HTTP is more straight-forward than it
is for HTTPS, because HTTPS is encrypted.

You can use the
following techniques to implement URL filtering.

* Category and reputation-based URL filtering—With a URL filtering license, you can control access to web sites based on the
  URL’s general classification (category) and risk level (reputation). This is by far the easiest and most effective way to
  block unwanted sites.
* Manual URL
  filtering—With any license, you can manually specify individual URLs, and
  groups of URLs, to achieve granular, custom control over web traffic. The main
  purpose of manual filtering is to create exceptions to category-based block
  rules, but you can use manual rules for other purposes.

The following topics
provide more information on URL filtering.

* [Filtering URLs by Category and Reputation](#concept_2190C5512921483CB9009A9FF5E3AE74)
* [Looking Up the Category and Reputation for a URL](#id_75010)
* [Manual URL Filtering](#concept_BA45929BE1D543DAA1738FE58F5E4C0C)
* [Filtering HTTPS Traffic](#concept_3DF15D5D32444D5DA55001A3D2BF4816)
* [Comparing URL and Application Filtering](#concept_9B9F5E79222E41DB9ED37367A499BE6E)
* [Best Practices for Effective URL Filtering](#concept_F6A0AA79F3F54EE7BBFA3646D00596A7)
* [What the User Sees When You Block Web Sites](#id_40051)

#### Filtering URLs by Category and Reputation

With a URL filtering license, you can control access to web sites based on the category and reputation of the requested URLs:

* Category—A general classification for the URL. For example, ebay.com
  belongs to the Auctions category, and monster.com belongs to the Job Search
  category. A URL can belong to more than one category.
* Reputation—How likely the URL is to be used for purposes that might be against your organization’s security policy. Reputations range from Untrusted (level 1) to Trusted (level 5).

URL categories and reputations help you quickly configure URL filtering. For example, you can use access control to block untrusted URLs in the Illegal Drugs category.

For a description of the categories, see <https://www.talosintelligence.com/categories>.

Using category and reputation data also simplifies policy creation and
administration. Sites that represent security threats, or that serve
undesirable content, might appear and disappear faster than you can update and
deploy new policies. As Cisco updates the URL database with new sites, changed
classifications, and changed reputations, your rules automatically adjust to
the new information. You do not need to edit your rules to account for new
sites.

If you enable regular URL database updates, you can ensure that the
system uses up-to-date information for URL filtering. You can also enable
communications with Cisco Collective Security Intelligence (CSI) to obtain the
latest threat intelligence for URLs with unknown category and reputation. For
more information, see
[Configuring URL Filtering Preferences](fptd-fdm-system.html#id_16177).

| **Note** | ---   To see URL category and reputation information in events and application details, you must create at least one rule with a URL condition.   --- |
| --- | --- |

#### Looking Up the Category and Reputation for a URL

You can check on the category and reputation for a particular URL. You can go to the URL tab of an access control rule, or
SSL decryption rule, or go to Device > System Settings > URL Filtering Preferences. There, you can enter the URL in the URL to Check field and click Go.

You will be taken to a web site that shows the results of the lookup. You can use this information to help you check the behavior
of your category- and reputation-based URL filtering rules.

If you disagree with the categorization, you can click the Submit a URL Category Dispute in the FDM to tell us what you think.

#### Manual URL Filtering

You can supplement or selectively override category and reputation-based
URL filtering by manually filtering individual URLs or groups of URLs. You can
perform this type of URL filtering without a special license.

For example, you might use access control to block a category of web
sites that are not appropriate for your organization. However, if the category
contains a web site that is appropriate, and to which you want to provide
access, you can create a manual Allow rule for that site and place it before
the Block rule for the category.

To configure manual URL filtering, you create a URL object with the
destination URL. How this URL is interpreted is based on the following rules:

* If you do not include a path (that is, there are no / characters in the URL), the match is based on the server’s hostname
  only. If you include one or more / character, the entire URL string is used for a substring match. Then, a URL is considered
  a match if any of the following are true:

  + The string is at the beginning of the URL.
  + The string follows a dot.
  + The string contains a dot in the beginning.
  + The string follows the :// characters.

  For example, ign.com matches ign.com or www.ign.com, but not versign.com.

  | **Note** | ---   We recommend that you do not use manual URL filtering to block or allow individual web pages or parts of sites (that is, URL strings with / characters), as servers can be reorganized and pages moved to new paths.   --- |
  | --- | --- |
* The system
  disregards the encryption protocol (HTTP vs HTTPS). In other words, if you
  block a website, both HTTP and HTTPS traffic to that website is blocked, unless
  you use an application condition to target a specific protocol. When creating a
  URL object, you do not need to specify the protocol when creating an object.
  For example, use example.com rather than http://example.com.
* If you plan to
  use a URL object to match HTTPS traffic in an access control rule, create the
  object using the subject common name in the public key certificate used to
  encrypt the traffic. Also, the system disregards subdomains within the subject
  common name, so do not include subdomain information. For example, use
  example.com rather than www.example.com.

  However, please
  understand that the subject common name in the certificate might be completely
  unrelated to a web site’s domain name. For example, the subject common name in
  the certificate for youtube.com is \*.google.com (this of course might change at
  any time). You will get more consistent results if you use the SSL Decryption
  policy to decrypt HTTPS traffic so that URL filtering rules work on decrypted
  traffic.

  | **Note** | ---   URL objects will not match HTTPS traffic if the browser resumes a TLS session because the certificate information is no longer available. Thus, even if you carefully configure the URL object, you might get inconsistent results for HTTPS connections.   --- |
  | --- | --- |

#### Filtering HTTPS Traffic

Because HTTPS traffic
is encrypted, performing URL filtering directly on HTTPS traffic is not as
straight-forward as it is on HTTP traffic. For that reason, you should consider
using SSL Decryption policies to decrypt all HTTPS traffic that you intend to
filter. That way, the URL filtering access control policies work on decrypted
traffic, and you get the same results you would get for regular HTTP traffic.

However, if you do
intend to allow some HTTPS traffic to pass undecrypted into the access control
policy, you need to understand that rules match HTTPS traffic differently than
they do for HTTP traffic. To filter encrypted traffic, the system determines
the requested URL based on information passed during the SSL handshake: the
subject common name in the public key certificate used to encrypt the traffic.
There might be little or no relationship between the web site hostname in the
URL and the subject common name.

You can improve HTTPS matching for category/reputation
rules if you enable DNS request filtering. The system can determine the category and
reputation during the DNS resolution phase, and block the DNS reply for unwanted
combinations, before the user can start the HTTPS connection attempt. For allowed DNS
responses, the system will have the category/reputation information available for
subsequent HTTPS connections. See [DNS Request Filtering](#Cisco_Concept.dita_8ecc19cf-1d41-4741-82cd-1bf5661deb22).

HTTPS filtering,
unlike HTTP filtering, disregards subdomains within the subject common name. Do
not include subdomain information when manually filtering HTTPS URLs. For
example, use example.com rather than www.example.com. Also, review the content
of the certificates used by the site to ensure you have the right domain, the
one used in the subject common name, and that this name will not conflict with
your other rules (for example, the name for a site you want to block might
overlap with one you want to allow). For example, the subject common name in
the certificate for youtube.com is \*.google.com (this of course might change at
any time).

| **Note** | ---   URL objects will not match HTTPS traffic if the browser resumes a TLS session because the certificate information is no longer available. Thus, even if you carefully configure the URL object, you might get inconsistent results for HTTPS connections.   --- |
| --- | --- |

##### Controlling Traffic by Encryption Protocol

The system disregards the encryption protocol (HTTP vs HTTPS)
when performing URL filtering. This occurs for both manual and reputation-based
URL conditions. In other words, URL filtering treats traffic to the following
web sites identically:

* http://example.com
* https://example.com

To configure a rule that matches only HTTP or HTTPS traffic, but
not both, either specify the TCP port in the Destination condition or add an
application condition to the rule. For example, you could allow HTTPS access to
a site while disallowing HTTP access by constructing two access control rules,
each with an TCP port or application, and URL, condition.

The first rule allows HTTPS traffic to the website:

* Action: Allow
* TCP port or
  Application: HTTPS (TCP port 443)
* URL: example.com

The second rule blocks HTTP access to the same website:

* Action: Block
* TCP port or
  Application: HTTP (TCP port 80)
* URL: example.com

#### Comparing URL and Application Filtering

URL and application
filtering have similarities. But you should use them for very distinct
purposes:

* URL filtering is
  best used to block or allow access to an entire web server. For example, if you
  do not want to allow any type of gambling on your network, you can create a URL
  filtering rule to block the Gambling category. With this rule, users cannot get
  to any pages on any web server within the category.
* Application
  filtering is useful for blocking specific applications regardless of the
  hosting site, or for blocking specific features of an otherwise allowable web
  site. For example, you could block just the Facebook Games application without
  blocking all of Facebook.

Because combining
application and URL criteria can lead to unexpected results, especially for
encrypted traffic, it is a good policy to create separate rules for URL and
application criteria. If you do need to combine application and URL criteria in
a single rule, you should place these rules after straight-forward
application-only or URL-only rules, unless the application+URL rule is acting
as an exception to a more general application-only or URL-only rule. Because
URL filtering block rules are more broad than application filtering, you should
place them above application-only rules.

If you do combine
application and URL criteria, you might need to monitor your network more
carefully to ensure that you are not allowing access to unwanted sites and
applications.

#### Best Practices for Effective URL Filtering

Please keep the
following recommendations in mind when designing your URL filtering access
control rules.

* Use category and
  reputation blocking whenever possible. This ensures that new sites get blocked
  automatically as they are added to the categories, and that blocking based on
  reputation is adjusted if a site becomes more (or less) reputable.
* When using URL category matching, note that there are cases where the login page for a site is in a different category than
  the site itself. For example, Gmail is in the Web-based Email category, whereas the login page is in the Search Engines and Portals category. If you have different rules with different actions for the categories, you might get unintended results.
* Use URL objects to
  target entire web sites and to make exceptions to category blocking rules. That
  is, to allow specific sites that would otherwise get blocked in a category
  rule.
* If you want to
  manually block a web server (using a URL object), it is much more effective to
  do so in the Security Intelligence policy. The Security Intelligence policy
  drops connections before the access control rules are evaluated, so you get a
  faster, more efficient, block.
* For the most
  effective filtering of HTTPS connections, implement SSL decryption rules to
  decrypt traffic for which you are writing an access control rule. Any decrypted
  HTTPS connections are filtered as HTTP connections in the access control
  policy, so you avoid all of the limitations for HTTPS filtering.
* TLS 1.3 encrpyts most handshake messages, so certificate information is not readily available. For traffic encrypted with
  TLS 1.3 to match access rules that use application or URL filtering effectively, the system must obtain a clear-text certificate
  for the server. We recommend that you enable TLS 1.3 Certificate Visibility in the access control settings. If you enable this option, the system checks whether a certificate for the site is stored
  in cache based on the IP address and Server Name Indication (SNI) in the client hello packet. If one is not available, the
  system uses a TLS 1.2 probe to obtain the certicate, which can then be used for application/URL category and reputation identification
  without decrypting the connection.
* Place URL blocking
  rules before any application filtering rules, because URL filtering blocks
  entire web servers, whereas application filtering targets specific application
  usage regardless of the web server.
* If you want to block high risk sites whose category is unknown, select the Uncategorized category and adjust the reputation slider to Questionable or Untrusted.
* You can improve overall URL filtering efficacy by also enabling DNS request
  filtering. When you use DNS request filtering, the system determines the FQDN’s
  URL category and reputation at DNS lookup time, so the information is available
  if a subsequent HTTP/HTTPS request comes for the same destination. Additionally,
  if you block the category/reputation, the attempted connection gets stopped at
  the DNS request stage, rather than the web-session establishment stage. See
  [DNS Request Filtering](#Cisco_Concept.dita_8ecc19cf-1d41-4741-82cd-1bf5661deb22).

#### What the User Sees When You Block Web Sites

When you block web sites with URL filtering rules, what the user sees
differs based on whether the site is encrypted.

* HTTP connections—The user sees a system default block response page
  instead of the normal browser page for timed out or reset connections. This
  page should make it clear that you blocked the connection on purpose.
* HTTPS (encrypted) connections—The user does not see the system
  default block response page. Instead, the user sees the browser’s default page
  for a secure connection failure. The error message does not indicate the site
  was blocked due to policy. Instead, errors might indicate that there are no
  common encryption algorithms. It will not be obvious from this message that you
  blocked the connection on purpose.

In addition, web sites might be blocked by other access control rules
that are not explicitly URL filtering rules, or even by the default action. For
example, if you block entire networks or geolocations, any web sites on that
network or in that geographic location are also blocked. Users blocked by these
rules may, or may not, get a response page as described in the limitations
below.

If you implement URL filtering, consider explaining to end users what
they might see when a site is intentionally blocked, and what types of site you
are blocking. Otherwise, they might spend a good deal of time troubleshooting
blocked connections.

##### Limitations of HTTP Response Pages

HTTP response pages do not always appear when the system blocks web
traffic.

* The system does not display a response page when web traffic is
  blocked as a result of a promoted access control rule (an early-placed blocking
  rule with only simple network conditions).
* The system does not display a response page when web traffic is
  blocked before the system identifies the requested URL.
* The system does not display a response page for encrypted
  connections blocked by access control rules.

### DNS Request Filtering

You can apply the URL category and reputation database to DNS lookup requests, even for
connection attempts that are not HTTP/HTTPS.

For example, if a user tries to make an FTP connection to www.example.com, you can
configure the system to look up the category and reputation of www.example.com when it
sees the DNS lookup request for that fully-qualified domain name (FQDN). If your DNS/URL
filtering rule for the returned category/reputation is a block rule, the system blocks
the DNS reply. Thus, the user does not get an IP address for the FQDN, and their
connection attempt fails.

By enabling DNS lookup request filtering, you can extend your URL filtering rules to
protocols other than HTTP/HTTPS, and prevent FTP, TFTP, SCP, ICMP, and any other
protocols from establishing a connection to a site that you are blocking for web access.
This works so long as the user uses an FQDN name and thus requires a DNS lookup. If the
user uses an IP address, there is no DNS request and DNS request blocking is not
possible.

For HTTP/HTTPS traffic, doing the category/reputation lookup at DNS request time might
improve system performance, as it can prevent the connection before the attempt to
establish the web session. This might be especially beneficial for HTTPS, which is
encrypted. By denying at the DNS request stage, the system never sees an HTTPS
connection, and thus your decryption rules do not need to be evaluated, nor does the
system need to perform the more difficult task of matching an encrypted session to the
right access control rule.

* [Guidelines for DNS Request Filtering](#Cisco_Concept.dita_878ba506-40a2-456d-b855-c703c8cae058)
* [Filtering DNS Requests Based on URL Category and Reputation](#Cisco_Task_in_List_GUI.dita_144597f9-f18a-47d8-a82e-35a4b93043d5)

#### Guidelines for DNS Request Filtering

Keep the following in mind as you configure DNS request filtering:

* DNS request filtering works on the DNS session only. If you allow the DNS reply
  (that is, the URL filtering rule action is Allow), then the subsequent
  connection that the user establishes with the returned IP address will be
  matched against your access control rules separately. The connection might match
  a different rule, and thus be blocked or allowed for other reasons. For example,
  if you allow an FTP attempt to get an IP address through a DNS lookup, you might
  have another access control rule that prohibits FTP connections, and the
  connection will ultimately be blocked.
* DNS lookup requests that match access control rules that come before your URL/DNS
  request filtering rules will be allowed or blocked according to the matching
  rule. Category/reputation lookup will not be done for these connections.
* This feature requires that you implement URL filtering based on
  category/reputation. You must have the URL filtering license for this type of
  URL filtering. If you have no URL filtering rules based on category/reputation,
  then DNS request filtering is not relevant and you should not enable it.
* Connection events generated by DNS filtering include the following fields of
  special interest: DNS Query, URL Category, and URL Reputation. The DNS Query
  field shows the fully-qualified domain name (FQDN) for the lookup request. For
  DNS filtering events, the URL field will be blank.
* DNS request filtering uses the URL category and reputation database only. Any URL
  objects or other manual URL filtering defined in a matching access control rule
  are ignored. If you want to implement manual DNS name blocking, use the Security
  Intelligence DNS policy.

#### Filtering DNS Requests Based on URL Category and Reputation

The following procedure explains how to implement DNS lookup request filtering.

##### Before you begin

You must enable the URL license if it is not already enabled.

##### Procedure

---

| **Step 1** | Select Policies > Access Control. |
| --- | --- |
| **Step 2** | If necessary, click the Access Policy Settings (Gear/Settings button. ) button, select the Reputation Enforcement on DNS Traffic option, and click OK.  This option enables DNS request filtering for the access control policy. The option is enabled by default. |
| **Step 3** | Evaluate existing URL filtering rules, or create new ones, to implement filtering based on URL category and reputation that will also apply to DNS requests.  URL filtering normally applies to HTTP/HTTPS traffic only, so there is no reason to restrict these rules based on application or port. However, if you do have these restrictions, ensure that the rule can also apply to DNS requests:   * On the Source/Destination tab, if the   Destination Ports field has   Any, no change is needed. If you   specified ports, add DNS over UDP and   DNS over TCP to the list. * On the Applications tab, if the application   list simply has Any, no change is needed. If   you specified any applications or application filters, add the   DNS application to the list or filter.   The other DNS-related options are not relevant for this purpose.   For information on creating access control rules, see [Configuring Access Control Rules](#task_68A29B520CFF46608A8E88D8DFE7AEC0). |
| **Step 4** | Evaluate preceding rules to ensure that DNS requests do not match those rules.  Category and reputation determination happens only if the DNS request matches a URL filtering rule that has category and reputation specifications. Any DNS requests that match rules earlier in the access control policy than your URL filtering rule bypass DNS request filtering. Such DNS requests are handled according to the matching rule, either blocked or allowed. |

---

### Intrusion, File, and Malware Inspection

Intrusion and file
policies work together as the last line of defense before traffic is allowed to
its destination:

* Intrusion policies
  govern the system's intrusion prevention capabilities.
* File policies govern the system's file control and malware defense capabilities.

All other traffic
handling occurs before network traffic is examined for intrusions, prohibited
files, and malware. By associating an intrusion or file policy with an access
control rule, you are telling the system that before it passes traffic that
matches the access control rule's conditions, you first want to inspect the
traffic with an intrusion policy, a file policy, or both.

You can configure
intrusion and file policies on rules that
allow traffic only. Inspection is not performed on
rules set to
trust or
block traffic. In addition, if the default action
for the access control policy is
allow, you can configure an intrusion policy but
not a file policy.

For any single
connection handled by an access control rule, file inspection occurs before
intrusion inspection. That is, the system does not inspect files blocked by a
file policy for intrusions. Within file inspection, simple blocking by type
takes precedence over malware inspection and blocking. Until a file is detected
and blocked in a session, packets from the session may be subject to intrusion
inspection.

| **Note** | ---   By default, the system disables intrusion and file inspection of encrypted payloads. This helps reduce false positives and improve performance when an encrypted connection matches an access control rule that has intrusion and file inspection configured. Inspection works with unencrypted traffic only.   --- |
| --- | --- |

### Best Practices for Access Control Rule Order

Rules are applied on a first-match basis, so you must ensure that rules
with highly specific traffic matching criteria appear above policies that have
more general criteria that would otherwise apply to the matching traffic.
Consider the following recommendations:

* Specific rules should come before general rules, especially when the
  specific rules are exceptions to general rules.
* Any rules that drop traffic based on layer-3/4 criteria only (such
  as IP address, security zone, and port number) should come as early as
  possible. We recommend they come before any rule that requires inspection, such
  as those with application or URL criteria, because Layer-3/4 criteria can be
  evaluated quickly and without inspection. Of course, any exceptions to these
  rules must be placed above them.
* Whenever possible, put specific drop rules near the top of the
  policy. This ensures the earliest possible decision on undesirable traffic.
* Any rules that include both application and URL criteria should come
  after straight-forward application-only or URL-only rules, unless the
  application+URL rule is acting as an exception to a more general
  application-only or URL-only rule. Combining application and URL criteria can
  lead to unexpected results, especially for encrypted traffic, so we recommend
  that you create separate rules for URL and application filtering whenever
  possible.

### NAT and Access Rules

Access rules always use the real IP addresses when determining
an access rule match, even if you configure NAT. For example, if you configure
NAT for an inside server, 10.1.1.5, so that it has a publicly routable IP
address on the outside, 209.165.201.5, then the access rule to allow the
outside traffic to access the inside server needs to reference the server’s
real IP address (10.1.1.5), and not the mapped address (209.165.201.5).

### How Other Security Policies Impact Access Control

Other security
policies can affect how access control rules function and match connections. As
you configure your access rules, keep the following in mind:

* SSL
  Decryption policy—The SSL decryption rules are evaluated before
  access control. Thus, if an encrypted connection matches an SSL decryption rule
  that applies some type of decryption, it is the plain text (decrypted)
  connection that is evaluated by the access control policy. The access rules do
  not see the encrypted version of the connection. Additionally, any connections
  that match SSL decryption rules that drop traffic are never seen by the access
  control policy. Finally, any encrypted connection that matches a Do Not Decrypt
  rule is evaluated in its encrypted state.
* Identity policy—Connections are matched to users
  (and thus, user groups) only if there is a user mapping for the source IP
  address. Access rules that key on user or group membership can match only those
  connections for which user identity was successfully collected by your identity
  policy.
* Security Intelligence policy—Any connection that is dropped is never
  seen by the access control policy. Connections that match the do not block list
  are subsequently matched to access control rules and, ultimately, it is the
  access control rule that determines how the connection is handled (allowed or
  dropped).
* VPN (site-to-site or remote access)—VPN traffic is always evaluated against
  the access control policy, and connections are allowed or dropped based on the
  matching rule. However, the VPN tunnel itself is decrypted before the access
  control policy is evaluated. The access control policy evaluates the
  connections that are embedded within the VPN tunnel, not the tunnel itself.

## License Requirements for Access Control

You do not need a special license to use the access control policy.

However, you do need the following licenses for specific features within
the access control policy. For information on configuring licenses, see
[Enabling or Disabling Optional Licenses](fptd-fdm-license.html#id_12247).

* URL license—To create rules that use URL categories and reputations as match criteria.
* **Threat** license—To configure an intrusion policy on an access rule or the default action. You also need this license to use a file
  policy (the Malware license is also required).
* **Malware** license—To configure a file policy on an access rule. The Threat is also required for file policies.

## Guidelines and Limitations for Access Control Policies

Following are some
additional limitations for access control. Please consider them when evaluating
whether you are getting the expected results from your rules.

* If a URL database update includes added (new, incoming), deprecated (outgoing), or deleted categories, there is a grace period
  for you to make changes to any access control rules that are affected. Impacted rules are marked with informational messages,
  with explanations about the issues that impact the rule and links to the Cisco Talos Intelligence Group
  (Talos) web site for more information about the category changes. You need to update the rule so that it uses the appropriate categories
  available in the latest URL database.

  To accommodate the grace period, add the newly added incoming categories to the appropriate rules without removing the outgoing
  deprecated categories: your rules should contain both the new and old categories. The new categories will be effective when
  the old categories are marked for deletion. When the old categories are finally deleted, you need to edit the rules to remove
  the deleted categories and redeploy the configuration. You will be blocked from deploying the configuration until you fix
  any rules that use deleted categories. Click the See Problem Rules link above the table to filter on rules that need attention.
* FDM can download information on up to 50,000 users from the
  directory server. If your directory server includes more than 50,000 user accounts, you will
  not see all possible names when selecting users in an access rule or when
  viewing user-based dashboard information. You can write rules on only those
  names that were downloaded.

  The 50,000 limit also applies to the names associated with groups. If a group has more than 50,000 members, only the 50,000 names that were downloaded can be matched against the group membership.
* If a Vulnerability Database (VDB) update removes (deprecates) applications, you must make changes to any access control rules
  or application filters that use the application that was deleted. You cannot deploy changes until you fix these rules. In
  addition, you cannot install system software updates before fixing the issue. On the Application Filters object page, or the
  Application tab of the rule, these applications say “(Deprecated)” after the application name.
* To use fully-qualified domain name (FQDN) network objects as source or destination criteria, you must also configure DNS for
  the data interfaces on Device > System Settings > DNS Server. The system does not use the management DNS server setting to do lookups for FQDN objects used in access control rules. For
  information on troubleshooting FQDN resolution, see [Troubleshooting General DNS Problems](fptd-fdm-system.html#id_73501).

  Note that controlling access by FQDN is a best-effort mechanism. Consider the following points:

  + Because DNS replies can be spoofed, only use fully trusted internal DNS servers.
  + Some FQDNs, especially for very popular servers, can have multiple and frequently changing IP addresses. Because the system
    uses cached DNS lookup results, users might get new addresses that are not yet in the cache. Thus, it is possible that blocking
    a popular site by FQDN will provide inconsistent results.
  + For popular FQDNs, different DNS servers can return a different set of IP addresses. Thus, if your users use a different DNS
    server than the one you configure, FQDN-based access control rules might not apply to all IP addresses for the site that are
    used by your clients, and you will not get the intended results for your rules.
  + Some FQDN DNS entries have very short time to live (TTL) values. This can result in frequent recompliation of the lookup table,
    which can impact overall system performance.
* If you edit a rule
  that is actively in use, the changes do not apply to established connections
  that are no longer being inspected by Snort. The new rule is used to match
  against future connections. In addition, if Snort is actively inspecting a
  connection, it can apply the changed matching or action criteria to an existing
  connection. If you need to ensure that your changes apply to all current
  connections, you can log into the device CLI and use the
  clear conn
  command to end established connections, on the assumption that the sources for
  the connections will then attempt to reestablish the connection and thus be
  matched appropriately against the new rule.
* It takes 3 to 5
  packets for the system to identify the application or URL in a connection.
  Thus, the correct access control rule might not be matched immediately for a
  given connection. However, once the application/URL is known, the connection is
  handled based on the matching rule. For encrypted connections, this happens
  after the server certificate exchange in the SSL handshake.
* The system applies
  the default policy action to packets that do not have a payload in a connection
  where an application is identified.
* Leave matching criteria empty whenever possible, especially those for security zones, network objects, and port objects. For
  example, the system can more efficiently match traffic for all interfaces if you simply leave the security zone criteria blank,
  rather than if you create zones that contain all interfaces. When you specify multiple criteria, the system must match against
  every combination of the contents of the criteria you specify.
* If you specify IP addresses for source or destination criteria, do not mix IPv4
  and IPv6 addresses in the same rule. Create separate rules for IPv4 and IPv6
  addresses.
* While operating, the FTD device expands access control rules into multiple access control list entries based on the contents of any network objects
  used in the access rule. You can reduce the memory required to search access control rules by enabling object group search.
  With object group search enabled, the system does not expand network objects, but instead searches access rules for matches
  based on those group definitions. Object group search does not impact how your access rules are defined or how they appear
  in the FDM. It impacts only how the device interprets and processes them while matching connections to access control rules.

  Enabling object group search reduces memory requirements for access control policies that include network objects. However,
  it is important to note that object group search might also decrease rule lookup performance and thus increase CPU utilization.
  You should balance the CPU impact against the reduced memory requirements for your specific access control policy. In most
  cases, enabling object group search provides a net operational improvement.

  You can set this option using FlexConfig by issuing the object-group-searchaccess-control  command; use the no  form of the command in the negate template.
* GRE tunnels that violate the related RFCs will be dropped. For example, if a GRE tunnel contains non-zero values in the reserved
  bits, contrary to the RFCs, it is dropped. If you need to allow non-compliant GRE tunnels, you need to use a remote manager
  and configure a prefilter rule that trusts the sessions. You cannot configure prefilter rules using the FDM.

## Configuring the Access Control Policy

Use the access control
policy to control access to network resources. The policy consists of a set of
ordered rules, which are evaluated from top to bottom. The rule applied to
traffic is the first one where all the traffic criteria are matched. If no
rules match the traffic, the default action shown at the bottom of the page is
applied.

To configure the
access control policy, select
Policies > Access
Control.

The access control
table lists all rules in order. For each rule:

* Click the
  > button next to the rule number in the left-most
  column to open the rule diagram. The diagram can help you visualize how the
  rule controls traffic. Click the button again to close the diagram.
* Most cells allow
  inline editing. For example, you can click the action to select a different
  one, or click a source network object to add or change the source criteria.
* To move a rule, hover over the rule until you get the move icon (![Move rule icon.](/c/dam/en/us/td/i/400001-500000/410001-420000/414001-415000/414046.jpg)),
  then click, drag, and drop the rule to the new location. You can also move a
  rule by editing it and selecting the new location in the
  Order list. It is critical that you put the
  rules in the order that you want them processed. Specific rules should be near
  the top, especially for rules that define exceptions to more general rules
* The right-most
  column contains the action buttons for a rule; mouse over the cell to see the
  buttons. You can edit (![edit icon](/c/dam/en/us/td/i/400001-500000/400001-410000/409001-410000/409815.jpg))
  or delete (![delete icon](/c/dam/en/us/td/i/400001-500000/400001-410000/409001-410000/409814.jpg))
  a rule.
* Click the Access Control Settings (![Gear/Settings button.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420147.jpg)) button to configure settings that apply to the access control policy, rather
  than to specific rules within the policy.
* Click the Toggle Hit Counts icon (![Toggle hit counts button.](/c/dam/en/us/td/i/400001-500000/430001-440000/432001-433000/432141.jpg)) above the table to add or remove the Hit Counts column in the table. The Hit Count column appears to the right of the Name
  column with the total hit count for the rule and the date and time of the last hit. The hit count information is fetched at
  the time you click the toggle button. Click the refresh icon (![Refresh hit count button.](/c/dam/en/us/td/i/400001-500000/430001-440000/432001-433000/432142.jpg)) to get the latest information.
* If any rules have problems, for example, because of removed or changed URL categories, click the See Problem Rules link next to the search box to filter the table to show only those rules. Please edit and correct (or delete) these rules,
  so that they will provide the service that you require.

The following topics
explain how to configure the policy.

* [Configuring the Default Action](#id_11412)
* [Configuring Access Control Policy Settings](#Cisco_Task_in_List_GUI.dita_179d5e33-2993-4e74-bffe-b87d45bd8142)
* [Configuring Access Control Rules](#task_68A29B520CFF46608A8E88D8DFE7AEC0)

### Configuring the Default Action

If a connection does
not match a specific access rule, it is handled by the default action for the
access control policy.

#### Procedure

---

| **Step 1** | Select Policies > Access Control. |
| --- | --- |
| **Step 2** | Click anywhere in the Default Action field. |
| **Step 3** | Select the action to apply to matching traffic.   * Trust—Allow   traffic without further inspection of any kind. * Allow—Allow the   traffic subject to the intrusion policy. * Block—Drop the   traffic unconditionally. The traffic is not inspected. |
| **Step 4** | If the action is Allow, select an intrusion policy.  For an explanation of the policy options, see [Intrusion Policy Settings](#concept_990E998E30CF44F2BBE8D32F6D242E00). |
| **Step 5** | (Optional.) Configure logging for the default action.  You must enable logging for traffic that matches the default action to be included in dashboard data or Event Viewer. See [Logging Settings](#id_10392). |
| **Step 6** | Click OK. |

---

### Configuring Access Control Policy Settings

You can configure settings that apply to the access control policy, rather than to
specific rules within the policy.

#### Procedure

---

| **Step 1** | Select Policy > Access Control. |
| --- | --- |
| **Step 2** | Click the Access Policy Settings (Gear/Settings button.) button. |
| **Step 3** | Configure the settings:   * TLS Server Identity Discovery—TLS 1.3 encrpyts most handshake messages, so certificate information is not readily available. For traffic encrypted with   TLS 1.3 to match access rules that use application or URL filtering, the system must have a clear-text certificate for the   server. If you enable this option, the system checks whether a certificate for the site is stored in cache based on the IP   address and Server Name Indication (SNI) in the client hello packet. If one is not available, the system uses a TLS 1.2 probe   to obtain the certicate, which can then be used for application/URL category and reputation identification. We recommend that   you enable this option to ensure encrypted connections are matched to the right access control rule. The setting obtains the   certificate only; the connection remains encrypted. Enabling this option is sufficient to obtain TLS 1.3 certificates; you   do not need to create a corresponding SSL decryption rule. However, the cached certificates are also used for more effective   decryption rule processing in addition to access control processing. * Reputation Enforcement on DNS Traffic—Enable   this option to apply your URL filtering category and reputation   rules to DNS lookup requests. If the fully-qualified domain name   (FQDN) in the lookup request has a category and reputation that you   are blocking, the system blocks the DNS reply. Because the user does   not receive a DNS resolution, the user cannot complete the   connection. Use this option to apply URL category and reputation   filtering to non-web traffic. For more information, see [DNS Request Filtering](#Cisco_Concept.dita_8ecc19cf-1d41-4741-82cd-1bf5661deb22). |
| **Step 4** | Click OK. |

---

### Configuring Access Control Rules

Use access control
rules to control access to network resources. Rules in the access control
policy are evaluated from top to bottom. The rule applied to traffic is the
first one where all the traffic criteria are matched.

#### Procedure

---

| **Step 1** | Select Policies > Access Control. |
| --- | --- |
| **Step 2** | Do any of the following:   * To create a new rule, click   the   + button. * To edit an existing rule,   click the edit icon (edit icon)   for the rule.   To delete a rule you no longer need, click the delete icon (delete icon) for the rule. |
| **Step 3** | In Order, select where you want to insert the rule in the ordered list of rules.  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 4** | In Title, enter a name for the rule.  The name cannot contain spaces. You can use alphanumeric characters and these special characters: + . \_ - |
| **Step 5** | Select the action to apply to matching traffic.   * Trust—Allow   traffic without further inspection of any kind. * Allow—Allow the   traffic subject to the intrusion and other inspection settings in the policy. * Block—Drop the   traffic unconditionally. The traffic is not inspected. |
| **Step 6** | Define the traffic matching criteria using any combination of the following tabs:   * Source/Destination—The   security zones (interfaces) through which the traffic passes, the IP   addresses or the country or continent (geographical location) for the IP   address, the security group tags (SGT)   assigned to the address, or the protocols and ports used in the   traffic. The default is any zone, address, geographical location, SGT, protocol, and port. See [Source/Destination Criteria](#concept_BA8B7882112F45E09AD00B341C64B871). * Application—The   application, or a filter that defines applications by type, category, tag,   risk, or business relevance. The default is any application. See [Application Criteria](#concept_1F51EAD7EE7D4107BCF4547CD8D0653B). * URL—The URL or URL category of a web or DNS   lookup request. The default is any URL. See [URL Criteria](#concept_885AAC35D2A54D34A1A3B602121818E0). * Users—The identity source, user or user group. Your identity policies determine whether user and group information is available for traffic matching.   You must configure identity policies to use this criteria. See [User Criteria](#id_12066).   To modify a condition, you click the + button within that condition, select the desired object or element, and click OK in the popup dialog box. If the criterion requires an object, you can click Create New Object if the object you require does not exist. Click the x for an object or element to remove it from the policy.  When adding conditions to access control rules, consider the following tips:   * You can   configure multiple conditions per rule. Traffic must match all the conditions   in the rule for the rule to apply to traffic. For example, you can use a single   rule to perform URL filtering for specific hosts or networks. * For each   condition in a rule, you can add up to 50 criteria. Traffic that matches any of   a condition's criteria satisfies the condition. For example, you can use a   single rule to apply application control for up to 50 applications or   application filters. Thus, there is an OR relationship among the items in a   single condition, but an AND relationship between condition types (for example,   between source/destination and application). * Some   features require that you enable the appropriate license. |
| **Step 7** | (Optional.) For policies that use the Allow action, you can configure further inspection on unencrypted traffic. Click one of the following links:   * Intrusion Policy—Select Intrusion Policy > On and select the intrusion inspection policy to inspect traffic   for intrusions and exploits. See [Intrusion Policy Settings](#concept_990E998E30CF44F2BBE8D32F6D242E00). * File Policy—Select the   file policy to inspect traffic for files that contain malware and for files   that should be blocked. See [File Policy Settings](#concept_AD893273F89D45FFA5846A9541E3084D). |
| **Step 8** | (Optional.) Configure logging for the rule.  By default, connection events are not generated for traffic that matches a rule, although file events are generated by default if you select a file policy. You can change this behavior. You must enable logging for traffic that matches the policy to be included in dashboard data or Event Viewer. See [Logging Settings](#id_10392).  Intrusion events are always generated for intrusion rules set to drop or alert regardless of the logging configuration on the matching access rule. |
| **Step 9** | Click OK. |

---

#### Source/Destination Criteria

The Source/Destination criteria of an access rule define the security zones (interfaces) through
which the traffic passes, the IP addresses or the country or continent (geographical
location) for the IP address, the security group
tags (SGT) assigned to the address, or the protocols and ports used in the
traffic. The default is any zone, address, geographical location, SGT, protocol, and port.

To modify a condition,
you click the
+ button within that condition, select the desired
object or element, and click
OK. If the criterion requires an object, you can
click
Create New
Object if the object you require does not
exist. Click the
x for an object or element to remove it from the
policy.

You can use the
following criteria to identify the source and destination to match in the rule.

Source Zones,
Destination Zones

The security
zone objects that define the interfaces through which the traffic passes. You
can define one, both, or neither criteria: any criteria not specified applies
to traffic on any interface.

* To match
  traffic leaving the device from an interface in the zone, add that zone to the
  Destination Zones.
* To match
  traffic entering the device from an interface in the zone, add that zone to the
  Source Zones.
* If you add
  both source and destination zone conditions to a rule, matching traffic must
  originate from one of the specified source zones and egress through one of the
  destination zones.

Use this
criteria when the rule should apply based on where the traffic enters or exits
the device. For example, if you want to ensure that all traffic going to inside
hosts gets intrusion inspection, you would select your inside zone as the
Destination Zones while leaving the source zone
empty. To implement intrusion filtering in the rule, the rule action must be
Allow, and you must select an intrusion policy in
the rule.

| **Note** | ---   You cannot mix passive and routed security zones in a single rule. In addition, you can specify passive security zones as source zones only, you cannot specify them as destination zones.   --- |
| --- | --- |

Source Networks,
Destination Networks

The network
objects or geographical locations that define the network addresses or
locations of the traffic.

* To match
  traffic from an IP address or geographical location, configure the
  Source Networks.
* To match traffic to an IP address or geographical location, configure the Destination Networks.
* If you add
  both source and destination network conditions to a rule, matching traffic must
  originate from one of the specified IP addresses and be destined for one of the
  destination IP addresses.

When you add
this criteria, you select from the following tabs:

* Network—Select the network objects or groups that define the source or destination IP addresses for the traffic you want to control.
  You can use objects that define the address using the fully-qualified domain name (FQDN); the address is determined through
  a DNS lookup.
* Geolocation—Select the geographical location to
  control traffic based on its source or destination country or continent.
  Selecting a continent selects all countries within the continent. Besides
  selecting geographical location directly in the rule, you can also select a
  geolocation object that you created to define the location. Using geographical
  location, you could easily restrict access to a particular country without
  needing to know all of the potential IP addresses used there.

  | **Note** | ---   To ensure that you are using up-to-date geographical location data to filter your traffic, Cisco strongly recommends that you regularly update the geolocation database (GeoDB).   --- |
  | --- | --- |

Source Ports,
Destination Ports/Protocols

The port objects
that define the protocols used in the traffic. For TCP/UDP, this can include
ports. For ICMP, it can include codes and types.

* To match
  traffic from a protocol or port, configure the
  Source Ports. Source ports can be TCP/UDP only.
* To match
  traffic to a protocol or port, configure the
  Destination Ports/Protocols. If you add only
  destination ports to a condition, you can add ports that use different
  transport protocols. ICMP and other non-TCP/UDP specifications are allowed in
  destination ports only; they are not allowed in source ports.
* To match
  traffic both originating from specific TCP/UDP ports and destined for specific
  TCP/UDP ports, configure both. If you add both source and destination ports to
  a condition, you can only add ports that share a single transport protocol, TCP
  or UDP. For example, you could target traffic from port TCP/80 to port
  TCP/8080.

Source SGT Groups, Destination SGT Groups

The Security Group Tag (SGT) group objects that identify the SGTs assigned to the traffic,
as downloaded from the Identity Services Engine (ISE). You can use these
objects only if you define an ISE identity source; otherwise, this section
will not appear. For detailed information on how to use SGTs for access
control, see [How to Control Network Access Using TrustSec Security Group Tags](#id_111477).

* To match traffic whose source has one of the SGT defined in the group, configure the
  Source SGT Groups.
* To match traffic to a destination that has one of the SGT defined in the group, configure
  the Destination SGT Groups.
* If you add both source and destination SGT conditions to a rule, matching traffic must
  originate from a source with one of the specified tags and be
  destined for one of the destination tags.

#### Application Criteria

The Application
criteria of an access rule defines the application used in an IP connection, or
a filter that defines applications by type, category, tag, risk, or business
relevance. The default is any application.

Although you can
specify individual applications in the rule, application filters simplify
policy creation and administration. For example, you could create an access
control rule that identifies and blocks all high risk, low business relevance
applications. If a user attempts to use one of those applications, the session
is blocked.

In addition, Cisco
frequently updates and adds additional application detectors via system and
vulnerability database (VDB) updates. Thus, a rule blocking high risk
applications can automatically apply to new applications without you having to
update the rule manually.

You can specify
applications and filters directly in the rule, or create application filter
objects that define those characteristics. The specifications are equivalent,
although using objects can make it easier to stay within the
50-items-per-criteria system limit if you are creating a complex rule.

To modify the
application and filters list, you click the
+ button within the condition, select the desired
applications or application filter objects, which are listed on separate tabs,
and click
OK in the popup dialog box. On either tab, you can
click
Advanced
Filter to select filter criteria or to help you search for specific
applications. Click the
x for an application, filter, or object to remove it
from the policy. Click the
Save As
Filter link to save the combined criteria that is not already an
object as a new application filter object.

| **Note** | ---   If a selected application was removed by a VDB update, “(Deprecated)” appears after the application name. You must remove these applications from the filter, or subsequent deployments and system software upgrades will be blocked.   --- |
| --- | --- |

You can use the
following
Advanced
Filter criteria to identify the application or filter to match in
the rule. These are the same elements used in application filter objects.

| **Note** | ---   Multiple selections within a single filter criteria have an OR relationship. For example, Risk is High OR Very High. The relationship between filters is AND, so Risk is High OR Very High, AND Business Relevance is Low OR Very Low. As you select filters, the list of applications in the display updates to show only those that meet the criteria. You can use these filters to help you find applications that you want to add individually, or to verify that you are selecting the desired filters to add to the rule.   --- |
| --- | --- |

Risks

The likelihood
that the application is used for purposes that might be against your
organization's security policy, from very low to very high.

Business
Relevance

The likelihood
that the application is used within the context of your organization's business
operations, as opposed to recreationally, from very low to very high.

Types

The type of
application:

* Application
  Protocol—Application protocols such as HTTP and SSH, which
  represent communications between hosts.
* Client
  Protocol—Clients such as web browsers and email clients, which
  represent software running on the host.
* Web
  Application—Web applications such as MPEG video and Facebook, which
  represent the content or requested URL for HTTP traffic.

Categories

A general
classification for the application that describes its most essential function.

Tags

Additional
information about the application, similar to category.

For encrypted
traffic, the system can identify and filter traffic using only the applications
tagged
 SSL
Protocol. Applications without this tag can only be detected in
unencrypted or decrypted traffic. Also, the system assigns the
decrypted traffic tag to applications that the
system can detect in decrypted traffic only, not encrypted or unencrypted.

Applications
List (bottom of the display)

This list
updates as you select filters from the options above the list, so you can see
the applications that currently match the filter. Use this list to verify that
your filter is targeting the desired applications when you intend to add filter
criteria to the rule. If your intention is to add specific applications, select
them from this list.

#### URL Criteria

The URL criteria of an
access rule defines the URL used in a web request, or the category to which the
requested URL belongs. For category matches, you can also specify the relative
reputation of sites to allow or block. The default is to allow all URLs.

If you enable DNS lookup request filtering, the category
and reputation settings also apply to the fully-qualified domain name (FQDN) in the
lookup request. Only the category and reputation settings apply for DNS request
filtering. Manual URL filtering is ignored.

URL categories and reputations allow you to quickly create URL conditions for access control rules. For example, you could
block all Gambling sites, or untrusted Social Networking sites. If a user attempts to browse to any URL with that category and reputation combination, the session
is blocked.

Using category and
reputation data also simplifies policy creation and administration. It grants
you assurance that the system will control web traffic as expected. Finally,
because Cisco's threat intelligence is continually updated with new URLs, as
well as new categories and risks for existing URLs, you can ensure that the
system uses up-to-date information to filter requested URLs. Malicious sites
that represent security threats such as malware, spam, botnets, and phishing
may appear and disappear faster than you can update and deploy new policies.

To modify the URL
list, you click the
+ button within the condition and select the desired
categories or URLs using one of the following techniques. Click the
x for a category or object to remove it from the
policy.

URL Tab

Click
+, select URL objects or groups, and click
OK. You can click
Create
New URL if the object you require does not exist.

| **Note** | ---   Before configuring URL objects to target specific sites, carefully read the information on manual URL filtering.   --- |
| --- | --- |

Categories Tab

Click
+, select the desired categories, and click
OK.

For a description of the categories, see <https://www.talosintelligence.com/categories>.

The default is
to apply the rule to all URLs in each selected category regardless of
reputation. To limit the rule based on reputation, click the down arrow for
each category, deselect the
Any checkbox, and then use the
Reputation slider to choose the reputation level.
The left of the reputation slider indicates sites that will be allowed, the
right side are sites that will be blocked. How reputation is used depends on
the rule action:

* If the rule blocks or monitors web access, selecting a reputation level also selects all reputations more severe than that
  level. For example, if you configure a rule to block or monitor Questionable sites (level 2), it also automatically blocks or monitors Untrusted (level 1) sites.
* If the rule allows web access, selecting a reputation level also selects all reputations less severe than that level. For
  example, if you configure a rule to allow Favorable sites (level 4), it also automatically allows Trusted (level 5) sites.

Select the Include Sites with
Unknown Reputation option to have URLs with unknown
reputation included in the reputation match. New sites typically are
unrated, and there can be other reasons a site's reputation is unknown or
cannot be determined.

Check the Category for a URL

You can check on the category and reputation for a particular URL. Enter the URL in the URL to Check box and click Go. You will be taken to an external website to see the results. If you disagree with a categorization, click the Submit a URL Category Dispute link and let us know.

#### User Criteria

The User criteria of
an access rule defines the user or user group for an IP connection. You must
configure identity policies and the associated directory server to include user
or user group criteria in an access rule.

Your identity policies
determine whether user identity is collected for a particular connection. If
identity is established, the IP address of the host is associated with the
identified user. Thus, traffic whose source IP address is mapped to a user is
considered to be from that user. IP packets themselves do not include user
identity information, so this IP-address-to-user mapping is the best
approximation available.

Because you can add a
maximum of 50 users or groups to a rule, selecting groups usually makes more
sense than selecting individual users. For example, you could create a rule
allowing the Engineering group access to a development network, and create a
subsequent rule that denies all other access to the network. Then, to make the
rule apply to new engineers, you only need to add the engineer to the
Engineering group in the directory server.

You an also select identity sources to apply to all users within that source. Thus, if you support multiple Active Directory
domains, you can provide differential access to resources based on the domain.

To modify the users list, you click the + button within the condition and select the desired identities using one of the following techniques. Click the x for an identity to remove it from the policy.

* Identity Sources—Select an identity source, such as an AD realm or the local user database, to apply the rule to all users obtained from the
  selected sources. If the realm you need does not yet exist, click Create New Identity Realm and create it now.
* Groups—Select the desired user groups. Groups are available only if you configure groups in the directory server. If you select
  a group, the rule applies to any member of the group, including subgroups. If you want to treat a sub-group differently, you
  need to create a separate access rule for the sub-group and place it above the rule for the parent group in the access control
  policy.
* Users—Select individual users. The user name is prefixed with the identity source, such as Realm\username.

  There are some built-in users under the Special-Identities-Realm:

  + Failed
    Authentication—The user was prompted to authenticate, but failed to
    enter a valid username/password pair within the maximum number of allowed
    attempts. Failure to authenticate does not itself prevent the user from
    accessing the network, but you can write an access rule to limit network access
    for these users.
  + Guest—Guest users
    are like Failed Authentication users, except that your identity rule is
    configured to call these users Guest. Guest users were prompted to authenticate
    and failed to do so within the maximum number of attempts.
  + No Authentication
    Required—The user was not prompted to authentication, because the
    user's connections matched identity rules that specified no authentication.
  + Unknown—There is
    no user mapping for the IP address, and there is no record of failed
    authentication yet. Typically, this means that no HTTP traffic has yet been
    seen from that address.

#### Intrusion Policy Settings

Cisco delivers several intrusion policies with the firewall system. The several intrusion policies delivered by Cisco Cisco Talos Intelligence Group
(Talos) are designed by the Cisco.Talos set the intrusion and preprocessor rule states and advanced settings. For access control
rules that allow traffic, you can select an intrusion policy to inspect traffic for intrusions and exploits. An intrusion
policy examines decoded packets for attacks based on patterns, and can block or alter malicious traffic.

When running Snort 2, these are the only policies available and you cannot modify
them. However, you can change the
action to take for a given rule, as described in [Changing Intrusion Rule Actions (Snort 2)](fptd-fdm-intrusion.html#task_4D5DD40DDCE0426C8846E5684287E63B).

When running Snort 3, you can select one of these policies, or you can create your
own intrusion policies.

To enable intrusion inspection, select Intrusion Policy > On and select the desired policy. Click the info icon for a policy in
the drop-down list to see a description for each policy.

For more information on the pre-defined policies, see [System-Defined Network Analysis and Intrusion Policies](fptd-fdm-intrusion.html#concept_D681E8E136034A9AA863E8389C2A6C03).

#### File Policy Settings

Use file policies to detect malicious software, or *malware*, using malware defense. You can also use file policies to perform file control, which allows control over all files of a
specific type regardless of whether the files contain malware.

Malware defense uses the AMP
Cloud to retrieve dispositions for possible malware detected in network traffic, and to obtain local malware analysis and file
pre-classification updates. The management interface must have a path to the Internet to reach the AMP
Cloud and perform malware lookups. When the device detects an eligible file, it uses the file's SHA-256 hash value to query the
AMP
Cloud for the file's disposition. The possible dispositions are:

* Malware—The AMP
  Cloud categorized the file as malware. An archive file (e.g. a zip file) is marked as malware if any file within it is malware.
* Clean—The AMP
  Cloud categorized the file as clean, containing no malware. An archive file is marked as clean if all files within it are clean.
* Unknown—The AMP
  Cloud has not assigned a disposition to the file yet. An archive file is marked as unknown if any file within it is unknown.
* Unavailable—The system could not query the AMP
  Cloud to determine the file's disposition. You may see a small percentage of events with this disposition; this is expected behavior.
  If you see a number of "unavailable" events in succession, ensure that the Internet connection for the management address
  is functioning correctly.

##### Available File Policies

You can select one
of the following file policies:

* None—Do not
  evaluate transmitted files for malware and do no file-specific blocking. Select
  this option for rules where file transmissions are trusted or where they are
  unlikely (or impossible), or for rules where you are confident your application
  or URL filtering adequately protects your network.
* Block Malware All—Query the AMP
  Cloud to determine if files traversing your network contain malware, then block files that represent threats.
* Cloud Lookup All—Query the AMP
  Cloudto obtain and log the disposition of files traversing your network while still allowing their transmission.
* (Custom File Policy)—You can create your own file policies using the Firepower Threat Defense API filepolicies resource, and the other FileAndMalwarePolicies resources (such as filetypes, filetypecategories, ampcloudconfig,
  ampservers, and ampcloudconnections). After you create the policies, and deploy changes, you can select your policies when
  editing an access control rule in the FDM. The policy description appears below the policy when you select it.

#### Logging Settings

The logging settings
for an access rule determine whether connection events are issued for traffic
that matches the rule. You must enable logging to see events related to the
rule in the Event Viewer. You must also enable logging for matching traffic to
be reflected in the various dashboards you can use to monitor the system.

You should log
connections according to the security and compliance needs of your
organization. If your goal is to limit the number of events you generate and
improve performance, only enable logging for the connections critical to your
analysis. However, if you want a broad view of your network traffic for
profiling purposes, you can enable logging for additional connections.

| **Caution** | ---   Logging blocked TCP connections during a Denial of Service (DoS) attack can affect system performance and overwhelm the database with multiple similar events. Before you enable logging for a Block rule, consider whether the rule is for an Internet-facing interface or other interface vulnerable to DoS attack.   --- |
| --- | --- |

You can configure the
following logging actions.

Select Log Action

You can select
one of the following actions:

* Log at Beginning and End of
  Connection—Issue events at the start and end of a connection.
  Because end-of-connection events contain everything that start-of-connection
  events contain, plus all of the information that could be gleaned during the
  connection, Cisco recommends that you do not select this option for traffic
  that you are allowing. Logging both events can impact system performance.
  However, this is the only option allowed for blocked traffic.
* Log at End of
  Connection—Select this option if you want to enable connection
  logging at the end of the connection, which is recommended for allowed or
  trusted traffic.
* No Logging at
  Connection—Select this option to disable logging for the rule. This
  is the default.

| **Note** | ---   When an intrusion policy invoked by an access control rule detects an intrusion and generates an intrusion event, the system automatically logs the end of the connection where the intrusion occurred, regardless of the logging configuration of the rule. For connections where an intrusion was blocked, the action for the connection in the connection log is Block, with a reason of Intrusion Block, even though to perform intrusion inspection you must use an Allow rule.   --- |
| --- | --- |

File Events

Select
Log
Files if you want to enable logging of prohibited files or malware
events. You must select a file policy in the rule to configure this option. The
option is enabled by default if you select a file policy for the rule. Cisco
recommends you leave this option enabled.

When the system detects a prohibited file, it automatically logs one of the following types of event:

* *File events*, which represent detected or blocked files, including malware files.
* *Malware events*, which represent detected or blocked malware files only.
* *Retrospective malware events*, which are generated when the malware disposition for a previously detected file changes.

For connections
where a file was blocked, the action for the connection in the connection log
is
Block even though to perform file and malware
inspection you must use an Allow rule. The connection's Reason is either
File
Monitor (a file type or malware was detected), or
Malware Block or
File
Block (a file was blocked).

Send Connection
Events To

If you want to
send a copy of the events to an external syslog server, select the server
object that defines the syslog server. If the required object does not already
exist, click
Create
New Syslog Server and create it. (To disable logging to a syslog
server, select
Any from the server list.)

Because event
storage on the device is limited, sending events to an external syslog server
can provide more long term storage and enhance your event analysis.

This setting applies to connection events only. To send intrusion events to syslog, configure the server in the intrusion
policy settings. To send file/malware events to syslog, configure the server on Device > System Settings > Logging Settings.

## Monitoring Access Control Policies

The following topics explain how you can monitor the access control policy.

* [Monitoring Access Control Statistics in the Dashboards](#id_92397)
* [Examining Rule Hit Counts](#id_92394)
* [Monitoring Syslog Messages for Access Control](#id_92396)
* [Monitoring Access Control Policies in the CLI](#id_92395)

### Monitoring Access Control Statistics in the Dashboards

Most of the data on the Monitoring dashboards are directly related to your access control policy. See [Monitoring Traffic and System Dashboards](fptd-fdm-monitor.html#id_10212).

* Monitoring > Access And SI Rules shows the most-hit access rules and Security Intelligence rule-equivalents and related statistics.
* You can find general statistics on the Network Overview, Destinations, and Zones, dashboards.
* You can find URL filtering results on the URL Categories and Destinations dashboards. You must have at least one URL filtering policy to see any information on the URL Categories dashboard.
* You can find application filtering results on the Applications and Web Applications dashboards.
* You can find user-based statistics on the Users dashboard. You must implement identity policies to collect user information.
* You can find intrusion policy statistics on the Attackers and Targets dashboards. You must apply an intrusion policy to at least one access control rule to see any information on these dashboards.
* You can find file policy and malware filtering statistics on the File Logs and Malware dashboards. You must apply a file policy to at least one access control rule to see any information on these dashboards.
* Monitoring > Events also shows events for connections and data related to the access control rules.

### Examining Rule Hit Counts

You can view the hit count for each access control rule. The hit count indicates how often connections matched the rule. You
can use this information to identify your most active rules and the rules that are less active.

The count is from the last time the system
rebooted, whether from your action or from a system upgrade, or from when you reset
the hit count for a rule or all rules.

You can also see rule hit count information in the device CLI using the show rule hits  command.

#### Procedure

---

| **Step 1** | Select Policies > Access Control. |
| --- | --- |
| **Step 2** | Click the Toggle Hit Counts icon (Toggle hit counts button.).  The Hit Count column appears to the right of the Name column with the total hit count for the rule and the date and time of the last hit. The hit count information is fetched at the time you click the toggle button.  You can do the following with the hit count information:   * To the left of the button, you will see information on when the hit count was last updated. Click the refresh icon (Refresh hit count button.) to get the latest numbers. * To open a detailed view of the hit count for a given rule, click the hit count number in the table to open the Hit Count dialog   box. The hit count information includes the number of hits and the date and time of the last connection that matched the rule.   Click the Reset link to reset the counter to zero.  If you want to reset the hit count for all rules at once, open an SSH session to the device and issue the clear rule hits  command. * Click the Toggle Hit Counts icon (Toggle hit counts button.) again to remove the hit count column from the table. |

---

### Monitoring Syslog Messages for Access Control

In addition to seeing events in the Event Viewer, you can configure access control rules, intrusion policies, file/malware policies, and Security Intelligence policies to send events to a syslog server. The events use the following message IDs:

* 430001—Intrusion event.
* 430002—Connection event logged at the beginning of a connection.
* 430003—Connection event logged at the end of a connection.
* 430004—File events.
* 430005—Malware events.

### Monitoring Access Control Policies in the CLI

You can also open the CLI console or log into the device CLI and use the following commands to get more detailed information about access control policies and
statistics.

* show access-control-config  displays summary information about the access control rules along with per-rule hit counts.
* show access-list  displays the access control lists (ACLs) that were generated from the access control rules. The ACLs provide an initial filter
  and attempt to provide quick decisions whenever possible, so that connections that should be dropped do not need to be inspected
  (and thus consume resources unnecessarily). This information includes hit counts.
* show rule hits displays consolidated hit counts that are more accurate than the counts shown with show access-control-config and show access-list. If you want to reset the hit count, use the clear rule hits command.
* show snort statistics  displays information about the Snort inspection engine, which is the main inspector. Snort implements application filtering,
  URL filtering, intrusion protection, and file and malware filtering.
* show conn  displays information about the connections currently established through the interfaces.
* show traffic  displays statistics about traffic flowing through each interface.
* show ipv6 traffic  displays statistics about IPv6 traffic flowing through the device.

## Examples for Access Control

The use case chapter
includes several examples of implementing access control rules. Please see the
following examples:

* [How to Gain Insight Into Your Network Traffic](fptd-fdm-use-cases.html#id_24907).
  This example shows some basic ideas for collecting overall connection and user
  information.
* [How to Block Threats](fptd-fdm-use-cases.html#id_25314).
  This example shows how to apply intrusion policies.
* [How to Block Malware](fptd-fdm-use-cases.html#id_25847).
  This example shows how to apply file policies.
* [How to Implement an Acceptable Use Policy (URL Filtering)](fptd-fdm-use-cases.html#id_25892).
  This example shows how to perform URL filtering.
* [How to Control Application Usage](fptd-fdm-use-cases.html#id_26357).
  This example shows how to perform application filtering.
* [How to Add a Subnet](fptd-fdm-use-cases.html#id_26565).
  This example shows how to integrate a new subnet into your overall network,
  including the access rules needed to allow traffic flow.
* [How to Passively Monitor the Traffic on a Network](fptd-fdm-use-cases.html#task_B9870E6741394745B05165E6BB008F23)

Following are additional examples.

* [How to Control Network Access Using TrustSec Security Group Tags](#id_111477)

### How to Control Network Access Using TrustSec Security Group Tags

If you use Cisco Identity Services Engine (ISE) to define and use security group tags (SGT) for classifying traffic in a Cisco
TrustSec network, you can write access control rules that use SGT as matching criteria. Thus, you can block or allow access
based on security group membership rather than IP addresses directly.

* [About Security Group Tags (SGT)](#id_111478)
* [Configure Access Control Based on Security Group Tag (SGT)](#Cisco_Task_in_List_GUI.dita_96d60f09-ac6d-4d6a-b99d-2c014e0a7927)

#### About Security Group Tags (SGT)

In Cisco Identity Services Engine (ISE), you can create security group tags (SGT) and assign host or network IP addresses
to each tag. You can also assign SGTs to user accounts, and the SGT is assigned to the user's traffic. If the switches and
routers in the network are configured to do so, these tags then get assigned to packets as they enter the network controlled
by ISE, the Cisco TrustSec cloud.

When you configure an ISE identity source in the FDM, the Firepower Threat Defense system automatically downloads the list of SGTs from ISE. You can then use SGT as a traffic matching condition in access
control rules.

For example, you could create a Production Users tag, and associate the 192.168.7.0/24 network to the tag. This would be appropriate
if you use that network for user end points, such as laptops, Wi-Fi clients, and so forth. You could create a separate tag
for Production Servers, and assign the IP addresses of the relevant servers or subnet to the tag. Then, in the Firepower Threat Defense, you could allow or block access from the user network to the production servers based on the tag. If you later alter the
host or network addresses associated with the tag in ISE, you do not need to change the access control rule defined for the
Firepower Threat Defense device.

When the Firepower Threat Defense evaluates SGT as a traffic matching criteria for an access control rule, it uses the following priority:

1. The source SGT tag defined in the packet, if any. For the SGT tag to be in the
   packet, the switches and routers in the network must be configured to add them.
   See the ISE documentation for information on how to implement this method.
2. The SGT assigned to the user session, as downloaded from the ISE session directory. You need to enable the option to listen
   to session directory information for this kind of SGT matching, but this option is on by default when you first create the
   ISE identity source. The SGT can be matched to source or destination. Although not required, you would also normally set up
   a passive authentication identity rule, using the ISE identity source along with an AD realm, to collect user identity information.
3. The SGT-to-IP address mapping downloaded using SXP. If the IP address is within the range for an SGT, then the traffic matches
   the access control rule that uses the SGT. The SGT can be matched to source or destination.

   ISE uses the Security-group eXchange Protocol (SXP) to propagate the IP-to-SGT mapping database to network devices. When you
   configure the Firepower Threat Defense device to use an ISE server, you must turn on the option to listen to the SXP topic from ISE. Thus, the Firepower Threat Defense device learns about the security group tags and mappings directly from ISE, and is notified whenever ISE publishes updated
   security group tags and mappings. This ensures that the list of security group tags and mappings stay up-to-date on the device,
   so that the Firepower Threat Defense can effectively enforce the policy defined in ISE.

#### Configure Access Control Based on Security Group Tag (SGT)

To configure access control rules that use security group tags (SGT) as matching
criteria, you must first configure the device to obtain the SGT mappings from an ISE
server.

The following procedure explains the end-to-end process based on the assumption that
you want to get all mappings that are defined in ISE, including SGT-to-IP address
mappings published through SXP. Alternatively:

* If you want to use SGT information in the packets only, and not use mappings
  downloaded from ISE, simply create SGT group dynamic objects and use them as
  source SGT criteria in access control rules. Note that in this case, you can
  use SGT tags as a source condition only; these tags will never match
  destination criteria.
* If you want to use SGT in packets plus user session SGT mappings only, you do
  not need to turn on the option to subscribe to the SXP topic in the ISE
  identity source, nor do you need to configure ISE to publish SXP mappings.
  You can use this information for both source and destination matching
  conditions.

##### Before you begin

The assumption here is that you have already configured Cisco TrustSec in your
network, and you are simply adding the Firepower Threat Defense device as a policy enforcement point. If you have not deployed Cisco TrustSec,
please start with ISE and configure your network, then return to this procedure.
Explaining Cisco TrustSec is outside the scope of this document.

##### Procedure

---

| **Step 1** | Ensure that SGTs are defined, that ISE is configured correctly to publish the SXP topic, and that any needed static mappings are in place.  See [Configure Security Groups and SXP Publishing in ISE](#id_111604). |
| --- | --- |
| **Step 2** | Update the Identity Services Engine object to listen to the SXP topic.  You can use ISE to obtain user session SGT mappings, static SGT-to-IP address mappings through SXP, or both. By default, when you configure the ISE identity source, it obtains user session mappings only; you must turn on the option to listen to the SXP topic from ISE.   1. Choose Objects > Identity Sources. 2. Edit the ISE object. If you have not configured one yet, click + > Identity Services Engine and see [Configure Identity Services Engine](fptd-fdm-identity-sources.html#id_71555). 3. Under Subscribe To, select SXP    Topic.  Ensure that Session Directory Topic is also    selected if you are using passive authentication or want user-to-SGT    mappings.     Subscribe to ISE SXP topic. 4. Click OK. |
| **Step 3** | Deploy your changes and wait for the system to download tags and mappings from ISE.  After you configure the ISE identity source and deploy changes, the system retrieves security group tag (SGT) information from the ISE server. The download will not happen until after you deploy changes. |
| **Step 4** | Create the SGT group objects that are required for your access control rules.  You cannot use the information retrieved from ISE directly in an access control rule. Instead, you need to create SGT groups, which refer to the downloaded SGT information. Your SGT groups can refer to more than one SGT, so you can apply policy based on relevant collections of tags if that is appropriate.  The number and contents of the objects depend on the access control rules that you intend to write. Repeat the following process to create all the objects that you need.   1. Choose Objects > SGT Groups. 2. Click + to add a new object, or edit an existing    object. 3. For new objects, enter a name and optionally a description. 4. Under Tags, click + and    select all the tags that should be included in the group.     SGT group dynamic object. 5. Click OK. |
| **Step 5** | Create access control rules that use the SGT group objects.  As an example, the following rule allows traffic from production users to production servers. The rule depends completely on SGT; it is not limited by source/destination interface or any other criteria. Thus, the rule will dynamically apply to traffic as it comes from different interfaces, and as you change security group membership in ISE. If the packet does not explicitly contain a source SGT, source/destination matching will be based on the packet IP addresses compared to the SGT-to-IP address mappings obtained from user session information or from SXP-published mappings.   1. Choose Policies > Access Control. 2. Click + to create a new rule, or edit an    existing rule. 3. Enter a rule name and select Allow as the    action. 4. On the Source/Destination tab, click    + under Source > SGT Groups and select the object you created for production    users. 5. On the Source/Destination tab, click    + under Destination > SGT Groups, and select the object you created for production    servers. 6. Configure other options as needed. For example, you can enable logging    and apply an intrusion policy. 7. Click OK. |
| **Step 6** | Deploy the configuration. |

---

* [Configure Security Groups and SXP Publishing in ISE](#id_111604)

##### Configure Security Groups and SXP Publishing in ISE

There is a lot of configuration that you must do in Cisco Identity Services Engine (ISE) to create the TrustSec policy and
security group tags (SGT). Please look at the ISE documentation for more complete information on implementing TrustSec.

The following procedure picks out the highlights of the core settings you must configure in ISE for the Firepower Threat Defense device to be able to download and apply static SGT-to-IP address mappings, which can then be used for source and destination
SGT matching in access control rules. See the ISE documentation for detailed information.

The screen shots in this procedure are based on ISE 2.4. The exact paths to these
features might change in subsequent releases, but the concepts and requirements will
be the same. Although ISE 2.4 or later is recommended, and preferably 2.6 or later,
the configuration should work starting with ISE 2.2 patch 1.

###### Before you begin

You must have the ISE Plus license to publish SGT-to-IP address static mappings and
to get user session-to-SGT mappings so that the Firepower Threat Defense device can receive them.

###### Procedure

---

| **Step 1** | Choose Work Centers > TrustSec > Settings > SXP Settings, and select the Publish SXP Bindings on PxGrid option.  This option makes ISE send the SGT mappings out using SXP. You must select this option for the FTD device to “hear” anything from listing to the SXP topic. This option must be selected for the FTD device to get static SGT-to-IP address mapping information. It is not necessary if you simply want to use SGT tags defined in the packets, or SGTs that are assigned to a user session. Turn on Publish SXP Bindings on PxGrid option in ISE. |
| --- | --- |
| **Step 2** | Choose Work Centers > TrustSec > SXP > SXP Devices, and add a device.  This does not have to be a real device, you can even use the management IP address of the Firepower Threat Defense device. The table simply needs at least one device to induce ISE to publish the static SGT-to-IP address mappings. This step is not necessary if you simply want to use SGT tags defined in the packets, or SGTs that are assigned to a user session. Add an SXP device in ISE. |
| **Step 3** | Choose Work Centers > TrustSec > Components > Security Groups and verify there are security group tags defined. Create new ones as necessary.  Configure security group tags (SGT) in ISE. |
| **Step 4** | Choose Work Centers > TrustSec > Components > IP SGT Static Mapping and map host and network IP addresses to the security group tags.  This step is not necessary if you simply want to use SGT tags defined in the packets, or SGTs that are assigned to a user session. Configure IP to SGT static mappings in ISE. |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_0cc32026_20250115_120509.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Cisco Secure Firewall Management Center Device Configuration Guide, 7.2

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Getting Started with Device Configuration
  + [Device Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-device-management.html)
  + [Users](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-logical-devices.html)
  + [High Availability](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/high-availability.html)
  + [Clustering for the Secure Firewall 3100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-sec-fw-3100.html)
  + [Clustering for Threat Defense Virtual in a
    Private Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-private.html)
  + [Clustering for Threat Defense Virtual in a
    Public Cloud](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-ftdv-public.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-firewall.html)
  + [Inline Sets and Passive Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000/2100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ecmp.html)
  + [OSPF](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-ospf.html)
  + [EIGRP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-eigrp.html)
  + [BGP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/objects-certs.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/vpn-monitoring.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-rules.html)
  + [URL Filtering](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-service-policies.html)
  + [Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-detection.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-content-restriction.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/network-malware-protection.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-overview.html)
  + [SSL Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html)
  + [TLS/SSL
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rules.html)
  + [TLS/SSL
    Rules and Policy Example](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-rule-examples.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-realms.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-captive-portal.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-access-control.html)
  + [Getting Started with
    Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-get-start.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/advanced-nap-adaptive-profiles.html)
* Threat Intelligence Director
  + [Secure Firewall Threat Intelligence Director](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/threat-intelligence-director.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Secure Firewall Management Center Device Configuration Guide, 7.2 Chapter Title Configuration Deployment

* [PDF - Complete Book
  (78.84 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72.pdf)
  [PDF - This Chapter (1.94 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: June 6, 2022

## Chapter: Configuration Deployment

Chapter Contents

* [Configuration Deployment](#topic_FD4270BD3512464AA509D2800FDE8D22)
* [About Configuration Deployment](#concept_FCCCA9931A4642DBB443FF0BD0D10DDB)
  + [Configuration Changes that Require Deployment](#ID-2176-0000043a)
  + [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825)
  + [Selective Policy Deployment](#select_pol_dep_1)
  + [System Username](#system-username)
  + [Auto-Enabling of Application Detectors](#auto-enabling-application-detectors)
  + [Asset Rediscovery with Network Discovery Policy Changes](#asset-rediscovery-with-network-discovery-policy-changes)
  + [Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)
    - [Restart Warnings for Devices](#id_65425)
    - [Inspect Traffic During Policy Apply](#id_55284)
    - [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty)
    - [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7)
    - [Changes that Immediately Restart the Snort Process](#reference_ymy_2n3_my)

- [Requirements and Prerequisites for Policy Management](#Cisco_Reference.dita_4f92cfc6-e127-4228-93ad-1028a57fdf33)
- [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d)
- [Deploy the Configuration](#concept_0CD8A576FD584C70BD305190E5125B14)
  * [Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B)
  * [Redeploy Existing Configurations to a Device](#task_5BD82554DC514472B7FD37B149B8D280)
- [Manage Deployments](#concept_EFE7C694C0824988BC477ACDB692A5E0)
  * [View Deployment Status](#dep_status_estimate_1)
  * [View Deployment History](#task_view_dep_hist)
    + [Set the Number of Configuration Versions](#configuration_version_setting)
  * [Roll Back a Deployment](#concept_f4c_ptb_dwb)
    + [Perform a Rollback](#rollback_task)
    + [View the Deployment Rollback Transcript](#view_rollback_transcript)
  * [Download Policy Changes Report for Multiple Devices](#download-policy-changes-report-for-multiple-devices)
  * [Compare Policies](#task_ABA1FE48DBBB44BC9FF40243FCC58BF6)
  * [Generate Current Policy Reports](#task_CCED983433824793AF09203FDAD1AF53)
- [History for Configuration Deployment](#his-pol-man)
Close

# Configuration Deployment

This chapter describes how to download configuration changes to one or more managed devices.

* [About Configuration Deployment](#concept_FCCCA9931A4642DBB443FF0BD0D10DDB)
* [Requirements and Prerequisites for Policy Management](#Cisco_Reference.dita_4f92cfc6-e127-4228-93ad-1028a57fdf33)
* [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d)
* [Deploy the Configuration](#concept_0CD8A576FD584C70BD305190E5125B14)
* [Manage Deployments](#concept_EFE7C694C0824988BC477ACDB692A5E0)
* [History for Configuration Deployment](#his-pol-man)

## About Configuration Deployment

All device configuration is managed by the management center and then deployed to the managed devices.

* [Configuration Changes that Require Deployment](#ID-2176-0000043a)
* [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825)
* [Selective Policy Deployment](#select_pol_dep_1)
* [System Username](#system-username)
* [Auto-Enabling of Application Detectors](#auto-enabling-application-detectors)
* [Asset Rediscovery with Network Discovery Policy Changes](#asset-rediscovery-with-network-discovery-policy-changes)
* [Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

### Configuration Changes that Require Deployment

The system marks out-of-date policies with red status text that indicates how many of
its targeted devices need a policy update. To clear this status, you must re-deploy
the policy to the devices.

#### Deployment Required

Configuration changes that require a deployment include:

* Modifying an access control policy: any changes to
  access control rules, the default action, policy targets, Security
  Intelligence filtering, advanced options including preprocessing, and so on.
* Modifying any of the policies that the access control
  policy invokes: the SSL policy, network analysis policies, intrusion
  policies, file policies, identity policies, or DNS policies.
* Changing any reusable object or configuration used in
  an access control policy or policies it invokes:

  + network, port, VLAN tag, URL, and geolocation objects
  + Security Intelligence lists and feeds
  + application filters or detectors
  + intrusion policy variable sets
  + file lists
  + decryption-related objects and security zones
* Updating the system software, intrusion rules, or the
  vulnerability database (VDB).

Keep in mind that you can change some of these configurations
from multiple places in the web interface. For example, you can modify security
zones using the object manager (Objects > Object Management), but modifying an interface type in a device’s configuration (Devices > Device Management) can also change a zone and require a deployment.

#### Deployment Not Required

Note that the following updates do **not** require a deployment:

* automatic updates to Security Intelligence feeds and
  additions to the Security Intelligence global Block or Do Not Block list
  using the context menu
* automatic updates to URL filtering data
* scheduled geolocation database (GeoDB) updates

### Deployment Preview

Preview provides a snapshot of all the policy and object changes to be deployed on
the device. The policy changes include the new policies, changes in the existing
policies, and the deleted policies. The object changes include the added and
modified objects which are used in policies. The unused object changes are not
displayed because they are not deployed on the device.

The preview shows all the default values, even when they are not altered, along with
the other configured settings when an interface or a platform settings policy is
added for the first time. Similarly, the high availability-related policies and
default values for settings are shown, even when they are not altered, in the first
preview after a high availability pair is configured or disrupted.

To view changes due to an auto rollback, see [Edit Deployment Settings](get-started-device-management.html#Cisco_Task.dita_64c08939-55e7-458f-ab11-01f32685fcf1).

#### Unsupported Features

* Object additions and attribute changes are displayed in the preview only if
  the objects are associated with any device or interface. Object deletions
  are not displayed.
* Preview is not supported for the following policies:

  + High availability
  + Network discovery
  + Network analysis
  + Device settings
* User information at the rule level is not available for intrusion
  policies.
* The preview does not show the reordering of rules across policies.

  For DNS policies, reordered rules
  appear in the preview list as rule additions and deletions. For example,
  moving a rule from position 1 to position 3 in the rule order is displayed
  as if the rule was deleted from position 1 and added as a new rule in
  position 3. Similarly, when a rule is deleted, the rules under it are listed
  as edited rules as they have changed their positions. The changes are
  displayed in the final order in which they appear in the policy.
* Preview is not supported in the following HA scenarios:

  + If a device was in standalone mode and if a chain is made, then an
    auto-deployment is triggered. For that particular job, preview is
    not supported. On hover over the Preview (![preview icon](/c/dam/en/us/td/i/400001-500000/440001-450000/448001-449000/448387.jpg)), a message is displayed that it is a HA bootstrap deployment, and
    no preview is supported.
  + Configuration groups - Consider a flow in which a device was initially standalone. Subsequently, three deployments took place. In the fourth deployment,
    the device was a HA bootstrap deployment. After these, the user deploys devices 5, 6, and 7. The deployment 7 is an HA break
    deployment, and the user deploys devices 8, 9, and 10.

    In this flow, the preview between 3 and 5 is not supported because 4
    was a HA deployment. Similarly, the preview between 8 and 3 is also
    not supported. Preview is supported only from 3 to 1, 7,6, 5, 4, and
    10, 9, and 8.
  + If a device is broken (HA is broken) then the new device is
    considered as a fresh device.

### Selective Policy Deployment

The management center allows you to select a specific policy within the list of all the changes on the
device that are due for deployment and deploy only the selected policy. Selective
deployment is available only for the following policies:

* Access control policies
* Intrusion policies
* Malware and file policies
* DNS policies
* Identity policies
* SSL policies
* QoS policies
* Prefilter policies
* Network discovery
* NAT policies
* Routing policies
* VPN policies

There are certain limitations to selectively deploying policies. Follow the contents in the table below to understand when
selective policy deployment can be used.

Table 1. Limitations for Selective Deployment

| Type | Description | Scenarios |
| --- | --- | --- |
| Full deployment | Full deployment is necessary for specific deploy scenarios, and the management center does not support selective deployment in such scenarios. If you encounter an error in such scenarios, you may choose to proceed by selecting all the changes for deployment on the device. | Scenarios wherein a full deployment is required are:   * The first deployment after you have upgraded the threat   defense or the management center. * The first deployment after you have restored the threat   defense. * The first deployment after modifications in the threat   defense interface settings. * The first deployment after modifications in the virtual   router settings. * When the threat   defense device is moved to a new domain (global to sub-domain or   sub-domain to global). |
| Associated policy deployment | The management center identifies interdependent policies which are interlinked. When one of the interlinked policies is selected, the remaining interlinked policies are automatically selected. | Scenarios wherein an associated policy is automatically selected:   * When a new object is associated with an existing policy. * When an existing policy's object is modified.   Scenarios wherein multiple policies are automatically selected:   * When a new object is associated with an existing policy, and   the same object is already associated with other policies,   all the associated policies are automatically selected. * When a shared object is modified, all the associated policies   are automatically selected. |
| Interdependent policy changes (shown using color-coded tags) | The management center dynamically detects dependencies in-between policies, and between the shared objects and the policies. The interdependency of the objects or policies is shown using color-coded tags. | Scenarios wherein color-coded interdependent policies or objects are automatically selected:   * When all the out-of-date policies have interdependent   changes.  For example, when an access control policy, an intrusion   policy, and a NAT policy are out-of-date. Since access   control policy and NAT policy share an object, all policies   are selected together for deployment. * When all out-of-date policies share an object, and the object   is modified. |
| Access Policy Group specifications | Access Policy Group policies are listed together in the preview window under Access Policy Group when you click Show or Hide Policy  (Show or Hide Policy icon). | The scenarios and the expected behavior for Access Policy Group policies are:   * If the access control policy is out-of-date, all other   out-of-date policies under this group, except file policy   and intrusion policy, are selected when the access control   policy is selected for deployment.  However, if the access control policy is out-of-date,   intrusion and file policies can be individually selected or   deselected irrespective of whether the access control policy   is selected or not, unless there are any dependent changes.   For example, if a new intrusion policy is assigned to an   access control rule, it indicates that there are dependent   changes, then both the access control policy and the   intrusion policy will be automatically selected when either   of them is selected. * If no access control policy is out-of-date, other out-of-date   policies in this group can be selected and deployed   individually. |

### System Username

The management center displays the username as system for the following
operations:

* Rollback
* Upgrade
* Threat Defense backup and restore
* SRU update
* LSP update
* VDB update

### Auto-Enabling of Application Detectors

If you are performing application control but disable required detectors, the system
automatically enables the appropriate system-provided detectors upon policy deploy. If
none exist, the system enables the most recently modified user-defined detector for the
application.

### Asset Rediscovery with Network Discovery Policy Changes

When you deploy changes to a network discovery policy, the system deletes and then
rediscovers MAC address, TTL, and hops information from the network map for the hosts in
your monitored networks. Also, the affected managed devices discard any discovery data
that has not yet been sent to the management center.

### Snort Restart Scenarios

When the traffic inspection engine referred to as *the Snort process* on a managed device restarts, inspection is interrupted until the process resumes. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles
traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) for more information. Additionally, resource demands may result in a small number of packets dropping without inspection when you deploy, regardless
of whether the Snort process restarts.

Any of the scenarios in the following table cause the Snort process to restart.

Table 2. Snort Restart Scenarios

| Restart Scenario | More Information |
| --- | --- |
| Deploying a specific configuration that requires the Snort process to restart. | [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7) |
| Modifying a configuration that immediately restarts the Snort process. | [Changes that Immediately Restart the Snort Process](#reference_ymy_2n3_my) |
| Traffic-activation of the currently deployed Automatic Application Bypass (AAB) configuration. | [Configure Automatic Application Bypass](get-started-device-management.html#ID-2242-00000f1f) |
| Enabling or disabling "Logging connection events to RAM disk" feature. | See the section **Log to Ramdisk** in [Troubleshoot Drain of FMC Unprocessed Events](https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/216081-troubleshoot-drain-of-fmc-unprocessed-ev.html). |

* [Restart Warnings for Devices](#id_65425)
* [Inspect Traffic During Policy Apply](#id_55284)
* [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty)
* [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7)
* [Changes that Immediately Restart the Snort Process](#reference_ymy_2n3_my)

**Related References**
[Access Control Policy Advanced Settings](access-policies.html#ID-2176-00000314)
[Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7)

#### Restart Warnings for Devices

When you deploy, the Inspect Interruption column in the deploy
page specifies whether a deployed configuration restarts the Snort process on the threat
defense device. When the traffic inspection engine referred to as *the Snort process*
restarts, inspection is interrupted until the process resumes. Whether traffic is
interrupted or passes without inspection during the interruption depends on how the
device handles traffic. Note that you can proceed with the deployment, cancel the
deployment and modify the configuration, or delay the deployment until a time when
deploying would have the least impact on your network.

When the Inspect Interruption column indicates
Yes and you expand the device configuration listing, the
system indicates any specific configuration type that would restart the Snort process
with an Inspect
Interruption (![inspect interruption icon](/c/dam/en/us/td/i/400001-500000/440001-450000/447001-448000/447700.jpg)). When you hover your mouse over the icon, a message informs you that deploying the
configuration may interrupt traffic.

The following table summarizes how the deploy page displays inspection interruption warnings.

Table 3. Inspection Interruption Indicators

| Type | Inspect Interruption | Description |
| --- | --- | --- |
| Threat Defense | Inspect Interruption (inspect interruption icon)Yes | At least one configuration would interrupt inspection on the device if deployed, and might interrupt traffic depending on how the device handles traffic. You can expand the device configuration listing for more information. |
| -- | Deployed configurations will not interrupt traffic on the device. |
| Undetermined | The system cannot determine if a deployed configuration may interrupt traffic on the device.  Undetermined status is displayed before the first deployment after a software upgrade, or in some cases during a Support call. |
| Errors (error icon) | The system cannot determine the status due to an internal error.  Cancel the operation and click Deploy again to allow the system to redetermine the Inspect Interruption status. If the problem persists, contact Support. |
| sensor | -- | The device identified as *sensor* is not the threat defense device; the system does not determine if a deployed configuration may interrupt traffic on this device. |

For information on all configurations that restart the Snort process for all device types, see [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).

#### Inspect Traffic During Policy Apply

Inspect traffic during policy apply is an advanced access control policy general setting that allows managed devices to inspect traffic while deploying configuration
changes; this is the case unless a configuration that you deploy requires the Snort process to restart. You can configure
this option as follows:

* Enabled — Traffic is inspected during the deployment unless certain configurations require the Snort process to restart.

  When the configurations you deploy do not require a Snort restart, the system initially uses the currently deployed access
  control policy to inspect traffic, and switches during deployment to the access control policy you are deploying.
* Disabled — Traffic is not inspected during the deployment. The Snort process always restarts when you deploy.

The following graphic illustrates how Snort restarts can occur when you enable or disable Inspect traffic during policy apply.

![](/c/dam/en/us/td/i/400001-500000/400001-410000/407001-408000/407766.jpg)

| **Caution** | ---   When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).   --- |
| --- | --- |

#### Snort Restart Traffic Behavior

The following tables explain how different devices handle traffic when the Snort process restarts.

Table 4. The Threat Defense and the Threat Defense Virtual Restart Traffic Effects

| Interface Configuration | Restart Traffic Behavior |
| --- | --- |
| inline: Snort Fail Open: Down: disabled | dropped |
| inline: Snort Fail Open: Down: enabled | passed without inspection  Some packets can be delayed in buffer for several seconds before the system recognizes that Snort is down. This delay can vary depending upon the load distribution. However, the buffered packets are eventually passed. |
| routed, transparent (including EtherChannel, redundant, subinterface): preserve-connection  enabled (configure snort preserve-connection enable ; default)  For more information, see [Cisco Secure Firewall Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense.html). | existing TCP/UDP flows: passed without inspection so long as at least one packet arrives while Snort is down  new TCP/UDP flows and all non-TCP/UDP flows: dropped  Note that the following traffic drops even when preserve-connection  is enabled:   * plaintext, passthrough prefilter tunnel traffic that   matches an Analyze rule action or an   Analyze all tunnel traffic    default policy action * connections that do not match an access control rule and   are instead handled by the default action. * decrypted TLS/SSL traffic * a safe search flow * a captive portal flow |
| routed, transparent (including EtherChannel, redundant, subinterface): preserve-connection  disabled (configure snort preserve-connection disable ) | dropped |
| inline: tap mode | egress packet immediately, copy bypasses Snort |
| passive | uninterrupted, not inspected |

| **Note** | ---  In addition to traffic handling when the Snort process is down while it restarts, traffic can also pass without inspection or drop when the Snort process is busy, depending on the configuration of the Snort Fail Open Busy option (see [Configure an Inline Set](interfaces-settings-ifcs-ips.html#task_0E963BC661AA45AF8E7E123430EAA1C4)). A device supports either the Failsafe option or the Snort Fail Open option, but not both.  --- |
| --- | --- |

| **Note** | ---  When the Snort process is busy but not down during configuration deployment, some packets may drop on routed, switched, or transparent interfaces if the total CPU load exceeds 60 percent.  --- |
| --- | --- |

| **Warning** | ---  Do not reboot the system while the Snort Rule Update is in progress.  --- |
| --- | --- |

Snort-busy drops happen when snort is not able to process the packets fast enough. Lina does not know whether Snort is busy
due to processing delay, or if is stuck or due to call blocking. When transmission queue is full, snort-busy drops occur.
Based on Transmission queue utilization, Lina will try to access if the queue is being serviced smoothly.

#### Configurations that Restart the Snort Process When Deployed or Activated

Deploying any of the following configurations except AAB restarts the Snort process as described. Deploying AAB does not cause
a restart, but excessive packet latency activates the currently deployed AAB configuration, causing a partial restart of the
Snort process.

##### Access Control Policy Advanced Settings

* Deploy when Inspect Traffic During Policy Apply is disabled.
* Add or remove an SSL policy.

##### File Policy

Deploy the first or last of any one of the following configurations; note that while otherwise
deploying these file policy configurations does not cause a restart, deploying
non-file-policy configurations can cause restarts.

* Take either of the following actions:

  + Enable or disable Inspect Archives when the deployed access control policy includes at least one file policy.
  + Add the first or remove the last file policy rule when Inspect Archives is enabled (note that at least one rule is required for Inspect Archives to be meaningful).
* Enable or disable Store files in a Detect Files or Block Files rule.
* Add the first or remove the last active file rule that combines the Malware Cloud Lookup or Block Malware rule action with an analysis option (Spero Analysis or MSEXE, Dynamic Analysis, or Local Malware Analysis) or a store files option (Malware,
  Unknown, Clean, or Custom).

Note that access control rules that deploy these file policy configurations to security zones or tunnel zones cause a restart
only when your configuration meets the following conditions:

* Source or destination security zones in your access control rule must match the security zones associated with interfaces
  on the target devices.
* Unless the destination zone in you access control rule is *any*, a source tunnel zone in the rule must match a tunnel zone assigned to a tunnel rule in the prefilter policy.

##### Identity Policy

* When SSL decryption is disabled (that is, when the access control policy does not include an SSL policy), add the first or
  remove the last active authentication rule.

  An active authentication rule has either an Active Authentication
  rule action, or a Passive Authentication rule action
  with Use active authentication if passive or VPN identity cannot
  be established selected.

##### Network Discovery

* Enable or disable non-authoritative, traffic-based user detection over the HTTP, FTP, or MDNS protocols, using the network
  discovery policy.

##### Device Management

* MTU: Change the highest MTU value among all non-management interfaces on a device.
* Automatic Application Bypass (AAB): The currently deployed AAB configuration activates when a malfunction of the Snort process
  or a device misconfiguration causes a single packet to use an excessive amount of processing time. The result is a partial
  restart of the Snort process to alleviate extremely high latency or prevent a complete traffic stall. This partial restart
  causes a few packets to pass without inspection, or drop, depending on how the device handles traffic.

##### Updates

* System update: Deploy configurations the first time after a software update that includes a new version of the Snort binary
  or data acquisition library (DAQ).
* VDB: For managed devices running Snort 2, deploying configurations the first time after installing a vulnerability database
  (VDB) update that includes changes applicable to managed devices will require a detection engine restart and may result in
  a temporary traffic interruption. For these, a message warns you when you select the management center to begin installing. The deploy dialog provides additional warnings for the threat
  defense devices when VDB changes are pending. VDB updates that apply only to the management center do not cause detection engine restarts, and you cannot deploy them.

  For managed devices running Snort 3, deploying configurations the first time after installing a vulnerability database (VDB)
  update may temporarily interrupt application detection, but there will be no traffic interruptions.

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

**Related Tasks**
[Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B)

#### Changes that Immediately Restart the Snort Process

The following changes immediately restart the Snort process without going through the deploy process. How the restart affects traffic depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) for more information.

* Take any of the following actions involving applications or application detectors:

  + Activate or deactivate a system or custom application detector.
  + Delete an activated custom detector.
  + Save and Reactivate an activated custom detector.
  + Create a user-defined application.

  A message warns you that continuing
  restarts the Snort process, and allows you to
  cancel; the restart occurs on any managed device
  in the current domain or in any of its child
  domains.
* Create or break a threat
  defense high availability pair.

  A message warns you that continuing to create a
  high availability pair restarts the Snort process
  on the primary and secondary devices and allows
  you to cancel.

## Requirements and Prerequisites for Policy Management

### Model Support

Any.

### Supported Domains

Any

### User Roles

* Admin
* Network Admin
* Security Approver

## Best Practices for Deploying Configuration Changes

The following are guidelines for deploying configuration changes.

### Reliable Management Connection

The management connection between the management center and the device is a secure, TLS-1.3-encrypted communication channel between
itself and the device.

You do not need to run this traffic over an additional encrypted tunnel such as
Site-to-Site VPN for security purposes. If the VPN goes down, for example, you will
lose your management connection, so we recommend a simple management path.

| **Caution** | ---   We recommend against a device's management connection going through a VPN tunnel that terminates on the device itself. If you deploy a configuration change that causes the VPN to go down, the management connection will be disconnected and you will not have any way to recover the configuration without connecting directly to the device.  If management traffic exits a VPN-terminating interface, be sure to exclude the management traffic from the VPN tunnel.   --- |
| --- | --- |

### Maximum Concurrent Deployments

You should not deploy to more than 25% of the maximum devices allowed for a management center in the same job. For example, for the FMCv300, the maximum job size should be 75
devices (25% of 300). Concurrent deployment to more devices can cause performance
issues.

### Deployment of Shared Policies

For best performance, deploy to devices that use the same policies. Create separate
deployment jobs for each group of devices that share policies.

### Time to Deploy and Memory Limitations

The time it takes to deploy depends on multiple factors, including (but not limited to):

* The configurations you send to the device. For example, if you dramatically increase the
  number of Security Intelligence entries you block, deployment can take
  longer.
* Device model and memory. On lower-memory devices, deploying can take longer.

Do not exceed the capability of your devices. If you exceed the maximum number of rules or policies supported by a target
device, the system displays a warning. The maximum depends on a number of factors—not only memory and the number of processors
on the device, but also on policy and rule complexity. For information on optimizing policies and rules, see [Best Practices for Access Control Rules](access-overview.html#ID-2176-000005b6).

### Use a Maintenance Window to Lessen the Impact of Traffic Interruptions

We *strongly* recommend you deploy in a maintenance window or at a time when
interruptions will have the least impact.

When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying
some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption
or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).

For the threat
defense devices, the Inspect Interruption column in the Deploy
dialog warns you when deploying might interrupt traffic flow or inspection. You can
either proceed with, cancel, or delay deployment; see [Restart Warnings for Devices](#id_65425) for more information.

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

## Deploy the Configuration

After you configure your deployment, and any time you change that configuration, you must deploy the changes to affected devices.
You can view deployment status in the Message Center.

Deploying updates the following components:

* Device and interface configurations
* Device-related policies: NAT, VPN, QoS, platform settings
* Access control and related policies: DNS, file, identity, intrusion, network analysis, prefilter, SSL
* Network discovery policy
* Intrusion rule
  updates
* Configurations and objects associated with any of these elements

You can configure the system to deploy automatically by scheduling a deploy task or by setting the system to deploy when importing
intrusion rule updates. Automating policy deployment is especially useful if you allow intrusion rule updates to modify system-provided
base policies for intrusion and network analysis. Intrusion rule updates can also modify default values for the advanced preprocessing
and performance options in your access control policies.

* [Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B)
* [Redeploy Existing Configurations to a Device](#task_5BD82554DC514472B7FD37B149B8D280)

### Deploy Configuration Changes

After you change configurations, deploy them to the affected devices. We *strongly* recommend that you deploy in a maintenance window or at a time when any interruptions to traffic flow and inspection will
have the least impact.

| **Caution** | ---  When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).  --- |
| --- | --- |

#### Before you begin

* Be sure all managed devices use the same revision of the Security Zones object. If you have edited security zone objects:
  Do not deploy configuration changes to any device until you edit the zone setting for interfaces on *all* devices you want to sync. You must deploy to all managed devices at the same time.
* To preview the deployment changes, enable
  REST API access. To enable the REST API access, follow the steps in Enabling REST API Access in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).

| **Note** | ---   The deployment process fails if the device configuration is being read at the device CLI during deployment. Do not execute commands such as show running-config  during the deployment.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | On the management center menu bar, click Deploy. |
| --- | --- |
| **Step 2** | For a quick deployment, check specific devices and then click Deploy, or click Deploy All to deploy to all devices. Otherwise, for additional deployment options, click Advanced Deploy.  The rest of this procedure applies to the Advanced Deploy screen.   Figure 1. Quick Deploy    Deploy  Figure 2. Advanced Deploy    Advanced Deploy |
| **Step 3** | Click Expand Arrow (expand arrow icon) to view device-specific configuration changes to be deployed.   Figure 3. Expand    Advanced Deploy  * The Modified By column lists the users who have modified the   policies or objects. On expanding the device listing, you can view   the users who have modified the policies against each policy   listing. For information about when the   System user is shown (instead of the   logged-in user), see [System Username](#system-username).       | **Note** | Usernames are not provided for deleted policies and objects. |   | --- | --- | * The Inspect Interruption column indicates if   traffic inspection interruption may be caused in the device during   deployment.  When the status indicates (Yes) that deploying will interrupt   inspection, and perhaps traffic, on the threat   defense device, the expanded list indicates the specific configurations   causing the interruption with the Inspect   Interruption (inspect interruption icon).  If the entry is blank in this column for a device, then it indicates   that there will be no traffic inspection interruptions on that   device during deployment.  See [Restart Warnings for Devices](#id_65425) for information to help you   identify configurations that interrupt traffic inspection and might   interrupt traffic when deployed to the threat   defense devices. * The Last Modified Time column specifies when   you last made the configuration changes. * The Preview column allows you to preview the changes for the next   deployment. * The Status column provides the status for each   deployment. For more information, see [View Deployment Status](#dep_status_estimate_1). |
| **Step 4** | In the Preview column, click Preview (preview icon) to see the configuration changes that you can deploy.   Figure 4. Preview    Preview  | **Note** | If you change the management center name in System (system gear icon) > Configuration > Information, the deployment preview does not specify this change, yet it requires a deployment. | | --- | --- |   For unsupported features for Preview, see [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825 "Deployment preview provides a snapshot of all the policy and object changes to be deployed on the device. The policy changes include the new policies, changes in the existing policies, and the deleted policies. The object changes include the added and modified objects which are used in policies.").  The Comparison View tab lists all the policy and object changes. The left pane lists all the different policy types that have changed on the device, organized in a tree structure.   Figure 5. Comparison View    Comparison View  The Filter icon () lets you filter the policies at the user level and policy level.  The right pane lists all the additions, changes, or deletions in the policy, or the object selected in the left pane. The two columns on the right pane provide the last deployed configuration settings (in the Deployed Version column) versus the changes that are due for deployment (in the Version on Firewall Management Center column). The last-deployed configuration settings are derived from a snapshot of the last saved deployment in the management center and not from the device. The background colors of the settings are color-coded as per the legend available on the top-right of the page.  The Modified By column lists the users who have modified, or added the configuration settings. At the policy level, the management center displays all the users who have modified the policy, and at the rule level, the management center displays only the last user who has modified the rule.  You can download a copy of the change log by clicking the Download Report button.  The Advanced View tab shows the CLI commands that will be applied. This view is useful if you are familiar with ASA CLI, which is used on the back end of the threat defense.   Figure 6. Advanced View    Advanced View |
| **Step 5** | Use Show or Hide Policy  (Show or Hide Policy icon) to selectively view or hide the associated unmodified policies.   Figure 7. Show or Hide Policy    Show or Hide Policy |
| **Step 6** | Check the box next to the device name to deploy all configuration changes, or click Policy selection  (policy selection icon) to select individual policies or configurations to deploy while withholding the remaining changes without deploying them.  You can also view the interdependent changes for a certain policy or configuration using this option. The management center dynamically detects dependencies between policies (for example, between an access control policy and an intrusion policy), and between the shared objects and the policies. Interdependent changes are indicated using color-coded tags to identify a set of interdependent deployment changes. When one of the deployment changes is selected, the interdependent changes are automatically selected.  For more details, see [Selective Policy Deployment](#select_pol_dep_1).   | **Note** | * When the changes in shared objects are deployed, the impacted   policies should also be deployed along with them. When you   select a shared object during deployment, the impacted policies   are automatically selected. * Selective deployment is not supported for scheduled deployments   and deployments using REST APIs. You can only opt for complete   deployment of all the changes in these cases. * The pre-deployment checks for warnings and errors are performed   not only on the selected policies, but on all the policies that   are out-of-date. Therefore, the warnings or errors list shows   the deselected policies as well. * Similarly, the **Inspect Interruption** column indication on   the Deployment page considers all out-of-date policies and not   just the selected policies. For information on the **Inspect   Interruption** column, see [Restart Warnings for Devices](#id_65425). | | --- | --- | |
| **Step 7** | After you select the devices or policies to deploy, click Estimate to get a rough estimate of the deployment duration.   Figure 8. Estimate    Estimate  Figure 9. Deploy Time    Deploy Time  The time duration is a rough estimate (having around 70% accuracy), and the actual time taken for deployment may vary for a few scenarios. The estimate is dependable for deployments of up to 20 devices.  When an estimate is not available, it indicates that the data is not available, since the first successful deployment on the selected device is pending. This situation could occur after the management center reimage, version upgrade, or after a high availability failover.   | **Note** | The estimate is incorrect and unreliable for bulk policy changes (in case of bulk policy migrations), and selective deployments because the estimate is based on the heuristic technique. | | --- | --- | |
| **Step 8** | Click Deploy. |
| **Step 9** | If the system identifies errors or warnings in the changes to be deployed, it displays them in the Validation Messages  window. To view complete details, click the arrow icon before the warnings or errors.  You have the following choices:   * Deploy—Continue deploying without resolving warning conditions. Check the Ignore warnings checkbox, to ignore warnings and deploy the changes. You cannot proceed if the system identifies errors. * Close—Exit without deploying. Resolve the error and warning conditions, and attempt to deploy the configuration again. |

---

#### What to do next

* (Optional) Monitor deployment status; see Viewing Deployment Messages in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* If the deployment fails, see [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).
* During deployment, if there are specific configuration changes in the deployment, the deployment failure may lead to traffic
  being interrupted. For example, in a cluster environment, an erroneous configuration of an IP address that is not in the same
  subnet as the Site IPs is configured on the interface. Due to this error, deployment fails and the device attempts to clear
  the configuration while the rollback operation is being processed. These events collectively lead to a deployment failure
  that interrupts the traffic.

  See the following table to know what configuration changes may cause traffic interruption when deployment fails.

  | Configuration Changes | Exists? | Traffic Impacted? |
  | --- | --- | --- |
  | **Threat Defense Service** changes in an access control policy | Yes | Yes |
  | VRF | Yes | Yes |
  | Interface | Yes | Yes |
  | QoS | Yes | Yes |

  | **Note** | ---   The configuration changes interrupting traffic during deployment is valid only if both the management center and the threat defense are of version 6.2.3 or higher.   --- |
  | --- | --- |

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

### Redeploy Existing Configurations to a Device

You can force-deploy existing (unchanged) configurations to a single managed device. We *strongly* recommend you deploy in a maintenance window or at a time when any interruptions to traffic flow and inspection will have
the least impact.

| **Caution** | ---  When you deploy, resource demands may result in a small number of packets dropping without inspection. Additionally, deploying some configurations restarts the Snort process, which interrupts traffic inspection. Whether traffic drops during this interruption or passes without further inspection depends on how the target device handles traffic. See [Snort Restart Traffic Behavior](#concept_uc1_gtq_ty) and [Configurations that Restart the Snort Process When Deployed or Activated](#reference_F11C552688424DEF85ED145FA97283B7).  --- |
| --- | --- |

#### Before you begin

Review the guidelines described in [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).

#### Procedure

---

| **Step 1** | Choose Devices > Device Management. |
| --- | --- |
| **Step 2** | Click Edit (edit icon) next to the device where you want to force deployment. |
| **Step 3** | Click Device. |
| **Step 4** | Click Edit (edit icon) next to the General section heading. |
| **Step 5** | Click Force Deploy (force deploy icon).   | **Note** | Force-deploy takes more time than the regular deployment because it involves the complete generation of the policy rules to be deployed on the threat defense. | | --- | --- | |
| **Step 6** | Click Deploy.  The system identifies any errors or warnings with the configurations you are deploying. You can click Proceed to continue without resolving warning conditions. However, you cannot proceed if the system identifies an error. |

---

#### What to do next

* (Optional) Monitor deployment status; see Viewing Deployment
  Messages in the [Cisco Secure Firewall Management
  Center Administration Guide](http://www.cisco.com/go/firepower-config).
* If deploy fails, see [Best Practices for Deploying Configuration Changes](#ID-2176-0000040d).

**Related Concepts**
[Snort Restart Scenarios](#concept_33516C5D6B574B6888B1A05F956ABDF9)

## Manage Deployments

* [View Deployment Status](#dep_status_estimate_1)
* [View Deployment History](#task_view_dep_hist)
* [Roll Back a Deployment](#concept_f4c_ptb_dwb)
* [Download Policy Changes Report for Multiple Devices](#download-policy-changes-report-for-multiple-devices)
* [Compare Policies](#task_ABA1FE48DBBB44BC9FF40243FCC58BF6)
* [Generate Current Policy Reports](#task_CCED983433824793AF09203FDAD1AF53)

### View Deployment Status

On the Deployment page, the Status column provides the deployment status for each device. If a deployment is in progress, then the live status of the deployment
progress is displayed, else one of the following statuses is displayed:

* Pending—Indicates that there are changes in the device that are to be deployed.
* Warnings or errors—Indicates that the pre-deployment checks have identified warnings or errors for the deployment, and you
  have not proceeded with the deployment. You can continue with the deployment if there are any warnings, but not if there are
  any errors.

  | **Note** | ---   The status column provides the warning or error status only for a single user session on the deployment page. If you navigate away from the page or refresh the page, the status changes to pending.   --- |
  | --- | --- |
* Failed—Indicates that the previous deployment attempt failed. Click on the status to view the details.
* In queue—Indicates that deployment is initiated, and the system is yet to start the deployment process.
* Completed—Indicates that deployment has completed successfully.

### View Deployment History

In the deployment history, the last 10 successful deployments, the last 5 failed
deployments, and last 5 rollback deployments are captured.

#### Procedure

---

| **Step 1** | On the management center menu bar, click Deploy and then click Deployment History (deployment history icon).   Figure 10. Deployment History Icon    Deployment History  A list of all the previous deployment and rollback jobs is displayed in reverse chronological order.   Figure 11. Deployment History Page    Deployment History |
| --- | --- |
| **Step 2** | Click Expand Arrow (expand arrow icon) next to the required deployment job to view the devices included in the job and their deployment statuses.   Figure 12. Expand    Expand  * View notes in the Deployment Notes column.  Deployment notes are custom notes that a user can add as part of the   deployment, and these notes are optional. |
| **Step 3** | (Optional) Click Transcript Details (transcript details icon) to view the commands sent to the device, and the responses received.   Figure 13. Transcript Details Icon    Transcript Details Icon  Figure 14. Transcript Details    Transcript Details  The transcript includes the following sections:   * **Snort Apply**—If there are any failures or responses from Snort-related policies, then the messages are displayed in this section. Normally,   the section is empty. * **CLI Apply**—This section covers features that are configured using commands that are sent to the device.       | **Note** | The transcript for the rollback operation does not provide the CLI commands information. To view the rollback commands, see [View the Deployment Rollback Transcript](#view_rollback_transcript). |   | --- | --- | * **Infrastructure Messages**—This section shows the status of different deployment modules.   In the **CLI Apply** section, the deployment transcript includes commands that are sent to the device, and any responses returned from the device. These responses can be informative messages or error messages. For failed deployments, look for messages that indicate errors with the commands. Examining these errors can be particularly helpful if you are using FlexConfig policies to configure customized features. These errors can help you correct the script in the FlexConfig object that is trying to configure the commands.   | **Note** | There is no distinction that is made in the transcript between commands that are sent for managed features and those generated from FlexConfig policies. | | --- | --- |   For example, the following sequence shows that management center sent commands to configure GigabitEthernet0/0 with the logical name **outside**. The device responded that it automatically set the security level to 0. Threat Defense does not use the security level for anything.  ```  ========= CLI APPLY =========  FMC >> interface GigabitEthernet0/0 FMC >>  nameif outside FTDv 192.168.0.152 >> [info] : INFO: Security level for "outside" set to 0 by default.   ``` |
| **Step 4** | (Optional) Click Preview (preview icon) to view the policy and object changes deployed on the device versus the previously deployed version.   Figure 15. Preview Icon    Preview Icon  1. To compare any two versions and view the change log, choose the    required versions in the drop-down boxes and click the    Show button. The drop-down boxes show the    deployment job name and the end time of the deployment.         Figure 16. Compare Versions                Compare Versions        | **Note** | The drop-down boxes also show failed deployments. |    | --- | --- | 2. The Modified By column lists the users who    have modified the policies or objects.     1. At the policy level, management center displays all the user names who have modified the       policy.    2. At the rule level, management center displays the last user who has modified the rule. 3. You can also download a copy of the change log by clicking    Download Report.  | **Note** | * Deployment history preview is not supported for certificate   enrollments, HA operations, and failed deployments. * When a device is registered, preview is not supported for the job   history record that is created. | | --- | --- | |
| **Step 5** | (Optional) Against each deployment job, click the More (more icon) icon and execute other actions:   * Bookmark—To bookmark the deployment job. * Edit Deployment Notes—To edit your custom deployment notes that you   added for a deployment job. * Generate Report—To generate a deployment report, which can be used   for auditing. This report includes job properties with preview and   transcript information, and the report can be downloaded as a PDF   file.    1. Click Generate Report to generate a deployment report.             Figure 17. Generate Report   2. In the Generate Report popup window, check the Email checkbox.   3. The report can also be sent through email if mail relay host is configured. If the mail relay host in not configured, use      the Edit (edit icon) icon to configure or modify the mail relay host. For more information, see Configuring a Mail Relay Host and Notification Address in the [Cisco Secure Firewall Management      Center Administration Guide](http://www.cisco.com/go/firepower-config).   4. In the Recipient List, you can enter multiple email adddresses, separated by semicolons.   5. Click Generate to generate the report, and this report is emailed to the recipients.   6. In the Notifications task tab, you can track the progress. After the report generation is complete, click the link in the      notification task tab to download the PDF report. |

---

* [Set the Number of Configuration Versions](#configuration_version_setting)

#### Set the Number of Configuration Versions

The management center stores device configuration history files on the disk as configuration versions. You can specify the number of configuration
versions that you want to retain for a device. This setting allows you to estimate the size of the device configuration files
on the disk and keep it within the allowed limit. Reducing the number of configuration versions can reduce the backup size
and improve the high-availability synchronization speed of the management center.

In a management center high-availability deployment, configuration version setting is available only on the active management center.

##### Before you begin

This feature is not supported in Version
7.2.0–7.2.5, 7.3.x, or 7.4.0. Support
returns in Version 7.4.1.

##### Procedure

---

| **Step 1** | On the management center menu bar, choose Deploy > Deployment History (deployment history icon). |
| --- | --- |
| **Step 2** | Click Deployment Setting. |
| **Step 3** | Choose the number of configuration versions that you want to retain for a device from the Number of Versions to Retain drop-down list.   | **Note** | Reducing the number of versions removes the oldest configuration versions to match the version size you have selected. You cannot roll back or preview the removed versions. | | --- | --- |  * Maximum Permitted Disk Size: The maximum size for storing configuration versions is 20 GB. The management center calculates the size of configuration versions periodically and sends a health alert if the size of the configuration versions   exceeds 20 GB. To resolve the health alert, choose a Number of Versions to Retain for which the estimated configuration version size is less than 20 GB. * Current Configuration Version Size: The size of the configuration files on the management center for the previous deployment. * Estimated Configuration Version Size: The approximate size of the configuration files on the management center. It is calculated based on the number of configuration versions you chose to retain. |
| **Step 4** | Click Save. |

---

### Roll Back a Deployment

You can roll back a device to a previously deployed configuration. After a policy
deployment, if the traffic through the device is affected in an unintended way,
rollback provides an option to revert the device to the earlier state, which existed
before the faulty deployment.

Rollback is a disruptive operation: all the existing connections and routes are
dropped, and the traffic is disrupted.

#### Identifying the Disruptive Configuration

When a deployment has gone awry and caused traffic interruption in an unintended way,
you should identify the change in the deployment that caused the condition and fix
it so your next deployment will be successful.

See the following ways to compare configurations.

**Before a Rollback**

1. Choose Deploy > Deployment History, expand the last deployed job (that caused the traffic
   disruption), and click the preview icon (![preview icon](/c/dam/en/us/td/i/400001-500000/440001-450000/448001-449000/448387.jpg)).

   The preview page provides an option to compare deployments, which can be
   useful to identify specific changes for a deployment compared to a previous
   deployment.
2. After identifying the change causing the problem, rectify the configuration,
   and redeploy it on the device.

**After a Rollback**

1. After a successful rollback operation, choose Deploy > Deployment, and click the Preview icon next to
   the rolled back device.
2. View the changes between the rolled back configuration and the current
   changes in the management center that are pending deployment.
3. After identifying the change causing the problem, rectify the configuration,
   and redeploy it on the device.

#### Rollback Guidelines and Limitations

* You can roll back to any one of the last 10 versions before the currently
  deployed version. Rollback to versions prior to these are not supported. The
  rollback icon is greyed out for unsupported versions.
* You have to perform a deployment before you can roll back again.
* After you perform a rollback, the rolled back devices are marked as
  out-of-date on the management center. The changes you made to the configuration are still pending for the next
  deployment. To see the pending changes, choose Deploy > Deployment, and click the Preview icon next to
  the rolled back device.
* For devices with very large access lists, if the Object Group
  Search setting is disabled, then the rollback operation may
  take a longer duration to complete. To verify the Object Group
  Search setting, choose Devices > Device Management, and then select the device and click Edit
  Advanced Settings.
* For the Firepower 4100/9300, make sure your current chassis manager interface configuration is the same for any rollback versions. Otherwise,
  the rollback interface configuration may not match your actual
  interfaces.
* Rollback is not supported if the manager access interface (Manager or data
  interface) is different between the rollback version and the current
  version.
* Independent certificate enrollments are also listed as deployment jobs in the
  Deployment History page. However, you cannot roll back to these versions. A
  rollback from a deployment version created after certificate enrollments
  reverts the certificate associations as well. In the next deployment after a
  rollback, manually associate the certificates before proceeding with the
  deployment.
* If you upgrade the management center, all rollback versions from the previous software release will no longer
  be available for devices, even if you did not upgrade the devices.
* If you upgrade the device, you can only roll back to versions on the current
  software release.
* If a deployment for a device with a FlexConfig object configured with a
  deployment frequency set to Once is rolled back, then
  you will not be able to redeploy the object even though it is displayed as
  out-of-date on the Preview page. After a rollback, you will have to manually
  unassign and then reassign the FlexConfig object to the device before the
  next deployment.
* For High Availability, rollback is not supported in the following
  scenarios:

  + When the version you want to roll back to contains the
    high-availability bootstrap configuration. In other words, the
    deployment when you first formed high availability for the
    standalone devices.
  + When a device that is currently in standalone mode was part of a high
    availability pair in the previous deployment version.
* For clustering, see the following guidelines:

  + Rollback is not supported when a device that is currently in
    standalone mode was part of a cluster in the previous deployment
    version.
  + (Secure Firewall 3100 and threat
    defense virtual in a private cloud) If you change the clustering
    bootstrap configuration or add or delete nodes, you cannot roll back
    to a version prior to those changes.

#### Configurations Not Reverted After a Rollback

Rollback reverts all the configurations on the device except a few. See the table
below for details.

| Configurations that are reverted during a rollback | Configurations that are not reverted during a rollback |
| --- | --- |
| * All policy configurations  * Interface configurations  * SRU configurations * VDB configurations * LSP configurations * VPN configurations * FXOS configurations | * Snort binaries       | **Note** | Rollback from Snort 3 to Snort 2 version policies and vice versa are supported. |   | --- | --- | * Geo DB |

* [Perform a Rollback](#rollback_task)
* [View the Deployment Rollback Transcript](#view_rollback_transcript)

#### Perform a Rollback

You can roll back a device to a previously deployed configuration. After a policy
deployment, if the traffic through the device is affected in an unintended way,
rollback provides an option to revert the device to the earlier state, which existed
before the faulty deployment.

Rollback reverts the configuration only on the selected devices.

##### Procedure

---

| **Step 1** | Choose Deploy >Deployment History (deployment history icon).  A list of all the previous deployment jobs is displayed in reverse chronological order. |
| --- | --- |
| **Step 2** | Click Rollback. |
| **Step 3** | Filter the list of devices displayed by either clicking Job and choosing a job from the Selected Job drop-down list, or by clicking Device List. |
| **Step 4** | (Optional) Enter the device name in the Search Device search box to filter the device list. |
| **Step 5** | Check the box next to the devices you want to roll back and choose the version for each device from the Rollback Version drop-down list.   Figure 18. Selected Job List    Selected Job List  Figure 19. Device List    Device List  The job names and associated deployment notes are also listed for a particular rollback version. |
| **Step 6** | (Optional) Click the preview icon (preview icon) to view the changes deployed in the selected version. |
| **Step 7** | Click Rollback. |

---

##### What to do next

To know the status of the rollback, choose Deploy > Deployment. You can view the rollback status next to the device name.

#### View the Deployment Rollback Transcript

Rollback transcript is a written version of the commands that are sent to the device, along with the responses returned from
the device. If a rollback operation has failed, the transcript in the **Deploy > Deployment History** page provides the reason for the failure. However, to know the CLI commands executed for a successful rollback operation,
follow the steps given below after a rollback operation has completed. Note that this information is available only until
the next deployment.

| **Note** | ---   The CLI command information is available after a rollback is complete and is available only until the next deployment. The first deployment after a rollback operation erases all the rollback-related information.   --- |
| --- | --- |

| **Note** | ---   For any rollback deployment, the Deployment Notes are updated automatically as Rollback Job. In the Deployment History page, the user can filter the Rollback Jobs easily using the Search option.   --- |
| --- | --- |

##### Procedure

---

| **Step 1** | On the Secure Firewall Management Center menu bar, choose System > Health > Monitor. |
| --- | --- |
| **Step 2** | Select the device, which was rolled back, from the left pane. |
| **Step 3** | Click View System & Troubleshooting Details link. |
| **Step 4** | Click Advanced Troubleshooting. |
| **Step 5** | Click Threat Defense CLI. |
| **Step 6** | Select show from the Command drop-down box. |
| **Step 7** | Enter `running` in the Parameter field. |
| **Step 8** | Click Execute. |

---

### Download Policy Changes Report for Multiple Devices

Download reports on the policy and object changes made since your last deployment for multiple threat
defense devices. You can download the reports in the form of a zip file that contains the following reports:

* A pending changes report for each device, that previews the additions, updates, or deletions in the policy, or the objects
  that are to be deployed on the device. For more information, see [Deploy Configuration Changes](#task_75E181687ECF4EFC8EB6AF4509C20C0B) and [Deployment Preview](#Cisco_Concept.dita_44f4e6ea-cdb6-41e7-974a-2573b51e3825 "Deployment preview provides a snapshot of all the policy and object changes to be deployed on the device. The policy changes include the new policies, changes in the existing policies, and the deleted policies. The object changes include the added and modified objects which are used in policies.").
* A consolidated report that categorizes each device based on the report status.

#### Procedure

---

| **Step 1** | Choose Deploy > Advanced Deploy. |
| --- | --- |
| **Step 2** | Check the check box next to the devices for which you want to generate a pending policy changes report, and then click Pending Changes Reports. |
| **Step 3** | Click Pending Changes Reports. Reports are generated in the background. |
| **Step 4** | On the management center menu bar, choose Notifications > Tasks to view the report generation task.  When the report request task is complete, the download link appears within the task notification. |
| **Step 5** | Click the Download Report(s) link to download the reports. |

---

### Compare Policies

To review policy changes for compliance with your organization's standards or to
optimize system performance, you can examine the differences between two policies or
between a saved policy and the running configuration.

You can compare the following policy types:

* DNS
* File
* Health
* Identity
* Intrusion (Only Snort 2 policies)
* Network Analysis
* SSL

The comparison view displays both policies in a side-by-side format. Differences
between the two policies are highlighted:

* Blue indicates that the highlighted setting is different in the two policies,
  and the difference is noted in red text.
* Green indicates that the highlighted setting appears in one policy but not
  the other.

#### Before you begin

You can compare policies only if you have access rights and any required licenses for
the specific policy, and you are in the correct domain for configuring the policy.

#### Procedure

---

| **Step 1** | Access the management page for the policy you want to compare:   * DNS—Policies > Access Control > DNS * File—Policies > Access Control > Malware & File * Health—System (system gear icon) > Health > Policy * Identity—Policies > Access Control > Identity * Intrusion—Policies > Access Control > Intrusion      | **Note** | You can compare only Snort 2 policies. |   | --- | --- | * Network Analysis—Policies > Access Control, then click Network Analysis   Policy or Policies  > Access Control > Intrusion, then click Network Analysis   Policies      | **Note** | If your custom user role limits access to the first path listed here, use the second path to access the policy. |   | --- | --- | * SSL—Policies > Access Control > SSL |
| --- | --- | --- | --- | --- | --- |
| **Step 2** | Click Compare Policies. |
| **Step 3** | From the Compare Against drop-down list, choose the type of comparison you want to make:   * To compare two different policies, choose Other Policy. * To compare two revisions of the same policy, choose Other Revision. * To compare another policy to the currently active policy, choose Running Configuration. |
| **Step 4** | Depending on the comparison type you choose, you have the following choices:   * If you are comparing two different policies, choose the policies you want to compare from the Policy A and Policy B drop-down lists. * If you are comparing the running configuration to another policy, choose the second policy from the Policy B drop-down list. |
| **Step 5** | Click OK. |
| **Step 6** | Review the comparison results:   * Comparison Viewer—To use the comparison viewer to navigate individually through policy differences, click Previous or Next above the title bar. * Comparison Report—To generate a PDF report that lists the differences between the two policies, click Comparison Report. |

---

### Generate Current Policy Reports

For most policies, you can generate two kinds of reports. A report on a single
policy provides details on the policy's current saved configuration, while a
comparison report lists only the differences between two policies. You can generate
a single-policy report for all policy types except health.

| **Note** | ---   Intrusion policy reports combine the settings in the base policy with the settings of the policy layers, and make no distinction between which settings originated in the base policy or policy layer.   --- |
| --- | --- |

#### Before you begin

You can generate policy reports only if you have access rights and any required
licenses for the specific policy, and you are in the correct domain for configuring
the policy.

#### Procedure

---

| **Step 1** | Access the management page for the policy for which you want to generate a report:   * Access Control—Policies > Access Control * DNS—Policies > Access Control > DNS * File—Policies > Access Control > Malware & File * Health—System (system gear icon) > Health > Policy * Identity—Policies > Access Control > Identity * Intrusion—Policies > Access Control > Intrusion * NAT—Devices > NAT * Network Analysis—Policies > Access Control, then click Network Analysis   Policy or Policies  > Access Control > Intrusion, then click Network Analysis   Policies      | **Note** | If your custom user role limits access to the first path listed here, use the second path to access the policy. |   | --- | --- | * SSL—Policies > Access Control > SSL |
| --- | --- | --- | --- |
| **Step 2** | Click Report (Report icon) next to the policy for which you want to generate a report. |

---

## History for Configuration Deployment

| Feature | Minimum Management Center | Minimum Threat Defense | Details |
| --- | --- | --- | --- |
| Set the number of deployment history files to retain for device rollback. | Any | Any | You can now set the number of deployment history files to retain for device rollback, up to ten (the default). This can help you save disk space on the management center.  New/modified screens: Deploy > Deployment History (deployment history icon) > Deployment Setting > Configuration Version Setting  Other version restrictions: Not supported with management center Version 7.3.x or 7.4.0. |
| View and generate reports on configuration changes since your last deployment. | Any | Any | You can generate, view, and download (as a zip file) the following reports on configuration changes since your last deployment:   * A policy changes report for each device that previews the   additions, changes, or deletions in the policy, or the   objects that are to be deployed on the device. * A consolidated report that categorizes each device based   on the status of policy changes report generation.   This is especially useful after you upgrade either the management center or threat defense devices, so that you can see the changes made by the upgrade before you deploy.  New/modified screens: Deploy > Advanced Deploy.  Other version restrictions: Not supported with management center Version 7.3.x or 7.4.0. |
| Generate and email a report when you deploy configuration changes. | 7.2 | Any | You can now generate a report for any deployment.  New/modified screens: Deploy > Deployment History (deployment history icon) icon > More (more icon)Generate Report |
| Deployment preview and user information in preview. | 7.0 | Any | The Deployment page has the following newly added features:   * On the Deployment page, the Modified By column lists the users who have modified the policies against each policy listing. * Filter support for deployment – The Filter icon provided on the Deployment page provides an option to filter the device listings that are pending deployment. The Filter icon provides options to filter   the listings based on selected devices and user names. * Deployment History Preview – Click Preview to view the policy and object changes deployed on the device versus the previously deployed version. In the deployment history,   the last 10 successful deployments, the last five failed deployments, and last five rollback deployments are captured. * Deployment Notes – The Deployment Notes are custom and optional notes that a user can add as part of deployment. You can view the Deployment Notes column in the Deployment History page. * Deployment rollback is available for Snort 3 policies as well. |
| Roll back deployment on threat defense devices. | 6.7 | 6.7 | Rollback is a deployment functionality provided to remove the existing deployment on threat defense devices and to reconfigure the device with the previously deployed configuration.  New/modified pages: The Deploy > Deployment History page provides a new Rollback column with the rollback icons. Similar rollback icons can also be found when the jobs are expanded, to initiate rollback at the device level. |
| New deployment web interface. | 6.6 | Any | The Deploy button on the management center menu bar is changed to Deploy menu. There are two new sub-menu options under it. These are Deployment and Deployment History. The Deployment page has undergone an improvement along with newly added features, and the new Deployment History page provides a legend of all the previous deployments.  The Deployment page has the following newly added features:   * Deployment status - On the Deployment page, the Status column provides the deployment status for each device. * Deployment estimate - The Estimate link is available on the Deployment page after you select a device, a policy, or a configuration. The Estimate link provides an estimate of the deployment duration once clicked. * Deployment preview - Preview provides a snapshot of all the policy and object changes to be deployed on the device. The policy   changes include the new policies, changes in the existing policies, and the deleted policies. The object changes include the   added and modified objects which are used in policies. * Selective policy deployment - management center allows you to select a specific policy within the list of all the changes on the device that are due for deployment and deploy   only the selected policy. |

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_226f8795_20250115_120516.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

# Support & Downloads

* [Worldwide - English](//www.cisco.com/c/en/us/support/index.html "Worldwide - English")
* [Arabic - عربي](//www.cisco.com/c/ar_ae/support/index.html "Arabic - عربي")
* [Brazil - Português](//www.cisco.com/c/pt_br/support/index.html "Brazil - Português")
* [Canada - Français](//www.cisco.com/c/fr_ca/support/index.html "Canada - Français")
* [China - 简体中文](//www.cisco.com/c/zh_cn/support/index.html "China - Chinese")
* [China - 繁體中文 (臺灣)](//www.cisco.com/c/zh_tw/support/index.html "Taiwan - Chinese")
* [Germany - Deutsch](//www.cisco.com/c/de_de/support/index.html "Germany - Deutsch")
* [Italy - Italiano](//www.cisco.com/c/it_it/support/index.html "Italy - Italiano")
* [Japan - 日本語](//www.cisco.com/c/ja_jp/support/index.html "Japan - Japanese")
* [Korea - 한국어](//www.cisco.com/c/ko_kr/support/index.html "Korea - Korean")
* [Latin America - Español](//www.cisco.com/c/es_mx/support/index.html "Latin America - Español")
* [Netherlands - Nederlands](//www.cisco.com/c/nl_nl/support/index.html "Netherlands - Nederlands")

Find Products and Downloads

* Helpful Links
* [Licensing Support](https://www.cisco.com/c/en/us/support/licensing/licensing-support.html)
* [Technology Support](https://www.cisco.com/c/en/us/tech/index.html)
* [Support for Cisco Acquisitions](https://www.cisco.com/c/en/us/support/web/acquisition-support.html)
* [Support Tools](https://www.cisco.com/c/en/us/support/web/tools-catalog.html)
* [Cisco Community](https://community.cisco.com/t5/technology-and-support/ct-p/technology-support)

When autocomplete results are available use up and down arrows to review and enter to select

## My Support

* View Open Cases ![Login Required](/etc/designs/cdc/fw/i/icon_lock_small.png)

  Log In
  [Create a Cisco Account](https://id.cisco.com/signin/register)

  [Benefits of a Cisco Account](//www.cisco.com/c/en/us/applicat/content/cdcrgstr/applications_overview.html)
* Software Downloads ![Login Required](/etc/designs/cdc/fw/i/icon_lock_small.png)

  Log In
  [Create a Cisco Account](https://id.cisco.com/signin/register)

  [Benefits of a Cisco Account](//www.cisco.com/c/en/us/applicat/content/cdcrgstr/applications_overview.html)

  [All Software Downloads](//software.cisco.com/download/navigator.html)
* Recently Viewed Products
* My Saved Content ![Login Required](/etc/designs/cdc/fw/i/icon_lock_small.png)
  Log In
  You can now save documents and other content for future use.
   [Log in](/c/login/index.html?referer=/c/en/us/support/index.html) to see your Saved Content.

* [![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback](https://ciscocx.qualtrics.com/jfe/form/SV_br4m3VYdhJreiii?Ref=)

## My Devices

[Log in to view or manage your My Devices inventory](https://cway.cisco.com/mydevices)

## Contact TAC by Phone

* Enterprise and Service Provider Products

  800-553-2447 US/Canada

  [Worldwide Phone Numbers](/c/en/us/support/web/tsd-cisco-worldwide-contacts.html)
* Small Business Products

  866-606-1866 US/Canada

  [Worldwide Phone Numbers](/c/en/us/support/web/tsd-cisco-small-business-support-center-contacts.html)

## Returns

* [Returns Portal](/c/en/us/support/returns/returns-portal.html)

## Products by Category

* [Switches](/c/en/us/support/switches/index.html)
* [Security](/c/en/us/support/security/index.html)
* [Routers](/c/en/us/support/routers/index.html)
* [Wireless](/c/en/us/support/wireless/index.html)

* [Unified Communications](/c/en/us/support/unified-communications/index.html)
* [Networking Software (IOS & NX-OS)](/c/en/us/support/ios-nx-os-software/index.html)
* [Collaboration Endpoints and Phones](/c/en/us/support/collaboration-endpoints/index.html)

See also: [All Products](/c/en/us/support/all-products.html) | [Technologies](/c/en/us/tech/index.html) |  [Acquisitions](/c/en/us/support/web/acquisition-support.html)

## Status Tools

* [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

  The Cisco Security portal provides actionable intelligence for security threats and vulnerabilities in Cisco products and services and third-party products.
* [Field Notices](/c/en/us/support/web/tsd-products-field-notice-summary.html)

  Get to know any significant issues, other than security vulnerability-related issues, that directly involve Cisco products and typically require an upgrade, workaround, or other customer action.

* [Cisco Cloud Status](/c/en/us/support/web/cloud-status.html)

  Check the current status of services and components for Cisco's cloud-based Webex, Security and IoT offerings.
* [Cisco Support Assistant](https://supportassistant.cisco.com/)

  The Cisco Support Assistant (formerly TAC Connect Bot) provides a self-service experience for common case inquiries and basic transactions without waiting in a queue.

## More Tools

* [Collaboration Solution Analyzer](https://cway.cisco.com/csa/)

  Suite of tools to assist you in the day to day operations of your Collaboration infrastructure.
* [Cisco CLI Analyzer](https://cway.cisco.com/cli/)

  The Cisco CLI Analyzer (formerly ASA CLI Analyzer) is a smart SSH client with internal TAC tools and knowledge integrated. It is designed to help troubleshoot and check the overall health of your Cisco supported software.

* [My Notifications](https://cway.cisco.com/mynotifications)

  My Notifications allows an user to subscribe and receive notifications for Cisco Security Advisories, End of Life Announcements, Field Notices, and Software & Bug updates for specific Cisco products and technologies.

[View All Tools](/c/en/us/support/web/tools-catalog.html)

## More Support

* [Partner Support](/c/en/us/partners/support-help.html)
* [Small Business Product Support](/c/en/us/support/smb/product-support/small-business.html)
* [Business Critical Services](/c/m/en_us/customer-experience/perform-transform/business-critical-services.html)

* [Customer Experience](/c/m/en_us/customer-experience/index.html)
* [DevNet Developer Support](https://developer.cisco.com/site/support/)
* [Cisco Trust Portal](https://trustportal.cisco.com/c/r/ctp/home.html)

## Cisco Communities

* [Cisco Community Home](https://community.cisco.com/t5/technology-and-support/ct-p/technology-support)
* [Partner Community](https://community.cisco.com/t5/for-partners/ct-p/2002j-partner-home)
* [Small Business Support Community](https://community.cisco.com/t5/small-business-support-community/ct-p/5541-small-business-support)
* [Webex Community](https://community.cisco.com/t5/webex/ct-p/product-adoption)
* [Cisco Insider User Group](https://community.cisco.com/t5/customer-connection/ct-p/ccp-home)

## Licenses

* [Traditional Licensing](https://slexui.cloudapps.cisco.com/SWIFT/LicensingUI/Quickstart)

  Generate and manage PAK-based and other device licenses, including demo licenses.
* [Smart Software Licensing](https://software.cisco.com/software/csws/ws/platform/home?locale=en_US#module/SmartLicensing)

  Track and manage Smart Software Licenses.

* [Enterprise Agreements](https://software.cisco.com/software/ea/agreements)

  Generate and manage licenses from Enterprise Agreements.
* [Licensing Support](/c/en/us/support/licensing/licensing-support.html)

  Solve common licensing issues on your own.

## Software and Downloads

* [Bug Search Tool](https://bst.cloudapps.cisco.com/bugsearch/?referring_site=shp)

  Find software bugs based on product, release and keyword.
* [Software Research](https://software.cisco.com/research/home)

  View Cisco suggestions for supported products.

* [Cisco Software Checker](https://tools.cisco.com/security/center/softwarechecker.x)

  Use the Cisco Software Checker to search for Cisco Security Advisories that apply to specific Cisco IOS, IOS XE, NX-OS and NX-OS in ACI Mode software releases.
* [Download Cisco Software](https://software.cisco.com/download/home)

  Get the latest updates, patches and releases of Cisco Software.

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from docs.defenseorchestrator.com_8179736b_20250115_120526.html ===


* [Basics of Security Cloud Control](g-basics-of-cisco-defense-orchestrator.html)
* [Cisco AI Assistant User Guide](g_firewall-policy-assistant.html)
* [Onboard Secure Firewall Threat Defense Devices](g-chapterwrapper-for-olh-onboarding-ftd-devices.html)
* [Onboard ASA Devices](g-chapter-wrapper-for-olh-onboard-asa-devices.html)
* [Onboard an On-Premises Firewall Management Center](g-chapter-wrapper-for-olh-onboard-an-fmc.html)
* [Migrate On-Premises Management Center Managed Secure Firewall Threat Defense to Cloud-delivered Firewall Management Center](g-change-firewall-threat-defense-device-management-from-secure-firewall-management-center-to-cdo.html)
* [Onboard an Umbrella Organization](g-olh-onboard-an-umbrella-organization.html)
* [Onboard Security Cloud Control Integrations](g-chapterwrapper-for-olh-onboard-cisco-defense-orchestrator-integrations.html)
* [Onboard Meraki MX Devices](g-chapterwrapper-for-olh-onboard-meraki-mx-devices.html)
* [Onboard AWS Devices](g-chapterwrapper-for-olh-onboard-aws-devices.html)
* [Upgrade Devices and Services](c-upgrade-devices-and-services.html)
* [Managing On-Premises Firewall Management Center with Cisco Security Cloud Control](g-firepower-management-center-and-cdo.html)
* [Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management Center](g-about-the-cloud-delivered-firewall-management-center-in-cdo.html)
* [Managing FDM Devices with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-ftd-with-cisco-defense-orchestrator.html)
* [Managing ASA with Cisco Security Cloud Control](g-about-managing-asa-with-cisco-defense-orchestrator.html)
* [Migrating Firewalls with the Firewall Migration Tool in Security Cloud Control](g-chapterwrapper-for-olh-migrating-firewalls-with-the-cloud-firewall-migration-tool.html)
* [Managing Umbrella with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-umbrella-with-cisco-defense-orchestrator.html)
* [Managing Meraki with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-meraki-with-cisco-defense-orchestrator.html)
* [Managing IOS Devices with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-ios-devices-with-cisco-defense-orchestrator.html)
* [Managing AWS with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-aws-with-cisco-defense-orchestrator.html)
* [Managing SSH Devices with Cisco Security Cloud Control](g-about-managing-ssh-devices-with-cisco-defense-orchestrator.html)
* [Integrating Security Cloud Control with Cisco Security Cloud Sign On](g-integrating-cdo-with-securex.html)
* [Analyzing, Detecting, and Fixing Policy Anomalies Using Policy Analyzer and Optimizer](g-analyzing-detecting-and-fixing-policy-anomalies-using-policy-analyzer-and-optimizer.html)
* [Virtual Private Network Management](g-chapterwrapper-for-olh-virtual-private-network-management.html)
* [Cisco Security Analytics and Logging](g-cisco-security-analytics-and-logging.html)
* [FTD Dashboard](g-analytics-dashboard.html)
* [Cisco Secure Dynamic Attributes Connector](g_cisco-secure-dynamic-attributes-connector.html)
* [Troubleshooting](g-troubleshooting.html)
* [FAQ and Support](g-faq-and-support.html)
* [Security and Internet Access](g_security-internet-access-and-communication-ports.html)
* [Open Source and 3rd Party License Attribution](g-appwrapper-open-source-and-3rd-party-license-attribution.html)
* [Terraform](g-cdo-terraform.html)
Managing Security and Network Devices with Cisco Security Cloud Control Copyright Â© 2025, Cisco Systems, Inc. All rights reserved.

=== Content from sec.cloudapps.cisco.com_0c277382_20250115_120524.html ===


[Home](http://www.cisco.com/) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Event Response PageCisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication Doc ID:  ERP-74985  First Published: 2023 November 1 16:00 GMT  Last Updated:  2023 November 1 17:46 GMT  Version: 1.1       Summary  * Cisco released its semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication on November 1, 2023.  The November 1, 2023, release of the Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication includes 22 Cisco Security Advisories that describe 27 vulnerabilities in Cisco ASA, FMC, and FTD. Cisco has released software updates that address these vulnerabilities.  Details  * The following table identifies Cisco Security content that is associated with this bundled publication:       | Cisco Security Advisory | CVE ID | Security Impact Rating | CVSS Base Score |   | --- | --- | --- | --- |   | [Cisco Firepower Management Center Software Command Injection Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-cmd-inj-29MP49hN) | CVE-2023-20048 | Critical | 9.9 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software ICMPv6 Message Processing Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asa-icmpv6-t5TzqwNd) | CVE-2023-20086 | High | 8.6 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software Remote Access VPN Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asa-webvpn-dos-3GhZQBAS) | CVE-2023-20095 | High | 8.6 |   | [Cisco Firepower Threat Defense Software for Cisco Firepower 2100 Series Firewalls Inspection Rules Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-intrusion-dos-DfT7wyGC) | CVE-2023-20244 | High | 8.6 |   | [Cisco Firepower Threat Defense Software ICMPv6 with Snort 2 Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-icmpv6-dos-4eMkLuN) | CVE-2023-20083 | High | 8.6 |   | [Cisco Firepower Threat Defense Software and Firepower Management Center Software Code Injection Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-fmc-code-inj-wSHrgz8L) | CVE-2023-20063 | High | 8.2 |   | [Cisco Firepower Management Center Software Log API Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-logview-dos-AYJdeX55) | CVE-2023-20155 | High | 7.5 |   | [Cisco Firepower Management Center Software Command Injection Vulnerabilities](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-cmdinj-bTEgufOX) | CVE-2023-20219 CVE-2023-20220 | High | 7.2 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software AnyConnect SSL/TLS VPN Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ssl-dos-kxG8mpUA) | CVE-2023-20042 | Medium | 6.8 |   | [Cisco Firepower Management Center Software Arbitrary File Download Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-file-download-7js4ug2J) | CVE-2023-20114 | Medium | 6.5 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software SAML Assertion Hijack Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-saml-hijack-ttuQfyz) | CVE-2023-20264 | Medium | 6.1 |   | [Cisco Firepower Management Center Software Cross-Site Scripting Vulnerabilities](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-xss-sK2gkfvJ) | CVE-2023-20005 CVE-2023-20041 CVE-2023-20074 CVE-2023-20206 | Medium | 6.1 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software AnyConnect Access Control List Bypass Vulnerabilities](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ac-acl-bypass-bwd7q6Gb) | CVE-2023-20245 CVE-2023-20256 | Medium | 5.8 |   | [Cisco Firepower Threat Defense Software SMB Protocol Snort 3 Detection Engine Bypass and Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-smbsnort3-dos-pfOjOYUV) | CVE-2023-20270 | Medium | 5.8 |   | [Multiple Cisco Products Snort 3 Access Control Policy Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3acp-bypass-3bdR2BEh) | CVE-2023-20246 | Medium | 5.8 |   | [Multiple Cisco Products Snort FTP Inspection Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-ftd-zXYtnjOM) | CVE-2023-20071 | Medium | 5.8 |   | [Cisco Adaptive Security Appliance Software and Firepower Threat Defense Software Remote Access SSL VPN Multiple Certificate Authentication Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-multi-cert-dzA3h5PT) | CVE-2023-20247 | Medium | 5 |   | [Cisco Adaptive Security Appliance and Firepower Threat Defense Software VPN Web Client Services Client-Side Request Smuggling Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asa-webvpn-LOeKsNmO) | CVE-2022-20713 | Medium | 4.3 |   | [Cisco Firepower Threat Defense Software Snort 3 Detection Engine Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-uAnUntcV) | CVE-2023-20070 | Medium | 4 |   | [Cisco Firepower Threat Defense Software Snort 3 Geolocation IP Filter Bypass Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftdsnort3sip-bypass-LMz2ThKn) | CVE-2023-20267 | Medium | 4 |   | [Cisco Firepower Threat Defense Software SSL and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-8U4HHxH8) | CVE-2023-20031 | Medium | 4 |   | [Cisco Firepower Threat Defense Software SSL/TLS URL Category and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sa-ftd-snort3-urldos-OccFQTeX) | CVE-2023-20177 | Medium | 4 |        Related Resources [Cisco Security Vulnerability Policy](https://www.cisco.com/c/en/us/about/security-center/security-vulnerability-policy.html) [MITRE Common Vulnerabilities and Exposures](https://cve.mitre.org/) [Common Vulnerability Scoring System and the Security Impact Rating](https://www.cisco.com/c/en/us/about/security-center/security-vulnerability-policy.html#asr) [Common Vulnerability Scoring System Q & A](https://www.cisco.com/c/en/us/about/security-center/cvss-q-a.html) |   | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_6c346794_20250115_120533.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryMultiple Cisco Products Snort SMB2 Detection Engine Policy Bypass and Denial of Service Vulnerabilities Medium   Advisory ID:  cisco-sa-snort-smb-3nfhJtr  First Published: 2022 November 9 16:00 GMT  Last Updated:  2022 November 30 21:51 GMT  Version 1.1:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [Yes](#workarounds)   Cisco Bug IDs: [CSCvy97080](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy97080)  [CSCwa55404](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa55404)  [CSCwb66736](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb66736)  More...  ,[CSCvy97080](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy97080),[CSCwa55404](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa55404),[CSCwb66736](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb66736),[CSCwb78519](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb78519),[CSCwb87762](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb87762),[CSCwb91454](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb91454),[CSCwc37339](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc37339),[CSCwc37518](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc37518)   CVE-2022-20922 CVE-2022-20943     CWE-244       CVSS Score: [Base 5.8](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L/E:X/RL:X/RC:X       CVE-2022-20922 CVE-2022-20943     CWE-244       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr/csaf/cisco-sa-snort-smb-3nfhJtr.json)   Email      Summary  * Multiple vulnerabilities in the Server Message Block Version 2 (SMB2) processor of the Snort detection engine on multiple Cisco products could allow an unauthenticated, remote attacker to bypass the configured policies or cause a denial of service (DoS) condition on an affected device.  These vulnerabilities are due to improper management of system resources when the Snort detection engine is processing SMB2 traffic. An attacker could exploit these vulnerabilities by sending a high rate of certain types of SMB2 packets through an affected device. A successful exploit could allow the attacker to trigger a reload of the Snort process, resulting in a DoS condition.  **Note**: When the **snort preserve-connection** option is enabled for the Snort detection engine, a successful exploit could also allow the attacker to bypass the configured policies and deliver a malicious payload to the protected network. The **snort preserve-connection** setting is enabled by default. See the [Details](#details) section of this advisory for more information.  **Note**: Only products that have Snort 3 configured are affected. Products that are configured with Snort 2 are not affected.  Cisco has released software updates that address these vulnerabilities. There are workarounds that address these vulnerabilities.  This advisory is available at the following link:[https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20191106-wsa-unauth-devreset)  This advisory is part of the November 2022 release of the Cisco ASA, FTD, and FMC Security Advisory Bundled publication. For a complete list of the advisories and links to them, see [Cisco Event Response: November 2022 Semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication](https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74838).  Affected Products  * Vulnerable Products At the time of publication, these vulnerabilities affected Open Source Snort 3.  For information about which Snort releases were vulnerable at the time of publication, see the [Fixed Software](#fs) section of this advisory. For more information on Snort, see the [Snort website](https://www.snort.org/). Impact to Cisco Products At the time of publication, these vulnerabilities affected the following Cisco products if they were running a vulnerable release of Cisco software:    + Cyber Vision   + FirePOWER Services - All platforms   + Firepower Threat Defense (FTD) Software - All platforms   + Meraki MX Security Appliances1   + Umbrella Secure Internet Gateway (SIG)1. See the [Products Confirmed Not Vulnerable](#nv) section of this advisory for a list of Meraki devices that are not affected by these vulnerabilities. For information about which Cisco software releases were vulnerable at the time of publication, see the [Fixed Software](#fs) section of this advisory. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information. Determine Cisco FTD Software Configuration On new installations of Cisco FTD Software releases 7.0.0 and later, Snort 3 is running by default. On devices that were running Cisco FTD Software Release 6.7.0 or earlier and were upgraded to Release 7.0.0 or later, Snort 2 is running by default. Determine Cisco FTD Software Configuration Using the FTD Software CLI To determine whether Snort 3 is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the **show snort3 status** command. If the command produces the following output, the device is running Snort 3 and is affected by these vulnerabilities:  ```   show snort3 statusCurrently running Snort 3   ``` Determine Cisco FTD Software Configuration for Cisco Firepower Management Center Software-Managed Devices To determine whether Snort 3 is configured on a device that is managed by Cisco Firepower Management Center (FMC) Software, complete the following steps:    1. Log in to the Cisco FMC Software web interface.   2. From the **Devices** menu, choose **Device Management**.   3. Choose the appropriate Cisco FTD device.   4. Click the **Edit** pencil icon.   5. Choose the **Device** tab and look in the **Inspection Engine** area.   + If **Snort 2** is listed, the device is not affected by these vulnerabilities.   + If **Snort 3** is listed, the device is affected by these vulnerabilities.Determine Cisco FTD Software Configuration for Cisco Firepower Device Manager Software-Managed Devices To determine whether Snort 3 is configured on a device that is managed by Cisco Firepower Device Manager (FDM) Software, complete the following steps:    1. Log in to the Cisco FTD Software web interface.   2. From the main menu, choose **Policies**.   3. Choose the **Intrusion** tab.   4. Look for the **Inspection Engine** version. The version will start with either a *2* for Snort 2 or a *3* for Snort 3.   + If the device is running a Snort 2 version, it is not affected by these vulnerabilities.   + If the device is running a Snort 3 version, it is affected by these vulnerabilities.Determine Cisco FTD Software Configuration for Cisco Defense Orchestrator-Managed Devices To determine whether Snort 3 is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the **Inventory** menu, choose the appropriate Cisco FTD device.   3. In the **Device Details** area, look for **Snort Version**. The version will start with either a *2* for Snort 2 or a *3* for Snort 3.   + If the device is running a Snort 2 version, it is not affected by these vulnerabilities.   + If the device is running a Snort 3 version, it is affected by these vulnerabilities.Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by these vulnerabilities.  Cisco has confirmed that these vulnerabilities do not affect the following products:    + Cisco 1000 Series Integrated Services Routers (ISRs)   + Cisco 4000 Series Integrated Services Routers (ISRs)   + Cisco Adaptive Security Appliance (ASA) Software   + Cisco Catalyst 8000V Edge Software   + Cisco Catalyst 8200 Series Edge Platforms   + Cisco Catalyst 8300 Series Edge Platforms   + Cisco Catalyst 8500 Series Edge Platforms   + Cisco Catalyst 8500L Series Edge Platforms   + Cisco Cloud Services Routers 1000V   + Cisco Firepower Management Center (FMC) Software   + Cisco Meraki MX64 and MX64w Appliances   + Cisco Meraki MX65 and MX65w Appliances   + Cisco Integrated Services Virtual Routers (ISRv)   + Open Source Snort 2  Details  * snort preserve-connection Settings The impact of these vulnerabilities can be twofold, depending on whether the **snort preserve-connection** setting is enabled or disabled and whether a traffic flow began before the Snort process went down or began while the Snort process was down.  The behavior for traffic flows that were established beforethe Snort process went downisconfiguration dependent. The behavior for traffic flows that begin whilethe Snort process is down is notconfiguration dependent and always results in a DoS condition. For details on the **snort preserve-connection** setting, see the [Cisco Secure Firewall Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense/c_3.html#wp1594004510) and the [Snort Restart Traffic Behavior](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/configuration/guide/fpmc-config-guide-v70/policy_management.html#concept_uc1_gtq_ty) section of the Firepower Management Center Configuration Guide. snort preserve-connection Is Enabled When the **snort preserve-connection** option is enabled for the Snort detection engine, existing traffic flow are not dropped when the Snort process goes down. Instead, existing traffic flows bypass the Snort detection engine. A successful exploit could allow an attacker to bypass the configured policies and deliver a malicious payload to the protected network. Traffic flows that begin while the Snort process is down are dropped, resulting in a DoS condition.  The CVSS score for existing traffic flows is as follows: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N  The CVSS score for new traffic flows is as follows: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L snort preserve-connection Is Disabled When the **snort preserve-connection** option is disabled for the Snort detection engine, existing traffic flows are dropped. A successful exploit could result in a DoS condition. Traffic flows that begin while the Snort process is down are also dropped, resulting in a DoS condition.  The CVSS score is the same for both new and existing traffic flows: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L Determine the Cisco FTD Software Configuration The **snort preserve-connection** setting is enabled by default. To view the current setting, log in to the Cisco FTD Software CLI and use the s**how running-config | include snort** command. There are no GUI options for viewing the setting.  If the command produces the following output, **snort preserve-connection** is enabled on the device:  ```   > show running-config | include snortsnort preserve-connection>   ```  If the command produces the following output, **snort preserve-connection** is disabled on the device:  ```   > show running-config | include snortno snort preserve-connection>   ```  Workarounds  * There is a workaround that addresses these vulnerabilities. To remove the attack vector for these vulnerabilities for Cisco FMC Software-managed devices and Cisco Defense Orchestrator-managed devices, configure a fastpath prefilter rule to bypass the Snort detection engine. To remove the attack vector for these vulnerabilities for Cisco Firepower Device Manager (FDM)-managed devices, configure an access control rule to bypass the Snort detection engine. Workaround for Cisco FMC Software-Managed Devices To configure a fastpath prefilter rule for SMB traffic for Cisco FMC Software-managed devices, do the following:    1. Log in to the FMC web interface.   2. From the **Policies** menu, under the **Access Control** section, choose **Prefilter**.   3. Choose **New Policy**.   4. Enter the **Name** and **Description** and click **Save**.   5. In the resulting window, ensure that **Default Action: Tunnel Traffic** is set to **Analyze all tunnel traffic**.   6. Click **Add Prefilter Rule**.   7. In the resulting window, enter a rule **Name** and ensure the **Enabled** box is checked.   8. From the **Action** drop-down menu, choose **Fastpath**.   9. Configure the policy under the **Interfaces**, **Networks**, and **Vlan Tags** tabs for SMB traffic on the affected network.   10. Click the **Port** tab.   11. Enter the following destination ports for SMB traffic: **TCP (6):138, TCP (6):139, TCP (6):445** and **UDP (17):137**.   12. Click **Add** to add the policy.   13. Click **Save** to save the policy. To associate the SMB prefilter policy with the access control policy deployed on Cisco FMC Software-managed devices, do the following:    1. From the **Policies** menu, under the **Access Control** section, choose **Access Control**.   2. Find the policy of interest.   3. Click the **Edit** icon.   4. Click the name next to **Prefilter Policy**.   5. Choose the name of the newly created SMB prefilter policy from the drop-down menu.   6. Click **OK**. For more information, see the [Prefiltering and Prefilter Policies](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.html) chapter of the Firepower Management Center Device Configuration Guide. Workaround for Cisco FDM-Managed Devices Fastpath is not supported on Cisco FDM-managed devices. Instead, set an access control policy with an action of trust for the appropriate ports.  To configure an access control policy to bypass SMB traffic for Cisco FDM-managed devices, do the following:    1. Log in to the Cisco FDM web interface.   2. From the **Policies** menu, choose **Access Control**.   3. Create a new policy by clicking the plus (**+**) sign.   4. Enter a name and under the **Action** drop-down menu, choose **Trust**.   5. In the **Port** section, click the plus (**+**) sign.   6. Select **Create new Port.**   7. Enter aname, protocol type, and port numberfor each of the following ports: **TCP (6):138**, **TCP (6):139**, **TCP (6):445**, and **UDP (17):137**.   8. Once the ports have been created, select the four ports to be added to the rule by selecting their names.   9. Click **OK** when done.   10. Click **OK** to add the policy.   11. Deploy changes to Cisco FTD Software. For more information, see the [Access Control Chapter](https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html) of the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager. Workaround for Cisco Defense Orchestrator-Managed Devices To configure a fastpath prefilter rule for SMB traffic for Cisco Defense Orchestrator-managed devices, do the following:    1. Log in to the Cisco Defense Orchestrator web interface.   2. From the **Policies** menu, choose **FTD Policies**.   3. From the **Policies** menu, under the **Access Control** section, choose **Prefilter**.   4. Click **New Policy**.   5. Enter the **Name** and **Description** and click **Save**.   6. In the resulting window, ensure that **Default Action: Tunnel Traffic** is set to **Analyze all tunnel traffic**.   7. Click **Add Prefilter Rule**.   8. In the resulting window, enter a rule **Name** and ensure the **Enabled** box is checked.   9. From the **Action** drop-down menu, select **Fastpath**.   10. Configure the policy under the **Interfaces**, **Networks**, and **Vlan Tags** tabs for SMB traffic on the affected network.   11. Click the **Port** tab.   12. Enter the following destination ports for SMB traffic: **TCP (6):138**, **TCP (6):139**, **TCP (6):445**, and **UDP (17):137**.   13. Click **Add** to add the policy.   14. Click **Save** to save the policy. To associate the SMB prefilter policy with the access control policy deployed on Cisco Defense Orchestrator-managed devices, do the following:    1. From the **Policies** menu, under the **Access Control** section, choose **Access Control.**   2. Find the policy of interest.   3. Click the **Edit** icon.   4. Click the name next to **Prefilter Policy**.   5. Choose the name of the newly created SMB prefilter policy from the drop-down menu.   6. Click **OK**. For more information, see the [Cisco Defense Orchestrator website](https://docs.defenseorchestrator.com/).  While this workaround has been deployed and was proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Cisco ASA, FMC, and FTD Software: [CSCwb87762](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb87762), [CSCwb66736](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb66736), [CSCwa55404](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa55404), [CSCvy97080](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy97080) To help customers determine their exposure to vulnerabilities in Cisco ASA, FMC, and FTD Software, Cisco provides the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x). This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories that the Software Checker identifies (“Combined First Fixed”).  To use the tool, go to the [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x) page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:    1. Choose which advisories the tool will search-all advisories, only High and Critical advisories, or only this advisory.   2. Choose the appropriate software.   3. Choose the appropriate platform (for Cisco ASA and FTD Software only).   4. Enter a release number-for example, **16.2.11** for Cisco ASA Software or **6.6.7** for Cisco FTD Software.   5. Click **Check**.     Only this advisory   All Critical and High advisories   All advisories   Cisco ASA Software   Cisco FMC Software   Cisco FTD Software   Any Platform   3000 Series Industrial Security Appliances (ISA)   ASA 5500-X Series Firewalls   ASA Service Module   Adaptive Security Virtual Appliance (ASAv)   Firepower 1000 Series   Firepower 2100 Series   Firepower 4100 Series   Firepower 9000 Series   Firepower NGFW Virtual   Secure Firewall 3100 Series        For instructions on upgrading your FTD device, see [Cisco Firepower Management Center Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting_started.html). Cyber Vision: [CSCwc37339](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc37339), [CSCwc37518](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc37518), [CSCwb78519](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb78519) At the time of publication, the release information in the following table(s) was accurate. See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information.       | Cisco Cyber Vision Release | First Fixed Release for CVE-2022-20922 and CVE-2022-20943 |   | --- | --- |   | 3.x | Migrate to a fixed release. |   | 4.0 | Migrate to a fixed release. |   | 4.1 | 4.1.2 |      Meraki MX Security Appliances      | Cisco Meraki MX Security Appliances Release | First Fixed Release for CVE-2022-20922 | First Fixed Release for CVE-2022-20943 |   | --- | --- | --- |   | MX15 and earlier | None planned. | Migrate to a fixed release. |   | MX16 | None planned. | Hotfix available for 16.16.7 |   | MX17 | None planned. | Hotfix available for 17.11.1 |   | MX18 | None planned. | Hotfix available for 18.1.3 |      Snort: [CSCwb87762](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb87762), [CSCwb66736](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb66736), [CSCwa55404](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa55404), [CSCvy97080](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy97080)      | Snort Release | First Fixed Release for CVE-2022-20922 | First Fixed Release for CVE-2022-20943 |   | --- | --- | --- |   | 2.x | Not vulnerable | Not vulnerable |   | 3.x | 3.1.31.0 | Not vulnerable |      Umbrella SIG: [CSCwb91454](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb91454) Cisco plans to address these vulnerabilities in Cisco Umbrella SIG, which is cloud based. No user action is required.  Customers who need additional information are advised to contact Cisco Umbrella Support at umbrella-support@cisco.com or their contracted maintenance providers. Additional Resources For help determining the best Cisco ASA, FTD, or FMC Software release, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.  [Cisco ASA Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html)[Cisco Secure Firewall ASA Upgrade Guide](%28https%3A/www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.htmlx)[Cisco Secure Firewall Threat Defense Compatibility Guide](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html)  The Cisco Product Security Incident Response Team (PSIRT) validates only the affected and fixed release information that is documented in this advisory.  Exploitation and Public Announcements  * The Cisco PSIRT is not aware of any public announcements or malicious use of the vulnerabilities that are described in this advisory.  Source  * These vulnerabilities were found during the resolution of a Cisco TAC support case.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.1 | Updated Meraki hotfix version from 16.6.7 to 16.16.7. | Fixed Releases | Final | 2022-NOV-30 |   | 1.0 | Initial public release. | - | Final | 2022-NOV-09 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from www.cisco.com_39faa076_20250115_120523.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [Compatibility Information](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/products-device-support-tables-list.html)
# Cisco Secure Firewall ASA Compatibility

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/asa/compatibility/asamatrx.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/td/docs/security/asa/compatibility/asamatrx.pdf)
  (302.2 KB)

  View with Adobe Reader on a variety of devices

Updated:November 12, 2024

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

## Contents

* [Cisco Secure Firewall ASA Compatibility](#id_65770)
* [ASA and ASDM Compatibility Per Model](#id_65776)
* [ASA 9.22](#reference_onm_zhh_j1c)
* [ASA 9.20 and 9.19](#reference_xy4_5xz_l5b)
* [ASA 9.18 to 9.17](#reference_ncw_ppb_fxb)
* [ASA 9.16 to 9.15](#reference_upj_nkl_x4b)
* [ASA 9.14 to 9.13](#reference_ftp_45n_nhb)
* [ASA 9.12 to 9.5](#id_59423)
* [ASA and VPN Compatibility](#id_65801)
* [Firepower 4100/9300 Compatibility with ASA and Threat Defense](#id_59069)
* [Firepower 1000/2100 and Secure Firewall 3100/4200 ASA and FXOS Bundle Versions](#id_65802)
* [ASA
  Virtual Hypervisor Compatibility](#id_65990)
* [Cisco Defense Orchestrator (CDO) Compatibility with the ASA](#Cisco_Reference.dita_b9a2ae6b-a69f-4bec-ae64-11893e462c96)
* [ASA REST API Compatibility](#id_65991)
* [Secure Firewall 3100 Network Module Compatibility](#Cisco_Reference.dita_d217ee8b-6b52-4c93-9c9f-5fbe54860bbb)
* [Secure Firewall 4200 Network Module Compatibility](#reference_lsn_mqw_txb)
* [Firepower 2100 Network Module Compatibility](#id_81530)
* [ASA and Threat Defense Clustering External Hardware Support](#id_66008)
* [ASA and Cisco Application Policy Infrastructure Controller (APIC) Compatibility](#id_66009)
* [End-of-Life Announcements](#id_66016)
* [Additional Resources](#Cisco_Reference.dita_046821cb-8138-4460-a455-afc073ab7be4)

**First Published: January 1, 2010**

# **Cisco Secure Firewall ASA Compatibility**

This document lists the Secure Firewall ASA software and
hardware compatibility and requirements.

## ASA and ASDM Compatibility Per Model

This section lists ASA and ASDM compatibility per model.

| **Note** | ---   For guidance on security issues on the ASA, and which releases contain fixes for each issue, see the [ASA Security Advisories](https://tools.cisco.com/security/center/publicationListing.x).   --- |
| --- | --- |

### ASA 9.22

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.20(x) was the final version for the Firepower 2100 series. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.22(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.20 with ASA 9.22. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.22(1.2) with ASDM 7.22(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required.  --- |
| --- | --- |

Table 1. ASA and ASDM Compatibility: 9.22

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  Firepower 1010E  1120  1140  1150 | Secure Firewall 1210CE  Secure Firewall 1210CP  Secure Firewall 1220CX | Secure Firewall 3105  3110  3120  3130  3140 | Firepower 4112  4115  4125  4145 | Secure Firewall 4215  Secure Firewall 4225  Secure Firewall 4245 | Firepower 9300 | ISA 3000 |
| **9.22(1.1)** | 7.22(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |

### ASA 9.20 and 9.19

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.20(x) was the final version for the Firepower 2100 series. * ASA 9.18(x) was the final version for the Firepower 4110, 4120, 4140, 4150, and   Security Modules SM-24, SM-36, and SM-44 for the Firepower 9300. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.19(1) can manage an ASA 5516-X on ASA   9.10(1). See the following   exceptions:    + For the Firepower 1010E, ASDM 7.19(1) is not supported. You must use 7.19(1.90)+     or 7.18(2.1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.18 with ASA 9.19. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.20(1.5) with ASDM 7.20(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required.  --- |
| --- | --- |

Table 2. ASA and ASDM Compatibility: 9.20 and 9.19

| ASA | ASDM | ASA Model | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 | Firepower 1010E | Firepower 2110  2120  2130  2140 | Secure Firewall 3105  3110  3120  3130  3140 | Firepower 4112  4115  4125  4145 | Secure Firewall 4215  Secure Firewall 4225  Secure Firewall 4245 | Firepower 9300 | ISA 3000 |
| **9.20(3)** | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(2) | 7.20(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.20(1) | 7.20(1) | — | — | — | — | — | — | **YES** | — | — |
| **9.19(1)** | 7.19(1) | **YES** | **YES** | — | **YES** | **YES** | **YES** | — | **YES** | **YES** |

### ASA 9.18 to 9.17

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.17(1) can manage an ASA 5516-X on ASA   9.10(1). See the following   exceptions:    + For the Firepower 1010E, ASDM 7.19(1) is not supported. You must use 7.19(1.90)+     or 7.18(2.1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.17 with ASA 9.18. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.17(1.2) with ASDM 7.17(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.17(1.13) and 9.18(2) and later requires ASDM 7.18(1.152) or later. The ASA now   validates whether the ASDM image is a Cisco digitally signed image. If you try to run   an older ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be   blocked and the message “%ERROR: Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 3. ASA and ASDM Compatibility: 9.18 to 9.17

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA Virtual | Firepower 1010  1120  1140  1150 | Firepower 1010E | Firepower 2110  2120  2130  2140 | Secure Firewall 3110  3120  3130  3140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.18(4)** | 7.19(1)95 | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(3) | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(2.218) | 7.18(2.1) | — | — | **YES** | — | — | — | — | — |
| 9.18(2) | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.18(1) | 7.18(1) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.17(1.13)** | 7.18(1.152) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.17(1) | 7.17(1.155) | **YES** | **YES** | — | **YES** | **YES** | **YES** | **YES** | **YES** |

### ASA 9.16 to 9.15

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.16(x) was the final version for the ASA 5506-X, 5506H-X, 5506W-X, 5508-X, and   5516-X. * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.15(1) can manage an ASA 5516-X on ASA   9.10(1). * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.15 with ASA 9.16. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.16(1.15) with ASDM 7.16(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.16(3.19) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 4. ASA and ASDM Compatibility: 9.16 to 9.15

| ASA | ASDM | ASA Model | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.16(4)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3.19) | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(3) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(2) | 7.16(1.150) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.16(1) | 7.16(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.15(1)** | 7.15(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |

### ASA 9.14 to 9.13

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.14(x) was the final version for the ASA 5525-X, 5545-X, and 5555-X. * ASA 9.12(x) was the final version for the ASA 5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all previous ASA versions, unless   otherwise stated. For example, ASDM 7.13(1) can manage an ASA 5516-X on ASA 9.10(1).   ASDM 7.13(1) and ASDM 7.14(1) did not support ASA 5512-X, 5515-X, 5585-X, and ASASM;   you must upgrade to ASDM 7.13(1.101) or 7.14(1.48) to restore ASDM support. * New ASA versions require the coordinating ASDM version or a later version; you cannot   use an old version of ASDM with a new version of ASA. For example, you cannot use ASDM   7.13 with ASA 9.14. For ASA maintenance releases and interims, you can continue to use   the current ASDM version, unless otherwise stated. For example, you can use ASA   9.14(1.2) with ASDM 7.14(1). If an ASA maintenance release has significant new   features, then usually there will be a new ASDM version required. * ASA 9.14(4.14) and later requires ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed image. If you try to run an older   ASDM image than 7.18(1.152) with an ASA version with this fix, ASDM will be blocked   and the message “%ERROR: Signature not valid for file disk0:/<filename>” will be   displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291),   [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 5. ASA and ASDM Compatibility: 9.14 to 9.13

| ASA | ASDM | ASA Model | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5525-X  5545-X  5555-X | ASAv | Firepower 1010  1120  1140  1150 | Firepower 2110  2120  2130  2140 | Firepower 4110  4112  4115  4120  4125  4140  4145  4150 | Firepower 9300 | ISA 3000 |
| **9.14(4.14)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(4) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(3) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(2) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.30) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.14(1.6) | 7.14(1.48) | — | — | **YES** (+ASAv100) | — | — | — | — | — |
| 9.14(1) | 7.14(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| **9.13(1)** | 7.13(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** (except 4112) | **YES** | **YES** |

### ASA 9.12 to 9.5

Releases in **bold** are the recommended versions.

| **Note** | ---  * ASA 9.12(x) was the final version for the ASA   5512-X, 5515-X, 5585-X, and ASASM. * ASDM versions are backwards compatible with all   previous ASA versions, unless otherwise stated.   For example, ASDM 7.12(1) can manage an ASA 5515-X   on ASA 9.10(1). * New ASA versions require the coordinating ASDM   version or a later version; you cannot use an old   version of ASDM with a new version of ASA. For   example, you cannot use ASDM 7.10 with ASA 9.12.   For ASA maintenance releases and interims, you can   continue to use the current ASDM version, unless   otherwise stated. For example, you can use ASA   9.12(1.15) with ASDM 7.12(1). If an ASA   maintenance release has significant new features,   then usually there will be a new ASDM version   required. * ASA 9.8(4.45) and 9.12(4.50) and later require   ASDM 7.18(1.152) or later. The ASA now validates   whether the ASDM image is a Cisco digitally signed   image. If you try to run an older ASDM image than   7.18(1.152) with an ASA version with this fix,   ASDM will be blocked and the message “%ERROR:   Signature not valid for file disk0:/<filename>”   will be displayed at the ASA CLI. ([CSCwb05291](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05291), [CSCwb05264](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb05264))  --- |
| --- | --- |

Table 6. ASA and ASDM Compatibility: 9.12 to 9.5

| ASA | ASDM | ASA Model | | | | | | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ASA 5506-X  5506H-X  5506W-X  5508-X  5516-X | ASA 5512-X  5515-X  5525-X  5545-X  5555-X | ASA 5585-X | ASAv | ASASM | Firepower 2110  2120  2130  2140 | Firepower 4110  4120  4140  4150 | Firepower 4115  4125  4145 | Firepower 9300 | ISA 3000 |
| **9.12(4.50)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(4) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(3) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(2) | 7.12(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.12(1) | 7.12(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** |
| 9.10(1) | 7.10(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(2) | 7.9(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.9(1) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| **9.8(4.45)** | 7.18(1.152) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(4) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(3) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(2) | 7.8(2) | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | **YES** |
| 9.8(1.200) | No support | — | — | — | **YES** | — | — | — | — | — | — |
| 9.8(1) | 7.8(1) | **YES** | **YES** | **YES** | **YES** (+ASAv50) | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.7(1.4) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(4) | 7.9(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(3.1) | 7.7(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(2) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** | — | **YES** | **YES** |
| 9.6(1) | 7.6(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | **YES** (except 4150) | — | **YES** | **YES** |
| 9.5(3.9) | 7.6(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(2.200) | 7.5(2.153) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(2.2) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2.1) | 7.5(2) | — | — | — | — | — | — | — | — | **YES** | — |
| 9.5(2) | 7.5(2) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | **YES** |
| 9.5(1.200) | 7.5(1) | — | — | — | **YES** | — | — | — | — | — | — |
| 9.5(1.5) | 7.5(1.112) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |
| 9.5(1) | 7.5(1) | **YES** | **YES** | **YES** | **YES** | **YES** | — | — | — | — | — |

## **ASA and VPN Compatibility**

For ASA and VPN compatibility, see [Supported VPN Platforms, Cisco ASA 5500 Series](https://www.cisco.com/en/US/docs/security/asa/compatibility/asa-vpn-compatibility.html).

## Firepower 4100/9300 Compatibility with ASA and Threat Defense

For the Firepower 4100/9300, you must maintain compatibility between FXOS and all ASA and
threat
defense logical devices. Upgrade FXOS before you upgrade the sofware. The **bold** versions
the the following table are specially-qualified (enhanced testing) companion releases. Use
these combinations whenever
possible.

Note that for other device models, the FXOS compatibility work is done for you. In most
cases, upgrading the software automatically upgrades
FXOS.
For the Secure Firewall 3100/4200 in multi-instance mode, the management center guides you through upgrading FXOS and then threat
defense.

To upgrade:

* FXOS: From FXOS 2.2.2 and later, you can upgrade directly to
  any higher version. When upgrading from versions earlier than 2.2.2, you need to
  upgrade to each intermediate version. Note that you cannot upgrade FXOS to a version
  that does not support your current logical device version. You will need to upgrade in
  steps: upgrade FXOS to the highest version that supports your current logical device;
  then upgrade your logical device to the highest version supported with that FXOS
  version. For example, if you want to upgrade from FXOS 2.2/ASA 9.8 to FXOS 2.13/ASA
  9.19, you would have to perform the following upgrades:

  1. FXOS 2.2→FXOS 2.11 (the highest version that supports 9.8)
  2. ASA 9.8→ASA 9.17 (the highest version supported by 2.11)
  3. FXOS 2.11→FXOS 2.13
  4. ASA 9.17→ASA 9.19
* Threat Defense: Interim upgrades may be required for threat
  defense, in addition to the FXOS requirements above. For the exact upgrade path, refer to the
  [management center upgrade guide](https://www.cisco.com/c/en/us/support/security/defense-center/products-installation-guides-list.html) for your version.
* ASA: ASA lets you upgrade directly from your current version to any higher version,
  noting the FXOS requirements above.

| **Note** | ---   FXOS 2.8(1.125)+ and later versions do not support ASA 9.14(1) or 9.14(1.10) for ASA SNMP polls and traps; you must use 9.14(1.15)+. Other releases, such as 9.13 or 9.12, are not affected.   --- |
| --- | --- |

Table 7. Firepower 4100/9300 Compatibility with ASA and Threat Defense

| FXOS Version | Model | ASA Version | Threat Defense Version |
| --- | --- | --- | --- |
| 2.16 | Firepower 4112 | **9.22** (recommended)  9.20  9.19  9.18  9.17 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.22** (recommended)  9.20  9.19  9.18  9.17 | **7.6** (recommended)  7.4  7.3  7.2  7.1 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.14(1) | Firepower 4112 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.20** (recommended)  9.19  9.18  9.17  9.16  9.14 | **7.4** (recommended)  7.3  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.13 | Firepower 4112 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.19** (recommended)  9.18  9.17  9.16  9.14 | **7.3** (recommended)  7.2  7.1  7.0  6.6 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| 2.12 | Firepower 4112 | **9.18** (recommended)  9.17  9.16  9.14 | **7.2** (recommended)  7.1  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.18** (recommended)  9.17  9.16  9.14  9.12 | **7.2** (recommended)  7.1  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.11 | Firepower 4112 | **9.17** (recommended)  9.16  9.14 | **7.1** (recommended)  7.0  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.17** (recommended)  9.16  9.14  9.12 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.17** (recommended)  9.16  9.14  9.12  9.8 | **7.1** (recommended)  7.0  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.10   | **Note** | For compatibility with 7.0.2+ and 9.16(3.11)+, you need FXOS 2.10(1.179)+. | | --- | --- | | Firepower 4112 | **9.16** (recommended)  9.14 | **7.0** (recommended)  6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.16** (recommended)  9.14  9.12 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.16** (recommended)  9.14  9.12  9.8 | **7.0** (recommended)  6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.9 | Firepower 4112 | 9.14 | 6.6 |
| Firepower 4145  Firepower 4125  Firepower 4115 | 9.14  9.12 | 6.6  6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.14  9.12  9.8 | 6.6  6.4 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.8 | Firepower 4112 | **9.14** | **6.6**   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- | |
| Firepower 4145  Firepower 4125  Firepower 4115 | **9.14** (recommended)  9.12   | **Note** | Firepower 9300 SM-56 requires ASA 9.12(2)+ | | --- | --- | | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4 |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.14** (recommended)  9.12  9.8 | **6.6** (recommended)   | **Note** | 6.6.1+ requires FXOS 2.8(1.125)+. | | --- | --- |   6.4  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.157)   | **Note** | You can now run ASA 9.12+ and FTD 6.4+ on separate modules in the same Firepower 9300 chassis | | --- | --- | | Firepower 4145  Firepower 4125  Firepower 4115 | **9.12**   | **Note** | Firepower 9300 SM-56 requires ASA 9.12.2+ | | --- | --- | | **6.4** |
| Firepower 9300 SM-56  Firepower 9300 SM-48  Firepower 9300 SM-40 |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 | **6.4** (recommended)  6.2.3 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.6(1.131) | Firepower 9300 SM-48  Firepower 9300 SM-40 | **9.12** | Not supported |
| Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.12** (recommended)  9.8 |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.73) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | | **6.2.3** (recommended)   | **Note** | 6.2.3.16+ requires FXOS 2.3.1.157+ | | --- | --- | |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.3(1.66)  2.3(1.58) | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | 9.8   | **Note** | 9.8(2.12)+ is required for flow offload when running FXOS 2.3(1.130)+. | | --- | --- | |  |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |
| 2.2 | Firepower 4150  Firepower 4140  Firepower 4120  Firepower 4110 | **9.8** | Threat Defense versions are EoL |
| Firepower 9300 SM-44  Firepower 9300 SM-36  Firepower 9300 SM-24 |

## Firepower 1000/2100 and Secure Firewall 3100/4200 ASA and FXOS Bundle Versions

Firepower 1000/2100 and Secure Firewall 3100/4200 platforms utilize FXOS as an
underlying operating system that is included in the ASA unified image bundles. The
following table lists the ASA and FXOS versions in each released bundle.

| **Note** | ---   You cannot install ASA or FXOS separately; you must install them both as part of the bundle.   --- |
| --- | --- |

Table 8. ASA Firepower 1000/2100 and Secure Firewall 3100/4200 ASA and FXOS Bundle Versions

| ASA Bundle Version | FXOS Version |
| --- | --- |
| 9.22(1) | 2.16(0.128) |
| 9.20(3) | 2.14(2.106) |
| 9.20(2) | 2.14(1.131) |
| 9.20(1) (Secure Firewall 4200 only) | 2.14(0.11) |
| 9.19(1) | 2.13(0.198) |
| 9.18(3) | 2.12(0.468) |
| 9.18(2) | 2.12(0.438) |
| 9.18(1) | 2.12(0.31) |
| 9.17(1) | 2.11(1.154) |
| 9.16(3) | 2.10(1.189) |
| 9.16(2) | 2.10(1.162) |
| 9.16(1) | 2.10(1.159) |
| 9.15(1) | 2.9(1.131) |
| 9.14(3) | 2.8(1.157) |
| 9.14(2) | 2.8(1.134) |
| 9.14(1.30) | 2.8(1.129) |
| 9.14(1) | 2.8(1.105) |
| 9.13(1) | 2.7(1.107) |
| 9.12(4) | 2.6(1.198) |
| 9.12(3) | 2.6(1.156) |
| 9.12(2) | 2.6(1.141) |
| 9.12(1) | 2.6(1.113) |
| 9.10(1) | 2.4(1.92) |
| 9.9(2) | 2.3(1.77) |
| 9.9(1) | 2.3(1.54) |
| 9.8(4) | 2.2(2.119) |
| 9.8(3) | 2.2(2.90) |
| 9.8(2) | 2.2(2.52) |

## **ASA Virtual Hypervisor Compatibility**

You can deploy the ASA
virtual on the following hypervisors.

| **Note** | ---   ASA virtual deployment on a platform using nested or multi-level hypervisor is not supported.   --- |
| --- | --- |

Table 9. ASA
Virtual Hypervisor Compatibility

| Hypervisor | Version and Details | ASA Virtual OS |
| --- | --- | --- |
| Amazon Web Services | **ASA 9.17 and later**  Amazon Web Services supports the following instance types:   * c5a.large, c5a.xlarge, c5a.2xlarge, c5a.4xlarge * c5d.large, c5d.xlarge, c5d.2xlarge, c5d.4xlarge * c5ad.large, c5ad.xlarge, c5ad.2xlarge, c5ad.4xlarge * m5n.large, m5n.xlarge, m5n.2xlarge, m5n.4xlarge * m5zn.large, m5zn.xlarge, m5zn.2xlarge   **ASA 9.14 and later**  Amazon Web Services supports the following instance types:   * c5.4xlarge * c5n.large, c5n.xlarge, c5n.2xlarge, c5n.4xlarge   **ASA 9.13 and later**   * ASAv50 support added. * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You can deploy the ASA   Virtual on a wide variety of Amazon Web Services instances   types such as:    + c5.large, c5.xlarge, c5.2xlarge, c4.2xlarge, c3.2xlarge, m4.2xlarge   **ASA 9.12 and earlier**  Amazon Web Services supports the ASAv10 and ASAv30 models on the following instance types:   * c3.large, c4.large, and m4.large instances (ASAv10) * c3.xlarge, c4.xlarge, and m4.xlarge instances (ASAv30)  | **Note** | The ASAv100 is not supported on Amazon Web Services. | | --- | --- | | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4(1.200), 9.4(2), 9.4(3), 9.4(4) |
| Kernel-based Virtual Machine (KVM) | * qemu-kvm, libvirt-bin, bridge-utils, virt-manager, genisoimage, virtinst, and virsh tools (part of KVM installation). * Linux Ubuntu 18.04 LTS host.  The ASA   Virtual has been extensively tested on an Ubuntu 18.04 LTS   host, but you can use other Linux distributions.   **ASA 9.14**   * ASAv100 support added.   **ASA 9.13**   * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You have greater   flexibility when you deploy the ASA   Virtual in a KVM private cloud environment.   **ASA 9.8**   * ASAv50 support added. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4  ASA 9.3(2.200), 9.3(3) |
| Microsoft Azure | **ASA 9.17 and later**  Microsoft Azure supports the following instance types:   * Standard\_D8s\_v3 * Standard\_D16s\_v3 * Standard\_F8s\_v2 * Standard\_F16s\_v2   **ASA 9.15 and later**  Microsoft Azure supports the following instance types:   * D5, DS5, D5\_v2, DS5\_v2, D16\_v3 * F16, F16s   **ASA 9.13 and later**   * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You can deploy the ASA   Virtual on a wide variety of Microsoft Azure instances types   such as.    + DS3, DS3\_v2, D4, D4\_v2, DS4, DS4\_v2, D8\_v3   + F4, F4s, F8, F8s * ASAv50 support added.   **ASA 9.12 and earlier**  Microsoft Azure supports the ASAv5, ASAv10, and ASAv30 models on the following instance types:   * Standard D3 instance * Standard D3\_v2 instance  | **Note** | The ASAv100 is not supported on Microsoft Azure. | | --- | --- | | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6(2), 9.6(3), 9.6(4)  ASA 9.5(2.200), 9.5(3) |
| Google Cloud Platform (GCP) | Google Cloud Platform (GCP) supports the ASA Virtual on the following GCP machine types:   * c2-standard-4 (ASAv5, ASAv10, and ASAv30) * c2-standard-8 (ASAv50) * c2-standard-16 (ASAv100) | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15 |
| OpenStack | OpenStack supports the ASA Virtual:   * Enabling OpenStack platform support for ASA   Virtual allows you to run ASA   Virtual on open source cloud platforms. * OpenStack uses a KVM hypervisor to manage virtual   resources. * ASA   Virtual devices are already supported on the KVM hypervisor.   Therefore, there is no extra addition of kernel packages   or drivers to enable OpenStack support. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16 |
| Oracle Cloud Infrastructure (OCI) | Oracle Cloud Infrastructure (OCI) supports the ASA Virtual on the following OCI shape types:   * VM.Standard2.4 (ASAv5, ASAv10, and ASAv30) * VM.Standard2.8 (ASAv50 and ASAv100) | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15 |
| VMware vSphere | 8.0:   * ESXi Server * (Optional) vCenter Server * vSphere Web Client, vSphere Client, or OVFTool for Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- | | ASA 9.22  ASA 9.20 |
| 7.0:   * ESXi Server * (Optional) vCenter Server * vSphere Web Client, vSphere Client, or OVFTool for Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- | | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16 |
| 6.0, 6.5, 6.7:   * ESXi Server * (Optional) vCenter Server * vSphere Web Client, vSphere Client, or OVFTool for   Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- |   **ASA 9.14**   * ASAv100 support added.   **ASA 9.13 and later**   * ASAv Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You have greater   flexibility when you deploy the ASA   Virtual in a VMware private cloud environment.   **ASA 9.8**   * ASAv50 support added. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14 (ASAv100 support added)  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8 (ASAv50 support added)  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4  ASA 9.3  ASA 9.2 |
| 5.x:   * ESXi Server * vCenter Server * vSphere Web Client or vSphere Client for Windows or Linux   See the VMware documentation for more information about vSphere and hardware requirements:  <http://www.vmware.com/support/pubs/>   | **Note** | You cannot install the ASA Virtual directly on an ESXi host without using vCenter. | | --- | --- |  | **Note** | You cannot deploy the ASA Virtual using vCloud Director. | | --- | --- | | ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4(1.200), 9.4(2), 9.4(3), 9.4(4) |
| * You can now install the ASA   Virtual directly on an ESXi host without using vCenter. * OVFTool support | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14 (ASAv100 support added)  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8 (ASAv50 support added)  ASA 9.7  ASA 9.6  ASA 9.5  ASA 9.4(1.200), 9.4(2), 9.4(3), 9.4(4) |
| Microsoft Hyper-V | The Microsoft Hyper-V hypervisor supports the ASAv5, ASAv10, and ASAv30 models.   | **Note** | The ASAv50 and ASAv100 are not supported on Microsoft Hyper-V. | | --- | --- |   **ASA 9.13 and later**   * ASA   Virtual Flexible Licensing allows any ASA   Virtual license to be used on any supported ASA   Virtual vCPU/memory configuration. You have greater   flexibility when you deploy the ASA   Virtual in a Microsoft Hyper-V private cloud environment. | ASA 9.20  ASA 9.19  ASA 9.18  ASA 9.17  ASA 9.16  ASA 9.15  ASA 9.14  ASA 9.13  ASA 9.12  ASA 9.10  ASA 9.9  ASA 9.8  ASA 9.7  ASA 9.6  ASA 9.5(1.200), 9.5(2), 9.5(3) |

## Cisco Defense Orchestrator (CDO) Compatibility with the ASA

CDO can manage all platforms running ASA 8.4 and later (see [ASA and ASDM Compatibility Per Model](#id_65776)), except for the ASA Services Module (ASASM), which is not
supported by CDO.

CDO can onboard an ASA running ASA 8.3 but cannot deploy changes to it or manage it
in any other way. Support is "read-only."

CDO does not support management of the ASA FirePOWER module, which runs a different
operating system from ASA. You can still use the ASA FirePOWER module in your
system, but you need to manage it separately with Firepower Management Center or
ASDM.

There may be a CDO feature that does not support all versions of ASA, such as ASA
upgrades from pre-9.12 versions. In those cases, the CDO documentation will list any
version exceptions with the prerequisites for that feature.

## ASA REST API Compatibility

This section lists ASA REST API and ASA compatibility.

| **Note** | ---   The REST API is not supported on newer hardware models and is no longer being developed. We recommend that you instead use the ASA HTTP interface for automation. See [Cisco Secure Firewall ASA HTTP Interface for Automation](https://www.cisco.com/c/en/us/td/docs/security/asa/misc/http-interface/asa-http-interface.html).   --- |
| --- | --- |

The ASA REST API is supported only on the following models starting with 9.3(2) and
ending with 9.16:

* ASA
  Virtual
* Firepower 9300
* ISA 3000
* Firepower 4110, 4120, 4140, 4150
* ASA 5585-X
* ASA 5525-X, 5545-X, 5555-X
* ASA 5512-X, 5515-X
* ASA 5506-X, 5506H-X, 5506W-X, 5508-X, 5516-X

  | **Note** | ---   The ASA 5506-X series does not support the REST API if you are running the FirePOWER module Version 6.0 or later. Disable the ASA REST API using the **no rest-api agent** command.   --- |
  | --- | --- |

## Secure Firewall 3100 Network Module Compatibility

Table 10. Secure Firewall 3100 Network Module Compatibility

| Modules Supported | Model | ASA OS |
| --- | --- | --- |
| 2-port 100-Gb QSFP+ network module (FPR3K-XNM-2X100G) | * Secure Firewall 3130 * Secure Firewall 3140 | 9.20(2) and later |
| * 6-port 1G SFP Hardware Bypass Network Module, SX   (multimode) (FPR3K-XNM-6X1SXF) * 6-port 10G SFP Hardware Bypass Network Module, SR   (multimode) (FPR3K-XNM-6X10SRF) * 6-port 10G SFP Hardware Bypass Network Module, LR (single   mode) (FPR3K-XNM-6X10LRF) * 8-port 1G Copper Hardware Bypass Network Module, RJ45   (copper) (FPR3K-XNM-8X1GF) | * Secure Firewall 3110 * Secure Firewall 3120 * Secure Firewall 3130 * Secure Firewall 3140 | 9.18(2) and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |
| * 6-port 25G SFP Hardware Bypass Network Module, SR   (multimode) (FPR3K-XNM-6X25SRF) * 6-port 25G Hardware Bypass Network Module, LR (single   mode) (FPR3K-XNM-6X25LRF) | * Secure Firewall 3130 * Secure Firewall 3140 | 9.18(2) and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |
| * 8-port 1-Gb copper hardware bypass network module, RJ45   copper (FPR3K-XNM-8X1GF) * 8-port 1/10-Gb SFP+ network module (FPR3K-XNM-8X10G) * 8-port 1/10/25-Gb ZSFP network module   (FPR3K-XNM-8X25G) | * Secure Firewall 3110 * Secure Firewall 3120 * Secure Firewall 3130 * Secure Firewall 3140 | 9.17 and later |
| 4-port 40-Gb QSFP+ network module (FPR3K-XNM-4X40G) | * Secure Firewall 3130 * Secure Firewall 3140 | 9.17 and later |

## Secure Firewall 4200 Network Module Compatibility

Table 11. Secure Firewall 4200 Network Module Compatibility

| Modules Supported | Model | ASA OS |
| --- | --- | --- |
| 4-port 200G QSFP+ network module (FPR4K-XNM-4X200G) | * Secure Firewall 4215 * Secure Firewall 4225 * Secure Firewall 4245 | 9.20 and later |
| * 8-port 1/10-Gb SFP+ network module (FPR4K-XNM-8X10G) * 8-port 1/10/25-Gb ZSFP network module   (FPR4K-XNM-8X25G) * 4-port 40-Gb QSFP+ network module (FPR4K-XNM-4X40G) * 2-port 100-Gb QSFP+ network module (FPR4K-XNM-2X100G)  * 6-port 1G SFP Hardware Bypass Network Module, SX   (multimode) (FPR4K-XNM-6X1SXF) * 8-port 1-Gb copper hardware bypass network module, RJ45   copper (FPR4K-XNM-8X1GF) * 6-port 10G SFP Hardware Bypass Network Module, SR   (multimode) (FPR4K-XNM-6X10SRF) * 6-port 10G SFP Hardware Bypass Network Module, LR (single   mode) (FPR4K-XNM-6X10LRF) * 6-port 25G SFP Hardware Bypass Network Module, SR   (multimode) (FPR4K-XNM-6X25SRF) * 6-port 25G Hardware Bypass Network Module, LR (single   mode) (FPR4K-XNM-6X25LRF) | * Secure Firewall 4215 * Secure Firewall 4225 * Secure Firewall 4245 | 9.20 and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |

## Firepower 2100 Network Module Compatibility

| **Note** | ---   If a network module is listed for multiple Firepower models, and the part number only differs in the model number (FPR*X*K-NM-*module*), then that module is compatible with the other Firepower models. For example, the FPR9K-NM-6X10SR-F module is compatible on the Firepower 2100 (FPR2K-NM-6X10SR-F) and Firepower 4100 (FPR4K-NM-6X10SR-F). See the [FXOS compatibility guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/compatibility/fxos-compatibility.html) for information about Firepower 4100 and 9300 network modules.   --- |
| --- | --- |

Table 12. Firepower 2100 Network Module Compatibility

| Modules Supported | Model | ASA OS |
| --- | --- | --- |
| * Firepower 6-port 1G SX FTW Network Module single-wide (FPR2K-NM-6X1SX-F) * Firepower 6-port 10G SR FTW Network Module single-wide (FPR2K-NM-6X10SR-F) * Firepower 6-port 10G LR FTW Network Module single-wide (FPR2K-NM-6X10LR-F) | Firepower 2130  Firepower 2140 | ASA 9.10 and later   | **Note** | The ASA does not support the hardware bypass functionality of these modules, but you can use them as regular interfaces. | | --- | --- | |
| Firepower 8-port 1G Network Module single-wide (FPR2K-NM-8X1G) | Firepower 2130  Firepower 2140 | ASA 9.10 and later |
| Firepower 8-port 10G Network Module single-wide (FPR2K-NM-8X10G) | Firepower 2130  Firepower 2140 | ASA 9.9 and later  ASA 9.8(2), 9.8(3) |

## ASA and Threat Defense Clustering External Hardware Support

Clustering will work with both Cisco and non-Cisco switches from other major
switching vendors with no known interoperability issues if they comply with the
following requirements and recommendations. Clustering is compatible with
technologies such as vPC (Nexus), VSS (Catalyst), and StackWise & StackWise
Virtual (Catalyst).

### Switch Requirements

* All third party switches must be compliant to the IEEE standard (802.3ad) Link Aggregation Control Protocol.
* EtherChannel bundling must be completed within 45 seconds when connected to Firepower devices and 33 seconds when connected
  to ASA devices.
* On the cluster control link, the switch must provide fully unimpeded unicast and broadcast connectivity at Layer 2 between
  all cluster members.
* On the cluster control link, the switch must not impose any limitations on IP addressing or the packet format above Layer
  2 headers.
* On the cluster control link, the switch interfaces must support jumbo frames and be configurable for an MTU above 1600.

### Switch Recommendations

* The switch should provide uniform traffic distribution over the EtherChannel's individual links.
* The switch should have an EtherChannel load-balancing algorithm that provides traffic symmetry.
* The EtherChannel load balance hash algorithm should be configurable using the 5-tuple, 4-tuple, or 2-tuple to calculate the
  hash.

| **Note** | ---   For the Firepower 9300 cluster, intra-chassis clustering can operate with any switch because Firepower 9300-to-switch connections use standard interface types.   --- |
| --- | --- |

| **Note** | ---   Some switches, such as the Nexus series, do not support LACP rate fast when performing in-service software upgrades (ISSUs), so we do not recommend using ISSUs with clustering.   --- |
| --- | --- |

## **ASA and Cisco Application Policy Infrastructure Controller (APIC) Compatibility**

The platforms supported include:

* ASA 5525-X, 5545-X, and 5555-X (8.6(x)—9.14(x))
* ASA 5512-X, 5515-X (8.6(x)—9.12(x))
* ASA 5585-X (8.4(x)—9.12(x))
* ASAv (9.2(x) and newer)
* Firepower 4100 and 9300 (9.6(x) and newer)
* Firepower 2100 (9.8(x) and newer)

The following table lists the supported ASA device packages, ASA versions, and APIC versions.

Table 13. ASA Device Package, ASA, and APIC Compatibility

| ASA Device Package Version | Integration Model | APIC Version | ASA Version |
| --- | --- | --- | --- |
| 1.3(12.4) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*)—5.0(2\*) | 8.4(x)—9.16(x) |
| 1.3(12.3) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*)—4.1(1\*) | 8.4(x)—9.12(x) |
| 1.3(11.22) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*)—4.0(1\*) | 8.4(x)—9.10(x) |
| 1.3(10.24) | Cloud Orchestrator  Policy Orchestration  Fabric Insertion | 3.1(1\*) | 8.4(x)—9.8(x) |
| 1.2(12.3) | Policy Orchestration  Fabric Insertion | 3.0(2\*) and older | 8.4(x)—9.16(x) |
| 1.2(12.2) | Policy Orchestration  Fabric Insertion | 3.0(2\*) and older | 8.4(x)—9.12(x) |
| 1.2(11.16) | Policy Orchestration  Fabric Insertion | 3.0(2\*) and older | 8.4(x)—9.10(1) |
| 1.2(10.26) | Policy Orchestration  Fabric Insertion | 3.0(2\*) | 8.4(x)—9.8(x) |
| 1.2(9.18) | Policy Orchestration  Fabric Insertion | 3.0(1\*) | 8.4(x)—9.8(x) |
| 1.2(8.9) | Policy Orchestration  Fabric Insertion | 2.2(2\*) | 8.4(x)—9.7(x) |
| 1.2(7.x) | Policy Orchestration  Fabric Insertion | 2.1(1\*) | 8.4(x)—9.6(2) |
| 1.2(6.15) | Policy Orchestration | 2.0(1\*) | 8.4(x)—9.5(2) |
| 1.2(5.21) | Policy Orchestration | 1.3(1\*) | 8.4(x)—9.5(1) |
| 1.2(5.5) | Policy Orchestration | 1.2(2\*) | 8.4(x)—9.4(x) |

| **Note** | ---   We do not recommend using any ASA device package older than 2016.   --- |
| --- | --- |

| **Note** | ---   Policy Orchestration = Service Policy Mode = Fully Managed Mode.   --- |
| --- | --- |

| **Note** | ---   Fabric Insertion = Customized ASA device package for L2-3 automation only.   --- |
| --- | --- |

## End-of-Life Announcements

For a list of all Cisco End-of-Life platforms, see [End-of-Sale and End-of-Life Products](https://www.cisco.com/c/en/us/products/eos-eol-listing.html).

See the following pages for ASA software and hardware End-of-Life announcements:

* Software—<https://www.cisco.com/c/en/us/products/security/asa-firepower-services/eos-eol-notice-listing.html>
* Hardware—<https://www.cisco.com/c/en/us/products/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-listing.html>

## Additional Resources

See the following additional resources:

* [Cisco’s Next Generation Firewall Product Line Software
  Release and Sustaining Bulletin](https://www.cisco.com/c/en/us/products/collateral/security/firewalls/bulletin-c25-743178.html)

Copyright © 2023, Cisco Systems, Inc. All rights reserved.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [3000 Series Industrial Security Appliances (ISA)](/c/en/us/support/security/industrial-security-appliance-isa/series.html)
* [ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [ASA 5500-X with FirePOWER Services](/c/en/us/support/security/asa-firepower-services/series.html)
* [Firepower 1000 Series](/c/en/us/support/security/firepower-1000-series/series.html)
* [Firepower 2100 Series](/c/en/us/support/security/firepower-2100-series/series.html)
* [Firepower 4100 Series](/c/en/us/support/security/firepower-4100-series/series.html)
* [Firepower 9300 Series](/c/en/us/support/security/firepower-9000-series/series.html)
* [Secure Firewall 1200 Series](/c/en/us/support/security/secure-firewall-1200-series/series.html)
* [Secure Firewall 3100 Series](/c/en/us/support/security/secure-firewall-3100-series/series.html)
* [Secure Firewall 4200 Series](/c/en/us/support/security/secure-firewall-4200-series/series.html)
* [Secure Firewall ASA](/c/en/us/support/security/adaptive-security-appliance-asa-software/series.html)
* [Secure Firewall ASA Virtual](/c/en/us/support/security/virtual-adaptive-security-appliance-firewall/series.html)
* [Secure Firewall ASDM](/c/en/us/support/security/adaptive-security-device-manager/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_576e475c_20250115_120515.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Configuration Guides](/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)
# Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version 7.1

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting
  Started](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-get-started.html)
* [Best Practices: Use Cases for FTD](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-use-cases.html)
* [Licensing the
  System](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-license.html)
* System Monitoring
  + [Monitoring the
    Device](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-monitor.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-isa3000-alarms.html)
* Reusable Objects
  + [Objects](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-objects.html)
  + [Certificates](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-certificates.html)
  + [Identity Sources](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-identity-sources.html)
* The Basics
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-logical-devices.html)
  + [High Availability
    (Failover)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ha.html)
  + [Interfaces](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-interfaces.html)
* Routing
  + [Routing Basics and Static Routes](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-routing.html)
  + [Virtual Routers](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-virtual-routers.html)
  + [Route Maps and Other Objects for Route Tuning](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-route-maps.html)
  + [Open Shortest Path First (OSPF)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ospf.html)
  + [Enhanced Interior Gateway Routing Protocol (EIGRP)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-eigrp.html)
  + [Border Gateway Protocol (BGP)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-bgp.html)
* Security
  Policies
  + [SSL
    Decryption](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.html)
  + [Identity
    Policies](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-identity.html)
  + [Security
    Intelligence](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-sec-intel.html)
  + [Access
    Control](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html)
  + [Intrusion
    Policies](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-intrusion.html)
  + [Network Address
    Translation (NAT)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-nat.html)
* Virtual Private
  Networks (VPN)
  + [Site-to-Site
    VPN](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-s2svpn.html)
  + [Remote Access
    VPN](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ravpn.html)
* System
  Administration
  + [System
    Settings](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-system.html)
  + [System
    Management](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-mgmt.html)
* [Advanced
  Configuration](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-advanced.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.html) to Save Content

Available Languages

Download

Download Options

### Book Title Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager, Version 7.1 Chapter Title SSL Decryption

* [PDF - Complete Book
  (18.48 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710.pdf)
  [PDF - This Chapter (1.21 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (10.71 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (22.68 MB)](/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 14, 2023

## Chapter: SSL Decryption

Chapter Contents

* [SSL Decryption](#topic_3E05DF8127124281AC1A8208FB4F0B2B)
* [About SSL Decryption](#concept_DF8743D3434644A49DB0D03D5865C955)
  + [Why Implement SSL Decryption?](#concept_9CE598D91E0E42A9A3BCA014053674A1)
  + [Actions You Can Apply to Encrypted Traffic](#concept_9C25DB275844450FAA2EA4E2D2DB93B5)
    - [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9)
    - [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061)
    - [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D)
    - [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057)
  + [Automatically Generated SSL Decryption Rules](#concept_97F27D8C3C88481F874E9C315B544185)
  + [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810)
* [License Requirements for SSL Decryption](#concept_CA331CC5D4C740F3BEB5C2765CE42074)
* [Guidelines for SSL Decryption](#concept_991745F245914B538F404B8AEA5EBFAF)
* [How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E)
* [Configuring SSL Decryption Policies](#task_A46EB67387764C209439122818AB7B43)
  + [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825)
  + [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316)
  + [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB)
    - [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B)
    - [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37)
    - [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC)
    - [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0)
    - [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD)
  + [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)
  + [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378)
* [Example: Blocking Older SSL/TLS Versions from the Network](#id_106121)
* [Monitoring and Troubleshooting SSL Decryption](#concept_AA3515B3412145898E69AA30306BE0BC)
  + [Monitoring SSL Decryption](#concept_F6B5C308790C43ABA150C8E3F937A71C)
  + [Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)](#concept_9CE017AD0A384BB581E3EFB7CBC76573)

Close

# SSL Decryption

Some protocols, such as HTTPS, use
Secure Sockets Layer (SSL) or its follow-on version, Transport Layer Security
(TLS), to encrypt traffic for secure transmissions. Because the system cannot
inspect encrypted connections, you must decrypt them if you want to apply
access rules that consider higher-layer traffic characteristics to make access
decisions.

* [About SSL Decryption](#concept_DF8743D3434644A49DB0D03D5865C955)
* [License Requirements for SSL Decryption](#concept_CA331CC5D4C740F3BEB5C2765CE42074)
* [Guidelines for SSL Decryption](#concept_991745F245914B538F404B8AEA5EBFAF)
* [How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E)
* [Configuring SSL Decryption Policies](#task_A46EB67387764C209439122818AB7B43)
* [Example: Blocking Older SSL/TLS Versions from the Network](#id_106121)
* [Monitoring and Troubleshooting SSL Decryption](#concept_AA3515B3412145898E69AA30306BE0BC)

## About SSL Decryption

Normally, connections go through the access control policy to determine
if they are allowed or blocked. However, if you enable the SSL decryption
policy, encrypted connections are first sent through the SSL decryption policy
to determine if they should be decrypted or blocked. Any unblocked connections,
whether or not decrypted, then go through the access control policy for a final
allow/block decision.

| **Note** | ---   You must enable the SSL decryption policy in order to implement active authentication rules in the identity policy. If you enable SSL decryption to enable identity policies, but do not otherwise want to implement SSL decryption, select Do Not Decrypt for the default action and do not create additional SSL decryption rules. The identity policy automatically generates whatever rules it needs.   --- |
| --- | --- |

The following topics explain encrypted traffic flow management and
decryption in more detail.

* [Why Implement SSL Decryption?](#concept_9CE598D91E0E42A9A3BCA014053674A1)
* [Actions You Can Apply to Encrypted Traffic](#concept_9C25DB275844450FAA2EA4E2D2DB93B5)
* [Automatically Generated SSL Decryption Rules](#concept_97F27D8C3C88481F874E9C315B544185)
* [Handling Undecryptable Traffic](#concept_DB014D15E0AA47BB8008E38BDC732810)

### Why Implement SSL Decryption?

Encrypted traffic, such as HTTPS connections, cannot be inspected.

Many connections are legitimately encrypted, such as connections to banks and other financial institutions. Many web sites
use encryption to protect privacy or sensitive data. For example, your connection to the FDM is encrypted.

However, users can also hide undesirable traffic within encrypted
connections.

By implementing SSL decryption, you can decrypt connections, inspect
them to ensure they do not contain threats or other undesirable traffic, and
then re-encrypt them before allowing the connection to proceed. (The decrypted
traffic goes through your access control policy and matches rules based on
inspected characteristics of the decrypted connection, not on the encrypted
characteristics.) This balances your need to apply access control policies with
the user’s need to protect sensitive information.

You can also configure SSL decryption rules to block encrypted traffic
of types you know you do not want on your network.

Keep in mind that decrypting and then re-encrypting traffic adds a
processing load on the device, which will reduce overall system performance.

### Actions You Can Apply to Encrypted Traffic

When configuring SSL decryption rules, you can apply the actions
described in the following topics. These actions are also available for the
default action, which applies to any traffic that does not match an explicit
rule.

| **Note** | ---   Any traffic that passes through the SSL decryption policy must then pass through the access control policy. Except for traffic you drop in the SSL decryption policy, the ultimate allow or drop decision rests with the access control policy.   --- |
| --- | --- |

* [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9)
* [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061)
* [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D)
* [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057)

#### Decrypt Re-Sign

If you elect to
decrypt and re-sign traffic, the system acts as a man-in-the-middle.

For example, the user
types in https://www.cisco.com in a browser. The traffic reaches the
Firepower Threat Defense device, the device then negotiates with the user using the
CA certificate specified in the rule and builds an SSL tunnel between the user
and the
Firepower Threat Defense device. At the same time the device connects to
https://www.cisco.com and creates an SSL tunnel between the server and the
Firepower Threat Defense device.

Thus, the user sees
the CA certificate configured for the SSL decryption rule instead of the
certificate from www.cisco.com. The user must trust the certificate to complete
the connection. The
Firepower Threat Defense device then performs decryption/re-encryption in both
directions for traffic between the user and destination server.

![Decryption using certificate re-signing.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420365.jpg)

| **Note** | ---   If the client does not trust the CA used to re-sign the server certificate, it warns the user that the certificate should not be trusted. To prevent this, import the CA certificate into the client trusted CA store. Alternatively, if your organization has a private PKI, you can issue an intermediate CA certificate signed by the root CA which is automatically trusted by all clients in the organization, then upload that CA certificate to the device.   --- |
| --- | --- |

If you configure a
rule with the Decrypt Re-Sign action, the rule matches traffic based on the
referenced internal CA certificate’s signature algorithm type, in addition to
any configured rule conditions. Because you can select a single re-sign
certificate for the SSL decryption policy, this can limit traffic matching for
resign rules.

For example, outgoing
traffic encrypted with an elliptic curve (EC) algorithm matches a Decrypt
Re-Sign rule only if the re-sign certificate is an EC-based CA certificate.
Similarly, traffic encrypted with an RSA algorithm matches Decrypt Re-Sign
rules only if the global re-sign certificate is RSA; outgoing traffic encrypted
with an EC algorithm does not match the rule, even if all other configured rule
conditions match.

#### Decrypt Known Key

If you own the
destination server, you can implement decryption with a known key. In this
case, when the user opens a connection to https://www.cisco.com, the user sees
the actual certificate for www.cisco.com, even though it is the
Firepower Threat Defense device that is presenting the certificate.

![Decryption using known keys.](/c/dam/en/us/td/i/400001-500000/420001-430000/420001-421000/420366.jpg)

Your organization must
be the owner of the domain and certificate. For the example of cisco.com the
only possible way to have the end user see Cisco’s certificate would be if you
actually own the domain cisco.com (i.e. you are Cisco Systems) and have
ownership of the cisco.com certificate signed by a public CA. You can only
decrypt with known keys for sites that your organization owns.

The main purpose of
decrypting with a known key is to decrypt traffic heading to your HTTPS server
to protect your servers from external attacks. For inspecting client side
traffic to external HTTPS sites, you must use decrypt re-sign as you do not own
the servers.

| **Note** | ---   To use known key decryption, you must upload the server’s certificate and key as an internal identity certificate, and then add it to the list of known-key certificates in the SSL decryption policy settings. Then, you can write the rule for known-key decryption with the server’s address as the destination address. For information on adding the certificate to the SSL decryption policy, see [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA).   --- |
| --- | --- |

#### Do Not Decrypt

If you elect to bypass
decryption for certain types of traffic, no processing is done on the traffic.
The encrypted traffic proceeds to the access control policy, where it is
allowed or dropped based on the access control rule it matches.

#### Block

You can simply block
encrypted traffic that matches an SSL decryption rule. Blocking in the SSL
decryption policy prevents the connection from reaching the access control
policy.

When you block an
HTTPS connection, the user does not see the system default block response page.
Instead, the user sees the browser’s default page for a secure connection
failure. The error message does not indicate the site was blocked due to
policy. Instead, errors might indicate that there are no common encryption
algorithms. It will not be obvious from this message that you blocked the
connection on purpose.

### Automatically Generated SSL Decryption Rules

Whether you enable the
SSL decryption policy, the system automatically generates Decrypt Re-sign rules
for each identity policy rule that implements active authentication. This is
required to enable active authentication for HTTPS connections.

When you enable the
SSL decryption policy, you see these rules under the Identity Policy Active
Authentication Rules heading. These rules are grouped at the top of the SSL
decryption policy. The rules are read only. You can change them only by
altering your identity policy.

### Handling Undecryptable Traffic

There are several characteristics that make a connection undecryptable. If a connection has any of the following characteristics,
the default action is applied to the connection regardless of any rule the connection would otherwise match. If you select
Block as your default action (rather than Do Not Decrypt), you might run into issues, including excessive drops of legitimate
traffic.

* Compressed
  session—Data compression was applied to the connection.
* SSLv2 session—The
  minimum supported SSL version is SSLv3.
* Unknown cipher
  suite—The system does not recognize the cipher suite for the connection.
* Unsupported cipher
  suite—The system does not support decryption based on the detected cipher
  suite.
* Session not
  cached—The SSL session has session reuse enabled, the client and server
  reestablished the session with the session identifier, and the system did not
  cache that session identifier.
* Handshake
  errors—An error occurred during the SSL handshake negotiation.
* Decryption
  errors—An error occurred during the decryption operation.
* Passive interface traffic—All traffic on passive interfaces (passive security zones) is undecryptable.

## License Requirements for SSL Decryption

You do not need a special license to use the SSL decryption policy.

However, you do need the URL license to create rules that use URL categories and reputations as match criteria. For information on configuring licenses,
see [Enabling or Disabling Optional Licenses](fptd-fdm-license.html#id_12247).

## Guidelines for SSL Decryption

Keep the following in
mind when configuring and monitoring SSL decryption policies:

* The SSL
  Decryption policy is bypassed for any connections that match access control
  rules set to trust or block if those rules:

  + Use security
    zone, network, geolocation, and port only as the traffic matching criteria.
  + Come before
    any other rules that require inspection, such as rules that match connections
    based on application or URL, or allow rules that apply intrusion or file
    inspection.
* When using URL category matching, note that there are cases where
  the login page for a site is in a different category than the site itself. For
  example, Gmail is in the “Web based email” category, whereas the login page is
  in the “Internet Portals” category. To get connections to these sites
  decrypted, you must include both categories in the rule.
* If a Vulnerability Database (VDB) update removes (deprecates) applications, you must make changes to any SSL decryption rules
  or application filters that use the application that was deleted. You cannot deploy changes until you fix these rules. In
  addition, you cannot install system software updates before fixing the issue. On the Application Filters object page, or the
  Application tab of the rule, these applications say “(Deprecated)” after the application name.
* You cannot disable the SSL decryption policy if you have any active authentication rules. To disable the SSL decryption policy,
  you must either disable the identity policy, or delete any identity rules that use active authentication.

## How to Implement and Maintain the SSL Decryption Policy

You can use SSL
decryption policies to turn encrypted traffic into plain text traffic, so that
you can then apply URL filtering, intrusion and malware control, and other
services that require deep packet inspection. If your policies allow the
traffic, the traffic is re-encrypted before it leaves the device.

The SSL decryption
policy applies to encrypted traffic only. No unencrypted connections are
evaluated against SSL decryption rules.

Unlike some other
security policies, you need to monitor and actively maintain the SSL decryption
policy, because certificates can expire or even be changed on destination
servers. Additionally, changes in client software might alter your ability to
decrypt certain connections, because the decrypt re-sign action is
indistinguishable from a man-in-the-middle attack.

The following
procedure explains the end-to-end process of implementing and maintaining the
SSL decryption policy.

### Procedure

---

| **Step 1** | If you will implement Decrypt Re-sign rules, create the required internal CA certificate.  You must use an internal Certificate Authority (CA) certificate. You have the following options. Because users must trust the certificate, either upload a certificate client browsers are already configured to trust, or ensure that the certificate you upload is added to the browser trust stores.   * Create a   self-signed internal CA certificate, which is signed by the device itself. See   [Generating Self-Signed Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_CB73ADE996FC43AF885ED0D4A5F83C97). * Upload an   internal CA certificate and key signed by an external trusted CA or by a CA   inside your organization. See   [Uploading Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_5CD7D9D1E8B3434AA5C550EF5497EF81). |
| --- | --- |
| **Step 2** | If you will implement Decrypt Known Key rules, collect the certificate and key from each of the internal servers.  You can use Decrypt Known Key only with servers that you control, because you must obtain the certificate and key from the server. Upload these certificates and keys as internal certificates (not internal CA certificates). See [Uploading Internal and Internal CA Certificates](fptd-fdm-certificates.html#task_5CD7D9D1E8B3434AA5C550EF5497EF81). |
| **Step 3** | [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825).  When you enable the policy, you also configure some basic settings. |
| **Step 4** | [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316).  If in doubt, select Do Not Decrypt as the default action. Your access control policy can still drop traffic that matches the default SSL decryption rule if appropriate. |
| **Step 5** | [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB).  Identify traffic to decrypt and the type of decryption to apply. |
| **Step 6** | If you configure known key decryption, edit the SSL decryption policy settings to include those certificates. See [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA). |
| **Step 7** | If necessary, download the CA certificate used for Decrypt Re-sign rules and upload it to the browser on client workstations.  For information on downloading the certificate and distributing it to clients, see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 8** | Periodically, update re-sign and known key certificates.   * Re-sign certificate—Update this certificate before it expires. If you generate the certificate through the FDM, it is valid for 5 years. To check the validity period for a certificate, select Objects > Certificates, find the certificate in the list, and click the information icon (View or info icon button.) for it in the Actions column. The information dialog box shows the validity period and some other characteristics. You can   also upload a replacement certificate from this page. * Known-key   certificate—For any known-key decryption rules, you need to ensure that you   have uploaded the destination server’s current certificate and key. Whenever   the certificate and key changes on supported servers, you must also upload the   new certificate and key (as an internal certificate) and update the SSL   decryption settings to use the new certificate. |
| **Step 9** | Upload missing trusted CA certificates for external servers.  The system includes a wide range of trusted CA root and intermediate certificates issued by third parties. These are needed when negotiating the connection between the Firepower Threat Defense and the destination servers for decrypt re-sign rules.  Upload all certificates within a root CA’s chain of trust to the list of trusted CA certificates, including the root CA certificate and all intermediate CA certificates. Otherwise, it is more difficult to detect trusted certificates issued by intermediate CAs. Upload certificates on the Objects > Certificates page. See [Uploading Trusted CA Certificates](fptd-fdm-certificates.html#task_CCECD443E93B4AE4B34CBA91BDF23013). |

---

## Configuring SSL Decryption Policies

You can use SSL
decryption policies to turn encrypted traffic into plain text traffic, so that
you can then apply URL filtering, intrusion and malware control, and other
services that require deep packet inspection. If your policies allow the
traffic, the traffic is re-encrypted before it leaves the device.

The SSL decryption
policy applies to encrypted traffic only. No unencrypted connections are
evaluated against SSL decryption rules.

| **Note** | ---   VPN tunnels are decrypted before the SSL decryption policy is evaluated, so the policy never applies to the tunnel itself. However, any encrypted connections within the tunnel are subject to evaluation by the SSL decryption policy.   --- |
| --- | --- |

The following
procedure explains how to configure the SSL decryption policy. For an
explanation of the end-to-end process of creating and managing SSL decryption,
see
[How to Implement and Maintain the SSL Decryption Policy](#task_34CD66D6C4AD4EAE85092A0E28AB502E).

### Before you begin

The SSL decryption
rules table contains two sections:

* Identity Policy Active
  Authentication Rules—If you enable the identity policy and create
  rules that use active authentication, the system automatically creates the SSL
  decryption rules needed to make those policies work. These rules are always
  evaluated before the SSL decryption rules you create yourself. You can alter
  these rules only indirectly, by making changes to the identity policy.
* SSL Native
  Rules—These are rules that you have configured. You can add rules
  to this section only.

### Procedure

---

| **Step 1** | Select Policies > SSL Decryption.  If you have not yet enabled the policy, click Enable SSL Decryption and configure policy settings, as described in [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825). |
| --- | --- |
| **Step 2** | Configure the default action for the policy.  The safest choice is Do Not Decrypt. For more information, see [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316). |
| **Step 3** | Manage the SSL decryption policy.  After you configure SSL decryption settings, this page lists all rules in order. Rules are matched against traffic from top to bottom with the first match determining the action to apply. You can do the following from this page:   * To disable   the policy, click the   SSL Decryption Policy toggle. You can re-enable it   by clicking   Enable SSL Decryption. * To edit policy settings, including the list of certificates used in the policy, click the SSL Decryption Settings button (Gear/Settings button.). You can also download the certificate used with decrypt re-sign rules so that you can distribute it to clients. See the   following topics:    + [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)   + [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378) * To configure   rules:    + To     create a new rule, click the     + button. See     [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB).   + To edit     an existing rule, click the edit icon (edit icon)     for the rule (in the Actions column). You can also selectively edit a rule     property by clicking on the property in the table.   + To     delete a rule you no longer need, click the delete icon (delete icon)     for the rule (in the Actions column). * To move a   rule, edit it and select the new location from the   Order drop-down list. * If any rules have problems, for example, because of removed or changed URL categories, click the See Problem Rules link next to the search box to filter the table to show only those rules. Please edit and correct (or delete) these rules,   so that they will provide the service that you require. |

---

* [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825)
* [Configure the Default SSL Decryption Action](#task_13ADCD983117415BA8628E354515D316)
* [Configure SSL Decryption Rules](#task_A273EF56A0F2407294086018A4228CBB)
* [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA)
* [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378)

### Enable the SSL Decryption Policy

Before you can
configure SSL decryption rules, you must enable the policy and configure some
basic settings. The following procedure explains how to enable the policy
directly. You can also enable it when you enable identity policies. Identity
policies require that you enable the SSL decryption policy.

#### Before you begin

If you upgraded from
a release that did not have SSL decryption policies, but you had configured the
identity policy with active authentication rules, the SSL decryption policy is
already enabled. Ensure that you select the Decrypt Re-Sign certificate you
want to use, and optionally enable pre-defined rules.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click Enable SSL Decryption to configure the policy settings.   * If this is   the first time you enabled the policy, the SSL Decryption Configuration dialog   box opens. Proceed with the next steps. * If you have   already configured the policy once and then disabled it, the policy is simply   enabled again with your previous settings and rules. You can click the   SSL Decryption Settings button (Gear/Settings button.) and configure settings as described in   [Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA). |
| **Step 3** | In Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create Internal CA to create it.  If you have not already installed the certificate in client browsers, click the download button (Download button.) to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 4** | (Optional.) Click + under Trusted CA Certificates and select the certificates or certificate groups that you want the policy to trust.  The default group, Cisco-Trusted-Authorities, includes all of the system-defined trusted CA certificates. If you uploaded additional certificates, you can add them here, or collect them in your own group and select the group here. You can either replace the Cisco-Trusted-Authorities group, or simply add your group. Users will be prompted to accept the certificate for any site whose certificate's signing authority is not represented in this list: access to the site is not blocked simply because the certificate is not trusted.  If you leave the list empty, or select only empty certificate groups, then the SSL decryption policy will trust any certificate. |
| **Step 5** | Select the initial SSL decryption rules.  The system includes the following pre-defined rule that you might find useful:   * Sensitive\_Data—This rule does not decrypt traffic   that matches web sites in the Financial Services or Health and Medicine URL   categories, which include banks, healthcare services, and so forth. You must   enable the URL license to implement this rule. |
| **Step 6** | Click Enable. |

---

### Configure the Default SSL Decryption Action

If an encrypted
connection does not match a specific SSL decryption rule, it is handled by the
default action for the SSL decryption policy.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click anywhere in the Default Action field. |
| **Step 3** | Select the action to apply to matching traffic.   * Do Not   Decrypt—Allow the encrypted connection. The access control policy   then evaluates the encrypted connection and drops or allows it based on access   control rules. * Block—Drop the   connection immediately. The connection is not passed on to the access control   policy. |
| **Step 4** | (Optional.) Configure logging for the default action.  You must enable logging for traffic that matches the default action to be included in dashboard data or Event Viewer. Select from these options:   * At End of   Connection—Generate an event at the conclusion of the connection.    + Send Connection Events To—If you want to send a copy     of the events to an external syslog server, select the server object that     defines the syslog server. If the required object does not already exist, click     Create New Syslog Server and create it. (To disable     logging to a syslog server, select     Any from the server list.)  Because     event storage on the device is limited, sending events to an external syslog     server can provide more long term storage and enhance your event analysis. * No Logging—Do not   generate any events. |
| **Step 5** | Click Save. |

---

### Configure SSL Decryption Rules

Use SSL decryption
rules to determine how to handle encrypted connections. Rules in the SSL
decryption policy are evaluated from top to bottom. The rule applied to traffic
is the first one where all the traffic criteria are matched.

You can create and
edit rules in the SSL Native Rules section only.

| **Note** | ---   Traffic for your VPN connections (both site-to-site and remote access) is decrypted before the SSL decryption policy evaluates connections. Thus, SSL decryption rules are never applied to VPN connections, and you do not need to consider VPN connections when creating these rules. However, any use of encrypted connections within a VPN tunnel are evaluated. For example, an HTTPS connection to an internal server through an RA VPN connection is evaluated by SSL decryption rules, even though the RA VPN tunnel itself is not (because it is decrypted already).   --- |
| --- | --- |

#### Before you begin

If you are
creating a decrypt known-key rule, ensure that you upload the certificate and
key for the destination server (as an internal certificate) and also edit the
SSL decryption policy settings to use the certificate. Known-key rules
typically specify the destination server in the destination network criteria of
the rule. For more information, see
[Configure Certificates for Known Key and Re-Sign Decryption](#task_2D9F7D21191B4B748745B9459F95A8FA).

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption.  If you have not configured any SSL decryption rules (other than the ones automatically generated for active authentication identity rules), you can add pre-defined rules by clicking Add Pre-Defined Rules. You are prompted to select the rules that you want. |
| --- | --- |
| **Step 2** | Do any of the following:   * To create a new rule, click   the   + button. * To edit an existing rule,   click the edit icon (edit icon)   for the rule.   To delete a rule you no longer need, click the delete icon (delete icon) for the rule. |
| **Step 3** | In Order, select where you want to insert the rule in the ordered list of rules.  You can insert rules into the SSL Native Rules section only. The Identity Policy Active Authentication Rules are automatically generated from your identity policy and are read-only.  Rules are applied on a first-match basis, so you must ensure that rules with highly specific traffic matching criteria appear above policies that have more general criteria that would otherwise apply to the matching traffic.  The default is to add the rule to the end of the list. If you want to change a rule's location later, edit this option. |
| **Step 4** | In Title, enter a name for the rule.  The name cannot contain spaces. You can use alphanumeric characters and these special characters: + . \_ - |
| **Step 5** | Select the action to apply to matching traffic.  For a detailed discussion of each option, see the following:   * [Decrypt Re-Sign](#concept_789AA81F890B4E2FBB7ECD375D29E2F9) * [Decrypt Known Key](#concept_E52D3CB8B10C435FB46C84F27C8D5061) * [Do Not Decrypt](#concept_961A65503CB84EED9E6A129E87E4539D) * [Block](#concept_85BEC0E9720C4470B8C6EA06216A0057) |
| **Step 6** | Define the traffic matching criteria using any combination of the following tabs:   * Source/Destination—The security zones (interfaces) through which the traffic passes, the IP addresses or the country or continent (geographical   location) for the IP address, or the TCP ports used in the traffic. The default is any zone, address, geographical location,   and TCP port. See [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B). * Application—The application, or a filter that defines applications by type, category, tag, risk, or business relevance. The default is   any encrypted application. See [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37). * URL—The URL   category of a web request. The default is that the URL category and reputation   are not considered for matching purposes. See   [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC). * Users—The identity source, user or user group. Your identity policies determine whether user and group information is available for traffic matching.   You must configure identity policies to use this criteria. See [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0). * Advanced—The   characteristics derived from the certificates used in the connection, such as   SSL/TLS version and certificate status. See   [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD).   To modify a condition, you click the + button within that condition, select the desired object or element, and click OK in the popup dialog box. If the criterion requires an object, you can click Create New Object if the object you require does not exist. Click the x for an object or element to remove it from the policy.  When adding conditions to SSL decryption rules, consider the following tips:   * You can   configure multiple conditions per rule. Traffic must match all the conditions   in the rule for the rule to apply to traffic. For example, you can use a single   rule to decrypt traffic based on URL category. * For each   condition in a rule, you can add up to 50 criteria. Traffic that matches any of   a condition's criteria satisfies the condition. For example, you can use a   single rule to apply application control for up to 50 applications or   application filters. Thus, there is an OR relationship among the items in a   single condition, but an AND relationship between condition types (for example,   between source/destination and application). * Matching URL category requires the URL filtering license. |
| **Step 7** | (Optional.) Configure logging for the rule.  You must enable logging for traffic that matches the rule to be included in dashboard data or Event Viewer. Select from these options:   * At End of   Connection—Generate an event at the conclusion of the connection.    + Send Connection Events To—If you want to send a copy     of the events to an external syslog server, select the server object that     defines the syslog server. If the required object does not already exist, click     Create New Syslog Server and create it. (To disable     logging to a syslog server, select Any from the server list.)  Because     event storage on the device is limited, sending events to an external syslog     server can provide more long term storage and enhance your event analysis. * No Logging—Do not   generate any events. |
| **Step 8** | Click OK. |

---

* [Source/Destination Criteria for SSL Decryption Rules](#concept_38D7F089EC654113A8D707474F90128B)
* [Application Criteria for SSL Decryption Rules](#concept_3F963C2152AD4E8C8FF478C81121DA37)
* [URL Criteria for SSL Decryption Rules](#concept_74B6B146775F4362A8E733C2F972CBAC)
* [User Criteria for SSL Decryption Rules](#concept_6A327B6E35084F24AE39C9A37B7DBBA0)
* [Advanced Criteria for SSL Decryption Rules](#concept_594894DFBA064419977B9F2D8B8BE4FD)

#### Source/Destination Criteria for SSL Decryption Rules

The Source/Destination
criteria of an SSL decryption rule define the security zones (interfaces)
through which the traffic passes, the IP addresses or the country or continent
(geographical location) for the IP address, or the TCP ports used in the
traffic. The default is any zone, address, geographical location, and any TCP
port. TCP is the only protocol matched to SSL decryption rules.

To modify a condition,
you click the
+ button within that condition, select the desired
object or element, and click
OK. If the criterion requires an object, you can
click
Create New
Object if the object you require does not
exist. Click the
x for an object or element to remove it from the
policy.

You can use the
following criteria to identify the source and destination to match in the rule.

Source Zones,
Destination Zones

The security
zone objects that define the interfaces through which the traffic passes. You
can define one, both, or neither criteria: any criteria not specified applies
to traffic on any interface.

* To match
  traffic leaving the device from an interface in the zone, add that zone to the
  Destination Zones.
* To match
  traffic entering the device from an interface in the zone, add that zone to the
  Source Zones.
* If you add
  both source and destination zone conditions to a rule, matching traffic must
  originate from one of the specified source zones and egress through one of the
  destination zones.

Use this
criteria when the rule should apply based on where the traffic enters or exits
the device. For example, if you want to ensure that all traffic going from
outside hosts to inside hosts gets decrypted, you would select your outside
zone as the
Source
Zones and your inside zone as the
Destination Zones.

Source Networks,
Destination Networks

The network
objects or geographical locations that define the network addresses or
locations of the traffic.

* To match
  traffic from an IP address or geographical location, configure the
  Source Networks.
* To match
  traffic to an IP address or geographical location, configure the
  Destination Networks.
* If you add
  both source and destination network conditions to a rule, matching traffic must
  originate from one of the specified IP addresses and be destined for one of the
  destination IP addresses.

When you add
this criteria, you select from the following tabs:

* Network—Select
  the network objects or groups that define the source or destination IP
  addresses for the traffic you want to control.

  | **Note** | ---   For Decrypt Known-Key rules, select an object with the IP address of the destination server that uses the certificate and key you uploaded.   --- |
  | --- | --- |
* Geolocation—Select the geographical location to
  control traffic based on its source or destination country or continent.
  Selecting a continent selects all countries within the continent. Besides
  selecting geographical location directly in the rule, you can also select a
  geolocation object that you created to define the location. Using geographical
  location, you could easily restrict access to a particular country without
  needing to know all of the potential IP addresses used there.

Source Ports,
Destination Ports/Protocols

The port objects
that define the protocols used in the traffic. You can specify TCP protocol and
ports only for SSL decryption rules.

* To match
  traffic from a TCP port, configure the
  Source Ports.
* To match
  traffic to a TCP port, configure the
  Destination Ports/Protocols.
* To match
  traffic both originating from specific TCP ports and destined for specific TCP
  ports, configure both. For example, you could target traffic from port TCP/80
  to port TCP/8080.

#### Application Criteria for SSL Decryption Rules

The Application
criteria of an SSL decryption rule defines the application used in an IP
connection, or a filter that defines applications by type, category, tag, risk,
or business relevance. The default is any application that has the SSL Protocol
tag. You cannot match SSL decryption rules to any non-encrypted application.

Although you can
specify individual applications in the rule, application filters simplify
policy creation and administration. For example, you could create an SSL
decryption rule that decrypts or blocks all high risk, low business relevance
applications. If a user attempts to use one of those applications, the session
is decrypted or blocked.

In addition, Cisco
frequently updates and adds additional application detectors via system and
vulnerability database (VDB) updates. Thus, a rule for high risk applications
can automatically apply to new applications without you having to update the
rule manually.

You can specify
applications and filters directly in the rule, or create application filter
objects that define those characteristics. The specifications are equivalent,
although using objects can make it easier to stay within the
50-items-per-criteria system limit if you are creating a complex rule.

To modify the
application and filters list, you click the
+ button within the condition, select the desired
applications or application filter objects, which are listed on separate tabs,
and click
OK in the popup dialog box. On either tab, you can
click
Advanced
Filter to select filter criteria or to help you search for specific
applications. Click the
x for an application, filter, or object to remove it
from the policy. Click the
Save As
Filter link to save the combined criteria that is not already an
object as a new application filter object.

For more information
about the application criteria and how to configure advanced filters and select
applications, see
[Configuring Application Filter Objects](fptd-fdm-objects.html#task_49CC5243743F4921AAF00CF6AB0264BE).

Consider the following
tips when using application criteria in SSL decryption rules.

* The system can
  identify unencrypted applications that become encrypted using StartTLS. This
  includes such applications as SMTPS, POPS, FTPS, TelnetS, and IMAPS. In
  addition, it can identify certain encrypted applications based on the Server
  Name Indication in the TLS ClientHello message, or the server certificate
  subject distinguished name value.
* The system can
  identify the application only after the server certificate exchange. If traffic
  exchanged during the SSL handshake matches all other conditions in an SSL rule
  containing an application condition but the identification is not complete, the
  SSL policy allows the packet to pass. This behavior allows the handshake to
  complete so that applications can be identified. After the system completes its
  identification, the system applies the SSL rule action to the remaining session
  traffic that matches its application condition.
* If a selected application was removed by a VDB update, “(Deprecated)” appears after the application name. You must remove
  these applications from the filter, or subsequent deployments and system software upgrades will be blocked.

#### URL Criteria for SSL Decryption Rules

The URL criteria of an
SSL decryption rule defines the category to which the URL in a web request
belongs. You can also specify the relative reputation of sites to decrypt,
block, or allow without decryption. The default is to not match connections
based on URL categories.

For example, you could block all encrypted Gambling sites, or decrypt untrusted Social Networking sites. If a user attempts to browse to any URL with that category and reputation combination, the session
is blocked or decrypted. For more information on URL category matching, see [Filtering URLs by Category and Reputation](fptd-fdm-access.html#concept_2190C5512921483CB9009A9FF5E3AE74).

Categories Tab

Click
+, select the desired categories, and click
OK. Click the
x for a category to remove it from the policy.

The default is
to apply the rule to all URLs in each selected category regardless of
reputation. To limit the rule based on reputation, click the down arrow for
each category, deselect the
Any checkbox, and then use the
Reputation slider to choose the reputation level.
The left of the reputation slider indicates sites that will be allowed without
decryption, the right side are sites that will be decrypted or blocked. How
reputation is used depends on the rule action:

* If the rule decrypts or blocks connections, selecting a reputation level also selects all reputations more severe than that
  level. For example, if you configure a rule to decrypt or block Questionable sites (level 2), it also automatically decrypts or blocks Untrusted (level 1) sites.
* If the rule allows connections without decryption (do not decrypt), selecting a reputation level also selects all reputations
  less severe than that level. For example, if you configure a rule to not decrypt Favorable sites (level 4), it also automatically does not decrypt Trusted (level 5) sites.

Select the Include Sites with
Unknown Reputation option to have URLs with unknown
reputation included in the reputation match. New sites typically are
unrated, and there can be other reasons a site's reputation is unknown or
cannot be determined.

Check the Category for a URL

You can check on the category and reputation for a particular URL. Enter the URL in the URL to Check box and click Go. You will be taken to an external website to see the results. If you disagree with a categorization, click the Submit a URL Category Dispute link and let us know.

#### User Criteria for SSL Decryption Rules

The User criteria of
an SSL decryption rule defines the user or user group for an IP connection. You
must configure identity policies and the associated directory server to include
user or user group criteria in a rule.

Your identity policies
determine whether user identity is collected for a particular connection. If
identity is established, the IP address of the host is associated with the
identified user. Thus, traffic whose source IP address is mapped to a user is
considered to be from that user. IP packets themselves do not include user
identity information, so this IP-address-to-user mapping is the best
approximation available.

Because you can add a maximum of 50 users or groups to a rule, selecting groups usually makes more sense than selecting individual
users. For example, you could create a rule that decrypts traffic to the Engineering group that comes from the outside network,
and create a separate rule that does not decrypt outgoing traffic from that group. Then, to make the rule apply to new engineers,
you only need to add the engineer to the Engineering group in the directory server.

You an also select identity sources to apply to all users within that source. Thus, if you support multiple Active Directory
domains, you can provide differential decryption based on the domain.

To modify the users
list, you click the
+ button within the condition and select the desired
users or user groups using one of the following techniques. Click the
x for a user or group to remove it from the policy.

* Identity Sources—Select an identity source, such as an AD realm or the local user database, to apply the rule to all users obtained from the
  selected sources. If the realm you need does not yet exist, click Create New Identity Realm and create it now.
* Groups—Select the desired user groups. Groups are available only if you configure groups in the directory server. If you select
  a group, the rule applies to any member of the group, including subgroups. If you want to treat a sub-group differently, you
  need to create a separate access rule for the sub-group and place it above the rule for the parent group in the access control
  policy.
* Users—Select individual users. The user name is prefixed with the identity source, such as Realm\username.

  There are some built-in users under the Special-Identities-Realm:

  + Failed
    Authentication—The user was prompted to authenticate, but failed to
    enter a valid username/password pair within the maximum number of allowed
    attempts. Failure to authenticate does not itself prevent the user from
    accessing the network, but you can write an access rule to limit network access
    for these users.
  + Guest—Guest users
    are like Failed Authentication users, except that your identity rule is
    configured to call these users Guest. Guest users were prompted to authenticate
    and failed to do so within the maximum number of attempts.
  + No Authentication
    Required—The user was not prompted to authentication, because the
    user's connections matched identity rules that specified no authentication.
  + Unknown—There is
    no user mapping for the IP address, and there is no record of failed
    authentication yet. Typically, this means that no HTTP traffic has yet been
    seen from that address.

#### Advanced Criteria for SSL Decryption Rules

The Advanced traffic
matching criteria relate to characteristics derived from the certificates used
in the connection. You can configure any or all of the following options.

Certificate
Properties

Traffic matches
the certificate properties option of the rule if it matches any of the selected
properties. You can configure the following:

Certificate
Status

Whether
the certificate is
Valid or
Invalid. Select
Any (the default) if you do not care about
certificate status.

A
certificate is considered valid if all of the following conditions are met,
otherwise it is invalid:

* The
  policy trusts the CA that issued the certificate.
* The
  certificate’s signature can be properly validated against the certificate’s
  content.
* The
  issuer CA certificate is stored in the policy’s list of trusted CA
  certificates.
* None
  of the policy’s trusted CAs revoked the certificate.
* The
  current date is between the certificate Valid From and Valid To dates.

Self-Signed

Whether
the server certificate contains the same subject and issuer distinguished name.
Select one of the following:

* Self-Signing—The server
  certificate is self-signed.
* CA-Signing—The server certificate
  is signed by a Certificate Authority. That is, the issuer and subject are not
  the same.
* Any—Do not consider whether the
  certificate is self-signed as a match criteria.

Supported Version

The SSL/TLS version to match. The rule applies to traffic that uses the any of the selected
versions only. The default is all versions. Select from: SSL
3.0, TLS 1.0, TLS
1.1, TLS 1.2.

For example, if you wanted to permit TLSv1.2
connections only, you could create a block rule for the lower versions.

Traffic that
uses any version not listed, such as SSL v2.0, is handled by the default action
for the SSL decryption policy.

### Configure Certificates for Known Key and Re-Sign Decryption

If you implement
decryption, either by re-signing or using known keys, you need to identify the
certificates that the SSL decryption rules can use. Ensure that all
certificates are valid and unexpired.

Especially for
known-key decryption, you need to ensure that the system has the current
certificate and key for each destination server whose connections you are
decrypting. With a decrypt known key rule, you use the actual certificate and
key from the destination server for decryption. Thus, you must ensure that the
Firepower Threat Defense device has the current certificate and key at all times, or
decryption will be unsuccessful.

Upload a new
internal certificate and key whenever you change the certificate or key on the
destination server in a known key rule. Upload them as an internal certificate
(not an internal CA certificate). You can upload the certificate during the
following procedure, or go to the
Objects > Certificates page and upload it there.

#### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the SSL Decryption Settings button (Gear/Settings button.). |
| **Step 3** | In Decrypt Re-Sign Certificate, select the internal CA certificate to use for rules that implement decryption with re-signed certificates.  You can use the pre-defined NGFW-Default-InternalCA certificate, or one that you created or uploaded. If the certificate does not yet exist, click Create Internal CA to create it.  If you have not already installed the certificate in client browsers, click the download button (Download button.) to obtain a copy. See the documentation for each browser for information on how to install the certificate. Also see [Downloading the CA Certificate for Decrypt Re-Sign Rules](#task_57B8261C06EB4A87BC3075BD9EBAF378). |
| **Step 4** | For each rule that decrypts using a known key, upload the internal certificate and key for the destination server.   1. Click    + under    Decrypt Known-Key Certificates. 2. Select the    internal identity certificate, or click    Create New Internal Certificate to upload it now. 3. Click    OK. |
| **Step 5** | (Optional.) Click + under Trusted CA Certificates and select the certificates or certificate groups that you want the policy to trust.  The default group, Cisco-Trusted-Authorities, includes all of the system-defined trusted CA certificates. Following are the main cases where you might want to change this setting:   * You want to use trusted CA certificates that are not in the default group. You would then   select both the default group and your new group in the SSL   decryption policy settings. You might do this if you have uploaded   additional trusted CA certificates. * You want to use a more limited list of trusted CA certificates than what is in the default   group. You would then create a group that has a complete list of   trusted certificates, not just your delta, and select it as the sole   group in the SSL decryption policy settings.   Users will be prompted to accept the certificate for any site whose certificate's signing authority is not represented in this list: access to the site is not blocked simply because the certificate is not trusted.  If you leave the list empty, or select only empty certificate groups, then the SSL decryption policy will trust any certificate. |
| **Step 6** | Click Save. |

---

### Downloading the CA Certificate for Decrypt Re-Sign Rules

If you decide to
decrypt traffic, users must have the internal CA certificate that is used in
the encryption process defined as a Trusted Root Certificate Authority in their
applications that use TLS/SSL. Typically if you generate a certificate, or
sometimes even if you import one, the certificate is not already defined as
trusted in these applications. By default in most web browsers, when users send
HTTPS requests, they will see a warning message from the client application
informing them that there is a problem with the web site’s security
certificate. Usually, the error message says that the web site’s security
certificate was not issued by a trusted certificate authority or the web site
was certified by an unknown authority, but the warning might also suggest there
is a possible man-in-the-middle attack in progress. Some other client
applications do not show this warning message to users nor allow users to
accept the unrecognized certificate.

You have the
following options for providing users with the required certificate:

Inform users to
accept the root certificate

You can inform
the users in your organization what the new policies are at the company and
tell them to accept the root certificate supplied by the organization as a
trusted source. Users should accept the certificate and save it in the Trusted
Root Certificate Authority storage area so that they are not prompted again the
next time they access the site.

| **Note** | ---   The user needs to accept and trust the CA certificate that created the replacement certificate. If they instead simply trust the replacement server certificate, they will continue to see warnings for each different HTTPS site that they visit.   --- |
| --- | --- |

Add the root certificate to client devices

You can add the root certificate to all client devices on the network as a trusted root certificate authority. This way, the
client applications automatically accept transactions with the root certificate.

You can either
make the certificate available to users by E-mailing it or placing it on a
shared site, or you could incorporate the certificate into your corporate
workstation image and use your application update facilities to distribute it
automatically to users.

The following
procedure explains how to download the internal CA certificate and install it
on Windows clients.

#### Procedure

---

| **Step 1** | Download the certificate from the FDM.   1. Select Policies > SSL Decryption. 2. Click the SSL Decryption Settings button (Gear/Settings button.). 3. Click the Download button (Download button.). 4. Select a download location, optionally change the file name (but not the extension), and click Save.  You can now cancel out of the SSL Decryption Settings dialog box. |
| --- | --- |
| **Step 2** | Install the certificate in the Trusted Root Certificate Authority storage area in web browsers on client systems, or make it available for clients to install themselves.  The process differs depending on the operating system and type of browser. For example, you can use the following process for Internet Explorer and Chrome running on Windows. (For Firefox, install through the Tools > Options > Advanced page.)   1. From the    Start menu, select    Control    Panel > Internet Options. 2. Select the    Content tab. 3. Click the    Certificates button to open the Certificates dialog    box. 4. Select the    Trusted Root Certificate Authorities tab. 5. Click    Import, and follow the wizard to locate and select    the downloaded file (<uuid>\_internalCA.crt) and add it to the Trusted    Root Certificate Authorities store. 6. Click    Finish.  Messages    should indicate that the import was successful. You might see an intermediate    dialog box warning you that Windows could not validate the certificate if you    generated a self-signed certificate rather than obtaining one from a well-known    third-party Certificate Authority.  You can now    close out the Certificate and Internet Options dialog boxes. |

---

## Example: Blocking Older SSL/TLS Versions from the Network

Some organizations are required to prevent the use of older versions of SSL or TLS either by government regulation or company
policy. You can use the SSL Decryption policy to block traffic that uses an SSL/TLS version that you prohibit. Consider placing
this rule at the top of the SSL Decryption policy to ensure that you catch the prohibited traffic immediately.

The following example blocks all SSL 3.0 and TLS 1.0 connections.

### Before you begin

This procedure assumes you have already enabled the SSL Decryption policy as explained in [Enable the SSL Decryption Policy](#task_760949762612428FB0D5C32F7788A825).

### Procedure

---

| **Step 1** | Select Policies > SSL Decryption. |
| --- | --- |
| **Step 2** | Click the + button to create a new rule. |
| **Step 3** | In Order, select 1 to place the rule at the top of the policy, or select the number most suitable for your network.  The default is to add the rule at the end of the policy. |
| **Step 4** | In Title, enter a name for the rule, for example, Block\_SSL3.0\_and\_TLS1.0. |
| **Step 5** | In Action, select Block. This will immediately drop any traffic that matches the rule. |
| **Step 6** | Leave the default values for all options on the following tabs: Source/Destination, Applications, URLs, Users. |
| **Step 7** | Click the Advanced tab and under Supported Versions, leave SSL 3.0 and TLS 1.0 selected, but uncheck TLS 1.1, TLS 1.2.  The policy should look like the following:  SSL decryption rule to block SSL 3.0 and TLS 1.0 connections. |
| **Step 8** | (Optional) Click the Logging tab and select At End of Connection if you want to dashboards and events to reflect blocked connections. You can also select an external syslog server if you are using one. |
| **Step 9** | Click OK.  You can now deploy the policy. Once deployed, any SSL 3.0 or TLS 1.0 connection that goes through the system will be dropped.   | **Note** | SSL 2.0 connections are handled by the default action for the policy. If you want to ensure these are also dropped, change the default action to Block. | | --- | --- | |

---

### What to do next

If you implement this rule, we have the following recommendations:

* For any type of decrypt rule, leave the default settings on the Advanced tab, where all SSL/TLS options are selected. By applying
  to all versions, the handshake process is simplified. However, your initial block rule will still prevent SSL 3.0 and TLS
  1.0 connections.
* We normally recommend that you use Do Not Decrypt as the default action for the policy. However, because SSL 2.0 connections
  are always handled by the default action, you might want to use Block instead. However, if you want to apply Do Not Decrypt
  as the default action for all decryptable traffic, create a Do Not Decrypt rule at the end of the policy where you accept
  all default values for traffic matching criteria. This rule would match any supported TLS connection that does not match an
  earlier rule in the table, and act as the default for those TLS versions.

## Monitoring and Troubleshooting SSL Decryption

The following topics explain how to
monitor and troubleshoot SSL decryption policies.

* [Monitoring SSL Decryption](#concept_F6B5C308790C43ABA150C8E3F937A71C)
* [Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)](#concept_9CE017AD0A384BB581E3EFB7CBC76573)

### Monitoring SSL Decryption

You can view
information about decryption in the dashboards and events for traffic that
matches rules (or the default action) for which you enabled logging.

#### SSL Decryption Dashboard

To evaluate overall
decryption statistics, view the
Monitoring > SSL
Decryption dashboard. The dashboard shows the
following information:

* Percentage of
  encrypted versus plain text traffic.
* How much
  encrypted traffic is decrypted per SSL rules.

#### Events

In addition to the
dashboard, the event viewer (Monitoring > Events) includes SSL information for
encrypted traffic. Following are some tips in evaluating events:

* For connections
  that were dropped because they matched an SSL rule (or default action) that
  blocked matching traffic, the
  Action should be “Block,” and the
  Reason should indicate “SSL Block.”
* The
  SSL
  Actual Action field indicates the actual action that the system
  applied to the connection. This can differ from the
  SSL
  Expected Action, which indicates the action defined on the matching
  rule. For example, a connection might match a rule that applies decryption, but
  could not be decrypted for some reason.

### Handling Web Sites Where Decrypt Re-sign Works for a Browser but not an App (SSL or Certificate Authority Pinning)

Some apps for smart phones and other devices use a technique called SSL (or Certificate Authority) pinning. The SSL pinning
technique embeds the hash of the original server certificate inside the app itself. As a result, when the app receives the
resigned certificate from the Firepower Threat Defense device, the hash validation fails and the connection is aborted.

The primary symptom is that users cannot connect to the web site using
the site’s app, but they can connect using the web browser, even when using the
browser on the same device where the app fails. For example, users cannot use
the Facebook iOS or Android app, but they can point Safari or Chrome at
https://www.facebook.com and make a successful connection.

Because SSL pinning is specifically used to avoid man-in-the-middle
attacks, there is no workaround. You must choose between the following options:

* Support app users, in which case you cannot decrypt any traffic to
  the site. Create a Do Not Decrypt rule for the site’s application (on the
  Application tab for the SSL Decryption rule) and ensure that the rule comes
  before any Decrypt Re-sign rule that would apply to the connections.
* Force users to use browsers only. If you must decrypt traffic to the
  site, you will need to inform users that they cannot use the site’s app when
  connecting through your network, that they must use their browsers only.

#### More Details

If a site works in a browser but not in an app on the same device, you
are almost certainly looking at an instance of SSL pinning. However, if you
want to delve deeper, you can use connection events to identify SSL pinning in
addition to the browser test.

There are two ways an app might deal with hash validation failures:

* Group 1 apps, such as Facebook, send an SSL ALERT Message as soon
  as it receives the SH, CERT, SHD message from the server. The Alert is usually
  an “Unknown CA (48)” alert indicating SSL Pinning. A TCP Reset is sent
  following the Alert message. You should see the following symptoms in the event
  details:

  + SSL Flow Flags include ALERT\_SEEN.
  + SSL Flow Flags do not include APP\_DATA\_C2S or APP\_DATA\_S2C.
  + SSL Flow Messages typically are: CLIENT\_HELLO, SERVER\_HELLO,
    SERVER\_CERTIFICATE, SERVER\_KEY\_EXCHANGE, SERVER\_HELLO\_DONE.
* Group 2 apps, such as Dropbox, do not send any alerts. Instead
  they wait until the handshake is done and then send a TCP Reset. You should see
  the following symptoms in the event:

  + SSL Flow Flags do not include ALERT\_SEEN, APP\_DATA\_C2S, or
    APP\_DATA\_S2C.
  + SSL Flow Messages typically are: CLIENT\_HELLO, SERVER\_HELLO,
    SERVER\_CERTIFICATE, SERVER\_KEY\_EXCHANGE, SERVER\_HELLO\_DONE,
    CLIENT\_KEY\_EXCHANGE, CLIENT\_CHANGE\_CIPHER\_SPEC, CLIENT\_FINISHED,
    SERVER\_CHANGE\_CIPHER\_SPEC, SERVER\_FINISHED.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_a7eeee24_20250115_181749.html ===
{
"document": {
"acknowledgments": [
{
"summary": "This vulnerability was found during the resolution of a Cisco TAC support case."
}
],
"category": "csaf\_security\_advisory",
"csaf\_version": "2.0",
"notes": [
{
"category": "summary",
"title": "Summary",
"text": "A vulnerability in the SSL/TLS certificate handling of Snort 3 Detection Engine integration with Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to cause the Snort 3 detection engine to restart.\r\n\r\nThis vulnerability is due to a logic error that occurs when an SSL/TLS certificate that is under load is accessed when it is initiating an SSL connection. Under specific, time-based constraints, an attacker could exploit this vulnerability by sending a high rate of SSL/TLS connection requests to be inspected by the Snort 3 detection engine on an affected device. A successful exploit could allow the attacker to cause the Snort 3 detection engine to reload, resulting in either a bypass or a denial of service (DoS) condition, depending on device configuration. See the Details [\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr#details\"] section of this advisory for more information. The Snort detection engine will restart automatically. No manual intervention is required.\r\n\r\nCisco has released software updates that address this vulnerability. There are workarounds that address this vulnerability.\r\n\r\n\r\n\r\nThis advisory is part of the November 2023 release of the Cisco ASA, FTD, and FMC Security Advisory Bundled publication. For a complete list of the advisories and links to them, see Cisco Event Response: November 2023 Semiannual Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication [\"https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985\"]."
},
{
"category": "general",
"title": "Vulnerable Products",
"text": "At the time of publication, this vulnerability affected Cisco FTD Software if it was running a vulnerable release and met all of the following conditions:\r\n\r\nThe device was running Snort 3.\r\nAt least one of the following conditions was true:\r\nTLS server identity discovery was enabled.\r\nAn SSL policy was configured.\r\n\r\n\r\nFor information about which Cisco software releases are vulnerable, see the Fixed Software [\"#fs\"] section of this advisory.\r\n Determine Cisco FTD Software Snort Configuration\r\nTo determine if Snort 3 is running on Cisco FTD Software, see Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD) [\"https://www.cisco.com/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html\"]. Snort 3 has to be active for this vulnerability to be exploited.\r\n Determine Cisco FTD Software TLS Server Identity Discovery Configuration\r\nTLS server identity discovery is disabled by default.\r\n\r\nDetermine Cisco FTD Software TLS Server Identity Discovery Configuration Using the FTD Software CLI\r\n\r\nTo determine whether TLS server identity discovery is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the show access-control-config command. Scroll down to the Advanced Settings section. If the command output shows TLS Server Identity Discovery Enabled, the device is affected by this vulnerability, as shown in the following example:\r\n\r\n\r\n> show access-control-config\r\n===============[ Advanced Settings ]================ General Settings Maximum URL Length : 1024 Interactive Block Bypass Timeout : 600 SSL Policy : Certificate-Visibility-SSL-Policy TLS Server Identity Discovery : Enabled\r\n\r\nThe following example shows that TLS server identity discovery is disabled:\r\n\r\n\r\n>show access-control-config\r\n===============[ Advanced Settings ]================ General Settings Maximum URL Length : 1024 Interactive Block Bypass Timeout : 600 TLS Server Identity Discovery : Disabled\r\n\r\nNote: Due to CSCvz06256 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz06256\"], this command will not show the TLS server identity discovery setting for the Cisco FTD 7.0 software train.\r\n\r\nDetermine Cisco FTD Software TLS Server Identity Discovery Configuration for Devices Managed by Cisco Firepower Device Manager Software\r\n\r\nTo determine whether TLS server identity discovery is configured on a device that is managed by Cisco Firepower Device Manager (FDM) Software, complete the following steps:\r\n\r\nLog in to the Cisco FDM web interface.\r\nFrom the Policies menu, choose Access Control.\r\nClick on the Settings gear icon.\r\nLocate the TLS Server Identity Discovery setting.\r\nIf the setting is enabled, the device is affected by this vulnerability.\r\nIf the setting is disabled, the device might not be affected by this vulnerability.\r\n\r\n\r\nFor detailed information about TLS server identity discovery, see the Access Control [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html\"] chapter of the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nDetermine Cisco FTD Software TLS Server Identity Discovery Configuration for Devices Managed by Cisco Firepower Management Center Software\r\n\r\nTo determine whether TLS server identity discovery is configured on a device that is managed by Cisco Firepower Management Center (FMC) Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC web interface.\r\nFrom the Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nClick on the Advanced tab.\r\nLocate the TLS Server Identity Discovery setting.\r\nIf the setting is enabled, the device is affected by this vulnerability.\r\nIf the setting is disabled, the device might not be affected by this vulnerability.\r\n\r\n\r\nFor detailed information about TLS server identity discovery, see the Access Control Policy [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html?bookSearch=true#ID-2176-00000314\"] chapter of the Cisco Secure Firewall Management Center Device Configuration Guide.\r\n\r\nDetermine Cisco FTD Software TLS Server Identity Discovery Configuration for Cisco Defense Orchestrator Devices\r\n\r\nTo determine whether TLS server identity discovery is configured on a device that is managed by Cisco Defense Orchestrator Software, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the Cisco Defense Orchestrator Policies menu, choose FTD Policies.\r\nFrom the FTD Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nChoose More and then Click on then Advanced Settings.\r\nLocate the TLS Server Identity Discovery setting.\r\nIf the setting is enabled, the device is affected by this vulnerability.\r\nIf the setting is disabled, the device might not be affected by this vulnerability.\r\n\r\n\r\nFor detailed information about TLS server identity discovery, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n Determine Cisco FTD Software SSL Policy Configuration\r\nSSL decryption policies are not configured by default.\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration Using the FTD Software CLI\r\n\r\nTo determine whether an SSL policy is configured on a device that is running Cisco FTD Software, log in to the Cisco FTD Software CLI and use the show ssl-policy-config command. If the command output shows a policy, the device has an SSL policy applied and is affected by this vulnerability, as shown in the following example:\r\n\r\n\r\n> show ssl-policy-config\r\n===================[ CSCwc07015 ]===================\r\n=================[ Default Action ]=================\r\nDefault Action : Do Not Decrypt\r\n...\r\n\r\nIn the following example, no SSL policy is applied:\r\n\r\n\r\n>show ssl-policy-config\r\nSSL policy not yet applied\r\n\r\n\r\n\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration for Devices Managed by Cisco FDM\r\n\r\nTo determine whether an SSL policy is configured on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD web interface.\r\nFrom the main menu, choose Policies.\r\nChoose the SSL Decryption tab.\r\nIf a Policy Name is listed, the device is affected by this vulnerability.\r\nIf SSL decryption is not enabled, the device might not affected by this vulnerability.\r\n\r\n\r\nFor detailed information about SSL decryption policies, see the SSL Decryption [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.html\"] chapter of the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration for Devices Managed by Cisco FMC Software\r\n\r\nTo determine whether an SSL policy is configured on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC web interface.\r\nFrom the Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nLook in the SSL Policy area.\r\n\r\nIf a Policy Name is listed, the device is affected by this vulnerability.\r\nIf None is listed, the device might not affected by this vulnerability.\r\n\r\n\r\nFor detailed information about SSL decryption policies, see the SSL Policy [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html\"] chapter of the Cisco Secure Firewall Management Center Device Configuration Guide.\r\n\r\nDetermine Cisco FTD Software SSL Policy Configuration for Devices Managed by Cisco Defense Orchestrator\r\n\r\nTo determine whether an SSL policy is configured on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the Cisco Defense Orchestrator Policies menu, choose the FTD Policies.\r\nFrom the FTD Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nLook in the Decryption Policy area.\r\nIf a Policy Name is listed, the device is affected by this vulnerability.\r\nIf None is listed, the device is not affected by this vulnerability.\r\n\r\n\r\nFor detailed information about devices managed by Cisco Defense Orchestrator, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]"
},
{
"category": "general",
"title": "Products Confirmed Not Vulnerable",
"text": "Only products listed in the Vulnerable Products [\"#vp\"] section of this advisory are known to be affected by this vulnerability.\r\n\r\nCisco has confirmed that this vulnerability does not affect the following products:\r\n\r\nCisco Adaptive Security Appliance (ASA) Software\r\nCisco FMC Software\r\nOpen Source Snort 2\r\nOpen Source Snort 3"
},
{
"category": "general",
"title": "Details",
"text": "The following Cisco FTD Software Snort 3 configuration parameters govern how traffic is handled if the Snort 3 process restarts, which could change how encrypted traffic is handled during an exploit of this vulnerability.\r\n\r\nSnort Fail Open\r\nSnort preserve-connection\r\n\r\nFor additional information, see the Snort Restart Traffic Behavior section of the Firepower Management Center Configuration Guide [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html#concept\_uc1\_gtq\_ty\"]or the Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Defense Orchestrator [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_get-started-deployment.html?bookSearch=true#concept\_uc1\_gtq\_ty\"] guide."
},
{
"category": "general",
"title": "Workarounds",
"text": "There is a workaround and mitigations that address this vulnerability. To remove the attack vector for this vulnerability, either revert to Snort 2, or, if remaining on Snort 3, disable both TLS server identity discovery and any configured decryption policy. If either is enabled, the device is still vulnerable.\r\n\r\nNote: For TLS server identity discovery to be enabled, a decryption policy does not need to be configured and associated with the access control policy.\r\n Reverting to Snort 2\r\nBefore reverting to Snort 2, review the Before you Begin section in the Switching Between Snort 2 and Snort 3 [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nNote: Downgrading to Snort 2 will delete customer policies, NAP customizations, and Hostname redirect in active authentications. To discuss the effects of reverting on your deployment, contact the Technical Assistance Center (TAC) [\"https://www.cisco.com/go/tac/\"].\r\n\r\nReverting to Snort 2 for Cisco FTD Devices by Using the CLI\r\n\r\nThere is no option to revert to snort 2 by using the CLI.\r\n\r\nReverting to Snort 2 for Cisco FTD Devices that Are Managed by FDM Software\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco FDM Software, complete the following steps:\r\n\r\nLog in to the Cisco FTD Software web interface.\r\nFrom the main menu, choose Device.\r\nIn the Updates area, choose View Configuration.\r\nIn the Intrusion Rule section, choose Downgrade to 2.0.\r\n\r\nAfter making the changes above, deploy changes to your FTD devices.\r\n\r\nFor detailed information about reverting to Snort 2, see the Switching Between Snort 2 and Snort 3 [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089\"] section in the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\nReverting to Snort 2 for Cisco FTD Devices that Are Managed by FMC Software\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco FMC Software, complete the following steps:\r\n\r\nLog in to the Cisco FMC Software web interface.\r\nFrom the Devices menu, choose Device Management.\r\nChoose the appropriate Cisco FTD device.\r\nClick the Edit pencil icon.\r\nChoose the Device tab.\r\nIn the Inspection Engine area, choose Revert to Snort 2.\r\n\r\nAfter making the changes above, deploy changes to your FTD devices.\r\n\r\nFor detailed information about reverting to Snort 2, see the Snort 3 Inspection Engine [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable\"] chapter of the Cisco Secure Firewall Management Center Snort 3 Configuration Guide.\r\n\r\nReverting to Snort 2 for Cisco FTD devices that Are Managed by Cisco Defense Orchestrator\r\n\r\nTo revert to Snort 2 on a device that is managed by Cisco Defense Orchestrator, complete the following steps:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nIn the navigation bar, click Inventory.\r\nClick the Devices tab.\r\nClick the FTD tab and click the device you want to revert.\r\nIn the Device Actions pane located to the right, click Upgrade.\r\nSet the upgrade toggle to Intrusion Prevention Engine.\r\nClick Revert to Snort Engine 2.0.\r\n\r\nAfter making the changes above, deploy changes to your FTD devices.\r\n\r\nFor detailed information about devices managed by Cisco Defense Orchestrator, see the Cisco Defense Orchestrator documentation. [\"https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html\"]\r\n\r\nFor detailed information about reverting to Snort 2 for Cisco FMC Devices managed with Cisco Defense Orchestrator, see the Snort 3 Inspection Engine [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable\"] chapter of the Cisco Secure Firewall Management Center Snort 3 Configuration Guide.\r\n\r\nFor detailed information about reverting to Snort 2 for Cisco FDM Devices managed with Cisco Defense Orchestrator, see the Revert From Snort 3.0 for FDM-Managed Device [\"https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert\_From\_Snort\_3\_for\_FTD\"] section of Managing FDM Devices with Cisco Defense Orchestrator.\r\n Mitigation for Devices that Are Managed by Cisco FDM Software\r\nFor Cisco FTD devices that stay on Snort 3, both the TLS server identity discovery and SSL policy must be disabled to implement the workaround. Disabling only one item will leave the device vulnerable.\r\n\r\nTo disable the TLS server identity discovery for devices managed by Cisco FDM Software, do the following:\r\n\r\nLog in to the Cisco FDM web interface.\r\nFrom the Policies menu, choose Access Control.\r\nClick on the Settings gear icon.\r\nIf the TLS Server Identity Discovery setting is enabled, disable it and click OK.\r\n\r\nTo disable the SSL Policy for devices managed by Cisco FDM Software, do the following:\r\n\r\nLog in to the Cisco FDM web interface.\r\nFrom the Policies menu, choose SSL Decryption.\r\nIf a policy name is present, disable SSL Decryption.\r\n\r\nAfter changing the policies above, deploy the new policies to your Cisco FTD devices.\r\n\r\nFor more information, see the Access Control Chapter [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html\"] of the Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager.\r\n\r\n Mitigation for Devices that Are Managed by Cisco FMC Software\r\nBoth the TLS server identity discovery and SSL policy must be disabled to implement the workaround. Disabling only one item will leave the device vulnerable.\r\n\r\nTo navigate to the correct configuration page to disable the policies for devices that are managed by Cisco FMC Software, do the following:\r\n\r\nLog in to the Cisco FMC web interface.\r\nFrom the Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nClick on the Advanced tab.\r\n\r\nTo disable the TLS server identity discovery for devices that are managed by Cisco FMC Software, do the following:\r\n\r\nLocate the TLS Server Identity Discovery setting.\r\nIf the setting is enabled, click the Edit pencil icon.\r\nUncheck the Early application detection and URL categorization box and choose OK.\r\nClick Save to save the policy.\r\n\r\nTo disable the SSL Policy for devices that are managed by Cisco FMC Software, do the following:\r\n\r\nLocate the SSL Policy Settings.\r\nIf a policy name is present, click the Edit pencil icon.\r\nIn the Drop-down menu, choose None and then OK\r\nClick Save to save the policy.\r\n\r\nAfter changing the policies above, deploy the new policies to your Cisco FTD devices.\r\n\r\nFor more information, see the Access Control Chapter [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.html\"] of the Firepower Management Center Device Configuration Guide.\r\n Mitigation for Devices that Are Managed by Cisco Defense Orchestrator\r\nBoth the TLS server identity discovery and SSL policy must be disabled to implement the workaround. Disabling only one item will leave the device vulnerable.\r\n\r\nTo navigate to the correct configuration page to disable the policies for devices that are managed by Cisco Defense Orchestrator Software, do the following:\r\n\r\nLog in to the Cisco Defense Orchestrator web interface.\r\nFrom the CDO Policies menu, choose FTD Policies.\r\nFrom the FTD Policies menu, choose Access Control.\r\nChoose the appropriate Access Control Policy.\r\nClick the Edit pencil icon.\r\nChoose More and then Click on then Advanced Settings\r\n\r\nTo disable the TLS server identity discovery for devices that are managed by Cisco Defense Orchestrator software, do the following:\r\n\r\nLocate the TLS Server Identity Discovery setting.\r\nIf the setting is enabled, click the Edit pencil icon.\r\nUncheck the Early application detection and URL categorization box and choose OK.\r\nClick Save to save the policy\r\n\r\nTo disable the SSL Policy for devices that are managed by Cisco Defense Orchestrator software, do the following:\r\n\r\nLocate the Decryption Policy Settings.\r\nIf a policy name is present, click the Edit pencil icon\r\nIn the Drop-down menu, choose None and then OK.\r\nClick Save to save the policy\r\n\r\nAfter changing the policies above, deploy the new policies to your Cisco Defense Orchestrator devices.\r\n\r\nFor more information, see the Cisco Defense Orchestrator documentation [\"https://docs.defenseorchestrator.com/\"].\r\n\r\nWhile these workarounds and mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment."
},
{
"category": "general",
"title": "Fixed Software",
"text": "When considering software upgrades [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes\"], customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories page [\"https://www.cisco.com/go/psirt\"], to determine exposure and a complete upgrade solution.\r\n\r\nIn all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.\r\nFixed ReleasesCisco ASA, FMC, and FTD Software\r\nTo help customers determine their exposure to vulnerabilities in Cisco ASA, FMC, and FTD Software, Cisco provides the Cisco Software Checker [\"https://sec.cloudapps.cisco.com/security/center/softwarechecker.x\"]. This tool identifies any Cisco security advisories that impact a specific software release and the earliest release that fixes the vulnerabilities that are described in each advisory (“First Fixed”). If applicable, the tool also returns the earliest release that fixes all the vulnerabilities that are described in all the advisories that the Software Checker identifies (“Combined First Fixed”).\r\n\r\nTo use the tool, go to the Cisco Software Checker [\"https://sec.cloudapps.cisco.com/security/center/softwarechecker.x\"] page and follow the instructions. Alternatively, use the following form to search for vulnerabilities that affect a specific software release. To use the form, follow these steps:\r\n\r\nChoose which advisories the tool will search—all advisories, only advisories with a Critical or High Security Impact Rating (SIR) [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#asr\"], or only this advisory.\r\nChoose the appropriate software.\r\nChoose the appropriate platform.\r\nEnter a release number—for example, 9.16.2.11 for Cisco ASA Software or 6.6.7 for Cisco FTD Software.\r\nClick Check.\r\n Only this advisoryAll Critical and High advisoriesAll advisoriesCisco ASA SoftwareCisco FMC SoftwareCisco FTD SoftwareAny Platform3000 Series Industrial Security Appliances (ISA)ASA 5500-X Series FirewallsASA Service ModuleAdaptive Security Virtual Appliance (ASAv)Firepower 1000 SeriesFirepower 2100 SeriesFirepower 4100 SeriesFirepower 9000 SeriesFirepower NGFW VirtualSecure Firewall 3100 SeriesFirepower Management Center Appliances\r\n\r\n\r\n\r\n\r\n\r\nFor instructions on upgrading your FTD device, see Cisco Firepower Management Center Upgrade Guide [\"https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting\_started.html\"].\r\n\r\n Additional Resources\r\nFor help determining the best Cisco ASA, FTD, or FMC Software release, see the following Recommended Releases documents. If a security advisory recommends a later release, Cisco recommends following the advisory guidance.\r\n\r\nCisco ASA Compatibility [\"https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html\"]\r\nCisco Secure Firewall ASA Upgrade Guide [\"https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html\"]\r\nCisco Secure Firewall Threat Defense Compatibility Guide [\"https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html\"]"
},
{
"category": "general",
"title": "Vulnerability Policy",
"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"http://www.cisco.com/web/about/security/psirt/security\_vulnerability\_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco."
},
{
"category": "general",
"title": "Exploitation and Public Announcements",
"text": "The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory."
},
{
"category": "general",
"title": "Source",
"text": "This vulnerability was found during the resolution of a Cisco TAC support case."
},
{
"category": "legal\_disclaimer",
"title": "Legal Disclaimer",
"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products."
}
],
"publisher": {
"category": "vendor",
"contact\_details": "psirt@cisco.com",
"issuing\_authority": "Cisco PSIRT",
"name": "Cisco",
"namespace": "https://wwww.cisco.com"
},
"references": [
{
"category": "self",
"summary": "Cisco Firepower Threat Defense Software SSL and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ftd-snort3-8U4HHxH8"
},
{
"category": "external",
"summary": "Cisco Event Response: November 2023 Cisco ASA, FMC, and FTD Software Security Advisory Bundled Publication",
"url": "https://sec.cloudapps.cisco.com/security/center/viewErp.x?alertId=ERP-74985"
},
{
"category": "external",
"summary": "Cisco Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
},
{
"category": "external",
"summary": "Details",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr#details"
},
{
"category": "external",
"summary": "Determine the Active Snort Version that Runs on Firepower Threat Defense (FTD)",
"url": "https://www.cisco.com/c/en/us/support/docs/security/secure-firewall-threat-defense/220415-determine-the-active-snort-version-that.html"
},
{
"category": "external",
"summary": "CSCvz06256",
"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvz06256"
},
{
"category": "external",
"summary": "Access Control",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-access.html"
},
{
"category": "external",
"summary": "Access Control Policy",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/access-policies.html?bookSearch=true#ID-2176-00000314"
},
{
"category": "external",
"summary": "Cisco Defense Orchestrator documentation.",
"url": "https://docs.defenseorchestrator.com/#!g-managing-security-and-network-devices-with-cdo.html"
},
{
"category": "external",
"summary": "SSL Decryption",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/710/fdm/fptd-fdm-config-guide-710/fptd-fdm-ssl-decryption.html"
},
{
"category": "external",
"summary": "SSL Policy",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/encrypted-traffic-policies.html"
},
{
"category": "external",
"summary": "Firepower Management Center Configuration Guide",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/720/management-center-device-config-72/get-started-deployment.html#concept\_uc1\_gtq\_ty"
},
{
"category": "external",
"summary": "Managing Firewall Threat Defense with Cloud-delivered Firewall Management Center in Cisco Defense Orchestrator",
"url": "https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m\_get-started-deployment.html?bookSearch=true#concept\_uc1\_gtq\_ty"
},
{
"category": "external",
"summary": "Switching Between Snort 2 and Snort 3",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/730/fdm/fptd-fdm-config-guide-730/fptd-fdm-intrusion.html?bookSearch=true#id\_120089"
},
{
"category": "external",
"summary": "Technical Assistance Center (TAC)",
"url": "https://www.cisco.com/go/tac/"
},
{
"category": "external",
"summary": "Snort 3 Inspection Engine",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/snort/720/snort3-configuration-guide-v72/migrating.html#concept\_D87B73A83ACA42CCA656F0041F9D860B-enabledisable"
},
{
"category": "external",
"summary": "Revert From Snort 3.0 for FDM-Managed Device",
"url": "https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html?bookSearch=true#Revert\_From\_Snort\_3\_for\_FTD"
},
{
"category": "external",
"summary": "Access Control Chapter",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.html"
},
{
"category": "external",
"summary": "Cisco Defense Orchestrator documentation",
"url": "https://docs.defenseorchestrator.com/"
},
{
"category": "external",
"summary": "considering software upgrades",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes"
},
{
"category": "external",
"summary": "Cisco Security Advisories page",
"url": "https://www.cisco.com/go/psirt"
},
{
"category": "external",
"summary": "Cisco Software Checker",
"url": "https://sec.cloudapps.cisco.com/security/center/softwarechecker.x"
},
{
"category": "external",
"summary": "Security Impact Rating (SIR)",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#asr"
},
{
"category": "external",
"summary": "Cisco Firepower Management Center Upgrade Guide",
"url": "https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting\_started.html"
},
{
"category": "external",
"summary": "Cisco ASA Compatibility",
"url": "https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html"
},
{
"category": "external",
"summary": "Cisco Secure Firewall ASA Upgrade Guide",
"url": "https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade/planning.html"
},
{
"category": "external",
"summary": "Cisco Secure Firewall Threat Defense Compatibility Guide",
"url": "https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html"
},
{
"category": "external",
"summary": "Security Vulnerability Policy",
"url": "http://www.cisco.com/web/about/security/psirt/security\_vulnerability\_policy.html"
}
],
"title": "Cisco Firepower Threat Defense Software SSL and Snort 3 Detection Engine Bypass and Denial of Service Vulnerability",
"tracking": {
"current\_release\_date": "2023-11-01T16:00:00+00:00",
"generator": {
"date": "2024-05-10T23:28:14+00:00",
"engine": {
"name": "TVCE"
}
},
"id": "cisco-sa-ftd-snort3-8U4HHxH8",
"initial\_release\_date": "2023-11-01T16:00:00+00:00",
"revision\_history": [
{
"date": "2023-11-01T15:59:58+00:00",
"number": "1.0.0",
"summary": "Initial public release."
}
],
"status": "final",
"version": "1.0.0"
}
},
"product\_tree": {
"branches": [
{
"name": "Cisco",
"category": "vendor",
"branches": [
{
"name": "Cisco Firepower Threat Defense Software",
"category": "product\_family",
"branches": [
{
"name": "7.0",
"category": "product\_version",
"branches": [
{
"name": "7.0.0",
"category": "service\_pack",
"product": {
"name": "7.0.0",
"product\_id": "CSAFPID-282695"
}
},
{
"name": "7.0.0.1",
"category": "service\_pack",
"product": {
"name": "7.0.0.1",
"product\_id": "CSAFPID-284277"
}
},
{
"name": "7.0.1",
"category": "service\_pack",
"product": {
"name": "7.0.1",
"product\_id": "CSAFPID-284789"
}
},
{
"name": "7.0.1.1",
"category": "service\_pack",
"product": {
"name": "7.0.1.1",
"product\_id": "CSAFPID-286538"
}
},
{
"name": "7.0.2",
"category": "service\_pack",
"product": {
"name": "7.0.2",
"product\_id": "CSAFPID-286930"
}
},
{
"name": "7.0.2.1",
"category": "service\_pack",
"product": {
"name": "7.0.2.1",
"product\_id": "CSAFPID-287122"
}
},
{
"name": "7.0.3",
"category": "service\_pack",
"product": {
"name": "7.0.3",
"product\_id": "CSAFPID-287181"
}
},
{
"name": "7.0.4",
"category": "service\_pack",
"product": {
"name": "7.0.4",
"product\_id": "CSAFPID-290481"
}
},
{
"name": "7.0.5",
"category": "service\_pack",
"product": {
"name": "7.0.5",
"product\_id": "CSAFPID-290663"
}
}
]
},
{
"name": "7.2",
"category": "product\_version",
"branches": [
{
"name": "7.2.0",
"category": "service\_pack",
"product": {
"name": "7.2.0",
"product\_id": "CSAFPID-287081"
}
},
{
"name": "7.2.0.1",
"category": "service\_pack",
"product": {
"name": "7.2.0.1",
"product\_id": "CSAFPID-290469"
}
}
]
}
]
},
{
"name": "Cisco Firepower 2100 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-277392"
}
},
{
"name": "Cisco Firepower 1000 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-277393"
}
},
{
"name": "Cisco ASA 5500-X Series Firewalls",
"category": "product\_name",
"product": {
"name": "Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-277437"
}
},
{
"name": "Cisco 3000 Series Industrial Security Appliances (ISA)",
"category": "product\_name",
"product": {
"name": "Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-277438"
}
},
{
"name": "Cisco Firepower 9000 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-277440"
}
},
{
"name": "Cisco Firepower 4100 Series",
"category": "product\_name",
"product": {
"name": "Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-277441"
}
},
{
"name": "Cisco Secure Firewall Threat Defense Virtual",
"category": "product\_name",
"product": {
"name": "Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-277464"
}
},
{
"name": "Cisco Secure Firewall 3100 Series",
"category": "product\_name",
"product": {
"name": "Cisco Secure Firewall 3100 Series",
"product\_id": "CSAFPID-286865"
}
}
]
}
],
"relationships": [
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-282695:277392"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-282695:277393"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-282695:277437"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-282695:277438"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-282695:277440"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-282695:277441"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-282695:277464"
},
"product\_reference": "CSAFPID-282695",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-284277:277392"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-284277:277393"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-284277:277437"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-284277:277438"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-284277:277440"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-284277:277441"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.0.1 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-284277:277464"
},
"product\_reference": "CSAFPID-284277",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-284789:277392"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-284789:277393"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-284789:277437"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-284789:277438"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-284789:277440"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-284789:277441"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-284789:277464"
},
"product\_reference": "CSAFPID-284789",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-286538:277392"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-286538:277393"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-286538:277437"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-286538:277438"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-286538:277440"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-286538:277441"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.1.1 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-286538:277464"
},
"product\_reference": "CSAFPID-286538",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-286930:277392"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-286930:277393"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-286930:277437"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-286930:277438"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-286930:277440"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-286930:277441"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-286930:277464"
},
"product\_reference": "CSAFPID-286930",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-287122:277392"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-287122:277393"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-287122:277437"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-287122:277438"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-287122:277440"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-287122:277441"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.2.1 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-287122:277464"
},
"product\_reference": "CSAFPID-287122",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-287181:277392"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-287181:277393"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-287181:277437"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-287181:277438"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-287181:277440"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-287181:277441"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.3 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-287181:277464"
},
"product\_reference": "CSAFPID-287181",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-290481:277392"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-290481:277393"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-290481:277437"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-290481:277438"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-290481:277440"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-290481:277441"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.4 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-290481:277464"
},
"product\_reference": "CSAFPID-290481",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-290663:277392"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-290663:277393"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco ASA 5500-X Series Firewalls",
"product\_id": "CSAFPID-290663:277437"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277437"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-290663:277438"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-290663:277440"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-290663:277441"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.0.5 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-290663:277464"
},
"product\_reference": "CSAFPID-290663",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-287081:277392"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-287081:277393"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-287081:277438"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-287081:277440"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-287081:277441"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-287081:277464"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0 when installed on Cisco Secure Firewall 3100 Series",
"product\_id": "CSAFPID-287081:286865"
},
"product\_reference": "CSAFPID-287081",
"relates\_to\_product\_reference": "CSAFPID-286865"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 2100 Series",
"product\_id": "CSAFPID-290469:277392"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277392"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 1000 Series",
"product\_id": "CSAFPID-290469:277393"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277393"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco 3000 Series Industrial Security Appliances (ISA)",
"product\_id": "CSAFPID-290469:277438"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277438"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 9000 Series",
"product\_id": "CSAFPID-290469:277440"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277440"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Firepower 4100 Series",
"product\_id": "CSAFPID-290469:277441"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277441"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Secure Firewall Threat Defense Virtual",
"product\_id": "CSAFPID-290469:277464"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-277464"
},
{
"category": "installed\_on",
"full\_product\_name": {
"name": "Cisco Firepower Threat Defense Software 7.2.0.1 when installed on Cisco Secure Firewall 3100 Series",
"product\_id": "CSAFPID-290469:286865"
},
"product\_reference": "CSAFPID-290469",
"relates\_to\_product\_reference": "CSAFPID-286865"
}
]
},
"vulnerabilities": [
{
"cve": "CVE-2023-20031",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCwc07015"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-282695:277392",
"CSAFPID-282695:277393",
"CSAFPID-282695:277437",
"CSAFPID-282695:277438",
"CSAFPID-282695:277440",
"CSAFPID-282695:277441",
"CSAFPID-282695:277464",
"CSAFPID-284277:277392",
"CSAFPID-284277:277393",
"CSAFPID-284277:277437",
"CSAFPID-284277:277438",
"CSAFPID-284277:277440",
"CSAFPID-284277:277441",
"CSAFPID-284277:277464",
"CSAFPID-284789:277392",
"CSAFPID-284789:277393",
"CSAFPID-284789:277437",
"CSAFPID-284789:277438",
"CSAFPID-284789:277440",
"CSAFPID-284789:277441",
"CSAFPID-284789:277464",
"CSAFPID-286538:277392",
"CSAFPID-286538:277393",
"CSAFPID-286538:277437",
"CSAFPID-286538:277438",
"CSAFPID-286538:277440",
"CSAFPID-286538:277441",
"CSAFPID-286538:277464",
"CSAFPID-286930:277392",
"CSAFPID-286930:277393",
"CSAFPID-286930:277437",
"CSAFPID-286930:277438",
"CSAFPID-286930:277440",
"CSAFPID-286930:277441",
"CSAFPID-286930:277464",
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-287122:277392",
"CSAFPID-287122:277393",
"CSAFPID-287122:277437",
"CSAFPID-287122:277438",
"CSAFPID-287122:277440",
"CSAFPID-287122:277441",
"CSAFPID-287122:277464",
"CSAFPID-287181:277392",
"CSAFPID-287181:277393",
"CSAFPID-287181:277437",
"CSAFPID-287181:277438",
"CSAFPID-287181:277440",
"CSAFPID-287181:277441",
"CSAFPID-287181:277464",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865",
"CSAFPID-290481:277392",
"CSAFPID-290481:277393",
"CSAFPID-290481:277437",
"CSAFPID-290481:277438",
"CSAFPID-290481:277440",
"CSAFPID-290481:277441",
"CSAFPID-290481:277464",
"CSAFPID-290663:277392",
"CSAFPID-290663:277393",
"CSAFPID-290663:277437",
"CSAFPID-290663:277438",
"CSAFPID-290663:277440",
"CSAFPID-290663:277441",
"CSAFPID-290663:277464"
]
},
"release\_date": "2023-11-01T16:00:00+00:00",
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-282695:277392",
"CSAFPID-282695:277393",
"CSAFPID-282695:277437",
"CSAFPID-282695:277438",
"CSAFPID-282695:277440",
"CSAFPID-282695:277441",
"CSAFPID-282695:277464",
"CSAFPID-284277:277392",
"CSAFPID-284277:277393",
"CSAFPID-284277:277437",
"CSAFPID-284277:277438",
"CSAFPID-284277:277440",
"CSAFPID-284277:277441",
"CSAFPID-284277:277464",
"CSAFPID-284789:277392",
"CSAFPID-284789:277393",
"CSAFPID-284789:277437",
"CSAFPID-284789:277438",
"CSAFPID-284789:277440",
"CSAFPID-284789:277441",
"CSAFPID-284789:277464",
"CSAFPID-286538:277392",
"CSAFPID-286538:277393",
"CSAFPID-286538:277437",
"CSAFPID-286538:277438",
"CSAFPID-286538:277440",
"CSAFPID-286538:277441",
"CSAFPID-286538:277464",
"CSAFPID-286930:277392",
"CSAFPID-286930:277393",
"CSAFPID-286930:277437",
"CSAFPID-286930:277438",
"CSAFPID-286930:277440",
"CSAFPID-286930:277441",
"CSAFPID-286930:277464",
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-287122:277392",
"CSAFPID-287122:277393",
"CSAFPID-287122:277437",
"CSAFPID-287122:277438",
"CSAFPID-287122:277440",
"CSAFPID-287122:277441",
"CSAFPID-287122:277464",
"CSAFPID-287181:277392",
"CSAFPID-287181:277393",
"CSAFPID-287181:277437",
"CSAFPID-287181:277438",
"CSAFPID-287181:277440",
"CSAFPID-287181:277441",
"CSAFPID-287181:277464",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865",
"CSAFPID-290481:277392",
"CSAFPID-290481:277393",
"CSAFPID-290481:277437",
"CSAFPID-290481:277438",
"CSAFPID-290481:277440",
"CSAFPID-290481:277441",
"CSAFPID-290481:277464",
"CSAFPID-290663:277392",
"CSAFPID-290663:277393",
"CSAFPID-290663:277437",
"CSAFPID-290663:277438",
"CSAFPID-290663:277440",
"CSAFPID-290663:277441",
"CSAFPID-290663:277464"
],
"url": "https://software.cisco.com"
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 4.0,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N",
"version": "3.1"
},
"products": [
"CSAFPID-282695:277392",
"CSAFPID-282695:277393",
"CSAFPID-282695:277437",
"CSAFPID-282695:277438",
"CSAFPID-282695:277440",
"CSAFPID-282695:277441",
"CSAFPID-282695:277464",
"CSAFPID-284277:277392",
"CSAFPID-284277:277393",
"CSAFPID-284277:277437",
"CSAFPID-284277:277438",
"CSAFPID-284277:277440",
"CSAFPID-284277:277441",
"CSAFPID-284277:277464",
"CSAFPID-284789:277392",
"CSAFPID-284789:277393",
"CSAFPID-284789:277437",
"CSAFPID-284789:277438",
"CSAFPID-284789:277440",
"CSAFPID-284789:277441",
"CSAFPID-284789:277464",
"CSAFPID-286538:277392",
"CSAFPID-286538:277393",
"CSAFPID-286538:277437",
"CSAFPID-286538:277438",
"CSAFPID-286538:277440",
"CSAFPID-286538:277441",
"CSAFPID-286538:277464",
"CSAFPID-286930:277392",
"CSAFPID-286930:277393",
"CSAFPID-286930:277437",
"CSAFPID-286930:277438",
"CSAFPID-286930:277440",
"CSAFPID-286930:277441",
"CSAFPID-286930:277464",
"CSAFPID-287081:277392",
"CSAFPID-287081:277393",
"CSAFPID-287081:277438",
"CSAFPID-287081:277440",
"CSAFPID-287081:277441",
"CSAFPID-287081:277464",
"CSAFPID-287081:286865",
"CSAFPID-287122:277392",
"CSAFPID-287122:277393",
"CSAFPID-287122:277437",
"CSAFPID-287122:277438",
"CSAFPID-287122:277440",
"CSAFPID-287122:277441",
"CSAFPID-287122:277464",
"CSAFPID-287181:277392",
"CSAFPID-287181:277393",
"CSAFPID-287181:277437",
"CSAFPID-287181:277438",
"CSAFPID-287181:277440",
"CSAFPID-287181:277441",
"CSAFPID-287181:277464",
"CSAFPID-290469:277392",
"CSAFPID-290469:277393",
"CSAFPID-290469:277438",
"CSAFPID-290469:277440",
"CSAFPID-290469:277441",
"CSAFPID-290469:277464",
"CSAFPID-290469:286865",
"CSAFPID-290481:277392",
"CSAFPID-290481:277393",
"CSAFPID-290481:277437",
"CSAFPID-290481:277438",
"CSAFPID-290481:277440",
"CSAFPID-290481:277441",
"CSAFPID-290481:277464",
"CSAFPID-290663:277392",
"CSAFPID-290663:277393",
"CSAFPID-290663:277437",
"CSAFPID-290663:277438",
"CSAFPID-290663:277440",
"CSAFPID-290663:277441",
"CSAFPID-290663:277464"
]
}
],
"title": "Cisco Firepower Threat Defense Software Snort 3 Detection Engine Bypass and Denial of Service Vulnerability"
}
]
}

=== Content from www.cisco.com_bd8eb837_20250115_120507.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Compatibility Information](/c/en/us/support/security/firepower-ngfw/products-device-support-tables-list.html)
# Cisco Secure Firewall Threat Defense Compatibility Guide

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.html) to Save Content

Translations

Download
Print

### Available Languages

### Download Options

* [PDF](/c/en/us/td/docs/security/secure-firewall/compatibility/threat-defense-compatibility.pdf)
  (375.7 KB)

  View with Adobe Reader on a variety of devices

Updated:January 13, 2025

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

# Cisco Secure Firewall Threat Defense Compatibility Guide

---

## Contents

* [Cisco
  Secure
  Firewall Threat Defense
  Compatibility Guide](#id_56932)
* [Suggested Release: Version 7.4.2](#Cisco_Reference.dita_51152350-7ccd-44e0-90be-cec52bebb020)
* [Threat Defense Platform Summary](#Cisco_Reference.dita_3c3a7148-33f3-4668-834c-ba9eca097785)
* [Threat Defense Hardware](#Cisco_Reference.dita_6d37561b-cfbc-4ce9-b7c9-efbb294bf3df)
* [Firepower 1000/2100 Series](#id_60525)
* [Secure Firewall 1200 Series](#r_ftd-1200)
* [Secure Firewall 3100/4200 Series](#r_ftd-3100-4200)
* [Firepower 4100/9300](#reference_6DF211D8F60F423387D0316000333539)
* [ASA 5500-X Series and ISA 3000](#id_34136)
* [Threat Defense Virtual](#id_37873)
* [Threat Defense High Availability and Clustering](#r_ftd-ha-scalability)
* [Threat Defense Management](#d54e7569a1635)
* [On-Prem Management Center](#device-management-onprem)
* [Cloud-delivered Firewall Management Center](#device-management-cloud)
* [Device Manager](#device-management-fdm)
* [Bundled Components](#id_67425)
* [Integrated Products](#reference_FB6BAC2CFBF446D5BA2CDD0E81F51C41)
* [Browser Requirements](#Cisco_Concept.dita_18039f61-fd2b-4b9f-ae6c-9fb2fa886dfd)
* [End-of-Life Announcements](#id_85448)
* [Terminology and Branding](#reference_9C7ED89DF14645BDA166E80F7BDA5FB7)

**First Published: May 5, 2022**

**Last Updated: January 13, 2025**

# Cisco Secure Firewall Threat Defense Compatibility Guide

This guide provides software and hardware compatibility for Cisco Secure
Firewall Threat Defense. For related compatibility guides, see the following table.

| **Note** | ---   Not all software versions, especially patches, apply to all platforms. A quick way to tell if a version is supported is that its upgrade/installation packages are posted on the Cisco Support & Download site. If the site is "missing" an upgrade or installation package, that version is not supported. You can also check the release notes and [End-of-Life Announcements](#id_85448). If you feel a version is missing in error, contact Cisco TAC.   --- |
| --- | --- |

Table 1. Additional Resources

| **Description** | **Resources** |
| --- | --- |
| ***Sustaining bulletins*** provide support timelines for the Cisco Next Generation Firewall product line, including management platforms and operating systems. | [Cisco NGFW Product Line Software Release and Sustaining Bulletin](https://www.cisco.com/c/en/us/products/collateral/security/firewalls/bulletin-c25-743178.html) |
| ***Compatibility guides*** provide detailed compatibility information for supported hardware models and software versions, including bundled components and integrated products. | [Cisco Secure Firewall Management Center Compatibility Guide](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/compatibility/management-center-compatibility.html)  [Cisco Firepower 4100/9300 FXOS Compatibility](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/compatibility/fxos-compatibility.html) |
| ***Release notes*** provide critical and release-specific information, including upgrade warnings and behavior changes. Release notes also contain quicklinks to upgrade and installation instructions. | [Cisco Secure Firewall Threat Defense Release Notes](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-release-notes-list.html)  [Cisco Firepower 4100/9300 FXOS Release Notes](https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html) |
| ***New Feature guides*** provide information on new and deprecated features by release. | [Cisco Secure Firewall Management Center New Features by Release](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/roadmap/management-center-new-features-by-release.html)  [Cisco Secure Firewall Device Manager New Features by Release](https://www.cisco.com/c/en/us/td/docs/security/firepower/roadmap/fdm-new-features/firepower-device-manager-new-features-by-release.html) |
| ***Documentation roadmaps*** provide links to currently available and legacy documentation. Try the roadmaps if what you are looking for is not listed above. | [Navigating the Cisco Secure Firewall Threat Defense Documentation](https://www.cisco.com/c/en/us/td/docs/security/firepower/roadmap/firepower-roadmap.html)  [Navigating the Cisco FXOS Documentation](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/roadmap/fxos-roadmap.html) |

## Suggested Release: Version 7.4.2

To take advantage of new features and resolved issues, we recommend you upgrade all
eligible appliances to at least the suggested release, including the latest patch.
On the Cisco Support & Download
site, the suggested release is marked with a gold star. In Version 7.2.6+/7.4.1+, the
management center notifies you when a new suggested release is available, and
indicates suggested releases on its product upgrades page.

### Suggested Releases for Older Appliances

If an appliance is too old to run the suggested release and you do not plan to
refresh the hardware right now, choose a major version then patch as far as
possible. Some major versions are designated *long-term* or *extra
long-term*, so consider one of those. For an explanation of these terms, see
[Cisco NGFW Product Line Software
Release and Sustaining Bulletin](https://www.cisco.com/c/en/us/products/collateral/security/firewalls/bulletin-c25-743178.html).

If you are interested in a hardware refresh, contact your Cisco representative or
partner contact.

## Threat Defense Platform Summary

These tables summarize the supported devices and on-prem (customer-deployed)
management methods for threat
defense.

| **Note** | ---   The cloud-delivered Firewall Management Center can manage threat defense 7.0.3 to 7.6.0 (except 7.1). For Security Cloud Control with device manager, you must be running at least threat defense 6.4.   --- |
| --- | --- |

### Threat Defense Hardware

Table 2. Secure Firewall Threat
Defense Hardware by Manager and Version

| **Device Platform** | **Device Versions: With On-Prem Management Center** | **Device Versions: With Device Manager** |
| --- | --- | --- |
| Firepower 1010, 1120, 1140 | 6.4+ | 6.4+ |
| Firepower 1010E | 7.2.3+  No support in 7.3 | 7.2.3+  No support in 7.3 |
| Firepower 1150 | 6.5+ | 6.5+ |
| Secure Firewall 1210, 1220 | 7.6+ | 7.6+ |
| Firepower 2110, 2120, 2130, 2140 | 6.2.1 to 7.4 | 6.2.1 to 7.4 |
| Secure Firewall 3105 | 7.3.1+ | 7.3.1+ |
| Secure Firewall 3110, 3120, 3130, 3140 | 7.1+ | 7.1+ |
| Firepower 4110, 4120, 4140 | 6.0.1 to 7.2 | 6.5 to 7.2 |
| Firepower 4150 | 6.1 to 7.2 | 6.5 to 7.2 |
| Firepower 4115, 4125, 4145 | 6.4+ | 6.5+ |
| Firepower 4112 | 6.6+ | 6.6+ |
| Secure Firewall 4215, 4225, 4245 | 7.4.0+ | — |
| Firepower 9300: SM-24, SM-36, SM-44 | 6.0.1 to 7.2 | 6.5 to 7.2 |
| Firepower 9300: SM-40, SM-48, SM-56 | 6.4+ | 6.5+ |
| ISA 3000 | 6.2.3+ | 6.2.3+ |
| ASA 5506-X, 5506H-X, 5506W-X | 6.0.1 to 6.2.3 | 6.1 to 6.2.3 |
| ASA 5508-X, 5516-X | 6.0.1 to 7.0 | 6.1 to 7.0 |
| ASA 5512-X | 6.0.1 to 6.2.3 | 6.1 to 6.2.3 |
| ASA 5515-X | 6.0.1 to 6.4 | 6.1 to 6.4 |
| ASA 5525-X, 5545-X, 5555-X | 6.0.1 to 6.6 | 6.1 to 6.6 |

### Threat Defense Virtual

Table 3. Threat Defense Virtual by Manager and Version

| **Device Platform** | **Device Versions: With On-Prem Management Center** | **Device Versions: With Device Manager** |
| --- | --- | --- |
| **Public Cloud** | | |
| AWS | 6.0.1+ | 6.6+ |
| Azure | 6.2+ | 6.5+ |
| GCP | 6.7+ | 7.2+ |
| OCI | 6.7+ | — |
| Megaport | 7.2.8+ | 7.2.8+ |
| **On-Prem/Private Cloud** | | |
| HyperFlex | 7.0+ | 7.0+ |
| KVM | 6.1+ | 6.2.3+ |
| Nutanix | 7.0+ | 7.0+ |
| OpenStack | 7.0+ | — |
| VMware 8.0 | 7.4.2+ | 7.4.2+ |
| VMware 7.0 | 7.0+ | 7.0+ |
| VMware 6.7 | 6.5+ | 6.5+ |
| VMware 6.5 | 6.2.3+ | 6.2.3+ |
| VMware 6.0 | 6.0 to 6.7 | 6.2.2 to 6.7 |
| VMware 5.5 | 6.0.1 to 6.2.3 | 6.2.2 to 6.2.3 |
| VMware 5.1 | 6.0.1 only | — |

## Threat Defense Hardware

### Firepower 1000/2100 Series

Firepower 1000/2100 series devices use the FXOS operating
system. Upgrading threat defense automatically upgrades FXOS. For information on bundled
FXOS versions, see [Bundled Components](#id_67425). These devices can also run ASA instead of threat defense; see [Cisco Secure Firewall ASA
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

Table 4. Firepower 1000/2100 Series Compatibility

| **Threat Defense** | **Firepower 1150** | **Firepower 1010E** | **Firepower 1010**  **Firepower 1120**  **Firepower 1140** | **Firepower 2110**  **Firepower 2120**  **Firepower 2130**  **Firepower 2140** |
| --- | --- | --- | --- | --- |
| 7.6 | **YES** | **YES** | **YES** | — |
| 7.4.1–7.4.x | **YES** | **YES** | **YES** | **YES** |
| 7.4.0 | — | — | — | — |
| 7.3 | **YES** | — | **YES** | **YES** |
| 7.2 | **YES** | **YES**  Requires 7.2.3+ | **YES** | **YES** |
| 7.1 | **YES** | — | **YES** | **YES** |
| 7.0 | **YES** | — | **YES** | **YES** |
| 6.7 | **YES** | — | **YES** | **YES** |
| 6.6 | **YES** | — | **YES** | **YES** |
| 6.5 | **YES** | — | **YES** | **YES** |
| 6.4 | — | — | **YES** | **YES** |
| 6.3 | — | — | — | **YES** |
| 6.2.3 | — | — | — | **YES** |
| 6.2.2 | — | — | — | **YES** |
| 6.2.1 | — | — | — | **YES** |

### Secure Firewall 1200 Series

Secure Firewall 1200 series devices use the FXOS operating system. Upgrading threat
defense automatically upgrades FXOS. For information on bundled FXOS versions, see
[Bundled Components](#id_67425). These devices can also run ASA instead of threat defense; see
[Cisco Secure Firewall ASA
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

Table 5. Secure Firewall 1200 Series Compatibility

| **Threat Defense** | **Secure Firewall 1210**  **Secure Firewall 1220** |
| --- | --- |
| 7.6 | **YES** |

### Secure Firewall 3100/4200 Series

Secure Firewall 3100/4200 series devices use the FXOS operating system. How FXOS is upgraded depends on
whether the device is in application mode or multi-instance mode. These devices can
also run ASA instead of threat defense; see [Cisco Secure Firewall ASA
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/asa/compatibility/asamatrx.html).

#### Application Mode

In application mode, upgrading threat
defense automatically upgrades FXOS. For information on bundled FXOS versions, see [Bundled Components](#id_67425).

Table 6. Secure Firewall 3100/4200 Series Application Mode Compatibility

| **Threat Defense** | **Secure Firewall 4215**  **Secure Firewall 4225**  **Secure Firewall 4245** | **Secure Firewall 3105** | **Secure Firewall 3110**  **Secure Firewall 3120**  **Secure Firewall 3130**  **Secure Firewall 3140** |
| --- | --- | --- | --- |
| 7.6 | **YES** | **YES** | **YES** |
| 7.4.1–7.4.x | **YES** | **YES** | **YES** |
| 7.4.0 | **YES** | — | — |
| 7.3 | — | **YES** | **YES** |
| 7.2 | — | — | **YES** |
| 7.1 | — | — | **YES** |

#### Multi-Instance Mode

In multi-instance mode, you upgrade the chassis (FXOS and firmware) and threat
defense separately. However, one package contains both components. It is possible to
have a chassis-only upgrade or a threat defense-only upgrade. For information on
bundled FXOS versions, see [Bundled Components](#id_67425).

Although you can run older threat defense instances on a newer
FXOS, new features and resolved issues
often require a full upgrade.

Table 7. Secure Firewall 3100/4200 Series Multi-Instance Mode Compatibility

| **Threat Defense** | **Secure Firewall 4215**  **Secure Firewall 4225**  **Secure Firewall 4245** | **Secure Firewall 3110**  **Secure Firewall 3120**  **Secure Firewall 3130**  **Secure Firewall 3140** |
| --- | --- | --- |
| 7.6 | **YES** | **YES** |
| 7.4.1–7.4.x | — | **YES** |

### Firepower 4100/9300

For the Firepower 4100/9300, major threat
defense versions have a specially qualified and recommended companion FXOS version,
listed below in **bold**. Use these combinations whenever possible, because we
perform enhanced testing for them. Note that the table lists the minimum build for
each FXOS version, but in most cases we recommend the latest. For more information,
see the [Cisco Firepower 4100/9300 FXOS Release
Notes](https://www.cisco.com/c/en/us/support/security/firepower-9000-series/products-release-notes-list.html).

| **Note** | ---   Although we document that FXOS 2.14.1.163+ is required for threat defense 7.4.x, this is for reimaging to 7.4.2+. If you are already running an earlier FXOS 2.14.1 build, you can successfully upgrade to 7.4.2+ without upgrading FXOS ([CSCwf64429](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwf64429)).   --- |
| --- | --- |

These devices can also run ASA instead of threat
defense. With ASA 9.12+ and threat
defense 6.4.0+, you can run both ASA and threat
defense on separate modules in the same Firepower 9300 chassis. For more information, see
[Cisco Firepower 4100/9300 FXOS
Compatibility](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/compatibility/fxos-compatibility.html).

Table 8. Firepower 4100/9300 Compatibility

| **Threat Defense** | **FXOS** | **Firepower 9300** | | **Firepower 4100 Series** | | | |
| --- | --- | --- | --- | --- | --- | --- | --- |
| **SM-24**  **SM-36**  **SM-44** | **SM-40**  **SM-48**  **SM-56** | **4110**  **4120**  **4140** | **4150** | **4112** | **4115**  **4125**  **4145** |
| 7.6 | **2.16.0.128+** | — | **YES** | — | — | **YES** | **YES** |
| 7.4.1–7.4.x | **2.14.1.163+**  2.16.0.128+ | — | **YES** | — | — | **YES** | **YES** |
| 7.4.0 | — | — | — | — | — | — | — |
| 7.3 | **2.13.0.198+**  2.14.1.163+  2.16.0.128+ | — | **YES** | — | — | **YES** | **YES** |
| 7.2 | **2.12.0.31+**  2.13.0.198+  2.14.1.163+  2.16.0.128+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 7.1 | **2.11.1.154+**  2.12.0.31+  2.13.0.198+  2.14.1.163+  2.16.0.128+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 7.0 | **2.10.1.159+**  2.11.1.154+  2.12.0.31+  2.13.0.198+  2.14.1.163+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 6.7 | **2.9.1.131+**  2.10.1.159+  2.11.1.154+  2.12.0.31+  2.13.0.198+  2.14.1.163+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 6.6 | **2.8.1.105+**  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+  2.13.0.198+  2.14.1.163+ | **YES**  no 2.13+ | **YES** | **YES**  no 2.13+ | **YES**  no 2.13+ | **YES** | **YES** |
| 6.5 | **2.7.1.92+**  2.8.1.105+  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+ | **YES** | **YES** | **YES** | **YES** | — | **YES** |
| 6.4 | **2.6.1.157+**  2.7.1.92+  2.8.1.105+  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+ | **YES** | **YES** | **YES** | **YES** | — | **YES** |
| 6.3 | **2.4.1.214+**  2.6.1.157+  2.7.1.92+  2.8.1.105+  2.9.1.131+  2.10.1.159+  2.11.1.154+  2.12.0.31+ | **YES** | — | **YES** | **YES** | — | — |
| 6.2.3 | **2.3.1.73+**  2.4.1.214+  2.6.1.157+  2.7.1.92+  2.8.1.105+   | **Note** | Firepower 6.2.3.16+ requires FXOS 2.3.1.157+. | | --- | --- | | **YES** | — | **YES** | **YES** | — | — |
| 6.2.2 | **2.2.2.x**  2.3.1.73+  2.4.1.214+  2.6.1.157+  2.7.1.92+ | **YES** | — | **YES** | **YES** | — | — |
| 6.2.1 | — | — | — | — | — | — | — |
| 6.2.0 | **2.1.1.x**, **2.2.1.x**, **2.2.2.x**  2.3.1.73+  2.4.1.214+  2.6.1.157+ | **YES** | — | **YES** | **YES** | — | — |
| 6.1 | **2.0.1.x**  2.1.1.x  2.3.1.73+ | **YES** | — | **YES** | **YES** | — | — |
| 6.0.1 | **1.1.4.x**  2.0.1.x | **YES** | — | **YES** | — | — | — |

### ASA 5500-X Series and ISA 3000

ASA 5500-X series and ISA 3000 devices use the ASA operating
system. Upgrading threat
defense automatically upgrades ASA. For information on the bundled ASA versions, see [Bundled Components](#id_67425).

Version 7.0 is the last major threat
defense release that supports ASA 5500-X series devices.

Table 9. ASA 5500-X Series and ISA 3000
Compatibility

| **Threat Defense** | **ISA 3000** | **ASA 5508-X**  **ASA 5516-X** | **ASA 5525-X**  **ASA 5545-X**  **ASA 5555-X** | **ASA 5515-X** | **ASA 5506-X**  **ASA 5506H-X**  **ASA 5506W-X**  **ASA 5512-X** |
| --- | --- | --- | --- | --- | --- |
| 7.6 | **YES** | — | — | — | — |
| 7.4.1–7.4.x | **YES** | — | — | — | — |
| 7.4.0 | — | — | — | — | — |
| 7.3 | **YES** | — | — | — | — |
| 7.2 | **YES** | — | — | — | — |
| 7.1 | **YES** | — | — | — | — |
| 7.0 | **YES** | **YES** | — | — | — |
| 6.7 | **YES** | **YES** | — | — | — |
| 6.6 | **YES** | **YES** | **YES** | — | — |
| 6.5 | **YES** | **YES** | **YES** | — | — |
| 6.4 | **YES** | **YES** | **YES** | **YES** | — |
| 6.3 | **YES** | **YES** | **YES** | **YES** | — |
| 6.2.3 | **YES** | **YES** | **YES** | **YES** | **YES** |
| 6.2.2 | — | **YES** | **YES** | **YES** | **YES** |
| 6.2.1 | — | — | — | — | — |
| 6.2.0 | — | **YES** | **YES** | **YES** | **YES** |
| 6.1 | — | **YES** | **YES** | **YES** | **YES** |
| 6.0.1 | — | **YES** | **YES** | **YES** | **YES** |

## Threat Defense Virtual

Table 10. Threat Defense Virtual Compatibility: Public Cloud

| **Threat Defense Virtual** | **Amazon Web Services (AWS)** | **Microsoft Azure (Azure)** | **Google Cloud Platform (GCP)** | Megaport Virtual Edge (Megaport) | **Oracle Cloud Infrastructure (OCI)** |
| --- | --- | --- | --- | --- | --- |
| 7.6 | **YES** | **YES** | **YES** | **YES** | **YES** |
| 7.4.1–7.4.x | **YES** | **YES** | **YES** | **YES** | **YES** |
| 7.4.0 | — | — | — | — | — |
| 7.3 | **YES** | **YES** | **YES** | **YES** | **YES** |
| 7.2 | **YES** | **YES** | **YES** | **YES**  Requires 7.2.8+ | **YES** |
| 7.1 | **YES** | **YES** | **YES** | — | **YES** |
| 7.0 | **YES** | **YES** | **YES** | — | **YES** |
| 6.7 | **YES** | **YES** | **YES** | — | **YES** |
| 6.6 | **YES** | **YES** | — | — | — |
| 6.6 | **YES** | **YES** | — | — | — |
| 6.4 | **YES** | **YES** | — | — | — |
| 6.3 | **YES** | **YES** | — | — | — |
| 6.2.3 | **YES** | **YES** | — | — | — |
| 6.2.2 | **YES** | **YES** | — | — | — |
| 6.2.1 | — | — | — | — | — |
| 6.2 | **YES** | **YES** | — | — | — |
| 6.1 | **YES** | — | — | — | — |
| 6.0.1 | **YES** | — | — | — | — |

Table 11. Threat Defense Virtual Compatibility: On-Prem/Private Cloud

| **Threat Defense Virtual** | **VMware vSphere/VMware ESXi** | **Cisco HyperFlex (HyperFlex)** | **Kernel-Based Virtual Machine (KVM)** | **Nutanix Enterprise Cloud (Nutanix)** | **OpenStack** |
| --- | --- | --- | --- | --- | --- |
| 7.6 | **YES**  VMware 6.5, 6.7, 7.0, 8.0 | **YES** | **YES** | **YES** | **YES** |
| 7.4.2–7.4.x | **YES**  VMware 6.5, 6.7, 7.0, 8.0 | **YES** | **YES** | **YES** | **YES** |
| 7.4.1 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.4.0 | — | — | — | — | — |
| 7.3 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.2 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.1 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 7.0 | **YES**  VMware 6.5, 6.7, 7.0 | **YES** | **YES** | **YES** | **YES** |
| 6.7 | **YES**  VMware 6.0, 6.5, 6.7 | — | **YES** | — | — |
| 6.6 | **YES**  VMware 6.0, 6.5, 6.7 | — | **YES** | — | — |
| 6.5 | **YES**  VMware 6.0, 6.5, 6.7 | — | **YES** | — | — |
| 6.4 | **YES**  VMware 6.0, 6.5 | — | **YES** | — | — |
| 6.3 | **YES**  VMware 6.0, 6.5 | — | **YES** | — | — |
| 6.2.3 | **YES**  VMware 5.5, 6.0, 6.5 | — | **YES** | — | — |
| 6.2.2 | **YES**  VMware 5.5, 6.0 | — | **YES** | — | — |
| 6.2.1 | — | — | — | — | — |
| 6.2.0 | **YES**  VMware 5.5, 6.0 | — | **YES** | — | — |
| 6.1 | **YES**  VMware 5.5, 6.0 | — | **YES** | — | — |
| 6.0.1 | **YES**  VMware 5.1, 5.5 | — | — | — | — |

## Threat Defense High Availability and Clustering

These tables list threat defense support for high availability and clustering. For
threat defense hardware, support differs depending on whether you are using
standalone devices (also called native instances or application mode) or container
instances (also called multi-instance mode). Threat defense virtual does not support
container instances.

### Standalone Devices

This table lists threat defense hardware support for high availability and clustering
with standalone devices. In management center deployments, all threat defense
hardware supports high availability. For device manager, high availability support
begins in Version 6.3 and clustering is not supported.

Table 12. Hardware Standalone Devices: High Availability and Clustering Support

| **Platform** | **High Availability** | **Clustering** |
| --- | --- | --- |
| Firepower 1000 | **YES** | — |
| Secure Firewall 1200 | **YES** | — |
| Firepower 2100 | **YES** | — |
| Secure Firewall 3100 | **YES** | 7.6+ (16 node)  7.1+ (8 node) |
| Secure Firewall 4200 | **YES** | 7.6+ (16 node)  7.4+ (8 node) |
| Firepower 4100 | **YES** | 7.2+ (16 node)  6.2+ (6 node) |
| Firepower 9300 | **YES** | 7.2+ (16 node)  6.2+ (6 node)  Intra-chassis clustering (3 node) is also supported in all versions. |
| ASA 5500-X | **YES** | — |
| ISA 3000 | **YES** | — |

This table lists threat defense virtual support for high availability (with
management center or device manager) and clustering (management center
only).

Table 13. Virtual Standalone Devices: High Availability and Clustering Support

| **Platform** | **High Availability** | **Clustering** |
| --- | --- | --- |
| **Public Cloud** | | |
| AWS | — | 7.2+ (16 node) |
| Azure | — | 7.3+ (16 node) |
| GCP | — | 7.3+ (16 node) |
| Megaport | 7.2.8+ | — |
| OCI | — | — |
| **On-Prem/Private Cloud** | | |
| HyperFlex | — | — |
| KVM | 7.3+ | 7.4.1+ (16 node)  7.2+ (4 node) |
| Nutanix | — | — |
| OpenStack | — | — |
| VMware | 6.7+ | 7.4.1+ (16 node)  7.2+ (4 node) |

### Container Instances

This table lists support for high availability and clustering with container
instances, which is available on select threat defense hardware in management center
deployments only.

Table 14. Container Instances: High Availability and Clustering Support

| **Platform** | **High Availability** | **Clustering** |
| --- | --- | --- |
| Secure Firewall 3100 series | 7.4.1+ | — |
| Secure Firewall 4200 series | 7.6+ | — |
| Firepower 4100 series | 6.3+ | 7.2+ (16 node)  6.6+ (6 node) |
| Firepower 9300 | 6.3+ | 7.2+ (16 node)  6.6+ (6 node)  Intra-chassis clustering (3 node) is also supported in Version 6.6+. |

Threat Defense Management

## On-Prem Management Center

All devices support remote management with a customer-deployed (*on-prem*)
management center.

Versions are major (A.x), maintenance (A.x.y), or patch (A.x.y.z). The management
center should run the same or newer version as its devices. New features and
resolved issues often require the latest version on both the management center and its devices, including patches. Upgrade the management center first—you will still be able to manage older devices, usually a few major
versions
back

| **Note** | ---   You cannot upgrade a device past the management center to a newer major or maintenance version. Although a patched device (fourth-digit) can be managed with an unpatched management center, fully patched deployments undergo enhanced testing.   --- |
| --- | --- |

Note
that in most cases you can upgrade an older device directly to the management center's major or maintenance version. However, sometimes you can manage an older
device that you cannot directly upgrade, even though the target version is
supported on the device. And rarely, there are issues with specific management center-device combinations. For release-specific requirements, see the release
notes.

Table 15. On-Prem Management
Center-Device Compatibility

| **Management Center Version** | **Oldest Device Version You Can Manage** |
| --- | --- |
| 7.6 | 7.1 |
| 7.4  Last support for NGIPS device management. | 7.0 |
| 7.3 | 6.7 |
| 7.2 | 6.6 |
| 7.1 | 6.5 |
| 7.0 | 6.4 |
| 6.7 | 6.3 |
| 6.6 | 6.2.3 |
| 6.5 | 6.2.3 |
| 6.4 | 6.1 |
| 6.3 | 6.1 |
| 6.2.3 | 6.1 |
| 6.2.2 | 6.1 |
| 6.2.1 | 6.1 |
| 6.2 | 6.1 |
| 6.1 | 5.4.0.2/5.4.1.1 |
| 6.0.1 | 5.4.0.2/5.4.1.1 |
| 6.0 | 5.4.0.2/5.4.1.1 |
| 5.4.1 | 5.4.1 for ASA FirePOWER on the ASA-5506-X series, ASA5508-X, and ASA5516-X.  5.3.1 for ASA FirePOWER on the ASA5512-X, ASA5515-X, ASA5525-X, ASA5545-X, ASA5555-X, and ASA-5585-X series.  5.3.0 for Firepower 7000/8000 series and legacy devices. |

## Cloud-delivered Firewall Management Center

The cloud-delivered Firewall Management Center can manage threat
defense devices running **Version 7.0.3 to 7.6.0 (except Version 7.1)**.

You can co-manage a cloud-managed device with a Version 7.2+ on-prem management center for event logging and analytics purposes only. Or, you can send security events
to the Cisco cloud with Security
Analytics and Logging (SaaS).

### Co-managing Devices with an Analytics Management Center

The cloud-delivered Firewall
Management Center supports a wider range of managed device versions than on-prem management
centers. This can cause issues if you use an on-prem management center for
analytics because devices can be "too old" or "too new" to co-manage.

You can be prevented from:

* Registering newer devices to the analytics management center because
  older devices are blocking the required management center upgrade.
* Upgrading co-managed devices to the latest release, because the analytics
  management center is "stuck" at an older release.
* Reverting device upgrade, if revert would take the device out of
  compatibility with the analytics management center.

For example, consider a scenario where you want to add co-managed Version 7.6.0
devices to a deployment that currently includes co-managed Version 7.0.x
devices. The cloud-delivered Firewall
Management Center can manage this full range of devices, but the on-prem analytics management
center cannot.

In order of preference, you can:

* Upgrade the Version 7.0.x devices to at least Version 7.2.0, upgrade the
  analytics management center to Version 7.6.0, then add the Version 7.6.0
  devices to both management centers.
* Remove the Version 7.0.x devices from the analytics management center,
  upgrade the analytics management center to Version 7.6.0, then add the
  Version 7.6.0 devices to both management centers.
* Leave the analytics management center as it is and do not add your
  Version 7.6.0 devices.

That is, your choices are:

* To get events from all devices, upgrade (or replace) the analytics
  management center and your older devices.
* To forgo events from older devices, upgrade (or replace) the analytics
  management center only.
* To forgo events from newer devices, leave the analytics management center
  at an older release.

## Device Manager

You can use device
manager to locally manage a single threat
defense device. Most models suppport local management.

Optionally, add Cisco Security Cloud Control to remotely manage multiple threat
defense devices, as an alternative to the management center. Although some configurations still require device
manager, Security Cloud Control allows you to establish and maintain consistent security policies across your threat
defense deployment.

## Bundled Components

These tables list the versions of various
components bundled with threat
defense. Use this information to identify open or resolved bugs in bundled components
that may affect your deployment.

Note that sometimes we release updated builds for select releases. If bundled
components change from build to build, we list the components in the *latest*
build. (In most cases, only the latest build is available for
download.)
For details on new builds and the issues they resolve, see the release notes for
your version.

### Operating Systems

ASA 5500-X series and ISA 3000 devices use the ASA operating system. Firepower
1000/2100, Secure Firewall 1200, and Secure Firewall 3100/4200 series devices use
the FXOS operating system. For the Firepower 4100/9300, see [Firepower 4100/9300](#reference_6DF211D8F60F423387D0316000333539).

Table 16.

| **Threat Defense** | **ASA** | **FXOS** |
| --- | --- | --- |
| 7.6.0 | 9.22(1.1) | 2.16.0.128 |
| 7.4.2.1 | 9.20.2.36 | 2.14.1.176 |
| 7.4.2 | 9.20(2.32) | 2.14.1.167 |
| 7.4.1.1 | 9.20(2.201) | 2.14.1.131 |
| 7.4.1 | 9.20(2.2) | 2.14.1.131 |
| 7.4.0 | 9.20(1.84) | 2.14.0.475 |
| 7.3.1.1 | 9.19(1.202) | 2.13.0.1022 |
| 7.3.1 | 9.19(1.200) | 2.13.0.1022 |
| 7.3.0 | 9.19(1) | 2.13.0.198 |
| 7.2.9 | 9.18(4.47) | 2.12.1.86 |
| 7.2.8.1 | 9.18(4.212) | 2.12.1.1703 |
| 7.2.8 | 9.18(4.210) | 2.12.1.73 |
| 7.2.7 | 9.18(4.201) | 2.12.1.73 |
| 7.2.6 | 9.18(4.22) | 2.12.1.73 |
| 7.2.5.2 | 9.18(3.61) | 2.12.0.530 |
| 7.2.5.1 | 9.18(3.60) | 2.12.0.530 |
| 7.2.5 | 9.18(3.53) | 2.12.0.519 |
| 7.2.4.1 | 9.18(3.53) | 2.12.0.519 |
| 7.2.4 | 9.18(3.39) | 2.12.0.499 |
| 7.2.3.1 | — | — |
| 7.2.3 | 9.18(2.219) | 2.12.0.1030 |
| 7.2.2 | 9.18(2.200) | 2.12.0.1104 |
| 7.2.1 | 9.18(2.4) | 2.12.0.442 |
| 7.2.0.1 | 9.18(1.200) | 2.12.0.31 |
| 7.2.0 | 9.18(1) | 2.12.0.31 |
| 7.1.0.3 | 9.17(1.24) | 2.11.1.191 |
| 7.1.0.2 | 9.17(1.201) | 2.11.1.1300 |
| 7.1.0.1 | 9.17(1.150) | 2.11.1.154 |
| 7.1.0 | 9.17(1.0) | 2.11.1.154 |
| 7.0.6.3 | 9.16(4.70) | 2.10.1.1633 |
| 7.0.6.2 | 9.16(4.57) | 2.10.1.1625 |
| 7.0.6.1 | 9.16(4.45) | 2.10.1.1614 |
| 7.0.6 | 9.16(4.35) | 2.10.1.1603 |
| 7.0.5.1 | — | — |
| 7.0.5 | 9.16(4.200) | 2.10.1.1400 |
| 7.0.4 | 9.16(3.18) | 2.10.1.208 |
| 7.0.3 | 9.16(3.201) | 2.10.1.1200 |
| 7.0.2.1 | 9.16(3.200) | 2.10.1.192 |
| 7.0.2 | 9.16(3.11) | 2.10.1.192 |
| 7.0.1.1 | 9.16(2.5) | 2.10.1.175 |
| 7.0.1 | 9.16(2.5) | 2.10.1.175 |
| 7.0.0.1 | 9.16(1.25) | 2.10.1.159 |
| 7.0.0 | 9.16(1) | 2.10.1.159 |
| 6.7.0.3 | 9.15(1.19) | 2.9.1.138 |
| 6.7.0.2 | 9.15(1.15) | 2.9.1.138 |
| 6.7.0.1 | 9.15(1.8) | 2.9.1.135 |
| 6.7.0 | 9.15(1) | 2.9.1.131 |
| 6.6.7.2 | 9.14(4.201) | 2.8.1.192 |
| 6.6.7.1 | 9.14(4.21) | 2.8.1.192 |
| 6.6.7 | 9.14(4.13) | 2.8.1.186 |
| 6.6.5.2 | 9.14(3.22) | 2.8.1.172 |
| 6.6.5.1 | 9.14(3.15) | 2.8.1.172 |
| 6.6.5 | 9.14(3.6) | 2.8.1.165 |
| 6.6.4 | 9.14(2.155) | 2.8.1.1148 |
| 6.6.3 | 9.14(2.151) | 2.8.1.1146 |
| 6.6.1 | 9.14(1.150) | 2.8.1.129 |
| 6.6.0.1 | 9.14(1.216) | 2.8.1.105 |
| 6.6.0 | 9.14(1.1) | 2.8.1.105 |
| 6.5.0.5 | 9.13(1.18) | 2.7.1.129 |
| 6.5.0.4 | 9.13(1.5) | 2.7.1.117 |
| 6.5.0.3 | 9.13(1.4) | 2.7.1.117 |
| 6.5.0.2 | 9.13(1.151) | 2.7.1.115 |
| 6.5.0.1 | 9.13(1.2) | 2.7.1.115 |
| 6.5.0 | 9.13(1) | 2.7.1.107 |
| 6.4.0.18 | 9.12(4.68) | 2.6.1.272 |
| 6.4.0.17 | 9.12(4.62) | 2.6.1.265 |
| 6.4.0.16 | 9.12(4.54) | 2.6.1.260 |
| 6.4.0.15 | 9.12(4.41) | 2.6.1.254 |
| 6.4.0.14 | 9.12(4.37) | 2.6.1.239 |
| 6.4.0.13 | 9.12(4.37) | 2.6.1.239 |
| 6.4.0.12 | 9.12(4.152) | 2.6.1.230 |
| 6.4.0.11 | 9.12(2.40) | 2.6.1.214 |
| 6.4.0.10 | 9.12(2.38) | 2.6.1.214 |
| 6.4.0.9 | 9.12(2.33) | 2.6.1.201 |
| 6.4.0.8 | 9.12(2.18) | 2.6.1.166 |
| 6.4.0.7 | 9.12(2.151) | 2.6.1.156 |
| 6.4.0.6 | 9.12(2.12) | 2.6.1.156 |
| 6.4.0.5 | 9.12(2.4) | 2.6.1.144 |
| 6.4.0.4 | 9.12(2.4) | 2.6.1.144 |
| 6.4.0.3 | 9.12(1.12) | 2.6.1.133 |
| 6.4.0.2 | 9.12(1.10) | 2.6.1.133 |
| 6.4.0.1 | 9.12(1.7) | 2.6.1.133 |
| 6.4.0 | 9.12(1.6) | 2.6.1.133 |
| 6.3.0.5 | 9.10(1.31) | 2.4.1.255 |
| 6.3.0.4 | 9.10(1.28) | 2.4.1.248 |
| 6.3.0.3 | 9.10(1.18) | 2.4.1.237 |
| 6.3.0.2 | 9.10(1.12) | 2.4.1.237 |
| 6.3.0.1 | 9.10(1.8) | 2.4.1.222 |
| 6.3.0 | 9.10(1.3) | 2.4.1.216 |
| 6.2.3.18 | 9.9(2.91) | 2.3.1.219 |
| 6.2.3.17 | 9.9(2.88) | 2.3.1.217 |
| 6.2.3.16 | 9.9(2.74) | 2.3.1.180 |
| 6.2.3.15 | 9.9(2.60) | 2.3.1.167 |
| 6.2.3.14 | 9.9(2.55) | 2.3.1.151 |
| 6.2.3.13 | 9.9(2.51) | 2.3.1.144 |
| 6.2.3.12 | 9.9(2.48) | 2.3.1.144 |
| 6.2.3.11 | 9.9(2.43) | 2.3.1.132 |
| 6.2.3.10 | 9.9(2.41) | 2.3.1.131 |
| 6.2.3.9 | 9.9(2.37) | 2.3.1.122 |
| 6.2.3.8 | 9.9(2.37) | 2.3.1.122 |
| 6.2.3.7 | 9.9(2.32) | 2.3.1.118 |
| 6.2.3.6 | 9.9(2.26) | 2.3.1.115 |
| 6.2.3.5 | 9.9(2.245) | 2.3.1.108 |
| 6.2.3.4 | 9.9(2.15) | 2.3.1.108 |
| 6.2.3.3 | 9.9(2.13) | 2.3.1.104 |
| 6.2.3.2 | 9.9(2.8) | 2.3.1.85 |
| 6.2.3.1 | 9.9(2.4) | 2.3.1.84 |
| 6.2.3 | 9.9(2) | 2.3.1.84 |
| 6.2.2.5 | 9.8(2.44) | 2.2.2.107 |
| 6.2.2.4 | 9.8(2.36) | 2.2.2.86 |
| 6.2.2.3 | 9.8(2.30) | 2.2.2.79 |
| 6.2.2.2 | 9.8(2.22) | 2.2.2.75 |
| 6.2.2.1 | 9.8(2.10) | 2.2.2.63 |
| 6.2.2 | 9.8(2.3) | 2.2.2.52 |
| 6.2.1 | 9.8(1) | 2.2.1.49 |
| 6.2.0.6 | 9.7(1.25) | — |
| 6.2.0.5 | 9.7(1.23) | — |
| 6.2.0.4 | 9.7(1.19) | — |
| 6.2.0.3 | 9.7(1.15) | — |
| 6.2.0.2 | 9.7(1.10) | — |
| 6.2.0.1 | 9.7(1.7) | — |
| 6.2.0 | 9.7(1.4) | — |
| 6.1.0.7 | 9.6(4.12) | — |
| 6.1.0.6 | 9.6(3.23) | — |
| 6.1.0.5 | 9.6(2.21) | — |
| 6.1.0.4 | 9.6(2.16) | — |
| 6.1.0.3 | 9.6(2.16) | — |
| 6.1.0.2 | 9.6(2.4) | — |
| 6.1.0.1 | 9.6(2.4) | — |
| 6.1.0 | 9.6(2) | — |
| 6.0.1.4 | 9.6(1.19) | — |
| 6.0.1.3 | 9.6(1.12) | — |
| 6.0.1.2 | 9.6(1.11) | — |
| 6.0.1.1 | 9.6(1) | — |
| 6.0.1 | 9.6(1) | — |
| 6.0.0.1 | 9.6(1) | — |
| 6.0.0 | 9.6(1) | — |

### Snort

Snort is the main inspection engine. Snort
3 is available in Version 6.7+ with device
manager, and Version 7.0+ with management center.

Table 17.

| **Threat Defense** | **Snort 2** | **Snort 3** |
| --- | --- | --- |
| 7.6.0 | 2.9.23-227 | 3.1.79.1-121 |
| 7.4.2.1 | 2.9.22-2000 | 3.1.53.201-112 |
| 7.4.2 | 2.9.22-2000 | 3.1.53.200-107 |
| 7.4.1.1 | 2.9.22-1103 | 3.1.53.100-56 |
| 7.4.1 | 2.9.22-1009 | 3.1.53.100-56 |
| 7.4.0 | 2.9.22-181 | 3.1.53.1-40 |
| 7.3.1.1 | 2.9.21-1109 | 3.1.36.101-2 |
| 7.3.1 | 2.9.21-1000 | 3.1.36.100-2 |
| 7.3.0 | 2.9.21-105 | 3.1.36.1-101 |
| 7.2.9 | 2.9.20-9000 | 3.1.21.900-7 |
| 7.2.8.1 | 2.9.20-8101 | 3.1.21.800-2 |
| 7.2.8 | 2.9.20-8005 | 3.1.21.800-2 |
| 7.2.7 | 2.9.20-6102 | 3.1.21.600-26 |
| 7.2.6 | 2.9.20-6102 | 3.1.21.600-26 |
| 7.2.5.2 | 2.9.20-5201 | 3.1.21.501-27 |
| 7.2.5.1 | 2.9.20-5100 | 3.1.21.501-26 |
| 7.2.5 | 2.9.20-5002 | 3.1.21.500-21 |
| 7.2.4.1 | 2.9.20-4103 | 3.1.21.401-6 |
| 7.2.4 | 2.9.20-4004 | 3.1.21.400-24 |
| 7.2.3.1 | 2.9.20-3100 | 3.1.21.100-7 |
| 7.2.3 | 2.9.20-3010 | 3.1.21.100-7 |
| 7.2.2 | 2.9.20-2001 | 3.1.21.100-7 |
| 7.2.1 | 2.9.20-1000 | 3.1.21.100-7 |
| 7.2.0.1 | 2.9.20-108 | 3.1.21.1-126 |
| 7.2.0 | 2.9.20-107 | 3.1.21.1-126 |
| 7.1.0.3 | 2.9.19-3000 | 3.1.7.3-210 |
| 7.1.0.2 | 2.9.19-2000 | 3.1.7.2-200 |
| 7.1.0.1 | 2.9.19-1013 | 3.1.7.2-200 |
| 7.1.0 | 2.9.19-92 | 3.1.7.1-108 |
| 7.0.6.3 | 2.9.18-6306 | 3.1.0.603-31 |
| 7.0.6.2 | 2.9.18-6201 | 3.1.0.602-26 |
| 7.0.6.1 | 2.9.18-6008 | 3.1.0.600-20 |
| 7.0.6 | 2.9.18-6008 | 3.1.0.600-20 |
| 7.0.5.1 | 2.9.18-5100 | — |
| 7.0.5 | 2.9.18-5002 | 3.1.0.500-7 |
| 7.0.4 | 2.9.18-4002 | 3.1.0.400-12 |
| 7.0.3 | 2.9.18-3005 | 3.1.0.300-3 |
| 7.0.2.1 | 2.9.18-2101 | 3.1.0.200-16 |
| 7.0.2 | 2.9.18-2022 | 3.1.0.200-16 |
| 7.0.1.1 | 2.9.18-1026 | 3.1.0.100-11 |
| 7.0.1 | 2.9.18-1026 | 3.1.0.100-11 |
| 7.0.0.1 | 2.9.18-1001 | 3.1.0.1-174 |
| 7.0.0 | 2.9.18-174 | 3.1.0.1-174 |
| 6.7.0.3 | 2.9.17-3014 | 3.0.1.4-129 |
| 6.7.0.2 | 2.9.17-2003 | 3.0.1.4-129 |
| 6.7.0.1 | 2.9.17-1006 | 3.0.1.4-129 |
| 6.7.0 | 2.9.17-200 | 3.0.1.4-129 |
| 6.6.7.2 | 2.9.16-7101 | — |
| 6.6.7.1 | 2.9.16-7100 | — |
| 6.6.7 | 2.9.16-7017 | — |
| 6.6.5.2 | 2.9.16-5204 | — |
| 6.6.5.1 | 2.9.16-5107 | — |
| 6.6.5 | 2.9.16-5034 | — |
| 6.6.4 | 2.9.16-4022 | — |
| 6.6.3 | 2.9.16-3033 | — |
| 6.6.1 | 2.9.16-1025 | — |
| 6.6.0.1 | 2.9.16-140 | — |
| 6.6.0 | 2.9.16-140 | — |
| 6.5.0.5 | 2.9.15-15510 | — |
| 6.5.0.4 | 2.9.15-15201 | — |
| 6.5.0.3 | 2.9.15-15201 | — |
| 6.5.0.2 | 2.9.15-15101 | — |
| 6.5.0.1 | 2.9.15-15101 | — |
| 6.5.0 | 2.9.15-7 | — |
| 6.4.0.18 | 2.9.14-28000 | — |
| 6.4.0.17 | 2.9.14-27005 | — |
| 6.4.0.16 | 2.9.14-26002 | — |
| 6.4.0.15 | 2.9.14-25006 | — |
| 6.4.0.14 | 2.9.14-24000 | — |
| 6.4.0.13 | 2.9.14-19008 | — |
| 6.4.0.12 | 2.9.14-18011 | — |
| 6.4.0.11 | 2.9.14-17005 | — |
| 6.4.0.10 | 2.9.14-16023 | — |
| 6.4.0.9 | 2.9.14-15906 | — |
| 6.4.0.8 | 2.9.14-15707 | — |
| 6.4.0.7 | 2.9.14-15605 | — |
| 6.4.0.6 | 2.9.14-15605 | — |
| 6.4.0.5 | 2.9.14-15507 | — |
| 6.4.0.4 | 2.9.12-15301 | — |
| 6.4.0.3 | 2.9.14-15301 | — |
| 6.4.0.2 | 2.9.14-15209 | — |
| 6.4.0.1 | 2.9.14-15100 | — |
| 6.4.0 | 2.9.14-15003 | — |
| 6.3.0.5 | 2.9.13-15503 | — |
| 6.3.0.4 | 2.9.13-15409 | — |
| 6.3.0.3 | 2.9.13-15307 | — |
| 6.3.0.2 | 2.9.13-15211 | — |
| 6.3.0.1 | 2.9.13-15101 | — |
| 6.3.0 | 2.9.13-15013 | — |
| 6.2.3.18 | 2.9.12-1813 | — |
| 6.2.3.17 | 2.9.12-1605 | — |
| 6.2.3.16 | 2.9.12-1605 | — |
| 6.2.3.15 | 2.9.12-1513 | — |
| 6.2.3.14 | 2.9.12-1401 | — |
| 6.2.3.13 | 2.9.12-1306 | — |
| 6.2.3.12 | 2.9.12-1207 | — |
| 6.2.3.11 | 2.9.12-1102 | — |
| 6.2.3.10 | 2.9.12-902 | — |
| 6.2.3.9 | 2.9.12-806 | — |
| 6.2.3.8 | 2.9.12-804 | — |
| 6.2.3.7 | 2.9.12-704 | — |
| 6.2.3.6 | 2.9.12-607 | — |
| 6.2.3.5 | 2.9.12-506 | — |
| 6.2.3.4 | 2.9.12-383 | — |
| 6.2.3.3 | 2.9.12-325 | — |
| 6.2.3.2 | 2.9.12-270 | — |
| 6.2.3.1 | 2.9.12-204 | — |
| 6.2.3 | 2.9.12-136 | — |
| 6.2.2.5 | 2.9.11-430 | — |
| 6.2.2.4 | 2.9.11-371 | — |
| 6.2.2.3 | 2.9.11-303 | — |
| 6.2.2.2 | 2.9.11-273 | — |
| 6.2.2.1 | 2.9.11-207 | — |
| 6.2.2 | 2.9.11-125 | — |
| 6.2.1 | 2.9.11-101 | — |
| 6.2.0.6 | 2.9.10-301 | — |
| 6.2.0.5 | 2.9.10-255 | — |
| 6.2.0.4 | 2.9.10-205 | — |
| 6.2.0.3 | 2.9.10-160 | — |
| 6.2.0.2 | 2.9.10-126 | — |
| 6.2.0.1 | 2.9.10-98 | — |
| 6.2.0 | 2.9.10-42 | — |
| 6.1.0.7 | 2.9.9-312 | — |
| 6.1.0.6 | 2.9.9-258 | — |
| 6.1.0.5 | 2.9.9-225 | — |
| 6.1.0.4 | 2.9.9-191 | — |
| 6.1.0.3 | 2.9.9-159 | — |
| 6.1.0.2 | 2.9.9-125 | — |
| 6.1.0.1 | 2.9.9-92 | — |
| 6.1.0 | 2.9.9-330 | — |
| 6.0.1.4 | 2.9.8-490 | — |
| 6.0.1.3 | 2.9.8-461 | — |
| 6.0.1.2 | 2.9.8-426 | — |
| 6.0.1.1 | 2.9.8-383 | — |
| 6.0.1 | 2.9.8-224 | — |

### System Databases

The vulnerability database (VDB) is a database of known vulnerabilities to which
hosts may be susceptible, as well as fingerprints for operating systems, clients,
and applications. The system uses the VDB to help determine whether a particular
host increases your risk of compromise.

The geolocation database (GeoDB) is a database that you can leverage to view and
filter traffic based on geographical location.

Table 18.

| **Threat Defense** | **VDB** | **GeoDB** |
| --- | --- | --- |
| 7.6.0 | 4.5.0-392 | 2022-07-04-101 |
| 7.4.1 through 7.4.x | 4.5.0-376 | 2022-07-04-101 |
| 7.4.0 | 4.5.0-365 | 2022-07-04-101 |
| 7.3.0 through 7.3.x | 4.5.0-358 | 2022-07-04-101 |
| 7.2.0 through 7.2.x | 4.5.0-353 | 2022-05-11-103 |
| 7.1.0 | 4.5.0-346 | 2020-04-28-002 |
| 6.7.0 through 7.0.x | 4.5.0-338 | 2020-04-28-002 |
| 6.6.1 through 6.6.x | 4.5.0-336 | 2019-06-03-002 |
| 6.6.0 | 4.5.0-328 | 2019-06-03-002 |
| 6.5.0 | 4.5.0-309 | 2019-06-03-002 |
| 6.4.0 | 4.5.0-309 | 2018-07-09-002 |
| 6.3.0 | 4.5.0-299 | 2018-07-09-002 |
| 6.2.3 | 4.5.0-290 | 2017-12-12-002 |
| 6.0.1 through 6.2.2 | 4.5.0-271 | 2015-10-12-001 |

## Integrated Products

The Cisco products listed below may have other compatibility requirements, for
example, they may need to run on specific hardware, or on a specific operating
system. For that information, see the documentation for the appropriate
product.

| **Note** | ---   Whenever possible, we recommend you use the latest (newest) compatible version of each integrated product. This ensures that you have the latest features, bug fixes, and security patches.   --- |
| --- | --- |

### Identity Services and User Control

Note that with:

* Cisco ISE and ISE-PIC: We list the versions of ISE and ISE-PIC for which we
  provide enhanced compatibility testing, although other combinations may
  work.
* Cisco Firepower User Agent: Version 6.6 is the last management center release to support the user agent software as an identity source; this
  blocks upgrade to Version 6.7+.

  You can instead use the Passive Identity Agent with Microsoft Active Directory. For more information, see [User Control With the Passive Identity Agent](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/management-center/device-config/760/management-center-device-config-76/passive-identity-agent.html).
* Cisco TS Agent: Versions 1.0 and 1.1 are no longer available.

Table 19. Integrated Products: Identity Services/User Control

| **Management Center/Threat Defense** | **Cisco Identity Services Engine (ISE)** | | **Cisco Firepower User Agent** | **Cisco Terminal Services (TS) Agent** | **Passive Identity Agent** |
| --- | --- | --- | --- | --- | --- |
| **ISE** | **ISE-PIC** |
| Supported with... | Management center  Device manager | Management center  Device manager | Management center only | Management center only | Management center only |
| Cloud-delivered Firewall Management Center (no version) | 3.3  3.2  3.1 patch 2+  3.0 patch 6+  2.7 patch 2+  The pxGrid cloud identity source requires ISE 3.1 patch 3 or later. | 3.2  3.1  2.7 patch 2+ | — | 1.4 | 1.0 |
| 7.6 | 3.3 patch 2  3.2 patch 5  3.1 patch 2+ | 3.2  3.1 | — | 1.4 | 1.0 |
| 7.4 | 3.3  3.2  3.1 patch 2+  3.0 patch 6+ | 3.2  3.1 | — | 1.4 | — |
| 7.3 | 3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.2.4–7.2.x | 3.3  3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.2.0–7.2.3 | 3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.1 | 3.2  3.1  3.0  2.7 patch 2+ | 3.2  3.1  2.7 patch 2+ | — | 1.4  1.3 | — |
| 7.0 | 3.2  3.1  3.0  2.7 patch 2+  2.6 patch 6+ | 3.2  3.1  2.7 patch 2+  2.6 patch 6+ | — | 1.4  1.3 | — |
| 6.7 | 3.0  2.7 patch 2+  2.6 patch 6+ | 2.7 patch 2+  2.6 patch 6+ | — | 1.4  1.3 | — |
| 6.6 | 3.0  2.7, any patch  2.6, any patch  2.4 | 2.7, any patch  2.6, any patch  2.4 | 2.5  2.4 | 1.4  1.3  1.2 | — |
| 6.5 | 2.6  2.4 | 2.6  2.4 | 2.5  2.4 | 1.4  1.3  1.2  1.1 | — |
| 6.4 | 2.4  2.3 patch 2  2.3 | 2.4  2.2 patch 1 | 2.5  2.4  2.3, no ASA FirePOWER | 1.4  1.3  1.2  1.1 | — |
| 6.3 | 2.4  2.3 patch 2  2.3 | 2.4  2.2 patch 1  2.4 | 2.4  2.3, no ASA FirePOWER | 1.2  1.1 | — |
| 6.2.3 | 2.3 patch 2  2.3  2.2 patch 5  2.2 patch 1  2.2 | 2.2 patch 1 | 2.4  2.3 | 1.2  1.1 | — |
| 6.2.2 | 2.3  2.2 patch 1  2.2  2.1 | 2.2 patch 1 | 2.3 | 1.2  1.1  1.0 | — |
| 6.2.1 | 2.1  2.0.1  2.0 | 2.2 patch 1 | 2.3 | 1.1  1.0 | — |
| 6.2.0 | 2.1  2.0.1  2.0  1.3 | — | 2.3 | — | — |
| 6.1 | 2.1  2.0.1  2.0  1.3 | — | 2.3 | — | — |
| 6.0.1 | 1.3 | — | 2.3 | — | — |

### Cisco Secure Dynamic Attributes Connector

The Cisco Secure
Dynamic Attributes Connector is a lightweight application that quickly and seamlessly updates firewall
policies on the management center based on cloud/virtual workload changes. For more information, see one of:

* On-prem connector: [Cisco Secure Dynamic Attributes
  Connector Configuration
  Guide](https://cisco.com/go/dyn-attr-conn-canonical)
* Cloud-delivered connector: Managing the Cisco Secure Dynamic Attributes Connector with Cisco Security Cloud Control chapters in [Managing Firewall Threat Defense with Cloud-Delivered Firewall Management Center in Cisco Security Cloud Control](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator.html)
* Bundled with the Secure Firewall Management Center: [Cisco Secure Firewall Management
  Center Device Configuration Guide](http://www.cisco.com/go/firepower-config)

Table 20. Integrated Products: Cisco Secure
Dynamic Attributes Connector

| **Management Center** | Cisco Secure Dynamic Attributes Connector | |
| --- | --- | --- |
| **On-Prem** | **Cloud-delivered (with Security Cloud Control)** |
| Cloud-delivered management center (no version) | 3.0  2.2  2.0 | **YES** |
| 7.1+ | 3.0  2.2  2.0  1.1 | **YES** |
| 7.0 | 3.0  2.2  2.0  1.1 | — |

The Cisco Secure
Dynamic Attributes Connector allows you to use service tags and categories from various cloud service platforms in security rules.

The following table shows supported connectors for the Cisco Secure
Dynamic Attributes Connector (CSDAC) provided with the Secure Firewall Management Center. For a list of supported connectors with the on-premises CSDAC, see the [Cisco Secure Dynamic Attributes
Connector Configuration
Guide](https://cisco.com/go/dyn-attr-conn-canonical).

Table 21. List of supported connectors by Cisco Secure
Dynamic Attributes Connector version and platform

| CSDAC version/platform | AWS | AWS Security Groups | AWS Service Tags | Azure | Azure Service Tags | Cisco Cyber Vision | Cisco Multicloud Defense | Generic text | GitHub | Google Cloud | Microsoft Office 365 | vCenter | Webex | Zoom |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Version 1.1 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | No | No | Yes | Yes | No | No |
| Version 2.0 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | No | Yes | Yes | Yes | No | No |
| Version 2.2 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | Yes | Yes | Yes | Yes | No | No |
| Version 2.3 (on-premises) | Yes | No | No | Yes | Yes | No | No | No | Yes | Yes | Yes | Yes | Yes | Yes |
| Version 3.0 (on-premises) | Yes | Yes | Yes | Yes | Yes | Yes | No | Yes | Yes | Yes | Yes | Yes | Yes | Yes |
| Cloud-delivered (Cisco Security Cloud Control) | Yes | No | No | Yes | Yes | No | Yes | No | Yes | Yes | Yes | No | No | No |
| Secure Firewall Management Center 7.4.1 | Yes | No | No | Yes | Yes | No | No | Yes | Yes | Yes | Yes | Yes | Yes | Yes |
| Secure Firewall Management Center 7.6 | Yes | Yes | Yes | Yes | Yes | Yes | No | Yes | Yes | Yes | Yes | Yes | Yes | Yes |

### Threat Detection

Note that:

* Cisco Security Analytics and Logging (On Premises) requires the Security
  Analytics and Logging On Prem app for the Stealthwatch Management Console
  (SMC). For information on Stealthwatch Enterprise (SWE) requirements for the
  SMC, see [Cisco Security Analytics
  and Logging On Premises: Firepower Event Integration
  Guide](https://www.cisco.com/c/en/us/support/security/security-analytics-logging/products-installation-guides-list.html).
* Cisco SecureX integration, which was available with
  Version 6.4–7.4, has now reached end of support. For a replacement
  technology, contact your Cisco representative or partner contact.

Table 22. Integrated Products: Threat Detection

| **Management Center/Threat Defense** | **Cisco Security Analytics and Logging (SaaS)** | **Cisco Security Analytics and Logging (On Prem)** | **Cisco Secure Malware Analytics** | **Cisco Security Packet Analyzer** |
| --- | --- | --- | --- | --- |
| Supported with... | Management center  Device manager | Management center only | Management center only | Management center only |
| 6.5+ | **YES** | **YES** | **YES** | — |
| 6.4 | **YES**  Requires management center with threat defense 6.4. | **YES** | **YES** | **YES** |
| 6.3 | — | — | **YES** | **YES** |
| 6.1–6.2.3 | — | — | **YES** | — |

### Threat Defense Remote Access VPN

Remote access virtual private network (RA VPN) allows individual users to connect to
your network from a remote location using a computer or supported mobile device.
Keep in mind that newer threat defense features can require newer versions of the
client.

For more information, see the [Cisco Secure Client/AnyConnect Secure Mobility Client
configuration guides](https://www.cisco.com/c/en/us/support/security/anyconnect-secure-mobility-client/products-installation-and-configuration-guides-list.html).

Table 23. Integrated Products: Threat Defense RA VPN

| **Threat Defense** | Cisco Secure Client/Cisco AnyConnect Secure Mobility Client |
| --- | --- |
| 6.2.2+ | 4.0+ |

## Browser Requirements

### Browsers

We test with the latest versions of these popular browsers, running on currently
supported versions of macOS and Microsoft Windows:

Table 24. Browsers

| Browser | Device Manager Version |
| --- | --- |
| Google Chrome | Any |
| Mozilla Firefox | Any |
| Microsoft Edge (Windows only) | Version 6.7+ |
| Apple Safari | Not extensively tested. Feedback welcome. |

If you encounter issues with any other browser, or are running an operating system
that has reached end of life, we ask that you switch or upgrade. If you continue to
encounter issues or have feedback, contact Cisco TAC.

### Browser Settings and Extensions

Regardless of browser, keep JavaScript and
cookies enabled.
If you are using Microsoft Edge, do *not* enable IE mode.

Note that some browser extensions can prevent you from saving values in fields like
the certificate and key in PKI objects. These extensions include, but are not
limited to, Grammarly and Whatfix Editor. This happens because these extensions
insert characters (such as HTML) in the fields, which causes the system to see them
invalid. We recommend you disable these extensions while you’re logged into our
products.

### Screen Resolution

Table 25. Screen Resolution

| **Interface** | **Minimum Resolution** |
| --- | --- |
| Device manager | 1024 x 768 |
| Chassis manager for the Firepower 4100/9300 | 1024 x 768 |

### Securing Communications

When you first log in, the system uses a self-signed digital certificate to secure
web communications. Your browser should display an untrusted authority warning, but
also should allow you to add the certificate to the trust store. Although this will
allow you to continue, we do recommend that you replace the self-signed certificate
with a certificate signed by a globally known or internally trusted certificate
authority (CA).

To begin replacing the self-signed certificate on device manager, click
Device, then the System Settings > Management Access link, then the Management Web Server tab.
For detailed procedures, see the online help or the [Cisco
Secure Firewall Device Manager Configuration
Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

| **Note** | ---   If you do not replace the self-signed certificate:   * Google Chrome does not cache static content, such as images, CSS, or   JavaScript. Especially in low bandwidth environments, this can extend   page load times. * Mozilla Firefox can stop trusting the self-signed certificate when the   browser updates. If this happens, you can refresh Firefox, keeping in   mind that you will lose some settings; see Mozilla's *[Refresh Firefox](https://support.mozilla.org/en-US/kb/refresh-firefox-reset-add-ons-and-settings)* support   page.  --- |
| --- | --- |

### Browsing from a Monitored Network

Many browsers use Transport Layer Security (TLS) v1.3 by default. If you are using an
SSL policy to handle encrypted traffic, and people in your monitored network use
browsers with TLS v1.3 enabled, websites that support TLS v1.3 may fail to load.

| **Note** | ---   In Version 6.2.3 and earlier, websites that support TLS v1.3 always fail to load. As a workaround, you can configure managed devices to remove extension 43 (TLS 1.3) from ClientHello negotiation; see the software advisory titled: [*Failures loading websites using TLS 1.3 with SSL inspection enabled*](https://www.cisco.com/c/en/us/td/docs/security/firepower/SA/SW_Advisory_CSCvh22181.html). In Version 6.2.3.7+, you can specify when to downgrade; see the system support  commands in the [Cisco Secure Firewall Threat Defense Command Reference](https://www.cisco.com/c/en/us/td/docs/security/firepower/command_ref/b_Command_Reference_for_Firepower_Threat_Defense.html) after consulting with Cisco TAC.   --- |
| --- | --- |

## End-of-Life Announcements

The following tables provide end-of-life details. Dates that have passed
are in **bold**.

### Snort

If you are still using the Snort 2 inspection engine with threat defense, switch to Snort 3
now for improved detection and performance. It is available starting in threat defense
Version 6.7+ (with device manager) and Version 7.0+ (with management center). Snort 2 will
be deprecated in a future release. You will eventually be unable to upgrade
Snort 2 devices.

In management center deployments, upgrading to threat defense Version
7.2+ also upgrades eligible Snort 2 devices to Snort
3.
For devices that are ineligible because they use custom intrusion or network analysis
policies, manually upgrade Snort. See Migrate from Snort 2 to Snort 3 in the
[Cisco Secure Firewall
Management Center Snort 3 Configuration
Guide](https://www.cisco.com/go/fmc-snort3).

In device manager deployments, manually upgrade Snort. See Intrusion Policies
in the [Cisco
Secure Firewall Device Manager Configuration
Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html).

### Software

These major software versions have reached end of sale and/or end of
support. Versions that have reached end of support are removed from the Cisco Support & Download
site.

Table 26. Software EOL Announcements

| **Version** | **End of Sale** | End of Updates | **End of Support** | **Announcement** |
| --- | --- | --- | --- | --- |
| 7.1 | **2023-12-22** | **2024-12-21** | 2025-12-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 7.1.(x), Firepower Management Center (FMC) 7.1.(x), Adaptive Security Appliance(ASA) 9.17.(x) and Firepower eXtensible Operating System (FXOS) 2.11.(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-ftd-fmc-7-1x-fxos-2-11x-eol.html) |
| 6.7 | **2021-07-09** | **2022-07-09** | **2024-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.7, Firepower Management Center (FMC) 6.7 and Firepower eXtensible Operating System (FXOS) 2.9(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-744709.html) |
| 6.6 | **2022-03-02** | **2023-03-02** | 2025-03-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD/FTDv) 6.6(x), Firepower Management Center (FMC/FMCv) 6.6(x) and Firepower eXtensible Operating System (FXOS) 2.8(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-ftd-fmc-6-6x-fxos-2-8x-eol.html) |
| 6.5 | **2020-06-22** | **2021-06-22** | **2023-06-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.5(x), Firepower Management Center (FMC) 6.5(x) and Firepower eXtensible Operating System (FXOS) 2.7(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743795.html) |
| 6.4 | **2023-02-27** | **2024-02-27** | 2026-02-28 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.4(X), Firepower Management Center (FMC) 6.4(X) and Firepower eXtensible Operating System (FXOS) 2.6(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-threat-defense-6-4x-eol.html) |
| 6.3 | **2020-04-30** | **2021-04-30** | **2023-04-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.2.2, 6.3(x), Firepower eXtensible Operating System (FXOS) 2.4.1 and Firepower Management Center (FMC) 6.2.2 and 6.3(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743073.html) |
| 6.2.3 | **2022-02-04** | **2023-02-04** | 2025-02-28 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.2.3, Firepower Management Center (FMC) 6.2.3 and Firepower eXtensible Operating System (FXOS) 2.2(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-threat-defense-eol.html) |
| 6.2.2 | **2020-04-30** | **2021-04-30** | **2023-04-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense (FTD) 6.2.2, 6.3(x), Firepower eXtensible Operating System (FXOS) 2.4.1 and Firepower Management Center (FMC) 6.2.2 and 6.3(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743073.html) |
| 6.2.1 | **2019-03-05** | **2020-03-04** | **2022-03-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense versions 6.2.0 and 6.2.1](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-741309.html) |
| 6.2 | **2019-03-05** | **2020-03-04** | **2022-03-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense versions 6.2.0 and 6.2.1](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-741309.html) |
| 6.1 | **2019-11-22** | **2021-05-22** | **2023-05-31** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Threat Defense versions 6.1, NGIPSv and NGFWv versions 6.1, Firepower Management Center 6.1 and Firepower eXtensible Operating System (FXOS) 2.0(x)](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743170.html) |
| 6.0.1 | **2017-11-10** | **2018-11-10** | **2020-11-30** | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower Software Releases 5.4, 6.0 and 6.0.1 and Firepower Management Center Software Releases 5.4, 6.0 and 6.0.1](https://www.cisco.com/c/en/us/products/collateral/security/firepower-8000-series-appliances/eos-eol-notice-c51-739057.html) |

These software versions on still-supported branches have been removed
from the Cisco Support & Download
site.

| **Note** | ---   In Version 6.2.3+, uninstalling a patch (fourth-digit release) results in an appliance running the version you upgraded from. This means that you can end up running a deprecated version simply by uninstalling a later patch. Unless otherwise stated, do *not* remain at a deprecated version. Instead, we recommend you upgrade. If upgrade is impossible, uninstall the deprecated patch.   --- |
| --- | --- |

Table 27. Software Removed Versions

| **Version** | **Date Removed** | **Related Bugs and Additional Details** |
| --- | --- | --- |
| 7.2.6 | **2024-04-29** | [CSCwi63113](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwi63113): FTD Boot Loop with SNMP Enabled after reload/upgrade |
| 6.4.0.6 | **2019-12-19** | [CSCvr52109](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvr52109): FTD may not match correct Access Control rule following a deploy to multiple devices |
| 6.2.3.8 | **2019-01-07** | [CSCvn82378](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvn82378): Traffic through ASA/FTD might stop passing upon upgrading FMC to 6.2.3.8-51 |

### Hardware and Virtual Platforms

These platforms have reached end of sale and/or end of support.

Table 28. Threat Defense Hardware EOL Announcements

| **Platform** | **Last Device Version** | Last Mgmt. Center to Manage | **End of Sale** | **End of Support** | **Announcement** |
| --- | --- | --- | --- | --- | --- |
| Firepower 2110, 2120, 2130, 2140 | 7.4 | TBD | 2025-05-27 | 2030-05-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 2100 Series Security Appliances & 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-2100-series-sec-app-5-yr-sub-eol.html) |
| Firepower 4110 | 7.2 | TBD | **2024-07-31** | 2027-01-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4110 Series Security Appliances 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-4110-series-sec-app-subscript-eol.html) |
| **2022-01-31** | 2027-01-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4110 Series Security Appliances & 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-4110-series-security-appliances-eol.html) |
| ASA 5508-X, 5516-X | 7.0 | 7.4 | **2021-08-02** | 2026-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5508 and ASA5516 Series Security Appliance and 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-744798.html) |
| ASA 5525-X, 5545-X, 5555-X | 6.6 | 7.2 | **2020-09-04** | 2025-09-30 | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5525, ASA5545 & ASA5555 Series Security Appliance & 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-firepower-services/eos-eol-notice-c51-743545.html) |
| Firepower 4120, 4140, 4150 | 7.2 | TBD | **2024-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 1 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/fpr-9300-sm24-36-44-sec-app-1-yr-sub-eol.html) |
| **2022-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-41204050-fpr-9300-sm243644-series-eol.html) |
| **2020-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances/Modules & 5 YR Subscription](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743522.html) |
| Firepower 9300: SM-24, SM-36, SM-44 modules | 7.2 | TBD | **2024-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 1 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/fpr-9300-sm24-36-44-sec-app-1-yr-sub-eol.html) |
| **2022-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/firepower-41204050-fpr-9300-sm243644-series-eol.html) |
| **2020-08-31** | 2025-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco Firepower 4120/40/50 and FPR 9300 SM24/36/44 Series Security Appliances/Modules & 5 YR Subscription](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw/eos-eol-notice-c51-743522.html) |
| ASA 5515-X | 6.4 | 7.0 | **2017-08-25** | **2022-08-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA 5512-X and ASA 5515-X](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-738644.html) |
| ASA 5506-X, 5506H-X, 5506W-X | 6.2.3 | 6.6 | **2021-08-02** | 2026-08-31 | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance with ASA software](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-744797.html) |
| **2021-07-31** | **2022-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance 1 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-744793.html) |
| **2020-05-05** | **2022-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance 3 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-743753.html) |
| **2018-09-30** | **2022-07-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA5506 Series Security Appliance 5 YR Subscriptions](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-741287.html) |
| ASA 5512-X | 6.2.3 | 6.6 | **2017-08-25** | **2022-08-31** | [End-of-Sale and End-of-Life Announcement for the Cisco ASA 5512-X and ASA 5515-X](https://www.cisco.com/c/en/us/products/collateral/security/asa-5500-series-next-generation-firewalls/eos-eol-notice-c51-738644.html) |

## Terminology and Branding

Table 29. Product Line

| **Current Name** | **Older Names** |
| --- | --- |
| Secure Firewall Threat Defense | Firepower  Firepower System  FireSIGHT System  Sourcefire 3D System |

Table 30. Devices

| **Current Name** | | **Older Names** |
| --- | --- | --- |
| Threat Defense | Secure Firewall Threat Defense | Firepower Threat Defense (FTD) |
| Secure Firewall Threat Defense Virtual | Firepower Threat Defense Virtual (FTDv) |
| Classic  NGIPS | ASA FirePOWER  ASA FirePOWER module  ASA with FirePOWER Services | — |
| 7000/8000 series | Series 3 |
| NGIPSv | virtual managed device |
| Legacy | Series 2 | — |
| Cisco NGIPS for Blue Coat X-Series | FireSIGHT Software for X-Series  Sourcefire Software for X-Series |

Table 31. Device Management

| **Current Name** | Older Names |
| --- | --- |
| Secure Firewall Management Center | Firepower Management Center (FMC)  FireSIGHT Management Center  FireSIGHT Defense Center  Defense Center |
| Secure Firewall Management Center Virtual | Firepower Management Center Virtual (FMCv)  FireFIGHT Virtual Management Center  FireSIGHT Virtual Defense Center  Virtual Defense Center |
| Cloud-delivered Firewall Management Center | — |
| Secure Firewall device manager | Firepower Device Manager (FDM) |
| Secure Firewall Adaptive Security Device Manager (ASDM) | Adaptive Security Device Manager (ASDM) |
| Secure Firewall chassis manager | Firepower Chassis Manager |
| Security Cloud Control | Cisco Defense Orchestrator (CDO) |

Table 32. Operating Systems

| **Current Name** | **Older Names** |
| --- | --- |
| Secure Firewall eXtensible Operating System (FXOS) | Firepower eXtensible Operating System (FXOS) |
| Secure Firewall Adaptive Security Appliance (ASA) Software | Adaptive Security Appliance (ASA) software |

Copyright © 2023, Cisco Systems, Inc. All rights reserved.

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

### This Document Applies to These Products

* [3000 Series Industrial Security Appliances (ISA)](/c/en/us/support/security/industrial-security-appliance-isa/series.html)
* [ASA 5500-X Series Firewalls](/c/en/us/support/security/asa-5500-series-next-generation-firewalls/series.html)
* [ASA 5500-X with FirePOWER Services](/c/en/us/support/security/asa-firepower-services/series.html)
* [Firepower 1000 Series](/c/en/us/support/security/firepower-1000-series/series.html)
* [Firepower 2100 Series](/c/en/us/support/security/firepower-2100-series/series.html)
* [Firepower 4100 Series](/c/en/us/support/security/firepower-4100-series/series.html)
* [Firepower 9300 Series](/c/en/us/support/security/firepower-9000-series/series.html)
* [Secure Firewall 1200 Series](/c/en/us/support/security/secure-firewall-1200-series/series.html)
* [Secure Firewall 3100 Series](/c/en/us/support/security/secure-firewall-3100-series/series.html)
* [Secure Firewall 4200 Series](/c/en/us/support/security/secure-firewall-4200-series/series.html)
* [Secure Firewall Threat Defense](/c/en/us/support/security/firepower-ngfw/series.html)
* [Secure Firewall Threat Defense Virtual](/c/en/us/support/security/firepower-ngfw-virtual/series.html)

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_799faa17_20250115_181751.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from www.cisco.com_abe025ae_20250115_120508.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Support](/c/%3Clocale%3E/support/index.html)
# My Notifications

Create custom subscriptions for Cisco products, series, or software to receive email alerts or consume RSS feeds when new announcements are released for the following notices:

* Cisco Security Advisories
* Field Notices
* End of Sale and End-of-Support Announcements
* Software Updates
* Updates to Known Bugs

[Log In to My Notifications](/c/login/index.html?referer=https://cway.cisco.com/mynotifications)![](/etc/designs/cdc/fw/i/icon_lock_small.png "Login Required")

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_85080164_20250115_120525.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x)

#### Cisco Security

# Cisco Software Checker

![](Resources/images/loader.gif)

![](Resources/images/loader.gif)

  1
  2
  3

### Select a Method

### A. Search By Release

* {{os}}

* {{::os}}

×

* {{v}}

* {{::v}}

* {{::v}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

* {{v}}

* {{::v.pName}}

×

* {{v}}

* {{::v}}

* {{::v}}

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

The maximum number of release selections is 50

### B. Use Show Version Command Output

* {{os}}

* {{::os}}

* {{v}}

* {{::v.nxOsPlatformDesc}}

![](Resources/images/reset.PNG "Reset Cisco NX-OS Software Release Show Version ")

### C. Upload a .txt file from your local system

* {{os}}

* {{::os}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

* {{v}}

* {{::v.pName}}

Use the Browse button to locate and upload a .txt file that contains one Cisco ASA Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco FMC Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco FTD Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco FXOS Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco IOS Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco IOS XE Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco NX-OS Software release per line.(max 50 releases)

Use the Browse button to locate and upload a .txt file that contains one Cisco ACI Software release per line.(max 50 releases)

 **Browse File**

![](Resources/images/reset.PNG "Reset Cisco NX-OS Software Release Show Version ")

No file chosen

---

Continue
Continue
Continue
Continue
Continue
Continue
Continue
Continue

Continue
Continue
Continue
Continue
Continue
Continue
Continue
Continue

Analyze And Continue

Upload And Continue
Continue

#### {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} Cisco IOS Cisco IOS XE Cisco NX-OS Software in ACI Mode Cisco Cisco ASA Cisco FMC Cisco FTD Software release(s) selected: for all Cisco NXOS Software Platforms for all Cisco Adaptive Security Appliance (ASA) Software Platforms for all Cisco Firepower Management Center (FMC) Software Platforms for all Cisco Firepower Threat Defense (FTD) Software Platforms for all Cisco FXOS Software Platforms

{{v}},
{{v}},
{{v}},
{{v}},
{{v}},
{{v}},
{{v}},
{{v}},

The maximum number of release selections is 50

 {{ v }}

 {{ v }}

#### Select Cisco Security Advisories Impact Rating

  All
  Critical
  High
  Medium
  Low
  Informational

#### Select Cisco Security Advisories that you are interested in searching

  All previously published Cisco Security Advisories

  Cisco Security Advisories that are included in the most recent Cisco IOS Software Security Advisory Bundled Publication (2024 Sep 25)

  Only the following Cisco Security Advisories

View/Edit Selections

Please select up to 150 number of advisories.

Continue
Continue
Back
Start Over

# Cisco Security Advisory Selection

* {{checkboxData.text}}
  + {{x.text}}
    - {{y.text}}

No advisories found for the selected impact.

 Cancel
 OK

#### {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} {{platformDesc}} Cisco IOS Cisco IOS XE Cisco NX-OS Software in ACI Mode software release(s) for all Cisco Adaptive Security Appliance (ASA) Software Platforms for all Cisco Firepower Management Center (FMC) Software Platforms for all Cisco NXOS Software Platforms for all Cisco Firepower Threat Defense (FTD) Software Platforms for all Cisco FXOS Software Platforms Cisco ASA Cisco FMC Cisco FTD Cisco FXOS

  {{ v.name}}

The maximum number of release selections is 50

Please select up to 150 number of advisories.

First uncheck Security Advisory boxes and then click the Recalculate button

Recalculate
Back
Start Over

![](Resources/images/loader.gif)

| Check Your Cisco Software  Use the Cisco Software Checker to search for Cisco Security Advisories that apply to specific software releases of the following products: Cisco ASA, FMC, FTD, FXOS, IOS, IOS XE, NX-OS and NX-OS in ACI Mode. To use the tool, select a product, platform (as required) and one or more releases, enter the output of the show version command, or upload a text file that lists specific releases. Then narrow the check to certain advisories, if desired. The availability of security fixes after the End of Sale is defined in the product's End-of-Sale announcement, as explained in the [Cisco End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Additional information about Cisco software updates, vulnerability rating and scoring is available in the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This tool does not provide information about Cisco IOS XR Software or interim software builds. Also note that for Cisco ASA, FMC, FTD and FXOS Software, the tool only contains vulnerability information for Cisco Security Advisories first published from January, 2022 onward, and for NX-OS Software and NX-OS Software in ACI Mode from July, 2019 onward. |
| --- |

##### Results for all previously published {{ratings}} Cisco Security Advisories

##### {{ratings}} {{result}} from the latest Cisco IOS Software Security Advisory Bundled Publication ({{bundleDate1}}) Export Selected Export All

##### Results for all previously published {{ratings}} Cisco Security Advisories Export Selected Export All

##### Results for selected Cisco Security Advisories: Export Selected Export All

##### Show advisory list

{{selectedAdvisoriesAsString}}

##### Hide advisory list

Security Advisories That Affect This Release
![](/security/center/img/questionmark_dkgrey.gif)

Uncheck security advisory boxes and click the Recalculate button to omit advisories and redetermine vulnerability and First Fixed information.

The following results include the first fixed or not affected release that addresses all vulnerabilities in a security advisory. The availability of security fixes after the End of Sale is defined in the product's End of Sale bulletin, as explained in the [Cisco End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Please refer to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html) for additional information.

|  | TITLE | PUBLICATION DATE | IMPACT | FIRST FIXED OR NOT AFFECTED  The first release in the upgrade path that addresses all vulnerabilities detailed in the advisory. |
| --- | --- | --- | --- | --- |
|  | [{{v1.title}}](%7B%7Bv1.url%7D%7D "{{v1.identifier}}") This advisory does not affect all platforms. | {{v1.firstPublished | date :'yyyy MMM dd' : 'UTC'}} | {{v1.impact}} | {{v2}}  The first-fixed release for this advisory is not the same for all platforms. Search against individual platforms to determine the first-fixed release for each platform.  Some platforms do not have a first-fixed release for this advisory. Search against individual platforms to determine the first-fixed release for each platform.  [SMU available](%7B%7BgetSmuUrl%28v2.smuURL%29%7D%7D) |
| {{message}} | | | | |
| **COMBINED FIRST FIXED OR NOT AFFECTED**   The first release in the upgrade path that addresses all vulnerabilities in all selected advisories.    {{c1}}, | | | | |
| --- | --- | --- | --- | --- |
{{advValue}}
##### None of the specified Cisco Security Advisories affect the selected Cisco software release

Cisco Software Checker data is currently unavailable.

{{errorPage3}}

#### Security Check

![](Resources/images/captchaImages/loader.gif)

![](Resources/images/audio-on.svg)
![](Resources/images/audio-off.svg)
Your browser does not support the audio element.

Please enter the text correctly.

Can't read the security check? Try another.

---

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)



=== Content from www.cisco.com_f946a804_20250115_120505.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Defense Orchestrator](/c/en/us/support/security/defense-orchestrator/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-orchestrator/products-installation-and-configuration-guides-list.html)
# Managing FDM Devices with Cisco Security Cloud Control

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Managing FDM-Managed Devices with Cisco Security
  Cloud Control](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/managing-ftd-with-cdo.html)
* [Basics of Security Cloud Control](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/basics-of-cisco-defense-orchestrator.html)
* [Onboard Devices and Services](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html)
* [Configuring FDM-Managed Devices](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/configuring-ftd-devices.html)
* [Monitoring and Reporting Change Logs, Workflows, and Jobs](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/monitoring-and-reporting.html)
* [Cisco Security Analytics and Logging](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/cisco-security-analytics-and-logging.html)
* [Integrating Security Cloud Control with Cisco Security Cloud Sign On](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/integrating-cdo-with-securex.html)
* [Terraform](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/m-cdo-terraform.html)
* [Troubleshooting](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/troubleshooting.html)
* [FAQ and Support](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/faq-and-support.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Managing FDM Devices with Cisco Security Cloud Control Chapter Title Onboard Devices and Services

* [PDF - Complete Book
  (15.68 MB)](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator.pdf)
  [PDF - This Chapter (2.7 MB)](/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator/onboard-devices-and-services.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: January 10, 2025

## Chapter: Onboard Devices and Services

Chapter Contents

* [Onboard Devices and Services](#Cisco_Generic_Topic.dita_8b6c26fa-03b9-413f-af92-3bbe687c30e4)
* [Onboard a Threat Defense Device](#Onboarding_an_FTD_to_CDO)
  + [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface)
    - [Manage an FDM-Managed Device from the Inside Interface](#Manage_FTD_from_the_InsideInterface)
  + [Managing an FDM-Managed Device from the Outside Interface](#About_Managing_FTD_from_the_Outside_Interface)
    - [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface)
  + [Onboard an FDM-Managed Device to Security Cloud Control](#Cisco_Concept.dita_d6daef95-4c3f-4b41-be5b-71699ca538fa)
    - [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_Procedure)
    - [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
      * [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD)
      * [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure)
    - [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key)
      * [Unregistering an FDM-Managed Device from Cisco Cloud Services](#Unregistering_anFTD_from_Cisco_Cloud_Services)
      * [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure)
    - [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number)
      * [Workflow and Prerequisites to Onboard the FDM-Managed Device Using Zero-Touch Provisioning](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number)
        + [Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning](#Onboarding_Procedure)
      * [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number)
    - [Onboard an FDM-Managed High Availability Pair](#Cisco_Concept.dita_5369ba64-fdc7-4637-a3d4-5235c9cd7d8f)
      * [Onboard an FDM-Managed High Availablity Pair with a Registration Key](#Before_You_Begin)
        + [Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5](#Onboard_an_FTD_HA_Pair_Running_Version_64_or_Version_65)
        + [Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later](#Onboard_an_FTD_HA_Pair_Running_Version_66_or_Version_67_and_later)
      * [Onboard an FDM-Managed High Availability Pair](#Cisco_Task.dita_4b81ad97-372f-4a17-9312-64c8dc973b37)
    - [Onboard an FTD Cluster](#onboard-an-ftd-cluster)
      * [Onboard a Clustered Secure Firewall Threat Defense Device](#onboard-a-ftd-cluster)
* [Applying or Updating a Smart License](#Applying_or_Updating_a_Smart_License)
  + [Smart-License an FDM-Managed Device When Onboarding Using a Registration Key](#SmartLicense_an_FTDDevice_When_OnboardingUsing_a_Registration_Key)
  + [Smart-License an FDM-Managed Device After Onboarding the Device Using a Registration Key or its Credentials](#SmartLicensean_FTDDevice_After_Onboarding_the_Device_Using_a_Registration_Key_or_its_Credentials)
  + [Updating an Existing Smart License of an FDM-Managed Device](#Updating_an_Existing_Smart_Licenseof_anFTDDevice)
  + [Change the Smart License Applied to an FDM-Managed Device Onboarded Using a Registration Key](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_a_Registration_Key)
  + [Change the Smart License Applied to an FDM-Managed Device Onboarded Using its Credentials](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_its_Credentials)
* [Security Cloud Control Support for DHCP Addressing of FDM-Managed Devices](#CDO_Support_for_DHCP_Addressing_of_FTD_Devices)
* [FDM-Managed Device Licensing Types](#FTD_Licensing_Types)
  + [Virtual FDM-Managed Device Tiered Licenses](#Cisco_Concept.dita_c59521f9-9d6c-4838-9b34-f4de7a69dc07)
  + [Viewing Smart-Licenses for a Device](#Viewing_SmartLicenses_for_a_Device)
  + [Enabling or Disabling Optional Licenses](#Before_you_Begin)
  + [Impact of Expired or Disabled Optional Licenses](#Impact_of_Expired_or_Disabled_Optional_Licenses)
* [Create and Import an Firewall Device Manager Model](#Create_and_Import_an_FTD_Model)
  + [Export FDM-Managed Device Configuration](#Export_FTD_Configuration)
  + [Import FDM-Managed Device Configuration](#Import_FTD_Configuration)

- [Delete a Device from Security Cloud Control](#Cisco_Task_in_List_GUI.dita_30250c0b-d78c-41b7-bdca-dca15c7d595d)
- [Import Configuration for Offline Device Management](#Cisco_Reference.dita_c8b96c27-74b5-4599-8331-096b9ad84150)
- [Backing Up FDM-Managed Devices](#Backing_Up_FTDs)
  * [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
    + [Procedure](#Procedure)
  * [Configure a Recurring Backup Schedule for a Single FDM-Managed Device](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
    + [Procedure](#Procedure)
  * [Download the Device Backup](#Procedure)
  * [Edit a Backup](#Edit_an_FTD_Backup)
  * [Delete a Backup](#Delete_an_FTDBackup)
  * [Managing Device Backup](#Managing_FTD_Backups)
  * [Restore a Backup to an FDM-Managed Device](#Procedure)
- [FDM Software Upgrade Paths](#Firepower_Software_Upgrade_Path)
  * [Other Upgrade Limitations](#Cisco_Task.dita_c9a8eb49-bab9-4b30-a756-0b39c58e83f1)
  * [4100 and 9300 Series Devices](#Cisco_Concept.dita_d0145adc-cabf-45b1-9197-8e3f1f0b1cb3)
- [FDM-Managed Device Upgrade Prerequisites](#FTD_Upgrade_Prerequisites)
- [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
  * [Upgrade A Single FDM-Managed Device with Images from Security Cloud Control's Repository](#Upgrade_A_Single_FTD_with_Images_from_CDOsRepository)
  * [Upgrade a Single FDM-Managed Device with Images from your own Repository](#Upgrade_a_Single_FTD_with_Images_from_your_ownRepository)
  * [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)
- [Bulk FDM-Managed Devices Upgrade](#Bulk_FTD_Upgrade)
  * [Upgrade Bulk FDM-Managed Devices with Images from Security Cloud Control's Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_CDOsRepository)
  * [Upgrade Bulk FDM-Managed Devices with Images from your own Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_your_ownRepository)
  * [Monitor the Bulk Upgrade Process](#Monitor_the_Bulk_Upgrade_Process)
- [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)
  * [Upgrade an FDM-Managed HA Pair with Images from Security Cloud Control's Repository](#Upgrade_an_FTD_HAPair_with_Images_from_CDOsRepository)
  * [Upgrade an FDM-Managed HA Pair with Images from your own Repository](#Upgrade_an_FTD_HAPair_with_Images_from_your_ownRepository)
  * [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)
- [Upgrade to Snort 3.0](#Upgrade_to_Snort_3)
  * [Upgrade the Device and the Intrusion Prevention Engine Simultaneously](#Upgrade_the_Device_and_the_Intrusion_Prevention_EngineSimultaneously)
  * [Upgrade the Intrusion Prevention Engine](#Upgrade_the_Intrusion_Prevention_Engine)
  * [Monitor the Upgrade Process](#Cisco_Concept.dita_734b576c-42ad-4612-ae33-5fbefcdbc912)
- [Revert From Snort 3.0 for FDM-Managed Device](#Revert_From_Snort_3_for_FTD)
  * [Revert From Snort 3.0](#Revert_From_Snort_3)
- [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update)
  * [Edit a Scheduled Security Database Update](#Edit_a_Scheduled_Security_Database_Update)
Close

# Onboard Devices and Services

You can onboard both live devices and model devices to Security Cloud Control. Model devices are uploaded configuration files that you can view and edit using Security Cloud Control.

Most live devices and services require an open HTTPS connection so that the Secure Device
Connector can connect Security Cloud Control to the device or service.

See [Secure Device Connector](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_e19faf6e-4e1b-4bb3-ad82-48a080430e8c) for more information on the SDC and its state.

This chapter covers the following sections:

* [Onboard a Threat Defense Device](#Onboarding_an_FTD_to_CDO)
* [Delete a Device from Security Cloud Control](#Cisco_Task_in_List_GUI.dita_30250c0b-d78c-41b7-bdca-dca15c7d595d)
* [Import Configuration for Offline Device Management](#Cisco_Reference.dita_c8b96c27-74b5-4599-8331-096b9ad84150)
* [Backing Up FDM-Managed Devices](#Backing_Up_FTDs)
* [FDM Software Upgrade Paths](#Firepower_Software_Upgrade_Path)
* [FDM-Managed Device Upgrade Prerequisites](#FTD_Upgrade_Prerequisites)
* [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
* [Bulk FDM-Managed Devices Upgrade](#Bulk_FTD_Upgrade)
* [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)
* [Upgrade to Snort 3.0](#Upgrade_to_Snort_3)
* [Revert From Snort 3.0 for FDM-Managed Device](#Revert_From_Snort_3_for_FTD)
* [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update)

## Onboard a Threat Defense Device

| **Attention** | ---   Secure Firewall device manager (FDM) support and functionality is only available upon request. If you do not already have Firewall device manager support enabled on your tenant you cannot manage or deploy to FDM-managed devices. [Send a request to the support team](faq-and-support.html#Cisco_Concept.dita_92ad1f10-ddda-45fe-b4e9-ea9433046396) to enable this platform.   --- |
| --- | --- |

There are different methods of onboarding a threat defense device. We recommend using the registration key method.

If you experience issues while onboarding a device, see [Troubleshoot FDM-Managed Device Onboarding Using Serial Number](troubleshooting.html#Cisco_Reference.dita_2c78ba62-d55a-4cef-8490-4d117af93f19) or [Failed Because of Insufficient License](troubleshooting.html#Failed_Because_of_Insufficient_License) for more information.

### Onboard a Threat Defense Device to Cloud-delivered Firewall Management Center

You can onboard threat defense devices running version 7.2 and later to the Cloud-delivered Firewall Management
Center. See [Onboard an FTD to the Cloud-Delivered Firewall Management Center](https://www.cisco.com/c/en/us/td/docs/security/cdo/cloud-delivered-firewall-management-center-in-cdo/managing-firewall-threat-defense-services-with-cisco-defense-orchestrator/m-onboard-for-ftd-management.html) for more information.

### Onboard a Threat Defense Device with a Serial Number

This procedure is a simplified method of onboarding the Firepower 1000, Firepower 2100, Secure Firewall
1210/1220, or Secure Firewall 3100 series physical devices running supported versions of software. To onboard the device, you need the chassis serial number
or PCA serial number of the device and ensure that the device is added to a network that can reach the internet.

You can onboard new factory-shipped devices or already configured devices to Security Cloud Control.

See [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number) for more information.

### Onboard a Threat Defense Device with a Registration Key

We recommend onboarding threat defense devices with a registration key. This is beneficial if your device is assigned an IP address using DHCP. If that IP address
changes for some reason, your threat defense device remains connected to Security Cloud Control if you have onboarded it with a registration key.

* [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key)

### Onboard an Threat Defense Device Using Credentials

You can onboard a threat defense device using the device credentials and the IP address of the device's outside, inside, or management interface depending
on how the device is configured in your network. To onboard a device with credentials, see [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_Procedure). To onboard with an interface address, see  [Device Addressing](#Onboarding_an_FTD_to_CDO) later in this article.

Security Cloud Control needs HTTPS access to the device in order to manage it. How you allow HTTPS access to the device depends on how your device
is configured in your network and whether you onboard the device using a [Secure Device Connector](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_e19faf6e-4e1b-4bb3-ad82-48a080430e8c) or a Cloud Connector.

| **Note** | ---   If you connect to <https://us.manage.security.cisco.com> and you are using software version 6.4, you must onboard the threat defense device with this method. You cannot use the registration key method.   --- |
| --- | --- |

When using device credentials to connect Security Cloud Control to a device, it a best practice to download and deploy a Secure Device Connector (SDC) in your network to manage the communication
between Security Cloud Control and the device. Typically, these devices are non-perimeter based, do not have a public IP address, or have an open port to
the outside interface. The threat defense device, when onboarded with credentials, can be onboarded to Security Cloud Control using an SDC.

Note that customers also using the threat defense devie as the head-end for VPN connections will not be able to use the outside interface to manage their device.

### Onboard a Threat Defense Cluster

You can onboard a threat defense device that is clustered prior to onboarding to Security Cloud Control. Clustering lets you group multiple firewall threat defense units together as a single logical device that provides the convenience of a single device (management, integration into
a network) while achieving the increased throughput and redundancy of multiple devices.

See [Onboard a Clustered Secure Firewall Threat Defense Device](#onboard-a-ftd-cluster).

### FDM-Managed Device Configuration Prerequisites for Onboarding

### FDM-Managed Device Management

You can only onboard threat defense devices that are being managed by Secure Firewall
device manager (FDM). threat defense devices being managed by Secure Firewall Management Center cannot be managed by the cloud-delivered Firewall
Management Center.

If the device is not configured for local management, you must switch to local management before onboarding the device. See
the **Switching Between Local and Remote Management** chapter of the [Secure Firewall Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor854).

### Licensing

The device must have at least an license installed before it can be onboarded to Security Cloud Control although you can have a Smart License applied in some circumstances.

| Onboarding Method | Secure Firewall device manager Software Version | 90-day Evaluation licensed allowed? | Can the device already be smart-licensed before onboarding? | Can the device already be registered with Cisco Cloud Services before you onboarding? |
| --- | --- | --- | --- | --- |
| Credentials (user name and password) | 6.4 or later | Yes | Yes | Yes |
| Registration Key | 6.4 or 6.5 | Yes | No. Unregister the smart license and then onboard the device. | N/A |
| Registration Key | 6.6 or later | Yes | Yes | No. Unregister the device from Cisco Cloud Services and then onboard the device. |
| Zero-Touch Provisioning | 6.7 or later | Yes | Yes | Yes |
| Onboarding a device with a Serial Number | 6.7 or later | Yes | Yes | Yes |

See [Cisco Firepower System Feature Licenses for more information](https://www.cisco.com/c/en/us/td/docs/security/firepower/roadmap/firepower-licenseroadmap.html).

### Device Addressing

It is a best practice that the address you use to onboard the FDM-managed device is a static address. If the device's IP address is assigned by DHCP, it would be optimal to use a DDNS (dynamic domain
name system) to automatically update your device's domain name entry with the new IP address of the device if it changes.

| **Note** | ---   FDM-managed devices do not natively support DDNS; you must configure your own DDNS.   --- |
| --- | --- |

| **Important** | ---   If your device gets an IP address from a DHCP server, and you *do not* have a DDNS server updating the FDM-managed device's domain name entry with any new IP addresses, or your device receives a new address, you can [change the IP address Security Cloud Control maintains for the device](basics-of-cisco-defense-orchestrator.html#Changing_a_Devices_IP_Address_in_CDO) and then [reconnect the device](basics-of-cisco-defense-orchestrator.html#How_to_BulkReconnect_toDevices). Better still, onboard the device with a registration key.   --- |
| --- | --- |

* [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface)
* [Managing an FDM-Managed Device from the Outside Interface](#About_Managing_FTD_from_the_Outside_Interface)
* [Onboard an FDM-Managed Device to Security Cloud Control](#Cisco_Concept.dita_d6daef95-4c3f-4b41-be5b-71699ca538fa)
* [Applying or Updating a Smart License](#Applying_or_Updating_a_Smart_License)
* [Security Cloud Control Support for DHCP Addressing of FDM-Managed Devices](#CDO_Support_for_DHCP_Addressing_of_FTD_Devices)
* [FDM-Managed Device Licensing Types](#FTD_Licensing_Types)
* [Create and Import an Firewall Device Manager Model](#Create_and_Import_an_FTD_Model)

### Managing an FDM-Managed Device from the Inside Interface

Managing an FDM-managed device using the inside interface may be desirable if the dedicated MGMT interface is
assigned an address that is not routable within your organization; for example, it might
only be reachable from within your data center or lab.

Figure 1. Interface Addresses

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457521.jpg)

#### Remote Access VPN Requirement

If the FDM-managed device you manage with Security Cloud Control will be managing Remote Access VPN (RA VPN) connections, Security Cloud Control must manage the device using the inside interface.

#### What to do next:

Continue to [Manage an FDM-Managed Device from the Inside Interface](#Manage_FTD_from_the_InsideInterface) for the procedure for configuring the FDM-managed device.

* [Manage an FDM-Managed Device from the Inside Interface](#Manage_FTD_from_the_InsideInterface)

#### Manage an FDM-Managed Device from the Inside Interface

This configuration method:

* Assumes that the FDM-managed device has not been on-boarded to Security Cloud Control.
* Configures a data interface as the inside interface.
* Configures the inside interface to receive MGMT traffic (HTTPS).
* Allows the address of the cloud connector to reach the inside interface of
  the device.

##### Before you begin

Review the prerequisites for this configuration in these topics:

* [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface)
* [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC)

##### Procedure

---

| **Step 1** | Log in to the Secure Firewall device manager. |
| --- | --- |
| **Step 2** | In the System Settings menu, click Management Access. |
| **Step 3** | Click the Data Interfaces tab and click Create Data Interface.   1. In the Interface field, select the pre-named "inside" interface from the list of interfaces. 2. In the Protocols field, select HTTPS if it is not already. 3. In the ****Allowed Networks**** field, select the network    objects that represent the networks inside your organization that    will be allowed to access the inside address of the FDM-managed device. The IP address of the SDC or cloud connector should be    among the addresses allowed to access the inside address of the    device.  In the [Interface Addresses](#About_Managing_FTDfrom_the_InsideInterface__ftd-interf-addrss) diagram, the SDC's IP address, 192.168.1.10 should be able to reach 192.168.1.1. |
| **Step 4** | Deploy the change. You can now manage the device using the inside interface. |

---

##### What to do next

**What if you are using a Cloud Connector?**

Use the procedure
above and add these steps:

* Add a step to "NAT" the outside interface to (203.0.113.2) to the inside
  interface (192.168.1.1). See [Interface
  Addresses](#About_Managing_FTDfrom_the_InsideInterface__ftd-interf-addrss).
* In step 3c of the procedure above, your "Allowed Network" is a network
  group object containing the public IP addresses of the cloud
  connector.
* Add a step that creates an Access Control rule allowing access to the outside interface (203.0.113.2) from the public IP addresses
  of the cloud connector. See for a list of all the Cloud Connector IP addresses for the various Security Cloud Control regions.

**Onboard the FDM-Managed Device**

The recommended way of onboarding the FDM-managed device to Security Cloud Control is to use the registration token onboarding approach. After you configure the inside interface to allow management access
from the Cloud Connector to the FDM-managed device, onboard the FDM-managed device with the user name and password. See [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_an_FTD_to_CDO) for more information. You will connect using the IP address of the inside interface. In our scenario above, that address
is 192.168.1.1.

### Managing an FDM-Managed Device from the Outside Interface

Managing an cloud-delivered Firewall
Management Center device from the outside interface may be desirable if you have one public IP address assigned to a branch office and Security Cloud Control is managed using a Cloud Connector at another location.

Figure 2. Device Management on Outside Interface

![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457522.jpg)

This configuration doesn't mean that the physical MGMT interface is no longer the device's management interface. If you were
in the office where the cloud-delivered Firewall
Management Center device was located, you would be able to connect to the address of the MGMT interface and manage the device directly.

#### Remote Access VPN Requirement

If the device you manage with cloud-delivered Firewall
Management Center will be managing Remote Access VPN (RA VPN) connections, cloud-delivered Firewall
Management Center will not be able to manage the cloud-delivered Firewall
Management Center device using the outside interface. See [Managing an FDM-Managed Device from the Inside Interface](#About_Managing_FTDfrom_the_InsideInterface) instead.

#### What to do next:

Continue to [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface) for the procedure for configuring the cloud-delivered Firewall
Management Center device.

* [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface)

#### Manage the FDM-Managed Device's Outside Interface

This configuration method:

1. Assumes that the FDM-managed device has not been on-boarded to Security Cloud Control.
2. Configures a data interface as the outside interface.
3. Configures management access on the outside interface.
4. Allows the public IP address of the cloud connector (after it has been NAT'd
   through the firewall) to reach the outside interface.

##### Before you begin

Review the prerequisites for this configuration in these topics:

* [Manage the FDM-Managed Device's Outside Interface](#Manage_the_FTD_Outside_Interface)
* [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC)

##### Procedure

---

| **Step 1** | Log in to the Secure Firewall device manager. |
| --- | --- |
| **Step 2** | In the System Settings menu, click Management Access. |
| **Step 3** | Click the Data Interfaces tab and click Create Data Interface.   1. In the Interface field, select the pre-named "outside" interface from the list of interfaces. 2. In the Protocols field, select    HTTPS if it is not already. Security Cloud Control only needs HTTPS access. 3. In the Allowed Networks field, create a host    network object containing the public-facing IP address of the cloud    connector after it gets NAT'd through the firewall.  In the [Device Management from    Outside Interface](#About_Managing_FTD_from_the_Outside_Interface__ftd-mgmt-out-addrss) network diagram, the cloud connector's    IP address, 10.10.10.55, would be NAT'd to 203.0.113.2. For the    Allowed Network, you would create a host network object with the    value 203.0.113.2. |
| **Step 4** | Create an Access Control policy in Secure Firewall device manager that allows management traffic (HTTPS) from the public IP address of the SDC or cloud connector, to the outside interface of your FDM-managed device. In this scenario, the source address would be 203.0.113.2 and the source protocol would be HTTPS; the destination address would be 209.165.202.129 and the protocol would be HTTPS. |
| **Step 5** | Deploy the change. You can now manage the device using the outside interface. |

---

##### What to do next

**What if you are using a cloud connector?**

The process is very similar, except for two things:

* In step 3c of the procedure above, your "Allowed Network" is a network group object containing the public IP addresses of
  the cloud connector. See [Connecting Devices to Security Cloud Control Through the Cloud Connector](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC__cloud-connect-ip) for a list of Cloud Connector IP addresses for the various Security Cloud Control regions.
* In step 4 of the procedure above, you create an Access Control rule that
  allows access to the outside interface from the public IP addresses of the
  cloud connector.

The [registration token onboarding](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key) approach is the recommended way of onboarding the FDM-managed device to Security Cloud Control. After you configure the outside interface to allow management access from the cloud connector, onboard the FDM-managed device. You will connect using the IP address of the outside interface. In our scenario, that address is 209.165.202.129.

### Onboard an FDM-Managed Device to Security Cloud Control

Use the following procedures to onboard an FDM-managed to Security Cloud Control with the following methods.

* [Onboard an FDM-Managed Device Using Username, Password, and IP Address](#Onboarding_Procedure)
* [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key)
* [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number)
* [Onboard an FDM-Managed High Availability Pair](#Cisco_Concept.dita_5369ba64-fdc7-4637-a3d4-5235c9cd7d8f)
* [Onboard an FTD Cluster](#onboard-an-ftd-cluster)

#### Onboard an FDM-Managed Device Using Username, Password, and IP Address

Use this procedure to onboard an FDM-managed device using only the device credentials and the device's Management IP address.
This is the simplest method of onboarding an FDM-managed device. However, the recommended way of onboarding an FDM-managed device to Security Cloud Control is by using a [registration key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key).

##### Before you begin

| **Important** | ---   Before you onboard an FDM-managed device to Security Cloud Control, read [Onboard an FDM-Managed Device](#Onboarding_an_FTD_to_CDO) and [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC). They provide the general device requirements and onboarding prerequisites needed to onboard a device.   --- |
| --- | --- |

* You need the following information to onboard an FDM-managed device using the credentials method:

  + The device credentials Security Cloud Control will use to connect to the device.
  + The device's IP address of the interface you are using to manage the
    device. This may be the Management interface, an inside interface,
    or the outside interface depending on how you have configured your
    network.
  + The device must be managed by Secure Firewall
    device manager and configured for local management in order for you to onboard
    it to Security Cloud Control. It cannot be managed by Secure Firewall Management
    Center.

| **Note** | ---   If you connect to <https://eu.manage.security.cisco.com> and your FDM-managed device is running software version 6.4, you must use this method. You can only onboard an FDM-managed device running software version 6.5+.   --- |
| --- | --- |

##### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**.   | **Important** | When you attempt to onboard an FDM-managed device, Security Cloud Control prompts you to read and accept the Secure Firewall Threat Defense End User License Agreement (EULA), which is a one-time activity for your tenant. Once you accept the EULA, Security Cloud Control won't prompt you again to accept it unless the EULA changes. | | --- | --- | |
| **Step 5** | In the onboarding wizard, click **Use Credentials**. |
| **Step 6** | In the Device Details step:   * Click the **Secure Device Connector** button and select a Secure Device Connector (SDC) installed in your network. If you would rather not use an SDC, Security Cloud Control can connect to your FDM-managed device using the Cloud Connector. Your choice depends on how you [connect Security Cloud Control to your managed devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC). * Enter the device name in the **Device Name** field. This could be   the hostname of the device or any other name you choose. * In the**Location** field, enter the IP address of the interface   you are using to manage the device, hostname, or fully qualified   domain name of the device. The default port is 443.  | **Important** | If you already have a SecureX or Cisco Threat Response (CTR) account, you will need to merge your Security Cloud Control tenant and SecureX/CTR account in order for your devices to be registered with SecureX. Your accounts can be merged through the SecureX portal. See [Merge Your Security Cloud Control and SecureX Accounts](https://cisco.com/go/merge-accounts)  for instructions. Until your accounts are merged, you will not be able to see your device’s events in SecureX or benefit from other SecureX features. | | --- | --- | |
| **Step 7** | In the **Database Updates** area, the **Immediately perform security updates, and enable recurring updates** is enabled by default. This option immediately triggers a security update as well as automatically schedules the device to check for additional updates every Monday at 2AM. See [Update FTD Security Databases](configuring-ftd-devices.html#Update_the_Security_Databases) and [Schedule a Security Database Update for more information](#Createa_Scheduled_Security_Database_Update).  Disabling this option does not affect any previously scheduled updates you may have configured through FDM.  Click **Next**. |
| **Step 8** | Enter the device administrator's username and password and click **Next**. |
| **Step 9** | If there are pending changes on the device's Secure Firewall device manager, you will be notified and you can revert the changes or log in to the manager and deploy the pending changes. If there are no pending changes on Secure Firewall device manager, you will not see a prompt. |
| **Step 10** | (Optional) Add a label the device. See [Labels and Label Groups](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_f15e9db8-94d5-4516-9107-1af22df49154) for more information. |

---

#### Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key

This procedure describes how to onboard an FDM-managed device using a registration key. This method is the recommended way of onboarding the FDM-managed device to Security Cloud Control and is beneficial if your FDM-managed device is assigned an IP address using DHCP. If that IP address changes for some reason, your FDM-managed device remains connected to Security Cloud Control. Additionally, your FDM-managed device can have an address on your local area network, and as long as it can access the outside network, it can be onboarded
to Security Cloud Control using this method.

| **Warning** | ---   If you already have a SecureX or Cisco Threat Response (CTR) account, you will need to merge your Security Cloud Control tenant and SecureX/CTR account in order for your devices to be registered with SecureX. Until your accounts are merged, you will not be able to see your device's events in SecureX or benefit from other SecureX features. We **strongly** recommend merging your accounts before you create a Security Cloud Control module in SecureX. Your accounts can be merged through the SecureX portal. See [Merge Accounts](https://admin.sse.itd.cisco.com/assets/static/online-help/index.html#!t_merge-your-cdo-and-securex-accounts.html) for instructions.   --- |
| --- | --- |

##### Before Onboarding

* For customers running version 6.4, this method of onboarding is only
  supported for the US region, <https://us.manage.security.cisco.com>.
* For customers running version 6.4, and connecting to the EU region, they must
  onboard their device using its [device username, password, and
  IP address](#Onboarding_Procedure).
* Customers running version 6.5 or later, and connecting either to the US, EU,
  or APJ regions can use this method of onboarding.
* Review [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC) for the networking
  requirements needed to connect Security Cloud Control to yourFDM-managed device.
* Make sure your device is managed by Secure Firewall
  device manager, not Secure Firewall Management Center.
* Devices running version 6.4 and 6.5 must not be registered with Cisco Smart Software Manager before onboarding them with a
  registration key. You will need to unregister the smart licenses of those FDM-managed devices before onboarding them to Security Cloud Control. See "Unregistering a Smart-licensed Firewall device manager" below.
* The device may be using a 90-day evaluation license.
* Log in to the FDM-managed device and make sure that there are no pending changes waiting on the device.
* Make sure DNS is configured properly on your FDM-managed device.
* Make sure the time services are configured properly on the FDM-managed device.
* Make sure the FDM-managed device shows the correct date and time otherwise the onboarding will fail.

##### What to do next

Do one of these two these things:

* Unregsiter your FDM-managed device from Cisco Smart Software Manager if it is already smart-licensed.
  **You must unregister the device from Cisco Smart Software Manager
  before you onboard it to Security Cloud Control with a registration Key.**Continue to [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD).
* If your device is not already smart-licensed, continue to [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure).

* [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD)
* [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure)

##### Unregister a Smart-licensed FDM-Managed Device

If the device you want to onboard is running version 6.4 or 6.5, and is already smart-licensed, the device is likely to be
registered with Cisco Smart Software Manager. **You must unregister the device from Cisco Smart Software Manager before you onboard it to Security Cloud Control with a registration Key.** When you unregister, the base license and all optional licenses associated with the device, are freed in your virtual account.

After unregistering the device, the current configuration and policies on the device continue to work as-is, but you cannot
make or deploy any changes.

###### Procedure

---

| **Step 1** | Log on to the device using the Secure Firewall device manager. |
| --- | --- |
| **Step 2** | Click the device icon in the upper tab. |
| **Step 3** | In the **Smart License** area, click **View Configuration**. |
| **Step 4** | Click the **Go to Cloud Services** gear menu and select **Unregister Device**. |
| **Step 5** | Read the warning and click **Unregister** to unregister the device. |

---

###### What to do next

If you unregistered your in order to onboard it to Security Cloud Control, continue to [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure)

##### Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key

To onboard an FDM-managed using a registration key, follow this procedure:

###### Before you begin

Review the prerequisites discussed in [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key).

###### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**.   | **Important** | When you attempt to onboard an FDM-managed device, Security Cloud Control prompts you to read and accept the Firepower Threat Defense End User License Agreement (EULA), which is a one-time activity in your tenant. Once you accept this agreement, Security Cloud Control doesn't prompt it again in subsequent FDM-managed onboarding. If the EULA agreement changes in the future, you must accept it again when prompted. | | --- | --- | |
| **Step 5** | On the **Onboard FTD Device** screen, click **Use Registration Key**. |
| **Step 6** | Enter the device name in the **Device Name** field. This could be the hostname of the device or any other name you choose. |
| **Step 7** | In the **Database Updates** area, the **Immediately perform security updates, and enable recurring updates** option is enabled by default. This option immediately triggers a security update as well as automatically schedules the device to check for additional updates every Monday at 2AM. See [Update FTD Security Databases](configuring-ftd-devices.html#Update_the_Security_Databases) and [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update) for more information.   | **Note** | Disabling this option does not affect any previously scheduled updates you may have configured through Secure Firewall device manager. | | --- | --- | |
| **Step 8** | In the **Create Registration Key** area, Security Cloud Control generates a registration key.   | **Note** | If you move away from the onboarding screen after the key is generated and before the device is fully onboarded, you will not be able to return to the onboarding screen; however, Security Cloud Control creates a placeholder for that device on the **Security Devices** page. When you select the device's placeholder, you will be able to see the key for that device in an action pane located to the right. | | --- | --- | |
| **Step 9** | Click the Copy icon  to copy the registration key.   | **Note** | You can skip copying the registration key and click **Next** to complete the place holder entry for the device and later, register the device. This option is useful when you're attempting to create the device first and later register it or if you're a Cisco partner installing a Proof of Value (POV) device in a customer network. | | --- | --- |   In the **Security Devices** page, you will see that the device is now in the connectivity state, "Unprovisioned". Copy the registration key appearing under **Unprovisioned** to Firewall device manager to complete the onboarding process. |
| **Step 10** | Log into the Secure Firewall device manager of the device you want to onboard to Security Cloud Control. |
| **Step 11** | In **System Settings**, click **Cloud Services**. |
| **Step 12** | In the Security Cloud Control tile, click **Get Started**. |
| **Step 13** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to.   | **Note** | This step is not applicable FDM-managed devices running version 6.4. | | --- | --- | |
| **Step 14** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 15** | Click **Register** and then **Accept** the Cisco Disclosure. |
| **Step 16** | Return to Security Cloud Control. Select all the licenses you want to apply to the device.  For more information, see [Applying or Updating a Smart License](#Applying_or_Updating_a_Smart_License). You can also click **Skip** to continue the onboarding with a 90-day evaluation license. |
| **Step 17** | Return to Security Cloud Control, open the **Security Devices** page and see that the device status progresses from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

#### Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key

This procedure describes how to onboard an FDM-managed device running Version 6.6+ using a registration key. This method is the recommended way of onboarding the FDM-managed device to Security Cloud Control and is beneficial if your FDM-managed device is assigned an IP address using DHCP. If that IP address changes for some reason, your FDM-managed device remains connected to Security Cloud Control. Additionally, your FDM-managed device can have an address on your local area network, and as long as it can access the outside network, it can be onboarded
to Security Cloud Control using this method.

| **Warning** | ---   If you already have a SecureX or Cisco Threat Response (CTR) account, you will need to merge your Security Cloud Control tenant and SecureX/CTR account in order for your devices to be registered with SecureX. Until your accounts are merged, you will not be able to see your device's events in SecureX or benefit from other SecureX features. We **strongly** recommend merging your accounts before you create a Security Cloud Control module in SecureX. Your accounts can be merged through the SecureX portal. See [Merge Accounts](https://admin.sse.itd.cisco.com/assets/static/online-help/index.html#!t_merge-your-cdo-and-securex-accounts.html) for instructions.   --- |
| --- | --- |

If you want to onboard an FDM-managed device running version 6.4 or 6.5, see [Onboard an FDM-Managed Device Running
Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key).

##### Before Onboarding

* This method of onboarding is currently available for version 6.6+ and to
  customers connecting to <https://us.manage.security.cisco.com>, <https://eu.manage.security.cisco.com>, or <https://apj.manage.security.cisco.com>.
* **Review**
  [Connect Security Cloud Control to your Managed Devices](basics-of-cisco-defense-orchestrator.html#Connect_Cisco_Defense_Orchestratorto_the_CloudSDC) for the networking
  requirements needed to connect Security Cloud Control to your FDM-managed device.
* Make sure your device is managed by Secure Firewall
  device manager, not Secure Firewall Management Center.
* The device can be using a 90-day evaluation license or it can be
  smart-licensed. Devices running version 6.6+ can be onboarded to Security Cloud Control using a registration key without unregistering any installed smart
  licenses.
* The device cannot already be registered with Cisco Cloud Services. See
  "Unregistering an FDM-Managed Device from Cisco Cloud Services" below before onboarding.
* Log in to the device's Secure Firewall
  device manager UI and make sure that there are no pending changes waiting on the
  device.
* Make sure DNS is configured properly on your FDM-managed device.
* Make sure the time services are configured on the FDM-managed device.
* Make sure the FDM-managed device shows the correct date and time otherwise the onboarding will fail.

##### What to do next:

Do one of these things:

* If your FDM-managed device running verison 6.6+ is already registered with Cisco Cloud
  Services, you need to unregister the device before onboarding it. Continue
  to [Unregistering an FDM-Managed Device from Cisco Cloud Services](#Unregistering_anFTD_from_Cisco_Cloud_Services).
* If your device is not registered to Cisco Cloud Services, continue to [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure).

* [Unregistering an FDM-Managed Device from Cisco Cloud Services](#Unregistering_anFTD_from_Cisco_Cloud_Services)
* [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure)

##### Unregistering an FDM-Managed Device from Cisco Cloud Services

The following procedure is how to unregister the device from Cisco Cloud Services. Use
this method before you onboard and FDM-managed device to Security Cloud Control with a registration key.

| **Note** | ---   If you onboard a virtual FDM-managed device running version 7.0 or later, registering the virtual FDM-managed device to Security Cloud Control automatically resets the performance-tiered Smart Licensing selection to **Variable**, which is the default tier. You **must** manually re-select the tier that matches the license associated with the device through the Secure Firewall device manager UI after onboarding.   --- |
| --- | --- |

Use this procedure to check and make sure it is not registered to Cisco Cloud Services:

###### Procedure

---

| **Step 1** | Log on to the device using Secure Firewall device manager. |
| --- | --- |
| **Step 2** | Click the device icon in the upper tab. |
| **Step 3** | Expand the **System Settings** menu and then click **Cloud Services**. |
| **Step 4** | In the **Cloud Services** page, click the gear menu and select **Unregister Cloud Services**. |
| **Step 5** | Read the warning and click **Unregister** to unregister the device. |

---

###### What to do next

If you are trying to onboard a FDM-managed device running version 6.6 or later, continue to [Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboarding_Procedure).

##### Procedure to Onboad an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key

To onboard an FDM-managed device using a registration key, follow this procedure:

###### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**.   | **Important** | When you attempt to onboard the FDM-managed device, Security Cloud Control prompts you to read and accept the End User License Agreement (EULA), which is a one-time activity in your tenant. Once you accept this agreement, Security Cloud Control doesn't prompt it again in subsequent onboarding. If the EULA agreement changes in the future, you must accept it again when prompted. | | --- | --- | |
| **Step 5** | On the **Onboard FTD Device** screen, click **Use Registration Key**. |
| **Step 6** | Enter the device name in the **Device Name** field. This could be the hostname of the device or any other name you choose. |
| **Step 7** | In the **Database Updates** area, the **Immediately perform security updates, and enable recurring updates** is enabled by default. This option immediately triggers a security update as well as automatically schedules the device to check for additional updates every Monday at 2AM. See [Update FTD Security Databases](configuring-ftd-devices.html#Update_the_Security_Databases) and [Schedule a Security Database Update](#Createa_Scheduled_Security_Database_Update) for more information.   | **Note** | Disabling this option does not affect any previously scheduled updates you may have configured through Secure Firewall device manager. | | --- | --- | |
| **Step 8** | In the **Create Registration Key** step, Security Cloud Control generates a registration key.   | **Note** | If you move away from the onboarding screen after the key is generated and before the device is fully onboarded, you will not be able to return to the onboarding screen; however, Security Cloud Control creates a placeholder for that device on the **Security Devices** page. When you select the device's placeholder, you will be able to see the key for that device, on that page. | | --- | --- | |
| **Step 9** | Click the Copy icon  to copy the registration key.   | **Note** | You can skip copying the registration key and click **Next** to complete the place holder entry for the device and later, register the device. This option is useful when you're attempting to create the device first and register it later, or if you're a Cisco partner installing a Proof of Value (POV) device in a customer network. | | --- | --- |   In the **Security Devices** page, you will see that the device is now in the connectivity state, "Unprovisioned". Copy the registration key appearing under **Unprovisioned**to Firewall device manager to completethe onboarding process. |
| **Step 10** | Log into the Secure Firewall device manager of the device you are onboarding. |
| **Step 11** | Under **System Settings**, click **Cloud Services**. |
| **Step 12** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to. |
| **Step 13** | In the **Enrollment Type** area, click **Security Account** .   | **Note** | For devices running version 6.6, note that the Tenancy tab for Security Cloud Control is titled **Security Account** and you must manually enable Security Cloud Control in Secure Firewall device manager. | | --- | --- | |
| **Step 14** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 15** | For devices running version 6.7 or later in the Service Enrollment area, check **Enable Cisco Security Cloud Control**. |
| **Step 16** | Review the information about the Cisco Success Network Enrollment. If you do not want to participate, uncheck the **Enroll Cisco Success Network** checkbox. |
| **Step 17** | Click **Register** and then **Accept** the Cisco Disclosure. Secure Firewall device manager sends the registration request to Security Cloud Control. |
| **Step 18** | Return to Security Cloud Control, in the **Create Registration Key** area, click **Next**. |
| **Step 19** | Select all licenses you want to apply to the device. Click **Next**. |
| **Step 20** | Return to Security Cloud Control, open the **Security Devices** page and see that the device status progresses from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

#### Onboard an FDM-Managed Device using the Device's Serial Number

This procedure is a simplified method of setting up and onboarding the FDM-managed devices to Security Cloud Control. All you need is the chassis serial number or PCA serial number of the device. You can apply a smart license or use a 90-day
evaluation license when onboarding the device.

Ensure that you read through the use cases to understand the concepts before you perform the [onboarding steps](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number).

| **Important** | ---   These methods of onboarding FDM-managed devices are only available for devices running version 6.7 or higher.   --- |
| --- | --- |

**Use Cases**

* [Onboard an FDM-Managed Device using the Device's Serial Number](#Onboard_an_FTD_using_the_Devices_Serial_Number): Onboarding a new factory-shipped FDM-managed device that is added to a network and reached from the Internet. The initial device setup wizard is not complete on the device.
* [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number): Onboarding an already configured FDM-managed device or an upgraded device that is already added to a network and reached from the Internet. The initial device setup wizard
  is complete on the device.

| **Important** | ---   If you want to use this method to onboard a device running on an older software version that is supported for your device, you need to perform a fresh installation (reimage) of the software on that device instead of an upgrade.   --- |
| --- | --- |

* [Workflow and Prerequisites to Onboard the FDM-Managed Device Using Zero-Touch Provisioning](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number)
* [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number)

**Related Information:**

* [Terminologies and Definitions](faq-and-support.html#Terminologies_and_Definitionsused_inLowTouch_Provisioning)
* [Troubleshoot FDM-Managed Device Onboarding using Serial Number](troubleshooting.html#Cisco_Reference.dita_2c78ba62-d55a-4cef-8490-4d117af93f19)

##### Workflow and Prerequisites to Onboard the FDM-Managed Device Using Zero-Touch Provisioning

Zero-Touch Provisioning is a feature that allows a new factory-shipped Firepower 1000, Firepower 2100, or Secure Firewall 3100 series device to be provisioned and configured automatically, eliminating most of the manual tasks involved with onboarding
the device to Security Cloud Control. The zero-touch provisioning is intended for remote offices or other locations where your employees are less experienced working with networking devices.

To use the zero-touch provisioning process, you must onboard the device to Security Cloud Control, connect it to a network that can reach the internet, and power on the device. See [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number) for more information.

| **Note** | ---   You can power-on the device before or after onboarding it to Security Cloud Control. **We recommend that you onboard the device to Security Cloud Control first and power-on the device and connect it to your branch network second.** When you onboard the device in Security Cloud Control, the device is associated with your Security Cloud Control tenant in the Cisco cloud and Security Cloud Control automatically syncs the device configuration.   --- |
| --- | --- |

You can also use this procedure to onboard a device purchased from an external vendor or onboard
a device already managed by another cloud tenant in a different region. However, if the
device is already registered to the external vendor's cloud tenant or a cloud tenant in
a different region, Security Cloud Control doesn't onboard the device but displays the "*Device serial number already
claimed*" error message. In such cases, the Security Cloud Control admin must unregister the device's serial number from its previous cloud tenant and
then claim the Security Cloud Control device in their own tenant. See [Device Serial Number Already
Claimed](troubleshooting.html#Cisco_Reference.dita_f367a3ac-3ee6-4479-b548-67d3db7204bf__device-already-claimed) in the troubleshooting chapter.

The device **Connectivity** status changes to "Online" and the **Configuration** status changes to "Synced". The FDM-managed device is onboarded to Security Cloud Control.

You can see the Status LED (Firepower 1010), SYS LED (Firepower 2100), or S LED Secure Firewall 3100) flashing green on the rear panel of the hardware. The device LED continues to flash in green when it's connected to the
cloud. If the device can't connect to the Cisco cloud or loses its connectivity after being connected, you can see the Status
LED (Firepower 1010), SYS LED (Firepower 2100), or M LED (Secure Firewall 3100) flashing alternate green and amber.

See this video: [Installing Your Cisco Firepower Firewall Using Zero-Touch Provisioning](https://www.youtube.com/watch?v=1Bkg12rZa44) video to understand the LED indicators.

| **Important** | ---   If you have logged into the FDM-managed device console, SSH, or Secure Firewall Threat Defense, you would have changed the device's password during your first login. You can still use the zero-touch provisioning process for onboarding the device using Security Cloud Control. After you log into Secure Firewall Threat Defense, ensure that you do not complete the device setup wizard step that configures the outside interface. If you complete this step, the device is unregistered from the cloud, and you cannot use the zero-touch provisioning process.   --- |
| --- | --- |

When you log into Secure
Firewall Threat Defense, you will see the following screen on the dashboard.

![](/c/dam/en/us/td/i/400001-500000/450001-460000/453001-454000/453587.jpg)

Without proceeding further on the Secure
Firewall Threat Defense UI, go to the serial number onboarding wizard and onboard the device. Here, you must select **Default Password Changed** because the device password has already been changed.

###### Prerequisites

###### Software and Hardware Requirements

The FDM-managed devices must be running software that supports serial-number-onboarding. Use the
following table as a guide:

Table 1. Hardward and Software Support

| Firewall Model Numbers that Support Zero-Touch Provisioning | Supported Firewall Software Version | Software Package |
| --- | --- | --- |
| Firepower 1000 series device models: 1010, 1120, 1140, 1150 | 6.7 or later | SF-F1K-TDx.x-K9 |
| Firepower 2100 series device models: 2110, 2120, 2130, 2140 | 6.7 or later | SF-F2K-TDx.x-K9 |
| Secure Firewall 3100 series device models: 3110, 3120, 3130, 3140 | 7.1 or later | SF-F3K-TDx.x-K9 |

Confirm the management platforms are running the correct version.

Table 2. Support FTD Manager Versions

| Manager | Supported Version |
| --- | --- |
| Secure Firewall Device Manager | 7.0 or later |
| On-Premises Firewall Management Center | 7.2 or later |
| Cloud-delivered Firewall Management Center | Not applicable |

###### Configuration Prerequisites for Hardware Installation

* **The network at the branch office cannot use the 192.168.1.0/24 address space.** The network
  on Ethernet 1/1 (outside) cannot use the 192.168.1.0/24 address space. The
  default IP address of the Ethernet 1/2 "inside" interface on the 1000 and
  2100 series devices running FDM 6.7 is 192.168.1.1 may conflict with the
  DHCP address allocated by your WAN modem if it's on that subnet.

  + **inside** - Ethernet 1/2, IP address 192.168.1.1
  + **outside** - Ethernet 1/1, IP address from DHCP or an address you
    specify during setup

  ![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457559.jpg)

  If you are unable to change the outside interface settings, use Secure Firewall
  device manager to change the subnet on the Ethernet 1/2 "inside" interface settings to avoid conflict. For example, you could change to
  the following subnet settings:

  + IP Address: 192.168.95.1
  + DHCP server range: 192.168.95.5-192.168.95.254

  To learn about the steps for configuring the physical interface, see the "[Secure Firewall Device Manager Configuration Guide](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html)". In the "Interfaces" chapter, see the "Configure a Physical Interface" section.
* The threat defense device must be installed and connected to the Cisco Cloud.
* The outside or management interface of the device must be connected to a network providing DHCP addressing. Typically, the
  device has a default DHCP client on the outside or management interface.

  | **Note** | ---   If the management interface is connected to a network having a DHCP server, it takes precedence over the outside interface for Linux stack initiated traffic.   --- |
  | --- | --- |
* Your outside or management interface needs to access to be able to access the following Security Services
  Exchange domains for the serial onboarding method.

  + Australia Region

    - api.aus.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.aus.sse.itd.cisco.com (currently only
      mx01.aus.sse.itd.cisco.com)
    - dex.aus.sse.itd.cisco.com (for customer success)
    - eventing-ingest.aus.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.aus.sse.itd.cisco.com (allows for device
      registration to the regional Cisco cloud)
  + APJ Region

    - api.apj.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.apj.sse.itd.cisco.com (currently only
      mx01.apj.sse.itd.cisco.com)
    - dex.apj.sse.itd.cisco.com (for customer success)
    - eventing-ingest.apj.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - [http://registration.apj.sse.itd.cisco.com](http://registration.apj.sse.itd.cisco.com/)
      (allows for device registration to the regional Cisco
      cloud)
  + EU Region

    - api.eu.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.eu.sse.itd.cisco.com (currently only
      mx01.eu.sse.itd.cisco.com)
    - dex.eu.sse.itd.cisco.com (for customer success)
    - eventing-ingest.eu.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.eu.sse.itd.cisco.com (allows for device
      registration to the regional Cisco cloud)
  + India Region

    - api.in.sse.itd.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.in.sse.itd.cisco.com (currently only
      mx01.in.sse.itd.cisco.com)
    - dex.in.sse.itd.cisco.com (for customer success)
    - eventing-ingest.in.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.in.sse.itd.cisco.com (allows for device
      registration to the regional Cisco cloud)
  + US Region

    - api-sse.cisco.com
    - est.sco.cisco.com (common across geographies)
    - mx\*.sse.itd.cisco.com (currently only mx01.sse.itd.cisco.com)
    - dex.sse.itd.cisco.com (for customer success)
    - eventing-ingest.sse.itd.cisco.com (for CTR and Security Cloud Control)
    - registration.us.sse.itd.cisco.com (allows for device registration to the regional Cisco cloud)
* The outside interface of the device must have DNS access to Cisco Umbrella DNS.

###### Before Claiming the Device in Security Cloud Control

Before claiming the device in Security Cloud Control, make sure that you have the following information:

* Chassis serial number or PCA number of the threat defense device. You can find this information on the bottom of the hardware chassis or on the carton box in which your device is
  delivered. In the following example picture, you can see the serial number "\*\*\*\*\*\*\*X0R9" on the bottom of the Firepower 1010
  chassis.

  ![](/c/dam/en/us/td/i/400001-500000/450001-460000/457001-458000/457546.jpg)
* The default password of the device.
* A smart license generated from [Cisco Smart Software Manager](https://software.cisco.com/software/csws/ws/platform/home?locale=en_US&locale=en_US#SmartLicensing-Inventory) for using the additional capabilities. However, you can complete the device onboarding using a 90-day evaluation license
  and later apply the smart license.

* [Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning](#Onboarding_Procedure)

###### Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning

| **Caution** | ---   When the device is being onboarded in Security Cloud Control, we recommend that you not perform the device easy setup using the Secure Firewall device manager. This causes provisional error in Security Cloud Control.   --- |
| --- | --- |

###### Before you begin

* The threat defense device must not be prevously or currently managed by Firewall Device Manager or Management Center. If the device is currently managed by a
  platform, see [Onboard a Configured FDM-Managed Device using the Device's Serial Number](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number).
* If you onboard a device with the intention of managing it with an on-premises management center, the on-premises management center
  **must** be running version 7.4 and later.

###### Procedure

---

| **Step 1** | If you are onboarding a device purchased from an external vendor, you must reimage the device first. For more information, see the "Reimage Procedures" chapter of the [Cisco FXOS Troubleshooting Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/2100/troubleshoot_fxos/b_2100_CLI_Troubleshoot.html). |
| --- | --- |
| **Step 2** | Log in to Security Cloud Control. |
| **Step 3** | In the navigation pane, click Security Devices. |
| **Step 4** | Click the blue plus button  to **Onboard** a device. |
| **Step 5** | Click the **FTD** tile.   | **Important** | When you attempt to onboard a device, Security Cloud Control prompts you to read and accept the End User License Agreement (EULA), which is a one-time activity in your tenant. Once you accept this agreement, Security Cloud Control doesn't prompt it again in subsequent onboarding. If the EULA agreement changes in the future, you must accept it again when prompted. | | --- | --- | |
| **Step 6** | On the **Onboard FTD Device** screen, click **Use Serial Number**. |
| **Step 7** | In the **Select FMC** step, use the drop-down menu to select an on-premises management center that has already been onboarded to Security Cloud Control. Click **Next**.  The on-premises management center must be running version 7.4 or higher. If you do not have an on-premises management center onboarded, click +Onboard On-Prem FMC for the onboarding wizard. |
| **Step 8** | In the **Connection** step, enter the device's serial number and device name. Click **Next**. |
| **Step 9** | For zero-touch provisioning, the device must be brand new, or has been reimaged. For the **Password Reset**, be sure to select **Yes, this new device has never been logged into or configured for a manager**. Enter a new password and confirm the new password for the device, then click **Next**. |
| **Step 10** | For **Policy Assignment**, use the drop-down menu to select a access control policy to be deployed once the device is onboarded. If you do not have a customized policy, Security Cloud Control auto-selects the default access control policy. Click **Next**. |
| **Step 11** | Select all licenses you want to apply to the device. Click **Next**. |
| **Step 12** | (Optional) Add labels to the device. Security Cloud Control applies these labels once the device successfully onboards. |

---

###### What to do next

Security Cloud Control starts claiming the device, and you will see the **Claiming** message on the right. Security Cloud Control continuously polls for an hour to determine if the device is online and registered to the cloud. Once it's registered to
the cloud, Security Cloud Control starts the initial provisioning and onboards the device successfully. The device registration can be confirmed when the LED
status flashes green on the device. If the device can't connect to the Cisco cloud or lose its connectivity after being connected,
you can see the Status LED (Firepower 1000) or SYS LED (Firepower 2100) flashing alternate green and amber.

If the device is still not registered to the cloud within the first one hour, a time-out occurs, and now Security Cloud Control polls periodically for every 10 minutes to determine the device status and remain in **Claiming** state. When the device is turned on and connected to the cloud, you don't have to wait for 10 minutes to know its onboarding
status. You can click the **Check Status** link anytime to see the status. Security Cloud Control starts the initial provisioning and onboards the device successfully.

| **Important** | ---   Suppose you have already completed the device setup wizard (see [Onboard an Already Configured FDM-Managed Device](#Onboard_a_Configured_FTD_using_the_Devices_Serial_Number)), the device is unregistered from the cloud, and in this case, Security Cloud Control remains in **Claiming** state. You need to complete manual registration from Secure Firewall device manager to add it to Security Cloud Control. (In Secure Firewall device manager, go to **System Settings** > **Cloud Services** and select the **Auto-enroll with Tenancy from Cisco Security Cloud Control** option and click **Register**). Then, click **Check Status**.   --- |
| --- | --- |

##### Onboard a Configured FDM-Managed Device using the Device's Serial Number

This procedure is for devices that have already been configured for local management. Because the device setup wizard is completed
on an already configured FDM-managed device, the device is unregistered from the cloud, and you can't onboard such devices to Security Cloud Control using the zero-touch provisioning process.

If you device is brand new and has never been managed or configured, you can onboard the device with zero-touch provisioning. See [Onboard a Secure Firewall Threat Defense Device With Zero-Touch Provisioning](#Onboarding_Procedure) for more information.

| **Note** | ---   When the device is not connected to the Cisco cloud, you can see the Status LED (Firepower 1000), SYS LED (Firepower 2100), or M LED (Secure Firewall 3100) flashing alternate green and amber.   --- |
| --- | --- |

You may have completed the device setup wizard to perform the following tasks:

* The device must be running version 6.7 or later.
* Configure a static IP address on the management interface of the device. If
  the interfaces cannot obtain the necessary dynamic IP address, or the DHCP
  server does not provide the gateway route, you need to configure a static IP
  address.
* Obtain an address using PPPoE and configure the outside interface.
* Manage the device running version 6.7 or later device using Secure Firewall
  device manager or Secure Firewall Management Center.
* You have an active SecureX account. If you do not have a SecureX account, see [SecureX and Security Cloud Control](https://docs.defenseorchestrator.com/securex.html) for more information.
* Your Security Cloud Control and SecureX account are merged. See [Link Your Security Cloud Control and SecureX or Cisco XDR Tenant Accounts](https://admin.sse.itd.cisco.com/assets/static/online-help/index.html#!t_merge-your-cdo-and-securex-accounts.html) for more information.

| **Important** | ---   You can switch the manager of a Secure Firewall Threat Defense device from Secure Firewall device manager to Secure Firewall Management Center, or the other way. Perform the steps explained in the **Switching Between Local and Remote Management** section of the "System Management" chapter of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor854) for the version the device runs.   --- |
| --- | --- |

If you want to onboard devices, perform the following:

###### Procedure

---

| **Step 1** | Review the prerequisites for onboarding here [Procedure for Onboarding FDM-Managed Device using Device Serial Number](#Procedure_for_Onboarding_an_FTD_using_the_Devices_Serial_Number). |
| --- | --- |
| **Step 2** | In the Secure Firewall device manager UI, navigate to System Settings > Cloud Services and select the Auto-enroll with Tenancy from **Cisco Security Cloud Control**option and click Register. |
| **Step 3** | Log in to Security Cloud Control. |
| **Step 4** | In the navigation pane, click Security Devices. |
| **Step 5** | Click the **FTD tile.** |
| **Step 6** | On the **Onboard FTD Device** screen, click **Use Serial Number**. |
| **Step 7** | In the **Select FMC** step, use the drop-down menu to select an on-premises management center that has already been onboarded to Security Cloud Control. Click **Next**.  The on-premises management center must be running version 7.4 or higher. If you do not have an on-premises management center onboarded, click +Onboard On-Prem FMC for the onboarding wizard. |
| **Step 8** | In the **Connection** step, enter the device's serial number and device name. Click **Next**. |
| **Step 9** | If the device is **not** brand new and has already been configured for management, select **Yes, this new device has never been logged into or configured for a manager** for the **Password Reset**. Click **Next**. |
| **Step 10** | For **Policy Assignment**, use the drop-down menu to select a access control policy to be deployed once the device is onboarded. If you do not have a customized policy, Security Cloud Control auto-selects the default access control policy. Click **Next**. |
| **Step 11** | Select all licenses you want to apply to the device. Click **Next**. |

---

Security Cloud Control changes the device **Connectivity** status changes to "Online" and the
**Configuration** status changes to the "Synced" state. The FDM-managed device is onboarded to Security Cloud Control. You can see the Status LED (Firepower 1000), SYS LED (Firepower 2100), or M LED flashing green on the rear panel of the hardware. The device LED
continues to flash in green when it's connected to Cisco Cloud. If the device can't
connect to the Cisco cloud or loses its connectivity after being connected, you can
see the same status LED flash alternate green and amber.

**Related Information:**

* [Terminologies and Definitions](faq-and-support.html#Terminologies_and_Definitionsused_inLowTouch_Provisioning)

#### Onboard an FDM-Managed High Availability Pair

To onboard an Secure Firewall Threat
Defense HA pair to Security Cloud Control, you must onboard each device of the pair individually. Once both peers of the pair are onboarded Security Cloud Control automatically combines them as a single entry in the **Seurity Devices** page. Onboard the devices using either the device login credentials or a registration key. We recommend onboarding **both** devices with the same method. Also be aware that if you onboard a device that is in standby mode first, Security Cloud Control disables the ability to deploy or read from that device. You can only read or deploy to the active device within an HA pair.

| **Note** | ---   Security Cloud Control strongly recommends onboarding devices with a registration key. Onboarding with a registration key is slightly different for Threat Defense devices running specific versions. See [Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5](#Onboard_an_FTD_HA_Pair_Running_Version_64_or_Version_65) and [Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later](#Onboard_an_FTD_HA_Pair_Running_Version_66_or_Version_67_and_later) for more information.   --- |
| --- | --- |

Before you onboard an Threat Defense HA pair to Security Cloud Control, review the following:

* Your HA pair is already formed prior to onboarding to Security Cloud Control.
* Both devices are in a healthy state. The pair could be either primary/active and
  secondary/standby **or** primary/standby and secondary/active modes.
  Unhealthy devices will not successfully sync to Security Cloud Control.
* Your HA pair is managed by Secure Firewall
  device manager, not Secure Firewall Management Center.
* Your cloud connector connects to Security Cloud Control at <https://us.manage.security.cisco.com>.

* [Onboard an FDM-Managed High Availablity Pair with a Registration Key](#Before_You_Begin)
* [Onboard an FDM-Managed High Availability Pair](#Cisco_Task.dita_4b81ad97-372f-4a17-9312-64c8dc973b37)

##### Onboard an FDM-Managed High Availablity Pair with a Registration Key

Be aware of the following prerequisites before you onboard an FDM-managed High Availability (HA) pair with a registration key:

* Onboarding devices that are running version 6.4 with a registration key is only
  supported for the US region (<https://us.manage.security.cisco.com>). To connect to the EU region (<https://eu.manage.security.cisco.com>) they must onboard their HA pair with username, password, and IP address.
* Customers running version 6.5 or later, and connecting either to the US, EU, or
  APJ regions can use this method of onboarding.
* Devices running version 6.4 and 6.5 must not be registered with Cisco Smart
  Software Manager before onboarding them with a registration key. You will need
  to unregister the smart licenses of those FDM-managed devices before onboarding them to Security Cloud Control. See [Unregister a Smart-licensed FDM-Managed Device](#Unregistering_a_Smartlicensed_FTD) for more information.

* [Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5](#Onboard_an_FTD_HA_Pair_Running_Version_64_or_Version_65)
* [Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later](#Onboard_an_FTD_HA_Pair_Running_Version_66_or_Version_67_and_later)

###### Onboard an FDM-Managed HA Pair Running Version 6.4 or Version 6.5

To onboard an FDM-managed HA pair running software version 6.4 or 6.5, you must onboard the devices one at a time. It does not matter if you onboard
the active or standby, the primary or secondary device.

| **Note** | ---   If you onboard either device of an HA pair with a registration key, you must onboard the other peer device in the same method.   --- |
| --- | --- |

Use the following steps for onboard an HA pair running Version 6.4 or 6.5:

###### Procedure

---

| **Step 1** | Onboard a peer device. See [Procedure to Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboarding_Procedure) to onboard the first device within the pair. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the **Devices** tab to locate your device. |
| **Step 4** | Click the **FTD** tab. Once the device is synced, select the device so it is highlighted. In the action pane located directly below **Device Details**, click **Onboard Device**. |
| **Step 5** | Enter the **HA Peer Device Name** for the peer device that has already been onboarded. Click **Next**. |
| **Step 6** | If you provided a smart license for the first device, Security Cloud Control repopulates that license so you can use it for onboarding this current device. Click **Next**.   | **Note** | If you unregistered your device's Smart License to onboard your FDM-managed device, this is where you re-apply the smart license. | | --- | --- | |
| **Step 7** | Security Cloud Control automatically generates that registration key for the device you are preparing to onboarding. Click the Copy icon  to copy the registration key. |
| **Step 8** | Log into the Secure Firewall device manager UI of the device you are onboarding. |
| **Step 9** | In **System Settings**, click **Cloud Services**. |
| **Step 10** | In the Security Cloud Control tile, click **Get Started**. |
| **Step 11** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 12** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to.   | **Note** | This step is not applicable to the FDM-managed device running on version 6.4. | | --- | --- | |
| **Step 13** | Click **Register** and then **Accept** the Cisco Disclosure. |
| **Step 14** | Return to Security Cloud Control and, in the **Create Registration Key** area, click **Next**. |
| **Step 15** | Click **Go to Security Devices**. Security Cloud Control automatically onboards the device and combines them as a single entry. Similar to the first peer device you onboard, the device status changes from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

###### Onboard an FDM-Managed HA Pair Running Threat Defense Version 6.6 or Version 6.7 and later

To onboard an FDM-managed HA pair running threat defense version 6.6 or 6.7, you must onboard the device one at a time. It does not matter if you onboard
the active or standby, the primary or secondary device.

| **Note** | ---   If you onboard either device of an HA pair with a registration key, you must onboard the other peer device in the same method.  Use the following steps for onboard an HA pair running version 6.6 or 6.7:   --- |
| --- | --- |

###### Procedure

---

| **Step 1** | Onboard a peer device. See [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key) |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the **Devices** tab to locate your device. |
| **Step 4** | Click the **FTD** tab. Once the device is synced, select the device so it is highlighted. In the action pane located directly below **Device Details**, click **Onboard Device**. |
| **Step 5** | Enter the HA Peer Device Name for the peer device that has already been onboarded. Click **Next**. |
| **Step 6** | If you provided a smart license for the first device, Security Cloud Control repopulates that license so you can use it for onboarding this current device. Click **Next**. |
| **Step 7** | Security Cloud Control automatically generates that registration key for the device you are preparing to onboarding. Click the Copy icon  to copy the registration key. |
| **Step 8** | Log into the Secure Firewall device manager UI of the device you want to onboard to Security Cloud Control. |
| **Step 9** | Under **System Settings**, click **Cloud Services**. |
| **Step 10** | In the **Enrollment Type** area, click **Security/Security Cloud Control Account**.   | **Note** | For devices running version 6.6, note that the Tenancy tab for Security Cloud Control is titled **Security Account** and you must manually enable Security Cloud Control in the Secure Firewall device manager UI. | | --- | --- | |
| **Step 11** | In the **Region** field, select the Cisco cloud region that your tenant is assigned to. |
| **Step 12** | In the **Registration Key** field, paste the registration key that you generated in Security Cloud Control. |
| **Step 13** | For devices running version 6.7 or later in the Service Enrollment area, check **Enable Cisco Security Cloud Control**. |
| **Step 14** | Review the information about the Cisco Success Network Enrollment. If you do not want to participate, uncheck the **Enroll Cisco Success Network** check box. |
| **Step 15** | Click **Register** and then **Accept** the Cisco Disclosure. FDM sends the registration request to Security Cloud Control. |
| **Step 16** | Return to Security Cloud Control, in the **Create Registration Key** area, click **Next**. |
| **Step 17** | In the **Smart License** area, you can apply a smart license to the FDM-managed device and click **Next**or you can click **Skip** to continue the onboarding with a 90-day evaluation license or if the device is already smart-licensed. For more information, see [Updating an Existing Smart License of an FDM-Managed Device](#Updating_an_Existing_Smart_Licenseof_anFTDDevice).   | **Note** | If your device is running version 6.6, you need to manually enable communication to Security Cloud Control. From the device's FDM-managed UI, navigate to System Settings > Cloud Services and, in the **Cisco Security Cloud Control** tile, click **Enable**. | | --- | --- | |
| **Step 18** | Return to Security Cloud Control, click **Go to Security Devices**. Security Cloud Control automatically onboards the device and combines them as a single entry. Similar to the first peer device you onboard, the device status changes from "Unprovisioned" to "Locating" to "Syncing" to "Synced." |

---

##### Onboard an FDM-Managed High Availability Pair

| **Note** | ---   Whichever method you onboard the first device of an HA pair with, you must onboard the other peer device in the same method.   --- |
| --- | --- |

To onboard an FDM-managed HA pair that has been created outside of Security Cloud Control, follow this procedure:

###### Procedure

---

| **Step 1** | Onboard one of the peer devices within the HA pair. Onboard the device with its [username](#Onboarding_Procedure), [registration key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key), or [serial number](#Onboarding_Procedure). |
| --- | --- |
| **Step 2** | Once the device is synced, in the **Security Devices** page, click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the device. In the action pane located directly below **Device Details**, click **Onboard Device**. |
| **Step 5** | In the pop-up window, enter the HA peer's device name and location. |
| **Step 6** | Click **Onboard Device**. Once both devices are successfully synced to Security Cloud Control, the HA pair is displayed as a single entity in the **Security Devices** page. |

---

#### Onboard an FTD Cluster

* [Onboard a Clustered Secure Firewall Threat Defense Device](#onboard-a-ftd-cluster)

##### Onboard a Clustered Secure Firewall Threat Defense Device

Onboard a threat defense device that has already been clustered with the following procedure:

###### Before you begin

The following devices support clustering:

* Secure Firewall 3100 devices
* Firepower 4100 devices
* Firepower 9300 devices
* Threat Defense Virtual device (AWS, Azure, VMware, KVM, GCP)

Note the following limitations for clustered devices:

* Devices must be running at least version 6.4.
* Devices must be managed by a physical or virtual Secure Firewall Management
  Center.
* Firepower 4100 and Firepower 9300 devices must be clustered through the device's chassis manager.
* Secure Firewall 3100 devices, KVM, and VMware environments must be clustered through the Secure Firewall Management Center UI.
* Azure, AWS, and GCP environment clusters must be created through their own environment and onboarded to Secure Firewall Management
  Center.

###### Procedure

---

| **Step 1** | Log in to Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the blue plus button  to **Onboard** a device. |
| **Step 4** | Click **FTD**. |
| **Step 5** | Under **Management Mode**, be sure **FTD** is selected.  By selecting **FTD**, you are retaining Secure Firewall Management Center as the managing platform. If you select **FDM**, this switches the manager from Secure Firewall Management Center to a local manager such as the Firewall Device Manager or cloud-delivered Firewall Management Center. Note that Switching managers resets all existing policy configurations except for interface configurations and you must re-configure policies after you onboard the device. |
| **Step 6** | On the **Onboard FTD Device** screen, click **Use CLI Registration Key**. |
| **Step 7** | Enter the device name in the **Device Name** field. This could be the hostname of the device or any other name you choose. |
| **Step 8** | In the Policy Assignment step, use the drop-down menu to select an access control policy to deploy once the device is onboarded. If you have no policies configured, select the Default Access Control Policy. |
| **Step 9** | Specify whether the device you are onboarding is a physical or virtual device. If you are onboarding a virtual device, you must select the device's performance tier from the drop-down menu. |
| **Step 10** | Select the essentials licenses you want applied to the device. Click **Next**. |
| **Step 11** | Security Cloud Control generates a command with the registration key. Paste the entire registration key as is into the device's CLI. |
| **Step 12** | The device starts to onboard. As an optional step, you can add labels to your device to help sort and filter the **Security Devices** page. Enter a label and select the blue plus button. . |

---

###### What to do next

Once the device is sychronized, Security Cloud Control automatically detects that the device is clustered. From here, select the device you just onboarded from the **Security Devices** page and select any of the options listed under the Management pane located to the right. We strongly recommend the following
actions:

* If you did not already, create a custom access control policy to customize the security for your environment. See [FDM-Managed Access Control Policy](configuring-ftd-devices.html#FTD_Access_Control_Policy) for more information.
* Enable Cisco Security Analytics and Logging (SAL) to view events in the Security Cloud Control dashboard **or** register the device to an Secure Firewall Management Center for security analytics.

### Applying or Updating a Smart License

#### Applying a New Smart License to an FDM-Managed Device

Perform one of the following procedures to Smart License the FDM-managed device:

* Smart license an FDM-managed device when onboarding using a registration key.
* Smart license an FDM-managed device after onboarding the device using a registration key or the administrator's credentials.

| **Note** | ---   The FDM-managed device may be using a 90-day evaluation license, or the license could be unregistered.   --- |
| --- | --- |

* [Smart-License an FDM-Managed Device When Onboarding Using a Registration Key](#SmartLicense_an_FTDDevice_When_OnboardingUsing_a_Registration_Key)
* [Smart-License an FDM-Managed Device After Onboarding the Device Using a Registration Key or its Credentials](#SmartLicensean_FTDDevice_After_Onboarding_the_Device_Using_a_Registration_Key_or_its_Credentials)
* [Updating an Existing Smart License of an FDM-Managed Device](#Updating_an_Existing_Smart_Licenseof_anFTDDevice)
* [Change the Smart License Applied to an FDM-Managed Device Onboarded Using a Registration Key](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_a_Registration_Key)
* [Change the Smart License Applied to an FDM-Managed Device Onboarded Using its Credentials](#Changethe_Smart_License_Applied_to_an_FTDDevice_OnboardedUsing_its_Credentials)

#### Smart-License an FDM-Managed Device When Onboarding Using a Registration Key

##### Procedure

---

| **Step 1** | Log on to the [Cisco Smart Software Manager](https://software.cisco.com/software/csws/ws/platform/home?locale=en_US#SmartLicensing-Inventory) and generate a new Smart License key. Copy the newly generated key. You can watch the [Generate Smart Licensing](https://www.youtube.com/watch?v=8nSyUDEAJEE) video for more information. |
| --- | --- |
| **Step 2** | Begin onboarding an FDM-managed device using a registration key. For more information, see [Onboard an FDM-Managed Device Running Software Version 6.6+ Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key) or [Onboard an FDM-Managed Device Running Software Version 6.4 or 6.5 Using a Registration Key](#Onboard_an_FTD_Running_Software_Version_64_or_65_Using_a_Registration_Key). |
| **Step 3** | In step 4 of the onboarding wizard, in the **Smart License here** box, paste the Smart License in the **Activate** field and click **Next**. |
| **Step 4** | Click **Go to Security Devices**. |
| **Step 5** | Click the **FTD** tab and see the progress of the onboarding process. The device starts synchronizing and applies the Smart License.  You should see that the device is now in the **Online** connectivity state. If the device is not in the online connectivity state, look in the Device Actions pane on the right and click Manage Licenses > Refresh Licenses to update the connectivity state. |
| **Step 6** | After applying the Smart License successfully to the FDM-managed device, click the **Manage Licenses**. The device status shows "**Connected**, **Sufficient License**." You can enable or disable the optional licenses. For more information, see [FDM-managed Device Smart Licensing Types](#FTD_Licensing_Types). |

---

#### Smart-License an FDM-Managed Device After Onboarding the Device Using a Registration Key or its Credentials

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate the device. |
| **Step 3** | Click the **FTD** tab and select the device that you want to license. |
| **Step 4** | In the **Device Actions** pane on the right, click **Manage Licenses**. |
| **Step 5** | Follow the on-screen instructions and enter the Smart License generated from Cisco Smart Software Manager. |
| **Step 6** | Paste the new license key in the box and click **Register Device**. After synchronizing with the device, the connectivity state changes to 'Online'. After applying the Smart License successfully to the FDM-managed device, the device status shows "**Connected**, **Sufficient License**." You can enable or disable the optional licenses. For more information, see [FDM-managed Device Smart Licensing Types](#FTD_Licensing_Types). |

---

#### Updating an Existing Smart License of an FDM-Managed Device

You can apply a new Smart License to an FDM-managed device which is Smart Licensed. Based on the method you have selected for onboarding your device, select the appropriate
procedure:

#### Change the Smart License Applied to an FDM-Managed Device Onboarded Using a Registration Key

##### Procedure

---

| **Step 1** | Remove the corresponding FDM-managed device from Security Cloud Control. |
| --- | --- |
| **Step 2** | Log into the Secure Firewall device manager for that device and unregister the Smart License. For more information, see [Unregister a Smart-licensedFDM-Managed Device](#Unregistering_a_Smartlicensed_FTD). |
| **Step 3** | In Security Cloud Control, onboard the FDM-managed device again using a registration key. For more information, see [Onboard an FDM-Managed Device with a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key). |
| **Step 4** | Click the **Devices** tab to locate the device. |
| **Step 5** | Click the tab. |
| **Step 6** | Apply the new Smart License during the onboarding process or by looking in the **Device Actions** pane on the right and clicking**Manage Licenses**. |

---

#### Change the Smart License Applied to an FDM-Managed Device Onboarded Using its Credentials

##### Procedure

---

| **Step 1** | Log into the Secure Firewall device manager for that device and unregister the Smart License. For more information, see [Onboard an FDM-Managed Device with a Registration Key](#Onboard_an_FTD_Running_Software_Version_66_Using_a_Registration_Key). |
| --- | --- |
| **Step 2** | Apply the new Smart License to the FDM-managed device in Secure Firewall device manager.   1. In the **Smart License** area, click **View    Configuration**. 2. Click **Register Now** and follow the onscreen instructions. |
| **Step 3** | In the left pane, click Security Devices page in Security Cloud Control, and then click the Devices tab. |
| **Step 4** | Click the **FTD** device. Check the FDM-managed device configuration for changes so that Security Cloud Control can make a copy of the FDM-managed device's deployed configuration and save it to the Security Cloud Control database. For more information, see [Reading, Discarding, Checking for, and Deploying Configuration Changes](configuring-ftd-devices.html#Cisco_Concept.dita_054db023-dea3-4486-8405-89a940f08e1a). |

---

### Security Cloud Control Support for DHCP Addressing of FDM-Managed Devices

What happens if the IP address used by my FDM-managed device changes?

Security Cloud Control has many Adaptive Security Appliance (ASA) and FDM-managed device customers who have onboarded devices using the IP address provided by their service provider using DHCP.

If the IP address of the device for any reason, whether that is a change in the static IP address or a change in the IP address
due to DHCP, you can [change the IP address that Security Cloud Control uses to connect to the device](basics-of-cisco-defense-orchestrator.html#Changing_a_Devices_IP_Address_in_CDO) and then reconnect the device.

The field, expressed concerns regarding the case of branch deployed FDM-managed devices managed by Security Cloud Control, a static IP is required on the outside interface of the FDM-managed device, which, in the view of some SE's, precludes using Security Cloud Control as a management solution when the FDM-managed device has a DHCP address configured for the outside interface.

However, this situation does not impact customers that have VPN tunnels to remote branch firewalls, and we know that a vast
majority of customers have Site to Site tunnels from their Branch Offices back to their datacenters. In the case that Site-to
-Site VPN is used to connect to the central site from devices, DHCP on the outside interface is not a concern since Security Cloud Control (and any management platform) can connect to the FW via its inside, statically addressed, interface (if so configured). This
is a recommended practice and we have Security Cloud Control customers with many (+1000) devices using this deployment mode.

Also, the fact that an interface IP address is being issued via DHCP does not preclude the customer from managing the device
using that IP. Again, this is not optimal, but the experience of periodically having to potentially change the IP address
in Security Cloud Control has not been seen as a hurdle to customers. This situation is not exclusive to Security Cloud Control and happens with any manager using the outside interface including ASDM, FDM or SSH.

### FDM-Managed Device Licensing Types

#### Smart License Types

The following table explains the licenses available for FDM-managed devices.

Your purchase of an FDM-managed device automatically includes a base license. All additional licenses are
optional.

| License | Duration | Granted Capabilities |
| --- | --- | --- |
| License (automatically included) | Perpetual | All features not covered by the subscription term licenses.  You must also specify whether to Allow export-controlled functionality on the products registered with this token. You can select this option only if your country meets export-control standards. This option controls your use of advanced encryption and the features that require advanced encryption. |
|  | Term-based | **Intrusion detection and prevention**-Intrusion policies analyze network traffic for intrusions and exploits and, optionally, drop offending packets.  **File control**-File policies detect and, optionally, block users from uploading (sending) or downloading (receiving) files of specific types. AMP for Firepower, which requires a Malware license, allows you to inspect and block files that contain malware. You must have the license to use any type of File policy.  **Security Intelligence filtering**-Drop selected traffic before the traffic is subjected to analysis by access control rules. Dynamic feeds allow you to drop connections based on the latest intelligence immediately. |
| Malware | Term-based | File policies that check for malware, which use Cisco Advanced Malware Protection (AMP) with AMP for Firepower (network-based Advanced Malware Protection) and Cisco Threat Grid.  File policies can detect and block malware in files transmitted over your network. |
| URL License | Term-based | Category and reputation-based URL filtering.  You can perform URL filtering on individual URLs without this license. |
|  | Term-based or perpetual based on the license type | Remote access VPN configuration. Your essentials license must allow export-controlled functionality to configure RA VPN. You select whether you meet export requirements when you register the device.  Firepower Device Manager can use any valid AnyConnect license. The available features do not differ based on the license type. If you have not already purchased one, see Licensing Requirements for Remote Access VPN.  Also, see the Cisco AnyConnect Ordering Guide,  [http://www.cisco.com/c/dam/en/us/products/collateral/security/anyconnect-og.pdf](https://www.cisco.com/c/en/us/products/collateral/security/anyconnect-og.html). |

* [Virtual FDM-Managed Device Tiered Licenses](#Cisco_Concept.dita_c59521f9-9d6c-4838-9b34-f4de7a69dc07)
* [Viewing Smart-Licenses for a Device](#Viewing_SmartLicenses_for_a_Device)
* [Enabling or Disabling Optional Licenses](#Before_you_Begin)
* [Impact of Expired or Disabled Optional Licenses](#Impact_of_Expired_or_Disabled_Optional_Licenses)

#### Virtual FDM-Managed Device Tiered Licenses

Version 7.0 introduces support for performance-tiered Smart Licensing for virtual FDM-Managed devices based on throughput requirements and RA VPN session limits. When the virtual
FDM-Managed device is licensed with one of the available performance licenses, two things occur:
session limits for RA VPNs are determined by the installed virtual FDM-Managed device platform entitlement tier, and enforced via a rate limiter.

Security Cloud Control
****does not**** fully support tiered smart licensing at this time; see the
following limitations:

* You cannot modify the tiered license through Security Cloud Control. You must make the changes in the Secure Firewall
  device manager UI.
* If you register a virtual FDM-Managed device to be managed by the cloud-delivered Firewall
  Management Center, the tiered license selection automatically resets to **Variable**, which
  is the default tier.
* If you onboard a virtual FDM-Managed device running version 7.0 or later, and select a license that is **not** a default license during the onboarding process, the tiered license selection automatically resets to **Variable**, which is the default tier.

We strongly recommend selecting a tier for your virtual FDM-Managed device license after onboarding your device to avoid the issues listed above. See  [Managing Smart Licenses](https://www.cisco.com/c/en/us/td/docs/security/firepower/70/fdm/fptd-fdm-config-guide-700/fptd-fdm-license.html#id_12167) for more information.

#### Viewing Smart-Licenses for a Device

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select an FDM-managed device to view its current license status. |
| **Step 5** | In the **Device Actions** pane on the right, click Manage Licenses. The **Manage Licenses** screen provides the following information:   * **Smart License Agent status**: Shows whether you're using a   90-day evaluation license, or if you have registered with the Cisco   Smart Software Manager. The Smart License Agent status can be the   following:    + **"Connected," "Sufficient Licenses"** - The device has     contacted and registered successfully with the License     Authority, which has authorized the license entitlements for     the appliance. The device is now In-Compliance.   + **Out-of-Compliance** - There's no available license     entitlement for the device. Licensed features continue to     work. However, you can either purchase or free up extra     entitlements to become In-Compliance.   + **Authorization Expired** - The device hasn't communicated     with the Licensing Authority in 90 or more days. Licensed     features continue to work. In this state, the Smart License     Agent retries its authorization requests. If a retry     succeeds, the agent enters either an Out-of-Compliance or     Authorized state and begins a new Authorization Period. Try     manually synchronizing the device. * **License Registration**: Allows you to apply smart-license to an   already onboarded FDM-managed device. Once registered, you can see the status of the connection   to the Cisco Smart Software Manager and the status for each type of   license. * **License Status**: Shows the status of the optional licenses   available for your FDM-managed device. You can enable a license to use the   features controlled by the license. |

---

#### Enabling or Disabling Optional Licenses

You can enable (register) optional licenses on FDM-managed devices that are using a 90-day
evaluation license or a full license. You must enable a license to use the features
controlled by the license.

If you no longer want to use the features covered by an optional term license, you
can disable (release) the license. Disabling the license releases it in your Cisco
Smart Software Manager account so that you can apply it to another device.

In evaluation mode, you can also enable evaluation versions of the optional licenses
and perform all operations. In this mode, the licenses aren't registered with Cisco
Smart Software Manager until you register the device.

| **Note** | ---   You can't enable the license in evaluation mode.   --- |
| --- | --- |

##### Before you begin

Before disabling a license, ensure that you are not using it. Rewrite or delete any
policies that require the license.

For units operating in a high availability configuration, you enable or disable
licenses on the active unit only. The change is reflected in the standby unit the
next time you deploy the configuration when the standby unit requests (or frees) the
necessary licenses. When enabling licenses, you must ensure that your Cisco Smart
Software Manager account has sufficient licenses available, or you could have one
unit compliant while the other unit is non-compliant.

To enable or disable optional licenses, follow this procedure:

##### Procedure

---

| **Step 1** | In the Security Devices page, select the FDM-managed device that you want and click Manage Licenses in **Device Actions pane**, The **Manage Licenses** screen appears. |
| --- | --- |
| **Step 2** | Click the slider control for each optional license to enable or disable the license. The status of the license shows OK when enabled.   * **Enabled**: Registers the license with your Cisco Smart Software   Manager account and enable the controlled features. You can now   configure and deploy policies controlled by the license. * **Disabled**: Unregisters the license with your Cisco Smart   Software Manager account and disables the controlled features. You   cannot configure the features in new policies, nor can you deploy   policies that use the feature. |
| **Step 3** | Click **Save** to save the changes. |

---

#### Impact of Expired or Disabled Optional Licenses

If an optional license expires, you can continue using features that require the license. However, the license is marked out
of compliance, and you need to purchase the license and add it to your account to bring the license back into compliance.

If you disable an optional license, the system reacts as follows:

* **Malware license**: The system stops querying the AMP cloud and also stops acknowledging retrospective events sent from the AMP cloud. You cannot
  re-deploy existing access control policies if they include file policies that apply malware inspection. Note that for a very
  brief time after a Malware license is disabled, the system can use existing cached file dispositions. After the time window
  expires, the system assigns a disposition of Unavailable to those files.
* : The system no longer applies intrusion or file-control policies. For Security Intelligence policies, the system no longer
  applies the policy and stops downloading feed updates. You cannot re-deploy existing policies that require the license.
* **URL**: Access control rules with URL category conditions immediately stop filtering URLs, and the system no longer downloads updates
  to URL data. You cannot re-deploy existing access control policies if they include rules with category and reputation-based
  URL conditions.
* : You cannot edit the remote access VPN configuration, but you can remove it. Users can still connect using the RA VPN configuration.
  However, if you change the device registration so that the system is no longer export compliant, the remote access VPN configuration
  stops immediately, and no remote users can connect through the VPN.

### Create and Import an Firewall Device Manager Model

Security Cloud Control provides the ability to export the complete configuration of an FDM-managed device on a Security Cloud Control tenant to a JSON file format. You can then import this file to another tenant as an Firewall device manager model and apply it to a new device on that tenant. The feature is beneficial when you want to use an FDM-managed device's configuration on different tenants that you manage.

| **Note** | ---   If the FDM-managed device contains rulesets, the shared rules associated with the rulesets are modified as local rules when exporting the configuration. Later, when the model is imported to another tenant and applied to an FDM-managed device, you'll see the local rules in the device.   --- |
| --- | --- |

* [Export FDM-Managed Device Configuration](#Export_FTD_Configuration)
* [Import FDM-Managed Device Configuration](#Import_FTD_Configuration)

#### Export FDM-Managed Device Configuration

The export configuration functionality is unavailable if your FDM-managed device has the following configuration:

* High Availability
* Snort 3 enabled

##### Procedure

---

| **Step 1** | In the left pane, click **Security Devices**. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate the device or the **Templates** tab to locate the model device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select an FDM-managed device and in the **Device Actions** on the right pane, click **Export Configuration**. |

---

#### Import FDM-Managed Device Configuration

##### Procedure

---

| **Step 1** | In the **Security Devices** page, click the blue plus () button to import the configuration. |
| --- | --- |
| **Step 2** | Click **Import** to import configuration for offline management. |
| **Step 3** | Select the **Device Type** as **FTD**. |
| **Step 4** | Click **Browse** and select the configuration file (JSON format) to upload. |
| **Step 5** | Once the configuration is verified, you're prompted to label the device or service. See [Labels and Label Groups](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_f15e9db8-94d5-4516-9107-1af22df49154) for more information. |
| **Step 6** | After labeling your model device, you can view it in the **Security Devices** list.   | **Note** | Depending on the size of the configuration and the number of other devices or services, it may take some time for the configuration to be analyzed. | | --- | --- | |

---

## Delete a Device from Security Cloud Control

Use the following procedure to delete a device from Security Cloud Control:

### Procedure

---

| **Step 1** | Log into Security Cloud Control. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Locate the device you want to delete and check the device in the device row to select it. |
| **Step 4** | In the **Device Actions** panel located to the right, select Remove. |
| **Step 5** | When prompted, select OK to confirm the removal of the selected device. Select Cancel to keep the device onboarded.  Note that both devices in an FDM-managed HA pair must be deleted simultaenously. Click the FDM-managed HA pair name and not the individual peers. |

---

## Import Configuration for Offline Device Management

Importing a device's configuration for offline management allows you to review and optimize a device's configuration without
having to work on a live device in your network. Security Cloud Control also refers to these uploaded configuration files as "models."

You can import the configurations of these devices to Security Cloud Control:

* FDM-Managed Device. See [Create and Import an FDM-Managed Device Model](#Create_and_Import_an_FTD_Model).
* Cisco IOS devices like the Aggregation Services Routers (ASR) and Integrated Services Routers (ISRs).

## Backing Up FDM-Managed Devices

You can use Security Cloud Control to back up an FDM-managed device's system configuration so that you can restore the device to a previous state. Backups include the configuration only,
and not the system software. If you need to completely reimage the device, you need to reinstall the software, then you can
upload a backup and recover the configuration. Security Cloud Control saves the last 5 backups made for a device. When a new backup occurs, the oldest backup is deleted in order to store the
newest backup.

| **Note** | ---   The backup does not include the management IP address configuration. Thus, when you recover a backup file, the management address is not replaced from the backup copy. This ensures that any changes you made to the address are preserved, and also makes it possible to restore the configuration on a different device on a different network segment.   --- |
| --- | --- |

The configuration database is locked during backup. You cannot make configuration changes during a backup, although you can
view policies, dashboards, and so forth. During a restore, the system is completely unavailable.

To make backup schedules across your devices consistent, you can configure your own default
backup schedule. When you schedule a backup for a particular device, you can use your
own default settings or change them. You can schedule recurring backups with cadences
from daily to once a month and you can perform an on-demand backup. You can also
download backups and then use the Threat
Defense device manager to restore them.

**Requirements and best practice for backing up and restoring an FDM-managed device using Security Cloud Control**

* Security Cloud Control can backup FDM-managed devices running software version 6.5 and later.
* The FDM-managed device must be onboarded to Security Cloud Control using a registration key.
* You can restore a backup onto a replacement device only if the two devices are the same model and
  are running the same version of the software, including the build number, not
  just the same point release. For example, a backup of an FDM-managed device running software version 6.6.0-90 can only be restored to an FDM-managed device running 6.6.0-90. Do not use the backup and restore process to copy
  configurations between appliances. A backup file contains information that
  uniquely identifies an appliance, so that it cannot be shared in this
  manner.
* For the Secure Firewall Threat
  Defense backup functionality to work in Security Cloud Control, threat defense needs to access one of these Security Cloud Control URLs based on your tenant region.

  + edge.apj.cdo.cisco.com
  + edge.aus.cdo.cisco.com
  + edge.eu.cdo.cisco.com
  + edge.in.cdo.cisco.com
  + edge.us.cdo.cisco.com
* Ensure that port 443 has external and outbound access for the HTTPS protocol. If the port is blocked behind a firewall, the
  backup and restore process may fail.

**Best Practice**

The device you are going to backup should be in the Synced state in Security Cloud Control. Security Cloud Control backs up the configuration of the device *from the device* not from Security Cloud Control. So, if the device is in a Not Synced state, changes on Security Cloud Control will not be backed up. If the device is in a Conflict Detected state, those changes
will be backed up.

* [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
* [Configure a Recurring Backup Schedule for a Single FDM-Managed Device](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
* [Download the Device Backup](#Procedure)
* [Edit a Backup](#Edit_an_FTD_Backup)
* [Delete a Backup](#Delete_an_FTDBackup)
* [Managing Device Backup](#Managing_FTD_Backups)
* [Restore a Backup to an FDM-Managed Device](#Procedure)

**Related Information:**

* [Configure a Default Recurring Backup Schedule for all FDM-Managed Devices](basics-of-cisco-defense-orchestrator.html#Configure_a_Default_Recurring_Backup_Schedule)
* [Configure a Recurring Backup Schedule for a Single FDM-Managed Device](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
* [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
* [Download an FDM-Managed Device Backup](#Procedure)
* [Edit or Delete an FDM-Managed Device Backup](#Edit_an_FTD_Backup)
* [Restore a Backup to an FDM-Managed Device](#Procedure)

### Back up an FDM-Managed Device On-Demand

This procedure describes how to backup an FDM-managed device so that it can be restored if need be.

#### Before you Begin

Review these [requirements and best practices](#Backing_Up_FTDs) before you backup up an FDM-managed device.

* [Procedure](#Procedure)

#### Procedure

##### Procedure

---

| **Step 1** | (Optional) Create a [change request](monitoring-and-reporting.html#About_Change_Request_Management) for the backup. |
| --- | --- |
| **Step 2** | In the left pane, click Security Devices. |
| **Step 3** | Click the **Devices** tab. |
| **Step 4** | Click the **FTD** tab and select the device you want to backup. |
| **Step 5** | In the **Device Actions** pane on the right, click **Manage Backups**. |
| **Step 6** | Click **Backup Now**. The Device enters the Backing Up configuration state.  When the backup is done, the Security Cloud Control displays the device's configuration state it was in before the backup started. You can also open the change log page to look for a recent change log record with the description, "Backup completed successfully."  If you created a change request in step 1, you can also filter by that value to find the change log entry. |
| **Step 7** | If you created a change request in step 1, clear the change request value so you do not inadvertently associated more changes with the change request. |

---

### Configure a Recurring Backup Schedule for a Single FDM-Managed Device

#### Before you Begin

Review these [requirements and best practices](#Backing_Up_FTDs) before you backup up an FDM-managed device.

* [Procedure](#Procedure)

#### Procedure

##### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to backup. |
| **Step 4** | In the **Device Actions** pane on the right, click **Manage Backups**. |
| **Step 5** | In the **Device Backups** page, click **Set Recurring Backup** or click the schedule in the Recurring Backup field. Security Cloud Control presents the default backup schedule for all FDM-managed devices on your tenant. See [Configure a Default Recurring Backup Schedule for all FDM-Managed Devices](basics-of-cisco-defense-orchestrator.html#Configure_a_Default_Recurring_Backup_Schedule) for more information. |
| **Step 6** | Select the time of day, in 24-hour time, you want the backup to occur. Note that you schedule the time in Coordinated Universal Time (UTC) time. |
| **Step 7** | In the Frequency field, select daily, weekly, or monthly backup.   * Daily backups: Give the scheduled backup a name and a description. * Weekly backups: Check the days of the week on which you want the backup to occur. Give the scheduled backup time a name and   a description. * Monthly backups: Click in the Days of Month field and add whichever days of the month you want to the schedule the backup.   Note: If you enter day 31 but a month doesn't have 31 days in it, the backup will not take place. Give the scheduled backup   time a name and a description. |
| **Step 8** | Click **Save**. Notice that on the Device Backup page, the Recurring Backup field is replaced by the backup schedule you set and reflects your local time. |

---

### Download the Device Backup

This procedure describes how to download a .tar file containing a backup of an FDM-managed device.

#### Procedure

---

| **Step 1** | In the navigation bar, click**Inventory**. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and the device whose backup you want to download. |
| **Step 4** | In the Actions pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to download and, in its row, click the **Generate Download Link** button . The button changes to read, "Download Backup Image." |
| **Step 6** | The button now reads **Download Backup Image**. Do one of these things:   * If you are on a device that can also reach the Firewall device manager of the device you want to restore, click the**Download Backup Image** button and save the downloaded file. Save it with a name that you will remember. * If you are not on a device that can also reach the FDM of the device   you want to restore:    1. Right-click the **Download Backup Image** button and copy      the link address.             | **Important** | The link address expires 15 minutes after you click the Generate Download Link button. |      | --- | --- |   2. Open a browser on a device that will also reach the Firewall device manager of the Secure Firewall Threat      Defense you want to restore the image to.   3. Enter the download link into the browser address bar and      download the backup file to that device. Save it with a name      that you will remember. |

---

### Edit a Backup

This procedure allows you to edit the name or description of a successful FDM-managed device download.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to edit. |
| **Step 4** | In the Actions pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to edit and it's row, click the edit icon . |
| **Step 6** | Change the name or description of the backup. You can see the new information in the Device Backups page. |

---

### Delete a Backup

Security Cloud Control saves the last 5 backups made for a device. When a new backup occurs, the oldest backup is deleted in order to store the
newest backup. Deleting existing backups may help you manage which backups are kept and which are deleted.

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to delete. |
| **Step 4** | In the Actions pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to delete and it's row, click the trash icon . |
| **Step 6** | Click **OK** to confirm. |

---

### Managing Device Backup

Backups of FDM-managed devices you produce using Security Cloud Control can be seen in the Device Backups page:

#### Procedure

---

| **Step 1** | In the left pane, click **Security Devices**. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Click the filter icon and check FDM under Devices/Services to see only FDM-managed devices in the device table. |
| **Step 5** | Select the device you want. |
| **Step 6** | In the **Device Actions** pane, click **Manage Backups**. You will see up to 5 of the latest backups made of that device. |

---

#### What to do next

See [Restore a Backup to an FDM-Managed Device](#Procedure) if you want to restore a backup.

### Restore a Backup to an FDM-Managed Device

Review this information before you restore a backup of an FDM-managed managed threat defense device.

* Review these [requirements and best practices](#Backing_Up_FTDs) before you restore
  a backup to an FDM-managed
  threat defense device.
* If the backup copy you want to restore is not already on the device, you must
  **upload** the backup first before restoring it.
* During a restore, the system is completely unavailable. After the backup is
  restored, the device reboots.
* This procedure assumes that you have an existing backup of the device ready
  to be restored to the device.
* You cannot restore a backup if the device is part of a high availability
  pair. You must first break HA from the Device > High Availability page,
  then you can restore the backup. If the backup includes the HA
  configuration, the device will rejoin the HA group. Do not restore the same
  backup on both units, because they would then both go active. Instead,
  restore the backup on the unit you want to go active first, then restore the
  equivalent backup on the other unit.

| **Note** | ---   The backup does not include the management IP address configuration. Thus, when you recover a backup file, the management address is not replaced from the backup copy. This ensures that any changes you made to the address are preserved, and also makes it possible to restore the configuration on a different device on a different network segment.   --- |
| --- | --- |

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device you want to restore. |
| **Step 4** | In the **Device Actions** pane on the right, click **Manage Backups**. |
| **Step 5** | Select the backup you want to restore. In its row, click the **Generate Download Link** button .   | **Note** | The link address expires 15 minutes after you click the Generate Download Link button. | | --- | --- | |
| **Step 6** | The button now reads **Download Backup Image**. Do one of these things:   * If you are on a device that can also reach the Firewall device manager of the device you want to restore, click the **Download Backup Image**button and save the downloaded file. *Save it with a name that you will remember*. * If you are not on a device that can also reach the firewall device manager of the device you want to restore:    1. Right-click the **Download Backup Image** button and copy      the link address.   2. Open a browser on a device that will also reach the firewall device manager you want to restore the image to.   3. Enter the download link into the browser address bar and      download the backup file to that device. *Save it with a      name that you will remember*. |
| **Step 7** | Log on to Firewall device manager for the device you want to restore. |
| **Step 8** | Open version 6.5 or higher of the [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor932). Navigate to the System Management chapter, and search for **Restoring a Backup**. Follow those instructions to restore the image you just downloaded to your FDM-managed device.   | **Tip** | You will need to upload your image to firewall device manager in order to restore it. | | --- | --- | |
| **Step 9** | Follow the prompts in firewall device manager. When the restore starts, your browser is disconnected from firewall device manager. After the restore has finished, the device reboots. |

---

**Related Information:**

* [Backing Up FDM-Managed Devices](#Backing_Up_FTDs)
* [Back up an FDM-Managed Device On-Demand](#Back_up_an_FTD_OnDemand)
* [Create a Backup Schedule for an FTD](#Configure_a_Recurring_Backup_Schedule_for_a_Single_FTD)
* [Download an FTD Backup](#Procedure)
* [Edit or Delete an FTD Backup](#Edit_an_FTD_Backup)

## FDM Software Upgrade Paths

### Upgrading FDM Versions

If you use Security Cloud Control to upgrade your FDM-managed firewalls, Security Cloud Control determines which version you can upgrade to and you will not need this topic. If you maintain your own repository of FDM
images and upgrade your FDM-managed devices using your own images, this topic explains what upgrade paths are available to
you.

You can upgrade an FDM-managed device directly from one major or maintenance version
to another; for example, Version 6.4.0 > 6.5.0, or Version 6.4.0 > 7.0.1. You do not
need to be running any specific patch level.

If direct upgrade is not possible, your upgrade path must include intermediate
versions, such as Version 6.4.0 > 7.0.0 > 7.1.0.

Table 3. Upgrade Paths for Major Releases

| Target Version | Oldest Release you can Upgrade to the Target Version |
| --- | --- |
| 7.3.x | 7.0.0 |
| 7.2.x | 6.6.0 |
| 7.1.x | 6.5.0 |
| 7.0.x | 6.4.0 |
| 6.7.x | 6.4.0 |
| 6.6.x | 6.4.0 |
| 6.5.0 | 6.4.0 |

### Patching FDM-Managed Devices

You cannot upgrade directly from a patch of one version to a patch of another
version, such as from Version 6.4.0.1 > 6.5.0.1. You must upgrade to the major
release first, and then patch that release. For example you must upgrade from
Version 6.4.0.1 > 6.5.0 > 6.5.0.1.

### Firepower Hotfixes

Security Cloud Control does not support hotfix updates or installations. If there is a hotfix available for your device model or software version,
we strongly recommend using the configured manager's dashboard or UI. After a hotfix is installed on the device, Security Cloud Control detects out of band configuration changes.

### Removing FDM Upgrades

You cannot use Security Cloud Control to remove or downgrade any release type, whether major, maintenance, or patch.

Starting with Secure Firewall Threat
Defense defense Version 6.7.0, you can use Firepower Device Manager or the FTD CLI to
revert a successfully upgraded device to its state just before the last major or
maintenance upgrade (also called a snapshot). Reverting after patching necessarily
removes patches as well. After reverting, you must reapply any configuration changes
you made between **upgrading** and reverting. **Note that to revert a major or
maintenance upgrade to FDM Version 6.5.0 through 6.6.x, you must reimage.**
See the "System Management" section of a *[Cisco Firepower Threat Defense Configuration
Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html#anchor219)* for more information.

### Removing FDM Patches

You cannot remove an FDM patch with either Security Cloud Control or FDM. To remove a patch, you must reimage to a major or maintenance release.

### Snort Upgrade

Snort is the main inspection engine for the product and is packaged into the Secure Firewall Threat
Defense software for your convenience. Version 6.7 introduces an update to the package
that you can upgrade to, or revert from, at any time. Although you can switch Snort
versions freely, some intrusion rules in Snort 2.0 might not exist in Snort 3.0, and
vice versa. We strongly recommend reading about the differences in the Firepower
Device Manager Configuration Guide for Version 6.7.0 for more information.

To proceed with upgrading your FDM-managed device to use Snort 3 or to revert from Snort 3 back to Snort 2 from the Security Cloud Control UI, see [Upgrade to Snort 3.0](#Upgrade_to_Snort_3) and [Revert From Snort 3.0 for FTD](#Revert_From_Snort_3_for_FTD) respectively.

* [Other Upgrade Limitations](#Cisco_Task.dita_c9a8eb49-bab9-4b30-a756-0b39c58e83f1)
* [4100 and 9300 Series Devices](#Cisco_Concept.dita_d0145adc-cabf-45b1-9197-8e3f1f0b1cb3)

### Other Upgrade Limitations

**2100 Series Devices**

Security Cloud Control can upgrade Firepower 2100 series devices only if they are running appliance mode.

* Firepower Threat Defense devices are always in appliance mode.

#### What to do next

See the "[Cisco Firepower 2100 Getting Started Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/quick_start/fp2100/firepower-2100-gsg/asa-platform.html)" for a more detailed discussion of these commands.

### 4100 and 9300 Series Devices

Security Cloud Control does not support the upgrade for the 4100 or 9300 series devices. You must upgrade these devices outside of Security Cloud Control.

**Related Information:**

* [FTD Upgrade Prerequisites](#FTD_Upgrade_Prerequisites)
* [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
* [Bulk FTD Upgrade](#Bulk_FTD_Upgrade)
* [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)

## FDM-Managed Device Upgrade Prerequisites

Security Cloud Control provides a wizard that helps you upgrade the Firewall device manager (FDM) images installed on an individual device or an HA pair.

The wizard guides you through the process of choosing compatible images, installs them, and reboots the device to complete
the upgrade. We secure the upgrade process by validating that the images you chose on Security Cloud Control are the ones copied to, and installed on, your FDM-managed device. We strongly recommend the FDM-managed devices you are upgrading have outbound access to the internet.

If your FDM-managed device does not have outbound access to the internet, you can download the image you want from Cisco.com, store them in your
own repository, provide the upgrade wizard with a custom URL to those images, and Security Cloud Control performs upgrades using those images. In this case, however, you determine what images you want to upgrade to. Security Cloud Control does not perform the image integrity check or disk-space check.

### Configuration Prerequisites

* DNS needs to be enabled on the FDM-managed device. See the "Configuring DNS" section
  of the **System Administration** chapter of the [Cisco Firepower Threat Defense Configuration Guide for
  Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for the version your device is running
  for more information.
* The FDM-managed device should be able to reach the internet if you use upgrade images from Security Cloud Control's image repository.
* The FDM-managed device has been successfully onboarded to Security Cloud Control.
* The FDM-managed device is reachable.
* The FDM-managed device is synced.

  + If you update a device that has pending changes in Security Cloud Control and you do not accept changes, pending changes are lost after the upgrade completes. Best practice is to deploy any pending
    changes before you upgrade..
  + If you have staged changes in firewall device manager and the device is not synced, the upgrade in Security Cloud Control will fail at an eligibility check.

### 4100 and 9300 Series Running FTD

Security Cloud Control does not support the upgrade for the 4100 or 9300 series devices. You must upgrade these devices outside of Security Cloud Control.

### Software and Hardware Requirements

Security Cloud Control is a cloud management platform. Software updates are released over time and are generally not dependent on hardware. See
[Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) for information about supported hardware types.

Devices running firewall device manager software have a recommended upgrade path for optimal performance. See  [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path) for more information.

### Upgrade Notes

You cannot deploy changes to a device while it is upgrading.

**Related Information:**

* [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path)
* [Upgrade a Single FDM-Managed Device](#Upgrade_a_Single_FTD_Device)
* [Bulk FDM-Managed Devices Upgrade](#Bulk_FTD_Upgrade)
* [Upgrade an FDM-Managed High Availability Pair](#Upgrade_an_FTD_High_Availability_Pair)

## Upgrade a Single FDM-Managed Device

### Before You Begin

Be sure to read through the [FTD Upgrade Prerequisites](#FTD_Upgrade_Prerequisites),  [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path), and the [Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) before you upgrade. This document covers any requirements and warnings you should know prior to upgrading to your desired
version of Firepower software.

* [Upgrade A Single FDM-Managed Device with Images from Security Cloud Control's Repository](#Upgrade_A_Single_FTD_with_Images_from_CDOsRepository)
* [Upgrade a Single FDM-Managed Device with Images from your own Repository](#Upgrade_a_Single_FTD_with_Images_from_your_ownRepository)
* [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)

### Upgrade A Single FDM-Managed Device with Images from Security Cloud Control's Repository

Use the following procedure to upgrade a standalone FDM-managed device using a software image that is stored in Security Cloud Control's repository:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device.. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the device you want to upgrade. |
| **Step 5** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 6** | In step 1, click **Use Security Cloud Control Image Repository** to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://cloudsso.cisco.com/as/authorization.oauth2?response_type=code&client_id=wam_prod_ac&redirect_uri=https%3A%2F%2Fwww.cisco.com%2Fpa%2Foidc%2Fcb&state=eyJ6aXAiOiJERUYiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2Iiwia2lkIjoiYzQiLCJzdWZmaXgiOiJMUERhdDEuMTYxNjE2NzQxNCJ9..l02iaNyeE0vXUpbt9qksTQ.ii9UNzSAFqwQ5YtIBmJ55ZgSlzkSZDhWuTAjDtoY_MSrKaiWPDAf8OBZW1u7xufP64YGohK6fi_d6dEGnrf70t3rBUXm3wP3X11LRYVGpDaxkhcwFtX9AfBmEMqHwjdsugHW54X7DpNP-vZy_oM8rz0VF8rssu8FQtNJW0_IS55aMDG0ZlPbrcZTIwfXrVGIepM4I0RZ9kwr0F1qLy3q9w.UW9FT-3LBSTXQXM8uRgP4g&nonce=7vzbmdhY0id5wGxxH_pP9kaHpr4lJNSv_6b93hH_pz0&acr_values=stdnomfa&scope=openid%20profile%20address%20email%20phone&vnd_pi_requested_resource=https%3A%2F%2Fwww.cisco.com%2Fc%2Flogin%2Findex.html%3Freferer%3D%2Fc%2Fen%2Fus%2Fsupport%2Fsecurity%2Ffirepower-ngfw%2Fproducts-installation-and-configuration-guides-list.html&vnd_pi_application_name=CDCprod-www), Version 6.4in for more information. |

---

### Upgrade a Single FDM-Managed Device with Images from your own Repository

Use the following procedure to upgrade a standalone FDM-managed device using a URL protocol to locate a software image:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device.. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the device you want to upgrade. |
| **Step 5** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 6** | In step 1, click **Specify Image URL** to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click Perform Upgrade when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://cloudsso.cisco.com/as/authorization.oauth2?response_type=code&client_id=wam_prod_ac&redirect_uri=https%3A%2F%2Fwww.cisco.com%2Fpa%2Foidc%2Fcb&state=eyJ6aXAiOiJERUYiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2Iiwia2lkIjoiYzQiLCJzdWZmaXgiOiJMUERhdDEuMTYxNjE2NzQxNCJ9..l02iaNyeE0vXUpbt9qksTQ.ii9UNzSAFqwQ5YtIBmJ55ZgSlzkSZDhWuTAjDtoY_MSrKaiWPDAf8OBZW1u7xufP64YGohK6fi_d6dEGnrf70t3rBUXm3wP3X11LRYVGpDaxkhcwFtX9AfBmEMqHwjdsugHW54X7DpNP-vZy_oM8rz0VF8rssu8FQtNJW0_IS55aMDG0ZlPbrcZTIwfXrVGIepM4I0RZ9kwr0F1qLy3q9w.UW9FT-3LBSTXQXM8uRgP4g&nonce=7vzbmdhY0id5wGxxH_pP9kaHpr4lJNSv_6b93hH_pz0&acr_values=stdnomfa&scope=openid%20profile%20address%20email%20phone&vnd_pi_requested_resource=https%3A%2F%2Fwww.cisco.com%2Fc%2Flogin%2Findex.html%3Freferer%3D%2Fc%2Fen%2Fus%2Fsupport%2Fsecurity%2Ffirepower-ngfw%2Fproducts-installation-and-configuration-guides-list.html&vnd_pi_application_name=CDCprod-www), Version 6.4in for more information. |

---

### Monitor the Upgrade Process

You can view the progress of your single device by selecting that device on the **Security Devices** page and clicking the upgrade button. Security Cloud Control takes you to the Device Upgrade page for that device.

If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information   --- |
| --- | --- |

## Bulk FDM-Managed Devices Upgrade

### Before You Begin

Be sure to read through the [FDM-Managed Device Upgrade Prerequisites](#FTD_Upgrade_Prerequisites), [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path),and the [Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) before you upgrade. This document covers any requirements and warnings you should know prior to upgrading to your desired
version of Firepower software.

| **Note** | ---   You can only bulk upgrade FDM-managed devices if they are all upgrading to the same software version.   --- |
| --- | --- |

* [Upgrade Bulk FDM-Managed Devices with Images from Security Cloud Control's Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_CDOsRepository)
* [Upgrade Bulk FDM-Managed Devices with Images from your own Repository](#Upgrade_Bulk_FTD_Devices_with_Images_from_your_ownRepository)
* [Monitor the Bulk Upgrade Process](#Monitor_the_Bulk_Upgrade_Process)

### Upgrade Bulk FDM-Managed Devices with Images from Security Cloud Control's Repository

Use the following procedure to upgrade multiple FDM-managed devices using a software image that is stored in Security Cloud Control's repository:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your devices. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Use the [filter](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) to narrow down the list of devices you may want to include in your bulk upgrade. |
| **Step 5** | From the filtered list of devices, select the devices you want to upgrade. |
| **Step 6** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 7** | On the Bulk Device Upgrade page, the devices that can be upgraded are presented to you. If any of the devices you chose are not upgradable, Security Cloud Control gives you a link to view the not upgradable devices. |
| **Step 8** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 9** | In step 1, click **Use Security Cloud Control Image Repository** to select the software image you want to upgrade to. You are only presented with choices that are compatible with the devices you can upgrade. Click **Continue**. |
| **Step 10** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 11** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrades while in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrades after it has started, Security Cloud Control does not deploy or poll for changes from the devices. Devices do not roll back to the previous configuration after a canceled upgrade, either. This may cause the devices to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 12** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 13** | Upgrade the system databases. You must do this step in Firewall device manager. See **Updating System Databases** in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), for the version your device is running. |

---

### Upgrade Bulk FDM-Managed Devices with Images from your own Repository

Use the following procedure to upgrade multiple FDM-managed devices using a URL protocol to locate a software image:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your devices. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Use the [filter](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_d59762f2-66dc-4180-954e-532941193457) to narrow down the list of devices you may want to include in your bulk upgrade. |
| **Step 5** | From the filtered list of devices, select the devices you want to upgrade. |
| **Step 6** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 7** | On the Bulk Device Upgrade page, the devices that can be upgraded are presented to you. If any of the devices you chose are not upgradable, Security Cloud Control gives you a link to view the not upgradable devices. |
| **Step 8** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 9** | In step 1, click **Specify Image URL** to select the software image you want to upgrade to, and click **Continue**. |
| **Step 10** | In step 2, confirm your choices and decide whether you only want to download the images to your devices or copy the images, install them, and reboot the device. |
| **Step 11** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrades while in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrades after it has started, Security Cloud Control does not deploy or poll for changes from the devices and the devices do not roll back to the previous configuration. This may cause the devices to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 12** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the  [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 13** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), Version 6.4in for more information. |

---

### Monitor the Bulk Upgrade Process

You can view the progress of a single device that was included in the bulk upgrade by selecting that device on the **Security Devices** page and clicking the upgrade button. You can also view the progress details by clicking **Jobs** in the left pane and expanding the bulk operation.

If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.

## Upgrade an FDM-Managed High Availability Pair

Upgrade your HA pair without disrupting traffic; the standby device continues to handle traffic detection while the secondary
device is upgraded.

When you upgrade an HA pair, Security Cloud Control executes an eligibility check and copies or identifies the image location before starting the upgrade. The secondary device
in a high availability pair upgrades first, even if it is currently the active device; if the secondary device is the Security Cloud Control active device, the paired devices automatically switch roles for the upgrade process. Once the secondary devices successfully
upgrade, the devices switch roles, then the new standby device upgrades. When the upgrade completes, the devices are automatically
configured so the primary device is active and the secondary device is standby.

We do not recommend deploying to the HA pair during the upgrade process.

### Before You Begin

* Deploy all pending changes to the active device before upgrading.
* Ensure there are no tasks running during the upgrade.
* Both devices in the HA pair are healthy.
* Confirm you are ready to upgrade; you cannot rollback to a previous version in Security Cloud Control.
* Read through the [FTD Upgrade Prerequisites](#FTD_Upgrade_Prerequisites),  [Firepower Software Upgrade Path](#Firepower_Software_Upgrade_Path), and the [Software and Hardware Supported by Security Cloud Control](basics-of-cisco-defense-orchestrator.html#Cisco_Concept.dita_fcdb591c-14a0-410f-b917-81e0b9d0ad34) to review any requirements and warnings that may incur during the ugprade process.

* [Upgrade an FDM-Managed HA Pair with Images from Security Cloud Control's Repository](#Upgrade_an_FTD_HAPair_with_Images_from_CDOsRepository)
* [Upgrade an FDM-Managed HA Pair with Images from your own Repository](#Upgrade_an_FTD_HAPair_with_Images_from_your_ownRepository)
* [Monitor the Upgrade Process](#Monitor_the_Upgrade_Process)

### Upgrade an FDM-Managed HA Pair with Images from Security Cloud Control's Repository

Use the following procedure to upgrade an FDM-managed HA pair using a software image that is stored in Security Cloud Control's repository:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the Devices tab to locate your device. |
| **Step 3** | Click the FTD tab. |
| **Step 4** | Select the HA pair you want to upgrade. |
| **Step 5** | In the Device Actions pane, click Upgrade. |
| **Step 6** | In step 1, click Use **Security Cloud Control** Image Repository to select the software image you want to upgrade to, and click Continue. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click Perform Upgrade when you are ready. From the Security Devices page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click Abort Upgrade from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or poll changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in FDM. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), Version 6.4 in for more information. |

---

### Upgrade an FDM-Managed HA Pair with Images from your own Repository

Use the following procedure to upgrade an FDM-managed HA pair using a URL protocol to locate a software image:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab to locate your device. |
| **Step 3** | Click the **FTD** tab. |
| **Step 4** | Select the HA pair you want to upgrade. |
| **Step 5** | In the **Device Actions** pane, click **Upgrade**. |
| **Step 6** | In step 1, click **Specify Image URL** to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 7** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 8** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or poll changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |
| **Step 9** | Alternatively, if you want Security Cloud Control to perform the upgrade later, select the Schedule Upgrade check box. Click the field to select a date and time in the future. When you are done, click the Schedule Upgrade button. |
| **Step 10** | Look at the [notifications tab](monitoring-and-reporting.html#Jobs_Page__notificationtab) for the progress of the bulk upgrade action. If you want more information about how the actions in the bulk upgrade job succeeded or failed, click the blue Review link and you will be directed to the [Jobs page](monitoring-and-reporting.html#Jobs_Page "This topic describes how the Jobs page in Security Cloud Control informs you of the status of various bulk operations that are being processed by Security Cloud Control."). |
| **Step 11** | Upgrade the system databases. You must do this step in Firewall device manager. See "Updating System Databases" in [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html), Version 6.4 for more information. |

---

### Monitor the Upgrade Process

You can view the progress of your single device by selecting that device on the **Security Devices** page and clicking the upgrade button. Security Cloud Control takes you to the **Device Upgrade** page for that device.

During the upgrade, the system suspends HA while updating system libraries, which includes an automatic deployment, and may
not be in a healthy state for the entirety of the upgrade process. This is expected. The device is available for SSH connections
during the last part of this process, so if you log in shortly after applying an upgrade, you might see HA in suspended status.
If the system experiences issues during the upgrade process and the HA pair appears to be suspended, manually resume HA from
the Firewall device manager console of the active device.

| **Note** | ---   If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.   --- |
| --- | --- |

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information.   --- |
| --- | --- |

## Upgrade to Snort 3.0

Snort 3 is the latest snort engine, or a powerful preprocessor that uses Open Source
Intrusion Prevention System (IPS), available for Firepower Version 6.7 and later. The
snort engine uses a series of rules that help define malicious network activity and uses
those rules to find packets that match against them and generates alerts for users and
is ideally used as a packet sniffer, a packet logger, or, more traditionally, as a a
standalone network IPS.

With Snort 3, you can now create custom intrusion policies; every FDM-managed device running Snort 3 has a set of intrusion policies that are pre-defined from Cisco's Talos Intelligence Group (Talos).
Snort 3 makes it possible to change these default policies, although we strongly recommend building on top of the base for
a more robust policy.

You cannot create custom policies with Snort 2.

### Switching from Snort 2 to Snort 3

You can switch Snort versions freely, though some intrusion rules in Snort 2.0 might
not exist in Snort 3.0, and vice versa. If you changed the rule action for an
existing rule, that change is not preserved if you switch to Snort 3 and then back
to Snort 2, or back again to Snort 3. Your changes to rule actions for rules that
exist in both versions are preserved. Note that the mapping between rules in Snort 3
and Snort 2 can be one-to-one or one-to-many, so preservation of changes is done on
a best-effort basis.

If you choose to upgrade from Snort 2 to Snort 3, please note that upgrading the
snort engines is comparable to a system upgrade. We strongly recommend upgrading
during a maintenance window to minimize the interruption in traffic monitoring for
your network. See [Managing Intrusion Policies
(Snort3)](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/fdm/fptd-fdm-config-guide-670/fptd-fdm-intrusion.html#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055)in the *Firepower Device Manager Configuration
Guide* as to how switching snort versions will affect how rules process
traffic.

| **Tip** | ---   You can filter by Snort version on the **Security Devices** page, and the Details window of a selected device displays the current version running on the device.   --- |
| --- | --- |

### Snort 3 Limitations

**License Requirements**

To allow the snort engine to process traffic for intrusion and malware analysis, you must have the  **license** enabled for the FDM-managed device. To enable this license through Firewall device manager, log into the Firewall device manager UI and navigate to Device  > View Configuration >  Enable/Disable and enable the license.

**Hardware Support**

The following devices support Snort 3:

* FTD 1000 series
* FTD 2100 series
* FTD 4100 series
* FTD virutal with AWS
* FTD virtual with Azure
* ASA 5500-X Series with FTD

**Software Support**

Devices **must** be running at least Firewall device manager Version 6.7. Security Cloud Control supports Snort 3 functionality for devices running Version 6.7 and later.

For FTD 1000 and 2000 series, see [FXOS bundled support](https://www.cisco.com/c/en/us/td/docs/security/firepower/compatibility/firepower-compatibility.html#id_67425) for more information
on FXOS patch support.

**Configuration Limitations**

Security Cloud Control does not support upgrading to Snort 3 if your device has the following configurations:

* Device is not running at least Version 6.7.
* If a device has pending changes. Deploy any changes prior to upgrading.
* If a device is currently upgrading. Do not attempt to upgrade or deploy to
  the device until the device is synced.
* If a device is configured with a virtual router.

| **Note** | ---   If you upgrade or revert the Snort version, the system automatically deploys to implement the changes between Snort 2 intrusion policies and Snort 3 intrusion policies.   --- |
| --- | --- |

**Rulesets and Snort 3**

Note that Snort 3 does not have full feature support at this time. Security Cloud Control rulesets are not supported on Snort 3 devices. If you simultaneously upgrade a device to Firewall device manager 6.7 or higher, and from Snort 2 to Snort 3, any rulesets configured prior to the upgrade are broken up and the rules in them
are saved as individual rules.

For a full list of ruleset support in regards to devices configured for Snort 3, see
[Rulesets](configuring-ftd-devices.html#FTD_Rulesets).

* [Upgrade the Device and the Intrusion Prevention Engine Simultaneously](#Upgrade_the_Device_and_the_Intrusion_Prevention_EngineSimultaneously)
* [Upgrade the Intrusion Prevention Engine](#Upgrade_the_Intrusion_Prevention_Engine)
* [Monitor the Upgrade Process](#Cisco_Concept.dita_734b576c-42ad-4612-ae33-5fbefcdbc912)

### Upgrade the Device and the Intrusion Prevention Engine Simultaneously

Security Cloud Control allows you to upgrade the device to Version 6.7 and the Snort 3. Use the following procedure to upgrade the FDM-managed device:

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device or devices you want to upgrade. |
| **Step 4** | In the **Devices Actions** pane located to the right, click **Upgrade**. |
| **Step 5** | Set the upgrade toggle to **FTD System Upgrade**. |
| **Step 6** | (Optional) If you want Security Cloud Control to perform the upgrade later, check the **Schedule Upgrade** check box. Click in the field to select a date and time in the future. |
| **Step 7** | In step 1, select your upgrade method. Either use the Security Cloud Control Image Repository and an image from your own repository:   * **Use Security Cloud Control Image Repository** - Click this option to select the software image you want to upgrade to, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. * **Specify Image URL** - Click this option to select the software image that is currently stored in your own repository, and click **Continue**. You are only presented with choices that are compatible with the device you can upgrade. |
| **Step 8** | In step 2, confirm your choices and decide whether you only want to download the images to your device or copy the images, install them, and reboot the device. |
| **Step 9** | Check **Upgrade to Snort 3 Engine**. |
| **Step 10** | Click **Perform Upgrade** when you are ready. From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status.   | **Warning** | If you decide to cancel the upgrade while it is in progress, click **Abort Upgrade** from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC. | | --- | --- | |

---

### Upgrade the Intrusion Prevention Engine

For devices that are already running Version 6.7 with Snort 2, use the following procedure to update just the Snort engine
to version 3:

#### Procedure

---

| **Step 1** | In the navigation bar, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the device or devices you want to upgrade. |
| **Step 4** | In the **Device Actions** pane located to the right, click **Upgrade**. |
| **Step 5** | Set the upgrade toggle to **Intrusion Prevention Engine**. |
| **Step 6** | Click **Upgrade to Snort Engine 3.0**. |
| **Step 7** | From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status. |

---

### Monitor the Upgrade Process

| **Warning** | ---   If you decide to cancel the upgrade while it is in progress, click Abort Upgrade from the Upgrade page. If you cancel the upgrade after it has started, Security Cloud Control does not deploy or check for changes from the device and the device does not roll back to the previous configuration. This may cause the device to enter an unhealthy state. If you experience any issues during the upgrade process, contact Cisco TAC.   --- |
| --- | --- |

You can view the progress of your single device by selecting that device on the **Security Devices** page and clicking the upgrade button. Security Cloud Control takes you to the **Device Upgrade**  page for that device.

If the upgrade fails at any point, Security Cloud Control displays a message. Security Cloud Control does not automatically restart the upgrade process.

| **Warning** | ---   Upgrading devices that have self-signed certificates may experience issues; see [New Certificate Detected](troubleshooting.html#Troubleshoot_New_Certificate_Issues__Newcertificatedetected) for more information   --- |
| --- | --- |

## Revert From Snort 3.0 for FDM-Managed Device

Some intrusion rules in Snort 2.0 might not exist in Snort 3.0. If you
downgrade to 2.0, any custom intrusion policies that you created are converted to the
base policy used in the custom policy. As far as possible, rule action overrides are
retained. If more than one custom policy uses the same base policy, the overrides of the
custom policy that is used in the most access control policies are retained, and the
overrides for the other custom policies are lost. Access control rules that used
these"duplicate"policies will now use the base policy created from your most-used custom
policy. All custom policies are deleted.

Before you opt to revert from Snort 3.0, read [Managing Intrusion Policies (Snort2)](https://www.cisco.com/c/en/us/td/docs/security/firepower/670/fdm/fptd-fdm-config-guide-670/fptd-fdm-intrusion.html#Cisco_Task_in_List_GUI.dita_9a2ed29f-0ef8-47bf-ac36-2f183fd2b055) of the *Firepower Device Manager Configuration Guide* and find out how switching snort engine versions will affect your current rules and policies.

| **Note** | ---   Reverting to version 2 does not uninstall the Firepower software version.   --- |
| --- | --- |

* [Revert From Snort 3.0](#Revert_From_Snort_3)

### Revert From Snort 3.0

If you change the Snort version,the system will perform an automatic deployment to implement the change. Note that you can
only revert individual devices from Snort 3.0 to version 2.

Use the following procedure to revert the intrusion prevention engine:

#### Procedure

---

| **Step 1** | In the navigation pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and and click the device you want to revert. |
| **Step 4** | In the **Device Actions** pane located to the right, click **Upgrade**. |
| **Step 5** | Set the upgrade toggle to **Intrusion Prevention Engine**. |
| **Step 6** | In Step 1, confirm you want to revert from Snort version 3, and click **Revert to Snort Engine 2**. |
| **Step 7** | From the **Security Devices** page, devices that are upgrading have a "Upgrade in Progress" configuration status. |

---

## Schedule a Security Database Update

Use the following procedure to create a scheduled task to check and update the security databases for an FDM-managed device:

### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the desired FDM-managed device. |
| **Step 4** | In the Actions pane, locate the **Security Database Updates** section and click the add + button.   | **Note** | If there is an existing scheduled task for the selected device, click the edit icon to create a new task. Creating a new task will overwrite the existing one. | | --- | --- | |
| **Step 5** | Configure the scheduled task with the following:   * **Frequency** - Choose for the update to occur daily, weekly, or   monthly. * **Time** - Choose the time of day. Note that the time displayed is   UTC. * **Select Days** - Choose which day(s) of the week you want the   update to occur. |
| **Step 6** | Click **Save**. |
| **Step 7** | The device's Configuration Status will change to "Updating Databases". |

---

* [Edit a Scheduled Security Database Update](#Edit_a_Scheduled_Security_Database_Update)

### Edit a Scheduled Security Database Update

Use the following procedure to edit an existing scheduled task to check and update the security databases for an FDM-managed device

#### Procedure

---

| **Step 1** | In the left pane, click Security Devices. |
| --- | --- |
| **Step 2** | Click the **Devices** tab. |
| **Step 3** | Click the **FTD** tab and select the desired FDM-managed device. |
| **Step 4** | In the Actions pane, locate the **Database Updates** section and click the edit icon. |
| **Step 5** | Edit the scheduled task with the following:   * **Frequency** - Choose for the update to occur daily, weekly, or   monthly. * **Time** - Choose the time of day. Note that the time displayed is   UTC. * **Select Days** - Choose which day(s) of the week you want the   update to occur. |
| **Step 6** | Click **Save**. |
| **Step 7** | The device's Configuration Status will change to "Updating Databases". |

---

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from sec.cloudapps.cisco.com_0602071d_20250115_120521.html ===


[Home](https://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x)
# Security Vulnerability Policy

Security Vulnerability Policy - Cisco

If you are experiencing a security vulnerability emergency, see the [Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv) section of this document.

---

### Contents

[Purpose](#purpose)

[Policy](#policy)

[Cisco Product Security Incident Response](#cpsir)

[Reporting or Obtaining Support for a Suspected Security Vulnerability](#roosfassv)

[General Security-Related Queries](#gsrq)

[Receiving Security Vulnerability Information from Cisco](#rsvifc)

[Cisco.com](#cc)

[Email](#email)

[RSS Feeds](#rss)

[Cisco PSIRT openVuln API](#openVuln_API)

[My Notifications](#cns)
[Creating a Notification](#pfsuc)

[Public Relations or Press Queries Regarding Cisco Security Vulnerability Information](#pr)

[Commitment to Product Security and Integrity at Cisco](#psi)

[Cisco Product Security Incident Response Process](#cpsirp)

[Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery](#dsvdpcsd)

[Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr)

[Cisco Cloud-Hosted Services](#cloud)

[Third-Party Software Vulnerabilities](#3psv)

[Cisco Vulnerability Repository](#cvr)

[Vulnerability Exploitability eXchange](#vex)
[Types of Security Publications](#tosp)

[Cisco Security Advisories](#sa)

[Cisco Event Responses](#cer)

[Release Note Enclosures](#rne)
[Communications Plan](#cp)

[Disclosure Schedule](#ds)

[Cisco NX-OS Software](#cis)

[Cisco IOS XR Software](#cis)

[Cisco IOS and IOS XE Software](#cis)

[All Other Products](#aop)

[Exceptions](#exceptions)
 [Incident Response Eligibility](#ire)

[Security Software Updates](#ssu)

[Security Advisory Terms and Conventions](#terms)

[Cisco Bug Bounty Programs](#bug_bounties)

---

## Purpose

This policy was created to guide and inform Cisco customers in the event of a reported vulnerability in a Cisco product or cloud-hosted service. It ensures that Cisco customers have a consistent, unambiguous resource to help them understand how Cisco responds to events of this nature.

## Policy

This policy clearly states how Cisco addresses reported security vulnerabilities in Cisco products and cloud-hosted services, including the timeline, actions, and responsibilities that apply to all customers.

## Cisco Product Security Incident Response

The Cisco Product Security Incident Response Team (PSIRT) is responsible for responding to Cisco product security incidents. The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of information about security vulnerabilities and issues related to Cisco products and services. Cisco defines a security vulnerability as a weakness in the computational logic (e.g., code) found in software and hardware components that, when exploited, results in a negative impact to confidentiality, integrity, or availability. Cisco reserves the right to deviate from this definition based on specific circumstances. The Cisco PSIRT adheres to ISO/IEC 29147:2018, which are [guidelines for disclosure of potential vulnerabilities](https://www.iso.org/standard/72311.html) established by the International Organization for Standardization.

The on-call Cisco PSIRT works 24 hours a day with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security vulnerabilities and issues with Cisco products and networks.

## Reporting or Obtaining Support for a Suspected Security Vulnerability

Individuals or organizations that are experiencing a product security issue are strongly encouraged to contact the Cisco PSIRT. Cisco welcomes reports from independent researchers, industry organizations, vendors, customers, and other sources concerned with product or network security. At minimum, a description of the potential vulnerability is needed to report a security issue.

To contact the Cisco PSIRT, use one of the following methods:

*Primary approach:* The most effective method for reaching the Cisco PSIRT is sending an email to psirt@cisco.com. In the email, provide a detailed problem description and any relevant details and logs.

Alternatively, the Cisco PSIRT may be contacted using the following phone numbers:

* +1 877 228 7302 (toll-free within North America)
* +1 408 525 6532 (international direct dial)

These contact numbers route to Cisco global customer support. To facilitate engagement, please explain that this is a product security issue or, alternatively, reference the PSIRT-SVP-001 search code.

Cisco encourages customers to encrypt sensitive information that is sent to Cisco by email. The Cisco PSIRT supports encrypted messages via Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software. The Cisco PSIRT public key is available at the following link: <https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc>.

**Note:** Cisco supports an RFC 9116-compliant security.txt file, located at <https://www.cisco.com/.well-known/security.txt>.

## General Security-Related Queries

For general security concerns about Cisco products and cloud-hosted services, the Cisco Technical Assistance Center (TAC) can provide configuration and technical assistance. The Cisco TAC can also help with nonsensitive security incidents and software upgrades for security bug fixes. To contact the Cisco TAC, use one of the following methods:

|  | **Cisco TAC Support** |
| --- | --- |
| **Phone** | +1 800 553 2447 (toll-free within North America)+1 408 526 7209 (international direct dial) Additional TAC numbers: [Customer Service Contacts](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html) |
| **Web** | <https://mycase.cloudapps.cisco.com/start> |
| **Hours** | 24 hours a day, 7 days a week |

## Receiving Security Vulnerability Information from Cisco

There are several ways to stay connected and receive the latest security vulnerability information from Cisco. Customers should review the following table, and subsequent summaries, to determine the appropriate option for them:

| **Cisco.com** | <https://www.cisco.com/security/> |
| --- | --- |
| **Email** | cust-security-announce@cisco.com |
| **RSS** | <https://sec.cloudapps.cisco.com/security/center/rss.x?i=44> |
| **Cisco PSIRT openVuln API** | [https://developer.cisco.com/site/PSIRT/](https://developer.cisco.com/site/PSIRT) |
| **My Notifications** | <https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html> |

### **Cisco.com**

The [Cisco Security portal](https://www.cisco.com/security) on Cisco.com provides Cisco security vulnerability documents and Cisco security information, including relevant security products and services.

For direct links to specific security functions, see the [Types of Security Publications](#tosp) section of this
document.

### **Email**

Cisco Security Advisories provide information about Critical-, High-, and Medium-severity security vulnerabilities. They are clear signed with the Cisco PSIRT [PGP public key](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/files/Cisco_PSIRT_PGP_Public_Key.asc) and distributed to the external cust-security-announce@cisco.com mailing list. The Cisco PSIRT may also send Informational advisories to the cust-security-announce mailing list. Informational advisories are used not as a disclosure mechanism for any Cisco vulnerabilities but for sharing information on security incidents that may impact Cisco products and that may be of interest to Cisco customers.

Emails are sent for the initial release of and major revisions to Cisco Security Advisories. A major revision is defined as a significant change to advisory content that could result in the customer addressing the vulnerability differently. Examples of a major advisory change include, but are not limited to, changes to the affected products list, changes in Security Impact Rating (SIR; see the [Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating](#asr) section of this document), and changes in mitigation and/or fix information. If a document undergoes a minor revision, the update will be posted to Cisco.com without an accompanying email. Customers that require automated alerts for minor revisions should subscribe to the Cisco Security Advisory Really Simple Syndication (RSS) feed or My Notifications. All Security Advisories on Cisco.com are displayed in chronological order, with the most recent advisories and updates appearing at the top of the page.

To subscribe to the cust-security-announce mailing list, email cust-security-announce-join@cisco.com. (The content of the message does not matter.) You will receive confirmation, instructions, and a list policy statement.

Please note that requests must be sent to cust-security-announce-join@cisco.com and not to the cust-security-announce@cisco.com list itself.

To unsubscribe from the cust-security-announce mailing list, email cust-security-announce-leave@cisco.com with the word "unsubscribe" in the subject line. (The content of the message does not matter.) You will receive a confirmation notice, to which you need to reply to be unsubscribed. You will not be unsubscribed unless you reply to the confirmation email.

Please note that requests to subscribe must be sent to cust-security-announce-join@cisco.com, and requests to unsubscribe must be sent to cust-security-announce-leave@cisco.com—not to the cust-security-announce@cisco.com email address itself.

You must send the messages from the account that you want to be subscribed to or unsubscribed from the list.

Customers can also request to be subscribed or unsubscribed to the cust-security-announce mailing list by emailing psirt@cisco.com.

### **RSS Feeds**

Cisco security vulnerability information is also available via RSS feeds from Cisco.com. These feeds are free and do not require an active Cisco.com registration. For information on how to subscribe to the RSS feeds, visit the [Cisco Security RSS Feeds page](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44).

### **Cisco PSIRT openVuln API**

The Cisco PSIRT openVuln application programming interface (API) is a RESTful API that conforms to the [representational state transfer](https://restfulapi.net/) (REST) software architectural style and allows customers to obtain Cisco security vulnerability information in different machine-consumable formats. To learn about accessing and using the API, visit the [PSIRT page](https://developer.cisco.com/site/PSIRT) on the Cisco DevNet website.

### **My Notifications**

The [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) allows registered Cisco.com users to subscribe to and receive important Cisco product and technology information, including Cisco Security Advisories. This service provides an improved unified subscription experience, allowing users to choose the timing of notifications as well as the notification delivery method (email or RSS feed). The level of access will be determined by the subscriber's relationship with Cisco.

### Creating a Notification

To create a notification, use the following steps:

1. Log in to the [My Notifications website](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) on Cisco.com using a registered Cisco.com account name and password.
2. Click the **Add Notification** button and follow the instructions.

## Public Relations or Press Queries Regarding Cisco Security Vulnerability Information

The following table shows the Cisco press contacts for Cisco security vulnerability information.

|  | **Press Contacts** |
| --- | --- |
| **Michael Ricketts** | Email: micricke@cisco.comPhone: +1 919 392 2756 |
| **Additional Public Relations** | media\_pr@cisco.com |

## Commitment to Product Security and Integrity at Cisco

Cisco product development practices specifically prohibit any intentional behaviors or product features that are designed to allow unauthorized device or network access, exposure of sensitive device information, or a bypass of security features or restrictions. These include, but are not limited to:

* Undisclosed device access methods or "back doors"
* Hardcoded or undocumented account credentials
* Covert communication channels
* Undocumented traffic diversion

Cisco considers such product behaviors to be serious vulnerabilities. Cisco will address any issues of this nature with the highest priority and encourages all parties to report suspected vulnerabilities to the Cisco PSIRT for immediate investigation. Internal and external reports of these vulnerabilities will be managed and disclosed in accordance with the terms of the Cisco Security Vulnerability Policy.

More information can be found on the [Cisco Secure Development Lifecycle (CSDL) website](https://www.cisco.com/c/en/us/about/trust-center/technology-built-in-security.html#~stickynav=2).

## Cisco Product Security Incident Response Process

Figure 1 illustrates the vulnerability life cycle and the Cisco PSIRT disclosure and resolution process at a high level.

**Figure 1.** Cisco Product Security Incident Response Process

![response process cycle from awareness to feedback](https://cscrdr.cloudapps.cisco.com/cscrdr/security/center/public/files/images/white_papers/psirtprocess.jpg "Cisco Product Security Incident Response Process")

The steps in the process illustrated in Figure 1 are as follows:

1. **Awareness:** PSIRT receives notification of a security incident.
2. **Active Management:** PSIRT prioritizes and identifies resources.
3. **Software Fixes:** PSIRT coordinates the fix and impact assessment.
4. **Customer Notification:** PSIRT notifies all customers simultaneously.

The Cisco PSIRT investigates all reports regardless of the Cisco software code version or product life cycle status until the product reaches the [Last Day of Support](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (LDoS). Issues will be prioritized based on the potential severity of the vulnerability and other environmental factors. Ultimately, the resolution of a reported incident may require upgrades to products and cloud-hosted services that are under active support from Cisco. As a best practice, Cisco strongly recommends that customers periodically verify that their products are under active support for access to the latest software updates and other benefits.

Throughout the investigative process, the Cisco PSIRT strives to work collaboratively with the source of the report (incident reporter) to confirm the nature of the vulnerability, gather required technical information, and ascertain appropriate remedial action. When the initial investigation is complete, results will be delivered to the incident reporter along with a plan for resolution and public disclosure. If the incident reporter disagrees with the conclusion, the Cisco PSIRT will make every effort to address those concerns.

In the case of incidents about which an agreement cannot be reached through the normal process, incident reporters may escalate by contacting the [Cisco TAC](#gsrq) and requesting the director of the global Cisco PSIRT team.

During any investigation, the Cisco PSIRT manages all sensitive information on a highly confidential basis. Internal distribution is limited to those individuals who have a legitimate need to know and can actively assist in the resolution. Similarly, the Cisco PSIRT asks incident reporters to maintain strict confidentiality until complete resolutions are available for customers and have been published by the Cisco PSIRT on the Cisco website through the appropriate coordinated disclosure.

With the agreement of the incident reporter, the Cisco PSIRT may acknowledge the reporter's contribution during the public disclosure of the vulnerability.

The Cisco PSIRT works with third-party coordination centers such as the [Computer Emergency Response Team Coordination Center](https://www.kb.cert.org/vuls/) (CERT/CC), [Computer Emergency Response Team of Finland](https://www.kyberturvallisuuskeskus.fi/en/) (CERT-FI), [Japan Computer Emergency Response Team](https://www.jpcert.or.jp/english/) (JP-CERT), and [National Protective Security Authority](https://www.npsa.gov.uk) (NPSA) to manage a coordinated industry disclosure for vulnerabilities reported to Cisco that may impact multiple vendors (for example, a generic protocol issue). In these situations, the Cisco PSIRT will either assist the incident reporter with contacting the coordination center or do so on the incident reporters behalf.

If a reported vulnerability involves a vendor product, the Cisco PSIRT will notify the vendor directly, coordinate with the incident reporter, or engage a third-party coordination center.

The Cisco PSIRT will coordinate with the incident reporter to determine the frequency of status updates on the incident and documentation updates.

In the event that Cisco becomes aware of a vulnerability that does not affect a Cisco product but does involve another vendor's product, Cisco will follow the Cisco [policy for reporting vulnerabilities to vendors](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html).

## Disclosure of Security Vulnerabilities Discovered as Part of Cisco Services Delivery

If a new or previously undisclosed security vulnerability is found during a Cisco Services engagement with a customer, Cisco will follow the [Cisco Product Security Incident Response Process](#cpsirp). Vulnerabilities found in Cisco products and cloud-hosted services will be handled by the Cisco PSIRT according to the [Cisco Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). If the vulnerability is in another vendors product, Cisco will follow the [Cisco Vendor Vulnerability Reporting and Disclosure Policy](https://sec.cloudapps.cisco.com/security/center/resources/vendor_vulnerability_policy.html) unless the affected customer wishes to report the vulnerability to the vendor directly; in that case, Cisco will facilitate contact between the customer and the vendor, and will notify CERT/CC (or its national equivalent).

Cisco will protect customer-specific data at all times throughout this process. Specifically, Cisco will not share any customer-specific data unless directed to do so by the affected customer, or as required by a legal investigation.

### **Assessing Security Risk—Common Vulnerability Scoring System and the Security Impact Rating**

Cisco uses [Version 3.1](https://www.first.org/cvss/v3-1/) of the [Common Vulnerability Scoring System](https://www.first.org/cvss/) (CVSS) as part of its standard process of evaluating reported potential vulnerabilities that do not have a CVE in Cisco products and cloud-hosted services. The CVSS model uses three distinct measurements, or scores, that include Base, Temporal, and Environmental calculations. Cisco will provide an evaluation of the Base vulnerability score and, in some instances, the Temporal vulnerability score. End users are encouraged to compute the Environmental score based on their network parameters. The combination of all three scores should be considered the final score, which represents a moment in time and is tailored to a specific environment. Organizations are advised to use this final score to prioritize responses in their own environments.

**Note:** Cisco began transitioning to CVSS Version 3.1 (CVSSv3.1) in May 2020.

In addition to CVSS scores, Cisco uses the Security Impact Rating (SIR) as a way to categorize vulnerability severity in a simpler manner. The SIR is based on the CVSS Qualitative Severity Rating Scale of the Base score, may be adjusted by PSIRT to account for Cisco-specific variables, and is included in every Cisco Security Advisory. Cisco uses the following guidelines to determine the Cisco Security Advisory type for vulnerabilities in Cisco-authored, customer-managed software. Security Advisories for Critical, High, and Medium SIRs include fixed software information.

| **Publication** | **Type** | **CVSS** | **CVE** | **Fix Information** | **Machine-Readable Format** |
| --- | --- | --- | --- | --- | --- |
| Cisco Security Advisory | Critical | 9.0–10.0 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD), and Firepower Management Center (FMC) Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| High | 7.0–8.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Medium | 4.0–6.9 | Yes | Fix information in the Security Advisory and bug. Detailed fix information for Cisco IOS, IOS XE, NX-OS, ASA, FTD, and FMC Software can be obtained using the Cisco Software Checker. | [RSS, CSAF](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |
| Informational | N/A | No | Fix information in bug (if applicable). | [RSS](https://sec.cloudapps.cisco.com/security/center/rss.x?i=44) |

Issues with a Low SIR are typically published as a bug Release Note Enclosure (RNE) and not as a Security Advisory.

Cisco reserves the right to deviate from these guidelines in specific cases if additional factors are not properly captured in the CVSS score.

If there is a security issue with a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the third party. In some cases, Cisco may adjust the CVSS score to reflect the impact to the Cisco product.

**Note:** Cisco is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/index.html) (CVE) Numbering Authority and will assign CVE IDs to Cisco software vulnerabilities from the MITRE block of IDs assigned to the company for this purpose. Cisco does not assign CVE IDs for reported vulnerabilities until the vulnerabilities have been confirmed by Cisco. After vulnerabilities are published, Cisco provides CVE details to MITRE for inclusion in its database.

For more information about CVSS, visit [FIRST.org](https://www.first.org/cvss/).
### **Cisco Cloud-Hosted Services**

Cisco offers multiple cloud-hosted services that are used by customers but are maintained, patched, and monitored by Cisco.

The Cisco PSIRT responds to vulnerabilities in Cisco cloud-hosted services and works closely with the teams that operate them. These teams ensure that security vulnerabilities are fixed and patches are deployed to all customer instances in a timely manner.

Typically, service-related security events are communicated to customers by the service teams through direct notification or through the service dashboard or portal. In some instances, Cisco may disclose vulnerabilities through Security Advisories for Cisco cloud-hosted services in coordination with the service teams.

In most cases, no user action is required because Cisco regularly patches cloud-hosted services.

### **Third-Party Software Vulnerabilities**

If there is a vulnerability in a third-party software component that is used in a Cisco product, Cisco typically uses the CVSS score provided by the component creator. Cisco may adjust the CVSS score to reflect the impact to Cisco products.

Cisco will consider a third-party vulnerability “high profile” if it meets the following criteria:

* The vulnerability exists in a third-party component.
* Multiple Cisco products and/or cloud-hosted services are affected.
* The CVSS score is 5.0 or above.
* The vulnerability has gathered significant public attention.
* The vulnerability is likely to have exploits available and is expected to be, or is being, actively exploited.

For high profile, third-party vulnerabilities, Cisco will begin assessing all potentially impacted products and cloud-hosted services that have not reached the LDoS and publish a Security Advisory within 24 hours after Cisco classifies the vulnerability as high profile. All known affected Cisco products and cloud-hosted services will be detailed in an update to the initial Security Advisory that will be published within 7 days of the initial disclosure. A Cisco bug will be created for each vulnerable product so that registered customers can view them using the Cisco Bug Search Toolkit. Third-party vulnerabilities that are not classified as high profile will be disclosed in a Release Note Enclosure.

### **Cisco Vulnerability Repository**

The [Cisco Vulnerability Repository](https://sec.cloudapps.cisco.com/security/center/cvr) (CVR) is a vulnerability search engine for CVEs reported after 2017 that may impact Cisco products. CVR can help customers understand if their Cisco product is affected by a particular third-party software vulnerability. This tool also displays any Cisco Security Advisories associated with a CVE. At this time, CVR does not include Cisco cloud offers. For help with a product not listed in this tool, please use the Feedback link on the [CVR page](https://sec.cloudapps.cisco.com/security/center/cvr) or contact your support organization.

### **Vulnerability Exploitability eXchange**

Customers may request a Vulnerability Exploitability eXchange (VEX) document for any CVE in CVR.

### **Types of Security Publications**

In all security publications, Cisco discloses the information required for an end user to assess the impact of a vulnerability and any potential steps needed to protect their environment. Cisco does not provide vulnerability details that could enable someone to craft an exploit. Cisco Security Advisories are point-in-time documents. Information should only be considered up to date as of the time and date of the last publication update as indicated by the "Last Updated" field in the advisory header.

Cisco provides the following types of security-related publications via the [Cisco Security portal](https://www.cisco.com/security) on Cisco.com.

### Cisco Security Advisories

[Cisco Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x) provide detailed information about security issues that directly involve Cisco products and cloud-hosted services and require an upgrade, fix, or other customer action. Security Advisories are used to disclose vulnerabilities in Cisco-authored software or in high-profile third-party software with a Critical, High, or Medium SIR. The Cisco PSIRT only validates the affected and fixed version information documented in the advisory.

All Cisco Security Advisories that disclose vulnerabilities with a Critical, High, or Medium SIR include an option to download [Common Security Advisory Framework (CSAF)](https://csaf.io/) content. CSAF is an industry standard designed to depict vulnerability information in machine-readable format. This machine-readable content can be used with other tools to automate the process of interpreting data contained in a Security Advisory. CSAF content can be downloaded directly from each Security Advisory. For more information about CSAF, see the preceding link.

The Informational type of Cisco Security Advisories addresses issues that require a response to information discussed in a public forum, such as a blog or discussion list. Informational advisories are normally published if a third party makes a public statement about a Cisco product vulnerability. Informational advisories may also be used to proactively notify customers about a security-related issue that is not a vulnerability.

### Cisco Event Responses

Cisco [Event Responses](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52) provide information about security events that have the potential for widespread impact on customer networks, applications, and devices. Cisco Event Responses contain summary information, threat analysis, and mitigation techniques that feature Cisco products and cloud-hosted services. They are normally published under the following circumstances:

* If a significant security vulnerability exists in a vendor's product that could affect a Cisco product due to interoperation with the vendor's product or use of the network as a vector for exploitation
* In response to the release of Cisco IOS and IOS XE, Cisco IOS XR, Cisco NX-OS, and Cisco ASA, FTD, and FMC Software bundled publications

### Release Note Enclosures

Release Note Enclosures are used to disclose issues with a Low SIR and most third-party software vulnerabilities. All Cisco bug IDs that are disclosed by Cisco are available for registered customers to view in the [Cisco Bug Search Tool](https://tools.cisco.com/bugsearch/).

If a Cisco Security Advisory references a bug, the bug entry in the Cisco Bug Search Tool will link to the relevant Cisco Security Advisory.

Any Cisco bug that has been evaluated by the Cisco PSIRT includes a "PSIRT Evaluation" section in its Release Note Enclosure. This section includes, where Cisco deems appropriate and relevant, Base and Temporal CVSS scores and a CVE ID. Customers are invited to use this additional information at their discretion and correlate Cisco bugs with industry events. This information is not intended to supplement any standard Cisco warranties applicable to the software as stated in the [Cisco End User License Agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html).

Free software updates will not be provided for issues that are disclosed through a Release Note Enclosure. Customers who wish to upgrade to a software version that includes fixes for those issues should contact their normal support channels. Any exception to this policy will be determined solely at the discretion of Cisco.

The following table summarizes the methods used to notify customers about the aforementioned security publications. Exceptions may be made on a case-by-case basis to increase communication for a given document.

| **Publication** | **Email** | **Security Portal** | **RSS** | **CNS** | **openVuln API** | **Bug Search Tool** |
| --- | --- | --- | --- | --- | --- | --- |
| **Cisco Security Advisory—Critical and High Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Medium Severity** | Yes | Yes | Yes | Yes | Yes | Yes |
| **Cisco Security Advisory—Informational** | Yes | Yes | Yes | No | No | Yes |
| **Cisco Event Response** | No | Yes | Yes | No | No | No |
| **Release Note Enclosure** | No | No | No | No | No | Yes |

### **Communications Plan**

If one or more of the following conditions exist, Cisco will publicly disclose Cisco Security Advisories:

* The Cisco PSIRT has completed the incident response process and determined that enough software patches or workarounds exist to address the vulnerability, or subsequent public disclosure of code fixes is planned to address high-severity vulnerabilities.
* The Cisco PSIRT has observed active exploitation of a vulnerability that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* There is the potential for increased public awareness of a vulnerability affecting Cisco products and/or cloud-hosted services that could lead to increased risk for Cisco customers. Cisco will accelerate the publication of a security announcement describing the vulnerability that may or may not include a complete set of patches or workarounds.
* The Cisco PSIRT has declared a third-party software vulnerability to be "high profile."

All Cisco security publications are disclosed to customers and the public simultaneously.

When coordinating disclosure with third parties, the Cisco PSIRT will attempt to provide notification of any changes to the Cisco PSIRT public disclosure schedule.

As documented in the [Receiving Security Vulnerability Information from Cisco](#rsvifc) section of this document, Cisco delivers technical security information about software fixes in Cisco products and distributes product updates through several channels. Cisco reserves the right to deviate from this policy on an exception basis to ensure access to Cisco.com for software patch availability.

### **Disclosure Schedule**

In direct response to customer feedback, Cisco releases the following bundles of Cisco Security Advisories at 1600 Greenwich Mean Time (GMT) on a regular schedule twice each year. This schedule applies to the disclosure of vulnerabilities in the following Cisco products and does not apply to the disclosure of vulnerabilities in other Cisco products.

| **Cisco Product(s)** | **Release Schedule** |
| --- | --- |
| Cisco NX-OS Software | Fourth Wednesday of February and August |
| Cisco IOS XR Software | Second Wednesday in March and September |
| Cisco IOS and IOS XE Software | Fourth Wednesday in March and September |

### All Other Products

Cisco generally discloses Cisco Security Advisories at 1600 GMT on any given Wednesday.

### Exceptions

Cisco reserves the right to publish an individual Security Advisory for Cisco IOS and IOS XE Software, Cisco IOS XR Software, or Cisco NX-OS Software or other products outside the published schedule. Conditions under which an out-of-cycle publication may occur include, but are not limited to, the following:

* Cisco detects heightened public awareness of a serious vulnerability.
* Cisco learns of active exploitation of a vulnerability.
* Cisco works with a third-party coordination center to publicly disclose a vulnerability.

### **Incident Response Eligibility**

All customers, regardless of contract status, are eligible to receive support from the Cisco TAC for a known or reasonably suspected security vulnerability in Cisco products and services. For more information about how to contact the Cisco TAC, see the [General Security-Related Queries](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq) section of this document. Customers who contact the Cisco TAC should reference the URL of the Cisco security publication to assist in connecting with the proper support team.

Customers with paid service contracts for incident response and forensic assistance should request assistance through the contact methods specified in their contract.

Cisco, at its sole discretion, may offer customers additional security services free of charge. Cisco reserves the right to determine the type and degree of free assistance it may offer in connection with any incident and to withdraw from such an incident at any time.

### **Security Software Updates**

The Cisco PSIRT will investigate and disclose vulnerabilities in Cisco products and services from the date of First Commercial Shipment (FCS) to the [LDoS](https://www.cisco.com/c/en/us/products/eos-eol-policy.html). Cisco customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels, generally from the Cisco website for the relevant product. Cisco recommends contacting the Cisco TAC only with specific and imminent problems or questions.

As a special customer service, and to improve the overall security of the internet, Cisco may offer customers free software updates to address high-severity security problems. The decision to provide free software updates is made on a case-by-case basis. Refer to the Cisco security publication for details. Free software updates will typically be limited to Critical- and High-severity vulnerabilities.

Fixes for some third-party software vulnerabilities may be available only in the most recent major software releases and not backported to older releases.

If Cisco has offered a free software update to address a specific issue, noncontract customers who are eligible for the update may obtain it by contacting the Cisco TAC using any of the methods described in the [General Security-Related Queries](#gsrq) section of this document.

**Note:** To verify their entitlement, individuals who contact the Cisco TAC should have available the URL of the Cisco document that is offering the update.

Customers may only download, install, and expect support for software releases and feature sets for which they have purchased a valid license that is current and active. By installing, downloading, accessing, or otherwise using such software updates, customers agree to follow the terms of the [Cisco software license agreement](https://www.cisco.com/c/en/us/about/legal/cloud-and-software/end_user_license_agreement.html). In most cases, the software update will be a maintenance release to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

After [End of Sale](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) (EoS), the availability of security fixes for vulnerabilities is defined in the product’s EoS bulletin. (See the [End-of-Life Policy](https://www.cisco.com/c/en/us/products/eos-eol-policy.html) for details.) The EoS bulletin may define the Last Day of Support (**LDoS**) milestone, which identifies the last date that Cisco will investigate and disclose product vulnerabilities.

Once the LDoS has been reached, the Cisco PSIRT will continue to accept vulnerability reports but will not analyze, fix, or disclose potential vulnerabilities. To this end, the Cisco PSIRT will not issue CVEs for issues reported on products that are past the LDoS milestone.

### Security Advisory Terms and Conventions

**Fixed Release Availability:** If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the "Last Updated" date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.

The designated Security Advisory status indicates the following:

**Interim:** The Cisco investigation is ongoing. Cisco will issue revisions to the advisory when additional information, including fixed software release data, becomes available.

**Final:** Cisco has completed its evaluation of the vulnerability described in the advisory. There will be no further updates unless there is a material change in the nature of the vulnerability.

All aspects of this process are subject to change without notice and on a case-by-case basis. No particular level of response is guaranteed for any specific issue or class of issues.

## Cisco Bug Bounty Programs

For information on Cisco Bug Bounty programs, see [Bug Bounty Programs at Cisco](https://sec.cloudapps.cisco.com/security/center/resources/cisco_bug_bounty_faq.html).

Back to Top

---

Last Updated: 2024 December 23

This document is part of the [Cisco Security](https://www.cisco.com/security) portal. Cisco provides the official information contained on the  [Cisco Security](https://www.cisco.com/security) portal in English only.

This document is provided on an "as is" basis and does not imply any kind of guarantee or warranty, including the warranties of merchantability or fitness for a particular use. Your use of the information in the document or materials linked from the document is at your own risk. Cisco reserves the right to change or update this document without notice at any time.

Internal Reference Policy: Security Vulnerability Policy, EDCS-19443599

Owning Function: Cisco PSIRT

---

© 2024 Cisco and/or its affiliates. All rights reserved. This document is Cisco Public Information.

![](http://www.cisco.com/swa/i/spacer.gif)



=== Content from docs.defenseorchestrator.com_a9036ec6_20250115_120517.html ===


* [Basics of Security Cloud Control](g-basics-of-cisco-defense-orchestrator.html)
* [Cisco AI Assistant User Guide](g_firewall-policy-assistant.html)
* [Onboard Secure Firewall Threat Defense Devices](g-chapterwrapper-for-olh-onboarding-ftd-devices.html)
* [Onboard ASA Devices](g-chapter-wrapper-for-olh-onboard-asa-devices.html)
* [Onboard an On-Premises Firewall Management Center](g-chapter-wrapper-for-olh-onboard-an-fmc.html)
* [Migrate On-Premises Management Center Managed Secure Firewall Threat Defense to Cloud-delivered Firewall Management Center](g-change-firewall-threat-defense-device-management-from-secure-firewall-management-center-to-cdo.html)
* [Onboard an Umbrella Organization](g-olh-onboard-an-umbrella-organization.html)
* [Onboard Security Cloud Control Integrations](g-chapterwrapper-for-olh-onboard-cisco-defense-orchestrator-integrations.html)
* [Onboard Meraki MX Devices](g-chapterwrapper-for-olh-onboard-meraki-mx-devices.html)
* [Onboard AWS Devices](g-chapterwrapper-for-olh-onboard-aws-devices.html)
* [Upgrade Devices and Services](c-upgrade-devices-and-services.html)
* [Managing On-Premises Firewall Management Center with Cisco Security Cloud Control](g-firepower-management-center-and-cdo.html)
* [Managing Cisco Secure Firewall Threat Defense Devices with Cloud-delivered Firewall Management Center](g-about-the-cloud-delivered-firewall-management-center-in-cdo.html)
* [Managing FDM Devices with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-ftd-with-cisco-defense-orchestrator.html)
* [Managing ASA with Cisco Security Cloud Control](g-about-managing-asa-with-cisco-defense-orchestrator.html)
* [Migrating Firewalls with the Firewall Migration Tool in Security Cloud Control](g-chapterwrapper-for-olh-migrating-firewalls-with-the-cloud-firewall-migration-tool.html)
* [Managing Umbrella with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-umbrella-with-cisco-defense-orchestrator.html)
* [Managing Meraki with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-meraki-with-cisco-defense-orchestrator.html)
* [Managing IOS Devices with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-ios-devices-with-cisco-defense-orchestrator.html)
* [Managing AWS with Cisco Security Cloud Control](g-chapterwrapper-for-olh-managing-aws-with-cisco-defense-orchestrator.html)
* [Managing SSH Devices with Cisco Security Cloud Control](g-about-managing-ssh-devices-with-cisco-defense-orchestrator.html)
* [Integrating Security Cloud Control with Cisco Security Cloud Sign On](g-integrating-cdo-with-securex.html)
* [Analyzing, Detecting, and Fixing Policy Anomalies Using Policy Analyzer and Optimizer](g-analyzing-detecting-and-fixing-policy-anomalies-using-policy-analyzer-and-optimizer.html)
* [Virtual Private Network Management](g-chapterwrapper-for-olh-virtual-private-network-management.html)
* [Cisco Security Analytics and Logging](g-cisco-security-analytics-and-logging.html)
* [FTD Dashboard](g-analytics-dashboard.html)
* [Cisco Secure Dynamic Attributes Connector](g_cisco-secure-dynamic-attributes-connector.html)
* [Troubleshooting](g-troubleshooting.html)
* [FAQ and Support](g-faq-and-support.html)
* [Security and Internet Access](g_security-internet-access-and-communication-ports.html)
* [Open Source and 3rd Party License Attribution](g-appwrapper-open-source-and-3rd-party-license-attribution.html)
* [Terraform](g-cdo-terraform.html)
Managing Security and Network Devices with Cisco Security Cloud Control Copyright Â© 2025, Cisco Systems, Inc. All rights reserved.

=== Content from www.cisco.com_9b137571_20250115_120522.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Configuration Guides](/c/en/us/support/security/defense-center/products-installation-and-configuration-guides-list.html)
# Firepower Management Center Device Configuration Guide, 7.1

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* Getting Started with Device Configuration
  + [Device Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/get-started-device-management.html)
  + [Users](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/get-started-users.html)
  + [Configuration Deployment](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/get-started-deployment.html)
* Device Operations
  + [Transparent or Routed Firewall Mode](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/device-ops-tfw.html)
  + [Logical Devices on the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/device-ops-logical-devices.html)
  + [High Availability](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/high-availability.html)
  + [Clustering for the Secure Firewall 3100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/device-ops-cluster-sec-fw-3100.html)
  + [Clustering for the Firepower 4100/9300](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/device-ops-cluster-fxos.html)
* Interfaces and Device Settings
  + [Interface Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-ifcs-overview.html)
  + [Regular Firewall Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-ifcs-firewall.html)
  + [Inline Sets and Passive Interfaces](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-ifcs-ips.html)
  + [DHCP and DDNS](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-dhcp-ddns.html)
  + [SNMP for the Firepower 1000/2100](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-snmp.html)
  + [Quality of Service](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-qos.html)
  + [Platform Settings](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-platform.html)
  + [Network Address Translation](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-nat.html)
  + [Alarms for the Cisco ISA 3000](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/interfaces-settings-isa3000-alarms.html)
* Routing
  + [Static and Default Routes](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-static.html)
  + [Virtual Routers](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-vrf.html)
  + [ECMP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-ecmp.html)
  + [OSPF](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-ospf.html)
  + [BGP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-bgp.html)
  + [RIP](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-rip.html)
  + [Multicast](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-multicast.html)
  + [Policy Based Routing](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/routing-policy-based.html)
* Objects and Certificates
  + [Object Management](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/objects-object-mgmt.html)
  + [Certificates](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/objects-certs.html)
* VPN
  + [VPN Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/vpn-overview.html)
  + [Site-to-Site VPNs](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/vpn-s2s.html)
  + [Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/vpn-remote-access.html)
  + [Dynamic Access Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/vpn-dap.html)
  + [VPN Monitoring and Troubleshooting](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/vpn-monitoring.html)
* Access Control
  + [Access Control Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-overview.html)
  + [Access Control Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-policies.html)
  + [Access Control
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-rules.html)
  + [URL Filtering](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-url-filtering.html)
  + [Security Intelligence](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-security-intelligence.html)
  + [DNS Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-dns.html)
  + [Prefiltering and Prefilter Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.html)
  + [Service Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-service-policies.html)
  + [Intelligent Application Bypass](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-intelligent-app-bypass.html)
  + [Content Restriction](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-content-restriction.html)
* Intrusion Detection and Prevention
  + [Network Analysis and Intrusion Policies Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-overview.html)
  + [Getting Started with
    Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-get-start.html)
  + [Tuning Intrusion
    Policies Using Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-tuning-rules.html)
  + [Custom Intrusion Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-custom-rules.html)
  + [Layers in Intrusion
    and Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-layers.html)
  + [Tailoring Intrusion
    Protection to Your Network Assets](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-tailoring.html)
  + [Sensitive Data
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-sensitive-data.html)
  + [Global Limit for Intrusion Event Logging](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-global-limit.html)
  + [Intrusion Prevention
    Performance Tuning](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/intrusion-performance.html)
* Network Malware Protection and File Policies
  + [Network Malware Protection and File Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/network-malware-protection.html)
* Encrypted Traffic Handling
  + [Traffic Decryption Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/encrypted-traffic-overview.html)
  + [SSL Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/encrypted-traffic-policies.html)
  + [TLS/SSL
    Rules](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/encrypted-traffic-rules.html)
  + [TLS/SSL
    Rules and Policy Example](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/m_tls-ssl-rules-policy-example.html)
* User Identity
  + [User Identity Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-overview.html)
  + [Realms](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-realms.html)
  + [User Control with ISE/ISE-PIC](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-ise.html)
  + [User Control with Captive Portal](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-captive-portal.html)
  + [User Control with Remote Access VPN](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-ra-vpn.html)
  + [User Control with TS Agent](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-ts-agent.html)
  + [User Identity Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/identity-policies.html)
* Network Discovery
  + [Network Discovery Overview](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/discovery-overview.html)
  + [Host Identity
    Sources](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/discovery-host-sources.html)
  + [Application
    Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/discovery-app-detection.html)
  + [Network Discovery
    Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/discovery-policies.html)
* FlexConfig Policies
  + [FlexConfig Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/flex-config.html)
* Advanced Network Analysis and Preprocessing
  + [Advanced Access
    Control Settings for Network Analysis and Intrusion Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-access-control.html)
  + [Getting Started with
    Network Analysis Policies](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-get-start.html)
  + [Application Layer
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-app-preprocessors.html)
  + [SCADA
    Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-scada-preprocessors.html)
  + [Transport and Network Layer Preprocessors](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-transport-preprocessors.html)
  + [Specific Threat Detection](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-specific-threat.html)
  + [Adaptive
    Profiles](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/advanced-nap-adaptive-profiles.html)
* Threat Intelligence Director
  + [Threat Intelligence Director](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/threat-intelligence-director.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Firepower Management Center Device Configuration Guide, 7.1 Chapter Title Prefiltering and Prefilter Policies

* [PDF - Complete Book
  (71.32 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71.pdf)
  [PDF - This Chapter (1.2 MB)](/c/en/us/td/docs/security/secure-firewall/management-center/device-config/710/management-center-device-config-71/access-prefilter.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: August 8, 2023

## Chapter: Prefiltering and Prefilter Policies

Chapter Contents

* [Prefiltering and Prefilter Policies](#id_17593)
* [About Prefiltering](#id_23215)
  + [About Prefilter Policies](#id_18072)
  + [Tunnel vs Prefilter Rules](#id_23357)
  + [Prefiltering vs Access Control](#id_29862)
  + [Passthrough Tunnels and Access Control](#id_29854)
* [Best Practices for Fastpath Prefiltering](#id_32280)
* [Best Practices for Encapsulated Traffic Handling](#Cisco_Reference.dita_4fc71ab7-320c-401c-996f-3122a395cea9)
* [Requirements and Prerequisites for Prefilter Policies](#Cisco_Reference.dita_bfc6ffa3-2139-4f0b-a111-5419cacf715e)
* [Configure Prefiltering](#id_17608)
  + [Tunnel and Prefilter Rule Components](#id_18094)
  + [Prefilter Rule Conditions](#Cisco_Concept.dita_924d24e1-0bc7-407d-a64e-f49f3beb05c0)
    - [Interface Rule Conditions](#Cisco_Concept.dita_c26e842c-6d24-4b6e-b644-6f4a3eda446e)
    - [Network Rule Conditions](#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab)
    - [VLAN Tags Rule Conditions](#Cisco_Concept.dita_a0431325-02f3-4417-aebd-c485767874ac)
    - [Port Rule Conditions for Prefilter Rules](#Cisco_Concept.dita_7946e740-bc51-4e4f-9a7d-9451ca303c64)
    - [Time and Day Rule Conditions](#Cisco_Concept.dita_c7e74804-4c62-4576-ab25-ffaf389bae93)
  + [Tunnel Rule Conditions](#Cisco_Concept.dita_9044337e-b0c1-4e89-95b3-93f936327908)
    - [Encapsulation Rule Conditions](#Cisco_Concept.dita_5b5a02a2-260d-461e-a3bf-4c2503d7c5c7)

- [Tunnel Zones and Prefiltering](#id_30606)
  * [Using Tunnel Zones](#id_31063)
  * [Creating Tunnel Zones](#id_18443)
- [Moving Prefilter Rules to an Access Control Policy](#ID-2190-prefilter-acpoli)
- [Prefilter Policy Hit Counts](#id_97028)
- [Large Flow Offloads](#id_14502)
  * [Flow Offload Limitations](#concept_D380F2E170164CA699509AAF363D7862)
- [History for Prefiltering](#id_124653)
Close

# Prefiltering and Prefilter Policies

* [About Prefiltering](#id_23215)
* [Best Practices for Fastpath Prefiltering](#id_32280)
* [Best Practices for Encapsulated Traffic Handling](#Cisco_Reference.dita_4fc71ab7-320c-401c-996f-3122a395cea9)
* [Requirements and Prerequisites for Prefilter Policies](#Cisco_Reference.dita_bfc6ffa3-2139-4f0b-a111-5419cacf715e)
* [Configure Prefiltering](#id_17608)
* [Tunnel Zones and Prefiltering](#id_30606)
* [Moving Prefilter Rules to an Access Control Policy](#ID-2190-prefilter-acpoli)
* [Prefilter Policy Hit Counts](#id_97028)
* [Large Flow Offloads](#id_14502)
* [History for Prefiltering](#id_124653)

## About Prefiltering

Prefiltering is the first phase of access control, before the system performs more resource-intensive evaluation. Prefiltering
is simple, fast, and early. Prefiltering uses limited outer-header criteria to quickly handle traffic. Compare this to subsequent
evaluation, which uses inner headers and has more robust inspection capabilities.

Configure prefiltering to:

* Improve performance— The sooner you exclude traffic that does not require inspection, the better. You can fastpath or block
  certain types of plaintext, passthrough tunnels based on their outer encapsulation headers, without inspecting their encapsulated
  connections. You can also fastpath or block any other connections that benefit from early handling.
* Tailor deep inspection to encapsulated traffic—You can rezone certain types of tunnels so that you can later handle their
  encapsulated connections using the same inspection criteria. Rezoning is necessary because after prefiltering, access control
  uses inner headers.

* [About Prefilter Policies](#id_18072)
* [Tunnel vs Prefilter Rules](#id_23357)
* [Prefiltering vs Access Control](#id_29862)
* [Passthrough Tunnels and Access Control](#id_29854)

### About Prefilter Policies

Prefiltering is a policy-based feature. To assign it to a device, you assign it to the access
control policy that is assigned to the device.

#### Policy Components: Rules and Default Action

In a prefilter policy, *tunnel rules*, *prefilter rules*, and a *default action* handle network traffic:

* Tunnel and prefilter rules—First, rules in a prefilter policy handle traffic in the order you specify. Tunnel rules match
  specific tunnels only and support rezoning. Prefilter rules have a wider range of constraints and do not support rezoning.
  For more information, see [Tunnel vs Prefilter Rules](#id_23357).
* Default action (tunnels only)—If a tunnel does not match any rules, the default action handles it. The default action can
  block these tunnels, or continue access control on their individual encapsulated connections. You cannot rezone tunnels with
  the default action.

  There is no default action for nonencapsulated traffic. If a nonencapsulated connection does not match any prefilter rules,
  the system continues with access control.

#### Connection Logging

You can log connections fastpathed and blocked by the prefilter policy. See Other Connections You Can Log in the [Firepower Management Center
Administration Guide](http://www.cisco.com/go/firepower-config) for more information.

Connection events contain information on whether and how logged connections—including entire tunnels—were prefiltered. You
can view this information in event views (workflows), dashboards, and reports, and use it as correlation criteria. Keep in
mind that because fastpathed and blocked connections are not subject to deep inspection, associated connection events contain
limited information.

#### Default Prefilter Policy

Every access control policy has an associated prefilter policy.

The system uses a default policy if you do not configure custom prefiltering. Initially, this system-provided policy passes
all traffic to the next phase of access control. You can change the policy's default action and configure its logging options,
but you cannot add rules to it or delete it.

#### Prefilter Policy Inheritance and Multitenancy

Access control uses a hierarchical implementation that complements multitenancy. Along with other advanced settings, you can
lock a prefilter policy association, enforcing that association in all descendant access control policies. For more information,
see [Access Control Policy Inheritance](access-overview.html#concept_F5F96D819A084248AFAACE3BE64F99D8).

In a multidomain deployment, the system displays policies created in the current domain, which you can edit. It also displays
policies created in ancestor domains, which you cannot edit. To view and edit policies created in a lower domain, switch to
that domain. The default prefilter policy belongs to the Global domain.

### Tunnel vs Prefilter Rules

Whether you configure a tunnel or prefilter rule depends on the specific type of traffic you want to match and the actions
or further analysis you want to perform.

| Characteristic | Tunnel Rules | Prefilter Rules |
| --- | --- | --- |
| Primary function | Quickly fastpath, block, or rezone plaintext, passthrough tunnels. | Quickly fastpath or block any other connection that benefits from early handling. |
| Encapsulation and port/protocol criteria | Encapsulation conditions match only plaintext tunnels over selected protocols, listed in [Encapsulation Rule Conditions](#Cisco_Concept.dita_5b5a02a2-260d-461e-a3bf-4c2503d7c5c7). | Port conditions can use a wider range of port and protocol constraints than tunnel rules; see [Port, Protocol, and ICMP Code Rule Conditions](interfaces-settings-qos.html#Cisco_Concept.dita_7bef1e8e-aa4c-4ede-b44c-8b8fe490febb). |
| Network criteria | Tunnel endpoint conditions constrain the endpoints of the tunnels you want to handle; see [Network Rule Conditions](#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab). | Network conditions constrain the source and destination hosts in each connection; see [Network Rule Conditions](#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab). |
| Direction | Bidirectional or unidirectional (configurable).  Tunnel rules are bidirectional by default, so they can handle all traffic between tunnel endpoints. | Unidirectional only (nonconfigurable).  Prefilter rules match source-to-destination traffic only. |
| Rezone sessions for further analysis | Supported, using tunnel zones; see [Tunnel Zones and Prefiltering](#id_30606). | Not supported. |

### Prefiltering vs Access Control

Prefilter and access control policies both allow you to block and trust traffic, though the prefiltering "trust" functionality
is called "fastpathing" because it skips more inspection. The following table explains this and other differences between
prefiltering and access control, to help you decide whether to configure custom prefiltering.

If you do not configure custom prefiltering, you can only approximate—not replicate—prefilter functionality with early-placed
Block and Trust rules in the access control policy.

| Characteristic | Prefiltering | Access Control | For more information, see... |
| --- | --- | --- | --- |
| Primary function | Quickly fastpath or block certain types of plaintext, passthrough tunnels (see [Encapsulation Rule Conditions](#Cisco_Concept.dita_5b5a02a2-260d-461e-a3bf-4c2503d7c5c7)), or tailor subsequent inspection to their encapsulated traffic.  Fastpath or block any other connections that benefit from early handling. | Inspect and control all network traffic, using simple or complex criteria, including contextual information and deep inspection results. | [About Prefiltering](#id_23215) |
| Implementation | Prefilter policy.  The prefilter policy is invoked by the access control policy. | Access control policy.  The access control policy is a main configuration. In addition to invoking subpolicies, access control policies have their own rules. | [About Prefilter Policies](#id_18072)  [Associating Other Policies with Access Control](access-policies.html#id_17609) |
| Sequence within access control | First.  The system matches traffic to prefilter criteria before all other access control configurations. | — | — |
| Rule actions | Fewer.  You can stop further inspection (Fastpath and Block) or allow further analysis with the rest of access control (Analyze). | More.  Access control rules have a larger variety of actions, including monitoring, deep inspection, block with reset, and interactive blocking. | [Tunnel and Prefilter Rule Components](#id_18094)  [Access Control Rule Actions](access-rules.html#ID-2190-0000021f) |
| Bypass capability | Fastpath rule action.  Fastpathing traffic in the prefilter stage bypasses all further inspection and handling, including:   * Security Intelligence * authentication requirements imposed by an identity policy * SSL decryption * access control rules * deep inspection of packet payloads * discovery * rate limiting | Trust rule action.  Traffic trusted by access control rules is only exempt from deep inspection and discovery. | [Introduction to Access Control Rules](access-rules.html#ID-2190-00000005) |
| Rule criteria | Limited.  Rules in the prefilter policy use simple network criteria: IP address, VLAN tag, port, and protocol.  For tunnels, tunnel endpoint conditions specify the IP address of the routed interfaces of the network devices on either side of the tunnel. | Robust.  Access control rules use network criteria, but also user, application, requested URL, and other contextual information available in packet payloads.  Network conditions specify the IP address of source and destination hosts. | [Tunnel vs Prefilter Rules](#id_23357)  [Prefilter Rule Conditions](#Cisco_Concept.dita_924d24e1-0bc7-407d-a64e-f49f3beb05c0)  [Tunnel Rule Conditions](#Cisco_Concept.dita_9044337e-b0c1-4e89-95b3-93f936327908) |
| IP headers used (tunnel handling) | Outermost.  Using outer headers allows you to handle entire plaintext, passthrough tunnels.  For nonencapsulated traffic, prefiltering still uses "outer" headers—which in this case are the only headers. | Innermost possible.  For a nonencrypted tunnel, access control acts on its individual encapsulated connections, not the tunnel as a whole. | [Passthrough Tunnels and Access Control](#id_29854) |
| Rezone encapsulated connections for further analysis | Rezones tunneled traffic.  Tunnel zones allow you to tailor subsequent inspection to prefiltered, encapsulated traffic. | Uses tunnel zones.  Access control uses the tunnel zones you assign during prefiltering. | [Tunnel Zones and Prefiltering](#id_30606) |
| Connection logging | Fastpathed and blocked traffic only. Allowed connections may still be logged by other configurations. | Any connection. | Other Connections You Can Log in the [Firepower Management Center Administration Guide](http://www.cisco.com/go/firepower-config) |
| Supported devices | Firepower Threat Defense only. | All. | — |

### Passthrough Tunnels and Access Control

Plaintext (nonencrypted) tunnels can encapsulate multiple connections, often flowing between discontinuous networks. These
tunnels are especially useful for routing custom protocols over IP networks, IPv6 traffic over IPv4 networks, and so on.

An outer *encapsulation header* specifies the source and destination IP addresses of the *tunnel endpoints*—the routed interfaces of the network devices on either side of the tunnel. Inner *payload headers* specify the source and destination IP addresses of the encapsulated connections' actual endpoints.

Often, network security devices handle plaintext tunnels as *passthrough* traffic. That is, the device is not one of the tunnel endpoints. Instead, it is deployed between the tunnel endpoints and
monitors the traffic flowing between them.

Some network security devices enforce security policies using outer IP headers. Even for plaintext tunnels, these devices
have no control over or insight into individual encapsulated connections and their payloads.

By contrast, the system leverages access control as follows:

* Outer header evaluation—First, prefiltering uses outer headers to handle traffic. You can block or fastpath entire plaintext,
  passthrough tunnels at this stage.
* Inner header evaluation—Next, the rest of access control (and other features such as QoS) use the innermost detectable level
  of headers to ensure the most granular level of inspection and handling possible.

  If a passthrough tunnel is not encrypted, the system acts on its individual encapsulated connections at this stage. You must
  *rezone* a tunnel (see [Tunnel Zones and Prefiltering](#id_30606)) to act on all its encapsulated connections.

Access control has no insight into encrypted passthrough tunnels. For example, access control rules see a passthrough VPN
tunnel as one connection. The system handles the entire tunnel using only the information in its outer, encapsulation header.

## Best Practices for Fastpath Prefiltering

When you use the fastpath action in a prefilter rule, the matching traffic bypasses inspection and is simply transmitted through
the device. Use this action for traffic that you can trust and that would not benefit from any of the security features available.

The following types of traffic are ideal for fastpathing. For example, you could configure the rules to fastpath any traffic
from or to the IP addresses of the endpoints or servers. You can further limit the rule based on ports used.

* VPN traffic that is going through the device. That is, the device is not an endpoint in the VPN topology.
* Scanner traffic. Scanner probes can create a lot of false-positive responses from intrusion policies.
* Voice/video.
* Backups.
* Management traffic (sftunnel) that traverses FTD devices. Performing deep inspection on management traffic (using access control policies) can cause issues. You can prefilter
  based on port TCP/8305 between the management center and managed devices.

## Best Practices for Encapsulated Traffic Handling

This topic discusses guidelines for the following types of encapsulated traffic:

* Generic Routing Encapsulation (GRE)
* Point-to-Point Protocol (PPTP)
* IPinIP
* IPv6inIP
* Teredo

### GRE Tunnel Limitations

GRE tunnel processing is limited to IPv4 and IPv6 passenger flows. Other protocols, such as PPTP and WCCP, are not supported
within the GRE tunnel.

### Understand Snort version support for your managed devices

The inspection engine used by managed devices is known as Snort. Snort 3 supports
more features than Snort 2. To understand how these affect managed devices on your
network, you must know:

* Which versions of Snort your device supports.

  Snort version support can be found in the section on bundled components in
  the Cisco Firepower Compatibility Guide.
* How the FMC and FTD software support Snort 2 and Snort 3

  Limitations of Snort 2 and Snort 3 can be found in the *Feature Limitations of Snort 3 for FMC-Managed FTD* topic in the [Firepower Management
  Center Snort 3 Configuration
  Guide](https://www.cisco.com/go/fmc-snort3).

### GRE v1 and PPTP bypass outer flow processing

GRE v1 (sometimes referred to as *stateful GRE*) and PPTP traffic bypass outer flow processing.

Passenger flow processing is supported for IPv6inIP and Teredo but the following limitations apply:

* Sessions are over a single tunnel that is not load-balanced
* There is no HA or clustering replication
* Primary and secondary flow relationships are not maintained
* Prefilter policy white and black lists are not supported

### GRE v0 sequence number field must be optional

All endpoints sending traffic on the network must send GREv0 traffic with the sequence number field as optional; otherwise,
the sequence number field is removed. RFC 1701 and RFC 2784 both specify the sequence field as optional.

### How tunnels work with interfaces

Prefilter and access control policy rules are applied to all tunnel types on routed, transparent, inline-set, inline-tap,
and passive interfaces.

### References

For more information about the GRE and PPTP protocols, see the following:

* [RFC 1701](https://tools.ietf.org/html/rfc1701), [RFC 2784](https://tools.ietf.org/html/rfc2784), and [RFC 2890](https://tools.ietf.org/html/rfc2890) (GRE protocol v0)
* [RFC 2637](https://tools.ietf.org/html/rfc2637) (PPTP and GRE protocol v1)

## Requirements and Prerequisites for Prefilter Policies

### Model Support

FTD

### Supported Domains

Any

### User Roles

* Admin
* Access Admin
* Network Admin

## Configure Prefiltering

To perform custom prefiltering, configure prefilter policies and assign the policies
to access control policies. It is through the access control policy that prefilter
policies get assigned to managed devices.

Only one person should edit a policy at a time, using a single browser window. If multiple users save the same policy, the
last saved changes are retained. For your convenience, the system displays information on who (if anyone) is currently editing
each policy. To protect the privacy of your session, a warning appears after 30 minutes of inactivity on the policy editor.
After 60 minutes, the system discards your changes.

### Procedure

---

| **Step 1** | Choose Policies > Access Control > Prefilter. |
| --- | --- |
| **Step 2** | Click New Policy to create a custom prefilter policy.  A new prefilter policy has no rules and a default action of Analyze all tunnel traffic. It performs no logging or tunnel rezoning. You can also Copy  (copy icon) or Edit (edit icon) an existing policy. |
| **Step 3** | Configure the prefilter policy's default action and its logging options.   * Default action—Choose a default action for supported plaintext, passthrough tunnels: Analyze all tunnel traffic (with access control) or Block all tunnel traffic. * Default action logging—Click Logging (logging icon) next to the default action; see Logging Connections with a Policy Default   Action in the [Firepower Management Center   Administration Guide](http://www.cisco.com/go/firepower-config).   You can configure default action logging for blocked tunnels only. |
| **Step 4** | Configure tunnel and prefilter rules.  In a custom prefilter policy, you can use both kinds of rule, in any order. Create rules depending on the specific type of traffic you want to match and the actions or further analysis you want to perform; see [Tunnel vs Prefilter Rules](#id_23357).   | **Caution** | Exercise caution when using tunnel rules to assign tunnel zones. Connections in rezoned tunnels may not match security zone constraints in later evaluation. For more information, see [Tunnel Zones and Prefiltering](#id_30606). | | --- | --- |   For detailed information on configuring rule components, see [Tunnel and Prefilter Rule Components](#id_18094). |
| **Step 5** | Evaluate rule order. To move a rule, click and drag or use the right-click menu to cut and paste.  Properly creating and ordering rules is a complex task, but one that is essential to building an effective deployment. If you do not plan carefully, rules can preempt other rules or contain invalid configurations. For more information, see [Best Practices for Access Control Rules](access-overview.html#ID-2176-000005b6). |
| **Step 6** | Save the prefilter policy. |
| **Step 7** | For configurations that support tunnel zone constraints, appropriately handle rezoned tunnels.  Match connections in rezoned tunnels by using tunnel zones as source zone constraints. |
| **Step 8** | Associate the prefilter policy with the access control policy deployed to your managed devices.  See [Associating Other Policies with Access Control](access-policies.html#id_17609). |
| **Step 9** | Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).   | **Note** | When you deploy a prefilter policy, its rules are not applied on the existing tunnel sessions. Hence, traffic on an existing connection is not bound by the new policy that is deployed. In addition, the policy hit count is incremented only for the first packet of a connection that matches a policy. Thus, the traffic on an existing connection that could match a policy is omitted from the hit count. To have the policy rules effectively applied, clear the existing tunnel sessions, and then deploy the policy. | | --- | --- | |

---

### What to do next

If you will deploy time-based rules, specify the time zone
of the device to which the policy is assigned. See [Time Zone](interfaces-settings-platform.html#Cisco_Task_in_List_GUI.dita_b1764425-499d-4101-bc02-d6c56656fb21).

* [Tunnel and Prefilter Rule Components](#id_18094)
* [Prefilter Rule Conditions](#Cisco_Concept.dita_924d24e1-0bc7-407d-a64e-f49f3beb05c0)
* [Tunnel Rule Conditions](#Cisco_Concept.dita_9044337e-b0c1-4e89-95b3-93f936327908)

### Tunnel and Prefilter Rule Components

#### State (Enabled/Disabled)

By default, rules are enabled. If you disable a rule, the system does not use it and stops generating warnings and errors
for that rule.

#### Position

Rules are numbered, starting at 1. The system matches traffic to rules in top-down order by ascending rule number. The first
rule that traffic matches is the rule that handles that traffic, regardless of rule type (tunnel vs prefilter).

#### Action

A rule's action determines how the system handles and logs matching traffic:

* Fastpath—Exempts matching traffic from all further inspection and control, including access control, identity requirements,
  and rate limiting. Fastpathing a tunnel fastpaths all encapsulated connections.
* Block—Blocks matching traffic without further inspection of any kind. Blocking a tunnel blocks all encapsulated connections.
* Analyze—Allows traffic to continue to be analyzed by the rest of access control, using inner headers. If passed by access
  control and any related deep inspection, this traffic may also be rate limited. For tunnel rules, enables rezoning with the
  Assign Tunnel Zone option.

#### Direction (Tunnel Rules Only)

A tunnel rule's direction determines how the system source and destination criteria:

* Match tunnels only from source (unidirectional)—Match source-to-destination traffic only. Matching traffic must originate
  from one of the specified source interfaces or tunnel endpoints, and leave through one of the destination interfaces or tunnel
  endpoints.
* Match tunnels from source and destination (bidirectional)—Match both source-to-destination traffic and destination-to-source
  traffic. The effect is identical to writing two unidirectional rules, one the mirror of the other.

Prefilter rules are always unidirectional.

#### Assign Tunnel Zone (Tunnel Rules Only)

In a tunnel rule, assigning a tunnel zone (whether existing or created on the fly), *rezones* matching tunnels. Rezoning requires the Analyze action.

Rezoning a tunnel allows other configurations—such as access control rules—to recognize all the tunnel's encapsulated connections
as belonging together. By using a tunnel's assigned tunnel zone as an interface constraint, you can tailor inspection to its
encapsulated connections. For more information, see [Tunnel Zones and Prefiltering](#id_30606).

| **Caution** | ---   Exercise caution when assigning tunnel zones. Connections in rezoned tunnels may not match security zone constraints in later evaluation. See [Using Tunnel Zones](#id_31063) for a brief walkthrough of a tunnel zone implementation, and a discussion of the implications of rezoning without explicitly handling rezoned traffic.   --- |
| --- | --- |

#### Conditions

Conditions specify the specific traffic the rule handles. Traffic must match all a rule's conditions to match the rule. Each
condition type has its own tab in the rule editor.

You can prefilter traffic using the following *outer-header* constraints. You must
constrain tunnel rules by encapsulation protocol.

* Interface—[Interface Rule Conditions](#Cisco_Concept.dita_c26e842c-6d24-4b6e-b644-6f4a3eda446e)
* Network (prefilter rule)/Tunnel Endpoints (tunnel rule)—[Network Rule Conditions](#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab)
* VLAN—[VLAN Tags Rule Conditions](#Cisco_Concept.dita_a0431325-02f3-4417-aebd-c485767874ac)
* Ports (prefilter rule)/Encapsulation and Ports (tunnel rule)—[Port Rule Conditions for Prefilter Rules](#Cisco_Concept.dita_7946e740-bc51-4e4f-9a7d-9451ca303c64) or
  [Encapsulation Rule Conditions](#Cisco_Concept.dita_5b5a02a2-260d-461e-a3bf-4c2503d7c5c7)
* Time Range—[Time and Day Rule Conditions](#Cisco_Concept.dita_c7e74804-4c62-4576-ab25-ffaf389bae93)

#### Logging

A rule's logging settings govern the records the system keeps of the traffic it handles.

In tunnel and prefilter rules, you can log fastpathed and blocked traffic (the Fastpath and
Block actions). For traffic subject to further analysis (the Analyze action), logging in the
prefilter policy is disabled, although matching connections may still be logged by other
configurations. Logging is performed on inner flows, not on the encapsulating flow. For more information, see Logging Connections with Tunnel and Prefilter Rules in the [Firepower Management Center
Administration Guide](http://www.cisco.com/go/firepower-config).

#### Comments

Each time you save changes to a rule you can add comments. For example, you might summarize the overall configuration for
the benefit of other users, or note when you change a rule and the reason for the change.

You cannot edit or delete these comments after you save the rule.

**Related Concepts**
[Best Practices for Access Control Rules](access-overview.html#ID-2176-000005b6)

### Prefilter Rule Conditions

Rule conditions enable you to fine-tune your prefilter policy to target the networks you want to control. See one of the following
sections for more information.

* [Interface Rule Conditions](#Cisco_Concept.dita_c26e842c-6d24-4b6e-b644-6f4a3eda446e)
* [Network Rule Conditions](#Cisco_Concept.dita_895cafbb-9541-4bda-81cd-647a414adeab)
* [VLAN Tags Rule Conditions](#Cisco_Concept.dita_a0431325-02f3-4417-aebd-c485767874ac)
* [Port Rule Conditions for Prefilter Rules](#Cisco_Concept.dita_7946e740-bc51-4e4f-9a7d-9451ca303c64)
* [Time and Day Rule Conditions](#Cisco_Concept.dita_c7e74804-4c62-4576-ab25-ffaf389bae93)

#### Interface Rule Conditions

Interface rule conditions control traffic by its source and destination interfaces.

Depending on the rule type and the devices in your deployment, you can use predefined *interface objects* called *security zones* or *interface groups* to build interface conditions. Interface objects segment your network to help you manage and classify traffic flow by grouping
interfaces across multiple devices; see [Interface](objects-object-mgmt.html#ID-2243-000009b4).

| **Tip** | ---   Constraining rules by interface is one of the best ways to improve system performance. If a rule excludes all of a device’s interfaces, that rule does not affect that device's performance.   --- |
| --- | --- |

Just as all interfaces in an interface object must be of the same type (all inline, passive, switched, routed, or ASA FirePOWER), all interface objects used in an interface condition must be of the same type. Because devices deployed passively do not
transmit traffic, in passive deployments you cannot constrain rules by destination interface.

#### Network Rule Conditions

Network rule conditions control traffic by its source and destination IP address, using inner headers. Tunnel rules, which
use outer headers, have tunnel endpoint conditions instead of network conditions.

You can use predefined objects to build network conditions, or manually specify individual IP addresses or address blocks.

| **Note** | ---   You *cannot* use FDQN network objects in identity rules.   --- |
| --- | --- |

Leave matching criteria empty whenever possible, especially those for security zones, network objects, and port objects. When
you specify multiple criteria, the system must match against every combination of the contents of the criteria you specify.

* [Redirect to Host Name Network Rule Conditions](#Cisco_Concept.dita_36e5a17f-97b6-41f9-aff8-00d314b6b0a0)

#### VLAN Tags Rule Conditions

| **Note** | ---   VLAN tags in access rules only apply to inline sets. Access rules with VLAN tags do not match traffic on firewall interfaces.   --- |
| --- | --- |

VLAN rule conditions control VLAN-tagged traffic, including Q-in-Q (stacked VLAN) traffic. The system uses the innermost VLAN
tag to filter VLAN traffic, with the exception of the prefilter policy, which uses the outermost VLAN tag in its rules.

Note the following Q-in-Q support:

* FTD on Firepower 4100/9300—Does not support Q-in-Q (supports only one VLAN tag).
* FTD on all other models:

  + Inline sets and passive interfaces—Supports Q-in-Q, up to 2 VLAN tags.
  + Firewall interfaces—Does not support Q-in-Q (supports only one VLAN tag).

You can use predefined objects to build VLAN conditions, or manually enter any VLAN tag from 1 to 4094. Use a hyphen to specify
a range of VLAN tags.

You can specify a maximum of 50 VLAN conditions.

In a cluster, if you encounter problems with VLAN matching, edit the access control policy advanced options, Transport/Network
Preprocessor Settings, and select the Ignore the VLAN header when tracking connections option.

| **Note** | ---  The system builds a separate network map for each leaf domain. In a multidomain deployment, using literal VLAN tags to constrain this configuration can have unexpected results. Using override-enabled objects allows descendant domain administrators to tailor Global configurations to their local environments.  --- |
| --- | --- |

#### Port Rule Conditions for Prefilter Rules

Port conditions match traffic based on the source and destination ports. Depending on the
rule type, “port” can represent any of the following:

* TCP and UDP—You can control TCP and UDP traffic based on the port. The system
  represents this configuration using the protocol number in parentheses, plus an
  optional associated port or port range. For example: TCP(6)/22.
* ICMP—You can control ICMP and ICMPv6 (IPv6-ICMP) traffic based on its internet
  layer protocol plus an optional type and code. For example: ICMP(1):3:3.
* Protocol—You can control traffic using other protocols that do not use ports.

##### Using Source and Destination Port Constraints

If you add both source and destination port constraints, you can only add ports that
share a single transport protocol (TCP or UDP). For example, if you add DNS over TCP
as a source port, you can add Yahoo Messenger Voice Chat (TCP) as a destination port
but not Yahoo Messenger Voice Chat (UDP).

If you add only source ports or only destination ports, you can add ports that use
different transport protocols. For example, you can add both DNS over TCP and DNS
over UDP as destination port conditions in a single access control rule.

##### Matching Non-TCP Traffic with Port Conditions

You can match non-port-based protocols. By default, if you do not specify a port
condition, you are matching IP traffic. Although you can configure port conditions
to match other protocols in prefilter rules, you should use tunnel rules instead
when matching GRE, IP in IP, IPv6 in IP, and Toredo Port 3544.

#### Time and Day Rule Conditions

You can specify a continuous time range or a recurring time period.

For example, a rule can apply only during weekday working hours, or every weekend, or during a holiday shutdown period.

Time-based rules are applied based on the local time of the device that processes the traffic.

Time-based rules are supported only on FTD devices. If you assign a policy with a time-based rule to a different type of device, the time restriction associated with
the rule is ignored on that device. You will see warnings in this case.

### Tunnel Rule Conditions

Rule conditions enable you to fine-tune your tunnel policy to target the networks you
want to control. For tunnel rules, you can use the following conditions:

* Interface Objects—The security zones or interface groups
  that define the device interfaces through which the connections pass. See [Interface Rule Conditions](#Cisco_Concept.dita_c26e842c-6d24-4b6e-b644-6f4a3eda446e).
* Tunnel Endpoints—The network objects that define the
  source and destination IP addresses of the tunnel.
* VLAN Tags—The outermost VLAN tag in the tunnel. See [VLAN Tags Rule Conditions](#Cisco_Concept.dita_a0431325-02f3-4417-aebd-c485767874ac).
* Encapsulation and Ports—The encapsulation protocol of the
  tunnel. See [Encapsulation Rule Conditions](#Cisco_Concept.dita_5b5a02a2-260d-461e-a3bf-4c2503d7c5c7).
* Time Range—The days and times when the rule is active. If
  you do not specify a time range, the rule is always active. See [Time and Day Rule Conditions](#Cisco_Concept.dita_c7e74804-4c62-4576-ab25-ffaf389bae93).

#### Encapsulation Rule Conditions

Encapsulation conditions are specific to tunnel rules.

These conditions control certain types of plaintext, passthrough tunnels by their encapsulation protocol. You must choose
at least one protocol to match before you can save the rule. You can choose:

* GRE (47)
* IP-in-IP (4)
* IPv6-in-IP (41)
* Teredo (UDP (17)/3455)

## Tunnel Zones and Prefiltering

Tunnel zones allow you to use prefiltering to tailor subsequent traffic handling to encapsulated connections.

A special mechanism is required because usually, the system handles traffic using the innermost detectable level of headers.
This ensures the most granular level of inspection possible. But it also means that if a passthrough tunnel is not encrypted,
the system acts on its individual encapsulated connections; see [Passthrough Tunnels and Access Control](#id_29854).

Tunnel zones solve this problem. During the first phase of access control (prefiltering) you can use outer headers to identify
certain types of plaintext, passthrough tunnels. Then, you can *rezone* those tunnels by assigning a custom *tunnel zone*.

Rezoning a tunnel allows other configurations—such as access control rules—to recognize all the tunnel's encapsulated connections
as belonging together. By using a tunnel's assigned tunnel zone as an interface constraint, you can tailor inspection to its
encapsulated connections.

Despite its name, a tunnel zone is not a security zone. A tunnel zone does not represent a set of interfaces. It is more accurate
to think of a tunnel zone as a tag that, in some cases, replaces the security zone associated with an encapsulated connection.

| **Caution** | ---   For configurations that support tunnel zone constraints, connections in rezoned tunnels do **not** match security zone constraints. For example, after you rezone a tunnel, access control rules can match its encapsulated connections with their newly assigned *tunnel* zone, but not with any original *security* zone.   --- |
| --- | --- |

See [Using Tunnel Zones](#id_31063) for a brief walkthrough of a tunnel zone implementation, and a discussion of the implications of rezoning without explicitly
handling rezoned traffic.

### Configurations Supporting Tunnel Zone Constraints

Only access control rules support tunnel zone constraints.

No other configurations support tunnel zone constraints. For example, you cannot use QoS to rate limit a plaintext tunnel
as a whole; you can only rate limit its individual encapsulated sessions.

* [Using Tunnel Zones](#id_31063)
* [Creating Tunnel Zones](#id_18443)

### Using Tunnel Zones

This example procedure summarizes how you might rezone GRE tunnels for further analysis, using tunnel zones. You can adapt
the concepts described in this example to other scenarios where you need to tailor traffic inspection to connections encapsulated
in plaintext, passthrough tunnels.

Consider a situation where your organization's internal traffic flows through the
Trusted security zone. The Trusted security zone represents a set of interfaces
across multiple managed devices deployed in various locations. Your organization's
security policy requires that you allow internal traffic after deep inspection for
exploits and malware.

Internal traffic sometimes includes plaintext, passthrough, GRE tunnels between particular endpoints. Because the traffic
profile of this encapsulated traffic is different from your "normal" interoffice activity—perhaps it is known and benign—you
can limit inspection of certain encapsulated connections while still complying with your security policy.

In this example, after you deploy configuration changes:

* Plaintext, passthrough, GRE-encapsulated tunnels detected in the Trusted zone have their individual encapsulated connections
  evaluated by one set of intrusion and file policies.
* All other traffic in the Trusted zone is evaluated with a different set of intrusion and file policies.

You accomplish this task by *rezoning* GRE tunnels. Rezoning ensures that access
control associates GRE-encapsulated connections with a custom *tunnel* zone,
rather than their original Trusted *security* zone. Rezoning is required due to
the way access control handles encapsulated traffic; see [Passthrough Tunnels and Access Control](#id_29854) and [Tunnel Zones and Prefiltering](#id_30606).

#### Procedure

---

|  |  |
| --- | --- |
| **Step 1** | Configure custom intrusion and file policies that tailor deep inspection to encapsulated traffic, and another set of intrusion and file policies tailored to nonencapsulated traffic. |
| **Step 2** | Configure custom prefiltering to rezone GRE tunnels flowing through the Trusted security zone.  Create a custom prefilter policy and associate it with access control. In that custom prefilter policy, create a tunnel rule (in this example, `GRE_tunnel_rezone`) and a corresponding tunnel zone (`GRE_tunnel`). For more information, see [Configure Prefiltering](#id_17608).   Table 1. GRE\_tunnel\_rezone Tunnel Rule   | Rule Component | Description | | --- | --- | | Interface object condition | Match internal-only tunnels by using the Trusted security zone as both a Source Interface Object and Destination Interface Object constraint. | | Tunnel endpoint condition | Specify the source and destination endpoints for the GRE tunnels used in your organization.  Tunnel rules are bidirectional by default. If you do not change the Match tunnels from... option, it does not matter which endpoints you specify as source and which as destination. | | Encapsulation condition | Match GRE traffic. | | Assign Tunnel Zone | Create the `GRE_tunnel` tunnel zone, and assign it to tunnels that match the rule. | | Action | Analyze (with the rest of access control). | |
| **Step 3** | Configure access control to handle connections in rezoned tunnels.  In the access control policy deployed to your managed devices, configure a rule (in this example, `GRE_inspection`) that handles the traffic you rezoned. For more information, see [Create and Edit Access Control Rules](access-rules.html#ID-2190-00000090).   Table 2. GRE\_inspection Access Control Rule   | Rule Component | Description | | --- | --- | | Security zone condition | Match rezoned tunnels by using the GRE\_tunnel security zone as a Source Zone constraint. | | Action | Allow, with deep inspection enabled.  Choose the file and intrusion policies tailored to inspect encapsulated internal traffic. |  | **Caution** | If you skip this step, the rezoned connections may match **any** access control rule not constrained by security zone. If the rezoned connections do not match any access control rules, they are handled by the access control policy default action. Make sure this is your intent. | | --- | --- | |
| **Step 4** | Configure access control to handle nonencapsulated connections flowing through the Trusted security zone.  In the same access control policy, configure a rule (in this example, `internal_default_inspection`) that handles non-rezoned traffic in the Trusted security zone.   Table 3. internal\_default\_inspection Access Control Rule   | Rule Component | Description | | --- | --- | | Security zone condition | Match non-rezoned internal-only traffic by using the Trusted security zone as both a Source Zone and Destination Zone constraint. | | Action | Allow, with deep inspection enabled.  Choose the file and intrusion policies tailored to inspect nonencapsulated internal traffic. | |
| **Step 5** | Evaluate the position of the new access control rules relative to preexisting rules. Change rule order if necessary.  If you place the two new access control rules next to each other, it does not matter which you place first. Because you rezoned GRE tunnels, the two rules cannot preempt each other. |
| **Step 6** | Save all changed configurations. |

---

#### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

### Creating Tunnel Zones

The following procedure explains how to create a tunnel zone in the
object manager. You can also create zones when editing a tunnel
rule.

#### Procedure

---

| **Step 1** | Choose Objects > Object Management. |
| --- | --- |
| **Step 2** | Chose Tunnel Zone from the list of object types. |
| **Step 3** | Click Add Tunnel Zone. |
| **Step 4** | Enter a Name and, optionally, a Description. |
| **Step 5** | Click Save. |

---

#### What to do next

* Assign tunnel zones to plaintext, passthrough tunnels as part of custom prefiltering; see [Configure Prefiltering](#id_17608).

## Moving Prefilter Rules to an Access Control Policy

You can move prefilter rules from a prefilter policy to the associated access control policy.

### Before you begin

Note the following conditions before you proceed:

* Only prefilter rules can be moved to an access control policy. Tunnel rules cannot be moved.
* The prefilter rules can be moved only to the associated access control policy.
* The prefilter rules with configured interface groups cannot be moved.
* The Action parameter in the prefilter rule is changed to a suitable action in the access control rule when moved. To know what each
  action in the prefilter rule maps to, see the following table:

  | Action in the prefilter rule | Action in the access control rule |
  | --- | --- |
  | Analyze | Allow |
  | Block | Block |
  | Fastpath | Trust |
* Similarly, based on the action configured in the prefilter rule, the logging configuration is set to an appropriate setting
  after the rule is moved, as mentioned in the following table.

  | Action in the prefilter rule | Enabled Logging configurations in the access control rule |
  | --- | --- |
  | Analyze | None of the log settings are enabled. |
  | Block | + Log at Beginning of Connection + Event Viewer + Syslog Server + SNMP Trap |
  | Fastpath | + Log at Beginning of Connection + Log at End of Connection + Event Viewer + Syslog Server + SNMP Trap |
* The comments in the prefilter rule configuration are lost after moving the rule. However, a new comment is added in the moved
  rule mentioning the source prefilter policy.
* While moving rules from the source policy, if another user modifies those rules, the FMC displays a message. You may continue with the process after refreshing the page.

### Procedure

---

| **Step 1** | In the prefilter policy editor, select the rules that you want to move with a left-click on your mouse.   | **Tip** | To select multiple rules, use the Ctrl (Control) key on your keyboard. | | --- | --- | |
| --- | --- | --- | --- |
| **Step 2** | Right-click the selected rules and choose Move to another policy. |
| **Step 3** | Select the destination access control policy from the Access Policy drop-down list. |
| **Step 4** | From the Place Rules drop-down list, choose where you want to position the moved rules:   * To position as the last set of rules in the Default section, choose At the bottom (within the Default section). * To position as the first set of rules in the Mandatory section, choose At the top (within the Mandatory section). |
| **Step 5** | Click Move. |

---

### What to do next

* Deploy configuration changes; see [Deploy Configuration Changes](get-started-deployment.html#task_75E181687ECF4EFC8EB6AF4509C20C0B).

## Prefilter Policy Hit Counts

Hit count indicates the number of times a policy rule has triggered for a matching connection.

For complete information on viewing prefilter policy hit counts, see [Viewing Rule Hit Counts](access-policies.html#id_92824).

## Large Flow Offloads

On Firepower 4100/9300 chassis, certain traffic that you configure to be fastpathed by a prefilter policy is handled by the hardware (specifically, in the
NIC), not by your FTD software. Offloading these connection flows results in higher throughput and lower latency, especially for data-intensive
applications such as large file transfers. This feature is especially useful for data centers. This is called *static flow offload*.

In addition, by default, FTD devices offload flows based on other criteria, including trust. This is called *dynamic flow offload*.

Offloaded flows continue to receive limited stateful inspection, such as basic TCP flag and option checking. The system can
selectively escalate packets to the firewall system for further processing if necessary.

Examples of applications that can benefit from offloading large flows are:

* High Performance Computing (HPC) Research sites, where the FTD device is deployed between storage and high compute stations. When one research site backs up using FTP file transfer or
  file sync over NFS, the large amount of data traffic affects all connections. Offloading FTP file transfer and file sync over
  NFS reduces the impact on other traffic.
* High Frequency Trading (HFT), where the FTD device is deployed between workstations and the Exchange, mainly for compliance purposes. Security is usually not a concern,
  but latency is a major concern.

The following flows can be offloaded:

* (Static flow offload only.) Connections that are fastpathed by the prefilter policy.
* Standard or 802.1Q tagged Ethernet frames only.
* (Dynamic flow offload only):

  + Inspected flows that the inspection engine decides no longer need inspection. These flows include:

    - Flows handled by access control rules that apply the Trust action and are based on security zone, source and destination network
      and port matching only.
    - TLS/SSL flows that are not selected for decryption using an
      SSL policy.
    - Flows that are trusted by the Intelligent Application Bypass (IAB) policy either explicitly or due to exceeding flow bypass
      thresholds.
    - Flows that match file or intrusion policies that result in trusting the flow.
    - Any allowed flow that no longer needs to be inspected.
  + The following IPS preprocessor inspected flows:

    - SSH and SMTP.
    - FTP preprocessor secondary connections.
    - Session Initiation Protocol (SIP) preprocessor secondary connections.
  + Intrusion rules that use keywords (also referred to as *options*)

| **Important** | ---   For details, exceptions, and limitations to the above, see [Flow Offload Limitations](#concept_D380F2E170164CA699509AAF363D7862).   --- |
| --- | --- |

### Use Static Flow Offload

To offload eligible traffic to hardware, create a prefilter policy rule that applies the Fastpath action. Use prefilter rules for TCP/UDP, and tunnel rules for GRE.

(Not recommended.) To disable static flow offload and as a by-product, dynamic flow-offload,
use FlexConfig to run the no flow-offload enable  command.
For information about this command, see the Cisco ASA Series Command
Reference, available from <https://www.cisco.com/c/en/us/support/security/adaptive-security-appliance-asa-software/products-command-reference-list.html>.

### Use Dynamic Flow Offload

Dynamic flow offload is enabled by default.

To disable dynamic offload:

```
> configure flow-offload dynamic whitelist disable
```
To re-enable dynamic offload:
```
> configure flow-offload dynamic whitelist enable
```

Note that dynamic offload occurs only if static flow offload is enabled, regardless of whether prefiltering is configured.

* [Flow Offload Limitations](#concept_D380F2E170164CA699509AAF363D7862)

### Flow Offload Limitations

Not all flows can be
offloaded. Even after offload, a flow can be removed from being offloaded under
certain conditions. Following are some of the limitations:

Device Limitations

The feature is supported on the following devices:

* Firepower 4100/9300 running FXOS 1.1.3 or higher.

Flows that cannot be offloaded

The following types of flows cannot be offloaded.

* Any flows that do not use IPv4 addressing, such as IPv6 addressing.
* Flows for any protocol other than TCP, UDP, and GRE.

  | **Note** | ---   PPTP GRE connections cannot be offloaded.   --- |
  | --- | --- |
* Flows on interfaces configured in passive, inline, or inline tap mode. Routed and switched interfaces are the only types supported.
* Flows that require inspection by Snort or other inspection engines. In some cases, such as FTP, the secondary data channel can be offloaded although the control channel cannot be offloaded.
* IPsec and TLS/DTLS VPN connections that terminate on the device.
* Flows that require encryption or decryption. For example, connections decrypted due to an
  SSL policy.
* Multicast flows in routed mode. They are supported in
  transparent mode if there are only two member interfaces in a
  bridge group.
* TCP Intercept flows.
* TCP state bypass flows. You cannot configure flow offload and TCP
  state bypass on the same traffic.
* Flows tagged with security groups.
* Reverse flows that are forwarded from a different cluster node, in case of asymmetric flows in a cluster.
* Centralized flows in a cluster, if the flow owner is not the control unit.
* Flows that include IP options cannot be dynamically offloaded.

Additional Limitations

* Flow offload and Dead Connection Detection (DCD) are not compatible.
  Do not configure DCD on connections that can be offloaded.
* If more than one flow that matches flow offload conditions are queued
  to be offloaded at the same time to the same location on the
  hardware, only the first flow is offloaded. The other flows are
  processed normally. This is called a *collision*. Use the
  show flow-offload flow  command in
  the CLI to display statistics for this situation.
* Dynamic flow offload disables all TCP normalizer checks.
* Although offloaded flows pass through FXOS interfaces, statistics for these flows do not appear on the logical device interface.
  Thus, logical device interface counters and packet rates do not reflect offloaded flows.

Conditions for reversing offload

After a flow is offloaded, packets within the flow are returned to the FTD for further processing if they meet the following conditions:

* They include TCP options other than Timestamp.
* They are fragmented.
* They are subject to Equal-Cost Multi-Path (ECMP) routing, and ingress packets move from one interface to another.

## History for Prefiltering

| Feature | Minimum FMC | Minimum FTD | Details |
| --- | --- | --- | --- |
| Moving prefilter rules to an access control policy | 6.7 | Any | You can move prefilter rules from a prefilter policy to the associated access control policy.  New/modified pages: In the prefilter policy page, the right-click menu for the selected rules provides a new Move to another policy option.  Supported platforms: FMC |
| Time-based rules | 6.6 | Any | Ability to apply prefilter and tunnel rules depending on the date and time, as determined by the time zone of the FTD device.  See description in [History for Access Control Rules](access-rules.html#id_124655). |
| View Object Details from prefilter rule page | 6.6 | Any | Feature introduced: Option to view details for an object or object group when viewing prefilter rules.  New options: Right-clicking a value in any of the following columns in the prefilter rule list offers an option to view object details: Source Networks, Destination Networks, Source Port, Destination Port, and VLAN Tag.  Supported platforms: Firepower Management Center |

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)


=== Content from www.cisco.com_f1bc8d27_20250115_120511.html ===


* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Security](/c/en/us/support/security/index.html)
* [Cisco Secure Firewall Management Center](/c/en/us/support/security/defense-center/series.html)
* [Install and Upgrade Guides](/c/en/us/support/security/defense-center/products-installation-guides-list.html)
# Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [Getting Started](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting_started.html)
* [Planning Your Upgrade](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/planning.html)
* [Upgrade Firepower Management Centers](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/upgrade_firepower_management_centers.html)
* [Upgrade Firepower Threat Defense](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/upgrade_firepower_threat_defense.html)
* [Upgrade Firepower 7000/8000 Series and NGIPSv](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/upgrade_7000_8000_ngipsv.html)
* [Upgrade ASA with FirePOWER Services](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/upgrade_asa_firepower.html)
* [Uninstall a Patch](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/uninstall.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting_started.html) to Save Content

Translations

Available Languages

Download

Download Options

### Book Title Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0 Chapter Title Getting Started

* [PDF - Complete Book
  (2.68 MB)](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.pdf)
  [PDF - This Chapter (1.01 MB)](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide/getting_started.pdf)

  View with Adobe Reader on a variety of devices
* [ePub - Complete Book
  (1.16 MB)](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.epub)

  View in various apps on iPhone, iPad, Android, Sony Reader, or Windows Phone
* [Mobi - Complete Book
  (2.62 MB)](/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.mobi)

  View on Kindle device or Kindle app on multiple devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: October 11, 2019

## Chapter: Getting Started

Chapter Contents

* [Getting Started](#id_63175)
* [Is This Guide for You?](#id_64614)
* [Upgrade Feature History](#Cisco_Reference.dita_5f13fcd0-f3f0-415a-95b8-200315a8776b)

Close

# Getting Started

* [Is This Guide for You?](#id_64614)
* [Upgrade Feature History](#Cisco_Reference.dita_5f13fcd0-f3f0-415a-95b8-200315a8776b)

## Is This Guide for You?

This guide explains how to prepare for and complete a successful upgrade to
Firepower **Version 7.0.x or earlier**, for:

* Firepower Management Center (FMC)
* Firepower Threat Defense (FTD) devices with FMC, including FXOS for the
  Firepower 4100/9300
* 7000/8000 series devices with FMC
* NGIPSv devices with FMC
* ASA FirePOWER devices with FMC, including ASA OS

### Additional Resources

If you are upgrading a different platform/component, or to a different version, see one of these resources.

Table 1. Upgrade Guides for FMC

| **Current FMC Version** | **Guide** |
| --- | --- |
| 7.2+ | [Cisco Secure Firewall Threat Defense Upgrade Guide for Management Center](http://www.cisco.com/go/ftd-quick) for your version |
| 7.1 | [Cisco Firepower Threat Defense Upgrade Guide for Firepower Management Center, Version 7.1](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/upgrade/management-center/710/upgrade-fmc-710.html) |
| 7.0 or earlier | [Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.html) |

Table 2. Upgrade Guides for FTD with FMC

| **Current FMC Version** | **Guide** |
| --- | --- |
| Cloud-delivered Firewall Management Center | [Cisco Secure Firewall Threat Defense Upgrade Guide for Cloud-Delivered Firewall Management Center](https://www.cisco.com/go/ftd-cdfmc-upgrade) |
| 7.2+ | [Cisco Secure Firewall Threat Defense Upgrade Guide for Management Center](http://www.cisco.com/go/ftd-quick) for your version |
| 7.1 | [Cisco Firepower Threat Defense Upgrade Guide for Firepower Management Center, Version 7.1](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/upgrade/management-center/710/upgrade-fmc-710/upgrade-threat-defense.html) |
| 7.0 or earlier | [Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.html) |

Table 3. Upgrade Guides for FTD with FDM

| **Current FTD Version** | **Guide** |
| --- | --- |
| 7.2+ | [Cisco Secure Firewall Threat Defense Upgrade Guide for Device Manager](http://www.cisco.com/go/ftd-quick) for your version |
| 7.1 | [Cisco Firepower Threat Defense Upgrade Guide for Firepower Device Manager, Version 7.1](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/upgrade/device-manager/710/upgrade-fdm-710/upgrade-threat-defense.html) |
| 7.0 or earlier | [Cisco Firepower Threat Defense Configuration Guide for Firepower Device Manager](https://www.cisco.com/c/en/us/support/security/firepower-ngfw/products-installation-and-configuration-guides-list.html) for your version: *System Management*  For the Firepower 4100/9300, also see the FXOS upgrade instructions in [Cisco Firepower 4100/9300 Upgrade Guide, FTD 6.0.1–7.0.x or ASA 9.4(1)–9.16(x) with FXOS 1.1.1–2.10.1](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/upgrade/b_FXOSUpgrade.html). |
| Version 6.4+, with CDO | [Managing FDM Devices with Cisco Security Cloud Control](https://www.cisco.com/c/en/us/td/docs/security/cdo/managing-ftd-with-cdo/managing-ftd-with-cisco-defense-orchestrator.html) |

Table 4. Upgrade Guides for NGIPS

| **Platform** | **Current Manager Version** | **Guide** |
| --- | --- | --- |
| Firepower 7000/8000 series with FMC | 6.0.0–7.0.x | [Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.html) |
| NGIPSv with FMC | 6.0.0–7.1.x  7.2.0–7.2.5  7.3.x  7.4.0 | [Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.html) |
| 7.2.6–7.2.x  7.4.1–7.4.x | [Cisco Secure Firewall Threat Defense Upgrade Guide for Management Center](http://www.cisco.com/go/ftd-quick) for your version |
| ASA FirePOWER withFMC | 6.0.0–7.1.x  7.2.0–7.2.5  7.3.x  7.4.0 | [Cisco Firepower Management Center Upgrade Guide, Version 6.0–7.0](https://www.cisco.com/c/en/us/td/docs/security/firepower/upgrade/fpmc-upgrade-guide.html) |
| 7.2.6–7.2.x  7.4.1–7.4.x | [Cisco Secure Firewall Threat Defense Upgrade Guide for Management Center](http://www.cisco.com/go/ftd-quick) for your version |
| ASA FirePOWER with ASDM | Any | [Cisco Secure Firewall ASA Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade.html) |

Table 5. Upgrade Other Components

| **Version** | **Component** | **Guide** |
| --- | --- | --- |
| Any | ASA logical devices on the Firepower 4100/9300 | [Cisco Secure Firewall ASA Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/asa/upgrade/asa-upgrade.html) |
| Latest | BIOS and firmware for FMC | [Cisco Secure Firewall Threat Defense/Firepower Hotfix Release Notes](https://www.cisco.com/c/en/us/td/docs/security/secure-firewall/release-notes/threat-defense/hotfix/threat-defense-release-notes-hotfix.html) |
| Latest | Firmware for the Firepower 4100/9300 | [Cisco Firepower 4100/9300 FXOS Firmware Upgrade Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/fxos/firmware-upgrade/fxos-firmware-upgrade.html) |
| Latest | ROMMON image for the ISA 3000 | [Cisco Secure Firewall ASA and Secure Firewall Threat Defense Reimage Guide](https://www.cisco.com/c/en/us/td/docs/security/firepower/quick_start/reimage/asa-ftd-reimage.html) |

## Upgrade Feature History

Table 6. Version 7.0.0 Features

| **Feature** | **Details** |
| --- | --- |
| **Threat Defense Upgrade** | |
| Improved FTD upgrade performance and status reporting. | FTD upgrades are now easier faster, more reliable, and take up less disk space. A new Upgrades tab in the Message Center provides further enhancements to upgrade status and error reporting. |
| Easy-to-follow upgrade workflow for FTD devices. | A new device upgrade page (Devices > Device Upgrade) on the FMC provides an easy-to-follow wizard for upgrading Version 6.4+ FTD devices. It walks you through important pre-upgrade stages, including selecting devices to upgrade, copying the upgrade package to the devices, and compatibility and readiness checks.  To begin, use the new Upgrade Firepower Software action on the Device Management page (Devices > Device Management > Select Action).  As you proceed, the system displays basic information about your selected devices, as well as the current upgrade-related status. This includes any reasons why you cannot upgrade. If a device does not "pass" a stage in the wizard, it does not appear in the next stage.  If you navigate away from wizard, your progress is preserved, although other users with Administrator access can reset, modify, or continue the wizard.   | **Note** | You must still use System(system gear icon) > Updates to upload or specify the location of FTD upgrade packages. You must also use the System Updates page to upgrade the FMC itself, as well as all non-FTD managed devices. | | --- | --- |  | **Note** | In Version 7.0, the wizard does not correctly display devices in clusters or high availability pairs. Even though you must select and upgrade these devices as a unit, the wizard displays them as standalone devices. Device status and upgrade readiness are evaluated and reported on an individual basis. This means it is possible for one unit to appear to "pass" to the next stage while the other unit or units do not. However, these devices are still grouped. Running a readiness check on one, runs it on all. Starting the upgrade on one, starts it on all.  To avoid possible time-consuming upgrade failures, *manually* ensure all group members are ready to move on to the next step of the wizard before you click Next. | | --- | --- | |
| Upgrade more FTD devices at once. | The number of devices you can upgrade at once is now limited by your management network bandwidth—not the system's ability to manage simultaneous upgrades. Previously, we recommended against upgrading more than five devices at a time.   | **Important** | Only upgrades to FTD Version 6.7+ using the FTD upgrade wizard see this improvement. If you are upgrading devices to an older FTD release—even if you are using the new upgrade wizard—we still recommend you limit to five devices at a time. | | --- | --- | |
| Upgrade different device models together. | You can now use the FTD upgrade wizard to queue and invoke upgrades for all FTD models at the same time, as long as the system has access to the appropriate upgrade packages.  Previously, you would choose an upgrade package, then choose the devices to upgrade using that package. That meant that you could upgrade multiple devices at the same time *only* if they shared an upgrade package. For example, you could upgrade two Firepower 2100 series devices at the same time, but not a Firepower 2100 series and a Firepower 1000 series. |

Table 7. Version 6.7.0 Features

| **Feature** | **Details** |
| --- | --- |
| **Threat Defense Upgrade** | |
| Upgrades remove PCAP files to save disk space. | Upgrades now remove locally stored PCAP files. To upgrade, you must have enough free disk space or the upgrade fails. |
| Improved FTD upgrade status reporting and cancel/retry options. | You can now view the status of FTD device upgrades and readiness checks in progress on the Device Management page, as well as a 7-day history of upgrade success/failures. The Message Center also provides enhanced status and error messages.  A new Upgrade Status pop-up, accessible from both Device Management and the Message Center with a single click, shows detailed upgrade information, including percentage/time remaining, specific upgrade stage, success/failure data, upgrade logs, and so on.  Also on this pop-up, you can manually cancel failed or in-progress upgrades (Cancel Upgrade), or retry failed upgrades (Retry Upgrade). Canceling an upgrade reverts the device to its pre-upgrade state.   | **Note** | To be able to manually cancel or retry a failed upgrade, you must disable the new auto-cancel option, which appears when you use the FMC to upgrade an FTD device: Automatically cancel on upgrade failure and roll back to the previous version. With the option enabled, the device automatically reverts to its pre-upgrade state upon upgrade failure.  Auto-cancel is not supported for patches. In an HA or clustered deployment, auto-cancel applies to each device individually. That is, if the upgrade fails on one device, only that device is reverted. | | --- | --- |   New/modified screens:   * System(system gear icon) > Updates > Product Updates > Available Updates > Install icon for the FTD upgrade package * Devices > Device Management > Upgrade * Message Center > Tasks   New/modified CLI commands: show upgrade status detail , show upgrade status continuous , show upgrade status , upgrade cancel , upgrade retry |
| **Content Updates** | |
| Custom intrusion rule import warns when rules collide. | The FMC now warns you of rule collisions when you import custom (local) intrusion rules. Previously, the system would silently skip the rules that cause collisions—with the exception of Version 6.6.0.1, where a rule import with collisions would fail entirely.  On the Rule Updates page, if a rule import had collisions, a warning icon is displayed in the Status column. For more information, hover your pointer over the warning icon and read the tooltip.  Note that a collision occurs when you try to import an intrusion rule that has the same SID/revision number as an existing rule. You should always make sure that updated versions of custom rules have new revision numbers.  New/modified screens: We added a warning icon to System(system gear icon) > Updates > Rule Updates. |

Table 8. Version 6.6.0 Features

| **Feature** | **Details** |
| --- | --- |
| **Threat Defense Upgrade** | |
| Get FTD upgrade packages from an internal web server. | FTD devices can now get upgrade packages from your own internal web server, rather than from the FMC. This is especially useful if you have limited bandwidth between the FMC and its devices. It also saves space on the FMC.   | **Note** | This feature is supported only for FTD devices running Version 6.6+. It is not supported for upgrades *to* Version 6.6, nor is it supported for the FMC or Classic devices. | | --- | --- |   New/modified screens: We added a Specify software update source option to the page where you upload upgrade packages. |
| **Content Updates** | |
| Automatic VDB update during initial setup. | When you set up a new or reimaged FMC, the system automatically attempts to update the vulnerability database (VDB).  This is a one-time operation. If the FMC has internet access, we recommend you schedule tasks to perform automatic recurring VDB update downloads and installations. |

Table 9. Version 6.5.0 Features

| **Feature** | **Details** |
| --- | --- |
| **Content Updates** | |
| Automatic software downloads and GeoDB updates. | When you set up a new or reimaged FMC, the system automatically schedules:   * A weekly task to download software updates for the FMC   and its managed devices. * Weekly updates for the GeoDB.   The tasks are scheduled in UTC, which means that when they occur locally depends on the date and your specific location. Also, because tasks are scheduled in UTC, they do not adjust for Daylight Saving Time, summer time, or any such seasonal adjustments that you may observe in your location. If you are affected, scheduled tasks occur one hour “later” in the summer than in the winter, according to local time. We recommend you review the auto-scheduled configurations and adjust them if necessary. |

Table 10. Version 6.4.0 Features

| **Feature** | **Details** |
| --- | --- |
| **Management Center Upgrade** | |
| Upgrades postpone scheduled tasks. | The FMC upgrade process now postpones scheduled tasks. Any task scheduled to begin during the upgrade will begin five minutes after the post-upgrade reboot.   | **Note** | Before you begin any upgrade, you must still make sure running tasks are complete. Tasks running when the upgrade begins are stopped, become failed tasks, and cannot be resumed. | | --- | --- |   Note that this feature is supported for all upgrades *from* a supported version. This includes Version 6.4.0.10 and later patches, Version 6.6.3 and later maintenance releases, and Version 6.7.0+. This feature is not supported for upgrades *to* a supported version from an unsupported version. |
| **Content Updates** | |
| Signed SRU, VDB, and GeoDB updates. | So the system can verify that you are using the correct update files, Version 6.4+ uses *signed* updates for intrusion rules (SRU), the vulnerability database (VDB), and the geolocation database (GeoDB). Earlier versions continue to use unsigned updates.  Unless you manually download updates from the Cisco Support & Download site—for example, in an air-gapped deployment—you should not notice any difference in functionality. If, however, you do manually download and install SRU, VDB, and GeoDB updates, make sure you download the correct package for your current version.  Signed update files begin with 'Cisco' instead of 'Sourcefire,' and terminate in .sh.REL.tar instead of .sh, as follows:   * SRU:   Cisco\_Firepower\_SRU-*date*-*build*-vrt.sh.REL.tar * VDB:   Cisco\_VDB\_Fingerprint\_Database-4.5.0-*version*.sh.REL.tar * GeoDB:   Cisco\_GEODB\_Update-*date*-*build*.sh.REL.tar   We will provide both signed and unsigned updates until the end-of-support for versions that require unsigned updates. Do not untar signed (.tar) packages. If you accidentally upload a signed update to an older FMC or ASA FirePOWER device, you must manually delete it. Leaving the package takes up disk space, and also may cause issues with future upgrades. |

Table 11. Version 6.2.3 Features

| **Feature** | **Details** |
| --- | --- |
| **Device Upgrade** | |
| Copy upgrade packages to managed devices before the upgrade. | You can now copy (or push) an upgrade package from the FMC to a managed device before you run the actual upgrade. This is useful because you can push during times of low bandwidth use, outside of the upgrade maintenance window.  When you push to high availability, clustered, or stacked devices, the system sends the upgrade package to the active/control/primary first, then to the standby/data/secondary.  New/modified screens: System(system gear icon) > Updates |
| **Content Updates** | |
| FMC warns of Snort restart before VDB updates. | The FMC now warns you that Vulnerability Database (VDB) updates restart the Snort process. This interrupts traffic inspection and, depending on how the managed device handles traffic, possibly interrupts traffic flow. You can cancel the install until a more convenient time, such as during a maintenance window.  These warnings can appear:   * After you download and manually install a VDB. * When you create a scheduled task to install the VDB. * When the VDB installs in the background, such as during a   previously scheduled task or as part of a software   upgrade. |
| Deprecated: Geolocation details | In May 2022 we split the GeoDB into two packages: a country code package mapping IP addresses to countries/continents, and an IP package containing additional contextual data associated with routable IP addresses. In January 2024, we stopped providing the IP package. This saves disk space and does not affect geolocation rules or traffic handling in any way. Any contextual data is now stale, and upgrading to most later versions deletes the IP package. Options to view contextual data have no effect, and are removed in later versions. |

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)

