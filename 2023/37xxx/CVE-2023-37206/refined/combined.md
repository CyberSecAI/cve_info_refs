=== Content from security.gentoo.org_897e22ca_20250114_185615.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_ecd955a5_20250114_185615.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-22

## Security Vulnerabilities fixed in Firefox 115

Announced
July 4, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 115

#### [#CVE-2023-3482: Block all cookies bypass for localstorage](#CVE-2023-3482)

Reporter
Martin Hostettler
Impact
moderate
##### Description

When Firefox is configured to block storage of all cookies, it was still possible to store data in localstorage by using an iframe with a source of 'about:blank'. This could have led to malicious websites storing tracking data without permission.

##### References

* [Bug 1839464](https://bugzilla.mozilla.org/show_bug.cgi?id=1839464)

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37203: Drag and Drop API may provide access to local system files](#CVE-2023-37203)

Reporter
Paul Nickerson and Ameen Basha M K
Impact
moderate
##### Description

Insufficient validation in the Drag and Drop API in conjunction with social engineering, may have allowed an attacker to trick end-users into creating a shortcut to local system files. This could have been leveraged to execute arbitrary code.

##### References

* [Bug 291640](https://bugzilla.mozilla.org/show_bug.cgi?id=291640)

#### [#CVE-2023-37204: Fullscreen notification obscured via option element](#CVE-2023-37204)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using an option element by introducing lag via an expensive computational function. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832195](https://bugzilla.mozilla.org/show_bug.cgi?id=1832195)

#### [#CVE-2023-37205: URL spoofing in address bar using RTL characters](#CVE-2023-37205)

Reporter
Rohan Sharma
Impact
moderate
##### Description

The use of RTL Arabic characters in the address bar may have allowed for URL spoofing.

##### References

* [Bug 1704420](https://bugzilla.mozilla.org/show_bug.cgi?id=1704420)

#### [#CVE-2023-37206: Insufficient validation of symlinks in the FileSystem API](#CVE-2023-37206)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Uploading files which contain symlinks may have allowed an attacker to trick a user into submitting sensitive data to a malicious website.

##### References

* [Bug 1813299](https://bugzilla.mozilla.org/show_bug.cgi?id=1813299)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37209: Use-after-free in "NotifyOnHistoryReload"](#CVE-2023-37209)

Reporter
Simon Descarpentries
Impact
moderate
##### Description

A use-after-free condition existed in `NotifyOnHistoryReload` where a `LoadingSessionHistoryEntry` object was freed and a reference to that object remained. This resulted in a potentially exploitable condition when the reference to that object was later reused.

##### References

* [Bug 1837993](https://bugzilla.mozilla.org/show_bug.cgi?id=1837993)

#### [#CVE-2023-37210: Full-screen mode exit prevention](#CVE-2023-37210)

Reporter
Hafiizh
Impact
low
##### Description

A website could prevent a user from exiting full-screen mode via alert and prompt calls. This could lead to user confusion and possible spoofing attacks.

##### References

* [Bug 1821886](https://bugzilla.mozilla.org/show_bug.cgi?id=1821886)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

#### [#CVE-2023-37212: Memory safety bugs fixed in Firefox 115](#CVE-2023-37212)

Reporter
Andrew McCreight, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 114. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1750870%2C1825552%2C1826206%2C1827076%2C1828690%2C1833503%2C1835710%2C1838587)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_68e99365_20250114_185614.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1813299)
* [XML](/show_bug.cgi?ctype=xml&id=1813299)

Closed
[Bug 1813299](/show_bug.cgi?id=1813299)
(CVE-2023-37206)

Opened 2 years ago
Closed 2 years ago

# Arbitrary File read via social engineering and re-uploading directories containing symbolic links

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Arbitrary File read via social engineering and re-uploading directories containing symbolic links

## Categories

### (Core :: DOM: File, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20File#DOM%3A%20File)

DOM: File
▾

Core :: DOM: File
For bugs in the DOM Blob, DOM File and FileSystem APIs
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20File&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20File&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20File)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

116 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | [-](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix) |
| firefox113 | [-](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix) |
| firefox114 | [-](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | [+](/buglist.cgi?f1=cf_tracking_firefox115&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox111 |  | wontfix |
| firefox112 | - | wontfix |
| firefox113 | - | wontfix |
| firefox114 | - | wontfix |
| firefox115 | + | fixed |
| firefox116 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ameenbasha111, Assigned: asuth)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/75b1e0d00a677e73b24efe34917fa1e9?d=mm&size=40)  [asuth](/user_profile?user_id=151407)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/90e8173161a73c012cc62b9f3cdeede4?d=mm&size=40)  [ameenbasha111](/user_profile?user_id=719704)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1833985](/show_bug.cgi?id=1833985 "RESOLVED DUPLICATE - FileChooser traverse symlink to sensitive directory on macOS/Linux")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1274959](/show_bug.cgi?id=1274959 "RESOLVED FIXED - Do we want to support link files in HTMLInputElement - filePicker/directory upload API/blink fileSystem API?"), [676998](/show_bug.cgi?id=676998 "NEW - some xpcshell test in xpcom/tests/unit fail on Android")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1345275 "https://bugs.chromium.org/p/chromium/issues/detail?id=1345275")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1378997 "https://bugs.chromium.org/p/chromium/issues/detail?id=1378997")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main115+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-37206

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main115+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a11795188_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a11306700_75935 "2 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Symlink-POC.zip](/attachment.cgi?id=9314684)  [2 years ago](#c1)  [Ameen](/user_profile?user_id=719704)   16.63 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9314684&action=edit) |
| --- | --- | --- |
| [Symlink-FileRead.mp4](/attachment.cgi?id=9314685)  [2 years ago](#c2)  [Ameen](/user_profile?user_id=719704)   5.03 MB, video/mp4 |  | [Details](/attachment.cgi?id=9314685&action=edit) |
| [Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!](/attachment.cgi?id=9335575)  [2 years ago](#c30)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c39 "2 years ago") | [Details](/attachment.cgi?id=9335575&action=edit) | [Review](/attachment.cgi?id=9335575) |
| [advisory.txt](/attachment.cgi?id=9341325)  [2 years ago](#c43)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   203 bytes, text/plain |  | [Details](/attachment.cgi?id=9341325&action=edit) |
| [advisory.txt](/attachment.cgi?id=9341340)  [2 years ago](#c46)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   207 bytes, text/plain |  | [Details](/attachment.cgi?id=9341340&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1813299#c0)• 2 years ago |
|  | |

Hi team. While looking for Firefox File upload feature and digging more about my another report (.desktop/.symlink) download. i have found a interesting exploit which can lead you to upload Arbitrary File.

Note: Chrome Fix this issue already

Ref: <https://bugs.chromium.org/p/chromium/issues/detail?id=1345275>

Root Cause: While opening/uploading a file firefox follows the symbolic link which allows to upload arbitrary file (many of the user doen't aware about the symbolic link so major of the victim will fall on this.)

Mac also support the symblink so i hope the same is vulnerable on Mac too.

POC:

1. Open the Html file
2. unzip the downloaded file.
3. Upload the folder
4. Boom Some other arbitrary files are uploaded.

Note: I have attached the POC files used in the Video (Also attached the POC Video)

In the POC Video i have shown the same with chrome. which was already fixed.

Flags: sec-bounty?

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1813299#c1)• 2 years ago |
|  | |

Attached file
[Symlink-POC.zip](attachment.cgi?id=9314684)
— [Details](attachment.cgi?id=9314684&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1813299#c2)• 2 years ago |
|  | |

Attached video
[Symlink-FileRead.mp4](attachment.cgi?id=9314685)
— [Details](attachment.cgi?id=9314685&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1813299#c3)• 2 years ago |
|  | |

FYI: the .wave folder contains the files which has symblink to the victim machine. so uploading the folder uploads the symlink mapped files recursively.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a179323_1689)• 2 years ago |

Group: firefox-core-security → core-securityComponent: Security → DOM: FormsProduct: Firefox → CoreSee Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1345275>,
<https://bugs.chromium.org/p/chromium/issues/detail?id=1378997>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a179339_1689)• 2 years ago |

Group: core-security → dom-core-security

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1813299#c4)• 2 years ago |
|  | |

Still the issue is not assigned to any of the developers/assignee. Kindly assign it to respective teams for quick fix on this

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a407632_1689)• 2 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1813299#c5)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

It is still in unassigned state, can we get this assigned to developers.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1813299#c6)• 2 years ago |
|  | |

Sounds like a file/folder picker's issue under `widget/` (I recalled [bug 271732](/show_bug.cgi?id=271732 "VERIFIED FIXED - COMMAND.COM is overwritten by downloading the pif file")).

Component: DOM: Forms → Widget: Win32

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a985325_456485)• 2 years ago |

Severity: -- → S3Priority: -- → P3Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][win:security]

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1813299#c7)• 2 years ago |
|  | |

This is not a Windows issue, or at least the provided POC doesn't apply on Windows (and not just for trivial reasons like "the paths referenced in these symlinks don't exist"). The Windows shell's built-in ZIP extractor discards the symbolic-link nature of these files and turns them into flat text.

(Windows *does* support symlinks, but by default, you need elevated permissions to create them, and anyway having those permissions does not change the built-in extractor's behavior. I believe 7Zip will create symlinks if you have permissions, but *these* symlinks are detected as dangerous and not created.)

Forwarding on to **DOM: File**, in the hopes of a cross-platform solution.

Component: Widget: Win32 → DOM: FileWhiteboard: [reporter-external] [client-bounty-form] [verif?][win:security] → [reporter-external] [client-bounty-form] [verif?]

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a1010099_699639)• 2 years ago |

Severity: S3 → --Priority: P3 → --

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1813299#c8)• 2 years ago |
|  | |

To avoid confusions on your end. This will not applicable on windows platform.

it Will be applicable to linux (ubuntu, kali linux etc)based environments and Mac OS

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1813299#c9)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Hi guys is there any progress update on this? that is Fix is already started?

|  | [Jari Jalkanen](/user_profile?user_id=689836) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a2097842_689836)• 2 years ago |

Severity: -- → S1
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%3F)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%3F)Priority: -- → P1

|  | [Jari Jalkanen](/user_profile?user_id=689836) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a2097978_689836)• 2 years ago |

Severity: S1 → S2
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%3F) → ---
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%3F) → ---Priority: P2 → --

|  | [Jari Jalkanen](/user_profile?user_id=689836) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1813299#c10)• 2 years ago |
|  | |

[Tracking Requested - why for this release]:

[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%3F)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%3F)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a2110070_151407)• 2 years ago |

Flags: needinfo?(bugmail)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a2185291_695136)• 2 years ago |

[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1813299#c11)• 2 years ago |
|  | |

The bug is marked as tracked for firefox111 (beta) and tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in 14 days. However, the bug still isn't assigned.

:jstutte, could you please find an assignee for this tracked bug? If you disagree with the tracking decision, please talk with the release managers.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#tracked_attention.py).

Flags: needinfo?(jstutte)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1813299#c12)• 2 years ago |
|  | |

Andrew will come up with a plan here.

Flags: needinfo?(jstutte)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1813299#c13)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox111 (beta) and tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in 8 days. However, the bug still isn't assigned.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1813299#c14)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox111 (beta) and tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in 7 days. However, the bug still isn't assigned.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1813299#c15)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1813299&comment_id=16308120 "1 revision") |
|  | |

The tl;dr general situation here is:

* [GetFilesHelper](https://searchfox.org/mozilla-central/source/dom/filesystem/GetFilesHelper.cpp) will intentionally include symlinks both when specifically selected and when recursively walking a directory.
  + We intentionally enabled this in [bug 1274959](/show_bug.cgi?id=1274959 "RESOLVED FIXED - Do we want to support link files in HTMLInputElement - filePicker/directory upload API/blink fileSystem API?") with :smaug I think making the policy decision in [bug 1274959 comment 1](/show_bug.cgi?id=1274959#c1 "RESOLVED FIXED - Do we want to support link files in HTMLInputElement - filePicker/directory upload API/blink fileSystem API?").
  + The bug did [add logic to avoid creating infinite loops when it relates to symlink traversal of directories](https://searchfox.org/mozilla-central/rev/f7edb0b474a1a922f3285107620e802c6e19914d/dom/filesystem/GetFilesHelper.cpp#379).
  + Recursive directory traversal also does not pay attention to conventions about dot-files potentially being hidden.
* Our File/Blob abstractions as returned by the directory picker create the stream without passing `O_NOFOLLOW` or otherwise doing anything that would cause an error when we read the contents of the File. We have no ability/desire to expose "hey, this is a symlink" to content via spec semantics.
* The general attack model described in this bug:
  + Convince a user to extract an archive which includes symlinks inside a directory hierarchy.
  + Convince the user to then upload the portion of the hierarchy that includes the symlinks, which we will traverse. Because the symlink can point to anywhere on any path that is accessible to the user running the parent process (modulo some safeguards we have around UNC paths, I think), this can read a lot of potentially sensitive files.

The general options we have here to change the current situation are:

1. Do not expose symlinks ever. Skip them in directory enumeration, do not let the user pick them individually.
2. Do let the user pick them individually, but skip them in directory enumeration.
3. Only allow symlinks that point within the directory tree that was selected, but as noted, we don't provide the ability to expose metadata about it being a symlink, so this is not particularly useful.
4. Do not expose the contents of the targets of symlinks but display something useless like "this is a symlink to /PATH", which potentially still would include private data.
5. Add a bunch of user prompting that will be hard to explain and where the development is unlikely to happen because it involves touching a lot of things.

:smaug, what are your current views on supporting symlinks given the threat possibilities here?

:dveditz, do we have an existing set of threat models about symlinks and user intent versus social engineering, etc.?

Flags: needinfo?(smaug)Flags: needinfo?(dveditz)Flags: needinfo?(bugmail)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1813299#c16)• 2 years ago |
|  | |

There is also option 6, to keep the current behavior. That is probably least surprising to the users (browser's file picking working like it works in other applications).

1 or 2 maybe. But those are data loss issues. User trying to select a directory, but not all its content is selected after all.

But I guess it could be 1.

(I don't understand what 3 means)

Flags: needinfo?(smaug)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1813299#c17)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1813299&comment_id=16309006 "1 revision") |
|  | |

FWIW [chrome opted for 2](https://chromium.googlesource.com/chromium/src/%2B/4fa830d8af6b2fb293219edeb39eebccfd322305), IIUC. So if the user clicks explicitly on a single file, it will always be uploaded, but for folders symlinks are always ignored, be they pointing to folders or files. I assume (but did not check) that this implies to follow the symlink if the picked folder itself is one. I can understand that as a compromise that respects the explicit choice of the user but avoids implicit surprises.

I read 3 as: Like 2 but only if the symlink points somewhere outside the selected folder. In terms of uploaded data this would actually double the payload for symlinks that point inside our folder, I fear, so probably not really wanted.

4 is a bit like the default behavior of tar on a folder that contains symlinks (though zip follows them by default, I think). Hard to say how surprising this would be to a normal linux user - at least it would give the chance to see what happened a posteriori in the uploaded data and not just silently omit files. In terms of uploaded file content this would be equivalent to 2, we just add the information of there being symlinks.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1813299#c18)• 2 years ago |
|  | |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox111 (beta) and tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in 6 days. However, the bug still isn't assigned.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a2960336_1689)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) → ---See Also: → [1274959](/show_bug.cgi?id=1274959 "RESOLVED FIXED - Do we want to support link files in HTMLInputElement - filePicker/directory upload API/blink fileSystem API?")

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1813299#c19)• 2 years ago |
|  | |

(In reply to Olli Pettay [:smaug][bugs@pettay.fi] from [comment #16](/show_bug.cgi?id=1813299#c16 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links"))

> There is also option 6, to keep the current behavior. That is probably least surprising to the users (browser's file picking working like it works in other applications).

(Note: I recognize you are not advocating for this option, just filling out the list of options; I did not include the status quo option because I was only listing changes, but I agree that it's an option, just a bad one.)

Least surprising I think presumes all users know about symlinks and actively include them in their mental model. I think if we did a user research study, most users would be surprised that the following sequence would allow an attacker to be able to read arbitrary files of their choosing outside of the directory the user selected to upload.

1. Download a file archive.
2. Extract the file archive.
3. Select the directory for upload via file picker.

> 1 or 2 maybe. But those are data loss issues. User trying to select a directory, but not all its content is selected after all.
>
> But I guess it could be 1.

You're right that the above set of steps is data-lossy versus the user re-archiving the contents of the directory. But the reality is that the File API does not expose the full set of file metadata exposed by the operating system, just the MIME type. (It is also the case that [FileSystemEntry](https://searchfox.org/mozilla-central/source/dom/webidl/FileSystemEntry.webidl) does not expose anything that can convey symlink-ness.) We could of course attempt to convey the symlink nature via the MIME type, but the [IANA media type assignments list](https://www.iana.org/assignments/media-types/media-types.xhtml) doesn't seem to actually have a type for symlinks that I can see.

I should note that [File System Access WICG proposal which we explicitly do not implement](https://wicg.github.io/file-system-access/) also does not have any mechanism for exposing symlink metadata, although [section 5.1: Users giving access to more, or more sensitive files than they intended](https://wicg.github.io/file-system-access/#privacy-wide-access) does explicitly make mention of the potential magic of ".lnk" files on windows is interesting.

> (I don't understand what 3 means)

Jens parsed this consistent with what I was trying to convey; we could distinguish between symlinks pointing within the directory sub-tree that the user has selected from those that point outside it. But as Jens points out, sending a second copy of data if we follow the symlink is not particularly useful. And if we expose the path of the symlink, there is some additional potential for revealing information that the user might not have intended to reveal; like if the symlink was created by the user, exposing the path may expose information about the layout of their filesystem which could be useful for subsequent attacks via different mechanisms.

I briefly looked at git/github for prior art:

* git explicitly has a concept of symbolic links; the [index format](https://git-scm.com/docs/index-format) has a specific object type encoding for "sybolic link"; there is a 9-bit unix permission field, but 0 is explicitly used for symlinks (and only `0755 and 0644` are valid otherwise).
* github makes a point to not serve as a CDN, so we can't see what MIME type it might use, but interestingly [their API does have specific behavior for symlinks](https://docs.github.com/en/rest/repos/contents?apiVersion=2022-11-28#if-the-content-is-a-symlink) of resolving links within the repo and serving up the path if it's not inside the repo. The threat model of that case is of course extremely different, although it's worth noting that people regularly mess up and commit private/privileged data to git they did not intend to commit!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1813299#c20)• 2 years ago |
|  | |

Option 2 from [comment 15](/show_bug.cgi?id=1813299#c15 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links") is safe enough and most consistent with both Safari and Chrome. Both browsers allow the initial pick to be a symlink to somewhere else, but silently ignore any symlink found within it. In terms of standard unix utility behavior

* Option 1 is like `find -P DIR -type f`
* Option 2 is like `find -H DIR -type f` (Safari's current behavior; my Chrome isn't recursing at all as if it had a `-maxdepth 1` term added)
* our current behavior is `find -L DIR -type f`

For the average user who has no idea what a symlink is this will avoid unexpected and unsafe surprises, while avoiding mysterious failures if they happen to pick a location that was symlinked elsewhere by their admin or a program they use. Power users who have symlinked files they'd like to upload will be able to figure out workarounds. It's a reasonable tradeoff, as Jens noted in [comment 17](/show_bug.cgi?id=1813299#c17 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")

What about single file uploads? You could try to argue similarly that bad things still happen if you can convince a user to upload a specific one of the booby-trapped symlinks from the original expanded archive. I really can't buy it. Why would someone re-upload a file they just downloaded that they've never opened? I didn't find the original "upload a just-downloaded directory" attack all that plausible, but maybe there's a chance it could happen. If there's a lot of files, and most were as expected, users probably didn't check each one. With a single file I just can't believe a user is going to re-upload without checking. If they naive enough to do that I can't believe they would have anything at a predictable location that's worth stealing (for example, ssh keys, AWS or other cloud tokens, etc). They'd have a Firefox profile full of cookies and such, but this kind of scenario is exactly why our profile directories have a good chunk of randomness in the name.

I really wish this feature had had a mature specification before everyone started implementing it in non-compatible ways.

Flags: needinfo?(dveditz)Summary: Arbitrary File read Via Symbolic Link Following → Arbitrary File read via social engineering and re-uploading directories containing symbolic links

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1813299#c21)• 2 years ago |
|  | |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in 3 days. However, the bug still isn't assigned.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1813299#c22)• 2 years ago |
|  | |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in 2 days. However, the bug still isn't assigned.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1813299#c23)• 2 years ago |
|  | |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is in a day. However, the bug still isn't assigned.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1813299#c24)• 2 years ago |
|  | |

This is a reminder regarding [comment #11](/show_bug.cgi?id=1813299#c11 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links")!

The bug is marked as tracked for firefox112 (nightly). We have limited time to fix this, the soft freeze is today. However, the bug still isn't assigned.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a3853007_151407)• 2 years ago |

Assignee: nobody → bugmailStatus: NEW → ASSIGNED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1813299#c25)• 2 years ago |
|  | |

Too late for 112 at this point with it going to RC on Monday. Let's aim for 113 instead.

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)
[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1813299#c26)• 2 years ago |
|  | |

Hi Andrew, do we have an ETA on this? We have 2 weeks until 113 goes to RC.

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1813299#c27)• 2 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #26](/show_bug.cgi?id=1813299#c26 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links"))

> Hi Andrew, do we have an ETA on this? We have 2 weeks until 113 goes to RC.

This is probably 3-4 weeks out at this point due to its relative priority and an imminent team meet-up.

Flags: needinfo?(bugmail)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a7031042_75935)• 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=-)
[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=-)
[tracking-firefox114](/buglist.cgi?f1=cf_tracking_firefox114&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a9907656_1689)• 2 years ago |

Duplicate of this bug: [1833985](/show_bug.cgi?id=1833985 "RESOLVED DUPLICATE - FileChooser traverse symlink to sensitive directory on macOS/Linux")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1813299#c29)• 2 years ago |
|  | |

The chrome bugs are public and we're picking up duplicates. No point to keep hidden.

Group: dom-core-security

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1813299#c30)• 2 years ago |
|  | |

Attached file
[Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!](attachment.cgi?id=9335575)
— [Details](attachment.cgi?id=9335575&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1813299#c31)• 2 years ago |
|  | |

Pushed by bugmail@asutherland.org:
<https://hg.mozilla.org/integration/autoland/rev/0eb72829d870>
Filter out symlinks for webkitdirectory. r=smaug

|  | [Iulian Moraru](/user_profile?user_id=682863) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1813299#c32)• 2 years ago |
|  | |

Backed out for causing failures on test\_basic.html.

* [Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=Gzhb0t5nTfSXyY5lFijKzg.0&resultStatus=pending%2Crunning%2Csuccess%2Ctestfailed%2Cbusted%2Cexception%2Crunnable&searchStr=mochitest-plain&revision=0eb72829d870e4195b514311cde774efe99be491)
* [Failure log](https://treeherder.mozilla.org/logviewer?job_id=417664965&repo=autoland&lineNumber=2092)
* [Backout link](https://hg.mozilla.org/integration/autoland/rev/4837e753ce74c803feb39ca95c79311d8b7b5948)

```
[task 2023-05-31T16:08:20.673Z] 16:08:20     INFO -  TEST-START | dom/filesystem/tests/test_basic.html
[task 2023-05-31T16:14:43.745Z] 16:14:43     INFO -  wait for org.mozilla.geckoview.test_runner complete; top activity=org.mozilla.geckoview.test_runner
[task 2023-05-31T16:14:43.745Z] 16:14:43     INFO -  org.mozilla.geckoview.test_runner unexpectedly found running. Killing...
[task 2023-05-31T16:14:56.960Z] 16:14:56  WARNING -  TEST-UNEXPECTED-FAIL | dom/filesystem/tests/test_basic.html | application timed out after 370 seconds with no output
[task 2023-05-31T16:14:56.960Z] 16:14:56     INFO -  runtestsremote.py | Application ran for: 0:06:40.886368
[task 2023-05-31T16:14:57.031Z] 16:14:57     INFO -  Stopping web server
[task 2023-05-31T16:14:57.034Z] 16:14:57     INFO -  Server shut down.
[task 2023-05-31T16:14:57.054Z] 16:14:57     INFO -  Web server killed.
[task 2023-05-31T16:14:57.055Z] 16:14:57     INFO -  Stopping web socket server
[task 2023-05-31T16:14:57.075Z] 16:14:57     INFO -  Stopping ssltunnel
[task 2023-05-31T16:14:57.095Z] 16:14:57     INFO -  runtests.py | Running tests: end.
[task 2023-05-31T16:14:57.289Z] 16:14:57     INFO -  Buffered messages finished
[task 2023-05-31T16:14:57.289Z] 16:14:57     INFO -  Running manifest: dom/manifest/test/mochitest.ini
[task 2023-05-31T16:14:57.491Z] 16:14:57     INFO -  runtests.py | Failed to copy /builds/worker/workspace/build/tests/mochitest/hyphenation to profile
[task 2023-05-31T16:14:57.613Z] 16:14:57     INFO -  PID 3247 | pk12util: PKCS12 IMPORT SUCCESSFUL
[task 2023-05-31T16:14:57.675Z] 16:14:57     INFO -  MochitestServer : launching ['/builds/worker/workspace/build/hostutils/host-utils-108.0a1.en-US.linux-x86_64/xpcshell', '-g', '/builds/worker/workspace/build/hostutils/host-utils-108.0a1.en-US.linux-x86_64', '-f', '/builds/worker/workspace/build/hostutils/host-utils-108.0a1.en-US.linux-x86_64/components/httpd.js', '-e', "const _PROFILE_PATH = '/tmp/tmp3_3oyspp.mozrunner'; const _SERVER_PORT = '8854'; const _SERVER_ADDR = '10.0.2.2'; const _TEST_PREFIX = undefined; const _DISPLAY_RESULTS = false;", '-f', '/builds/worker/workspace/build/tests/mochitest/server.js']
[task 2023-05-31T16:14:57.675Z] 16:14:57     INFO -  runtests.py | Server pid: 3256
[task 2023-05-31T16:14:57.678Z] 16:14:57     INFO -  runtests.py | Websocket server pid: 3259
[task 2023-05-31T16:14:57.682Z] 16:14:57     INFO -  runtests.py | SSL tunnel pid: 3263
[task 2023-05-31T16:14:57.733Z] 16:14:57     INFO -  use http3 server: 0
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running with scheme: http
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running with e10s: True
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running with fission: True
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running with cross-origin iframes: False
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running with serviceworker_e10s: True
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running with socketprocess_e10s: False
[task 2023-05-31T16:14:57.913Z] 16:14:57     INFO -  runtests.py | Running tests: start.
[task 2023-05-31T16:14:57.955Z] 16:14:57     INFO -  adb Granting important runtime permissions to org.mozilla.geckoview.test_runner
[task 2023-05-31T16:14:59.163Z] 16:14:59     INFO -  adb launch_application: am start -W -n org.mozilla.geckoview.test_runner/org.mozilla.geckoview.test_runner.TestRunnerActivity -a android.intent.action.MAIN --es env0 MOZ_CRASHREPORTER_NO_REPORT=1 --es env1 MOZ_CRASHREPORTER=1 --es env2 MOZ_CRASHREPORTER_SHUTDOWN=1 --es env3 MOZ_DISABLE_NONLOCAL_CONNECTIONS=1 --es env4 MOZ_IN_AUTOMATION=1 --es env5 R_LOG_LEVEL=6 --es env6 R_LOG_DESTINATION=stderr --es env7 R_LOG_VERBOSE=1 --es env8 XPCOM_DEBUG_BREAK=stack --es env9 MOZ_UPLOAD_DIR=/data/local/tmp/test_root/mozlog --es env10 MOZ_HIDE_RESULTS_TABLE=1 --es arg0 -no-remote --es arg1 -profile --es arg2 /data/local/tmp/test_root/profile/ --ez use_multiprocess True -d 'http://mochi.test:8888/tests?autorun=1&closeWhenDone=1&logFile=%2Fdata%2Flocal%2Ftmp%2Ftest_root%2Flogs%2Fmochitest.log&fileLevel=INFO&consoleLevel=INFO&hideResultsTable=1&manifestFile=tests.json&dumpOutputDirectory=%2Fdata%2Flocal%2Ftmp%2Ftest_root&ignorePrefsFile=ignorePrefs.json'
[task 2023-05-31T16:15:00.287Z] 16:15:00     INFO -  runtestsremote.py | Application pid: 4952
[task 2023-05-31T16:15:02.472Z] 16:15:02     INFO -  TEST-START | dom/manifest/test/test_ImageObjectProcessor_purpose.html

```
Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1813299#c33)• 2 years ago |
|  | |

Ah, so the symlink test won't work on android, but the canary test I used [xpcom/tests/unit/test\_symlinks.js](https://searchfox.org/mozilla-central/source/xpcom/tests/unit/test_symlinks.js) had misleading information about where it runs exposed on searchfox:

Searchfox says:

> This test gets skipped with pattern: `os == "win"`

The [actual content in the ini file has a fail-if line that searchfox does not expose](https://searchfox.org/mozilla-central/rev/f5dde549cca5193743d11daa1c5f08258bee9d42/xpcom/tests/unit/xpcshell.ini#51-55), whoops!:

```
[test_symlinks.js]
# Creating a symlink requires admin or developer mode on Windows.
skip-if = os == "win"
# Bug 676998: test fails consistently on Android
fail-if = os == "android"

```

I filed [bug 1836639](/show_bug.cgi?id=1836639 "NEW - Expose manifest.ini conditional annotations beyond \"skip-if\" like \"run-if\" and \"fail-if\" test information via searchfox test info boxes") on the searchfox enhancement to address this oversight. For this bug I will be expanding the exclusion for where we try to create symlinks to also skip doing so on android since it's not particularly important to the coverage and is consistent with our other symlink coverage. (Although the choice of "fail-if" is a little weird since it still tries to run the test, but it expects it to fail.) I am also adding a see-also from this bug to [bug 676998](/show_bug.cgi?id=676998 "NEW - some xpcshell test in xpcom/tests/unit fail on Android") associated with the fail-if above in case someone does something to address that bug and the changes there could be relevant to the testing in this bug.

I will re-needinfo myself to land this after the tree re-opens.

Flags: needinfo?(bugmail)See Also: → [676998](/show_bug.cgi?id=676998 "NEW - some xpcshell test in xpcom/tests/unit fail on Android")

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1813299#c34)• 2 years ago |
|  | |

Pushed by bugmail@asutherland.org:
<https://hg.mozilla.org/integration/autoland/rev/70255c96976d>
Filter out symlinks for webkitdirectory. r=smaug

|  | [Natalia Csoregi [:nataliaCs]](/user_profile?user_id=600555) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1813299#c35)• 2 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/70255c96976d>

Status: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 116 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1813299#c36)• 2 years ago |
|  | |

Since nightly and release are affected, beta will likely be affected too.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#missing_beta_status.py).

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a11306700_75935)• 2 years ago |

[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[tracking-firefox114](/buglist.cgi?f1=cf_tracking_firefox114&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=-)
[tracking-firefox115](/buglist.cgi?f1=cf_tracking_firefox115&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox115&o1=equals&v1=%2B)
[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)Flags: in-testsuite+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1813299#c37)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:asuth, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox115` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1813299#c38)• 2 years ago |
|  | |

Comment on [attachment 9335575](/attachment.cgi?id=9335575 "Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!") [[details]](/attachment.cgi?id=9335575&action=edit "Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!")

[Bug 1813299](/show_bug.cgi?id=1813299 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links") - Filter out symlinks for webkitdirectory. r=smaug!

### Beta/Release Uplift Approval Request

* **User impact if declined**: The concern with this bug is that a user who has been socially engineered to extract an archive on linux or OS X containing hostile symlinks and then to select a directory for upload via a form element/drag-and-drop could expose the contents of sensitive files on their hard disk that they did not think they were exposing with the actions they were taking.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This change is limited to our handling of symlinks and makes our code do less in general in a straightforward way. This change makes us conform to Chrome/Blink and Safari/Webkit's behavior and so we're not particularly concerned about there being weird use-cases out there that would break. (And to be clear, we intentionally do not want to support any weird use-cases that break.)

That said, it's not a major problem for this to just ride the trains, but it could be nice for this to be on ESR for consistency reasons.

* **String changes made/needed**:
* **Is Android affected?**: Yes
Flags: needinfo?(bugmail)
[Attachment #9335575](/attachment.cgi?id=9335575&action=edit "Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!") -
Flags: approval-mozilla-beta?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1813299#c39)• 2 years ago |
|  | |

Comment on [attachment 9335575](/attachment.cgi?id=9335575 "Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!") [[details]](/attachment.cgi?id=9335575&action=edit "Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!")

[Bug 1813299](/show_bug.cgi?id=1813299 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links") - Filter out symlinks for webkitdirectory. r=smaug!

Approved for 115.0b3.

[Attachment #9335575](/attachment.cgi?id=9335575&action=edit "Bug 1813299 - Filter out symlinks for webkitdirectory. r=smaug!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1813299#c40)• 2 years ago |
| bugherder uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/994292710c9d>

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1813299#c41)• 2 years ago |
|  | |

Hi Mates i hope you all doing well, is this planned to released in 115 (or) 116?

Kindly confirm.

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1813299#c42)• 2 years ago |
|  | |

(In reply to Ameen from [comment #41](/show_bug.cgi?id=1813299#c41 "RESOLVED FIXED - Arbitrary File read via social engineering and re-uploading directories containing symbolic links"))

> Hi Mates i hope you all doing well, is this planned to released in 115 (or) 116?
>
> Kindly confirm.

This landed during the Fx116 cycle but was uplifted and will be released with Fx115

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a11795188_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a12997204_586683)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main115+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1813299#c43)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341325) (obsolete)
— [Details](attachment.cgi?id=9341325&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1813299#c44)• 2 years ago |
|  | |

Hi Jason Kratzer My name is mentioned as Ameen Basha instead of Ameen Basha M K.

Previous CVE's of mine are addressed as Ameen Basha M K. Kindly change it.

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1813299#c45)• 2 years ago |
|  | |

Certainly! Thank you for letting me know!

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1813299#c46)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341340)
— [Details](attachment.cgi?id=9341340&action=edit)

[Attachment #9341325](/attachment.cgi?id=9341325&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a13090088_578488)• 2 years ago |

Alias: CVE-2023-37206

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813299#a42206710_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1813299&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Ameen](/user_profile?user_id=719704)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


