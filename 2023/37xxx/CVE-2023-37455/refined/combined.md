=== Content from bugzilla.mozilla.org_3778aa99_20250114_200340.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1786934)
* [XML](/show_bug.cgi?ctype=xml&id=1786934)

Closed
[Bug 1786934](/show_bug.cgi?id=1786934)
(CVE-2023-37455)

Opened 2 years ago
Closed 2 years ago

# In Firefox on iOS, the permission request prompt from the site in the background tab is overlaid on top of the site in the foreground tab.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

In Firefox on iOS, the permission request prompt from the site in the background tab is overlaid on top of the site in the foreground tab.

## Categories

### (Firefox for iOS :: General, defect, P2)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=General#General)

General
▾

Firefox for iOS :: General
For bugs that don't fit into other components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Other

iOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [115](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=115) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 115 |  |

## People

### (Reporter: lmarceau, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7fb2b1922d97306f98551a6d1db2768a?d=mm&size=40)  [lmarceau](/user_profile?user_id=694570)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/13363 "https://github.com/mozilla-mobile/firefox-ios/pull/13363")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-37455

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a28339798_1689 "1 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [PoC 1786934.PNG](/attachment.cgi?id=9291625)  [2 years ago](#c2)  [lmarceau](/user_profile?user_id=694570)   177.26 KB, image/png |  | [Details](/attachment.cgi?id=9291625&action=edit) |
| --- | --- | --- |
| [PoC 1786934-2.PNG](/attachment.cgi?id=9291816)  [2 years ago](#c3)  [lmarceau](/user_profile?user_id=694570)   166.52 KB, image/png |  | [Details](/attachment.cgi?id=9291816&action=edit) |
| [RPReplay\_Final1686317789.MP4](/attachment.cgi?id=9339165)  [2 years ago](#c13)  [lmarceau](/user_profile?user_id=694570)   5.79 MB, video/mp4 |  | [Details](/attachment.cgi?id=9339165&action=edit) |
| [POC from reporter's site](/attachment.cgi?id=9340574)  [2 years ago](#c14)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   945 bytes, text/html |  | [Details](/attachment.cgi?id=9340574&action=edit) |
| ["second.html" required by first stage of the POC](/attachment.cgi?id=9340584)  [2 years ago](#c15)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   1.46 KB, text/html |  | [Details](/attachment.cgi?id=9340584&action=edit) |
| [advisory.txt](/attachment.cgi?id=9342257)  [2 years ago](#c21)  [lmarceau](/user_profile?user_id=694570)   195 bytes, text/plain |  | [Details](/attachment.cgi?id=9342257&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1786934#c0)• 2 years ago |
|  | |

Originated from bug report <https://bugzilla.mozilla.org/show_bug.cgi?id=1784741>

### Vulnerabilities related to T6

T6-1 : In Firefox on iOS, the permission request prompt from the site in the background tab is overlaid on top of the site in the foreground tab. The permission types in which this vulnerability exists are shown in Table VIII. This vulnerability realizes the Permission-based Phishing Attack shown below. This vulnerability can be exploited in a serious attack that threatens user privacy.

### Permission-based Phishing Attack

In a Permission-based Phishing Attack, an attacker compels the target to mistakenly grant access to a resource by presenting a fake permission request. For details on this attack, refer to Sections V-B and VI-B of our paper.

Proof-of-concept Code

We share a proof-of-concept code for overlay of permission request prompts.

<https://drive.google.com/drive/folders/1OCA3qSmx-lB-pQB30ky62Xmoi_2BYV4z?usp=sharing>

You can try the overlay of the permission request prompt by installing this PoC code on a server on an HTTPS domain.

In particular, open index.html, click on the "Open a New Tab" link, and wait for about 20 seconds.

Then you will see a permission request prompt from the domain where index.html is located on the site "example.com" which is opened in a new tab.

We also prepared a website with PoC installed on our server.

<https://pocforshare.com/77cxk/index.html>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a8588_1689)• 2 years ago |

Group: partner-confidential

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1786934#c1)• 2 years ago |
|  | |

Laurie: this is a background tab requesting a permission, popping up on top of another tab. This rings a bell and we may have a duplicate for this (or maybe someone filed one on Android in the past that we fixed).

Flags: needinfo?(lmarceau)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a93067_694570)• 2 years ago |

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1786934#c2)• 2 years ago |
|  | |

Attached image
[PoC 1786934.PNG](attachment.cgi?id=9291625)
— [Details](attachment.cgi?id=9291625&action=edit)

I can reproduce this issue with the provided PoC.

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1786934#c3)• 2 years ago |
|  | |

Attached image
[PoC 1786934-2.PNG](attachment.cgi?id=9291816)
— [Details](attachment.cgi?id=9291816&action=edit)

Ideally would not show if the webview isn't active.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1786934#c4)• 2 years ago |
|  | |

The severity field is not set for this bug.

:jeevans, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(jeevans)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a7874413_694570)• 2 years ago |

Priority: -- → P2

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1786934#c5)• 2 years ago |
|  | |

Opened a [PR](https://github.com/mozilla-mobile/firefox-ios/pull/13363/files) to fix the issue. It implements `requestMediaCapturePermissionFor` to check if we're the current tab. If it's not the current tab, then the media prompt won't show. This means the media prompt is not going to show on top of another tab when the prompt is requested from a background tab.

Flags: needinfo?(jeevans)

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1786934#c6)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1786934&comment_id=16305654 "1 revision") |
|  | |

Hello, Laurie thanks for all the information.

As the information is pretty old, I also checked the pictures and all the messages, and here are my findings:

#### 1. I was able to trigger the **`Allow "pocforshare.com" to use your microphone`** - on an older build like v109.

##### On the latest build **v9000 (29027)** I had a weird case:

##### - I opened <https://pocforshare.com/77cxk/index.html> -> Open a New tab -> Wait for the 20s the prompt is correctly displayed -> Close all the tabs and reach the home-scree -> <https://pocforshare.com/77cxk/index.html/second> appeared there -> upon accessing that link the **`Allow "pocforshare.com" to use your microphone`** was displayed again, and even when pressing `Don't Allow` when accessing that site, it will appear over and over again. Here is the [video](https://drive.google.com/file/d/1psov4dDv5aI4PDyHoU2KoJB70VfP5vAL/view?usp=share_link) In the video you see here, I already tapped on Don't allow so that's why it doesn't appear when opening a new tab.

#### 2. On **v9000 (29027)** latest nightly build I was able to trigger the correct prompt **`"Firefox Beta" Would Like to Access the Microphone Firefox uses your microphone to record and upload audio.`**

##### Here I had 2 cases:

##### -Tapping `Don't Allow` the prompt is dismissed and even with restarts never appeared again.

##### -Tapping `OK` the prompt is dismissed and it was never displayed again.

###### I used: iPhone 13 Pro (15.7.1), iPad mini 5 (14.7), and iPhone 14 (16.1).

I would say if the weird case on the 1. is related only to how our website for the test was made, we can close this one as I verified everything.

@Laurie please let me know if there is something else to test or maybe other websites, I also checked on Chrome, and Safari but there is no prompt displayed with our test website after the 20s so for sure they have nothing implemented.

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1786934#c7)• 2 years ago |
|  | |

Thanks Andrei. I'll have a look into the case you noted there. My expectation would be that the second prompt (which is only for the website `pocforshare.com` with the prompt `Allow "pocforshare.com" to use your microphone`) would show only when we are on the website `pocforshare.com`, and not shown on top of another tab. I see in your video the prompt appears on top of the homepage (it appears on the correct tab, but navigation to homepage happened afterwards it seems) - I'll have a look into that as this isn't great. The "pocforshare.com" prompt should only show on the "pocforshare.com" website.

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1786934#c8)• 2 years ago |
|  | |

Opened [PR](https://github.com/mozilla-mobile/firefox-ios/pull/14418) to improve not showing on homepage.

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1786934#c9)• 2 years ago |
|  | |

Hello, Laurie, please note that the website used for testing is not working anymore can you help with this please?

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a24780919_694570)• 2 years ago |

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1786934#c10)• 2 years ago |
|  | |

:nomotokazuki Since you originally reported the problem, wondering if it would be possible to have the [PoC website](https://pocforshare.com/77cxk/index.html) available again? That would enable us to test the fix more easily. Thank you for your time!

Flags: needinfo?(nomotokazuki)

|  | [Kazuki Nomoto](/user_profile?user_id=711688) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1786934#c11)• 2 years ago |
|  | |

I have restored the page, and it is now available.

Thank you for your time!

Flags: needinfo?(nomotokazuki)

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1786934#c12)• 2 years ago |
|  | |

Thank you, Kazuki!

@Laurie as discussed on Slack the issue still occurs.

This appears only if Im on the homepage and tap on the recent visited section.

If I access that website - tap on the button - it opens a new tab with that notification permission - this is correct.

Do you think we can close this issue? I'm not really sure how often it will happen if someone access it from the recent visited.

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a25379192_616105)• 2 years ago |

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1786934#c13)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1786934&comment_id=16455720 "1 revision") |
|  | |

Attached video
[RPReplay\_Final1686317789.MP4](attachment.cgi?id=9339165)
— [Details](attachment.cgi?id=9339165&action=edit)

Hello! I'm attaching the video of this use case here, but I think this use case is acceptable and we fixed the security problem. The prompt only shows when a user clicks to see the "pocforshare" URL. The prompt is not shown when we navigate to "example.com" domain anymore. I attached the video here Andrei shared with me.

cc: :dveditz I think this is fine but what do you think?

Flags: needinfo?(lmarceau) → needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1786934#c14)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Attached file
[POC from reporter's site](attachment.cgi?id=9340574)
— [Details](attachment.cgi?id=9340574&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1786934#c15)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Attached file
["second.html" required by first stage of the POC](attachment.cgi?id=9340584)
— [Details](attachment.cgi?id=9340584&action=edit)

The POC requires a second page. For convenience I've combined the separate .js file into the .html. The referenced style.css was a 404 on the reporter's site but it should be fine since there's nothing on that page to style.

Because it's two files the POC won't run from the bugzilla attachment. You'll have to download both files together. Doesn't matter what the POC is called, but this one has to be "second.html" or you'll have to edit the POC. *Might* work as a local file: url, but you might have to run a localhost server (e.g `python3 -m http.server` or node or similar)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1786934#c16)• 2 years ago |
|  | |

oh, permissions won't work from an insecure context. A simple server isn't going to have a cert so you can't load the test from a desktop server, and while Chrome and Firefox otherwise consider <http://localhost> to be a "secure context", webkit does not so that won't work either.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a26135833_1689)• 2 years ago |

[Attachment #9340574](/attachment.cgi?id=9340574&action=edit "POC from reporter's site") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a26135860_1689)• 2 years ago |

[Attachment #9340584](/attachment.cgi?id=9340584&action=edit "\"second.html\" required by first stage of the POC") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1786934#c17)• 2 years ago |
|  | |

The video is OK for --this-- permission prompt, but it looks like the patch is specific to the media devices prompt. Could someone turn around and do the same thing with prompts for other permissions? If they don't share common base code that prevents them from appearing in front other the wrong tab then we have to look at each one at a time, and hope we don't forget one.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a26138965_1689)• 2 years ago |

[Attachment #9340574](/attachment.cgi?id=9340574&action=edit "POC from reporter's site") -
Attachment is obsolete: false

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a26138983_1689)• 2 years ago |

[Attachment #9340584](/attachment.cgi?id=9340584&action=edit "\"second.html\" required by first stage of the POC") -
Attachment is obsolete: false

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1786934#c18)• 2 years ago |
|  | |

I tried rewriting the testcase to run in a single file from the bugzilla attachment, but I don't know the purpose of navigating to the second page. Is there a reason the permission request has to be done after a navigation rather than from the original document? The setTimeout() makes sense -- you have to give time for the victim page to load.

In fact I don't see how requesting the permission after the navigation is valid in the first place, with or without the popup. Permission prompts are supposed to be limited to "user activation", and the user didn't click in that page -- they clicked in the previous page. Not to mention the 10 second delay between the click and the attempted action violates the "no surprises" principle of requiring the click. See, for example, the "popup" vs "popup (delayed)" tests on <https://permission.site/>, which Firefox for iOS does correctly (blocks the delayed popup). [Note: this site includes tests for several chrome-only features that aren't expected to work in Firefox]

Looks like getUserMedia() might be a special snowflake wrt requiring user activation, see still-open [Enforcing user gesture for getUserMedia](https://github.com/w3c/mediacapture-extensions/issues/11). Comments in that thread confirm that in Safari, user-activation isn't inherited across navigations. But apparently getUserMedia() doesn't require user activation. I guess the user's ability to block future requests disincentivizes abuse.

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1786934#c19)• 2 years ago |
|  | |

> Could someone turn around and do the same thing with prompts for other permissions?

:dveditz the media prompt includes camera and microphone permissions, as seen with [WKMediaCaptureType](https://developer.apple.com/documentation/webkit/wkmediacapturetype).

For other iOS permissions type, like location permissions; it's a different flow which we don't really have as an API for to control over (so no equivalent of [webView(:requestMediaCapturePermissionFor:](https://developer.apple.com/documentation/webkit/wkuidelegate/3763087-webview) that I used here to improve on this flow). We do have some improvements to do with the location permission thought with [1786929](https://bugzilla.mozilla.org/show_bug.cgi?id=1786929), [1786931](https://bugzilla.mozilla.org/show_bug.cgi?id=1786931) and [1786932](https://bugzilla.mozilla.org/show_bug.cgi?id=1786932). I don't think WebKit can ask for other permissions than those 3.

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1786934#c20)• 2 years ago |
|  | |

Hello I will close the current issue as fixed, but we opened two related bugs with [1840921](https://bugzilla.mozilla.org/show_bug.cgi?id=1840921) and [1840919](https://bugzilla.mozilla.org/show_bug.cgi?id=1840919).

Status: NEW → RESOLVEDClosed: 2 years agoResolution: --- → FIXED

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a26616243_694570)• 2 years ago |

[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=%3F) → [115](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=115)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a26700707_75935)• 2 years ago |

Group: mobile-core-security → core-security-release

|  | [lmarceau](/user_profile?user_id=694570)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1786934#c21)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9342257)
— [Details](attachment.cgi?id=9342257&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a27281129_428608)• 2 years ago |

Alias: CVE-2023-37455

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a28339662_1689)• 1 years ago |

See Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/13363>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a28339798_1689)• 1 years ago |

Flags: sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a55725454_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1786934#a65103665_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1786934&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [lmarceau](/user_profile?user_id=694570)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_fc4f8e4e_20250114_200341.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-25

## Security Vulnerabilities fixed in Firefox for iOS 115

Announced
July 4, 2023
Impact
moderate
Products
Firefox for iOS
Fixed in

* Firefox for iOS 115

#### [#CVE-2023-37455: Media permission request prompt showing from background tab](#CVE-2023-37455)

Reporter
Kazuki Nomoto
Impact
moderate
##### Description

The permission request prompt from the site in the background tab was overlaid on top of the site in the foreground tab.

##### References

* [Bug 1786934](https://bugzilla.mozilla.org/show_bug.cgi?id=1786934)

#### [#CVE-2023-37456: Browser crashed when session restore was called with an empty body](#CVE-2023-37456)

Reporter
Artem Chaykin
Impact
low
##### Description

The session restore helper crashed whenever there was no parameter sent to the message handler.

##### References

* [Bug 1795496](https://bugzilla.mozilla.org/show_bug.cgi?id=1795496)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


