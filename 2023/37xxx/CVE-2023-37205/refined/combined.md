=== Content from security.gentoo.org_897e22ca_20250114_191743.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_ecd955a5_20250114_191745.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-22

## Security Vulnerabilities fixed in Firefox 115

Announced
July 4, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 115

#### [#CVE-2023-3482: Block all cookies bypass for localstorage](#CVE-2023-3482)

Reporter
Martin Hostettler
Impact
moderate
##### Description

When Firefox is configured to block storage of all cookies, it was still possible to store data in localstorage by using an iframe with a source of 'about:blank'. This could have led to malicious websites storing tracking data without permission.

##### References

* [Bug 1839464](https://bugzilla.mozilla.org/show_bug.cgi?id=1839464)

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37203: Drag and Drop API may provide access to local system files](#CVE-2023-37203)

Reporter
Paul Nickerson and Ameen Basha M K
Impact
moderate
##### Description

Insufficient validation in the Drag and Drop API in conjunction with social engineering, may have allowed an attacker to trick end-users into creating a shortcut to local system files. This could have been leveraged to execute arbitrary code.

##### References

* [Bug 291640](https://bugzilla.mozilla.org/show_bug.cgi?id=291640)

#### [#CVE-2023-37204: Fullscreen notification obscured via option element](#CVE-2023-37204)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using an option element by introducing lag via an expensive computational function. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832195](https://bugzilla.mozilla.org/show_bug.cgi?id=1832195)

#### [#CVE-2023-37205: URL spoofing in address bar using RTL characters](#CVE-2023-37205)

Reporter
Rohan Sharma
Impact
moderate
##### Description

The use of RTL Arabic characters in the address bar may have allowed for URL spoofing.

##### References

* [Bug 1704420](https://bugzilla.mozilla.org/show_bug.cgi?id=1704420)

#### [#CVE-2023-37206: Insufficient validation of symlinks in the FileSystem API](#CVE-2023-37206)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Uploading files which contain symlinks may have allowed an attacker to trick a user into submitting sensitive data to a malicious website.

##### References

* [Bug 1813299](https://bugzilla.mozilla.org/show_bug.cgi?id=1813299)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37209: Use-after-free in "NotifyOnHistoryReload"](#CVE-2023-37209)

Reporter
Simon Descarpentries
Impact
moderate
##### Description

A use-after-free condition existed in `NotifyOnHistoryReload` where a `LoadingSessionHistoryEntry` object was freed and a reference to that object remained. This resulted in a potentially exploitable condition when the reference to that object was later reused.

##### References

* [Bug 1837993](https://bugzilla.mozilla.org/show_bug.cgi?id=1837993)

#### [#CVE-2023-37210: Full-screen mode exit prevention](#CVE-2023-37210)

Reporter
Hafiizh
Impact
low
##### Description

A website could prevent a user from exiting full-screen mode via alert and prompt calls. This could lead to user confusion and possible spoofing attacks.

##### References

* [Bug 1821886](https://bugzilla.mozilla.org/show_bug.cgi?id=1821886)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

#### [#CVE-2023-37212: Memory safety bugs fixed in Firefox 115](#CVE-2023-37212)

Reporter
Andrew McCreight, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 114. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1750870%2C1825552%2C1826206%2C1827076%2C1828690%2C1833503%2C1835710%2C1838587)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_43c552ea_20250114_191743.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1704420)
* [XML](/show_bug.cgi?ctype=xml&id=1704420)

Closed
[Bug 1704420](/show_bug.cgi?id=1704420)
(CVE-2023-37205)

Opened 4 years ago
Closed 2 years ago

# Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)

## Categories

### (Firefox :: Address Bar, defect, P3)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Address%20Bar#Address%20Bar)

Address Bar
▾

Firefox :: Address Bar
For bugs in the Firefox "Smart Location Bar" (aka Awesome Bar) UI element, including the bookmark and history autocomplete matching behavior.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Address%20Bar&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Address%20Bar&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Address%20Bar)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 87

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

115 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox113 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed) |
| firefox119 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed) |
| firefox120 | --- | [verified](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=verified) |
| firefox121 | --- | [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox113 |  | wontfix |
| firefox114 |  | wontfix |
| firefox115 |  | fixed |
| firefox119 |  | fixed |
| firefox120 |  | verified |
| firefox121 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: rohansharma.rohan27, Assigned: mseibert)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/82c213f9f648a145742e189093dbcd7d?d=mm&size=40)  [mseibert](/user_profile?user_id=725240)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ca01a9c048a909177b5e76e720c5cee5?d=mm&size=40)  [rohansharma.rohan27](/user_profile?user_id=683445)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/d949a35ad3900bd0ee47938b23a0cbee?d=mm&size=40)  [dao](/user_profile?user_id=219124)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2023-5732](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")

Dependency [tree](/showdependencytree.cgi?id=1704420&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1704420)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1825692](/show_bug.cgi?id=1825692 "RESOLVED DUPLICATE - Address Bar Spoofing due to Arabic RTL characters")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2021-4221](/show_bug.cgi?id=1704422 "RESOLVED FIXED - Address Bar Spoofing due to Arabic RTL characters"), [1844915](/show_bug.cgi?id=1844915 "RESOLVED DUPLICATE - Arabic IDNs allow address bar spoofing")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [adv-main115+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-37205

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main115+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c28 "4 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a99992516_578488 "7 months ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | [in-testsuite](#c45 "1 years ago") | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 3 obsolete files)

| [firefox-desktop-PoC.html](/attachment.cgi?id=9215016)  [4 years ago](#c0)  [Rohan Sharma](/user_profile?user_id=683445)   248 bytes, text/html |  | [Details](/attachment.cgi?id=9215016&action=edit) |
| --- | --- | --- |
| [firefox-poc.png](/attachment.cgi?id=9215017)  [4 years ago](#c1)  [Rohan Sharma](/user_profile?user_id=683445)   19.88 KB, image/png |  | [Details](/attachment.cgi?id=9215017&action=edit) |
| [firefox-latest-mac-poc.mov](/attachment.cgi?id=9215247)  [4 years ago](#c8)  [Rohan Sharma](/user_profile?user_id=683445)   6.52 MB, video/quicktime |  | [Details](/attachment.cgi?id=9215247&action=edit) |
| [Bug 1704420 - Improve bidi handling in the url bar. r=mak](/attachment.cgi?id=9265067)  [3 years ago](#c20)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9265067&action=edit) | [Review](/attachment.cgi?id=9265067) |
| [WIP: Bug 1704420](/attachment.cgi?id=9268715)  [3 years ago](#c24)  [Marco Bonardo [:mak]](/user_profile?user_id=240353)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9268715&action=edit) | [Review](/attachment.cgi?id=9268715) |
| [Bug 1704420.r=mak](/attachment.cgi?id=9330368)  [2 years ago](#c30)  [Marc Seibert (:mseibert)](/user_profile?user_id=725240)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9330368&action=edit) | [Review](/attachment.cgi?id=9330368) |
| [Bug 1704420 - Test.r=mak](/attachment.cgi?id=9333592)  [2 years ago](#c31)  [Marc Seibert (:mseibert)](/user_profile?user_id=725240)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9333592&action=edit) | [Review](/attachment.cgi?id=9333592) |
| [advisory.txt](/attachment.cgi?id=9341329)  [2 years ago](#c41)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   118 bytes, text/plain |  | [Details](/attachment.cgi?id=9341329&action=edit) |
| [Bug 1704420 - Test.r=mak](/attachment.cgi?id=9345514)  [1 years ago](#c43)  [Marc Seibert (:mseibert)](/user_profile?user_id=725240)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9345514&action=edit) | [Review](/attachment.cgi?id=9345514) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1704420#c0)• 4 years ago |
|  | |

Attached file
[firefox-desktop-PoC.html](attachment.cgi?id=9215016)
— [Details](attachment.cgi?id=9215016&action=edit)

User Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0

Steps to reproduce:

Tested on:

User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:87.0) Gecko/20100101 Firefox/87.0

User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0

STEP 1: Click on "run" in attached file ("firefox-desktop-PoC.html")

The address bar will point to "www.mozilla.org", however the actual content is being delivered by "اختبار.اختبار"

The URL is not handled properly. Arabic characters in the domain name are being rendered from Right to Left(RTL) direction rather than Left to Right(LTR).

Actual results:

[http://www.mozilla.org/hello/1/index.html/رابتخا.رابتخا](http://www.mozilla.org/hello/1/index.html/%D8%B1%D8%A7%D8%A8%D8%AA%D8%AE%D8%A7.%D8%B1%D8%A7%D8%A8%D8%AA%D8%AE%D8%A7)

Expected results:

[http://اختبار.اختبار/www.mozilla.org/hello/1/index.html](http://%D8%A7%D8%AE%D8%AA%D8%A8%D8%A7%D8%B1.%D8%A7%D8%AE%D8%AA%D8%A8%D8%A7%D8%B1/www.mozilla.org/hello/1/index.html)

The address bar should point to "اختبار.اختبار" instead of "www.mozilla.org"

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1704420#c1)• 4 years ago |
|  | |

Attached image
[firefox-poc.png](attachment.cgi?id=9215017)
— [Details](attachment.cgi?id=9215017&action=edit)

Added PoC image

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a365_683445)• 4 years ago |

Version: unspecified → Firefox 87

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1704420#c2)• 4 years ago |
|  | |

Weirdly, for me the URL is initially correct, but then is incorrect when switching away from the tab and then back. Marco, do you know what's going on here?

Component: Untriaged → Address BarFlags: needinfo?(mak)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1704420#c3)• 4 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #2](/show_bug.cgi?id=1704420#c2 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> Weirdly, for me the URL is initially correct, but then is incorrect when switching away from the tab and then back. Marco, do you know what's going on here?

For me the domain is not highlighted when clicking in the poc, what do you mean by initially correct but incorrect later? If this would be a very long url, it could happen that we ensure the domain stays visible only on initial load and not later on.

Flags: needinfo?(mak) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1704420#c4)• 4 years ago |
|  | |

(In reply to Marco Bonardo [:mak] from [comment #3](/show_bug.cgi?id=1704420#c3 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> (In reply to :Gijs (he/him) from [comment #2](/show_bug.cgi?id=1704420#c2 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))
>
> > Weirdly, for me the URL is initially correct, but then is incorrect when switching away from the tab and then back. Marco, do you know what's going on here?
>
> For me the domain is not highlighted when clicking in the poc,

Same here. I think because we're loading an error page?

> what do you mean by initially correct but incorrect later?

I mean the order of the text matches "expected results" for me after I click the link, and doesn't match "actual / broken result" until I switch away from the tab and then switch back. Are you seeing something else?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(mak)

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1704420#c5)• 4 years ago |
|  | |

You can visit following link for live version.

<http://xn--4gbrim.xn--mgberp4a5d4ar/www.mozilla.org/1>

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1704420#c6)• 4 years ago |
|  | |

(In reply to Rohan Sharma from [comment #5](/show_bug.cgi?id=1704420#c5 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> You can visit following link for live version.
>
> <http://xn--4gbrim.xn--mgberp4a5d4ar/www.mozilla.org/1>

This just redirects to `https://nic.sa/www.mozilla.org/1`.

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1704420#c7)• 4 years ago |
|  | |

I don't see any difference after switching to other tabs, in Nightly.

Flags: needinfo?(mak)

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1704420#c8)• 4 years ago |
|  | |

Attached video
[firefox-latest-mac-poc.mov](attachment.cgi?id=9215247)
— [Details](attachment.cgi?id=9215247&action=edit)

Added a video PoC for better understanding of how it is working on my end.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a151718_406194)• 4 years ago |

See Also: → [CVE-2021-4221](/show_bug.cgi?id=1704422 "RESOLVED FIXED - Address Bar Spoofing due to Arabic RTL characters")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1704420#c9)• 4 years ago |
|  | |

I think we have a dupe of this, Jonathan do you remember?

If you set `browser.urlbar.trimURLs` to `false` (not the default) then this works correctly -- the scheme anchors the text direction correctly.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a234148_1689)• 4 years ago |

Flags: needinfo?(jfkthame)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1704420#c10)• 4 years ago |
|  | |

I do not reproduce the behavior in the .PNG -- I only get the behavior when we trim schemes, which we only do for `http:` links (by default?), and we wouldn't show the lock icon for that. I don't get any web content, I get a server error, so we're not going to get a lock in any case.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a234259_1689)• 4 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1704420#c11)• 4 years ago |
|  | |

We've certainly seen similar examples before, and trimming the scheme from the URL is at least part of the issue, because if the scheme is present it provides an unambiguously-LTR beginning for the text.

With Nightly on macOS, I do see a surprising inconsistency in behavior: when I initially clicked the attachment link here, and then clicked "Run", the URL bar displayed the Arabic-script domain first (leftmost), and the "fake" domain mozilla.org to the right; but when I downloaded the testcase and loaded it from a file://, they appeared reversed.

Further testing shows that it's somewhat flaky: with the testcase loaded directly here, repeatedly clicking "Run" and then go-back, I get sometimes the "correct" order and sometimes the "reversed" version. (With the testcase loaded from a local file, it seems consistently reversed.)

So there is definitely something odd going on, though AFAICS only "trimmed" URLs are subject to this, and so it wouldn't be possible to spoof an https:// location in this way.

Flags: needinfo?(jfkthame)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1704420#c12)• 4 years ago |
|  | |

Dupe of [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1704420#c13)• 4 years ago |
|  | |

The reported has submitted this for bounty consideration.

Flags: sec-bounty?

|  | [Rohan Sharma](/user_profile?user_id=683445)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1704420#c14)• 4 years ago |
|  | |

Hi, we have passed 60 days for this vulnerability report. Any updates?

|  | [Drew Willcoxon :adw](/user_profile?user_id=334927) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a20279838_334927)• 3 years ago |

Severity: -- → S3Priority: -- → P3

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a27354919_1689)• 3 years ago |

Status: UNCONFIRMED → RESOLVEDClosed: 3 years agoResolution: --- → DUPLICATE

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a27354955_428608)• 3 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1704420#c16)• 3 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

(In reply to Rohan Sharma from [comment #14](/show_bug.cgi?id=1704420#c14 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> Hi, we have passed 60 days for this vulnerability report. Any updates?

We just discovered this was *indeed* a duplicate of a previous report. Sorry about the lack of notice.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1704420#c17)• 3 years ago |
|  | |

(In reply to Jonathan Kew (:jfkthame) from [comment #12](/show_bug.cgi?id=1704420#c12 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> Dupe of [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")?

I'm not sure it is. This one might be fixed by whatever you eventually do for [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)"), but this is a much simpler case of not anchoring the hostname to the left when we don't display the scheme. It only works with http:// domains with the default value for `browser.urlbar.trimURLs` and does not work for https:// domains.

[bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)") shows misordering even within https:// urls. It might be simple to fix this bug without fixing all of [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")

I initially duped it, but I'm going to make it a "depends on" in case we can come up with a shorter-term fix for this variant. Seem reasonable?

Depends on: [CVE-2023-5732](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")Flags: sec-bounty?Flags: sec-bounty-Flags: needinfo?(jfkthame)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a27356428_1689)• 3 years ago |

Status: RESOLVED → REOPENEDEver confirmed: trueResolution: DUPLICATE → ---

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1704420#c19)• 3 years ago |
|  | |

Possibly the simplest thing to do here would be when we trim "http://" from the URL, insert a Left-to-Right mark (U+200E) in its place so that we maintain the same ordering for any bidi content.

This looks trivial to do in [`BrowserUIUtils.trimURL()`](https://searchfox.org/mozilla-central/rev/20ebe9f39e8790e2db123f89fab3293dc0a796ac/browser/modules/BrowserUIUtils.jsm#201-207), by making it return `"\u200e" + url.substring(this.trimURLProtocol.length)` instead of just the substring; but I suspect some other adjustments will need to be made to ensure this doesn't disrupt other operations such as URLbar formatting.

Flags: needinfo?(jfkthame)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1704420#c20)• 3 years ago |
|  | |

Attached file
[Bug 1704420 - Improve bidi handling in the url bar. r=mak](attachment.cgi?id=9265067) (obsolete)
— [Details](attachment.cgi?id=9265067&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a27364962_600971)• 3 years ago |

Assignee: nobody → jfkthame

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1704420#c21)• 3 years ago |
|  | |

Here's a strawman patch that appears to improve the behavior, based on my local testing; however, please be aware that I don't really know this code at all, and there's a strong chance that it'll have some kind of side-effects and require further work before it's really usable. Feedback welcome, or better still, if someone who actually knows front-end code wants to take this and finish it, that'd be great!

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1704420#c22)• 3 years ago |
|  | |

Fwiw, in the past we addressed these cases through formatting and highlighting the right domain in the url.

In a few cases where the code can't identify the domain string we just give up and don't format, that seems what is happening here, though I'm not sure why yet, it should be debugged.

If the domain highlight UI is still confusing, maybe that is what requires a change, users should not make assumption between order of parts and safety of the URL in general, our UI here is sub-optimal.

Of course currently this only affects http due to trimming, but it's likely at a certain point the behavior will switch to hide https instead.

(In reply to Jonathan Kew (:jfkthame) from [comment #19](/show_bug.cgi?id=1704420#c19 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> Possibly the simplest thing to do here would be when we trim "http://" from the URL, insert a Left-to-Right mark (U+200E) in its place so that we maintain the same ordering for any bidi content.

That's something we evaluated in the past but it is a bit risky, because it's effectively adding artificial chars to the url, and then we must guarantee any code using that value is accounting for that.

For example, I think the patch is not correctly handling this code:

<https://searchfox.org/mozilla-central/rev/f8db81665dc2833fff09dc7eef200539ac1fd351/browser/components/urlbar/UrlbarInput.jsm#1184>

then there's various calls to \_trimValue related to the selection and what is copied to the clipboard

<https://searchfox.org/mozilla-central/rev/f8db81665dc2833fff09dc7eef200539ac1fd351/browser/components/urlbar/UrlbarInput.jsm#2199-2202>

and then everything using inputField.value would also have to take that into account:

<https://searchfox.org/mozilla-central/rev/f8db81665dc2833fff09dc7eef200539ac1fd351/browser/components/urlbar/UrlbarInput.jsm#1967,1972,1981>

So, I don't think it's trivial to add special characters to the urlbar value without the risk of subtle breakage here and there.

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1704420#c23)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1704420&comment_id=15823289 "1 revision") |
|  | |

fwiw, the link in [comment 5](/show_bug.cgi?id=1704420#c5 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)") is doing proper highlighting for me where the RTL domain is highlighted, as well as the link in [comment 0](/show_bug.cgi?id=1704420#c0 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)").

On the other side the poc.html link on load is not formatted, making things worse.

This is the first thing I wanted to understand, and it seems to be because the trimmed string confuses URIFixup, indeed here

<https://searchfox.org/mozilla-central/rev/f8db81665dc2833fff09dc7eef200539ac1fd351/browser/components/urlbar/UrlbarValueFormatter.jsm#136,156>

URIFixup thinks the string should be searched for and we end up here <https://searchfox.org/mozilla-central/rev/f8db81665dc2833fff09dc7eef200539ac1fd351/browser/components/urlbar/UrlbarValueFormatter.jsm#163>

If we'd use the .untrimmedValue instead of the inputField.value, everything seems to be working fine.

We manage that later instead:

<https://searchfox.org/mozilla-central/rev/f8db81665dc2833fff09dc7eef200539ac1fd351/browser/components/urlbar/UrlbarValueFormatter.jsm#169-178>

So apparently there's a bug here that makes us skip formatting for trimmed RTL domains, and we can write a test for it. Of course it will require some additional checks around using untrimmedValue but it should be fine for the most part.

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1704420#c24)• 3 years ago |
|  | |

Attached file
[WIP: Bug 1704420](attachment.cgi?id=9268715) (obsolete)
— [Details](attachment.cgi?id=9268715&action=edit)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1704420#c25)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1704420&comment_id=15823331 "1 revision") |
|  | |

Basically, the patch I'm attaching should be addressing the lack of formatting for this case (I still have to write tests). Whether that's enough or not to address our sec concerns, is TBD. Fwiw I'm also happy to fix that separately in a public bug (there's nothing particularly risky there, imo) while keeping this open for further investigation and a broader solution. Wdyt Daniel?

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1704420#c26)• 3 years ago |
|  | |

What kinds of other concerns do you want to investigate, or what parts of the original complain here would remain unfixed? We also have [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)") for other kinds of mixed RTL text URL spoofs. Would your investigation and broader solution fit with that, or are your concerns different?

From a bug-bounty perspective it would be better to fix the reporter's testcase in this bug and do the broader follow-up investigation in a new bug, but that's mainly an administrative concern. If you feel strongly the other approach is better we can make that work.

Flags: needinfo?(dveditz)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1704420#c27)• 3 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #26](/show_bug.cgi?id=1704420#c26 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> What kinds of other concerns do you want to investigate, or what parts of the original complain here would remain unfixed? We also have [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)") for other kinds of mixed RTL text URL spoofs. Would your investigation and broader solution fit with that, or are your concerns different?

Yes, I think [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)") is covering the broader concern with RTL inverting url parts positioning. We don't have a UI able to remove any misleading use of RTL today, and that would require a deeper UI change, like for example only showing the origin like some other browsers do. That's far away afaict.

Let's keep this to fix highlighting, if we think that is sufficient to address concern with the reported bug. It was considered sufficient so far, for the other cases we hit in the past.

As for adding chars to force direction of the shown url, that's technically feasible, but it may become source of various regressions, especially when it will apply to the most common case of stripping https. It may be necessary to hide inputField into the UrlbarInput object and expose/override only parts of it, that way we could abstract away the special character that would not exist for external consumers and be handled internally. Since this is a larger effort, I'd probably leave it to a separate bug.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1704420#c28)• 2 years ago |
|  | |

The bug bounty committee has decided that this is a sub-set of the earlier reported [bug 1690979](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)") and won't be awarded a bounty. Your [bug 1704422](/show_bug.cgi?id=1704422 "RESOLVED FIXED - Address Bar Spoofing due to Arabic RTL characters") was awarded because although visually the same, the fix was in a different codebase.

Flags: sec-bounty? → sec-bounty-

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a62063182_159069)• 2 years ago |

Duplicate of this bug: [1825692](/show_bug.cgi?id=1825692 "RESOLVED DUPLICATE - Address Bar Spoofing due to Arabic RTL characters")

|  | [Marc Seibert (:mseibert)](/user_profile?user_id=725240)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1704420#c30)• 2 years ago |
|  | |

Attached file
[Bug 1704420.r=mak](attachment.cgi?id=9330368)
— [Details](attachment.cgi?id=9330368&action=edit)

|  | [Marc Seibert (:mseibert)](/user_profile?user_id=725240)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a65338906_725240)• 2 years ago |

Assignee: jfkthame → mseibert

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a65423939_600971)• 2 years ago |

[Attachment #9330368](/attachment.cgi?id=9330368&action=edit "Bug 1704420.r=mak") -
Attachment description: WIP: Bug 1704420 → Bug 1704420 - Address Bar Spoofing due to Arabic RTL characters.r=mak

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a65594218_240353)• 2 years ago |

[Attachment #9268715](/attachment.cgi?id=9268715&action=edit "WIP: Bug 1704420") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a65940348_600971)• 2 years ago |

[Attachment #9330368](/attachment.cgi?id=9330368&action=edit "Bug 1704420.r=mak") -
Attachment description: Bug 1704420 - Address Bar Spoofing due to Arabic RTL characters.r=mak → Bug 1704420.r=mak

|  | [Marc Seibert (:mseibert)](/user_profile?user_id=725240)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1704420#c31)• 2 years ago |
|  | |

Attached file
[Bug 1704420 - Test.r=mak](attachment.cgi?id=9333592) (obsolete)
— [Details](attachment.cgi?id=9333592&action=edit)

Depends on D176529

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1704420#c32)• 2 years ago |
|  | |

The landed patch makes the origin emphasized (or better, it deemphasize all the rest), making the url less likely to be abused.

In [Bug 1833091](/show_bug.cgi?id=1833091 "RESOLVED FIXED - Replace direct UrlbarInput.inputField access with UrlbarInput proxies") we are investigating the approach suggested by Jonathan, of adding a force LTR char when we strip the protocol.

Long term we should experiment with showing only the origin by default (allowing advanced users to revert to the full url).

<https://hg.mozilla.org/integration/autoland/rev/ce16eb5623883665dc8db25169efe5b61647f58c>

<https://hg.mozilla.org/mozilla-central/rev/ce16eb5623883665dc8db25169efe5b61647f58c>

Status: REOPENED → RESOLVEDClosed: 3 years ago → 2 years agoResolution: --- → FIXED

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a66105619_240353)• 2 years ago |

[Attachment #9265067](/attachment.cgi?id=9265067&action=edit "Bug 1704420 - Improve bidi handling in the url bar. r=mak") -
Attachment is obsolete: true

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a66105716_258347)• 2 years ago |

Group: firefox-core-security → core-security-release
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed)Target Milestone: --- → 115 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a66150125_75935)• 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1704420#c33)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:mseibert, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox114` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(mseibert)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1704420#c34)• 2 years ago |
|  | |

I'd just let this follow normal train to release, considered it's touching urlbar highlighting anyway, and 115 will become an ESR.

Daniel, wdyt?

Flags: needinfo?(mseibert) → needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1704420#c35)• 2 years ago |
|  | |

That seems reasonable

Flags: needinfo?(dveditz)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a66607679_75935)• 2 years ago |

[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a68018367_551058)• 2 years ago |

Flags: qe-verify+

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1704420#c36)• 2 years ago |
|  | |

Setting a needinfo to remember landing the test in the future.

Flags: needinfo?(mak)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1704420#c37)• 2 years ago |
|  | |

FWIW; You can also set a whiteboard tag `[reminder-land-tests YYY-mm-dd]` and the bot will needinfo you on that day.

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1704420#c38)• 2 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #37](/show_bug.cgi?id=1704420#c37 "VERIFIED FIXED - Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)"))

> FWIW; You can also set a whiteboard tag `[reminder-land-tests YYY-mm-dd]` and the bot will needinfo you on that day.

TIL, thank you!

I assume it will notify the bug assignee though.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1704420#c39)• 2 years ago |
|  | |

Nope, that goes to the person who set it. :)

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1704420#c40)• 2 years ago |
|  | |

Awesome.

Flags: needinfo?(mak)Whiteboard: [reminder-land-tests 2023-07-05]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a69679829_586683)• 2 years ago |

Whiteboard: [reminder-land-tests 2023-07-05] → [reminder-land-tests 2023-07-05][adv-main115+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1704420#c41)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341329)
— [Details](attachment.cgi?id=9341329&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a69772232_578488)• 2 years ago |

Alias: CVE-2023-37205

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a72050265_1689)• 1 years ago |

See Also: → [1844915](/show_bug.cgi?id=1844915 "RESOLVED DUPLICATE - Arabic IDNs allow address bar spoofing")

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1704420#c42)• 1 years ago |
|  | |

Sounds like I should have used reminder-tests in the whiteboard. Checking the test patch applies to land it.

Whiteboard: [reminder-land-tests 2023-07-05][adv-main115+] → [adv-main115+]

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a72071829_600971)• 1 years ago |

[Attachment #9333592](/attachment.cgi?id=9333592&action=edit "Bug 1704420 - Test.r=mak") -
Attachment is obsolete: true

|  | [Marc Seibert (:mseibert)](/user_profile?user_id=725240)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1704420#c43)• 1 years ago |
|  | |

Attached file
[Bug 1704420 - Test.r=mak](attachment.cgi?id=9345514)
— [Details](attachment.cgi?id=9345514&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1704420#c44)• 1 years ago |
|  | |

Pushed by mak77@bonardo.net:
<https://hg.mozilla.org/integration/autoland/rev/411fcc325af6>
Test.r=mak

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1704420#c45)• 1 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/411fcc325af6>

Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a72185769_1689)• 1 years ago |

Summary: Address Bar Spoofing due to Arabic RTL characters → Address Bar Spoofing due to Arabic RTL characters (fix domain highlighting)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a78135431_75935)• 1 year ago |

Blocks: [CVE-2023-5732](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")No longer depends on: [CVE-2023-5732](/show_bug.cgi?id=1690979 "RESOLVED FIXED - URL bar spoofing with bidirectional Unicode characters (also link hover text)")

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1704420#c46)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/b89315fc78f8>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a79398487_1689)• 1 year ago |

Group: core-security-release

|  | [Ardelean Oana, Desktop Test Engineering [:oardelean]](/user_profile?user_id=700963) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1704420#c47)• 1 year ago |
|  | |

Reproducible on Firefox 114.0 on macOS 12.

Verified as fixed on Firefox 120.0 and Nightly 121.0a1 on macOS 12, Windows 10, Ubuntu 22.

Status: RESOLVED → VERIFIED
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=verified)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a81929388_1689)• 1 year ago |

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a98886769_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1704420#a99992516_578488)• 7 months ago |

Flags: sec-bounty-hof+
You need to [log in](/show_bug.cgi?id=1704420&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Rohan Sharma](/user_profile?user_id=683445)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


