=== Content from github.com_3c169821_20250114_204003.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMightyPirates%2FOpenComputers%2Fsecurity%2Fadvisories%2FGHSA-vvfj-xh7c-j2cm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMightyPirates%2FOpenComputers%2Fsecurity%2Fadvisories%2FGHSA-vvfj-xh7c-j2cm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=MightyPirates%2FOpenComputers)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MightyPirates](/MightyPirates)
/
**[OpenComputers](/MightyPirates/OpenComputers)**
Public

* [Notifications](/login?return_to=%2FMightyPirates%2FOpenComputers) You must be signed in to change notification settings
* [Fork
  434](/login?return_to=%2FMightyPirates%2FOpenComputers)
* [Star
   1.6k](/login?return_to=%2FMightyPirates%2FOpenComputers)

* [Code](/MightyPirates/OpenComputers)
* [Issues
  122](/MightyPirates/OpenComputers/issues)
* [Pull requests
  23](/MightyPirates/OpenComputers/pulls)
* [Actions](/MightyPirates/OpenComputers/actions)
* [Wiki](/MightyPirates/OpenComputers/wiki)
* [Security](/MightyPirates/OpenComputers/security)
* [Insights](/MightyPirates/OpenComputers/pulse)

Additional navigation options

* [Code](/MightyPirates/OpenComputers)
* [Issues](/MightyPirates/OpenComputers/issues)
* [Pull requests](/MightyPirates/OpenComputers/pulls)
* [Actions](/MightyPirates/OpenComputers/actions)
* [Wiki](/MightyPirates/OpenComputers/wiki)
* [Security](/MightyPirates/OpenComputers/security)
* [Insights](/MightyPirates/OpenComputers/pulse)

# SSRF to cloud (AWS, GCP, Azure) service metadata services (IMDS) and local IPv6 addresses not blocked by default

Critical

[asiekierka](/asiekierka)
published
GHSA-vvfj-xh7c-j2cm
Jul 7, 2023

## Package

OpenComputers
(Minecraft Mod)

## Affected versions

1.2.0+

## Patched versions

1.8.3

maven

li.cil.oc:OpenComputers:MC1.7.10-1.5.+:api
([Maven](/advisories?query=ecosystem%3Amaven))

All

1.8.3

## Description

### Summary

If the OpenComputers mod is installed as part of a Minecraft server hosted on a popular cloud hosting provider, such as AWS, GCP and Azure, those metadata services' API endpoints are not forbidden (aka "blacklisted") by default. As such, any player can gain access to sensitive information exposed via those metadata servers, potentially allowing them to pivot or privilege escalate into the hosting provider.

In addition, IPv6 addresses are not correctly filtered at all, allowing broader access into the local IPv6 network.

This is a follow up of a vulnerability that [@JLLeitschuh](https://github.com/JLLeitschuh) also reported back in 2017:

* [#2365](https://github.com/MightyPirates/OpenComputers/issues/2365)

### Details

The default set of domains that are forbidden by OpenComputers are defined here:

[OpenComputers/src/main/resources/application.conf](https://github.com/MightyPirates/OpenComputers/blob/5b2ba76a4c242b369b9b6ac6196fd04d96580ad0/src/main/resources/application.conf#L966-L986)

Lines 966 to 986
in
[5b2ba76](/MightyPirates/OpenComputers/commit/5b2ba76a4c242b369b9b6ac6196fd04d96580ad0)

|  | # This is a list of forbidden domain names. If an HTTP request is made |
| --- | --- |
|  | # or a socket connection is opened the target address will be compared |
|  | # to the addresses / address ranges in this list. It it is present in this |
|  | # list, the request will be denied. |
|  | # Entries are either domain names (www.example.com) or IP addresses in |
|  | # string format (10.0.0.3), optionally in CIDR notation to make it easier |
|  | # to define address ranges (1.0.0.0/8). Domains are resolved to their |
|  | # actual IP once on startup, future requests are resolved and compared |
|  | # to the resolved addresses. |
|  | # By default all local addresses are blocked. This is only meant as a |
|  | # thin layer of security, to avoid average users hosting a game on their |
|  | # local machine having players access services in their local network. |
|  | # Server hosters are expected to configure their network outside of the |
|  | # mod's context in an appropriate manner, e.g. using a system firewall. |
|  | blacklist: [ |
|  | "127.0.0.0/8" |
|  | "0.0.0.0/8" |
|  | "10.0.0.0/8" |
|  | "192.168.0.0/16" |
|  | "172.16.0.0/12" |
|  | ] |

And those are interpreted here:

[OpenComputers/src/main/scala/li/cil/oc/Settings.scala](https://github.com/MightyPirates/OpenComputers/blob/5b2ba76a4c242b369b9b6ac6196fd04d96580ad0/src/main/scala/li/cil/oc/Settings.scala#L614-L637)

Lines 614 to 637
in
[5b2ba76](/MightyPirates/OpenComputers/commit/5b2ba76a4c242b369b9b6ac6196fd04d96580ad0)

|  | class AddressValidator(val value: String) { |
| --- | --- |
|  | val validator: (InetAddress, String) => Option[Boolean] = try cidrPattern.findFirstIn(value) match { |
|  | case Some(cidrPattern(address, prefix)) => |
|  | val addr = InetAddresses.coerceToInteger(InetAddresses.forString(address)) |
|  | val mask = 0xFFFFFFFF << (32 - prefix.toInt) |
|  | val min = addr & mask |
|  | val max = min | ~mask |
|  | (inetAddress: InetAddress, host: String) => Some(inetAddress match { |
|  | case v4: Inet4Address => |
|  | val numeric = InetAddresses.coerceToInteger(v4) |
|  | min <= numeric && numeric <= max |
|  | case \_ => true // Can't check IPv6 addresses so we pass them. |
|  | }) |
|  | case \_ => |
|  | val address = InetAddress.getByName(value) |
|  | (inetAddress: InetAddress, host: String) => Some(host == value || inetAddress == address) |
|  | } catch { |
|  | case t: Throwable => |
|  | OpenComputers.log.warn("Invalid entry in internet blacklist / whitelist: " + value, t) |
|  | (inetAddress: InetAddress, host: String) => None |
|  | } |
|  |  |
|  | def apply(inetAddress: InetAddress, host: String) = validator(inetAddress, host) |
|  | } |

Unfortunately, by default, this list does not include the IP or Domains used by most IMDS:

* IPv4: `169.254.169.254`
* IPv6: `fd00:ec2::254` (in the case of AWS)
* `metadata.google.internal` (in the case of GCP)
* Oracle Cloud: `192.0.0.192`
* Alibaba Cloud: `100.100.100.200`

### Impact

This can allow a player on a server using an OpenComputers computer to access parts of the private IPv4 address space, as well as the whole IPv6 address space, in order to retrieve sensitive information like:

* User-data passed to the system at boot time (could contain secrets)
* IAM role credentials (could allow access to the greater AWS cloud account)
* Managed identity credentials (could allow access to the Azure account)
* Service account tokens (allowing access to the GCP account)

This issue affects every version of OpenComputers with the Internet Card feature enabled; that is, OpenComputers 1.2.0 and above in their most common, default configurations.

### Mitigations

* The following mitigation strategies are available, in order from most to least recommended:
  + Upgrading to a non-affected version of OpenComputers (v1.8.3 for Minecraft 1.7.10 and 1.12.2),
  + Disabling the Internet Card feature completely,
  + If using OpenComputers 1.3.0 or above, the following can also be done:
    - Using the allow list (`opencomputers.internet.whitelist` option) - this will prohibit connections to any IP addresses and/or domains not listed.
    - Adding the following entries to the block list (`opencomputers.internet.blacklist` option):

```
      "100.64.0.0/10",
      "169.254.0.0/16",
      "192.0.0.0/24",
      "192.0.2.0/24",
      "198.18.0.0/15",
      "198.51.100.0/24",
      "203.0.113.0/24",
      "224.0.0.0/3"

```

Note that, while filtering IPv6 addresses is not directly supported, thanks to an IPv4 coercion implemented by OpenComputers 1.3.0 and above, blocking `224.0.0.0/3` will also block all IPv6 addresses.

### References

* <https://www.sans.org/blog/cloud-instance-metadata-services-imds-/>
* <https://hackingthe.cloud/gcp/general-knowledge/metadata_in_google_cloud_instances/>
* <https://hackingthe.cloud/aws/general-knowledge/intro_metadata_service/>
* <https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md>

### Related

* [GHSA-7p4w-mv69-2wm2](https://github.com/cc-tweaked/CC-Tweaked/security/advisories/GHSA-7p4w-mv69-2wm2 "GHSA-7p4w-mv69-2wm2")

### Severity

Critical

9.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N

### CVE ID

CVE-2023-37261

### Weaknesses

[CWE-918](/advisories?query=cwe%3A918)

### Credits

* [![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=40&v=4)](/JLLeitschuh)
  [JLLeitschuh](/JLLeitschuh)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a1e2b2f8_20250114_204004.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fblob%2F96847bb8c28df51e5e49f2dd2978ff6cc4e2821b%2Fprojects%2Fcore%2Fsrc%2Fmain%2Fjava%2Fdan200%2Fcomputercraft%2Fcore%2Fapis%2Fhttp%2Foptions%2FAddressPredicate.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fblob%2F96847bb8c28df51e5e49f2dd2978ff6cc4e2821b%2Fprojects%2Fcore%2Fsrc%2Fmain%2Fjava%2Fdan200%2Fcomputercraft%2Fcore%2Fapis%2Fhttp%2Foptions%2FAddressPredicate.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=cc-tweaked%2FCC-Tweaked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cc-tweaked](/cc-tweaked)
/
**[CC-Tweaked](/cc-tweaked/CC-Tweaked)**
Public

* [Notifications](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked) You must be signed in to change notification settings
* [Fork
  217](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked)
* [Star
   961](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked)

* [Code](/cc-tweaked/CC-Tweaked)
* [Issues
  112](/cc-tweaked/CC-Tweaked/issues)
* [Pull requests
  11](/cc-tweaked/CC-Tweaked/pulls)
* [Discussions](/cc-tweaked/CC-Tweaked/discussions)
* [Actions](/cc-tweaked/CC-Tweaked/actions)
* [Projects
  0](/cc-tweaked/CC-Tweaked/projects)
* [Wiki](/cc-tweaked/CC-Tweaked/wiki)
* [Security](/cc-tweaked/CC-Tweaked/security)
* [Insights](/cc-tweaked/CC-Tweaked/pulse)

Additional navigation options

* [Code](/cc-tweaked/CC-Tweaked)
* [Issues](/cc-tweaked/CC-Tweaked/issues)
* [Pull requests](/cc-tweaked/CC-Tweaked/pulls)
* [Discussions](/cc-tweaked/CC-Tweaked/discussions)
* [Actions](/cc-tweaked/CC-Tweaked/actions)
* [Projects](/cc-tweaked/CC-Tweaked/projects)
* [Wiki](/cc-tweaked/CC-Tweaked/wiki)
* [Security](/cc-tweaked/CC-Tweaked/security)
* [Insights](/cc-tweaked/CC-Tweaked/pulse)

## Files

 96847bb
## Breadcrumbs

1. [CC-Tweaked](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b)
2. /[projects](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects)
3. /[core](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core)
4. /[src](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src)
5. /[main](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main)
6. /[java](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java)
7. /[dan200](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200)
8. /[computercraft](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft)
9. /[core](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core)
10. /[apis](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis)
11. /[http](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http)
12. /[options](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http/options)
/
# AddressPredicate.java

Copy path Blame  Blame
## Latest commit

## History

[History](/cc-tweaked/CC-Tweaked/commits/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java)128 lines (104 loc) · 3.95 KB 96847bb
## Breadcrumbs

1. [CC-Tweaked](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b)
2. /[projects](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects)
3. /[core](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core)
4. /[src](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src)
5. /[main](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main)
6. /[java](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java)
7. /[dan200](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200)
8. /[computercraft](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft)
9. /[core](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core)
10. /[apis](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis)
11. /[http](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http)
12. /[options](/cc-tweaked/CC-Tweaked/tree/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http/options)
/
# AddressPredicate.java

Top
## File metadata and controls

* Code
* Blame

128 lines (104 loc) · 3.95 KB[Raw](https://github.com/cc-tweaked/CC-Tweaked/raw/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128// SPDX-FileCopyrightText: 2020 The CC: Tweaked Developers//// SPDX-License-Identifier: MPL-2.0
package dan200.computercraft.core.apis.http.options;
import com.google.common.net.InetAddresses;import org.slf4j.Logger;import org.slf4j.LoggerFactory;
import javax.annotation.Nullable;import java.net.InetAddress;import java.net.InetSocketAddress;import java.util.regex.Pattern;
/\*\* \* A predicate on an address. Matches against a domain and an ip address. \* \* @see AddressRule#apply(Iterable, String, InetSocketAddress) for the actual handling of this rule. \*/interface AddressPredicate { Logger LOG = LoggerFactory.getLogger(AddressPredicate.class);
 default boolean matches(String domain) { return false; }
 default boolean matches(InetAddress socketAddress) { return false; }
 final class HostRange implements AddressPredicate { private final byte[] min; private final byte[] max;
 HostRange(byte[] min, byte[] max) { this.min = min; this.max = max; }
 @Override public boolean matches(InetAddress address) { var entry = address.getAddress(); if (entry.length != min.length) return false;
 for (var i = 0; i < entry.length; i++) { var value = 0xFF & entry[i]; if (value < (0xFF & min[i]) || value > (0xFF & max[i])) return false; }
 return true; }
 @Nullable public static HostRange parse(String addressStr, String prefixSizeStr) { int prefixSize; try { prefixSize = Integer.parseInt(prefixSizeStr); } catch (NumberFormatException e) { LOG.error( "Malformed http whitelist/blacklist entry '{}': Cannot extract size of CIDR mask from '{}'.", addressStr + '/' + prefixSizeStr, prefixSizeStr ); return null; }
 InetAddress address; try { address = InetAddresses.forString(addressStr); } catch (IllegalArgumentException e) { LOG.error( "Malformed http whitelist/blacklist entry '{}': Cannot extract IP address from '{}'.", addressStr + '/' + prefixSizeStr, prefixSizeStr ); return null; }
 // Mask the bytes of the IP address. byte[] minBytes = address.getAddress(), maxBytes = address.getAddress(); var size = prefixSize; for (var i = 0; i < minBytes.length; i++) { if (size <= 0) { minBytes[i] = (byte) 0; maxBytes[i] = (byte) 0xFF; } else if (size < 8) { minBytes[i] = (byte) (minBytes[i] & 0xFF << (8 - size)); maxBytes[i] = (byte) (maxBytes[i] | ~(0xFF << (8 - size))); }
 size -= 8; }
 return new HostRange(minBytes, maxBytes); } }
 final class DomainPattern implements AddressPredicate { private final Pattern pattern;
 DomainPattern(Pattern pattern) { this.pattern = pattern; }
 @Override public boolean matches(String domain) { return pattern.matcher(domain).matches(); }
 @Override public boolean matches(InetAddress socketAddress) { return pattern.matcher(socketAddress.getHostAddress()).matches(); } }
 final class PrivatePattern implements AddressPredicate { static final PrivatePattern INSTANCE = new PrivatePattern();
 @Override public boolean matches(InetAddress socketAddress) { return socketAddress.isAnyLocalAddress() || socketAddress.isLoopbackAddress() || socketAddress.isLinkLocalAddress() || socketAddress.isSiteLocalAddress(); } }
}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_46e06a55_20250114_204009.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdan200%2FComputerCraft%2Fissues%2F170)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdan200%2FComputerCraft%2Fissues%2F170)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=dan200%2FComputerCraft)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dan200](/dan200)
/
**[ComputerCraft](/dan200/ComputerCraft)**
Public

* [Notifications](/login?return_to=%2Fdan200%2FComputerCraft) You must be signed in to change notification settings
* [Fork
  195](/login?return_to=%2Fdan200%2FComputerCraft)
* [Star
   984](/login?return_to=%2Fdan200%2FComputerCraft)

* [Code](/dan200/ComputerCraft)
* [Issues
  77](/dan200/ComputerCraft/issues)
* [Pull requests
  56](/dan200/ComputerCraft/pulls)
* [Actions](/dan200/ComputerCraft/actions)
* [Projects
  0](/dan200/ComputerCraft/projects)
* [Wiki](/dan200/ComputerCraft/wiki)
* [Security](/dan200/ComputerCraft/security)
* [Insights](/dan200/ComputerCraft/pulse)

Additional navigation options

* [Code](/dan200/ComputerCraft)
* [Issues](/dan200/ComputerCraft/issues)
* [Pull requests](/dan200/ComputerCraft/pulls)
* [Actions](/dan200/ComputerCraft/actions)
* [Projects](/dan200/ComputerCraft/projects)
* [Wiki](/dan200/ComputerCraft/wiki)
* [Security](/dan200/ComputerCraft/security)
* [Insights](/dan200/ComputerCraft/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdan200%2FComputerCraft%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdan200%2FComputerCraft%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Real world security] Http blacklist or similar #170

Closed

[JLLeitschuh](/JLLeitschuh) opened this issue
May 1, 2017
· 22 comments

Closed

# [[Real world security] Http blacklist or similar](#top) #170

[JLLeitschuh](/JLLeitschuh) opened this issue
May 1, 2017
· 22 comments

## Comments

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=80&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)

Copy link

Contributor

### **[JLLeitschuh](/JLLeitschuh)** commented [May 1, 2017](#issue-225552684) • edited Loading

| There are certain things you may not want your server users able to poke around with. For example, most routers are running on `192.168.1.1`. I really don't want people on my server able to poke around and access my router's admin console (I have a password but let's be honest here, how many people actually change the default password).  Many people running servers probably aren't using a hosting service and having the computer craft http module enabled currently gives players full access to the server's internal network.  Example:  ``` http.get("http://192.168.1.1"):readAll() ```  This will dump the HTML of most server's router web interfaces. It's a simple bit of code to go from here to tinkering with the server hosters router. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
2
 Wojbie and dmarcuse reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

[![@Wojbie](https://avatars.githubusercontent.com/u/5893536?s=80&u=6cffa0692076cc091682a3d8b890036d6692653a&v=4)](/Wojbie)

Copy link

Contributor

### **[Wojbie](/Wojbie)** commented [May 1, 2017](#issuecomment-298459302)

| Hmm... This post makes sense. We have a http whitelist. It would make sense to have a blacklist that can be set by server owner too if they wanted to protect some addresses while letting rest of internet be free. Unless there is some magic way to blacklist one (or few) addresses using current implementation of whitelist. |
| --- |

All reactions

Sorry, something went wrong.

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=80&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)

Copy link

Contributor

Author

### **[JLLeitschuh](/JLLeitschuh)** commented [May 2, 2017](#issuecomment-298478103) • edited Loading

| We also need to be wary of mDNS too. So things with `*.local` in the path should be disabled. There should probably be a setting that disables local http requests by default that can be enabled if the server owner feels like they know what they are doing. |
| --- |

All reactions

Sorry, something went wrong.

[![@paolobarbolini](https://avatars.githubusercontent.com/u/6215781?s=80&u=e58c99ddb79261393166eefd8d3af34ec786788a&v=4)](/paolobarbolini)

Copy link

### **[paolobarbolini](/paolobarbolini)** commented [May 2, 2017](#issuecomment-298511243) • edited Loading

| I think that RFC 1918 addresses should be blacklisted by default so that unexperienced users don't get hacked by computercraft computers on local servers or downloaded maps.  It should be possible to disable it so that contraptions like this one with a raspberry pi are still possible <https://youtu.be/86Zj_59P52c> |
| --- |

All reactions

Sorry, something went wrong.

[![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=80&u=30829b2d0cdfdbefcb5943088ead9be0300dd06f&v=4)](/SquidDev)

Copy link

Contributor

### **[SquidDev](/SquidDev)** commented [May 2, 2017](#issuecomment-298515912)

| I rather like the way CCTweaks and "The computer mod which Must Not Be Named" handle this: you can specify a blacklist and whitelist composed of host names and IP address, which can be in in the [CIDR](https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing) format. (so `example.com`, `127.0.0.0`, 127.0.0.0/8`).  `127.0.0.0/8`, `10.0.0.0/8`, `192.168.0.0/16`, `172.16.0.0/12` should be sufficient to block all local domains. When performing your HTTP request, you'd also need to resolve the host name to an IP address beforehand, so you can double check it hasn't been blacklisted. |
| --- |

 👍
2
 JLLeitschuh and SharkWipf reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=80&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)

Copy link

Contributor

Author

### **[JLLeitschuh](/JLLeitschuh)** commented [May 2, 2017](#issuecomment-298650603)

| It should be possible to disable it so that contraptions like this one with a raspberry pi are still possible <https://youtu.be/86Zj_59P52c>  I totally agree with this. That's really awesome. But yes, in the general use case it would be good to keep server owners safe from having their players hack their network. |
| --- |

All reactions

Sorry, something went wrong.

[![@dmarcuse](https://avatars.githubusercontent.com/u/5429337?s=80&v=4)](/dmarcuse)

Copy link

Contributor

### **[dmarcuse](/dmarcuse)** commented [May 2, 2017](#issuecomment-298696347)

| CC should also resolve hostnames before checking against the black/whitelist, otherwise you may still be able to access local devices if the server is running avahi or similar. |
| --- |

All reactions

Sorry, something went wrong.

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=80&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)

Copy link

Contributor

Author

### **[JLLeitschuh](/JLLeitschuh)** commented [May 2, 2017](#issuecomment-298711765)

| I agree, but the blacklist/whitelist needs to check the hostnames AND the resolved address, the admin could have declared the whitelist/blacklist with either.  Also, there needs to be a discussion about priority.  What takes priority? The whitelist or the blacklist? |
| --- |

All reactions

Sorry, something went wrong.

[![@paolobarbolini](https://avatars.githubusercontent.com/u/6215781?s=80&u=e58c99ddb79261393166eefd8d3af34ec786788a&v=4)](/paolobarbolini)

Copy link

### **[paolobarbolini](/paolobarbolini)** commented [May 2, 2017](#issuecomment-298714757)

| I think we should proritize the most specific filter, for example if i blacklist `192.168.0.0/16` and i whitelist `192.168.1.7`, i should be able to access `192.168.1.7` but not the rest of the /16 subnet. |
| --- |

All reactions

Sorry, something went wrong.

[![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=80&u=30829b2d0cdfdbefcb5943088ead9be0300dd06f&v=4)](/SquidDev)

Copy link

Contributor

### **[SquidDev](/SquidDev)** commented [May 2, 2017](#issuecomment-298716282) • edited Loading

| I would personally do something like:   * If whitelist is empty then ensure the IP and Host isn't in the blacklist. * If whitelist has elements and blacklist is empty, then ensure the IP or host is in the whitelist. * Otherwise they are both non-empty. Here the whitelist takes priority.   You could potentially leave out the last step, but I'd consider it useful - as [@paolobarbolini](https://github.com/paolobarbolini) says, it can be used to allow a limited number of local ips, while still blocking the rest. |
| --- |

 👍
3
 Wojbie, paolobarbolini, and oddstr13 reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=80&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)

Copy link

Contributor

Author

### **[JLLeitschuh](/JLLeitschuh)** commented [May 3, 2017](#issuecomment-298992608)

| Looks like the `InetAddress` library in java covers this use case nicely. I'm working on a PR that includes a few unit tests to make sure this works correctly.  ``` if (InetAddress.getByName(url.getHost()).isSiteLocalAddress()) {   // Do something } ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=80&u=30829b2d0cdfdbefcb5943088ead9be0300dd06f&v=4)](/SquidDev)

Copy link

Contributor

### **[SquidDev](/SquidDev)** commented [May 3, 2017](#issuecomment-298997336) • edited Loading

| [@JLLeitschuh](https://github.com/JLLeitschuh) It is worth noting that `InetAddress.getByName` will block the thread, which isn't really desirable. For requests this is easy to fix - you can just move the check inside the request thread. However, for `http.checkURL` you'd have to make it run on a separate thread and wait for an event.  From a configuration point of view, I'd rather the user can specify a whole list of IP addresses/ranges to block, rather than just using `isSiteLocalAddress()`. For IPv4 it's just `10/8`, `172.16/1`2 and `192.168/16`. Ipv6 seems to be `fec0:/120`. |
| --- |

All reactions

Sorry, something went wrong.

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=80&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)

Copy link

Contributor

Author

### **[JLLeitschuh](/JLLeitschuh)** commented [May 3, 2017](#issuecomment-299001981)

| I'm not sure what you mean by "run on a separate thread and wait for an event". How do I await an event to return a method call made in lua? Is there an example somewhere? |
| --- |

All reactions

Sorry, something went wrong.

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=40&u=477b44e744c9d63ec1386f1c728195936b42cbe7&v=4)](/JLLeitschuh)
[JLLeitschuh](/JLLeitschuh)
mentioned this issue
[May 3, 2017](#ref-issue-226110266)

[[Real world security] Http connections possible to local server network
MightyPirates/OpenComputers#2365](/MightyPirates/OpenComputers/issues/2365)

Closed

[![@Restioson](https://avatars.githubusercontent.com/u/6688948?s=80&v=4)](/Restioson)

Copy link

Contributor

### **[Restioson](/Restioson)** commented [May 4, 2017](#issuecomment-299234091)

| If this is implemented, please just keep in mind that routers can *also* be on `192.168.0.1` (mine is) |
| --- |

All reactions

Sorry, something went wrong.

[![@dmarcuse](https://avatars.githubusercontent.com/u/5429337?s=80&v=4)](/dmarcuse)

Copy link

Contributor

### **[dmarcuse](/dmarcuse)** commented [May 4, 2017](#issuecomment-299236170) • edited Loading

| [@Restioson](https://github.com/Restioson) that would be covered by `192.168.0.0/16` as mentioned above. |
| --- |

All reactions

Sorry, something went wrong.

[![@Restioson](https://avatars.githubusercontent.com/u/6688948?s=80&v=4)](/Restioson)

Copy link

Contributor

### **[Restioson](/Restioson)** commented [May 4, 2017](#issuecomment-299237618)

| @apemanzilla ah OK. I'm not really familiar with that syntax. I'll look it up. Sorry! |
| --- |

All reactions

Sorry, something went wrong.

[![@EngineerCoding](https://avatars.githubusercontent.com/u/4210459?s=80&v=4)](/EngineerCoding)

Copy link

### **[EngineerCoding](/EngineerCoding)** commented [May 5, 2017](#issuecomment-299343681) • edited Loading

| The flows should be like this:   1. Check if url/ip/whatever is on whitelist, serve if in this list. 2. Check if url/ip/whatever is on blacklist, don't serve if in list. 3. Check if only the whitelist is allowed (a boolean flag added to the settings), if so don't serve. Otherwise serve.   With this one can blacklist entire ranges and just enable just one specific IP. This is how Pihole does it anyway (without the boolean flag). It would be really clear to the user editing the config since the flow is fixed, and not based on empty/filled lists as [@SquidDev](https://github.com/SquidDev) suggests. |
| --- |

All reactions

Sorry, something went wrong.

[![@dan200](https://avatars.githubusercontent.com/u/1956716?s=80&v=4)](/dan200)

Copy link

Owner

### **[dan200](/dan200)** commented [May 7, 2017](#issuecomment-299720977)

| If someone wants to write a PR for this, I suggest the following:   * Allow the specification of IP wildcards in http\_whitelist * Add http\_blacklist, supporting both IP and domain wildcards * Set the default value of http\_blacklist to "192.168.*.*"   If we only supported blocking IPs, i'd prefer the /16 syntax apemanzilla suggests, but for this context it's better to be consistent with what's already there as it's clearer and more obvious to config editors who aren't network engineers.   Make the filtering logic work as follows: if( (address matches whitelist) && !(address matches blacklist) ) { serve(); } else { error(); } Remember that the default whitelist contains "\*", so I don't think we need a third flag or anything more complicated |
| --- |

All reactions

Sorry, something went wrong.

[![@dmarcuse](https://avatars.githubusercontent.com/u/5429337?s=80&v=4)](/dmarcuse)

Copy link

Contributor

### **[dmarcuse](/dmarcuse)** commented [May 7, 2017](#issuecomment-299722895) • edited Loading

| [@dan200](https://github.com/dan200) other private subnets (`10.0.0.0/24` and `172.16.0.0/20`) should also be blacklisted by default, they're often used in enterprise networks.  I'd suggest that we allow both `192.168.*.*` and `192.168.0.0/16` formats to be used for IPs, so you can use the more precise CIDR format or the simpler wildcard format.  I can start working on a PR for this. |
| --- |

All reactions

Sorry, something went wrong.

[![@dan200](https://avatars.githubusercontent.com/u/1956716?s=80&v=4)](/dan200)

Copy link

Owner

### **[dan200](/dan200)** commented [May 7, 2017](#issuecomment-299724616) via email

| Adding those ranges makes sense. Maybe add 127.0.0.1 as well? … On 7 May 2017 at 18:56, apemanzilla \*\*\*@\*\*\*.\*\*\*> wrote: [@dan200](https://github.com/dan200) <<https://github.com/dan200>> other private subnets (10.0.0.0/24 and 172.16.0.0/20) should also be blacklisted by default, they're often used in enterprise networks. I'd suggest that we allow both 192.168.\*.\* and 192.168.0.0/16 formats to be used, so you can use the more precise CIDR format or the simpler wildcard format. I can start working on a PR for this. — You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#170 (comment)](https://github.com/dan200/ComputerCraft/issues/170#issuecomment-299722895)>, or mute the thread <<https://github.com/notifications/unsubscribe-auth/AB3bbGSLh7eM_Nwt3dNpStNpJUYXU1Z0ks5r3gXdgaJpZM4NNjCD>> . |
| --- |

All reactions

Sorry, something went wrong.

[![@dmarcuse](https://avatars.githubusercontent.com/u/5429337?s=80&v=4)](/dmarcuse)

Copy link

Contributor

### **[dmarcuse](/dmarcuse)** commented [May 7, 2017](#issuecomment-299725896)

| `127.0.0.0/8`, but yeah good point. Are you OK with the wildcard and CIDR formats for IP ranges? |
| --- |

All reactions

Sorry, something went wrong.

[![@dan200](https://avatars.githubusercontent.com/u/1956716?s=80&v=4)](/dan200)

Copy link

Owner

### **[dan200](/dan200)** commented [May 7, 2017](#issuecomment-299725948)

| Yeah, if supporting both is easy, do it. |
| --- |

All reactions

Sorry, something went wrong.

[![@dmarcuse](https://avatars.githubusercontent.com/u/5429337?s=80&v=4)](/dmarcuse)

Copy link

Contributor

### **[dmarcuse](/dmarcuse)** commented [May 7, 2017](#issuecomment-299726433)

| Alright, I'll start on this in a bit. |
| --- |

All reactions

Sorry, something went wrong.

[![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=40&u=30829b2d0cdfdbefcb5943088ead9be0300dd06f&v=4)](/SquidDev)
[SquidDev](/SquidDev)
mentioned this issue
[May 11, 2017](#ref-issue-225472366)

[Suggestion - Web Sockets
#161](/dan200/ComputerCraft/issues/161)

Open

[![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=40&u=30829b2d0cdfdbefcb5943088ead9be0300dd06f&v=4)](/SquidDev)
[SquidDev](/SquidDev)
mentioned this issue
[Jun 11, 2017](#ref-pullrequest-235090586)

[HTTP blacklist and IP address support
#313](/dan200/ComputerCraft/pull/313)
 Merged

[![@dan200](https://avatars.githubusercontent.com/u/1956716?s=40&v=4)](/dan200)
[dan200](/dan200)
closed this as [completed](/dan200/ComputerCraft/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#313](/dan200/ComputerCraft/pull/313)
[Jun 28, 2017](#event-1143200116)

[![@Wojbie](https://avatars.githubusercontent.com/u/5893536?s=40&u=6cffa0692076cc091682a3d8b890036d6692653a&v=4)](/Wojbie)
[Wojbie](/Wojbie)
mentioned this issue
[Aug 13, 2017](#ref-issue-249879612)

[Why is localhost on the blacklist?
#418](/dan200/ComputerCraft/issues/418)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdan200%2FComputerCraft%2Fissues%2F170)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

8 participants

[![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=52&v=4)](/JLLeitschuh) [![@dan200](https://avatars.githubusercontent.com/u/1956716?s=52&v=4)](/dan200) [![@EngineerCoding](https://avatars.githubusercontent.com/u/4210459?s=52&v=4)](/EngineerCoding) [![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=52&v=4)](/SquidDev) [![@dmarcuse](https://avatars.githubusercontent.com/u/5429337?s=52&v=4)](/dmarcuse) [![@Wojbie](https://avatars.githubusercontent.com/u/5893536?s=52&v=4)](/Wojbie) [![@paolobarbolini](https://avatars.githubusercontent.com/u/6215781?s=52&v=4)](/paolobarbolini) [![@Restioson](https://avatars.githubusercontent.com/u/6688948?s=52&v=4)](/Restioson)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f07c0077_20250114_204005.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fcommit%2F4bbde8c50c00bc572578ab2cff609b3443d10ddf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fcommit%2F4bbde8c50c00bc572578ab2cff609b3443d10ddf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cc-tweaked%2FCC-Tweaked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cc-tweaked](/cc-tweaked)
/
**[CC-Tweaked](/cc-tweaked/CC-Tweaked)**
Public

* [Notifications](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked) You must be signed in to change notification settings
* [Fork
  217](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked)
* [Star
   961](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked)

* [Code](/cc-tweaked/CC-Tweaked)
* [Issues
  112](/cc-tweaked/CC-Tweaked/issues)
* [Pull requests
  11](/cc-tweaked/CC-Tweaked/pulls)
* [Discussions](/cc-tweaked/CC-Tweaked/discussions)
* [Actions](/cc-tweaked/CC-Tweaked/actions)
* [Projects
  0](/cc-tweaked/CC-Tweaked/projects)
* [Wiki](/cc-tweaked/CC-Tweaked/wiki)
* [Security](/cc-tweaked/CC-Tweaked/security)
* [Insights](/cc-tweaked/CC-Tweaked/pulse)

Additional navigation options

* [Code](/cc-tweaked/CC-Tweaked)
* [Issues](/cc-tweaked/CC-Tweaked/issues)
* [Pull requests](/cc-tweaked/CC-Tweaked/pulls)
* [Discussions](/cc-tweaked/CC-Tweaked/discussions)
* [Actions](/cc-tweaked/CC-Tweaked/actions)
* [Projects](/cc-tweaked/CC-Tweaked/projects)
* [Wiki](/cc-tweaked/CC-Tweaked/wiki)
* [Security](/cc-tweaked/CC-Tweaked/security)
* [Insights](/cc-tweaked/CC-Tweaked/pulse)

## Commit

[Permalink](/cc-tweaked/CC-Tweaked/commit/4bbde8c50c00bc572578ab2cff609b3443d10ddf)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Tighten up the $private HTTP rule

[Browse files](/cc-tweaked/CC-Tweaked/tree/4bbde8c50c00bc572578ab2cff609b3443d10ddf)
Browse the repository at this point in the history

```
 - Block multicast and the fd00::/8 address ranges.
 - Block several cloud metadata providers which sit outside the standard
   address ranges.
```

* Loading branch information

[![@SquidDev](https://avatars.githubusercontent.com/u/4346137?s=40&v=4)](/SquidDev)

[SquidDev](/cc-tweaked/CC-Tweaked/commits?author=SquidDev "View all commits by SquidDev")
committed
Jul 6, 2023

1 parent
[cc8c1f3](/cc-tweaked/CC-Tweaked/commit/cc8c1f38e7e15548c89f5da2f0ead7e1299ad9cc)

commit 4bbde8c

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**39 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* projects/core/src

  + main/java/dan200/computercraft/core/apis/http/options

    - projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java
      [AddressPredicate.java](#diff-ea8583fe82564e5dee4a7ee3e249b7d893cc82ef54ce6852fe0cc0cfec787770)
  + test/java/dan200/computercraft/core/apis/http/options

    - projects/core/src/test/java/dan200/computercraft/core/apis/http/options/AddressRuleTest.java
      [AddressRuleTest.java](#diff-a3d2828abe0a47222aab90cb663f2a9a27fb3ab872aec043160d2d555b940868)

## There are no files selected for viewing

35 changes: 31 additions & 4 deletions

35
[...ects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java](#diff-ea8583fe82564e5dee4a7ee3e249b7d893cc82ef54ce6852fe0cc0cfec787770 "projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java")

Show comments

[View file](/cc-tweaked/CC-Tweaked/blob/4bbde8c50c00bc572578ab2cff609b3443d10ddf/projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,9 +6,13 @@ |
|  |  |  |
|  |  | import com.google.common.net.InetAddresses; |
|  |  |  |
|  |  | import java.net.Inet6Address; |
|  |  | import java.net.InetAddress; |
|  |  | import java.net.InetSocketAddress; |
|  |  | import java.util.Arrays; |
|  |  | import java.util.Set; |
|  |  | import java.util.regex.Pattern; |
|  |  | import java.util.stream.Collectors; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* A predicate on an address. Matches against a domain and an ip address. |
| Expand Down  Expand Up | | @@ -107,12 +111,35 @@ public boolean matches(InetAddress socketAddress) { |
|  |  | final class PrivatePattern implements AddressPredicate { |
|  |  | static final PrivatePattern INSTANCE = new PrivatePattern(); |
|  |  |  |
|  |  | private static final Set<InetAddress> additionalAddresses = Arrays.stream(new String[]{ |
|  |  | // Block various cloud providers internal IPs. |
|  |  | "100.100.100.200", // Alibaba |
|  |  | "192.0.0.192", // Oracle |
|  |  | }).map(InetAddresses::forString).collect(Collectors.toUnmodifiableSet()); |
|  |  |  |
|  |  | @Override |
|  |  | public boolean matches(InetAddress socketAddress) { |
|  |  | return socketAddress.isAnyLocalAddress() |
|  |  | || socketAddress.isLoopbackAddress() |
|  |  | || socketAddress.isLinkLocalAddress() |
|  |  | || socketAddress.isSiteLocalAddress(); |
|  |  | return |
|  |  | socketAddress.isAnyLocalAddress() // 0.0.0.0, ::0 |
|  |  | || socketAddress.isLoopbackAddress() // 127.0.0.0/8, ::1 |
|  |  | || socketAddress.isLinkLocalAddress() // 169.254.0.0/16, fe80::/10 |
|  |  | || socketAddress.isSiteLocalAddress() // 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, fec0::/10 |
|  |  | || socketAddress.isMulticastAddress() // 224.0.0.0/4, ff00::/8 |
|  |  | || isUniqueLocalAddress(socketAddress) // fd00::/8 |
|  |  | || additionalAddresses.contains(socketAddress); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Determine if an IP address lives inside the ULA address range. |
|  |  | \* |
|  |  | \* @param address The IP address to test. |
|  |  | \* @return Whether this address sits in the ULA address range. |
|  |  | \* @see <a href="https://en.wikipedia.org/wiki/Unique\_local\_address">Unique local address on Wikipedia</a> |
|  |  | \*/ |
|  |  | private boolean isUniqueLocalAddress(InetAddress address) { |
|  |  | // ULA is actually defined as fc00::/7 (so both fc00::/8 and fd00::/8). However, only the latter is actually |
|  |  | // defined right now, so let's be conservative. |
|  |  | return address instanceof Inet6Address && (address.getAddress()[0] & 0xff) == 0xfd; |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

9 changes: 8 additions & 1 deletion

9
[projects/core/src/test/java/dan200/computercraft/core/apis/http/options/AddressRuleTest.java](#diff-a3d2828abe0a47222aab90cb663f2a9a27fb3ab872aec043160d2d555b940868 "projects/core/src/test/java/dan200/computercraft/core/apis/http/options/AddressRuleTest.java")

Show comments

[View file](/cc-tweaked/CC-Tweaked/blob/4bbde8c50c00bc572578ab2cff609b3443d10ddf/projects/core/src/test/java/dan200/computercraft/core/apis/http/options/AddressRuleTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,7 +31,14 @@ public void matchesPort() { |
|  |  | @ValueSource(strings = { |
|  |  | "0.0.0.0", "[::]", |
|  |  | "localhost", "127.0.0.1.nip.io", "127.0.0.1", "[::1]", |
|  |  | "172.17.0.1", "192.168.1.114", "[0:0:0:0:0:ffff:c0a8:172]", "10.0.0.1" |
|  |  | "172.17.0.1", "192.168.1.114", "[0:0:0:0:0:ffff:c0a8:172]", "10.0.0.1", |
|  |  | // Multicast |
|  |  | "224.0.0.1", "ff02::1", |
|  |  | // Cloud metadata providers |
|  |  | "100.100.100.200", // Alibaba |
|  |  | "192.0.0.192", // Oracle |
|  |  | "fd00:ec2::254", // AWS |
|  |  | "169.254.169.254", // AWS, Digital Ocean, GCP, etc.. |
|  |  | }) |
|  |  | public void blocksLocalDomains(String domain) { |
|  |  | assertEquals(apply(CoreConfig.httpRules, domain, 80).action, Action.DENY); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4bbde8c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fcommit%2F4bbde8c50c00bc572578ab2cff609b3443d10ddf) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f05e6262_20250114_204006.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fsecurity%2Fadvisories%2FGHSA-7p4w-mv69-2wm2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-tweaked%2FCC-Tweaked%2Fsecurity%2Fadvisories%2FGHSA-7p4w-mv69-2wm2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=cc-tweaked%2FCC-Tweaked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cc-tweaked](/cc-tweaked)
/
**[CC-Tweaked](/cc-tweaked/CC-Tweaked)**
Public

* [Notifications](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked) You must be signed in to change notification settings
* [Fork
  217](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked)
* [Star
   961](/login?return_to=%2Fcc-tweaked%2FCC-Tweaked)

* [Code](/cc-tweaked/CC-Tweaked)
* [Issues
  112](/cc-tweaked/CC-Tweaked/issues)
* [Pull requests
  11](/cc-tweaked/CC-Tweaked/pulls)
* [Discussions](/cc-tweaked/CC-Tweaked/discussions)
* [Actions](/cc-tweaked/CC-Tweaked/actions)
* [Projects
  0](/cc-tweaked/CC-Tweaked/projects)
* [Wiki](/cc-tweaked/CC-Tweaked/wiki)
* [Security](/cc-tweaked/CC-Tweaked/security)
* [Insights](/cc-tweaked/CC-Tweaked/pulse)

Additional navigation options

* [Code](/cc-tweaked/CC-Tweaked)
* [Issues](/cc-tweaked/CC-Tweaked/issues)
* [Pull requests](/cc-tweaked/CC-Tweaked/pulls)
* [Discussions](/cc-tweaked/CC-Tweaked/discussions)
* [Actions](/cc-tweaked/CC-Tweaked/actions)
* [Projects](/cc-tweaked/CC-Tweaked/projects)
* [Wiki](/cc-tweaked/CC-Tweaked/wiki)
* [Security](/cc-tweaked/CC-Tweaked/security)
* [Insights](/cc-tweaked/CC-Tweaked/pulse)

# SSRF to Cloud (AWS, GCP, Azure) Services Metadata Services (IMDS) not Blocked by Default

Critical

[SquidDev](/SquidDev)
published
GHSA-7p4w-mv69-2wm2
Jul 7, 2023

## Package

CC-Tweaked
(Minecraft Mod)

## Affected versions

All

## Patched versions

1.106.0

maven

cc.tweaked:cc-tweaked-1.19.3-core
([Maven](/advisories?query=ecosystem%3Amaven))

All

None

maven

cc.tweaked:cc-tweaked-1.19.4-core
([Maven](/advisories?query=ecosystem%3Amaven))

All

1.106.0

## Description

### Summary

If the cc-tweaked plugin is running on a Minecraft server hosted on a popular cloud hosting providers, like AWS, GCP, and Azure, those metadata services API endpoints are not forbidden (aka "blacklisted") by default. As such, any player can gain access to sensitive information exposed via those metadata servers, potentially allowing them to pivot or privilege escalate into the hosting provider.

This is a follow up of a vulnerability that [@JLLeitschuh](https://github.com/JLLeitschuh) also reported back in 2017: [dan200/ComputerCraft#170](https://github.com/dan200/ComputerCraft/issues/170)

### Details

The default set of patterns that are forbidden by CC-Tweaked are defined by this predicate:

[CC-Tweaked/projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java](https://github.com/cc-tweaked/CC-Tweaked/blob/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b/projects/core/src/main/java/dan200/computercraft/core/apis/http/options/AddressPredicate.java#L116-L126)

Lines 116 to 126
in
[96847bb](/cc-tweaked/CC-Tweaked/commit/96847bb8c28df51e5e49f2dd2978ff6cc4e2821b)

|  | final class PrivatePattern implements AddressPredicate { |
| --- | --- |
|  | static final PrivatePattern INSTANCE = new PrivatePattern(); |
|  |  |
|  | @Override |
|  | public boolean matches(InetAddress socketAddress) { |
|  | return socketAddress.isAnyLocalAddress() |
|  | || socketAddress.isLoopbackAddress() |
|  | || socketAddress.isLinkLocalAddress() |
|  | || socketAddress.isSiteLocalAddress(); |
|  | } |
|  | } |

This, by default, this does include the IP or Domains that most IMDS use:

* IPv4: `169.254.169.254`
* `metadata.google.internal` (in the case of GCP)

However, this, by default, does not include the IPs used by other popular IMDS:

* Oracle Cloud: `192.0.0.192`
* Alibaba Cloud: `100.100.100.200`
* AWS: `fd00:ec2::254`

### PoC

```
http.get("http://100.100.100.200/[cloud host specific path]"):readAll()

```
### Impact

This can allow a player on a server, using a cc-tweaked computer to retrieve sensitive information like:

* User-data passed to the system at boot time (could contain secrets)
* IAM role credentials (could allow access to the greater AWS cloud account)
* Managed identity credentials (could allow access to the Azure account)
* Service account tokens (allowing access to the GCP account)

### References

* <https://www.sans.org/blog/cloud-instance-metadata-services-imds-/>
* <https://hackingthe.cloud/gcp/general-knowledge/metadata_in_google_cloud_instances/>
* <https://hackingthe.cloud/aws/general-knowledge/intro_metadata_service/>
* <https://security.alibaba.com/announcement/announcement?id=194>

### Related

* [GHSA-vvfj-xh7c-j2cm](https://github.com/MightyPirates/OpenComputers/security/advisories/GHSA-vvfj-xh7c-j2cm "GHSA-vvfj-xh7c-j2cm")

### Severity

Critical

9.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N

### CVE ID

CVE-2023-37262

### Weaknesses

[CWE-918](/advisories?query=cwe%3A918)

### Credits

* [![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=40&v=4)](/JLLeitschuh)
  [JLLeitschuh](/JLLeitschuh)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


