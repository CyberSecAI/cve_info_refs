- **Root cause of vulnerability**: The `pacparser_find_proxy()` function in `pacparser` uses `strcat()` to construct a JavaScript string that includes the URL and host parameters. It sanitizes single quotes using URL encoding but does not account for backslashes which can escape the closing single quote in the string, leading to a JavaScript injection vulnerability.
- **Weaknesses/vulnerabilities present**: JavaScript injection vulnerability due to insufficient input sanitization.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code by injecting it into the URL, potentially allowing them to manipulate proxy settings, bypass security controls, or execute malicious code, especially if the application runs with elevated privileges. The use of an old SpiderMonkey version could allow for breaking out of the sandbox, with potential local privilege escalation. An attacker can also override functions like `findProxyForURL()` to return arbitrary proxy values.
- **Attack vectors**:  By manipulating the URL, specifically adding a backslash, the attacker can inject arbitrary JavaScript code into the string constructed by `pacparser_find_proxy()`.
- **Required attacker capabilities/position**:  The attacker needs the ability to control the URL parameter passed to the `pacparser_find_proxy()` function.