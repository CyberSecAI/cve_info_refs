- **Root cause of vulnerability:** The application allows users to input custom code in the header section, which is then rendered without proper sanitization, leading to a stored Cross-Site Scripting (XSS) vulnerability.
- **Weaknesses/vulnerabilities present:** Stored XSS vulnerability exists due to the lack of sanitization of user-supplied input in the header section.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that executes when an administrator visits a page, allowing for session hijacking via cookie disclosure, revealing the website's root path, PHP variables, and potentially gaining control of the administrator's session.
- **Attack vectors:** The attack vector is through the "站点设置" (Site Settings) where an attacker can insert a malicious payload into the "头部(header)代码 - 用户" field (Header code - user field).
- **Required attacker capabilities/position:** An attacker needs to have a registered account on the application with the ability to access and modify site settings. In this case, the default setting allows free registration. The attacker also needs to target an admin user to trigger the payload.