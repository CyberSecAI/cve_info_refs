=== Content from phabricator.wikimedia.org_2d838532_20250115_080547.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT330968)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T330968
# CVE-2023-37252: Special:CheckUserLog shows usernames which have been hiddenClosed, Resolved[Public](/policy/explain/PHID-TASK-66yjdudlpzsyn5cjxeeq/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/330968/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/330968/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* [Protect as security issue](/wmf/escalate-task/330968/)
* [Award Token](/token/give/PHID-TASK-66yjdudlpzsyn5cjxeeq/)
* [Flag For Later](/flag/edit/PHID-TASK-66yjdudlpzsyn5cjxeeq/)

Assigned To

|  | [Dreamy\_Jazz](/p/Dreamy_Jazz/) |
| --- | --- |

Authored By

|  | [Dreamy\_Jazz](/p/Dreamy_Jazz/) |
| --- | --- |
| Mar 2 2023, 2:48 AM2023-03-02 02:48:39 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Security](/tag/security/)
* [CheckUser](/tag/checkuser/) [(Inbox)](/project/board/203/)
* [Vuln-Infoleak](/tag/vuln-infoleak/)
* [SecTeam-Processed](/tag/secteam-processed/) [(Completed)](/project/board/5180/)
* [Patch-For-Review](/tag/patch-for-review/)
Referenced Files

|  | [F37109833: T330968-api.patch](/F37109833) |
| --- | --- |
| Jun 20 2023, 12:01 AM2023-06-20 00:01:23 (UTC+0) |

|  | [F37109794: T330968-api.patch](/F37109794) |
| --- | --- |
| Jun 19 2023, 10:05 PM2023-06-19 22:05:37 (UTC+0) |

|  | [F36912558: image.png](/F36912558) |
| --- | --- |
| Mar 15 2023, 11:21 AM2023-03-15 11:21:17 (UTC+0) |

|  | [F36912559: image.png](/F36912559) |
| --- | --- |
| Mar 15 2023, 11:21 AM2023-03-15 11:21:17 (UTC+0) |

|  | [F36912550: image.png](/F36912550) |
| --- | --- |
| Mar 15 2023, 11:19 AM2023-03-15 11:19:38 (UTC+0) |

|  | [F36912548: image.png](/F36912548) |
| --- | --- |
| Mar 15 2023, 11:19 AM2023-03-15 11:19:38 (UTC+0) |

|  | [F36912547: T330968.patch](/F36912547) |
| --- | --- |
| Mar 15 2023, 11:19 AM2023-03-15 11:19:38 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [Dreamy\_Jazz](/p/Dreamy_Jazz/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [mmartorana](/p/mmartorana/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

|  | [Xaosflux](/p/Xaosflux/) |
| --- | --- |

|  | [Zabe](/p/Zabe/) |
| --- | --- |

# Description

Steps to reproduce:

* Find a user who has been hidden as part of their block (With "Hide username from edits and lists" checked)
* Log into an account that has the checkuser-log right (on WMF wikis this all users with steward or checkuser groups as well as ombuds) and importantly not the suppress right.
* Either search for the hidden username or find the username in the log with no applied filters, noting that the hidden username is shown.

**What should have happened**

The hidden username should not have been displayed. Instead (similar to Special:Log) it should be possible to search by the hidden username but not see the hidden username displayed in the log entries.

**Other info**

Reproduced this issue on the English Wikipedia by asking a non-suppressor checkuser to load the log for a check on a hidden user.

Status:

* Special:CheckUserLog - patch deployed
* CheckUser API - patch uploaded to task and in review
# Details

Risk Rating Low Author Affiliation Wikimedia Communities

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [Fix constructor, missing use. Follow up to fa250d83ecc77](https://gerrit.wikimedia.org/r/c/941399) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_38](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_38) | +2 -0 |
|  | [SECURITY: Hide hidden users in CheckUserLog API](https://gerrit.wikimedia.org/r/c/935439) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_35](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_35) | +21 -0 |
|  | [SECURITY: Hide hidden users in Special:CheckUserLog](https://gerrit.wikimedia.org/r/c/935474) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_35](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_35) | +56 -3 |
|  | [SECURITY: Hide hidden users in CheckUserLog API](https://gerrit.wikimedia.org/r/c/933919) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_38](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_38) | +30 -2 |
|  | [SECURITY: Hide hidden users in CheckUserLog API](https://gerrit.wikimedia.org/r/c/933916) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_39](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_39) | +32 -2 |
|  | [SECURITY: Hide hidden users in Special:CheckUserLog](https://gerrit.wikimedia.org/r/c/934390) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_39](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_39) | +79 -17 |
|  | [SECURITY: Hide hidden users in Special:CheckUserLog](https://gerrit.wikimedia.org/r/c/934392) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_38](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_38) | +81 -7 |
|  | [SECURITY: Hide hidden users in Special:CheckUserLog](https://gerrit.wikimedia.org/r/c/933686) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/master) | +77 -17 |
|  | [SECURITY: Hide hidden users in CheckUserLog API](https://gerrit.wikimedia.org/r/c/932822) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/master) | +29 -3 |
|  | [SECURITY: Hide hidden users in CheckUserLog API](https://gerrit.wikimedia.org/r/c/933630) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_40) | +29 -3 |
|  | [SECURITY: Hide hidden users in Special:CheckUserLog](https://gerrit.wikimedia.org/r/c/933631) | [mediawiki/extensions/CheckUser](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser) | [REL1\_40](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/CheckUser/%2B/REL1_40) | +77 -17 |

Show related patches [Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T330968)
# Related Objects

* Mentions

Mentioned In [T340874: Write and send supplementary release announcement for extensions and skins with security patches (1.35.12/1.39.5/1.40.1)](/T340874)
[T333626: Write and send supplementary release announcement for extensions and skins with security patches (1.35.11/1.38.7/1.39.4/1.40.0)](/T333626) Mentioned Here [T333626: Write and send supplementary release announcement for extensions and skins with security patches (1.35.11/1.38.7/1.39.4/1.40.0)](/T333626)
[T326865: CVE-2024-40597: Special:CheckUser can expose suppressed information for log events](/T326865)
### Event Timeline

[Dreamy\_Jazz](/p/Dreamy_Jazz/) created this task.[Mar 2 2023, 2:48 AM2023-03-02 02:48:39 (UTC+0)](#8659284)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/5210084/)[Mar 2 2023, 2:48 AM2023-03-02 02:48:41 (UTC+0)](#8659295)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a project: [CheckUser](/tag/checkuser/).[Mar 2 2023, 2:48 AM2023-03-02 02:48:53 (UTC+0)](#8659296)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a project: [Vuln-Infoleak](/tag/vuln-infoleak/).[Mar 2 2023, 2:56 AM2023-03-02 02:56:56 (UTC+0)](#8659297)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-6zg6cxogm7ngofb/)[Mar 2 2023, 3:02 AM2023-03-02 03:02:31 (UTC+0)](#8659316)[sbassett](/p/sbassett/) subscribed.Edited · [Mar 2 2023, 3:49 PM2023-03-02 15:49:16 (UTC+0)](#8661175)Comment Actions
> Instead (similar to Special:Log) it should be possible to search by the hidden username but not see the hidden username displayed in the log entries.

Well, you can *kind of* search by a hidden username, but only if you know it, right? When I search for hidden/suppressed usernames at enwiki/Special:Log, as performers or targets, I get the red text and no auto-complete in the search input, like I would for non-existent users, e.g. <https://w.wiki/6PwK>. With my staff rights, I can then view details about them below (blocks, etc.), for anons and unprivileged users, those details do not show up. But I do not get any obvious clues from the search inputs that hidden users ever existed.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.Edited · [Mar 2 2023, 4:16 PM2023-03-02 16:16:40 (UTC+0)](#8661293)Comment Actions

Yeah. I'm hoping that the Special:Log interface of being able to search by it *if you already know the username* would be how the Special:CheckUserLog would work once this is resolved. The CheckUserLog already does not auto-suggest usernames which have been hidden, but someone who doesn't know it could see it when scrolling through the log with no filters enabled.

[mmartorana](/p/mmartorana/) changed the task status from Open to In Progress.[Mar 13 2023, 5:47 PM2023-03-13 17:47:52 (UTC+0)](#8688844)[mmartorana](/p/mmartorana/) triaged this task as Medium priority.[mmartorana](/p/mmartorana/) changed Risk Rating from N/A to Low.[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 15 2023, 10:25 AM2023-03-15 10:25:49 (UTC+0)](#8696929)Comment Actions

Working on a patch.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.Edited · [Mar 15 2023, 11:19 AM2023-03-15 11:19:38 (UTC+0)](#8697127)Comment Actions

T330968.patch7 KB[Download](https://phab.wmfusercontent.org/file/download/azkabv4dhw23znbso3lv/PHID-FILE-etszff24ceblsw5utkcg/T330968.patch)

For the above patch:

| Rights the user has | Before | After |
| --- | --- | --- |
| hideuser (through suppressor group) | [image.png (1×1 px, 339 KB)](https://phab.wmfusercontent.org/file/data/oo56exbsuazq2thya7f5/PHID-FILE-r3axk72idufokp3jqdqm/image.png) | [image.png (1×1 px, 346 KB)](https://phab.wmfusercontent.org/file/data/lkypsspiickj55jrojgm/PHID-FILE-iek63q22hq7t2q7i427c/image.png) |
| no hideuser right | [image.png (1×1 px, 337 KB)](https://phab.wmfusercontent.org/file/data/h74xw4znmxntpeifcwig/PHID-FILE-hcvtukyxoofxnjjqla2s/image.png) | [image.png (1×1 px, 362 KB)](https://phab.wmfusercontent.org/file/data/t46k4s23tyg3pfv2quaq/PHID-FILE-rh73wotqmkvpqxaqhs54/image.png) |
|

The "Show IP" button being italic when the user is hidden is a separate issue and is out of the scope for this task.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) claimed this task.[Mar 15 2023, 11:20 AM2023-03-15 11:20:02 (UTC+0)](#8697130)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Dreamy\_Jazz](/p/Dreamy_Jazz/) attached a referenced file: [F36912558: image.png](/F36912558). [(Show Details)](/transactions/detail/PHID-XACT-TASK-nvq2353ksgb3rx5/)[Dreamy\_Jazz](/p/Dreamy_Jazz/) attached a referenced file: [F36912559: image.png](/F36912559). [(Show Details)](/transactions/detail/PHID-XACT-TASK-adab4jhadmtr3sl/)[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Security Patch To Deploy](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Mar 22 2023, 5:19 PM2023-03-22 17:19:07 (UTC+0)](#8718716)[Xaosflux](/p/Xaosflux/) subscribed.[Mar 24 2023, 4:34 PM2023-03-24 16:34:11 (UTC+0)](#8725309)[Xaosflux](/p/Xaosflux/) added a comment.[Mar 24 2023, 4:37 PM2023-03-24 16:37:11 (UTC+0)](#8725316)Comment Actions

Related? A checkuser (who is not a suppresser) reporting that when running a check, the already locally suppressed/globally hidden username still appeared in a cu report, e.g:

• User logs 1:23:45 (Username or IP removed) Successfully logged in to Wikipedia as HIDDENUSERNAMEHERE

IP: 1.1.1.1 USERAGENTHERE

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 24 2023, 4:40 PM2023-03-24 16:40:44 (UTC+0)](#8725335)Comment Actions

[@Xaosflux](/p/Xaosflux/) that would be covered under [T326865](/T326865). While the exposed information is similar, this task fixes Special:CheckUserLog while the issue you mention is for Special:CheckUser/Special:Investigate. That leak of information you mention needs many other fixes to make it possible to be fixed.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 24 2023, 4:43 PM2023-03-24 16:43:04 (UTC+0)](#8725340)Comment Actions

A fix is also likely needed for the CheckUserLog API, but I have not tested this yet. My in review patch only fixes Special:CheckUserLog.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-o6dlpcdkkzayg3j/)[Mar 24 2023, 4:43 PM2023-03-24 16:43:49 (UTC+0)](#8725343)[Zabe](/p/Zabe/) subscribed.[Mar 27 2023, 11:31 PM2023-03-27 23:31:37 (UTC+0)](#8731820)Comment Actions
> In [T330968#8697127](/T330968#8697127), [@Dreamy\_Jazz](/p/Dreamy_Jazz/) wrote:
>
> T330968.patch7 KB[Download](https://phab.wmfusercontent.org/file/download/azkabv4dhw23znbso3lv/PHID-FILE-etszff24ceblsw5utkcg/T330968.patch)

[Deployed](https://sal.toolforge.org/log/YRhpJYcB0IdT-khDU7mM)

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Mar 28 2023, 2:36 PM2023-03-28 14:36:09 (UTC+0)](#8735023)Comment Actions

Thanks

[sbassett](/p/sbassett/) moved this task from [Security Patch To Deploy](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Apr 3 2023, 4:15 PM2023-04-03 16:15:08 (UTC+0)](#8751242)[sbassett](/p/sbassett/) mentioned this in [T333626: Write and send supplementary release announcement for extensions and skins with security patches (1.35.11/1.38.7/1.39.4/1.40.0)](/T333626).[Apr 4 2023, 9:09 PM2023-04-04 21:09:48 (UTC+0)](#8756904)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-iiwgwhalymsuocc/)[Apr 4 2023, 9:14 PM2023-04-04 21:14:25 (UTC+0)](#8756912)[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Jun 19 2023, 10:05 PM2023-06-19 22:05:37 (UTC+0)](#8947633)Comment Actions

Testing locally showed that the API also has the same problem. Patch for the API code (tested locally):

T330968-api.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/oijb6e7n346pu4seizh3/PHID-FILE-neksjakzmbom4xj7qvll/T330968-api.patch)

[Dreamy\_Jazz](/p/Dreamy_Jazz/) moved this task from [Watching](/project/board/1179/) to [Security Patch To Deploy](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 19 2023, 10:05 PM2023-06-19 22:05:49 (UTC+0)](#8947634)[Dreamy\_Jazz](/p/Dreamy_Jazz/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-7ppjbp7wvadvnl5/)[Zabe](/p/Zabe/) added a comment.[Jun 19 2023, 11:45 PM2023-06-19 23:45:37 (UTC+0)](#8947655)Comment Actions

When trying to deploy this <https://test.wikipedia.org/w/api.php?action=query&format=json&prop=&list=checkuserlog&formatversion=2> delivered the following error (no idea why).

```
[4eb02b83-1362-4327-ac17-1a9c9383c680] /w/api.php   Error: Call to a member function isHidden() on null
from /srv/mediawiki/php-1.41.0-wmf.13/extensions/CheckUser/src/Api/ApiQueryCheckUserLog.php(136)
#0 /srv/mediawiki/php-1.41.0-wmf.13/includes/api/ApiQuery.php(662): MediaWiki\CheckUser\Api\ApiQueryCheckUserLog->execute()
#1 /srv/mediawiki/php-1.41.0-wmf.13/includes/api/ApiMain.php(1913): ApiQuery->execute()
#2 /srv/mediawiki/php-1.41.0-wmf.13/includes/api/ApiMain.php(890): ApiMain->executeAction()
#3 /srv/mediawiki/php-1.41.0-wmf.13/includes/api/ApiMain.php(861): ApiMain->executeActionWithErrorHandling()
#4 /srv/mediawiki/php-1.41.0-wmf.13/api.php(95): ApiMain->execute()
#5 /srv/mediawiki/php-1.41.0-wmf.13/api.php(48): wfApiMain()
#6 /srv/mediawiki/w/api.php(3): require(string)
#7 {main}
```

```
wikiadmin2023@10.64.132.14(testwiki)> select * from cu_log order by cul_id desc limit 1\G
*************************** 1. row ***************************
                 cul_id: 1300
          cul_timestamp: 20230619233956
               cul_type: useredits
          cul_target_id: 54726
        cul_target_text: Zabe (test 5)
         cul_target_hex:
        cul_range_start:
          cul_range_end:
              cul_actor: 111536
          cul_reason_id: 238728
cul_reason_plaintext_id: 238728
1 row in set (0.001 sec)

wikiadmin2023@10.64.132.14(testwiki)>
```

The account Zabe (test 5) was suppressed while performing the api request.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Jun 20 2023, 12:01 AM2023-06-20 00:01:23 (UTC+0)](#8947658)Comment Actions

Apologies, didn't test how IPs would be treated as I tested by looking for entries through filtering by username. newFromName returns null for IPs. Updated patch (that null checks):

T330968-api.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/6gtd66npmzk3mv4jmx6b/PHID-FILE-pxsa3m2j4fc7hriimqrl/T330968-api.patch)

[Zabe](/p/Zabe/) added a comment.[Jun 20 2023, 12:14 AM2023-06-20 00:14:42 (UTC+0)](#8947661)Comment Actions
> In [T330968#8947658](/T330968#8947658), [@Dreamy\_Jazz](/p/Dreamy_Jazz/) wrote:
>
> Apologies, didn't test how IPs would be treated as I tested by looking for entries through filtering by username. newFromName returns null for IPs. Updated patch (that null checks):
>
> T330968-api.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/6gtd66npmzk3mv4jmx6b/PHID-FILE-pxsa3m2j4fc7hriimqrl/T330968-api.patch)

Thanks, deployed: <https://sal.toolforge.org/log/Uq0m1ogBhuQtenzv6PNe>

[sbassett](/p/sbassett/) moved this task from [Security Patch To Deploy](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 20 2023, 5:04 PM2023-06-20 17:04:58 (UTC+0)](#8950024)[sbassett](/p/sbassett/) edited projects, added [SecTeam-Processed](/tag/secteam-processed/); removed [Patch-For-Review](/tag/patch-for-review/).Comment Actions
> In [T330968#8947661](/T330968#8947661), [@Zabe](/p/Zabe/) wrote:
> > In [T330968#8947658](/T330968#8947658), [@Dreamy\_Jazz](/p/Dreamy_Jazz/) wrote:
> >
> > Apologies, didn't test how IPs would be treated as I tested by looking for entries through filtering by username. newFromName returns null for IPs. Updated patch (that null checks):
> >
> > T330968-api.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/6gtd66npmzk3mv4jmx6b/PHID-FILE-pxsa3m2j4fc7hriimqrl/T330968-api.patch)
>
> Thanks, deployed: <https://sal.toolforge.org/log/Uq0m1ogBhuQtenzv6PNe>

Thanks for the patch and deploy. Tracking at T276237 and for the upcoming supplemental release [T333626](/T333626).

[Mstyles](/p/Mstyles/) added a subscriber: [gerritbot](/p/gerritbot/).[Jun 27 2023, 11:00 PM2023-06-27 23:00:21 (UTC+0)](#8970009)[gerritbot](/p/gerritbot/) added a comment.[Jun 27 2023, 11:10 PM2023-06-27 23:10:56 (UTC+0)](#8970053)Comment Actions

Change 932822 had a related patch set uploaded (by Mstyles; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@master] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/932822>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Jun 27 2023, 11:10 PM2023-06-27 23:10:59 (UTC+0)](#8970055)[gerritbot](/p/gerritbot/) added a comment.[Jun 27 2023, 11:40 PM2023-06-27 23:40:15 (UTC+0)](#8970119)Comment Actions

Change 933686 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@master] Hide hidden users from users without hideuser right on CheckUserLog

<https://gerrit.wikimedia.org/r/933686>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 12:09 AM2023-06-28 00:09:21 (UTC+0)](#8970185)Comment Actions

Change 933630 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_40] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/933630>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 12:10 AM2023-06-28 00:10:55 (UTC+0)](#8970187)Comment Actions

Change 933631 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_40] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/933631>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 10:21 AM2023-06-28 10:21:00 (UTC+0)](#8971056)Comment Actions

Change 933631 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_40] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/933631>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 10:21 AM2023-06-28 10:21:05 (UTC+0)](#8971057)Comment Actions

Change 933630 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_40] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/933630>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 10:36 AM2023-06-28 10:36:15 (UTC+0)](#8971111)Comment Actions

Change 933686 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@master] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/933686>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 10:36 AM2023-06-28 10:36:21 (UTC+0)](#8971114)Comment Actions

Change 932822 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@master] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/932822>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 2:44 PM2023-06-28 14:44:40 (UTC+0)](#8973683)Comment Actions

Change 933916 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_39] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/933916>

[gerritbot](/p/gerritbot/) added a comment.[Jun 28 2023, 2:59 PM2023-06-28 14:59:05 (UTC+0)](#8973745)Comment Actions

Change 933919 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_38] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/933919>

[gerritbot](/p/gerritbot/) added a comment.[Jun 29 2023, 5:41 PM2023-06-29 17:41:46 (UTC+0)](#8977454)Comment Actions

Change 934390 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_39] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/934390>

[gerritbot](/p/gerritbot/) added a comment.[Jun 29 2023, 5:51 PM2023-06-29 17:51:03 (UTC+0)](#8977519)Comment Actions

Change 934392 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_38] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/934392>

[mmartorana](/p/mmartorana/) closed this task as Resolved.[Jun 30 2023, 2:44 PM2023-06-30 14:44:20 (UTC+0)](#8981089)[mmartorana](/p/mmartorana/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-jsdpoh2vvwf6hfc/)" to "Public (No Login Required)".[mmartorana](/p/mmartorana/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-r6lsqzlhcuzp5me/)" to "All Users".[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a subscriber: [mmartorana](/p/mmartorana/).[Jun 30 2023, 2:45 PM2023-06-30 14:45:22 (UTC+0)](#8981092)Comment Actions

[@mmartorana](/p/mmartorana/) a patch has not been created for release 1.35. Should this remain open until this is done?

Furthermore, fixes for 1.38 and 1.39 are yet to be merged.

[mmartorana](/p/mmartorana/) changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-qcy66zbxbdx4vgk/)".[Jun 30 2023, 2:53 PM2023-06-30 14:53:35 (UTC+0)](#8981117)[mmartorana](/p/mmartorana/) changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-nsqjdrmyh4rolzz/)".[gerritbot](/p/gerritbot/) added a comment.[Jun 30 2023, 2:55 PM2023-06-30 14:55:42 (UTC+0)](#8981135)Comment Actions

Change 934392 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_38] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/934392>

[gerritbot](/p/gerritbot/) added a comment.[Jun 30 2023, 2:55 PM2023-06-30 14:55:56 (UTC+0)](#8981136)Comment Actions

Change 934390 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_39] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/934390>

[gerritbot](/p/gerritbot/) added a comment.[Jun 30 2023, 2:56 PM2023-06-30 14:56:07 (UTC+0)](#8981137)Comment Actions

Change 933916 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_39] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/933916>

[gerritbot](/p/gerritbot/) added a comment.[Jun 30 2023, 2:56 PM2023-06-30 14:56:20 (UTC+0)](#8981140)Comment Actions

Change 933919 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_38] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/933919>

[mmartorana](/p/mmartorana/) added a comment.[Jun 30 2023, 3:34 PM2023-06-30 15:34:53 (UTC+0)](#8981320)Comment Actions

Hi [@Dreamy\_Jazz](/p/Dreamy_Jazz/) - At present, my plan is to resolve and publish the task since the patch has been successfully integrated into all other branches. Unfortunately, a new patch should be created specifically for REL1\_35.

[Dreamy\_Jazz](/p/Dreamy_Jazz/) added a comment.[Jun 30 2023, 4:00 PM2023-06-30 16:00:07 (UTC+0)](#8981436)Comment Actions

Okay. Thanks for the info. I start a contracting role on Monday and I may be able to resolve the conflicts when cherry picking the fixes to release 1.35 from Monday. The changes from 1.38 should be able to cherry-picked after resolving conflicts without a need to modify them significantly.

[mmartorana](/p/mmartorana/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-sazmtgsr5vgr7g3/)" to "Public (No Login Required)".[Jun 30 2023, 4:02 PM2023-06-30 16:02:05 (UTC+0)](#8981447)[mmartorana](/p/mmartorana/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-5g7vleomtqfvd3v/)" to "All Users".[mmartorana](/p/mmartorana/) renamed this task from Special:CheckUserLog shows usernames which have been hidden to CVE-2023-37252: Special:CheckUserLog shows usernames which have been hidden.[Jun 30 2023, 5:55 PM2023-06-30 17:55:26 (UTC+0)](#8982454)[Mstyles](/p/Mstyles/) moved this task from [Watching](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[Jun 30 2023, 5:59 PM2023-06-30 17:59:31 (UTC+0)](#8982467)[gerritbot](/p/gerritbot/) added a comment.[Jul 4 2023, 2:11 PM2023-07-04 14:11:56 (UTC+0)](#8988302)Comment Actions

Change 935439 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_35] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/935439>

[gerritbot](/p/gerritbot/) added a comment.[Jul 4 2023, 4:14 PM2023-07-04 16:14:07 (UTC+0)](#8988773)Comment Actions

Change 935474 had a related patch set uploaded (by Dreamy Jazz; author: Dreamy Jazz):

[mediawiki/extensions/CheckUser@REL1\_35] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/935474>

[sbassett](/p/sbassett/) mentioned this in [T340874: Write and send supplementary release announcement for extensions and skins with security patches (1.35.12/1.39.5/1.40.1)](/T340874).[Jul 6 2023, 3:27 PM2023-07-06 15:27:54 (UTC+0)](#8994371)[gerritbot](/p/gerritbot/) added a comment.[Jul 10 2023, 2:15 PM2023-07-10 14:15:06 (UTC+0)](#9001658)Comment Actions

Change 935474 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_35] SECURITY: Hide hidden users in Special:CheckUserLog

<https://gerrit.wikimedia.org/r/935474>

[gerritbot](/p/gerritbot/) added a comment.[Jul 10 2023, 2:15 PM2023-07-10 14:15:51 (UTC+0)](#9001661)Comment Actions

Change 935439 **merged** by jenkins-bot:

[mediawiki/extensions/CheckUser@REL1\_35] SECURITY: Hide hidden users in CheckUserLog API

<https://gerrit.wikimedia.org/r/935439>

[Bawolff](/p/Bawolff/) subscribed.[Jul 25 2023, 1:01 PM2023-07-25 13:01:49 (UTC+0)](#9041143)Comment Actions

FYI, there was some comments on chat that the REL1\_38 backport is incorrect (Looks like SpecialCheckUserLog.php constructor never assigns its argument to $this->userFactory)

[gerritbot](/p/gerritbot/) added a comment.[Jul 25 2023, 1:06 PM2023-07-25 13:06:29 (UTC+0)](#9041162)Comment Actions

Change 941399 had a related patch set uploaded (by Brian Wolff; author: Brian Wolff):

[mediawiki/extensions/CheckUser@REL1\_38] Fix constructor. Follow up to fa250d83ecc77

<https://gerrit.wikimedia.org/r/941399>

[gerritbot](/p/gerritbot/) added a comment.[Jul 25 2023, 2:39 PM2023-07-25 14:39:27 (UTC+0)](#9041500)Comment Actions

Change 941399 **merged** by Dreamy Jazz:

[mediawiki/extensions/CheckUser@REL1\_38] Fix constructor, missing use. Follow up to fa250d83ecc77

<https://gerrit.wikimedia.org/r/941399>

Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_9f61018a_20250115_080545.html ===



