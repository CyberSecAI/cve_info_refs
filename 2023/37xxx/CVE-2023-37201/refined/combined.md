=== Content from www.mozilla.org_ecd955a5_20250114_182743.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-22

## Security Vulnerabilities fixed in Firefox 115

Announced
July 4, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 115

#### [#CVE-2023-3482: Block all cookies bypass for localstorage](#CVE-2023-3482)

Reporter
Martin Hostettler
Impact
moderate
##### Description

When Firefox is configured to block storage of all cookies, it was still possible to store data in localstorage by using an iframe with a source of 'about:blank'. This could have led to malicious websites storing tracking data without permission.

##### References

* [Bug 1839464](https://bugzilla.mozilla.org/show_bug.cgi?id=1839464)

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37203: Drag and Drop API may provide access to local system files](#CVE-2023-37203)

Reporter
Paul Nickerson and Ameen Basha M K
Impact
moderate
##### Description

Insufficient validation in the Drag and Drop API in conjunction with social engineering, may have allowed an attacker to trick end-users into creating a shortcut to local system files. This could have been leveraged to execute arbitrary code.

##### References

* [Bug 291640](https://bugzilla.mozilla.org/show_bug.cgi?id=291640)

#### [#CVE-2023-37204: Fullscreen notification obscured via option element](#CVE-2023-37204)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using an option element by introducing lag via an expensive computational function. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832195](https://bugzilla.mozilla.org/show_bug.cgi?id=1832195)

#### [#CVE-2023-37205: URL spoofing in address bar using RTL characters](#CVE-2023-37205)

Reporter
Rohan Sharma
Impact
moderate
##### Description

The use of RTL Arabic characters in the address bar may have allowed for URL spoofing.

##### References

* [Bug 1704420](https://bugzilla.mozilla.org/show_bug.cgi?id=1704420)

#### [#CVE-2023-37206: Insufficient validation of symlinks in the FileSystem API](#CVE-2023-37206)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Uploading files which contain symlinks may have allowed an attacker to trick a user into submitting sensitive data to a malicious website.

##### References

* [Bug 1813299](https://bugzilla.mozilla.org/show_bug.cgi?id=1813299)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37209: Use-after-free in "NotifyOnHistoryReload"](#CVE-2023-37209)

Reporter
Simon Descarpentries
Impact
moderate
##### Description

A use-after-free condition existed in `NotifyOnHistoryReload` where a `LoadingSessionHistoryEntry` object was freed and a reference to that object remained. This resulted in a potentially exploitable condition when the reference to that object was later reused.

##### References

* [Bug 1837993](https://bugzilla.mozilla.org/show_bug.cgi?id=1837993)

#### [#CVE-2023-37210: Full-screen mode exit prevention](#CVE-2023-37210)

Reporter
Hafiizh
Impact
low
##### Description

A website could prevent a user from exiting full-screen mode via alert and prompt calls. This could lead to user confusion and possible spoofing attacks.

##### References

* [Bug 1821886](https://bugzilla.mozilla.org/show_bug.cgi?id=1821886)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

#### [#CVE-2023-37212: Memory safety bugs fixed in Firefox 115](#CVE-2023-37212)

Reporter
Andrew McCreight, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 114. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1750870%2C1825552%2C1826206%2C1827076%2C1828690%2C1833503%2C1835710%2C1838587)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_a338c196_20250114_182740.html ===


---

[[Date Prev](msg00005.html)][[Date Next](msg00007.html)]
[[Thread Prev](msg00005.html)][[Thread Next](msg00007.html)]
[[Date Index](maillist.html#00006)]
[[Thread Index](threads.html#00006)]

# [SECURITY] [DLA 3484-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3484-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Sat, 8 Jul 2023 00:05:25 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20230707220525.40B2D2A00DB%40andromeda)Â [20230707220525.40B2D2A00DB@andromeda](msg00006.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3484-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
July 08, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 102.13.0esr-1~deb10u1
CVE ID         : CVE-2023-37201 CVE-2023-37202 CVE-2023-37207 CVE-2023-37208
                 CVE-2023-37211

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code or spoofing.

For Debian 10 buster, these problems have been fixed in version
102.13.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmSojCEACgkQnUbEiOQ2
gwLhcg/9F5itksRSkkG3DBcgdAnxS/CQWKxGxVtEvUL0T1OcLXw1NciIujzqQtpy
TE14geUO7dYYj+W1PpcXvtZfg41tkEmqCRwcf2I78iA1LK6vZFifyGQzHmtZ296z
K7pAaP0CY2hZ5A7Vtdm+Rq/q0sH3b4PKfFV9u3LZj6ale2O/sQla/iLG2CoykKhz
DGArfdBgC05Aa7bjTeb6WjKTUJc5fPTgtnqp7R9zOwhylpDAbA6fRxQFTv1gxBGC
+U6QJ8xjc3qUijj/Demv3Qj9O5MTnhswOwOoDQi7teOlYrLXiy2U6fI9igQJ081p
se6jPYjarNpfcOT3+t9NKB66ZMR9DHRfabJDV0I8bSpTxfWNwnc8DUPpQ0Z7Rjra
b/vAqn+ZkbZh6tu47GnWZortQACtw+iibPY/thD9KJ1XeW5lU05AP9S10nsM5Yw+
0Qg0xh3sCBsCiw55EPejQ6aMZh7FWg08xy82/M/hKKS15JVwf3+8W87lpqfHO3mp
OZv/FoLPSm8RQzmFEgk/jsGsE13SwI147NaVdHHGH4FBel+us8cYbNbZC4ewNzYK
kqn0RBxwNY9nSqd0B+hXQC4mGOG2Zes+bDq9Z1e4ZD8nuRaSmwpz39TsEY6RiOlq
EBSP8wMC9QdQLPhkVMiY2tgM20lQpH/gJJ86dzAcmhC7qWNWOy0=
=inoz
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_e464ab50_20250114_182741.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3490-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3490-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Tue, 11 Jul 2023 09:27:23 +0200 (CEST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20230711072723.D272B2A00F7%40andromeda)Â [20230711072723.D272B2A00F7@andromeda](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3490-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
July 11, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:102.13.0-1~deb10u1
CVE ID         : CVE-2023-37201 CVE-2023-37202 CVE-2023-37207 CVE-2023-37208
                 CVE-2023-37211

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:102.13.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmStBFkACgkQnUbEiOQ2
gwIHIg//XA1EZbcftc8XtcMnbziXtT6HvoqFc9w2BN0zl5hYj6RTAgVd25Wfkw9Y
cECmh4TVIkrWeyd7C3vmf/j29qH4/VHgeajBQVpvSqGylfKCvRnvCRS3yjuVrJ+x
8zCroOesS8rOy8GWrTUPK/W18sQBGvHPKXrOUJeb1Wv4brldl7jJsQtI2dQcOxpp
4mxnwUg/D0JSfaTja2zXQIh1If6aMjISU5U2RQnjzCosBY58WYKSF+mFM/mAm/EP
946pFb/vwcixUr1GR9Z7Yhq4c732zzhjhLUUfXbPOp0CU/Vb2W5Jyc0N/oIiRmWr
MXqWhMRR85aQ0uYJZk7QIZO1dHcaKcqVsvtN2c4Y2DEeZ74w0SohnDhXCUBQWPFI
BNoUaTEJeBIt4J1Bup8at0Yzrc1LwHzYxqp2pNsu70z3BfFC68LOUmfCvSwd0N9b
WFwvRgdghVsyZGdeugliaCCmDtePeovhmJ5bJnBk7uw5WMFVZbB8ysaTzVu4AmU/
WJj6XuYIK5JP+au6oGfAoNw9Dqd7ztylpwZWxgNcpiNPffjf8g0eJyRJIiJ0xGyk
Ui3xdyCr4N0N74UQ6LfI1xHIpzGfeRvRZHPcfCZHR8daXcmWAQAM4k6Pa/B/F8jJ
SVjk9qHKEfeYe2AkFfQMm0TeLItUPBLlcVj9jBtXQ/9f3Q6M2W8=
=+c7f
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_9bb23d64_20250114_182745.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-24

## Security Vulnerabilities fixed in Thunderbird 102.13

Announced
July 4, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.13

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_30f730d6_20250114_182745.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-23

## Security Vulnerabilities fixed in Firefox ESR 102.13

Announced
July 4, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.13

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_30b579dd_20250114_182740.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1826002)
* [XML](/show_bug.cgi?ctype=xml&id=1826002)

Closed
[Bug 1826002](/show_bug.cgi?id=1826002)
(CVE-2023-37201)

Opened 2 years ago
Closed 2 years ago

# Use-after-free on freebl3!SHA256\_Update\_Native at sha256-x86.c on OOM

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Use-after-free on freebl3!SHA256\_Update\_Native at sha256-x86.c on OOM

## Categories

### (Core :: WebRTC, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC#WebRTC)

WebRTC
â–¾

Core :: WebRTC
General bugs associated with WebRTC
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

116 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [115+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=115%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | [+](/buglist.cgi?f1=cf_tracking_firefox115&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=verified) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 115+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox114 |  | wontfix |
| firefox115 | + | verified |
| firefox116 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: keeler)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [keeler](/user_profile?user_id=349244)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e2a2be17b9bb8a1d4d7427c810996388?d=mm&size=40)  [mjf](/user_profile?user_id=546718)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main115+][adv-esr102.13+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-37201

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main115+][adv-esr102.13+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c30 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (14 files)

| [testcase1.html](/attachment.cgi?id=9326471)  [2 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   571 bytes, text/html |  | [Details](/attachment.cgi?id=9326471&action=edit) |
| --- | --- | --- |
| [minidump\_0xe5e5e5e5.txt](/attachment.cgi?id=9326473)  [2 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   9.02 KB, text/plain |  | [Details](/attachment.cgi?id=9326473&action=edit) |
| [minidump\_0x61313736.txt](/attachment.cgi?id=9326474)  [2 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   8.91 KB, text/plain |  | [Details](/attachment.cgi?id=9326474&action=edit) |
| [logging.patch](/attachment.cgi?id=9327402)  [2 years ago](#c6)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   2.84 KB, patch |  | [Details](/attachment.cgi?id=9327402&action=edit) | [Diff](/attachment.cgi?id=9327402&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1826002&attachment=9327402) |
| [rtccertificate-dtlsidentity-uaf-log.txt](/attachment.cgi?id=9327403)  [2 years ago](#c7)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   24.04 KB, text/plain |  | [Details](/attachment.cgi?id=9327403&action=edit) |
| [minidump\_uaf\_64bit.txt](/attachment.cgi?id=9336275)  [2 years ago](#c14)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   8.73 KB, text/plain |  | [Details](/attachment.cgi?id=9336275&action=edit) |
| [minidump\_ECDH\_Derive\_memcpy.txt](/attachment.cgi?id=9336276)  [2 years ago](#c15)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   4.28 KB, text/plain |  | [Details](/attachment.cgi?id=9336276&action=edit) |
| [nssarena\_destroy\_trigger\_uaf.diff](/attachment.cgi?id=9338085)  [2 years ago](#c18)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   560 bytes, patch |  | [Details](/attachment.cgi?id=9338085&action=edit) | [Diff](/attachment.cgi?id=9338085&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1826002&attachment=9338085) |
| [asan-heap-uaf-read-8.txt](/attachment.cgi?id=9338086)  [2 years ago](#c19)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   21.07 KB, text/plain |  | [Details](/attachment.cgi?id=9338086&action=edit) |
| [Bug 1826002 - use decoded certificates r?jschanck!](/attachment.cgi?id=9338295)  [2 years ago](#c24)  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c28 "2 years ago")  dmeehan : [approval-mozilla-esr102+](#c37 "2 years ago") | [Details](/attachment.cgi?id=9338295&action=edit) | [Review](/attachment.cgi?id=9338295) |
| [testcase2.html](/attachment.cgi?id=9340705)  [2 years ago](#c33)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   974 bytes, text/html |  | [Details](/attachment.cgi?id=9340705&action=edit) |
| [patch for esr102](/attachment.cgi?id=9341101)  [2 years ago](#c35)  [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)   8.77 KB, patch |  | [Details](/attachment.cgi?id=9341101&action=edit) | [Diff](/attachment.cgi?id=9341101&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1826002&attachment=9341101) |
| [testcase3.html](/attachment.cgi?id=9341108)  [2 years ago](#c36)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   974 bytes, text/html |  | [Details](/attachment.cgi?id=9341108&action=edit) |
| [advisory.txt](/attachment.cgi?id=9341308)  [2 years ago](#c39)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   164 bytes, text/plain |  | [Details](/attachment.cgi?id=9341308&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1826002#c0)â€¢ 2 years ago |
|  | |

Attached file
[testcase1.html](attachment.cgi?id=9326471)
â€” [Details](attachment.cgi?id=9326471&action=edit)

On Firefox 32-bit after filling memory around 2700mb, then call `new RTCPeerConnection()` and `new Worker` the tab able to crash at `ACCESS_VIOLATION_READ` on `SHA256_Update_Native` at sha256-x86.c on address `0xe5e5e5e5`, the address can be changed dynamically to e.g. `0xe5eff000`, `0xe5f0000`, `0xe6901000`, and more.

The testcase is currently intermittent, it commonly crash at mozalloc\_abort breakpoint rather than SHA256\_Update\_Native, I'll post update when I found more reliable testcase.

After spent some time debugging through WinDbg, on the stack `PeerConnectionImpl::SetCertificate(mozilla::dom::RTCCertificate& aCertificate)` the `aCertificate->mCertificate` sub-variable e.g. extensions, emailAddr, keyUsage, derCert, and more value is already set at `0xe5e5e5e5`, then that `mCertificate` is passed to `SHA256_Update_Native` causing the `ACCESS_VIOLATION_READ`.

When looking at RTCCertificate.cpp code, it looks like the code is called from another thread, on the `WebCryptoTask::Run()` there are code comment "// Run heavy crypto operations on the thread pool, off the original thread.".

I then add printf to print address of `mCertificate` from `RTCCertificate!SignCertificate` and `PeerConnectionImpl::SetCertificate` to match the address, when calling simple function `new RTCPeerConnection()` both `mCertificate` address is match, but when visiting the testcase which do repeatedly in loop, the `mCertificate` address is out of sync, it looks like the RTCCertificate is generate too excessive `mCertificate`, then older `mCertificate` is freed, after that the `PeerConnectionImpl::SetCertificate` is still taking the old (freed) `mCertificate` address rather than fresh `mCertificate` which causing the use-after-free.

## Tested on:

* Firefox 113.0a1 (2023-04-01) (32-bit)
* Firefox 111.0.1 (32-bit)

## Steps to reproduce:

1. Open Firefox 32-bit
2. Visit attached testcase1.html on HTTPS site
3. After a while the tabs is crashed
4. Analyze the crash dump

If Firefox crash at EXCEPTION\_BREAKPOINT, try again until it crashes at EXCEPTION\_ACCESS\_VIOLATION.

Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1826002#c1)â€¢ 2 years ago |
|  | |

Attached file
[minidump\_0xe5e5e5e5.txt](attachment.cgi?id=9326473)
â€” [Details](attachment.cgi?id=9326473&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1826002#c2)â€¢ 2 years ago |
|  | |

Attached file
[minidump\_0x61313736.txt](attachment.cgi?id=9326474)
â€” [Details](attachment.cgi?id=9326474&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a73848_406194)â€¢ 2 years ago |

Group: firefox-core-security â†’ media-core-securityComponent: Security â†’ WebRTCKeywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)Product: Firefox â†’ Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1826002#c3)â€¢ 2 years ago |
|  | |

We're going to try to reproduce in an instrumented build and figure out whether to blame NSS or WebRTC. The testcase is relying on OOM situations which would make it hard to create a reliable exploit out of. We can raise the severity if we figure out how to do that

Flags: needinfo?(twsmith)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1826002#c4)â€¢ 2 years ago |
|  | |

I haven't been able to trigger the issue locally with a 32-bit ASan build on Linux. Unfortunately all I've been able to trigger are OOMs.

Flags: needinfo?(twsmith)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1826002#c5)â€¢ 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #3](/show_bug.cgi?id=1826002#c3 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> figure out whether to blame NSS or WebRTC.

I've added some logging code to my Firefox, on `RTCCertificate.cpp` which responsible to generate new RTC client certificate and `dtlsidentity.cpp` which use the generated client certificate then pass this to `HASH_HashBuf`.

On single call of `new RTCPeerConnection()` function, the `dtlsidentity.cpp` is using the properly generated certificate (`mCertificate` address generated by `RTCCertificate.cpp` is same as `cert` address used by `dtlsidentity.cpp`) the log is as follow:

```
1 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: 05350810
2 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 330
3 dtlsidentity.cpp->ComputeFingerprint cert address -> 05350810
4 dtlsidentity.cpp->ComputeFingerprint cert->derCert.len 330

```

After the `RTCCertificate` generate the certificate then `dtlsidentity` directly uses the generated `mCertificate`

However when running the testcase, it can be seen that `dtlsidentity.cpp` is using the old (freed) `mCertificate` as the following summary (full log can be seen at attachment uaf-rtccertificate-dtlsidentity-log.txt):

```
1 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: 05351010
2 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 331
3 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: 05351810
4 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 330
5 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: 0AFA9010
6 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 331
...
232 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: FFE6D010 <- freed address
233 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 330 <- len is 330
...
345 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: FFEDD810
346 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 329
347 RTCCertificate.cpp->SignCertificate() Address of mCertificate object: FFEDF010
348 dtlsidentity.cpp->ComputeFingerprint cert address -> FFE6D010 <- use of freed address
349 dtlsidentity.cpp->ComputeFingerprint cert->derCert.len -437918235 <- len from freed address how minus
350 RTCCertificate.cpp->SignCertificate() mCertificate->derCert.len = 329

```

From line 1 in this case the `RTCCertificate` generate a lot of certificate, but when `dtlsidentity` not yet using the `mCertificate`, the `RTCCertificate` keep generating the `mCertificate`.

On line 348 it show that the `dtlsidentity` is using `mCertificate` from line 232 which has been freed, the value of `cert->derCert.len` is showing minus value -437918235 (instead of 330) which indicate the UAF.

If I added new logging code e.g. `cert->emailAddr` below of logging the `cert->derCert.len` it also able to trigger the UAF.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1826002#c6)â€¢ 2 years ago |
|  | |

Attached patch

[logging.patch](attachment.cgi?id=9327402&action=diff)
â€” [Details](attachment.cgi?id=9327402&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1826002&attachment=9327402)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1826002#c7)â€¢ 2 years ago |
|  | |

Attached file
[rtccertificate-dtlsidentity-uaf-log.txt](attachment.cgi?id=9327403)
â€” [Details](attachment.cgi?id=9327403&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1826002#c8)â€¢ 2 years ago |
|  | |

The reason `RTCCertificate` re-generate certificates, when `dtlsidentity` has not used it, probably because `RTCCertificate` is running on another thread than `dtlsidentity`.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1826002#c9)â€¢ 2 years ago |
|  | |

I've found more reliable testcase than the testcase1.html, but still testing across my machine to confirm is more reliable on them, I will attach that later.

I also able to reproduce this on Linux OS and Firefox ESR 102.9.0esr (32-bit), when run this on mozregression I able to reproduce this since build 2020-02-14.

I tried to compile Firefox build\_date 2020-02-14 on Windows 11 to find out the regression, but latest Windows clang-cl (from mach bootstrap) is causing error on older build, try to find out older clang-cl (2020) from Mozilla archive, but couldn't find one. Fortunately I also reproduced this on Linux OS, compiling old Firefox looks easier on Linux, which I have done before, I'll try compile older version on Linux to find out the regression.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1826002#c10)â€¢ 2 years ago |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #9](/show_bug.cgi?id=1826002#c9 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> when run this on mozregression I able to reproduce this since build 2020-02-14.

On Linux OS I was also able to reproduce this on build 2019-12-18, and looks like still possible on earlier date builds, looks like UAF is possible since the code has been committed.

I'll share more reliable testcase instead.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1826002#c11)â€¢ 2 years ago |
|  | |

The severity field is not set for this bug.

:mjf, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(mfroman)

|  | [Michael Froman [:mjf]](/user_profile?user_id=546718) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a1898848_546718)â€¢ 2 years ago |

Flags: needinfo?(mfroman) â†’ needinfo?(docfaraday)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1826002#c12)â€¢ 2 years ago |
|  | |

I'm having no luck reproducing this either with an ASan build. Any progress on the more reliable testcase you're working on?

Flags: needinfo?(docfaraday) â†’ needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1826002#c13)â€¢ 2 years ago |
|  | |

(In reply to Byron Campen [:bwc] from [comment #12](/show_bug.cgi?id=1826002#c12 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> I'm having no luck reproducing this either with an ASan build. Any progress on the more reliable testcase you're working on?

I do get the more reliable testcase, when running the testcase for 20 times, the success rate is about 40% - 50% to hit the UAF, but I've tested that on Firefox Nightly, after next Firefox Nightly update the success rate is drop to 20% - 30%. The trick is adding slowdown code or DOM code above new RTCPeerConnection() able to increase the success rate.

It looks like it is also reproducible on Firefox on Windows 64-bit, I able to get following UAF crash stack:

```
r10 = 0x00000fff1e06c9fe        r11 = 0x5401401401504104        r12 = 0x0000000000000086
r13 = 0x0000000000000378        r14 = 0x0000020dbb982000        r15 = 0x0000000000000128
 r8 = 0x000000f0c89fe3a8         r9 = 0x0000020dbb982000        rax = 0x0000000000000000
rbp = 0x0000000000000195        rbx = 0x0000000000000128        rcx = 0xe5e5e5e5e5e5e5e5
rdi = 0xe5e5e5e5e5e5e5e5        rdx = 0x000002103b45b790        rip = 0x00007ff8f4d3dd77
rsi = 0x000002103b45b790        rsp = 0x000000f0c89fe170
OS|Windows NT|10.0.22621
CPU|amd64|family 6 model 183 stepping 1|32
Crash|EXCEPTION_ACCESS_VIOLATION_READ|0xe5e5e5e5e5e5e61d|0
0|0|nss3.dll|nssCertificate_Destroy(NSSCertificateStr*)|hg:hg.mozilla.org/mozilla-central:security/nss/lib/pki/certificate.c:25209607dc0b253635ead03eff51fdc10a62e659|97|0x17
0|1|xul.dll|mozilla::dom::RTCCertificate::~RTCCertificate()|hg:hg.mozilla.org/mozilla-central:dom/media/webrtc/RTCCertificate.h:25209607dc0b253635ead03eff51fdc10a62e659|79|0x15
0|2|xul.dll|mozilla::dom::RTCCertificate::cycleCollection::DeleteCycleCollectable(void*)|hg:hg.mozilla.org/mozilla-central:dom/media/webrtc/RTCCertificate.h:25209607dc0b253635ead03eff51fdc10a62e659|47|0xf
0|3|xul.dll|nsPurpleBuffer::VisitEntries<SnowWhiteKiller>(SnowWhiteKiller&)|hg:hg.mozilla.org/mozilla-central:xpcom/base/nsCycleCollector.cpp:25209607dc0b253635ead03eff51fdc10a62e659|969|0xca9
0|4|xul.dll|nsCycleCollector::FreeSnowWhiteWithBudget(js::SliceBudget&)|hg:hg.mozilla.org/mozilla-central:xpcom/base/nsCycleCollector.cpp:25209607dc0b253635ead03eff51fdc10a62e659|2679|0x11f
WARNING: Hit stack size output limit!

```

And following nss3.dll crash stack:

```
r10 = 0x0000000000000116        r11 = 0x00007ffaeccb1b61        r12 = 0x0000000000000000
r13 = 0x00000244e457a0d0        r14 = 0x00000247a47d7cc8        r15 = 0x0000000000000000
 r8 = 0x0000000000000000         r9 = 0x000000ca3f83f060        rax = 0x0000000000000006
rbp = 0x0000000000000116        rbx = 0x00000000000000ef        rcx = 0x00000000000000c8
rdi = 0x0000000000000000        rdx = 0x00007ffae3bd4a44        rip = 0x00007ffae3bd3670
rsi = 0x0000000000000000        rsp = 0x000000ca3f83f030
OS|Windows NT|10.0.22621
CPU|amd64|family 6 model 183 stepping 1|16
Crash|EXCEPTION_ACCESS_VIOLATION_READ|0x0000000000000008|8
8|0|nss3.dll|sgn_NewContext(<unnamed-tag>, SECItemStr*, SECKEYPrivateKeyStr*)|hg:hg.mozilla.org/mozilla-central:security/nss/lib/cryptohi/secsign.c:faf51404785d5440c5ce9b38d9b5828f8f1cd5df|55|0x50
8|1|nss3.dll|sec_SignData(SECItemStr*, unsigned char const*, int, SECKEYPrivateKeyStr*, <unnamed-tag>, SECItemStr*)|hg:hg.mozilla.org/mozilla-central:security/nss/lib/cryptohi/secsign.c:faf51404785d5440c5ce9b38d9b5828f8f1cd5df|312|0x22
8|2|nss3.dll|sec_DerSignData(PLArenaPool*, SECItemStr*, unsigned char const*, int, SECKEYPrivateKeyStr*, <unnamed-tag>, SECItemStr*)|hg:hg.mozilla.org/mozilla-central:security/nss/lib/cryptohi/secsign.c:faf51404785d5440c5ce9b38d9b5828f8f1cd5df|428|0x78
8|3|nss3.dll|SEC_DerSignData(PLArenaPool*, SECItemStr*, unsigned char const*, int, SECKEYPrivateKeyStr*, <unnamed-tag>)|hg:hg.mozilla.org/mozilla-central:security/nss/lib/cryptohi/secsign.c:faf51404785d5440c5ce9b38d9b5828f8f1cd5df|456|0x25
8|4|xul.dll||||
WARNING: Hit stack size output limit!

```

I'll try reproduce more on Firefox ASAN 64-bit, hopefully able to get the UAF stack trace.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1826002#c14)â€¢ 2 years ago |
|  | |

Attached file
[minidump\_uaf\_64bit.txt](attachment.cgi?id=9336275)
â€” [Details](attachment.cgi?id=9336275&action=edit)

It possible to hit the UAF on `SHA256_Update_Native` and AV\_WRITE `NSC_GenerateKeyPair` -> `ECDH_Derive` on Firefox Nightly 115.0a1 (2023-05-26) (64-bit).

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1826002#c15)â€¢ 2 years ago |
|  | |

Attached file
[minidump\_ECDH\_Derive\_memcpy.txt](attachment.cgi?id=9336276)
â€” [Details](attachment.cgi?id=9336276&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1826002#c16)â€¢ 2 years ago |
|  | |

Ok great! I finally found the use-after-free root cause, the free is occurred on NSS code, then RTCCertificate.cpp pass the freed certificate to dtlsidentity.cpp. I'll post more detail soon!

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1826002#c17)â€¢ 2 years ago |
|  | |

When user run JS `new RTCPeerConnection()` function, the [RTCCertificate.cpp](https://searchfox.org/mozilla-central/source/dom/media/webrtc/RTCCertificate.cpp#236) will run `GenerateRTCCertificateTask::GenerateCertificate()` and `GenerateRTCCertificateTask::SignCertificate()`.

After that, [RTCCertificate.cpp](https://searchfox.org/mozilla-central/source/dom/media/webrtc/RTCCertificate.cpp#249) will call [`GenerateRTCCertificateTask::Resolve()`](https://searchfox.org/mozilla-central/source/dom/media/webrtc/RTCCertificate.cpp#249) to `CERT_DupCertificate` using generated certificate from `GenerateCertificate()` and `SignCertificate()`, then after it duplicated, it will pass the certificate to [webrtc/jsapi/PeerConnectionImpl.cpp `PeerConnectionImpl::SetCertificate`](https://searchfox.org/mozilla-central/source/dom/media/webrtc/jsapi/PeerConnectionImpl.cpp#536) and [webrtc/transport/dtlsidentity.cpp `DtlsIdentity::ComputeFingerprint`](https://searchfox.org/mozilla-central/source/dom/media/webrtc/transport/dtlsidentity.cpp#286).

When [`GenerateRTCCertificateTask::Resolve()`](https://searchfox.org/mozilla-central/source/dom/media/webrtc/RTCCertificate.cpp#249) run [`CERT_DupCertificate(mCertificate.get())`](https://searchfox.org/mozilla-central/source/security/nss/lib/certdb/certdb.c#1268) it will go to [`STAN_GetNSSCertificate(CERTCertificate *cc)`](https://searchfox.org/mozilla-central/source/security/nss/lib/pki/pki3hack.c#1049) -> [`nssPKIObject_Create`](https://searchfox.org/mozilla-central/source/security/nss/lib/pki/pkibase.c#108) -> [`PR_NewMonitor()`](https://searchfox.org/mozilla-central/source/nsprpub/pr/src/threads/prmon.c#64)

On OOM scenario, when `PR_NewMonitor()` run `mon = PR_NEWZAP(PRMonitor);` the `mon` will be set to `NULL`, causing to run `PR_SetError(PR_OUT_OF_MEMORY_ERROR, 0);` and `return NULL;`

On the `nssPKIObject_Create` as `PR_OUT_OF_MEMORY_ERROR` it will run `goto loser;` then free certificate arena with `nssArena_Release(arena, mark);`

On the `STAN_GetNSSCertificate(CERTCertificate *cc)` the `pkiob` will set to `NULL` causing to free the certificate arena with `nssArena_Destroy(arena);` and `return NULL;`

After that, the `CERT_DupCertificate` will return the certificate with freed arena, then `GenerateRTCCertificateTask::Resolve` will pass the certificate with freed arena to `PeerConnectionImpl::SetCertificate` and `DtlsIdentity::ComputeFingerprint` causing the use-after-free.

Flags: needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1826002#c18)â€¢ 2 years ago |
|  | |

Attached patch

[nssarena\_destroy\_trigger\_uaf.diff](attachment.cgi?id=9338085&action=diff)
â€” [Details](attachment.cgi?id=9338085&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1826002&attachment=9338085)

To trigger same UAF scenario as [comment 17](/show_bug.cgi?id=1826002#c17 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"), we can add the following code to [pki3hack.c](https://searchfox.org/mozilla-central/source/security/nss/lib/pki/pki3hack.c#1049):

```
diff --git a/security/nss/lib/pki/pki3hack.c b/security/nss/lib/pki/pki3hack.c
index 5556cd17695f..5d6271120924 100644
--- a/security/nss/lib/pki/pki3hack.c
+++ b/security/nss/lib/pki/pki3hack.c
@@ -1047,6 +1047,8 @@ STAN_GetNSSCertificate(CERTCertificate *cc)
     NSSITEM_FROM_SECITEM(&c->encoding, &cc->derCert);
     c->type = NSSCertificateType_PKIX;
     pkiob = nssPKIObject_Create(arena, NULL, cc->dbhandle, NULL, nssPKIMonitor);
+    nssArena_Destroy(arena);
+    return NULL;
     if (!pkiob) {
         nssArena_Destroy(arena);
         return NULL;

```

After Firefox was compiled (more useful with AddressSanitizer enabled), go to <https://www.example.com>, then open web console (Ctrl+Shift+K), after that type `new RTCPeerConnection()` then press enter.

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1826002#c19)â€¢ 2 years ago |
|  | |

Attached file
[asan-heap-uaf-read-8.txt](attachment.cgi?id=9338086)
â€” [Details](attachment.cgi?id=9338086&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a5779827_537720)â€¢ 2 years ago |

Flags: needinfo?(docfaraday)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1826002#c20)â€¢ 2 years ago |
|  | |

This is an NSS bug, then, but note that the webRTC code should be audited for places where the result of `CERT_DupCertificate` isn't null-checked.

Assignee: nobody â†’ nobodyGroup: media-core-security â†’ crypto-core-securityComponent: WebRTC â†’ LibrariesProduct: Core â†’ NSSVersion: unspecified â†’ other

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1826002#c21)â€¢ 2 years ago |
|  | |

Discussed this with the team. There are NSS issues here, but the most expedient fix for Firefox will be to change how we're using CERT\_CreateCertificate in this code.

Assignee: nobody â†’ dkeelerSeverity: -- â†’ S2Component: Libraries â†’ WebRTCProduct: NSS â†’ CoreVersion: other â†’ unspecified

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1826002#c22)â€¢ 2 years ago |
|  | |

Does this patch address the issue for you?

<https://hg.mozilla.org/try/rev/f5b661d1ed080c63e48cadb8650259841fc5e221>

Flags: needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1826002#c23)â€¢ 2 years ago |
|  | |

(In reply to Dana Keeler (she/her) (use needinfo) (:keeler for reviews) from [comment #22](/show_bug.cgi?id=1826002#c22 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Does this patch address the issue for you?
>
> <https://hg.mozilla.org/try/rev/f5b661d1ed080c63e48cadb8650259841fc5e221>

Thanks for the patch! I've applied the patch on my Firefox 32-bit local build on Windows 11 and Arch Linux, after Firefox 32-bit was build, I then try with various `new RTCPeerConnection()` testcase repeatedly multiple times, I confirm I no longer receive crash on `SHA256_Update_Native`.

Flags: needinfo?(susah.yak)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a5862173_406194)â€¢ 2 years ago |

Summary: Use-after-free on freebl3!SHA256\_Update\_Native at sha256-x86.c â†’ Use-after-free on freebl3!SHA256\_Update\_Native at sha256-x86.c on OOM

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1826002#c24)â€¢ 2 years ago |
|  | |

Attached file
[Bug 1826002 - use decoded certificates r?jschanck!](attachment.cgi?id=9338295)
â€” [Details](attachment.cgi?id=9338295&action=edit)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1826002#c25)â€¢ 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/f642619224ee>

Looks like this grafts cleanly to Beta and most of the way to ESR102 (though it would probably be good to sanity check that one).

Group: crypto-core-security â†’ core-security-releaseStatus: NEW â†’ RESOLVEDClosed: 2 years ago
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox115](/buglist.cgi?f1=cf_tracking_firefox115&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox115&o1=equals&v1=%2B)
[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- â†’ [115+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=115%2B)Flags: needinfo?(docfaraday)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 116 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1826002#c26)â€¢ 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:keeler, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox115` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(dkeeler)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1826002#c27)â€¢ 2 years ago |
|  | |

Comment on [attachment 9338295](/attachment.cgi?id=9338295 "Bug 1826002 - use decoded certificates r?jschanck!") [[details]](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!")

[Bug 1826002](/show_bug.cgi?id=1826002 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") - use decoded certificates r?jschanck!

### Beta/Release Uplift Approval Request

* **User impact if declined**: UAF under high memory pressure conditions.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The changes in the patch are minimal; the only real difference is the use of an NSS function that is already widely used (CERT\_NewTempCertificate). This should be safe.
* **String changes made/needed**: none
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Though this is a sec-moderate and is unlikely to be reliably exploitable, it is a UAF and the fix is fairly straightforward.
* **User impact if declined**: UAF under high memory pressure conditions.
* **Fix Landed on Version**: 116
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The changes in the patch are minimal; the only real difference is the use of an NSS function that is already widely used (CERT\_NewTempCertificate). This should be safe.
Flags: needinfo?(dkeeler)
[Attachment #9338295](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!") -
Flags: approval-mozilla-esr102?
[Attachment #9338295](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!") -
Flags: approval-mozilla-beta?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1826002#c28)â€¢ 2 years ago |
|  | |

Comment on [attachment 9338295](/attachment.cgi?id=9338295 "Bug 1826002 - use decoded certificates r?jschanck!") [[details]](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!")

[Bug 1826002](/show_bug.cgi?id=1826002 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") - use decoded certificates r?jschanck!

Approved for 115.0b5.

[Attachment #9338295](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1826002#c29)â€¢ 2 years ago |
| fixed | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/1617cf9288b5>

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1826002#c30)â€¢ 2 years ago |
|  | |

25-50% reliability for the PoC ([comment 13](/show_bug.cgi?id=1826002#c13 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM")), not to mention working on 64-bit, is good enough to prove my sec-moderate was too low

Flags: sec-bounty? â†’ sec-bounty+Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) â†’ [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1826002#c31)â€¢ 2 years ago |
|  | |

Noticed in [Comment 27](/show_bug.cgi?id=1826002#c27 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"), that Manual QE is needed for verifying this. Can we use the STR from the Description and the attached "testcase1.html" for our verification? Or is there another testcase available that we should use?

Flags: needinfo?(susah.yak)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1826002#c32)â€¢ 2 years ago |
|  | |

:keeler could you attach a patch based on esr102?

Flags: needinfo?(dkeeler)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1826002#c33)â€¢ 2 years ago |
|  | |

Attached file
[testcase2.html](attachment.cgi?id=9340705)
â€” [Details](attachment.cgi?id=9340705&action=edit)

(In reply to Camelia Badau [:cbadau], Desktop QA from [comment #31](/show_bug.cgi?id=1826002#c31 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Noticed in [Comment 27](/show_bug.cgi?id=1826002#c27 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"), that Manual QE is needed for verifying this. Can we use the STR from the Description and the attached "testcase1.html" for our verification? Or is there another testcase available that we should use?

The current attached testcase1.html is using `new Worker` to help fill the memory, on latest Firefox it now hitting JS assertion and worker limit assertion.

On new attached testcase2.html it's now using retry fill method and no longer using `new Worker` to fill the memory, however the success rate is not 100% to hit access-violation on SHA256, so we can use FFPuppet to automate retry the testcase2.html, when run 20x on my i5-1035G1 I able to get 9x success, 11x failure (about 45% success rate), on my other machine it only get 5x success, however I think it's enough for QE testing to prove the fix.

## Steps to reproduce:

1. Run `pip install ffpuppet` in PowerShell
2. Download attached testcase2.html
3. Make new directory and enter the directory
4. Type `for ($i = 1; $i -le 20; $i++) { python -m ffpuppet "[firefox path]" -u "[path to testcase file]" }` on PowerShell
5. Change `[firefox path]` to Firefox 32-bit path i.e. `C:/Program Files (x86)/Firefox/firefox.exe`
6. Change `[path to testcase file]` to testcase2.html path i.e. `C:/tmp/testcase2.html`
7. Run the command
8. After the command is completed, find "SHA256" text in the folder
9. If "SHA256" text is found, then the Firefox build is affected
Flags: needinfo?(susah.yak)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a7315682_500622)â€¢ 2 years ago |

Flags: qe-verify+

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a7315730_500622)â€¢ 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1826002#c34)â€¢ 2 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1826002&comment_id=16472008 "1 revision") |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #33](/show_bug.cgi?id=1826002#c33 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Created [attachment 9340705](/attachment.cgi?id=9340705 "testcase2.html") [[details]](/attachment.cgi?id=9340705&action=edit "testcase2.html")
>
> testcase2.html
>
> (In reply to Camelia Badau [:cbadau], Desktop QA from [comment #31](/show_bug.cgi?id=1826002#c31 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))
>
> > Noticed in [Comment 27](/show_bug.cgi?id=1826002#c27 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"), that Manual QE is needed for verifying this. Can we use the STR from the Description and the attached "testcase1.html" for our verification? Or is there another testcase available that we should use?
>
> The current attached testcase1.html is using `new Worker` to help fill the memory, on latest Firefox it now hitting JS assertion and worker limit assertion.
>
> On new attached testcase2.html it's now using retry fill method and no longer using `new Worker` to fill the memory, however the success rate is not 100% to hit access-violation on SHA256, so we can use FFPuppet to automate retry the testcase2.html, when run 20x on my i5-1035G1 I able to get 9x success, 11x failure (about 45% success rate), on my other machine it only get 5x success, however I think it's enough for QE testing to prove the fix.
>
> ## Steps to reproduce:
>
> 1. Run `pip install ffpuppet` in PowerShell
> 2. Download attached testcase2.html
> 3. Make new directory and enter the directory
> 4. Type `for ($i = 1; $i -le 20; $i++) { python -m ffpuppet "[firefox path]" -u "[path to testcase file]" }` on PowerShell
> 5. Change `[firefox path]` to Firefox 32-bit path i.e. `C:/Program Files (x86)/Firefox/firefox.exe`
> 6. Change `[path to testcase file]` to testcase2.html path i.e. `C:/tmp/testcase2.html`
> 7. Run the command
> 8. After the command is completed, find "SHA256" text in the folder
> 9. If "SHA256" text is found, then the Firefox build is affected

Using the old Nightly build from 2023-06-03 (32bit), the testcase2.html and the steps provided here I can't seem to see SHA256 anywhere in the directory where the logs are created and nothing inside the logs as well. I tested on both Windows 11 on a VM and Windows 10 on a real machine. Any thoughts?

Here is the content of a log file that has more info in it then the rest:

`out of memory: 0x0000000000000188 bytes requested`

`[ERROR viaduct::backend::ffi] Missing HTTP status`

`[Parent 21040, IPC I/O Parent] WARNING: DuplicateHandle failed for handle 0 in TransferHandles: file /builds/worker/checkouts/gecko/ipc/chromium/src/chrome/common/ipc_channel_win.cc:787`

`[ERROR viaduct::backend::ffi] Missing HTTP status`

`[ERROR viaduct::backend::ffi] Missing HTTP status`

`[ffpuppet] Reason code: ALERT`

Note that I do see similar log files and directory names and all with the last Nightly from today as well. Also I having an AMD Ryzen 7 2700x CPU on the machine not an intel as you said, not sure if this is relevant or not.

Flags: needinfo?(susah.yak)

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1826002#c35)â€¢ 2 years ago |
|  | |

Attached patch

[patch for esr102](attachment.cgi?id=9341101&action=diff)
â€” [Details](attachment.cgi?id=9341101&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1826002&attachment=9341101)

Flags: needinfo?(dkeeler)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1826002#c36)â€¢ 2 years ago |
|  | |

Attached file
[testcase3.html](attachment.cgi?id=9341108)
â€” [Details](attachment.cgi?id=9341108&action=edit)

(In reply to Bogdan Maris, Desktop QA from [comment #34](/show_bug.cgi?id=1826002#c34 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Using the old Nightly build from 2023-06-03 (32bit), the testcase2.html and the steps provided here I can't seem to see SHA256 anywhere in the directory where the logs are created and nothing inside the logs as well. I tested on both Windows 11 on a VM and Windows 10 on a real machine. Any thoughts?

Ok, I've tried reproduce testcase2.html on Firefox Nightly 2023-06-03 (32bit), I download it from <https://ftp.mozilla.org/pub/firefox/nightly/2023/06/2023-06-03-09-24-55-mozilla-central/firefox-115.0a1.en-US.win32.installer.exe>, then I extracted the .exe and rename the updater.exe to updater.exe.bak to prevent automatic update, tried to reproduce this, but I also unable to see "SHA256" on the logs folder.

Then I reduced the max fill memory on testcase2.html from `3753500000` to `3700000000`, I attached the modified testcase as testcase3.html, now I able to see "SHA256" on the logs folder, I've tested this works on AMD Ryzen 7 5700G, Intel i5-1035G1, and Intel i9-13900K on Windows 11.

Flags: needinfo?(susah.yak)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1826002#c37)â€¢ 2 years ago |
|  | |

Comment on [attachment 9338295](/attachment.cgi?id=9338295 "Bug 1826002 - use decoded certificates r?jschanck!") [[details]](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!")

[Bug 1826002](/show_bug.cgi?id=1826002 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") - use decoded certificates r?jschanck!

Approved for 102.13esr.

[Attachment #9338295](/attachment.cgi?id=9338295&action=edit "Bug 1826002 - use decoded certificates r?jschanck!") -
Flags: approval-mozilla-esr102? â†’ approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1826002#c38)â€¢ 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/a053c9cb7874>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a7423685_586683)â€¢ 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] â†’ [reporter-external] [client-bounty-form] [verif?][adv-main115+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1826002#c39)â€¢ 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341308)
â€” [Details](attachment.cgi?id=9341308&action=edit)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a7430081_586683)â€¢ 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main115+] â†’ [reporter-external] [client-bounty-form] [verif?][adv-main115+][adv-esr102.13+]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1826002#c40)â€¢ 2 years ago |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #36](/show_bug.cgi?id=1826002#c36 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Created [attachment 9341108](/attachment.cgi?id=9341108 "testcase3.html") [[details]](/attachment.cgi?id=9341108&action=edit "testcase3.html")
>
> testcase3.html
>
> (In reply to Bogdan Maris, Desktop QA from [comment #34](/show_bug.cgi?id=1826002#c34 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))
>
> > Using the old Nightly build from 2023-06-03 (32bit), the testcase2.html and the steps provided here I can't seem to see SHA256 anywhere in the directory where the logs are created and nothing inside the logs as well. I tested on both Windows 11 on a VM and Windows 10 on a real machine. Any thoughts?
>
> Ok, I've tried reproduce testcase2.html on Firefox Nightly 2023-06-03 (32bit), I download it from <https://ftp.mozilla.org/pub/firefox/nightly/2023/06/2023-06-03-09-24-55-mozilla-central/firefox-115.0a1.en-US.win32.installer.exe>, then I extracted the .exe and rename the updater.exe to updater.exe.bak to prevent automatic update, tried to reproduce this, but I also unable to see "SHA256" on the logs folder.
>
> Then I reduced the max fill memory on testcase2.html from `3753500000` to `3700000000`, I attached the modified testcase as testcase3.html, now I able to see "SHA256" on the logs folder, I've tested this works on AMD Ryzen 7 5700G, Intel i5-1035G1, and Intel i9-13900K on Windows 11.

Thanks for your reply and for the additional info. Unfortunately I still can't see SHA256 anywhere using the exact build that you posted above and the testcase3.html file. I tried on 3 different PCs, two of them Windows 10 (Intel Core i5-3470 and AMD FX(tm)-8320) and one Windows 11 (AMD Ryzen 5 3450U).

Since I can't seem to reproduce this on older builds, would you mind verifying if this is fixed on a few builds for us?

115.0 RC - <https://archive.mozilla.org/pub/firefox/candidates/115.0-candidates/build1/win32/en-US/Firefox%20Setup%20115.0.exe>

116.0a1 Nightly - <https://archive.mozilla.org/pub/firefox/nightly/2023/06/2023-06-27-21-45-48-mozilla-central/firefox-116.0a1.en-US.win32.installer.exe>

I would ask to try on 102.13 esr but we don't have a build yet, I will let you know when we do and will ask you to check that as well if you don't mind.

Flags: needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1826002#c41)â€¢ 2 years ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #40](/show_bug.cgi?id=1826002#c40 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Thanks for your reply and for the additional info. Unfortunately I still can't see SHA256 anywhere using the exact build that you posted above and the testcase3.html file. I tried on 3 different PCs, two of them Windows 10 (Intel Core i5-3470 and AMD FX(tm)-8320) and one Windows 11 (AMD Ryzen 5 3450U).
>
> Since I can't seem to reproduce this on older builds, would you mind verifying if this is fixed on a few builds for us?
>
> 115.0 RC - <https://archive.mozilla.org/pub/firefox/candidates/115.0-candidates/build1/win32/en-US/Firefox%20Setup%20115.0.exe>
>
> 116.0a1 Nightly - <https://archive.mozilla.org/pub/firefox/nightly/2023/06/2023-06-27-21-45-48-mozilla-central/firefox-116.0a1.en-US.win32.installer.exe>

Ok, I've tried reproduce this recently using testcase3.html on [Firefox Nightly 2023-06-03 (32bit)](https://ftp.mozilla.org/pub/firefox/nightly/2023/06/2023-06-03-09-24-55-mozilla-central/firefox-115.0a1.en-US.win32.installer.exe) on Intel i9-13900k, I able to see "SHA256" on the logs folder (log\_minidump\_00.txt).

I've downloaded Firefox 115.0 RC from <https://archive.mozilla.org/pub/firefox/candidates/115.0-candidates/build1/win32/en-US/Firefox%20Setup%20115.0.exe> and 116.0a1 Nightly from <https://archive.mozilla.org/pub/firefox/nightly/2023/06/2023-06-27-21-45-48-mozilla-central/firefox-116.0a1.en-US.win32.installer.exe>, then extracted the directory, try STR on [Comment 36](/show_bug.cgi?id=1826002#c36 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") using both testcase2.html and testcase3.html, I still unable to see "SHA256" on the logs directory.

> I would ask to try on 102.13 esr but we don't have a build yet, I will let you know when we do and will ask you to check that as well if you don't mind.

Ok, just set needinfo request on me, I'll test once the new ESR build is available.

Flags: needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1826002#c42)â€¢ 2 years ago |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #41](/show_bug.cgi?id=1826002#c41 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> Ok, I've tried reproduce this recently using testcase3.html on [Firefox Nightly 2023-06-03 (32bit)](https://ftp.mozilla.org/pub/firefox/nightly/2023/06/2023-06-03-09-24-55-mozilla-central/firefox-115.0a1.en-US.win32.installer.exe) on Intel i9-13900k, I able to see "SHA256" on the logs folder (log\_minidump\_00.txt).
>
> I've downloaded Firefox 115.0 RC from <https://archive.mozilla.org/pub/firefox/candidates/115.0-candidates/build1/win32/en-US/Firefox%20Setup%20115.0.exe> and 116.0a1 Nightly from <https://archive.mozilla.org/pub/firefox/nightly/2023/06/2023-06-27-21-45-48-mozilla-central/firefox-116.0a1.en-US.win32.installer.exe>, then extracted the directory, try STR on [Comment 36](/show_bug.cgi?id=1826002#c36 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") using both testcase2.html and testcase3.html, I still unable to see "SHA256" on the logs directory.
>
> > I would ask to try on 102.13 esr but we don't have a build yet, I will let you know when we do and will ask you to check that as well if you don't mind.
>
> Ok, just set needinfo request on me, I'll test once the new ESR build is available.

Sorry typo, I mean STR on [Comment 33](/show_bug.cgi?id=1826002#c33 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") (not [Comment 36](/show_bug.cgi?id=1826002#c36 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1826002#c43)â€¢ 2 years ago |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #41](/show_bug.cgi?id=1826002#c41 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> (In reply to Bogdan Maris, Desktop QA from [comment #40](/show_bug.cgi?id=1826002#c40 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))
>
> > Thanks for your reply and for the additional info. Unfortunately I still can't see SHA256 anywhere using the exact build that you posted above and the testcase3.html file. I tried on 3 different PCs, two of them Windows 10 (Intel Core i5-3470 and AMD FX(tm)-8320) and one Windows 11 (AMD Ryzen 5 3450U).
> >
> > Since I can't seem to reproduce this on older builds, would you mind verifying if this is fixed on a few builds for us?
> >
> > 115.0 RC - <https://archive.mozilla.org/pub/firefox/candidates/115.0-candidates/build1/win32/en-US/Firefox%20Setup%20115.0.exe>
> >
> > 116.0a1 Nightly - <https://archive.mozilla.org/pub/firefox/nightly/2023/06/2023-06-27-21-45-48-mozilla-central/firefox-116.0a1.en-US.win32.installer.exe>
>
> Ok, I've tried reproduce this recently using testcase3.html on [Firefox Nightly 2023-06-03 (32bit)](https://ftp.mozilla.org/pub/firefox/nightly/2023/06/2023-06-03-09-24-55-mozilla-central/firefox-115.0a1.en-US.win32.installer.exe) on Intel i9-13900k, I able to see "SHA256" on the logs folder (log\_minidump\_00.txt).
>
> I've downloaded Firefox 115.0 RC from <https://archive.mozilla.org/pub/firefox/candidates/115.0-candidates/build1/win32/en-US/Firefox%20Setup%20115.0.exe> and 116.0a1 Nightly from <https://archive.mozilla.org/pub/firefox/nightly/2023/06/2023-06-27-21-45-48-mozilla-central/firefox-116.0a1.en-US.win32.installer.exe>, then extracted the directory, try STR on [Comment 36](/show_bug.cgi?id=1826002#c36 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM") using both testcase2.html and testcase3.html, I still unable to see "SHA256" on the logs directory.
>
> > I would ask to try on 102.13 esr but we don't have a build yet, I will let you know when we do and will ask you to check that as well if you don't mind.
>
> Ok, just set needinfo request on me, I'll test once the new ESR build is available.

Thanks you very much. I'll go ahead and mark as verified both Nightly and RC based on the above.

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=verified)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a7516667_578488)â€¢ 2 years ago |

Alias: CVE-2023-37201

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1826002#c44)â€¢ 2 years ago |
|  | |

102.13esr build is up if you don't mind giving it a quick testing - <https://archive.mozilla.org/pub/firefox/candidates/102.13.0esr-candidates/build1/win32/en-US/Firefox%20Setup%20102.13.0esr.exe>

Flags: needinfo?(susah.yak)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1826002#c45)â€¢ 2 years ago |
|  | |

(In reply to Bogdan Maris, Desktop QA from [comment #44](/show_bug.cgi?id=1826002#c44 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> 102.13esr build is up if you don't mind giving it a quick testing - <https://archive.mozilla.org/pub/firefox/candidates/102.13.0esr-candidates/build1/win32/en-US/Firefox%20Setup%20102.13.0esr.exe>

Ok, I just tested it on Firefox 102.12.0esr (32-bit), on the testcase3.html I lowered max fill memory from `3700000000` to `3680000000`, I able to find "SHA256" string on the logs folder.

After that I downloaded Firefox 102.13esr (32-bit) from <https://archive.mozilla.org/pub/firefox/candidates/102.13.0esr-candidates/build1/win32/en-US/Firefox%20Setup%20102.13.0esr.exe> then retest with same testcase as above, repeated multiple times (more than 20x times), I still unable to see "SHA256" string on the logs folder.

Flags: needinfo?(susah.yak)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1826002#c46)â€¢ 2 years ago |
|  | |

(In reply to Irvan Kurniawan (:sourc7) from [comment #45](/show_bug.cgi?id=1826002#c45 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))

> (In reply to Bogdan Maris, Desktop QA from [comment #44](/show_bug.cgi?id=1826002#c44 "VERIFIED FIXED - Use-after-free on freebl3!SHA256_Update_Native at sha256-x86.c on OOM"))
>
> > 102.13esr build is up if you don't mind giving it a quick testing - <https://archive.mozilla.org/pub/firefox/candidates/102.13.0esr-candidates/build1/win32/en-US/Firefox%20Setup%20102.13.0esr.exe>
>
> Ok, I just tested it on Firefox 102.12.0esr (32-bit), on the testcase3.html I lowered max fill memory from `3700000000` to `3680000000`, I able to find "SHA256" string on the logs folder.
>
> After that I downloaded Firefox 102.13esr (32-bit) from <https://archive.mozilla.org/pub/firefox/candidates/102.13.0esr-candidates/build1/win32/en-US/Firefox%20Setup%20102.13.0esr.exe> then retest with same testcase as above, repeated multiple times (more than 20x times), I still unable to see "SHA256" string on the logs folder.

Thanks again for testing this. I'll go ahead and mark this bug as verified fixed.

Status: RESOLVED â†’ VERIFIED
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a17142940_1689)â€¢ 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826002#a36633482_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1826002&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.debian.org_26aab747_20250114_182742.html ===


---

[[Date Prev](msg00142.html)][[Date Next](msg00144.html)]
[[Thread Prev](msg00142.html)][[Thread Next](msg00144.html)]
[[Date Index](maillist.html#00143)]
[[Thread Index](threads.html#00143)]

# [SECURITY] [DSA 5451-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5451-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 9 Jul 2023 18:30:19 +0000
* *Message-id*: <ZKr8u5sD79xL/DXZ@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5451-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
July 09, 2023                         <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2023-37201 CVE-2023-37202 CVE-2023-37207
                 CVE-2023-37208 CVE-2023-37211
Debian Bug     : 971790 1006432

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For the oldstable distribution (bullseye), this problem has been fixed
in version 1:102.13.0-1~deb11u1.

For the stable distribution (bookworm), this problem has been fixed in
version 1:102.13.0-1~deb12u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmSq/IEACgkQEMKTtsN8
TjbbzA//RGC3Tj6WRrccthY5Uxh30CLYzuGvJmlwzd4iH80/8cXZi4dbPu0bSFnP
wA6qjtNxxeCFcc711699O9LqVGQUBzyK23hp012yHtPb4zjnWwkhZ7FqyZCvgx9d
H06rtsuOAr2PBlS4bcW3NQy9fH1xMom/+blW6L4IejQ3jXJXmT6B/xZxo0aj39bE
qNZXxtBWLdiIzVDjXbR7TMT9J+UkvTxyNTXKjf6d3u34LfEIfiHHE8vfZB+JCwwn
17I8/nsecJglQHXpIu7dNfDNqLmLJPrceBl1R3XMHmA3uQLqQMypT5nsPdWpiMOW
kOvgmE6jrUUcR7mgQsTcxqD6B5QEztEvOpaRrA7MB5geWewd8E4deksvGwv5Tr9R
coBM2lzbLRrnbcki83qTjNX8D7B7Urs+uU3YIp/TNSwmaiLIXgwxu7CyzLUif6+7
+n3GPSMski64qc6WJ0cPajQAmdX2pwtWmyYne5mcKpC3iujj/fQTpZ+Qf5Yuhs/K
jAd+xqwOXpbEMrCwWBssy92Nj8vWkT2T4vIco1QRxKy3TSBkwubjigZSorKFIx6v
39a4AeknI0HuH4E3oJ8E6+Um9miptZB4jswlRSRDay7H1AX6bVfs1Bi0L1pozNG6
lfcugCF+TPFaLRBcBEK3dD4ch47x98rE9bOEZr2ITT2JuP+A1cE=
=SqjJ
-----END PGP SIGNATURE-----

```

---


