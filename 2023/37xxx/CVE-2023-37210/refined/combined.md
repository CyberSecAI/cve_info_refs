=== Content from security.gentoo.org_897e22ca_20250114_193321.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_87fe465c_20250114_193321.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1821886)
* [XML](/show_bug.cgi?ctype=xml&id=1821886)

Closed
[Bug 1821886](/show_bug.cgi?id=1821886)
(CVE-2023-37210)

Opened 2 years ago
Closed 2 years ago

# Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert

## Categories

### (Core :: DOM: Events, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Events#DOM%3A%20Events)

DOM: Events
▾

Core :: DOM: Events
This component includes bugs for DOM events from [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/).
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Events&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Events&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Events)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

115 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox113 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox113 |  | wontfix |
| firefox114 |  | wontfix |
| firefox115 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: masayuki)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/900caab146bc7a489b3854cf10acf93f?d=mm&size=40)  [masayuki](/user_profile?user_id=34283)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1835570](/show_bug.cgi?id=1835570 "RESOLVED FIXED - Full screen shortcut no longer displayed in menubar \"View\" menu nor hamburger menu (says \"null\" instead in that menu!)")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, reporter-external, sec-low, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main115+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-37210

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main115+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a6870004_1689 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a6419544_75935 "2 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [bandicam 2023-03-12 13-04-02-922.mp4](/attachment.cgi?id=9322583)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   1.16 MB, video/mp4 |  | [Details](/attachment.cgi?id=9322583&action=edit) |
| --- | --- | --- |
| [pocfullscreen.html](/attachment.cgi?id=9322584)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   1.07 KB, text/html |  | [Details](/attachment.cgi?id=9322584&action=edit) |
| [urlbar.jpg](/attachment.cgi?id=9322585)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   27.27 KB, image/jpeg |  | [Details](/attachment.cgi?id=9322585&action=edit) |
| [Bug 1821886 - Reserve shortcut keys exiting from the fullscreen mode r=Gijs!,Edgar!,smaug!](/attachment.cgi?id=9334474)  [2 years ago](#c26)  [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9334474&action=edit) | [Review](/attachment.cgi?id=9334474) |
| [advisory.txt](/attachment.cgi?id=9341310)  [2 years ago](#c28)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   197 bytes, text/plain |  | [Details](/attachment.cgi?id=9341310&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1821886#c0)• 2 years ago |
|  | |

Attached video
[bandicam 2023-03-12 13-04-02-922.mp4](attachment.cgi?id=9322583)
— [Details](attachment.cgi?id=9322583&action=edit)

i found vulnerabilty when using zoom feature using press Fn+F11 or F11 on keyboard , the web page can the webpage will go fullscreen,

and when it will exit fullscreen mode user must press Fn+F11 or F11 again. This will be used to spoof by using a window prompt / alert (do not exit fullscreen mode when pressing f11) so that the victim will think they have exited fullscreen mode

1. open pocfullscreen.html
2. press Fn+F11 or F11 on keyboard to using zoom feature (fullscreen)

   3 press Fn+F11 or F11 on keyboard again to exit zoom (fullscreen) (it show alert and not exit on fullscreen mode it can spoof )

mitigation:

* when using zoom feature (fullscreen) show notification fullscreen
Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1821886#c1)• 2 years ago |
|  | |

Attached file
[pocfullscreen.html](attachment.cgi?id=9322584)
— [Details](attachment.cgi?id=9322584&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1821886#c2)• 2 years ago |
|  | |

Attached image
[urlbar.jpg](attachment.cgi?id=9322585)
— [Details](attachment.cgi?id=9322585&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1821886#c3)• 2 years ago |
|  | |

new POC

1. <http://103.186.0.20/pocfullscreen.html>
2. press Fn+F11 or F11 on keyboard to using zoom feature (fullscreen)

   3 press Fn+F11 or F11 on keyboard again to exit zoom (fullscreen) (it show alert and not exit on fullscreen mode it can spoof )

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1821886#c4)• 2 years ago |
|  | |

Edgar, can you take a look? ISTM websites should not be able to prevent exiting F11-fullscreen.

Flags: needinfo?(echen)Summary: using zoom feature (fullscreen) it can spoof using window prompt/alert → Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1821886#c5)• 2 years ago |
|  | |

Yes, website should not be able to prevent exiting fullscreen. It seems like `alert()` call in `keydown` event handler somehow suppress event handling for F11 to exit fullscreen. If you keep the alter open and press F11 again, fullscreen can be exited. I will check why `alert()` suppress fullscreen exit.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1821886#c6)• 2 years ago |
|  | |

Parent process doesn't handle the `eKeyPress` (while receiving `ReplyKey` from content process) because it is preventDefaulted, <https://searchfox.org/mozilla-central/rev/af78418c4b5f2c8721d1a06486cf4cf0b33e1e8d/dom/events/GlobalKeyListener.cpp#92-94>. And it is preventDefaulted in content process in <https://searchfox.org/mozilla-central/rev/af78418c4b5f2c8721d1a06486cf4cf0b33e1e8d/dom/ipc/BrowserChild.cpp#2042-2044> due to the document is suppressed on event handling for `alert()` call.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1821886#c7)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #6](/show_bug.cgi?id=1821886#c6 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))

> And it is preventDefaulted in content process in <https://searchfox.org/mozilla-central/rev/af78418c4b5f2c8721d1a06486cf4cf0b33e1e8d/dom/ipc/BrowserChild.cpp#2042-2044> due to the document is suppressed on event handling for `alert()` call.

Oh, this was introduced in [bug 1309587](/show_bug.cgi?id=1309587 "RESOLVED FIXED - Text inputs on VIA Rail website behave badly with e10s").

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1821886#c8)• 2 years ago |
|  | |

Hmm, page could even just use `event.preventDefault()` in keyboard event handler to prevent exiting fullscreen. Chrome doesn't allow the default action of exiting fullscreen being prevented, i.e. `event.preventDefault()` won't prevent the default action of exiting fullscreen, but it can prevent entering fullscreen.

Masayuki, it seems `GlobalKeyListener` just ignore a preventDefaulted event in <https://searchfox.org/mozilla-central/rev/af78418c4b5f2c8721d1a06486cf4cf0b33e1e8d/dom/events/GlobalKeyListener.cpp#92-94>, we probably doesn't have any existing way that can avoid page preventDefault a xul command? What is your suggestion to handle this, i.e. avoid page to prevent exiting fullscreen by calling `event.preventDefault()`?

Flags: needinfo?(echen) → needinfo?(masayuki)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a147003_455480)• 2 years ago |

Group: firefox-core-security → core-securityComponent: Security → DOM: EventsProduct: Firefox → Core

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a147047_455480)• 2 years ago |

Severity: -- → S2

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1821886#c9)• 2 years ago |
|  | |

Basically, Gecko does not dispatch keyboard events whose default actions are not cancelable. However, I'm not sure whether we should apply this rule for `F11` here because (according to your comment,) Chrome dispatches keyboard events of `F11` even in the cases. Therefore, not dispatching keyboard events **might** cause new web-compat issues.

If you stop dispatching `F11` keyboard events only while it's in the fullscreen mode, you can call `WidgetEvent::StopCrossProcessForwarding` in `EventStateManager::PreHandleEvent` or somewhere in the main process.

If you won't stop dispatching `F11` keyboard events, I think that you could set `WidgetEvent::mFlags.mCancelable` to `false` before dispatching it into the DOM tree.

Olli: Do you have any ideas?

Flags: needinfo?(masayuki) → needinfo?(smaug)

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1821886#c10)• 2 years ago |
|  | |

Ah, but for making the shortcut key customizable, we could need to consider it in `GlobalKeyListener` with adding new attribute to [the `<key>`](https://searchfox.org/mozilla-central/rev/af78418c4b5f2c8721d1a06486cf4cf0b33e1e8d/browser/base/content/browser-sets.inc#218), perhaps around [here](https://searchfox.org/mozilla-central/rev/af78418c4b5f2c8721d1a06486cf4cf0b33e1e8d/dom/events/GlobalKeyListener.cpp#340,351).

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1821886#c11)• 2 years ago |
|  | |

(In reply to Masayuki Nakano [:masayuki] (he/him)(JST, +0900) from [comment #9](/show_bug.cgi?id=1821886#c9 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))

> Basically, Gecko does not dispatch keyboard events whose default actions are not cancelable. However, I'm not sure whether we should apply this rule for `F11` here because (according to your comment,) Chrome dispatches keyboard events of `F11` even in the cases. Therefore, not dispatching keyboard events **might** cause new web-compat issues.

Oh, Chrome doesn't dispatch `F11` event while browser is in fullscreen mode (I thought it dispatch but the event is not cancelled, but it actually doesn't dispatch at all).

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1821886#c12)• 2 years ago |
|  | |

Not dispatching F11 when we're in fullscreen mode sounds reasonable.

Flags: needinfo?(smaug)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1821886#c13)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1821886&comment_id=16325316 "1 revision") |
|  | |

Chrome behave differently on Mac where the shortcut for browser fullscreen is `fn`+`F`, it still dispatch the keyboard event but it seems not cancelable (i.e. calling preventDefault() won't prevent exiting fullscreen). And Chrome's behavior on Windows where the shortcut for browser fullscreen is also `F11` is the same as Linux (event isn't dispatched at all).

I am not sure why Chrome behave differently on Mac. But I feel that it might make more sense to behave consistent on each platform? I will try to check Chromuim source code to see if I could find any clue.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1821886#c14)• 2 years ago |
|  | |

I agree, we should try be consistent, even if Chrome isn't.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a216420_406194)• 2 years ago |

Group: core-security → dom-core-security

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1821886#c15)• 2 years ago |
|  | |

Yeah, then, we should not dispatch keyboard events of a shortcut key to exit fullscreen mode if and only if it's in the fullscreen mode.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1821886#c16)• 2 years ago |
|  | |

Would it be enough to add `reserved="true"` to the relevant `<key>` elements?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1821886#c17)• 2 years ago |
|  | |

Doesn't seem to work on Mac -- Cmd-shift-F always seems to work, as does mousing up to the top to bring up the real OS menu bar.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1821886#c18)• 2 years ago |
|  | |

Locking someone into fullscreen is more of a DOS. Seems like if you're going to do this kind of spoof and the victim browses around in application-fullscreen mode, then any random page could just draw a picture of a browser and make the user think Firefox popped out of fullscreen.

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1821886#c19)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #16](/show_bug.cgi?id=1821886#c16 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))

> Would it be enough to add `reserved="true"` to the relevant `<key>` elements?

Unfortunately, no. We need to reserve it only while it's in the fullscreen mode because the command toggles the state. Perhaps, `reserved` command should be set at entering the fullscreen mode and removed at existing from it, just check it in `GlobalKeyHandler` dynamically, or split the command to enter and to exit and update enabled state of them at changing the fullscreen mode and reserve the exit key.

BTW, does the keyboard navigation with the buttons in the fullscreen mode work even if all keyboard events are `preventDefault`'ed by the web apps? If no, it could be that the simplest solution is, we always stop dispatching keyboard events while it's in the fullscreen mode.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1821886#c20)• 2 years ago |
|  | |

(In reply to Masayuki Nakano [:masayuki] (he/him)(JST, +0900) from [comment #19](/show_bug.cgi?id=1821886#c19 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))

> (In reply to :Gijs (he/him) from [comment #16](/show_bug.cgi?id=1821886#c16 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))
>
> > Would it be enough to add `reserved="true"` to the relevant `<key>` elements?
>
> Unfortunately, no. We need to reserve it only while it's in the fullscreen mode because the command toggles the state.

I'm afraid I don't follow. Why would it be bad to reserve the key in non-fullscreen mode? AIUI all it means is that websites would not be able to prevent entering fullscreen. That doesn't seem unreasonable to me?

> BTW, does the keyboard navigation with the buttons in the fullscreen mode work even if all keyboard events are `preventDefault`'ed by the web apps?

I'm not sure what you specifically mean with "keyboard navigation with the buttons". Assuming you're referring to tab/arrow navigation in the toolbox, I would expect it to work once you got focus into that area of the browser, as I wouldn't expect events to go to web content at all. Inside web content itself, I guess websites will need to be able to adjust behaviour for tab/shift-tab so I guess they could break the focus-switching behaviour completely if they wanted to...

> If no, it could be that the simplest solution is, we always stop dispatching keyboard events while it's in the fullscreen mode.

(This too I'm a bit confused by - presumably users still need to be able to use input fields etc. in fullscreen mode, so not sure what you mean by not dispatching the events at all? Sorry for all the dumb questions...)

Flags: needinfo?(masayuki)

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1821886#c21)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #20](/show_bug.cgi?id=1821886#c20 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))

> (In reply to Masayuki Nakano [:masayuki] (he/him)(JST, +0900) from [comment #19](/show_bug.cgi?id=1821886#c19 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))
>
> > (In reply to :Gijs (he/him) from [comment #16](/show_bug.cgi?id=1821886#c16 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))
> >
> > > Would it be enough to add `reserved="true"` to the relevant `<key>` elements?
> >
> > Unfortunately, no. We need to reserve it only while it's in the fullscreen mode because the command toggles the state.
>
> I'm afraid I don't follow. Why would it be bad to reserve the key in non-fullscreen mode? AIUI all it means is that websites would not be able to prevent entering fullscreen. That doesn't seem unreasonable to me?

Although I've not checked the other browsers' behavior. I assume that they allow web apps to prevent **entering** the fullscreen mode with keyboard event listeners, we should follow it. Otherwise, it's fine to make it always reserved. In my understanding, **exiting** from the fullscreen mode is more important than **entering** to the fullscreen mode because the fullscreen mode consumes the space in the screen from the other native apps.

> > BTW, does the keyboard navigation with the buttons in the fullscreen mode work even if all keyboard events are `preventDefault`'ed by the web apps?
>
> I'm not sure what you specifically mean with "keyboard navigation with the buttons".

Ah, sorry. I was confused at the fullscreen mode UI of the `<vidoe>`.

> > If no, it could be that the simplest solution is, we always stop dispatching keyboard events while it's in the fullscreen mode.
>
> (This too I'm a bit confused by - presumably users still need to be able to use input fields etc. in fullscreen mode, so not sure what you mean by not dispatching the events at all? Sorry for all the dumb questions...)

Sorry, this is too. I was confused at the fullscreen mode of the `<video>`.

(Sorry for the long delay to reply since I'm sick, I need some more days to restart my usual work.)

Flags: needinfo?(masayuki)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1821886#c22)• 2 years ago |
|  | |

(In reply to Masayuki Nakano [:masayuki] (he/him)(JST, +0900)(still sick) from [comment #21](/show_bug.cgi?id=1821886#c21 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert"))

> (Sorry for the long delay to reply since I'm sick, I need some more days to restart my usual work.)

No worries, please get well before replying! This bug can wait a bit.

> Although I've not checked the other browsers' behavior. I assume that they allow web apps to prevent **entering** the fullscreen mode with keyboard event listeners, we should follow it. Otherwise, it's fine to make it always reserved. In my understanding, **exiting** from the fullscreen mode is more important than **entering** to the fullscreen mode because the fullscreen mode consumes the space in the screen from the other native apps.

Hm. Thanks for elaborating. I don't really understand why websites would want/need to prevent entering fullscreen. Preventing the keyboard shortcut would not prevent opening fullscreen via the browser menus or toolbar buttons. I'm not sure why we would want to give websites the opportunity to block one of these but not the other - I guess in case the shortcut is supposed to do something else inside the web app instead of toggling full screen? But then, that would still not work properly if the shortcut did always exit fullscreen (but didn't enter it).

I tested Chrome on macOS (where it now uses Fn+F to open fullscreen), and could not prevent entering fullscreen using this shortcut. However, reading up about the shortcut change, it seems cmd-ctrl-f is also still supported to enter full screen, and that shortcut **was** prevented. See also [comment 13](/show_bug.cgi?id=1821886#c13 "RESOLVED FIXED - Alerts break exiting non-DOM fullscreen leading to spoof using window prompt/alert").

Assuming we want to do the same, we could of course fix this in DOM code, but I do wonder whether the simplest fix would be duplicating the `<key>` element, using one for entering and one for exiting, making the exiting one `reserved`, and enabling/disabling them based on whether we're in fullscreen at the moment.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1821886#c23)• 2 years ago |
|  | |

Sorry for the long delay.

> I don't really understand why websites would want/need to prevent entering fullscreen.

Web apps may want to use function keys for their shortcut keys. In this scenario, web apps must want to prevent any defaults of their shortcut keys, not just for entering fullscreen.

> Preventing the keyboard shortcut would not prevent opening fullscreen via the browser menus or toolbar buttons.

Indeed, but the other browser commands associated with a shortcut key have same issue. So I think that the inconsistency is not a problem.

Once we allow to override `F11` only at entering the fullscreen mode, the shortcut key of the web app may not work only when exiting from the fullscreen mode which is started without `F11` key press. This inconsistent behavior (temporarily `F11` is not available on the web apps) is not good, but I think that this is rarer than the cases `F11` work as expected on web apps without fullscreen mode.

> I tested Chrome on macOS (where it now uses Fn+F to open fullscreen), and could not prevent entering fullscreen using this shortcut.

I tested it on Chrome on Windows. Then, `F11` for entering the fullscreen mode can be overridden. However, `F11` key events are not fired for existing the fullscreen mode. This is what I'd love to do.

> but I do wonder whether the simplest fix would be duplicating the `<key>` element, using one for entering and one for exiting, making the exiting one `reserved`, and enabling/disabling them based on whether we're in fullscreen at the moment.

Yeah, sounds like it's the best approach to fix this soon without risky changes.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1821886#c24)• 2 years ago |
|  | |

Hmm, only one `<key>` element is registered into `GlobalKeyListener` if some have same key combinations. Therefore, the approach using multiple `<key>` elements do not work. Additionally, updating `reserved` attribute does not affect `GlobalKeyListener` because probably it's once initialized and not observing the mutations. I'll keep investigating which way is the simplest/safest fix.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a5270754_34283)• 2 years ago |

Assignee: nobody → masayukiStatus: NEW → ASSIGNED

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1821886#c25)• 2 years ago |
|  | |

Ah, it seems that it's caused by a bug of the loop in `GlobalKeyListener::WalkHandlersAndExecute`.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1821886#c26)• 2 years ago |
|  | |

Attached file
[Bug 1821886 - Reserve shortcut keys exiting from the fullscreen mode r=Gijs!,Edgar!,smaug!](attachment.cgi?id=9334474)
— [Details](attachment.cgi?id=9334474&action=edit)

Chrome for Windows does not dispatch `keydown` event for shortcut keys existing

from the fullscreen mode. Therefore, we can follow it.

For reserving only shortcut keys in fullscreen mode, we need to duplicate XUL

`<key>` elements which define the shortcut keys (only one in Windows/Linux,

but 3 in macOS). Then, their `disabled` attributes should be managed when

toggling the fullscreen mode.

Finally, we need to make `XULKeySetGlobalKeyListener` check the `disabled`

attribute **of** `<key>` elements because it's check in `DispatchXULKeyCommand`

in the final step:

<https://searchfox.org/mozilla-central/rev/11a4d97a7b5cdfa133f4bda4525649f651703018/dom/events/KeyEventHandler.cpp#315-316>

and it stops handling everything with doing nothing. I'm not sure whether this

was intentionally implemented or just a inefficient code which we didn't take

care the performance. However, I think that ignoring the disabled `<key>`

elements is reasonable behavior from `<key>` element users point of view.

(I found only one `<key>` which is disabled by default:

<https://searchfox.org/mozilla-central/rev/11a4d97a7b5cdfa133f4bda4525649f651703018/browser/base/content/browser-sets.inc#225-233>)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1821886#c27)• 2 years ago |
|  | |

Reserve shortcut keys exiting from the fullscreen mode r=Gijs,edgar,smaug

<https://hg.mozilla.org/integration/autoland/rev/caf2490340fed8d3d90e7dcb96d73af5eeabfe13>

<https://hg.mozilla.org/mozilla-central/rev/caf2490340fe>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 115 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a6419544_75935)• 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)Flags: in-testsuite+

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a6714621_159069)• 2 years ago |

Regressions: [1835570](/show_bug.cgi?id=1835570 "RESOLVED FIXED - Full screen shortcut no longer displayed in menubar \"View\" menu nor hamburger menu (says \"null\" instead in that menu!)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a6870004_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a9280578_586683)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main115+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1821886#c28)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341310)
— [Details](attachment.cgi?id=9341310&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a9373406_578488)• 2 years ago |

Alias: CVE-2023-37210

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a18999642_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821886#a38490144_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1821886&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ecd955a5_20250114_193322.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-22

## Security Vulnerabilities fixed in Firefox 115

Announced
July 4, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 115

#### [#CVE-2023-3482: Block all cookies bypass for localstorage](#CVE-2023-3482)

Reporter
Martin Hostettler
Impact
moderate
##### Description

When Firefox is configured to block storage of all cookies, it was still possible to store data in localstorage by using an iframe with a source of 'about:blank'. This could have led to malicious websites storing tracking data without permission.

##### References

* [Bug 1839464](https://bugzilla.mozilla.org/show_bug.cgi?id=1839464)

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37203: Drag and Drop API may provide access to local system files](#CVE-2023-37203)

Reporter
Paul Nickerson and Ameen Basha M K
Impact
moderate
##### Description

Insufficient validation in the Drag and Drop API in conjunction with social engineering, may have allowed an attacker to trick end-users into creating a shortcut to local system files. This could have been leveraged to execute arbitrary code.

##### References

* [Bug 291640](https://bugzilla.mozilla.org/show_bug.cgi?id=291640)

#### [#CVE-2023-37204: Fullscreen notification obscured via option element](#CVE-2023-37204)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using an option element by introducing lag via an expensive computational function. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832195](https://bugzilla.mozilla.org/show_bug.cgi?id=1832195)

#### [#CVE-2023-37205: URL spoofing in address bar using RTL characters](#CVE-2023-37205)

Reporter
Rohan Sharma
Impact
moderate
##### Description

The use of RTL Arabic characters in the address bar may have allowed for URL spoofing.

##### References

* [Bug 1704420](https://bugzilla.mozilla.org/show_bug.cgi?id=1704420)

#### [#CVE-2023-37206: Insufficient validation of symlinks in the FileSystem API](#CVE-2023-37206)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Uploading files which contain symlinks may have allowed an attacker to trick a user into submitting sensitive data to a malicious website.

##### References

* [Bug 1813299](https://bugzilla.mozilla.org/show_bug.cgi?id=1813299)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37209: Use-after-free in "NotifyOnHistoryReload"](#CVE-2023-37209)

Reporter
Simon Descarpentries
Impact
moderate
##### Description

A use-after-free condition existed in `NotifyOnHistoryReload` where a `LoadingSessionHistoryEntry` object was freed and a reference to that object remained. This resulted in a potentially exploitable condition when the reference to that object was later reused.

##### References

* [Bug 1837993](https://bugzilla.mozilla.org/show_bug.cgi?id=1837993)

#### [#CVE-2023-37210: Full-screen mode exit prevention](#CVE-2023-37210)

Reporter
Hafiizh
Impact
low
##### Description

A website could prevent a user from exiting full-screen mode via alert and prompt calls. This could lead to user confusion and possible spoofing attacks.

##### References

* [Bug 1821886](https://bugzilla.mozilla.org/show_bug.cgi?id=1821886)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

#### [#CVE-2023-37212: Memory safety bugs fixed in Firefox 115](#CVE-2023-37212)

Reporter
Andrew McCreight, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 114. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1750870%2C1825552%2C1826206%2C1827076%2C1828690%2C1833503%2C1835710%2C1838587)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


