- **Root cause of vulnerability**: The vulnerability lies in the way Foxit Reader handles the `exportDataObject` method of the `Doc` object. Specifically, the application doesn't properly validate the filename specified via the `UF` key, and fails to sanitize directory traversal characters (../) before appending the filename to a temporary directory path. This allows an attacker to write files to arbitrary locations. Additionally, the application's blocklist filter for suspicious file extensions is incomplete, as it filters `hta%20` but not `hta`.
- **Weaknesses/vulnerabilities present**:
  - Directory traversal vulnerability due to lack of proper input validation for file paths.
  - Incomplete blocklist for dangerous file extensions allowing execution of HTA files.
  - Use of the `exportDataObject` method with `nLaunch` set to 2 allows automatic execution of the created file.
- **Impact of exploitation**: Arbitrary file creation and arbitrary code execution via HTA files. Successful exploitation allows an attacker to execute arbitrary code on the victim's machine by creating and executing a malicious HTA file.
- **Attack vectors**:
  - By tricking a user into opening a specially crafted PDF file.
  - By visiting a malicious website with the browser plugin extension enabled.
- **Required attacker capabilities/position**:
  - Ability to create a malicious PDF file with the described properties.
  - Ability to deliver the malicious PDF file to the victim or host it on a website.