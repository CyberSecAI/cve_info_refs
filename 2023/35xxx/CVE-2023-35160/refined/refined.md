Based on the provided information, here's an analysis of CVE-2023-35160:

**Root Cause of Vulnerability:**
The vulnerability is a Reflected Cross-Site Scripting (RXSS) issue stemming from the `resubmit` template in XWiki. The application fails to properly sanitize user-controlled parameters (`resubmit` and `xback`) which are then directly output into the HTML, allowing for the injection of malicious JavaScript code.

**Weaknesses/Vulnerabilities Present:**
- **Reflected Cross-Site Scripting (RXSS):** The core weakness is the lack of input sanitization and output encoding of the `resubmit` and `xback` parameters. This allows an attacker to inject malicious scripts that are then reflected back to the victim's browser.
- **Unsafe URL Handling:** The application did not properly validate or sanitize URLs provided via parameters before using them in the `action` attribute of a form and the `href` attribute of an anchor element.

**Impact of Exploitation:**
- **Full User Compromise:**  An attacker can execute arbitrary JavaScript in the victim's browser, potentially leading to:
    - Performing actions on behalf of the user.
    - Viewing sensitive information accessible to the user.
    - Modifying data that the user has access to.
- **Session Hijacking:** By stealing session cookies, the attacker can take over the user's session.
- **Malware Distribution:** The attacker could redirect the user to a malicious website or download malware.

**Attack Vectors:**
- **URL Manipulation:**  The attack vector involves crafting a malicious URL containing JavaScript in the `resubmit` and `xback` parameters, like the example given:  `xwiki/bin/view/XWiki/Main?xpage=resubmit&resubmit=javascript:alert(document.domain)&xback=javascript:alert(document.domain)`
- **Social Engineering:** An attacker would likely need to trick a user into clicking the malicious link, for example through phishing or other social engineering tactics.

**Required Attacker Capabilities/Position:**
- **Ability to create and distribute malicious links:** The attacker needs to be able to construct and distribute the malicious URL to a victim.
- **No authentication required**: The attacker does not need to authenticate to exploit this vulnerability.
- **User interaction required**: The victim needs to click on the malicious link.

**Additional Notes:**
- The vulnerability has been present since XWiki 2.5-milestone-2 and fixed in versions 14.10.5 and 15.1-rc-1.
- The fix involved the use of a new macro named `#getSanitizedURLAttributeValue`  that sanitizes URL attributes. This macro leverages other XWiki script services for URL and HTML sanitization.
- The severity of this vulnerability is considered "Critical" with a CVSS score of 9.7.
- The Jira ticket [XWIKI-20583](https://jira.xwiki.org/browse/XWIKI-20583) was created to address the need for a macro to sanitize URLs in templates, demonstrating a proactive measure to avoid similar issues.
- The commit [dbc92dc](https://github.com/xwiki/xwiki-platform/commit/dbc92dcdace33823ffd1e1591617006cb5fc6a7f) shows the actual code change that adds sanitization of the URL attribute.