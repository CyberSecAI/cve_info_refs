```
{
  "vulnerability": {
    "root_cause": "The vulnerability lies in the permission check logic for accessing user information via the `/api/user/userGrid/{datasetId}` endpoint. The system automatically adds a dataset with level 3 and a value of 0 to the list of accessible datasets during permission checks. This allows a low-privileged user to bypass the intended access controls.",
    "weaknesses": [
      "Insufficient access control",
      "Privilege bypass",
      "Flawed logic in permission validation"
    ],
    "impact": "An ordinary user can retrieve sensitive information about all users, including their password hashes (MD5), usernames, email addresses, and phone numbers. This can lead to unauthorized access, account compromise, and further attacks.",
    "attack_vectors": {
      "method": "Direct API call",
      "endpoint": "/api/user/userGrid/{datasetId}",
      "payload": "Using a datasetId of 0 when a level 3 dataset is added to the access list automatically."
    },
    "required_capabilities": "The attacker only needs a low-privileged user account (like a demo user). They must also be able to make API calls to the DataEase server."
  },
  "additional_details": "The vulnerability occurs because the AOP annotation restricts access to level 3 and above, while the permission check logic inadvertently adds a dataset with level 3 and value 0, which is used to perform the check via datasetId. This dataset is returned by AuthUtils.permissionByType. This allows any user to perform the api call by using datasetId 0, resulting in leaking all user information."
}
```