=== Content from github.com_576752a8_20250114_192312.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcompare%2Fsuricata-6.0.12...suricata-6.0.13)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcompare%2Fsuricata-6.0.12...suricata-6.0.13)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  72](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

[Permalink](https://github.com/OISF/suricata/compare/OISF%3A809aebf...OISF%3Af09a6b5)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
OISF/suricata

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
suricata-6.0.12

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-6.0.13)

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...suricata-6.0.13)

 Loading

...

*head repository:*
OISF/suricata

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
suricata-6.0.13

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/OISF/suricata/compare/suricata-6.0.12...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/OISF/suricata/compare/suricata-6.0.12...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

6
contributors

[Commits
45](#commits_bucket)
[Files changed
53](#files_bucket)

 Loading

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff suricata-6.0.12...suricata-6.0.13`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_aa6eefa1_20250114_192305.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F735f5aa9ca3b28cfacc7a443f93a44387fbacf17)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F735f5aa9ca3b28cfacc7a443f93a44387fbacf17)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  72](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/735f5aa9ca3b28cfacc7a443f93a44387fbacf17)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

datasets: flag to disable "write" actions

[Browse files](/OISF/suricata/tree/735f5aa9ca3b28cfacc7a443f93a44387fbacf17)
Browse the repository at this point in the history

```
Add a new configuration flag, "datasets.rules.allow-write" to control
if rules can contain "save" or "state" rules which allow write access
to the file system.

Ticket: [#6123](https://github.com/OISF/suricata/pull/6123)
```

* Loading branch information

[![@jasonish](https://avatars.githubusercontent.com/u/644115?s=40&v=4)](/jasonish) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[jasonish](/OISF/suricata/commits?author=jasonish "View all commits by jasonish")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Jun 14, 2023

1 parent
[3f7b7e0](/OISF/suricata/commit/3f7b7e0b26df9d948549d7ccf40c1a5e41623fd8)

commit 735f5aa

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**14 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/detect-dataset.c
    [detect-dataset.c](#diff-f794456436bc6c8a750a12e1dc9d1361126081ce06dc9096701852f363b7cf00)
* suricata.yaml.in
  [suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db)

## There are no files selected for viewing

9 changes: 9 additions & 0 deletions

9
[src/detect-dataset.c](#diff-f794456436bc6c8a750a12e1dc9d1361126081ce06dc9096701852f363b7cf00 "src/detect-dataset.c")

Show comments

[View file](/OISF/suricata/blob/735f5aa9ca3b28cfacc7a443f93a44387fbacf17/src/detect-dataset.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -302,6 +302,15 @@ static int SetupSavePath(const DetectEngineCtx \*de\_ctx, |
|  |  | { |
|  |  | SCLogDebug("save %s", save); |
|  |  |  |
|  |  | int allow\_save = 1; |
|  |  | if (ConfGetBool("datasets.rules.allow-write", &allow\_save)) { |
|  |  | if (!allow\_save) { |
|  |  | SCLogError(SC\_ERR\_INVALID\_SIGNATURE, |
|  |  | "Rules containing save/state datasets have been disabled"); |
|  |  | return -1; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | int allow\_absolute = 0; |
|  |  | (void)ConfGetBool("datasets.rules.allow-absolute-filenames", &allow\_absolute); |
|  |  | if (allow\_absolute) { |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db "suricata.yaml.in")

Show comments

[View file](/OISF/suricata/blob/735f5aa9ca3b28cfacc7a443f93a44387fbacf17/suricata.yaml.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1004,6 +1004,11 @@ asn1-max-frames: 256 |
|  |  | # # ".." components to reference parent directories in rules that specify |
|  |  | # # their filenames. |
|  |  | # #allow-absolute-filenames: false |
|  |  | # |
|  |  | # # Allow datasets in rules write access for "save" and |
|  |  | # # "state". This is enabled by default, however write access is |
|  |  | # # limited to the data directory. |
|  |  | # #allow-write: true |
|  |  |  |
|  |  | ############################################################################## |
|  |  | ## |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `735f5aa`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2F735f5aa9ca3b28cfacc7a443f93a44387fbacf17) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.stamus-networks.com_3722be91_20250114_192314.html ===

[![Stamus Networks Logo](https://www.stamus-networks.com/hubfs/stamus_logo_blue_cropped-2.png "Stamus Networks Logo")](//stamus-networks-6344338-hs-sites-com.sandbox.hs-sites.com/?hsLang=en)

* [Solutions](https://www.stamus-networks.com/network-detection-and-response)
  + [Optimize your network security with NDR](https://www.stamus-networks.com/network-detection-and-response)
  + [Replace your legacy Intrusion Detection System](https://www.stamus-networks.com/replace-your-legacy-intrusion-detection-system)
  + [Streamline your Suricata deployment](https://www.stamus-networks.com/streamline-suricata)
  + [Achieve Regulatory Compliance with NDR](https://www.stamus-networks.com/cybersecurity-compliance)
* [Product](https://www.stamus-networks.com/clear-ndr)
  + [Clear NDR™ - Enterprise (formerly Stamus Security Platform)](https://www.stamus-networks.com/clear-ndr)
  + [Clear NDR™ - Community (formerly SELKS)](https://www.stamus-networks.com/clear-ndr-community)
  + [Clear NDR™ Transition FAQ](https://www.stamus-networks.com/clear-ndr-frequently-asked-questions)
  + [Stamus for cloud](https://www.stamus-networks.com/stamus-for-cloud)
  + [Stamus on-premise](https://www.stamus-networks.com/stamus-on-premise)
  + [Stamus appliances](https://www.stamus-networks.com/stamus-appliances)
  + [Get Pricing](https://www.stamus-networks.com/pricing-quote-generator)
* [Stamus Labs](https://www.stamus-networks.com/stamus-labs)
  + [Clear NDR™ - Community (formerly SELKS)](https://www.stamus-networks.com/clear-ndr-community)
  + [Suricata for Analysts (Book)](https://www.stamus-networks.com/suricata-4-analysts)
  + [Lateral Movement Ruleset](https://www.stamus-networks.com/lateral-movement-ruleset-for-suricata)
  + [Jupyter Playbooks for Suricata](https://www.stamus-networks.com/jupyter-playbooks-for-suricata)
  + [GopherCAP™](https://www.stamus-networks.com/gophercap)
  + [Splunk App](https://www.stamus-networks.com/stamus-networks-app-for-splunk)
  + [Suricata Language Server™](https://www.stamus-networks.com/suricata-language-server)
  + [Open NRD Threat Intel Feeds](https://www.stamus-networks.com/stamus-labs/subscribe-to-threat-intel-feed)
  + [Kibana Dashboards for Suri](https://www.stamus-networks.com/kibana-dashboards)
* [Company](https://www.stamus-networks.com/about-us)
  + [About us](https://www.stamus-networks.com/about-us)
  + [Why Stamus](https://www.stamus-networks.com/why-stamus)
  + [News](https://www.stamus-networks.com/news)
  + [Analyst Coverage](https://www.stamus-networks.com/analyst-recognition)
  + [Events](https://www.stamus-networks.com/events)
  + [Contact](https://www.stamus-networks.com/contact-us)
  + [Partners](https://www.stamus-networks.com/partners)
  + [Support](https://www.stamus-networks.com/support)
  + [Careers](https://www.stamus-networks.com/careers)
  + [How to buy](https://www.stamus-networks.com/how-to-buy)
  + [NATO Live Fire Exercises](https://www.stamus-networks.com/nato-ccdcoe-participation)
* [Resources](https://www.stamus-networks.com/library)
  + [Blog](https://www.stamus-networks.com/blog)
  + [Library](https://www.stamus-networks.com/library)
  + [Blue Team Diaries™ Podcast](https://www.stamus-networks.com/blue-team-diaries-podcast)
  + [Webinar Archive](https://www.stamus-networks.com/recent-webinars)
  + [Stamus Spotlight Newsletter](https://www.stamus-networks.com/stamusspotlightarchive)
  + [Russia-Ukraine Conflict](https://www.stamus-networks.com/en-us/landing/russia-ukraine-statement)
* [Schedule a Demo](https://www.stamus-networks.com/demo)
* [Get Pricing](https://www.stamus-networks.com/pricing-quote-generator)

# Stamus Labs

Review the work of our open source software & threat research team

## Open Source and Community Projects

![StamusLabs SELKS Card](https://www.stamus-networks.com/hubfs/StamusLabs_SELKS_Card.jpg)
### Clear NDR™ - Community (formerly SELKS) by Stamus Networks

[Learn More](https://www.stamus-networks.com/clear-ndr-community?hsLang=en)

![StamusLabs_Suri4Analysts_Card](https://www.stamus-networks.com/hubfs/StamusLabs_Suri4Analysts_Card.jpg)
### Suricata for Analysts

[Learn More](https://www.stamus-networks.com/suricata-4-analysts?hsLang=en)

![StamusLabs_SuriRuleset_Card](https://www.stamus-networks.com/hubfs/StamusLabs_SuriRuleset_Card.jpg)
### Lateral Movement Ruleset

[Learn More](https://www.stamus-networks.com/lateral-movement-ruleset-for-suricata?hsLang=en)

![StamusLabs_Jupyter4Suri_Card](https://www.stamus-networks.com/hubfs/StamusLabs_Jupyter4Suri_Card.jpg)
### Jupyter Playbooks for Suricata

[Learn More](https://www.stamus-networks.com/jupyter-playbooks-for-suricata?hsLang=en)

![Stamus-GopherCAP-2023](https://www.stamus-networks.com/hubfs/Stamus-GopherCAP-2023.jpg)
### GopherCAP™

[Learn More](https://www.stamus-networks.com/gophercap?hsLang=en)

![StamusLabs SplunkApp Card](https://www.stamus-networks.com/hubfs/StamusLabs_SplunkApp_Card.jpg)
### Splunk App

[Learn More](https://www.stamus-networks.com/stamus-networks-app-for-splunk?hsLang=en)

![StamusLabs_SuriLangSvr_Card](https://www.stamus-networks.com/hubfs/StamusLabs_SuriLangSvr_Card.jpg)
### Suricata Language Server

[Learn More](https://www.stamus-networks.com/suricata-language-server?hsLang=en)

![Stamus-OpenNRD-2023](https://www.stamus-networks.com/hs-fs/hubfs/Stamus-OpenNRD-2023.jpg?width=2000&name=Stamus-OpenNRD-2023.jpg)
### Open NRD Threat Intel Feeds

[Learn More](https://www.stamus-networks.com/stamus-labs/subscribe-to-threat-intel-feed?hsLang=en)

![Stamus-KibanaDash-2023](https://www.stamus-networks.com/hs-fs/hubfs/Stamus-KibanaDash-2023.jpg?width=2000&name=Stamus-KibanaDash-2023.jpg)
### Kibana Dashboards for Suri

[Learn More](https://www.stamus-networks.com/kibana-dashboards?hsLang=en)

## Threat Intelligence from Stamus Labs

Every day, Clear NDR™ - Enterprise customers receive updated threat intelligence and detection algorithms from Stamus Labs. Each week, we send customers an update email summarizing the updates from the past week.

[![ThreatUpdate_Banner](https://www.stamus-networks.com/hs-fs/hubfs/ThreatUpdate_Banner.jpeg?width=1200&name=ThreatUpdate_Banner.jpeg)](https://www.stamus-networks.com/stamus-labs/detection-updates?hsLang=en)

Click on [this link](/stamus-labs/detection-updates?hsLang=en) to go to the archive of those updates.

Visit the [sign-up page](/en-us/landing/subscribe-weekly-threat-detection-updates?hsLang=en) to subscribe and receive these weekly updates directly in your inbox.

## A rich history of open source contribution

Stamus Networks has a long history of developing and supporting open source technologies. The company was founded by Éric Leblond and Peter Manev, two open source icons.

Éric and Peter are on [the board of directors and executive team for the OISF](https://oisf.net/team/) (the governing body for Suricata), respectively. And they are active developers on the [Suricata project](https://suricata.io/), the widely-deployed open source intrusion detection and network security monitoring engine. The OISF is a non-profit organization created to build community and to support open source security technologies like Suricata.

In addition to our extensive contributions to Suricata itself, our team at Stamus Labs have six active projects underway.

* Since 2014, we have developed and maintained [SELKS](/selks?hsLang=en) (now known as Clear NDR™ - Community), the popular turnkey Suricata-based open source intrusion detection system (IDS), Network Security Monitor (NSM) and threat hunting system.
* In 2020, we introduced the [Stamus App for Splunk](/stamus-networks-app-for-splunk?hsLang=en) which is a free and open source Splunk app for investigating and hunting in the IDS alert data and the protocol transaction logs generated by Suricata sensors. This Splunk app also provides complete access to data from Stamus Security Platform.
* Also in 2020, we introduced [GopherCAP](/gophercap?hsLang=en), an innovative PCAP manipulation application that provides accurate playback of extra large PCAP files directly from tar archives.
* In January 2022, we introduced the [Suricata Language Server](/suricata-language-server?hsLang=en), a tool that adds syntax checking, performance guidance, and auto-completion to popular text editors for Suricata signature developers.
* In November 2022, we published the "[Security Analyst's Guide to Suricata](/suricata-4-analysts?hsLang=en)" - the world's first practical guide for unlocking the full potential of Suricata. Written for security operations center (SOC) analysts and threat hunters who use Suricata to gain insights into what is taking place on their networks, the book provides vital information on entry points and in-depth analysis on the most important Suricata features.
* Also, in November 2022, we introduced the [free Suricata ruleset](/lateral-movement-ruleset-for-suricata?hsLang=en) specifically focused on detecting lateral movement in Microsoft Windows environments
* In 2023, we introduced the [Jupyter Playbooks for Suricata](/jupyter-playbooks-for-suricata?hsLang=en)
* Also in 2023, Stamus Networks introduced a set of free [newly-registered domain threat intelligence feeds (Open NRD)](/stamus-labs/subscribe-to-threat-intel-feed?hsLang=en), optimized for Suricata.

##

## NOTE: All open-source contributions from Stamus Networks are free: you may redistribute them and/or modify them under the terms of the GNU General Public License as published by the Free Software Foundation, version 3.0-or-later of the License. Review the terms of the license here:

 [https://www.stamus-networks.com/en-us/landing/gplv3-license](/en-us/landing/gplv3-license?hsLang=en)

[![stamus_logo_white](https://www.stamus-networks.com/hubfs/Logos/stamus_logo_white.png "stamus_logo_white")](https://www.stamus-networks.com/?hsLang=en)

 ABOUT STAMUS NETWORKS ™

Stamus Networks believes that cyber defense is bigger than any single person, platform, company, or technology. That’s why we leverage the power of community to deliver the next generation of open and transparent network defense. Trusted by security teams at the world’s most targeted organizations, our flagship offering – Clear NDR™ – empowers cyber defenders to uncover and stop serious threats and unauthorized network activity before they harm their organizations. Clear NDR helps defenders see more clearly and act more confidently through detection they can trust with results they can explain.

Indianapolis, USA
Paris, France

contact@stamus-networks.com

[Privacy](https://www.stamus-networks.com/privacy-policy?hsLang=en)

© 2014-2025 Stamus Networks, Inc. All rights Reserved.



=== Content from github.com_0f2ae832_20250114_192310.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Faee1523b4591430ebed1ded0bb95508e6717a335)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Faee1523b4591430ebed1ded0bb95508e6717a335)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OISF%2Fsuricata)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OISF](/OISF)
/
**[suricata](/OISF/suricata)**
Public

* [Notifications](/login?return_to=%2FOISF%2Fsuricata) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2FOISF%2Fsuricata)
* [Star
   4.8k](/login?return_to=%2FOISF%2Fsuricata)

* [Code](/OISF/suricata)
* [Pull requests
  72](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

Additional navigation options

* [Code](/OISF/suricata)
* [Pull requests](/OISF/suricata/pulls)
* [Actions](/OISF/suricata/actions)
* [Security](/OISF/suricata/security)
* [Insights](/OISF/suricata/pulse)

## Commit

[Permalink](/OISF/suricata/commit/aee1523b4591430ebed1ded0bb95508e6717a335)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

datasets: don't allow absolute or paths with directory traversal

[Browse files](/OISF/suricata/tree/aee1523b4591430ebed1ded0bb95508e6717a335)
Browse the repository at this point in the history

```
For dataset filenames coming from rules, do not allow filenames that
are absolute or contain a directory traversal with "..". This prevents
datasets from escaping the define data-directory which may allow a bad
rule to overwrite any file that Suricata has permission to write to.

Add a new configuration option,
"datasets.rules.allow-absolute-filenames" to allow absolute filenames
in dataset rules. This will be a way to revert back to the pre 6.0.13
behavior where save/state rules could use any filename.

Ticket: [#6118](https://github.com/OISF/suricata/pull/6118)
```

* Loading branch information

[![@jasonish](https://avatars.githubusercontent.com/u/644115?s=40&v=4)](/jasonish) [![@victorjulien](https://avatars.githubusercontent.com/u/32410611?s=40&v=4)](/victorjulien)

[jasonish](/OISF/suricata/commits?author=jasonish "View all commits by jasonish")
authored and
[victorjulien](/OISF/suricata/commits?author=victorjulien "View all commits by victorjulien")
committed
Jun 14, 2023

1 parent
[ea3a470](/OISF/suricata/commit/ea3a470eb90f776510c6a4bd36c0c01fd3681389)

commit aee1523

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**38 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/detect-dataset.c
    [detect-dataset.c](#diff-f794456436bc6c8a750a12e1dc9d1361126081ce06dc9096701852f363b7cf00)
  + src/util-path.c
    [util-path.c](#diff-d009cd3bb70c380845158b7f3318f1b42bd7428c940b06228eb174214c4187ff)
  + src/util-path.h
    [util-path.h](#diff-a03800572fa4a06beb5fc5e5481daf6780a764ec48a00242895f5bbf75f4b2ac)
* suricata.yaml.in
  [suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db)

## There are no files selected for viewing

16 changes: 14 additions & 2 deletions

16
[src/detect-dataset.c](#diff-f794456436bc6c8a750a12e1dc9d1361126081ce06dc9096701852f363b7cf00 "src/detect-dataset.c")

Show comments

[View file](/OISF/suricata/blob/aee1523b4591430ebed1ded0bb95508e6717a335/src/detect-dataset.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -302,8 +302,20 @@ static int SetupSavePath(const DetectEngineCtx \*de\_ctx, |
|  |  | { |
|  |  | SCLogDebug("save %s", save); |
|  |  |  |
|  |  | if (PathIsAbsolute(save)) { |
|  |  | return 0; |
|  |  | int allow\_absolute = 0; |
|  |  | (void)ConfGetBool("datasets.rules.allow-absolute-filenames", &allow\_absolute); |
|  |  | if (allow\_absolute) { |
|  |  | SCLogNotice("Allowing absolute filename for dataset rule: %s", save); |
|  |  | } else { |
|  |  | if (PathIsAbsolute(save)) { |
|  |  | SCLogError(SC\_ERR\_INVALID\_ARGUMENT, "Absolute paths not allowed: %s", save); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
|  |  | if (SCPathContainsTraversal(save)) { |
|  |  | SCLogError(SC\_ERR\_INVALID\_ARGUMENT, "Directory traversals not allowed: %s", save); |
|  |  | return -1; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // data dir |
| Expand Down | |  |

17 changes: 17 additions & 0 deletions

17
[src/util-path.c](#diff-d009cd3bb70c380845158b7f3318f1b42bd7428c940b06228eb174214c4187ff "src/util-path.c")

Show comments

[View file](/OISF/suricata/blob/aee1523b4591430ebed1ded0bb95508e6717a335/src/util-path.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -247,3 +247,20 @@ const char \*SCBasename(const char \*path) |
|  |  |  |
|  |  | return final + 1; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* \brief Check for directory traversal |
|  |  | \* |
|  |  | \* \param path The path string to check for traversal |
|  |  | \* |
|  |  | \* \retval true if directory traversal is found, otherwise false |
|  |  | \*/ |
|  |  | bool SCPathContainsTraversal(const char \*path) |
|  |  | { |
|  |  | #ifdef OS\_WIN32 |
|  |  | const char \*pattern = "..\\"; |
|  |  | #else |
|  |  | const char \*pattern = "../"; |
|  |  | #endif |
|  |  | return strstr(path, pattern) != NULL; |
|  |  | } |

1 change: 1 addition & 0 deletions

1
[src/util-path.h](#diff-a03800572fa4a06beb5fc5e5481daf6780a764ec48a00242895f5bbf75f4b2ac "src/util-path.h")

Show comments

[View file](/OISF/suricata/blob/aee1523b4591430ebed1ded0bb95508e6717a335/src/util-path.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,5 +41,6 @@ bool SCIsRegularDirectory(const struct dirent \*const dir\_entry); |
|  |  | bool SCIsRegularFile(const struct dirent \*const dir\_entry); |
|  |  | char \*SCRealPath(const char \*path, char \*resolved\_path); |
|  |  | const char \*SCBasename(const char \*path); |
|  |  | bool SCPathContainsTraversal(const char \*path); |
|  |  |  |
|  |  | #endif /\* \_\_UTIL\_PATH\_H\_\_ \*/ |

6 changes: 6 additions & 0 deletions

6
[suricata.yaml.in](#diff-6edad567c7414ca3b78009e7d315547542cbb77455e7a223c11719d2734fd3db "suricata.yaml.in")

Show comments

[View file](/OISF/suricata/blob/aee1523b4591430ebed1ded0bb95508e6717a335/suricata.yaml.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -998,6 +998,12 @@ asn1-max-frames: 256 |
|  |  | # defaults: |
|  |  | # memcap: 100mb |
|  |  | # hashsize: 2048 |
|  |  | # |
|  |  | # rules: |
|  |  | # # Set to true to allow absolute filenames and filenames that use |
|  |  | # # ".." components to reference parent directories in rules that specify |
|  |  | # # their filenames. |
|  |  | # #allow-absolute-filenames: false |
|  |  |  |
|  |  | ############################################################################## |
|  |  | ## |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `aee1523`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOISF%2Fsuricata%2Fcommit%2Faee1523b4591430ebed1ded0bb95508e6717a335) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


