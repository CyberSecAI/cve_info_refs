The provided content relates to CVE-2023-35958.

**Root cause of vulnerability:**
The vulnerability lies in the `fstReaderIterBlocks2` function when handling VCDATA blocks. Specifically, when decompressing or copying data into the `mem_for_traversal` buffer, there is a lack of proper bounds checking on `destlen` before writing to the buffer.

**Weaknesses/vulnerabilities present:**
- Heap-based buffer overflow in `fstReaderIterBlocks2` function due to missing bounds check when using `fstFread`.

**Impact of exploitation:**
- Arbitrary code execution can occur due to the heap-based buffer overflow.

**Attack vectors:**
- A specially crafted `.fst` file can trigger the vulnerability.
- The victim needs to open the malicious `.fst` file.

**Required attacker capabilities/position:**
- An attacker needs to create a malicious `.fst` file.
- The attacker needs to convince the victim to open the malicious file using GTKWave.

**More Details:**
- The vulnerability occurs when the code copies uncompressed VCDATA into a buffer without checking if the destination buffer is large enough to hold the data. This allows writing out of bounds. The size of the destination buffer is determined by a field in the .fst file that has no relationship with the actual data size.
- The vulnerability is triggered in the `fstReaderIterBlocks2` function, which is used to parse VCDATA blocks within a .fst file.
- An attacker can control the size of the destination buffer (`mem_for_traversal`) and manipulate the length and offset of the VCDATA elements via `chain_table`.
- The vulnerability occurs in the uncompressed code path, when reading the decompressed data using `fstFread`.