The provided content relates to CVE-2023-35789.

**Root cause of vulnerability:**
The command-line tools `amqp-publish` and `amqp-consume` in `rabbitmq-c` library were insecure because they allowed users to pass the username and password as command-line parameters using `--password` or as part of the URL using `--url`.

**Weaknesses/vulnerabilities present:**
- **Exposure of sensitive information:** Passing the password as a command-line parameter exposed it to anyone on the host who could view the process list (e.g., using `ps` or `pgrep`).

**Impact of exploitation:**
- **Credential theft:** Attackers with access to the system's process list could easily steal the username and password used for connecting to the RabbitMQ server.
- **Unauthorized access:** With the stolen credentials, attackers could gain unauthorized access to the RabbitMQ server and potentially disrupt services, read or manipulate messages, and more.

**Attack vectors:**
- **Local access:** Attackers must have local access to the system where `amqp-publish` or `amqp-consume` is running.
- **Process list access:** Attackers need access to view the process list of the system.

**Required attacker capabilities/position:**
- The attacker needs to have local access to the machine running the vulnerable applications and the ability to view the system's process list.

**Mitigation:**
The vulnerability was mitigated by adding an `--authfile` option to read credentials from a file. The file should contain the username and password in the format `username:user` and `password:password`.