Based on the provided information, here's an analysis of CVE-2023-35938:

**Root Cause of Vulnerability:**

The vulnerability stems from a failure to properly revoke administrative privileges from restricted users when a Tuleap project's visibility is changed from a setting that allows restricted users to "Private without restricted."  Specifically, when a project is switched to "Private without restricted," users who were restricted project administrators previously were not having their administrative rights removed. This allows them to retain access and perform administrative actions on the project even though they should no longer have those privileges under the new visibility setting.

**Weaknesses/Vulnerabilities Present:**

*   **Broken Access Control:** The primary weakness is a broken access control mechanism. Project visibility changes were not consistently applying the correct permissions, resulting in unauthorized access for restricted users.
*   **Privilege Escalation:** Although not a direct privilege escalation, the vulnerability allowed restricted users to retain administrative rights that should have been revoked, effectively giving them more access than intended within the new project visibility context.
*   **Insufficient Authorization Checks:** The system lacked proper authorization checks during the project visibility switch. It did not ensure that project administrators who were also restricted users had their administrative rights removed appropriately.

**Impact of Exploitation:**

*   **Unauthorized Access:** Restricted users who were project administrators before the visibility switch retain the ability to access the project and view project details, which should be inaccessible to them.
*   **Unauthorized Actions:** These users are also able to perform administrative actions within the project, such as modify project settings.
*   **Confidentiality, Integrity, and Availability Impact:** The CVSS score of 4.1 reflects low impact to confidentiality, integrity and availability. It's not a full bypass of the system, but rather a retention of higher privileges than is intended.

**Attack Vectors:**

*   **Configuration Change:** The attack vector is triggered when an administrator changes the visibility of a Tuleap project from a state that allows restricted users to "Private without restricted".

**Required Attacker Capabilities/Position:**

*   **Prior Project Administrator:** The attacker needs to have been a restricted user who was a project administrator before the visibility change.
*   **No user interaction:** The vulnerability does not require user interaction for the exploitation to occur.

**Additional Details:**

*   The fix involves implementing logic to remove project administration rights from restricted users during the project visibility switch and preventing the switch if it would remove the last administrator.
*   The vulnerability does not affect "Public visibility without restricted", which could be addressed in a future commit.

The provided commit ([a108186e7538676c4bf6e615f793f3b787a09b91](https://github.com/Enalean/tuleap/commit/a108186e7538676c4bf6e615f793f3b787a09b91)) includes changes to address this issue, such as adding a new `UpdateVisibilityChecker` class to verify if restricted administrators are impacted by project visibility changes, a `ProjectOwnerRemover` class to remove those users from being project owners during the visibility change, and unit tests for these classes.