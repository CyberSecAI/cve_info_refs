```
{
  "vulnerability_details": [
    {
      "cve": "CVE-2023-30545",
      "root_cause": "The vulnerability lies in the SQL Manager functionality within PrestaShop, specifically in how it handles SQL queries. It does not properly restrict the use of the `LOAD_FILE` SQL function.",
      "weaknesses": [
        "Improper restriction of SQL functions: The SQL manager allows the use of the `LOAD_FILE` function in SQL queries, which is a potentially dangerous function that can be used to read files from the server."
      ],
      "impact": "An attacker with access to the SQL Manager can use the `LOAD_FILE` function within a SELECT query to read arbitrary files from the server's file system. This could expose sensitive information like configuration files, source code, or database credentials.",
      "attack_vectors": "The attack vector is through the SQL Manager interface, which is accessible through the PrestaShop back office.",
      "attacker_capabilities": "The attacker needs to have access to the SQL Manager within the PrestaShop back office, which typically requires low privileges."
    }
  ],
    "fixes": [
        {
            "commit_id": "d900806e1841a31f26ff0a1843a6888fc1bb7f81",
            "changes": [
                "Modified `classes/RequestSql.php` to include `LOAD_FILE` in the list of unauthorized SQL keywords",
                "Modified `src/Adapter/SqlManager/SqlQueryValidator.php` to provide a specific error message when an unauthorized function like `LOAD_FILE` is used."
            ]
        },
         {
            "commit_id": "cddac4198a47c602878a787280d813f60c6c0630",
            "changes": [
                "Modified `classes/RequestSql.php` to include `LOAD_FILE` in the list of unauthorized SQL keywords",
                "Modified `src/Adapter/SqlManager/SqlQueryValidator.php` to provide a specific error message when an unauthorized function like `LOAD_FILE` is used.",
                 "Added integration tests in `tests/Integration/Adapter/SqlManager/QueryHandler/GetSqlRequestExecutionResultHandlerTest.php` to verify that using the function `LOAD_FILE` will throw an exception."
            ]
        }
    ]
}
```