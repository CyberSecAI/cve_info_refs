=== Content from patchstack.com_0b80532f_20250114_191549.html ===


[Pricing](https://patchstack.com/pricing/)
Solutions

[WordPress security

Instantly fix and mitigate vulnerabilities](https://patchstack.com/wordpress-security/)
[Plugin auditing

Paid auditing for WordPress vendors](https://patchstack.com/auditing/)
[Managed VDP

Start a security program for your plugin](https://patchstack.com/for-plugins/)
[Bug Bounty

Join the community and earn bounties](https://patchstack.com/bug-bounty/)
[Enterprise API

At scale monitoring and vPatching for hosts](https://patchstack.com/for-hosts/)
[Vulnerability database

The latest WordPress security intelligence](https://patchstack.com/database/)

[Login](https://app.patchstack.com/login)

[Start trial](https://app.patchstack.com/register?type=pro)

# WordPress Advanced Custom Fields Plugin 5.8.10-5.12.5 is vulnerable to Cross Site Scripting (XSS)

![Patch priority: medium](https://patchstack.com/database/img/priority-medium.svg)

Medium priority

vPatch available

![Vulnerable version](https://patchstack.com/database/img/vulnerable_version.svg)

5.8.10-5.12.5

Vulnerable version

![Fixed](https://patchstack.com/database/img/fix-available.svg)

5.12.6

Fixed version

[![](https://patchstack.com/database/img/platforms/WordPress.svg)](https://patchstack.com/database/wordpress/plugin/advanced-custom-fields)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

05 May 2023
by Patchstack

# Risks

CVSS 7.1

This vulnerability is moderately dangerous and expected to become exploited.

##### 7.1

### Cross Site Scripting (XSS)

This could allow a malicious actor to inject malicious scripts, such as redirects, advertisements, and other HTML payloads into your website which will be executed when guests visit your site.

This is a general description of this vulnerability type, specific impact varies case by case.
CVSS score is a way to evaluate and rank reported vulnerabilities in a standardized and repeatable way, but it is not ideal for CMSs.

![Alert](https://patchstack.com/database/img/exploited.svg)
### Known to be exploited!

# Solutions

We advise to mitigate or resolve the vulnerability immediately.

![Protect your website(s)](https://patchstack.com/database/img/shield-star.svg)
### Automatically mitigate vulnerabilities and keep your websites safe

Patchstack has issued a virtual patch to mitigate this issue by blocking any attacks until
you have updated to a fixed version.

#### Get the fastest vulnerability mitigation with Patchstack!

[Get Started](https://patchstack.com/pricing/)

![Update to version X or later](https://patchstack.com/database/img/update-checkmark.svg)
### Update to version 5.12.6 or later.

Update to version 5.12.6 or later to remove the vulnerability.
Patchstack users can turn on auto-update for vulnerable plugins only.

# Details

Software

Advanced Custom Fields

Type

Plugin

Vulnerable versions

5.8.10-5.12.5

Fixed in

5.12.6

OWASP Top 10

A7: Cross-Site Scripting (XSS)

Classification

Cross Site Scripting (XSS)

CVE

[CVE-2023-30777](https://www.cve.org/CVERecord?id=CVE-2023-30777)

Patch priority

Medium

CVSS severity

Medium
(7.1)

Developer

[Claim ownership](https://patchstack.com/for-plugins)

PSID

2970573ffd97

Credits

[![Rafie Muhammad (Patchstack)](https://patchstack.com/database/img/logomark-small.svg)](https://patchstack.com/database/researcher/38daedf8-3237-4768-ae6e-be8e32979a65)

Required privilege

Unauthenticated

Published

5 May, 2023

[Technical Details](https://patchstack.com/articles/reflected-xss-in-advanced-custom-fields-plugins-affecting-2-million-sites/)

![Remove and replace software](https://patchstack.com/database/img/expand.svg)
Expand full details

Have additional information or questions about this entry?
Let us know.

#### Found this useful? Support Rafie Muhammad (Patchstack) for reporting this vulnerability.

[Send thanks](https://www.buymeacoffee.com/yeraisci)

#### Found this report useful?

[Send thanks](https://www.buymeacoffee.com/yeraisci)

# Timeline

![Search icon](https://patchstack.com/database/img/search-green.svg)

Reported by

[![Rafie Muhammad (Patchstack)](https://patchstack-database.s3.us-east-2.amazonaws.com/researcher/34/emberspirit.jpg?X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATLPOZUEKEA5CDFOJ%2F20250114%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20250114T191548Z&X-Amz-SignedHeaders=host&X-Amz-Expires=604800&X-Amz-Signature=032a43e839152add907a38f95c4aa7a93522fec7eb043ab874972ca43235d300)
Rafie Muhammad (Patchstack)](https://patchstack.com/database/researcher/38daedf8-3237-4768-ae6e-be8e32979a65)

02 May 2023

![Early warning sent out](https://patchstack.com/database/img/warning.svg)

Early warning sent out to Patchstack customers

05 May 2023

![Published by Patchstack](https://patchstack.com/database/img/info.svg)

Published by Patchstack

07 May 2023

Go to

[![WordPress](https://patchstack.com/database/img/platforms/WordPress.svg)
Plugin page](https://patchstack.com/database/wordpress/plugin/advanced-custom-fields)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

How can Patchstack provide the fastest protection?

Patchstack is one of the largest open-source vulnerability disclosers in the world. For example, in 2023 more than 70% of new WordPress vulnerabilities were originally published by Patchstack. This focus on research enables us to deploy vulnerability protection rules faster than anybody else.

What is virtual patching?

Patchstack vPatching auto-mitigates security vulnerabilities even when there's no official patch available. It's the fastest and most effective way to eliminate new security vulnerabilities without sacrificing performance.

Why would a hacker target my website?

Hackers automate attacks against new security vulnerabilities to take over as many websites as they can before users have time to patch and update. The attacks are opportunistic and victims are not chosen - everyone is a target.

What if my website has already been compromised?

We recommend reaching out to your hosting provider for server-side malware scanning or use a professional incident response service. Don't rely on plugin based malware scanners as they are commonly tampered with by malware.

# Weekly WordPress security intelligence delivered to your inbox.

![vPatch available](https://patchstack.com/database/img/envelope.svg)

Subscribe

### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

© 2025 Patchstack
[DPA](https://patchstack.com/data-processing-agreement-dpa/)
[Privacy Policy](https://patchstack.com/privacy-policy/)
[Terms & Conditions](https://patchstack.com/terms-and-conditions/)
![EU Logo](https://patchstack.com/database/img/eic-logo.png)

![](https://patchstack.com/database/img/logo.svg)
### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)

## Let us know if we have missed a vulnerability reported elsewhere

Report
![arrow right](https://patchstack.com/database/img/chevron-right.svg)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)
[Close](https://patchstack.com/database/)
## reCAPTCHA's verification failed!

## Thank you for contributing!

[Close](https://patchstack.com/database/)
![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)



=== Content from patchstack.com_3f3e0107_20250114_191548.html ===


[Pricing](https://patchstack.com/pricing/)
Solutions

[WordPress security

Instantly fix and mitigate vulnerabilities](https://patchstack.com/wordpress-security/)
[Plugin auditing

Paid auditing for WordPress vendors](https://patchstack.com/auditing/)
[Managed VDP

Start a security program for your plugin](https://patchstack.com/for-plugins/)
[Bug Bounty

Join the community and earn bounties](https://patchstack.com/bug-bounty/)
[Enterprise API

At scale monitoring and vPatching for hosts](https://patchstack.com/for-hosts/)
[Vulnerability database

The latest WordPress security intelligence](https://patchstack.com/database/)

[Login](https://app.patchstack.com/login)

[Start trial](https://app.patchstack.com/register?type=pro)

# WordPress Advanced Custom Fields PRO Plugin <= 6.1.5 is vulnerable to Cross Site Scripting (XSS)

![Patch priority: medium](https://patchstack.com/database/img/priority-medium.svg)

Medium priority

vPatch available

![Vulnerable version](https://patchstack.com/database/img/vulnerable_version.svg)

<= 6.1.5

Vulnerable version

![Fixed](https://patchstack.com/database/img/fix-available.svg)

6.1.6

Fixed version

[![](https://patchstack.com/database/img/platforms/WordPress.svg)](https://patchstack.com/database/wordpress/plugin/advanced-custom-fields-pro)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

05 May 2023
by Patchstack

# Risks

CVSS 7.1

This vulnerability is moderately dangerous and expected to become exploited.

##### 7.1

### Cross Site Scripting (XSS)

This could allow a malicious actor to inject malicious scripts, such as redirects, advertisements, and other HTML payloads into your website which will be executed when guests visit your site.

This is a general description of this vulnerability type, specific impact varies case by case.
CVSS score is a way to evaluate and rank reported vulnerabilities in a standardized and repeatable way, but it is not ideal for CMSs.

![Alert](https://patchstack.com/database/img/exploited.svg)
### Known to be exploited!

# Solutions

We advise to mitigate or resolve the vulnerability immediately.

![Protect your website(s)](https://patchstack.com/database/img/shield-star.svg)
### Automatically mitigate vulnerabilities and keep your websites safe

Patchstack has issued a virtual patch to mitigate this issue by blocking any attacks until
you have updated to a fixed version.

#### Get the fastest vulnerability mitigation with Patchstack!

[Get Started](https://patchstack.com/pricing/)

![Update to version X or later](https://patchstack.com/database/img/update-checkmark.svg)
### Update to version 6.1.6 or later.

Update to version 6.1.6 or later to remove the vulnerability.
Patchstack users can turn on auto-update for vulnerable plugins only.

# Details

Software

Advanced Custom Fields PRO

Type

Plugin

Vulnerable versions

<= 6.1.5

Fixed in

6.1.6

OWASP Top 10

A7: Cross-Site Scripting (XSS)

Classification

Cross Site Scripting (XSS)

CVE

[CVE-2023-30777](https://www.cve.org/CVERecord?id=CVE-2023-30777)

Patch priority

Medium

CVSS severity

Medium
(7.1)

Developer

[Claim ownership](https://patchstack.com/for-plugins)

PSID

007d3de805e3

Credits

[![Rafie Muhammad (Patchstack)](https://patchstack.com/database/img/logomark-small.svg)](https://patchstack.com/database/researcher/38daedf8-3237-4768-ae6e-be8e32979a65)

Required privilege

Unauthenticated

Published

5 May, 2023

[Technical Details](https://patchstack.com/articles/reflected-xss-in-advanced-custom-fields-plugins-affecting-2-million-sites/)

![Remove and replace software](https://patchstack.com/database/img/expand.svg)
Expand full details

Have additional information or questions about this entry?
Let us know.

#### Found this useful? Support Rafie Muhammad (Patchstack) for reporting this vulnerability.

[Send thanks](https://www.buymeacoffee.com/yeraisci)

#### Found this report useful?

[Send thanks](https://www.buymeacoffee.com/yeraisci)

# Timeline

![Search icon](https://patchstack.com/database/img/search-green.svg)

Reported by

[![Rafie Muhammad (Patchstack)](https://patchstack-database.s3.us-east-2.amazonaws.com/researcher/34/emberspirit.jpg?X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATLPOZUEKEA5CDFOJ%2F20250114%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20250114T191547Z&X-Amz-SignedHeaders=host&X-Amz-Expires=604800&X-Amz-Signature=8561b45afcdbdf9dda12d4ff057c335fc10baa88d1c6d54c909f422c240ff6a1)
Rafie Muhammad (Patchstack)](https://patchstack.com/database/researcher/38daedf8-3237-4768-ae6e-be8e32979a65)

02 May 2023

![Early warning sent out](https://patchstack.com/database/img/warning.svg)

Early warning sent out to Patchstack customers

05 May 2023

![Published by Patchstack](https://patchstack.com/database/img/info.svg)

Published by Patchstack

07 May 2023

Go to

[![WordPress](https://patchstack.com/database/img/platforms/WordPress.svg)
Plugin page](https://patchstack.com/database/wordpress/plugin/advanced-custom-fields-pro)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

How can Patchstack provide the fastest protection?

Patchstack is one of the largest open-source vulnerability disclosers in the world. For example, in 2023 more than 70% of new WordPress vulnerabilities were originally published by Patchstack. This focus on research enables us to deploy vulnerability protection rules faster than anybody else.

What is virtual patching?

Patchstack vPatching auto-mitigates security vulnerabilities even when there's no official patch available. It's the fastest and most effective way to eliminate new security vulnerabilities without sacrificing performance.

Why would a hacker target my website?

Hackers automate attacks against new security vulnerabilities to take over as many websites as they can before users have time to patch and update. The attacks are opportunistic and victims are not chosen - everyone is a target.

What if my website has already been compromised?

We recommend reaching out to your hosting provider for server-side malware scanning or use a professional incident response service. Don't rely on plugin based malware scanners as they are commonly tampered with by malware.

# Weekly WordPress security intelligence delivered to your inbox.

![vPatch available](https://patchstack.com/database/img/envelope.svg)

Subscribe

### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

© 2025 Patchstack
[DPA](https://patchstack.com/data-processing-agreement-dpa/)
[Privacy Policy](https://patchstack.com/privacy-policy/)
[Terms & Conditions](https://patchstack.com/terms-and-conditions/)
![EU Logo](https://patchstack.com/database/img/eic-logo.png)

![](https://patchstack.com/database/img/logo.svg)
### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)

## Let us know if we have missed a vulnerability reported elsewhere

Report
![arrow right](https://patchstack.com/database/img/chevron-right.svg)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)
[Close](https://patchstack.com/database/)
## reCAPTCHA's verification failed!

## Thank you for contributing!

[Close](https://patchstack.com/database/)
![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)



=== Content from patchstack.com_b23a54a3_20250114_191547.html ===


[Skip to main content](#main)
[![](https://patchstack.com/wp-content/uploads/2021/11/logo.svg)](/)

JavaScript is disabled in your browser. Please enable JavaScript for a better experience.

* [Pricing](/pricing/)
* Solutions
  + [WordPress security](https://patchstack.com/wordpress-security/)
  + [Enterprise API](https://patchstack.com/for-hosts/)
  + [Managed VDP](https://patchstack.com/for-plugins/)
  + [Bug Bounty](https://patchstack.com/bug-bounty/)
  + [Plugin auditing](https://patchstack.com/auditing/)
  + [Vulnerability database](https://patchstack.com/database/)
* [Login](https://app.patchstack.com/login)

* ![]()

  + ![]()

    - ![]()

[Start trial](https://app.patchstack.com/register)

# Reflected XSS in Advanced Custom Fields Plugins Affecting 2+ Million Sites

[Security advisories](https://patchstack.com/category/security-advisories/)
[Security Advisory](https://patchstack.com/tag/security-advisory/)
Published 5 May 2023Updated 13 December 2024![](https://secure.gravatar.com/avatar/1afc8ea1128a413b5780e102a8032b6f?s=200&d=mm&r=g)[Rafie Muhammad](https://patchstack.com/author/rafie/)Security Researcher at PatchstackTable of Contents

[#### WordPress Advanced Custom Fields Plugin 5.8.10-5.12.5

Cross Site Scripting (XSS)](https://patchstack.com/database/vulnerability/advanced-custom-fields/wordpress-advanced-custom-fields-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability)
[#### WordPress Advanced Custom Fields PRO Plugin <= 6.1.5

Cross Site Scripting (XSS)](https://patchstack.com/database/vulnerability/advanced-custom-fields-pro/wordpress-advanced-custom-fields-pro-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability)

This blog post is about the Advanced Custom Fields free and pro plugin vulnerability. If you’re an Advanced Custom Fields free and pro user, please update the plugin to at least version **6.1.6**. The security fix also backported on version **5.12.6**.

**Patchstack [Developer and Enterprise Plan](https://patchstack.com/pricing/) users are protected from the vulnerability.**

You can also sign up for the [Patchstack Community plan](http://patchstack.com/pricing/) to be notified about vulnerabilities as soon as they become disclosed.

For plugin developers, we have [security audit services](https://patchstack.com/auditing/) and [Threat Intelligence Feed API](https://patchstack.com/threat-intel-feed/) for hosting companies.

## Update regarding exploitation attempts

As we are writing this update on 16 May 2023, we notice claims circulating in the media that the sample PoC URL on this article is being used to mass-exploit websites. We found that to be unlikely since the XSS could only be triggered by logged-in users (mainly administrators) that have access to the Advanced Custom Fields feature. We assume that the attacker tries to directly hit the sample PoC URL and it doesn’t indicates that the attempt is a concrete exploitation. This case mostly applies across vulnerabilities that require user interaction such as CSRF and Reflected XSS. Until this update is published, our monitoring system didn’t catch any concrete exploitation attempts on our customers.

## About the Advanced Custom Fields WordPress plugin

The plugin [Advanced Custom Fields](https://wordpress.org/plugins/advanced-custom-fields/) and [Advanced Custom Fields Pro](https://www.advancedcustomfields.com/pro/) (versions **6.1.5** and below, free and pro version), has over 2 million active installations. It is known as the most popular custom fields plugins in WordPress.

![Advanced Custom Fields WordPress vulnerability](https://patchstack.com/wp-content/uploads/2023/05/image-1.png)

This plugin is a WordPress plugin that allows us to add extra content fields to our WordPress edit screens. These extra content fields are more commonly referred to as Custom Fields and can allow us to build websites faster with more available fields.

## The security vulnerability in Advanced Custom Fields

This plugin suffers from reflected XSS vulnerability.

**This vulnerability allows any unauthenticated user from stealing sensitive information to, in this case, privilege escalation on the WordPress site by tricking privileged users to visit the crafted URL path.**

The described vulnerability was fixed in version **6.1.6**, also fixed in version **5.12.6,** and assigned **CVE-2023-30777**.

[Find out more from the Patchstack database](https://patchstack.com/database/vulnerability/advanced-custom-fields/wordpress-advanced-custom-fields-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability) and [here](https://patchstack.com/database/vulnerability/advanced-custom-fields-pro/wordpress-advanced-custom-fields-pro-plugin-6-1-5-reflected-cross-site-scripting-xss-vulnerability).

The underlying vulnerability is located on `admin_body_class` function handler:

```
public function admin_body_class( $classes ) {
    $classes .= " acf-admin-page acf-internal-post-type {$this->admin_body_class}";

    if ( $this->view ) {
        $classes .= " view-{$this->view}";
    }

    return $classes;
}
```

The `admin_body_class` configured to be an extra handler of WordPress own hook that is also named `[admin_body_class](https://developer.wordpress.org/reference/hooks/admin_body_class/)`. This hook controls and filters the CSS classes for the main body tag in the admin area.

```
// Add hooks.
add_action( 'admin_enqueue_scripts', array( $this, 'admin_enqueue_scripts' ) );
add_action( 'admin_body_class', array( $this, 'admin_body_class' ) );
```

If we look deeper at the implementation of the `[admin_body_class](https://developer.wordpress.org/reference/hooks/admin_body_class/)` on WordPress core, we could see that the outputted value of the hook is not properly sanitized and directly constructed on the HTML page :

```
$admin_body_classes = apply_filters( 'admin_body_class', '' );
$admin_body_classes = ltrim( $admin_body_classes . ' ' . $admin_body_class );
?>
<body class="wp-admin wp-core-ui no-js <?php echo $admin_body_classes; ?>">
<script type="text/javascript">
	document.body.className = document.body.className.replace('no-js','js');
</script>
```

Because of that condition, there is a potential XSS vulnerability if the `admin_body_class` hook function handler doesn’t properly sanitized the returned classes string.

Let’s get back to the hook function handler, the code will directly concatenated `$this->view` variable to the `$classes` variable that will be returned as classes string. We actually could fully control the `$this->view` variable from `current_screen` function :

```
public function current_screen() {
    // Bail early if not the list admin page.
    if ( ! acf_is_screen( "edit-{$this->post_type}" ) ) {
        return;
    }

    // Get the current view.
    $this->view = isset( $_GET['post_status'] ) ? sanitize_text_field( $_GET['post_status'] ) : ''; //
-------------------------------------
```

Sanitization using `[sanitize_text_field](https://developer.wordpress.org/reference/functions/sanitize_text_field/)` function is not enough to prevent XSS, since we could still use a DOM XSS payload. Combining all of that, the XSS could be achieved using this example payload :

```
http://<WORDPRESS_SITE>/wp-admin/edit.php?post_type=acf-field-group&post_status=xxxxxxx" onload=alert(document.domain) xxx="
```

The reflected HTML structure that is being shown on the front-end could be something like this :

```
<body class="wp-admin wp-core-ui no-js acf-admin-5-3 acf-browser-chrome acf-admin-page acf-internal-post-type acf-admin-field-groups view-xxxxxxx\" onload=alert(document.domain) xxx=\" edit-php auto-fold admin-bar post-type-acf-field-group branch-6-2 version-6-2 admin-color-fresh locale-en-us no-customize-support no-svg">

```

Note that this vulnerability could be triggered on a default installation or configuration of the Advanced Custom Fields plugin. The XSS also could only be triggered by logged-in users that have access to the Advanced Custom Fields plugin.

## The patch in Advanced Custom Fields

Since this issue is mainly because the code directly constructed a variable to the HTML without proper sanitization, implementing `[esc_attr](https://developer.wordpress.org/reference/functions/esc_attr/)` function should be enough to patch the issue. The [patch](https://plugins.trac.wordpress.org/changeset/2908095/advanced-custom-fields/tags/6.1.6/includes/admin/admin-internal-post-type-list.php?old=2892912&old_path=advanced-custom-fields%2Ftrunk%2Fincludes%2Fadmin%2Fadmin-internal-post-type-list.php) can be found below :

![Advanced Custom Fields](https://patchstack.com/wp-content/uploads/2023/05/image-8-1024x361.png)

There are many WordPress hook functions that are used across plugin and theme codes. One of them is `admin_body_class` hook. Make sure to sanitize the classes string that outputted when using the hook using sanitize function like `[esc_attr](https://developer.wordpress.org/reference/functions/esc_attr/)`.

## Timeline

02 May 2023We found the vulnerability and reached out to the plugin vendor.

04 May 2023Advanced Custom Fields free and pro plugin version **5.12.6** and **6.1.6** was published to patch the reported issues.

05 May 2023Added the vulnerabilities to the [Patchstack vulnerability database](https://patchstack.com/database/).

05 May 2023Published the article.

### Help us make the Internet a safer place

Making the WordPress ecosystem more secure is a team effort, and we believe that plugin developers and security researchers should work together.

* If you’re a **plugin developer**, join our [mVDP program](http://patchstack.com/for-plugins/) that makes it easier to report, manage and address vulnerabilities in your software.
* If you’re a **security researcher**, join [Patchstack Alliance](https://patchstack.com/bug-bounty/) to report vulnerabilities & earn rewards.
Found this useful? Share on

* ![](https://patchstack.com/wp-content/uploads/2024/06/twitter-x-line.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/facebook-fill.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/linkedin-fill.svg)

Protect your websites against WordPress vulnerabilities[Get started](/pricing/)
### Monthly security advice

Get the latest WordPress security intelligence delivered to your inbox.**NEW**: Get started with 5 bite-sized security lessons.
Email SignupEmailSubscribe
### The latest in Security advisories

[See all](https://patchstack.com/category/security-advisories/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerability-Patched-in-GiveWP-Plugin-main.png)10 January, 2025
#### Critical Vulnerability Patched in GiveWP Plugin

Critical Vulnerability
php object injection
Zeroday bounties
zeroday
givewp](https://patchstack.com/articles/critical-vulnerability-patched-in-givewp-plugin/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerabilities-Found-in-Fancy-Product-Designer-Plugin-main.png)8 January, 2025
#### Critical Vulnerabilities Found in Fancy Product Designer Plugin

ENVATO
Critical Vulnerability
arbitrary file upload
SQL Injection](https://patchstack.com/articles/critical-vulnerabilities-found-in-fancy-product-designer-plugin/)[![](https://patchstack.com/wp-content/uploads/2024/12/Multiple-Critical-Vulnerabilities-Patched-in-WPLMS-and-VibeBP-Plugins-main.png)23 December, 2024
#### Multiple Critical Vulnerabilities Patched in WPLMS and VibeBP Plugins

Critical Vulnerability
privilege escalation
arbitrary file upload
theme
SQL Injection
ENVATO](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wplms-and-vibebp-plugins/)

### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)[![Patchstack logo](https://patchstack.com/wp-content/uploads/2024/01/logo-opt-300x32.webp)](/)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)![Co-funded by EU logo](https://patchstack.com/wp-content/uploads/2024/01/EIC-logo-CoFundedBy-opt.webp)
[![](https://patchstack.com/wp-content/uploads/2021/01/logo.png)](/)
### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)

Looks like your browser is blocking our support chat widget. Turn off adblockers and reload the page.Reload page

xml version="1.0"?closechevron-downchainbarsangle-rightangle-upxml version="1.0"?crossmenu


