=== Content from github.com_d679a57d_20250115_090919.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fcommit%2F0bb7203b584e771b23536ba065a6efda457161bb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fcommit%2F0bb7203b584e771b23536ba065a6efda457161bb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vyperlang%2Fvyper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vyperlang](/vyperlang)
/
**[vyper](/vyperlang/vyper)**
Public

* [Notifications](/login?return_to=%2Fvyperlang%2Fvyper) You must be signed in to change notification settings
* [Fork
  818](/login?return_to=%2Fvyperlang%2Fvyper)
* [Star
   5k](/login?return_to=%2Fvyperlang%2Fvyper)

* [Code](/vyperlang/vyper)
* [Issues
  407](/vyperlang/vyper/issues)
* [Pull requests
  82](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects
  0](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

Additional navigation options

* [Code](/vyperlang/vyper)
* [Issues](/vyperlang/vyper/issues)
* [Pull requests](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

## Commit

[Permalink](/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-mgv8-gggw-mrg6](https://github.com/advisories/GHSA-mgv8-gggw-mrg6 "GHSA-mgv8-gggw-mrg6")

[Browse files](/vyperlang/vyper/tree/0bb7203b584e771b23536ba065a6efda457161bb)
Browse the repository at this point in the history

```
* fix: block storage allocator overflows

the storage allocator did not guard against overflow when no storage
layout override was provided. this could result in vulnerabilities like
the following:

```vyper
owner: public(address)
buffer: public(uint256[max_value(uint256)])

[@external](https://github.com/external)
def initialize():
    self.owner = msg.sender

[@external](https://github.com/external)
def foo(idx: uint256, data: uint256):
    self.buffer[idx] = data
```

while the get_element_ptr calculation for `self.buffer[idx]` is checked,
it is not checked in `mod_{2**256}` arithmetic, which can lead to
arithmetic wrapping back to the `owner` variable if the provided `idx`
is large enough.

* clean up allocator logic

also fix a bug where large allocations would use too much storage due to
floating point rounding precision

* add warning for large arrays

* add note about 2**64 behavior
```

* Loading branch information

[![@charles-cooper](https://avatars.githubusercontent.com/u/3867501?s=40&v=4)](/charles-cooper)

[charles-cooper](/vyperlang/vyper/commits?author=charles-cooper "View all commits by charles-cooper")
authored
Apr 29, 2023

1 parent
[4f1a98a](/vyperlang/vyper/commit/4f1a98a4291beef2c00147d7101d13162a561e96)

commit 0bb7203

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**75 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs

  + docs/types.rst
    [types.rst](#diff-903b4ce625a3ca3299767c92b7473444d0487e9ad0eb5320afa929887d8e51af)
* tests

  + cli/outputs

    - tests/cli/outputs/test\_storage\_layout\_overrides.py
      [test\_storage\_layout\_overrides.py](#diff-a9e94597d4d1720df7f7ab9569b233ebf9977985ed559d1e2d8419ed9cf67fd5)
  + functional

    - tests/functional/test\_storage\_slots.py
      [test\_storage\_slots.py](#diff-ce39e1921835ea20162cc146adc78f66086eafd3163287895b0ec3c2bf3c57a6)
* vyper/semantics

  + analysis

    - vyper/semantics/analysis/data\_positions.py
      [data\_positions.py](#diff-241beb9679a2e837e12a2b9ac0f2a2cbc0bf7b761fcc185138585d166d99ec2a)
  + types

    - vyper/semantics/types/subscriptable.py
      [subscriptable.py](#diff-5bcecbbde4c97177d5a4fb5ca8b89cfd684495d72cf8c7e71463b0c2a5fc60bc)

## There are no files selected for viewing

7 changes: 7 additions & 0 deletions

7
[docs/types.rst](#diff-903b4ce625a3ca3299767c92b7473444d0487e9ad0eb5320afa929887d8e51af "docs/types.rst")

Show comments

[View file](/vyperlang/vyper/blob/0bb7203b584e771b23536ba065a6efda457161bb/docs/types.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -520,6 +520,9 @@ A two dimensional list can be declared with ``\_name: \_ValueType[inner\_size][oute |
|  |  | # Returning the value in row 0 column 4 (in this case 14) |
|  |  | return exampleList2D[0][4] |
|  |  |  |
|  |  | .. note:: |
|  |  | Defining an array in storage whose size is significantly larger than ``2\*\*64`` can result in security vulnerabilities due to risk of overflow. |
|  |  |  |
|  |  | .. index:: !dynarrays |
|  |  |  |
|  |  | Dynamic Arrays |
| Expand Down  Expand Up | | @@ -561,6 +564,10 @@ Dynamic arrays represent bounded arrays whose length can be modified at runtime, |
|  |  |  |
|  |  | In the ABI, they are represented as ``\_Type[]``. For instance, ``DynArray[int128, 3]`` gets represented as ``int128[]``, and ``DynArray[DynArray[int128, 3], 3]`` gets represented as ``int128[][]``. |
|  |  |  |
|  |  | .. note:: |
|  |  | Defining a dynamic array in storage whose size is significantly larger than ``2\*\*64`` can result in security vulnerabilities due to risk of overflow. |
|  |  |  |
|  |  |  |
|  |  | .. \_types-struct: |
|  |  |  |
|  |  | Structs |
| Expand Down | |  |

15 changes: 15 additions & 0 deletions

15
[tests/cli/outputs/test\_storage\_layout\_overrides.py](#diff-a9e94597d4d1720df7f7ab9569b233ebf9977985ed559d1e2d8419ed9cf67fd5 "tests/cli/outputs/test_storage_layout_overrides.py")

Show comments

[View file](/vyperlang/vyper/blob/0bb7203b584e771b23536ba065a6efda457161bb/tests/cli/outputs/test_storage_layout_overrides.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -95,6 +95,21 @@ def test\_simple\_collision(): |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def test\_overflow(): |
|  |  | code = """ |
|  |  | x: uint256[2] |
|  |  | """ |
|  |  |  |
|  |  | storage\_layout\_override = {"x": {"slot": 2\*\*256 - 1, "type": "uint256[2]"}} |
|  |  |  |
|  |  | with pytest.raises( |
|  |  | StorageLayoutException, match=f"Invalid storage slot for var x, out of bounds: {2\*\*256}\n" |
|  |  | ): |
|  |  | compile\_code( |
|  |  | code, output\_formats=["layout"], storage\_layout\_override=storage\_layout\_override |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def test\_incomplete\_overrides(): |
|  |  | code = """ |
|  |  | name: public(String[64]) |
| Expand Down | |  |

16 changes: 16 additions & 0 deletions

16
[tests/functional/test\_storage\_slots.py](#diff-ce39e1921835ea20162cc146adc78f66086eafd3163287895b0ec3c2bf3c57a6 "tests/functional/test_storage_slots.py")

Show comments

[View file](/vyperlang/vyper/blob/0bb7203b584e771b23536ba065a6efda457161bb/tests/functional/test_storage_slots.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,7 @@ |
|  |  | import pytest |
|  |  |  |
|  |  | from vyper.exceptions import StorageLayoutException |
|  |  |  |
|  |  | code = """ |
|  |  |  |
|  |  | struct StructOne: |
| Expand Down  Expand Up | | @@ -97,3 +101,15 @@ def test\_reentrancy\_lock(get\_contract): |
|  |  | assert [c.foo(0, i) for i in range(3)] == [987, 654, 321] |
|  |  | assert [c.foo(1, i) for i in range(3)] == [123, 456, 789] |
|  |  | assert c.h(0) == 123456789 |
|  |  |  |
|  |  |  |
|  |  | def test\_allocator\_overflow(get\_contract): |
|  |  | code = """ |
|  |  | x: uint256 |
|  |  | y: uint256[max\_value(uint256)] |
|  |  | """ |
|  |  | with pytest.raises( |
|  |  | StorageLayoutException, |
|  |  | match=f"Invalid storage slot for var y, tried to allocate slots 1 through {2\*\*256}\n", |
|  |  | ): |
|  |  | get\_contract(code) |

51 changes: 34 additions & 17 deletions

51
[vyper/semantics/analysis/data\_positions.py](#diff-241beb9679a2e837e12a2b9ac0f2a2cbc0bf7b761fcc185138585d166d99ec2a "vyper/semantics/analysis/data_positions.py")

Show comments

[View file](/vyperlang/vyper/blob/0bb7203b584e771b23536ba065a6efda457161bb/vyper/semantics/analysis/data_positions.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ |
|  |  | from vyper.exceptions import StorageLayoutException |
|  |  | from vyper.semantics.analysis.base import CodeOffset, StorageSlot |
|  |  | from vyper.typing import StorageLayout |
|  |  | from vyper.utils import ceil32 |
|  |  |  |
|  |  |  |
|  |  | def set\_data\_positions( |
| Expand Down  Expand Up | | @@ -121,8 +122,7 @@ def set\_storage\_slots\_with\_overrides( |
|  |  | # Expect to find this variable within the storage layout overrides |
|  |  | if node.target.id in storage\_layout\_overrides: |
|  |  | var\_slot = storage\_layout\_overrides[node.target.id]["slot"] |
|  |  | # Calculate how many storage slots are required |
|  |  | storage\_length = math.ceil(varinfo.typ.size\_in\_bytes / 32) |
|  |  | storage\_length = varinfo.typ.storage\_size\_in\_words |
|  |  | # Ensure that all required storage slots are reserved, and prevents other variables |
|  |  | # from using these slots |
|  |  | reserved\_slots.reserve\_slot\_range(var\_slot, storage\_length, node.target.id) |
| Expand All | | @@ -139,14 +139,29 @@ def set\_storage\_slots\_with\_overrides( |
|  |  | return ret |
|  |  |  |
|  |  |  |
|  |  | class SimpleStorageAllocator: |
|  |  | def \_\_init\_\_(self, starting\_slot: int = 0): |
|  |  | self.\_slot = starting\_slot |
|  |  |  |
|  |  | def allocate\_slot(self, n, var\_name): |
|  |  | ret = self.\_slot |
|  |  | if self.\_slot + n >= 2\*\*256: |
|  |  | raise StorageLayoutException( |
|  |  | f"Invalid storage slot for var {var\_name}, tried to allocate" |
|  |  | f" slots {self.\_slot} through {self.\_slot + n}" |
|  |  | ) |
|  |  | self.\_slot += n |
|  |  | return ret |
|  |  |  |
|  |  |  |
|  |  | def set\_storage\_slots(vyper\_module: vy\_ast.Module) -> StorageLayout: |
|  |  | """ |
|  |  | Parse module-level Vyper AST to calculate the layout of storage variables. |
|  |  | Returns the layout as a dict of variable name -> variable info |
|  |  | """ |
|  |  | # Allocate storage slots from 0 |
|  |  | # note storage is word-addressable, not byte-addressable |
|  |  | storage\_slot = 0 |
|  |  | allocator = SimpleStorageAllocator() |
|  |  |  |
|  |  | ret: Dict[str, Dict] = {} |
|  |  |  |
| Expand All | | @@ -165,36 +180,38 @@ def set\_storage\_slots(vyper\_module: vy\_ast.Module) -> StorageLayout: |
|  |  | type\_.set\_reentrancy\_key\_position(StorageSlot(\_slot)) |
|  |  | continue |
|  |  |  |
|  |  | type\_.set\_reentrancy\_key\_position(StorageSlot(storage\_slot)) |
|  |  | # TODO use one byte - or bit - per reentrancy key |
|  |  | # requires either an extra SLOAD or caching the value of the |
|  |  | # location in memory at entrance |
|  |  | slot = allocator.allocate\_slot(1, variable\_name) |
|  |  |  |
|  |  | type\_.set\_reentrancy\_key\_position(StorageSlot(slot)) |
|  |  |  |
|  |  | # TODO this could have better typing but leave it untyped until |
|  |  | # we nail down the format better |
|  |  | ret[variable\_name] = {"type": "nonreentrant lock", "slot": storage\_slot} |
|  |  | ret[variable\_name] = {"type": "nonreentrant lock", "slot": slot} |
|  |  |  |
|  |  | # TODO use one byte - or bit - per reentrancy key |
|  |  | # requires either an extra SLOAD or caching the value of the |
|  |  | # location in memory at entrance |
|  |  | storage\_slot += 1 |
|  |  |  |
|  |  | for node in vyper\_module.get\_children(vy\_ast.VariableDecl): |
|  |  | # skip non-storage variables |
|  |  | if node.is\_constant or node.is\_immutable: |
|  |  | continue |
|  |  |  |
|  |  | varinfo = node.target.\_metadata["varinfo"] |
|  |  | varinfo.set\_position(StorageSlot(storage\_slot)) |
|  |  |  |
|  |  | type\_ = varinfo.typ |
|  |  |  |
|  |  | # this could have better typing but leave it untyped until |
|  |  | # we understand the use case better |
|  |  | ret[node.target.id] = {"type": str(type\_), "slot": storage\_slot} |
|  |  |  |
|  |  | # CMC 2021-07-23 note that HashMaps get assigned a slot here. |
|  |  | # I'm not sure if it's safe to avoid allocating that slot |
|  |  | # for HashMaps because downstream code might use the slot |
|  |  | # ID as a salt. |
|  |  | storage\_slot += math.ceil(type\_.size\_in\_bytes / 32) |
|  |  | n\_slots = type\_.storage\_size\_in\_words |
|  |  | slot = allocator.allocate\_slot(n\_slots, node.target.id) |
|  |  |  |
|  |  | varinfo.set\_position(StorageSlot(slot)) |
|  |  |  |
|  |  | # this could have better typing but leave it untyped until |
|  |  | # we understand the use case better |
|  |  | ret[node.target.id] = {"type": str(type\_), "slot": slot} |
|  |  |  |
|  |  | return ret |
|  |  |  |
| Expand All | | @@ -216,7 +233,7 @@ def set\_code\_offsets(vyper\_module: vy\_ast.Module) -> Dict: |
|  |  | type\_ = varinfo.typ |
|  |  | varinfo.set\_position(CodeOffset(offset)) |
|  |  |  |
|  |  | len\_ = math.ceil(type\_.size\_in\_bytes / 32) \* 32 |
|  |  | len\_ = ceil32(type\_.size\_in\_bytes) |
|  |  |  |
|  |  | # this could have better typing but leave it untyped until |
|  |  | # we understand the use case better |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[vyper/semantics/types/subscriptable.py](#diff-5bcecbbde4c97177d5a4fb5ca8b89cfd684495d72cf8c7e71463b0c2a5fc60bc "vyper/semantics/types/subscriptable.py")

Show comments

[View file](/vyperlang/vyper/blob/0bb7203b584e771b23536ba065a6efda457161bb/vyper/semantics/types/subscriptable.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,6 +103,9 @@ def \_\_init\_\_(self, value\_type: VyperType, length: int): |
|  |  | if not 0 < length < 2\*\*256: |
|  |  | raise InvalidType("Array length is invalid") |
|  |  |  |
|  |  | if length >= 2\*\*64: |
|  |  | warnings.warn("Use of large arrays can be unsafe!") |
|  |  |  |
|  |  | super().\_\_init\_\_(UINT256\_T, value\_type) |
|  |  | self.length = length |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0bb7203`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fcommit%2F0bb7203b584e771b23536ba065a6efda457161bb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8d8f1113_20250115_090919.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fsecurity%2Fadvisories%2FGHSA-mgv8-gggw-mrg6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fsecurity%2Fadvisories%2FGHSA-mgv8-gggw-mrg6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=vyperlang%2Fvyper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vyperlang](/vyperlang)
/
**[vyper](/vyperlang/vyper)**
Public

* [Notifications](/login?return_to=%2Fvyperlang%2Fvyper) You must be signed in to change notification settings
* [Fork
  818](/login?return_to=%2Fvyperlang%2Fvyper)
* [Star
   5k](/login?return_to=%2Fvyperlang%2Fvyper)

* [Code](/vyperlang/vyper)
* [Issues
  407](/vyperlang/vyper/issues)
* [Pull requests
  82](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects
  0](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

Additional navigation options

* [Code](/vyperlang/vyper)
* [Issues](/vyperlang/vyper/issues)
* [Pull requests](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

# Storage allocator overflow

Moderate

[charles-cooper](/charles-cooper)
published
GHSA-mgv8-gggw-mrg6
May 5, 2023

## Package

pip

vyper
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<=0.3.7

## Patched versions

0.3.8

## Description

### Impact

The storage allocator does not guard against allocation overflows. This can result in vulnerabilities like the following:

```
owner: public(address)
take_up_some_space: public(uint256[10])
buffer: public(uint256[max_value(uint256)])

@external
def initialize():
    self.owner = msg.sender

@external
def foo(idx: uint256, data: uint256):
    self.buffer[idx] = data
```

Per [@ToonVanHove](https://github.com/ToonVanHove), "An attacker can overwrite the owner variable by calling this contract with calldata: `0x04bc52f8 fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff5 ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff` (spaces inserted for readability)

`0x04bc52f8` is the selector for `foo(uint256, uint256)`, and the last argument `fff...fff` is the new value for the owner variable."

### Patches

patched in [0bb7203](https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb)

### Workarounds

*Is there a way for users to fix or remediate the vulnerability without upgrading?*

### References

*Are there any links users can visit to find out more?*

### Severity

Moderate

### CVE ID

CVE-2023-30837

### Weaknesses

No CWEs

### Credits

* [![@ToonVanHove](https://avatars.githubusercontent.com/u/9501896?s=40&v=4)](/ToonVanHove)
  [ToonVanHove](/ToonVanHove)
  Analyst
* [![@trocher](https://avatars.githubusercontent.com/u/43437004?s=40&v=4)](/trocher)
  [trocher](/trocher)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


