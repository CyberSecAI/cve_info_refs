=== Content from github.com_d2f48e12_20250114_213436.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGitSquared%2Fedex-ui%2Fblob%2F04a00c4079908788b371c6ecdefff96d0d9950f8%2Fsrc%2Fclasses%2Fterminal.class.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGitSquared%2Fedex-ui%2Fblob%2F04a00c4079908788b371c6ecdefff96d0d9950f8%2Fsrc%2Fclasses%2Fterminal.class.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=GitSquared%2Fedex-ui)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Oct 22, 2021. It is now read-only.

[GitSquared](/GitSquared)
/
**[edex-ui](/GitSquared/edex-ui)**
Public archive

* [Notifications](/login?return_to=%2FGitSquared%2Fedex-ui) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FGitSquared%2Fedex-ui)
* [Star
   41.1k](/login?return_to=%2FGitSquared%2Fedex-ui)

* [Code](/GitSquared/edex-ui)
* [Issues
  6](/GitSquared/edex-ui/issues)
* [Pull requests
  0](/GitSquared/edex-ui/pulls)
* [Discussions](/GitSquared/edex-ui/discussions)
* [Actions](/GitSquared/edex-ui/actions)
* [Wiki](/GitSquared/edex-ui/wiki)
* [Security](/GitSquared/edex-ui/security)
* [Insights](/GitSquared/edex-ui/pulse)

Additional navigation options

* [Code](/GitSquared/edex-ui)
* [Issues](/GitSquared/edex-ui/issues)
* [Pull requests](/GitSquared/edex-ui/pulls)
* [Discussions](/GitSquared/edex-ui/discussions)
* [Actions](/GitSquared/edex-ui/actions)
* [Wiki](/GitSquared/edex-ui/wiki)
* [Security](/GitSquared/edex-ui/security)
* [Insights](/GitSquared/edex-ui/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b1ee31e4_20250114_213437.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGitSquared%2Fedex-ui%2Fsecurity%2Fadvisories%2FGHSA-q8xc-f2wf-ffh9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGitSquared%2Fedex-ui%2Fsecurity%2Fadvisories%2FGHSA-q8xc-f2wf-ffh9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=GitSquared%2Fedex-ui)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Oct 22, 2021. It is now read-only.

[GitSquared](/GitSquared)
/
**[edex-ui](/GitSquared/edex-ui)**
Public archive

* [Notifications](/login?return_to=%2FGitSquared%2Fedex-ui) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FGitSquared%2Fedex-ui)
* [Star
   41.1k](/login?return_to=%2FGitSquared%2Fedex-ui)

* [Code](/GitSquared/edex-ui)
* [Issues
  6](/GitSquared/edex-ui/issues)
* [Pull requests
  0](/GitSquared/edex-ui/pulls)
* [Discussions](/GitSquared/edex-ui/discussions)
* [Actions](/GitSquared/edex-ui/actions)
* [Wiki](/GitSquared/edex-ui/wiki)
* [Security](/GitSquared/edex-ui/security)
* [Insights](/GitSquared/edex-ui/pulse)

Additional navigation options

* [Code](/GitSquared/edex-ui)
* [Issues](/GitSquared/edex-ui/issues)
* [Pull requests](/GitSquared/edex-ui/pulls)
* [Discussions](/GitSquared/edex-ui/discussions)
* [Actions](/GitSquared/edex-ui/actions)
* [Wiki](/GitSquared/edex-ui/wiki)
* [Security](/GitSquared/edex-ui/security)
* [Insights](/GitSquared/edex-ui/pulse)

# Cross-site websocket hijacking enables remote command execution (RCE)

High

[GitSquared](/GitSquared)
published
GHSA-q8xc-f2wf-ffh9
Apr 28, 2023

## Package

edex-ui

## Affected versions

<= v2.2.8

## Patched versions

None

## Description

### Impact

When running eDEX-UI and browsing the web, a malicious website can connect to eDEX's internal terminal control websocket, and send arbitrary commands to the shell.

### Patches

The project has been archived for 2+ years, and at the moment there are no plans to patch this issue and release a new version.

### Workarounds

* Shutting down eDEX-UI when browsing the web
* Ensuring the eDEX terminal runs with lowest possible privileges helps mitigating potential risks

### References

More context about the root cause of this issue can be found here:

<https://christian-schneider.net/CrossSiteWebSocketHijacking.html>

The vulnerable code can be examined here:

[edex-ui/src/classes/terminal.class.js](https://github.com/GitSquared/edex-ui/blob/04a00c4079908788b371c6ecdefff96d0d9950f8/src/classes/terminal.class.js#L458)

Line 458
in
[04a00c4](/GitSquared/edex-ui/commit/04a00c4079908788b371c6ecdefff96d0d9950f8)

|  | this.wss.on("connection", ws => { |
| --- | --- |

### Severity

High

8.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
Low

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L

### CVE ID

CVE-2023-30856

### Weaknesses

[CWE-1385](/advisories?query=cwe%3A1385)

### Credits

* [![@aufzayed](https://avatars.githubusercontent.com/u/40190200?s=40&v=4)](/aufzayed)
  [aufzayed](/aufzayed)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from christian-schneider.net_0fabc116_20250114_213435.html ===


* mail@christian-schneider.net
* +49 178 3081340
[![Christian Schneider - Security Architect, Hacker, Trainer](https://christian-schneider.net/images/logo.png)](/)

* [About](/about/)
* [Service](/service/)[Application Pentest](/service/application-pentest)
  [Cloud Security Check](/service/cloud-security-check)
  [Container Platform Review](/service/container-platform-review)
  [Attack Surface Mapping](/service/attack-surface-mapping)
  [Secure SDLC Process Review](/service/secure-sdlc-process-review)
  [Whitebox Analysis](/service/whitebox-analysis)
* [Consulting](/consulting/)[Agile Threat Modeling](/consulting/agile-threat-modeling)
  [Vulnerability Assessment](/consulting/vulnerability-assessment)
  [DevSecOps Pipeline](/consulting/devsecops-pipeline)
  [Security Architecture](/consulting/security-architecture)
  [Ask-me-Anything Series](/consulting/ask-me-anything-series)
* [Training](/training/)[Web Security Bootcamp](/training/web-security-bootcamp)
  [Pentesting Training](/training/pentesting-training)
  [Live Hacking Event](/training/live-hacking-event)
  [Custom Mini Session](/training/custom-mini-session)
* [Development](/development/)[AttackTree: Free SaaS Edition](/development/attacktree-free-saas)
  [AttackTree: Custom SaaS Edition](/development/attacktree-custom-saas)
  [AttackTree: Self-Hosted Edition](/development/attacktree-self-hosted)
  [Threagile: Support Subscription](/development/threagile-support-subscription)
  [Micro Attack Simulation: Toolkit](/development/micro-attack-simulation-toolkit)
* [Blog](/blog/)

[Contact](https://christian-schneider.net/contact/)
# Cross-Site WebSocket Hijacking (CSWSH)

1. [Home](/)
2. Blog
![post thumb](https://christian-schneider.net/images/blog/vulnerability.jpg)Vulnerabilityby
**Christian Schneider**
/ on **31 Aug 2013**
Archived Blog Post from 2013
### Hijacking WebSocket Connections

The relatively new *HTML5 WebSocket* technique to enable full-duplex communication channels between browsers and servers is retrieving more and more attention from developers as well as security analysts. Using WebSockets, developers can exchange text and binary messages pushed from the server to the browser as well as vice versa.

During some experiments and pentests with WebSocket backed applications in the last few months, I came across a scenario where developers might use WebSockets in a way to open up their applications to a vulnerability I call *Cross-Site WebSocket Hijacking (CSWSH)*, which I will present in this short blog post.

#### The protocol upgrade

In order to create the full-duplex communication channel the WebSocket protocol requires a handshake (carried out over `https://` usually) to switch towards a WebSocket protocol. This handshake effectively upgrades the communication protocol to `wss://`. But this upgrade phase is also a potential target to attack and Achilles’ heel of using WebSockets inside an application that deals with non-public data, because it kind of bridges/transfers the https-based communication towards the wss-based WebSocket protocol.

The typical lifecycle of a WebSocket interaction between a client and server goes as follows:

1. Client initiates a connection by sending an https WebSocket handshake request.
2. Server replies with a handshake response (all handled by the web application server transparently to the application) and sends a response status code of `101 Switching Protocols`.

Let’s take a closer look at this handshake request and inspect the request headers of such a handshake to upgrade the protocol to WebSockets *(of an imaginary stock portfolio management application, which uses WebSockets to quickly push new stock quotes to logged-in users as well as retrieve stock orders from them)*:

```
GET /trading/ws/stockPortfolio HTTP/1.1
Host: www.some-trading-application.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:23.0) Firefox/23.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: de-de,de;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Sec-WebSocket-Version: 13
Origin: https://www.some-trading-application.com
Sec-WebSocket-Key: x7nPlaiHMGDBuJeD6l7y/Q==
Cookie: JSESSIONID=1A9431CF043F851E0356F5837845B2EC
Connection: keep-alive, Upgrade
Pragma: no-cache
Cache-Control: no-cache
Upgrade: websocket

```

As you can see from the request headers of the https handshake request, the authentication data (in this example the `Cookie` header) is sent along with the upgrade handshake. The same would be true for HTTP-Authentication data. Both are correct behavior of the browsers according to the aforementioned specification and RFC.

Upon successful WebSocket handshake, the server replies with the 101 Switching Protocols status code and from then on the `wss://` based connection is established between browser and server. The header Sec-WebSocket-Key is part of the browser/server handshake internals (to verify that the server has read and understood the request) and is automatically created by and taken care of the browser initiating the WebSocket request.

Regarding client authentication during this handshake/upgrade phase, the RFC 6455 reads as follows:

> This protocol doesn’t prescribe any particular way that servers can authenticate clients during the WebSocket handshake. The WebSocket server can use any client authentication mechanism available to a generic HTTP server, such as cookies, HTTP authentication, or TLS authentication.

RFC 6455 "The WebSocket Protocol", chapter 10.5 WebSocket Client Authentication

This means to developers that they can use, for example, cookies or HTTP-Authentication to authenticate the WebSocket handshake request, as if it was a regular https web application request.

#### Hijacking it cross-site

Now let’s consider what happens when a developer follows this well-known style of using session cookies to authenticate the WebSocket handshake/upgrade request within a logged-in (sensitive) part of a web application:

Because WebSockets are **not restrained by the same-origin policy**, an attacker can easily initiate a WebSocket request (i.e. the handshake/upgrade process) from a malicious webpage targeting the `wss://` endpoint URL of the attacked application (the stock service in our example). Due to the fact that this request is a regular https request, browsers send the cookies and HTTP-Authentication headers along, even cross-site.

Take a look at the WebSocket handshake/upgrade request when issued from a malicious webpage cross-site (visited by the victim while logged-in with our stock trading application). Here the WebSocket endpoint `wss://www.some-trading-application.com/trading/ws/stockPortfolio` is accessed from a malicious webpage at `https://www.some-evil-attacker-application.com` as seen below (`Origin` and `Cookie` header):

```
GET /trading/ws/stockPortfolio HTTP/1.1
Host: www.some-trading-application.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:23.0) Firefox/23.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: de-de,de;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Sec-WebSocket-Version: 13
Origin: https://www.some-evil-attacker-application.com
Sec-WebSocket-Key: hP+ghc+KuZT2wQgRRikjBw==
Cookie: JSESSIONID=1A9431CF043F851E0356F5837845B2EC
Connection: keep-alive, Upgrade
Pragma: no-cache
Cache-Control: no-cache
Upgrade: websocket

```

As you can see, the browser sends the authentication information (in this example the session cookie) along with the WebSocket handshake/upgrade request. This is very similar to a *Cross-Site Request Forgery (CSRF)* attack scenario. But in the WebSocket scenario, this attack can be extended from a write-only CSRF attack to a full read/write communication with a WebSocket service by physically establishing a new WebSocket connection with the service under the same authentication data as the victim. Therefore, I call this attack vector *Cross-Site WebSocket Hijacking (CSWSH)*.

Effectively, this allows the attacker in our scenario to read the victim’s stock portfolio updates pushed via the WebSocket connection and update the protfolio by issuing write requests via the WebSocket connection. This is possible due to the fact that the server’s WebSocket code relies on the session authentication data (cookies or HTTP-Authentication) sent along from the browser during the WebSocket handshake/upgrade phase.

Another interesting observation is the `Origin` header that is sent along the WebSocket handshake/upgrade request. This is like in a regular CORS request utilizing Cross-Origin Resource Sharing: If this was a regular https CORS request, the browser would not let the JavaScript on the malicious webpage see the response, when the server does not explicitly allow it (via a matching `Access-Control-Allow-Origin` response header). But when it comes to WebSockets, this “fail close” style of defaulting to “restrict response access” when the server does not explicitly allow cross-origin requests is inverted: In our example the server did not send any CORS response headers along, but the cross-site WebSocket request’s response is still handled by the browser by properly establishing the full-duplex WebSocket connection. This demonstrates that WebSockets are not protected by the Same-Origin Policy (SOP), so developers must not rely on SOP protection when it comes to developing WebSocket based applications. Clearly the CORS stuff has nothing to do with the WebSockets stuff, but they both utilize the same request header (`Origin`) and the server-side code should check that header!

#### Securing it

As you’ve already noticed, securing an application against Cross-Site WebSocket Hijacking attacks can be performed using two countermeasures:

* Check the Origin header of the WebSocket handshake request on the server, since that header was designed to protect the server against attacker-initiated cross-site connections of victim browsers!
* Use session-individual random tokens (like CSRF-Tokens) on the handshake request and verify them on the server.

These simple but effective protections must be used as soon as you’re using WebSockets inside an application which access the web session on the server-side to communicate and/or accept private data via the WebSocket channel.

If you don’t need to access the web session from the server-side WebSocket counterpart, just separately handle authentication and/or authorization using custom tokens or similar techniques within your WebSocket protocol and avoid relating to the web session via cookies or HTTP-Authentication during the handshake request.

#### Conclusion

##### As a Pentester

Check for Cross-Site WebSocket Hijacking attacks as soon as you notice any WebSocket based communication in the application you’re analysing. As a side note, in case you already find Origin header verification present in the application, try to bypass it from victim’s browser: When the server expects <https://www.some-trading-application.com> as the Origin, mount your attacks on <https://www.some-trading-application.com.some-evil-attacker-application.com> to test for obviously broken Origin header verifications.

##### As a Security Consultant

Make your clients aware of the requirement to always check Origin headers. Educate them to secure all WebSocket handshakes using random tokens (like protecting against CSRF attacks) or let them embed the authentication and/or authorization into the WebSocket protocol (avoid web session access).

##### As a Developer

Make sure you are aware of this attack scenario and know how to employ the countermeasures securely into your application (at least when you need to access the web session from the application part that uses WebSockets or when you otherwise try to transfer non-public data over that channel). Better try to avoid accessing the web session from the server-side WebSocket counterpart and separately handle authentication and/or authorization using tokens or similar techniques within your WebSocket protocol.

##### Tags:

* [web](https://christian-schneider.net/tags/web)
* [websocket](https://christian-schneider.net/tags/websocket)
#### Latest Articles

[![](https://christian-schneider.net/images/blog/process.jpg)](https://christian-schneider.net/blog/12-steps-to-secure-software/)[##### 12 Steps to Secure Software](https://christian-schneider.net/blog/12-steps-to-secure-software/)13 Apr 2024[![](https://christian-schneider.net/images/blog/vulnerability.jpg)](https://christian-schneider.net/blog/micro-attack-simulations/)[##### Micro Attack Simulations](https://christian-schneider.net/blog/micro-attack-simulations/)20 Oct 2023[![](https://christian-schneider.net/images/blog/vulnerability.jpg)](https://christian-schneider.net/blog/log4shell-vulnerability/)[##### Handling Log4Shell vulnerability](https://christian-schneider.net/blog/log4shell-vulnerability/)18 Dec 2021
#### all Categories

* [Best Practice](/categories/best-practice)
* [Conference](/categories/conference)
* [Vulnerability](/categories/vulnerability)
#### all Tags

* [agile](/tags/agile)
* [attack-tree](/tags/attack-tree)
* [chrome](/tags/chrome)
* [cloud](/tags/cloud)
* [dependencies](/tags/dependencies)
* [deserialization](/tags/deserialization)
* [devsecops](/tags/devsecops)
* [faq](/tags/faq)
* [java](/tags/java)
* [pentesting](/tags/pentesting)
* [process](/tags/process)
* [red-team](/tags/red-team)
* [secure-sdlc](/tags/secure-sdlc)
* [simulation](/tags/simulation)
* [strategy](/tags/strategy)
* [tool](/tags/tool)
* [video](/tags/video)
* [web](/tags/web)
* [websocket](/tags/websocket)
* [xml](/tags/xml)
[**Web Security Bootcamp**
Join my upcoming two-day online training event:
**20. â 21. February 2025** (click here to see details)](/training-booking/)[![Christian Schneider - Security Architect, Hacker, Trainer](https://christian-schneider.net/images/logo-alt.png)](/)

Christian Schneider
Security Architect, Hacker, Trainer

#### Profile

#### Membership

[OWASP â Open Worldwide Application Security Project](https://www.owasp.org/)
[CCC â Chaos Computer Club](https://ccc.de/)
[Allianz fÃ¼r Cybersicherheit](https://www.allianz-fuer-cybersicherheit.de/)

#### Contact

+49 178 3081340
mail@christian-schneider.net
Herbert-Lewin-Str. 3, 50931 KÃ¶ln, Germany
#### Crypto

Preferred Messenger: Signal
S/MIME Mail: mail@christian-schneider.net
PGP-Key: [2898B0BE](https://christian-schneider.net/pgp-key.asc)
#### Meta

Insured during project assignments: [Exali IT Insurance](https://christian-schneider.net/insurance.pdf)
Tracking: Nope, visiting my website is cookieless.
#### Newsletter

Low-volume to announce new trainings, services, and conference talks *(about six mails per year)*

Subscribe
#### [Service](https://christian-schneider.net/service/)

* [Application Pentest](https://christian-schneider.net/service/application-pentest/)
* [Cloud Security Check](https://christian-schneider.net/service/cloud-security-check/)
* [Container Platform Review](https://christian-schneider.net/service/container-platform-review/)
* [Attack Surface Mapping](https://christian-schneider.net/service/attack-surface-mapping/)
* [Secure SDLC Process Review](https://christian-schneider.net/service/secure-sdlc-process-review/)
* [Whitebox Analysis](https://christian-schneider.net/service/whitebox-analysis/)
#### [Consulting](https://christian-schneider.net/consulting/)

* [Agile Threat Modeling](https://christian-schneider.net/consulting/agile-threat-modeling/)
* [Vulnerability Assessment](https://christian-schneider.net/consulting/vulnerability-assessment/)
* [DevSecOps Pipeline](https://christian-schneider.net/consulting/devsecops-pipeline/)
* [Security Architecture](https://christian-schneider.net/consulting/security-architecture/)
* [Ask-me-Anything Series](https://christian-schneider.net/consulting/ask-me-anything-series/)
#### [Training](https://christian-schneider.net/training/)

* [Web Security Bootcamp](https://christian-schneider.net/training/web-security-bootcamp/)
* [Pentesting Training](https://christian-schneider.net/training/pentesting-training/)
* [Live Hacking Event](https://christian-schneider.net/training/live-hacking-event/)
* [Custom Mini Session](https://christian-schneider.net/training/custom-mini-session/)
#### [Development](https://christian-schneider.net/development/)

* [AttackTree: Free SaaS Edition](/development/attacktree-free-saas)
* [AttackTree: Custom SaaS Edition](/development/attacktree-custom-saas)
* [AttackTree: Self-Hosted Edition](/development/attacktree-self-hosted)
* [Threagile: Support Subscription](/development/threagile-support-subscription)
* [Micro Attack Simulation: Toolkit](/development/micro-attack-simulation-toolkit)

Copyright © 2024 by Christian Schneider

* [Imprint & Disclaimer](/disclaimer/)

