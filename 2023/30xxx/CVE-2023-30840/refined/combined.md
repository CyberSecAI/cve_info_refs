=== Content from github.com_3ba68591_20250114_223356.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fcommit%2F91c05c32db131997b5ca065e869c9918a125c149)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fcommit%2F91c05c32db131997b5ca065e869c9918a125c149)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fluid-cloudnative%2Ffluid)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fluid-cloudnative](/fluid-cloudnative)
/
**[fluid](/fluid-cloudnative/fluid)**
Public

generated from [kubernetes/kubernetes-template-project](/kubernetes/kubernetes-template-project)

* [Notifications](/login?return_to=%2Ffluid-cloudnative%2Ffluid) You must be signed in to change notification settings
* [Fork
  960](/login?return_to=%2Ffluid-cloudnative%2Ffluid)
* [Star
   1.7k](/login?return_to=%2Ffluid-cloudnative%2Ffluid)

* [Code](/fluid-cloudnative/fluid)
* [Issues
  233](/fluid-cloudnative/fluid/issues)
* [Pull requests
  33](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects
  0](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

Additional navigation options

* [Code](/fluid-cloudnative/fluid)
* [Issues](/fluid-cloudnative/fluid/issues)
* [Pull requests](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

## Commit

[Permalink](/fluid-cloudnative/fluid/commit/91c05c32db131997b5ca065e869c9918a125c149)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-93xx-cvmc-9w3v](https://github.com/advisories/GHSA-93xx-cvmc-9w3v "GHSA-93xx-cvmc-9w3v")

[Browse files](/fluid-cloudnative/fluid/tree/91c05c32db131997b5ca065e869c9918a125c149)
Browse the repository at this point in the history

```
* Fix rbacs and limit CSI Plugin's node related access

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>

* Update change log and chart version

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>

* Fix fluid.namespace template rendering

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>

* Remove leader election for fluid webhook

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>

---------

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>
```

* Loading branch information

[![@TrafalgarZZZ](https://avatars.githubusercontent.com/u/14257111?s=40&v=4)](/TrafalgarZZZ)

[TrafalgarZZZ](/fluid-cloudnative/fluid/commits?author=TrafalgarZZZ "View all commits by TrafalgarZZZ")
authored
May 8, 2023

1 parent
[5588b1f](/fluid-cloudnative/fluid/commit/5588b1f212e8fa8e6457c7f1cd67c931329187f1)

commit 91c05c3

 Show file tree

 Hide file tree

Showing
**13 changed files**
with
**215 additions**
and
**73 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* charts/fluid/fluid

  + charts/fluid/fluid/CHANGELOG.md
    [CHANGELOG.md](#diff-f26707de8a195ad6da1401f3e9a505e907799ceb03d084001ac4288324cd298a)
  + charts/fluid/fluid/Chart.yaml
    [Chart.yaml](#diff-3d49f383d52ce417aa7bcf339666ee60ef56d105cd9979814061b3ed2156cf44)
  + templates

    - csi

      * charts/fluid/fluid/templates/csi/daemonset.yaml
        [daemonset.yaml](#diff-6611dcbd4e82bcce23cf2d7550f2d67821c476fb55962a93d6f0c39a29b5e6b9)
    - role

      * csi

        + charts/fluid/fluid/templates/role/csi/rbac.yaml
          [rbac.yaml](#diff-23a502048d6828807ea725009a9b9d60338b5b55e951e465c2d4aa97094f3be0)
      * webhook

        + charts/fluid/fluid/templates/role/webhook/rabc.yaml
          [rabc.yaml](#diff-c70ca1eecb22f3ba29b7fef54d1f5e083a13a5fb2519848911f36965e5cd129e)
    - webhook

      * charts/fluid/fluid/templates/webhook/webhook.yaml
        [webhook.yaml](#diff-4a143455cef213ba86bc6e01ad655b1a4d2c6d249f5ef9500f47ab06e5f23f27)
  + charts/fluid/fluid/values.yaml
    [values.yaml](#diff-0d9539a874c2bd72724e132812f4ec71417c7a37703546a411c1bab4820f9928)
* cmd/csi/app

  + cmd/csi/app/csi.go
    [csi.go](#diff-d045d754805a287a19ad40feb0be143ee97f7e06118e06bb41e561f2c4c7bf60)
* pkg

  + csi

    - config

      * pkg/csi/config/config.go
        [config.go](#diff-0fbefccf47d7729cf86ebeb23cc5efbd9c970ccb9911ff746453daabfafa545d)
    - plugins

      * pkg/csi/plugins/driver.go
        [driver.go](#diff-3f76f48901d61a09a644daf5e3688387ec7e2d2a8e136305d66215219cb4476e)
      * pkg/csi/plugins/nodeserver.go
        [nodeserver.go](#diff-a1838a013e18393122f4764335f0774dc04d3ccf71490d2754dae51a174406d9)
      * pkg/csi/plugins/register.go
        [register.go](#diff-d00dc4783d1585521b9460a2e63c5a9f3a88839beedba4fa56cfd0d9d5da6257)
  + utils/kubelet

    - pkg/utils/kubelet/node\_auth\_client.go
      [node\_auth\_client.go](#diff-7f262c3d8388a2f3d7512feaa0188fb22406639014482dfca4550a02751bebd3)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[charts/fluid/fluid/CHANGELOG.md](#diff-f26707de8a195ad6da1401f3e9a505e907799ceb03d084001ac4288324cd298a "charts/fluid/fluid/CHANGELOG.md")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -54,3 +54,4 @@ |
|  |  |  |
|  |  | ### 0.9.0 |
|  |  | \* Support pass image pull secrets from fluid charts to alluxioruntime controller |
|  |  | \* Fix components rbacs and set Fluid CSI Plugin with node-authorized kube-client |

2 changes: 1 addition & 1 deletion

2
[charts/fluid/fluid/Chart.yaml](#diff-3d49f383d52ce417aa7bcf339666ee60ef56d105cd9979814061b3ed2156cf44 "charts/fluid/fluid/Chart.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/Chart.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,7 +18,7 @@ version: 0.8.6 |
|  |  |  |
|  |  | # This is the version number of the application being deployed. This version number should be |
|  |  | # incremented each time you make changes to the application. |
|  |  | appVersion: 0.8.5-00f609e |
|  |  | appVersion: 0.8.6-2131f34 |
|  |  | home: https://github.com/fluid-cloudnative/fluid |
|  |  | keywords: |
|  |  | - category:data |
| Expand Down | |  |

28 changes: 24 additions & 4 deletions

28
[charts/fluid/fluid/templates/csi/daemonset.yaml](#diff-6611dcbd4e82bcce23cf2d7550f2d67821c476fb55962a93d6f0c39a29b5e6b9 "charts/fluid/fluid/templates/csi/daemonset.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/templates/csi/daemonset.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -104,8 +104,16 @@ spec: |
|  |  | - name: fluid-src-dir |
|  |  | mountPath: {{ .Values.runtime.mountRoot | quote }} |
|  |  | mountPropagation: "Bidirectional" |
|  |  | - name: host-etc-dir |
|  |  | mountPath: /host-etc |
|  |  | - name: kubelet-kube-config |
|  |  | mountPath: /etc/kubernetes/kubelet.conf |
|  |  | readOnly: true |
|  |  | - name: kubelet-cert-dir |
|  |  | mountPath: {{ .Values.csi.kubelet.certDir | quote }} |
|  |  | readOnly: true |
|  |  | - name: updatedb-conf |
|  |  | mountPath: /host-etc/updatedb.conf |
|  |  | - name: updatedb-conf-bak |
|  |  | mountPath: /host-etc/updatedb.conf.bak |
|  |  | volumes: |
|  |  | - name: kubelet-dir |
|  |  | hostPath: |
| Expand All | | @@ -124,6 +132,18 @@ spec: |
|  |  | type: DirectoryOrCreate |
|  |  | name: fluid-src-dir |
|  |  | - hostPath: |
|  |  | path: /etc |
|  |  | path: {{ .Values.csi.kubelet.kubeConfigFile | quote }} |
|  |  | type: File |
|  |  | name: kubelet-kube-config |
|  |  | - hostPath: |
|  |  | path: {{ .Values.csi.kubelet.certDir | quote }} |
|  |  | type: Directory |
|  |  | name: host-etc-dir |
|  |  | name: kubelet-cert-dir |
|  |  | - hostPath: |
|  |  | path: /etc/updatedb.conf |
|  |  | type: FileOrCreate |
|  |  | name: updatedb-conf |
|  |  | - hostPath: |
|  |  | path: /etc/updatedb.conf.backup |
|  |  | type: FileOrCreate |
|  |  | name: updatedb-conf-bak |

8 changes: 1 addition & 7 deletions

8
[charts/fluid/fluid/templates/role/csi/rbac.yaml](#diff-23a502048d6828807ea725009a9b9d60338b5b55e951e465c2d4aa97094f3be0 "charts/fluid/fluid/templates/role/csi/rbac.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/templates/role/csi/rbac.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,13 +37,7 @@ rules: |
|  |  | verbs: ["get"] |
|  |  | - apiGroups: [""] |
|  |  | resources: ["events"] |
|  |  | verbs: ["get", "list", "watch", "create", "update", "patch"] |
|  |  | - apiGroups: [""] |
|  |  | resources: ["nodes"] |
|  |  | verbs: ["get", "patch"] |
|  |  | - apiGroups: [""] |
|  |  | resources: ["nodes/proxy"] |
|  |  | verbs: ["\*"] |
|  |  | verbs: ["create", "patch"] |
|  |  | --- |
|  |  | kind: ClusterRoleBinding |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
| Expand Down | |  |

55 changes: 45 additions & 10 deletions

55
[charts/fluid/fluid/templates/role/webhook/rabc.yaml](#diff-c70ca1eecb22f3ba29b7fef54d1f5e083a13a5fb2519848911f36965e5cd129e "charts/fluid/fluid/templates/role/webhook/rabc.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/templates/role/webhook/rabc.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,16 +1,59 @@ |
|  |  | {{ if .Values.webhook.enabled -}} |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: Role |
|  |  | metadata: |
|  |  | name: fluid-webhook |
|  |  | namespace: fluid-system |
|  |  | rules: |
|  |  | - apiGroups: |
|  |  | - "" |
|  |  | resources: |
|  |  | - secrets |
|  |  | verbs: |
|  |  | - get |
|  |  | - update |
|  |  | resourceNames: |
|  |  | - fluid-webhook-certs |
|  |  | # resourceNames won't protect create verb, so individually specify it for readability |
|  |  | - apiGroups: |
|  |  | - "" |
|  |  | resources: |
|  |  | - secrets |
|  |  | verbs: |
|  |  | - create |
|  |  | --- |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: RoleBinding |
|  |  | metadata: |
|  |  | name: fluid-webhook-rolebinding |
|  |  | namespace: fluid-system |
|  |  | roleRef: |
|  |  | apiGroup: rbac.authorization.k8s.io |
|  |  | kind: Role |
|  |  | name: fluid-webhook |
|  |  | subjects: |
|  |  | - kind: ServiceAccount |
|  |  | name: fluid-webhook |
|  |  | namespace: fluid-system |
|  |  | --- |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: ClusterRole |
|  |  | metadata: |
|  |  | name: fluid-webhook |
|  |  | rules: |
|  |  | # Can only list and watch secret `mutatingwebhookconfiguration` with a metadata.name field selector |
|  |  | # See https://kubernetes.io/docs/reference/access-authn-authz/rbac/#referring-to-resources |
|  |  | - apiGroups: |
|  |  | - admissionregistration.k8s.io |
|  |  | resources: |
|  |  | - validatingwebhookconfigurations |
|  |  | - mutatingwebhookconfigurations |
|  |  | resourceNames: |
|  |  | - fluid-pod-admission-webhook |
|  |  | verbs: |
|  |  | - '\*' |
|  |  | - get |
|  |  | - patch |
|  |  | - list |
|  |  | - watch |
|  |  | - apiGroups: |
|  |  | - data.fluid.io |
|  |  | resources: |
| Expand All | | @@ -36,9 +79,7 @@ rules: |
|  |  | - apiGroups: |
|  |  | - "" |
|  |  | resources: |
|  |  | - secrets |
|  |  | - configmaps |
|  |  | - events |
|  |  | verbs: |
|  |  | - get |
|  |  | - create |
| Expand All | | @@ -54,12 +95,6 @@ rules: |
|  |  | - get |
|  |  | - list |
|  |  | - watch |
|  |  | - apiGroups: |
|  |  | - coordination.k8s.io |
|  |  | resources: |
|  |  | - leases |
|  |  | verbs: |
|  |  | - '\*' |
|  |  | --- |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: ClusterRoleBinding |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[charts/fluid/fluid/templates/webhook/webhook.yaml](#diff-4a143455cef213ba86bc6e01ad655b1a4d2c6d249f5ef9500f47ab06e5f23f27 "charts/fluid/fluid/templates/webhook/webhook.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/templates/webhook/webhook.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,8 @@ spec: |
|  |  | labels: |
|  |  | control-plane: fluid-webhook |
|  |  | spec: |
|  |  | tolerations: |
|  |  | - operator: Exists |
|  |  | {{- with .Values.image.imagePullSecrets }} |
|  |  | imagePullSecrets: |
|  |  | {{- toYaml . | nindent 8 }} |
| Expand All | | @@ -29,7 +31,6 @@ spec: |
|  |  | - --development=false |
|  |  | - --full-go-profile=false |
|  |  | - --pprof-addr=:6060 |
|  |  | - --enable-leader-election |
|  |  | env: |
|  |  | - name: MY\_POD\_NAMESPACE |
|  |  | valueFrom: |
| Expand Down | |  |

26 changes: 14 additions & 12 deletions

26
[charts/fluid/fluid/values.yaml](#diff-0d9539a874c2bd72724e132812f4ec71417c7a37703546a411c1bab4820f9928 "charts/fluid/fluid/values.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/charts/fluid/fluid/values.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,15 +4,15 @@ |
|  |  |  |
|  |  | workdir: /tmp |
|  |  | crdUpgrade: |
|  |  | image: fluidcloudnative/fluid-crd-upgrader:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/fluid-crd-upgrader:v0.8.6-2131f34 |
|  |  |  |
|  |  | image: |
|  |  | imagePullSecrets: [] |
|  |  |  |
|  |  | dataset: |
|  |  | replicas: 1 |
|  |  | controller: |
|  |  | image: fluidcloudnative/dataset-controller:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/dataset-controller:v0.8.6-2131f34 |
|  |  |  |
|  |  | csi: |
|  |  | featureGates: "FuseRecovery=false" |
| Expand All | | @@ -21,8 +21,10 @@ csi: |
|  |  | registrar: |
|  |  | image: registry.aliyuncs.com/acs/csi-node-driver-registrar:v2.3.0-038aeb6-aliyun |
|  |  | plugins: |
|  |  | image: fluidcloudnative/fluid-csi:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/fluid-csi:v0.8.6-2131f34 |
|  |  | kubelet: |
|  |  | kubeConfigFile: /etc/kubernetes/kubelet.conf |
|  |  | certDir: /var/lib/kubelet/pki |
|  |  | rootDir: /var/lib/kubelet |
|  |  | pruneFs: fuse.alluxio-fuse,fuse.jindofs-fuse,fuse.juicefs,fuse.goosefs-fuse,ossfs |
|  |  |  |
| Expand All | | @@ -37,9 +39,9 @@ runtime: |
|  |  | portAllocatePolicy: random |
|  |  | enabled: false |
|  |  | init: |
|  |  | image: fluidcloudnative/init-users:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/init-users:v0.8.6-2131f34 |
|  |  | controller: |
|  |  | image: fluidcloudnative/alluxioruntime-controller:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/alluxioruntime-controller:v0.8.6-2131f34 |
|  |  | runtime: |
|  |  | # image: fluidcloudnative/alluxio:release-2.7.3-SNAPSHOT-a7154f1 |
|  |  | image: fluidcloudnative/alluxio:release-2.8.1-SNAPSHOT-0433ade |
| Expand All | | @@ -59,21 +61,21 @@ runtime: |
|  |  | fuse: |
|  |  | image: registry.cn-shanghai.aliyuncs.com/jindofs/jindo-fuse:4.5.1 |
|  |  | controller: |
|  |  | image: fluidcloudnative/jindoruntime-controller:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/jindoruntime-controller:v0.8.6-2131f34 |
|  |  | init: |
|  |  | portCheck: |
|  |  | enabled: false |
|  |  | image: fluidcloudnative/init-users:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/init-users:v0.8.6-2131f34 |
|  |  | goosefs: |
|  |  | replicas: 1 |
|  |  | runtimeWorkers: 3 |
|  |  | portRange: 26000-32000 |
|  |  | portAllocatePolicy: random |
|  |  | enabled: false |
|  |  | init: |
|  |  | image: fluidcloudnative/init-users:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/init-users:v0.8.6-2131f34 |
|  |  | controller: |
|  |  | image: fluidcloudnative/goosefsruntime-controller:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/goosefsruntime-controller:v0.8.6-2131f34 |
|  |  | runtime: |
|  |  | image: ccr.ccs.tencentyun.com/qcloud/goosefs:v1.2.0 |
|  |  | fuse: |
| Expand All | | @@ -82,18 +84,18 @@ runtime: |
|  |  | replicas: 1 |
|  |  | enabled: false |
|  |  | controller: |
|  |  | image: fluidcloudnative/juicefsruntime-controller:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/juicefsruntime-controller:v0.8.6-2131f34 |
|  |  | fuse: |
|  |  | image: juicedata/juicefs-fuse:v1.0.0-4.8.0 |
|  |  |  |
|  |  | webhook: |
|  |  | enabled: true |
|  |  | image: fluidcloudnative/fluid-webhook:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/fluid-webhook:v0.8.6-2131f34 |
|  |  | replicas: 1 |
|  |  | reinvocationPolicy: Never |
|  |  |  |
|  |  | fluidapp: |
|  |  | enabled: true |
|  |  | replicas: 1 |
|  |  | controller: |
|  |  | image: fluidcloudnative/application-controller:v0.8.5-00f609e |
|  |  | image: fluidcloudnative/application-controller:v0.8.6-2131f34 |

23 changes: 13 additions & 10 deletions

23
[cmd/csi/app/csi.go](#diff-d045d754805a287a19ad40feb0be143ee97f7e06118e06bb41e561f2c4c7bf60 "cmd/csi/app/csi.go")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/cmd/csi/app/csi.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,12 +39,13 @@ import ( |
|  |  | ) |
|  |  |  |
|  |  | var ( |
|  |  | endpoint string |
|  |  | nodeID string |
|  |  | metricsAddr string |
|  |  | pprofAddr string |
|  |  | pruneFs []string |
|  |  | prunePath string |
|  |  | endpoint string |
|  |  | nodeID string |
|  |  | metricsAddr string |
|  |  | pprofAddr string |
|  |  | pruneFs []string |
|  |  | prunePath string |
|  |  | kubeletKubeConfigPath string |
|  |  | ) |
|  |  |  |
|  |  | var scheme = runtime.NewScheme() |
| Expand Down  Expand Up | | @@ -81,6 +82,7 @@ func init() { |
|  |  | startCmd.Flags().StringVarP(&prunePath, "prune-path", "", "/runtime-mnt", "Prune path to add in /etc/updatedb.conf") |
|  |  | startCmd.Flags().StringVarP(&metricsAddr, "metrics-addr", "", ":8080", "The address the metrics endpoint binds to.") |
|  |  | startCmd.Flags().StringVarP(&pprofAddr, "pprof-addr", "", "", "The address for pprof to use while exporting profiling results") |
|  |  | startCmd.Flags().StringVarP(&kubeletKubeConfigPath, "kubelet-kube-config", "", "/etc/kubernetes/kubelet.conf", "The file path to kubelet kube config") |
|  |  | utilfeature.DefaultMutableFeatureGate.AddFlag(startCmd.Flags()) |
|  |  | startCmd.Flags().AddGoFlagSet(flag.CommandLine) |
|  |  | } |
| Expand Down  Expand Up | | @@ -109,10 +111,11 @@ func handle() { |
|  |  | } |
|  |  |  |
|  |  | config := config.Config{ |
|  |  | NodeId: nodeID, |
|  |  | Endpoint: endpoint, |
|  |  | PruneFs: pruneFs, |
|  |  | PrunePath: prunePath, |
|  |  | NodeId: nodeID, |
|  |  | Endpoint: endpoint, |
|  |  | PruneFs: pruneFs, |
|  |  | PrunePath: prunePath, |
|  |  | KubeletConfigPath: kubeletKubeConfigPath, |
|  |  | } |
|  |  |  |
|  |  | if err = csi.SetupWithManager(mgr, config); err != nil { |
| Expand Down | |  |

9 changes: 5 additions & 4 deletions

9
[pkg/csi/config/config.go](#diff-0fbefccf47d7729cf86ebeb23cc5efbd9c970ccb9911ff746453daabfafa545d "pkg/csi/config/config.go")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/pkg/csi/config/config.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,8 +17,9 @@ limitations under the License. |
|  |  | package config |
|  |  |  |
|  |  | type Config struct { |
|  |  | NodeId string |
|  |  | Endpoint string |
|  |  | PruneFs []string |
|  |  | PrunePath string |
|  |  | NodeId string |
|  |  | Endpoint string |
|  |  | PruneFs []string |
|  |  | PrunePath string |
|  |  | KubeletConfigPath string |
|  |  | } |

35 changes: 20 additions & 15 deletions

35
[pkg/csi/plugins/driver.go](#diff-3f76f48901d61a09a644daf5e3688387ec7e2d2a8e136305d66215219cb4476e "pkg/csi/plugins/driver.go")

Show comments

[View file](/fluid-cloudnative/fluid/blob/91c05c32db131997b5ca065e869c9918a125c149/pkg/csi/plugins/driver.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,9 +20,11 @@ import ( |
|  |  | "fmt" |
|  |  | "os" |
|  |  | "path/filepath" |
|  |  | "strings" |
|  |  |  |
|  |  | "k8s.io/client-go/kubernetes" |
|  |  | "sigs.k8s.io/controller-runtime/pkg/client" |
|  |  | "sigs.k8s.io/controller-runtime/pkg/manager" |
|  |  | "strings" |
|  |  |  |
|  |  | "github.com/container-storage-interface/spec/lib/go/csi" |
|  |  | "github.com/fluid-cloudnative/fluid/pkg/utils" |
| Expand All | | @@ -36,15 +38,16 @@ const ( |
|  |  | ) |
|  |  |  |
|  |  | type driver struct { |
|  |  | client client.Client |
|  |  | apiReader client.Reader |
|  |  | csiDriver \*csicommon.CSIDriver |
|  |  | nodeId, endpoint string |
|  |  | client client.Client |
|  |  | apiReader client.Reader |
|  |  | nodeAuthorizedClient \*kubernetes.Clientset |
|  |  | csiDriver \*csicommon.CSIDriver |
|  |  | nodeId, endpoint string |
|  |  | } |
|  |  |  |
|  |  | var \_ manager.Runnable = &driver{} |
|  |  |  |
|  |  | func NewDriver(nodeID, endpoint string, client client.Client, apiReader client.Reader) \*driver { |
|  |  | func NewDriver(nodeID, endpoint string, client client.Client, apiReader client.Reader, nodeAuthorizedClient \*kubernetes.Clientset) \*driver { |
|  |  | glog.Infof("Driver: %v version: %v", driverName, version) |
|  |  |  |
|  |  | proto, addr := utils.SplitSchemaAddr(endpoint) |
| Expand All | | @@ -66,11 +69,12 @@ func NewDriver(nodeID, endpoint string, client client.Client, apiReader client.R |
|  |  | csiDriver.AddVolumeCapabilityAccessModes([]csi.VolumeCapability\_AccessMode\_Mode{csi.VolumeCapability\_AccessMode\_MULTI\_NODE\_MULTI\_WRITER}) |
|  |  |  |
|  |  | return &driver{ |
|  |  | nodeId: nodeID, |
|  |  | endpoint: endpoint, |
|  |  | csiDriver: csiDriver, |
|  |  | client: client, |
|  |  | apiReader: apiReader, |
|  |  | nodeId: nodeID, |
|  |  | endpoint: endpoint, |
|  |  | csiDriver: csiDriver, |
|  |  | client: client, |
|  |  | nodeAuthorizedClient: nodeAuthorizedClient, |
|  |  | apiReader: apiReader, |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand All | | @@ -82,10 +86,11 @@ func (d \*driver) newControllerServer() \*controllerServer { |
|  |  |  |
|  |  | func (d \*driver) newNodeServer() \*nodeServer { |
|  |  | return &nodeServer{ |
|  |  | nodeId: d.nodeId, |
|  |  | DefaultNodeServer: csicommon.NewDefaultNodeServer(d.csiDriver), |
|  |  | client: d.client, |
|  |  | apiReader: d.apiReader, |
|  |  | nodeId: d.nodeId, |
|  |  | DefaultNodeServer: csicommon.NewDefaultNodeServer(d.csiDriver), |
|  |  | client: d.client, |
|  |  | apiReader: d.apiReader, |
|  |  | nodeAuthorizedClient: d.nodeAuthorizedClient, |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `91c05c3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fcommit%2F91c05c32db131997b5ca065e869c9918a125c149) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_21bfae1a_20250114_223354.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fcommit%2F77c8110a3d1ec077ae2bce6bd88d296505db1550)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fcommit%2F77c8110a3d1ec077ae2bce6bd88d296505db1550)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fluid-cloudnative%2Ffluid)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fluid-cloudnative](/fluid-cloudnative)
/
**[fluid](/fluid-cloudnative/fluid)**
Public

generated from [kubernetes/kubernetes-template-project](/kubernetes/kubernetes-template-project)

* [Notifications](/login?return_to=%2Ffluid-cloudnative%2Ffluid) You must be signed in to change notification settings
* [Fork
  960](/login?return_to=%2Ffluid-cloudnative%2Ffluid)
* [Star
   1.7k](/login?return_to=%2Ffluid-cloudnative%2Ffluid)

* [Code](/fluid-cloudnative/fluid)
* [Issues
  233](/fluid-cloudnative/fluid/issues)
* [Pull requests
  33](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects
  0](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

Additional navigation options

* [Code](/fluid-cloudnative/fluid)
* [Issues](/fluid-cloudnative/fluid/issues)
* [Pull requests](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

## Commit

[Permalink](/fluid-cloudnative/fluid/commit/77c8110a3d1ec077ae2bce6bd88d296505db1550)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-93xx-cvmc-9w3v](https://github.com/advisories/GHSA-93xx-cvmc-9w3v "GHSA-93xx-cvmc-9w3v")

[Browse files](/fluid-cloudnative/fluid/tree/77c8110a3d1ec077ae2bce6bd88d296505db1550)
Browse the repository at this point in the history

```
* Fix rbacs and limit CSI Plugin's node related access

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>

* Update change log

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>

---------

Signed-off-by: trafalgarzzz <trafalgarz@outlook.com>
```

* Loading branch information

[![@TrafalgarZZZ](https://avatars.githubusercontent.com/u/14257111?s=40&v=4)](/TrafalgarZZZ)

[TrafalgarZZZ](/fluid-cloudnative/fluid/commits?author=TrafalgarZZZ "View all commits by TrafalgarZZZ")
authored
May 8, 2023

1 parent
[1cc14b3](/fluid-cloudnative/fluid/commit/1cc14b31b96aa07aa057e3f481e21c539110c2c5)

commit 77c8110

 Show file tree

 Hide file tree

Showing
**12 changed files**
with
**203 additions**
and
**60 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* charts/fluid/fluid

  + charts/fluid/fluid/CHANGELOG.md
    [CHANGELOG.md](#diff-f26707de8a195ad6da1401f3e9a505e907799ceb03d084001ac4288324cd298a)
  + templates

    - csi

      * charts/fluid/fluid/templates/csi/daemonset.yaml
        [daemonset.yaml](#diff-6611dcbd4e82bcce23cf2d7550f2d67821c476fb55962a93d6f0c39a29b5e6b9)
    - role

      * csi

        + charts/fluid/fluid/templates/role/csi/rbac.yaml
          [rbac.yaml](#diff-23a502048d6828807ea725009a9b9d60338b5b55e951e465c2d4aa97094f3be0)
      * webhook

        + charts/fluid/fluid/templates/role/webhook/rabc.yaml
          [rabc.yaml](#diff-c70ca1eecb22f3ba29b7fef54d1f5e083a13a5fb2519848911f36965e5cd129e)
    - webhook

      * charts/fluid/fluid/templates/webhook/webhook.yaml
        [webhook.yaml](#diff-4a143455cef213ba86bc6e01ad655b1a4d2c6d249f5ef9500f47ab06e5f23f27)
  + charts/fluid/fluid/values.yaml
    [values.yaml](#diff-0d9539a874c2bd72724e132812f4ec71417c7a37703546a411c1bab4820f9928)
* cmd/csi/app

  + cmd/csi/app/csi.go
    [csi.go](#diff-d045d754805a287a19ad40feb0be143ee97f7e06118e06bb41e561f2c4c7bf60)
* pkg

  + csi

    - config

      * pkg/csi/config/config.go
        [config.go](#diff-0fbefccf47d7729cf86ebeb23cc5efbd9c970ccb9911ff746453daabfafa545d)
    - plugins

      * pkg/csi/plugins/driver.go
        [driver.go](#diff-3f76f48901d61a09a644daf5e3688387ec7e2d2a8e136305d66215219cb4476e)
      * pkg/csi/plugins/nodeserver.go
        [nodeserver.go](#diff-a1838a013e18393122f4764335f0774dc04d3ccf71490d2754dae51a174406d9)
      * pkg/csi/plugins/register.go
        [register.go](#diff-d00dc4783d1585521b9460a2e63c5a9f3a88839beedba4fa56cfd0d9d5da6257)
  + utils/kubelet

    - pkg/utils/kubelet/node\_auth\_client.go
      [node\_auth\_client.go](#diff-7f262c3d8388a2f3d7512feaa0188fb22406639014482dfca4550a02751bebd3)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[charts/fluid/fluid/CHANGELOG.md](#diff-f26707de8a195ad6da1401f3e9a505e907799ceb03d084001ac4288324cd298a "charts/fluid/fluid/CHANGELOG.md")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/charts/fluid/fluid/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -53,4 +53,5 @@ |
|  |  | \* Scale runtime controllers on demand |
|  |  |  |
|  |  | ### 0.9.0 |
|  |  | \* Support pass image pull secrets from fluid charts to alluxioruntime controller |
|  |  | \* Support pass image pull secrets from fluid charts to alluxioruntime controller |
|  |  | \* Fix components rbacs and set Fluid CSI Plugin with node-authorized kube-client |

28 changes: 24 additions & 4 deletions

28
[charts/fluid/fluid/templates/csi/daemonset.yaml](#diff-6611dcbd4e82bcce23cf2d7550f2d67821c476fb55962a93d6f0c39a29b5e6b9 "charts/fluid/fluid/templates/csi/daemonset.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/charts/fluid/fluid/templates/csi/daemonset.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -104,8 +104,16 @@ spec: |
|  |  | - name: fluid-src-dir |
|  |  | mountPath: {{ .Values.runtime.mountRoot | quote }} |
|  |  | mountPropagation: "Bidirectional" |
|  |  | - name: host-etc-dir |
|  |  | mountPath: /host-etc |
|  |  | - name: kubelet-kube-config |
|  |  | mountPath: /etc/kubernetes/kubelet.conf |
|  |  | readOnly: true |
|  |  | - name: kubelet-cert-dir |
|  |  | mountPath: {{ .Values.csi.kubelet.certDir | quote }} |
|  |  | readOnly: true |
|  |  | - name: updatedb-conf |
|  |  | mountPath: /host-etc/updatedb.conf |
|  |  | - name: updatedb-conf-bak |
|  |  | mountPath: /host-etc/updatedb.conf.bak |
|  |  | volumes: |
|  |  | - name: kubelet-dir |
|  |  | hostPath: |
| Expand All | | @@ -124,6 +132,18 @@ spec: |
|  |  | type: DirectoryOrCreate |
|  |  | name: fluid-src-dir |
|  |  | - hostPath: |
|  |  | path: /etc |
|  |  | path: {{ .Values.csi.kubelet.kubeConfigFile | quote }} |
|  |  | type: File |
|  |  | name: kubelet-kube-config |
|  |  | - hostPath: |
|  |  | path: {{ .Values.csi.kubelet.certDir | quote }} |
|  |  | type: Directory |
|  |  | name: host-etc-dir |
|  |  | name: kubelet-cert-dir |
|  |  | - hostPath: |
|  |  | path: /etc/updatedb.conf |
|  |  | type: FileOrCreate |
|  |  | name: updatedb-conf |
|  |  | - hostPath: |
|  |  | path: /etc/updatedb.conf.backup |
|  |  | type: FileOrCreate |
|  |  | name: updatedb-conf-bak |

8 changes: 1 addition & 7 deletions

8
[charts/fluid/fluid/templates/role/csi/rbac.yaml](#diff-23a502048d6828807ea725009a9b9d60338b5b55e951e465c2d4aa97094f3be0 "charts/fluid/fluid/templates/role/csi/rbac.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/charts/fluid/fluid/templates/role/csi/rbac.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,13 +41,7 @@ rules: |
|  |  | verbs: ["get"] |
|  |  | - apiGroups: [""] |
|  |  | resources: ["events"] |
|  |  | verbs: ["get", "list", "watch", "create", "update", "patch"] |
|  |  | - apiGroups: [""] |
|  |  | resources: ["nodes"] |
|  |  | verbs: ["get", "patch"] |
|  |  | - apiGroups: [""] |
|  |  | resources: ["nodes/proxy"] |
|  |  | verbs: ["\*"] |
|  |  | verbs: ["create", "patch"] |
|  |  | --- |
|  |  | kind: ClusterRoleBinding |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
| Expand Down | |  |

55 changes: 45 additions & 10 deletions

55
[charts/fluid/fluid/templates/role/webhook/rabc.yaml](#diff-c70ca1eecb22f3ba29b7fef54d1f5e083a13a5fb2519848911f36965e5cd129e "charts/fluid/fluid/templates/role/webhook/rabc.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/charts/fluid/fluid/templates/role/webhook/rabc.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,16 +1,59 @@ |
|  |  | {{ if .Values.webhook.enabled -}} |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: Role |
|  |  | metadata: |
|  |  | name: fluid-webhook |
|  |  | namespace: {{ include "fluid.namespace" . }} |
|  |  | rules: |
|  |  | - apiGroups: |
|  |  | - "" |
|  |  | resources: |
|  |  | - secrets |
|  |  | verbs: |
|  |  | - get |
|  |  | - update |
|  |  | resourceNames: |
|  |  | - fluid-webhook-certs |
|  |  | # resourceNames won't protect create verb, so individually specify it for readability |
|  |  | - apiGroups: |
|  |  | - "" |
|  |  | resources: |
|  |  | - secrets |
|  |  | verbs: |
|  |  | - create |
|  |  | --- |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: RoleBinding |
|  |  | metadata: |
|  |  | name: fluid-webhook-rolebinding |
|  |  | namespace: {{ include "fluid.namespace" . }} |
|  |  | roleRef: |
|  |  | apiGroup: rbac.authorization.k8s.io |
|  |  | kind: Role |
|  |  | name: fluid-webhook |
|  |  | subjects: |
|  |  | - kind: ServiceAccount |
|  |  | name: fluid-webhook |
|  |  | namespace: {{ include "fluid.namespace" . }} |
|  |  | --- |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: ClusterRole |
|  |  | metadata: |
|  |  | name: fluid-webhook |
|  |  | rules: |
|  |  | # Can only list and watch secret `mutatingwebhookconfiguration` with a metadata.name field selector |
|  |  | # See https://kubernetes.io/docs/reference/access-authn-authz/rbac/#referring-to-resources |
|  |  | - apiGroups: |
|  |  | - admissionregistration.k8s.io |
|  |  | resources: |
|  |  | - validatingwebhookconfigurations |
|  |  | - mutatingwebhookconfigurations |
|  |  | resourceNames: |
|  |  | - fluid-pod-admission-webhook |
|  |  | verbs: |
|  |  | - '\*' |
|  |  | - get |
|  |  | - patch |
|  |  | - list |
|  |  | - watch |
|  |  | - apiGroups: |
|  |  | - data.fluid.io |
|  |  | resources: |
| Expand Down  Expand Up | | @@ -38,9 +81,7 @@ rules: |
|  |  | - apiGroups: |
|  |  | - "" |
|  |  | resources: |
|  |  | - secrets |
|  |  | - configmaps |
|  |  | - events |
|  |  | verbs: |
|  |  | - get |
|  |  | - create |
| Expand All | | @@ -56,12 +97,6 @@ rules: |
|  |  | - get |
|  |  | - list |
|  |  | - watch |
|  |  | - apiGroups: |
|  |  | - coordination.k8s.io |
|  |  | resources: |
|  |  | - leases |
|  |  | verbs: |
|  |  | - '\*' |
|  |  | --- |
|  |  | apiVersion: rbac.authorization.k8s.io/v1 |
|  |  | kind: ClusterRoleBinding |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[charts/fluid/fluid/templates/webhook/webhook.yaml](#diff-4a143455cef213ba86bc6e01ad655b1a4d2c6d249f5ef9500f47ab06e5f23f27 "charts/fluid/fluid/templates/webhook/webhook.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/charts/fluid/fluid/templates/webhook/webhook.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,8 @@ spec: |
|  |  | labels: |
|  |  | control-plane: fluid-webhook |
|  |  | spec: |
|  |  | tolerations: |
|  |  | - operator: Exists |
|  |  | {{- with .Values.image.imagePullSecrets }} |
|  |  | imagePullSecrets: |
|  |  | {{- toYaml . | nindent 8 }} |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[charts/fluid/fluid/values.yaml](#diff-0d9539a874c2bd72724e132812f4ec71417c7a37703546a411c1bab4820f9928 "charts/fluid/fluid/values.yaml")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/charts/fluid/fluid/values.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,6 +26,8 @@ csi: |
|  |  | plugins: |
|  |  | image: fluidcloudnative/fluid-csi:v0.9.0-085b23e |
|  |  | kubelet: |
|  |  | kubeConfigFile: /etc/kubernetes/kubelet.conf |
|  |  | certDir: /var/lib/kubelet/pki |
|  |  | rootDir: /var/lib/kubelet |
|  |  | pruneFs: fuse.alluxio-fuse,fuse.jindofs-fuse,fuse.juicefs,fuse.goosefs-fuse,ossfs,alifuse.aliyun-alinas-efc |
|  |  |  |
| Expand Down | |  |

23 changes: 13 additions & 10 deletions

23
[cmd/csi/app/csi.go](#diff-d045d754805a287a19ad40feb0be143ee97f7e06118e06bb41e561f2c4c7bf60 "cmd/csi/app/csi.go")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/cmd/csi/app/csi.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,12 +39,13 @@ import ( |
|  |  | ) |
|  |  |  |
|  |  | var ( |
|  |  | endpoint string |
|  |  | nodeID string |
|  |  | metricsAddr string |
|  |  | pprofAddr string |
|  |  | pruneFs []string |
|  |  | prunePath string |
|  |  | endpoint string |
|  |  | nodeID string |
|  |  | metricsAddr string |
|  |  | pprofAddr string |
|  |  | pruneFs []string |
|  |  | prunePath string |
|  |  | kubeletKubeConfigPath string |
|  |  | ) |
|  |  |  |
|  |  | var scheme = runtime.NewScheme() |
| Expand Down  Expand Up | | @@ -81,6 +82,7 @@ func init() { |
|  |  | startCmd.Flags().StringVarP(&prunePath, "prune-path", "", "/runtime-mnt", "Prune path to add in /etc/updatedb.conf") |
|  |  | startCmd.Flags().StringVarP(&metricsAddr, "metrics-addr", "", ":8080", "The address the metrics endpoint binds to.") |
|  |  | startCmd.Flags().StringVarP(&pprofAddr, "pprof-addr", "", "", "The address for pprof to use while exporting profiling results") |
|  |  | startCmd.Flags().StringVarP(&kubeletKubeConfigPath, "kubelet-kube-config", "", "/etc/kubernetes/kubelet.conf", "The file path to kubelet kube config") |
|  |  | utilfeature.DefaultMutableFeatureGate.AddFlag(startCmd.Flags()) |
|  |  | startCmd.Flags().AddGoFlagSet(flag.CommandLine) |
|  |  | } |
| Expand Down  Expand Up | | @@ -109,10 +111,11 @@ func handle() { |
|  |  | } |
|  |  |  |
|  |  | config := config.Config{ |
|  |  | NodeId: nodeID, |
|  |  | Endpoint: endpoint, |
|  |  | PruneFs: pruneFs, |
|  |  | PrunePath: prunePath, |
|  |  | NodeId: nodeID, |
|  |  | Endpoint: endpoint, |
|  |  | PruneFs: pruneFs, |
|  |  | PrunePath: prunePath, |
|  |  | KubeletConfigPath: kubeletKubeConfigPath, |
|  |  | } |
|  |  |  |
|  |  | if err = csi.SetupWithManager(mgr, config); err != nil { |
| Expand Down | |  |

9 changes: 5 additions & 4 deletions

9
[pkg/csi/config/config.go](#diff-0fbefccf47d7729cf86ebeb23cc5efbd9c970ccb9911ff746453daabfafa545d "pkg/csi/config/config.go")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/pkg/csi/config/config.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,8 +17,9 @@ limitations under the License. |
|  |  | package config |
|  |  |  |
|  |  | type Config struct { |
|  |  | NodeId string |
|  |  | Endpoint string |
|  |  | PruneFs []string |
|  |  | PrunePath string |
|  |  | NodeId string |
|  |  | Endpoint string |
|  |  | PruneFs []string |
|  |  | PrunePath string |
|  |  | KubeletConfigPath string |
|  |  | } |

32 changes: 18 additions & 14 deletions

32
[pkg/csi/plugins/driver.go](#diff-3f76f48901d61a09a644daf5e3688387ec7e2d2a8e136305d66215219cb4476e "pkg/csi/plugins/driver.go")

Show comments

[View file](/fluid-cloudnative/fluid/blob/77c8110a3d1ec077ae2bce6bd88d296505db1550/pkg/csi/plugins/driver.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,7 @@ import ( |
|  |  | "path/filepath" |
|  |  | "strings" |
|  |  |  |
|  |  | "k8s.io/client-go/kubernetes" |
|  |  | "sigs.k8s.io/controller-runtime/pkg/client" |
|  |  | "sigs.k8s.io/controller-runtime/pkg/manager" |
|  |  |  |
| Expand All | | @@ -38,15 +39,16 @@ const ( |
|  |  | ) |
|  |  |  |
|  |  | type driver struct { |
|  |  | client client.Client |
|  |  | apiReader client.Reader |
|  |  | csiDriver \*csicommon.CSIDriver |
|  |  | nodeId, endpoint string |
|  |  | client client.Client |
|  |  | apiReader client.Reader |
|  |  | nodeAuthorizedClient \*kubernetes.Clientset |
|  |  | csiDriver \*csicommon.CSIDriver |
|  |  | nodeId, endpoint string |
|  |  | } |
|  |  |  |
|  |  | var \_ manager.Runnable = &driver{} |
|  |  |  |
|  |  | func NewDriver(nodeID, endpoint string, client client.Client, apiReader client.Reader) \*driver { |
|  |  | func NewDriver(nodeID, endpoint string, client client.Client, apiReader client.Reader, nodeAuthorizedClient \*kubernetes.Clientset) \*driver { |
|  |  | glog.Infof("Driver: %v version: %v", driverName, version) |
|  |  |  |
|  |  | proto, addr := utils.SplitSchemaAddr(endpoint) |
| Expand All | | @@ -68,11 +70,12 @@ func NewDriver(nodeID, endpoint string, client client.Client, apiReader client.R |
|  |  | csiDriver.AddVolumeCapabilityAccessModes([]csi.VolumeCapability\_AccessMode\_Mode{csi.VolumeCapability\_AccessMode\_MULTI\_NODE\_MULTI\_WRITER}) |
|  |  |  |
|  |  | return &driver{ |
|  |  | nodeId: nodeID, |
|  |  | endpoint: endpoint, |
|  |  | csiDriver: csiDriver, |
|  |  | client: client, |
|  |  | apiReader: apiReader, |
|  |  | nodeId: nodeID, |
|  |  | endpoint: endpoint, |
|  |  | csiDriver: csiDriver, |
|  |  | client: client, |
|  |  | nodeAuthorizedClient: nodeAuthorizedClient, |
|  |  | apiReader: apiReader, |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand All | | @@ -84,10 +87,11 @@ func (d \*driver) newControllerServer() \*controllerServer { |
|  |  |  |
|  |  | func (d \*driver) newNodeServer() \*nodeServer { |
|  |  | return &nodeServer{ |
|  |  | nodeId: d.nodeId, |
|  |  | DefaultNodeServer: csicommon.NewDefaultNodeServer(d.csiDriver), |
|  |  | client: d.client, |
|  |  | apiReader: d.apiReader, |
|  |  | nodeId: d.nodeId, |
|  |  | DefaultNodeServer: csicommon.NewDefaultNodeServer(d.csiDriver), |
|  |  | client: d.client, |
|  |  | apiReader: d.apiReader, |
|  |  | nodeAuthorizedClient: d.nodeAuthorizedClient, |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `77c8110`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fcommit%2F77c8110a3d1ec077ae2bce6bd88d296505db1550) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9016a322_20250114_223359.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fsecurity%2Fadvisories%2FGHSA-93xx-cvmc-9w3v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Fsecurity%2Fadvisories%2FGHSA-93xx-cvmc-9w3v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=fluid-cloudnative%2Ffluid)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fluid-cloudnative](/fluid-cloudnative)
/
**[fluid](/fluid-cloudnative/fluid)**
Public

generated from [kubernetes/kubernetes-template-project](/kubernetes/kubernetes-template-project)

* [Notifications](/login?return_to=%2Ffluid-cloudnative%2Ffluid) You must be signed in to change notification settings
* [Fork
  960](/login?return_to=%2Ffluid-cloudnative%2Ffluid)
* [Star
   1.7k](/login?return_to=%2Ffluid-cloudnative%2Ffluid)

* [Code](/fluid-cloudnative/fluid)
* [Issues
  233](/fluid-cloudnative/fluid/issues)
* [Pull requests
  33](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects
  0](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

Additional navigation options

* [Code](/fluid-cloudnative/fluid)
* [Issues](/fluid-cloudnative/fluid/issues)
* [Pull requests](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

# On a compromised node, the fluid-csi service account can be used to modify node specs

Moderate

[cheyang](/cheyang)
published
GHSA-93xx-cvmc-9w3v
May 8, 2023

## Package

charts/fluid/fluid/templates/role/csi/rbac.yaml
(Kubernetes)

## Affected versions

< 0.8.6, >= 0.7.0

## Patched versions

0.8.6

## Description

### Impact

If a malicious user gains control of a Kubernetes node running fluid csi pod (controlled by the `csi-nodeplugin-fluid` node-daemonset), he/she can leverage the fluid-csi service account to modify specs of all the nodes in the cluster. However, since this service account lacks "list node" permissions, the attacker may need to use other techniques to identify vulnerable nodes.

Once the attacker identifies and modifies the node specs, he/she can manipulate system-level-privileged components to access all secrets in the cluster or execute pods on other nodes. This allows he/she to elevate privileges beyond the compromised node and potentially gain full privileged access to the whole cluster.

To exploit this vulnerability, the attacker can make all other nodes unschedulable (for example, patch node with taints) and wait for system-critical components with high privilege to appear on the compromised node. However, this attack requires two prerequisites: a compromised node and identifying all vulnerable nodes through other means. Additionally, since the attack is passive and requires patience and luck, the severity of this finding is considered medium.

### Patches

For users who're using version < 0.8.6, >= 0.7.0, upgrade to v0.8.6.

### Workarounds

Delete the `csi-nodeplugin-fluid` daemonset in `fluid-system` namespace and avoid using CSI mode to mount FUSE file systems. Alternatively using sidecar mode to mount FUSE file systems is recommended. Refer to [the doc](https://github.com/fluid-cloudnative/fluid/blob/master/docs/en/samples/knative.md) to get a full example of how to use sidecar mode.

### References

Fixed by [Fix rbacs and limit CSI Plugin's node related access](https://github.com/fluid-cloudnative/fluid/commit/77c8110a3d1ec077ae2bce6bd88d296505db1550)

### Credits

Special thanks to the discoverers of this issue:

Nanzi Yang (nzyang@stu.xidian.edu.cn)

### Severity

Moderate

4.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
High

Privileges required
High

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:H/I:N/A:N

### CVE ID

CVE-2023-30840

### Weaknesses

[CWE-863](/advisories?query=cwe%3A863)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c97b677e_20250114_223358.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Freleases%2Ftag%2Fv0.8.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffluid-cloudnative%2Ffluid%2Freleases%2Ftag%2Fv0.8.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=fluid-cloudnative%2Ffluid)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fluid-cloudnative](/fluid-cloudnative)
/
**[fluid](/fluid-cloudnative/fluid)**
Public

generated from [kubernetes/kubernetes-template-project](/kubernetes/kubernetes-template-project)

* [Notifications](/login?return_to=%2Ffluid-cloudnative%2Ffluid) You must be signed in to change notification settings
* [Fork
  960](/login?return_to=%2Ffluid-cloudnative%2Ffluid)
* [Star
   1.7k](/login?return_to=%2Ffluid-cloudnative%2Ffluid)

* [Code](/fluid-cloudnative/fluid/tree/v0.8.6)
* [Issues
  233](/fluid-cloudnative/fluid/issues)
* [Pull requests
  33](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects
  0](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

Additional navigation options

* [Code](/fluid-cloudnative/fluid/tree/v0.8.6)
* [Issues](/fluid-cloudnative/fluid/issues)
* [Pull requests](/fluid-cloudnative/fluid/pulls)
* [Actions](/fluid-cloudnative/fluid/actions)
* [Projects](/fluid-cloudnative/fluid/projects)
* [Security](/fluid-cloudnative/fluid/security)
* [Insights](/fluid-cloudnative/fluid/pulse)

1. [Releases](/fluid-cloudnative/fluid/releases)
2. [v0.8.6](/fluid-cloudnative/fluid/releases/tag/v0.8.6)

# v0.8.6

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/fluid-cloudnative/fluid/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.8.6)

 Loading

[View all tags](/fluid-cloudnative/fluid/tags)

![@cheyang](https://avatars.githubusercontent.com/u/3724388?s=40&v=4)
[cheyang](/cheyang)
released this
08 May 06:53

·
[1483 commits](/fluid-cloudnative/fluid/compare/v0.8.6...master)
to master
since this release

[v0.8.6](/fluid-cloudnative/fluid/tree/v0.8.6)

[`91c05c3`](/fluid-cloudnative/fluid/commit/91c05c32db131997b5ca065e869c9918a125c149)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## What's Changed

* Add approvers for release 0.8 by [@cheyang](https://github.com/cheyang) in [#2864](https://github.com/fluid-cloudnative/fluid/pull/2864)
* Update fluid version to 0.8.6 by [@cheyang](https://github.com/cheyang) in [#2843](https://github.com/fluid-cloudnative/fluid/pull/2843)
* add reinvocationPolicy by [@cheyang](https://github.com/cheyang) in [#3047](https://github.com/fluid-cloudnative/fluid/pull/3047)
* Cherry-pick fix worker volumes in alluxio chart ([#2330](https://github.com/fluid-cloudnative/fluid/pull/2330)) by [@wangshli](https://github.com/wangshli) in [#3191](https://github.com/fluid-cloudnative/fluid/pull/3191)
* Fix rbacs and limit CSI Plugin's node related access by [@TrafalgarZZZ](https://github.com/TrafalgarZZZ)

**Full Changelog**: [v0.8.5...v0.8.6](https://github.com/fluid-cloudnative/fluid/compare/v0.8.5...v0.8.6)

### Contributors

* [![@cheyang](https://avatars.githubusercontent.com/u/3724388?s=64&v=4)](https://github.com/cheyang)
* [![@TrafalgarZZZ](https://avatars.githubusercontent.com/u/14257111?s=64&v=4)](https://github.com/TrafalgarZZZ)
* [![@wangshli](https://avatars.githubusercontent.com/u/89928606?s=64&v=4)](https://github.com/wangshli)

cheyang, TrafalgarZZZ, and wangshli

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


