=== Content from github.com_ec980230_20250114_211753.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetal3-io%2Fbaremetal-operator%2Fpull%2F1241)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetal3-io%2Fbaremetal-operator%2Fpull%2F1241)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=metal3-io%2Fbaremetal-operator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[metal3-io](/metal3-io)
/
**[baremetal-operator](/metal3-io/baremetal-operator)**
Public

* [Notifications](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator) You must be signed in to change notification settings
* [Fork
  258](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator)
* [Star
   604](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator)

* [Code](/metal3-io/baremetal-operator)
* [Issues
  47](/metal3-io/baremetal-operator/issues)
* [Pull requests
  9](/metal3-io/baremetal-operator/pulls)
* [Discussions](/metal3-io/baremetal-operator/discussions)
* [Actions](/metal3-io/baremetal-operator/actions)
* [Projects
  1](/metal3-io/baremetal-operator/projects)
* [Security](/metal3-io/baremetal-operator/security)
* [Insights](/metal3-io/baremetal-operator/pulse)

Additional navigation options

* [Code](/metal3-io/baremetal-operator)
* [Issues](/metal3-io/baremetal-operator/issues)
* [Pull requests](/metal3-io/baremetal-operator/pulls)
* [Discussions](/metal3-io/baremetal-operator/discussions)
* [Actions](/metal3-io/baremetal-operator/actions)
* [Projects](/metal3-io/baremetal-operator/projects)
* [Security](/metal3-io/baremetal-operator/security)
* [Insights](/metal3-io/baremetal-operator/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmetal3-io%2Fbaremetal-operator%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# ‚ö†Ô∏è Store htpasswd files in Secrets instead of ConfigMaps #1241

 Merged

[metal3-io-bot](/metal3-io-bot)
merged 1 commit into
[metal3-io:main](/metal3-io/baremetal-operator/tree/main "metal3-io/baremetal-operator:main")
from
[Nordix:lentzi90/secret-htpasswd](/Nordix/baremetal-operator/tree/lentzi90/secret-htpasswd "Nordix/baremetal-operator:lentzi90/secret-htpasswd")

Apr 14, 2023

 Merged

# [‚ö†Ô∏è Store htpasswd files in Secrets instead of ConfigMaps](#top) #1241

[metal3-io-bot](/metal3-io-bot)
merged 1 commit into
[metal3-io:main](/metal3-io/baremetal-operator/tree/main "metal3-io/baremetal-operator:main")
from
[Nordix:lentzi90/secret-htpasswd](/Nordix/baremetal-operator/tree/lentzi90/secret-htpasswd "Nordix/baremetal-operator:lentzi90/secret-htpasswd")

Apr 14, 2023

+5

‚àí7

[Conversation
14](/metal3-io/baremetal-operator/pull/1241)
[Commits
1](/metal3-io/baremetal-operator/pull/1241/commits)
[Checks
0](/metal3-io/baremetal-operator/pull/1241/checks)
[Files changed
3](/metal3-io/baremetal-operator/pull/1241/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![lentzi90](https://avatars.githubusercontent.com/u/9117693?s=60&v=4)](/lentzi90)

Copy link

Member

### @lentzi90 **[lentzi90](/lentzi90)** commented [Mar 29, 2023](#issue-1645227048) ‚Ä¢ edited Loading

**What this PR does / why we need it**:

The htpasswd files for Ironic and Inspector contains clear text usernames and hashed passwords so it is better to store them in Secrets.

Depending on how exactly Ironic is deployed this could be a breaking change that requires manual action from the user.

I have tested this with the [deploy.sh](https://github.com/metal3-io/baremetal-operator/blob/main/tools/deploy.sh) script and confirmed that it is working. Re-deploying Ironic, with the updated kustomization using the script, automatically creates the new Secrets and configures Ironic and Inspector to use them instead of the ConfigMaps.

Note that the ConfigMaps are **not** automatically removed. Ideally, the user should remove the ConfigMaps and change the credentials. The ConfigMaps in question are named `baremetal-operator-ironic-htpasswd-<random-hash>` and `baremetal-operator-ironic-inspector-htpasswd-<random-hash>` and are located in the `baremetal-operator-system` Namespace by default.

Note that if the credentials are changed, they must also be updated for BMO. This can be done in the same way by re-deploying using the script.

**Which issue(s) this PR fixes** *(optional, in `fixes #<issue number>(, fixes #<issue_number>, ...)` format, will close the issue(s) when PR gets merged)*:

Fixes #

## Steps for changing ConfigMap to Secret

Before you start, confirm if the environment is affected or not.

This can be done with the following commands:

```
kubectl -n baremetal-operator-system get deployments.apps baremetal-operator-ironic \
  -o jsonpath="{.spec.template.spec.containers[?(@.name == 'ironic-httpd')].envFrom}{'\n'}"
kubectl -n baremetal-operator-system get deployments.apps baremetal-operator-ironic \
  -o jsonpath="{.spec.template.spec.containers[?(@.name == 'ironic')].envFrom}{'\n'}"
kubectl -n baremetal-operator-system get deployments.apps baremetal-operator-ironic \
  -o jsonpath="{.spec.template.spec.containers[?(@.name == 'ironic-inspector')].envFrom}{'\n'}"
```

Affected environments would have `configMapRef`s for the htpasswd files in the output.

If it instead shows `secretRef`s for the htpasswd files it is not affected.

Start by listing the current ConfigMaps and Secrets for reference, so it is easy to check which are new and which are old later.

```
kubectl -n baremetal-operator-system get secrets > old-secrets.txt
kubectl -n baremetal-operator-system get configmaps > old-configmaps.txt
```

Generate new credentials and configuration files, for example like this:

```
IRONIC_USERNAME="$(tr -dc 'a-zA-Z0-9' < /dev/urandom | fold -w 12 | head -n 1)"
IRONIC_PASSWORD="$(tr -dc 'a-zA-Z0-9' < /dev/urandom | fold -w 12 | head -n 1)"
IRONIC_INSPECTOR_USERNAME="$(tr -dc 'a-zA-Z0-9' < /dev/urandom | fold -w 12 | head -n 1)"
IRONIC_INSPECTOR_PASSWORD="$(tr -dc 'a-zA-Z0-9' < /dev/urandom | fold -w 12 | head -n 1)"

echo "IRONIC_HTPASSWD=$(htpasswd -n -b -B "${IRONIC_USERNAME}" "${IRONIC_PASSWORD}")" > ironic-htpasswd
echo "INSPECTOR_HTPASSWD=$(htpasswd -n -b -B "${IRONIC_INSPECTOR_USERNAME}" \
        "${IRONIC_INSPECTOR_PASSWORD}")" > ironic-inspector-htpasswd

cat > ironic-auth-config <<-EOF
[ironic]
auth_type=http_basic
username=${IRONIC_USERNAME}
password=${IRONIC_PASSWORD}
EOF

cat > ironic-inspector-auth-config <<-EOF
[inspector]
auth_type=http_basic
username=${IRONIC_INSPECTOR_USERNAME}
password=${IRONIC_INSPECTOR_PASSWORD}
EOF
```

Create new secrets from htpasswd files, authentication configuration files and credentials for BareMetalOperator.

The exact names of these do not matter and the ones provided here are just examples.

```
# Htpasswd
kubectl -n baremetal-operator-system create secret generic baremetal-operator-ironic-htpasswd \
  --from-env-file=ironic-htpasswd
kubectl -n baremetal-operator-system create secret generic baremetal-operator-ironic-inspector-htpasswd \
  --from-env-file=ironic-inspector-htpasswd
# Auth config
kubectl -n baremetal-operator-system create secret generic baremetal-operator-ironic-auth-config \
  --from-file=auth-config=ironic-auth-config
kubectl -n baremetal-operator-system create secret generic baremetal-operator-ironic-inspector-auth-config \
  --from-file=auth-config=ironic-inspector-auth-config
# BMO credentials
kubectl -n baremetal-operator-system create secret generic ironic-credentials \
  --from-literal=username="${IRONIC_USERNAME}" --from-literal=password="${IRONIC_PASSWORD}"
kubectl -n baremetal-operator-system create secret generic ironic-inspector-credentials \
  --from-literal=username="${IRONIC_INSPECTOR_USERNAME}" --from-literal=password="${IRONIC_INSPECTOR_PASSWORD}"
```

Edit the Ironic Deployment to make it use the Secrets instead of the ConfigMaps.

Unfortunately, it is not easy to generate a fool proof patch (for `kubectl patch`) for this, since the `envFrom` field is an array.

It is only possible to replace the whole array or do index based replacements, which cannot really be used without knowing the exact details of the specific environment.

For this reason we only show the steps using `kubectl edit` instead of providing a patch that would likely not work for everyone.

Edit the Deployment with this command: `kubectl -n baremetal-operator-system edit deployment baremetal-operator-ironic`.

Note that the names of the ConfigMaps may differ depending on version and how it was deployed (e.g. the `baremetal-operator-` prefix may not be included in v0.1.2).

The order of the containers and other fields can also differ.

The necessary changes are described here:

```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: baremetal-operator-ironic
spec:
  template:
    spec:
      containers:
      # Only the containers ironic-httpd, ironic and ironic-inspector need changes
      - name: ironic-httpd
        envFrom:
        # Add the secretRefs like this
        - secretRef:
            name: baremetal-operator-ironic-htpasswd
        - secretRef:
            name: baremetal-operator-ironic-inspector-htpasswd
        # Remove these old configMapRefs
        - configMapRef:
            name: baremetal-operator-ironic-htpasswd-<random-hash>
        - configMapRef:
            name: baremetal-operator-ironic-inspector-htpasswd-<random-hash>
      - name: ironic
        envFrom:
        # Add the secretRef like this
        - secretRef:
            name: baremetal-operator-ironic-htpasswd
        # Remove the old configMapRef
        - configMapRef:
            name: baremetal-operator-ironic-htpasswd-<random-hash>
      - name: ironic-inspector
        envFrom:
        # Add the secretRef like this
        - secretRef:
            name: baremetal-operator-ironic-inspector-htpasswd
        # Remove the old configMapRef
        - configMapRef:
            name: baremetal-operator-ironic-inspector-htpasswd-<random-hash>
      volumes:
      # Change the secret name for the ironic-auth-config and ironic-inspector-auth-config
      # to match what was created earlier.
      - name: ironic-auth-config
        secret:
          defaultMode: 420
          secretName: baremetal-operator-ironic-auth-config
      - name: ironic-inspector-auth-config
        secret:
          defaultMode: 420
          secretName: baremetal-operator-ironic-inspector-auth-config

```

Now patch the BareMetalOperator Deployment to make use of the new credentials.

```
cat > patch.yaml <<-EOF
apiVersion: apps/v1
kind: Deployment
metadata:
  name: baremetal-operator-controller-manager
spec:
  template:
    spec:
      volumes:
      - name: ironic-credentials
        secret:
          defaultMode: 420
          secretName: ironic-credentials
      - name: ironic-inspector-credentials
        secret:
          defaultMode: 420
          secretName: ironic-inspector-credentials
EOF
kubectl -n baremetal-operator-system patch deployment baremetal-operator-controller-manager --patch-file=patch.yaml
```

Check that the new Pods become `Running` and then delete the old ConfigMaps and Secrets (optional).

```
# Check that the Pods become Running
kubectl -n baremetal-operator-system get pods
# Delete old ConfigMaps (check old-configmaps.txt if you are unsure)
kubectl -n baremetal-operator-system delete configmap baremetal-operator-ironic-htpasswd-<random-hash>
kubectl -n baremetal-operator-system delete configmap baremetal-operator-ironic-inspector-htpasswd-<random-hash>
# Delete old Secrets (check old-secrets.txt if you are unsure)
kubectl -n baremetal-operator-system delete secret baremetal-operator-ironic-auth-config-<random-hash>
kubectl -n baremetal-operator-system delete secret baremetal-operator-ironic-inspector-auth-config-<random-hash>
kubectl -n baremetal-operator-system delete secret ironic-credentials-<random-hash>
kubectl -n baremetal-operator-system delete secret ironic-inspector-credentials-<random-hash>
```

Confirm the fix by again checking the output of these commands:

```
kubectl -n baremetal-operator-system get deployments.apps baremetal-operator-ironic \
  -o jsonpath="{.spec.template.spec.containers[?(@.name == 'ironic-httpd')].envFrom}{'\n'}"
kubectl -n baremetal-operator-system get deployments.apps baremetal-operator-ironic \
  -o jsonpath="{.spec.template.spec.containers[?(@.name == 'ironic')].envFrom}{'\n'}"
kubectl -n baremetal-operator-system get deployments.apps baremetal-operator-ironic \
  -o jsonpath="{.spec.template.spec.containers[?(@.name == 'ironic-inspector')].envFrom}{'\n'}"
```

They should now show only `secretRef`s for htpasswd files.

Clean up temporary files:

```
rm patch.yaml
rm old-secrets.txt
rm old-configmaps.txt
shred -u ironic-htpasswd
shred -u ironic-inspector-htpasswd
shred -u ironic-auth-config
shred -u ironic-inspector-auth-config
```

Sorry, something went wrong.

All reactions

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=40&v=4)](/lentzi90)

`[Store htpasswd files in Secrets instead of ConfigMaps](/metal3-io/baremetal-operator/pull/1241/commits/a58a905cccd69284e13eda3db4da07ef2c707aad "Store htpasswd files in Secrets instead of ConfigMaps

The htpasswd files for Ironic and Inspector contains clear text
usernames and hashed passwords so it is better to store them in Secrets.

Depending on how exactly Ironic is deployed this could be a breaking
change that requires manual action from the user.
I have tested this with the
[deploy.sh](https://github.com/metal3-io/baremetal-operator/blob/main/tools/deploy.sh)
script and confirmed that it is working. Re-deploying Ironic, with the
updated kustomization using the script, automatically creates the new
Secrets and configures Ironic and Inspector to use them instead of the
ConfigMaps.

Note that the ConfigMaps are **not** automatically removed. Ideally, the
user should remove the ConfigMaps and change the credentials. The
ConfigMaps in question are named
`baremetal-operator-ironic-htpasswd-<random-hash>` and
`baremetal-operator-ironic-inspector-htpasswd-<random-hash>` and are
located in the `baremetal-operator-system` Namespace by default.

Note that if the credentials are changed, they must also be updated for
BMO. This can be done in the same way by re-deploying using the script.")`
 ‚Ä¶

`[a58a905](/metal3-io/baremetal-operator/pull/1241/commits/a58a905cccd69284e13eda3db4da07ef2c707aad)`

```
The htpasswd files for Ironic and Inspector contains clear text
usernames and hashed passwords so it is better to store them in Secrets.

Depending on how exactly Ironic is deployed this could be a breaking
change that requires manual action from the user.
I have tested this with the
[deploy.sh](<https://github.com/metal3-io/baremetal-operator/blob/main/tools/deploy.sh>)
script and confirmed that it is working. Re-deploying Ironic, with the
updated kustomization using the script, automatically creates the new
Secrets and configures Ironic and Inspector to use them instead of the
ConfigMaps.

Note that the ConfigMaps are **not** automatically removed. Ideally, the
user should remove the ConfigMaps and change the credentials. The
ConfigMaps in question are named
`baremetal-operator-ironic-htpasswd-<random-hash>` and
`baremetal-operator-ironic-inspector-htpasswd-<random-hash>` and are
located in the `baremetal-operator-system` Namespace by default.

Note that if the credentials are changed, they must also be updated for
BMO. This can be done in the same way by re-deploying using the script.
```

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
added
the
[size/S](/metal3-io/baremetal-operator/labels/size/S)
Denotes a PR that changes 10-29 lines, ignoring generated files.
label
[Mar 29, 2023](#event-8873065713)

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=80&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)

Copy link

Member

Author

### **[lentzi90](/lentzi90)** commented [Mar 29, 2023](#issuecomment-1488116437)

| /test-centos-e2e-integration-main /test-ubuntu-integration-main |
| --- |

All reactions

Sorry, something went wrong.

 [![@tuminoid](https://avatars.githubusercontent.com/u/853790?s=40&v=4)](/tuminoid)
[tuminoid](/tuminoid)
self-requested a review
[March 29, 2023 08:19](#event-8873325366)

[![@dtantsur](https://avatars.githubusercontent.com/u/531923?s=80&u=8c6ead79a17803b108562bf9a0570daffee40468&v=4)](/dtantsur)

Copy link

Member

### **[dtantsur](/dtantsur)** commented [Mar 29, 2023](#issuecomment-1488181121)

| /lgtm |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
added
the
[lgtm](/metal3-io/baremetal-operator/labels/lgtm)
Indicates that a PR is ready to be merged.
label
[Mar 29, 2023](#event-8873587924)

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=80&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)

Copy link

Member

Author

### **[lentzi90](/lentzi90)** commented [Mar 29, 2023](#issuecomment-1488697618)

| /hold Until I have time to test and document manual steps for patching a live environment. |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
added
the
[do-not-merge/hold](/metal3-io/baremetal-operator/labels/do-not-merge/hold)
Indicates that a PR should not merge because someone has issued a /hold command.
label
[Mar 29, 2023](#event-8877159785)

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=80&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)

Copy link

Member

Author

### **[lentzi90](/lentzi90)** commented [Mar 30, 2023](#issuecomment-1490027846)

| /hold cancel  I have added manual steps for live environments in the description. It is hard to make something fool proof without making too many assumptions, so it is unfortunately quite general. The users will need to adapt to their specific environments. |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
removed
the
[do-not-merge/hold](/metal3-io/baremetal-operator/labels/do-not-merge/hold)
Indicates that a PR should not merge because someone has issued a /hold command.
label
[Mar 30, 2023](#event-8885574511)

[![@tuminoid](https://avatars.githubusercontent.com/u/853790?s=80&v=4)](/tuminoid)

Copy link

Member

### **[tuminoid](/tuminoid)** commented [Mar 30, 2023](#issuecomment-1490070098)

| /hold cancel  I have added manual steps for live environments in the description. It is hard to make something fool proof without making too many assumptions, so it is unfortunately quite general. The users will need to adapt to their specific environments.  Thanks [@lentzi90](https://github.com/lentzi90), the steps are detailed enough and quite OK. Anyone installing BMO should be able to follow those. |
| --- |

 üëç
1
 lentzi90 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![tuminoid](https://avatars.githubusercontent.com/u/853790?s=60&v=4)](/tuminoid)

**[tuminoid](/tuminoid)**
approved these changes
[Mar 30, 2023](#pullrequestreview-1364816744)

 [View reviewed changes](/metal3-io/baremetal-operator/pull/1241/files/a58a905cccd69284e13eda3db4da07ef2c707aad)

Copy link

Member

### @tuminoid **[tuminoid](/tuminoid)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

/lgtm

Sorry, something went wrong.

All reactions

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=80&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)

Copy link

Member

Author

### **[lentzi90](/lentzi90)** commented [Apr 11, 2023](#issuecomment-1503964700)

| Prow/Tide test, please disregard /test unit |
| --- |

All reactions

Sorry, something went wrong.

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=80&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)

Copy link

Member

Author

### **[lentzi90](/lentzi90)** commented [Apr 11, 2023](#issuecomment-1503989622)

| /test unit |
| --- |

All reactions

Sorry, something went wrong.

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=80&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)

Copy link

Member

Author

### **[lentzi90](/lentzi90)** commented [Apr 13, 2023](#issuecomment-1506360519)

| [@kashifest](https://github.com/kashifest) [@zaneb](https://github.com/zaneb) [@dtantsur](https://github.com/dtantsur) please take a look when you have the time. |
| --- |

All reactions

Sorry, something went wrong.

 [![@tuminoid](https://avatars.githubusercontent.com/u/853790?s=40&v=4)](/tuminoid)
[tuminoid](/tuminoid)
requested review from
[dtantsur](/dtantsur),
[zaneb](/zaneb) and
[elfosardo](/elfosardo)
[April 13, 2023 05:23](#event-8992729248)

[![@kashifest](https://avatars.githubusercontent.com/u/52313821?s=80&u=b4b535b24a4b1e7e9d1b74ba06dfad44d3943fa2&v=4)](/kashifest)

Copy link

Member

### **[kashifest](/kashifest)** commented [Apr 13, 2023](#issuecomment-1506826382)

| /approve |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=80&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)

Copy link

Contributor

### **[metal3-io-bot](/metal3-io-bot)** commented [Apr 13, 2023](#issuecomment-1506826477)

| [APPROVALNOTIFIER] This PR is **APPROVED**  This pull-request has been approved by: *[kashifest](https://github.com/metal3-io/baremetal-operator/pull/1241#issuecomment-1506826382 "Approved")*, *[tuminoid](https://github.com/metal3-io/baremetal-operator/pull/1241#pullrequestreview-1364816744 "LGTM")*  The full list of commands accepted by this bot can be found [here](https://go.k8s.io/bot-commands?repo=metal3-io%2Fbaremetal-operator).  The pull request process is described [here](https://git.k8s.io/community/contributors/guide/owners.md#the-code-review-process)  Needs approval from an approver in each of these files:  * ~~[OWNERS](https://github.com/metal3-io/baremetal-operator/blob/main/OWNERS)~~ [kashifest]   Approvers can indicate their approval by writing `/approve` in a comment Approvers can cancel approval by writing `/approve cancel` in a comment |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
added
the
[approved](/metal3-io/baremetal-operator/labels/approved)
Indicates a PR has been approved by an approver from all required OWNERS files.
label
[Apr 13, 2023](#event-8995950433)

[![@kashifest](https://avatars.githubusercontent.com/u/52313821?s=80&u=b4b535b24a4b1e7e9d1b74ba06dfad44d3943fa2&v=4)](/kashifest)

Copy link

Member

### **[kashifest](/kashifest)** commented [Apr 13, 2023](#issuecomment-1506827106)

| /hold |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
added
the
[do-not-merge/hold](/metal3-io/baremetal-operator/labels/do-not-merge/hold)
Indicates that a PR should not merge because someone has issued a /hold command.
label
[Apr 13, 2023](#event-8995955477)

[![@kashifest](https://avatars.githubusercontent.com/u/52313821?s=80&u=b4b535b24a4b1e7e9d1b74ba06dfad44d3943fa2&v=4)](/kashifest)

Copy link

Member

### **[kashifest](/kashifest)** commented [Apr 13, 2023](#issuecomment-1506827783)

| Rerunning the tests since the previous runs were 2 weeks old. Unhold it when the tests pass. /test-centos-e2e-integration-main /test-ubuntu-integration-main |
| --- |

All reactions

Sorry, something went wrong.

[![@kashifest](https://avatars.githubusercontent.com/u/52313821?s=80&u=b4b535b24a4b1e7e9d1b74ba06dfad44d3943fa2&v=4)](/kashifest)

Copy link

Member

### **[kashifest](/kashifest)** commented [Apr 14, 2023](#issuecomment-1507964516)

| /hold cancel |
| --- |

All reactions

Sorry, something went wrong.

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
removed
the
[do-not-merge/hold](/metal3-io/baremetal-operator/labels/do-not-merge/hold)
Indicates that a PR should not merge because someone has issued a /hold command.
label
[Apr 14, 2023](#event-9003749623)

[![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=40&u=2a1945fe2f6851631999e6f481ea1e2b61d08461&v=4)](/metal3-io-bot)
[metal3-io-bot](/metal3-io-bot)
merged commit [`ae34635`](/metal3-io/baremetal-operator/commit/ae34635a1e038ff42333bb3c952f5b9bfe301b83)
into
metal3-io:main

[Apr 14, 2023](https://github.com/metal3-io/baremetal-operator/pull/1241#event-9003755963)

 [![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=40&u=21b22fb60ea54a66d0453203cea1d9643e43d8a2&v=4)](/lentzi90)
[lentzi90](/lentzi90)
deleted the
lentzi90/secret-htpasswd

branch
[April 14, 2023 06:29](#event-9003967722)

This was referenced Apr 26, 2023

[Add documentation how to configure BMO for single namespace
#1261](/metal3-io/baremetal-operator/issues/1261)

Open

[BMO pods are running among workloads
#1262](/metal3-io/baremetal-operator/issues/1262)

Open

[![@tuminoid](https://avatars.githubusercontent.com/u/853790?s=40&v=4)](/tuminoid)
[tuminoid](/tuminoid)
mentioned this pull request
[Apr 26, 2023](#ref-issue-1684915077)

[CAPM3 (capm3-system namespace pods) should not be running among workloads
metal3-io/cluster-api-provider-metal3#940](/metal3-io/cluster-api-provider-metal3/issues/940)

Open

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Apr 26, 2023](#ref-issue-1685636242)

[x/vulndb: potential Go vuln in github.com/metal3-io/baremetal-operator: CVE-2023-30841
golang/vulndb#1746](/golang/vulndb/issues/1746)

Closed

[![@ventifus](https://avatars.githubusercontent.com/u/44683696?s=40&v=4)](/ventifus)
[ventifus](/ventifus)
mentioned this pull request
[Oct 26, 2023](#ref-pullrequest-1964365902)

[[main] Update baremetal-operator to release-4.13
openshift/installer-aro-wrapper#73](/openshift/installer-aro-wrapper/pull/73)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetal3-io%2Fbaremetal-operator%2Fpull%2F1241)

Reviewers

[![@tuminoid](https://avatars.githubusercontent.com/u/853790?s=40&v=4)](/tuminoid) [tuminoid](/tuminoid)

tuminoid approved these changes

[![@dtantsur](https://avatars.githubusercontent.com/u/531923?s=40&v=4)](/dtantsur) [dtantsur](/dtantsur)

 Awaiting requested review from dtantsur

[![@zaneb](https://avatars.githubusercontent.com/u/842470?s=40&v=4)](/zaneb) [zaneb](/zaneb)

 Awaiting requested review from zaneb

[![@elfosardo](https://avatars.githubusercontent.com/u/13394161?s=40&v=4)](/elfosardo) [elfosardo](/elfosardo)

 Awaiting requested review from elfosardo

Assignees

No one assigned

Labels

[approved](/metal3-io/baremetal-operator/labels/approved)
Indicates a PR has been approved by an approver from all required OWNERS files.
[lgtm](/metal3-io/baremetal-operator/labels/lgtm)
Indicates that a PR is ready to be merged.
[size/S](/metal3-io/baremetal-operator/labels/size/S)
Denotes a PR that changes 10-29 lines, ignoring generated files.

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@lentzi90](https://avatars.githubusercontent.com/u/9117693?s=52&v=4)](/lentzi90) [![@dtantsur](https://avatars.githubusercontent.com/u/531923?s=52&v=4)](/dtantsur) [![@tuminoid](https://avatars.githubusercontent.com/u/853790?s=52&v=4)](/tuminoid) [![@kashifest](https://avatars.githubusercontent.com/u/52313821?s=52&v=4)](/kashifest) [![@metal3-io-bot](https://avatars.githubusercontent.com/u/55852648?s=52&v=4)](/metal3-io-bot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_54d30af4_20250114_211754.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetal3-io%2Fbaremetal-operator%2Fsecurity%2Fadvisories%2FGHSA-9wh7-397j-722m)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmetal3-io%2Fbaremetal-operator%2Fsecurity%2Fadvisories%2FGHSA-9wh7-397j-722m)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=metal3-io%2Fbaremetal-operator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[metal3-io](/metal3-io)
/
**[baremetal-operator](/metal3-io/baremetal-operator)**
Public

* [Notifications](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator) You must be signed in to change notification settings
* [Fork
  258](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator)
* [Star
   604](/login?return_to=%2Fmetal3-io%2Fbaremetal-operator)

* [Code](/metal3-io/baremetal-operator)
* [Issues
  47](/metal3-io/baremetal-operator/issues)
* [Pull requests
  9](/metal3-io/baremetal-operator/pulls)
* [Discussions](/metal3-io/baremetal-operator/discussions)
* [Actions](/metal3-io/baremetal-operator/actions)
* [Projects
  1](/metal3-io/baremetal-operator/projects)
* [Security](/metal3-io/baremetal-operator/security)
* [Insights](/metal3-io/baremetal-operator/pulse)

Additional navigation options

* [Code](/metal3-io/baremetal-operator)
* [Issues](/metal3-io/baremetal-operator/issues)
* [Pull requests](/metal3-io/baremetal-operator/pulls)
* [Discussions](/metal3-io/baremetal-operator/discussions)
* [Actions](/metal3-io/baremetal-operator/actions)
* [Projects](/metal3-io/baremetal-operator/projects)
* [Security](/metal3-io/baremetal-operator/security)
* [Insights](/metal3-io/baremetal-operator/pulse)

# Ironic and ironic-inspector may expose htpasswd files as ConfigMaps

Moderate

[tuminoid](/tuminoid)
published
GHSA-9wh7-397j-722m
Apr 26, 2023

## Package

baremetal-operator

## Affected versions

< 0.3.0

## Patched versions

0.3.0

## Description

### Impact

Ironic and ironic-inspector deployed within Baremetal Operator using the included `deploy.sh` store their `.htpasswd` files as ConfigMaps instead of Secrets. This causes the plain-text username and hashed password to be readable by anyone having a cluster-wide read-access to the management cluster, or access to the management cluster's Etcd storage.

### Patches

This issue is patched in [baremetal-operator PR#1241](https://github.com/metal3-io/baremetal-operator/pull/1241), and is included in BMO release 0.3.0 onwards.

### Workarounds

User may modify the kustomizations and redeploy the BMO, or recreate the required ConfigMaps as Secrets per instructions in [baremetal-operator PR#1241](https://github.com/metal3-io/baremetal-operator/pull/1241)

### References

[baremetal-operator PR#1241](https://github.com/metal3-io/baremetal-operator/pull/1241)

### Severity

Moderate

6.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Changed

Confidentiality
None

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:H/A:N

### CVE ID

CVE-2023-30841

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


