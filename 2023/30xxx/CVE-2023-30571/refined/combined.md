=== Content from github.com_d9015662_20250115_113329.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cw7x-3mv7-w6xm)

**CVE-2023-30571**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-cw7x-3mv7-w6xm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2023-30571](/advisories/GHSA-cw7x-3mv7-w6xm)

## Libarchive through 3.6.2 can cause directories to have...

Moderate severity

Unreviewed

Published
May 29, 2023
to the GitHub Advisory Database
•
Updated Apr 11, 2024

## Package

No package listed—
[Suggest a package](/advisories/GHSA-cw7x-3mv7-w6xm/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Libarchive through 3.6.2 can cause directories to have world-writable permissions. The umask() call inside archive\_write\_disk\_posix.c changes the umask of the whole process for a very short period of time; a race condition with another thread can lead to a permanent umask 0 setting. Such a race condition could lead to implicit directory creation with permissions 0777 (without the sticky bit), which means that any low-privileged local user can delete and rename files inside those directories.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2023-30571>
* [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
* <https://groups.google.com/g/libarchive-announce>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2023-30571)
May 29, 2023

Published to the GitHub Advisory Database
May 29, 2023

Last updated
Apr 11, 2024

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.042%
 (5th percentile)

### Weaknesses

[CWE-362](/advisories?query=cwe%3A362)

### CVE ID

CVE-2023-30571

### GHSA ID

GHSA-cw7x-3mv7-w6xm

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-cw7x-3mv7-w6xm/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from groups.google.com_c1296abe_20250114_185403.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## libarchive-announce

[Conversations](./g/libarchive-announce)[About](./g/libarchive-announce/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# libarchive-announce

Contact owners and managers1–19 of 19Mark all as readReport group0 selected![mar...@matuska.org's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVk1T2FPfwqyIxEcVQt05B_JcnxjUfkIZ7xhKrK7YpwOd95kQ=s28-c)[mar...@matuska.org](./g/libarchive-announce/c/ZDHZik6kjwY)8/23/21[libarchive 3.5.2 releasedLibarchive 3.5.2 is a feature and security release. Source release: https://libarchive.org/downloads/](./g/libarchive-announce/c/ZDHZik6kjwY)unread,[libarchive 3.5.2 releasedLibarchive 3.5.2 is a feature and security release. Source release: https://libarchive.org/downloads/](./g/libarchive-announce/c/ZDHZik6kjwY)8/23/21![mar...@matuska.org's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVk1T2FPfwqyIxEcVQt05B_JcnxjUfkIZ7xhKrK7YpwOd95kQ=s28-c)[mar...@matuska.org](./g/libarchive-announce/c/QrjvI6YmnfU)12/26/20[libarchive 3.5.1 releasedLibarchive 3.5.1 is now available at: https://libarchive.org/downloads/libarchive-3.5.1.tar.xz https:](./g/libarchive-announce/c/QrjvI6YmnfU)unread,[libarchive 3.5.1 releasedLibarchive 3.5.1 is now available at: https://libarchive.org/downloads/libarchive-3.5.1.tar.xz https:](./g/libarchive-announce/c/QrjvI6YmnfU)12/26/20![Martin Matuska's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVk1T2FPfwqyIxEcVQt05B_JcnxjUfkIZ7xhKrK7YpwOd95kQ=s28-c)[Martin Matuska](./g/libarchive-announce/c/MeLQzRqewqY)5/21/20[libarchive 3.4.3 releasedLibarchive 3.4.3 is now available at: https://libarchive.org/downloads/libarchive-3.4.3.tar.xz https:](./g/libarchive-announce/c/MeLQzRqewqY)unread,[libarchive 3.4.3 releasedLibarchive 3.4.3 is now available at: https://libarchive.org/downloads/libarchive-3.4.3.tar.xz https:](./g/libarchive-announce/c/MeLQzRqewqY)5/21/20![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/YjwfQUHOy_w)12/23/17[bsdtar on Windows!Thought folks might find this interesting: bsdtar is now the standard tar implementation for the](./g/libarchive-announce/c/YjwfQUHOy_w)unread,[bsdtar on Windows!Thought folks might find this interesting: bsdtar is now the standard tar implementation for the](./g/libarchive-announce/c/YjwfQUHOy_w)12/23/17![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/y0IEjnplpcM)3/2/17[Libarchive 3.3.1 feature and security releaseLibarchive 3.3.1 is now available at https://libarchive.org/downloads/libarchive-3.3.1.tar.gz https:/](./g/libarchive-announce/c/y0IEjnplpcM)unread,[Libarchive 3.3.1 feature and security releaseLibarchive 3.3.1 is now available at https://libarchive.org/downloads/libarchive-3.3.1.tar.gz https:/](./g/libarchive-announce/c/y0IEjnplpcM)3/2/17![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/lyaOLoBI1Fs)6/20/16[Libarchive 3.2.1 Security ReleaseLibarchive 3.2.1 is now available at https://libarchive.org/downloads/libarchive-3.2.1.tar.gz](./g/libarchive-announce/c/lyaOLoBI1Fs)unread,[Libarchive 3.2.1 Security ReleaseLibarchive 3.2.1 is now available at https://libarchive.org/downloads/libarchive-3.2.1.tar.gz](./g/libarchive-announce/c/lyaOLoBI1Fs)6/20/16![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle2](./g/libarchive-announce/c/qdeGf_DRvN4)5/1/16[Libarchive 3.2.0 releasedRevised: I omitted the download link in the initial announcement email. Libarchive 3.2.0 is a feature](./g/libarchive-announce/c/qdeGf_DRvN4)unread,[Libarchive 3.2.0 releasedRevised: I omitted the download link in the initial announcement email. Libarchive 3.2.0 is a feature](./g/libarchive-announce/c/qdeGf_DRvN4)5/1/16![Andres Mejia's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXsMpPJCdmx4wcWtmt5DCUuf5A7pLEEmU6908EauYFAsy8WVZw=s28-c)[Andres Mejia](./g/libarchive-announce/c/_jbIbpPwxTI)2/9/13[Libarchive 3.1.2 ReleasedLibarchive 3.1.2 is now available. http://www.libarchive.org/downloads/libarchive-3.1.2.tar.gz http:/](./g/libarchive-announce/c/_jbIbpPwxTI)unread,[Libarchive 3.1.2 ReleasedLibarchive 3.1.2 is now available. http://www.libarchive.org/downloads/libarchive-3.1.2.tar.gz http:/](./g/libarchive-announce/c/_jbIbpPwxTI)2/9/13![Andres Mejia's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXsMpPJCdmx4wcWtmt5DCUuf5A7pLEEmU6908EauYFAsy8WVZw=s28-c)[Andres Mejia](./g/libarchive-announce/c/qi6Ptrmylr8)1/14/13[Libarchive 3.1.1 ReleasedLibarchive 3.1.1 is now available. https://github.com/libarchive/libarchive/tree/v3.1.1 This is a](./g/libarchive-announce/c/qi6Ptrmylr8)unread,[Libarchive 3.1.1 ReleasedLibarchive 3.1.1 is now available. https://github.com/libarchive/libarchive/tree/v3.1.1 This is a](./g/libarchive-announce/c/qi6Ptrmylr8)1/14/13![Andres Mejia's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXsMpPJCdmx4wcWtmt5DCUuf5A7pLEEmU6908EauYFAsy8WVZw=s28-c)[Andres Mejia](./g/libarchive-announce/c/W2_Afs0-VrY)1/14/13[Libarchive 3.1 ReleasedLibarchive 3.1.0 is now available. https://github.com/libarchive/libarchive/tree/v3.1.0 There has](./g/libarchive-announce/c/W2_Afs0-VrY)unread,[Libarchive 3.1 ReleasedLibarchive 3.1.0 is now available. https://github.com/libarchive/libarchive/tree/v3.1.0 There has](./g/libarchive-announce/c/W2_Afs0-VrY)1/14/13![Andres Mejia's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXsMpPJCdmx4wcWtmt5DCUuf5A7pLEEmU6908EauYFAsy8WVZw=s28-c)[Andres Mejia](./g/libarchive-announce/c/3H_jjtdy7Zk)2/25/12[libarchive Migration to Gitlibarchive has been converted to git. All further development of libarchive is now done via git from](./g/libarchive-announce/c/3H_jjtdy7Zk)unread,[libarchive Migration to Gitlibarchive has been converted to git. All further development of libarchive is now done via git from](./g/libarchive-announce/c/3H_jjtdy7Zk)2/25/12![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/goqfRK7bsJE)1/13/12[Libarchive 3.0 AvailableLibarchive 3.0 is now available from http://libarchive.googlecode.com/ The major version change](./g/libarchive-announce/c/goqfRK7bsJE)unread,[Libarchive 3.0 AvailableLibarchive 3.0 is now available from http://libarchive.googlecode.com/ The major version change](./g/libarchive-announce/c/goqfRK7bsJE)1/13/12![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/gGcRslHICis)9/3/11[Libarchive 2.8.5 availableLibarchive 2.8.5 is the latest release in the libarchive 2.8 branch. This includes a number of bug](./g/libarchive-announce/c/gGcRslHICis)unread,[Libarchive 2.8.5 availableLibarchive 2.8.5 is the latest release in the libarchive 2.8 branch. This includes a number of bug](./g/libarchive-announce/c/gGcRslHICis)9/3/11![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/9fw_c5gSYSM)2/5/10[libarchive 2.8.0 availableI've just posted the official libarchive 2.8.0 release at http://libarchive.googlecode.com/ This](./g/libarchive-announce/c/9fw_c5gSYSM)unread,[libarchive 2.8.0 availableI've just posted the official libarchive 2.8.0 release at http://libarchive.googlecode.com/ This](./g/libarchive-announce/c/9fw_c5gSYSM)2/5/10![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/4-7QnjUVMtE)4/16/09[Libarchive 2.7.0 ReleasedI'm pleased to announce that libarchive 2.7.0 is now ready for general use. It can be downloaded](./g/libarchive-announce/c/4-7QnjUVMtE)unread,[Libarchive 2.7.0 ReleasedI'm pleased to announce that libarchive 2.7.0 is now ready for general use. It can be downloaded](./g/libarchive-announce/c/4-7QnjUVMtE)4/16/09![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/gRi7e9IIgZQ)4/11/09[Libarchive 2.7 Release CandidateI've just posted libarchive-2.6.992a, which should be the final test release prior to the](./g/libarchive-announce/c/gRi7e9IIgZQ)unread,[Libarchive 2.7 Release CandidateI've just posted libarchive-2.6.992a, which should be the final test release prior to the](./g/libarchive-announce/c/gRi7e9IIgZQ)4/11/09![Tim Kientzle's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[Tim Kientzle](./g/libarchive-announce/c/DM10r7xwQ5g)2/27/09[libarchive 2.6.2 availableLibarchive 2.6.2 has a handful of point bug fixes since 2.6.1. You can download it from: http://code.](./g/libarchive-announce/c/DM10r7xwQ5g)unread,[libarchive 2.6.2 availableLibarchive 2.6.2 has a handful of point bug fixes since 2.6.1. You can download it from: http://code.](./g/libarchive-announce/c/DM10r7xwQ5g)2/27/09![kien...@gmail.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[kien...@gmail.com](./g/libarchive-announce/c/X13QeIfVRw0)2/18/09[A few updates...I'm expecting to cut the first libarchive 2.7 alpha releases in about a month. There's been](./g/libarchive-announce/c/X13QeIfVRw0)unread,[A few updates...I'm expecting to cut the first libarchive 2.7 alpha releases in about a month. There's been](./g/libarchive-announce/c/X13QeIfVRw0)2/18/09![kien...@gmail.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXIvhPfdeNvv8Y-p2dVFe2DNE6DKs1roNp1JPaL4XsB8ANzlw=s28-c)[kien...@gmail.com](./g/libarchive-announce/c/jJVDzmEcNO0)1/18/09[libarchive-2.6.1 availableLibarchive 2.6.1 is now available for download from http://libarchive.googlecode.com/ This is the](./g/libarchive-announce/c/jJVDzmEcNO0)unread,[libarchive-2.6.1 availableLibarchive 2.6.1 is now available for download from http://libarchive.googlecode.com/ This is the](./g/libarchive-announce/c/jJVDzmEcNO0)1/18/09

=== Content from github.com_e030072f_20250114_185400.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibarchive%2Flibarchive%2Fissues%2F1876)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibarchive%2Flibarchive%2Fissues%2F1876)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=libarchive%2Flibarchive)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libarchive](/libarchive)
/
**[libarchive](/libarchive/libarchive)**
Public

* [Notifications](/login?return_to=%2Flibarchive%2Flibarchive) You must be signed in to change notification settings
* [Fork
  776](/login?return_to=%2Flibarchive%2Flibarchive)
* [Star
   3.1k](/login?return_to=%2Flibarchive%2Flibarchive)

* [Code](/libarchive/libarchive)
* [Issues
  450](/libarchive/libarchive/issues)
* [Pull requests
  35](/libarchive/libarchive/pulls)
* [Actions](/libarchive/libarchive/actions)
* [Projects
  0](/libarchive/libarchive/projects)
* [Wiki](/libarchive/libarchive/wiki)
* [Security](/libarchive/libarchive/security)
* [Insights](/libarchive/libarchive/pulse)

Additional navigation options

* [Code](/libarchive/libarchive)
* [Issues](/libarchive/libarchive/issues)
* [Pull requests](/libarchive/libarchive/pulls)
* [Actions](/libarchive/libarchive/actions)
* [Projects](/libarchive/libarchive/projects)
* [Wiki](/libarchive/libarchive/wiki)
* [Security](/libarchive/libarchive/security)
* [Insights](/libarchive/libarchive/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flibarchive%2Flibarchive%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flibarchive%2Flibarchive%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Race condition in multi-threaded use of archive\_write\_disk\_header() on posix based systems #1876

Open

[xypiie](/xypiie) opened this issue
May 24, 2023
· 9 comments

Open

# [Race condition in multi-threaded use of archive\_write\_disk\_header() on posix based systems](#top) #1876

[xypiie](/xypiie) opened this issue
May 24, 2023
· 9 comments

## Comments

[![@xypiie](https://avatars.githubusercontent.com/u/6825615?s=80&u=af368c47127a655c398c0ac053b7a5732daf34a3&v=4)](/xypiie)

Copy link

### **[xypiie](/xypiie)** commented [May 24, 2023](#issue-1723439288)

| Summary the umask() call inside archive\_write\_disk\_posix.c changes the umask of the whole process for a very short period of time and race condition with other thread can lead to permanent umask 0 setting: \_archive\_write\_disk\_header(): umask(a->user\_umask = umask(0));  **process has umask of 027** **thread1** enters \_archive\_write\_disk\_header() **thread1**: prev\_umask = umask(0) -> returns 027 **thread1**: whole process has now umask of 0 **thread2** enters \_archive\_write\_disk\_header() **thread2**: prev\_umask = umask(0) -> returns 0 **thread1**: umask(prev\_umask) sets to 027 **thread2**: umask (prev\_umask) sets to 0 **whole process remains at umask of 0** Effects (vulnerability) Such race condition could lead to implicit directory creation with permissions 777 without sticky bit, which means any low privileged user on this system can delete and rename files inside those directories. This is a serious vulnerability on a multi-user system and admins might not even be aware of it. They probably need to scan their full rootfs for such directories to mitigate. ProposalsShort term: Adding info to README Adding information to README to make users aware to mutex this call: [#1875](https://github.com/libarchive/libarchive/pull/1875) Potential solution for Linux (>= 4.7) since linux kernel 4.7 rc1, the umask can be read from /proc fs without modifying it see: [torvalds/linux@3e42979](https://github.com/torvalds/linux/commit/3e42979e65dace1f9268dd5440e5ab096b8dee59)  Example: [getumask.c](https://piie.net/files/getumask.c) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@xypiie](https://avatars.githubusercontent.com/u/6825615?s=80&u=af368c47127a655c398c0ac053b7a5732daf34a3&v=4)](/xypiie)

Copy link

Author

### **[xypiie](/xypiie)** commented [May 30, 2023](#issuecomment-1568147227)

| [CVE-2023-30571](https://nvd.nist.gov/vuln/detail/CVE-2023-30571) has been assigned to this |
| --- |

All reactions

Sorry, something went wrong.

[![@dongsupark](https://avatars.githubusercontent.com/u/10096906?s=40&v=4)](/dongsupark)
[dongsupark](/dongsupark)
mentioned this issue
[Jun 2, 2023](#ref-issue-1737722802)

[update: libarchive
flatcar/Flatcar#1054](/flatcar/Flatcar/issues/1054)

Closed

[![@directionless](https://avatars.githubusercontent.com/u/179542?s=40&v=4)](/directionless)
[directionless](/directionless)
mentioned this issue
[Jun 20, 2023](#ref-pullrequest-1766002475)

[Ignore CVE-2023-30571
osquery/osquery#8065](/osquery/osquery/pull/8065)
 Merged

[![@ljavorsk](https://avatars.githubusercontent.com/u/52954689?s=80&u=d6967743997cf75bfeef88677fbf1073abf24578&v=4)](/ljavorsk)

Copy link

Contributor

### **[ljavorsk](/ljavorsk)** commented [Jun 27, 2023](#issuecomment-1609606314)

| Hi, is there any update on the issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@ljavorsk](https://avatars.githubusercontent.com/u/52954689?s=80&u=d6967743997cf75bfeef88677fbf1073abf24578&v=4)](/ljavorsk)

Copy link

Contributor

### **[ljavorsk](/ljavorsk)** commented [Jul 4, 2023](#issuecomment-1619649162)

| [@xypiie](https://github.com/xypiie) Could you please share more detail about your example? What it does do, what is expected behavior and what is current (faulty) behavior? Thank you so much |
| --- |

All reactions

Sorry, something went wrong.

[![@kientzle](https://avatars.githubusercontent.com/u/1398793?s=80&v=4)](/kientzle)

Copy link

Contributor

### **[kientzle](/kientzle)** commented [Jul 4, 2023](#issuecomment-1620434964)

| This issue arises if you are using multiple threads, each using libarchive to restore archive entries to disk. Note that libarchive has *never* officially supported this mode of use, primarily because libarchive relies on C library services that are not safe for multi-threaded use. Also note that `umask()` is not the only non-thread-safe function that libarchive relies on; fixing this issue would not be sufficient to support using libarchive from multiple threads simultaneously. |
| --- |

All reactions

Sorry, something went wrong.

[![@theta682](https://avatars.githubusercontent.com/u/1522049?s=80&v=4)](/theta682)

Copy link

Contributor

### **[theta682](/theta682)** commented [Jul 4, 2023](#issuecomment-1620743344)

| This issue arises if you are using multiple threads, each using libarchive to restore archive entries to disk. Note that libarchive has *never* officially supported this mode of use, primarily because libarchive relies on C library services that are not safe for multi-threaded use. Also note that `umask()` is not the only non-thread-safe function that libarchive relies on; fixing this issue would not be sufficient to support using libarchive from multiple threads simultaneously.  [#1875](https://github.com/libarchive/libarchive/pull/1875) proposes to make a statement in the README file. I agree that it must be documented properly. |
| --- |

All reactions

Sorry, something went wrong.

[![@xypiie](https://avatars.githubusercontent.com/u/6825615?s=80&u=af368c47127a655c398c0ac053b7a5732daf34a3&v=4)](/xypiie)

Copy link

Author

### **[xypiie](/xypiie)** commented [Jul 4, 2023](#issuecomment-1620772425)

| This issue arises if you are using multiple threads, each using libarchive to restore archive entries to disk. Note that libarchive has *never* officially supported this mode of use, primarily because libarchive relies on C library services that are not safe for multi-threaded use. Also note that `umask()` is not the only non-thread-safe function that libarchive relies on; fixing this issue would not be sufficient to support using libarchive from multiple threads simultaneously.  In the README, it's stated: "The library is generally thread safe depending on the platform..." and adds some limits / constraints to it, like mentioning the usage of `chdir()`, which could cause problems. From my point of view it's important to add information about the usage of the `umask()` calls as well, as this could even cause security issues. That's why I raised [#1875](https://github.com/libarchive/libarchive/pull/1875) and from my point of view, merging it would close the case as then the users are informed and can take care about mutexing this call on their own. Further possibility and efforts to provide a fix inside libarchive code it is up to libarchive team to decide. |
| --- |

All reactions

Sorry, something went wrong.

[![@kientzle](https://avatars.githubusercontent.com/u/1398793?s=80&v=4)](/kientzle)

Copy link

Contributor

### **[kientzle](/kientzle)** commented [Jul 9, 2023](#issuecomment-1627767567)

| Yeah, we should certainly clarify the documentation:   * The `archive_read` and `archive_write` core APIs are in fact generally thread safe, depending on how you implement the callbacks. * The `archive_read_disk` and `archive_write_disk` APIs are *not* generally thread safe. Writing a thread-safe version of these APIs would be an interesting project, if anyone wanted to take on that challenge. (Hint: `openat()` and related `*at()` APIs are probably essential components for implementing this on POSIX.) |
| --- |

All reactions

Sorry, something went wrong.

[halstead](/halstead)
pushed a commit
to yoctoproject/poky
that referenced
this issue
[Jul 30, 2023](#ref-commit-5dd5f0f)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@rpurdie](https://avatars.githubusercontent.com/u/1184070?s=40&v=4)](/rpurdie)

`[libarchive: ignore](/yoctoproject/poky/commit/5dd5f0f5348594a0b636ef05a87381b997db4fb5 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: 9b5b850d6a6982bb8ff14dcfbb6769b293638293)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[5dd5f0f](/yoctoproject/poky/commit/5dd5f0f5348594a0b636ef05a87381b997db4fb5)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: 9b5b850d6a6982bb8ff14dcfbb6769b293638293)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>
```

[halstead](/halstead)
pushed a commit
to openembedded/openembedded-core
that referenced
this issue
[Jul 30, 2023](#ref-commit-9b5b850)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@rpurdie](https://avatars.githubusercontent.com/u/1184070?s=40&v=4)](/rpurdie)

`[libarchive: ignore](/openembedded/openembedded-core/commit/9b5b850d6a6982bb8ff14dcfbb6769b293638293 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[9b5b850](/openembedded/openembedded-core/commit/9b5b850d6a6982bb8ff14dcfbb6769b293638293)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>
```

[halstead](/halstead)
pushed a commit
to openembedded/openembedded-core
that referenced
this issue
[Aug 7, 2023](#ref-commit-d5e7971)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@sakoman](https://avatars.githubusercontent.com/u/20076?s=40&v=4)](/sakoman)

`[libarchive: ignore](/openembedded/openembedded-core/commit/d5e7971e12cdc8748be91b4e6408b42fa86b2f15 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[d5e7971](/openembedded/openembedded-core/commit/d5e7971e12cdc8748be91b4e6408b42fa86b2f15)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[halstead](/halstead)
pushed a commit
to yoctoproject/poky
that referenced
this issue
[Aug 7, 2023](#ref-commit-cd329fc)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@sakoman](https://avatars.githubusercontent.com/u/20076?s=40&v=4)](/sakoman)

`[libarchive: ignore](/yoctoproject/poky/commit/cd329fc98420f69ec17aa8b619ed1e39f050db99 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: d5e7971e12cdc8748be91b4e6408b42fa86b2f15)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[cd329fc](/yoctoproject/poky/commit/cd329fc98420f69ec17aa8b619ed1e39f050db99)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: d5e7971e12cdc8748be91b4e6408b42fa86b2f15)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[jpuhlman](/jpuhlman)
pushed a commit
to MontaVista-OpenSourceTechnology/poky
that referenced
this issue
[Aug 9, 2023](#ref-commit-4988cfe)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@jpuhlman](https://avatars.githubusercontent.com/u/786636?s=40&v=4)](/jpuhlman)

`[libarchive: ignore](/MontaVista-OpenSourceTechnology/poky/commit/4988cfeb652df5ba24a534e502bda3a06fe7f348 "libarchive: ignore CVE-2023-30571

Source: poky
MR: 126575, 127628
Type: Security Fix
Disposition: Merged from poky
ChangeID: cd329fc98420f69ec17aa8b619ed1e39f050db99
Description:

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: d5e7971e12cdc8748be91b4e6408b42fa86b2f15)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Jeremy A. Puhlman <jpuhlman@mvista.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[4988cfe](/MontaVista-OpenSourceTechnology/poky/commit/4988cfeb652df5ba24a534e502bda3a06fe7f348)`

```
Source: poky
MR: 126575, 127628
Type: Security Fix
Disposition: Merged from poky
ChangeID: [cd329fc](https://github.com/MontaVista-OpenSourceTechnology/poky/commit/cd329fc98420f69ec17aa8b619ed1e39f050db99)
Description:

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: d5e7971e12cdc8748be91b4e6408b42fa86b2f15)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Jeremy A. Puhlman <jpuhlman@mvista.com>
```

[halstead](/halstead)
pushed a commit
to openembedded/openembedded-core
that referenced
this issue
[Aug 15, 2023](#ref-commit-ffa8f92)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@sakoman](https://avatars.githubusercontent.com/u/20076?s=40&v=4)](/sakoman)

`[libarchive: ignore](/openembedded/openembedded-core/commit/ffa8f92aa6f8405d8fea117af2f212ba190de393 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[ffa8f92](/openembedded/openembedded-core/commit/ffa8f92aa6f8405d8fea117af2f212ba190de393)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[halstead](/halstead)
pushed a commit
to yoctoproject/poky
that referenced
this issue
[Aug 15, 2023](#ref-commit-ba48855)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@sakoman](https://avatars.githubusercontent.com/u/20076?s=40&v=4)](/sakoman)

`[libarchive: ignore](/yoctoproject/poky/commit/ba4885546eb1352af2b1a75973c8ee68f190999c "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: ffa8f92aa6f8405d8fea117af2f212ba190de393)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[ba48855](/yoctoproject/poky/commit/ba4885546eb1352af2b1a75973c8ee68f190999c)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: ffa8f92aa6f8405d8fea117af2f212ba190de393)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[halstead](/halstead)
pushed a commit
to openembedded/openembedded-core
that referenced
this issue
[Aug 16, 2023](#ref-commit-9374e68)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@sakoman](https://avatars.githubusercontent.com/u/20076?s=40&v=4)](/sakoman)

`[libarchive: ignore](/openembedded/openembedded-core/commit/9374e680ae2376589a9bfe4565dfcf4dc9791aa8 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[9374e68](/openembedded/openembedded-core/commit/9374e680ae2376589a9bfe4565dfcf4dc9791aa8)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[halstead](/halstead)
pushed a commit
to yoctoproject/poky
that referenced
this issue
[Aug 16, 2023](#ref-commit-0de5f6a)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@sakoman](https://avatars.githubusercontent.com/u/20076?s=40&v=4)](/sakoman)

`[libarchive: ignore](/yoctoproject/poky/commit/0de5f6a27a794c915a2ef2483901ab915056d961 "libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: 9374e680ae2376589a9bfe4565dfcf4dc9791aa8)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[0de5f6a](/yoctoproject/poky/commit/0de5f6a27a794c915a2ef2483901ab915056d961)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: 9374e680ae2376589a9bfe4565dfcf4dc9791aa8)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
```

[jpuhlman](/jpuhlman)
pushed a commit
to MontaVista-OpenSourceTechnology/poky
that referenced
this issue
[Aug 23, 2023](#ref-commit-c97e7d9)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@jpuhlman](https://avatars.githubusercontent.com/u/786636?s=40&v=4)](/jpuhlman)

`[libarchive: ignore](/MontaVista-OpenSourceTechnology/poky/commit/c97e7d91c6ae862c3b9fb4066ce023c68b5ffc6d "libarchive: ignore CVE-2023-30571

Source: poky
MR: 127621, 126578
Type: Security Fix
Disposition: Merged from poky
ChangeID: 0de5f6a27a794c915a2ef2483901ab915056d961
Description:

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: 9374e680ae2376589a9bfe4565dfcf4dc9791aa8)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Jeremy A. Puhlman <jpuhlman@mvista.com>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[c97e7d9](/MontaVista-OpenSourceTechnology/poky/commit/c97e7d91c6ae862c3b9fb4066ce023c68b5ffc6d)`

```
Source: poky
MR: 127621, 126578
Type: Security Fix
Disposition: Merged from poky
ChangeID: 0de5f6a27a794c915a2ef2483901ab915056d961
Description:

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: 9374e680ae2376589a9bfe4565dfcf4dc9791aa8)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Steve Sakoman <steve@sakoman.com>
Signed-off-by: Jeremy A. Puhlman <jpuhlman@mvista.com>
```

[![@LeSuisse](https://avatars.githubusercontent.com/u/737767?s=40&v=4)](/LeSuisse)
[LeSuisse](/LeSuisse)
mentioned this issue
[Sep 23, 2023](#ref-pullrequest-1816333637)

[libarchive: 3.6.2 -> 3.7.2
NixOS/nixpkgs#244713](/NixOS/nixpkgs/pull/244713)
 Merged

12 tasks

[![@arabesc](https://avatars.githubusercontent.com/u/2709027?s=80&u=5ab777ff68e2d55876711060036d326c825d1434&v=4)](/arabesc)

Copy link

### **[arabesc](/arabesc)** commented [Feb 5, 2024](#issuecomment-1926897655)

| *This issue arises if you are using multiple threads, each using libarchive to restore archive entries to disk.*  The issue does not require the use of libarchive from multiple threads. The problem is not in the libarchive itself, but in the thread-unsafe use of the system function `umask` that changes process global state. So, any code that uses `umask` from multiple threads without synchronization is unsafe, including the libarchive `*disk*` functions.  *The archive\_read\_disk and archive\_write\_disk APIs are not generally thread safe.*  It would be good to add in the README that the `archive_*_disk_*()` functions are API specific and that other APIs such as `archive_write_new` are safe. This will save time on investigating what it's all for and where it's used. |
| --- |

All reactions

Sorry, something went wrong.

[![@arabesc](https://avatars.githubusercontent.com/u/2709027?s=80&u=5ab777ff68e2d55876711060036d326c825d1434&v=4)](/arabesc)

Copy link

### **[arabesc](/arabesc)** commented [Feb 5, 2024](#issuecomment-1926955849)

| I think a better solution than mutexing umask calls would be to ask a client to provide the mask value via a callback. There will be no umask calls in libarchive, no calls - no problem. |
| --- |

All reactions

Sorry, something went wrong.

[daregit](/daregit)
pushed a commit
to daregit/yocto-combined
that referenced
this issue
[May 22, 2024](#ref-commit-5889e88)
[![@petermarko](https://avatars.githubusercontent.com/u/13253278?s=40&v=4)](/petermarko) [![@rpurdie](https://avatars.githubusercontent.com/u/1184070?s=40&v=4)](/rpurdie)

`[src/poky:libarchive: ignore](/daregit/yocto-combined/commit/5889e88fb03be9ad0eadb1fd70b9e7eb8afe1557 "src/poky:libarchive: ignore CVE-2023-30571

This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] https://github.com/libarchive/libarchive/issues/1876
[2] https://github.com/libarchive/libarchive/pull/1875

(From OE-Core rev: 9b5b850d6a6982bb8ff14dcfbb6769b293638293)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>") [CVE-2023-30571](https://github.com/advisories/GHSA-cw7x-3mv7-w6xm "CVE-2023-30571")`
…

`[5889e88](/daregit/yocto-combined/commit/5889e88fb03be9ad0eadb1fd70b9e7eb8afe1557)`

```
This issue was reported and discusses under [1] which is linked in NVD CVE report.
It was already documented that some parts or libarchive are thread safe and some not.
[2] was now merged to document that also reported function is not thread safe.
So this CVE *now* reports thread race condition for non-thread-safe function.
And as such the CVE report is now invalid.

The issue is still not closed for 2 reasons:
* better document what is and what is not thread safe
* request to public if someone could make these functions thread safe
This should however not invalidate above statment about ignoring this CVE.

[1] [libarchive/libarchive#1876](https://github.com/libarchive/libarchive/issues/1876)
[2] [libarchive/libarchive#1875](https://github.com/libarchive/libarchive/pull/1875)

(From OE-Core rev: 9b5b850d6a6982bb8ff14dcfbb6769b293638293)

Signed-off-by: Peter Marko <peter.marko@siemens.com>
Signed-off-by: Richard Purdie <richard.purdie@linuxfoundation.org>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flibarchive%2Flibarchive%2Fissues%2F1876)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[![@kientzle](https://avatars.githubusercontent.com/u/1398793?s=52&v=4)](/kientzle) [![@theta682](https://avatars.githubusercontent.com/u/1522049?s=52&v=4)](/theta682) [![@arabesc](https://avatars.githubusercontent.com/u/2709027?s=52&v=4)](/arabesc) [![@xypiie](https://avatars.githubusercontent.com/u/6825615?s=52&v=4)](/xypiie) [![@ljavorsk](https://avatars.githubusercontent.com/u/52954689?s=52&v=4)](/ljavorsk)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


