- **Root cause of vulnerability**: The City Autocomplete module for PrestaShop is vulnerable to SQL injection due to improper neutralization of SQL parameters in the `autocompletion.php` front controller. Specifically, the `type`, `input_name`, and `q` parameters are not properly sanitized before being used in SQL queries.
- **Weaknesses/vulnerabilities present**:
    - SQL injection (CWE-89)
    - Lack of input sanitization for `type`, `input_name`, and `q` parameters.
- **Impact of exploitation**:
    - Remote attackers can execute arbitrary SQL commands.
    - Potential for obtaining admin access.
    - Ability to remove or modify data from the associated PrestaShop database.
    - Copy/paste data from sensitive tables to the front end to expose tokens and unlock admin's ajax scripts.
    - Possibility of rewriting SMTP settings to hijack emails.
    - Deployment of webskimmers to steal credit card data.
- **Attack vectors**:
    - Network-based attacks via HTTP requests.
    - The vulnerability is located in the `/module/cityautocomplete/autocompletion` FrontController endpoint.
    - The attack can be performed through manipulated GET parameters (`type`, `input_name`, `q`).
- **Required attacker capabilities/position**:
    - No special privileges required.
    - No user interaction needed for successful exploitation.
    - Attackers can exploit this vulnerability remotely over the network.