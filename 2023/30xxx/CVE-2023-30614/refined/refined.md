Based on the provided content, here's an analysis of CVE-2023-30614:

**Root Cause:**

The vulnerability stems from the lack of proper sanitization of the `back` parameter in the URL on a payments info page within the 'pay' gem for Ruby on Rails applications. This parameter was used to redirect users after a payment action.

**Weaknesses/Vulnerabilities:**

*   **Reflected Cross-Site Scripting (XSS):** The application was vulnerable to reflected XSS because it directly used the unsanitized `back` parameter from the URL to generate a redirect link.
*   **Improper Neutralization of Script-Related HTML Tags:** The application failed to neutralize script-related HTML tags or URLs provided in the `back` parameter which allowed for arbitrary JavaScript execution in the user's browser.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** An attacker could craft a malicious URL with JavaScript code embedded in the `back` parameter. When a user clicked on this link, the JavaScript would be executed in their browser.
*   **Potential for Account Compromise:** Through the execution of malicious JavaScript, an attacker could potentially steal cookies, session tokens, or perform actions on behalf of the user, leading to account compromise or data theft.
*   **Malicious Redirection:** An attacker could also use the `back` parameter to redirect users to phishing sites or other malicious websites.
*   **Phishing Attacks:** This vulnerability allows for crafted URLs to be distributed through email or user-generated content, making it easier for attackers to target specific individuals.

**Attack Vectors:**

*   **Malicious URLs:** The attacker crafts a malicious URL that includes JavaScript or a malicious redirect URL in the `back` parameter.
*   **Distribution Methods:** The malicious URL can be distributed via email or through user-generated content functionalities in the targeted application (like comments or forums)

**Required Attacker Capabilities/Position:**

*   **Ability to Craft URLs:** An attacker needs to be able to create a URL with the malicious payload in the `back` parameter.
*   **Target Interaction:** The attacker needs to persuade a user to click on the malicious link.
*   **No Special Privileges Needed:** The attack does not require any special privileges or access to the server beyond the ability to send a crafted URL.

**Additional Details from Content:**

*   The vulnerability affects versions of the `pay` gem prior to 6.3.2.
*   The patch in version 6.3.2 sanitizes the `back` parameter and restricts it to relative paths, preventing the injection of malicious URLs or JavaScript code.
*   The fix involves using `URI.parse(params[:back].to_s).path` to extract the path and ensure itâ€™s a relative path. Additionally, the view file was updated to sanitize the link using the `sanitize` helper.

The provided content offers more detail than a basic CVE description, including specific code changes and the mechanism of the vulnerability, along with remediation details.