=== Content from lists.debian.org_df8bd381_20250115_095026.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 3425-1] sqlparse security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3425-1] sqlparse security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Tue, 16 May 2023 13:33:56 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZGNqJCG1EzP24GuP%40debian.org)Â [ZGNqJCG1EzP24GuP@debian.org](msg00017.html)>
* *Mail-followup-to*: debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3425-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
May 16, 2023                                  <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : sqlparse
Version        : 0.2.4-1+deb10u1
CVE ID         : CVE-2023-30608
Debian Bug     : 1034615

Erik Krogh Kristensen discovered that sqlparse, a non-validating SQL
parser, contained a regular expression that is vulnerable to ReDoS
(Regular Expression Denial of Service).

For Debian 10 buster, this problem has been fixed in version
0.2.4-1+deb10u1.

We recommend that you upgrade your sqlparse packages.

For the detailed security status of sqlparse please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/sqlparse>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgprEQ2xK6w2W.pgp)**

*Description:* PGP signature

---



=== Content from github.com_c0503d11_20250115_095025.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fe75e35869473832a1eb67772b1adfee2db11b85a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fe75e35869473832a1eb67772b1adfee2db11b85a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=andialbrecht%2Fsqlparse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[andialbrecht](/andialbrecht)
/
**[sqlparse](/andialbrecht/sqlparse)**
Public

* [Notifications](/login?return_to=%2Fandialbrecht%2Fsqlparse) You must be signed in to change notification settings
* [Fork
  703](/login?return_to=%2Fandialbrecht%2Fsqlparse)
* [Star
   3.8k](/login?return_to=%2Fandialbrecht%2Fsqlparse)

* [Code](/andialbrecht/sqlparse)
* [Issues
  238](/andialbrecht/sqlparse/issues)
* [Pull requests
  12](/andialbrecht/sqlparse/pulls)
* [Discussions](/andialbrecht/sqlparse/discussions)
* [Actions](/andialbrecht/sqlparse/actions)
* [Security](/andialbrecht/sqlparse/security)
* [Insights](/andialbrecht/sqlparse/pulse)

Additional navigation options

* [Code](/andialbrecht/sqlparse)
* [Issues](/andialbrecht/sqlparse/issues)
* [Pull requests](/andialbrecht/sqlparse/pulls)
* [Discussions](/andialbrecht/sqlparse/discussions)
* [Actions](/andialbrecht/sqlparse/actions)
* [Security](/andialbrecht/sqlparse/security)
* [Insights](/andialbrecht/sqlparse/pulse)

## Commit

[Permalink](/andialbrecht/sqlparse/commit/e75e35869473832a1eb67772b1adfee2db11b85a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Recognize escaped backslashes within strings

[Browse files](/andialbrecht/sqlparse/tree/e75e35869473832a1eb67772b1adfee2db11b85a)
Browse the repository at this point in the history

```
Previously if a single quoted string ended with an escaped backslash,
parsing would not consider the string to be terminated.
```

* Loading branch information

casey
committed
Feb 26, 2015

1 parent
[77e0789](/andialbrecht/sqlparse/commit/77e0789aea8918a2fbbc6f20196cd0bcdecccf52)

commit e75e358

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**5 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sqlparse

  + sqlparse/lexer.py
    [lexer.py](#diff-a32560eb0875dc8180ddffc2aca3cd57ce67b80db9c54497521d0883fbe713b5)
* tests

  + tests/test\_split.py
    [test\_split.py](#diff-b158b85e51bb5d4e9aef95fa137e171e50ef7663b5f61d8e6494bdcab583630a)

## There are no files selected for viewing

3 changes: 1 addition & 2 deletions

3
[sqlparse/lexer.py](#diff-a32560eb0875dc8180ddffc2aca3cd57ce67b80db9c54497521d0883fbe713b5 "sqlparse/lexer.py")

Show comments

[View file](/andialbrecht/sqlparse/blob/e75e35869473832a1eb67772b1adfee2db11b85a/sqlparse/lexer.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -191,8 +191,7 @@ class Lexer(object): |
|  |  | (r'[-]?[0-9]\*(\.[0-9]+)?[eE][-]?[0-9]+', tokens.Number.Float), |
|  |  | (r'[-]?[0-9]\*\.[0-9]+', tokens.Number.Float), |
|  |  | (r'[-]?[0-9]+', tokens.Number.Integer), |
|  |  | # TODO: Backslash escapes? |
|  |  | (r"'(''|\\'|[^'])\*'", tokens.String.Single), |
|  |  | (r"'(''|\\\\|\\'|[^'])\*'", tokens.String.Single), |
|  |  | # not a real string literal in ANSI SQL: |
|  |  | (r'(""|".\*?[^\\]")', tokens.String.Symbol), |
|  |  | (r'(?<=[\w\]])(\[[^\]]\*?\])', tokens.Punctuation.ArrayIndex), |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[tests/test\_split.py](#diff-b158b85e51bb5d4e9aef95fa137e171e50ef7663b5f61d8e6494bdcab583630a "tests/test_split.py")

Show comments

[View file](/andialbrecht/sqlparse/blob/e75e35869473832a1eb67772b1adfee2db11b85a/tests/test_split.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,6 +22,10 @@ def test\_split\_semicolon(self): |
|  |  | self.ndiffAssertEqual(unicode(stmts[0]), self.\_sql1) |
|  |  | self.ndiffAssertEqual(unicode(stmts[1]), sql2) |
|  |  |  |
|  |  | def test\_split\_backslash(self): |
|  |  | stmts = sqlparse.parse(r"select '\\'; select '\''; select '\\\'';") |
|  |  | self.assertEqual(len(stmts), 3) |
|  |  |  |
|  |  | def test\_create\_function(self): |
|  |  | sql = load\_file('function.sql') |
|  |  | stmts = sqlparse.parse(sql) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e75e358`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fe75e35869473832a1eb67772b1adfee2db11b85a) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_821e161e_20250115_095025.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fc457abd5f097dd13fb21543381e7cfafe7d31cfb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fc457abd5f097dd13fb21543381e7cfafe7d31cfb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=andialbrecht%2Fsqlparse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[andialbrecht](/andialbrecht)
/
**[sqlparse](/andialbrecht/sqlparse)**
Public

* [Notifications](/login?return_to=%2Fandialbrecht%2Fsqlparse) You must be signed in to change notification settings
* [Fork
  703](/login?return_to=%2Fandialbrecht%2Fsqlparse)
* [Star
   3.8k](/login?return_to=%2Fandialbrecht%2Fsqlparse)

* [Code](/andialbrecht/sqlparse)
* [Issues
  238](/andialbrecht/sqlparse/issues)
* [Pull requests
  12](/andialbrecht/sqlparse/pulls)
* [Discussions](/andialbrecht/sqlparse/discussions)
* [Actions](/andialbrecht/sqlparse/actions)
* [Security](/andialbrecht/sqlparse/security)
* [Insights](/andialbrecht/sqlparse/pulse)

Additional navigation options

* [Code](/andialbrecht/sqlparse)
* [Issues](/andialbrecht/sqlparse/issues)
* [Pull requests](/andialbrecht/sqlparse/pulls)
* [Discussions](/andialbrecht/sqlparse/discussions)
* [Actions](/andialbrecht/sqlparse/actions)
* [Security](/andialbrecht/sqlparse/security)
* [Insights](/andialbrecht/sqlparse/pulse)

## Commit

[Permalink](/andialbrecht/sqlparse/commit/c457abd5f097dd13fb21543381e7cfafe7d31cfb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Remove unnecessary parts in regex for bad escaping.

[Browse files](/andialbrecht/sqlparse/tree/c457abd5f097dd13fb21543381e7cfafe7d31cfb)
Browse the repository at this point in the history

```
The regex tried to deal with situations where escaping in the
SQL to be parsed was suspicious.
```

* Loading branch information

[![@andialbrecht](https://avatars.githubusercontent.com/u/25632?s=40&v=4)](/andialbrecht)

[andialbrecht](/andialbrecht/sqlparse/commits?author=andialbrecht "View all commits by andialbrecht")
committed
Apr 18, 2023

1 parent
[b949fdf](/andialbrecht/sqlparse/commit/b949fdf9a1538f98b57612bef6306fc38f32aaf7)

commit c457abd

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**14 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG
  [CHANGELOG](#diff-ecec88c33adb7591ee6aa88e29b62ad52ef443611cba5e0f0ecac9b5725afdba)
* sqlparse

  + sqlparse/keywords.py
    [keywords.py](#diff-1e8198a38c2584359246d41ebdcd5d0a7ca47be5dbe1a13ae33b2f9ef8452784)
* tests

  + tests/test\_split.py
    [test\_split.py](#diff-b158b85e51bb5d4e9aef95fa137e171e50ef7663b5f61d8e6494bdcab583630a)

## There are no files selected for viewing

10 changes: 10 additions & 0 deletions

10
[CHANGELOG](#diff-ecec88c33adb7591ee6aa88e29b62ad52ef443611cba5e0f0ecac9b5725afdba "CHANGELOG")

Show comments

[View file](/andialbrecht/sqlparse/blob/c457abd5f097dd13fb21543381e7cfafe7d31cfb/CHANGELOG)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,12 +1,22 @@ |
|  |  | Development Version |
|  |  | ------------------- |
|  |  |  |
|  |  | Notable Changes |
|  |  |  |
|  |  | \* IMPORTANT: This release fixes a security vulnerability in the |
|  |  | parser where a regular expression vulnerable to ReDOS (Regular |
|  |  | Expression Denial of Service) was used. See the security advisory |
|  |  | for details: https://github.com/andialbrecht/sqlparse/security/advisories/GHSA-rrm6-wvj7-cwh2 |
|  |  | The vulnerability was discovered by @erik-krogh from GitHub |
|  |  | Security Lab (GHSL). Thanks for reporting! |
|  |  |  |
|  |  | Bug Fixes |
|  |  |  |
|  |  | \* Revert a change from 0.4.0 that changed IN to be a comparison (issue694). |
|  |  | The primary expectation is that IN is treated as a keyword and not as a |
|  |  | comparison operator. That also follows the definition of reserved keywords |
|  |  | for the major SQL syntax definitions. |
|  |  | \* Fix regular expressions for string parsing. |
|  |  |  |
|  |  | Other |
|  |  |  |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[sqlparse/keywords.py](#diff-1e8198a38c2584359246d41ebdcd5d0a7ca47be5dbe1a13ae33b2f9ef8452784 "sqlparse/keywords.py")

Show comments

[View file](/andialbrecht/sqlparse/blob/c457abd5f097dd13fb21543381e7cfafe7d31cfb/sqlparse/keywords.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -59,9 +59,9 @@ |
|  |  | (r'(?![\_A-ZÃ€-Ãœ])-?(\d+(\.\d\*)|\.\d+)(?![\_A-ZÃ€-Ãœ])', |
|  |  | tokens.Number.Float), |
|  |  | (r'(?![\_A-ZÃ€-Ãœ])-?\d+(?![\_A-ZÃ€-Ãœ])', tokens.Number.Integer), |
|  |  | (r"'(''|\\\\|\\'|[^'])\*'", tokens.String.Single), |
|  |  | (r"'(''|\\'|[^'])\*'", tokens.String.Single), |
|  |  | # not a real string literal in ANSI SQL: |
|  |  | (r'"(""|\\\\|\\"|[^"])\*"', tokens.String.Symbol), |
|  |  | (r'"(""|\\"|[^"])\*"', tokens.String.Symbol), |
|  |  | (r'(""|".\*?[^\\]")', tokens.String.Symbol), |
|  |  | # sqlite names can be escaped with [square brackets]. left bracket |
|  |  | # cannot be preceded by word character or a right bracket -- |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[tests/test\_split.py](#diff-b158b85e51bb5d4e9aef95fa137e171e50ef7663b5f61d8e6494bdcab583630a "tests/test_split.py")

Show comments

[View file](/andialbrecht/sqlparse/blob/c457abd5f097dd13fb21543381e7cfafe7d31cfb/tests/test_split.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,8 +18,8 @@ def test\_split\_semicolon(): |
|  |  |  |
|  |  |  |
|  |  | def test\_split\_backslash(): |
|  |  | stmts = sqlparse.parse(r"select '\\'; select '\''; select '\\\'';") |
|  |  | assert len(stmts) == 3 |
|  |  | stmts = sqlparse.parse("select '\'; select '\'';") |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fc457abd5f097dd13fb21543381e7cfafe7d31cfb)       Sorry, something went wrong.           Copy link    Quote reply     @mcepl **[mcepl](/mcepl)** [May 25, 2023](#r114988207)  [@andialbrecht](https://github.com/andialbrecht) Are you certain that this really shouldnâ€™t be `r`-string?      All reactions | | |
|  |  | assert len(stmts) == 2 |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.parametrize('fn', ['function.sql', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c457abd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fcommit%2Fc457abd5f097dd13fb21543381e7cfafe7d31cfb) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from owasp.org_8376dce0_20250115_095027.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# Regular expression Denial of Service - ReDoS

**Author:** Adar Weidman

**Contributor(s):** Ebing, Rsl81, Wichers, Bjoern Kimminich, kingthorin, pi3ch

## Introduction

The **Regular expression Denial of Service (ReDoS)** is a [Denial of
Service](Denial_of_Service) attack, that exploits the fact
that most Regular Expression implementations may reach extreme
situations that cause them to work very slowly (exponentially related to
input size). An attacker can then cause a program using a Regular
Expression (Regex) to enter these extreme situations and then hang for a very
long time.

## Description

### The problematic Regex naÃ¯ve algorithm

The Regex naÃ¯ve algorithm builds a [Nondeterministic Finite
Automaton
(NFA)](https://en.wikipedia.org/wiki/Nondeterministic_finite_state_machine),
which is a finite state machine where for each pair of state and input
symbol there may be several possible next states. Then the engine starts
to make transition until the end of the input. Since there may be
several possible next states, a deterministic algorithm is used. This
algorithm tries one by one all the possible paths (if needed) until a
match is found (or all the paths are tried and fail).

For example, the Regex pattern or quantifier `^(a+)+$` is represented by the following
NFA:

![Nondeterministic Finite Automaton](../assets/images/attacks/NFA.png)

For the input `aaaaX` there are 16 possible paths in the above
graph. But for `aaaaaaaaaaaaaaaaX` there are 65536 possible paths,
and the number is double for each additional `a`. This is an extreme
case where the naÃ¯ve algorithm is problematic, because it must pass on
many paths to find a **non-matching input**.

The root-cause of the above example is in a Regex engine feature called **backtracking**.
Simply, if the input (token) fails to match, the engine goes back to
previous positions where it could take a different path.
The engine tries this many times until it explores all possible paths.
In the above example, this feature create a long running loop
because there were many paths to explore due to inefficient Regex pattern.

Notice, that not all algorithms are naÃ¯ve, and actually Regex algorithms
can be written in an efficient way. Unfortunately, most Regex engines
today try to solve not only â€œpureâ€ Regexes, but also â€œexpandedâ€ Regexes
with â€œspecial additionsâ€, such as back-references that cannot be always
be solved efficiently (see **Patterns for non-regular languages** in
[Wiki-Regex](https://en.wikipedia.org/wiki/Regular_expression) for some
more details). So even if the Regex is not â€œexpandedâ€, a naÃ¯ve algorithm
is used.

### Evil Regex

A Regex pattern is called **Evil Regex** if it can get stuck on crafted input.

**Evil Regex contains**:

* Grouping with repetition
* Inside the repeated group:
  + Repetition
  + Alternation with overlapping

**Examples of Evil Regex**:

* `(a+)+$`
* `([a-zA-Z]+)*$`
* `(a|aa)+$`
* `(a|a?)+$`

All the above are susceptible to the input
`aaaaaaaaaaaaaaaaaaaaaaaa!` (The minimum input length might change
slightly, when using faster or slower machines).

### Attacks

The attacker might use the above knowledge to look for applications that
use Regular Expressions, containing an **Evil Regex**, and send a
well-crafted input, that will hang the system. Alternatively, if a Regex
itself is affected by a user input, the attacker can inject an **Evil
Regex**, and make the system vulnerable.

## Risk Factors

The Web is Regex-Based:

![](../assets/images/attacks/RegexBasedWeb.png)

In every layer of the WEB there are Regular Expressions, that might
contain an **Evil Regex**. An attacker can hang a WEB-browser (on a
computer or potentially also on a mobile device), hang a Web Application
Firewall (WAF), attack a database, and even stack a vulnerable WEB
server.

For example, if a programmer uses a Regex to validate the client side of
a system, and the Regex contains an **Evil Regex**, the attacker can
assume the same vulnerable Regex is used in the server side, and send a
well-crafted input, that stacks the WEB server.

## Examples

### Vulnerable Regex in online repositories

1. [ReGexLib,id=1757 (email validation)](http://regexlib.com/REDetails.aspx?regexp_id=1757) - see
   bold part, which is an **Evil Regex**

`^([a-zA-Z0-9])`**`(([\-.]|[_]+)?([a-zA-Z0-9]+))*`**`(@){1}[a-z0-9]+[.]{1}(([a-z]{2,3})|([a-z]{2,3}[.]{1}[a-z]{2,3}))$`

Input:

`aaaaaaaaaaaaaaaaaaaaaaaa!`

1. [OWASP Validation Regex Repository](https://wiki.owasp.org/index.php/OWASP_Validation_Regex_Repository), Java
   Classname - see bold part, which is an **Evil Regex**

`^`**`(([a-z])+.)+`**`[A-Z]([a-z])+$`

Input:

`aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa!`

### Web application attack

* Open a JavaScript
* Find **Evil Regex**
* Craft a malicious input for the found Regex
* Submit a valid value via intercepting proxy
* Change the request to contain a malicious input
* You are done!

### ReDoS via Regex Injection

The following example checks if the username is part of the password
entered by the user.

```
String userName = textBox1.Text;
String password = textBox2.Text;
Regex testPassword = new Regex(userName);
Match match = testPassword.Match(password);
if (match.Success)
{
    MessageBox.Show("Do not include name in password.");
}
else
{
    MessageBox.Show("Good password.");
}

```

If an attacker enters `^(([a-z])+.)+[A-Z]([a-z])+$` as a username
and `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa!` as a password, the program
will hang.

## References

* [Regular Expression Denial Of Service / Crosby&Wallach, Usenix Security 2003](https://web.archive.org/web/20031120114522/https%3A//www.cs.rice.edu/~scrosby/hash/slides/USENIX-RegexpWIP.2.ppt)
* [Regular expression Denial of Service Revisited, Sep-2009](https://web.archive.org/web/20091007100653/http%3A//www.checkmarx.com/Upload/Documents/PDF/Checkmarx_OWASP_IL_2009_ReDoS.pdf)
* [RegExLib](http://regexlib.com/)
* [ReDOS Attacks: From the Exploitation to the Prevention (in .NET)](https://dzone.com/articles/regular-expressions-denial)
* [Tool for detecting ReDoS vulnerabilities.](https://web.archive.org/web/20211027135828/https%3A//www.cs.bham.ac.uk/~hxt/research/rxxr.shtml)
* Examples of ReDoS in open source applications:
  + [ReDoS in DataVault](https://nvd.nist.gov/vuln/detail/CVE-2009-3277)
  + [ReDoS in EntLib](https://nvd.nist.gov/vuln/detail/CVE-2009-3275)
  + [ReDoS in NASD CORE.NET Terelik](https://nvd.nist.gov/vuln/detail/CVE-2009-3276)
  + [ReDoS in .NET Framework](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html)
  + [ReDoS in Javascript minimatch](https://nvd.nist.gov/vuln/detail/CVE-2022-3517)

[Category:Injection](https://owasp.org/www-community/Injection_Flaws)

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASPÂ® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* Attacks (You are here)
* [Vulnerabilities](/www-community/vulnerabilities)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, OWASP Boston Application Security Conference, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.



=== Content from github.com_0f12767d_20250115_095026.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fsecurity%2Fadvisories%2FGHSA-rrm6-wvj7-cwh2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fandialbrecht%2Fsqlparse%2Fsecurity%2Fadvisories%2FGHSA-rrm6-wvj7-cwh2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=andialbrecht%2Fsqlparse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[andialbrecht](/andialbrecht)
/
**[sqlparse](/andialbrecht/sqlparse)**
Public

* [Notifications](/login?return_to=%2Fandialbrecht%2Fsqlparse) You must be signed in to change notification settings
* [Fork
  703](/login?return_to=%2Fandialbrecht%2Fsqlparse)
* [Star
   3.8k](/login?return_to=%2Fandialbrecht%2Fsqlparse)

* [Code](/andialbrecht/sqlparse)
* [Issues
  238](/andialbrecht/sqlparse/issues)
* [Pull requests
  12](/andialbrecht/sqlparse/pulls)
* [Discussions](/andialbrecht/sqlparse/discussions)
* [Actions](/andialbrecht/sqlparse/actions)
* [Security](/andialbrecht/sqlparse/security)
* [Insights](/andialbrecht/sqlparse/pulse)

Additional navigation options

* [Code](/andialbrecht/sqlparse)
* [Issues](/andialbrecht/sqlparse/issues)
* [Pull requests](/andialbrecht/sqlparse/pulls)
* [Discussions](/andialbrecht/sqlparse/discussions)
* [Actions](/andialbrecht/sqlparse/actions)
* [Security](/andialbrecht/sqlparse/security)
* [Insights](/andialbrecht/sqlparse/pulse)

# Parser contains a regular expression that is vulnerable to ReDOS (Regular Expression Denial of Service)

Moderate

[andialbrecht](/andialbrecht)
published
GHSA-rrm6-wvj7-cwh2
Apr 18, 2023

## Package

python-sqlparse
(Python)

## Affected versions

>=0.1.15

## Patched versions

0.4.4

## Description

### Impact

The SQL parser contains a regular expression that is vulnerable to [ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS) (Regular Expression Denial of Service). The vulnerability may lead to Denial of Service (DoS).

### Patches

This issues has been fixed in sqlparse 0.4.4.

### Workarounds

None.

### References

This issue was discovered and reported by GHSL team member [@erik-krogh (Erik Krogh Kristensen)](https://github.com/erik-krogh).

* Commit that introduced the vulnerability: [e75e358](https://github.com/andialbrecht/sqlparse/commit/e75e35869473832a1eb67772b1adfee2db11b85a)

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-30608

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400) [CWE-1333](/advisories?query=cwe%3A1333)

### Credits

* [![@erik-krogh](https://avatars.githubusercontent.com/u/54990334?s=40&v=4)](/erik-krogh)
  [erik-krogh](/erik-krogh)
  Reporter

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


