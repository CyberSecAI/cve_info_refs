The provided content is related to CVE-2023-30191.

**Root cause of vulnerability:**
The vulnerability is due to improper neutralization of SQL parameters within the `CdesignerTraitementModuleFrontController::initContent()` method of the "CDesigner" module for PrestaShop. Specifically, the `id_design` parameter from user input is not properly sanitized before being used in a SQL query.

**Weaknesses/vulnerabilities present:**
- SQL Injection (CWE-89): The module is vulnerable to SQL injection because it directly incorporates user-supplied data into a SQL query without proper sanitization or parameterization.

**Impact of exploitation:**
- Obtain admin access: Attackers could potentially elevate their privileges to gain administrative control.
- Steal/Remove data: Attackers could access, modify, or delete sensitive data from the PrestaShop database.
- Expose sensitive data: Copy data from sensitive tables to the front end, possibly revealing tokens and other sensitive information.
- Hijack emails: Attackers could modify SMTP settings to intercept or control email communications.
- Deploy webskimmer: This vulnerability is actively exploited to deploy webskimmers which steal credit card information.

**Attack vectors:**
- Network: The vulnerability can be exploited remotely over the network.
- HTTP POST request: The attack is performed using a crafted HTTP POST request to the module's front controller.
- Module controller: The specific path of the vulnerable controller can be concealed, making it difficult to detect the exploit using conventional front-end logs.

**Required attacker capabilities/position:**
- No privilege required: The attacker does not need any special access or prior authentication to exploit the vulnerability.
- No user interaction: The attack can be performed without any interaction from the user or the administrator.
- Knowledge of the vulnerable module: Attackers need to know the specific module and controller endpoint to target.
- Ability to forge HTTP requests: Attackers need the ability to send a crafted HTTP POST request with the malicious payload.

**Additional details:**
- The vulnerability is present in versions of the "cdesigner" module up to and including 3.2.2. Version 3.2.3 includes a fix.
- The module author does not follow semantic versioning, meaning that the fix may not be available for all major versions of PrestaShop.
- The provided patch replaces direct user input usage with `pSQL()` which provides escaping of special characters.
- Exploitation is actively being used to deploy web skimmers to steal credit card data.
- Attackers can conceal the module's controller path, meaning standard frontend logs will likely only show "POST /".
- Activating the AuditEngine of mod_security (or similar) is recommended to detect this exploit.