=== Content from plugins.trac.wordpress.org_29ecc00c_20250114_195217.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Forder-tracking%2Ftrunk%2Fincludes%2FExport.class.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/order-tracking/trunk/includes/Export.class.php?rev=3063867 "Revision 3063867")
* Next Revision →
* [Blame](/browser/order-tracking/trunk/includes/Export.class.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/order-tracking/trunk/includes/Export.class.php)

---

# [source:](/browser?order=name "Go to repository root") [order-tracking](/browser/order-tracking?order=name "View order-tracking")/[trunk](/browser/order-tracking/trunk?order=name "View trunk")/[includes](/browser/order-tracking/trunk/includes?order=name "View includes")/[Export.class.php](/browser/order-tracking/trunk/includes/Export.class.php?order=name "View Export.class.php")

View diff against:

View revision:

| [Last change](/changeset/3150879/order-tracking/trunk/includes/Export.class.php "View differences") on this file was [3150879](/changeset/3150879/ "View changeset 3150879"), checked in by Rustaurius, [4 months ago](/timeline?from=2024-09-12T13%3A47%3A43Z&precision=second "See timeline at 09/12/2024 01:47:43 PM") |
| --- |
| v3.3.16 releaseed and tagged |
| **File size:** 17.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* Class to export orders created by the plugin |
| [5](#L5) | \*/ |
| [6](#L6) |  |
| [7](#L7) | if ( !defined( 'ABSPATH' ) ) |
| [8](#L8) | exit; |
| [9](#L9) |  |
| [10](#L10) | if (!class\_exists('ComposerAutoloaderInit4618f5c41cf5e27cc7908556f031e4d4')) { require\_once EWD\_OTP\_PLUGIN\_DIR . '/lib/PHPSpreadsheet/vendor/autoload.php'; } |
| [11](#L11) | use PhpOffice\PhpSpreadsheet\Spreadsheet; |
| [12](#L12) | use PhpOffice\PhpSpreadsheet\Writer\Xls; |
| [13](#L13) | use PhpOffice\PhpSpreadsheet\Writer\Csv; |
| [14](#L14) | class ewdotpExport { |
| [15](#L15) |  |
| [16](#L16) | // Set whether a valid nonce is needed before exporting orders |
| [17](#L17) | public $nonce\_check = true; |
| [18](#L18) |  |
| [19](#L19) | /\*\* |
| [20](#L20) | \* all the messages to display |
| [21](#L21) | \* array( |
| [22](#L22) | \*   'error' => 'Some error!', |
| [23](#L23) | \*   'info'  => 'Some info msg', |
| [24](#L24) | \*   'success' => 'Some success', |
| [25](#L25) | \*   'warning' => 'Some warning!' |
| [26](#L26) | \* ) |
| [27](#L27) | \* @var array |
| [28](#L28) | \*/ |
| [29](#L29) | public $messages = array(); |
| [30](#L30) |  |
| [31](#L31) | public function \_\_construct() { |
| [32](#L32) |  |
| [33](#L33) | if ( isset( $\_POST['ewd\_otp\_export'] ) ) { add\_action( 'admin\_menu', array( $this, 'run\_export' ) ); } |
| [34](#L34) |  |
| [35](#L35) | add\_action( 'admin\_menu', array($this, 'register\_install\_screen' )); |
| [36](#L36) | } |
| [37](#L37) |  |
| [38](#L38) | public function register\_install\_screen() { |
| [39](#L39) | global $ewd\_otp\_controller; |
| [40](#L40) |  |
| [41](#L41) | add\_submenu\_page( |
| [42](#L42) | 'ewd-otp-orders', |
| [43](#L43) | 'Export Menu', |
| [44](#L44) | 'Export', |
| [45](#L45) | $ewd\_otp\_controller->settings->get\_setting( 'access-role' ), |
| [46](#L46) | 'ewd-otp-export', |
| [47](#L47) | array($this, 'display\_export\_screen') |
| [48](#L48) | ); |
| [49](#L49) |  |
| [50](#L50) | // This is required to enqueue style however, we are not registering/rendering this |
| [51](#L51) | require\_once( EWD\_OTP\_PLUGIN\_DIR . '/lib/simple-admin-pages/simple-admin-pages.php' ); |
| [52](#L52) | $sap = sap\_initialize\_library( |
| [53](#L53) | $args = array( |
| [54](#L54) | 'version' => '2.6.22', |
| [55](#L55) | 'lib\_url' => EWD\_OTP\_PLUGIN\_URL . '/lib/simple-admin-pages/', |
| [56](#L56) | 'theme'   => 'purple', |
| [57](#L57) | ) |
| [58](#L58) | ); |
| [59](#L59) | $sap->add\_page( |
| [60](#L60) | 'submenu', |
| [61](#L61) | array( |
| [62](#L62) | 'id'            => 'ewd-otp-export', |
| [63](#L63) | 'title'         => \_\_( 'Export', 'order-tracking' ), |
| [64](#L64) | 'menu\_title'    => \_\_( 'Export', 'order-tracking' ), |
| [65](#L65) | 'parent\_menu'   => 'ewd-otp-orders', |
| [66](#L66) | 'description'   => '' |
| [67](#L67) | ) |
| [68](#L68) | ); |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | public function display\_export\_screen() { |
| [72](#L72) | global $ewd\_otp\_controller; |
| [73](#L73) |  |
| [74](#L74) | $export\_permission = $ewd\_otp\_controller->permissions->check\_permission( 'export' ); |
| [75](#L75) |  |
| [76](#L76) | ?> |
| [77](#L77) | <div class="wrap sap-settings-page"> |
| [78](#L78) | <h1>Export</h1> |
| [79](#L79) |  |
| [80](#L80) | <?php $this->display\_messages(); ?> |
| [81](#L81) |  |
| [82](#L82) | <?php if ( $export\_permission ) { ?> |
| [83](#L83) | <form method='post'> |
| [84](#L84) | <?php |
| [85](#L85) | wp\_nonce\_field( 'EWD\_OTP\_Export', 'EWD\_OTP\_Export\_Nonce' ); |
| [86](#L86) |  |
| [87](#L87) | // Fetch order status |
| [88](#L88) | $order\_status\_list = ewd\_otp\_decode\_infinite\_table\_setting( $ewd\_otp\_controller->settings->get\_setting( 'statuses' ) ); |
| [89](#L89) | $customer\_list = $this->get\_customer\_list(); |
| [90](#L90) | $sales\_rep\_list = $this->get\_sales\_rep\_list(); |
| [91](#L91) |  |
| [92](#L92) | // set type being exported to orders if not set |
| [93](#L93) | $\_POST['type-of-record'] = isset( $\_POST['type-of-record'] ) ? $\_POST['type-of-record'] : 'order'; |
| [94](#L94) | ?> |
| [95](#L95) |  |
| [96](#L96) | <h2>Filters</h2> |
| [97](#L97) |  |
| [98](#L98) | <table class="form-table ewd-otp-export-filters" role="presentation"> |
| [99](#L99) |  |
| [100](#L100) | <tr class="row type-of-record"> |
| [101](#L101) | <th><?php \_e( 'Type of Record', 'order-tracking' ); ?></th> |
| [102](#L102) | <td> |
| [103](#L103) | <fieldset> |
| [104](#L104) | <label for="type-of-record-order" class="sap-admin-input-container"> |
| [105](#L105) | <input type="radio" name="type-of-record" value="order" id="type-of-record-order" <?php echo $\_POST['type-of-record'] == 'order' ? 'checked' : ''; ?>> |
| [106](#L106) | <span class="sap-admin-radio-button"></span> |
| [107](#L107) | <span><?php \_e( 'Order', 'order-tracking' ); ?></span> |
| [108](#L108) | </label> |
| [109](#L109) | <label for="type-of-record-customer" class="sap-admin-input-container"> |
| [110](#L110) | <input type="radio" name="type-of-record" value="customer" id="type-of-record-customer" <?php echo $\_POST['type-of-record'] == 'customer' ? 'checked' : ''; ?>> |
| [111](#L111) | <span class="sap-admin-radio-button"></span> |
| [112](#L112) | <span>Customer</span> |
| [113](#L113) | </label> |
| [114](#L114) | <label for="type-of-record-sales-rep" class="sap-admin-input-container"> |
| [115](#L115) | <input type="radio" name="type-of-record" value="sales-rep" id="type-of-record-sales-rep" <?php echo $\_POST['type-of-record'] == 'sales-rep' ? 'checked' : ''; ?>> |
| [116](#L116) | <span class="sap-admin-radio-button"></span> |
| [117](#L117) | <span>Sales Rep</span> |
| [118](#L118) | </label> |
| [119](#L119) | </fieldset> |
| [120](#L120) | </td> |
| [121](#L121) | </tr> |
| [122](#L122) |  |
| [123](#L123) | <tr class="row by-status <?php echo $\_POST['type-of-record'] != 'order' ? 'ewd-otp-hidden' : ''; ?>" > |
| [124](#L124) | <th><?php \_e( 'Orders by Status', 'order-tracking' ); ?></th> |
| [125](#L125) | <td> |
| [126](#L126) | <fieldset> |
| [127](#L127) | <?php foreach ($order\_status\_list as $record): ?> |
| [128](#L128) | <label for="type-of-record-<?php echo esc\_attr( $record->status );?>" class="sap-admin-input-container"> |
| [129](#L129) | <input type="checkbox" name="order-by-status[]" value="<?php echo $record->status;?>" id="type-of-record-<?php echo $record->status;?>" <?php echo isset($\_POST['order-by-status']) && in\_array($record->status, $\_POST['order-by-status']) ? 'checked' : ''; ?>> |
| [130](#L130) | <span class="sap-admin-checkbox"></span> |
| [131](#L131) | <span><?php echo esc\_html( $record->status );?></span> |
| [132](#L132) | </label> |
| [133](#L133) | <?php endforeach ?> |
| [134](#L134) | </fieldset> |
| [135](#L135) | </td> |
| [136](#L136) | </tr> |
| [137](#L137) |  |
| [138](#L138) | <tr class="row date-range <?php echo $\_POST['type-of-record'] != 'order' ? 'ewd-otp-hidden' : ''; ?>"> |
| [139](#L139) | <th><?php \_e( 'Orders from a Specific Date Range', 'order-tracking' ); ?></th> |
| [140](#L140) | <td> |
| [141](#L141) | <fieldset> |
| [142](#L142) | <label for="date-range-today" class="sap-admin-input-container"> |
| [143](#L143) | <input type="radio" name="date\_range" value="today" id="date-range-today" <?php echo isset( $\_POST['date\_range'] ) && 'today' == $\_POST['date\_range'] ? 'checked' : ''; ?>> |
| [144](#L144) | <span class="sap-admin-radio-button"></span> |
| [145](#L145) | <span><?php \_e( sprintf( 'Today (%s)', date( get\_option( 'date\_format' ), strtotime( 'today' ) ) ), 'order-tracking' ); ?></span> |
| [146](#L146) | </label> |
| [147](#L147) | <label for="date-range-week" class="sap-admin-input-container"> |
| [148](#L148) | <input type="radio" name="date\_range" value="week" id="date-range-week" <?php echo isset( $\_POST['date\_range'] ) && 'week' == $\_POST['date\_range'] ? 'checked' : ''; ?>> |
| [149](#L149) | <span class="sap-admin-radio-button"></span> |
| [150](#L150) | <span><?php \_e( sprintf( 'This Week (%s - %s)', date( get\_option( 'date\_format' ), strtotime( 'monday this week' ) ), date( get\_option( 'date\_format' ), strtotime( 'sunday this week' ) ) ), 'order-tracking' ); ?></span> |
| [151](#L151) | </label> |
| [152](#L152) | <label for="date-range-past" class="sap-admin-input-container"> |
| [153](#L153) | <input type="radio" name="date\_range" value="past" id="date-range-past" <?php echo isset( $\_POST['date\_range'] ) && 'past' == $\_POST['date\_range'] ? 'checked' : ''; ?>> |
| [154](#L154) | <span class="sap-admin-radio-button"></span> |
| [155](#L155) | <span><?php \_e( 'Past', 'order-tracking' ); ?></span> |
| [156](#L156) | </label> |
| [157](#L157) | <label for="date-range-from"><?php \_e( 'From', 'order-tracking' ); ?></label> |
| [158](#L158) | <input type="date" name="start\_date" id="date-range-from" value="<?php echo isset( $\_POST['start\_date'] ) ? esc\_attr\_\_( $\_POST['start\_date'] ) : ''; ?>"> |
| [159](#L159) | <label for="date-range-to"><?php \_e( 'To', 'order-tracking' ); ?></label> |
| [160](#L160) | <input type="date" name="end\_date" id="date-range-to" value="<?php echo isset( $\_POST['end\_date'] ) ? esc\_attr\_\_( $\_POST['end\_date'] ) : ''; ?>"> |
| [161](#L161) | </fieldset> |
| [162](#L162) | </td> |
| [163](#L163) | </tr> |
| [164](#L164) |  |
| [165](#L165) | <tr class="row customer-list <?php echo $\_POST['type-of-record'] != 'order' ? 'ewd-otp-hidden' : ''; ?>"> |
| [166](#L166) | <th><?php \_e( 'Orders from specific Customer(s)', 'order-tracking' ); ?></th> |
| [167](#L167) | <td> |
| [168](#L168) | <fieldset> |
| [169](#L169) | <select name="order-of-customer[]" multiple> |
| [170](#L170) | <?php |
| [171](#L171) | foreach ($customer\_list as $record) { |
| [172](#L172) | $selected = isset($\_POST['order-of-customer']) && in\_array($record->id, $\_POST['order-of-customer']) ? 'selected' : ''; |
| [173](#L173) | echo "<option value='{$record->id}' {$selected}>{$record->id} - {$record->name} ( {$record->email} )</option>"; |
| [174](#L174) | } |
| [175](#L175) | ?> |
| [176](#L176) | </select> |
| [177](#L177) | </fieldset> |
| [178](#L178) | </td> |
| [179](#L179) | </tr> |
| [180](#L180) |  |
| [181](#L181) | <tr class="row sales-rep-list <?php echo $\_POST['type-of-record'] != 'order' ? 'ewd-otp-hidden' : ''; ?>"> |
| [182](#L182) | <th><?php \_e( 'Orders for specific Sales Rep(s)', 'order-tracking' ); ?></th> |
| [183](#L183) | <td> |
| [184](#L184) | <fieldset> |
| [185](#L185) | <select name="order-of-sales-rep[]" multiple> |
| [186](#L186) | <?php |
| [187](#L187) | foreach ($sales\_rep\_list as $record) { |
| [188](#L188) | $selected = isset($\_POST['order-of-sales-rep']) && in\_array($record->id, $\_POST['order-of-sales-rep']) ? 'selected' : ''; |
| [189](#L189) | $l\_name = !empty( $record->last\_name ) ? " {$record->last\_name}" : ''; |
| [190](#L190) | echo "<option value='{$record->id}' {$selected}>{$record->id} - {$record->first\_name}{$l\_name} ( {$record->email} )</option>"; |
| [191](#L191) | } |
| [192](#L192) | ?> |
| [193](#L193) | </select> |
| [194](#L194) | </fieldset> |
| [195](#L195) | </td> |
| [196](#L196) | </tr> |
| [197](#L197) |  |
| [198](#L198) | </table> |
| [199](#L199) |  |
| [200](#L200) | <input type='submit' name='ewd\_otp\_export' value='Export to Spreadsheet' class='button button-primary'> |
| [201](#L201) | &nbsp; |
| [202](#L202) | <a href="" class='button'><?php \_e( 'Clear Form', 'order-tracking' ); ?></a> |
| [203](#L203) |  |
| [204](#L204) | </form> |
| [205](#L205) | <?php } else { ?> |
| [206](#L206) | <div class='ewd-otp-premium-locked'> |
| [207](#L207) | <a href="https://www.etoilewebdesign.com/license-payment/?Selected=OTP&Quantity=1&utm\_source=otp\_export" target="\_blank">Upgrade</a> to the premium version to use this feature |
| [208](#L208) | </div> |
| [209](#L209) | <?php } ?> |
| [210](#L210) | </div> |
| [211](#L211) | <?php } |
| [212](#L212) |  |
| [213](#L213) |  |
| [214](#L214) | public function run\_export() { |
| [215](#L215) | global $ewd\_otp\_controller; |
| [216](#L216) |  |
| [217](#L217) | if ( $this->nonce\_check and ! isset( $\_POST['EWD\_OTP\_Export\_Nonce'] ) ) { |
| [218](#L218) | return; |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | if ( $this->nonce\_check and ! wp\_verify\_nonce( $\_POST['EWD\_OTP\_Export\_Nonce'], 'EWD\_OTP\_Export' ) ) { |
| [222](#L222) | return; |
| [223](#L223) | } |
| [224](#L224) |  |
| [225](#L225) | // Instantiate a new PHPExcel object |
| [226](#L226) | $spreadsheet = new Spreadsheet(); |
| [227](#L227) | // Set the active Excel worksheet to sheet 0 |
| [228](#L228) | $spreadsheet->setActiveSheetIndex(0); |
| [229](#L229) |  |
| [230](#L230) | $records = array('header' => array(), 'data' => array()); |
| [231](#L231) |  |
| [232](#L232) | if ( empty( $\_POST['type-of-record'] ) or 'order' == $\_POST['type-of-record'] ) { |
| [233](#L233) | $records = $this->get\_order\_data(); |
| [234](#L234) | } |
| [235](#L235) | elseif ( 'customer' == $\_POST['type-of-record'] ) { |
| [236](#L236) | $records = $this->get\_customer\_data(); |
| [237](#L237) | } |
| [238](#L238) | elseif( 'sales-rep' == $\_POST['type-of-record'] ) { |
| [239](#L239) | $records = $this->get\_sales\_rep\_data(); |
| [240](#L240) | } |
| [241](#L241) |  |
| [242](#L242) | if( 1 > count( $records['data'] ) ) { |
| [243](#L243) | $this->warning('No records found to export!'); |
| [244](#L244) | return; |
| [245](#L245) | } |
| [246](#L246) |  |
| [247](#L247) | // Adding header |
| [248](#L248) | $row = 1; $col = 'A'; |
| [249](#L249) | foreach ($records['header'] as $value) { |
| [250](#L250) | $spreadsheet->getActiveSheet()->setCellValue( $col.$row, $value ); |
| [251](#L251) | $col++; |
| [252](#L252) | } |
| [253](#L253) |  |
| [254](#L254) | //start while loop to get data |
| [255](#L255) | $row = 2; |
| [256](#L256) | foreach ( $records['data'] as $record ) { |
| [257](#L257) | $col = 'A'; |
| [258](#L258) | foreach ( $record as $value ) { |
| [259](#L259) | $spreadsheet->getActiveSheet()->setCellValue( $col.$row, $value ); |
| [260](#L260) | $col++; |
| [261](#L261) | } |
| [262](#L262) | $row++; |
| [263](#L263) | } |
| [264](#L264) |  |
| [265](#L265) | // Redirect output to a client’s web browser (Excel5) |
| [266](#L266) | if ( ! isset( $format\_type ) == 'csv' ) { |
| [267](#L267) |  |
| [268](#L268) | ob\_clean(); |
| [269](#L269) |  |
| [270](#L270) | header('Content-Type: application/vnd.ms-excel'); |
| [271](#L271) | header('Content-Disposition: attachment;filename="' . $records['filename'] . '.csv"'); |
| [272](#L272) | header('Cache-Control: max-age=0'); |
| [273](#L273) | $objWriter = new Csv($spreadsheet); |
| [274](#L274) | $objWriter->save('php://output'); |
| [275](#L275) | } |
| [276](#L276) | else { |
| [277](#L277) |  |
| [278](#L278) | ob\_clean(); |
| [279](#L279) |  |
| [280](#L280) | header('Content-Type: application/vnd.ms-excel'); |
| [281](#L281) | header('Content-Disposition: attachment;filename="' . $records['filename'] . '.xls"'); |
| [282](#L282) | header('Cache-Control: max-age=0'); |
| [283](#L283) | $objWriter = new Xls($spreadsheet); |
| [284](#L284) | $objWriter->save('php://output'); |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) | die(); |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | public function get\_order\_data() |
| [291](#L291) | { |
| [292](#L292) | global $ewd\_otp\_controller; |
| [293](#L293) |  |
| [294](#L294) | // Print out the regular order field labels |
| [295](#L295) | $order\_header = array( |
| [296](#L296) | 'Name', |
| [297](#L297) | 'Number', |
| [298](#L298) | 'Order Status', |
| [299](#L299) | 'Order Status Updated (Read-Only)', |
| [300](#L300) | 'Location', |
| [301](#L301) | 'Display', |
| [302](#L302) | 'Notes Public', |
| [303](#L303) | 'Notes Private', |
| [304](#L304) | 'Email', |
| [305](#L305) | 'Phone Number', |
| [306](#L306) | 'Customer', |
| [307](#L307) | 'Sales Rep' |
| [308](#L308) | ); |
| [309](#L309) |  |
| [310](#L310) | // Add custom fields to column headers |
| [311](#L311) | $custom\_fields = $ewd\_otp\_controller->settings->get\_order\_custom\_fields(); |
| [312](#L312) |  |
| [313](#L313) | foreach ( $custom\_fields as $custom\_field ) { |
| [314](#L314) |  |
| [315](#L315) | $order\_header[] = $custom\_field->name; |
| [316](#L316) | } |
| [317](#L317) |  |
| [318](#L318) | $args = array( |
| [319](#L319) | 'display'                       => true, |
| [320](#L320) | 'orders\_per\_page'       => -1, |
| [321](#L321) | ); |
| [322](#L322) |  |
| [323](#L323) | // Order status |
| [324](#L324) | if( isset( $\_POST['order-by-status'] ) && 0 < count( $\_POST['order-by-status'] ) ) { |
| [325](#L325) |  |
| [326](#L326) | $args['status'] = array\_map( 'sanitize\_text\_field', $\_POST['order-by-status'] ); |
| [327](#L327) | } |
| [328](#L328) |  |
| [329](#L329) | // Order for Date-range |
| [330](#L330) | if ( ! empty( $this->after ) ) { |
| [331](#L331) |  |
| [332](#L332) | // Used to let sales-rep and customers download their data from front-end |
| [333](#L333) | $args['after'] = $this->after; |
| [334](#L334) | } |
| [335](#L335) | elseif( isset( $\_POST['date\_range'] ) ) { |
| [336](#L336) |  |
| [337](#L337) | $args['date\_range'] = sanitize\_text\_field( $\_POST['date\_range'] ); |
| [338](#L338) | } |
| [339](#L339) | elseif( isset( $\_POST['start\_date'] ) || isset( $\_POST['end\_date'] ) ) { |
| [340](#L340) |  |
| [341](#L341) | // just to pass if in order\_manager->prepare\_args() |
| [342](#L342) | $args['date\_range'] = 'custom'; |
| [343](#L343) | $args['start\_date'] = sanitize\_text\_field( $\_POST['start\_date'] ); |
| [344](#L344) | $args['end\_date'] = sanitize\_text\_field( $\_POST['end\_date'] ); |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | // Order of Customer('s) |
| [348](#L348) | if ( ! empty( $this->customer\_id ) ) { |
| [349](#L349) |  |
| [350](#L350) | // Used to let sales-rep and customers download their data from front-end |
| [351](#L351) | $args['customer'] = $this->customer\_id; |
| [352](#L352) | } |
| [353](#L353) | elseif( isset( $\_POST['order-of-customer'] ) && 0 < count( $\_POST['order-of-customer'] ) ) { |
| [354](#L354) |  |
| [355](#L355) | $args['customer'] = array\_map( 'sanitize\_text\_field', $\_POST['order-of-customer'] ); |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | // Order of Sales Rep('s) |
| [359](#L359) | if ( ! empty( $this->sales\_rep\_id ) ) { |
| [360](#L360) |  |
| [361](#L361) | // Used to let sales-rep and customers download their data from front-end |
| [362](#L362) | $args['sales\_rep'] = $this->sales\_rep\_id; |
| [363](#L363) | } |
| [364](#L364) | elseif( isset( $\_POST['order-of-sales-rep'] ) ) { |
| [365](#L365) |  |
| [366](#L366) | $args['sales\_rep'] = array\_map( 'sanitize\_text\_field', $\_POST['order-of-sales-rep'] ); |
| [367](#L367) | } |
| [368](#L368) |  |
| [369](#L369) | // fetching orders |
| [370](#L370) | $orders = $ewd\_otp\_controller->order\_manager->get\_matching\_orders( $args ); |
| [371](#L371) |  |
| [372](#L372) | $data = array(); |
| [373](#L373) |  |
| [374](#L374) | foreach ( $orders as $order ) { |
| [375](#L375) |  |
| [376](#L376) | $record = array( |
| [377](#L377) | $order->name, |
| [378](#L378) | $order->number, |
| [379](#L379) | $order->status, |
| [380](#L380) | $order->status\_updated, |
| [381](#L381) | $order->location, |
| [382](#L382) | ( $order->display ? 'Yes' : 'No' ), |
| [383](#L383) | $order->notes\_public, |
| [384](#L384) | $order->notes\_private, |
| [385](#L385) | $order->email, |
| [386](#L386) | $order->phone\_number, |
| [387](#L387) | max( $order->customer, 0 ), |
| [388](#L388) | max( $order->sales\_rep, 0 ), |
| [389](#L389) | ); |
| [390](#L390) |  |
| [391](#L391) | // Adding custom field data |
| [392](#L392) | foreach ( $custom\_fields as $custom\_field ) { |
| [393](#L393) |  |
| [394](#L394) | $record[] = $ewd\_otp\_controller->order\_manager->get\_field\_value( $custom\_field->id, $order->id ); |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | $data[] = $record; |
| [398](#L398) | } |
| [399](#L399) |  |
| [400](#L400) | return array( |
| [401](#L401) | 'header'        => $order\_header, |
| [402](#L402) | 'data'          => $data, |
| [403](#L403) | 'filename'      => 'order\_export', |
| [404](#L404) | ); |
| [405](#L405) | } |
| [406](#L406) |  |
| [407](#L407) | public function get\_customer\_data() { |
| [408](#L408) | global $ewd\_otp\_controller; |
| [409](#L409) |  |
| [410](#L410) | // Print out the regular customer field labels |
| [411](#L411) | $customer\_header = array( |
| [412](#L412) | 'Customer ID', |
| [413](#L413) | 'Number', |
| [414](#L414) | 'Name', |
| [415](#L415) | 'Email', |
| [416](#L416) | 'Sales Rep ID', |
| [417](#L417) | 'WP ID', |
| [418](#L418) | 'FEUP ID', |
| [419](#L419) | ); |
| [420](#L420) |  |
| [421](#L421) | // Add custom fields to column headers |
| [422](#L422) | $custom\_fields = $ewd\_otp\_controller->settings->get\_customer\_custom\_fields(); |
| [423](#L423) |  |
| [424](#L424) | foreach ( $custom\_fields as $custom\_field ) { |
| [425](#L425) |  |
| [426](#L426) | $customer\_header[] = $custom\_field->name; |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | $args = array( |
| [430](#L430) | 'customers\_per\_page'    => -1, |
| [431](#L431) | ); |
| [432](#L432) |  |
| [433](#L433) | // fetching customers |
| [434](#L434) | $customers = $ewd\_otp\_controller->customer\_manager->get\_matching\_customers( $args ); |
| [435](#L435) |  |
| [436](#L436) | $data = array(); |
| [437](#L437) |  |
| [438](#L438) | foreach ( $customers as $customer ) { |
| [439](#L439) |  |
| [440](#L440) | $record = array( |
| [441](#L441) | $customer->id, |
| [442](#L442) | $customer->number, |
| [443](#L443) | $customer->name, |
| [444](#L444) | $customer->email, |
| [445](#L445) | max( $customer->sales\_rep, 0 ), |
| [446](#L446) | max( $customer->wp\_id, 0 ), |
| [447](#L447) | max( $customer->feup\_id, 0 ), |
| [448](#L448) | ); |
| [449](#L449) |  |
| [450](#L450) | // Adding custom field data |
| [451](#L451) | foreach ( $custom\_fields as $custom\_field ) { |
| [452](#L452) |  |
| [453](#L453) | $record[] = $ewd\_otp\_controller->customer\_manager->get\_field\_value( $custom\_field->id, $customer->id ); |
| [454](#L454) | } |
| [455](#L455) |  |
| [456](#L456) | $data[] = $record; |
| [457](#L457) | } |
| [458](#L458) |  |
| [459](#L459) | return array( |
| [460](#L460) | 'header'        => $customer\_header, |
| [461](#L461) | 'data'          => $data, |
| [462](#L462) | 'filename'      => 'customer\_export', |
| [463](#L463) | ); |
| [464](#L464) | } |
| [465](#L465) |  |
| [466](#L466) | public function get\_sales\_rep\_data() { |
| [467](#L467) | global $ewd\_otp\_controller; |
| [468](#L468) |  |
| [469](#L469) | // Print out the regular sales rep field labels |
| [470](#L470) | $sales\_rep\_header = array( |
| [471](#L471) | 'Sales Rep ID', |
| [472](#L472) | 'Number', |
| [473](#L473) | 'First Name', |
| [474](#L474) | 'Last Name', |
| [475](#L475) | 'Email', |
| [476](#L476) | 'Phone Number', |
| [477](#L477) | 'WP ID', |
| [478](#L478) | ); |
| [479](#L479) |  |
| [480](#L480) | // Add custom fields to column headers |
| [481](#L481) | $custom\_fields = $ewd\_otp\_controller->settings->get\_sales\_rep\_custom\_fields(); |
| [482](#L482) |  |
| [483](#L483) | foreach ( $custom\_fields as $custom\_field ) { |
| [484](#L484) |  |
| [485](#L485) | $sales\_rep\_header[] = $custom\_field->name; |
| [486](#L486) | } |
| [487](#L487) |  |
| [488](#L488) | $args = array( |
| [489](#L489) | 'sales\_reps\_per\_page'   => -1, |
| [490](#L490) | ); |
| [491](#L491) |  |
| [492](#L492) | // fetching sales reps |
| [493](#L493) | $sales\_reps = $ewd\_otp\_controller->sales\_rep\_manager->get\_matching\_sales\_reps( $args ); |
| [494](#L494) |  |
| [495](#L495) | $data = array(); |
| [496](#L496) |  |
| [497](#L497) | foreach ( $sales\_reps as $sales\_rep ) { |
| [498](#L498) |  |
| [499](#L499) | $record = array( |
| [500](#L500) | $sales\_rep->id, |
| [501](#L501) | $sales\_rep->number, |
| [502](#L502) | $sales\_rep->first\_name, |
| [503](#L503) | $sales\_rep->last\_name, |
| [504](#L504) | $sales\_rep->email, |
| [505](#L505) | $sales\_rep->phone\_number, |
| [506](#L506) | max( $sales\_rep->wp\_id, 0 ), |
| [507](#L507) | ); |
| [508](#L508) |  |
| [509](#L509) | // Adding custom field data |
| [510](#L510) | foreach ( $custom\_fields as $custom\_field ) { |
| [511](#L511) |  |
| [512](#L512) | $record[] = $ewd\_otp\_controller->sales\_rep\_manager->get\_field\_value( $custom\_field->id, $customer->id ); |
| [513](#L513) | } |
| [514](#L514) |  |
| [515](#L515) | $data[] = $record; |
| [516](#L516) | } |
| [517](#L517) |  |
| [518](#L518) | return array( |
| [519](#L519) | 'header'        => $sales\_rep\_header, |
| [520](#L520) | 'data'          => $data, |
| [521](#L521) | 'filename'      => 'sales\_rep\_export', |
| [522](#L522) | ); |
| [523](#L523) | } |
| [524](#L524) |  |
| [525](#L525) | public function get\_customer\_list() { |
| [526](#L526) | global $ewd\_otp\_controller; |
| [527](#L527) |  |
| [528](#L528) | $args = array( |
| [529](#L529) | 'orderby' => 'Customer\_Name', |
| [530](#L530) | 'order'   => 'asc', |
| [531](#L531) | 'customers\_per\_page' => -1 |
| [532](#L532) | ); |
| [533](#L533) |  |
| [534](#L534) | return $ewd\_otp\_controller->customer\_manager->get\_matching\_customers( $args ); |
| [535](#L535) | } |
| [536](#L536) |  |
| [537](#L537) | public function get\_sales\_rep\_list() { |
| [538](#L538) | global $ewd\_otp\_controller; |
| [539](#L539) |  |
| [540](#L540) | $args = array( |
| [541](#L541) | 'orderby' => 'Sales\_Rep\_First\_Name', |
| [542](#L542) | 'order'   => 'asc', |
| [543](#L543) | 'sales\_reps\_per\_page' => -1 |
| [544](#L544) | ); |
| [545](#L545) |  |
| [546](#L546) | return $ewd\_otp\_controller->sales\_rep\_manager->get\_matching\_sales\_reps( $args ); |
| [547](#L547) | } |
| [548](#L548) |  |
| [549](#L549) | public function display\_messages() { |
| [550](#L550) |  |
| [551](#L551) | foreach ( $this->messages as $type => $msgs ) { |
| [552](#L552) |  |
| [553](#L553) | echo "<div class='notice notice-{$type}''>"; |
| [554](#L554) | foreach ($msgs as $msg) { |
| [555](#L555) | echo "<p>{$msg}</p>"; |
| [556](#L556) | } |
| [557](#L557) | echo '</div>'; |
| [558](#L558) | } |
| [559](#L559) | } |
| [560](#L560) |  |
| [561](#L561) | public function warning( $msg ) { |
| [562](#L562) |  |
| [563](#L563) | if ( !isset( $this->messages['warning'] ) ) { |
| [564](#L564) |  |
| [565](#L565) | $this->messages['warning'] = array(); |
| [566](#L566) | } |
| [567](#L567) |  |
| [568](#L568) | $this->messages['warning'][] = $msg; |
| [569](#L569) | } |
| [570](#L570) |  |
| [571](#L571) | public function error( $msg ) { |
| [572](#L572) |  |
| [573](#L573) | if ( !isset( $this->messages['error'] ) ) { |
| [574](#L574) |  |
| [575](#L575) | $this->messages['error'] = array(); |
| [576](#L576) | } |
| [577](#L577) |  |
| [578](#L578) | $this->messages['error'][] = $msg; |
| [579](#L579) | } |
| [580](#L580) |  |
| [581](#L581) | public function success( $msg ) { |
| [582](#L582) |  |
| [583](#L583) | if ( !isset( $this->messages['success'] ) ) { |
| [584](#L584) |  |
| [585](#L585) | $this->messages['success'] = array(); |
| [586](#L586) | } |
| [587](#L587) |  |
| [588](#L588) | $this->messages['success'][] = $msg; |
| [589](#L589) | } |
| [590](#L590) |  |
| [591](#L591) | } |
| [592](#L592) |  |
| [593](#L593) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/order-tracking/trunk/includes/Export.class.php?format=txt)
* [Original Format](/export/3222463/order-tracking/trunk/includes/Export.class.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_3f806c0c_20250114_195220.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Order Tracking Pro <= 3.3.6 - Reflected Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Order Tracking Pro <= 3.3.6 - Reflected Cross-Site Scripting

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-4471](https://www.cve.org/CVERecord?id=CVE-2023-4471) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | August 28, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The Order Tracking Pro plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the start\_date and end\_date parameters in versions up to, and including, 3.3.6 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/order-tracking/trunk/includes/Export.class.php#L158)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=2959453%40order-tracking%2Ftrunk&old=2949611%40order-tracking%2Ftrunk&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Forder-tracking%2Forder-tracking-pro-336-reflected-cross-site-scripting&t=Order%20Tracking%20Pro%20%3C%3D%203.3.6%20-%20Reflected%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Forder-tracking%2Forder-tracking-pro-336-reflected-cross-site-scripting&text=Order%20Tracking%20Pro%20%3C%3D%203.3.6%20-%20Reflected%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Forder-tracking%2Forder-tracking-pro-336-reflected-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Order Tracking – WordPress Status Tracking Plugin

#### [Order Tracking – WordPress Status Tracking Plugin](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/order-tracking)

| Software Type | Plugin |
| --- | --- |
| Software Slug | order-tracking [(view on wordpress.org)](https://wordpress.org/plugins/order-tracking) |
| Patched? | Yes |
| Remediation | Update to version 3.3.7, or a newer patched version |
| Affected Version | * <= 3.3.6 |
| Patched Version | * 3.3.7 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_dd34160b_20250114_195219.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2959453%2540order-tracking%252Ftrunk%26old%3D2949611%2540order-tracking%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/2949611/order-tracking/trunk?old=2959453&old_path=%2Forder-tracking%2Ftrunk)

---

# Changes in [order-tracking/trunk](/browser/order-tracking/trunk?rev=2959453 "Show entry in browser") [[2949611:2959453]](/log/order-tracking/trunk?rev=2959453&stop_rev=2949611 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[order-tracking/trunk](/browser/order-tracking/trunk?rev=2959453)
Files:

3 edited

* [includes/Export.class.php](/browser/order-tracking/trunk/includes/Export.class.php?rev=2959453 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [order-tracking.php](/browser/order-tracking/trunk/order-tracking.php?rev=2959453 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))
* [readme.txt](/browser/order-tracking/trunk/readme.txt?rev=2959453 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [order-tracking/trunk/includes/Export.class.php](/changeset/2959453/order-tracking/trunk/includes/Export.class.php?old=2944315&old_path=order-tracking%2Ftrunk%2Fincludes%2FExport.class.php "Show the [2949611:2959453] differences restricted to order-tracking/trunk/includes/Export.class.php")

  | [r2949611](/browser/order-tracking/trunk/includes/Export.class.php?rev=2944315#L126 "Show revision 2949611 of this file in browser") | [r2959453](/browser/order-tracking/trunk/includes/Export.class.php?rev=2959453#L126 "Show revision 2959453 of this file in browser") |  |
  | --- | --- | --- |
  | 126 | 126 | <fieldset> |
  | 127 | 127 | <?php foreach ($order\_status\_list as $record): ?> |
  | 128 |  | <label for="type-of-record-<?php echo ~~$record->status~~;?>" class="sap-admin-input-container"> |
  |  | 128 | <label for="type-of-record-<?php echo esc\_attr( $record->status );?>" class="sap-admin-input-container"> |
  | 129 | 129 | <input type="checkbox" name="order-by-status[]" value="<?php echo $record->status;?>" id="type-of-record-<?php echo $record->status;?>" <?php echo isset($\_POST['order-by-status']) && in\_array($record->status, $\_POST['order-by-status']) ? 'checked' : ''; ?>> |
  | 130 | 130 | <span class="sap-admin-checkbox"></span> |
  | 131 |  | <span><?php echo ~~$record->status~~;?></span> |
  |  | 131 | <span><?php echo esc\_html( $record->status );?></span> |
  | 132 | 132 | </label> |
  | 133 | 133 | <?php endforeach ?> |
  | […](/browser/order-tracking/trunk/includes/Export.class.php?rev=2944315#L156) | […](/browser/order-tracking/trunk/includes/Export.class.php?rev=2959453#L156) |  |
  | 156 | 156 | </label> |
  | 157 | 157 | <label for="date-range-from"><?php \_e( 'From', 'order-tracking' ); ?></label> |
  | 158 |  | <input type="date" name="start\_date" id="date-range-from" value="<?php echo isset( $\_POST['start\_date'] ) ? ~~$\_POST['start\_date']~~ : ''; ?>"> |
  |  | 158 | <input type="date" name="start\_date" id="date-range-from" value="<?php echo isset( $\_POST['start\_date'] ) ? esc\_attr\_\_( $\_POST['start\_date'] ) : ''; ?>"> |
  | 159 | 159 | <label for="date-range-to"><?php \_e( 'To', 'order-tracking' ); ?></label> |
  | 160 |  | <input type="date" name="end\_date" id="date-range-to" value="<?php echo isset( $\_POST['end\_date'] ) ? ~~$\_POST['end\_date']~~ : ''; ?>"> |
  |  | 160 | <input type="date" name="end\_date" id="date-range-to" value="<?php echo isset( $\_POST['end\_date'] ) ? esc\_attr\_\_( $\_POST['end\_date'] ) : ''; ?>"> |
  | 161 | 161 | </fieldset> |
  | 162 | 162 | </td> |
* ## [order-tracking/trunk/order-tracking.php](/changeset/2959453/order-tracking/trunk/order-tracking.php?old=2949611&old_path=order-tracking%2Ftrunk%2Forder-tracking.php "Show the [2949611:2959453] differences restricted to order-tracking/trunk/order-tracking.php")

  | [r2949611](/browser/order-tracking/trunk/order-tracking.php?rev=2949611#L8 "Show revision 2949611 of this file in browser") | [r2959453](/browser/order-tracking/trunk/order-tracking.php?rev=2959453#L8 "Show revision 2959453 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | Terms and Conditions: https://www.etoilewebdesign.com/plugin-terms-and-conditions/ |
  | 9 | 9 | Text Domain: order-tracking |
  | 10 |  | Version: 3.3.~~6~~ |
  | 11 |  | WC requires at least: ~~3.0~~ |
  |  | 10 | Version: 3.3.7 |
  |  | 11 | WC requires at least: 7.1 |
  | 12 | 12 | WC tested up to: 8.0 |
  | 13 | 13 | \*/ |
  | […](/browser/order-tracking/trunk/order-tracking.php?rev=2949611#L47) | […](/browser/order-tracking/trunk/order-tracking.php?rev=2959453#L47) |  |
  | 47 | 47 | define( 'EWD\_OTP\_PLUGIN\_FNAME', plugin\_basename( \_\_FILE\_\_ ) ); |
  | 48 | 48 | define( 'EWD\_OTP\_TEMPLATE\_DIR', 'ewd-otp-templates' ); |
  | 49 |  | define( 'EWD\_OTP\_VERSION', '3.3.~~6~~' ); |
  |  | 49 | define( 'EWD\_OTP\_VERSION', '3.3.7' ); |
  | 50 | 50 | } |
  | 51 | 51 |  |
  | […](/browser/order-tracking/trunk/order-tracking.php?rev=2949611#L168) | […](/browser/order-tracking/trunk/order-tracking.php?rev=2959453#L168) |  |
  | 168 | 168 |  |
  | 169 | 169 | add\_action( 'upgrader\_process\_complete', array( $this, 'update\_tables\_post\_plugin\_update' ), 10, 2 ); |
  |  | 170 |  |
  |  | 171 | add\_action( 'before\_woocommerce\_init', array( $this, 'declare\_wc\_hpos' ) ); |
  | 170 | 172 | } |
  | 171 | 173 |  |
  | […](/browser/order-tracking/trunk/order-tracking.php?rev=2949611#L522) | […](/browser/order-tracking/trunk/order-tracking.php?rev=2959453#L524) |  |
  | 522 | 524 | } |
  | 523 | 525 |  |
  |  | 526 | /\*\* |
  |  | 527 | \* Declares compatibility with WooCommerce High-Performance Order Storage |
  |  | 528 | \* @since 3.3.7 |
  |  | 529 | \*/ |
  |  | 530 | public function declare\_wc\_hpos() { |
  |  | 531 |  |
  |  | 532 | if ( class\_exists( \Automattic\WooCommerce\Utilities\FeaturesUtil::class ) ) { |
  |  | 533 |  |
  |  | 534 | \Automattic\WooCommerce\Utilities\FeaturesUtil::declare\_compatibility( 'custom\_order\_tables', \_\_FILE\_\_, true ); |
  |  | 535 | } |
  |  | 536 | } |
  | 524 | 537 | } |
  | 525 | 538 | } // endif; |
* ## [order-tracking/trunk/readme.txt](/changeset/2959453/order-tracking/trunk/readme.txt?old=2949611&old_path=order-tracking%2Ftrunk%2Freadme.txt "Show the [2949611:2959453] differences restricted to order-tracking/trunk/readme.txt")

  | [r2949611](/browser/order-tracking/trunk/readme.txt?rev=2949611#L5 "Show revision 2949611 of this file in browser") | [r2959453](/browser/order-tracking/trunk/readme.txt?rev=2959453#L5 "Show revision 2959453 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: 5.0 |
  | 6 | 6 | Tested up to: 6.3 |
  | 7 |  | Stable tag: 3.3.~~6~~ |
  |  | 7 | Stable tag: 3.3.7 |
  | 8 | 8 | License: GPLv3 |
  | 9 | 9 | License URI:http://www.gnu.org/licenses/gpl-3.0.html |
  | […](/browser/order-tracking/trunk/readme.txt?rev=2949611#L304) | […](/browser/order-tracking/trunk/readme.txt?rev=2959453#L304) |  |
  | 304 | 304 | == Changelog == |
  | 305 | 305 |  |
  |  | 306 | = 3.3.7 (2023-08-28) = |
  |  | 307 | - Tested and declaring compatibility with WooCommerce High-Performance Order Storage. |
  |  | 308 | - Updates to the escaping/sanitization for elements in the walk-through and the export feature. |
  |  | 309 |  |
  | 306 | 310 | = 3.3.6 (2023-08-08) = |
  | 307 | 311 | - Tested for WordPress 6.3 compatibility/support. |
  | […](/browser/order-tracking/trunk/readme.txt?rev=2949611#L335) | […](/browser/order-tracking/trunk/readme.txt?rev=2959453#L339) |  |
  | 335 | 339 | - Fixed an issue with custom field values not displaying correctly in notifications. |
  | 336 | 340 |  |
  | 337 |  | = 3.2.5 (2023-04-06) = |
  | 338 |  | - Fix for selected sales rep not saving on customer edit screen. |
  | 339 |  |  |
  | 340 |  | = 3.2.4 (2023-03-30) = |
  | 341 |  | - Added a new order number search shortcode and block that lets you place an input/search box on any page, so people can search for an order number and get redirected to the tracking page with the results. |
  | 342 |  | - Updatied blocks for compatibility with WordPress 6.2. |
  | 343 |  |  |
  | 344 |  | = 3.2.3 (2023-01-04) = |
  | 345 |  | - Fixes a potential fatal error on the settings page. |
  | 346 |  |  |
  | 347 |  | = 3.2.2 (2023-01-03) = |
  | 348 |  | - Update to the settings page to correct an issue that could cause an error to display for checkbox options. |
  | 349 |  | - Fixed issue with customers tab (in the admin) not paginating correctly. |
  | 350 |  |  |
  | 351 |  | = 3.2.1 (2022-12-19) = |
  | 352 |  | - Corrected an issue sometimes causing a notice or error when creating a customer or sales rep after updating the plugin. |
  | 353 |  | - Updating an incorrect link and a typo in the admin screens. |
  | 354 |  |  |
  | 355 |  | = 3.2.0 (2022-12-09) = |
  | 356 |  | - Added new tutorial videos to the settings pages that explain and show what each option does. |
  | 357 |  | - Added quick links to the admin about page to re-run the walk-through, view tutorial videos and suggest a feature. |
  | 358 |  | - Added the ability to specify a customer number for each customer and a sales rep number for each sales rep, which can be used in the corresponding tracking forms instead of the auto-generated ID. |
  | 359 |  | - Added filtering options (status, time period, customer and/or sales rep) to the export functionality. |
  | 360 |  | - Fixed an issue with certain characters not being supported in exports. |
  | 361 |  | - Tested with PHP 8.1 and updated deprecated function use. |
  | 362 |  |  |
  | 363 |  | = 3.1.7 (2022-10-05) = |
  | 364 |  | - Fixed an issue in which, if you manually added a new order in the admin and then immediately clicked Update Order, it would create a duplicate new order. |
  | 365 |  |  |
  | 366 |  | = 3.1.6 (2022-08-17) = |
  | 367 |  | - Updated the import process so it automatically assigns an order to a customer if the email address for the order provided in the spreadsheet matches the email address of an existing customer (must have the "Assign Orders to Customers" option enabled). |
  | 368 |  | - Added a div around the instructions text in the various tracking forms, so that text can be specifically targeted for custom styling. |
  | 369 |  | - Fixed an issue in which orders couldn't have their payment status set back to no via the admin. |
  | 370 |  | - Small styling updates for the order edit screen. |
  | 371 |  |  |
  | 372 |  | = 3.1.5 (2022-06-16) = |
  | 373 |  | - Updated the customer and sales rep form result tables to make use of the "Use WP Timezone" and "Date/Time Format" settings. |
  | 374 |  | - On the admin edit screen for a sales rep or customer, updated the table that shows all associated orders to make use of the "Use WP Timezone" and "Date/Time Format" settings. |
  | 375 |  |  |
  | 376 |  | = 3.1.4 (2022-06-08) = |
  | 377 |  | - Added a context to sanitize title calls, to allow for customization of them. |
  | 378 |  |  |
  | 379 |  | = 3.1.3 (2022-05-20) = |
  | 380 |  | - Tested with WordPress 6.0. |
  | 381 |  |  |
  | 382 |  | = 3.1.2 (2022-05-17) = |
  | 383 |  | - Added previews for Gutenberg blocks (i.e. on the page edit screen, when you add the block, it will show a preview). |
  | 384 |  |  |
  | 385 |  | = 3.1.1 (2022-04-14) = |
  | 386 |  | - Added a redirect option for the customer order form. Use the success\_redirect\_page attribute in the shortcode or the parameter in the block. |
  | 387 |  | - Added a reCAPTCHA option for the customer order form. |
  | 388 |  | - Added an option to send status update notifications to sales reps as well. |
  | 389 |  | - Added filtering options to the export. |
  | 390 |  | - Switched notes fields on the order edit screens to text areas. |
  | 391 |  | - Styling updates to the Orders, Sales Reps and Customers admin screens. |
  | 392 |  | - Fixed issue in which checkbox type custom fields were not saving correctly on the sales rep and customer edit screens. |
  | 393 |  |  |
  | 394 |  | = 3.1.0 (2022-02-01) = |
  | 395 |  | - Updated escaping and sanitizing. |
  | 396 |  | - Updated nonces and capability checks. |
  | 397 |  | - Changed how premium settings areas are previewed. |
  | 398 |  | - Fixed compatibility issue when using block-based themes. |
  | 399 |  | - Added a location attribute to the customer order shortcode to specify the default/starting location for a submitted order. |
  | 400 |  | - Added a dropdown to the customer order form block to select the default/starting location for a submitted order. |
  | 401 |  |  |
  | 402 |  | = 3.0.17 (2022-01-06) = |
  | 403 |  | - A few styling fixes in the walk-through and admin panel. |
  | 404 |  | - Updated nonces in the admin. |
  | 405 |  | - Added a notice pertaining to the requirement of the premium helper plugin to access premium settings and content. |
  | 406 |  |  |
  | 407 |  | = 3.0.16 (2021-11-26) = |
  | 408 |  | - Added an option to use what you set as your timezone in WordPress for the displayed timestamp for status updates. (By default, it uses your server's time, which may not be the same.) |
  | 409 |  | - Made the order numbers links in the dashboard order summary area, which open the order edit screen. |
  | 410 |  |  |
  | 411 |  | = 3.0.15 (2021-11-03) = |
  | 412 |  | - Update to SAP library version 2.6.1 |
  | 413 |  | - Makes a number of setting's display conditional on another setting having a specific value |
  | 414 |  | - Fix for statuses incorrectly being set to internal during front-end updating at times |
  | 415 |  | - Fix for a number of notices |
  | 416 |  |  |
  | 417 |  | = 3.0.14 (2021-10-18) = |
  | 418 |  | - Fixes an issue where some sales reps were unable to access their orders in the admin |
  | 419 |  |  |
  | 420 |  | = 3.0.13 (2021-10-08) = |
  | 421 |  | - Fixes an issue where custom fields were not being added correctly when sending emails with UWPM |
  | 422 |  | - Removes a number of notices when the sales rep or customer aren't set but are being displayed in the order tracking results. |
  | 423 |  |  |
  | 424 |  | = 3.0.12 (2021-09-30) = |
  | 425 |  | - Corrected an issue in which, in certain circumstances, the customer form and sales rep form were returning results when an invalid number/ID was input. |
  | 426 |  |  |
  | 427 |  | = 3.0.11 (2021-09-09) = |
  | 428 |  | - Fix for WooCommerce order statuses always being reverted on deactivation. |
  | 429 |  |  |
  | 430 |  | = 3.0.10 (2021-09-08) = |
  | 431 |  | - Updated the settings page library. |
  | 432 |  | - Added a link type custom field. |
  | 433 |  | - Updated so status email notifications are triggered when bulk updating orders via spreadsheet. |
  | 434 |  | - Added option to set number of orders per page in the admin ORDERS tab |
  | 435 |  | - Fix for status not being set when order submitted via the customer order form. |
  | 436 |  | - Fix for email not being sent to customer when order submitted via the customer order form. |
  | 437 |  | - Fix for emails created in Ultimate WP Mail not being sent on status change. |
  | 438 |  |  |
  | 439 |  | = 3.0.9 (2021-08-12) = |
  | 440 |  | - Fixed Gutenberg blocks |
  | 441 |  | - Updated deprecated block\_categories |
  | 442 |  |  |
  | 443 |  | = 3.0.8 (2021-07-14) = |
  | 444 |  | - Corrects an issue in which, in a rare instance, the update status form was showing on the front-end tracking page for non-logged in users. |
  | 445 |  |  |
  | 446 |  | = 3.0.7 (2021-07-02) = |
  | 447 |  | - Fixed an issue in which, in some rare instances, the update status form was still showing on the front-end tracking page for non-logged in users. |
  | 448 |  | - Fixed an issue in which the order tracking tags in the Ultimate WP Mail plugin were showing under the wrong label. |
  | 449 |  | - Fixed a typo in the walk-through. |
  | 450 |  |  |
  | 451 |  | = 3.0.6 (2021-06-18) = |
  | 452 |  | - Fixed an integration issue with the Ultimate WP Mail plugin, in which emails created in that plugin were not selectable for a status. |
  | 453 |  |  |
  | 454 |  | = 3.0.5 (2021-06-14) = |
  | 455 |  | - Re-introduces the ability to update orders via import, if an order number in the spreadsheet matches an existing one. |
  | 456 |  | - Adds Location, Sales Rep and Customer to the export spreadsheet. |
  | 457 |  |  |
  | 458 |  | = 3.0.4 (2021-06-10) = |
  | 459 |  | - Fixed an issue where changes to custom field values for an order were not showing on the front-end tracking page (it was showing an older value). |
  | 460 |  | - Localizing the delete button for individual statuses on the order edit screen. |
  | 461 |  | - Eliminating a PHP notice. |
  | 462 |  |  |
  | 463 |  | = 3.0.3 (2021-06-03) = |
  | 464 |  | - Fixed an issue with imported orders not being correctly assigned the specified status. |
  | 465 |  | - Fixed an issue in which the tracking page update status feature was not working correctly. |
  | 466 |  | - Fixed an issue where the update status feature was sometimes showing on the tracking page for non-logged-in customers when the order was imported from spreadsheet and not yet edited or saved. |
  | 467 |  | - Fixed an issue in which, if you typed, on the tracking page, an order number that didn't exist, it would display an empty template instead of the "no orders found" message. |
  | 468 |  |  |
  | 469 |  | = 3.0.2 (2021-05-28) = |
  | 470 |  | - Fixed an issue with pagination on the orders admin screen. |
  | 471 |  | - Fixed an issue with (not) being able to delete past statuses from the order edit screen. |
  | 472 |  |  |
  | 473 |  | = 3.0.1 (2021-05-25) = |
  | 474 |  | - Added in the ability to have the tracking number be a link (to the tracking page) in the customer and sales rep forms when AJAX reloading is disabled. |
  | 475 |  | - Added styling to the row hover when viewing the customer or sales rep form with AJAX enabled (not disabled) to make it more obvious that it is clickable (brings you to the tracking page for that order). |
  | 476 |  | - Added (back) in the ability to show hidden orders in the admin orders table. |
  | 477 |  | - Fixed an issue where the date filtering on the orders admin screen was sometimes blocking the other filters from being clickable. |
  | 478 |  | - Fixed an error with bulk setting orders to a specific status. |
  | 479 |  | - Fixed an issue with setting orders to payment received. |
  | 480 |  | - Fixed an issue in which the order ID was being displayed, instead of the order number, as part of the default thank you message after submitting the customer order form. |
  | 481 |  |  |
  | 482 |  | = 3.0.0 (2021-05-20) = |
  | 483 |  | - <strong>This update includes quite a big change to the construction of the plugin, so please take caution and test before updating on a live site (or wait a few days before updating in case some minor corrective updates need to be released).</strong> |
  | 484 |  | - Rebuilt the plugin, from the ground up, to be object oriented. |
  | 485 |  | - Updated the structure of the settings pages. |
  | 486 |  | - CSS/styling updates. |
  | 487 |  | - Updates to the walk-through that runs on plugin activation. |
  | 488 |  | - Fixed a few small issues with the WooCommerce integration and sync. |
  | 489 |  | - Update to the statistics, so you can now see the number of views as well as data for the link clicking directly on the order edit screen. |
  | 490 |  | - Updates to custom fields and how they tie in with customers and sales reps. |
  | 491 |  | - Updated the custom fields edit screen. |
  | 492 |  | - Fixed a few small issues with certain custom field types and the customer order form. |
  | 493 |  | - Updates to several styling and labelling options. |
  | 494 |  | - Updates to the conditional enqueuing of assets. |
  | 495 |  | - Cleaning up/removing unnecessary code and files. |
  | 496 |  | - Updated .pot file. (If you have created a translation based on the old version, you might need to update your .po file for this new version.) |
  |  | 341 | [See changelog for all versions](https://www.etoilewebdesign.com/changelogs/order-tracking.txt). |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2959453&old=2949611&new_path=%2Forder-tracking%2Ftrunk&old_path=%2Forder-tracking%2Ftrunk)
* [Zip Archive](?format=zip&new=2959453&old=2949611&new_path=%2Forder-tracking%2Ftrunk&old_path=%2Forder-tracking%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


