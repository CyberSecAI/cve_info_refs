=== Content from gist.github.com_c3b82d13_20250114_200727.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@dmknght](https://avatars.githubusercontent.com/u/29118926?s=64&v=4)](/dmknght)

# [dmknght](/dmknght)/**[totolink\_ex1200L.md](/dmknght/02a29e1c5ae18b45eacc2085d22068e8)**

Last active
August 27, 2023 08:09

Show Gist options

* [Download ZIP](/dmknght/02a29e1c5ae18b45eacc2085d22068e8/archive/9f94ca5a81239197189d4fb6d6bb26eaa3f069f7.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/dmknght/02a29e1c5ae18b45eacc2085d22068e8.js&quot;&gt;&lt;/script&gt;
* Save dmknght/02a29e1c5ae18b45eacc2085d22068e8 to your computer and use it in GitHub Desktop.

[Code](/dmknght/02a29e1c5ae18b45eacc2085d22068e8)
[Revisions
10](/dmknght/02a29e1c5ae18b45eacc2085d22068e8/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/dmknght/02a29e1c5ae18b45eacc2085d22068e8.js&quot;&gt;&lt;/script&gt;

Save dmknght/02a29e1c5ae18b45eacc2085d22068e8 to your computer and use it in GitHub Desktop.

[Download ZIP](/dmknght/02a29e1c5ae18b45eacc2085d22068e8/archive/9f94ca5a81239197189d4fb6d6bb26eaa3f069f7.zip)

Multiple OS command Injection in TOTOLink EX1200L firmware

 [Raw](/dmknght/02a29e1c5ae18b45eacc2085d22068e8/raw/9f94ca5a81239197189d4fb6d6bb26eaa3f069f7/totolink_ex1200L.md)

[**totolink\_ex1200L.md**](#file-totolink_ex1200l-md)

# Research info

## Firmware

* Build version: EN\_V9.3.5u.6146\_B20201023
* Download URL: <https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/217/ids/36.html>

## Description and impact

These vulnerabilities allow attacker executes remote OS command as root. The build version was 2020 so It's possibly attacker can send unauthenticated requests to `cgi-bin`

## Root-cause

Totolink's cgi-bin shares the code with other firmware. While the other firmware was analyzed, reported by researchers (and fixed), this firmware wasn't fixed by Totolink company.

# Vulnerability details

## OS command injection in `setDiagnosisCfg`

### Description and impact

Function `setDiagnosisCfg` executes os command `ping`. An attacker can execute remote os command using crafted payload at `Ping Address`

### Root-cause

When the function `setDiagnosisCfg` is called, it crafts the ping command following syntax `ping %s -w %d &>/var/log/pingCheck`
The value of `Ping Address` is not validated, therefore an attacker can send a craftted payload to execute OS command and get the command output with `getDiagnosisCfg`
[![image](https://user-images.githubusercontent.com/29118926/257681109-d7537698-dd93-4ce5-be77-70cecd179d4c.png)](https://user-images.githubusercontent.com/29118926/257681109-d7537698-dd93-4ce5-be77-70cecd179d4c.png)

## OS command injection in traceroute

### Description and impact

Function `setTracerouteCfg` executes os command `traceroute`. An attacker can execute remote os command using crafted payload at `Trace Address`

### Root cause

When the function `setTracerouteCfg` is called, it crafts the ping command following syntax `traceroute -m %d %s&>/var/log/traceRouteLog`. The value of `Trace Address` is not validated, therefore an attacker can send crafted payload to execute OS command and get the command output with `getTracerouteCfg`
[![image](https://user-images.githubusercontent.com/29118926/257681369-2532e044-ab89-4529-a2f9-e83616c9124e.png)](https://user-images.githubusercontent.com/29118926/257681369-2532e044-ab89-4529-a2f9-e83616c9124e.png)

## Blind OS command injection in hostname via setWanCfg

### Description and impact

Function `setWanCfg` executes os command `echo` to overwrite hostname. An attacker can execute remote os command using crafted payload at `Host Name`.

### Root-cause

When the function `setWanCfg` is called, it crafts os command following syntax `echo '%s' > /proc/sys/kernel/hostname`. The value of `Host name` is not validated. An attacker can send crafted payload to execute OS command.
[![image](https://user-images.githubusercontent.com/29118926/257681580-135b9274-1f06-4a2b-b5cd-6c820e78a178.png)](https://user-images.githubusercontent.com/29118926/257681580-135b9274-1f06-4a2b-b5cd-6c820e78a178.png)

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fdmknght%2F02a29e1c5ae18b45eacc2085d22068e8)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


