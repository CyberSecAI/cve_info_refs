=== Content from plugins.trac.wordpress.org_125b7736_20250114_190916.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fsocial-warfare%2Ftags%2F4.4.1%2Flib%2Fbuttons-panel%2FSWP_Buttons_Panel_Trait.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php)

---

# [source:](/browser?order=name "Go to repository root") [social-warfare](/browser/social-warfare?order=name "View social-warfare")/[tags](/browser/social-warfare/tags?order=name "View tags")/[4.4.1](/browser/social-warfare/tags/4.4.1?order=name "View 4.4.1")/[lib](/browser/social-warfare/tags/4.4.1/lib?order=name "View lib")/[buttons-panel](/browser/social-warfare/tags/4.4.1/lib/buttons-panel?order=name "View buttons-panel")/[SWP\_Buttons\_Panel\_Trait.php](/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?order=name "View SWP_Buttons_Panel_Trait.php")

View diff against:

View revision:

| [Last change](/changeset/2865844/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php "View differences") on this file was [2865844](/changeset/2865844/ "View changeset 2865844"), checked in by WarfarePlugins, [2 years ago](/timeline?from=2023-02-15T16%3A23%3A43Z&precision=second "See timeline at 02/15/2023 04:23:43 PM") |
| --- |
| Updating version number to 4.4.1 |
| **File size:** 26.3 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* SWP\_Buttons\_Panel\_Trait |
| [5](#L5) | \* |
| [6](#L6) | \* The purpose of this trait is to allow access to commonly used methods |
| [7](#L7) | \* throughout the various Buttons\_Panel classes of the plugin without having to |
| [8](#L8) | \* force the extension of an abstract class onto them. |
| [9](#L9) | \* |
| [10](#L10) | \*     create\_panel(); |
| [11](#L11) | \* |
| [12](#L12) | \*     generate\_panel\_html(); |
| [13](#L13) | \*     generate\_individual\_buttons\_html(); |
| [14](#L14) | \*     generate\_total\_shares\_html(); |
| [15](#L15) | \* |
| [16](#L16) | \*     should\_panel\_display(); |
| [17](#L17) | \*     should\_total\_shares\_display(); |
| [18](#L18) | \* |
| [19](#L19) | \*     get\_alignment(); |
| [20](#L20) | \*     get\_colors(); |
| [21](#L21) | \*     get\_shape(); |
| [22](#L22) | \*     get\_scale(); |
| [23](#L23) | \*     get\_min\_width(); |
| [24](#L24) | \*     get\_float\_background(); |
| [25](#L25) | \*     get\_option(); |
| [26](#L26) | \*     get\_float\_location(); |
| [27](#L27) | \*     get\_mobile\_float\_location(); |
| [28](#L28) | \*     get\_order\_of\_icons(); |
| [29](#L29) | \*     get\_ordered\_network\_objects(); |
| [30](#L30) | \*     get\_key\_from\_name(); |
| [31](#L31) | \* |
| [32](#L32) | \* |
| [33](#L33) | \* |
| [34](#L34) | \* @since 3.4.0 | 21 SEP 2018 | Created |
| [35](#L35) | \* |
| [36](#L36) | \*/ |
| [37](#L37) | trait SWP\_Buttons\_Panel\_Trait { |
| [38](#L38) |  |
| [39](#L39) |  |
| [40](#L40) | protected function append\_panel\_to\_content() { |
| [41](#L41) |  |
| [42](#L42) |  |
| [43](#L43) | /\*\* |
| [44](#L44) | \* If the panel type is static\_horizontal, then the switch below will |
| [45](#L45) | \* determine the lcoation setting and append the html to the content |
| [46](#L46) | \* according to that location. |
| [47](#L47) | \* |
| [48](#L48) | \*/ |
| [49](#L49) | if( $this->panel\_type === 'static\_horizontal' ) { |
| [50](#L50) | switch ($this->location) { |
| [51](#L51) | case 'both' : |
| [52](#L52) | $content = $this->html . $this->content . $this->html; |
| [53](#L53) | break; |
| [54](#L54) | case 'above' : |
| [55](#L55) | $content = $this->html . $this->content; |
| [56](#L56) | break; |
| [57](#L57) | case 'below' : |
| [58](#L58) | $content = $this->content . $this->html; |
| [59](#L59) | break; |
| [60](#L60) |  |
| [61](#L61) | case 'none' : |
| [62](#L62) | $content = $this->content; |
| [63](#L63) | default : |
| [64](#L64) | $content = $this->content; |
| [65](#L65) | break; |
| [66](#L66) | } |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) |  |
| [70](#L70) | /\*\* |
| [71](#L71) | \* If the panel type is floating\_side, then forget the content because |
| [72](#L72) | \* it will be empty. Instead just replace the content to be returned |
| [73](#L73) | \* with the generated html for the panel. |
| [74](#L74) | \* |
| [75](#L75) | \*/ |
| [76](#L76) | if( $this->panel\_type === 'floating\_side' ) { |
| [77](#L77) | $content = $this->html; |
| [78](#L78) | } |
| [79](#L79) |  |
| [80](#L80) | $this->content = $content; |
| [81](#L81) |  |
| [82](#L82) | if ( isset( $this->args['echo']) && true === $this->args['echo'] ) { |
| [83](#L83) | echo $this->content; |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | return $this->content; |
| [87](#L87) | } |
| [88](#L88) |  |
| [89](#L89) | /\*\* |
| [90](#L90) | \* Takes a display name and returns the snake\_cased key of that name. |
| [91](#L91) | \* |
| [92](#L92) | \* This is used to convert a network's name, such as Google Plus, |
| [93](#L93) | \* to the database-friendly key of google\_plus. |
| [94](#L94) | \* |
| [95](#L95) | \* @since  3.0.0 | 18 APR 2018 | Created |
| [96](#L96) | \* @param  string $name The string to convert. |
| [97](#L97) | \* @return string The converted string. |
| [98](#L98) | \* |
| [99](#L99) | \*/ |
| [100](#L100) | public function get\_key\_from\_name( $string ) { |
| [101](#L101) | return preg\_replace( '/[\s]+/', '\_', strtolower( trim ( $string ) ) ); |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) |  |
| [105](#L105) | /\*\* |
| [106](#L106) | \* Tells you true/false if the buttons should print on this page. |
| [107](#L107) | \* |
| [108](#L108) | \* Each variable is a boolean value. For the buttons to eligible for printing, |
| [109](#L109) | \* each of the variables must evaluate to true. |
| [110](#L110) | \* |
| [111](#L111) | \* $user\_settings: Options editable by the Admin user. |
| [112](#L112) | \* $desired\_conditions: WordPress conditions we require for the buttons. |
| [113](#L113) | \* $undesired\_conditions: WordPress pages where we do not display the buttons. |
| [114](#L114) | \* |
| [115](#L115) | \* |
| [116](#L116) | \* @return Boolean True if the buttons are okay to print, else false. |
| [117](#L117) | \* @since  3.0.8 | 21 MAY 2018 | Added extra condition to check for content |
| [118](#L118) | \*                               (for calls to social\_warfare()). |
| [119](#L119) | \* @since  3.3.3 | 18 SEP 2018 | Added check for in\_the\_loop(). |
| [120](#L120) | \* @since  3.4.0 | 24 OCT 2018 | Added check for $this->post\_data. |
| [121](#L121) | \* @param  void |
| [122](#L122) | \* @return void |
| [123](#L123) | \* |
| [124](#L124) | \*/ |
| [125](#L125) | public function should\_panel\_display() { |
| [126](#L126) |  |
| [127](#L127) |  |
| [128](#L128) | /\*\* |
| [129](#L129) | \* If for some reason the post\_data failed to populate, we just have to |
| [130](#L130) | \* bail out so the PHP doesn't throw undefined property errors. |
| [131](#L131) | \* |
| [132](#L132) | \*/ |
| [133](#L133) | if( empty( $this->post\_data ) ) { |
| [134](#L134) | return false; |
| [135](#L135) | } |
| [136](#L136) |  |
| [137](#L137) |  |
| [138](#L138) | /\*\* |
| [139](#L139) | \* WordPress requires title and content. This indicates the buttons are |
| [140](#L140) | \* called via social\_warfare() or via the shortcode. |
| [141](#L141) | \* |
| [142](#L142) | \*/ |
| [143](#L143) | if ( empty( $this->content ) && !isset( $this->args['content'] )  ) { |
| [144](#L144) | return true; |
| [145](#L145) | } |
| [146](#L146) |  |
| [147](#L147) |  |
| [148](#L148) | $user\_settings        = 'none' !== $this->location; |
| [149](#L149) | $desired\_conditions   = is\_main\_query() && in\_the\_loop() && get\_post\_status( $this->post\_id ) === 'publish'; |
| [150](#L150) | $undesired\_conditions = is\_admin() || is\_feed() || is\_search() || is\_attachment() || is\_preview(); |
| [151](#L151) |  |
| [152](#L152) | return $user\_settings && $desired\_conditions && !$undesired\_conditions; |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) |  |
| [156](#L156) | /\*\* |
| [157](#L157) | \* A method to get the alignment when scale is set below 100%. |
| [158](#L158) | \* |
| [159](#L159) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [160](#L160) | \* @param  void |
| [161](#L161) | \* @return string A string of the appropriate CSS class to add to the panel. |
| [162](#L162) | \* |
| [163](#L163) | \*/ |
| [164](#L164) | protected function get\_alignment() { |
| [165](#L165) | return ' scale-' . $this->get\_option('button\_alignment'); |
| [166](#L166) | } |
| [167](#L167) |  |
| [168](#L168) |  |
| [169](#L169) | /\*\* |
| [170](#L170) | \* A function to get the color states for this buttons panel. |
| [171](#L171) | \* |
| [172](#L172) | \* All of the buttons contain 3 states: default, hover, and single. The |
| [173](#L173) | \* default state is what the buttons look like when not being interacted |
| [174](#L174) | \* with. The hover is what all the buttons in the panel look like when |
| [175](#L175) | \* the panel is being hovered. The single is what the individual button |
| [176](#L176) | \* being hovered will look like. |
| [177](#L177) | \* |
| [178](#L178) | \* This method handles generating the classes that the CSS can target to |
| [179](#L179) | \* ensure that all three of those states work. |
| [180](#L180) | \* |
| [181](#L181) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [182](#L182) | \* @since  3.3.2 | 13 SEP 2018 | Modified to control float selectors better |
| [183](#L183) | \* @param  boolean $float Whether this is a floating panel or not. |
| [184](#L184) | \* @return string  The string of CSS classes to be used on the panel. |
| [185](#L185) | \* |
| [186](#L186) | \*/ |
| [187](#L187) | protected function get\_colors( $float = false ) { |
| [188](#L188) |  |
| [189](#L189) |  |
| [190](#L190) | /\*\* |
| [191](#L191) | \* If pro was installed, but no longer is installed or activated, |
| [192](#L192) | \* then this option won't exist and will return false. If so, then |
| [193](#L193) | \* we output the default core color/style classes. |
| [194](#L194) | \* |
| [195](#L195) | \*/ |
| [196](#L196) | if ( false === $this->get\_option( 'default\_colors' ) ) { |
| [197](#L197) | return " swp\_default\_full\_color swp\_individual\_full\_color swp\_other\_full\_color "; |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) |  |
| [201](#L201) | /\*\* |
| [202](#L202) | \* If the buttons are the static horizontal buttons (not the float), |
| [203](#L203) | \* or if it is the float but we are inheriting the styles from the |
| [204](#L204) | \* horizontal buttons, then just output the CSS classes that are used |
| [205](#L205) | \* for the horizontal buttons. |
| [206](#L206) | \* |
| [207](#L207) | \* "float\_style\_source" on the options page is actually answering |
| [208](#L208) | \* the question "Do the floating buttons inherit their colors from |
| [209](#L209) | \* the horizontal buttons?" It will be true if they do, and false if |
| [210](#L210) | \* they don't. |
| [211](#L211) | \* |
| [212](#L212) | \*/ |
| [213](#L213) | $prefix = ''; |
| [214](#L214) |  |
| [215](#L215) |  |
| [216](#L216) | /\*\* |
| [217](#L217) | \* If this is a set of floating buttons and we are not inheriting |
| [218](#L218) | \* the color styles from the static floating buttons, then we need |
| [219](#L219) | \* to return the style classes that are specific to the floating |
| [220](#L220) | \* buttons being rendered. |
| [221](#L221) | \* |
| [222](#L222) | \*/ |
| [223](#L223) | if( true === $float && false === $this->options['float\_style\_source'] ) { |
| [224](#L224) | $prefix = 'float\_'; |
| [225](#L225) | } |
| [226](#L226) |  |
| [227](#L227) |  |
| [228](#L228) | /\*\* |
| [229](#L229) | \* |
| [230](#L230) | \* If it's a static, horizontal panel, there is no prefix. If it's |
| [231](#L231) | \* a floating panel, there is a prefix. However, the prefix needs |
| [232](#L232) | \* to be removed for the CSS class name that is actualy output. |
| [233](#L233) | \* |
| [234](#L234) | \* So here we fetch the appropriate color options, strip out the |
| [235](#L235) | \* "float\_" prefix since we don't use that on the actual CSS |
| [236](#L236) | \* selector, and then return the CSS classes that will be added to |
| [237](#L237) | \* this buttons panel that is being rendered. |
| [238](#L238) | \* |
| [239](#L239) | \*/ |
| [240](#L240) | $default = str\_replace( $prefix, '', $this->get\_option( $prefix . 'default\_colors' ) ); |
| [241](#L241) | $hover   = str\_replace( $prefix, '', $this->get\_option( $prefix . 'hover\_colors' ) ); |
| [242](#L242) | $single  = str\_replace( $prefix, '', $this->get\_option( $prefix . 'single\_colors' ) ); |
| [243](#L243) | return " swp\_default\_{$default} swp\_other\_{$hover} swp\_individual\_{$single} "; |
| [244](#L244) |  |
| [245](#L245) | } |
| [246](#L246) |  |
| [247](#L247) |  |
| [248](#L248) | /\*\* |
| [249](#L249) | \* A method to fetch/determine the shape of the current buttons. |
| [250](#L250) | \* |
| [251](#L251) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [252](#L252) | \* @param  void |
| [253](#L253) | \* @return string The string of the CSS class to be used. |
| [254](#L254) | \* |
| [255](#L255) | \*/ |
| [256](#L256) | protected function get\_shape() { |
| [257](#L257) | $button\_shape = $this->get\_option( 'button\_shape' ); |
| [258](#L258) |  |
| [259](#L259) | //\* They have gone from an Addon to Core. |
| [260](#L260) | if ( false === $button\_shape ) { |
| [261](#L261) | return "swp\_flat\_fresh "; |
| [262](#L262) | } |
| [263](#L263) |  |
| [264](#L264) | return "swp\_{$button\_shape} "; |
| [265](#L265) | } |
| [266](#L266) |  |
| [267](#L267) |  |
| [268](#L268) | /\*\* |
| [269](#L269) | \* A method to fetch/determine the size/scale of the panel. |
| [270](#L270) | \* |
| [271](#L271) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [272](#L272) | \* @param  void |
| [273](#L273) | \* @return string The CSS class to be added to the panel. |
| [274](#L274) | \* |
| [275](#L275) | \*/ |
| [276](#L276) | protected function get\_scale() { |
| [277](#L277) | $button\_size = $this->get\_option( 'button\_size' ); |
| [278](#L278) |  |
| [279](#L279) | //\* They have gone from an Addon to Core. |
| [280](#L280) | if ( false === $button\_size ) { |
| [281](#L281) | return "scale-100 "; |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | return 'scale-' . $button\_size \* 100; |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) |  |
| [288](#L288) | /\*\* |
| [289](#L289) | \* A method for getting the minimum width of the buttons panel. |
| [290](#L290) | \* |
| [291](#L291) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [292](#L292) | \* @param  void |
| [293](#L293) | \* @return string The HTML attribute to be added to the buttons panel. |
| [294](#L294) | \* |
| [295](#L295) | \*/ |
| [296](#L296) | protected function get\_min\_width() { |
| [297](#L297) | $min\_width = $this->get\_option( 'float\_screen\_width' ); |
| [298](#L298) |  |
| [299](#L299) | //\* They have gone from an Addon to Core. |
| [300](#L300) | if ( false === $min\_width ) { |
| [301](#L301) | return 'data-min-width="1100" '; |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | return 'data-min-width="' . $min\_width . '" '; |
| [305](#L305) | } |
| [306](#L306) |  |
| [307](#L307) |  |
| [308](#L308) | /\*\* |
| [309](#L309) | \* A method for getting the ID of the current post. |
| [310](#L310) | \* |
| [311](#L311) | \* @since  4.0.1 | 01 APR 2020 | Created |
| [312](#L312) | \* @param  void |
| [313](#L313) | \* @return string The HTML attribute to be added to the buttons panel. |
| [314](#L314) | \* |
| [315](#L315) | \*/ |
| [316](#L316) | protected function get\_post\_id\_attribute() { |
| [317](#L317) | return 'data-post-id="'.$this->post\_id.'" '; |
| [318](#L318) | } |
| [319](#L319) |  |
| [320](#L320) |  |
| [321](#L321) | /\*\* |
| [322](#L322) | \* A method for getting the transition mode for the side floating buttons. |
| [323](#L323) | \* |
| [324](#L324) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [325](#L325) | \* @param  void |
| [326](#L326) | \* @return string The HTML attribute to be added to the buttons panel. |
| [327](#L327) | \* |
| [328](#L328) | \*/ |
| [329](#L329) | protected function get\_float\_transition() { |
| [330](#L330) | $transition = $this->get\_option( 'transition' ); |
| [331](#L331) |  |
| [332](#L332) | //\* They have gone from an Addon to Core. |
| [333](#L333) | if ( false === $transition ) { |
| [334](#L334) | return 'data-transition="slide" '; |
| [335](#L335) | } |
| [336](#L336) |  |
| [337](#L337) | return 'data-transition="' . $transition . '" '; |
| [338](#L338) | } |
| [339](#L339) |  |
| [340](#L340) |  |
| [341](#L341) | /\*\* |
| [342](#L342) | \* A method to determin the background color of the floating buttons. |
| [343](#L343) | \* |
| [344](#L344) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [345](#L345) | \* @param  void |
| [346](#L346) | \* @return string The HTML attribute to be added to the buttons panel. |
| [347](#L347) | \* |
| [348](#L348) | \*/ |
| [349](#L349) | protected function get\_float\_background() { |
| [350](#L350) | $float\_background\_color = $this->get\_option( 'float\_background\_color' ); |
| [351](#L351) |  |
| [352](#L352) | //\* They have gone from an Addon to Core. |
| [353](#L353) | if ( false === $float\_background\_color ) { |
| [354](#L354) | return ''; |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | return 'data-float-color="' . $float\_background\_color . '" '; |
| [358](#L358) | } |
| [359](#L359) |  |
| [360](#L360) |  |
| [361](#L361) | /\*\* |
| [362](#L362) | \* Get one of the user options. |
| [363](#L363) | \* |
| [364](#L364) | \* This function acts just like the global SWP\_Utility:get\_option() method. |
| [365](#L365) | \* In fact, it even uses that function as a fallback. Basically, when the |
| [366](#L366) | \* Buttons\_Panel class is instantiated, a user has the option to pass in an |
| [367](#L367) | \* array of options. These will be merged with the global $swp\_user\_options, |
| [368](#L368) | \* and stored in the $this->options property. |
| [369](#L369) | \* |
| [370](#L370) | \* First, we check if the option exists in our local options property. Second, |
| [371](#L371) | \* we use the SWP\_Utility::get\_option() method which will pull the option |
| [372](#L372) | \* from the global settings as well as handle things like requests for |
| [373](#L373) | \* options that may not exist (return false). |
| [374](#L374) | \* |
| [375](#L375) | \* @since  3.0.5 | 10 MAY 2018 | Created |
| [376](#L376) | \* @param  string $key The name of the option. |
| [377](#L377) | \* @return mixed       The value of that option. |
| [378](#L378) | \* |
| [379](#L379) | \*/ |
| [380](#L380) | protected function get\_option( $key ) { |
| [381](#L381) |  |
| [382](#L382) | // Check if this option exists in this panel's localized options. |
| [383](#L383) | if( isset( $this->options[$key] ) ) { |
| [384](#L384) | return $this->options[$key]; |
| [385](#L385) | } |
| [386](#L386) |  |
| [387](#L387) | // As a backup, use the option as it exists in the global user options. |
| [388](#L388) | return SWP\_Utility::get\_option( $key ); |
| [389](#L389) | } |
| [390](#L390) |  |
| [391](#L391) |  |
| [392](#L392) | /\*\* |
| [393](#L393) | \* A Method to determine the location of the floating buttons |
| [394](#L394) | \* |
| [395](#L395) | \* This method was created because we can't just use the option as it is set |
| [396](#L396) | \* in the options page. Instead, we must first check that we are on a single.php |
| [397](#L397) | \* page and second we must check that the floating buttons toggle is turned on. |
| [398](#L398) | \* Then and only then will we check the actual floating location and return it. |
| [399](#L399) | \* |
| [400](#L400) | \* @since  3.0.0 | 09 MAY 2018 | Created |
| [401](#L401) | \* @since  3.0.4 | 09 MAY 2018 | Added check for the global post type on/off toggle. |
| [402](#L402) | \* @param  void |
| [403](#L403) | \* @return string A string containing the float bar location. |
| [404](#L404) | \* |
| [405](#L405) | \*/ |
| [406](#L406) | public function get\_float\_location() { |
| [407](#L407) |  |
| [408](#L408) |  |
| [409](#L409) | /\*\* |
| [410](#L410) | \* If we failed to populate a post id, then we just bail out and won't |
| [411](#L411) | \* be showing any. |
| [412](#L412) | \* |
| [413](#L413) | \*/ |
| [414](#L414) | if( false == isset( $this->post\_id ) ) { |
| [415](#L415) | return 'none'; |
| [416](#L416) | } |
| [417](#L417) |  |
| [418](#L418) |  |
| [419](#L419) | /\*\* |
| [420](#L420) | \* These are the float location settings all across the WordPress |
| [421](#L421) | \* ecosystem. There is a global on/off setting, a per post type on/off |
| [422](#L422) | \* setting, and even a setting on each individual post. |
| [423](#L423) | \* |
| [424](#L424) | \*/ |
| [425](#L425) | $float\_location    = $this->get\_option( 'float\_location' ); |
| [426](#L426) | $global\_setting    = $this->get\_option('floating\_panel' ); |
| [427](#L427) | $post\_type\_setting = 'on' == $this->get\_option('float\_location\_' . $this->post\_data['post\_type'] ); |
| [428](#L428) | $post\_setting      = get\_post\_meta( $this->post\_id, 'swp\_float\_location', true ); |
| [429](#L429) |  |
| [430](#L430) |  |
| [431](#L431) | /\*\* |
| [432](#L432) | \* If the floaters are implicitly turned on at the post level, then that |
| [433](#L433) | \* means the user wants them to float on this post regardless of the |
| [434](#L434) | \* global settings. |
| [435](#L435) | \* |
| [436](#L436) | \*/ |
| [437](#L437) | if( 'on' === $post\_setting ) { |
| [438](#L438) | return $float\_location; |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) |  |
| [442](#L442) | /\*\* |
| [443](#L443) | \* We don't use floating buttons on the home page. |
| [444](#L444) | \* |
| [445](#L445) | \*/ |
| [446](#L446) | if( is\_home() && !is\_front\_page() ) { |
| [447](#L447) | return 'none'; |
| [448](#L448) | } |
| [449](#L449) |  |
| [450](#L450) |  |
| [451](#L451) | /\*\* |
| [452](#L452) | \* Do not print floating buttons on archive pages. |
| [453](#L453) | \* |
| [454](#L454) | \*/ |
| [455](#L455) | if ( !is\_singular() ) { |
| [456](#L456) | return 'none'; |
| [457](#L457) | } |
| [458](#L458) |  |
| [459](#L459) |  |
| [460](#L460) | /\*\* |
| [461](#L461) | \* If the location on this specific post is set to off, then we'll |
| [462](#L462) | \* disable floating locations. Anything else and we'll defer to the |
| [463](#L463) | \* global setting. |
| [464](#L464) | \* |
| [465](#L465) | \*/ |
| [466](#L466) | if ( !empty( $post\_setting ) && 'off' === $post\_setting ) { |
| [467](#L467) | return 'none'; |
| [468](#L468) | } |
| [469](#L469) |  |
| [470](#L470) |  |
| [471](#L471) | /\*\* |
| [472](#L472) | \* If everything checks out, we'll return the global float location. If |
| [473](#L473) | \* somehow nothing checked out, we'll return none. |
| [474](#L474) | \* |
| [475](#L475) | \*/ |
| [476](#L476) | if ( $global\_setting && $post\_type\_setting ) { |
| [477](#L477) | return $float\_location; |
| [478](#L478) | } |
| [479](#L479) |  |
| [480](#L480) | return 'none'; |
| [481](#L481) | } |
| [482](#L482) |  |
| [483](#L483) |  |
| [484](#L484) | /\*\* |
| [485](#L485) | \* This method wraps the output of get\_float\_location into it's html |
| [486](#L486) | \* attribute that will be appended to the wrapper div of the buttons panel. |
| [487](#L487) | \* |
| [488](#L488) | \* @since  3.4.0 | 24 OCT 2018 | Created |
| [489](#L489) | \* @param  void |
| [490](#L490) | \* @return string The html attribute. |
| [491](#L491) | \* |
| [492](#L492) | \*/ |
| [493](#L493) | public function get\_float\_location\_attribute() { |
| [494](#L494) | return 'data-float="' . $this->get\_float\_location() . '" '; |
| [495](#L495) | } |
| [496](#L496) |  |
| [497](#L497) |  |
| [498](#L498) | /\*\* |
| [499](#L499) | \* A Method to determine the location of the floating buttons on mobile devices |
| [500](#L500) | \* |
| [501](#L501) | \* This method was created because we can't just use the option as it is set |
| [502](#L502) | \* in the options page. Instead, we must first check that we are on a single.php |
| [503](#L503) | \* page and second we must check that the floating buttons toggle is turned on. |
| [504](#L504) | \* Then and only then will we check the actual floating location and return it. |
| [505](#L505) | \* |
| [506](#L506) | \* @since  3.0.0 | 09 MAY 2018 | Created |
| [507](#L507) | \* @since  3.0.4 | 09 MAY 2018 | Added check for the global post type on/off toggle. |
| [508](#L508) | \* @since  3.4.0 | 17 OCT 2018 | Added conditions for front\_page, archive, category. |
| [509](#L509) | \* @since  3.4.2 | 07 DEC 2018 | Added conditions for false mobile locations. |
| [510](#L510) | \* @param  void |
| [511](#L511) | \* @return string A string containing the float bar location. |
| [512](#L512) | \* |
| [513](#L513) | \*/ |
| [514](#L514) | public function get\_mobile\_float\_location() { |
| [515](#L515) | $global\_float\_toggle    = $this->get\_option( 'floating\_panel' ); |
| [516](#L516) | $post\_type\_float\_toggle = $this->get\_option( 'float\_location\_' . $this->post\_data['post\_type'] ); |
| [517](#L517) | $float\_location         = $this->get\_option( 'float\_location' ); |
| [518](#L518) | $mobile\_location        = $this->get\_option( 'float\_mobile' ); |
| [519](#L519) |  |
| [520](#L520) |  |
| [521](#L521) | /\*\* |
| [522](#L522) | \* If the float location is completely set to none, then we won't have |
| [523](#L523) | \* any floating buttons on mobile either. |
| [524](#L524) | \* |
| [525](#L525) | \*/ |
| [526](#L526) | if( 'none' == $this->get\_float\_location() ) { |
| [527](#L527) | $mobile\_location = 'none'; |
| [528](#L528) | } |
| [529](#L529) |  |
| [530](#L530) |  |
| [531](#L531) | /\*\* |
| [532](#L532) | \* If the $mobile\_location is set to false, it means that this option |
| [533](#L533) | \* is not available which means that pro is not installed. If this |
| [534](#L534) | \* option were available, it would return as a string. |
| [535](#L535) | \* As such, we'll set it to the defaults that are available in core. |
| [536](#L536) | \* |
| [537](#L537) | \*/ |
| [538](#L538) | if( false === $mobile\_location ) { |
| [539](#L539) | $mobile\_location = $float\_location; |
| [540](#L540) |  |
| [541](#L541) |  |
| [542](#L542) | /\*\* |
| [543](#L543) | \* If the main floating buttons are set to left or right, then the |
| [544](#L544) | \* user won't get any floating buttons at all once those go away. |
| [545](#L545) | \* Switching from side to top/bottom is a pro only feature. If they |
| [546](#L546) | \* have them already set to top/bottom then we will just keep that |
| [547](#L547) | \* setting as no actual transition is needed. |
| [548](#L548) | \* |
| [549](#L549) | \*/ |
| [550](#L550) | if( true === in\_array( $float\_location, array( 'left','right' ) ) ) { |
| [551](#L551) | $mobile\_location = 'none'; |
| [552](#L552) | } |
| [553](#L553) | } |
| [554](#L554) |  |
| [555](#L555) |  |
| [556](#L556) | //\* Front page, archive, and categories do not have a global float option. |
| [557](#L557) | //\* Instead they use options in the post editor (saved in post\_meta). |
| [558](#L558) | if ( is\_front\_page() || is\_archive() || is\_category() ) { |
| [559](#L559) | $float\_enabled = get\_post\_meta( $this->post\_data['ID'], 'swp\_float\_location', true ); |
| [560](#L560) |  |
| [561](#L561) | if ( 'off' != $float\_enabled ) { |
| [562](#L562) | return 'data-float-mobile="' . $mobile\_location . '" '; |
| [563](#L563) | } |
| [564](#L564) |  |
| [565](#L565) | return 'data-float-mobile="none" '; |
| [566](#L566) | } |
| [567](#L567) |  |
| [568](#L568) | if( is\_singular() && true === $global\_float\_toggle && 'on' === $post\_type\_float\_toggle ) { |
| [569](#L569) | return 'data-float-mobile="' . $mobile\_location . '" '; |
| [570](#L570) | } |
| [571](#L571) |  |
| [572](#L572) | return 'data-float-mobile="none" '; |
| [573](#L573) | } |
| [574](#L574) |  |
| [575](#L575) |  |
| [576](#L576) | /\*\* |
| [577](#L577) | \* A method to control the order in which the buttons are output. |
| [578](#L578) | \* |
| [579](#L579) | \* @since  3.4.0 | 20 SEP 2018 | Created |
| [580](#L580) | \* @since  3.4.2 | 05 DEC 2018 | Added check for false sort\_method for core. |
| [581](#L581) | \* @param  void |
| [582](#L582) | \* @return array The array of network names in their proper order. |
| [583](#L583) | \* |
| [584](#L584) | \*/ |
| [585](#L585) | protected function get\_order\_of\_icons() { |
| [586](#L586) | global $swp\_social\_networks; |
| [587](#L587) | $active\_networks = SWP\_Utility::get\_option( 'order\_of\_icons' ); |
| [588](#L588) | $sort\_method     = SWP\_Utility::get\_option( 'order\_of\_icons\_method' ); |
| [589](#L589) | $order           = array(); |
| [590](#L590) |  |
| [591](#L591) |  |
| [592](#L592) | /\*\* |
| [593](#L593) | \* If the icons are set to be manually sorted, then we simply use the |
| [594](#L594) | \* order from the options page that the user has set. |
| [595](#L595) | \* |
| [596](#L596) | \* Adding a check for false, because this option is pro only and will |
| [597](#L597) | \* return false if it is not available in core, and therefore will default |
| [598](#L598) | \* to the manual sorting method. |
| [599](#L599) | \* |
| [600](#L600) | \*/ |
| [601](#L601) | if ( 'manual' === $sort\_method || false === $sort\_method ) { |
| [602](#L602) | return $active\_networks; |
| [603](#L603) | } |
| [604](#L604) |  |
| [605](#L605) |  |
| [606](#L606) | /\*\* |
| [607](#L607) | \* Even if it's not set to manual sorting, we will still use the manual |
| [608](#L608) | \* order of the buttons if we don't have any share counts by which to |
| [609](#L609) | \* process the order dynamically. |
| [610](#L610) | \* |
| [611](#L611) | \*/ |
| [612](#L612) | if( empty( $this->shares ) || !is\_array( $this->shares ) ) { |
| [613](#L613) | return $active\_networks; |
| [614](#L614) | } |
| [615](#L615) |  |
| [616](#L616) |  |
| [617](#L617) | /\*\* |
| [618](#L618) | \* If the icons are set to be ordered dynamically, and we passed the |
| [619](#L619) | \* check above then we will sort them based on how many shares each |
| [620](#L620) | \* network has. |
| [621](#L621) | \* |
| [622](#L622) | \*/ |
| [623](#L623) | arsort( $this->shares ); |
| [624](#L624) | foreach( $this->shares as $network => $share\_count ) { |
| [625](#L625) | if( $network != 'total\_shares' && in\_array( $network, $active\_networks ) ) { |
| [626](#L626) | $order[$network] = $network; |
| [627](#L627) | } |
| [628](#L628) | } |
| [629](#L629) | $this->options['order\_of\_icons'] = $order; |
| [630](#L630) | return $order; |
| [631](#L631) | } |
| [632](#L632) |  |
| [633](#L633) |  |
| [634](#L634) | /\*\* |
| [635](#L635) | \* A method to arrange the array of network objects in proper order. |
| [636](#L636) | \* |
| [637](#L637) | \* @since  3.0.0 | 04 MAY 2018 | Created |
| [638](#L638) | \* @since  3.3.0 | 30 AUG 2018 | Renamed from 'order\_network\_objects' to 'get\_ordered\_network\_objects' |
| [639](#L639) | \* @param  array $order An ordered array of network keys. |
| [640](#L640) | \* @return array        An ordered array of network objects. |
| [641](#L641) | \* |
| [642](#L642) | \*/ |
| [643](#L643) | protected function get\_ordered\_network\_objects( $order ) { |
| [644](#L644) | $network\_objects = array(); |
| [645](#L645) |  |
| [646](#L646) | if ( empty( $order ) ) : |
| [647](#L647) | $order = SWP\_Utility::get\_option( 'order\_of\_icons' ); |
| [648](#L648) | endif; |
| [649](#L649) |  |
| [650](#L650) | foreach( $order as $network\_key ) { |
| [651](#L651) | foreach( $this->networks as $key => $network ) : |
| [652](#L652) | if ( $key === $network\_key ) : |
| [653](#L653) | $network\_objects[$key] = $network; |
| [654](#L654) | endif; |
| [655](#L655) | endforeach; |
| [656](#L656) | } |
| [657](#L657) |  |
| [658](#L658) | return $network\_objects; |
| [659](#L659) | } |
| [660](#L660) |  |
| [661](#L661) |  |
| [662](#L662) | /\*\* |
| [663](#L663) | \* Render the html for the indivial buttons. |
| [664](#L664) | \* |
| [665](#L665) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [666](#L666) | \* @param  integer $max\_count The maximum number of buttons to display. |
| [667](#L667) | \* @return string             The compiled html for the buttons. |
| [668](#L668) | \* |
| [669](#L669) | \*/ |
| [670](#L670) | protected function generate\_individual\_buttons\_html() { |
| [671](#L671) | $html = ''; |
| [672](#L672) | $count = 0; |
| [673](#L673) |  |
| [674](#L674) | foreach( $this->networks as $key => $network ) { |
| [675](#L675) |  |
| [676](#L676) |  |
| [677](#L677) | /\*\* |
| [678](#L678) | \* The floating buttons have a maximum number of buttons that can |
| [679](#L679) | \* be displayed at any given time. If that number is set, we bail |
| [680](#L680) | \* out once that maximum has been reached. If that number is set to |
| [681](#L681) | \* zero, it represents unlimited buttons can be displayed. |
| [682](#L682) | \* |
| [683](#L683) | \*/ |
| [684](#L684) | if ( 0 !== $this->max\_buttons && $count == $this->max\_buttons ) : |
| [685](#L685) | return $html; |
| [686](#L686) | endif; |
| [687](#L687) |  |
| [688](#L688) | // Pass in some context for this specific panel of buttons |
| [689](#L689) | $context['shares']    = $this->shares; |
| [690](#L690) | $context['options']   = $this->options; |
| [691](#L691) | $context['post\_data'] = $this->post\_data; |
| [692](#L692) | $html .= $network->render\_HTML( $context ); |
| [693](#L693) | $count++; |
| [694](#L694) | } |
| [695](#L695) |  |
| [696](#L696) | return $html; |
| [697](#L697) | } |
| [698](#L698) |  |
| [699](#L699) |  |
| [700](#L700) | /\*\* |
| [701](#L701) | \* The Total Shares Count |
| [702](#L702) | \* |
| [703](#L703) | \* If share counts are active, renders the Total Share Counts HTML. |
| [704](#L704) | \* |
| [705](#L705) | \* @since  3.0.0 | 18 APR 2018 | Created |
| [706](#L706) | \* @since  3.3.2 | 12 SEP 2018 | Moved strtolower to $totals\_argument |
| [707](#L707) | \* @since  3.4.0 | 20 SEP 2018 | Moved display logic to should\_total\_shares\_display() |
| [708](#L708) | \* @param  void |
| [709](#L709) | \* @return string $html The fully qualified HTML to display share counts. |
| [710](#L710) | \* |
| [711](#L711) | \*/ |
| [712](#L712) | public function generate\_total\_shares\_html() { |
| [713](#L713) |  |
| [714](#L714) | // Check if total shares should be rendered or not. |
| [715](#L715) | if( false === $this->should\_total\_shares\_display() ) { |
| [716](#L716) | return; |
| [717](#L717) | } |
| [718](#L718) |  |
| [719](#L719) | // Render the html for the total shares. |
| [720](#L720) | $html = '<div class="nc\_tweetContainer swp\_share\_button total\_shares total\_sharesalt" >'; |
| [721](#L721) | $html .= '<span class="swp\_count ">' . SWP\_Utility::kilomega( $this->shares['total\_shares'] ) . ' <span class="swp\_label">' . \_\_( 'Shares','social-warfare' ) . '</span></span>'; |
| [722](#L722) | $html .= '</div>'; |
| [723](#L723) |  |
| [724](#L724) | return $html; |
| [725](#L725) | } |
| [726](#L726) |  |
| [727](#L727) |  |
| [728](#L728) | /\*\* |
| [729](#L729) | \* Should the total shares be rendered. |
| [730](#L730) | \* |
| [731](#L731) | \* @since  3.4.0 | 20 SEP 2018 | Created |
| [732](#L732) | \* @param  void |
| [733](#L733) | \* @return bool True: show shares; False: don't render them. |
| [734](#L734) | \* |
| [735](#L735) | \*/ |
| [736](#L736) | protected function should\_total\_shares\_display() { |
| [737](#L737) |  |
| [738](#L738) |  |
| [739](#L739) | /\*\* |
| [740](#L740) | \* If the share counts are delayed in the options, then we'll check the |
| [741](#L741) | \* current age of the post and check to see if they are still delayed |
| [742](#L742) | \* or if they can be shown now. |
| [743](#L743) | \* |
| [744](#L744) | \*/ |
| [745](#L745) | if( true === SWP\_Buttons\_Panel::are\_share\_counts\_delayed( $this->post\_id ) ) { |
| [746](#L746) | return false; |
| [747](#L747) | } |
| [748](#L748) |  |
| [749](#L749) |  |
| [750](#L750) | /\*\* |
| [751](#L751) | \* Find out if the total shares are activated on the settings page. We |
| [752](#L752) | \* will overwrite this variable if the user has passed in a 'buttons' |
| [753](#L753) | \* argument and instead use what they've passed in. |
| [754](#L754) | \* |
| [755](#L755) | \*/ |
| [756](#L756) | $are\_total\_shares\_active = $this->get\_option('total\_shares'); |
| [757](#L757) |  |
| [758](#L758) |  |
| [759](#L759) | /\*\* |
| [760](#L760) | \* If this is a shortcode and the buttons argument has been specifically |
| [761](#L761) | \* passed into the function, then we will use that buttons argument to |
| [762](#L762) | \* determine whether or not to display the total shares. |
| [763](#L763) | \* |
| [764](#L764) | \*/ |
| [765](#L765) | $buttons = isset( $this->args['buttons'] ) ? $this->args['buttons'] : array(); |
| [766](#L766) | if ( $this->is\_shortcode && !empty( $buttons ) ) { |
| [767](#L767) | $total = in\_array('total', array\_map('strtolower', $buttons) ); |
| [768](#L768) | $totals = in\_array('totals', array\_map('strtolower', $buttons) ); |
| [769](#L769) | $are\_total\_shares\_active = ( $total || $totals ); |
| [770](#L770) | } |
| [771](#L771) |  |
| [772](#L772) |  |
| [773](#L773) | /\*\* |
| [774](#L774) | \* If total shares are turned off or this is a shortcode with a buttons |
| [775](#L775) | \* parameter that didn't include totals then we're not going to render |
| [776](#L776) | \* any total shares. |
| [777](#L777) | \* |
| [778](#L778) | \*/ |
| [779](#L779) | if ( false == $are\_total\_shares\_active ) { |
| [780](#L780) | return false; |
| [781](#L781) | } |
| [782](#L782) |  |
| [783](#L783) |  |
| [784](#L784) | /\*\* |
| [785](#L785) | \* If minimum share counts are enabled and this post hasn't achieved |
| [786](#L786) | \* that threshold of shares yet, then we don't show them. |
| [787](#L787) | \* |
| [788](#L788) | \*/ |
| [789](#L789) | if ( $this->shares['total\_shares'] < $this->get\_option('minimum\_shares') ) { |
| [790](#L790) | return false; |
| [791](#L791) | } |
| [792](#L792) |  |
| [793](#L793) |  |
| [794](#L794) | // If none of the flags above get caught, return true. |
| [795](#L795) | return true; |
| [796](#L796) | } |
| [797](#L797) |  |
| [798](#L798) |  |
| [799](#L799) | /\*\* |
| [800](#L800) | \* Combine the Total Shares html with the Buttons html. |
| [801](#L801) | \* |
| [802](#L802) | \* @since  3.4.0 | 23 OCT 2018 | Created |
| [803](#L803) | \* @param  void |
| [804](#L804) | \* @return string The html for the buttons and total shares. |
| [805](#L805) | \* |
| [806](#L806) | \*/ |
| [807](#L807) | protected function generate\_buttons\_and\_totals\_html() { |
| [808](#L808) |  |
| [809](#L809) | // Generate the html for the total shares and each button in the set. |
| [810](#L810) | $total\_shares\_html = $this->generate\_total\_shares\_html(); |
| [811](#L811) | $buttons\_html      = $this->generate\_individual\_buttons\_html(); |
| [812](#L812) | $is\_side\_floating  = ('floating\_side' == $this->panel\_type); |
| [813](#L813) | $is\_left\_aligned   = ('totals\_left' == $this->get\_option('totals\_alignment')); |
| [814](#L814) |  |
| [815](#L815) |  |
| [816](#L816) | /\*\* |
| [817](#L817) | \* $is\_side\_floating: If this is a set of floating sidebar buttons, then |
| [818](#L818) | \* we will attach the total shares to the left which will then visually |
| [819](#L819) | \* appear at the top of the panel. |
| [820](#L820) | \* |
| [821](#L821) | \* $is\_left\_aligned: If, in the options page, the user has set the total |
| [822](#L822) | \* shares to appear on the left, then we will concantenate the html to |
| [823](#L823) | \* the left. |
| [824](#L824) | \* |
| [825](#L825) | \*/ |
| [826](#L826) | if( $is\_side\_floating || $is\_left\_aligned ) { |
| [827](#L827) | $this->inner\_html = $total\_shares\_html . $buttons\_html; |
| [828](#L828) | return; |
| [829](#L829) | } |
| [830](#L830) |  |
| [831](#L831) | /\*\* |
| [832](#L832) | \* If it's not a set of floating buttons and it's not set to the left, |
| [833](#L833) | \* then we attach the total shares on the right. |
| [834](#L834) | \* |
| [835](#L835) | \*/ |
| [836](#L836) |  |
| [837](#L837) | else { |
| [838](#L838) | $this->inner\_html = $buttons\_html . $total\_shares\_html; |
| [839](#L839) | } |
| [840](#L840) | } |
| [841](#L841) |  |
| [842](#L842) |  |
| [843](#L843) | /\*\* |
| [844](#L844) | \* Generate the html attributes attached to the container. |
| [845](#L845) | \* |
| [846](#L846) | \* @since  3.4.0 | 23 OCT 2018 | Created |
| [847](#L847) | \* @param  void |
| [848](#L848) | \* @return void |
| [849](#L849) | \* @var    $this->attributes Stores panel html attributes as a string of text. |
| [850](#L850) | \* |
| [851](#L851) | \*/ |
| [852](#L852) | protected function generate\_attributes() { |
| [853](#L853) | $attributes  = $this->get\_min\_width(); |
| [854](#L854) | $attributes .= $this->get\_float\_background(); |
| [855](#L855) | $attributes .= $this->get\_float\_location\_attribute(); |
| [856](#L856) | $attributes .= $this->get\_mobile\_float\_location(); |
| [857](#L857) | $attributes .= $this->get\_float\_transition(); |
| [858](#L858) | $attributes .= $this->get\_post\_id\_attribute(); |
| [859](#L859) | $this->attributes = $attributes; |
| [860](#L860) | } |
| [861](#L861) |  |
| [862](#L862) |  |
| [863](#L863) | /\*\* |
| [864](#L864) | \* Generate the CSS classes that need to be applied to the buttons panel. |
| [865](#L865) | \* |
| [866](#L866) | \* @since  3.4.0 | 23 OCT 2018 | Created |
| [867](#L867) | \* @param  void |
| [868](#L868) | \* @return void |
| [869](#L869) | \* @var    $this->classes Stores panel classes as a string of text. |
| [870](#L870) | \* |
| [871](#L871) | \*/ |
| [872](#L872) | protected function generate\_css\_classes() { |
| [873](#L873) | $classes = 'class="swp\_social\_panel swp\_horizontal\_panel '; |
| [874](#L874) | $classes .= $this->get\_shape(); |
| [875](#L875) | $classes .= $this->get\_colors(); |
| [876](#L876) | $classes .= $this->get\_scale(); |
| [877](#L877) | $classes .= $this->get\_alignment(); |
| [878](#L878) | $classes .= '" '; |
| [879](#L879) | $this->classes = $classes; |
| [880](#L880) | } |
| [881](#L881) |  |
| [882](#L882) |  |
| [883](#L883) | /\*\* |
| [884](#L884) | \* A method used to combine the CSS classes for the panel wrapper, the |
| [885](#L885) | \* html attributes, and the html for the buttons and total shares into one |
| [886](#L886) | \* single string of html for output. |
| [887](#L887) | \* |
| [888](#L888) | \* @since  3.4.0 | 24 OCT 2018 | Created |
| [889](#L889) | \* @param  void |
| [890](#L890) | \* @return void |
| [891](#L891) | \* @var    $this->html Stores the fully compiled panel html as a string. |
| [892](#L892) | \* |
| [893](#L893) | \*/ |
| [894](#L894) | protected function combine\_html\_assets() { |
| [895](#L895) | $this->html = '<div ' . $this->classes . $this->attributes . '>' . $this->inner\_html . '</div>'; |
| [896](#L896) | } |
| [897](#L897) |  |
| [898](#L898) |  |
| [899](#L899) | /\*\* |
| [900](#L900) | \* This allows users to delay the display of share counts until the post |
| [901](#L901) | \* has reached a certain age in hours. So if they set the option to 10, |
| [902](#L902) | \* then the share counts will not display until the post is at least |
| [903](#L903) | \* that old. |
| [904](#L904) | \* |
| [905](#L905) | \* @since  4.0.0 | 12 JUL 2019 | Created |
| [906](#L906) | \* @param  integer $post\_id The Post ID |
| [907](#L907) | \* @return boolean True if delayed, false if not delayed. |
| [908](#L908) | \* |
| [909](#L909) | \*/ |
| [910](#L910) | public static function are\_share\_counts\_delayed( $post\_id ) { |
| [911](#L911) | $delay\_share\_counts = SWP\_Utility::get\_option( 'delay\_share\_counts' ); |
| [912](#L912) | if( !empty($delay\_share\_counts) && is\_numeric($delay\_share\_counts) && $delay\_share\_counts > 0 ) { |
| [913](#L913) | $delay\_share\_counts = $delay\_share\_counts \* 60 \* 60; |
| [914](#L914) | $current\_time       = date( 'U' ); |
| [915](#L915) | $publication\_time   = get\_post\_time( 'U' , true , $post\_id ); |
| [916](#L916) | $post\_age           = $current\_time - $publication\_time; |
| [917](#L917) |  |
| [918](#L918) | if($post\_age < $delay\_share\_counts ) { |
| [919](#L919) | return true; |
| [920](#L920) | } |
| [921](#L921) | } |
| [922](#L922) | return false; |
| [923](#L923) | } |
| [924](#L924) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?format=txt)
* [Original Format](/export/3222447/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_cffa378c_20250114_190921.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2982662%2Fsocial-warfare)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2981329/social-warfare "Changeset 2981329 for social-warfare")
* [Next Change](/changeset/2982664/social-warfare "Changeset 2982664 for social-warfare") →

---

# Changeset [2982662](/changeset/2982662 "Show full changeset") for [social-warfare](/browser/social-warfare?rev=2982662 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/23/2023 02:56:46 PM
([15 months](/timeline?from=2023-10-23T14%3A56%3A46Z&precision=second "See timeline at 10/23/2023 02:56:46 PM") ago)

Author:
WarfarePlugins
Message:
# 4.4.4 (23 OCT 2023)

* Security patch: Prevent XSS vulnerabilities in the plugin
  + Escaped output in the `generate_css_classes` method to prevent potential XSS vulnerabilities.
  + Added validation and escaping in the `get_min_width` method to ensure input is safe from potential XSS vulnerabilities.

Location:
[social-warfare/trunk](/browser/social-warfare/trunk?rev=2982662)
Files:

2 edited

* [lib/buttons-panel/SWP\_Buttons\_Panel\_Trait.php](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2982662 "Show entry in browser")
  (modified)
  ([4 diffs](#file0 "Show differences"))
* [readme.txt](/browser/social-warfare/trunk/readme.txt?rev=2982662 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [social-warfare/trunk/lib/buttons-panel/SWP\_Buttons\_Panel\_Trait.php](/changeset/2982662/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php "Show the changeset 2982662 restricted to social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php")

  | [r2273409](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2273409#L290 "Show revision 2273409 of this file in browser") | [r2982662](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2982662#L290 "Show revision 2982662 of this file in browser") |  |
  | --- | --- | --- |
  | 290 | 290 | \* |
  | 291 | 291 | \* @since  3.0.0 | 01 MAR 2018 | Created |
  |  | 292 | \* @since  4.4.2 | 23 OCT 2023 | Security Patch: Added validation and escaping to ensure input is safe from potential XSS vulnerabilities. |
  | 292 | 293 | \* @param  void |
  | 293 | 294 | \* @return string The HTML attribute to be added to the buttons panel. |
  | […](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2273409#L295) | […](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2982662#L296) |  |
  | 295 | 296 | \*/ |
  | 296 | 297 | protected function get\_min\_width() { |
  | 297 |  | $min\_width = $this->get\_option( 'float\_screen\_width' ); |
  | 298 |  |  |
  | 299 |  | //\* They have gone from an Addon to Core. |
  | 300 |  | if ( false === $min\_width ) { |
  | 301 |  | return 'data-min-width="1100" '; |
  | 302 |  | } |
  | 303 |  |  |
  | 304 |  | return 'data-min-width="' . $min\_width . '" '; |
  |  | 298 | $min\_width = $this->get\_option('float\_screen\_width'); |
  |  | 299 |  |
  |  | 300 | if (!is\_numeric($min\_width)) { |
  |  | 301 | $min\_width = "1100"; |
  |  | 302 | } |
  |  | 303 |  |
  |  | 304 | return 'data-min-width="' . esc\_attr($min\_width) . '" '; |
  | 305 | 305 | } |
  | 306 | 306 |  |
  | […](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2273409#L865) | […](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2982662#L865) |  |
  | 865 | 865 | \* |
  | 866 | 866 | \* @since  3.4.0 | 23 OCT 2018 | Created |
  |  | 867 | \* @since  4.4.3 | 23 OCT 2023 | Security Patch: Escaped output to prevent potential XSS vulnerabilities. |
  | 867 | 868 | \* @param  void |
  | 868 | 869 | \* @return void |
  | […](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2273409#L872) | […](/browser/social-warfare/trunk/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?rev=2982662#L873) |  |
  | 872 | 873 | protected function generate\_css\_classes() { |
  | 873 | 874 | $classes = 'class="swp\_social\_panel swp\_horizontal\_panel '; |
  | 874 |  | $classes .= ~~$this->get\_shape(~~); |
  | 875 |  | $classes .= ~~$this->get\_colors(~~); |
  | 876 |  | $classes .= ~~$this->get\_scale(~~); |
  | 877 |  | $classes .= ~~$this->get\_alignment(~~); |
  |  | 875 | $classes .= esc\_attr($this->get\_shape()); |
  |  | 876 | $classes .= esc\_attr($this->get\_colors()); |
  |  | 877 | $classes .= esc\_attr($this->get\_scale()); |
  |  | 878 | $classes .= esc\_attr($this->get\_alignment()); |
  | 878 | 879 | $classes .= '" '; |
  | 879 | 880 | $this->classes = $classes; |
* ## [social-warfare/trunk/readme.txt](/changeset/2982662/social-warfare/trunk/readme.txt "Show the changeset 2982662 restricted to social-warfare/trunk/readme.txt")

  | [r2981325](/browser/social-warfare/trunk/readme.txt?rev=2981325#L1 "Show revision 2981325 of this file in browser") | [r2982662](/browser/social-warfare/trunk/readme.txt?rev=2982662#L1 "Show revision 2982662 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Social Sharing Plugin - Social Warfare === |
  | 2 |  | Contributors: holas84, webinator, warfareplugins, cdegraff1 |
  |  | 2 | Contributors: holas84, webinator, warfareplugins, cdegraff1, andbalashov |
  | 3 | 3 | Tags: sharing buttons, social media share, floating share buttons, facebook share, linkedin share, pin it, pinterest save, mix button, tweet button, twitter share, click to tweet, social sharing buttons, social share, social sharing, social media sharing, wordpress social sharing plugin, social sharing plugin, share buttons, share counts |
  | 4 | 4 | Requires at least: 4.5.0 |
  | 5 | 5 | Tested up to: 6.3.2 |
  | 6 |  | Stable tag: 4.4.~~3~~ |
  |  | 6 | Stable tag: 4.4.4 |
  | 7 | 7 | Requires PHP: 5.6 |
  | 8 | 8 | License: GNU General Public License v2.0 or later |
  | […](/browser/social-warfare/trunk/readme.txt?rev=2981325#L183) | […](/browser/social-warfare/trunk/readme.txt?rev=2982662#L183) |  |
  | 183 | 183 |  |
  | 184 | 184 | == Changelog == |
  |  | 185 |  |
  |  | 186 | = 4.4.4 (23 OCT 2023) = |
  |  | 187 | \* Security patch: Prevent XSS vulnerabilities in the plugin |
  |  | 188 | - Escaped output in the `generate\_css\_classes` method to prevent potential XSS vulnerabilities. |
  |  | 189 | - Added validation and escaping in the `get\_min\_width` method to ensure input is safe from potential XSS vulnerabilities. |
  | 185 | 190 |  |
  | 186 | 191 | = 4.4.3 (19 OCT 2023) = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2982662)
* [Zip Archive](?format=zip&new=2982662)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_cbcff79a_20250114_190919.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fsocial-warfare%2Ftags%2F4.4.1%2Flib%2Fbuttons-panel%2FSWP_Buttons_Panel_Trait.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php)

---

# [source:](/browser?order=name "Go to repository root") [social-warfare](/browser/social-warfare?order=name "View social-warfare")/[tags](/browser/social-warfare/tags?order=name "View tags")/[4.4.1](/browser/social-warfare/tags/4.4.1?order=name "View 4.4.1")/[lib](/browser/social-warfare/tags/4.4.1/lib?order=name "View lib")/[buttons-panel](/browser/social-warfare/tags/4.4.1/lib/buttons-panel?order=name "View buttons-panel")/[SWP\_Buttons\_Panel\_Trait.php](/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?order=name "View SWP_Buttons_Panel_Trait.php")

View diff against:

View revision:

| [Last change](/changeset/2865844/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php "View differences") on this file was [2865844](/changeset/2865844/ "View changeset 2865844"), checked in by WarfarePlugins, [2 years ago](/timeline?from=2023-02-15T16%3A23%3A43Z&precision=second "See timeline at 02/15/2023 04:23:43 PM") |
| --- |
| Updating version number to 4.4.1 |
| **File size:** 26.3 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* SWP\_Buttons\_Panel\_Trait |
| [5](#L5) | \* |
| [6](#L6) | \* The purpose of this trait is to allow access to commonly used methods |
| [7](#L7) | \* throughout the various Buttons\_Panel classes of the plugin without having to |
| [8](#L8) | \* force the extension of an abstract class onto them. |
| [9](#L9) | \* |
| [10](#L10) | \*     create\_panel(); |
| [11](#L11) | \* |
| [12](#L12) | \*     generate\_panel\_html(); |
| [13](#L13) | \*     generate\_individual\_buttons\_html(); |
| [14](#L14) | \*     generate\_total\_shares\_html(); |
| [15](#L15) | \* |
| [16](#L16) | \*     should\_panel\_display(); |
| [17](#L17) | \*     should\_total\_shares\_display(); |
| [18](#L18) | \* |
| [19](#L19) | \*     get\_alignment(); |
| [20](#L20) | \*     get\_colors(); |
| [21](#L21) | \*     get\_shape(); |
| [22](#L22) | \*     get\_scale(); |
| [23](#L23) | \*     get\_min\_width(); |
| [24](#L24) | \*     get\_float\_background(); |
| [25](#L25) | \*     get\_option(); |
| [26](#L26) | \*     get\_float\_location(); |
| [27](#L27) | \*     get\_mobile\_float\_location(); |
| [28](#L28) | \*     get\_order\_of\_icons(); |
| [29](#L29) | \*     get\_ordered\_network\_objects(); |
| [30](#L30) | \*     get\_key\_from\_name(); |
| [31](#L31) | \* |
| [32](#L32) | \* |
| [33](#L33) | \* |
| [34](#L34) | \* @since 3.4.0 | 21 SEP 2018 | Created |
| [35](#L35) | \* |
| [36](#L36) | \*/ |
| [37](#L37) | trait SWP\_Buttons\_Panel\_Trait { |
| [38](#L38) |  |
| [39](#L39) |  |
| [40](#L40) | protected function append\_panel\_to\_content() { |
| [41](#L41) |  |
| [42](#L42) |  |
| [43](#L43) | /\*\* |
| [44](#L44) | \* If the panel type is static\_horizontal, then the switch below will |
| [45](#L45) | \* determine the lcoation setting and append the html to the content |
| [46](#L46) | \* according to that location. |
| [47](#L47) | \* |
| [48](#L48) | \*/ |
| [49](#L49) | if( $this->panel\_type === 'static\_horizontal' ) { |
| [50](#L50) | switch ($this->location) { |
| [51](#L51) | case 'both' : |
| [52](#L52) | $content = $this->html . $this->content . $this->html; |
| [53](#L53) | break; |
| [54](#L54) | case 'above' : |
| [55](#L55) | $content = $this->html . $this->content; |
| [56](#L56) | break; |
| [57](#L57) | case 'below' : |
| [58](#L58) | $content = $this->content . $this->html; |
| [59](#L59) | break; |
| [60](#L60) |  |
| [61](#L61) | case 'none' : |
| [62](#L62) | $content = $this->content; |
| [63](#L63) | default : |
| [64](#L64) | $content = $this->content; |
| [65](#L65) | break; |
| [66](#L66) | } |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) |  |
| [70](#L70) | /\*\* |
| [71](#L71) | \* If the panel type is floating\_side, then forget the content because |
| [72](#L72) | \* it will be empty. Instead just replace the content to be returned |
| [73](#L73) | \* with the generated html for the panel. |
| [74](#L74) | \* |
| [75](#L75) | \*/ |
| [76](#L76) | if( $this->panel\_type === 'floating\_side' ) { |
| [77](#L77) | $content = $this->html; |
| [78](#L78) | } |
| [79](#L79) |  |
| [80](#L80) | $this->content = $content; |
| [81](#L81) |  |
| [82](#L82) | if ( isset( $this->args['echo']) && true === $this->args['echo'] ) { |
| [83](#L83) | echo $this->content; |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | return $this->content; |
| [87](#L87) | } |
| [88](#L88) |  |
| [89](#L89) | /\*\* |
| [90](#L90) | \* Takes a display name and returns the snake\_cased key of that name. |
| [91](#L91) | \* |
| [92](#L92) | \* This is used to convert a network's name, such as Google Plus, |
| [93](#L93) | \* to the database-friendly key of google\_plus. |
| [94](#L94) | \* |
| [95](#L95) | \* @since  3.0.0 | 18 APR 2018 | Created |
| [96](#L96) | \* @param  string $name The string to convert. |
| [97](#L97) | \* @return string The converted string. |
| [98](#L98) | \* |
| [99](#L99) | \*/ |
| [100](#L100) | public function get\_key\_from\_name( $string ) { |
| [101](#L101) | return preg\_replace( '/[\s]+/', '\_', strtolower( trim ( $string ) ) ); |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) |  |
| [105](#L105) | /\*\* |
| [106](#L106) | \* Tells you true/false if the buttons should print on this page. |
| [107](#L107) | \* |
| [108](#L108) | \* Each variable is a boolean value. For the buttons to eligible for printing, |
| [109](#L109) | \* each of the variables must evaluate to true. |
| [110](#L110) | \* |
| [111](#L111) | \* $user\_settings: Options editable by the Admin user. |
| [112](#L112) | \* $desired\_conditions: WordPress conditions we require for the buttons. |
| [113](#L113) | \* $undesired\_conditions: WordPress pages where we do not display the buttons. |
| [114](#L114) | \* |
| [115](#L115) | \* |
| [116](#L116) | \* @return Boolean True if the buttons are okay to print, else false. |
| [117](#L117) | \* @since  3.0.8 | 21 MAY 2018 | Added extra condition to check for content |
| [118](#L118) | \*                               (for calls to social\_warfare()). |
| [119](#L119) | \* @since  3.3.3 | 18 SEP 2018 | Added check for in\_the\_loop(). |
| [120](#L120) | \* @since  3.4.0 | 24 OCT 2018 | Added check for $this->post\_data. |
| [121](#L121) | \* @param  void |
| [122](#L122) | \* @return void |
| [123](#L123) | \* |
| [124](#L124) | \*/ |
| [125](#L125) | public function should\_panel\_display() { |
| [126](#L126) |  |
| [127](#L127) |  |
| [128](#L128) | /\*\* |
| [129](#L129) | \* If for some reason the post\_data failed to populate, we just have to |
| [130](#L130) | \* bail out so the PHP doesn't throw undefined property errors. |
| [131](#L131) | \* |
| [132](#L132) | \*/ |
| [133](#L133) | if( empty( $this->post\_data ) ) { |
| [134](#L134) | return false; |
| [135](#L135) | } |
| [136](#L136) |  |
| [137](#L137) |  |
| [138](#L138) | /\*\* |
| [139](#L139) | \* WordPress requires title and content. This indicates the buttons are |
| [140](#L140) | \* called via social\_warfare() or via the shortcode. |
| [141](#L141) | \* |
| [142](#L142) | \*/ |
| [143](#L143) | if ( empty( $this->content ) && !isset( $this->args['content'] )  ) { |
| [144](#L144) | return true; |
| [145](#L145) | } |
| [146](#L146) |  |
| [147](#L147) |  |
| [148](#L148) | $user\_settings        = 'none' !== $this->location; |
| [149](#L149) | $desired\_conditions   = is\_main\_query() && in\_the\_loop() && get\_post\_status( $this->post\_id ) === 'publish'; |
| [150](#L150) | $undesired\_conditions = is\_admin() || is\_feed() || is\_search() || is\_attachment() || is\_preview(); |
| [151](#L151) |  |
| [152](#L152) | return $user\_settings && $desired\_conditions && !$undesired\_conditions; |
| [153](#L153) | } |
| [154](#L154) |  |
| [155](#L155) |  |
| [156](#L156) | /\*\* |
| [157](#L157) | \* A method to get the alignment when scale is set below 100%. |
| [158](#L158) | \* |
| [159](#L159) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [160](#L160) | \* @param  void |
| [161](#L161) | \* @return string A string of the appropriate CSS class to add to the panel. |
| [162](#L162) | \* |
| [163](#L163) | \*/ |
| [164](#L164) | protected function get\_alignment() { |
| [165](#L165) | return ' scale-' . $this->get\_option('button\_alignment'); |
| [166](#L166) | } |
| [167](#L167) |  |
| [168](#L168) |  |
| [169](#L169) | /\*\* |
| [170](#L170) | \* A function to get the color states for this buttons panel. |
| [171](#L171) | \* |
| [172](#L172) | \* All of the buttons contain 3 states: default, hover, and single. The |
| [173](#L173) | \* default state is what the buttons look like when not being interacted |
| [174](#L174) | \* with. The hover is what all the buttons in the panel look like when |
| [175](#L175) | \* the panel is being hovered. The single is what the individual button |
| [176](#L176) | \* being hovered will look like. |
| [177](#L177) | \* |
| [178](#L178) | \* This method handles generating the classes that the CSS can target to |
| [179](#L179) | \* ensure that all three of those states work. |
| [180](#L180) | \* |
| [181](#L181) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [182](#L182) | \* @since  3.3.2 | 13 SEP 2018 | Modified to control float selectors better |
| [183](#L183) | \* @param  boolean $float Whether this is a floating panel or not. |
| [184](#L184) | \* @return string  The string of CSS classes to be used on the panel. |
| [185](#L185) | \* |
| [186](#L186) | \*/ |
| [187](#L187) | protected function get\_colors( $float = false ) { |
| [188](#L188) |  |
| [189](#L189) |  |
| [190](#L190) | /\*\* |
| [191](#L191) | \* If pro was installed, but no longer is installed or activated, |
| [192](#L192) | \* then this option won't exist and will return false. If so, then |
| [193](#L193) | \* we output the default core color/style classes. |
| [194](#L194) | \* |
| [195](#L195) | \*/ |
| [196](#L196) | if ( false === $this->get\_option( 'default\_colors' ) ) { |
| [197](#L197) | return " swp\_default\_full\_color swp\_individual\_full\_color swp\_other\_full\_color "; |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) |  |
| [201](#L201) | /\*\* |
| [202](#L202) | \* If the buttons are the static horizontal buttons (not the float), |
| [203](#L203) | \* or if it is the float but we are inheriting the styles from the |
| [204](#L204) | \* horizontal buttons, then just output the CSS classes that are used |
| [205](#L205) | \* for the horizontal buttons. |
| [206](#L206) | \* |
| [207](#L207) | \* "float\_style\_source" on the options page is actually answering |
| [208](#L208) | \* the question "Do the floating buttons inherit their colors from |
| [209](#L209) | \* the horizontal buttons?" It will be true if they do, and false if |
| [210](#L210) | \* they don't. |
| [211](#L211) | \* |
| [212](#L212) | \*/ |
| [213](#L213) | $prefix = ''; |
| [214](#L214) |  |
| [215](#L215) |  |
| [216](#L216) | /\*\* |
| [217](#L217) | \* If this is a set of floating buttons and we are not inheriting |
| [218](#L218) | \* the color styles from the static floating buttons, then we need |
| [219](#L219) | \* to return the style classes that are specific to the floating |
| [220](#L220) | \* buttons being rendered. |
| [221](#L221) | \* |
| [222](#L222) | \*/ |
| [223](#L223) | if( true === $float && false === $this->options['float\_style\_source'] ) { |
| [224](#L224) | $prefix = 'float\_'; |
| [225](#L225) | } |
| [226](#L226) |  |
| [227](#L227) |  |
| [228](#L228) | /\*\* |
| [229](#L229) | \* |
| [230](#L230) | \* If it's a static, horizontal panel, there is no prefix. If it's |
| [231](#L231) | \* a floating panel, there is a prefix. However, the prefix needs |
| [232](#L232) | \* to be removed for the CSS class name that is actualy output. |
| [233](#L233) | \* |
| [234](#L234) | \* So here we fetch the appropriate color options, strip out the |
| [235](#L235) | \* "float\_" prefix since we don't use that on the actual CSS |
| [236](#L236) | \* selector, and then return the CSS classes that will be added to |
| [237](#L237) | \* this buttons panel that is being rendered. |
| [238](#L238) | \* |
| [239](#L239) | \*/ |
| [240](#L240) | $default = str\_replace( $prefix, '', $this->get\_option( $prefix . 'default\_colors' ) ); |
| [241](#L241) | $hover   = str\_replace( $prefix, '', $this->get\_option( $prefix . 'hover\_colors' ) ); |
| [242](#L242) | $single  = str\_replace( $prefix, '', $this->get\_option( $prefix . 'single\_colors' ) ); |
| [243](#L243) | return " swp\_default\_{$default} swp\_other\_{$hover} swp\_individual\_{$single} "; |
| [244](#L244) |  |
| [245](#L245) | } |
| [246](#L246) |  |
| [247](#L247) |  |
| [248](#L248) | /\*\* |
| [249](#L249) | \* A method to fetch/determine the shape of the current buttons. |
| [250](#L250) | \* |
| [251](#L251) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [252](#L252) | \* @param  void |
| [253](#L253) | \* @return string The string of the CSS class to be used. |
| [254](#L254) | \* |
| [255](#L255) | \*/ |
| [256](#L256) | protected function get\_shape() { |
| [257](#L257) | $button\_shape = $this->get\_option( 'button\_shape' ); |
| [258](#L258) |  |
| [259](#L259) | //\* They have gone from an Addon to Core. |
| [260](#L260) | if ( false === $button\_shape ) { |
| [261](#L261) | return "swp\_flat\_fresh "; |
| [262](#L262) | } |
| [263](#L263) |  |
| [264](#L264) | return "swp\_{$button\_shape} "; |
| [265](#L265) | } |
| [266](#L266) |  |
| [267](#L267) |  |
| [268](#L268) | /\*\* |
| [269](#L269) | \* A method to fetch/determine the size/scale of the panel. |
| [270](#L270) | \* |
| [271](#L271) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [272](#L272) | \* @param  void |
| [273](#L273) | \* @return string The CSS class to be added to the panel. |
| [274](#L274) | \* |
| [275](#L275) | \*/ |
| [276](#L276) | protected function get\_scale() { |
| [277](#L277) | $button\_size = $this->get\_option( 'button\_size' ); |
| [278](#L278) |  |
| [279](#L279) | //\* They have gone from an Addon to Core. |
| [280](#L280) | if ( false === $button\_size ) { |
| [281](#L281) | return "scale-100 "; |
| [282](#L282) | } |
| [283](#L283) |  |
| [284](#L284) | return 'scale-' . $button\_size \* 100; |
| [285](#L285) | } |
| [286](#L286) |  |
| [287](#L287) |  |
| [288](#L288) | /\*\* |
| [289](#L289) | \* A method for getting the minimum width of the buttons panel. |
| [290](#L290) | \* |
| [291](#L291) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [292](#L292) | \* @param  void |
| [293](#L293) | \* @return string The HTML attribute to be added to the buttons panel. |
| [294](#L294) | \* |
| [295](#L295) | \*/ |
| [296](#L296) | protected function get\_min\_width() { |
| [297](#L297) | $min\_width = $this->get\_option( 'float\_screen\_width' ); |
| [298](#L298) |  |
| [299](#L299) | //\* They have gone from an Addon to Core. |
| [300](#L300) | if ( false === $min\_width ) { |
| [301](#L301) | return 'data-min-width="1100" '; |
| [302](#L302) | } |
| [303](#L303) |  |
| [304](#L304) | return 'data-min-width="' . $min\_width . '" '; |
| [305](#L305) | } |
| [306](#L306) |  |
| [307](#L307) |  |
| [308](#L308) | /\*\* |
| [309](#L309) | \* A method for getting the ID of the current post. |
| [310](#L310) | \* |
| [311](#L311) | \* @since  4.0.1 | 01 APR 2020 | Created |
| [312](#L312) | \* @param  void |
| [313](#L313) | \* @return string The HTML attribute to be added to the buttons panel. |
| [314](#L314) | \* |
| [315](#L315) | \*/ |
| [316](#L316) | protected function get\_post\_id\_attribute() { |
| [317](#L317) | return 'data-post-id="'.$this->post\_id.'" '; |
| [318](#L318) | } |
| [319](#L319) |  |
| [320](#L320) |  |
| [321](#L321) | /\*\* |
| [322](#L322) | \* A method for getting the transition mode for the side floating buttons. |
| [323](#L323) | \* |
| [324](#L324) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [325](#L325) | \* @param  void |
| [326](#L326) | \* @return string The HTML attribute to be added to the buttons panel. |
| [327](#L327) | \* |
| [328](#L328) | \*/ |
| [329](#L329) | protected function get\_float\_transition() { |
| [330](#L330) | $transition = $this->get\_option( 'transition' ); |
| [331](#L331) |  |
| [332](#L332) | //\* They have gone from an Addon to Core. |
| [333](#L333) | if ( false === $transition ) { |
| [334](#L334) | return 'data-transition="slide" '; |
| [335](#L335) | } |
| [336](#L336) |  |
| [337](#L337) | return 'data-transition="' . $transition . '" '; |
| [338](#L338) | } |
| [339](#L339) |  |
| [340](#L340) |  |
| [341](#L341) | /\*\* |
| [342](#L342) | \* A method to determin the background color of the floating buttons. |
| [343](#L343) | \* |
| [344](#L344) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [345](#L345) | \* @param  void |
| [346](#L346) | \* @return string The HTML attribute to be added to the buttons panel. |
| [347](#L347) | \* |
| [348](#L348) | \*/ |
| [349](#L349) | protected function get\_float\_background() { |
| [350](#L350) | $float\_background\_color = $this->get\_option( 'float\_background\_color' ); |
| [351](#L351) |  |
| [352](#L352) | //\* They have gone from an Addon to Core. |
| [353](#L353) | if ( false === $float\_background\_color ) { |
| [354](#L354) | return ''; |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | return 'data-float-color="' . $float\_background\_color . '" '; |
| [358](#L358) | } |
| [359](#L359) |  |
| [360](#L360) |  |
| [361](#L361) | /\*\* |
| [362](#L362) | \* Get one of the user options. |
| [363](#L363) | \* |
| [364](#L364) | \* This function acts just like the global SWP\_Utility:get\_option() method. |
| [365](#L365) | \* In fact, it even uses that function as a fallback. Basically, when the |
| [366](#L366) | \* Buttons\_Panel class is instantiated, a user has the option to pass in an |
| [367](#L367) | \* array of options. These will be merged with the global $swp\_user\_options, |
| [368](#L368) | \* and stored in the $this->options property. |
| [369](#L369) | \* |
| [370](#L370) | \* First, we check if the option exists in our local options property. Second, |
| [371](#L371) | \* we use the SWP\_Utility::get\_option() method which will pull the option |
| [372](#L372) | \* from the global settings as well as handle things like requests for |
| [373](#L373) | \* options that may not exist (return false). |
| [374](#L374) | \* |
| [375](#L375) | \* @since  3.0.5 | 10 MAY 2018 | Created |
| [376](#L376) | \* @param  string $key The name of the option. |
| [377](#L377) | \* @return mixed       The value of that option. |
| [378](#L378) | \* |
| [379](#L379) | \*/ |
| [380](#L380) | protected function get\_option( $key ) { |
| [381](#L381) |  |
| [382](#L382) | // Check if this option exists in this panel's localized options. |
| [383](#L383) | if( isset( $this->options[$key] ) ) { |
| [384](#L384) | return $this->options[$key]; |
| [385](#L385) | } |
| [386](#L386) |  |
| [387](#L387) | // As a backup, use the option as it exists in the global user options. |
| [388](#L388) | return SWP\_Utility::get\_option( $key ); |
| [389](#L389) | } |
| [390](#L390) |  |
| [391](#L391) |  |
| [392](#L392) | /\*\* |
| [393](#L393) | \* A Method to determine the location of the floating buttons |
| [394](#L394) | \* |
| [395](#L395) | \* This method was created because we can't just use the option as it is set |
| [396](#L396) | \* in the options page. Instead, we must first check that we are on a single.php |
| [397](#L397) | \* page and second we must check that the floating buttons toggle is turned on. |
| [398](#L398) | \* Then and only then will we check the actual floating location and return it. |
| [399](#L399) | \* |
| [400](#L400) | \* @since  3.0.0 | 09 MAY 2018 | Created |
| [401](#L401) | \* @since  3.0.4 | 09 MAY 2018 | Added check for the global post type on/off toggle. |
| [402](#L402) | \* @param  void |
| [403](#L403) | \* @return string A string containing the float bar location. |
| [404](#L404) | \* |
| [405](#L405) | \*/ |
| [406](#L406) | public function get\_float\_location() { |
| [407](#L407) |  |
| [408](#L408) |  |
| [409](#L409) | /\*\* |
| [410](#L410) | \* If we failed to populate a post id, then we just bail out and won't |
| [411](#L411) | \* be showing any. |
| [412](#L412) | \* |
| [413](#L413) | \*/ |
| [414](#L414) | if( false == isset( $this->post\_id ) ) { |
| [415](#L415) | return 'none'; |
| [416](#L416) | } |
| [417](#L417) |  |
| [418](#L418) |  |
| [419](#L419) | /\*\* |
| [420](#L420) | \* These are the float location settings all across the WordPress |
| [421](#L421) | \* ecosystem. There is a global on/off setting, a per post type on/off |
| [422](#L422) | \* setting, and even a setting on each individual post. |
| [423](#L423) | \* |
| [424](#L424) | \*/ |
| [425](#L425) | $float\_location    = $this->get\_option( 'float\_location' ); |
| [426](#L426) | $global\_setting    = $this->get\_option('floating\_panel' ); |
| [427](#L427) | $post\_type\_setting = 'on' == $this->get\_option('float\_location\_' . $this->post\_data['post\_type'] ); |
| [428](#L428) | $post\_setting      = get\_post\_meta( $this->post\_id, 'swp\_float\_location', true ); |
| [429](#L429) |  |
| [430](#L430) |  |
| [431](#L431) | /\*\* |
| [432](#L432) | \* If the floaters are implicitly turned on at the post level, then that |
| [433](#L433) | \* means the user wants them to float on this post regardless of the |
| [434](#L434) | \* global settings. |
| [435](#L435) | \* |
| [436](#L436) | \*/ |
| [437](#L437) | if( 'on' === $post\_setting ) { |
| [438](#L438) | return $float\_location; |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) |  |
| [442](#L442) | /\*\* |
| [443](#L443) | \* We don't use floating buttons on the home page. |
| [444](#L444) | \* |
| [445](#L445) | \*/ |
| [446](#L446) | if( is\_home() && !is\_front\_page() ) { |
| [447](#L447) | return 'none'; |
| [448](#L448) | } |
| [449](#L449) |  |
| [450](#L450) |  |
| [451](#L451) | /\*\* |
| [452](#L452) | \* Do not print floating buttons on archive pages. |
| [453](#L453) | \* |
| [454](#L454) | \*/ |
| [455](#L455) | if ( !is\_singular() ) { |
| [456](#L456) | return 'none'; |
| [457](#L457) | } |
| [458](#L458) |  |
| [459](#L459) |  |
| [460](#L460) | /\*\* |
| [461](#L461) | \* If the location on this specific post is set to off, then we'll |
| [462](#L462) | \* disable floating locations. Anything else and we'll defer to the |
| [463](#L463) | \* global setting. |
| [464](#L464) | \* |
| [465](#L465) | \*/ |
| [466](#L466) | if ( !empty( $post\_setting ) && 'off' === $post\_setting ) { |
| [467](#L467) | return 'none'; |
| [468](#L468) | } |
| [469](#L469) |  |
| [470](#L470) |  |
| [471](#L471) | /\*\* |
| [472](#L472) | \* If everything checks out, we'll return the global float location. If |
| [473](#L473) | \* somehow nothing checked out, we'll return none. |
| [474](#L474) | \* |
| [475](#L475) | \*/ |
| [476](#L476) | if ( $global\_setting && $post\_type\_setting ) { |
| [477](#L477) | return $float\_location; |
| [478](#L478) | } |
| [479](#L479) |  |
| [480](#L480) | return 'none'; |
| [481](#L481) | } |
| [482](#L482) |  |
| [483](#L483) |  |
| [484](#L484) | /\*\* |
| [485](#L485) | \* This method wraps the output of get\_float\_location into it's html |
| [486](#L486) | \* attribute that will be appended to the wrapper div of the buttons panel. |
| [487](#L487) | \* |
| [488](#L488) | \* @since  3.4.0 | 24 OCT 2018 | Created |
| [489](#L489) | \* @param  void |
| [490](#L490) | \* @return string The html attribute. |
| [491](#L491) | \* |
| [492](#L492) | \*/ |
| [493](#L493) | public function get\_float\_location\_attribute() { |
| [494](#L494) | return 'data-float="' . $this->get\_float\_location() . '" '; |
| [495](#L495) | } |
| [496](#L496) |  |
| [497](#L497) |  |
| [498](#L498) | /\*\* |
| [499](#L499) | \* A Method to determine the location of the floating buttons on mobile devices |
| [500](#L500) | \* |
| [501](#L501) | \* This method was created because we can't just use the option as it is set |
| [502](#L502) | \* in the options page. Instead, we must first check that we are on a single.php |
| [503](#L503) | \* page and second we must check that the floating buttons toggle is turned on. |
| [504](#L504) | \* Then and only then will we check the actual floating location and return it. |
| [505](#L505) | \* |
| [506](#L506) | \* @since  3.0.0 | 09 MAY 2018 | Created |
| [507](#L507) | \* @since  3.0.4 | 09 MAY 2018 | Added check for the global post type on/off toggle. |
| [508](#L508) | \* @since  3.4.0 | 17 OCT 2018 | Added conditions for front\_page, archive, category. |
| [509](#L509) | \* @since  3.4.2 | 07 DEC 2018 | Added conditions for false mobile locations. |
| [510](#L510) | \* @param  void |
| [511](#L511) | \* @return string A string containing the float bar location. |
| [512](#L512) | \* |
| [513](#L513) | \*/ |
| [514](#L514) | public function get\_mobile\_float\_location() { |
| [515](#L515) | $global\_float\_toggle    = $this->get\_option( 'floating\_panel' ); |
| [516](#L516) | $post\_type\_float\_toggle = $this->get\_option( 'float\_location\_' . $this->post\_data['post\_type'] ); |
| [517](#L517) | $float\_location         = $this->get\_option( 'float\_location' ); |
| [518](#L518) | $mobile\_location        = $this->get\_option( 'float\_mobile' ); |
| [519](#L519) |  |
| [520](#L520) |  |
| [521](#L521) | /\*\* |
| [522](#L522) | \* If the float location is completely set to none, then we won't have |
| [523](#L523) | \* any floating buttons on mobile either. |
| [524](#L524) | \* |
| [525](#L525) | \*/ |
| [526](#L526) | if( 'none' == $this->get\_float\_location() ) { |
| [527](#L527) | $mobile\_location = 'none'; |
| [528](#L528) | } |
| [529](#L529) |  |
| [530](#L530) |  |
| [531](#L531) | /\*\* |
| [532](#L532) | \* If the $mobile\_location is set to false, it means that this option |
| [533](#L533) | \* is not available which means that pro is not installed. If this |
| [534](#L534) | \* option were available, it would return as a string. |
| [535](#L535) | \* As such, we'll set it to the defaults that are available in core. |
| [536](#L536) | \* |
| [537](#L537) | \*/ |
| [538](#L538) | if( false === $mobile\_location ) { |
| [539](#L539) | $mobile\_location = $float\_location; |
| [540](#L540) |  |
| [541](#L541) |  |
| [542](#L542) | /\*\* |
| [543](#L543) | \* If the main floating buttons are set to left or right, then the |
| [544](#L544) | \* user won't get any floating buttons at all once those go away. |
| [545](#L545) | \* Switching from side to top/bottom is a pro only feature. If they |
| [546](#L546) | \* have them already set to top/bottom then we will just keep that |
| [547](#L547) | \* setting as no actual transition is needed. |
| [548](#L548) | \* |
| [549](#L549) | \*/ |
| [550](#L550) | if( true === in\_array( $float\_location, array( 'left','right' ) ) ) { |
| [551](#L551) | $mobile\_location = 'none'; |
| [552](#L552) | } |
| [553](#L553) | } |
| [554](#L554) |  |
| [555](#L555) |  |
| [556](#L556) | //\* Front page, archive, and categories do not have a global float option. |
| [557](#L557) | //\* Instead they use options in the post editor (saved in post\_meta). |
| [558](#L558) | if ( is\_front\_page() || is\_archive() || is\_category() ) { |
| [559](#L559) | $float\_enabled = get\_post\_meta( $this->post\_data['ID'], 'swp\_float\_location', true ); |
| [560](#L560) |  |
| [561](#L561) | if ( 'off' != $float\_enabled ) { |
| [562](#L562) | return 'data-float-mobile="' . $mobile\_location . '" '; |
| [563](#L563) | } |
| [564](#L564) |  |
| [565](#L565) | return 'data-float-mobile="none" '; |
| [566](#L566) | } |
| [567](#L567) |  |
| [568](#L568) | if( is\_singular() && true === $global\_float\_toggle && 'on' === $post\_type\_float\_toggle ) { |
| [569](#L569) | return 'data-float-mobile="' . $mobile\_location . '" '; |
| [570](#L570) | } |
| [571](#L571) |  |
| [572](#L572) | return 'data-float-mobile="none" '; |
| [573](#L573) | } |
| [574](#L574) |  |
| [575](#L575) |  |
| [576](#L576) | /\*\* |
| [577](#L577) | \* A method to control the order in which the buttons are output. |
| [578](#L578) | \* |
| [579](#L579) | \* @since  3.4.0 | 20 SEP 2018 | Created |
| [580](#L580) | \* @since  3.4.2 | 05 DEC 2018 | Added check for false sort\_method for core. |
| [581](#L581) | \* @param  void |
| [582](#L582) | \* @return array The array of network names in their proper order. |
| [583](#L583) | \* |
| [584](#L584) | \*/ |
| [585](#L585) | protected function get\_order\_of\_icons() { |
| [586](#L586) | global $swp\_social\_networks; |
| [587](#L587) | $active\_networks = SWP\_Utility::get\_option( 'order\_of\_icons' ); |
| [588](#L588) | $sort\_method     = SWP\_Utility::get\_option( 'order\_of\_icons\_method' ); |
| [589](#L589) | $order           = array(); |
| [590](#L590) |  |
| [591](#L591) |  |
| [592](#L592) | /\*\* |
| [593](#L593) | \* If the icons are set to be manually sorted, then we simply use the |
| [594](#L594) | \* order from the options page that the user has set. |
| [595](#L595) | \* |
| [596](#L596) | \* Adding a check for false, because this option is pro only and will |
| [597](#L597) | \* return false if it is not available in core, and therefore will default |
| [598](#L598) | \* to the manual sorting method. |
| [599](#L599) | \* |
| [600](#L600) | \*/ |
| [601](#L601) | if ( 'manual' === $sort\_method || false === $sort\_method ) { |
| [602](#L602) | return $active\_networks; |
| [603](#L603) | } |
| [604](#L604) |  |
| [605](#L605) |  |
| [606](#L606) | /\*\* |
| [607](#L607) | \* Even if it's not set to manual sorting, we will still use the manual |
| [608](#L608) | \* order of the buttons if we don't have any share counts by which to |
| [609](#L609) | \* process the order dynamically. |
| [610](#L610) | \* |
| [611](#L611) | \*/ |
| [612](#L612) | if( empty( $this->shares ) || !is\_array( $this->shares ) ) { |
| [613](#L613) | return $active\_networks; |
| [614](#L614) | } |
| [615](#L615) |  |
| [616](#L616) |  |
| [617](#L617) | /\*\* |
| [618](#L618) | \* If the icons are set to be ordered dynamically, and we passed the |
| [619](#L619) | \* check above then we will sort them based on how many shares each |
| [620](#L620) | \* network has. |
| [621](#L621) | \* |
| [622](#L622) | \*/ |
| [623](#L623) | arsort( $this->shares ); |
| [624](#L624) | foreach( $this->shares as $network => $share\_count ) { |
| [625](#L625) | if( $network != 'total\_shares' && in\_array( $network, $active\_networks ) ) { |
| [626](#L626) | $order[$network] = $network; |
| [627](#L627) | } |
| [628](#L628) | } |
| [629](#L629) | $this->options['order\_of\_icons'] = $order; |
| [630](#L630) | return $order; |
| [631](#L631) | } |
| [632](#L632) |  |
| [633](#L633) |  |
| [634](#L634) | /\*\* |
| [635](#L635) | \* A method to arrange the array of network objects in proper order. |
| [636](#L636) | \* |
| [637](#L637) | \* @since  3.0.0 | 04 MAY 2018 | Created |
| [638](#L638) | \* @since  3.3.0 | 30 AUG 2018 | Renamed from 'order\_network\_objects' to 'get\_ordered\_network\_objects' |
| [639](#L639) | \* @param  array $order An ordered array of network keys. |
| [640](#L640) | \* @return array        An ordered array of network objects. |
| [641](#L641) | \* |
| [642](#L642) | \*/ |
| [643](#L643) | protected function get\_ordered\_network\_objects( $order ) { |
| [644](#L644) | $network\_objects = array(); |
| [645](#L645) |  |
| [646](#L646) | if ( empty( $order ) ) : |
| [647](#L647) | $order = SWP\_Utility::get\_option( 'order\_of\_icons' ); |
| [648](#L648) | endif; |
| [649](#L649) |  |
| [650](#L650) | foreach( $order as $network\_key ) { |
| [651](#L651) | foreach( $this->networks as $key => $network ) : |
| [652](#L652) | if ( $key === $network\_key ) : |
| [653](#L653) | $network\_objects[$key] = $network; |
| [654](#L654) | endif; |
| [655](#L655) | endforeach; |
| [656](#L656) | } |
| [657](#L657) |  |
| [658](#L658) | return $network\_objects; |
| [659](#L659) | } |
| [660](#L660) |  |
| [661](#L661) |  |
| [662](#L662) | /\*\* |
| [663](#L663) | \* Render the html for the indivial buttons. |
| [664](#L664) | \* |
| [665](#L665) | \* @since  3.0.0 | 01 MAR 2018 | Created |
| [666](#L666) | \* @param  integer $max\_count The maximum number of buttons to display. |
| [667](#L667) | \* @return string             The compiled html for the buttons. |
| [668](#L668) | \* |
| [669](#L669) | \*/ |
| [670](#L670) | protected function generate\_individual\_buttons\_html() { |
| [671](#L671) | $html = ''; |
| [672](#L672) | $count = 0; |
| [673](#L673) |  |
| [674](#L674) | foreach( $this->networks as $key => $network ) { |
| [675](#L675) |  |
| [676](#L676) |  |
| [677](#L677) | /\*\* |
| [678](#L678) | \* The floating buttons have a maximum number of buttons that can |
| [679](#L679) | \* be displayed at any given time. If that number is set, we bail |
| [680](#L680) | \* out once that maximum has been reached. If that number is set to |
| [681](#L681) | \* zero, it represents unlimited buttons can be displayed. |
| [682](#L682) | \* |
| [683](#L683) | \*/ |
| [684](#L684) | if ( 0 !== $this->max\_buttons && $count == $this->max\_buttons ) : |
| [685](#L685) | return $html; |
| [686](#L686) | endif; |
| [687](#L687) |  |
| [688](#L688) | // Pass in some context for this specific panel of buttons |
| [689](#L689) | $context['shares']    = $this->shares; |
| [690](#L690) | $context['options']   = $this->options; |
| [691](#L691) | $context['post\_data'] = $this->post\_data; |
| [692](#L692) | $html .= $network->render\_HTML( $context ); |
| [693](#L693) | $count++; |
| [694](#L694) | } |
| [695](#L695) |  |
| [696](#L696) | return $html; |
| [697](#L697) | } |
| [698](#L698) |  |
| [699](#L699) |  |
| [700](#L700) | /\*\* |
| [701](#L701) | \* The Total Shares Count |
| [702](#L702) | \* |
| [703](#L703) | \* If share counts are active, renders the Total Share Counts HTML. |
| [704](#L704) | \* |
| [705](#L705) | \* @since  3.0.0 | 18 APR 2018 | Created |
| [706](#L706) | \* @since  3.3.2 | 12 SEP 2018 | Moved strtolower to $totals\_argument |
| [707](#L707) | \* @since  3.4.0 | 20 SEP 2018 | Moved display logic to should\_total\_shares\_display() |
| [708](#L708) | \* @param  void |
| [709](#L709) | \* @return string $html The fully qualified HTML to display share counts. |
| [710](#L710) | \* |
| [711](#L711) | \*/ |
| [712](#L712) | public function generate\_total\_shares\_html() { |
| [713](#L713) |  |
| [714](#L714) | // Check if total shares should be rendered or not. |
| [715](#L715) | if( false === $this->should\_total\_shares\_display() ) { |
| [716](#L716) | return; |
| [717](#L717) | } |
| [718](#L718) |  |
| [719](#L719) | // Render the html for the total shares. |
| [720](#L720) | $html = '<div class="nc\_tweetContainer swp\_share\_button total\_shares total\_sharesalt" >'; |
| [721](#L721) | $html .= '<span class="swp\_count ">' . SWP\_Utility::kilomega( $this->shares['total\_shares'] ) . ' <span class="swp\_label">' . \_\_( 'Shares','social-warfare' ) . '</span></span>'; |
| [722](#L722) | $html .= '</div>'; |
| [723](#L723) |  |
| [724](#L724) | return $html; |
| [725](#L725) | } |
| [726](#L726) |  |
| [727](#L727) |  |
| [728](#L728) | /\*\* |
| [729](#L729) | \* Should the total shares be rendered. |
| [730](#L730) | \* |
| [731](#L731) | \* @since  3.4.0 | 20 SEP 2018 | Created |
| [732](#L732) | \* @param  void |
| [733](#L733) | \* @return bool True: show shares; False: don't render them. |
| [734](#L734) | \* |
| [735](#L735) | \*/ |
| [736](#L736) | protected function should\_total\_shares\_display() { |
| [737](#L737) |  |
| [738](#L738) |  |
| [739](#L739) | /\*\* |
| [740](#L740) | \* If the share counts are delayed in the options, then we'll check the |
| [741](#L741) | \* current age of the post and check to see if they are still delayed |
| [742](#L742) | \* or if they can be shown now. |
| [743](#L743) | \* |
| [744](#L744) | \*/ |
| [745](#L745) | if( true === SWP\_Buttons\_Panel::are\_share\_counts\_delayed( $this->post\_id ) ) { |
| [746](#L746) | return false; |
| [747](#L747) | } |
| [748](#L748) |  |
| [749](#L749) |  |
| [750](#L750) | /\*\* |
| [751](#L751) | \* Find out if the total shares are activated on the settings page. We |
| [752](#L752) | \* will overwrite this variable if the user has passed in a 'buttons' |
| [753](#L753) | \* argument and instead use what they've passed in. |
| [754](#L754) | \* |
| [755](#L755) | \*/ |
| [756](#L756) | $are\_total\_shares\_active = $this->get\_option('total\_shares'); |
| [757](#L757) |  |
| [758](#L758) |  |
| [759](#L759) | /\*\* |
| [760](#L760) | \* If this is a shortcode and the buttons argument has been specifically |
| [761](#L761) | \* passed into the function, then we will use that buttons argument to |
| [762](#L762) | \* determine whether or not to display the total shares. |
| [763](#L763) | \* |
| [764](#L764) | \*/ |
| [765](#L765) | $buttons = isset( $this->args['buttons'] ) ? $this->args['buttons'] : array(); |
| [766](#L766) | if ( $this->is\_shortcode && !empty( $buttons ) ) { |
| [767](#L767) | $total = in\_array('total', array\_map('strtolower', $buttons) ); |
| [768](#L768) | $totals = in\_array('totals', array\_map('strtolower', $buttons) ); |
| [769](#L769) | $are\_total\_shares\_active = ( $total || $totals ); |
| [770](#L770) | } |
| [771](#L771) |  |
| [772](#L772) |  |
| [773](#L773) | /\*\* |
| [774](#L774) | \* If total shares are turned off or this is a shortcode with a buttons |
| [775](#L775) | \* parameter that didn't include totals then we're not going to render |
| [776](#L776) | \* any total shares. |
| [777](#L777) | \* |
| [778](#L778) | \*/ |
| [779](#L779) | if ( false == $are\_total\_shares\_active ) { |
| [780](#L780) | return false; |
| [781](#L781) | } |
| [782](#L782) |  |
| [783](#L783) |  |
| [784](#L784) | /\*\* |
| [785](#L785) | \* If minimum share counts are enabled and this post hasn't achieved |
| [786](#L786) | \* that threshold of shares yet, then we don't show them. |
| [787](#L787) | \* |
| [788](#L788) | \*/ |
| [789](#L789) | if ( $this->shares['total\_shares'] < $this->get\_option('minimum\_shares') ) { |
| [790](#L790) | return false; |
| [791](#L791) | } |
| [792](#L792) |  |
| [793](#L793) |  |
| [794](#L794) | // If none of the flags above get caught, return true. |
| [795](#L795) | return true; |
| [796](#L796) | } |
| [797](#L797) |  |
| [798](#L798) |  |
| [799](#L799) | /\*\* |
| [800](#L800) | \* Combine the Total Shares html with the Buttons html. |
| [801](#L801) | \* |
| [802](#L802) | \* @since  3.4.0 | 23 OCT 2018 | Created |
| [803](#L803) | \* @param  void |
| [804](#L804) | \* @return string The html for the buttons and total shares. |
| [805](#L805) | \* |
| [806](#L806) | \*/ |
| [807](#L807) | protected function generate\_buttons\_and\_totals\_html() { |
| [808](#L808) |  |
| [809](#L809) | // Generate the html for the total shares and each button in the set. |
| [810](#L810) | $total\_shares\_html = $this->generate\_total\_shares\_html(); |
| [811](#L811) | $buttons\_html      = $this->generate\_individual\_buttons\_html(); |
| [812](#L812) | $is\_side\_floating  = ('floating\_side' == $this->panel\_type); |
| [813](#L813) | $is\_left\_aligned   = ('totals\_left' == $this->get\_option('totals\_alignment')); |
| [814](#L814) |  |
| [815](#L815) |  |
| [816](#L816) | /\*\* |
| [817](#L817) | \* $is\_side\_floating: If this is a set of floating sidebar buttons, then |
| [818](#L818) | \* we will attach the total shares to the left which will then visually |
| [819](#L819) | \* appear at the top of the panel. |
| [820](#L820) | \* |
| [821](#L821) | \* $is\_left\_aligned: If, in the options page, the user has set the total |
| [822](#L822) | \* shares to appear on the left, then we will concantenate the html to |
| [823](#L823) | \* the left. |
| [824](#L824) | \* |
| [825](#L825) | \*/ |
| [826](#L826) | if( $is\_side\_floating || $is\_left\_aligned ) { |
| [827](#L827) | $this->inner\_html = $total\_shares\_html . $buttons\_html; |
| [828](#L828) | return; |
| [829](#L829) | } |
| [830](#L830) |  |
| [831](#L831) | /\*\* |
| [832](#L832) | \* If it's not a set of floating buttons and it's not set to the left, |
| [833](#L833) | \* then we attach the total shares on the right. |
| [834](#L834) | \* |
| [835](#L835) | \*/ |
| [836](#L836) |  |
| [837](#L837) | else { |
| [838](#L838) | $this->inner\_html = $buttons\_html . $total\_shares\_html; |
| [839](#L839) | } |
| [840](#L840) | } |
| [841](#L841) |  |
| [842](#L842) |  |
| [843](#L843) | /\*\* |
| [844](#L844) | \* Generate the html attributes attached to the container. |
| [845](#L845) | \* |
| [846](#L846) | \* @since  3.4.0 | 23 OCT 2018 | Created |
| [847](#L847) | \* @param  void |
| [848](#L848) | \* @return void |
| [849](#L849) | \* @var    $this->attributes Stores panel html attributes as a string of text. |
| [850](#L850) | \* |
| [851](#L851) | \*/ |
| [852](#L852) | protected function generate\_attributes() { |
| [853](#L853) | $attributes  = $this->get\_min\_width(); |
| [854](#L854) | $attributes .= $this->get\_float\_background(); |
| [855](#L855) | $attributes .= $this->get\_float\_location\_attribute(); |
| [856](#L856) | $attributes .= $this->get\_mobile\_float\_location(); |
| [857](#L857) | $attributes .= $this->get\_float\_transition(); |
| [858](#L858) | $attributes .= $this->get\_post\_id\_attribute(); |
| [859](#L859) | $this->attributes = $attributes; |
| [860](#L860) | } |
| [861](#L861) |  |
| [862](#L862) |  |
| [863](#L863) | /\*\* |
| [864](#L864) | \* Generate the CSS classes that need to be applied to the buttons panel. |
| [865](#L865) | \* |
| [866](#L866) | \* @since  3.4.0 | 23 OCT 2018 | Created |
| [867](#L867) | \* @param  void |
| [868](#L868) | \* @return void |
| [869](#L869) | \* @var    $this->classes Stores panel classes as a string of text. |
| [870](#L870) | \* |
| [871](#L871) | \*/ |
| [872](#L872) | protected function generate\_css\_classes() { |
| [873](#L873) | $classes = 'class="swp\_social\_panel swp\_horizontal\_panel '; |
| [874](#L874) | $classes .= $this->get\_shape(); |
| [875](#L875) | $classes .= $this->get\_colors(); |
| [876](#L876) | $classes .= $this->get\_scale(); |
| [877](#L877) | $classes .= $this->get\_alignment(); |
| [878](#L878) | $classes .= '" '; |
| [879](#L879) | $this->classes = $classes; |
| [880](#L880) | } |
| [881](#L881) |  |
| [882](#L882) |  |
| [883](#L883) | /\*\* |
| [884](#L884) | \* A method used to combine the CSS classes for the panel wrapper, the |
| [885](#L885) | \* html attributes, and the html for the buttons and total shares into one |
| [886](#L886) | \* single string of html for output. |
| [887](#L887) | \* |
| [888](#L888) | \* @since  3.4.0 | 24 OCT 2018 | Created |
| [889](#L889) | \* @param  void |
| [890](#L890) | \* @return void |
| [891](#L891) | \* @var    $this->html Stores the fully compiled panel html as a string. |
| [892](#L892) | \* |
| [893](#L893) | \*/ |
| [894](#L894) | protected function combine\_html\_assets() { |
| [895](#L895) | $this->html = '<div ' . $this->classes . $this->attributes . '>' . $this->inner\_html . '</div>'; |
| [896](#L896) | } |
| [897](#L897) |  |
| [898](#L898) |  |
| [899](#L899) | /\*\* |
| [900](#L900) | \* This allows users to delay the display of share counts until the post |
| [901](#L901) | \* has reached a certain age in hours. So if they set the option to 10, |
| [902](#L902) | \* then the share counts will not display until the post is at least |
| [903](#L903) | \* that old. |
| [904](#L904) | \* |
| [905](#L905) | \* @since  4.0.0 | 12 JUL 2019 | Created |
| [906](#L906) | \* @param  integer $post\_id The Post ID |
| [907](#L907) | \* @return boolean True if delayed, false if not delayed. |
| [908](#L908) | \* |
| [909](#L909) | \*/ |
| [910](#L910) | public static function are\_share\_counts\_delayed( $post\_id ) { |
| [911](#L911) | $delay\_share\_counts = SWP\_Utility::get\_option( 'delay\_share\_counts' ); |
| [912](#L912) | if( !empty($delay\_share\_counts) && is\_numeric($delay\_share\_counts) && $delay\_share\_counts > 0 ) { |
| [913](#L913) | $delay\_share\_counts = $delay\_share\_counts \* 60 \* 60; |
| [914](#L914) | $current\_time       = date( 'U' ); |
| [915](#L915) | $publication\_time   = get\_post\_time( 'U' , true , $post\_id ); |
| [916](#L916) | $post\_age           = $current\_time - $publication\_time; |
| [917](#L917) |  |
| [918](#L918) | if($post\_age < $delay\_share\_counts ) { |
| [919](#L919) | return true; |
| [920](#L920) | } |
| [921](#L921) | } |
| [922](#L922) | return false; |
| [923](#L923) | } |
| [924](#L924) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php?format=txt)
* [Original Format](/export/3222447/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_45d1f073_20250114_190922.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Social Sharing Plugin - Social Warfare <= 4.4.3 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Social Sharing Plugin - Social Warfare <= 4.4.3 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-4842](https://www.cve.org/CVERecord?id=CVE-2023-4842) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | November 6, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The Social Sharing Plugin - Social Warfare plugin for WordPress is vulnerable to Stored Cross-Site Scripting via 'social\_warfare' shortcode in versions up to, and including, 4.4.3 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers with contributor-level and above permissions to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php#L304)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/social-warfare/tags/4.4.1/lib/buttons-panel/SWP_Buttons_Panel_Trait.php#L877)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2982662/social-warfare#file0)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fsocial-warfare%2Fsocial-sharing-plugin-social-warfare-443-authenticated-contributor-stored-cross-site-scripting-via-shortcode&t=Social%20Sharing%20Plugin%20-%20Social%20Warfare%20%3C%3D%204.4.3%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fsocial-warfare%2Fsocial-sharing-plugin-social-warfare-443-authenticated-contributor-stored-cross-site-scripting-via-shortcode&text=Social%20Sharing%20Plugin%20-%20Social%20Warfare%20%3C%3D%204.4.3%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fsocial-warfare%2Fsocial-sharing-plugin-social-warfare-443-authenticated-contributor-stored-cross-site-scripting-via-shortcode "LinkedIn")
Email

## Vulnerability Details for Social Sharing Plugin – Social Warfare

#### [Social Sharing Plugin – Social Warfare](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/social-warfare)

| Software Type | Plugin |
| --- | --- |
| Software Slug | social-warfare [(view on wordpress.org)](https://wordpress.org/plugins/social-warfare) |
| Patched? | Yes |
| Remediation | Update to version 4.4.4, or a newer patched version |
| Affected Version | * <= 4.4.3 |
| Patched Version | * 4.4.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


