=== Content from seclists.org_8f644110_20250115_093722.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](25)

![](/shared/images/nst-icons.svg#search)

# APPLE-SA-10-25-2023-4 macOS Sonoma 14.1

---

*From*: Apple Product Security via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 25 Oct 2023 12:03:38 -0700

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

APPLE-SA-10-25-2023-4 macOS Sonoma 14.1

macOS Sonoma 14.1 addresses the following issues.
Information about the security content is also available at
<https://support.apple.com/kb/HT213984>.

Apple maintains a Security Updates page at
<https://support.apple.com/HT201222> which lists recent
software updates with security advisories.

App Support
Available for: macOS Sonoma
Impact: Parsing a file may lead to an unexpected app termination or
arbitrary code execution
Description: This issue was addressed by removing the vulnerable code.
CVE-2023-30774

AppSandbox
Available for: macOS Sonoma
Impact: An app may be able to access user-sensitive data
Description: A permissions issue was addressed with additional
restrictions.
CVE-2023-40444: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

Contacts
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2023-41072: Wojciech Regula of SecuRing (wojciechregula.blog) and
Csaba Fitzl (@theevilbit) of Offensive Security
CVE-2023-42857: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

CoreAnimation
Available for: macOS Sonoma
Impact: An app may be able to cause a denial-of-service
Description: The issue was addressed with improved memory handling.
CVE-2023-40449: Tomi Tokics (@tomitokics) of iTomsn0w

Emoji
Available for: macOS Sonoma
Impact: An attacker may be able to execute arbitrary code as root from
the Lock Screen
Description: The issue was addressed by restricting options offered on a
locked device.
CVE-2023-41989: Jewel Lambert

FileProvider
Available for: macOS Sonoma
Impact: An app may be able to cause a denial-of-service to Endpoint
Security clients
Description: This issue was addressed by removing the vulnerable code.
CVE-2023-42854: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

Find My
Available for: macOS Sonoma
Impact: An app may be able to read sensitive location information
Description: The issue was addressed with improved handling of caches.
CVE-2023-40413: Adam M.

Foundation
Available for: macOS Sonoma
Impact: A website may be able to access sensitive user data when
resolving symlinks
Description: This issue was addressed with improved handling of
symlinks.
CVE-2023-42844: Ron Masas of BreakPoint.SH

ImageIO
Available for: macOS Sonoma
Impact: Processing an image may result in disclosure of process memory
Description: The issue was addressed with improved memory handling.
CVE-2023-40416: JZ

IOTextEncryptionFamily
Available for: macOS Sonoma
Impact: An app may be able to execute arbitrary code with kernel
privileges
Description: The issue was addressed with improved memory handling.
CVE-2023-40423: an anonymous researcher

iperf3
Available for: macOS Sonoma
Impact: A remote user may be able to cause unexpected app termination or
arbitrary code execution
Description: The issue was addressed with improved checks.
CVE-2023-38403

Kernel
Available for: macOS Sonoma
Impact: An attacker that has already achieved kernel code execution may
be able to bypass kernel memory mitigations
Description: The issue was addressed with improved memory handling.
CVE-2023-42849: Linus Henze of Pinauten GmbH (pinauten.de)

LaunchServices
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: The issue was addressed with improved permissions logic.
CVE-2023-42850: Thijs Alkemade (@xnyhps) from Computest Sector 7, Brian
McNulty, Zhongquan Li

Login Window
Available for: macOS Sonoma
Impact: An attacker with knowledge of a standard user's credentials can
unlock another standard user's locked screen on the same Mac
Description: A logic issue was addressed with improved state management.
CVE-2023-42861: Jon Crain, ÂáØ Áéã, Brandon Chesser & CPU IT, inc, Matthew
McLean, Steven Maser, and Avalon IT Team of Concentrix

Mail Drafts
Available for: macOS Sonoma
Impact: Hide My Email may be deactivated unexpectedly
Description: An inconsistent user interface issue was addressed with
improved state management.
CVE-2023-40408: Grzegorz Riegel

Maps
Available for: macOS Sonoma
Impact: An app may be able to read sensitive location information
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2023-40405: Csaba Fitzl (@theevilbit) of Offensive Security

Model I/O
Available for: macOS Sonoma
Impact: Processing a file may lead to unexpected app termination or
arbitrary code execution
Description: The issue was addressed with improved memory handling.
CVE-2023-42856: Michael DePlante (@izobashi) of Trend Micro Zero Day
Initiative

Networking
Available for: macOS Sonoma
Impact: An app may be able to execute arbitrary code with kernel
privileges
Description: A use-after-free issue was addressed with improved memory
management.
CVE-2023-40404: Certik Skyfall Team

Passkeys
Available for: macOS Sonoma
Impact: An attacker may be able to access passkeys without
authentication
Description: A logic issue was addressed with improved checks.
CVE-2023-42847: an anonymous researcher

Photos
Available for: macOS Sonoma
Impact: Photos in the Hidden Photos Album may be viewed without
authentication
Description: An authentication issue was addressed with improved state
management.
CVE-2023-42845: Bistrit Dahla

Pro Res
Available for: macOS Sonoma
Impact: An app may be able to execute arbitrary code with kernel
privileges
Description: The issue was addressed with improved memory handling.
CVE-2023-42841: Mingxuan Yang (@PPPF00L), happybabywu and Guang Gong of
360 Vulnerability Research Institute

Safari
Available for: macOS Sonoma
Impact: Visiting a malicious website may reveal browsing history
Description: The issue was addressed with improved handling of caches.
CVE-2023-41977: Alex Renda

Safari
Available for: macOS Sonoma
Impact: Visiting a malicious website may lead to user interface spoofing
Description: An inconsistent user interface issue was addressed with
improved state management.
CVE-2023-42438: Rafay Baloch & Muhammad Samaak, an anonymous researcher

Siri
Available for: macOS Sonoma
Impact: An attacker with physical access may be able to use Siri to
access sensitive user data
Description: This issue was addressed by restricting options offered on
a locked device.
CVE-2023-41982: Bistrit Dahla
CVE-2023-41997: Bistrit Dahla
CVE-2023-41988: Bistrit Dahla

talagent
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: A permissions issue was addressed with additional
restrictions.
CVE-2023-40421: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

Terminal
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: The issue was addressed with improved checks.
CVE-2023-42842: an anonymous researcher

Vim
Available for: macOS Sonoma
Impact: Processing malicious input may lead to code execution
Description: A use-after-free issue was addressed with improved memory
management.
CVE-2023-4733
CVE-2023-4734
CVE-2023-4735
CVE-2023-4736
CVE-2023-4738
CVE-2023-4750
CVE-2023-4751
CVE-2023-4752
CVE-2023-4781

Weather
Available for: macOS Sonoma
Impact: An app may be able to access sensitive user data
Description: A privacy issue was addressed with improved private data
redaction for log entries.
CVE-2023-41254: Cristian Dinca of "Tudor Vianu" National High School of
Computer Science, Romania

WebKit
Available for: macOS Sonoma
Impact: Processing web content may lead to arbitrary code execution
Description: The issue was addressed with improved memory handling.
WebKit Bugzilla: 259836
CVE-2023-40447: Ïù¥Ï§ÄÏÑ±(Junsung Lee) of Cross Republic

WebKit
Available for: macOS Sonoma
Impact: Processing web content may lead to arbitrary code execution
Description: A use-after-free issue was addressed with improved memory
management.
WebKit Bugzilla: 259890
CVE-2023-41976: Ïù¥Ï§ÄÏÑ±(Junsung Lee)

WebKit
Available for: macOS Sonoma
Impact: Processing web content may lead to arbitrary code execution
Description: A logic issue was addressed with improved checks.
WebKit Bugzilla: 260173
CVE-2023-42852: an anonymous researcher

WebKit Process Model
Available for: macOS Sonoma
Impact: Processing web content may lead to a denial-of-service
Description: The issue was addressed with improved memory handling.
WebKit Bugzilla: 260757
CVE-2023-41983: Ïù¥Ï§ÄÏÑ±(Junsung Lee)

WindowServer
Available for: macOS Sonoma
Impact: A website may be able to access the microphone without the
microphone use indicator being shown
Description: This issue was addressed by removing the vulnerable code.
CVE-2023-41975: an anonymous researcher

Additional recognition

libarchive
We would like to acknowledge Bahaa Naamneh for their assistance.

libxml2
We would like to acknowledge OSS-Fuzz, Ned Williamson of Google Project
Zero for their assistance.

Login Window
We would like to acknowledge an anonymous researcher for their
assistance.

man
We would like to acknowledge Kirin (@Pwnrin) for their assistance.

Power Manager
We would like to acknowledge Xia0o0o0o (@Nyaaaaa_ovo) of University of
California, San Diego for their assistance.

Reminders
We would like to acknowledge Noah Roskin-Frazee and Prof. J.
(ZeroClicks.ai Lab) for their assistance.

WebKit
We would like to acknowledge an anonymous researcher for their
assistance.

macOS Sonoma 14.1 may be obtained from the Mac App Store or Apple's
Software Downloads web site: <https://support.apple.com/downloads/>
All information is also posted on the Apple Security Updates
web site: <https://support.apple.com/en-us/HT201222>.

This message is signed with Apple's Product Security PGP key,
and details are available at:
<https://www.apple.com/support/security/pgp/>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEsz9altA7uTI+rE/qX+5d1TXaIvoFAmU5Y1gACgkQX+5d1TXa
Ivp59RAA2EQwY61OvHZQ0u99Wov8TAoM9popyjLrkWBvKbTH03vdZIXyeCOaqFR8
aT5SAlRwGOv0QIp/KmRweGlLl96/YP5fhgmDxISwahJZqOuwFkcj9OTfmoENyd6w
7YYr0BwSfFhrFEQm/OdE4TbiXp+87YiPXA0NPVeClw15bpmQ830aIY3iMJrCLcAE
ZI6QW9Yi3ynYhor1U+24V8hCM6LgMClNCWavZMorx3D1dfcPkhfspZL1cLqrGNqz
cCF0IJaJDqKiFG//4FQqDbMOUuP3/FMkH4vED+9krIRqe51P6XDkVeI/BgFo6wpu
hgZVgcPxMgbeiZX7O4BAY/ygLe2pKpyvBDJKCCo4GjkypcjmFhyyul+J45yLOSA1
+x9EzYE8OSOn4dGA+qT9aKC4Csti9idoK0KsYHN7jCLU56Y9gvIV2n+PcWVhI4RF
gE4BD+71vPyn6+tpf27+Kt5qW1Mj3ru6Q3u0w2xobbLdpgxc66EfCn2ZLxuzSqvc
kSgwf1yOpiMLzBMAqWxgX51qppsQA1du8G6ZNmPjdyV28GpaWNzL/qb3vivaSYkK
b6vrLEGID7U4wFjbVfuc7v0xmZeOgUprH6eQ7PnjRdmMq0xDaW8xFs3iGc6GScvl
ZCI4CcZSLGPrCzmyUpbD+OMFT4SDDaOGSNEXW7jOrRjgQMc6bJQ=
=YgRC
-----END PGP SIGNATURE-----
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](25)

### Current thread:

* **APPLE-SA-10-25-2023-4 macOS Sonoma 14.1** *Apple Product Security via Fulldisclosure (Oct 25)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from huntr.dev_b69a3fb6_20250115_093724.html ===


* [![logo](/horizontal-logo-wh.svg)](/)
* [Bounties](/bounties)
* [Partners](/partners)
* Community
* Info
[SUBMIT REPORT](/bounties/disclose)

Supported by¬†[Protect AI](https://protectai.com/)¬†and leading the way to [MLSecOps](https://mlsecops.com) and greater AI security.

¬© 2024

[Privacy Policy](/privacy)[Terms of Service](/terms)[Code of Conduct](/code-of-conduct)Cookie Preferences[Contact Us](/contact-us)

=== Content from support.apple.com_ae2b50d1_20250115_093725.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of macOS Sonoma 14.1

This document describes the security content of macOS Sonoma 14.1.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security releases](https://support.apple.com/kb/HT201222) page.

Apple security documents reference vulnerabilities by [CVE-ID](https://www.cve.org/About/Overview) when possible.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page.

## macOS Sonoma 14.1

Released October 25, 2023

**App Support**

Available for: macOS Sonoma

Impact: Parsing a file may lead to an unexpected app termination or arbitrary code execution

Description: This issue was addressed by removing the vulnerable code.

CVE-2023-30774

**AppSandbox**

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A permissions issue was addressed with additional restrictions.

CVE-2023-40444: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

**Automation**

Available for: macOS Sonoma

Impact: An app with root privileges may be able to access private information

Description: The issue was addressed with improved checks.

CVE-2023-42952: Zhipeng Huo (@R3dF09) of Tencent Security Xuanwu Lab (xlab.tencent.com)

Entry added February 16, 2024

**Bluetooth**

Available for: macOS Sonoma

Impact: An app may gain unauthorized access to Bluetooth

Description: A permissions issue was addressed with additional restrictions.

CVE-2023-42945

Entry added February 16, 2024

**Contacts**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2023-41072: Wojciech Regula of SecuRing (wojciechregula.blog) and Csaba Fitzl (@theevilbit) of Offensive Security

CVE-2023-42857: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

**CoreAnimation**

Available for: macOS Sonoma

Impact: An app may be able to cause a denial-of-service

Description: The issue was addressed with improved memory handling.

CVE-2023-40449: Tomi Tokics (@tomitokics) of iTomsn0w

**Core Recents**

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: The issue was resolved by sanitizing logging

CVE-2023-42823

Entry added February 16, 2024

**Emoji**

Available for: macOS Sonoma

Impact: An attacker may be able to execute arbitrary code as root from the Lock Screen

Description: The issue was addressed by restricting options offered on a locked device.

CVE-2023-41989: Jewel Lambert

**FileProvider**

Available for: macOS Sonoma

Impact: An app may be able to cause a denial-of-service to Endpoint Security clients

Description: This issue was addressed by removing the vulnerable code.

CVE-2023-42854: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

**Find My**

Available for: macOS Sonoma

Impact: An app may be able to read sensitive location information

Description: The issue was addressed with improved handling of caches.

CVE-2023-40413: Adam M.

**Find My**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A privacy issue was addressed with improved handling of files.

CVE-2023-42834: Csaba Fitzl (@theevilbit) of Offensive Security

Entry added February 16, 2024

**Foundation**

Available for: macOS Sonoma

Impact: A website may be able to access sensitive user data when resolving symlinks

Description: This issue was addressed with improved handling of symlinks.

CVE-2023-42844: Ron Masas of BreakPoint.SH

**Game Center**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A permissions issue was addressed with additional restrictions.

CVE-2023-42953: Michael (Biscuit) Thomas - @biscuit@social.lol

Entry added February 16, 2024

**ImageIO**

Available for: macOS Sonoma

Impact: Processing an image may result in disclosure of process memory

Description: The issue was addressed with improved memory handling.

CVE-2023-40416: JZ

**ImageIO**

Available for: macOS Sonoma

Impact: Processing a maliciously crafted image may lead to heap corruption

Description: The issue was addressed with improved bounds checks.

CVE-2023-42848: JZ

Entry added February 16, 2024

**IOTextEncryptionFamily**

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code with kernel privileges

Description: The issue was addressed with improved memory handling.

CVE-2023-40423: an anonymous researcher

**iperf3**

Available for: macOS Sonoma

Impact: A remote user may be able to cause unexpected app termination or arbitrary code execution

Description: The issue was addressed with improved checks.

CVE-2023-38403

**Kernel**

Available for: macOS Sonoma

Impact: An attacker that has already achieved kernel code execution may be able to bypass kernel memory mitigations

Description: The issue was addressed with improved memory handling.

CVE-2023-42849: Linus Henze of Pinauten GmbH (pinauten.de)

**LaunchServices**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: The issue was addressed with improved permissions logic.

CVE-2023-42850: Thijs Alkemade (@xnyhps) from Computest Sector 7, Zhongquan Li (@Guluisacat), and Bohdan Stasiuk (@Bohdan\_Stasiuk)

Entry updated May 29, 2024

**libc**

Available for: macOS Sonoma

Impact: Processing maliciously crafted input may lead to arbitrary code execution in user-installed apps

Description: The issue was addressed with improved memory handling.

CVE-2023-40446: inooo

Entry added November 3, 2023

**libxpc**

Available for: macOS Sonoma

Impact: A malicious app may be able to gain root privileges

Description: This issue was addressed with improved handling of symlinks.

CVE-2023-42942: Mickey Jin (@patch1t)

Entry added February 16, 2024

**Login Window**

Available for: macOS Sonoma

Impact: An attacker with knowledge of a standard user's credentials can unlock another standard user's locked screen on the same Mac

Description: A logic issue was addressed with improved state management.

CVE-2023-42861: Jon Crain, ÂáØ Áéã, Brandon Chesser & CPU IT, inc, Matthew McLean, Steven Maser, and the Avalon IT Team of Concentrix

Entry updated May 29, 2024

**LoginWindow**

Available for: macOS Sonoma

Impact: A local attacker may be able to view the previous logged in user‚Äôs desktop from the fast user switching screen

Description: An authentication issue was addressed with improved state management.

CVE-2023-42935: ASentientBot

Entry added January 22, 2024, updated April 24, 2024

**Mail Drafts**

Available for: macOS Sonoma

Impact: Hide My Email may be deactivated unexpectedly

Description: An inconsistent user interface issue was addressed with improved state management.

CVE-2023-40408: Grzegorz Riegel

**Maps**

Available for: macOS Sonoma

Impact: An app may be able to read sensitive location information

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2023-40405: Csaba Fitzl (@theevilbit) of Offensive Security

**MediaRemote**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: This issue was addressed with improved redaction of sensitive information.

CVE-2023-28826: Meng Zhang (È≤∏ËêΩ) of NorthSea

Entry added March 7, 2024

**Model I/O**

Available for: macOS Sonoma

Impact: Processing a file may lead to unexpected app termination or arbitrary code execution

Description: The issue was addressed with improved memory handling.

CVE-2023-42856: Michael DePlante (@izobashi) of Trend Micro Zero Day Initiative

**Networking**

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code with kernel privileges

Description: A use-after-free issue was addressed with improved memory management.

CVE-2023-40404: Certik Skyfall Team

**PackageKit**

Available for: macOS Sonoma

Impact: An app may be able to modify protected parts of the file system

Description: The issue was addressed with improved checks.

CVE-2023-42859: Arsenii Kostromin (0x3c3e), Mickey Jin (@patch1t), and Hevel Engineering

CVE-2023-42877: Arsenii Kostromin (0x3c3e)

Entry added February 16, 2024

**PackageKit**

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: The issue was addressed with improved checks.

CVE-2023-42840: Mickey Jin (@patch1t), and Csaba Fitzl (@theevilbit) of Offensive Security

Entry added February 16, 2024

**PackageKit**

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: A logic issue was addressed with improved checks.

CVE-2023-42853: Mickey Jin (@patch1t)

Entry added February 16, 2024

**PackageKit**

Available for: macOS Sonoma

Impact: An app may be able to modify protected parts of the file system

Description: A permissions issue was addressed with additional restrictions.

CVE-2023-42860: Koh M. Nakagawa (@tsunek0h) of FFRI Security, Inc.

Entry added February 16, 2024

**PackageKit**

Available for: macOS Sonoma

Impact: An app may be able to bypass certain Privacy preferences

Description: The issue was addressed with improved checks.

CVE-2023-42889: Mickey Jin (@patch1t)

Entry added February 16, 2024

**Passkeys**

Available for: macOS Sonoma

Impact: An attacker may be able to access passkeys without authentication

Description: A logic issue was addressed with improved checks.

CVE-2023-42847: an anonymous researcher

**Photos**

Available for: macOS Sonoma

Impact: Photos in the Hidden Photos Album may be viewed without authentication

Description: An authentication issue was addressed with improved state management.

CVE-2023-42845: Bistrit Dahal

Entry updated February 16, 2024

**Pro Res**

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code with kernel privileges

Description: The issue was addressed with improved memory handling.

CVE-2023-42841: Mingxuan Yang (@PPPF00L), happybabywu and Guang Gong of 360 Vulnerability Research Institute

**Pro Res**

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code with kernel privileges

Description: The issue was addressed with improved bounds checks.

CVE-2023-42873: Mingxuan Yang (@PPPF00L), and happybabywu and Guang Gong of 360 Vulnerability Research Institute

Entry added February 16, 2024

**quarantine**

Available for: macOS Sonoma

Impact: An app may be able to execute arbitrary code out of its sandbox or with certain elevated privileges

Description: An access issue was addressed with improvements to the sandbox.

CVE-2023-42838: Yiƒüit Can YILMAZ (@yilmazcanyigit), Csaba Fitzl (@theevilbit) of Offensive Security

Entry added February 16, 2024

**RemoteViewServices**

Available for: macOS Sonoma

Impact: An attacker may be able to access user data

Description: A logic issue was addressed with improved checks.

CVE-2023-42835: Mickey Jin (@patch1t)

Entry added February 16, 2024

**Safari**

Available for: macOS Sonoma

Impact: Visiting a malicious website may reveal browsing history

Description: The issue was addressed with improved handling of caches.

CVE-2023-41977: Alex Renda

**Safari**

Available for: macOS Sonoma

Impact: Visiting a malicious website may lead to user interface spoofing

Description: An inconsistent user interface issue was addressed with improved state management.

CVE-2023-42438: Rafay Baloch & Muhammad Samaak, and an anonymous researcher

**Sandbox**

Available for: macOS Sonoma

Impact: An attacker may be able to access connected network volumes mounted in the home directory

Description: A logic issue was addressed with improved checks.

CVE-2023-42836: Yiƒüit Can YILMAZ (@yilmazcanyigit)

Entry added February 16, 2024

**Sandbox**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: This issue was addressed with improved state management.

CVE-2023-42839: Yiƒüit Can YILMAZ (@yilmazcanyigit)

Entry added February 16, 2024

**Share Sheet**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2023-42878: Kirin (@Pwnrin), Wojciech Regula of SecuRing (wojciechregula.blog), and Cristian Dinca of "Tudor Vianu" National High School of Computer Science, Romania

Entry added February 16, 2024

**Siri**

Available for: macOS Sonoma

Impact: An attacker with physical access may be able to use Siri to access sensitive user data

Description: This issue was addressed by restricting options offered on a locked device.

CVE-2023-41982: Bistrit Dahal

CVE-2023-41997: Bistrit Dahal

CVE-2023-41988: Bistrit Dahal

Entry updated February 16, 2024

**Siri**

Available for: macOS Sonoma

Impact: An app may be able to leak sensitive user information

Description: This issue was addressed with improved redaction of sensitive information.

CVE-2023-42946

Entry added February 16, 2024

**SQLite**

Available for: macOS Sonoma

Impact: A remote user may be able to cause a denial-of-service

Description: This issue was addressed with improved checks.

CVE-2023-36191

Entry added February 16, 2024

**talagent**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A permissions issue was addressed with additional restrictions.

CVE-2023-40421: Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab)

**Terminal**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: The issue was addressed with improved checks.

CVE-2023-42842: an anonymous researcher

**Vim**

Available for: macOS Sonoma

Impact: Processing malicious input may lead to code execution

Description: A use-after-free issue was addressed with improved memory management.

CVE-2023-4733

CVE-2023-4734

CVE-2023-4735

CVE-2023-4736

CVE-2023-4738

CVE-2023-4750

CVE-2023-4751

CVE-2023-4752

CVE-2023-4781

**Weather**

Available for: macOS Sonoma

Impact: An app may be able to access sensitive user data

Description: A privacy issue was addressed with improved private data redaction for log entries.

CVE-2023-41254: Cristian Dinca of "Tudor Vianu" National High School of Computer Science, Romania

**WebKit**

Available for: macOS Sonoma

Impact: Processing web content may lead to arbitrary code execution

Description: The issue was addressed with improved memory handling.

WebKit Bugzilla: 259836

CVE-2023-40447: Ïù¥Ï§ÄÏÑ±(Junsung Lee) of Cross Republic

**WebKit**

Available for: macOS Sonoma

Impact: Processing web content may lead to arbitrary code execution

Description: A use-after-free issue was addressed with improved memory management.

WebKit Bugzilla: 259890

CVE-2023-41976: Ïù¥Ï§ÄÏÑ±(Junsung Lee)

**WebKit**

Available for: macOS Sonoma

Impact: Processing web content may lead to arbitrary code execution

Description: A logic issue was addressed with improved checks.

WebKit Bugzilla: 260173

CVE-2023-42852: Pedro Ribeiro (@pedrib1337) and Vitor Pedreira (@0xvhp\_) of Agile Information Security

Entry updated February 16, 2024

**WebKit**

Available for: macOS Sonoma

Impact: Visiting a malicious website may lead to address bar spoofing

Description: An inconsistent user interface issue was addressed with improved state management.

WebKit Bugzilla: 260046

CVE-2023-42843: Kacper Kwapisz (@KKKas\_)

Entry added February 16, 2024

**WebKit Process Model**

Available for: macOS Sonoma

Impact: Processing web content may lead to a denial-of-service

Description: The issue was addressed with improved memory handling.

WebKit Bugzilla: 260757

CVE-2023-41983: Ïù¥Ï§ÄÏÑ±(Junsung Lee)

**WindowServer**

Available for: macOS Sonoma

Impact: A website may be able to access the microphone without the microphone use indicator being shown

Description: This issue was addressed by removing the vulnerable code.

CVE-2023-41975: an anonymous researcher

**WindowServer**

Available for: macOS Sonoma

Impact: An app may be able to access user-sensitive data

Description: The issue was addressed with improved checks.

CVE-2023-42858: an anonymous researcher

Entry added February 16, 2024

## Additional recognition

**libarchive**

We would like to acknowledge Bahaa Naamneh for their assistance.

**libxml2**

We would like to acknowledge OSS-Fuzz, Ned Williamson of Google Project Zero for their assistance.

**Login Window**

We would like to acknowledge an anonymous researcher for their assistance.

**man**

We would like to acknowledge Kirin (@Pwnrin) and Roman Mishchenko for their assistance.

Entry updated February 16, 2024

**Power Manager**

We would like to acknowledge Xia0o0o0o (@Nyaaaaa\_ovo) of University of California, San Diego for their assistance.

**Preview**

We would like to acknowledge Akshay Nagpal for their assistance.

Entry added February 16, 2024

**Reminders**

We would like to acknowledge Noah Roskin-Frazee and Prof. J. (ZeroClicks.ai Lab) for their assistance.

**Setup Assistant**

We would like to acknowledge Digvijay Sai Gujjarlapudi, Kyle Andrews, and an anonymous researcher for their assistance.

Entry added April 24, 2024, updated May 29, 2024

**System Extensions**

We would like to acknowledge Jaron Bradley, Ferdous Saljooki, and Austin Prueher of Jamf Software for their assistance.

Entry added April 24, 2024

**WebKit**

We would like to acknowledge an anonymous researcher for their assistance.

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date:¬†June 12, 2024

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don‚Äôt include any personal information in your comment.
Submit

Thanks for your feedback.

![](/clientside/images/Icon_communities.png)

### Explore Apple Support Community

Find what‚Äôs been asked and answered by Apple customers.

Search the Community

Submit

![](/clientside/images/get-support-icon-person-2-fill.png)
### Contact Apple Support

Need more help? Save time by starting your support request online and we'll connect you to an expert.

[Get started](https://getsupport.apple.com/?caller=ikb)

## Apple Footer

[Ô£ø
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of macOS Sonoma 14.1

[United States](https://support.apple.com/en-us/109051/localeselector "Choose your country or region")

Copyright ¬© 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from github.com_1618777f_20250115_093723.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F816fbcc262687b81fc46f82f7bbeb1453addfe0c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F816fbcc262687b81fc46f82f7bbeb1453addfe0c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=vim%2Fvim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vim](/vim)
/
**[vim](/vim/vim)**
Public

* [Notifications](/login?return_to=%2Fvim%2Fvim) You must be signed in to change notification settings
* [Fork
  5.5k](/login?return_to=%2Fvim%2Fvim)
* [Star
   37.2k](/login?return_to=%2Fvim%2Fvim)

* [Code](/vim/vim)
* [Issues
  1.5k](/vim/vim/issues)
* [Pull requests
  52](/vim/vim/pulls)
* [Discussions](/vim/vim/discussions)
* [Actions](/vim/vim/actions)
* [Projects
  0](/vim/vim/projects)
* [Wiki](/vim/vim/wiki)
* [Security](/vim/vim/security)
* [Insights](/vim/vim/pulse)

Additional navigation options

* [Code](/vim/vim)
* [Issues](/vim/vim/issues)
* [Pull requests](/vim/vim/pulls)
* [Discussions](/vim/vim/discussions)
* [Actions](/vim/vim/actions)
* [Projects](/vim/vim/projects)
* [Wiki](/vim/vim/wiki)
* [Security](/vim/vim/security)
* [Insights](/vim/vim/pulse)

## Commit

[Permalink](/vim/vim/commit/816fbcc262687b81fc46f82f7bbeb1453addfe0c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

patch 9.0.1833: [security] runtime file fixes

[Browse files](/vim/vim/tree/816fbcc262687b81fc46f82f7bbeb1453addfe0c)
Browse the repository at this point in the history

```
Problem:  runtime files may execute code in current dir
Solution: only execute, if not run from current directory

The perl, zig and ruby filetype plugins and the zip and gzip autoload
plugins may try to load malicious executable files from the current
working directory.  This is especially a problem on windows, where the
current directory is implicitly in your $PATH and windows may even run a
file with the extension `.bat` because of $PATHEXT.

So make sure that we are not trying to execute a file from the current
directory. If this would be the case, error out (for the zip and gzip)
plugins or silently do not run those commands (for the ftplugins).

This assumes, that only the current working directory is bad. For all
other directories, it is assumed that those directories were
intentionally set to the $PATH by the user.

Signed-off-by: Christian Brabandt <cb@256bit.org>
```

* Loading branch information

[![@chrisbra](https://avatars.githubusercontent.com/u/244927?s=40&v=4)](/chrisbra)

[chrisbra](/vim/vim/commits?author=chrisbra "View all commits by chrisbra")
committed
Aug 31, 2023

1 parent
[0ffa97e](/vim/vim/commit/0ffa97e8fae5e73ff05ba24178cfc7206a3fe67e)

commit 816fbcc

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**56 additions**
and
**32 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* runtime

  + autoload

    - runtime/autoload/gzip.vim
      [gzip.vim](#diff-9ee372ec0b7f82f26ff6333067ef209672ef051b6f21d1393b9c9b5393f69283)
    - runtime/autoload/zip.vim
      [zip.vim](#diff-c3431e35dce9ef0098df28d227c4539fc744a55e32dca0291be3eeddab0fe245)
  + ftplugin

    - runtime/ftplugin/perl.vim
      [perl.vim](#diff-b27f7d09f0ebc9478568c8008c63d59216c12384cfc647d9d28bd7ec92ee3df0)
    - runtime/ftplugin/ruby.vim
      [ruby.vim](#diff-0c3fce5e7d0d1d5d2c8d7921ce1c2767a7fbc0cc9f6f847f352e7ebee183545b)
    - runtime/ftplugin/zig.vim
      [zig.vim](#diff-4fcbb17cf1c12da1cd5494f52c1165785d6e450024f467c441e4d070eece2487)
* src

  + src/version.c
    [version.c](#diff-ea763fdb2cbd2223b87bfc5dcbc65b0d0b7a9e07c7738d3ff1d136b98dce06fc)

## There are no files selected for viewing

7 changes: 6 additions & 1 deletion

7
[runtime/autoload/gzip.vim](#diff-9ee372ec0b7f82f26ff6333067ef209672ef051b6f21d1393b9c9b5393f69283 "runtime/autoload/gzip.vim")

Show comments

[View file](/vim/vim/blob/816fbcc262687b81fc46f82f7bbeb1453addfe0c/runtime/autoload/gzip.vim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,12 +10,17 @@ |
|  |  | fun s:check(cmd) |
|  |  | let name = substitute(a:cmd, '\(\S\*\).\*', '\1', '') |
|  |  | if !exists("s:have\_" . name) |
|  |  | " safety check, don't execute anything from the current directory |
|  |  | let f = fnamemodify(exepath(name), ":p:h") !=# getcwd() |
|  |  | if !f |
|  |  | echoerr "Warning: NOT executing " .. name .. " from current directory!" |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F816fbcc262687b81fc46f82f7bbeb1453addfe0c)       Sorry, something went wrong.           Copy link    Quote reply     @pkopylov **[pkopylov](/pkopylov)** [Sep 14, 2023](#r127316543)  May be just only one dot-operator to concatenate strings should be used here?      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F816fbcc262687b81fc46f82f7bbeb1453addfe0c)       Sorry, something went wrong.           Copy link    Quote reply     @chrisbra **[chrisbra](/chrisbra)** [Sep 14, 2023](#r127316845) Author  Member   no, `.` is deprecated.     üëç 1  pkopylov reacted with thumbs up emoji   All reactions  * üëç   1 reaction         This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F816fbcc262687b81fc46f82f7bbeb1453addfe0c)       Sorry, something went wrong.           Copy link    Quote reply     @pkopylov **[pkopylov](/pkopylov)** [Sep 14, 2023](#r127317114)  no, `.` is deprecated.  the single dot is used in two lines below, so I asked.      All reactions | | |
|  |  | endif |
|  |  | let e = executable(name) |
|  |  | if e < 0 |
|  |  | let r = system(name . " --version") |
|  |  | let e = (r !~ "not found" && r != "") |
|  |  | endif |
|  |  | exe "let s:have\_" . name . "=" . e |
|  |  | exe "let s:have\_" . name . "=" . (e && f) |
|  |  | endif |
|  |  | exe "return s:have\_" . name |
|  |  | endfun |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[runtime/autoload/zip.vim](#diff-c3431e35dce9ef0098df28d227c4539fc744a55e32dca0291be3eeddab0fe245 "runtime/autoload/zip.vim")

Show comments

[View file](/vim/vim/blob/816fbcc262687b81fc46f82f7bbeb1453addfe0c/runtime/autoload/zip.vim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,6 +57,10 @@ if !exists("g:zip\_extractcmd") |
|  |  | let g:zip\_extractcmd= g:zip\_unzipcmd |
|  |  | endif |
|  |  |  |
|  |  | if fnamemodify(exepath(g:zip\_unzipcmd), ":p:h") ==# getcwd() |
|  |  | echoerr "Warning: NOT executing " .. g:zip\_unzipcmd .. " from current directory!" |
|  |  | finish |
|  |  | endif |
|  |  | " ---------------- |
|  |  | " Functions: {{{1 |
|  |  | " ---------------- |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[runtime/ftplugin/perl.vim](#diff-b27f7d09f0ebc9478568c8008c63d59216c12384cfc647d9d28bd7ec92ee3df0 "runtime/ftplugin/perl.vim")

Show comments

[View file](/vim/vim/blob/816fbcc262687b81fc46f82f7bbeb1453addfe0c/runtime/ftplugin/perl.vim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,7 +54,8 @@ endif |
|  |  |  |
|  |  | " Set this once, globally. |
|  |  | if !exists("perlpath") |
|  |  | if executable("perl") |
|  |  | " safety check: don't execute perl from current directory |
|  |  | if executable("perl") && fnamemodify(exepath("perl"), ":p:h") != getcwd() |
|  |  | try |
|  |  | if &shellxquote != '"' |
|  |  | let perlpath = system('perl -e "print join(q/,/,@INC)"') |
| Expand Down | |  |

68 changes: 39 additions & 29 deletions

68
[runtime/ftplugin/ruby.vim](#diff-0c3fce5e7d0d1d5d2c8d7921ce1c2767a7fbc0cc9f6f847f352e7ebee183545b "runtime/ftplugin/ruby.vim")

Show comments

[View file](/vim/vim/blob/816fbcc262687b81fc46f82f7bbeb1453addfe0c/runtime/ftplugin/ruby.vim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -99,41 +99,51 @@ function! s:build\_path(path) abort |
|  |  | return path |
|  |  | endfunction |
|  |  |  |
|  |  | if !exists('b:ruby\_version') && !exists('g:ruby\_path') && isdirectory(expand('%:p:h')) |
|  |  | let s:version\_file = findfile('.ruby-version', '.;') |
|  |  | if !empty(s:version\_file) && filereadable(s:version\_file) |
|  |  | let b:ruby\_version = get(readfile(s:version\_file, '', 1), '') |
|  |  | if !has\_key(g:ruby\_version\_paths, b:ruby\_version) |
|  |  | let g:ruby\_version\_paths[b:ruby\_version] = s:query\_path(fnamemodify(s:version\_file, ':p:h')) |
|  |  | let s:execute\_ruby = 1 |
|  |  | " Security Check, don't execute ruby from the current directory |
|  |  | if fnamemodify(exepath("ruby"), ":p:h") ==# getcwd() |
|  |  | let s:execute\_ruby = 0 |
|  |  | endif |
|  |  |  |
|  |  | function SetRubyPath() |
|  |  | if !exists('b:ruby\_version') && !exists('g:ruby\_path') && isdirectory(expand('%:p:h')) |
|  |  | let s:version\_file = findfile('.ruby-version', '.;') |
|  |  | if !empty(s:version\_file) && filereadable(s:version\_file) && s:execute\_ruby |
|  |  | let b:ruby\_version = get(readfile(s:version\_file, '', 1), '') |
|  |  | if !has\_key(g:ruby\_version\_paths, b:ruby\_version) |
|  |  | let g:ruby\_version\_paths[b:ruby\_version] = s:query\_path(fnamemodify(s:version\_file, ':p:h')) |
|  |  | endif |
|  |  | endif |
|  |  | endif |
|  |  | endif |
|  |  |  |
|  |  | if exists("g:ruby\_path") |
|  |  | let s:ruby\_path = type(g:ruby\_path) == type([]) ? join(g:ruby\_path, ',') : g:ruby\_path |
|  |  | elseif has\_key(g:ruby\_version\_paths, get(b:, 'ruby\_version', '')) |
|  |  | let s:ruby\_paths = g:ruby\_version\_paths[b:ruby\_version] |
|  |  | let s:ruby\_path = s:build\_path(s:ruby\_paths) |
|  |  | else |
|  |  | if !exists('g:ruby\_default\_path') |
|  |  | if has("ruby") && has("win32") |
|  |  | ruby ::VIM::command( 'let g:ruby\_default\_path = split("%s",",")' % $:.join(%q{,}) ) |
|  |  | elseif executable('ruby') && !empty($HOME) |
|  |  | let g:ruby\_default\_path = s:query\_path($HOME) |
|  |  | else |
|  |  | let g:ruby\_default\_path = map(split($RUBYLIB,':'), 'v:val ==# "." ? "" : v:val') |
|  |  | if exists("g:ruby\_path") |
|  |  | let s:ruby\_path = type(g:ruby\_path) == type([]) ? join(g:ruby\_path, ',') : g:ruby\_path |
|  |  | elseif has\_key(g:ruby\_version\_paths, get(b:, 'ruby\_version', '')) && s:execute\_ruby |
|  |  | let s:ruby\_paths = g:ruby\_version\_paths[b:ruby\_version] |
|  |  | let s:ruby\_path = s:build\_path(s:ruby\_paths) |
|  |  | else |
|  |  | if !exists('g:ruby\_default\_path') |
|  |  | if has("ruby") && has("win32") |
|  |  | ruby ::VIM::command( 'let g:ruby\_default\_path = split("%s",",")' % $:.join(%q{,}) ) |
|  |  | elseif executable('ruby') && !empty($HOME) && s:execute\_ruby |
|  |  | let g:ruby\_default\_path = s:query\_path($HOME) |
|  |  | else |
|  |  | let g:ruby\_default\_path = map(split($RUBYLIB,':'), 'v:val ==# "." ? "" : v:val') |
|  |  | endif |
|  |  | endif |
|  |  | let s:ruby\_paths = g:ruby\_default\_path |
|  |  | let s:ruby\_path = s:build\_path(s:ruby\_paths) |
|  |  | endif |
|  |  | let s:ruby\_paths = g:ruby\_default\_path |
|  |  | let s:ruby\_path = s:build\_path(s:ruby\_paths) |
|  |  | endif |
|  |  |  |
|  |  | if stridx(&l:path, s:ruby\_path) == -1 |
|  |  | let &l:path = s:ruby\_path |
|  |  | endif |
|  |  | if exists('s:ruby\_paths') && stridx(&l:tags, join(map(copy(s:ruby\_paths),'v:val."/tags"'),',')) == -1 |
|  |  | let &l:tags = &tags . ',' . join(map(copy(s:ruby\_paths),'v:val."/tags"'),',') |
|  |  | endif |
|  |  | if stridx(&l:path, s:ruby\_path) == -1 |
|  |  | let &l:path = s:ruby\_path |
|  |  | endif |
|  |  | if exists('s:ruby\_paths') && stridx(&l:tags, join(map(copy(s:ruby\_paths),'v:val."/tags"'),',')) == -1 |
|  |  | let &l:tags = &tags . ',' . join(map(copy(s:ruby\_paths),'v:val."/tags"'),',') |
|  |  | endif |
|  |  | endfunction |
|  |  |  |
|  |  | call SetRubyPath() |
|  |  |  |
|  |  | if (has("gui\_win32") || has("gui\_gtk")) && !exists("b:browsefilter") |
|  |  | let b:browsefilter = "Ruby Source Files (\*.rb)\t\*.rb\n" . |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[runtime/ftplugin/zig.vim](#diff-4fcbb17cf1c12da1cd5494f52c1165785d6e450024f467c441e4d070eece2487 "runtime/ftplugin/zig.vim")

Show comments

[View file](/vim/vim/blob/816fbcc262687b81fc46f82f7bbeb1453addfe0c/runtime/ftplugin/zig.vim)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,7 +39,9 @@ endif |
|  |  |  |
|  |  | let &l:define='\v(<fn>|<const>|<var>|^\s\*\#\s\*define)' |
|  |  |  |
|  |  | if !exists('g:zig\_std\_dir') && exists('\*json\_decode') && executable('zig') |
|  |  | " Safety check: don't execute zip from current directory |
|  |  | if !exists('g:zig\_std\_dir') && exists('\*json\_decode') && |
|  |  | \  executable('zig') && fnamemodify(exepath("zig"), ":p:h") != getcwd() |
|  |  | silent let s:env = system('zig env') |
|  |  | if v:shell\_error == 0 |
|  |  | let g:zig\_std\_dir = json\_decode(s:env)['std\_dir'] |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[src/version.c](#diff-ea763fdb2cbd2223b87bfc5dcbc65b0d0b7a9e07c7738d3ff1d136b98dce06fc "src/version.c")

Show comments

[View file](/vim/vim/blob/816fbcc262687b81fc46f82f7bbeb1453addfe0c/src/version.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -699,6 +699,8 @@ static char \*(features[]) = |
|  |  |  |
|  |  | static int included\_patches[] = |
|  |  | { /\* Add new patch number below this line \*/ |
|  |  | /\*\*/ |
|  |  | 1833, |
|  |  | /\*\*/ |
|  |  | 1832, |
|  |  | /\*\*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 3 comments on commit `816fbcc`

[![@benknoble](https://avatars.githubusercontent.com/u/22802209?s=80&v=4)](/benknoble)

Copy link

Contributor

### @benknoble **[benknoble](/benknoble)** commented on `[816fbcc](/vim/vim/commit/816fbcc262687b81fc46f82f7bbeb1453addfe0c)` [Sep 6, 2023](#commitcomment-126623810)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It seems like we should have a unified mechanism for this, but I expect many of these files are maintained outside the main Vim tree. Is there interest in providing an (autoloaded) library of functions useful to filetype-maintainers? Example: `vim#ft#is_safe_exe('perl')`?

I suppose this would introduce a Vim version constraint on the external sources of the runtime files (if I use old Vim with new runtime files, they wouldn't work).

Sorry, something went wrong.

All reactions

[![@chrisbra](https://avatars.githubusercontent.com/u/244927?s=80&v=4)](/chrisbra)

Copy link

Member

Author

### @chrisbra **[chrisbra](/chrisbra)** commented on `[816fbcc](/vim/vim/commit/816fbcc262687b81fc46f82f7bbeb1453addfe0c)` [Sep 6, 2023](#commitcomment-126634974)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Note: there were a few more improvements since this patch.

> Example: vim#ft#is\_safe\_exe('perl')?

But sure, do you want to give it a try?

Sorry, something went wrong.

All reactions

[![@benknoble](https://avatars.githubusercontent.com/u/22802209?s=80&v=4)](/benknoble)

Copy link

Contributor

### @benknoble **[benknoble](/benknoble)** commented on `[816fbcc](/vim/vim/commit/816fbcc262687b81fc46f82f7bbeb1453addfe0c)` [Sep 6, 2023](#commitcomment-126645102)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yeah I‚Äôll take a look

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvim%2Fvim%2Fcommit%2F816fbcc262687b81fc46f82f7bbeb1453addfe0c) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


