Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The core issue lies in the way FOSSBilling handles session invalidation after a password reset or change. Previously, when a user (client or staff) changed their password, only the current session was invalidated. This commit introduces a mechanism to invalidate all existing sessions for a given user upon password change or reset.

**Weaknesses/Vulnerabilities:**

*   **Insufficient Session Invalidation:** Prior to this patch, only the current session was invalidated after a password change, leaving other active sessions vulnerable. This means if a user had multiple active sessions, changing the password would not terminate those sessions, potentially allowing unauthorized access.
*   **Lack of Comprehensive Session Management:** The system lacked a method for an administrator to terminate all sessions associated with a particular user, even without a password change, this commit introduces this functionality.

**Impact of Exploitation:**

*   **Unauthorized Access:** If an attacker had an active session of a user whose password was changed by the legitimate user, the attacker could maintain unauthorized access to the system until the session expired by normal means.
*   **Session Hijacking:** If an attacker managed to obtain access to a user's active session (e.g., through a stolen session cookie), a legitimate password change would not immediately revoke that session access.
*   **Privilege Escalation:** If an attacker has an active session with admin or staff privileges, they could maintain their access and privileges even after the password was changed.

**Attack Vectors:**

*   **Stolen Session Cookies:** An attacker could obtain a user's session cookie through various means (e.g., man-in-the-middle attacks, malware, etc.) and use it to maintain access to the system.
*   **Concurrent Sessions:** The vulnerability existed if the user had multiple concurrent sessions (e.g., logged in on multiple devices or browsers).

**Required Attacker Capabilities/Position:**

*   **Access to a Valid Session:** The attacker needs to have an active and valid session, this can be done by:
    *   Having stolen session cookies
    *   Having a user log into a compromised device

**Summary of Changes**

This commit introduces a new `invalidateSessions` function in `src/modules/Profile/Service.php`. This function is called when a user (admin, staff or client) changes their password. The function queries all active sessions from the `session` table and invalidates those sessions based on their type and ID.

The commit also introduces a new `destroy_sessions` API endpoint in `src/modules/Profile/Api/Admin.php` and `src/modules/Profile/Api/Client.php` allowing an administrator or a client to invalidate all of their own sessions.

This commit also adds necessary calls to `invalidateSessions` in `src/modules/Client/Api/Admin.php` and `src/modules/Staff/Service.php` to invalidate user sessions on password reset.

This commit improves the security by making sure that all sessions are invalidated upon a password change.