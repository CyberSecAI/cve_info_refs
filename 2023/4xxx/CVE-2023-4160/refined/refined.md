Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2023-4160

**Vulnerability Description:**
The WooCommerce PDF Invoice Builder plugin for WordPress is vulnerable to Stored Cross-Site Scripting (XSS).

**Root Cause:**
The vulnerability stems from insufficient input sanitization and output escaping when handling admin settings. This allows an attacker to inject malicious web scripts through the plugin's settings.

**Weaknesses/Vulnerabilities:**
- Stored Cross-Site Scripting (XSS)

**Impact of Exploitation:**
- Successful exploitation allows an attacker to inject arbitrary web scripts into pages.
- These injected scripts will execute whenever a user accesses the affected pages.
- This could lead to various malicious actions, including data theft, session hijacking, or redirecting users to malicious websites, potentially affecting any user accessing the affected page, including administrators.

**Attack Vectors:**
- Authenticated attackers with administrator-level permissions or higher can inject the malicious scripts through the plugin's settings.
- The vulnerability is triggered when a user accesses a page containing the injected script.
- This vulnerability only affects multi-site installations or installations where `unfiltered_html` is disabled.

**Required Attacker Capabilities/Position:**
- The attacker needs to be an authenticated user with at least administrator-level permissions on the WordPress site.

**Additional Notes:**
- The vulnerability is present in versions up to and including 1.2.90.
- The vulnerability is fixed in version 1.2.91.
- The provided links show the vulnerable code and the fix, specifically, the `SaveCustomField` function in `woocommerce-pdf-invoice-ajax.php` was removed and its functionality was moved elsewhere, likely with proper sanitization.
- The Wordfence analysis highlights that the vulnerability is triggered by insufficient sanitization in the "admin settings."