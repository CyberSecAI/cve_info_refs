- **Root cause of vulnerability:** The PageLayer plugin fails to prevent unauthenticated attackers from modifying a post's header or footer code, specifically in scheduled posts.
- **Weaknesses/vulnerabilities present:** Unauthenticated Stored Cross-Site Scripting (XSS). The plugin does not properly sanitize user-supplied input when updating header/footer code, allowing the injection of malicious scripts.
- **Impact of exploitation:** An attacker can inject arbitrary JavaScript code into a website's pages. This could lead to various malicious actions such as session hijacking, defacement, or redirecting users to malicious sites.
- **Attack vectors:**
    -   **Unauthenticated attacker:** An attacker can send a crafted request to the `wp-cron.php` file with malicious code in the `pagelayer_header_code` parameter, targeting scheduled posts.
    -   **Authenticated contributor:** A contributor can insert malicious code via the "Header, Body and Footer" section within the PageLayer builder.
-   **Required attacker capabilities/position:**
    -   **Unauthenticated attacker:** No specific position or capabilities are needed. The attacker can be any user capable of sending an HTTP request to the vulnerable site.
    -   **Authenticated contributor:** The attacker needs to have contributor-level access to the WordPress website.