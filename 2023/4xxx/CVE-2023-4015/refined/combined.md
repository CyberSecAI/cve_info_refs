=== Content from git.kernel.org_65e28f6b_20250114_225522.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2023-07-23 16:24:46 +0200 |
| --- | --- | --- |
| committer | Florian Westphal <fw@strlen.de> | 2023-07-26 16:48:49 +0200 |
| commit | [0a771f7b266b02d262900c75f1e175c7fe76fec2](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)) | |
| tree | [423d50a9a9b24b3c51754383e5511f2a51ed2369](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2) | |
| parent | [f718863aca469a109895cb855e6b81fff4827d71](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f718863aca469a109895cb855e6b81fff4827d71) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2&id2=f718863aca469a109895cb855e6b81fff4827d71)) | |
| download | [linux-0a771f7b266b02d262900c75f1e175c7fe76fec2.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-0a771f7b266b02d262900c75f1e175c7fe76fec2.tar.gz) | |

netfilter: nf\_tables: skip immediate deactivate in \_PREPARE\_ERROROn error when building the rule, the immediate expression unbinds the
chain, hence objects can be deactivated by the transaction records.
Otherwise, it is possible to trigger the following warning:
WARNING: CPU: 3 PID: 915 at net/netfilter/nf\_tables\_api.c:2013 nf\_tables\_chain\_destroy+0x1f7/0x210 [nf\_tables]
CPU: 3 PID: 915 Comm: chain-bind-err- Not tainted 6.1.39 #1
RIP: 0010:nf\_tables\_chain\_destroy+0x1f7/0x210 [nf\_tables]
Fixes: 4bedf9eee016 ("netfilter: nf\_tables: fix chain binding transaction logic")
Reported-by: Kevin Rich <kevinrich1337@gmail.com>
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Florian Westphal <fw@strlen.de>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)

| -rw-r--r-- | [net/netfilter/nft\_immediate.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/netfilter/nft_immediate.c?id=0a771f7b266b02d262900c75f1e175c7fe76fec2) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/net/netfilter/nft\_immediate.c b/net/netfilter/nft\_immediate.cindex 407d7197f75bb3..fccb3cf7749c1d 100644--- a/[net/netfilter/nft\_immediate.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nft_immediate.c?id=f718863aca469a109895cb855e6b81fff4827d71)+++ b/[net/netfilter/nft\_immediate.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nft_immediate.c?id=0a771f7b266b02d262900c75f1e175c7fe76fec2)@@ -125,15 +125,27 @@ static void nft\_immediate\_activate(const struct nft\_ctx \*ctx, return nft\_data\_hold(&priv->data, nft\_dreg\_to\_type(priv->dreg)); } +static void nft\_immediate\_chain\_deactivate(const struct nft\_ctx \*ctx,+ struct nft\_chain \*chain,+ enum nft\_trans\_phase phase)+{+ struct nft\_ctx chain\_ctx;+ struct nft\_rule \*rule;++ chain\_ctx = \*ctx;+ chain\_ctx.chain = chain;++ list\_for\_each\_entry(rule, &chain->rules, list)+ nft\_rule\_expr\_deactivate(&chain\_ctx, rule, phase);+}+ static void nft\_immediate\_deactivate(const struct nft\_ctx \*ctx, const struct nft\_expr \*expr, enum nft\_trans\_phase phase) { const struct nft\_immediate\_expr \*priv = nft\_expr\_priv(expr); const struct nft\_data \*data = &priv->data;- struct nft\_ctx chain\_ctx; struct nft\_chain \*chain;- struct nft\_rule \*rule;  if (priv->dreg == NFT\_REG\_VERDICT) { switch (data->verdict.code) {@@ -143,20 +155,17 @@ static void nft\_immediate\_deactivate(const struct nft\_ctx \*ctx, if (!nft\_chain\_binding(chain)) break; - chain\_ctx = \*ctx;- chain\_ctx.chain = chain;-- list\_for\_each\_entry(rule, &chain->rules, list)- nft\_rule\_expr\_deactivate(&chain\_ctx, rule, phase);- switch (phase) { case NFT\_TRANS\_PREPARE\_ERROR: nf\_tables\_unbind\_chain(ctx, chain);- fallthrough;+ nft\_deactivate\_next(ctx->net, chain);+ break; case NFT\_TRANS\_PREPARE:+ nft\_immediate\_chain\_deactivate(ctx, chain, phase); nft\_deactivate\_next(ctx->net, chain); break; default:+ nft\_immediate\_chain\_deactivate(ctx, chain, phase); nft\_chain\_del(chain); chain->bound = false; nft\_use\_dec(&chain->table->use); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:53:59 +0000



=== Content from www.debian.org_8233c44a_20250114_225523.html ===


---

[[Date Prev](msg00183.html)][[Date Next](msg00185.html)]
[[Thread Prev](msg00183.html)][[Thread Next](msg00185.html)]
[[Date Index](maillist.html#00184)]
[[Thread Index](threads.html#00184)]

# [SECURITY] [DSA 5492-1] linux security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5492-1] linux security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Sat, 09 Sep 2023 21:40:04 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1qf5gS-0050Vs-Ln%40seger.debian.org)Â [E1qf5gS-0050Vs-Ln@seger.debian.org](msg00184.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5492-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
September 09, 2023                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : linux
CVE ID         : CVE-2023-1206 CVE-2023-1989 CVE-2023-2430 CVE-2023-2898
                 CVE-2023-3611 CVE-2023-3772 CVE-2023-3773 CVE-2023-3776
                 CVE-2023-3777 CVE-2023-3863 CVE-2023-4004 CVE-2023-4015
                 CVE-2023-4128 CVE-2023-4132 CVE-2023-4147 CVE-2023-4155
                 CVE-2023-4194 CVE-2023-4206 CVE-2023-4207 CVE-2023-4208
                 CVE-2023-4273 CVE-2023-4569 CVE-2023-4622 CVE-2023-20588
                 CVE-2023-34319 CVE-2023-40283

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service or information
leaks.

CVE-2023-1206

    It was discovered that the networking stack permits attackers to
    force hash collisions in the IPv6 connection lookup table, which may
    result in denial of service (significant increase in the cost of
    lookups, increased CPU utilization).

CVE-2023-1989

    Zheng Wang reported a race condition in the btsdio Bluetooth adapter
    driver that can lead to a use-after-free. An attacker able to insert
    and remove SDIO devices can use this to cause a denial of service
    (crash or memory corruption) or possibly to run arbitrary code in
    the kernel.

CVE-2023-2430

    Xingyuan Mo discovered that the io_uring subsystem did not properly
    handle locking when the target ring is configured with IOPOLL, which
    may result in denial of service.

CVE-2023-2898

    It was discovered that missing sanitising in the f2fs file
    system may result in denial of service if a malformed file
    system is accessed.

CVE-2023-3611

    The TOTE Robot tool found a flaw in the Btrfs filesystem driver that
    can lead to a use-after-free. It's unclear whether an unprivileged
    user can exploit this.

CVE-2023-3772

    Lin Ma discovered a NULL pointer dereference flaw in the XFRM
    subsystem which may result in denial of service.

CVE-2023-3773

    Lin Ma discovered a flaw in the the XFRM subsystem, which may result
    in denial of service for a user with the CAP_NET_ADMIN capability in
    any user or network namespace.

CVE-2023-3776, CVE-2023-4128, CVE-2023-4206, CVE-2023-4207, CVE-2023-4208

    It was discovered that a use-after-free in the cls_fw, cls_u32 and
    cls_route network classifiers may result in denial of service or
    potential local privilege escalation.

CVE-2023-3777

    Kevin Rich discovered a use-after-free in Netfilter when flushing
    table rules, which may result in local privilege escalation for a
    user with the CAP_NET_ADMIN capability in any user or network
    namespace.

CVE-2023-3863

    It was discovered that a use-after-free in the NFC implementation
    may result in denial of service, an information leak or potential
    local privilege escalation.

CVE-2023-4004

    It was discovered that a use-after-free in Netfilter's
    implementation of PIPAPO (PIle PAcket POlicies) may result in denial
    of service or potential local privilege escalation for a user with
    the CAP_NET_ADMIN capability in any user or network namespace.

CVE-2023-4015

    Kevin Rich discovered a use-after-free in Netfilter when handling
    bound chain deactivation in certain circumstances, may result in
    denial of service or potential local privilege escalation for a user
    with the CAP_NET_ADMIN capability in any user or network namespace.

CVE-2023-4132

    A use-after-free in the driver for Siano SMS1xxx based MDTV
    receivers may result in local denial of service.

CVE-2023-4147

    Kevin Rich discovered a use-after-free in Netfilter when adding a
    rule with NFTA_RULE_CHAIN_ID, which may result in local privilege
    escalation for a user with the CAP_NET_ADMIN capability in any user
    or network namespace.

CVE-2023-4155

    Andy Nguyen discovered a flaw in the KVM subsystem allowing a KVM
    guest using EV-ES or SEV-SNP to cause a denial of service.

CVE-2023-4194

    A type confusion in the implementation of TUN/TAP network devices
    may allow a local user to bypass network filters.

CVE-2023-4273

    Maxim Suhanov discovered a stack overflow in the exFAT driver, which
    may result in local denial of service via a malformed file system.

CVE-2023-4569

    lonial con discovered flaw in the Netfilter subsystem, which may
    allow a local attacher to cause a double-deactivations of catchall
    elements, which results in a memory leak.

CVE-2023-4622

    Bing-Jhong Billy Jheng discovered a use-after-free within the Unix
    domain sockets component, which may result in local privilege
    escalation.

CVE-2023-20588

    Jana Hofmann, Emanuele Vannacci, Cedric Fournet, Boris Koepf and
    Oleksii Oleksenko discovered that on some AMD CPUs with the Zen1
    micro architecture an integer division by zero may leave stale
    quotient data from a previous division, resulting in a potential
    leak of sensitive data.

CVE-2023-34319

    Ross Lagerwall discovered a buffer overrun in Xen's netback driver
    which may allow a Xen guest to cause denial of service to the
    virtualisation host my sending malformed packets.

CVE-2023-40283

    A use-after-free was discovered in Bluetooth L2CAP socket handling.

For the stable distribution (bookworm), these problems have been fixed in
version 6.1.52-1. This update is released without armel builds. Changes
in the new stable series import cause a substantial increase of the
compressed image for marvell flavour. This issue will be addressed in a
future linux update.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to its security
tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmT85fRfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0TRNA/5AcjodSsYf3Z7EY00Hl9jfs69RGy9Oq9HpKsTgJhDttqwKw1h3IFLXUxz
6KzrtjCi9NGu6REnBBN9Utgz/aHPZL4KmzyQ78U4p7j3FF8b8cNyyNk2fMtxCGg9
T5/sq3SfH5N7lV3s/3aOelAi+DXfmxhyWYDxFVxkLWCvRx1xuJ6ShmtIE/virqXh
lJhvVXjbujvIcStfQYnikrsC18kbNqNZjgBsdNc8qs7PiWhYtt+Xn5nFZTfYmAbr
haixcnUG0Y59WtLg7WHdy1w2YgyrDxW+bDZLCF1ZELm+DbmQFfM9KXovfcv54AnO
UG1PkGyCF5WKaBJDWIPHz7YCXOCkOu4WXE/oRm0tKD6ZyaXgZGfYaQulgSX20qEg
xPDWWG6DOME4SO0F9OW3+MWr8AtvBdCLr2lTs/LW452GiMFgcVUSyydQwUDNQpDb
YksIh3OLz3v+7e87GCQhMoxupsxMqN4Lej+knfDs170V8I3DIz+/RpTPQfesOnOk
YOG/90+exSu0tCVAn0sh4y9Keyl6SAc7nITmSIWnsXxi0VyG3wisgDqfauMNm9Ux
87naYV2jjOc16BACVMMQQYo+1Kpqldrb0TXF7QT+ZQF/hrNXozgxlYcTDGj5AlAP
dhOA0Pa2onTFFNrTFiuWb1eTl8EgPGwpy1NIwEDyRul+YR/tCCs=
=Ulr4
-----END PGP SIGNATURE-----

```

---


