=== Content from gitlab.com_96ddf150_20250115_090747.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Bypass CODEOWNERS approval removal

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2115574](https://hackerone.com/reports/2115574)** by `ali_shehab` on 2023-08-18, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hi team hope you are well. There is something weird happening, that allows me to bypass CODEOWNERS approval of a file. This is done by creating a mr from branch: test to main, the owner approves. Now you add another mr from test2 to test and merge it. So new code is added to the test however the approval is not removed. Although in the merge request rule, I said to reset approves if new code is added.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/10013666dd48ad63d367a125860606970a163378/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f65303362613133362d376130362d343266632d383461612d3637373137633933383932662f696d6167652e706e67)

##### Steps to reproduce

1. Create a group named: CodeOwners and a project named: test with README.md file.
2. Start the free trail for CodeOwners group
3. Invite a developer to the CodeOwners group, for example his username is: userA.
4. Now go to project test and add this file with name: `CODEOWNERS` and content: `README.md [@]userA`
5. Now the owner of the README.md is userA.
6. Go to project settings => protected branch => main add turn on codeowners approval and turn off push and merge.
7. Go to project settings => merge request and add those settings:

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/ed532e50c8ab29ad7a3aee8d9b76c6b6f1ae05b0/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62353436666363382d323265342d343065372d393230372d6533663163613663333564312f696d6167652e706e67)

8. Now from your account not userA try to edit the README.md and open a Mr with branch name: test.
9. userA now approves the code.
10. Now from your account go to branch test and edit the README.md and open mr with branch name: test2 and base test.
11. Merge test2 with the test, so new code is added to the first Mr.
12. Now go to the first MR it is still approved however new code was added and you can merge it.

The video sorry it will be long but i will cover everything:

[bandicam\_2023-08-18\_13-57-01-962.mp4](https://user-content.gitlab-static.net/4a2248432470ee879364673f630d5143b0a81a70/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39333437343434372d336563312d346361302d393262642d3761386264623966616232322f62616e646963616d5f323032332d30382d31385f31332d35372d30312d3936322e6d7034 "Download 'bandicam_2023-08-18_13-57-01-962.mp4'")

#### Impact

Bypass code owners approval for example, you can pass a safe file in the .gitlab-ci.yaml and when the owner approves it you can add a malicious code that allows you to read all protected variables and allows him to push without requiring to be approved by the codeowner.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/e03ba136-7a06-42fc-84aa-67717c93892f/image.png)
* [image.png](https://h1.sec.gitlab.net/a/b546fcc8-22e4-40e7-9207-e3f1ca6c35d1/image.png)
* [bandicam\_2023-08-18\_13-57-01-962.mp4](https://h1.sec.gitlab.net/a/93474447-3ec1-4ca0-92bd-7a8bdb9fab22/bandicam_2023-08-18_13-57-01-962.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Jan 10, 2024 by [Greg Myers](/greg)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


