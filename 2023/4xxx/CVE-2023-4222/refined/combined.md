=== Content from github.com_073238e5_20250115_081744.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2Fed72914608d2a07ee2eb587c1a654480d08201db)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2Fed72914608d2a07ee2eb587c1a654480d08201db)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=chamilo%2Fchamilo-lms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chamilo](/chamilo)
/
**[chamilo-lms](/chamilo/chamilo-lms)**
Public

* [Notifications](/login?return_to=%2Fchamilo%2Fchamilo-lms) You must be signed in to change notification settings
* [Fork
  487](/login?return_to=%2Fchamilo%2Fchamilo-lms)
* [Star
   821](/login?return_to=%2Fchamilo%2Fchamilo-lms)

* [Code](/chamilo/chamilo-lms)
* [Issues
  568](/chamilo/chamilo-lms/issues)
* [Pull requests
  31](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects
  0](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

Additional navigation options

* [Code](/chamilo/chamilo-lms)
* [Issues](/chamilo/chamilo-lms/issues)
* [Pull requests](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

## Commit

[Permalink](/chamilo/chamilo-lms/commit/ed72914608d2a07ee2eb587c1a654480d08201db)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

LP: Security: sanitize params when executing converter

[Browse files](/chamilo/chamilo-lms/tree/ed72914608d2a07ee2eb587c1a654480d08201db)
Browse the repository at this point in the history

* Loading branch information

[![@AngelFQC](https://avatars.githubusercontent.com/u/1697880?s=40&v=4)](/AngelFQC)

[AngelFQC](/chamilo/chamilo-lms/commits?author=AngelFQC "View all commits by AngelFQC")
committed
Sep 5, 2023

1 parent
[6f32625](/chamilo/chamilo-lms/commit/6f32625a012d5de2dfe8edbccb4ed14a85e310d4)

commit ed72914

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**28 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* main/lp

  + main/lp/openoffice\_document.class.php
    [openoffice\_document.class.php](#diff-4b3ef58e79ccc9d63f846355b094a0e2920606c8e5c3cc70aad560669f5b5dbe)
  + main/lp/openoffice\_presentation.class.php
    [openoffice\_presentation.class.php](#diff-295b996949bd806f7181f1f3f69fb248d06dd155b7a5a79952b63e4958b24e90)
  + main/lp/openoffice\_text.class.php
    [openoffice\_text.class.php](#diff-14385753d288185f308a592879eab3fcdd0da2a7057bdf1dc16fc7cbfd6ced90)
  + main/lp/openoffice\_text\_document.class.php
    [openoffice\_text\_document.class.php](#diff-48e44c8de21270fcea3d45c5b6d5be89bc45b8042d7d979ddebce426d0807b4d)

## There are no files selected for viewing

10 changes: 7 additions & 3 deletions

10
[main/lp/openoffice\_document.class.php](#diff-4b3ef58e79ccc9d63f846355b094a0e2920606c8e5c3cc70aad560669f5b5dbe "main/lp/openoffice_document.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/ed72914608d2a07ee2eb587c1a654480d08201db/main/lp/openoffice_document.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -70,8 +70,8 @@ public function convert\_document($file, $action\_after\_conversion = 'make\_lp', $s |
|  |  | if (!empty($size)) { |
|  |  | list($w, $h) = explode('x', $size); |
|  |  | if (!empty($w) && !empty($h)) { |
|  |  | $this->slide\_width = $w; |
|  |  | $this->slide\_height = $h; |
|  |  | $this->slide\_width = (int) $w; |
|  |  | $this->slide\_height = (int) $h; |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -106,6 +106,7 @@ public function convert\_document($file, $action\_after\_conversion = 'make\_lp', $s |
|  |  |  |
|  |  | $files = []; |
|  |  | $return = 0; |
|  |  | $cmd = escapeshellcmd($cmd); |
|  |  | $shell = exec($cmd, $files, $return); |
|  |  |  |
|  |  | if ($return != 0) { // If the java application returns an error code. |
| Expand Down  Expand Up | | @@ -211,7 +212,9 @@ public function convertCopyDocument($originalPath, $convertedPath, $convertedTit |
|  |  |  |
|  |  | $cmd .= ' -p '.api\_get\_setting('service\_ppt2lp', 'port'); |
|  |  | // Call to the function implemented by child. |
|  |  | $cmd .= ' "'.$this->base\_work\_dir.'/'.$this->file\_path.'" "'.$this->base\_work\_dir.'/'.$this->created\_dir.'"'; |
|  |  | $cmd .= ' "'.Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->created\_dir).'"'; |
|  |  | // To allow openoffice to manipulate docs. |
|  |  | @chmod($this->base\_work\_dir, $permissionFolder); |
|  |  | @chmod($this->base\_work\_dir.'/'.$this->file\_path, $permissionFile); |
| Expand All | | @@ -221,6 +224,7 @@ public function convertCopyDocument($originalPath, $convertedPath, $convertedTit |
|  |  |  |
|  |  | $files = []; |
|  |  | $return = 0; |
|  |  | $cmd = escapeshellcmd($cmd); |
|  |  | $shell = exec($cmd, $files, $return); |
|  |  | // TODO: Chown is not working, root keep user privileges, should be www-data |
|  |  | @chown($this->base\_work\_dir.'/'.$this->created\_dir, 'www-data'); |
| Expand Down | |  |

15 changes: 11 additions & 4 deletions

15
[main/lp/openoffice\_presentation.class.php](#diff-295b996949bd806f7181f1f3f69fb248d06dd155b7a5a79952b63e4958b24e90 "main/lp/openoffice_presentation.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/ed72914608d2a07ee2eb587c1a654480d08201db/main/lp/openoffice_presentation.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -247,16 +247,23 @@ public function make\_lp($files = []) |
|  |  | public function add\_command\_parameters() |
|  |  | { |
|  |  | if (empty($this->slide\_width) || empty($this->slide\_height)) { |
|  |  | list($this->slide\_width, $this->slide\_height) = explode('x', api\_get\_setting('service\_ppt2lp', 'size')); |
|  |  | list($w, $h) = explode('x', api\_get\_setting('service\_ppt2lp', 'size')); |
|  |  |  |
|  |  | $this->slide\_width = (int) $w; |
|  |  | $this->slide\_height = (int) $h; |
|  |  | } |
|  |  |  |
|  |  | return ' -w '.$this->slide\_width.' -h '.$this->slide\_height.' -d oogie "'.$this->base\_work\_dir.'/'.$this->file\_path.'" "'.$this->base\_work\_dir.$this->created\_dir.'.html"'; |
|  |  | return ' -w '.$this->slide\_width.' -h '.$this->slide\_height.' -d oogie "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'.html') |
|  |  | .'"'; |
|  |  | } |
|  |  |  |
|  |  | public function set\_slide\_size($width, $height) |
|  |  | { |
|  |  | $this->slide\_width = $width; |
|  |  | $this->slide\_height = $height; |
|  |  | $this->slide\_width = (int) $width; |
|  |  | $this->slide\_height = (int) $height; |
|  |  | } |
|  |  |  |
|  |  | public function add\_docs\_to\_visio($files = []) |
| Expand Down | |  |

6 changes: 5 additions & 1 deletion

6
[main/lp/openoffice\_text.class.php](#diff-14385753d288185f308a592879eab3fcdd0da2a7057bdf1dc16fc7cbfd6ced90 "main/lp/openoffice_text.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/ed72914608d2a07ee2eb587c1a654480d08201db/main/lp/openoffice_text.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -331,7 +331,11 @@ public function dealPerPage($header, $body) |
|  |  | \*/ |
|  |  | public function add\_command\_parameters() |
|  |  | { |
|  |  | return ' -d woogie "'.$this->base\_work\_dir.'/'.$this->file\_path.'" "'.$this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html"'; |
|  |  | return ' -d woogie "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html') |
|  |  | .'"'; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

6 changes: 5 additions & 1 deletion

6
[main/lp/openoffice\_text\_document.class.php](#diff-48e44c8de21270fcea3d45c5b6d5be89bc45b8042d7d979ddebce426d0807b4d "main/lp/openoffice_text_document.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/ed72914608d2a07ee2eb587c1a654480d08201db/main/lp/openoffice_text_document.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -333,7 +333,11 @@ public function dealPerPage($header, $body) |
|  |  | \*/ |
|  |  | public function add\_command\_parameters() |
|  |  | { |
|  |  | return ' -d woogie "'.$this->base\_work\_dir.'/'.$this->file\_path.'" "'.$this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html"'; |
|  |  | return ' -d woogie "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html') |
|  |  | .'"'; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ed72914`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2Fed72914608d2a07ee2eb587c1a654480d08201db) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from support.chamilo.org_debe4127_20250115_081747.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fwiki)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fwiki)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Findex&source=header-repo&source_repo=chamilo%2Fchamilo-lms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chamilo](/chamilo)
/
**[chamilo-lms](/chamilo/chamilo-lms)**
Public

* [Notifications](/login?return_to=%2Fchamilo%2Fchamilo-lms) You must be signed in to change notification settings
* [Fork
  487](/login?return_to=%2Fchamilo%2Fchamilo-lms)
* [Star
   821](/login?return_to=%2Fchamilo%2Fchamilo-lms)

* [Code](/chamilo/chamilo-lms)
* [Issues
  568](/chamilo/chamilo-lms/issues)
* [Pull requests
  31](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects
  0](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

Additional navigation options

* [Code](/chamilo/chamilo-lms)
* [Issues](/chamilo/chamilo-lms/issues)
* [Pull requests](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

# Home

[Jump to bottom](#wiki-pages-box)
 [Edit](/chamilo/chamilo-lms/wiki/Home/_edit)
 [New page](/chamilo/chamilo-lms/wiki/_new)

Yannick Warnier edited this page Dec 19, 2024
·
[56 revisions](/chamilo/chamilo-lms/wiki/Home/_history)

Welcome to the chamilo-lms wiki!

Chamilo LMS is, as of 2018, one of the 3 top Open Source LMS worldwide and one of the top 8 LMS in use for Higher Education worldwide, as reported by [ListEdTech](http://listedtech.com/lms-coverage-two-year-anniversary/).

This is the technical wiki of Chamilo, meaning if you're looking for more user-side documentation, you should either be looking at [Chamilo's website](https://chamilo.org) or its online documentation (see below).

## Essentials

* [Chamilo Teacher, Admin and Developers guides](https://docs.chamilo.org)
* Chamilo's [Installation guide](https://11.chamilo.org/documentation/installation_guide.html) for versions 1.11.\*
* [How to report issues](/chamilo/chamilo-lms/wiki/How-to-report-issues) also [in French](https://github.com/chamilo/chamilo-lms/wiki/Comment-rapporter-une-erreur) or [in Spanish](https://github.com/chamilo/chamilo-lms/wiki/Como-reportar-errores)
* [Chamilo Development Principles](/chamilo/chamilo-lms/wiki/Chamilo-Development-Principles)
* [Chamilo Developer's Starting Guide for v1.\*](/chamilo/chamilo-lms/wiki/Chamilo-Developer%27s-Starting-Guide-for-v1.%2A)
* [Secure Development Policy](/chamilo/chamilo-lms/wiki/Secure-Development-Policy)
* [Security Issues](/chamilo/chamilo-lms/wiki/security-issues)

### Chamilo 1.\*

* [Coding conventions](/chamilo/chamilo-lms/wiki/Coding-conventions)
* [Database structure](/chamilo/chamilo-lms/wiki/Database-structure)
* [Extra fields dictionary v1](/chamilo/chamilo-lms/wiki/Extra-fields-dictionary-v1)
* [Import from Moodle](/chamilo/chamilo-lms/wiki/Import-from-Moodle)
* [Password Management](/chamilo/chamilo-lms/wiki/Password-Management)
* [Quiz features dictionary v1](/chamilo/chamilo-lms/wiki/Quiz-features-dictionary-v1)
* [Reports dictionary](/chamilo/chamilo-lms/wiki/Reports-dictionary)
* [Security issues and reporting procedure](https://support.chamilo.org/projects/chamilo-18/wiki/Security_issues)
* [Session expiry time](/chamilo/chamilo-lms/wiki/Session-expiry-time)
* [Web services](wiki/webservices)

### Chamilo 2.\*

* [Authentication methods](/chamilo/chamilo-lms/wiki/authentication.yaml)
* [Clean-up choices for v1 to v2](/chamilo/chamilo-lms/wiki/Clean-up-choices-for-v1-to-v2)
* [Converting legacy SQL](/chamilo/chamilo-lms/wiki/Converting-legacy-SQL)
* [Code quality checkers](/chamilo/chamilo-lms/wiki/Code-quality-checkers)
* [Code annotation types](/chamilo/chamilo-lms/wiki/Code-annotation-types)
* [Coding conventions v2](/chamilo/chamilo-lms/wiki/Coding-conventions-v2)
* [Configurations](/chamilo/chamilo-lms/wiki/Configurations)
* [Graphical design guide](/chamilo/chamilo-lms/wiki/Graphical-design-guide)
* [Internationalization](/chamilo/chamilo-lms/wiki/Internationalization)
* [Technical design decisions](/chamilo/chamilo-lms/wiki/Technical-design-decisions)
* [Message queue](/chamilo/chamilo-lms/wiki/Message-queue), emails, etc
* [Password Management 2](/chamilo/chamilo-lms/wiki/Password-Management-2)
* [Permissions](/chamilo/chamilo-lms/wiki/Permissions)

#### Procedures

* [c\_item\_property to nodes conversion](/chamilo/chamilo-lms/wiki/c_item_property-to-nodes-conversion)
* [Adding page types](/chamilo/chamilo-lms/wiki/Adding-page-types) (CMS feature)

## Extra

* [Supported versions](/chamilo/chamilo-lms/wiki/Supported-versions)
* [Release procedure](/chamilo/chamilo-lms/wiki/Release-procedure)
* [Release cycle](/chamilo/chamilo-lms/wiki/Release-cycle)
* [Translations management](/chamilo/chamilo-lms/wiki/Translations-management)
* [Community support strategy](/chamilo/chamilo-lms/wiki/Community-support-strategy)
* [Tools and sessions](/chamilo/chamilo-lms/wiki/Tools-and-sessions)
* [Visual design](/chamilo/chamilo-lms/wiki/visuals)
* [(near) Real Time Communications](/chamilo/chamilo-lms/wiki/RTC)
* [Common Cartridge](/chamilo/chamilo-lms/wiki/Common-Cartridge) support

## Policies

* [Privacy Policy](/chamilo/chamilo-lms/wiki/Privacy-Policy) of the Chamilo software
* [Cookie Policy](/chamilo/chamilo-lms/wiki/Cookie-Policy) of the Chamilo software

The main wiki for the Chamilo LMS project is now here. Our wiki was previously kept on a separate tracking system: <https://support.chamilo.org/projects/chamilo-18/wiki>. Use it for legacy references, like tasks references in this form "CT#1234"

[Add a custom footer](/chamilo/chamilo-lms/wiki/_new?wiki%5Bname%5D=_Footer)

### Toggle table of contents Pages 60

* Loading

  [Home](/chamilo/chamilo-lms/wiki)

  + [Essentials](/chamilo/chamilo-lms/wiki#essentials)
  + [Chamilo 1.\*](/chamilo/chamilo-lms/wiki#chamilo-1)
  + [Chamilo 2.\*](/chamilo/chamilo-lms/wiki#chamilo-2)
  + [Procedures](/chamilo/chamilo-lms/wiki#procedures)
  + [Extra](/chamilo/chamilo-lms/wiki#extra)
  + [Policies](/chamilo/chamilo-lms/wiki#policies)
* Loading

  [1.11 data dictionary](/chamilo/chamilo-lms/wiki/1.11-data-dictionary)
* Loading

  [2.0 data dictionary](/chamilo/chamilo-lms/wiki/2.0-data-dictionary)
* Loading

  [Add a new Chamilo setting](/chamilo/chamilo-lms/wiki/Add-a-new-Chamilo-setting)
* Loading

  [Adding page types](/chamilo/chamilo-lms/wiki/Adding-page-types)
* Loading

  [authentication.yaml](/chamilo/chamilo-lms/wiki/authentication.yaml)
* Loading

  [c\_item\_property to nodes conversion](/chamilo/chamilo-lms/wiki/c_item_property-to-nodes-conversion)
* Loading

  [Chamilo APIs](/chamilo/chamilo-lms/wiki/Chamilo-APIs)
* Loading

  [Chamilo Developer's Starting Guide for v1.\*](/chamilo/chamilo-lms/wiki/Chamilo-Developer%27s-Starting-Guide-for-v1.%2A)
* Loading

  [Chamilo Development Principles](/chamilo/chamilo-lms/wiki/Chamilo-Development-Principles)
* Loading

  [Clean up choices for v1 to v2](/chamilo/chamilo-lms/wiki/Clean-up-choices-for-v1-to-v2)
* Loading

  [Code annotation types](/chamilo/chamilo-lms/wiki/Code-annotation-types)
* Loading

  [Code quality checkers](/chamilo/chamilo-lms/wiki/Code-quality-checkers)
* Loading

  [Coding conventions](/chamilo/chamilo-lms/wiki/Coding-conventions)
* Loading

  [Coding conventions v2](/chamilo/chamilo-lms/wiki/Coding-conventions-v2)
* Loading

  [Comment rapporter une erreur](/chamilo/chamilo-lms/wiki/Comment-rapporter-une-erreur)
* Loading

  [Common Cartridge](/chamilo/chamilo-lms/wiki/Common-Cartridge)
* Loading

  [Community support strategy](/chamilo/chamilo-lms/wiki/Community-support-strategy)
* Loading

  [Como reportar errores](/chamilo/chamilo-lms/wiki/Como-reportar-errores)
* Loading

  [Configurations](/chamilo/chamilo-lms/wiki/Configurations)
* Loading

  [Converting legacy SQL](/chamilo/chamilo-lms/wiki/Converting-legacy-SQL)
* Loading

  [Cookie Policy](/chamilo/chamilo-lms/wiki/Cookie-Policy)
* Loading

  [Database structure](/chamilo/chamilo-lms/wiki/Database-structure)
* Loading

  [Date and time management](/chamilo/chamilo-lms/wiki/Date-and-time-management)
* Loading

  [Error when creating a course](/chamilo/chamilo-lms/wiki/Error-when-creating-a-course)
* Loading

  [este error me sale cuando quiero poner una foto en mi perfil](/chamilo/chamilo-lms/wiki/este-error-me-sale-cuando-quiero-poner-una-foto-en-mi-perfil)
* Loading

  [Estrategia de soporte comunitario](/chamilo/chamilo-lms/wiki/Estrategia-de-soporte-comunitario)
* Loading

  [Extra fields dictionary v1](/chamilo/chamilo-lms/wiki/Extra-fields-dictionary-v1)
* Loading

  [Graphical design guide](/chamilo/chamilo-lms/wiki/Graphical-design-guide)
* Loading

  [GraphQL API API v3](/chamilo/chamilo-lms/wiki/GraphQL-API---API-v3)
* Loading

  [How to report issues](/chamilo/chamilo-lms/wiki/How-to-report-issues)
* Loading

  [Import from Moodle](/chamilo/chamilo-lms/wiki/Import-from-Moodle)
* Loading

  [Importing IMS QTI](/chamilo/chamilo-lms/wiki/Importing-IMS-QTI)
* Loading

  [Internationalization](/chamilo/chamilo-lms/wiki/Internationalization)
* Loading

  [Learning objects management](/chamilo/chamilo-lms/wiki/Learning-objects-management)
* Loading

  [Message queue](/chamilo/chamilo-lms/wiki/Message-queue)
* Loading

  [Moodle Exporter](/chamilo/chamilo-lms/wiki/Moodle-Exporter)
* Loading

  [Password Management](/chamilo/chamilo-lms/wiki/Password-Management)
* Loading

  [Password Management 2](/chamilo/chamilo-lms/wiki/Password-Management-2)
* Loading

  [Permissions](/chamilo/chamilo-lms/wiki/Permissions)
* Loading

  [Privacy Policy](/chamilo/chamilo-lms/wiki/Privacy-Policy)
* Loading

  [Quiz features dictionary v1](/chamilo/chamilo-lms/wiki/Quiz-features-dictionary-v1)
* Loading

  [Release cycle](/chamilo/chamilo-lms/wiki/Release-cycle)
* Loading

  [Release procedure](/chamilo/chamilo-lms/wiki/Release-procedure)
* Loading

  [Reports dictionary](/chamilo/chamilo-lms/wiki/Reports-dictionary)
* Loading

  [Rest WebServices](/chamilo/chamilo-lms/wiki/Rest-WebServices)
* Loading

  [RTC](/chamilo/chamilo-lms/wiki/RTC)
* Loading

  [Secure Development Policy](/chamilo/chamilo-lms/wiki/Secure-Development-Policy)
* Loading

  [security issues](/chamilo/chamilo-lms/wiki/security-issues)
* Loading

  [Session expiry time](/chamilo/chamilo-lms/wiki/Session-expiry-time)
* Loading

  [Settings migration from 1 to 2](/chamilo/chamilo-lms/wiki/Settings-migration-from-1-to-2)
* Loading

  [Supported versions](/chamilo/chamilo-lms/wiki/Supported-versions)
* Loading

  [Technical design decisions](/chamilo/chamilo-lms/wiki/Technical-design-decisions)
* Loading

  [Tools and sessions](/chamilo/chamilo-lms/wiki/Tools-and-sessions)
* Loading

  [Translations management](/chamilo/chamilo-lms/wiki/Translations-management)
* Loading

  [Visual design](/chamilo/chamilo-lms/wiki/Visual-design)
* Loading

  [visuals](/chamilo/chamilo-lms/wiki/visuals)
* Loading

  [webservices](/chamilo/chamilo-lms/wiki/webservices)
* Loading

  [webservices api latest](/chamilo/chamilo-lms/wiki/webservices-api-latest)
* Loading

  [xAPI](/chamilo/chamilo-lms/wiki/xAPI)
* Show 45 more pages…

![Chamilo LMS](https://camo.githubusercontent.com/72f8fa6ebdb4427d1500ae718e03fa926d3afe1173b766c18aedafb910f2f2dd/68747470733a2f2f6368616d696c6f2e6f72672f77702d636f6e74656e742f75706c6f6164732f323031382f30392f6368616d696c6f5f6c6f676f2e706e67)

* [Home](https://github.com/chamilo/chamilo-lms/wiki)
  + [Tools and sessions](https://github.com/chamilo/chamilo-lms/wiki/Tools-and-sessions)
  + Quiz: Importing
    - [IMS/QTI](https://github.com/chamilo/chamilo-lms/wiki/Importing-ims-qti)
* Releases
  + [Supported versions](https://github.com/chamilo/chamilo-lms/wiki/Supported-versions)
  + [Release cycle](https://github.com/chamilo/chamilo-lms/wiki/Release-cycle)
  + [Release procedure](https://github.com/chamilo/chamilo-lms/wiki/Release-procedure)
* [Community support strategy](https://github.com/chamilo/chamilo-lms/wiki/Community-support-strategy)
  + [Estrategia de soporte comunitario](https://github.com/chamilo/chamilo-lms/wiki/Estrategia-de-soporte-comunitario)
* [Translation management](https://github.com/chamilo/chamilo-lms/wiki/Translations-management)
* [How to report issues](https://github.com/chamilo/chamilo-lms/wiki/How-to-report-issues)
  + [Comment rapporter une erreur](https://github.com/chamilo/chamilo-lms/wiki/Comment-rapporter-une-erreur)
  + [Cómo reportar errores](https://github.com/chamilo/chamilo-lms/wiki/Como-reportar-errores)
* Development
  + [Coding conventions](https://github.com/chamilo/chamilo-lms/wiki/Coding-conventions)
  + [Add a new Chamilo setting](https://github.com/chamilo/chamilo-lms/wiki/Add-a-new-Chamilo-setting)
  + [Database structure](https://github.com/chamilo/chamilo-lms/wiki/Database-structure)
  + [Date and time management](https://github.com/chamilo/chamilo-lms/wiki/Date-and-time-management)
* Integration
  + [Chamilo APIs](https://github.com/chamilo/chamilo-lms/wiki/Chamilo-APIs)
    - [Rest WebServices](https://github.com/chamilo/chamilo-lms/wiki/Rest-WebServices)
    - [GraphQL API / API v3](https://github.com/chamilo/chamilo-lms/wiki/GraphQL-API---API-v3)

##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from starlabs.sg_81778794_20250115_081745.html ===

[![logo](https://starlabs.sg/logo-white.png)](https://starlabs.sg/ "  (Alt + H)")

* [Home](https://starlabs.sg/ "Home")
* [About](https://starlabs.sg/about/ "About")
* [Advisories](https://starlabs.sg/advisories/ "Advisories")
* [Blog](https://starlabs.sg/blog/ "Blog")
* [Achievements](https://starlabs.sg/achievements/ "Achievements")
* [Publications](https://starlabs.sg/publications/ "Publications")
* [Search](https://starlabs.sg/search/ "Search (Alt + /)")

[Home](https://starlabs.sg/) » [Advisories](https://starlabs.sg/advisories/)
# (CVE-2023-4222) Chamilo LMS Learning Path PPT2LP OpenofficeTextDocument Command Injection

November 28, 2023 · 5 min · Ngo Wei Lin (@Creastery)

Table of Contents

* [Summary](#summary)
* [CVSS3.1 Scoring System](#cvss31-scoring-system)
* [Product Overview](#product-overview)
* [Vulnerability Summary](#vulnerability-summary)
* [Vulnerability Details](#vulnerability-details)
* [OpenofficeTextDocument Command Injection](#openofficetextdocument-command-injection)
* [Exploit Conditions](#exploit-conditions)
* [Proof-of-Concept](#proof-of-concept)
* [Suggested Mitigations](#suggested-mitigations)
* [Detection Guidance](#detection-guidance)
* [Credits](#credits)
* [Timeline](#timeline)

## Summary[#](#summary)

| **Product** | Chamilo |
| --- | --- |
| **Vendor** | Chamilo |
| **Severity** | High - Adversaries may exploit software vulnerabilities to obtain unauthenticated remote code execution. |
| **Affected Versions** | <= v1.11.24 |
| **Tested Versions** | v1.11.24 (latest version as of writing) |
| **CVE Identifier** | CVE-2023-4222 |
| **CVE Description** | Command injection in `main/lp/openoffice_text_document.class.php` in Chamilo LMS <= v1.11.24 allows users permitted to upload Learning Paths to obtain remote code execution via improper neutralisation of special characters. |
| **CWE Classification(s)** | CWE-78: Improper Neutralization of Special Elements used in an OS Command |
| **CAPEC Classification(s)** | CAPEC-88 OS Command Injection |

## CVSS3.1 Scoring System[#](#cvss31-scoring-system)

**Base Score:** 7.2 (High)

**Vector String:** `CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:N/C:H/I:H/A:H`

| **Metric** | **Value** |
| --- | --- |
| **Attack Vector (AV)** | Network |
| **Attack Complexity (AC)** | Low |
| **Privileges Required (PR)** | High |
| **User Interaction (UI)** | None |
| **Scope (S)** | Unchanged |
| **Confidentiality (C)** | High |
| **Integrity (I)** | High |
| **Availability (A)** | High |

## Product Overview[#](#product-overview)

Chamilo is an open-source PHP-based Learning Management System (LMS) that facilitates online education and training. It offers features such as course creation, content management, assessments, collaboration and delivering educational resources.

## Vulnerability Summary[#](#vulnerability-summary)

There are two command injection vulnerabilities manifesting in `main/lp/openoffice_presentation.class.php` (CVE-2023-4221) and `main/lp/openoffice_text_document.class.php` (CVE-2023-4222), which appears to be variants of CVE-2023-34960 (unauthenticated command injection in `main/webservices/additional_webservices.php`). Consequently, attackers with permissions to upload learning paths may exploit the vulnerability to gain remote code execution.

***Note:** This advisory details the second command injection vulnerability in `main/lp/openoffice_text_document.class.php` (CVE-2023-4222). The advisory for the first command injection vulnerability in `main/lp/openoffice_presentation.class.php` (CVE-2023-4221) can be found [here](/advisories/23/23-4221/).*

## Vulnerability Details[#](#vulnerability-details)

The relevant code from [`main/lp/lp_upload.php`](https://github.com/chamilo/chamilo-lms/blob/v1.11.24/main/lp/lp_upload.php#L112-L125) is shown below:

```
...
 elseif ($_SERVER['REQUEST_METHOD'] === 'POST' && count($_FILES) > 0 && !empty($_FILES['user_file']['name'])) {
    // A file upload has been detected, now deal with the file...
    // Directory creation.
    $stopping_error = false;
    $s = $_FILES['user_file']['name'];
    // Get name of the zip file without the extension.
    $info = pathinfo($s);
    $filename = $info['basename'];
    $extension = $info['extension'];
    $file_base_name = str_replace('.'.$extension, '', $filename);
    $new_dir = api_replace_dangerous_char(trim($file_base_name));
    $type = learnpath::getPackageType($_FILES['user_file']['tmp_name'], $_FILES['user_file']['name']); // [1]
    ...
    switch ($type) {
        ...
        case 'oogie':
            require_once 'openoffice_presentation.class.php';
            $take_slide_name = empty($_POST['take_slide_name']) ? false : true;
            $o_ppt = new OpenofficePresentation($take_slide_name);
            $first_item_id = $o_ppt->convert_document($_FILES['user_file'], 'make_lp', $_POST['slide_size']); // [2]
            Display::addFlash(Display::return_message(get_lang('UplUploadSucceeded')));
            break;
        case 'woogie':
            require_once 'openoffice_text.class.php';
            $split_steps = (empty($_POST['split_steps']) || $_POST['split_steps'] == 'per_page') ? 'per_page' : 'per_chapter';
            $o_doc = new OpenofficeText($split_steps);
            $first_item_id = $o_doc->convert_document($_FILES['user_file']); // [3]
            Display::addFlash(Display::return_message(get_lang('UplUploadSucceeded')));
            break;
        ...
    }
}
...

```

At [1], [`learnpath::getPackageType()`](https://github.com/chamilo/chamilo-lms/blob/v1.11.24/main/lp/learnpath.class.php#L2021-L2037) is invoked to determine if `oogie` or `woogie` should be used for processing the uploaded file:

```
class learnpath
{
    ...
    public static function getPackageType($file_path, $file_name)
    {
        // Get name of the zip file without the extension.
        $file_info = pathinfo($file_name);
        $extension = $file_info['extension']; // Extension only.
        if (!empty($_POST['ppt2lp']) && !in_array(strtolower($extension), [
                'dll',
                'exe',
            ])) {
            return 'oogie';
        }
        if (!empty($_POST['woogie']) && !in_array(strtolower($extension), [
                'dll',
                'exe',
            ])) {
            return 'woogie';
        }
        ...
    }
    ...
}

```

Observe that so long as the uploaded file extension does not match `dll` or `exe`, supplying a non-empty `ppt2lp` or `woogie` POST parameter allows reaching of the respective code paths.

Subsequently, the code will flow to either [2] and [3] where command injection occurs. Note that [3] leads to the second command injection vulnerability (presented in this advisory), and [2] leads to a [first command injection (CVE-2023-4221)](/advisories/23/23-4221/).

## OpenofficeTextDocument Command Injection[#](#openofficetextdocument-command-injection)

At [3], `OpenofficeTextDocument::convert_document()` is invoked. Since `OpenofficeTextDocument` extends from `OpenofficeDocument`, `OpenofficeDocument::convert_document()` is invoked in absence of an overriden function within the `OpenofficeTextDocument` class too. At [5], `add_command_parameters()` of the subclass is invoked. The [implementation of `OpenofficeTextDocument::add_command_parameters()`](https://github.com/chamilo/chamilo-lms/blob/v1.11.24/main/lp/openoffice_text_document.class.php#L334-L337) is shown below:

```
    public function add_command_parameters()
    {
        return ' -d woogie "'.$this->base_work_dir.'/'.$this->file_path.'"  "'.$this->base_work_dir.$this->created_dir.'/'.$this->file_name.'.html"';
    }

```

Notice that `$this->file_name` is used to construct the command to be executed here. Backtracking to the implementation of [`OpenofficeDocument::convert_document()`](https://github.com/chamilo/chamilo-lms/blob/v1.11.24/main/lp/openoffice_document.class.php#L50-L55), it can be seen that `$this->filename` is set using the uploaded file’s name:

```
    public function convert_document($file, $action_after_conversion = 'make_lp', $size = null)
    {
        $_course = api_get_course_info();
        $this->file_name = pathinfo($file['name'], PATHINFO_FILENAME);
        ...
    }

```

Observe that no sanitisation is performed on the `$file['name']`. Since `$_FILES['user_file']` is passed as the `$file` argument, it is possible to upload a file containing the command injection payload in its filename.

## Exploit Conditions[#](#exploit-conditions)

The following exploit conditions are identified for successful execution of this exploit scenario reliably:

1. Attacker must have permissions to upload learning paths (e.g. has the Trainer user role).
2. Chamilo RAPID (Rapid Learning tool) is enabled.
3. `service_ppt2lp` API configuration option must be set to `localhost`.

## Proof-of-Concept[#](#proof-of-concept)

1. Ensure that Chamilo RAPID (`http://<chamilo>/main/admin/configure_extensions.php?display=ppt2lp`) is enabled and that the `host` is set to `localhost`.
2. As the attacker, log in to an account with Trainer user role.
3. Note down the value of the `ch_sid` session cookie.
4. Create a course named `test` and navigate to `http://<chamilo>/courses/TEST/`.
5. Run the following shell commands on the attacker’s machine to execute arbitrary commands on the victim target:
   ```
   $ curl -b 'ch_sid=<ch_sid_value>' -F "user_file=@$(mktemp);filename='$(id > /tmp/rce)'" -F 'woogie=y' 'http://<chamilo>/main/lp/lp_upload.php'

   ```
6. Observe that the file `/tmp/rce` is created on the target server with the `id` shell command output as the file contents.

## Suggested Mitigations[#](#suggested-mitigations)

It is recommended to use `escapeshellarg()` to properly escape user-input used to construct shell commands.

End users are encouraged to update to the latest version of Chamilo.

## Detection Guidance[#](#detection-guidance)

It is possible to detect the exploitation of this vulnerability by checking the server’s access logs for all requests made to:

1. `/main/lp/lp_upload.php`
2. `/main/lp/lp_controller.php`
3. `/main/upload/upload_ppt.php`
4. `/main/upload/upload_upload.php`
5. `/main/upload/upload.scorm.php`

Successful exploitation of this vulnerability requiresa non-empty `woogie` POST parameter and the command injection payload to be placed within the filename of the `user_file` uploaded.

This vulnerability can be detected more accurately by performing investigation of database logs, as the [filename is stored in the database](https://github.com/chamilo/chamilo-lms/blob/v1.11.24/main/inc/lib/fileUpload.lib.php#L1450-L1458). For example, the following SQL query may be used to flag suspicious learning path uploads as potential exploit attempts:

```
SELECT * FROM c_document
WHERE path LIKE '/learning_path/%'
AND NOT regexp_replace(title, '[a-z0-9 ._-]+', '') = ''

```
## Credits[#](#credits)

Ngo Wei Lin ([@Creastery](https://twitter.com/Creastery)) of STAR Labs SG Pte. Ltd. ([@starlabs\_sg](https://twitter.com/starlabs_sg))

## Timeline[#](#timeline)

* 2023-09-04 Vendor Disclosure
* 2023-09-06 Initial Vendor Contact
* 2023-09-12 Sent additional information to vendor regarding incomplete fixes found
* 2023-09-27 Vendor Patch Release (v1.11.26) completely fixing vulnerability
* 2023-09-29 Vendor published the vulnerability sumamry
* 2023-09-29 Mutual agreement to delay the publication of vulnerability details was reached in light of the recent [in-the-wild exploitation of Chamilo N-day vulnerability (CVE-2023-34960)](https://github.com/chamilo/chamilo-lms/issues/4813)
* 2023-11-28 Public Release

[« Prev

(CVE-2023-4221) Chamilo LMS Learning Path PPT2LP OpenofficePresentation Command Injection](https://starlabs.sg/advisories/23/23-4221/)
[Next »

(CVE-2023-4223) Chamilo LMS Document Ajax File Upload Functionality Remote Code Execution](https://starlabs.sg/advisories/23/23-4223/)

© 2025 [STAR Labs](https://starlabs.sg/)
Powered by
[Hugo](https://gohugo.io/) &
[PaperMod](https://git.io/hugopapermod)



=== Content from github.com_51afad9b_20250115_081743.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2F841a07396fed0ef27c5db13a1b700eac02754fc7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2F841a07396fed0ef27c5db13a1b700eac02754fc7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=chamilo%2Fchamilo-lms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[chamilo](/chamilo)
/
**[chamilo-lms](/chamilo/chamilo-lms)**
Public

* [Notifications](/login?return_to=%2Fchamilo%2Fchamilo-lms) You must be signed in to change notification settings
* [Fork
  487](/login?return_to=%2Fchamilo%2Fchamilo-lms)
* [Star
   821](/login?return_to=%2Fchamilo%2Fchamilo-lms)

* [Code](/chamilo/chamilo-lms)
* [Issues
  568](/chamilo/chamilo-lms/issues)
* [Pull requests
  31](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects
  0](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

Additional navigation options

* [Code](/chamilo/chamilo-lms)
* [Issues](/chamilo/chamilo-lms/issues)
* [Pull requests](/chamilo/chamilo-lms/pulls)
* [Discussions](/chamilo/chamilo-lms/discussions)
* [Actions](/chamilo/chamilo-lms/actions)
* [Projects](/chamilo/chamilo-lms/projects)
* [Wiki](/chamilo/chamilo-lms/wiki)
* [Security](/chamilo/chamilo-lms/security)
* [Insights](/chamilo/chamilo-lms/pulse)

## Commit

[Permalink](/chamilo/chamilo-lms/commit/841a07396fed0ef27c5db13a1b700eac02754fc7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security: Avoid wrapping commands in double quotes as escapeshellarg(…

[Browse files](/chamilo/chamilo-lms/tree/841a07396fed0ef27c5db13a1b700eac02754fc7)
Browse the repository at this point in the history

```
…) does not escape them from args
```

* Loading branch information

[![@ywarnier](https://avatars.githubusercontent.com/u/609839?s=40&v=4)](/ywarnier)

[ywarnier](/chamilo/chamilo-lms/commits?author=ywarnier "View all commits by ywarnier")
committed
Sep 21, 2023

1 parent
[e864127](/chamilo/chamilo-lms/commit/e864127a440c2cab0eb62c113a04e2e904543a1f)

commit 841a073

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**9 additions**
and
**12 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* main/lp

  + main/lp/openoffice\_presentation.class.php
    [openoffice\_presentation.class.php](#diff-295b996949bd806f7181f1f3f69fb248d06dd155b7a5a79952b63e4958b24e90)
  + main/lp/openoffice\_text.class.php
    [openoffice\_text.class.php](#diff-14385753d288185f308a592879eab3fcdd0da2a7057bdf1dc16fc7cbfd6ced90)
  + main/lp/openoffice\_text\_document.class.php
    [openoffice\_text\_document.class.php](#diff-48e44c8de21270fcea3d45c5b6d5be89bc45b8042d7d979ddebce426d0807b4d)

## There are no files selected for viewing

7 changes: 3 additions & 4 deletions

7
[main/lp/openoffice\_presentation.class.php](#diff-295b996949bd806f7181f1f3f69fb248d06dd155b7a5a79952b63e4958b24e90 "main/lp/openoffice_presentation.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/841a07396fed0ef27c5db13a1b700eac02754fc7/main/lp/openoffice_presentation.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -253,11 +253,10 @@ public function add\_command\_parameters() |
|  |  | $this->slide\_height = (int) $h; |
|  |  | } |
|  |  |  |
|  |  | return ' -w '.$this->slide\_width.' -h '.$this->slide\_height.' -d oogie "' |
|  |  | return ' -w '.$this->slide\_width.' -h '.$this->slide\_height.' -d oogie ' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'.html') |
|  |  | .'"'; |
|  |  | .' ' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'.html'); |
|  |  | } |
|  |  |  |
|  |  | public function set\_slide\_size($width, $height) |
| Expand Down | |  |

7 changes: 3 additions & 4 deletions

7
[main/lp/openoffice\_text.class.php](#diff-14385753d288185f308a592879eab3fcdd0da2a7057bdf1dc16fc7cbfd6ced90 "main/lp/openoffice_text.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/841a07396fed0ef27c5db13a1b700eac02754fc7/main/lp/openoffice_text.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -331,11 +331,10 @@ public function dealPerPage($header, $body) |
|  |  | \*/ |
|  |  | public function add\_command\_parameters() |
|  |  | { |
|  |  | return ' -d woogie "' |
|  |  | return ' -d woogie ' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html') |
|  |  | .'"'; |
|  |  | .' ' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html'); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

7 changes: 3 additions & 4 deletions

7
[main/lp/openoffice\_text\_document.class.php](#diff-48e44c8de21270fcea3d45c5b6d5be89bc45b8042d7d979ddebce426d0807b4d "main/lp/openoffice_text_document.class.php")

Show comments

[View file](/chamilo/chamilo-lms/blob/841a07396fed0ef27c5db13a1b700eac02754fc7/main/lp/openoffice_text_document.class.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -333,11 +333,10 @@ public function dealPerPage($header, $body) |
|  |  | \*/ |
|  |  | public function add\_command\_parameters() |
|  |  | { |
|  |  | return ' -d woogie "' |
|  |  | return ' -d woogie ' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.'/'.$this->file\_path) |
|  |  | .'" "' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html') |
|  |  | .'"'; |
|  |  | .' ' |
|  |  | .Security::sanitizeExecParam($this->base\_work\_dir.$this->created\_dir.'/'.$this->file\_name.'.html'); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `841a073`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fchamilo%2Fchamilo-lms%2Fcommit%2F841a07396fed0ef27c5db13a1b700eac02754fc7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


