- **Root cause of vulnerability:** The application uses a redirect for permission checks but fails to terminate script execution after the redirect. This allows an attacker to bypass permission checks and execute code intended for higher-privileged users.
- **Weaknesses/vulnerabilities present:** Vertical privilege escalation. Improper redirect implementation. Lack of proper termination of script execution after redirect.
- **Impact of exploitation:** Attackers can gain unauthorized access to administrative functionalities. In the given example, an attacker can delete doctor information by exploiting the vulnerability in the `/vm/admin/delete-doctor.php` file. This can lead to data loss and other unauthorized actions.
- **Attack vectors:** Remote HTTP GET request to a specific vulnerable file. The attacker needs to know the path of the vulnerable file and the parameter required to perform the action.
- **Required attacker capabilities/position:** The attacker can be a low-privileged user or an external actor with the ability to send HTTP requests to the vulnerable application.