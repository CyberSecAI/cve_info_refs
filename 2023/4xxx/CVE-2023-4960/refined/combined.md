=== Content from www.wordfence.com_f595aa32_20250115_102438.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WCFM Marketplace <= 3.6.2 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WCFM Marketplace <= 3.6.2 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-4960](https://www.cve.org/CVERecord?id=CVE-2023-4960) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | November 23, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The WCFM Marketplace plugin for WordPress is vulnerable to Stored Cross-Site Scripting via 'wcfm\_stores' shortcode in versions up to, and including, 3.6.2 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers with contributor-level and above permissions to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php#L207)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php#L241)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3000763/wc-multivendor-marketplace#file999)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwc-multivendor-marketplace%2Fwcfm-marketplace-362-authenticated-contributor-stored-cross-site-scripting-via-shortcode&t=WCFM%20Marketplace%20%3C%3D%203.6.2%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwc-multivendor-marketplace%2Fwcfm-marketplace-362-authenticated-contributor-stored-cross-site-scripting-via-shortcode&text=WCFM%20Marketplace%20%3C%3D%203.6.2%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwc-multivendor-marketplace%2Fwcfm-marketplace-362-authenticated-contributor-stored-cross-site-scripting-via-shortcode "LinkedIn")
Email

## Vulnerability Details for WCFM Marketplace – Multivendor Marketplace for WooCommerce

#### [WCFM Marketplace – Multivendor Marketplace for WooCommerce](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wc-multivendor-marketplace)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wc-multivendor-marketplace [(view on wordpress.org)](https://wordpress.org/plugins/wc-multivendor-marketplace) |
| Patched? | Yes |
| Remediation | Update to version 3.6.3, or a newer patched version |
| Affected Version | * <= 3.6.2 |
| Patched Version | * 3.6.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_aac8f105_20250115_102235.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwc-multivendor-marketplace%2Ftags%2F3.6.1%2Fviews%2Fstore-lists%2Fwcfmmp-view-store-lists.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php)

---

# [source:](/browser?order=name "Go to repository root") [wc-multivendor-marketplace](/browser/wc-multivendor-marketplace?order=name "View wc-multivendor-marketplace")/[tags](/browser/wc-multivendor-marketplace/tags?order=name "View tags")/[3.6.1](/browser/wc-multivendor-marketplace/tags/3.6.1?order=name "View 3.6.1")/[views](/browser/wc-multivendor-marketplace/tags/3.6.1/views?order=name "View views")/[store-lists](/browser/wc-multivendor-marketplace/tags/3.6.1/views/store-lists?order=name "View store-lists")/[wcfmmp-view-store-lists.php](/browser/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php?order=name "View wcfmmp-view-store-lists.php")

View diff against:

View revision:

| [Last change](/changeset/2939091/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php "View differences") on this file was [2939091](/changeset/2939091/ "View changeset 2939091"), checked in by wclovers, [18 months ago](/timeline?from=2023-07-16T07%3A05%3A07Z&precision=second "See timeline at 07/16/2023 07:05:07 AM") |
| --- |
| WCFM Marketplace 3.6.1 version update |
| **File size:** 9.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* The Template for displaying store list. |
| [4](#L4) | \* |
| [5](#L5) | \* @package WCfM Markeplace Views Store Lists |
| [6](#L6) | \* |
| [7](#L7) | \* For edit coping this to yourtheme/wcfm/store-lists |
| [8](#L8) | \* |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | if ( ! defined( 'ABSPATH' ) ) exit; // Exit if accessed directly |
| [12](#L12) |  |
| [13](#L13) | global $WCFM, $WCFMmp, $post; |
| [14](#L14) |  |
| [15](#L15) | $pagination\_base = ''; |
| [16](#L16) | if( $post ) |
| [17](#L17) | $pagination\_base = str\_replace( $post->ID, '%#%', esc\_url( get\_pagenum\_link( $post->ID ) ) ); |
| [18](#L18) |  |
| [19](#L19) | $url = explode( '?', $pagination\_base ); |
| [20](#L20) | $pagination\_base = $url[0]; |
| [21](#L21) |  |
| [22](#L22) | //$search\_country = ''; |
| [23](#L23) | //$search\_state   = ''; |
| [24](#L24) |  |
| [25](#L25) | // GEO Locate Support |
| [26](#L26) | if( apply\_filters( 'wcfmmp\_is\_allow\_store\_list\_by\_user\_location', true ) ) { |
| [27](#L27) | if( is\_user\_logged\_in() && !$search\_country ) { |
| [28](#L28) | $user\_location = get\_user\_meta( get\_current\_user\_id(), 'wcfm\_user\_location', true ); |
| [29](#L29) | if( $user\_location ) { |
| [30](#L30) | $search\_country = $user\_location['country']; |
| [31](#L31) | $search\_state   = $user\_location['state']; |
| [32](#L32) | } |
| [33](#L33) | } |
| [34](#L34) |  |
| [35](#L35) | if( apply\_filters( 'wcfm\_is\_allow\_wc\_geolocate', true ) && class\_exists( 'WC\_Geolocation' ) && !$search\_country ) { |
| [36](#L36) | $user\_location = WC\_Geolocation::geolocate\_ip(); |
| [37](#L37) | $search\_country = $user\_location['country']; |
| [38](#L38) | $search\_state   = $user\_location['state']; |
| [39](#L39) | } |
| [40](#L40) | } |
| [41](#L41) |  |
| [42](#L42) | $search\_query     = isset( $\_GET['wcfmmp\_store\_search'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_search'] ) : $search\_term; |
| [43](#L43) | $search\_category  = isset( $\_GET['wcfmmp\_store\_category'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_category'] ) : $search\_category; |
| [44](#L44) | $store\_category   = isset( $\_GET['wcfmsc\_store\_categories'] ) ? sanitize\_text\_field( $\_GET['wcfmsc\_store\_categories'] ) : $store\_category; |
| [45](#L45) |  |
| [46](#L46) | $search\_country = isset( $\_GET['wcfmmp\_store\_country'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_country'] ) : $search\_country; |
| [47](#L47) | $search\_state   = isset( $\_GET['wcfmmp\_store\_state'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_state'] ) : $search\_state; |
| [48](#L48) | $search\_city    = isset( $\_GET['wcfmmp\_store\_city'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_city'] ) : $search\_city; |
| [49](#L49) | $search\_zip     = isset( $\_GET['wcfmmp\_store\_zip'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_zip'] ) : $search\_zip; |
| [50](#L50) |  |
| [51](#L51) | $search\_radius\_range    = isset( $\_GET['wcfmmp\_radius\_range'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_range'] ) : $search\_radius\_range; |
| [52](#L52) | $search\_radius\_lat      = isset( $\_GET['wcfmmp\_radius\_lat'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_lat'] ) : $search\_radius\_lat; |
| [53](#L53) | $search\_radius\_lng              = isset( $\_GET['wcfmmp\_radius\_lng'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_lng'] ) : $search\_radius\_lng; |
| [54](#L54) |  |
| [55](#L55) | $orderby          = isset( $\_GET['orderby'] ) ? sanitize\_sql\_orderby( $\_GET['orderby'] ) : $orderby; |
| [56](#L56) |  |
| [57](#L57) | $search\_data     = array(); |
| [58](#L58) | if( $store\_category ) { |
| [59](#L59) | $search\_data['wcfmsc\_store\_categories'] = $store\_category; |
| [60](#L60) | } |
| [61](#L61) | if( $search\_country ) { |
| [62](#L62) | $search\_data['wcfmmp\_store\_country'] = $search\_country; |
| [63](#L63) | } |
| [64](#L64) | if( $search\_state ) { |
| [65](#L65) | $search\_data['wcfmmp\_store\_state'] = $search\_state; |
| [66](#L66) | } |
| [67](#L67) | if( $search\_city ) { |
| [68](#L68) | $search\_data['wcfmmp\_store\_city'] = $search\_city; |
| [69](#L69) | } |
| [70](#L70) | if( $search\_zip ) { |
| [71](#L71) | $search\_data['wcfmmp\_store\_zip'] = $search\_zip; |
| [72](#L72) | } |
| [73](#L73) | if( $search\_radius\_range ) { |
| [74](#L74) | $search\_data['wcfmmp\_radius\_range'] = $search\_radius\_range; |
| [75](#L75) | } |
| [76](#L76) | if( $search\_radius\_lat ) { |
| [77](#L77) | $search\_data['wcfmmp\_radius\_lat'] = $search\_radius\_lat; |
| [78](#L78) | } |
| [79](#L79) | if( $search\_radius\_lng ) { |
| [80](#L80) | $search\_data['wcfmmp\_radius\_lng'] = $search\_radius\_lng; |
| [81](#L81) | } |
| [82](#L82) | if( isset( $\_POST['search\_data'] ) ) { |
| [83](#L83) | parse\_str($\_POST['search\_data'], $search\_data); |
| [84](#L84) | $search\_data = wc\_clean( wp\_unslash( $search\_data ) ); |
| [85](#L85) | } elseif( isset( $\_GET['orderby'] ) ) { |
| [86](#L86) | $search\_data = wc\_clean( wp\_unslash($\_GET) ); |
| [87](#L87) | } |
| [88](#L88) | $search\_data['excludes'] = $excludes; |
| [89](#L89) |  |
| [90](#L90) | $args = array( |
| [91](#L91) | 'stores'                        => $stores, |
| [92](#L92) | 'limit'                         => $limit, |
| [93](#L93) | 'offset'                        => $offset, |
| [94](#L94) | 'paged'                         => $paged, |
| [95](#L95) | 'sidebar'                       => $sidebar, |
| [96](#L96) | 'filter'                        => $filter, |
| [97](#L97) | 'search'                        => $search, |
| [98](#L98) | 'category'                      => $category, |
| [99](#L99) | 'country'                       => $country, |
| [100](#L100) | 'state'                         => $state, |
| [101](#L101) | 'has\_city'                      => $has\_city, |
| [102](#L102) | 'has\_zip'                       => $has\_zip, |
| [103](#L103) | 'radius'                        => $radius, |
| [104](#L104) | 'map'                           => $map, |
| [105](#L105) | 'map\_zoom'                      => $map\_zoom, |
| [106](#L106) | 'auto\_zoom'                     => $auto\_zoom, |
| [107](#L107) | 'search\_query'                  => $search\_query, |
| [108](#L108) | 'search\_term'                   => $search\_query, |
| [109](#L109) | 'search\_country'                => $search\_country, |
| [110](#L110) | 'search\_state'                  => $search\_state, |
| [111](#L111) | 'search\_city'                   => $search\_city, |
| [112](#L112) | 'search\_zip'                    => $search\_zip, |
| [113](#L113) | 'search\_category'               => $search\_category, |
| [114](#L114) | 'search\_radius\_range'   => $search\_radius\_range, |
| [115](#L115) | 'search\_radius\_lat'     => $search\_radius\_lat, |
| [116](#L116) | 'search\_radius\_lng'     => $search\_radius\_lng, |
| [117](#L117) | 'store\_category'                => $store\_category, |
| [118](#L118) | 'pagination\_base'               => $pagination\_base, |
| [119](#L119) | 'per\_row'                       => $per\_row, |
| [120](#L120) | 'search\_enabled'                => $search, |
| [121](#L121) | 'image\_size'                    => $image\_size, |
| [122](#L122) | 'includes'                      => $includes, |
| [123](#L123) | 'excludes'                      => $excludes, |
| [124](#L124) | 'orderby'                       => $orderby, |
| [125](#L125) | 'has\_orderby'                   => $has\_orderby, |
| [126](#L126) | 'has\_product'                   => $has\_product, |
| [127](#L127) | 'theme'                         => $theme, |
| [128](#L128) | 'search\_data'                   => $search\_data |
| [129](#L129) | ); |
| [130](#L130) |  |
| [131](#L131) | $store\_sidebar\_pos = isset( $WCFMmp->wcfmmp\_marketplace\_options['store\_sidebar\_pos'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['store\_sidebar\_pos'] : 'left'; |
| [132](#L132) |  |
| [133](#L133) | $api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
| [134](#L134) | $wcfm\_map\_lib = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
| [135](#L135) | if( !$wcfm\_map\_lib && $api\_key ) { $wcfm\_map\_lib = 'google'; } elseif( !$wcfm\_map\_lib && !$api\_key ) { $wcfm\_map\_lib = 'leaftlet'; } |
| [136](#L136) |  |
| [137](#L137) | $wcfm\_store\_lists\_wrapper\_class = apply\_filters( 'wcfm\_store\_lists\_wrapper\_class', '' ); |
| [138](#L138) |  |
| [139](#L139) | if( $theme == 'classic' ) { |
| [140](#L140) | wp\_enqueue\_style( 'wcfmmp\_store\_list\_classic\_css',  $WCFMmp->library->css\_lib\_url\_min . 'store-lists/wcfmmp-style-stores-list-classic.css', array( 'wcfmmp\_store\_list\_css' ), $WCFMmp->version ); |
| [141](#L141) |  |
| [142](#L142) | if( is\_rtl() ) { |
| [143](#L143) | wp\_enqueue\_style( 'wcfmmp\_store\_list\_classic\_rtl\_css',  $WCFMmp->library->css\_lib\_url\_min . 'store-lists/wcfmmp-style-stores-list-classic-rtl.css', array( 'wcfmmp\_store\_list\_classic\_css' ), $WCFMmp->version ); |
| [144](#L144) | } |
| [145](#L145) | } elseif( $theme == 'compact' ) { |
| [146](#L146) | wp\_enqueue\_style( 'wcfmmp\_store\_list\_compact\_css',  $WCFMmp->library->css\_lib\_url\_min . 'store-lists/wcfmmp-style-stores-list-compact.css', array( 'wcfmmp\_store\_list\_css' ), $WCFMmp->version ); |
| [147](#L147) |  |
| [148](#L148) | if( is\_rtl() ) { |
| [149](#L149) | wp\_enqueue\_style( 'wcfmmp\_store\_list\_compact\_rtl\_css',  $WCFMmp->library->css\_lib\_url\_min . 'store-lists/wcfmmp-style-stores-list-compact-rtl.css', array( 'wcfmmp\_store\_list\_compact\_css' ), $WCFMmp->version ); |
| [150](#L150) | } |
| [151](#L151) | } |
| [152](#L152) |  |
| [153](#L153) | ?> |
| [154](#L154) |  |
| [155](#L155) | <?php if( $sidebar && $WCFMmp->wcfmmp\_vendor->is\_store\_lists\_sidebar() && ($store\_sidebar\_pos != 'left' ) ) { ?> |
| [156](#L156) | <style> |
| [157](#L157) | #wcfmmp-stores-lists .right\_side{float:left !important;} |
| [158](#L158) | #wcfmmp-stores-lists .left\_sidebar{float:right !important;} |
| [159](#L159) | </style> |
| [160](#L160) | <?php } ?> |
| [161](#L161) |  |
| [162](#L162) | <?php do\_action( 'wcfmmp\_store\_lists\_before' ); ?> |
| [163](#L163) |  |
| [164](#L164) | <div id="wcfmmp-stores-lists" class="wcfmmp-stores-listing <?php echo esc\_attr($wcfm\_store\_lists\_wrapper\_class); ?>"> |
| [165](#L165) |  |
| [166](#L166) | <?php do\_action( 'wcfmmp\_store\_lists\_start' ); ?> |
| [167](#L167) |  |
| [168](#L168) | <?php do\_action( 'wcfmmp\_store\_lists\_before\_map' ); ?> |
| [169](#L169) |  |
| [170](#L170) | <?php if( $map && apply\_filters( 'wcfmmp\_is\_allow\_map\_full\_width', true ) ) { $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-map.php', $args ); } ?> |
| [171](#L171) |  |
| [172](#L172) | <?php do\_action( 'wcfmmp\_store\_lists\_after\_map' ); ?> |
| [173](#L173) |  |
| [174](#L174) | <?php if( (!$WCFMmp->wcfmmp\_vendor->is\_store\_lists\_sidebar() || !$sidebar ) && $filter && ($search || $category || $radius || $country || $state || $has\_city || $has\_zip) ) { $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-search-form.php', $args ); } ?> |
| [175](#L175) |  |
| [176](#L176) | <?php if( $sidebar && !apply\_filters( 'wcfmmp\_is\_allow\_mobile\_sidebar\_at\_bottom', true ) ) { ?> |
| [177](#L177) | <?php $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-sidebar.php', $args ); ?> |
| [178](#L178) | <?php } ?> |
| [179](#L179) |  |
| [180](#L180) | <?php do\_action( 'wcfmmp\_store\_lists\_before\_loop' ); ?> |
| [181](#L181) |  |
| [182](#L182) | <div id="wcfmmp-stores-wrap-holder" class="rgt right\_side <?php if( !$sidebar || !$WCFMmp->wcfmmp\_vendor->is\_store\_lists\_sidebar() ) echo 'right\_side\_full'; ?>"> |
| [183](#L183) | <?php if( $map && !apply\_filters( 'wcfmmp\_is\_allow\_map\_full\_width', true ) ) { $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-map.php', $args ); } ?> |
| [184](#L184) |  |
| [185](#L185) | <div id="wcfmmp-stores-wrap"> |
| [186](#L186) | <?php $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-loop.php', $args ); ?> |
| [187](#L187) | </div> |
| [188](#L188) | </div> |
| [189](#L189) |  |
| [190](#L190) | <?php do\_action( 'wcfmmp\_store\_lists\_after\_loop' ); ?> |
| [191](#L191) |  |
| [192](#L192) | <?php if( $sidebar && apply\_filters( 'wcfmmp\_is\_allow\_mobile\_sidebar\_at\_bottom', true ) ) { ?> |
| [193](#L193) | <?php $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-sidebar.php', $args ); ?> |
| [194](#L194) | <?php } ?> |
| [195](#L195) |  |
| [196](#L196) | <?php do\_action( 'wcfmmp\_store\_lists\_end' ); ?> |
| [197](#L197) |  |
| [198](#L198) | <div class="spacer"></div> |
| [199](#L199) | </div> |
| [200](#L200) |  |
| [201](#L201) | <?php do\_action( 'wcfmmp\_store\_lists\_after' ); ?> |
| [202](#L202) |  |
| [203](#L203) | <?php  if( !$map || ( ($wcfm\_map\_lib == 'google') && !$api\_key ) ) { ?> |
| [204](#L204) | <script> |
| [205](#L205) | $per\_row     = '<?php echo esc\_attr($per\_row); ?>'; |
| [206](#L206) | $per\_page    = '<?php echo esc\_attr($limit); ?>'; |
| [207](#L207) | $includes    = '<?php echo implode(",", $includes ); ?>'; |
| [208](#L208) | $excludes    = '<?php echo esc\_attr($excludes); ?>'; |
| [209](#L209) | $has\_product = '<?php echo esc\_attr($has\_product); ?>'; |
| [210](#L210) | $sidebar     = '<?php echo esc\_attr($sidebar); ?>'; |
| [211](#L211) | $has\_orderby = '<?php echo esc\_attr($has\_orderby); ?>'; |
| [212](#L212) | $theme       = '<?php echo esc\_attr($theme); ?>'; |
| [213](#L213) | </script> |
| [214](#L214) | <?php } ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php?format=txt)
* [Original Format](/export/3222765/wc-multivendor-marketplace/tags/3.6.1/views/store-lists/wcfmmp-view-store-lists.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_553495a9_20250115_102436.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3000763%2Fwc-multivendor-marketplace)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2974835/wc-multivendor-marketplace "Changeset 2974835 for wc-multivendor-marketplace")
* [Next Change](/changeset/3004470/wc-multivendor-marketplace "Changeset 3004470 for wc-multivendor-marketplace") →

---

# Changeset [3000763](/changeset/3000763 "Show full changeset") for [wc-multivendor-marketplace](/browser/wc-multivendor-marketplace?rev=3000763 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/23/2023 03:00:38 PM
([14 months](/timeline?from=2023-11-23T15%3A00%3A38Z&precision=second "See timeline at 11/23/2023 03:00:38 PM") ago)

Author:
wclovers
Message:

WCFM Marketplace 3.6.3 version update

Location:
[wc-multivendor-marketplace](/browser/wc-multivendor-marketplace?rev=3000763)
Files:

980 added
22 edited

* [tags/3.6.3](/browser/wc-multivendor-marketplace/tags/3.6.3?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets](/browser/wc-multivendor-marketplace/tags/3.6.3/assets?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/admin](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/admin?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/admin/wcfmmp-style-admin.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/admin/wcfmmp-style-admin.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/carousel](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/carousel?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/carousel/wcfmmp-style-owl-carousel.min.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/carousel/wcfmmp-style-owl-carousel.min.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/checkout](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/checkout?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/checkout/wcfmmp-style-checkout-location.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/checkout/wcfmmp-style-checkout-location.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/gateway](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/gateway?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/gateway/stripe.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/gateway/stripe.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/ledger](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/ledger?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/ledger/wcfmmp-style-ledger.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/ledger/wcfmmp-style-ledger.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/media](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/media?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/media/wcfmmp-style-media.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/media/wcfmmp-style-media.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/admin](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/admin?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/admin/wcfmmp-style-admin.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/admin/wcfmmp-style-admin.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/checkout](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/checkout?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/checkout/wcfmmp-style-checkout-location.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/checkout/wcfmmp-style-checkout-location.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/gateway](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/gateway?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/gateway/stripe.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/gateway/stripe.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/ledger](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/ledger?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/ledger/wcfmmp-style-ledger.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/ledger/wcfmmp-style-ledger.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/media](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/media?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/media/wcfmmp-style-media.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/media/wcfmmp-style-media.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/product-geolocate](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/product-geolocate?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/product-geolocate/wcfmmp-style-product-list-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/product-geolocate/wcfmmp-style-product-list-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/product-geolocate/wcfmmp-style-product-list.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/product-geolocate/wcfmmp-style-product-list.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/product\_multivendor](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/product_multivendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/product\_multivendor/wcfmmp-style-product-multivendor.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/product_multivendor/wcfmmp-style-product-multivendor.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/product\_multivendor/wcfmmp-style-sell-items-catalog.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/product_multivendor/wcfmmp-style-sell-items-catalog.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/refund/wcfmmp-style-refund-requests-popup.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/refund/wcfmmp-style-refund-requests-popup.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/refund/wcfmmp-style-refund-requests.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/refund/wcfmmp-style-refund-requests.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/reviews](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/reviews?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/reviews/wcfmmp-style-product-reviews.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/reviews/wcfmmp-style-product-reviews.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/reviews/wcfmmp-style-reviews-manage.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/reviews/wcfmmp-style-reviews-manage.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/reviews/wcfmmp-style-reviews.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/reviews/wcfmmp-style-reviews.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-classic-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-classic-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-classic.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-classic.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-compact-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-compact-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-compact.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-compact.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store-lists/wcfmmp-style-stores-list.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/legacy](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/legacy?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/legacy/wcfmmp-style-store-responsive.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/legacy/wcfmmp-style-store-responsive.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/legacy/wcfmmp-style-store-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/legacy/wcfmmp-style-store-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/legacy/wcfmmp-style-store.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/legacy/wcfmmp-style-store.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/wcfmmp-style-product.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/wcfmmp-style-product.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/wcfmmp-style-store-responsive.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/wcfmmp-style-store-responsive.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/wcfmmp-style-store-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/wcfmmp-style-store-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/min/store/wcfmmp-style-store.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/min/store/wcfmmp-style-store.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/product-geolocate](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/product-geolocate?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/product-geolocate/wcfmmp-style-product-list-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/product-geolocate/wcfmmp-style-product-list-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/product-geolocate/wcfmmp-style-product-list.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/product-geolocate/wcfmmp-style-product-list.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/product\_multivendor](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/product_multivendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/product\_multivendor/wcfmmp-style-product-multivendor.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/product_multivendor/wcfmmp-style-product-multivendor.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/product\_multivendor/wcfmmp-style-sell-items-catalog.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/product_multivendor/wcfmmp-style-sell-items-catalog.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/refund/wcfmmp-style-refund-requests-popup.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/refund/wcfmmp-style-refund-requests-popup.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/refund/wcfmmp-style-refund-requests.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/refund/wcfmmp-style-refund-requests.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/reviews](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/reviews?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/reviews/wcfmmp-style-product-reviews.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/reviews/wcfmmp-style-product-reviews.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/reviews/wcfmmp-style-reviews-manage.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/reviews/wcfmmp-style-reviews-manage.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/reviews/wcfmmp-style-reviews.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/reviews/wcfmmp-style-reviews.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-classic-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-classic-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-classic.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-classic.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-compact-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-compact-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-compact.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-compact.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store-lists/wcfmmp-style-stores-list.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/legacy](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/legacy?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/legacy/wcfmmp-style-store-responsive.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/legacy/wcfmmp-style-store-responsive.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/legacy/wcfmmp-style-store-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/legacy/wcfmmp-style-store-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/legacy/wcfmmp-style-store.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/legacy/wcfmmp-style-store.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/wcfmmp-style-product.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/wcfmmp-style-product.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/wcfmmp-style-store-responsive.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/wcfmmp-style-store-responsive.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/wcfmmp-style-store-rtl.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/wcfmmp-style-store-rtl.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/css/store/wcfmmp-style-store.css](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/css/store/wcfmmp-style-store.css?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/Conflict-larger-word-400x.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/Conflict-larger-word-400x.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/bank\_transfer.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/bank_transfer.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/by\_cash.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/by_cash.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/connect\_stripe.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/connect_stripe.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/default\_banner.jpg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/default_banner.jpg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/amex.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/amex.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/credit-card.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/credit-card.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/diners.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/diners.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/discover.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/discover.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/jcb.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/jcb.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/maestro.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/maestro.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/mastercard.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/mastercard.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway/visa.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway/visa.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/gateway\_logo.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/gateway_logo.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/list\_arow.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/list_arow.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/list\_arow1.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/list_arow1.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/locate.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/locate.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/paypal.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/paypal.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/sold\_by\_advanced.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/sold_by_advanced.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/sold\_by\_simple.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/sold_by_simple.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/sold\_by\_tab.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/sold_by_tab.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/sort\_asc.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/sort_asc.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/sort\_both.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/sort_both.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/sort\_desc.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/sort_desc.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/stripe.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/stripe.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfm\_marketplace\_white\_ogo.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfm_marketplace_white_ogo.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmgs-icon-128x128.jpg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmgs-icon-128x128.jpg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp-30X30.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp-30X30.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp-75x75.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp-75x75.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp-blue.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp-blue.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp-storelist.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp-storelist.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp\_ico.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp_ico.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp\_icon.svg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp_icon.svg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp\_map\_icon-original.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp_map_icon-original.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp\_map\_icon.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp_map_icon.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/wcfmmp\_map\_icon\_back.png](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/wcfmmp_map_icon_back.png?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/images/write.jpg](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/images/write.jpg?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/carousel](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/carousel?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/carousel/wcfmmp-script-owl-carousel-custom.min.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/carousel/wcfmmp-script-owl-carousel-custom.min.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/carousel/wcfmmp-script-owl-carousel.min.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/carousel/wcfmmp-script-owl-carousel.min.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/cart](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/cart?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/cart/wcfmmp-script-cart.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/cart/wcfmmp-script-cart.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/checkout](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/checkout?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/checkout/wcfmmp-script-checkout-location.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/checkout/wcfmmp-script-checkout-location.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/checkout/wcfmmp-script-checkout.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/checkout/wcfmmp-script-checkout.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/gateway](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/gateway?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/gateway/stripe.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/gateway/stripe.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/gateway/wirecard-checkout.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/gateway/wirecard-checkout.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/gateway/wirecard.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/gateway/wirecard.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/ledger](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/ledger?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/ledger/wcfmmp-script-ledger.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/ledger/wcfmmp-script-ledger.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/media](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/media?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/media/wcfmmp-script-media.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/media/wcfmmp-script-media.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/cart](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/cart?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/cart/wcfmmp-script-cart.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/cart/wcfmmp-script-cart.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/checkout](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/checkout?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/checkout/wcfmmp-script-checkout-location.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/checkout/wcfmmp-script-checkout-location.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/checkout/wcfmmp-script-checkout.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/checkout/wcfmmp-script-checkout.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/gateway](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/gateway?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/gateway/stripe.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/gateway/stripe.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/gateway/wirecard-checkout.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/gateway/wirecard-checkout.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/gateway/wirecard.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/gateway/wirecard.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/ledger](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/ledger?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/ledger/wcfmmp-script-ledger.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/ledger/wcfmmp-script-ledger.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/media](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/media?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/media/wcfmmp-script-media.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/media/wcfmmp-script-media.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/product-geolocate](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/product-geolocate?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/product-geolocate/wcfmmp-script-product-lists.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/product-geolocate/wcfmmp-script-product-lists.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/product\_multivendor](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/product_multivendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/product\_multivendor/wcfmmp-script-product-multivendor.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/product_multivendor/wcfmmp-script-product-multivendor.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/product\_multivendor/wcfmmp-script-sell-items-catalog.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/product_multivendor/wcfmmp-script-sell-items-catalog.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/refund/wcfmmp-script-refund-requests-popup.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/refund/wcfmmp-script-refund-requests-popup.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/refund/wcfmmp-script-refund-requests.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/refund/wcfmmp-script-refund-requests.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/reviews](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/reviews?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/reviews/wcfmmp-script-product-reviews.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/reviews/wcfmmp-script-product-reviews.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/reviews/wcfmmp-script-reviews-manage.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/reviews/wcfmmp-script-reviews-manage.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/reviews/wcfmmp-script-reviews.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/reviews/wcfmmp-script-reviews.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/store](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/store?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/store-lists](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/store-lists?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/store-lists/wcfmmp-script-store-lists.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/store-lists/wcfmmp-script-store-lists.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/store/wcfmmp-script-fb-widget.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/store/wcfmmp-script-fb-widget.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/store/wcfmmp-script-store.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/store/wcfmmp-script-store.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/vendors](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/vendors?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/vendors/wcfmmp-script-vendors-manage.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/vendors/wcfmmp-script-vendors-manage.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/min/wcfmmp-script-settings.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/min/wcfmmp-script-settings.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/product-geolocate](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/product-geolocate?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/product-geolocate/wcfmmp-script-product-lists.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/product-geolocate/wcfmmp-script-product-lists.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/product\_multivendor](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/product_multivendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/product\_multivendor/wcfmmp-script-product-multivendor.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/product_multivendor/wcfmmp-script-product-multivendor.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/product\_multivendor/wcfmmp-script-sell-items-catalog.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/product_multivendor/wcfmmp-script-sell-items-catalog.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/refund/wcfmmp-script-refund-requests-popup.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/refund/wcfmmp-script-refund-requests-popup.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/refund/wcfmmp-script-refund-requests.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/refund/wcfmmp-script-refund-requests.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/reviews](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/reviews?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/reviews/wcfmmp-script-product-reviews.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/reviews/wcfmmp-script-product-reviews.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/reviews/wcfmmp-script-reviews-manage.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/reviews/wcfmmp-script-reviews-manage.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/reviews/wcfmmp-script-reviews.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/reviews/wcfmmp-script-reviews.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/store](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/store?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/store-lists](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/store-lists?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/store-lists/wcfmmp-script-store-lists.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/store-lists/wcfmmp-script-store-lists.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/store/wcfmmp-script-fb-widget.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/store/wcfmmp-script-fb-widget.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/store/wcfmmp-script-store.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/store/wcfmmp-script-store.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/vendors](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/vendors?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/vendors/wcfmmp-script-vendors-manage.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/vendors/wcfmmp-script-vendors-manage.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/assets/js/wcfmmp-script-settings.js](/browser/wc-multivendor-marketplace/tags/3.6.3/assets/js/wcfmmp-script-settings.js?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/ledger](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/ledger?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/ledger/wcfmmp-controller-ledger.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/ledger/wcfmmp-controller-ledger.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/media](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/media?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/media/wcfmmp-controller-media.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/media/wcfmmp-controller-media.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/product\_multivendor](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/product_multivendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/product\_multivendor/wcfmmp-controller-sell-items-catalog.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/product_multivendor/wcfmmp-controller-sell-items-catalog.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/refund/wcfmmp-controller-refund-requests-actions.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/refund/wcfmmp-controller-refund-requests-actions.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/refund/wcfmmp-controller-refund-requests-form.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/refund/wcfmmp-controller-refund-requests-form.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/refund/wcfmmp-controller-refund-requests.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/refund/wcfmmp-controller-refund-requests.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/reviews](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/reviews?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/reviews/wcfmmp-controller-product-reviews.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/reviews/wcfmmp-controller-product-reviews.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/reviews/wcfmmp-controller-reviews-manage.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/reviews/wcfmmp-controller-reviews-manage.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/reviews/wcfmmp-controller-reviews-submit.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/reviews/wcfmmp-controller-reviews-submit.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/controllers/reviews/wcfmmp-controller-reviews.php](/browser/wc-multivendor-marketplace/tags/3.6.3/controllers/reviews/wcfmmp-controller-reviews.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core](/browser/wc-multivendor-marketplace/tags/3.6.3/core?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-abstract-gateway.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-abstract-gateway.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-admin.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-admin.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-ajax.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-ajax.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-commission.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-commission.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-emails.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-emails.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-frontend.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-frontend.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-gateways.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-gateways.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-ledger.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-ledger.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-library.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-library.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-media.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-media.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-non-ajax.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-non-ajax.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-notification-manager.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-notification-manager.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-product-multivendor.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-product-multivendor.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-product.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-product.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-refund.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-refund.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-reviews.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-reviews.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-rewrite.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-rewrite.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-settings.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-settings.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-shipping-gateway.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-shipping-gateway.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-shipping-zone.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-shipping-zone.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-shipping.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-shipping.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-shortcode.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-shortcode.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-sidebar-widgets.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-sidebar-widgets.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-store-hours.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-store-hours.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-store-seo.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-store-seo.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-store.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-store.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-template.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-template.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-vendor.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-vendor.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp-withdraw.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp-withdraw.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/core/class-wcfmmp.php](/browser/wc-multivendor-marketplace/tags/3.6.3/core/class-wcfmmp.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers/class-wcfmmp-dependencies.php](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers/class-wcfmmp-dependencies.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers/class-wcfmmp-install.php](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers/class-wcfmmp-install.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers/class-wcfmmp-setup.php](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers/class-wcfmmp-setup.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers/class-wcfmmp-store-setup.php](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers/class-wcfmmp-store-setup.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers/class-wcfmmp-uninstall.php](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers/class-wcfmmp-uninstall.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/helpers/wcfmmp-core-functions.php](/browser/wc-multivendor-marketplace/tags/3.6.3/helpers/wcfmmp-core-functions.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes](/browser/wc-multivendor-marketplace/tags/3.6.3/includes?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/CHANGELOG.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/CHANGELOG.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/CODE\_OF\_CONDUCT.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/CODE_OF_CONDUCT.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/LICENSE](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/LICENSE?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/Makefile](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/Makefile?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/OPENAPI\_VERSION](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/OPENAPI_VERSION?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/README.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/README.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/VERSION](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/VERSION?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/build.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/build.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/composer.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/composer.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/data](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/data?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/data/ca-certificates.crt](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/data/ca-certificates.crt?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/init.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/init.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Account.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Account.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/AccountLink.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/AccountLink.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/All.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/All.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/Create.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/Create.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/Delete.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/Delete.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/NestedResource.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/NestedResource.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/Request.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/Request.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/Retrieve.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/Retrieve.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/Search.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/Search.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/SingletonRetrieve.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/SingletonRetrieve.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiOperations/Update.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiOperations/Update.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiRequestor.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiRequestor.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiResource.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiResource.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApiResponse.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApiResponse.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApplePayDomain.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApplePayDomain.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApplicationFee.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApplicationFee.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ApplicationFeeRefund.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ApplicationFeeRefund.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Apps](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Apps?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Apps/Secret.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Apps/Secret.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Balance.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Balance.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BalanceTransaction.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BalanceTransaction.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BankAccount.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BankAccount.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BaseStripeClient.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BaseStripeClient.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BaseStripeClientInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BaseStripeClientInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BillingPortal](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BillingPortal?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BillingPortal/Configuration.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BillingPortal/Configuration.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/BillingPortal/Session.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/BillingPortal/Session.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Capability.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Capability.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Card.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Card.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/CashBalance.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/CashBalance.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Charge.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Charge.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Checkout](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Checkout?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Checkout/Session.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Checkout/Session.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Collection.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Collection.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/CountrySpec.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/CountrySpec.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Coupon.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Coupon.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/CreditNote.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/CreditNote.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/CreditNoteLineItem.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/CreditNoteLineItem.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Customer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Customer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/CustomerBalanceTransaction.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/CustomerBalanceTransaction.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/CustomerCashBalanceTransaction.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/CustomerCashBalanceTransaction.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Discount.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Discount.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Dispute.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Dispute.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/EphemeralKey.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/EphemeralKey.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ErrorObject.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ErrorObject.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Event.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Event.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/ApiConnectionException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/ApiConnectionException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/ApiErrorException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/ApiErrorException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/AuthenticationException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/AuthenticationException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/BadMethodCallException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/BadMethodCallException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/CardException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/CardException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/ExceptionInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/ExceptionInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/IdempotencyException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/IdempotencyException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/InvalidArgumentException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/InvalidArgumentException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/InvalidRequestException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/InvalidRequestException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/ExceptionInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/ExceptionInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidClientException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidClientException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidGrantException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidGrantException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidRequestException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidRequestException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidScopeException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/InvalidScopeException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/OAuthErrorException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/OAuthErrorException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/UnknownOAuthErrorException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/UnknownOAuthErrorException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/UnsupportedGrantTypeException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/UnsupportedGrantTypeException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/OAuth/UnsupportedResponseTypeException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/OAuth/UnsupportedResponseTypeException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/PermissionException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/PermissionException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/RateLimitException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/RateLimitException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/SignatureVerificationException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/SignatureVerificationException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/UnexpectedValueException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/UnexpectedValueException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Exception/UnknownApiErrorException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Exception/UnknownApiErrorException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ExchangeRate.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ExchangeRate.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/File.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/File.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FileLink.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FileLink.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FinancialConnections](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FinancialConnections?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FinancialConnections/Account.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FinancialConnections/Account.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FinancialConnections/AccountOwner.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FinancialConnections/AccountOwner.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FinancialConnections/AccountOwnership.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FinancialConnections/AccountOwnership.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FinancialConnections/Session.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FinancialConnections/Session.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/FundingInstructions.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/FundingInstructions.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/HttpClient](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/HttpClient?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/HttpClient/ClientInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/HttpClient/ClientInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/HttpClient/CurlClient.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/HttpClient/CurlClient.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/HttpClient/StreamingClientInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/HttpClient/StreamingClientInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Identity](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Identity?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Identity/VerificationReport.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Identity/VerificationReport.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Identity/VerificationSession.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Identity/VerificationSession.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Invoice.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Invoice.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/InvoiceItem.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/InvoiceItem.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/InvoiceLineItem.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/InvoiceLineItem.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing/Authorization.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing/Authorization.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing/Card.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing/Card.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing/CardDetails.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing/CardDetails.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing/Cardholder.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing/Cardholder.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing/Dispute.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing/Dispute.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Issuing/Transaction.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Issuing/Transaction.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/LineItem.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/LineItem.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/LoginLink.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/LoginLink.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Mandate.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Mandate.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/OAuth.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/OAuth.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/OAuthErrorObject.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/OAuthErrorObject.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/PaymentIntent.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/PaymentIntent.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/PaymentLink.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/PaymentLink.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/PaymentMethod.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/PaymentMethod.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Payout.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Payout.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Person.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Person.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Plan.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Plan.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Price.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Price.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Product.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Product.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/PromotionCode.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/PromotionCode.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Quote.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Quote.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Radar](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Radar?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Radar/EarlyFraudWarning.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Radar/EarlyFraudWarning.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Radar/ValueList.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Radar/ValueList.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Radar/ValueListItem.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Radar/ValueListItem.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/RecipientTransfer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/RecipientTransfer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Refund.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Refund.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Reporting](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Reporting?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Reporting/ReportRun.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Reporting/ReportRun.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Reporting/ReportType.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Reporting/ReportType.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/RequestTelemetry.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/RequestTelemetry.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Review.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Review.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SearchResult.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SearchResult.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/AbstractService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/AbstractService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/AbstractServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/AbstractServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/AccountLinkService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/AccountLinkService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/AccountService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/AccountService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ApplePayDomainService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ApplePayDomainService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ApplicationFeeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ApplicationFeeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Apps](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Apps?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Apps/AppsServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Apps/AppsServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Apps/SecretService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Apps/SecretService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/BalanceService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/BalanceService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/BalanceTransactionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/BalanceTransactionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/BillingPortal](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/BillingPortal?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/BillingPortal/BillingPortalServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/BillingPortal/BillingPortalServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/BillingPortal/ConfigurationService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/BillingPortal/ConfigurationService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/BillingPortal/SessionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/BillingPortal/SessionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ChargeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ChargeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Checkout](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Checkout?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Checkout/CheckoutServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Checkout/CheckoutServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Checkout/SessionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Checkout/SessionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/CoreServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/CoreServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/CountrySpecService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/CountrySpecService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/CouponService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/CouponService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/CreditNoteService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/CreditNoteService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/CustomerService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/CustomerService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/DisputeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/DisputeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/EphemeralKeyService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/EphemeralKeyService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/EventService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/EventService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ExchangeRateService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ExchangeRateService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/FileLinkService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/FileLinkService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/FileService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/FileService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections/AccountService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections/AccountService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections/FinancialConnectionsServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections/FinancialConnectionsServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections/SessionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/FinancialConnections/SessionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Identity](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Identity?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Identity/IdentityServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Identity/IdentityServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Identity/VerificationReportService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Identity/VerificationReportService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Identity/VerificationSessionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Identity/VerificationSessionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/InvoiceItemService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/InvoiceItemService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/InvoiceService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/InvoiceService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing/AuthorizationService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing/AuthorizationService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing/CardService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing/CardService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing/CardholderService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing/CardholderService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing/DisputeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing/DisputeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing/IssuingServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing/IssuingServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Issuing/TransactionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Issuing/TransactionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/MandateService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/MandateService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/OAuthService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/OAuthService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PaymentIntentService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PaymentIntentService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PaymentLinkService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PaymentLinkService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PaymentMethodService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PaymentMethodService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PayoutService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PayoutService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PlanService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PlanService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PriceService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PriceService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ProductService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ProductService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/PromotionCodeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/PromotionCodeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/QuoteService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/QuoteService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Radar](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Radar?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Radar/EarlyFraudWarningService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Radar/EarlyFraudWarningService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Radar/RadarServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Radar/RadarServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Radar/ValueListItemService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Radar/ValueListItemService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Radar/ValueListService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Radar/ValueListService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/RefundService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/RefundService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Reporting](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Reporting?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Reporting/ReportRunService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Reporting/ReportRunService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Reporting/ReportTypeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Reporting/ReportTypeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Reporting/ReportingServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Reporting/ReportingServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ReviewService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ReviewService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/SetupAttemptService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/SetupAttemptService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/SetupIntentService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/SetupIntentService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/ShippingRateService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/ShippingRateService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Sigma](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Sigma?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Sigma/ScheduledQueryRunService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Sigma/ScheduledQueryRunService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Sigma/SigmaServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Sigma/SigmaServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/SourceService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/SourceService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/SubscriptionItemService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/SubscriptionItemService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/SubscriptionScheduleService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/SubscriptionScheduleService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/SubscriptionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/SubscriptionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TaxCodeService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TaxCodeService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TaxRateService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TaxRateService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Terminal](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Terminal?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Terminal/ConfigurationService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Terminal/ConfigurationService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Terminal/ConnectionTokenService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Terminal/ConnectionTokenService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Terminal/LocationService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Terminal/LocationService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Terminal/ReaderService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Terminal/ReaderService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Terminal/TerminalServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Terminal/TerminalServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/CustomerService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/CustomerService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Issuing](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Issuing?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Issuing/CardService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Issuing/CardService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Issuing/IssuingServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Issuing/IssuingServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/RefundService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/RefundService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Terminal](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Terminal?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Terminal/ReaderService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Terminal/ReaderService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Terminal/TerminalServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Terminal/TerminalServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/TestClockService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/TestClockService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/TestHelpersServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/TestHelpersServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/InboundTransferService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/InboundTransferService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/OutboundPaymentService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/OutboundPaymentService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/OutboundTransferService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/OutboundTransferService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/ReceivedCreditService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/ReceivedCreditService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/ReceivedDebitService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/ReceivedDebitService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/TreasuryServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TestHelpers/Treasury/TreasuryServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TokenService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TokenService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TopupService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TopupService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/TransferService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/TransferService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/CreditReversalService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/CreditReversalService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/DebitReversalService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/DebitReversalService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/FinancialAccountService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/FinancialAccountService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/InboundTransferService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/InboundTransferService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/OutboundPaymentService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/OutboundPaymentService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/OutboundTransferService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/OutboundTransferService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/ReceivedCreditService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/ReceivedCreditService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/ReceivedDebitService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/ReceivedDebitService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/TransactionEntryService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/TransactionEntryService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/TransactionService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/TransactionService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/Treasury/TreasuryServiceFactory.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/Treasury/TreasuryServiceFactory.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Service/WebhookEndpointService.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Service/WebhookEndpointService.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SetupAttempt.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SetupAttempt.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SetupIntent.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SetupIntent.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/ShippingRate.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/ShippingRate.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Sigma](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Sigma?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Sigma/ScheduledQueryRun.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Sigma/ScheduledQueryRun.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SingletonApiResource.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SingletonApiResource.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Source.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Source.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SourceTransaction.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SourceTransaction.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Stripe.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Stripe.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/StripeClient.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/StripeClient.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/StripeClientInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/StripeClientInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/StripeObject.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/StripeObject.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/StripeStreamingClientInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/StripeStreamingClientInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Subscription.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Subscription.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SubscriptionItem.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SubscriptionItem.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/SubscriptionSchedule.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/SubscriptionSchedule.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/TaxCode.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/TaxCode.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/TaxId.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/TaxId.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/TaxRate.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/TaxRate.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Terminal](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Terminal?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Terminal/Configuration.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Terminal/Configuration.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Terminal/ConnectionToken.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Terminal/ConnectionToken.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Terminal/Location.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Terminal/Location.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Terminal/Reader.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Terminal/Reader.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/TestHelpers](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/TestHelpers?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/TestHelpers/TestClock.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/TestHelpers/TestClock.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Token.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Token.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Topup.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Topup.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Transfer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Transfer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/TransferReversal.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/TransferReversal.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/CreditReversal.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/CreditReversal.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/DebitReversal.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/DebitReversal.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/FinancialAccount.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/FinancialAccount.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/FinancialAccountFeatures.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/FinancialAccountFeatures.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/InboundTransfer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/InboundTransfer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/OutboundPayment.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/OutboundPayment.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/OutboundTransfer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/OutboundTransfer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/ReceivedCredit.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/ReceivedCredit.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/ReceivedDebit.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/ReceivedDebit.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/Transaction.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/Transaction.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Treasury/TransactionEntry.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Treasury/TransactionEntry.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/UsageRecord.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/UsageRecord.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/UsageRecordSummary.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/UsageRecordSummary.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/ApiVersion.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/ApiVersion.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/CaseInsensitiveArray.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/CaseInsensitiveArray.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/DefaultLogger.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/DefaultLogger.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/LoggerInterface.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/LoggerInterface.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/ObjectTypes.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/ObjectTypes.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/RandomGenerator.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/RandomGenerator.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/RequestOptions.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/RequestOptions.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/Set.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/Set.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Util/Util.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Util/Util.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/Webhook.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/Webhook.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/WebhookEndpoint.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/WebhookEndpoint.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/lib/WebhookSignature.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/lib/WebhookSignature.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/phpdoc.dist.xml](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/phpdoc.dist.xml?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/phpstan-baseline.neon](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/phpstan-baseline.neon?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/phpstan.neon.dist](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/phpstan.neon.dist?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/stripe-util-functions.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/stripe-util-functions.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/Stripe/update\_certs.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/Stripe/update_certs.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-bank\_transfer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-bank_transfer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-by\_cash.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-by_cash.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-paypal.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-paypal.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-skrill.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-skrill.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-stripe.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-stripe.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-stripe\_split.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-wirecard.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/payment-gateways/class-wcfmmp-gateway-wirecard.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/shipping-gateways](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/shipping-gateways?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-country.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-country.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-distance.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-distance.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-weight.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-weight.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/sms-gateways](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/sms-gateways?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/sms-gateways/class-wcfmmp-twilio-sms-notification.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/sms-gateways/class-wcfmmp-twilio-sms-notification.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-emails](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-emails?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-emails/class-wcfmmp-email-store-new-order.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-emails/class-wcfmmp-email-store-new-order.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-products-search-by-vendors.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-products-search-by-vendors.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-best-selling-vendors.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-best-selling-vendors.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-category.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-category.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-coupons.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-coupons.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-featured-products.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-featured-products.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-hours.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-hours.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-info.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-info.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-category-filter.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-category-filter.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-location-filter.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-location-filter.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-meta-filter.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-meta-filter.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-radius-filter.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-radius-filter.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-search.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-lists-search.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-location.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-location.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-on-sale-products.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-on-sale-products.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-product-search.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-product-search.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-recent-articles.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-recent-articles.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-recent-products.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-recent-products.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-shipping-rules.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-shipping-rules.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-taxonomy.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-taxonomy.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-top-products.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-top-products.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-top-rated-products.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-top-rated-products.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-top-rated-vendors.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/store-widgets/class-wcfmmp-widget-store-top-rated-vendors.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wcfm-stripe](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wcfm-stripe?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-api.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-api.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-customer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-customer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-helper.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-intent-controller.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-intent-controller.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-order-handler.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wcfm-stripe/class-wcfm-stripe-order-handler.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/composer.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/composer.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/composer.lock](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/composer.lock?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/autoload.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/autoload.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/ClassLoader.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/ClassLoader.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/LICENSE](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/LICENSE?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/autoload\_classmap.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/autoload_classmap.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/autoload\_files.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/autoload_files.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/autoload\_namespaces.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/autoload_namespaces.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/autoload\_psr4.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/autoload_psr4.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/autoload\_real.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/autoload_real.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/autoload\_static.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/autoload_static.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/composer/installed.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/composer/installed.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/CHANGELOG.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/CHANGELOG.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/CONTRIBUTING.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/CONTRIBUTING.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/LICENSE](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/LICENSE?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/circle.yml](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/circle.yml?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/composer.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/composer.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/phpunit.xml](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/phpunit.xml?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth/BasicAuth.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth/BasicAuth.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth/Connect.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth/Connect.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth/OAuth.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Auth/OAuth.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Contracts](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Contracts?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Contracts/Authentication.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Contracts/Authentication.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/Error.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/Error.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/InvalidArgumentException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/InvalidArgumentException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/UnautorizedException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/UnautorizedException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/UnexpectedException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/UnexpectedException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/ValidationException.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Exceptions/ValidationException.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Filters.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Filters.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Links.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Links.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Pagination.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Pagination.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Utils.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/Utils.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/helpers.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Helper/helpers.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Moip.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Moip.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Account.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Account.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Balances.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Balances.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/BankAccount.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/BankAccount.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/BankAccountList.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/BankAccountList.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Customer.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Customer.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/CustomerCreditCard.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/CustomerCreditCard.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Entry.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Entry.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Escrow.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Escrow.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Event.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Event.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Holder.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Holder.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Keys.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Keys.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/MoipResource.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/MoipResource.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Multiorders.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Multiorders.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/NotificationPreferences.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/NotificationPreferences.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/NotificationPreferencesList.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/NotificationPreferencesList.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Orders.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Orders.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/OrdersList.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/OrdersList.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Payment.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Payment.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Refund.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Refund.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Transfers.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Transfers.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/TransfersList.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/TransfersList.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Webhook.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/Webhook.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/WebhookList.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/src/Resource/WebhookList.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Helper](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Helper?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Helper/FiltersTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Helper/FiltersTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Helper/LinksTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Helper/LinksTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/MoipTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/MoipTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/AccountTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/AccountTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/BalancesTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/BalancesTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/BankAccountListTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/BankAccountListTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/BankAccountTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/BankAccountTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/CustomerTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/CustomerTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/EscrowTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/EscrowTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/KeyTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/KeyTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/MoipResourceTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/MoipResourceTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/NotificationPreferencesListTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/NotificationPreferencesListTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/NotificationPreferencesTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/NotificationPreferencesTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/OrdersListTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/OrdersListTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/OrdersTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/OrdersTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/PaymentTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/PaymentTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/RefundTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/RefundTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/TransfersListTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/TransfersListTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/TransfersTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/TransfersTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/WebhookListTest.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/Resource/WebhookListTest.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/TestCase.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/TestCase.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/account](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/account?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/account/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/account/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/account/get.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/account/get.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/balances](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/balances?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/balances/get.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/balances/get.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank\_account](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank_account?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank\_account/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank_account/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank\_account/list.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank_account/list.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank\_account/update.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/bank_account/update.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/customer](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/customer?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/customer/add\_credit\_card.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/customer/add_credit_card.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/customer/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/customer/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/escrow](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/escrow?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/escrow/release.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/escrow/release.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/keys](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/keys?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/keys/get.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/keys/get.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multiorder](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multiorder?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multiorder/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multiorder/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/cancel\_pre\_authorized.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/cancel_pre_authorized.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/capture.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/capture.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/create\_billet.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/create_billet.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/create\_cc.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/create_cc.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/get.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/multipayment/get.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/notification](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/notification?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/notification/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/notification/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/notification/list.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/notification/list.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/order](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/order?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/order/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/order/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/order/get\_list.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/order/get_list.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/cancel\_pre\_authorized.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/cancel_pre_authorized.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/capture.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/capture.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create\_billet.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create_billet.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create\_cc\_delay\_capture.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create_cc_delay_capture.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create\_cc\_pci.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create_cc_pci.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create\_cc\_pci\_escrow.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create_cc_pci_escrow.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create\_cc\_pci\_store.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/create_cc_pci_store.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/get.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/payment/get.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order\_full\_bankaccount.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order_full_bankaccount.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order\_full\_cc.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order_full_cc.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order\_partial\_bankaccount.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order_partial_bankaccount.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order\_partial\_cc.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/order_partial_cc.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment\_full\_bankaccount.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment_full_bankaccount.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment\_full\_cc.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment_full_cc.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment\_partial\_bankaccount.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment_partial_bankaccount.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment\_partial\_cc.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/refund/payment_partial_cc.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers/create.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers/create.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers/list.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers/list.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers/revert.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/transfers/revert.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks/get\_all\_filters.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks/get_all_filters.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks/get\_no\_filter.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks/get_no_filter.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks/get\_pagination.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/moip/moip-sdk-php/tests/jsons/webhooks/get_pagination.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/CHANGELOG.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/CHANGELOG.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/LICENSE](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/LICENSE?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/bin](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/bin?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/bin/create\_pear\_package.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/bin/create_pear_package.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/composer.json](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/composer.json?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/authentication-custom.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/authentication-custom.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/authentication.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/authentication.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/goals.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/goals.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/hooks.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/hooks.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/proxy.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/proxy.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/usage-advanced.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/usage-advanced.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/usage.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/usage.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/why-requests.md](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/docs/why-requests.md?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/basic-auth.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/basic-auth.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/cookie.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/cookie.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/cookie\_jar.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/cookie_jar.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/get.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/get.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/multiple.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/multiple.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/post.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/post.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/proxy.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/proxy.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/session.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/session.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/timeout.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/examples/timeout.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Auth](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Auth?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Auth.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Auth.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Auth/Basic.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Auth/Basic.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Cookie](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Cookie?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Cookie.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Cookie.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Cookie/Jar.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Cookie/Jar.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/304.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/304.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/305.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/305.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/306.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/306.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/400.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/400.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/401.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/401.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/402.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/402.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/403.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/403.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/404.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/404.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/405.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/405.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/406.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/406.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/407.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/407.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/408.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/408.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/409.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/409.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/410.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/410.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/411.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/411.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/412.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/412.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/413.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/413.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/414.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/414.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/415.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/415.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/416.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/416.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/417.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/417.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/418.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/418.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/428.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/428.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/429.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/429.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/431.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/431.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/500.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/500.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/501.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/501.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/502.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/502.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/503.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/503.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/504.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/504.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/505.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/505.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/511.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/511.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/Unknown.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/HTTP/Unknown.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/Transport](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/Transport?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/Transport.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/Transport.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/Transport/cURL.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Exception/Transport/cURL.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Hooker.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Hooker.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Hooks.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Hooks.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/IDNAEncoder.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/IDNAEncoder.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/IPv6.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/IPv6.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/IRI.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/IRI.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Proxy](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Proxy?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Proxy.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Proxy.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Proxy/HTTP.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Proxy/HTTP.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Response](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Response?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Response.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Response.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Response/Headers.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Response/Headers.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/SSL.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/SSL.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Session.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Session.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport/cURL.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport/cURL.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport/cacert.pem](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport/cacert.pem?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport/fsockopen.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Transport/fsockopen.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Utility](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Utility?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Utility/CaseInsensitiveDictionary.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Utility/CaseInsensitiveDictionary.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Utility/FilteredIterator.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/library/Requests/Utility/FilteredIterator.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/package.xml.tpl](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/package.xml.tpl?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Auth](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Auth?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Auth/Basic.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Auth/Basic.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/ChunkedEncoding.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/ChunkedEncoding.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Cookies.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Cookies.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Encoding.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Encoding.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/IDNAEncoder.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/IDNAEncoder.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/IRI.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/IRI.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Proxy](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Proxy?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Proxy/HTTP.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Proxy/HTTP.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Requests.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Requests.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Response](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Response?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Response/Headers.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Response/Headers.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/SSL.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/SSL.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Session.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Session.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport/Base.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport/Base.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport/cURL.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport/cURL.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport/fsockopen.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/Transport/fsockopen.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/bootstrap.php](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/bootstrap.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/phpunit.xml.dist](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/phpunit.xml.dist?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy/proxy.py](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy/proxy.py?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy/start.sh](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy/start.sh?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy/stop.sh](/browser/wc-multivendor-marketplace/tags/3.6.3/includes/wirecard/vendor/rmccue/requests/tests/utils/proxy/stop.sh?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang](/browser/wc-multivendor-marketplace/tags/3.6.3/lang?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-de\_DE.mo](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-de_DE.mo?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-de\_DE.po](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-de_DE.po?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-fr\_FR.mo](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-fr_FR.mo?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-fr\_FR.po](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-fr_FR.po?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-ru\_RU.mo](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-ru_RU.mo?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-ru\_RU.po](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-ru_RU.po?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-zh\_CN.mo](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-zh_CN.mo?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-zh\_CN.po](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-zh_CN.po?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-zh\_TW.mo](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-zh_TW.mo?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace-zh\_TW.po](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace-zh_TW.po?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/lang/wc-multivendor-marketplace.pot](/browser/wc-multivendor-marketplace/tags/3.6.3/lang/wc-multivendor-marketplace.pot?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/readme.txt](/browser/wc-multivendor-marketplace/tags/3.6.3/readme.txt?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views](/browser/wc-multivendor-marketplace/tags/3.6.3/views?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/emails](/browser/wc-multivendor-marketplace/tags/3.6.3/views/emails?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/emails/plain](/browser/wc-multivendor-marketplace/tags/3.6.3/views/emails/plain?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/emails/plain/store-new-order.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/emails/plain/store-new-order.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/emails/store-new-order.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/emails/store-new-order.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/ledger](/browser/wc-multivendor-marketplace/tags/3.6.3/views/ledger?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/ledger/wcfmmp-view-ledger.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/ledger/wcfmmp-view-ledger.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/media](/browser/wc-multivendor-marketplace/tags/3.6.3/views/media?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/media/wcfmmp-view-media.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/media/wcfmmp-view-media.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product-geolocate](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product-geolocate?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product-geolocate/wcfmmp-view-product-lists-map.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product-geolocate/wcfmmp-view-product-lists-search-form.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product-geolocate/wcfmmp-view-product-lists-search-form.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product-geolocate/wcfmmp-view-product-lists-vendor-filter.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product-geolocate/wcfmmp-view-product-lists-vendor-filter.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product\_multivendor](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product_multivendor?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product\_multivendor/wcfmmp-view-more-offer-single.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product_multivendor/wcfmmp-view-more-offer-single.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product\_multivendor/wcfmmp-view-more-offers-loop.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product_multivendor/wcfmmp-view-more-offers-loop.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product\_multivendor/wcfmmp-view-more-offers.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product_multivendor/wcfmmp-view-more-offers.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/product\_multivendor/wcfmmp-view-sell-items-catalog.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/product_multivendor/wcfmmp-view-sell-items-catalog.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/refund](/browser/wc-multivendor-marketplace/tags/3.6.3/views/refund?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/refund/wcfmmp-view-refund-requests-popup.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/refund/wcfmmp-view-refund-requests-popup.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/refund/wcfmmp-view-refund-requests.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/refund/wcfmmp-view-refund-requests.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-product-reviews.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-product-reviews.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-category-ratings.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-category-ratings.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-latest-review.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-latest-review.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-latest-stat.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-latest-stat.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-manage.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-manage.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-new.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-new.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-pagination.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-pagination.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews-ratings.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews-ratings.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/reviews/wcfmmp-view-reviews.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/reviews/wcfmmp-view-reviews.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/shipping](/browser/wc-multivendor-marketplace/tags/3.6.3/views/shipping?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/shipping/wcfmmp-view-add-method-popup.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/shipping/wcfmmp-view-add-method-popup.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/shipping/wcfmmp-view-edit-method-popup.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/shipping/wcfmmp-view-edit-method-popup.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/shipping/wcfmmp-view-shipping-info.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/shipping/wcfmmp-view-shipping-info.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/shipping/wcfmmp-view-shipping-settings.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/shipping/wcfmmp-view-shipping-settings.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/sold-by](/browser/wc-multivendor-marketplace/tags/3.6.3/views/sold-by?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/sold-by/wcfmmp-view-sold-by-advanced.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/sold-by/wcfmmp-view-sold-by-advanced.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/sold-by/wcfmmp-view-sold-by-simple.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/sold-by/wcfmmp-view-sold-by-simple.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/sold-by/wcfmmp-view-sold-by-tab.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/sold-by/wcfmmp-view-sold-by-tab.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-card.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-card.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-carousel.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-carousel.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-loop.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-loop.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-map.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-map.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-orderby.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-orderby.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-pagination.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-pagination.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-search-form.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-search-form.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-sidebar.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists-sidebar.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store-lists/wcfmmp-view-store-lists.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store-lists/wcfmmp-view-store-lists.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/legacy](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/legacy?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/legacy/wcfmmp-view-store-header.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/legacy/wcfmmp-view-store-header.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-about.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-about.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-articles.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-articles.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-banner.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-banner.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-followers.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-followers.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-followings.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-followings.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-header.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-header.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-policies.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-policies.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-products.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-products.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-reviews.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-reviews.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-sidebar.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-sidebar.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-social.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-social.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store-tabs.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store-tabs.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/wcfmmp-view-store.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/wcfmmp-view-store.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-best-selling-vendors.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-best-selling-vendors.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-store-category.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-store-category.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-store-hours.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-store-hours.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-store-location.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-store-location.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-store-product-search.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-store-product-search.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-store-shipping-rules.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-store-shipping-rules.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-store-taxonomy.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-store-taxonomy.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/views/store/widgets/wcfmmp-view-top-rated-vendors.php](/browser/wc-multivendor-marketplace/tags/3.6.3/views/store/widgets/wcfmmp-view-top-rated-vendors.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/wc-multivendor-marketplace-config.php](/browser/wc-multivendor-marketplace/tags/3.6.3/wc-multivendor-marketplace-config.php?rev=3000763 "Show entry in browser")
  (added)
* [tags/3.6.3/wc-multivendor-marketplace.php](/browser/wc-multivendor-marketplace/tags/3.6.3/wc-multivendor-marketplace.php?rev=3000763 "Show entry in browser")
  (added)
* [trunk/assets/js/wcfmmp-script-settings.js](/browser/wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js?rev=3000763 "Show entry in browser")
  (modified)
  ([2 diffs](#file980 "Show differences"))
* [trunk/core/class-wcfmmp-admin.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php?rev=3000763 "Show entry in browser")
  (modified)
  ([2 diffs](#file981 "Show differences"))
* [trunk/core/class-wcfmmp-ajax.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php?rev=3000763 "Show entry in browser")
  (modified)
  ([2 diffs](#file982 "Show differences"))
* [trunk/core/class-wcfmmp-commission.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763 "Show entry in browser")
  (modified)
  ([23 diffs](#file983 "Show differences"))
* [trunk/core/class-wcfmmp-frontend.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=3000763 "Show entry in browser")
  (modified)
  ([3 diffs](#file984 "Show differences"))
* [trunk/core/class-wcfmmp-library.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php?rev=3000763 "Show entry in browser")
  (modified)
  ([2 diffs](#file985 "Show differences"))
* [trunk/core/class-wcfmmp-refund.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763 "Show entry in browser")
  (modified)
  ([6 diffs](#file986 "Show differences"))
* [trunk/core/class-wcfmmp-settings.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763 "Show entry in browser")
  (modified)
  ([26 diffs](#file987 "Show differences"))
* [trunk/core/class-wcfmmp-store.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-store.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file988 "Show differences"))
* [trunk/core/class-wcfmmp-withdraw.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php?rev=3000763 "Show entry in browser")
  (modified)
  ([2 diffs](#file989 "Show differences"))
* [trunk/core/class-wcfmmp.php](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763 "Show entry in browser")
  (modified)
  ([18 diffs](#file990 "Show differences"))
* [trunk/helpers/wcfmmp-core-functions.php](/browser/wc-multivendor-marketplace/trunk/helpers/wcfmmp-core-functions.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file991 "Show differences"))
* [trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file992 "Show differences"))
* [trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe\_split.php](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=3000763 "Show entry in browser")
  (modified)
  ([3 diffs](#file993 "Show differences"))
* [trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php](/browser/wc-multivendor-marketplace/trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file994 "Show differences"))
* [trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763 "Show entry in browser")
  (modified)
  ([6 diffs](#file995 "Show differences"))
* [trunk/readme.txt](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=3000763 "Show entry in browser")
  (modified)
  ([3 diffs](#file996 "Show differences"))
* [trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=3000763 "Show entry in browser")
  (modified)
  ([3 diffs](#file997 "Show differences"))
* [trunk/views/store-lists/wcfmmp-view-store-lists-map.php](/browser/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists-map.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file998 "Show differences"))
* [trunk/views/store-lists/wcfmmp-view-store-lists.php](/browser/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file999 "Show differences"))
* [trunk/wc-multivendor-marketplace-config.php](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace-config.php?rev=3000763 "Show entry in browser")
  (modified)
  ([1 diff](#file1000 "Show differences"))
* [trunk/wc-multivendor-marketplace.php](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=3000763 "Show entry in browser")
  (modified)
  ([3 diffs](#file1001 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js](/changeset/3000763/wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js")

  | [r2887030](/browser/wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js?rev=2887030#L57 "Show revision 2887030 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js?rev=3000763#L57 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 57 | 57 | $payment\_option = $(this).val(); |
  | 58 | 58 |  |
  | 59 |  | if( ['stripe', 'stripe\_split'].includes( $payment\_option ) ) { |
  | 60 |  | if( $( '.payment\_options[value^="stripe"]:checked' ).length > 0 ) { |
  | 61 |  | $('.withdrawal\_mode\_'+$payment\_option).removeClass('wcfm\_ele\_hide'); |
  |  | 59 | if( $(this).is(':checked') ) { |
  |  | 60 | $('.withdrawal\_mode\_'+$payment\_option).removeClass('wcfm\_ele\_hide'); |
  |  | 61 | } else { |
  |  | 62 | // if the unchecked checkbox is stripe/stripe\_split |
  |  | 63 | if( ['stripe', 'stripe\_split'].includes( $payment\_option ) ) { |
  |  | 64 | // if any of the stripe/stripe\_split chekbox is active |
  |  | 65 | if( $( '.payment\_options[value^="stripe"]:checked' ).length > 0 ) { |
  |  | 66 | if ('stripe\_split' === $payment\_option) { |
  |  | 67 | // hide all stripe\_split inputs except stripe inputs |
  |  | 68 | $('.withdrawal\_mode\_stripe\_split:not(.withdrawal\_mode\_stripe)').addClass('wcfm\_ele\_hide'); |
  |  | 69 | } else if ('stripe' === $payment\_option) { |
  |  | 70 | // hide all stripe inputs except stripe\_split inputs |
  |  | 71 | $('.withdrawal\_mode\_stripe:not(.withdrawal\_mode\_stripe\_split)').addClass('wcfm\_ele\_hide'); |
  |  | 72 | } |
  |  | 73 | } else { |
  |  | 74 | $('.withdrawal\_mode\_'+$payment\_option).addClass('wcfm\_ele\_hide'); |
  |  | 75 | } |
  | 62 | 76 | } else { |
  | 63 | 77 | $('.withdrawal\_mode\_'+$payment\_option).addClass('wcfm\_ele\_hide'); |
  | 64 | 78 | } |
  |  | 79 | } |
  |  | 80 |  |
  |  | 81 | // hides Enable test mode if no payment method selected |
  |  | 82 | if ($('#withdrawal\_payment\_methods .payment\_options:checked').length > 0) { |
  |  | 83 | $('#withdrawal\_test\_mode, .withdrawal\_test\_mode').removeClass('wcfm\_ele\_hide'); |
  | 65 | 84 | } else { |
  | 66 |  | if( $(this).is(':checked') ) { |
  | 67 |  | $('.withdrawal\_mode\_'+$payment\_option).removeClass('wcfm\_ele\_hide'); |
  | 68 |  | } else { |
  | 69 |  | $('.withdrawal\_mode\_'+$payment\_option).addClass('wcfm\_ele\_hide'); |
  | 70 |  | } |
  |  | 85 | $('#withdrawal\_test\_mode, .withdrawal\_test\_mode').addClass('wcfm\_ele\_hide'); |
  | 71 | 86 | } |
  | 72 | 87 | }).change(); |
  | […](/browser/wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js?rev=2887030#L133) | […](/browser/wc-multivendor-marketplace/trunk/assets/js/wcfmmp-script-settings.js?rev=3000763#L148) |  |
  | 133 | 148 | $(this).change(function() { |
  | 134 | 149 | $payment\_option = $(this).val(); |
  | 135 |  |  |
  | 136 |  | if( ['stripe', 'stripe\_split'].includes( $payment\_option ) ) { |
  | 137 |  | if( $( '.payment\_options[value^="stripe"]:checked' ).length > 0 ) { |
  | 138 |  | $('.withdraw\_charge\_'+$payment\_option).removeClass('wcfm\_ele\_hide'); |
  | 139 |  | } else { |
  | 140 |  | $('.withdraw\_charge\_'+$payment\_option).addClass('wcfm\_ele\_hide'); |
  | 141 |  | } |
  |  | 150 | if( $(this).is(':checked') ) { |
  |  | 151 | $('.withdraw\_charge\_'+$payment\_option).removeClass('wcfm\_ele\_hide'); |
  | 142 | 152 | } else { |
  | 143 |  | if( $(this).is(':checked') ) { |
  | 144 |  | $('.withdraw\_charge\_'+$payment\_option).removeClass('wcfm\_ele\_hide'); |
  | 145 |  | } else { |
  | 146 |  | $('.withdraw\_charge\_'+$payment\_option).addClass('wcfm\_ele\_hide'); |
  | 147 |  | } |
  |  | 153 | $('.withdraw\_charge\_'+$payment\_option).addClass('wcfm\_ele\_hide'); |
  | 148 | 154 | } |
  | 149 | 155 | }).change(); |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php")

  | [r2710458](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php?rev=2710458#L215 "Show revision 2710458 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php?rev=3000763#L215 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 215 | 215 | } |
  | 216 | 216 | } |
  | 217 |  |  |
  | 218 |  | ~~function wcfmmp\_store\_shop\_order\_custom\_column( $column, $order\_id~~ ) { |
  | 219 |  | global $WCFM, $WCFMmp; |
  | 220 |  |  |
  | 221 |  | ~~switch ( $column~~ ) { |
  | 222 |  | case 'wcfm\_vendor': |
  |  | 217 |  |
  |  | 218 | function wcfmmp\_store\_shop\_order\_custom\_column($column, $order\_id) { |
  |  | 219 | global $WCFM, $WCFMmp; |
  |  | 220 |  |
  |  | 221 | switch ($column) { |
  |  | 222 | case 'wcfm\_vendor': |
  | 223 | 223 | $vendor\_name = ''; |
  | 224 | 224 | $processed\_vendors = array(); |
  | 225 |  | if~~( function\_exists( 'wcfm\_get\_vendor\_store\_by\_post' )~~ ) { |
  | 226 |  | $order = wc\_get\_order(~~$order\_id~~ ); |
  | 227 |  | if~~( is\_a( $order , 'WC\_Order' )~~ ) { |
  | 228 |  | $items = $order->get\_items(~~'line\_item'~~ ); |
  | 229 |  | if~~( !empty( $items )~~ ) { |
  | 230 |  | foreach~~( $items as $order\_item\_id => $item~~ ) { |
  | 231 |  | $line\_item = new WC\_Order\_Item\_Product(~~$item~~ ); |
  |  | 225 | if (function\_exists('wcfm\_get\_vendor\_store\_by\_post')) { |
  |  | 226 | $order = wc\_get\_order($order\_id); |
  |  | 227 | if (is\_a($order, 'WC\_Order')) { |
  |  | 228 | $items = $order->get\_items('line\_item'); |
  |  | 229 | if (!empty($items)) { |
  |  | 230 | foreach ($items as $order\_item\_id => $item) { |
  |  | 231 | $line\_item = new WC\_Order\_Item\_Product($item); |
  | 232 | 232 | $product  = $line\_item->get\_product(); |
  | 233 | 233 | $product\_id = $line\_item->get\_product\_id(); |
  | 234 |  | $vendor\_id  = wcfm\_get\_vendor\_id\_by\_post(~~$product\_id~~ ); |
  | 235 |  |  |
  | 236 |  | if~~( !$vendor\_id~~ ) continue; |
  | 237 |  | if~~( in\_array( $vendor\_id, $processed\_vendors )~~ ) continue; |
  | 238 |  |  |
  | 239 |  | $store\_name = wcfm\_get\_vendor\_store(~~$vendor\_id~~ ); |
  | 240 |  | if~~( $store\_name~~ ) { |
  | 241 |  | if~~( $vendor\_name~~ ) $vendor\_name .= "<br />"; |
  |  | 234 | $vendor\_id  = wcfm\_get\_vendor\_id\_by\_post($product\_id); |
  |  | 235 |  |
  |  | 236 | if (!$vendor\_id) continue; |
  |  | 237 | if (in\_array($vendor\_id, $processed\_vendors)) continue; |
  |  | 238 |  |
  |  | 239 | $store\_name = wcfm\_get\_vendor\_store($vendor\_id); |
  |  | 240 | if ($store\_name) { |
  |  | 241 | if ($vendor\_name) $vendor\_name .= "<br />"; |
  | 242 | 242 | $vendor\_name .= '<span class="dashicons dashicons-businessperson"></span>' . $store\_name; |
  | 243 | 243 | $processed\_vendors[$vendor\_id] = $vendor\_id; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php?rev=2710458#L247) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-admin.php?rev=3000763#L247) |  |
  | 247 | 247 | } |
  | 248 | 248 | } |
  | 249 |  |  |
  | 250 |  | if( !$vendor\_name ) { $vendor\_name = '&ndash;'; } |
  | 251 |  |  |
  |  | 249 |  |
  |  | 250 | if (!$vendor\_name) { |
  |  | 251 | $vendor\_name = '&ndash;'; |
  |  | 252 | } |
  |  | 253 |  |
  | 252 | 254 | echo wp\_kses\_post($vendor\_name); |
  | 253 |  | break; |
  | 254 |  | } |
  | 255 |  | } |
  |  | 255 | break; |
  |  | 256 | } |
  |  | 257 | } |
  | 256 | 258 |  |
  | 257 | 259 | function wcfmmp\_store\_shop\_subscription\_custom\_column( $column, $subscription\_id ) { |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php")

  | [r2894888](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php?rev=2894888#L1 "Show revision 2894888 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php?rev=3000763#L1 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  | 2 | 3 | /\*\* |
  | 3 | 4 | \* WCFM Markeplace plugin core |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php?rev=2894888#L9) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-ajax.php?rev=3000763#L10) |  |
  | 9 | 10 | \* @version   1.0.0 |
  | 10 | 11 | \*/ |
  | 11 |  |  |
  |  | 12 |  |
  | 12 | 13 | class WCFMmp\_Ajax { |
  | 13 |  |  |
  | 14 |  | public $controllers\_path; |
  | 15 |  |  |
  | 16 |  | public function \_\_construct() { |
  | 17 |  | global $WCFM, $WCFMa; |
  | 18 |  |  |
  | 19 |  | // Vendor Order Status Update |
  | 20 |  | add\_action( 'before\_wcfm\_order\_status\_update', array( &$this, 'wcfmmp\_vendor\_order\_status\_update' ), 10, 2 ); |
  | 21 |  |  |
  | 22 |  | // Store List Search |
  | 23 |  | add\_action( 'wp\_ajax\_wcfmmp\_stores\_list\_search', array($this, 'wcfmmp\_stores\_list\_search') ); |
  | 24 |  | add\_action( 'wp\_ajax\_nopriv\_wcfmmp\_stores\_list\_search', array($this, 'wcfmmp\_stores\_list\_search') ); |
  | 25 |  |  |
  | 26 |  | // Store List Map markers |
  | 27 |  | add\_action( 'wp\_ajax\_wcfmmp\_stores\_list\_map\_markers', array($this, 'wcfmmp\_stores\_list\_map\_markers') ); |
  | 28 |  | add\_action( 'wp\_ajax\_nopriv\_wcfmmp\_stores\_list\_map\_markers', array($this, 'wcfmmp\_stores\_list\_map\_markers') ); |
  | 29 |  |  |
  | 30 |  | // Zone Shipping Ajax |
  | 31 |  | add\_action( 'wp\_ajax\_wcfmmp-get-shipping-zone', array( $this, 'wcfmmp\_get\_shipping\_zone' ) ); |
  | 32 |  | add\_action( 'wp\_ajax\_wcfmmp-add-shipping-method', array( $this, 'wcfmmp\_add\_shipping\_method' ) ); |
  | 33 |  | add\_action( 'wp\_ajax\_wcfmmp-toggle-shipping-method', array( $this, 'wcfmmp\_toggle\_shipping\_method' ) ); |
  | 34 |  | add\_action( 'wp\_ajax\_wcfmmp-delete-shipping-method', array( $this, 'wcfmmp\_delete\_shipping\_method' ) ); |
  | 35 |  | add\_action( 'wp\_ajax\_wcfmmp-update-shipping-method', array( $this, 'wcfmmp\_update\_shipping\_method' ) ); |
  | 36 |  |  |
  | 37 |  | add\_action( 'wp\_ajax\_wcfmmp-remove-cart-vendor-product', array( $this, 'wcfmmp\_remove\_cart\_vendor\_product' ) ); |
  | 38 |  | add\_action( 'wp\_ajax\_nopriv\_wcfmmp-remove-cart-vendor-product', array( $this, 'wcfmmp\_remove\_cart\_vendor\_product' ) ); |
  | 39 |  |  |
  | 40 |  | // Vendor Store Offline |
  | 41 |  | add\_action( 'wp\_ajax\_wcfm\_vendor\_store\_offline', array( &$this, 'wcfm\_vendor\_store\_offline' ) ); |
  | 42 |  |  |
  | 43 |  | // Vendor Store Online |
  | 44 |  | add\_action( 'wp\_ajax\_wcfm\_vendor\_store\_online', array( &$this, 'wcfm\_vendor\_store\_online' ) ); |
  | 45 |  | } |
  | 46 |  |  |
  | 47 |  | /\*\* |
  | 48 |  | \* Vendor Order - Commission Status Update |
  | 49 |  | \*/ |
  | 50 |  | function wcfmmp\_vendor\_order\_status\_update( $order\_id, $order\_status ) { |
  | 51 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 52 |  |  |
  | 53 |  | if( !wcfm\_is\_vendor() ) return; |
  | 54 |  |  |
  | 55 |  | if( !$order\_id ) { |
  | 56 |  | if( defined('WCFM\_REST\_API\_CALL') ) { |
  | 57 |  | return '{"status": false, "message": "' . esc\_html\_\_( 'No Order ID found.', 'wc-frontend-manager' ) . '"}'; |
  | 58 |  | } |
  | 59 |  | echo '{"status": false, "message": "' . esc\_html\_\_( 'No Order ID found.', 'wc-frontend-manager' ) . '"}'; |
  | 60 |  | die; |
  | 61 |  | } |
  | 62 |  |  |
  | 63 |  | if( $order\_status == 'wc-refunded' ) { |
  | 64 |  | if( defined('WCFM\_REST\_API\_CALL') ) { |
  | 65 |  | return '{"status": false, "message": "' . esc\_html\_\_( 'This status not allowed, please go through Refund Request.', 'wc-multivendor-marketplace' ) . '"}'; |
  | 66 |  | } |
  | 67 |  | echo '{"status": false, "message": "' . esc\_html\_\_( 'This status not allowed, please go through Refund Request.', 'wc-multivendor-marketplace' ) . '"}'; |
  | 68 |  | die; |
  | 69 |  | } |
  | 70 |  |  |
  | 71 |  | if( $order\_status == 'wc-shipped' ) { |
  | 72 |  | if( defined('WCFM\_REST\_API\_CALL') ) { |
  | 73 |  | return '{"status": false, "message": "' . esc\_html\_\_( 'This status not allowed, please go through Shipment Tracking.', 'wc-multivendor-marketplace' ) . '"}'; |
  | 74 |  | } |
  | 75 |  | echo '{"status": false, "message": "' . esc\_html\_\_( 'This status not allowed, please go through Shipment Tracking.', 'wc-multivendor-marketplace' ) . '"}'; |
  | 76 |  | die; |
  | 77 |  | } |
  | 78 |  |  |
  | 79 |  | $wcfmmp\_marketplace\_options   = wcfm\_get\_option( 'wcfm\_marketplace\_options', array() ); |
  | 80 |  | $order\_sync  = isset( $wcfmmp\_marketplace\_options['order\_sync'] ) ? $wcfmmp\_marketplace\_options['order\_sync'] : 'no'; |
  | 81 |  | if( $order\_sync == 'yes' ) return; |
  | 82 |  |  |
  | 83 |  | $vendor\_id = $WCFMmp->vendor\_id; |
  | 84 |  |  |
  | 85 |  | if( $vendor\_id ) { |
  | 86 |  | $order = wc\_get\_order( $order\_id ); |
  | 87 |  | $status = str\_replace('wc-', '', $order\_status); |
  | 88 |  | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('commission\_status' => $status), array('order\_id' => $order\_id, 'vendor\_id' => $vendor\_id), array('%s'), array('%d', '%d') ); |
  | 89 |  |  |
  | 90 |  | // Withdrawal Threshold check by Order Completed date |
  | 91 |  | if( apply\_filters( 'wcfm\_is\_allow\_withdrwal\_check\_by\_order\_complete\_date', false ) && ( $status == 'completed' ) ) { |
  | 92 |  | $wpdb->update( "{$wpdb->prefix}wcfm\_marketplace\_orders", array( 'created' => date( 'Y-m-d H:i:s', current\_time( 'timestamp', 0 ) ) ), array( 'order\_id' => $order\_id, 'vendor\_id' => $vendor\_id ), array('%s'), array('%d', '%d') ); |
  | 93 |  | } |
  | 94 |  |  |
  | 95 |  |  |
  | 96 |  | do\_action( 'wcfmmp\_vendor\_order\_status\_updated', $order\_id, $order\_status, $vendor\_id ); |
  | 97 |  |  |
  | 98 |  | // Add Order Note for Log |
  | 99 |  | if( apply\_filters( 'wcfmmp\_is\_allow\_sold\_by\_linked', true ) ) { |
  | 100 |  | $shop\_name = wcfm\_get\_vendor\_store( absint($vendor\_id) ); |
  | 101 |  | } else { |
  | 102 |  | $shop\_name = wcfm\_get\_vendor\_store\_name( absint($vendor\_id) ); |
  | 103 |  | } |
  | 104 |  |  |
  | 105 |  | // Fetch Product ID |
  | 106 |  | $is\_all\_complete = true; |
  | 107 |  | if( apply\_filters( 'wcfm\_is\_allow\_itemwise\_notification', true ) ) { |
  | 108 |  | $sql = 'SELECT product\_id  FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission'; |
  | 109 |  | $sql .= ' WHERE 1=1'; |
  | 110 |  | $sql .= " AND `order\_id` = %d"; |
  | 111 |  | $sql .= " AND `vendor\_id` = %d"; |
  | 112 |  | $commissions = $wpdb->get\_results( $wpdb->prepare( $sql, $order\_id, $vendor\_id ) ); |
  | 113 |  | $product\_id = 0; |
  | 114 |  | if( !empty( $commissions ) ) { |
  | 115 |  | foreach( $commissions as $commission ) { |
  | 116 |  | $product\_id = $commission->product\_id; |
  | 117 |  |  |
  | 118 |  | $wcfm\_messages = sprintf( \_\_( 'Order item <b>%s</b> status updated to <b>%s</b> by <b>%s</b>', 'wc-multivendor-marketplace' ), '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_permalink($product\_id) . '">' . get\_the\_title( $product\_id ) . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $order\_status ), $shop\_name ); |
  | 119 |  |  |
  | 120 |  | add\_filter( 'woocommerce\_new\_order\_note\_data', array( $WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor' ), 10, 2 ); |
  | 121 |  | $is\_customer\_note = apply\_filters( 'wcfm\_is\_allow\_order\_update\_note\_for\_customer', '1' ); |
  | 122 |  | $comment\_id = $order->add\_order\_note( apply\_filters( 'wcfm\_order\_item\_status\_update\_message', $wcfm\_messages, $order\_id, $vendor\_id, $product\_id ), $is\_customer\_note ); |
  | 123 |  | add\_comment\_meta( $comment\_id, '\_vendor\_id', $vendor\_id ); |
  | 124 |  | remove\_filter( 'woocommerce\_new\_order\_note\_data', array( $WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor' ), 10, 2 ); |
  | 125 |  |  |
  | 126 |  | if( apply\_filters( 'wcfm\_is\_allow\_order\_update\_note\_for\_admin', true ) ) { |
  | 127 |  | $wcfm\_messages = apply\_filters( 'wcfm\_order\_item\_status\_update\_admin\_message', sprintf( \_\_( '<b>%s</b> order item <b>%s</b> status updated to <b>%s</b> by <b>%s</b>', 'wc-multivendor-marketplace' ), '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . wcfm\_get\_order\_number( $order\_id ) . '</a>', '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_permalink($product\_id) . '">' . get\_the\_title( $product\_id ) . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $order\_status ), $shop\_name ), $order\_id, $vendor\_id, $product\_id ); |
  | 128 |  |  |
  | 129 |  | $raw\_message = [ |
  | 130 |  | 'hook'      => [ |
  | 131 |  | 'name'  => 'wcfm\_order\_item\_status\_update\_admin\_message', |
  | 132 |  | 'args'  => [ |
  | 133 |  | $order\_id, |
  | 134 |  | $vendor\_id, |
  | 135 |  | $product\_id |
  | 136 |  | ] |
  | 137 |  | ], |
  | 138 |  | 'l10n'  => [ |
  | 139 |  | 'text'        => '<b>%s</b> order item <b>%s</b> status updated to <b>%s</b> by <b>%s</b>', |
  | 140 |  | 'domain'    => 'wc-multivendor-marketplace', |
  | 141 |  | 'wrapper' => [ |
  | 142 |  | 'function'  => 'sprintf', |
  | 143 |  | 'args'      => [ |
  | 144 |  | '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . wcfm\_get\_order\_number( $order\_id ) . '</a>', |
  | 145 |  | '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_permalink($product\_id) . '">' . get\_the\_title( $product\_id ) . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $order\_status ), |
  | 146 |  | $shop\_name |
  |  | 14 |  |
  |  | 15 | public $controllers\_path; |
  |  | 16 |  |
  |  | 17 | public function \_\_construct() { |
  |  | 18 | global $WCFM, $WCFMa; |
  |  | 19 |  |
  |  | 20 | // Vendor Order Status Update |
  |  | 21 | add\_action('before\_wcfm\_order\_status\_update', array(&$this, 'wcfmmp\_vendor\_order\_status\_update'), 10, 2); |
  |  | 22 |  |
  |  | 23 | // Store List Search |
  |  | 24 | add\_action('wp\_ajax\_wcfmmp\_stores\_list\_search', array($this, 'wcfmmp\_stores\_list\_search')); |
  |  | 25 | add\_action('wp\_ajax\_nopriv\_wcfmmp\_stores\_list\_search', array($this, 'wcfmmp\_stores\_list\_search')); |
  |  | 26 |  |
  |  | 27 | // Store List Map markers |
  |  | 28 | add\_action('wp\_ajax\_wcfmmp\_stores\_list\_map\_markers', array($this, 'wcfmmp\_stores\_list\_map\_markers')); |
  |  | 29 | add\_action('wp\_ajax\_nopriv\_wcfmmp\_stores\_list\_map\_markers', array($this, 'wcfmmp\_stores\_list\_map\_markers')); |
  |  | 30 |  |
  |  | 31 | // Zone Shipping Ajax |
  |  | 32 | add\_action('wp\_ajax\_wcfmmp-get-shipping-zone', array($this, 'wcfmmp\_get\_shipping\_zone')); |
  |  | 33 | add\_action('wp\_ajax\_wcfmmp-add-shipping-method', array($this, 'wcfmmp\_add\_shipping\_method')); |
  |  | 34 | add\_action('wp\_ajax\_wcfmmp-toggle-shipping-method', array($this, 'wcfmmp\_toggle\_shipping\_method')); |
  |  | 35 | add\_action('wp\_ajax\_wcfmmp-delete-shipping-method', array($this, 'wcfmmp\_delete\_shipping\_method')); |
  |  | 36 | add\_action('wp\_ajax\_wcfmmp-update-shipping-method', array($this, 'wcfmmp\_update\_shipping\_method')); |
  |  | 37 |  |
  |  | 38 | add\_action('wp\_ajax\_wcfmmp-remove-cart-vendor-product', array($this, 'wcfmmp\_remove\_cart\_vendor\_product')); |
  |  | 39 | add\_action('wp\_ajax\_nopriv\_wcfmmp-remove-cart-vendor-product', array($this, 'wcfmmp\_remove\_cart\_vendor\_product')); |
  |  | 40 |  |
  |  | 41 | // Vendor Store Offline |
  |  | 42 | add\_action('wp\_ajax\_wcfm\_vendor\_store\_offline', array(&$this, 'wcfm\_vendor\_store\_offline')); |
  |  | 43 |  |
  |  | 44 | // Vendor Store Online |
  |  | 45 | add\_action('wp\_ajax\_wcfm\_vendor\_store\_online', array(&$this, 'wcfm\_vendor\_store\_online')); |
  |  | 46 | } |
  |  | 47 |  |
  |  | 48 | /\*\* |
  |  | 49 | \* Vendor Order - Commission Status Update |
  |  | 50 | \*/ |
  |  | 51 | function wcfmmp\_vendor\_order\_status\_update($order\_id, $order\_status) { |
  |  | 52 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 53 |  |
  |  | 54 | if (!wcfm\_is\_vendor()) return; |
  |  | 55 |  |
  |  | 56 | if (!$order\_id) { |
  |  | 57 | if (defined('WCFM\_REST\_API\_CALL')) { |
  |  | 58 | return '{"status": false, "message": "' . esc\_html\_\_('No Order ID found.', 'wc-frontend-manager') . '"}'; |
  |  | 59 | } |
  |  | 60 | echo '{"status": false, "message": "' . esc\_html\_\_('No Order ID found.', 'wc-frontend-manager') . '"}'; |
  |  | 61 | die; |
  |  | 62 | } |
  |  | 63 |  |
  |  | 64 | if ($order\_status == 'wc-refunded') { |
  |  | 65 | if (defined('WCFM\_REST\_API\_CALL')) { |
  |  | 66 | return '{"status": false, "message": "' . esc\_html\_\_('This status not allowed, please go through Refund Request.', 'wc-multivendor-marketplace') . '"}'; |
  |  | 67 | } |
  |  | 68 | echo '{"status": false, "message": "' . esc\_html\_\_('This status not allowed, please go through Refund Request.', 'wc-multivendor-marketplace') . '"}'; |
  |  | 69 | die; |
  |  | 70 | } |
  |  | 71 |  |
  |  | 72 | if ($order\_status == 'wc-shipped') { |
  |  | 73 | if (defined('WCFM\_REST\_API\_CALL')) { |
  |  | 74 | return '{"status": false, "message": "' . esc\_html\_\_('This status not allowed, please go through Shipment Tracking.', 'wc-multivendor-marketplace') . '"}'; |
  |  | 75 | } |
  |  | 76 | echo '{"status": false, "message": "' . esc\_html\_\_('This status not allowed, please go through Shipment Tracking.', 'wc-multivendor-marketplace') . '"}'; |
  |  | 77 | die; |
  |  | 78 | } |
  |  | 79 |  |
  |  | 80 | $wcfmmp\_marketplace\_options   = wcfm\_get\_option('wcfm\_marketplace\_options', array()); |
  |  | 81 | $order\_sync  = isset($wcfmmp\_marketplace\_options['order\_sync']) ? $wcfmmp\_marketplace\_options['order\_sync'] : 'no'; |
  |  | 82 | if ($order\_sync == 'yes') return; |
  |  | 83 |  |
  |  | 84 | $vendor\_id = $WCFMmp->vendor\_id; |
  |  | 85 |  |
  |  | 86 | if ($vendor\_id) { |
  |  | 87 | $order = wc\_get\_order($order\_id); |
  |  | 88 | $status = str\_replace('wc-', '', $order\_status); |
  |  | 89 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('commission\_status' => $status), array('order\_id' => $order\_id, 'vendor\_id' => $vendor\_id), array('%s'), array('%d', '%d')); |
  |  | 90 |  |
  |  | 91 | // Withdrawal Threshold check by Order Completed date |
  |  | 92 | if (apply\_filters('wcfm\_is\_allow\_withdrwal\_check\_by\_order\_complete\_date', false) && ($status == 'completed')) { |
  |  | 93 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('created' => date('Y-m-d H:i:s', current\_time('timestamp', 0))), array('order\_id' => $order\_id, 'vendor\_id' => $vendor\_id), array('%s'), array('%d', '%d')); |
  |  | 94 | } |
  |  | 95 |  |
  |  | 96 |  |
  |  | 97 | do\_action('wcfmmp\_vendor\_order\_status\_updated', $order\_id, $order\_status, $vendor\_id); |
  |  | 98 |  |
  |  | 99 | // Add Order Note for Log |
  |  | 100 | if (apply\_filters('wcfmmp\_is\_allow\_sold\_by\_linked', true)) { |
  |  | 101 | $shop\_name = wcfm\_get\_vendor\_store(absint($vendor\_id)); |
  |  | 102 | } else { |
  |  | 103 | $shop\_name = wcfm\_get\_vendor\_store\_name(absint($vendor\_id)); |
  |  | 104 | } |
  |  | 105 |  |
  |  | 106 | // Fetch Product ID |
  |  | 107 | $is\_all\_complete = true; |
  |  | 108 | if (apply\_filters('wcfm\_is\_allow\_itemwise\_notification', true)) { |
  |  | 109 | $sql = 'SELECT product\_id  FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission'; |
  |  | 110 | $sql .= ' WHERE 1=1'; |
  |  | 111 | $sql .= " AND `order\_id` = %d"; |
  |  | 112 | $sql .= " AND `vendor\_id` = %d"; |
  |  | 113 | $commissions = $wpdb->get\_results($wpdb->prepare($sql, $order\_id, $vendor\_id)); |
  |  | 114 | $product\_id = 0; |
  |  | 115 | if (!empty($commissions)) { |
  |  | 116 | foreach ($commissions as $commission) { |
  |  | 117 | $product\_id = $commission->product\_id; |
  |  | 118 |  |
  |  | 119 | $wcfm\_messages = sprintf(\_\_('Order item <b>%s</b> status updated to <b>%s</b> by <b>%s</b>', 'wc-multivendor-marketplace'), '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_permalink($product\_id) . '">' . get\_the\_title($product\_id) . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($order\_status), $shop\_name); |
  |  | 120 |  |
  |  | 121 | add\_filter('woocommerce\_new\_order\_note\_data', array($WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor'), 10, 2); |
  |  | 122 | $is\_customer\_note = apply\_filters('wcfm\_is\_allow\_order\_update\_note\_for\_customer', '1'); |
  |  | 123 | $comment\_id = $order->add\_order\_note(apply\_filters('wcfm\_order\_item\_status\_update\_message', $wcfm\_messages, $order\_id, $vendor\_id, $product\_id), $is\_customer\_note); |
  |  | 124 | add\_comment\_meta($comment\_id, '\_vendor\_id', $vendor\_id); |
  |  | 125 | remove\_filter('woocommerce\_new\_order\_note\_data', array($WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor'), 10, 2); |
  |  | 126 |  |
  |  | 127 | if (apply\_filters('wcfm\_is\_allow\_order\_update\_note\_for\_admin', true)) { |
  |  | 128 | $wcfm\_messages = apply\_filters('wcfm\_order\_item\_status\_update\_admin\_message', sprintf(\_\_('<b>%s</b> order item <b>%s</b> status updated to <b>%s</b> by <b>%s</b>', 'wc-multivendor-marketplace'), '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . wcfm\_get\_order\_number($order\_id) . '</a>', '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_permalink($product\_id) . '">' . get\_the\_title($product\_id) . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($order\_status), $shop\_name), $order\_id, $vendor\_id, $product\_id); |
  |  | 129 |  |
  |  | 130 | $raw\_message = [ |
  |  | 131 | 'hook'        => [ |
  |  | 132 | 'name'  => 'wcfm\_order\_item\_status\_update\_admin\_message', |
  |  | 133 | 'args'  => [ |
  |  | 134 | $order\_id, |
  |  | 135 | $vendor\_id, |
  |  | 136 | $product\_id |
  |  | 137 | ] |
  |  | 138 | ], |
  |  | 139 | 'l10n'    => [ |
  |  | 140 | 'text'         => '<b>%s</b> order item <b>%s</b> status updated to <b>%s</b> by <b>%s</b>', |
  |  | 141 | 'domain'    => 'wc-multivendor-marketplace', |
  |  | 142 | 'wrapper'    => [ |
  |  | 143 | 'function'     => 'sprintf', |
  |  | 144 | 'args'         => [ |
  |  | 145 | '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . wcfm\_get\_order\_number($order\_id) . '</a>', |
  |  | 146 | '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_permalink($product\_id) . '">' . get\_the\_title($product\_id) . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($order\_status), |
  |  | 147 | $shop\_name |
  |  | 148 | ] |
  |  | 149 | ] |
  |  | 150 | ] |
  |  | 151 | ]; |
  |  | 152 |  |
  |  | 153 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message($vendor\_id, 0, 0, 1, $wcfm\_messages, 'status-update', true, $raw\_message); |
  |  | 154 | } |
  |  | 155 | } |
  |  | 156 | } |
  |  | 157 | } else { |
  |  | 158 | $wcfm\_messages = sprintf(\_\_('Order status updated to <b>%s</b> by <b>%s</b>', 'wc-frontend-manager'), $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($order\_status), $shop\_name); |
  |  | 159 |  |
  |  | 160 | add\_filter('woocommerce\_new\_order\_note\_data', array($WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor'), 10, 2); |
  |  | 161 | $is\_customer\_note = apply\_filters('wcfm\_is\_allow\_order\_update\_note\_for\_customer', '1'); |
  |  | 162 | $comment\_id = $order->add\_order\_note(apply\_filters('wcfm\_order\_item\_status\_update\_message', $wcfm\_messages, $order\_id, $vendor\_id, 0), $is\_customer\_note); |
  |  | 163 | add\_comment\_meta($comment\_id, '\_vendor\_id', $vendor\_id); |
  |  | 164 | remove\_filter('woocommerce\_new\_order\_note\_data', array($WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor'), 10, 2); |
  |  | 165 |  |
  |  | 166 | if (apply\_filters('wcfm\_is\_allow\_order\_update\_note\_for\_admin', true)) { |
  |  | 167 | $wcfm\_messages = apply\_filters('wcfm\_order\_item\_status\_update\_admin\_message', sprintf(\_\_('<b>%s</b> order status updated to <b>%s</b> by <b>%s</b>', 'wc-frontend-manager'), '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($order\_status), $shop\_name), $order\_id, $vendor\_id, 0); |
  |  | 168 |  |
  |  | 169 | $raw\_message = [ |
  |  | 170 | 'hook'        => [ |
  |  | 171 | 'name'  => 'wcfm\_order\_item\_status\_update\_admin\_message', |
  |  | 172 | 'args'  => [ |
  |  | 173 | $order\_id, |
  |  | 174 | $vendor\_id, |
  |  | 175 | 0 |
  |  | 176 | ] |
  |  | 177 | ], |
  |  | 178 | 'l10n'    => [ |
  |  | 179 | 'text'         => '<b>%s</b> order status updated to <b>%s</b> by <b>%s</b>', |
  |  | 180 | 'domain'    => 'wc-multivendor-marketplace', |
  |  | 181 | 'wrapper'    => [ |
  |  | 182 | 'function'     => 'sprintf', |
  |  | 183 | 'args'         => [ |
  |  | 184 | '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', |
  |  | 185 | $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($order\_status), |
  |  | 186 | $shop\_name |
  |  | 187 | ] |
  |  | 188 | ] |
  |  | 189 | ] |
  |  | 190 | ]; |
  |  | 191 |  |
  |  | 192 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(-2, 0, 1, 0, $wcfm\_messages, 'status-update', true, $raw\_message); |
  |  | 193 | } |
  |  | 194 | } |
  |  | 195 |  |
  |  | 196 | // Update Main Order status on all Commission Order Status Update |
  |  | 197 | if (in\_array($status, apply\_filters('wcfm\_change\_main\_order\_on\_child\_order\_statuses', array('completed', 'processing'))) && apply\_filters('wcfm\_is\_allow\_mark\_complete\_main\_order\_on\_all\_child\_order\_complete', true)) { |
  |  | 198 | if (wc\_is\_order\_status('wc-' . $status) && $order\_id) { |
  |  | 199 |  |
  |  | 200 | // Check is all vendor orders completed or not |
  |  | 201 | $is\_all\_complete = true; |
  |  | 202 | $sql = 'SELECT commission\_status  FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission'; |
  |  | 203 | $sql .= ' WHERE 1=1'; |
  |  | 204 | $sql .= " AND `order\_id` = %d"; |
  |  | 205 | $commissions = $wpdb->get\_results($wpdb->prepare($sql, $order\_id)); |
  |  | 206 | if (!empty($commissions)) { |
  |  | 207 | foreach ($commissions as $commission) { |
  |  | 208 | if ($commission->commission\_status != $status) { |
  |  | 209 | $is\_all\_complete = false; |
  |  | 210 | } |
  |  | 211 | } |
  |  | 212 | } |
  |  | 213 |  |
  |  | 214 | if ($is\_all\_complete) { |
  |  | 215 | $order->update\_status($status, '', true); |
  |  | 216 |  |
  |  | 217 | // Add Order Note for Log |
  |  | 218 | $wcfm\_messages = sprintf(\_\_('<b>%s</b> order status updated to <b>%s</b>', 'wc-multivendor-marketplace'), '#' . $order->get\_order\_number(), wc\_get\_order\_status\_name($status)); |
  |  | 219 |  |
  |  | 220 | $raw\_message = [ |
  |  | 221 | 'l10n'    => [ |
  |  | 222 | 'text'         => '<b>%s</b> order status updated to <b>%s</b>', |
  |  | 223 | 'domain'    => 'wc-multivendor-marketplace', |
  |  | 224 | 'wrapper'    => [ |
  |  | 225 | 'function'     => 'sprintf', |
  |  | 226 | 'args'         => [ |
  |  | 227 | '#' . $order->get\_order\_number(), |
  |  | 228 | wc\_get\_order\_status\_name($status) |
  |  | 229 | ] |
  |  | 230 | ] |
  |  | 231 | ] |
  |  | 232 | ]; |
  |  | 233 |  |
  |  | 234 | $is\_customer\_note = apply\_filters('wcfm\_is\_allow\_order\_update\_note\_for\_customer', '1'); |
  |  | 235 |  |
  |  | 236 | $comment\_id = $order->add\_order\_note($wcfm\_messages, $is\_customer\_note); |
  |  | 237 |  |
  |  | 238 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(-2, 0, 1, 0, $wcfm\_messages, 'status-update', true, $raw\_message); |
  |  | 239 |  |
  |  | 240 | do\_action('woocommerce\_order\_edit\_status', $order\_id, $status); |
  |  | 241 | do\_action('wcfm\_order\_status\_updated', $order\_id, $status); |
  |  | 242 | } |
  |  | 243 | } |
  |  | 244 | } |
  |  | 245 |  |
  |  | 246 | if (defined('WCFM\_REST\_API\_CALL')) { |
  |  | 247 | return '{"status": true, "message": "' . esc\_html\_\_('Order status updated.', 'wc-frontend-manager') . '"}'; |
  |  | 248 | } |
  |  | 249 |  |
  |  | 250 | echo '{"status": true, "message": "' . esc\_html\_\_('Order status updated.', 'wc-frontend-manager') . '"}'; |
  |  | 251 | die; |
  |  | 252 | } |
  |  | 253 | } |
  |  | 254 |  |
  |  | 255 | function wcfmmp\_stores\_list\_search() { |
  |  | 256 | global $WCFMmp; |
  |  | 257 |  |
  |  | 258 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 259 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 260 | wp\_die(); |
  |  | 261 | } |
  |  | 262 |  |
  |  | 263 | $search\_term     = isset($\_REQUEST['search\_term']) ? sanitize\_text\_field($\_REQUEST['search\_term']) : ''; |
  |  | 264 | $search\_category = isset($\_REQUEST['wcfmmp\_store\_category']) ? sanitize\_text\_field($\_REQUEST['wcfmmp\_store\_category']) : ''; |
  |  | 265 | $pagination\_base = isset($\_REQUEST['pagination\_base']) ? sanitize\_text\_field($\_REQUEST['pagination\_base']) : ''; |
  |  | 266 | $paged           = 1;                                                                                                             //isset( $\_REQUEST['paged'] ) ? absint( $\_REQUEST['paged'] ) : 1; |
  |  | 267 | $per\_row         = isset($\_REQUEST['per\_row']) ? absint($\_REQUEST['per\_row']) : 3; |
  |  | 268 | $length          = isset($\_REQUEST['per\_page']) ? (int) $\_REQUEST['per\_page'] : 10; |
  |  | 269 | $includes        = isset($\_REQUEST['includes']) ? sanitize\_text\_field($\_REQUEST['includes']) : ''; |
  |  | 270 | $excludes        = isset($\_REQUEST['excludes']) ? sanitize\_text\_field($\_REQUEST['excludes']) : ''; |
  |  | 271 | $orderby         = isset($\_REQUEST['orderby']) ? sanitize\_sql\_orderby($\_REQUEST['orderby']) : 'newness\_asc'; |
  |  | 272 | $has\_orderby     = isset($\_REQUEST['has\_orderby']) ? sanitize\_text\_field($\_REQUEST['has\_orderby']) : ''; |
  |  | 273 | $has\_product     = isset($\_REQUEST['has\_product']) ? sanitize\_text\_field($\_REQUEST['has\_product']) : ''; |
  |  | 274 | $sidebar         = isset($\_REQUEST['sidebar']) ? sanitize\_text\_field($\_REQUEST['sidebar']) : ''; |
  |  | 275 | $theme           = isset($\_REQUEST['theme']) ? sanitize\_text\_field($\_REQUEST['theme']) : 'simple'; |
  |  | 276 | $search\_data     = array(); |
  |  | 277 |  |
  |  | 278 | if (isset($\_REQUEST['search\_data'])) |
  |  | 279 | parse\_str($\_REQUEST['search\_data'], $search\_data); |
  |  | 280 |  |
  |  | 281 | $search\_data = wc\_clean(wp\_unslash($search\_data)); |
  |  | 282 |  |
  |  | 283 | $offset  = ($paged - 1) \* absint($length); |
  |  | 284 |  |
  |  | 285 | $search\_data['excludes'] = $excludes; |
  |  | 286 |  |
  |  | 287 | if ($includes) $includes = explode(",", $includes); |
  |  | 288 | else $includes = array(); |
  |  | 289 |  |
  |  | 290 | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_get\_vendors($offset, $length, $search\_term, $includes, 'ASC', 'ID', $search\_data, $search\_category, $has\_product); |
  |  | 291 |  |
  |  | 292 | $template\_args = apply\_filters('wcfmmp\_stores\_args', array( |
  |  | 293 | 'stores'          => $stores, |
  |  | 294 | 'limit'           => $length, |
  |  | 295 | 'offset'          => $offset, |
  |  | 296 | 'paged'           => $paged, |
  |  | 297 | 'includes'        => $includes, |
  |  | 298 | 'excludes'        => $excludes, |
  |  | 299 | 'image\_size'      => 'full', |
  |  | 300 | 'filter'          => 'yes', |
  |  | 301 | 'search'          => 'yes', |
  |  | 302 | 'category'        => 'yes', |
  |  | 303 | 'country'         => 'yes', |
  |  | 304 | 'state'           => 'yes', |
  |  | 305 | 'has\_product'     => $has\_product, |
  |  | 306 | 'search\_query'    => $search\_term, |
  |  | 307 | 'search\_category' => $search\_category, |
  |  | 308 | 'search'          => $search\_term, |
  |  | 309 | 'pagination\_base' => $pagination\_base, |
  |  | 310 | 'orderby'         => $orderby, |
  |  | 311 | 'has\_orderby'     => $has\_orderby, |
  |  | 312 | 'per\_row'         => $per\_row, |
  |  | 313 | 'sidebar'         => $sidebar, |
  |  | 314 | 'theme'           => $theme, |
  |  | 315 | 'search\_data'     => $search\_data |
  |  | 316 | ), $\_REQUEST, $search\_data); |
  |  | 317 |  |
  |  | 318 | ob\_start(); |
  |  | 319 | $WCFMmp->template->get\_template('store-lists/wcfmmp-view-store-lists-loop.php', $template\_args); |
  |  | 320 | $content = ob\_get\_clean(); |
  |  | 321 |  |
  |  | 322 | wp\_send\_json\_success($content); |
  |  | 323 | } |
  |  | 324 |  |
  |  | 325 | function wcfmmp\_stores\_list\_map\_markers() { |
  |  | 326 | global $WCFMmp, $WCFMu; |
  |  | 327 |  |
  |  | 328 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 329 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 330 | wp\_die(); |
  |  | 331 | } |
  |  | 332 |  |
  |  | 333 | $search\_term     = isset($\_REQUEST['search\_term']) ? sanitize\_text\_field($\_REQUEST['search\_term']) : ''; |
  |  | 334 | $search\_category = isset($\_REQUEST['wcfmmp\_store\_category']) ? sanitize\_text\_field($\_REQUEST['wcfmmp\_store\_category']) : ''; |
  |  | 335 | $pagination\_base = isset($\_REQUEST['pagination\_base']) ? sanitize\_text\_field($\_REQUEST['pagination\_base']) : ''; |
  |  | 336 | $paged           = isset($\_REQUEST['paged']) ? sanitize\_text\_field($\_REQUEST['paged']) : ''; |
  |  | 337 | $per\_row         = isset($\_REQUEST['per\_row']) ? sanitize\_text\_field($\_REQUEST['per\_row']) : '3'; |
  |  | 338 | $length          = isset($\_REQUEST['per\_page']) ? (int) $\_REQUEST['per\_page'] : 10; |
  |  | 339 | $includes        = isset($\_REQUEST['includes']) ? sanitize\_text\_field($\_REQUEST['includes']) : ''; |
  |  | 340 | $excludes        = isset($\_REQUEST['excludes']) ? sanitize\_text\_field($\_REQUEST['excludes']) : ''; |
  |  | 341 | $has\_product     = isset($\_REQUEST['has\_product']) ? sanitize\_text\_field($\_REQUEST['has\_product']) : ''; |
  |  | 342 | $sidebar         = isset($\_REQUEST['sidebar']) ? sanitize\_text\_field($\_REQUEST['sidebar']) : ''; |
  |  | 343 | //$filter\_vendor   = isset( $\_REQUEST['filter\_vendor'] ) ? sanitize\_text\_field( $\_REQUEST['filter\_vendor'] ) : ''; |
  |  | 344 | $search\_data     = array(); |
  |  | 345 |  |
  |  | 346 | if (isset($\_POST['search\_data'])) |
  |  | 347 | parse\_str($\_POST['search\_data'], $search\_data); |
  |  | 348 |  |
  |  | 349 | $search\_data = wc\_clean(wp\_unslash($search\_data)); |
  |  | 350 |  |
  |  | 351 | $offset  = (absint($paged) - 1) \* absint($length); |
  |  | 352 |  |
  |  | 353 | $search\_data['excludes'] = $excludes; |
  |  | 354 |  |
  |  | 355 | if ($includes) $includes = explode(",", $includes); |
  |  | 356 | else $includes = array(); |
  |  | 357 |  |
  |  | 358 | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_get\_vendors($offset, $length, $search\_term, $includes, 'ASC', 'ID', $search\_data, $search\_category, $has\_product); |
  |  | 359 | $store\_list\_markers = ''; |
  |  | 360 | if (!empty($stores)) { |
  |  | 361 | $stores = apply\_filters('wcfmmp\_include\_all\_valid\_branches\_for\_map\_marker', $stores); |
  |  | 362 | foreach ($stores as $store\_id => $branches) { |
  |  | 363 | foreach ($branches as $store) { |
  |  | 364 | $store\_user      = wcfmmp\_get\_store($store\_id); |
  |  | 365 | $store\_info      = $store\_user->get\_shop\_info(); |
  |  | 366 | $store\_name      = wcfm\_get\_vendor\_store\_name($store\_id); |
  |  | 367 | $store\_name      = apply\_filters('wcfmmp\_store\_title', esc\_attr($store\_name), $store\_id); |
  |  | 368 | $store\_url       = wcfmmp\_get\_store\_url($store\_id); |
  |  | 369 | if (!empty($store['branch\_id']) && apply\_filters('wcfm\_is\_pref\_multi\_store', true)) { |
  |  | 370 | global $WCFMu; |
  |  | 371 | $store\_address = $WCFMu->wcfmu\_multi\_store->formatted\_store\_address($store); |
  |  | 372 | $store\_lat     = $store['latitude'] ?? $store\_info['store\_lat'] ?? 0; |
  |  | 373 | $store\_lng     = $store['longitude'] ?? $store\_info['store\_lng'] ?? 0; |
  |  | 374 | } else { |
  |  | 375 | $store\_address = $store\_user->get\_address\_string(); |
  |  | 376 | $store\_lat     = isset($store\_info['store\_lat']) ? esc\_attr($store\_info['store\_lat']) : 0; |
  |  | 377 | $store\_lng     = isset($store\_info['store\_lng']) ? esc\_attr($store\_info['store\_lng']) : 0; |
  |  | 378 | } |
  |  | 379 |  |
  |  | 380 | $gravatar        = $store\_user->get\_avatar(); |
  |  | 381 |  |
  |  | 382 | if ($store\_address && (($store\_info['store\_hide\_address'] == 'yes') || !wcfm\_vendor\_has\_capability($store\_id, 'vendor\_address'))) { |
  |  | 383 | $store\_address = ''; |
  |  | 384 | } |
  |  | 385 |  |
  |  | 386 | $info\_window\_content =  apply\_filters('wcfmmp\_map\_store\_info', "<div class='wcfm\_map\_info\_wrapper'>" . |
  |  | 387 | "<a class='wcfm\_map\_info\_logo' target='\_blank' href='" . $store\_url . "'><img width='80' src='" . $gravatar . "' /></a>" . |
  |  | 388 | "<div class='wcfm\_map\_info\_content'>" . |
  |  | 389 | "<a class='wcfm\_map\_info\_store' target='\_blank' href='" . $store\_url . "'>" . $store\_name . "</a>" . |
  |  | 390 | apply\_filters('wcfmmp\_map\_additional\_store\_info', "<p class='wcfm\_map\_info\_addr'>" . $store\_address . "</p>", $store, $store\_id) . |
  |  | 391 | "</div>" . |
  |  | 392 | "</div>", $store\_id, $store\_user); |
  |  | 393 |  |
  |  | 394 | $store\_icon = apply\_filters('wcfmmp\_map\_store\_icon', esc\_url($WCFMmp->plugin\_url . 'assets/images/wcfmmp\_map\_icon.png'), $store\_id, $store\_user); |
  |  | 395 |  |
  |  | 396 | if ($store\_lat && $store\_lng) { |
  |  | 397 | if ($store\_list\_markers) $store\_list\_markers .= ", "; |
  |  | 398 | $store\_list\_markers .= wp\_unslash('{"name": "' . $store\_name . '", "lat": "' . $store\_lat . '", "lang": "' . $store\_lng . '", "url": "' . $store\_url . '", "address": "' . $store\_address . '", "gravatar": "' . $gravatar . '", "info\_window\_content": "' . $info\_window\_content . '", "icon": "' . $store\_icon . '"}'); |
  |  | 399 | } |
  |  | 400 | } |
  |  | 401 | } |
  |  | 402 | } |
  |  | 403 | $store\_list\_markers = '[' . $store\_list\_markers . ']'; |
  |  | 404 |  |
  |  | 405 | wp\_send\_json\_success($store\_list\_markers); |
  |  | 406 | } |
  |  | 407 |  |
  |  | 408 | /\*\* |
  |  | 409 | \* Get shipping zone |
  |  | 410 | \* |
  |  | 411 | \* @since 1.0.0 |
  |  | 412 | \* |
  |  | 413 | \* @return void |
  |  | 414 | \*/ |
  |  | 415 | public function wcfmmp\_get\_shipping\_zone() { |
  |  | 416 | global $WCFM, $WCFMmp; |
  |  | 417 |  |
  |  | 418 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 419 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 420 | wp\_die(); |
  |  | 421 | } |
  |  | 422 |  |
  |  | 423 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('wcfm\_vendor') && !current\_user\_can('shop\_staff')) { |
  |  | 424 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 425 | wp\_die(); |
  |  | 426 | } |
  |  | 427 |  |
  |  | 428 | if (isset($\_POST['zoneID'])) { |
  |  | 429 | $zones = WCFMmp\_Shipping\_Zone::get\_zone(absint($\_POST['zoneID']), absint($\_POST['userID'])); |
  |  | 430 | //print\_r($zones); die; |
  |  | 431 | } |
  |  | 432 | $show\_post\_code\_list = $show\_state\_list = $show\_post\_code\_list = false; |
  |  | 433 | //print\_r($zones);die; |
  |  | 434 | $zone\_id = $zones['data']['id']; |
  |  | 435 | $user\_id =  absint($\_POST['userID']); |
  |  | 436 | $zone\_locations = $zones['data']['zone\_locations']; |
  |  | 437 | //print\_r($zone\_locations); |
  |  | 438 | $zone\_location\_types = array\_column(array\_map('wcfmmp\_convert\_to\_array', $zone\_locations), 'type', 'code'); |
  |  | 439 | //print\_r($zone\_location\_types); |
  |  | 440 | $selected\_continent\_codes = array\_keys($zone\_location\_types, 'continent'); |
  |  | 441 | if (!$selected\_continent\_codes) $selected\_continent\_codes = array(); |
  |  | 442 |  |
  |  | 443 | $all\_continents = WC()->countries->get\_continents(); |
  |  | 444 | $all\_allowed\_countries = WC()->countries->get\_allowed\_countries(); |
  |  | 445 |  |
  |  | 446 | $countries\_key\_by\_continent = array\_intersect\_key($all\_continents, array\_flip($selected\_continent\_codes)); |
  |  | 447 | if ($countries\_key\_by\_continent) { |
  |  | 448 | $countries\_key\_by\_continent = call\_user\_func\_array('array\_merge', array\_column($countries\_key\_by\_continent, 'countries')); |
  |  | 449 | } else { |
  |  | 450 | $countries\_key\_by\_continent = array(); |
  |  | 451 | } |
  |  | 452 |  |
  |  | 453 | $countries\_by\_continent = array\_intersect\_key($all\_allowed\_countries, array\_flip($countries\_key\_by\_continent)); |
  |  | 454 | //print\_r($all\_allowed\_countries); |
  |  | 455 | $selected\_country\_codes = array\_keys($zone\_location\_types, 'country'); |
  |  | 456 | $all\_states = WC()->countries->get\_states(); |
  |  | 457 |  |
  |  | 458 | $state\_key\_by\_country = array(); |
  |  | 459 | $state\_key\_by\_country = array\_intersect\_key($all\_states, array\_flip($selected\_country\_codes)); |
  |  | 460 | //print\_r($state\_key\_by\_country);die; |
  |  | 461 | array\_walk($state\_key\_by\_country, 'wcfmmp\_state\_key\_alter'); |
  |  | 462 |  |
  |  | 463 | if ($state\_key\_by\_country) |
  |  | 464 | $state\_key\_by\_country = call\_user\_func\_array('array\_merge', array\_values($state\_key\_by\_country)); |
  |  | 465 |  |
  |  | 466 |  |
  |  | 467 |  |
  |  | 468 | if (apply\_filters('wcfmmp\_city\_select\_dropdown\_enabled', false)) { |
  |  | 469 | global $wc\_city\_select; |
  |  | 470 | $all\_cities = $wc\_city\_select->get\_cities(); |
  |  | 471 | $city\_key\_by\_state = array(); |
  |  | 472 | //print\_r($all\_cities); |
  |  | 473 | $selected\_state\_codes = array\_keys($zone\_location\_types, 'state'); |
  |  | 474 | //$selected\_countywise\_states = array(); |
  |  | 475 | foreach ($selected\_state\_codes as $key => $value) { |
  |  | 476 | $country\_state\_arr = explode(':', $value); |
  |  | 477 | $exploded\_country = $country\_state\_arr[0]; |
  |  | 478 | $exploded\_state =  $country\_state\_arr[1]; |
  |  | 479 | if (isset($all\_cities[$exploded\_country][$exploded\_state])) { |
  |  | 480 | $city\_key\_by\_state = array\_merge($city\_key\_by\_state, $all\_cities[$exploded\_country][$exploded\_state]); |
  |  | 481 | } |
  |  | 482 | } |
  |  | 483 | $city\_key\_by\_state = array\_combine($city\_key\_by\_state, $city\_key\_by\_state); |
  |  | 484 | } |
  |  | 485 |  |
  |  | 486 |  |
  |  | 487 | $show\_limit\_location\_link = apply\_filters('show\_limit\_location\_link', (!in\_array('postcode', $zone\_location\_types))); |
  |  | 488 | $vendor\_shipping\_methods  = $zones['shipping\_methods']; |
  |  | 489 | $show\_country\_list        = false; |
  |  | 490 | $show\_city\_list           = apply\_filters('wcfmmp\_city\_select\_dropdown\_enabled', false); |
  |  | 491 |  |
  |  | 492 | if ($show\_limit\_location\_link) { |
  |  | 493 | if (in\_array('state', $zone\_location\_types)) { |
  |  | 494 | $show\_post\_code\_list = true; |
  |  | 495 | } elseif (in\_array('country', $zone\_location\_types)) { |
  |  | 496 | $show\_state\_list = true; |
  |  | 497 | $show\_post\_code\_list = true; |
  |  | 498 | } elseif (in\_array('continent', $zone\_location\_types)) { |
  |  | 499 | $show\_country\_list = true; |
  |  | 500 | $show\_state\_list = true; |
  |  | 501 | $show\_post\_code\_list = true; |
  |  | 502 | } |
  |  | 503 | } |
  |  | 504 |  |
  |  | 505 | $want\_to\_limit\_location = !empty($zones['locations']); |
  |  | 506 | $countries = $states = $cities = $postcodes = array(); |
  |  | 507 |  |
  |  | 508 | if ($want\_to\_limit\_location) { |
  |  | 509 |  |
  |  | 510 | foreach ($zones['locations'] as $each\_location) { |
  |  | 511 | switch ($each\_location['type']) { |
  |  | 512 | case 'country': |
  |  | 513 | $countries[] = $each\_location['code']; |
  |  | 514 | break; |
  |  | 515 | case 'state': |
  |  | 516 | $states[] = $each\_location['code']; |
  |  | 517 | break; |
  |  | 518 | case 'city': |
  |  | 519 | $cities[] = $each\_location['code']; |
  |  | 520 | break; |
  |  | 521 | case 'postcode': |
  |  | 522 | $postcodes[] = $each\_location['code']; |
  |  | 523 | break; |
  |  | 524 | default: |
  |  | 525 | break; |
  |  | 526 | } |
  |  | 527 | } |
  |  | 528 | $postcodes = implode(',', $postcodes); |
  |  | 529 | } |
  |  | 530 | //print\_r($states); |
  |  | 531 |  |
  |  | 532 | ob\_start(); |
  |  | 533 | ?> |
  |  | 534 |  |
  |  | 535 | <div class="zone-component"> |
  |  | 536 | <div class="return-to-zone-list"> |
  |  | 537 | <p> |
  |  | 538 | <a href="#">&larr; <?php \_e('Back to Zone List', 'wc-multivendor-marketplace'); ?></a> |
  |  | 539 | </p> |
  |  | 540 | </div> |
  |  | 541 | <form action="" method="post"> |
  |  | 542 | <div class="wcfmmp-form-group wcfmmp-clearfix"> |
  |  | 543 | <p class="wcfm\_title"> |
  |  | 544 | <strong><?php \_e('Zone Name', 'wc-multivendor-marketplace'); ?></strong> |
  |  | 545 | </p> |
  |  | 546 | <label for="" class="screen-reader-text"> |
  |  | 547 | <?php \_e('Zone Name', 'wc-multivendor-marketplace'); ?> |
  |  | 548 | </label> |
  |  | 549 | <p class="wcfm\_title"> |
  |  | 550 | <?php \_e($zones['data']['zone\_name'], 'wc-multivendor-marketplace'); ?> |
  |  | 551 | </p> |
  |  | 552 | </div> |
  |  | 553 | <div class="wcfmmp-form-group wcfmmp-clearfix"> |
  |  | 554 | <p class="wcfm\_title"> |
  |  | 555 | <strong> |
  |  | 556 | <?php \_e('Zone Location', 'wc-multivendor-marketplace'); ?> |
  |  | 557 | </strong> |
  |  | 558 | </p> |
  |  | 559 | <label for="" class="screen-reader-text"> |
  |  | 560 | <?php \_e('Zone Location', 'wc-multivendor-marketplace'); ?> |
  |  | 561 | </label> |
  |  | 562 | <p class="wcfm\_title"> |
  |  | 563 | <?php \_e($zones['formatted\_zone\_location'], 'wc-multivendor-marketplace'); ?> |
  |  | 564 | </p> |
  |  | 565 | </div> |
  |  | 566 |  |
  |  | 567 | <?php |
  |  | 568 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 569 | array( |
  |  | 570 | "zone\_id" => array( |
  |  | 571 | 'name'  => 'wcfmmp\_shipping\_zone[' . $zone\_id . '][\_zone\_id]', |
  |  | 572 | 'type'  => 'hidden', |
  |  | 573 | 'class' => 'wcfm-hidden input-hidden wcfm\_ele', |
  |  | 574 | 'value' => $zone\_id |
  |  | 575 | ) |
  |  | 576 | ) |
  |  | 577 | ); |
  |  | 578 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 579 | array( |
  |  | 580 | "user\_vendor\_id" => array( |
  |  | 581 | 'name'  => 'wcfmmp\_shipping\_zone[' . $user\_id . '][\_user\_id]', |
  |  | 582 | 'type'  => 'hidden', |
  |  | 583 | 'class' => 'wcfm-hidden input-hidden wcfm\_ele', |
  |  | 584 | 'value' => $user\_id |
  |  | 585 | ) |
  |  | 586 | ) |
  |  | 587 | ); |
  |  | 588 | if ($show\_limit\_location\_link && $zone\_id !== 0) { |
  |  | 589 |  |
  |  | 590 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 591 | array( |
  |  | 592 | "limit\_zone\_location" => array( |
  |  | 593 | 'label'       => \_\_('Limit Zone Location', 'wc-multivendor-marketplace'), |
  |  | 594 | 'name'        => 'wcfmmp\_shipping\_zone[' . $zone\_id . '][\_limit\_zone\_location]', |
  |  | 595 | 'type'        => 'checkbox', |
  |  | 596 | 'class'       => 'wcfm-checkbox input-checkbox wcfm\_ele', |
  |  | 597 | 'value'       => 1, |
  |  | 598 | 'label\_class' => 'wcfm\_title checkbox\_title', |
  |  | 599 | 'dfvalue'     => $want\_to\_limit\_location |
  |  | 600 | ) |
  |  | 601 | ) |
  |  | 602 | ); |
  |  | 603 | } |
  |  | 604 | if ($show\_country\_list) { |
  |  | 605 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 606 | array( |
  |  | 607 | "select\_zone\_country" => array( |
  |  | 608 | 'label'       => \_\_('Select Specific Countries', 'wc-multivendor-marketplace'), |
  |  | 609 | 'name'        => 'wcfmmp\_shipping\_zone[' . $zone\_id . '][\_select\_zone\_country]', |
  |  | 610 | 'type'        => 'select', |
  |  | 611 | 'class'       => 'wcfm-select wcfm-select2 wcfm\_ele select\_zone\_country\_select hide\_if\_zone\_not\_limited', |
  |  | 612 | 'label\_class' => 'wcfm\_title select\_title hide\_if\_zone\_not\_limited', |
  |  | 613 | 'attributes'  => array('multiple' => 'multiple'), |
  |  | 614 | 'options'     => $countries\_by\_continent, |
  |  | 615 | 'value'       => $countries |
  |  | 616 | ) |
  |  | 617 | ) |
  |  | 618 | ); |
  |  | 619 | } |
  |  | 620 | if ($show\_state\_list) { |
  |  | 621 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 622 | array( |
  |  | 623 | "select\_zone\_states" => array( |
  |  | 624 | 'label'       => \_\_('Select Specific States', 'wc-multivendor-marketplace'), |
  |  | 625 | 'name'        => 'wcfmmp\_shipping\_zone[' . $zone\_id . '][\_select\_zone\_states]', |
  |  | 626 | 'type'        => 'select', |
  |  | 627 | 'class'       => 'wcfm-select wcfm-select2 wcfm\_ele select\_zone\_states\_select hide\_if\_zone\_not\_limited', |
  |  | 628 | 'label\_class' => 'wcfm\_title select\_title hide\_if\_zone\_not\_limited', |
  |  | 629 | 'attributes'  => array('multiple' => 'multiple'), |
  |  | 630 | 'options'     => $state\_key\_by\_country, |
  |  | 631 | 'value'       => $states |
  |  | 632 | ) |
  |  | 633 | ) |
  |  | 634 | ); |
  |  | 635 | } |
  |  | 636 |  |
  |  | 637 | if ($show\_city\_list) { |
  |  | 638 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 639 | array( |
  |  | 640 | "select\_zone\_city" => array( |
  |  | 641 | 'label'       => \_\_('Select Specific City', 'wc-multivendor-marketplace'), |
  |  | 642 | 'name'        => 'wcfmmp\_shipping\_zone[' . $zone\_id . '][\_select\_zone\_city]', |
  |  | 643 | 'type'        => 'select', |
  |  | 644 | 'class'       => 'wcfm-select wcfm-select2 wcfm\_ele select\_zone\_city\_select hide\_if\_zone\_not\_limited', |
  |  | 645 | 'label\_class' => 'wcfm\_title select\_title hide\_if\_zone\_not\_limited', |
  |  | 646 | 'attributes'  => array('multiple' => 'multiple'), |
  |  | 647 | 'options'     => $city\_key\_by\_state, |
  |  | 648 | 'value'       => $cities |
  |  | 649 | ) |
  |  | 650 | ) |
  |  | 651 | ); |
  |  | 652 | } |
  |  | 653 |  |
  |  | 654 | if ($show\_post\_code\_list) { |
  |  | 655 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 656 | array( |
  |  | 657 | "select\_zone\_postcodes" => array( |
  |  | 658 | 'label'       => \_\_('Set your postcode', 'wc-multivendor-marketplace'), |
  |  | 659 | 'name'        => 'wcfmmp\_shipping\_zone[' . $zone\_id . '][\_select\_zone\_postcodes]', |
  |  | 660 | 'type'        => 'text', |
  |  | 661 | 'class'       => 'wcfm-text wcfm\_ele hide\_if\_zone\_not\_limited', |
  |  | 662 | 'label\_class' => 'wcfm\_title wcfm\_ele hide\_if\_zone\_not\_limited', |
  |  | 663 | 'desc'        => \_\_('Postcodes containing wildcards (e.g. CB23\*) or fully numeric ranges (e.g. 90210...99000) are also supported.', 'wc-multivendor-marketplace'), |
  |  | 664 | 'desc\_class'  => 'instructions hide\_if\_zone\_not\_limited', |
  |  | 665 | 'value'       => $postcodes |
  |  | 666 | ) |
  |  | 667 | ) |
  |  | 668 | ); |
  |  | 669 | } |
  |  | 670 | ?> |
  |  | 671 | </form> |
  |  | 672 | <div class="wcfmmp-zone-method-wrapper"> |
  |  | 673 | <div class="wcfmmp-zone-method-heading"> |
  |  | 674 | <h2> |
  |  | 675 | <i aria-hidden="true" class="wcfmfa fa-truck"></i> |
  |  | 676 | <?php \_e('Shipping Method', 'wc-multivendor-marketplace'); ?> |
  |  | 677 | </h2> |
  |  | 678 | <div class="wcfm-clearfix"></div> |
  |  | 679 | <span> |
  |  | 680 | <?php \_e('Add your shipping method for appropiate zone', 'wc-multivendor-marketplace'); ?> |
  |  | 681 | </span> |
  |  | 682 | <div class="wcfm-clearfix"></div> |
  |  | 683 | </div> |
  |  | 684 | <div class="wcfmmp-zone-method-content"> |
  |  | 685 | <table class="wcfmmp-table zone-method-table"> |
  |  | 686 | <thead> |
  |  | 687 | <tr> |
  |  | 688 | <th class="title"><?php \_e('Method Title', 'wc-multivendor-marketplace'); ?></th> |
  |  | 689 | <th class="enabled"><?php \_e('Status', 'wc-multivendor-marketplace'); ?></th> |
  |  | 690 | <th class="description"><?php \_e('Description', 'wc-multivendor-marketplace'); ?></th> |
  |  | 691 | </tr> |
  |  | 692 | </thead> |
  |  | 693 | <tbody> |
  |  | 694 | <?php |
  |  | 695 | if (empty($vendor\_shipping\_methods)) { ?> |
  |  | 696 | <tr> |
  |  | 697 | <td colspan="3"> |
  |  | 698 | <?php \_e('No shipping method found', 'wc-multivendor-marketplace'); ?> |
  |  | 699 | </td> |
  |  | 700 | </tr> |
  |  | 701 | <?php |
  |  | 702 | } else { |
  |  | 703 | //print\_r($vendor\_shipping\_methods); |
  |  | 704 | foreach ($vendor\_shipping\_methods as $vendor\_shipping\_method) { |
  |  | 705 | ?> |
  |  | 706 | <tr> |
  |  | 707 | <td> |
  |  | 708 | <?php \_e($vendor\_shipping\_method['title'], 'wc-multivendor-marketplace'); ?> |
  |  | 709 | <div data-instance\_id="<?php echo esc\_attr($vendor\_shipping\_method['instance\_id']); ?>" data-method\_id="<?php echo esc\_attr($vendor\_shipping\_method['id']); ?>" data-method-settings='<?php echo esc\_attr(json\_encode($vendor\_shipping\_method)); ?>' class="row-actions edit\_del\_actions"> |
  |  | 710 | <span class="edit"> |
  |  | 711 | <a href="#" class="edit\_shipping\_method"> |
  |  | 712 | <?php \_e('Edit', 'wc-multivendor-marketplace'); ?> |
  |  | 713 | </a> | |
  |  | 714 | </span> |
  |  | 715 | <span class="delete"> |
  |  | 716 | <a class="delete\_shipping\_method" href="#"> |
  |  | 717 | <?php \_e('Delete', 'wc-multivendor-marketplace'); ?> |
  |  | 718 | </a> |
  |  | 719 | </span> |
  |  | 720 | </div> |
  |  | 721 | </td> |
  |  | 722 | <td> |
  |  | 723 | <?php |
  |  | 724 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 725 | array( |
  |  | 726 | "method\_status" => array( |
  |  | 727 | 'label'   => false, |
  |  | 728 | 'name'    => 'method\_status', |
  |  | 729 | 'type'    => 'checkbox', |
  |  | 730 | 'class'   => 'wcfm-checkbox method\_status input-checkbox wcfm\_ele', |
  |  | 731 | 'value'   => $vendor\_shipping\_method['instance\_id'], |
  |  | 732 | 'dfvalue' => ($vendor\_shipping\_method['enabled'] == "yes") ? $vendor\_shipping\_method['instance\_id'] : 0 |
  |  | 733 | ) |
  |  | 734 | ) |
  |  | 735 | ); |
  |  | 736 | ?> |
  |  | 737 | </td> |
  |  | 738 | <td> |
  |  | 739 | <?php \_e($vendor\_shipping\_method['settings']['description'], 'wc-multivendor-marketplace'); ?> |
  |  | 740 | </td> |
  |  | 741 | </tr> |
  |  | 742 | <?php |
  |  | 743 | } |
  |  | 744 | } |
  |  | 745 | ?> |
  |  | 746 | </tbody> |
  |  | 747 | </table> |
  |  | 748 | </div> |
  |  | 749 | <div class="wcfmmp-zone-method-footer"> |
  |  | 750 | <a href="#" class="wcfmmp-btn wcfmmp-btn-theme wcfmmp-zone-method-add-btn"> |
  |  | 751 | <i class="wcfmfa fa-plus"></i> |
  |  | 752 | <?php \_e('Add Shipping Method', 'wc-multivendor-marketplace') ?> |
  |  | 753 | </a> |
  |  | 754 | </div> |
  |  | 755 | <?php |
  |  | 756 | $WCFMmp->template->get\_template('shipping/wcfmmp-view-edit-method-popup.php'); |
  |  | 757 | $WCFMmp->template->get\_template('shipping/wcfmmp-view-add-method-popup.php'); |
  |  | 758 | ?> |
  |  | 759 | </div> |
  |  | 760 | </div> |
  |  | 761 |  |
  |  | 762 |  |
  |  | 763 | <?php |
  |  | 764 | $zone\_html['html']   = ob\_get\_clean(); |
  |  | 765 | $zone\_html['states'] = json\_encode($states); |
  |  | 766 | $zone\_html['cities'] = json\_encode($cities); |
  |  | 767 | wp\_send\_json\_success($zone\_html); |
  |  | 768 | } |
  |  | 769 |  |
  |  | 770 | /\*\* |
  |  | 771 | \* Add shipping Method |
  |  | 772 | \* |
  |  | 773 | \* @since 1.0.0 |
  |  | 774 | \* |
  |  | 775 | \* @return void |
  |  | 776 | \*/ |
  |  | 777 | public function wcfmmp\_add\_shipping\_method() { |
  |  | 778 |  |
  |  | 779 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 780 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 781 | wp\_die(); |
  |  | 782 | } |
  |  | 783 |  |
  |  | 784 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('wcfm\_vendor') && !current\_user\_can('shop\_staff')) { |
  |  | 785 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 786 | wp\_die(); |
  |  | 787 | } |
  |  | 788 |  |
  |  | 789 | $data = array( |
  |  | 790 | 'zone\_id'   => absint($\_POST['zoneID']), |
  |  | 791 | 'method\_id' => sanitize\_text\_field($\_POST['method']), |
  |  | 792 | 'user\_id'   => isset($\_POST['userID']) ? absint($\_POST['userID']) : 0 |
  |  | 793 | ); |
  |  | 794 |  |
  |  | 795 | $result = WCFMmp\_Shipping\_Zone::add\_shipping\_methods($data); |
  |  | 796 |  |
  |  | 797 | if (is\_wp\_error($result)) { |
  |  | 798 | wp\_send\_json\_error($result->get\_error\_message(), 'wc-multivendor-marketplace'); |
  |  | 799 | } |
  |  | 800 |  |
  |  | 801 | wp\_send\_json\_success(\_\_('Shipping method added successfully', 'wc-multivendor-marketplace')); |
  |  | 802 | } |
  |  | 803 |  |
  |  | 804 | /\*\* |
  |  | 805 | \* Toggle shipping Method |
  |  | 806 | \* |
  |  | 807 | \* @since 1.0.0 |
  |  | 808 | \* |
  |  | 809 | \* @return void |
  |  | 810 | \*/ |
  |  | 811 | public function wcfmmp\_toggle\_shipping\_method() { |
  |  | 812 |  |
  |  | 813 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 814 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 815 | wp\_die(); |
  |  | 816 | } |
  |  | 817 |  |
  |  | 818 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('wcfm\_vendor') && !current\_user\_can('shop\_staff')) { |
  |  | 819 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 820 | wp\_die(); |
  |  | 821 | } |
  |  | 822 |  |
  |  | 823 | //print\_r($\_POST); |
  |  | 824 | $data = array( |
  |  | 825 | 'instance\_id' => sanitize\_text\_field($\_POST['instance\_id']), |
  |  | 826 | 'zone\_id'     => absint($\_POST['zoneID']), |
  |  | 827 | 'user\_id'     => absint($\_POST['userID']), |
  |  | 828 | 'checked'     => ($\_POST['checked'] == 'true') ? 1 : 0 |
  |  | 829 | ); |
  |  | 830 | $result = WCFMmp\_Shipping\_Zone::toggle\_shipping\_method($data); |
  |  | 831 | if (is\_wp\_error($result)) { |
  |  | 832 | wp\_send\_json\_error($result->get\_error\_message()); |
  |  | 833 | } |
  |  | 834 | $message = $data['checked'] ? \_\_('Shipping method enabled successfully',  'wc-multivendor-marketplace') : \_\_('Shipping method disabled successfully',  'wc-multivendor-marketplace'); |
  |  | 835 | wp\_send\_json\_success($message); |
  |  | 836 | } |
  |  | 837 |  |
  |  | 838 | /\*\* |
  |  | 839 | \* Delete shipping Method |
  |  | 840 | \* |
  |  | 841 | \* @since 1.0.0 |
  |  | 842 | \* |
  |  | 843 | \* @return void |
  |  | 844 | \*/ |
  |  | 845 | public function wcfmmp\_delete\_shipping\_method() { |
  |  | 846 |  |
  |  | 847 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 848 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 849 | wp\_die(); |
  |  | 850 | } |
  |  | 851 |  |
  |  | 852 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('wcfm\_vendor') && !current\_user\_can('shop\_staff')) { |
  |  | 853 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 854 | wp\_die(); |
  |  | 855 | } |
  |  | 856 |  |
  |  | 857 | $data = array( |
  |  | 858 | 'zone\_id'     => absint($\_POST['zoneID']), |
  |  | 859 | 'instance\_id' => sanitize\_text\_field($\_POST['instance\_id']), |
  |  | 860 | 'user\_id'     => absint($\_POST['userID']) |
  |  | 861 | ); |
  |  | 862 |  |
  |  | 863 | $result = WCFMmp\_Shipping\_Zone::delete\_shipping\_methods($data); |
  |  | 864 |  |
  |  | 865 | if (is\_wp\_error($result)) { |
  |  | 866 | wp\_send\_json\_error($result->get\_error\_message(), 'wc-multivendor-marketplace'); |
  |  | 867 | } |
  |  | 868 | $resp['msg'] = \_\_('Shipping method deleted', 'wc-multivendor-marketplace'); |
  |  | 869 | $resp['user\_id'] = $data['user\_id']; |
  |  | 870 | wp\_send\_json\_success($resp); |
  |  | 871 | } |
  |  | 872 |  |
  |  | 873 | /\*\* |
  |  | 874 | \* Update shipping Method |
  |  | 875 | \* |
  |  | 876 | \* @since 1.0.0 |
  |  | 877 | \* |
  |  | 878 | \* @return void |
  |  | 879 | \*/ |
  |  | 880 | public function wcfmmp\_update\_shipping\_method() { |
  |  | 881 |  |
  |  | 882 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 883 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 884 | wp\_die(); |
  |  | 885 | } |
  |  | 886 |  |
  |  | 887 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('wcfm\_vendor') && !current\_user\_can('shop\_staff')) { |
  |  | 888 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 889 | wp\_die(); |
  |  | 890 | } |
  |  | 891 |  |
  |  | 892 | //print\_r($\_POST); die; |
  |  | 893 | $args =  wc\_clean(wp\_unslash($\_POST['args'])); |
  |  | 894 | if (empty($args['settings']['title'])) { |
  |  | 895 | wp\_send\_json\_error(\_\_('Shipping title must be required', 'wc-multivendor-marketplace')); |
  |  | 896 | } |
  |  | 897 |  |
  |  | 898 | $result = WCFMmp\_Shipping\_Zone::update\_shipping\_method($args); |
  |  | 899 | if (is\_wp\_error($result)) { |
  |  | 900 | wp\_send\_json\_error($result->get\_error\_message(), 'wc-multivendor-marketplace'); |
  |  | 901 | } |
  |  | 902 | $resp['msg'] = \_\_('Shipping method updated', 'wc-multivendor-marketplace'); |
  |  | 903 | $resp['user\_id'] = $args['user\_id']; |
  |  | 904 | wp\_send\_json\_success($resp); |
  |  | 905 | } |
  |  | 906 |  |
  |  | 907 | public function wcfmmp\_remove\_cart\_vendor\_product() { |
  |  | 908 | global $WCFM; |
  |  | 909 |  |
  |  | 910 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 911 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 912 | wp\_die(); |
  |  | 913 | } |
  |  | 914 |  |
  |  | 915 | $removed\_products = array(); |
  |  | 916 |  |
  |  | 917 | foreach (WC()->cart->get\_cart() as $cart\_item\_key => $item) { |
  |  | 918 | if ($item['data']->needs\_shipping()) { |
  |  | 919 | //print\_r($item['data']->name); die; |
  |  | 920 | $product\_id = $item['product\_id']; |
  |  | 921 | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post($product\_id); |
  |  | 922 | //WC()->cart->remove\_cart\_item($cart\_item\_key); |
  |  | 923 | $vendor\_data = get\_user\_meta($vendor\_id, 'wcfmmp\_profile\_settings', true); |
  |  | 924 | if ($vendor\_data && !empty($vendor\_data['shop\_shipping\_countries'])) { |
  |  | 925 | $shop\_shipping\_countries = $vendor\_data['shop\_shipping\_countries']; |
  |  | 926 | $cust\_shipping\_country = WC()->customer->get\_shipping\_country(); |
  |  | 927 | if (!in\_array($cust\_shipping\_country, $shop\_shipping\_countries)) { |
  |  | 928 | $removed\_products[] = $item['data']->name; |
  |  | 929 | WC()->cart->remove\_cart\_item($cart\_item\_key); |
  |  | 930 | continue; |
  |  | 931 | } |
  |  | 932 | } |
  |  | 933 | } |
  |  | 934 | } |
  |  | 935 | $response = array('items\_removed' => false); |
  |  | 936 | if (!empty($removed\_products)) { |
  |  | 937 | $response['removed\_products'] = implode(', ', $removed\_products); |
  |  | 938 | $response['items\_removed'] = true; |
  |  | 939 | } |
  |  | 940 |  |
  |  | 941 | wp\_send\_json\_success($response); |
  |  | 942 | //die; |
  |  | 943 | } |
  |  | 944 |  |
  |  | 945 | /\*\* |
  |  | 946 | \* Vendor Store Offline |
  |  | 947 | \*/ |
  |  | 948 | function wcfm\_vendor\_store\_offline() { |
  |  | 949 | global $WCFM, $\_POST, $wpdb; |
  |  | 950 |  |
  |  | 951 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 952 | wp\_send\_json\_error(esc\_html\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 953 | wp\_die(); |
  |  | 954 | } |
  |  | 955 |  |
  |  | 956 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('shop\_staff')) { |
  |  | 957 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 958 | wp\_die(); |
  |  | 959 | } |
  |  | 960 |  |
  |  | 961 | if (isset($\_POST['memberid'])) { |
  |  | 962 | $member\_id = absint($\_POST['memberid']); |
  |  | 963 | $vendor\_store = wcfm\_get\_vendor\_store($member\_id); |
  |  | 964 |  |
  |  | 965 | update\_user\_meta($member\_id, '\_wcfm\_store\_offline', 'yes'); |
  |  | 966 |  |
  |  | 967 | // Vendor Notification |
  |  | 968 | $wcfm\_messages = sprintf(\_\_('Your Store: <b>%s</b> has been set off-line.', 'wc-multivendor-marketplace'), $vendor\_store); |
  |  | 969 |  |
  |  | 970 | $raw\_message = [ |
  |  | 971 | 'l10n'    => [ |
  |  | 972 | 'text'         => 'Your Store: <b>%s</b> has been set off-line.', |
  |  | 973 | 'domain'    => 'wc-multivendor-marketplace', |
  |  | 974 | 'wrapper'    => [ |
  |  | 975 | 'function'     => 'sprintf', |
  |  | 976 | 'args'         => [ |
  |  | 977 | $vendor\_store |
  |  | 978 | ] |
  | 147 | 979 | ] |
  | 148 |  | ~~]~~ |
  | 149 | 980 | ] |
  | 150 |  | ]; |
  | 151 |  |  |
  | 152 |  | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message( $vendor\_id, 0, 0, 1, $wcfm\_messages, 'status-update', true, $raw\_message ); |
  | 153 |  | } |
  | 154 |  | } |
  | 155 |  | } |
  | 156 |  | } else { |
  | 157 |  | $wcfm\_messages = sprintf( \_\_( 'Order status updated to <b>%s</b> by <b>%s</b>', 'wc-frontend-manager' ), $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $order\_status ), $shop\_name ); |
  | 158 |  |  |
  | 159 |  | add\_filter( 'woocommerce\_new\_order\_note\_data', array( $WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor' ), 10, 2 ); |
  | 160 |  | $is\_customer\_note = apply\_filters( 'wcfm\_is\_allow\_order\_update\_note\_for\_customer', '1' ); |
  | 161 |  | $comment\_id = $order->add\_order\_note( apply\_filters( 'wcfm\_order\_item\_status\_update\_message', $wcfm\_messages, $order\_id, $vendor\_id, 0 ), $is\_customer\_note); |
  | 162 |  | add\_comment\_meta( $comment\_id, '\_vendor\_id', $vendor\_id ); |
  | 163 |  | remove\_filter( 'woocommerce\_new\_order\_note\_data', array( $WCFM->wcfm\_marketplace, 'wcfm\_update\_comment\_vendor' ), 10, 2 ); |
  | 164 |  |  |
  | 165 |  | if( apply\_filters( 'wcfm\_is\_allow\_order\_update\_note\_for\_admin', true ) ) { |
  | 166 |  | $wcfm\_messages = apply\_filters( 'wcfm\_order\_item\_status\_update\_admin\_message', sprintf( \_\_( '<b>%s</b> order status updated to <b>%s</b> by <b>%s</b>', 'wc-frontend-manager' ), '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $order\_status ), $shop\_name ), $order\_id, $vendor\_id, 0 ); |
  | 167 |  |  |
  | 168 |  | $raw\_message = [ |
  | 169 |  | 'hook'      => [ |
  | 170 |  | 'name'  => 'wcfm\_order\_item\_status\_update\_admin\_message', |
  | 171 |  | 'args'  => [ |
  | 172 |  | $order\_id, |
  | 173 |  | $vendor\_id, |
  | 174 |  | 0 |
  | 175 |  | ] |
  | 176 |  | ], |
  | 177 |  | 'l10n'  => [ |
  | 178 |  | 'text'        => '<b>%s</b> order status updated to <b>%s</b> by <b>%s</b>', |
  | 179 |  | 'domain'    => 'wc-multivendor-marketplace', |
  | 180 |  | 'wrapper' => [ |
  | 181 |  | 'function'  => 'sprintf', |
  | 182 |  | 'args'      => [ |
  | 183 |  | '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', |
  | 184 |  | $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $order\_status ), |
  | 185 |  | $shop\_name |
  |  | 981 | ]; |
  |  | 982 |  |
  |  | 983 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(-1, $member\_id, 1, 0, $wcfm\_messages, 'vendor-disable', true, $raw\_message); |
  |  | 984 |  |
  |  | 985 | do\_action('wcfm\_store\_offline\_after', $member\_id); |
  |  | 986 |  |
  |  | 987 | echo '{"status": true, "message": "' . esc\_html\_\_('Vendor Store Off-line.', 'wc-multivendor-marketplace') . '"}'; |
  |  | 988 | die; |
  |  | 989 | } |
  |  | 990 | } |
  |  | 991 |  |
  |  | 992 | /\*\* |
  |  | 993 | \* Vendor Store Offline |
  |  | 994 | \*/ |
  |  | 995 | function wcfm\_vendor\_store\_online() { |
  |  | 996 | global $WCFM, $\_POST, $wpdb; |
  |  | 997 |  |
  |  | 998 | if (!check\_ajax\_referer('wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false)) { |
  |  | 999 | wp\_send\_json\_error(\_\_('Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager')); |
  |  | 1000 | wp\_die(); |
  |  | 1001 | } |
  |  | 1002 |  |
  |  | 1003 | if (!current\_user\_can('manage\_woocommerce') && !current\_user\_can('shop\_staff')) { |
  |  | 1004 | wp\_send\_json\_error(esc\_html\_\_('You don&#8217;t have permission to do this.', 'woocommerce')); |
  |  | 1005 | wp\_die(); |
  |  | 1006 | } |
  |  | 1007 |  |
  |  | 1008 | if (isset($\_POST['memberid'])) { |
  |  | 1009 | $member\_id = absint($\_POST['memberid']); |
  |  | 1010 | $vendor\_store = wcfm\_get\_vendor\_store($member\_id); |
  |  | 1011 |  |
  |  | 1012 | delete\_user\_meta($member\_id, '\_wcfm\_store\_offline'); |
  |  | 1013 |  |
  |  | 1014 | // Vendor Notification |
  |  | 1015 | $wcfm\_messages = sprintf(\_\_('Your Store: <b>%s</b> has been set on-line.', 'wc-multivendor-marketplace'), $vendor\_store); |
  |  | 1016 |  |
  |  | 1017 | $raw\_message = [ |
  |  | 1018 | 'l10n'    => [ |
  |  | 1019 | 'text'         => 'Your Store: <b>%s</b> has been set on-line.', |
  |  | 1020 | 'domain'    => 'wc-multivendor-marketplace', |
  |  | 1021 | 'wrapper'    => [ |
  |  | 1022 | 'function'     => 'sprintf', |
  |  | 1023 | 'args'         => [ |
  |  | 1024 | $vendor\_store |
  |  | 1025 | ] |
  |  | 1026 | ] |
  | 186 | 1027 | ] |
  | 187 |  | ~~]~~ |
  | 188 |  | ~~]~~ |
  | 189 |  | ~~];~~ |
  | 190 |  |  |
  | 191 |  | ~~$WCFM->wcfm\_notification->wcfm\_send\_direct\_message( -2, 0, 1, 0, $wcfm\_messages, 'status-update', true, $raw\_message );~~ |
  | 192 |  | ~~}~~ |
  | 193 |  | ~~}~~ |
  | 194 |  |  |
  | 195 |  | ~~// Update Main Order status on all Commission Order Status Update~~ |
  | 196 |  | ~~if( in\_array( $status, apply\_filters( 'wcfm\_change\_main\_order\_on\_child\_order\_statuses', array( 'completed', 'processing' ) ) ) && apply\_filters( 'wcfm\_is\_allow\_mark\_complete\_main\_order\_on\_all\_child\_order\_complete', true ) ) {~~ |
  | 197 |  | ~~if ( wc\_is\_order\_status( 'wc-'.$status ) && $order\_id ) {~~ |
  | 198 |  |  |
  | 199 |  | ~~// Check is all vendor orders completed or not~~ |
  | 200 |  | ~~$is\_all\_complete = true;~~ |
  | 201 |  | ~~$sql = 'SELECT commission\_status  FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission';~~ |
  | 202 |  | ~~$sql .= ' WHERE 1=1';~~ |
  | 203 |  | ~~$sql .= " AND `order\_id` = %d";~~ |
  | 204 |  | ~~$commissions = $wpdb->get\_results( $wpdb->prepare( $sql, $order\_id ) );~~ |
  | 205 |  | ~~if( !empty( $commissions ) ) {~~ |
  | 206 |  | ~~foreach( $commissions as $commission ) {~~ |
  | 207 |  | ~~if( $commission->commission\_status != $status ) {~~ |
  | 208 |  | ~~$is\_all\_complete = false;~~ |
  | 209 |  | ~~}~~ |
  | 210 |  | ~~}~~ |
  | 211 |  | ~~}~~ |
  | 212 |  |  |
  | 213 |  | ~~if( $is\_all\_complete ) {~~ |
  | 214 |  | ~~$order->update\_status( $status, '', true );~~ |
  | 215 |  |  |
  | 216 |  | ~~// Add Order Note for Log~~ |
  | 217 |  | ~~$wcfm\_messages = sprintf( \_\_( '<b>%s</b> order status updated to <b>%s</b>', 'wc-multivendor-marketplace' ), '#' . $order->get\_order\_number(), wc\_get\_order\_status\_name( $status ) );~~ |
  | 218 |  |  |
  | 219 |  | ~~$raw\_message = [~~ |
  | 220 |  | ~~'l10n'    => [~~ |
  | 221 |  | ~~'text'      => '<b>%s</b> order status updated to <b>%s</b>',~~ |
  | 222 |  | ~~'domain'    => 'wc-multivendor-marketplace',~~ |
  | 223 |  | ~~'wrapper'   => [~~ |
  | 224 |  | ~~'function'    => 'sprintf',~~ |
  | 225 |  | ~~'args'        => [~~ |
  | 226 |  | ~~'#' . $order->get\_order\_number(),~~ |
  | 227 |  | ~~wc\_get\_order\_status\_name( $status )~~ |
  | 228 |  | ~~]~~ |
  | 229 |  | ~~]~~ |
  | 230 |  | ~~]~~ |
  | 231 | 1028 | ]; |
  | 232 | 1029 |  |
  | 233 |  | $is\_customer\_note = apply\_filters( 'wcfm\_is\_allow\_order\_update\_note\_for\_customer', '1' ); |
  | 234 |  |  |
  | 235 |  | $comment\_id = $order->add\_order\_note( $wcfm\_messages, $is\_customer\_note ); |
  | 236 |  |  |
  | 237 |  | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message( -2, 0, 1, 0, $wcfm\_messages, 'status-update', true, $raw\_message ); |
  | 238 |  |  |
  | 239 |  | do\_action( 'woocommerce\_order\_edit\_status', $order\_id, $status ); |
  | 240 |  | do\_action( 'wcfm\_order\_status\_updated', $order\_id, $status ); |
  | 241 |  | } |
  | 242 |  | } |
  | 243 |  | } |
  | 244 |  |  |
  | 245 |  | if( defined('WCFM\_REST\_API\_CALL') ) { |
  | 246 |  | return '{"status": true, "message": "' . esc\_html\_\_( 'Order status updated.', 'wc-frontend-manager' ) . '"}'; |
  | 247 |  | } |
  | 248 |  |  |
  | 249 |  | echo '{"status": true, "message": "' . esc\_html\_\_( 'Order status updated.', 'wc-frontend-manager' ) . '"}'; |
  | 250 |  | die; |
  | 251 |  | } |
  | 252 |  | } |
  | 253 |  |  |
  | 254 |  | function wcfmmp\_stores\_list\_search() { |
  | 255 |  | global $WCFMmp; |
  | 256 |  |  |
  | 257 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 258 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 259 |  | wp\_die(); |
  | 260 |  | } |
  | 261 |  |  |
  | 262 |  | $search\_term     = isset( $\_REQUEST['search\_term'] ) ? sanitize\_text\_field( $\_REQUEST['search\_term'] ) : ''; |
  | 263 |  | $search\_category = isset( $\_REQUEST['wcfmmp\_store\_category'] ) ? sanitize\_text\_field( $\_REQUEST['wcfmmp\_store\_category'] ) : ''; |
  | 264 |  | $pagination\_base = isset( $\_REQUEST['pagination\_base'] ) ? sanitize\_text\_field( $\_REQUEST['pagination\_base'] ) : ''; |
  | 265 |  | $paged           = 1;                                                                                                             //isset( $\_REQUEST['paged'] ) ? absint( $\_REQUEST['paged'] ) : 1; |
  | 266 |  | $per\_row         = isset( $\_REQUEST['per\_row'] ) ? absint( $\_REQUEST['per\_row'] ) : 3; |
  | 267 |  | $length          = isset( $\_REQUEST['per\_page'] ) ? (int) $\_REQUEST['per\_page'] : 10; |
  | 268 |  | $includes        = isset( $\_REQUEST['includes'] ) ? sanitize\_text\_field( $\_REQUEST['includes'] ) : ''; |
  | 269 |  | $excludes        = isset( $\_REQUEST['excludes'] ) ? sanitize\_text\_field( $\_REQUEST['excludes'] ) : ''; |
  | 270 |  | $orderby         = isset( $\_REQUEST['orderby'] ) ? sanitize\_sql\_orderby( $\_REQUEST['orderby'] ) : 'newness\_asc'; |
  | 271 |  | $has\_orderby     = isset( $\_REQUEST['has\_orderby'] ) ? sanitize\_text\_field( $\_REQUEST['has\_orderby'] ) : ''; |
  | 272 |  | $has\_product     = isset( $\_REQUEST['has\_product'] ) ? sanitize\_text\_field( $\_REQUEST['has\_product'] ) : ''; |
  | 273 |  | $sidebar         = isset( $\_REQUEST['sidebar'] ) ? sanitize\_text\_field( $\_REQUEST['sidebar'] ) : ''; |
  | 274 |  | $theme           = isset( $\_REQUEST['theme'] ) ? sanitize\_text\_field( $\_REQUEST['theme'] ) : 'simple'; |
  | 275 |  | $search\_data     = array(); |
  | 276 |  |  |
  | 277 |  | if( isset( $\_REQUEST['search\_data'] ) ) |
  | 278 |  | parse\_str($\_REQUEST['search\_data'], $search\_data); |
  | 279 |  |  |
  | 280 |  | $search\_data = wc\_clean( wp\_unslash( $search\_data ) ); |
  | 281 |  |  |
  | 282 |  | $offset  = ( $paged - 1 ) \* absint( $length ); |
  | 283 |  |  |
  | 284 |  | $search\_data['excludes'] = $excludes; |
  | 285 |  |  |
  | 286 |  | if( $includes ) $includes = explode(",", $includes); |
  | 287 |  | else $includes = array(); |
  | 288 |  |  |
  | 289 |  | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_get\_vendors( $offset, $length, $search\_term, $includes, 'ASC', 'ID', $search\_data, $search\_category, $has\_product ); |
  | 290 |  |  |
  | 291 |  | $template\_args = apply\_filters( 'wcfmmp\_stores\_args', array( |
  | 292 |  | 'stores'          => $stores, |
  | 293 |  | 'limit'           => $length, |
  | 294 |  | 'offset'          => $offset, |
  | 295 |  | 'paged'           => $paged, |
  | 296 |  | 'includes'        => $includes, |
  | 297 |  | 'excludes'        => $excludes, |
  | 298 |  | 'image\_size'      => 'full', |
  | 299 |  | 'filter'          => 'yes', |
  | 300 |  | 'search'          => 'yes', |
  | 301 |  | 'category'        => 'yes', |
  | 302 |  | 'country'         => 'yes', |
  | 303 |  | 'state'           => 'yes', |
  | 304 |  | 'has\_product'     => $has\_product, |
  | 305 |  | 'search\_query'    => $search\_term, |
  | 306 |  | 'search\_category' => $search\_category, |
  | 307 |  | 'search'          => $search\_term, |
  | 308 |  | 'pagination\_base' => $pagination\_base, |
  | 309 |  | 'orderby'         => $orderby, |
  | 310 |  | 'has\_orderby'     => $has\_orderby, |
  | 311 |  | 'per\_row'         => $per\_row, |
  | 312 |  | 'sidebar'         => $sidebar, |
  | 313 |  | 'theme'           => $theme, |
  | 314 |  | 'search\_data'     => $search\_data |
  | 315 |  | ), $\_REQUEST, $search\_data ); |
  | 316 |  |  |
  | 317 |  | ob\_start(); |
  | 318 |  | $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-loop.php', $template\_args ); |
  | 319 |  | $content = ob\_get\_clean(); |
  | 320 |  |  |
  | 321 |  | wp\_send\_json\_success( $content ); |
  | 322 |  | } |
  | 323 |  |  |
  | 324 |  | function wcfmmp\_stores\_list\_map\_markers() { |
  | 325 |  | global $WCFMmp; |
  | 326 |  |  |
  | 327 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 328 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 329 |  | wp\_die(); |
  | 330 |  | } |
  | 331 |  |  |
  | 332 |  | $search\_term     = isset( $\_REQUEST['search\_term'] ) ? sanitize\_text\_field( $\_REQUEST['search\_term'] ) : ''; |
  | 333 |  | $search\_category = isset( $\_REQUEST['wcfmmp\_store\_category'] ) ? sanitize\_text\_field( $\_REQUEST['wcfmmp\_store\_category'] ) : ''; |
  | 334 |  | $pagination\_base = isset( $\_REQUEST['pagination\_base'] ) ? sanitize\_text\_field( $\_REQUEST['pagination\_base'] ) : ''; |
  | 335 |  | $paged           = isset( $\_REQUEST['paged'] ) ? sanitize\_text\_field( $\_REQUEST['paged'] ) : ''; |
  | 336 |  | $per\_row         = isset( $\_REQUEST['per\_row'] ) ? sanitize\_text\_field( $\_REQUEST['per\_row'] ) : '3'; |
  | 337 |  | $length          = isset( $\_REQUEST['per\_page'] ) ? (int) $\_REQUEST['per\_page'] : 10; |
  | 338 |  | $includes        = isset( $\_REQUEST['includes'] ) ? sanitize\_text\_field( $\_REQUEST['includes'] ) : ''; |
  | 339 |  | $excludes        = isset( $\_REQUEST['excludes'] ) ? sanitize\_text\_field( $\_REQUEST['excludes'] ) : ''; |
  | 340 |  | $has\_product     = isset( $\_REQUEST['has\_product'] ) ? sanitize\_text\_field( $\_REQUEST['has\_product'] ) : ''; |
  | 341 |  | $sidebar         = isset( $\_REQUEST['sidebar'] ) ? sanitize\_text\_field( $\_REQUEST['sidebar'] ) : ''; |
  | 342 |  | //$filter\_vendor   = isset( $\_REQUEST['filter\_vendor'] ) ? sanitize\_text\_field( $\_REQUEST['filter\_vendor'] ) : ''; |
  | 343 |  | $search\_data     = array(); |
  | 344 |  |  |
  | 345 |  | if( isset( $\_POST['search\_data'] ) ) |
  | 346 |  | parse\_str($\_POST['search\_data'], $search\_data); |
  | 347 |  |  |
  | 348 |  | $search\_data = wc\_clean( wp\_unslash( $search\_data ) ); |
  | 349 |  |  |
  | 350 |  | $offset  = ( $paged - 1 ) \* absint( $length ); |
  | 351 |  |  |
  | 352 |  | $search\_data['excludes'] = $excludes; |
  | 353 |  |  |
  | 354 |  | if( $includes ) $includes = explode(",", $includes); |
  | 355 |  | else $includes = array(); |
  | 356 |  |  |
  | 357 |  | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_get\_vendors( $offset, $length, $search\_term, $includes, 'ASC', 'ID', $search\_data, $search\_category, $has\_product ); |
  | 358 |  | $store\_list\_markers = ''; |
  | 359 |  | if ( !empty( $stores )  ) { |
  | 360 |  | foreach ( $stores as $store\_id => $branches ) { |
  | 361 |  | $count = 1; |
  | 362 |  | foreach($branches as $store) { |
  | 363 |  | if( $count > 1 && apply\_filters('wcfmmp\_vendor\_restrict\_to\_single\_map\_marker', true) ) continue; |
  | 364 |  | $store\_user      = wcfmmp\_get\_store( $store\_id ); |
  | 365 |  | $store\_info      = $store\_user->get\_shop\_info(); |
  | 366 |  | $store\_name      = $store['display\_name'] ?? wcfm\_get\_vendor\_store\_name( $store\_id ); |
  | 367 |  | $store\_name      = apply\_filters( 'wcfmmp\_store\_title', esc\_attr($store\_name), $store\_id ); |
  | 368 |  | $store\_url       = wcfmmp\_get\_store\_url( $store\_id ); |
  | 369 |  | if(!empty($store['branch\_id']) && apply\_filters('wcfm\_is\_pref\_multi\_store', true)) { |
  | 370 |  | global $WCFMu; |
  | 371 |  | $store\_address = $WCFMu->wcfmu\_multi\_store->formatted\_store\_address($store); |
  | 372 |  | $store\_lat     = $store['latitude'] ?? $store\_info['store\_lat'] ?? 0; |
  | 373 |  | $store\_lng     = $store['longitude'] ?? $store\_info['store\_lng'] ?? 0; |
  | 374 |  | } else { |
  | 375 |  | $store\_address = $store\_user->get\_address\_string(); |
  | 376 |  | $store\_lat     = isset( $store\_info['store\_lat'] ) ? esc\_attr( $store\_info['store\_lat'] ) : 0; |
  | 377 |  | $store\_lng     = isset( $store\_info['store\_lng'] ) ? esc\_attr( $store\_info['store\_lng'] ) : 0; |
  | 378 |  | } |
  | 379 |  | // $store\_description = $store\_user->get\_shop\_description(); |
  | 380 |  | $gravatar        = $store\_user->get\_avatar(); |
  | 381 |  |  |
  | 382 |  | if( $store\_address && ( ( $store\_info['store\_hide\_address'] == 'yes' ) || !wcfm\_vendor\_has\_capability( $store\_id, 'vendor\_address' ) ) ) { |
  | 383 |  | $store\_address = ''; |
  | 384 |  | } |
  | 385 |  |  |
  | 386 |  | $info\_window\_content =  apply\_filters( 'wcfmmp\_map\_store\_info', "<div class='wcfm\_map\_info\_wrapper'>" . |
  | 387 |  | "<a class='wcfm\_map\_info\_logo' target='\_blank' href='".$store\_url."'><img width='80' src='".$gravatar."' /></a>" . |
  | 388 |  | "<div class='wcfm\_map\_info\_content'>" . |
  | 389 |  | "<a class='wcfm\_map\_info\_store' target='\_blank' href='".$store\_url."'>".$store\_name."</a>" . |
  | 390 |  | "<p class='wcfm\_map\_info\_addr'>".$store\_address."</p>" . |
  | 391 |  | apply\_filters( 'wcfmmp\_map\_additional\_store\_info', '', $store, $store\_id ) . |
  | 392 |  | "</div>" . |
  | 393 |  | "</div>", $store\_id, $store\_user ); |
  | 394 |  |  |
  | 395 |  | $store\_icon = apply\_filters( 'wcfmmp\_map\_store\_icon', esc\_url($WCFMmp->plugin\_url . 'assets/images/wcfmmp\_map\_icon.png'), $store\_id, $store\_user ); |
  | 396 |  |  |
  | 397 |  | if( $store\_lat && $store\_lng ) { |
  | 398 |  | if( $store\_list\_markers ) $store\_list\_markers .= ", "; |
  | 399 |  | $store\_list\_markers .= wp\_unslash('{"name": "' . $store\_name . '", "lat": "' . $store\_lat . '", "lang": "' . $store\_lng. '", "url": "' . $store\_url . '", "address": "' . $store\_address . '", "gravatar": "' . $gravatar . '", "info\_window\_content": "'.$info\_window\_content.'", "icon": "'.$store\_icon.'"}'); |
  | 400 |  |  |
  | 401 |  | } |
  | 402 |  | $count++; |
  | 403 |  | } |
  | 404 |  | } |
  | 405 |  | } |
  | 406 |  | $store\_list\_markers = '['.$store\_list\_markers.']'; |
  | 407 |  |  |
  | 408 |  | wp\_send\_json\_success( $store\_list\_markers ); |
  | 409 |  | } |
  | 410 |  |  |
  | 411 |  | /\*\* |
  | 412 |  | \* Get shipping zone |
  | 413 |  | \* |
  | 414 |  | \* @since 1.0.0 |
  | 415 |  | \* |
  | 416 |  | \* @return void |
  | 417 |  | \*/ |
  | 418 |  | public function wcfmmp\_get\_shipping\_zone() { |
  | 419 |  | global $WCFM, $WCFMmp; |
  | 420 |  |  |
  | 421 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 422 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 423 |  | wp\_die(); |
  | 424 |  | } |
  | 425 |  |  |
  | 426 |  | if ( !current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'wcfm\_vendor' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 427 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 428 |  | wp\_die(); |
  | 429 |  | } |
  | 430 |  |  |
  | 431 |  | if ( isset( $\_POST['zoneID'] ) ) { |
  | 432 |  | $zones = WCFMmp\_Shipping\_Zone::get\_zone( absint($\_POST['zoneID']), absint($\_POST['userID']) ); |
  | 433 |  | //print\_r($zones); die; |
  | 434 |  | } |
  | 435 |  | $show\_post\_code\_list = $show\_state\_list = $show\_post\_code\_list = false; |
  | 436 |  | //print\_r($zones);die; |
  | 437 |  | $zone\_id = $zones['data']['id']; |
  | 438 |  | $user\_id =  absint($\_POST['userID']); |
  | 439 |  | $zone\_locations = $zones['data']['zone\_locations']; |
  | 440 |  | //print\_r($zone\_locations); |
  | 441 |  | $zone\_location\_types = array\_column(array\_map('wcfmmp\_convert\_to\_array', $zone\_locations) , 'type' , 'code'); |
  | 442 |  | //print\_r($zone\_location\_types); |
  | 443 |  | $selected\_continent\_codes = array\_keys($zone\_location\_types, 'continent'); |
  | 444 |  | if( !$selected\_continent\_codes ) $selected\_continent\_codes = array(); |
  | 445 |  |  |
  | 446 |  | $all\_continents = WC()->countries->get\_continents(); |
  | 447 |  | $all\_allowed\_countries = WC()->countries->get\_allowed\_countries(); |
  | 448 |  |  |
  | 449 |  | $countries\_key\_by\_continent = array\_intersect\_key($all\_continents, array\_flip($selected\_continent\_codes)); |
  | 450 |  | if( $countries\_key\_by\_continent ) { |
  | 451 |  | $countries\_key\_by\_continent = call\_user\_func\_array('array\_merge',array\_column( $countries\_key\_by\_continent, 'countries' )); |
  | 452 |  | } else { |
  | 453 |  | $countries\_key\_by\_continent = array(); |
  | 454 |  | } |
  | 455 |  |  |
  | 456 |  | $countries\_by\_continent = array\_intersect\_key($all\_allowed\_countries, array\_flip($countries\_key\_by\_continent)); |
  | 457 |  | //print\_r($all\_allowed\_countries); |
  | 458 |  | $selected\_country\_codes = array\_keys($zone\_location\_types, 'country'); |
  | 459 |  | $all\_states = WC()->countries->get\_states(); |
  | 460 |  |  |
  | 461 |  | $state\_key\_by\_country = array(); |
  | 462 |  | $state\_key\_by\_country = array\_intersect\_key($all\_states, array\_flip($selected\_country\_codes)); |
  | 463 |  | //print\_r($state\_key\_by\_country);die; |
  | 464 |  | array\_walk($state\_key\_by\_country, 'wcfmmp\_state\_key\_alter'); |
  | 465 |  |  |
  | 466 |  | if( $state\_key\_by\_country ) |
  | 467 |  | $state\_key\_by\_country = call\_user\_func\_array('array\_merge', array\_values( $state\_key\_by\_country )); |
  | 468 |  |  |
  | 469 |  |  |
  | 470 |  |  |
  | 471 |  | if( apply\_filters('wcfmmp\_city\_select\_dropdown\_enabled', false ) ) { |
  | 472 |  | global $wc\_city\_select; |
  | 473 |  | $all\_cities = $wc\_city\_select->get\_cities(); |
  | 474 |  | $city\_key\_by\_state = array(); |
  | 475 |  | //print\_r($all\_cities); |
  | 476 |  | $selected\_state\_codes = array\_keys($zone\_location\_types, 'state'); |
  | 477 |  | //$selected\_countywise\_states = array(); |
  | 478 |  | foreach ( $selected\_state\_codes as $key => $value ) { |
  | 479 |  | $country\_state\_arr = explode(':', $value); |
  | 480 |  | $exploded\_country = $country\_state\_arr[0]; |
  | 481 |  | $exploded\_state =  $country\_state\_arr[1]; |
  | 482 |  | if( isset( $all\_cities[$exploded\_country][$exploded\_state] ) ) { |
  | 483 |  | $city\_key\_by\_state = array\_merge($city\_key\_by\_state, $all\_cities[$exploded\_country][$exploded\_state] ); |
  | 484 |  | } |
  | 485 |  |  |
  | 486 |  | } |
  | 487 |  | $city\_key\_by\_state = array\_combine($city\_key\_by\_state, $city\_key\_by\_state); |
  | 488 |  | } |
  | 489 |  |  |
  | 490 |  |  |
  | 491 |  | $show\_limit\_location\_link = apply\_filters( 'show\_limit\_location\_link', (!in\_array('postcode', $zone\_location\_types)) ); |
  | 492 |  | $vendor\_shipping\_methods  = $zones['shipping\_methods']; |
  | 493 |  | $show\_country\_list        = false; |
  | 494 |  | $show\_city\_list           = apply\_filters('wcfmmp\_city\_select\_dropdown\_enabled', false); |
  | 495 |  |  |
  | 496 |  | if($show\_limit\_location\_link) { |
  | 497 |  | if ( in\_array('state', $zone\_location\_types) ) { |
  | 498 |  | $show\_post\_code\_list = true; |
  | 499 |  | } elseif ( in\_array('country', $zone\_location\_types) ) { |
  | 500 |  | $show\_state\_list = true; |
  | 501 |  | $show\_post\_code\_list = true; |
  | 502 |  | } elseif (in\_array('continent', $zone\_location\_types)) { |
  | 503 |  | $show\_country\_list = true; |
  | 504 |  | $show\_state\_list = true; |
  | 505 |  | $show\_post\_code\_list = true; |
  | 506 |  |  |
  | 507 |  | } |
  | 508 |  | } |
  | 509 |  |  |
  | 510 |  | $want\_to\_limit\_location = !empty($zones['locations']); |
  | 511 |  | $countries = $states = $cities = $postcodes = array(); |
  | 512 |  |  |
  | 513 |  | if($want\_to\_limit\_location) { |
  | 514 |  |  |
  | 515 |  | foreach($zones['locations'] as $each\_location ) { |
  | 516 |  | switch ($each\_location['type']) { |
  | 517 |  | case 'country': |
  | 518 |  | $countries[] = $each\_location['code']; |
  | 519 |  | break; |
  | 520 |  | case 'state': |
  | 521 |  | $states[] = $each\_location['code']; |
  | 522 |  | break; |
  | 523 |  | case 'city': |
  | 524 |  | $cities[] = $each\_location['code']; |
  | 525 |  | break; |
  | 526 |  | case 'postcode': |
  | 527 |  | $postcodes[] = $each\_location['code']; |
  | 528 |  | break; |
  | 529 |  | default: |
  | 530 |  | break; |
  | 531 |  | } |
  | 532 |  | } |
  | 533 |  | $postcodes = implode(',', $postcodes); |
  | 534 |  | } |
  | 535 |  | //print\_r($states); |
  | 536 |  |  |
  | 537 |  | ob\_start(); |
  | 538 |  | ?> |
  | 539 |  |  |
  | 540 |  | <div class="zone-component"> |
  | 541 |  | <div class="return-to-zone-list"> |
  | 542 |  | <p> |
  | 543 |  | <a href="#" >&larr; <?php  \_e('Back to Zone List', 'wc-multivendor-marketplace'); ?></a> |
  | 544 |  | </p> |
  | 545 |  | </div> |
  | 546 |  | <form action="" method="post"> |
  | 547 |  | <div class="wcfmmp-form-group wcfmmp-clearfix"> |
  | 548 |  | <p class="wcfm\_title"> |
  | 549 |  | <strong><?php  \_e('Zone Name', 'wc-multivendor-marketplace'); ?></strong> |
  | 550 |  | </p> |
  | 551 |  | <label for="" class="screen-reader-text"> |
  | 552 |  | <?php  \_e('Zone Name', 'wc-multivendor-marketplace'); ?> |
  | 553 |  | </label> |
  | 554 |  | <p class="wcfm\_title"> |
  | 555 |  | <?php  \_e($zones['data']['zone\_name'], 'wc-multivendor-marketplace'); ?> |
  | 556 |  | </p> |
  | 557 |  | </div> |
  | 558 |  | <div class="wcfmmp-form-group wcfmmp-clearfix"> |
  | 559 |  | <p class="wcfm\_title"> |
  | 560 |  | <strong> |
  | 561 |  | <?php  \_e('Zone Location', 'wc-multivendor-marketplace'); ?> |
  | 562 |  | </strong> |
  | 563 |  | </p> |
  | 564 |  | <label for="" class="screen-reader-text"> |
  | 565 |  | <?php  \_e('Zone Location', 'wc-multivendor-marketplace'); ?> |
  | 566 |  | </label> |
  | 567 |  | <p class="wcfm\_title"> |
  | 568 |  | <?php  \_e($zones['formatted\_zone\_location'], 'wc-multivendor-marketplace'); ?> |
  | 569 |  | </p> |
  | 570 |  | </div> |
  | 571 |  |  |
  | 572 |  | <?php |
  | 573 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 574 |  | array ( |
  | 575 |  | "zone\_id" => array( |
  | 576 |  | 'name' => 'wcfmmp\_shipping\_zone['. $zone\_id .'][\_zone\_id]', |
  | 577 |  | 'type' => 'hidden', |
  | 578 |  | 'class' => 'wcfm-hidden input-hidden wcfm\_ele', |
  | 579 |  | 'value' => $zone\_id |
  | 580 |  | ) |
  | 581 |  | ) |
  | 582 |  | ); |
  | 583 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 584 |  | array ( |
  | 585 |  | "user\_vendor\_id" => array( |
  | 586 |  | 'name' => 'wcfmmp\_shipping\_zone['. $user\_id .'][\_user\_id]', |
  | 587 |  | 'type' => 'hidden', |
  | 588 |  | 'class' => 'wcfm-hidden input-hidden wcfm\_ele', |
  | 589 |  | 'value' => $user\_id |
  | 590 |  | ) |
  | 591 |  | ) |
  | 592 |  | ); |
  | 593 |  | if( $show\_limit\_location\_link && $zone\_id !== 0 ) { |
  | 594 |  |  |
  | 595 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 596 |  | array ( |
  | 597 |  | "limit\_zone\_location" => array( |
  | 598 |  | 'label' => \_\_('Limit Zone Location', 'wc-multivendor-marketplace') , |
  | 599 |  | 'name' => 'wcfmmp\_shipping\_zone['. $zone\_id .'][\_limit\_zone\_location]', |
  | 600 |  | 'type' => 'checkbox', |
  | 601 |  | 'class' => 'wcfm-checkbox input-checkbox wcfm\_ele', |
  | 602 |  | 'value' => 1, |
  | 603 |  | 'label\_class' => 'wcfm\_title checkbox\_title', |
  | 604 |  | 'dfvalue' => $want\_to\_limit\_location |
  | 605 |  | ) |
  | 606 |  | ) |
  | 607 |  | ); |
  | 608 |  | } |
  | 609 |  | if( $show\_country\_list ) { |
  | 610 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 611 |  | array( |
  | 612 |  | "select\_zone\_country" => array( |
  | 613 |  | 'label' => \_\_('Select Specific Countries', 'wc-multivendor-marketplace') , |
  | 614 |  | 'name' => 'wcfmmp\_shipping\_zone['. $zone\_id .'][\_select\_zone\_country]', |
  | 615 |  | 'type' => 'select', |
  | 616 |  | 'class' => 'wcfm-select wcfm-select2 wcfm\_ele select\_zone\_country\_select hide\_if\_zone\_not\_limited', |
  | 617 |  | 'label\_class' => 'wcfm\_title select\_title hide\_if\_zone\_not\_limited', |
  | 618 |  | 'attributes' => array( 'multiple' => 'multiple' ), |
  | 619 |  | 'options' => $countries\_by\_continent, |
  | 620 |  | 'value' => $countries |
  | 621 |  | ) |
  | 622 |  | ) |
  | 623 |  | ); |
  | 624 |  | } |
  | 625 |  | if(  $show\_state\_list ) { |
  | 626 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 627 |  | array( |
  | 628 |  | "select\_zone\_states" => array( |
  | 629 |  | 'label' => \_\_('Select Specific States', 'wc-multivendor-marketplace') , |
  | 630 |  | 'name' => 'wcfmmp\_shipping\_zone['. $zone\_id .'][\_select\_zone\_states]', |
  | 631 |  | 'type' => 'select', |
  | 632 |  | 'class' => 'wcfm-select wcfm-select2 wcfm\_ele select\_zone\_states\_select hide\_if\_zone\_not\_limited', |
  | 633 |  | 'label\_class' => 'wcfm\_title select\_title hide\_if\_zone\_not\_limited', |
  | 634 |  | 'attributes' => array( 'multiple' => 'multiple' ), |
  | 635 |  | 'options' => $state\_key\_by\_country, |
  | 636 |  | 'value' => $states |
  | 637 |  | ) |
  | 638 |  | ) |
  | 639 |  | ); |
  | 640 |  | } |
  | 641 |  |  |
  | 642 |  | if( $show\_city\_list ) { |
  | 643 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 644 |  | array( |
  | 645 |  | "select\_zone\_city" => array( |
  | 646 |  | 'label' => \_\_('Select Specific City', 'wc-multivendor-marketplace'), |
  | 647 |  | 'name' => 'wcfmmp\_shipping\_zone['. $zone\_id .'][\_select\_zone\_city]', |
  | 648 |  | 'type' => 'select', |
  | 649 |  | 'class' => 'wcfm-select wcfm-select2 wcfm\_ele select\_zone\_city\_select hide\_if\_zone\_not\_limited', |
  | 650 |  | 'label\_class' => 'wcfm\_title select\_title hide\_if\_zone\_not\_limited', |
  | 651 |  | 'attributes' => array( 'multiple' => 'multiple' ), |
  | 652 |  | 'options' => $city\_key\_by\_state, |
  | 653 |  | 'value' => $cities |
  | 654 |  | ) |
  | 655 |  | ) |
  | 656 |  | ); |
  | 657 |  | } |
  | 658 |  |  |
  | 659 |  | if( $show\_post\_code\_list ) { |
  | 660 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 661 |  | array( |
  | 662 |  | "select\_zone\_postcodes" => array( |
  | 663 |  | 'label' => \_\_('Set your postcode', 'wc-multivendor-marketplace'), |
  | 664 |  | 'name' => 'wcfmmp\_shipping\_zone['. $zone\_id .'][\_select\_zone\_postcodes]', |
  | 665 |  | 'type' => 'text', |
  | 666 |  | 'class' => 'wcfm-text wcfm\_ele hide\_if\_zone\_not\_limited', |
  | 667 |  | 'label\_class' => 'wcfm\_title wcfm\_ele hide\_if\_zone\_not\_limited', |
  | 668 |  | 'desc' => \_\_('Postcodes containing wildcards (e.g. CB23\*) or fully numeric ranges (e.g. 90210...99000) are also supported.', 'wc-multivendor-marketplace'), |
  | 669 |  | 'desc\_class' => 'instructions hide\_if\_zone\_not\_limited', |
  | 670 |  | 'value' => $postcodes |
  | 671 |  | ) |
  | 672 |  | ) |
  | 673 |  | ); |
  | 674 |  | } |
  | 675 |  | ?> |
  | 676 |  | </form> |
  | 677 |  | <div class="wcfmmp-zone-method-wrapper"> |
  | 678 |  | <div class="wcfmmp-zone-method-heading"> |
  | 679 |  | <h2> |
  | 680 |  | <i aria-hidden="true" class="wcfmfa fa-truck"></i> |
  | 681 |  | <?php  \_e('Shipping Method', 'wc-multivendor-marketplace'); ?> |
  | 682 |  | </h2> |
  | 683 |  | <div class="wcfm-clearfix"></div> |
  | 684 |  | <span> |
  | 685 |  | <?php \_e('Add your shipping method for appropiate zone', 'wc-multivendor-marketplace'); ?> |
  | 686 |  | </span> |
  | 687 |  | <div class="wcfm-clearfix"></div> |
  | 688 |  | </div> |
  | 689 |  | <div class="wcfmmp-zone-method-content"> |
  | 690 |  | <table class="wcfmmp-table zone-method-table"> |
  | 691 |  | <thead> |
  | 692 |  | <tr> |
  | 693 |  | <th class="title"><?php  \_e('Method Title', 'wc-multivendor-marketplace'); ?></th> |
  | 694 |  | <th class="enabled"><?php  \_e('Status', 'wc-multivendor-marketplace'); ?></th> |
  | 695 |  | <th class="description"><?php  \_e('Description', 'wc-multivendor-marketplace'); ?></th> |
  | 696 |  | </tr> |
  | 697 |  | </thead> |
  | 698 |  | <tbody> |
  | 699 |  | <?php |
  | 700 |  | if(empty($vendor\_shipping\_methods)) { ?> |
  | 701 |  | <tr> |
  | 702 |  | <td colspan="3"> |
  | 703 |  | <?php \_e('No shipping method found', 'wc-multivendor-marketplace'); ?> |
  | 704 |  | </td> |
  | 705 |  | </tr> |
  | 706 |  | <?php |
  | 707 |  | } else { |
  | 708 |  | //print\_r($vendor\_shipping\_methods); |
  | 709 |  | foreach ( $vendor\_shipping\_methods as $vendor\_shipping\_method ) { |
  | 710 |  | ?> |
  | 711 |  | <tr> |
  | 712 |  | <td> |
  | 713 |  | <?php \_e($vendor\_shipping\_method['title'], 'wc-multivendor-marketplace' ); ?> |
  | 714 |  | <div |
  | 715 |  | data-instance\_id="<?php echo esc\_attr($vendor\_shipping\_method['instance\_id']); ?>" |
  | 716 |  | data-method\_id="<?php echo esc\_attr($vendor\_shipping\_method['id']); ?>" |
  | 717 |  | data-method-settings='<?php echo esc\_attr( json\_encode($vendor\_shipping\_method) ); ?>' |
  | 718 |  | class="row-actions edit\_del\_actions" |
  | 719 |  |  |
  | 720 |  | > |
  | 721 |  | <span class="edit"> |
  | 722 |  | <a href="#" class="edit\_shipping\_method"> |
  | 723 |  | <?php \_e('Edit', 'wc-multivendor-marketplace' ); ?> |
  | 724 |  | </a> | |
  | 725 |  | </span> |
  | 726 |  | <span class="delete"> |
  | 727 |  | <a class="delete\_shipping\_method" href="#"> |
  | 728 |  | <?php \_e('Delete', 'wc-multivendor-marketplace' ); ?> |
  | 729 |  | </a> |
  | 730 |  | </span> |
  | 731 |  | </div> |
  | 732 |  | </td> |
  | 733 |  | <td> |
  | 734 |  | <?php |
  | 735 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 736 |  | array ( |
  | 737 |  | "method\_status" => array( |
  | 738 |  | 'label' => false , |
  | 739 |  | 'name' => 'method\_status', |
  | 740 |  | 'type' => 'checkbox', |
  | 741 |  | 'class' => 'wcfm-checkbox method\_status input-checkbox wcfm\_ele', |
  | 742 |  | 'value' => $vendor\_shipping\_method['instance\_id'], |
  | 743 |  | 'dfvalue' => ( $vendor\_shipping\_method['enabled'] == "yes" ) ? $vendor\_shipping\_method['instance\_id'] : 0 |
  | 744 |  | ) |
  | 745 |  | ) |
  | 746 |  | ); |
  | 747 |  | ?> |
  | 748 |  | </td> |
  | 749 |  | <td> |
  | 750 |  | <?php \_e($vendor\_shipping\_method['settings']['description'], 'wc-multivendor-marketplace' ); ?> |
  | 751 |  | </td> |
  | 752 |  | </tr> |
  | 753 |  | <?php |
  | 754 |  | } |
  | 755 |  | } |
  | 756 |  | ?> |
  | 757 |  | </tbody> |
  | 758 |  | </table> |
  | 759 |  | </div> |
  | 760 |  | <div class="wcfmmp-zone-method-footer"> |
  | 761 |  | <a href="#" class="wcfmmp-btn wcfmmp-btn-theme wcfmmp-zone-method-add-btn"> |
  | 762 |  | <i class="wcfmfa fa-plus"></i> |
  | 763 |  | <?php \_e('Add Shipping Method', 'wc-multivendor-marketplace') ?> |
  | 764 |  | </a> |
  | 765 |  | </div> |
  | 766 |  | <?php |
  | 767 |  | $WCFMmp->template->get\_template( 'shipping/wcfmmp-view-edit-method-popup.php' ); |
  | 768 |  | $WCFMmp->template->get\_template( 'shipping/wcfmmp-view-add-method-popup.php' ); |
  | 769 |  | ?> |
  | 770 |  | </div> |
  | 771 |  | </div> |
  | 772 |  |  |
  | 773 |  |  |
  | 774 |  | <?php |
  | 775 |  | $zone\_html['html'] = ob\_get\_clean(); |
  | 776 |  | $zone\_html['states'] = json\_encode($states); |
  | 777 |  | $zone\_html['cities'] = json\_encode($cities); |
  | 778 |  | wp\_send\_json\_success( $zone\_html ); |
  | 779 |  | } |
  | 780 |  |  |
  | 781 |  | /\*\* |
  | 782 |  | \* Add shipping Method |
  | 783 |  | \* |
  | 784 |  | \* @since 1.0.0 |
  | 785 |  | \* |
  | 786 |  | \* @return void |
  | 787 |  | \*/ |
  | 788 |  | public function wcfmmp\_add\_shipping\_method() { |
  | 789 |  |  |
  | 790 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 791 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 792 |  | wp\_die(); |
  | 793 |  | } |
  | 794 |  |  |
  | 795 |  | if ( !current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'wcfm\_vendor' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 796 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 797 |  | wp\_die(); |
  | 798 |  | } |
  | 799 |  |  |
  | 800 |  | $data = array( |
  | 801 |  | 'zone\_id'   => absint($\_POST['zoneID']), |
  | 802 |  | 'method\_id' => sanitize\_text\_field($\_POST['method']), |
  | 803 |  | 'user\_id' => isset($\_POST['userID']) ? absint($\_POST['userID']) : 0 |
  | 804 |  | ); |
  | 805 |  |  |
  | 806 |  | $result = WCFMmp\_Shipping\_Zone::add\_shipping\_methods( $data ); |
  | 807 |  |  |
  | 808 |  | if ( is\_wp\_error( $result ) ) { |
  | 809 |  | wp\_send\_json\_error( $result->get\_error\_message() , 'wc-multivendor-marketplace' ); |
  | 810 |  | } |
  | 811 |  |  |
  | 812 |  | wp\_send\_json\_success( \_\_( 'Shipping method added successfully', 'wc-multivendor-marketplace' ) ); |
  | 813 |  |  |
  | 814 |  | } |
  | 815 |  |  |
  | 816 |  | /\*\* |
  | 817 |  | \* Toggle shipping Method |
  | 818 |  | \* |
  | 819 |  | \* @since 1.0.0 |
  | 820 |  | \* |
  | 821 |  | \* @return void |
  | 822 |  | \*/ |
  | 823 |  | public function wcfmmp\_toggle\_shipping\_method() { |
  | 824 |  |  |
  | 825 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 826 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 827 |  | wp\_die(); |
  | 828 |  | } |
  | 829 |  |  |
  | 830 |  | if ( !current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'wcfm\_vendor' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 831 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 832 |  | wp\_die(); |
  | 833 |  | } |
  | 834 |  |  |
  | 835 |  | //print\_r($\_POST); |
  | 836 |  | $data = array( |
  | 837 |  | 'instance\_id' => sanitize\_text\_field($\_POST['instance\_id']), |
  | 838 |  | 'zone\_id'     => absint($\_POST['zoneID']), |
  | 839 |  | 'user\_id'     => absint($\_POST['userID']), |
  | 840 |  | 'checked'     => ( $\_POST['checked'] == 'true' ) ? 1 : 0 |
  | 841 |  | ); |
  | 842 |  | $result = WCFMmp\_Shipping\_Zone::toggle\_shipping\_method( $data ); |
  | 843 |  | if ( is\_wp\_error( $result ) ) { |
  | 844 |  | wp\_send\_json\_error( $result->get\_error\_message() ); |
  | 845 |  | } |
  | 846 |  | $message = $data['checked'] ? \_\_( 'Shipping method enabled successfully',  'wc-multivendor-marketplace' ) : \_\_( 'Shipping method disabled successfully',  'wc-multivendor-marketplace' ); |
  | 847 |  | wp\_send\_json\_success( $message ); |
  | 848 |  | } |
  | 849 |  |  |
  | 850 |  | /\*\* |
  | 851 |  | \* Delete shipping Method |
  | 852 |  | \* |
  | 853 |  | \* @since 1.0.0 |
  | 854 |  | \* |
  | 855 |  | \* @return void |
  | 856 |  | \*/ |
  | 857 |  | public function wcfmmp\_delete\_shipping\_method() { |
  | 858 |  |  |
  | 859 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 860 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 861 |  | wp\_die(); |
  | 862 |  | } |
  | 863 |  |  |
  | 864 |  | if ( !current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'wcfm\_vendor' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 865 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 866 |  | wp\_die(); |
  | 867 |  | } |
  | 868 |  |  |
  | 869 |  | $data = array( |
  | 870 |  | 'zone\_id'     => absint($\_POST['zoneID']), |
  | 871 |  | 'instance\_id' => sanitize\_text\_field($\_POST['instance\_id']), |
  | 872 |  | 'user\_id'     => absint($\_POST['userID']) |
  | 873 |  | ); |
  | 874 |  |  |
  | 875 |  | $result = WCFMmp\_Shipping\_Zone::delete\_shipping\_methods( $data ); |
  | 876 |  |  |
  | 877 |  | if ( is\_wp\_error( $result ) ) { |
  | 878 |  | wp\_send\_json\_error( $result->get\_error\_message() , 'wc-multivendor-marketplace' ); |
  | 879 |  | } |
  | 880 |  | $resp['msg'] = \_\_( 'Shipping method deleted', 'wc-multivendor-marketplace' ); |
  | 881 |  | $resp['user\_id'] = $data['user\_id']; |
  | 882 |  | wp\_send\_json\_success( $resp ); |
  | 883 |  | } |
  | 884 |  |  |
  | 885 |  | /\*\* |
  | 886 |  | \* Update shipping Method |
  | 887 |  | \* |
  | 888 |  | \* @since 1.0.0 |
  | 889 |  | \* |
  | 890 |  | \* @return void |
  | 891 |  | \*/ |
  | 892 |  | public function wcfmmp\_update\_shipping\_method() { |
  | 893 |  |  |
  | 894 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 895 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 896 |  | wp\_die(); |
  | 897 |  | } |
  | 898 |  |  |
  | 899 |  | if ( !current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'wcfm\_vendor' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 900 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 901 |  | wp\_die(); |
  | 902 |  | } |
  | 903 |  |  |
  | 904 |  | //print\_r($\_POST); die; |
  | 905 |  | $args =  wc\_clean( wp\_unslash($\_POST['args']) ); |
  | 906 |  | if ( empty( $args['settings']['title'] ) ) { |
  | 907 |  | wp\_send\_json\_error( \_\_( 'Shipping title must be required', 'wc-multivendor-marketplace' ) ); |
  | 908 |  | } |
  | 909 |  |  |
  | 910 |  | $result = WCFMmp\_Shipping\_Zone::update\_shipping\_method( $args ); |
  | 911 |  | if ( is\_wp\_error( $result ) ) { |
  | 912 |  | wp\_send\_json\_error( $result->get\_error\_message() , 'wc-multivendor-marketplace' ); |
  | 913 |  | } |
  | 914 |  | $resp['msg'] = \_\_( 'Shipping method updated', 'wc-multivendor-marketplace' ); |
  | 915 |  | $resp['user\_id'] = $args['user\_id']; |
  | 916 |  | wp\_send\_json\_success( $resp ); |
  | 917 |  |  |
  | 918 |  | } |
  | 919 |  |  |
  | 920 |  | public function wcfmmp\_remove\_cart\_vendor\_product() { |
  | 921 |  | global $WCFM; |
  | 922 |  |  |
  | 923 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 924 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 925 |  | wp\_die(); |
  | 926 |  | } |
  | 927 |  |  |
  | 928 |  | $removed\_products = array(); |
  | 929 |  |  |
  | 930 |  | foreach ( WC()->cart->get\_cart() as $cart\_item\_key => $item) { |
  | 931 |  | if ($item['data']->needs\_shipping()) { |
  | 932 |  | //print\_r($item['data']->name); die; |
  | 933 |  | $product\_id = $item['product\_id']; |
  | 934 |  | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post( $product\_id ); |
  | 935 |  | //WC()->cart->remove\_cart\_item($cart\_item\_key); |
  | 936 |  | $vendor\_data = get\_user\_meta( $vendor\_id, 'wcfmmp\_profile\_settings', true ); |
  | 937 |  | if( $vendor\_data && !empty( $vendor\_data['shop\_shipping\_countries'] ) ) { |
  | 938 |  | $shop\_shipping\_countries = $vendor\_data['shop\_shipping\_countries']; |
  | 939 |  | $cust\_shipping\_country = WC()->customer->get\_shipping\_country(); |
  | 940 |  | if( !in\_array( $cust\_shipping\_country, $shop\_shipping\_countries )  ) { |
  | 941 |  | $removed\_products[] = $item['data']->name; |
  | 942 |  | WC()->cart->remove\_cart\_item($cart\_item\_key); |
  | 943 |  | continue; |
  | 944 |  | } |
  | 945 |  | } |
  | 946 |  | } |
  | 947 |  | } |
  | 948 |  | $response = array ('items\_removed'=> false ); |
  | 949 |  | if(!empty($removed\_products)) { |
  | 950 |  | $response['removed\_products'] = implode(', ', $removed\_products); |
  | 951 |  | $response['items\_removed'] = true; |
  | 952 |  | } |
  | 953 |  |  |
  | 954 |  | wp\_send\_json\_success($response); |
  | 955 |  | //die; |
  | 956 |  | } |
  | 957 |  |  |
  | 958 |  | /\*\* |
  | 959 |  | \* Vendor Store Offline |
  | 960 |  | \*/ |
  | 961 |  | function wcfm\_vendor\_store\_offline() { |
  | 962 |  | global $WCFM, $\_POST, $wpdb; |
  | 963 |  |  |
  | 964 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 965 |  | wp\_send\_json\_error( esc\_html\_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 966 |  | wp\_die(); |
  | 967 |  | } |
  | 968 |  |  |
  | 969 |  | if ( ! current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 970 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 971 |  | wp\_die(); |
  | 972 |  | } |
  | 973 |  |  |
  | 974 |  | if( isset( $\_POST['memberid'] ) ) { |
  | 975 |  | $member\_id = absint( $\_POST['memberid'] ); |
  | 976 |  | $vendor\_store = wcfm\_get\_vendor\_store( $member\_id ); |
  | 977 |  |  |
  | 978 |  | update\_user\_meta( $member\_id, '\_wcfm\_store\_offline', 'yes' ); |
  | 979 |  |  |
  | 980 |  | // Vendor Notification |
  | 981 |  | $wcfm\_messages = sprintf( \_\_( 'Your Store: <b>%s</b> has been set off-line.', 'wc-multivendor-marketplace' ), $vendor\_store ); |
  | 982 |  |  |
  | 983 |  | $raw\_message = [ |
  | 984 |  | 'l10n'  => [ |
  | 985 |  | 'text'        => 'Your Store: <b>%s</b> has been set off-line.', |
  | 986 |  | 'domain'    => 'wc-multivendor-marketplace', |
  | 987 |  | 'wrapper' => [ |
  | 988 |  | 'function'  => 'sprintf', |
  | 989 |  | 'args'      => [ |
  | 990 |  | $vendor\_store |
  | 991 |  | ] |
  | 992 |  | ] |
  | 993 |  | ] |
  | 994 |  | ]; |
  | 995 |  |  |
  | 996 |  | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message( -1, $member\_id, 1, 0, $wcfm\_messages, 'vendor-disable', true, $raw\_message ); |
  | 997 |  |  |
  | 998 |  | do\_action( 'wcfm\_store\_offline\_after', $member\_id ); |
  | 999 |  |  |
  | 1000 |  | echo '{"status": true, "message": "' . esc\_html\_\_( 'Vendor Store Off-line.', 'wc-multivendor-marketplace' ) . '"}'; |
  | 1001 |  | die; |
  | 1002 |  | } |
  | 1003 |  | } |
  | 1004 |  |  |
  | 1005 |  | /\*\* |
  | 1006 |  | \* Vendor Store Offline |
  | 1007 |  | \*/ |
  | 1008 |  | function wcfm\_vendor\_store\_online() { |
  | 1009 |  | global $WCFM, $\_POST, $wpdb; |
  | 1010 |  |  |
  | 1011 |  | if ( ! check\_ajax\_referer( 'wcfm\_ajax\_nonce', 'wcfm\_ajax\_nonce', false ) ) { |
  | 1012 |  | wp\_send\_json\_error( \_\_( 'Invalid nonce! Refresh your page and try again.', 'wc-frontend-manager' ) ); |
  | 1013 |  | wp\_die(); |
  | 1014 |  | } |
  | 1015 |  |  |
  | 1016 |  | if ( ! current\_user\_can( 'manage\_woocommerce' ) && !current\_user\_can( 'shop\_staff' ) ) { |
  | 1017 |  | wp\_send\_json\_error( esc\_html\_\_( 'You don&#8217;t have permission to do this.', 'woocommerce' ) ); |
  | 1018 |  | wp\_die(); |
  | 1019 |  | } |
  | 1020 |  |  |
  | 1021 |  | if( isset( $\_POST['memberid'] ) ) { |
  | 1022 |  | $member\_id = absint( $\_POST['memberid'] ); |
  | 1023 |  | $vendor\_store = wcfm\_get\_vendor\_store( $member\_id ); |
  | 1024 |  |  |
  | 1025 |  | delete\_user\_meta( $member\_id, '\_wcfm\_store\_offline' ); |
  | 1026 |  |  |
  | 1027 |  | // Vendor Notification |
  | 1028 |  | $wcfm\_messages = sprintf( \_\_( 'Your Store: <b>%s</b> has been set on-line.', 'wc-multivendor-marketplace' ), $vendor\_store ); |
  | 1029 |  |  |
  | 1030 |  | $raw\_message = [ |
  | 1031 |  | 'l10n'  => [ |
  | 1032 |  | 'text'        => 'Your Store: <b>%s</b> has been set on-line.', |
  | 1033 |  | 'domain'    => 'wc-multivendor-marketplace', |
  | 1034 |  | 'wrapper' => [ |
  | 1035 |  | 'function'  => 'sprintf', |
  | 1036 |  | 'args'      => [ |
  | 1037 |  | $vendor\_store |
  | 1038 |  | ] |
  | 1039 |  | ] |
  | 1040 |  | ] |
  | 1041 |  | ]; |
  | 1042 |  |  |
  | 1043 |  | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message( -1, $member\_id, 1, 0, $wcfm\_messages, 'vendor-enable', true, $raw\_message ); |
  | 1044 |  |  |
  | 1045 |  | do\_action( 'wcfm\_store\_online\_after', $member\_id ); |
  | 1046 |  |  |
  | 1047 |  | echo '{"status": true, "message": "' . esc\_html\_\_( 'Vendor Store On-line.', 'wc-multivendor-marketplace' ) . '"}'; |
  | 1048 |  | die; |
  | 1049 |  | } |
  | 1050 |  | } |
  |  | 1030 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(-1, $member\_id, 1, 0, $wcfm\_messages, 'vendor-enable', true, $raw\_message); |
  |  | 1031 |  |
  |  | 1032 | do\_action('wcfm\_store\_online\_after', $member\_id); |
  |  | 1033 |  |
  |  | 1034 | echo '{"status": true, "message": "' . esc\_html\_\_('Vendor Store On-line.', 'wc-multivendor-marketplace') . '"}'; |
  |  | 1035 | die; |
  |  | 1036 | } |
  |  | 1037 | } |
  | 1051 | 1038 | } |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php")

  | [r2848338](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L1 "Show revision 2848338 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L1 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  | 2 | 3 | /\*\* |
  | 3 | 4 | \* WCFMmp plugin core |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L9) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L10) |  |
  | 9 | 10 | \* @version   1.0.0 |
  | 10 | 11 | \*/ |
  | 11 |  |  |
  |  | 12 |  |
  |  | 13 | use Automattic\WooCommerce\Utilities\OrderUtil; |
  |  | 14 |  |
  | 12 | 15 | class WCFMmp\_Commission { |
  | 13 | 16 |  |
  | 14 | 17 | public function \_\_construct() { |
  | 15 | 18 | global $WCFM, $WCFMmp; |
  | 16 |  |  |
  |  | 19 |  |
  | 17 | 20 | // Generating Marketplace Order on WC Process Checkout |
  | 18 |  | add\_action(~~'woocommerce\_checkout\_order\_processed', array(&$this, 'wcfmmp\_checkout\_order\_processed'), 30, 3~~ ); |
  | 19 |  |  |
  |  | 21 | add\_action('woocommerce\_checkout\_order\_processed', array(&$this, 'wcfmmp\_checkout\_order\_processed'), 30, 3); |
  |  | 22 |  |
  | 20 | 23 | // Marketplace Manual Order Reset |
  | 21 |  | add\_action(~~'wcfm\_manual\_order\_reset', array(&$this, 'wcfmmp\_commission\_order\_reset'), 30, 2~~ ); |
  | 22 |  |  |
  |  | 24 | add\_action('wcfm\_manual\_order\_reset', array(&$this, 'wcfmmp\_commission\_order\_reset'), 30, 2); |
  |  | 25 |  |
  | 23 | 26 | // Generating Marketplace Order on WCFM Manual Order Process |
  | 24 |  | add\_action(~~'wcfm\_manual\_order\_processed', array(&$this, 'wcfmmp\_checkout\_order\_processed'), 30, 3~~ ); |
  | 25 |  |  |
  |  | 27 | add\_action('wcfm\_manual\_order\_processed', array(&$this, 'wcfmmp\_checkout\_order\_processed'), 30, 3); |
  |  | 28 |  |
  | 26 | 29 | // Recheck Marketplace New Order after WC New Order object update |
  | 27 |  | add\_action(~~'woocommerce\_order\_object\_updated\_props', array( $this, 'wcfmmp\_new\_order\_check' ), 100, 2~~ ); |
  | 28 |  |  |
  |  | 30 | add\_action('woocommerce\_order\_object\_updated\_props', array($this, 'wcfmmp\_new\_order\_check'), 100, 2); |
  |  | 31 |  |
  | 29 | 32 | // WC POS Order Process |
  | 30 |  | add\_action(~~'woocommerce\_pos\_process\_payment', array( $this, 'wcfmmp\_pos\_order\_check' ), 100, 2~~ ); |
  | 31 |  |  |
  |  | 33 | add\_action('woocommerce\_pos\_process\_payment', array($this, 'wcfmmp\_pos\_order\_check'), 100, 2); |
  |  | 34 |  |
  | 32 | 35 | // Generating Marketplace Order for Subscription Renewal Order |
  | 33 |  | add\_filter(~~'wcs\_renewal\_order\_created', array(&$this, 'wcfmmp\_renewal\_order\_processed'), 30, 2~~ ); |
  | 34 |  |  |
  |  | 36 | add\_filter('wcs\_renewal\_order\_created', array(&$this, 'wcfmmp\_renewal\_order\_processed'), 30, 2); |
  |  | 37 |  |
  | 35 | 38 | // YiTH Request Order Process |
  | 36 |  | add\_action(~~'ywraq\_after\_create\_order', array( $this, 'wcfmmp\_checkout\_order\_processed' ), 40, 2~~ ); |
  | 37 |  |  |
  |  | 39 | add\_action('ywraq\_after\_create\_order', array($this, 'wcfmmp\_checkout\_order\_processed'), 40, 2); |
  |  | 40 |  |
  | 38 | 41 | // WC Bookings Manual Booking Order |
  | 39 |  | add\_action(~~'woocommerce\_bookings\_created\_manual\_booking', array(&$this, 'wcfmmp\_manual\_booking\_order\_processed'), 30~~ ); |
  | 40 |  |  |
  |  | 42 | add\_action('woocommerce\_bookings\_created\_manual\_booking', array(&$this, 'wcfmmp\_manual\_booking\_order\_processed'), 30); |
  |  | 43 |  |
  | 41 | 44 | // WC Appointment Manual Appointment Order |
  | 42 |  | add\_action(~~'woocommerce\_appointments\_create\_appointment\_page\_add\_order\_item', array(&$this, 'wcfmmp\_manual\_appointment\_order\_processed'), 30~~ ); |
  | 43 |  |  |
  |  | 45 | add\_action('woocommerce\_appointments\_create\_appointment\_page\_add\_order\_item', array(&$this, 'wcfmmp\_manual\_appointment\_order\_processed'), 30); |
  |  | 46 |  |
  | 44 | 47 | // Update Marketplace Order Status on WC Order Status changed |
  | 45 |  | add\_action(~~'woocommerce\_order\_status\_changed', array(&$this, 'wcfmmp\_order\_status\_changed'), 30, 3~~ ); |
  | 46 |  |  |
  |  | 48 | add\_action('woocommerce\_order\_status\_changed', array(&$this, 'wcfmmp\_order\_status\_changed'), 30, 3); |
  |  | 49 |  |
  | 47 | 50 | // Withdrawal Status Completed |
  | 48 |  | add\_action(~~'wcfmmp\_withdraw\_status\_completed\_by\_commission', array(&$this, 'wcfmmp\_commission\_withdrawal\_id\_update' ), 10, 2~~ ); |
  | 49 |  |  |
  |  | 51 | add\_action('wcfmmp\_withdraw\_status\_completed\_by\_commission', array(&$this, 'wcfmmp\_commission\_withdrawal\_id\_update'), 10, 2); |
  |  | 52 |  |
  | 50 | 53 | // Shipping and Tax Cost Commission Rule Fixed cost Multiply handler |
  | 51 |  | add\_filter('wcfmmmp\_shipping\_commission\_rule', array(&$this, 'wcfmmp\_shipping\_tax\_commission\_rule\_fixed\_handler'~~)~~ ); |
  | 52 |  | add\_filter('wcfmmmp\_tax\_commission\_rule', array(&$this, 'wcfmmp\_shipping\_tax\_commission\_rule\_fixed\_handler'~~)~~ ); |
  | 53 |  |  |
  |  | 54 | add\_filter('wcfmmmp\_shipping\_commission\_rule', array(&$this, 'wcfmmp\_shipping\_tax\_commission\_rule\_fixed\_handler')); |
  |  | 55 | add\_filter('wcfmmmp\_tax\_commission\_rule', array(&$this, 'wcfmmp\_shipping\_tax\_commission\_rule\_fixed\_handler')); |
  |  | 56 |  |
  | 54 | 57 | // Commission on Tax Admin MOde Handler |
  | 55 |  | add\_filter(~~'wcfmmp\_commission\_deducted\_tax', array(&$this, 'wcfmmp\_commission\_deducted\_tax\_admin\_mode\_handler' ), 100, 9~~ ); |
  | 56 |  |  |
  |  | 58 | add\_filter('wcfmmp\_commission\_deducted\_tax', array(&$this, 'wcfmmp\_commission\_deducted\_tax\_admin\_mode\_handler'), 100, 9); |
  |  | 59 |  |
  | 57 | 60 | // On Order Item Refund |
  | 58 |  | add\_action(~~'woocommerce\_order\_refunded', array(&$this, 'wcfmmp\_commission\_order\_item\_refund' ), 30, 2~~ ); |
  | 59 |  |  |
  |  | 61 | add\_action('woocommerce\_order\_refunded', array(&$this, 'wcfmmp\_commission\_order\_item\_refund'), 30, 2); |
  |  | 62 |  |
  | 60 | 63 | // On New Item added to Order |
  | 61 |  | add\_action(~~'woocommerce\_ajax\_order\_items\_added', array(&$this, 'wcfmmp\_commission\_order\_item\_add' ), 30, 2~~ ); |
  | 62 |  |  |
  |  | 64 | add\_action('woocommerce\_ajax\_order\_items\_added', array(&$this, 'wcfmmp\_commission\_order\_item\_add'), 30, 2); |
  |  | 65 |  |
  | 63 | 66 | // On Order Item Edit |
  | 64 |  | add\_action(~~'woocommerce\_saved\_order\_items', array(&$this, 'wcfmmp\_commission\_order\_item\_edit' ), 30, 2~~ ); |
  | 65 |  |  |
  |  | 67 | add\_action('woocommerce\_saved\_order\_items', array(&$this, 'wcfmmp\_commission\_order\_item\_edit'), 30, 2); |
  |  | 68 |  |
  | 66 | 69 | // ON Delete Order Item Delete Commision Order |
  | 67 |  | add\_action(~~'woocommerce\_before\_delete\_order\_item', array(&$this, 'wcfmmp\_commission\_order\_item\_delete' ), 30~~ ); |
  | 68 |  | add\_action(~~'woocommerce\_delete\_order\_item', array(&$this, 'wcfmmp\_commission\_order\_item\_delete' ), 30~~ ); |
  | 69 |  |  |
  |  | 70 | add\_action('woocommerce\_before\_delete\_order\_item', array(&$this, 'wcfmmp\_commission\_order\_item\_delete'), 30); |
  |  | 71 | add\_action('woocommerce\_delete\_order\_item', array(&$this, 'wcfmmp\_commission\_order\_item\_delete'), 30); |
  |  | 72 |  |
  | 70 | 73 | // ON Trashed Order Trash Commision Order |
  | 71 |  | add\_action(~~'woocommerce\_trash\_order', array(&$this, 'wcfmmp\_commission\_order\_trash' ), 30~~ ); |
  | 72 |  | add\_action(~~'wp\_trash\_post', array(&$this, 'wcfmmp\_commission\_order\_trash' ), 30~~ ); |
  | 73 |  |  |
  |  | 74 | add\_action('woocommerce\_trash\_order', array(&$this, 'wcfmmp\_commission\_order\_trash'), 30); |
  |  | 75 | add\_action('wp\_trash\_post', array(&$this, 'wcfmmp\_commission\_order\_trash'), 30); |
  |  | 76 |  |
  | 74 | 77 | // ON Delete Order delete Commision Order |
  | 75 |  | add\_action(~~'woocommerce\_delete\_order', array(&$this, 'wcfmmp\_commission\_order\_delete' ), 30~~ ); |
  | 76 |  | add\_action(~~'before\_delete\_post', array(&$this, 'wcfmmp\_commission\_order\_delete' ), 30~~ ); |
  | 77 |  | } |
  | 78 |  |  |
  |  | 78 | add\_action('woocommerce\_delete\_order', array(&$this, 'wcfmmp\_commission\_order\_delete'), 30); |
  |  | 79 | add\_action('before\_delete\_post', array(&$this, 'wcfmmp\_commission\_order\_delete'), 30); |
  |  | 80 | } |
  |  | 81 |  |
  | 79 | 82 | /\*\* |
  | 80 | 83 | \* WCfM Marketplace Order create on WC Order Process |
  | 81 | 84 | \*/ |
  | 82 |  | public function wcfmmp\_checkout\_order\_processed( $order\_id, $order\_posted, $order = '' ) { |
  | 83 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 84 |  |  |
  | 85 |  | if( !$order\_id ) return; |
  | 86 |  |  |
  | 87 |  | if ( get\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', true ) ) return; |
  | 88 |  |  |
  |  | 85 | public function wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted, $order = '') { |
  |  | 86 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 87 |  |
  |  | 88 | if (!$order\_id) return; |
  |  | 89 |  |
  | 89 | 90 | if (!$order) |
  | 90 |  | $order = wc\_get\_order( $order\_id ); |
  | 91 |  |  |
  | 92 |  | if( !is\_a( $order , 'WC\_Order' ) ) return; |
  | 93 |  |  |
  | 94 |  | $wcfmmp\_order\_processed = false; |
  | 95 |  |  |
  | 96 |  | $customer\_id = 0; |
  | 97 |  | if ( $order->get\_user\_id() ) |
  | 98 |  | $customer\_id = $order->get\_user\_id(); |
  | 99 |  |  |
  | 100 |  | $payment\_method = ! empty( $order->get\_payment\_method() ) ? $order->get\_payment\_method() : ''; |
  | 101 |  | $order\_status = $commission\_status = $order->get\_status(); |
  | 102 |  | $shipping\_status = 'pending'; |
  | 103 |  | $is\_withdrawable = 1; |
  | 104 |  | $is\_auto\_withdrawal = 0; |
  | 105 |  |  |
  | 106 |  | $disallow\_payment\_methods = get\_wcfm\_marketplace\_disallow\_active\_order\_payment\_methods(); |
  | 107 |  | $withdrawal\_reverse = isset( $WCFMmp->wcfmmp\_withdrawal\_options['withdrawal\_reverse'] ) ? 'yes' : ''; |
  | 108 |  | if( $withdrawal\_reverse && !empty( $disallow\_payment\_methods ) && in\_array( $payment\_method, array\_keys( $disallow\_payment\_methods ) ) ) { |
  | 109 |  | $is\_auto\_withdrawal = 1; |
  | 110 |  | } |
  | 111 |  |  |
  | 112 |  | // Set Shipping Status Complete for Virtual Products |
  | 113 |  | if( !$order->get\_formatted\_shipping\_address() ) { |
  | 114 |  | $shipping\_status = 'completed'; |
  | 115 |  | } |
  | 116 |  |  |
  | 117 |  | // Ger Shipping Vendor Packages |
  | 118 |  | $vendor\_shipping = array(); |
  | 119 |  | if( $WCFMmp && $WCFMmp->wcfmmp\_shipping ) { |
  | 120 |  | $vendor\_shipping = $WCFMmp->wcfmmp\_shipping->get\_order\_vendor\_shipping( $order ); |
  | 121 |  | } |
  | 122 |  |  |
  | 123 |  | $items = $order->get\_items( 'line\_item' ); |
  | 124 |  | if( !empty( $items ) ) { |
  | 125 |  |  |
  |  | 91 | $order = wc\_get\_order($order\_id); |
  |  | 92 |  |
  |  | 93 | if (!is\_a($order, 'WC\_Order')) return; |
  |  | 94 |  |
  |  | 95 | if ($order->get\_meta('\_wcfmmp\_order\_processed')) return; |
  |  | 96 |  |
  |  | 97 | $wcfmmp\_order\_processed = false; |
  |  | 98 |  |
  |  | 99 | $customer\_id = 0; |
  |  | 100 | if ($order->get\_user\_id()) |
  |  | 101 | $customer\_id = $order->get\_user\_id(); |
  |  | 102 |  |
  |  | 103 | $payment\_method = !empty($order->get\_payment\_method()) ? $order->get\_payment\_method() : ''; |
  |  | 104 | $order\_status = $commission\_status = $order->get\_status(); |
  |  | 105 | $shipping\_status = 'pending'; |
  |  | 106 | $is\_withdrawable = 1; |
  |  | 107 | $is\_auto\_withdrawal = 0; |
  |  | 108 |  |
  |  | 109 | $disallow\_payment\_methods = get\_wcfm\_marketplace\_disallow\_active\_order\_payment\_methods(); |
  |  | 110 | $withdrawal\_reverse = isset($WCFMmp->wcfmmp\_withdrawal\_options['withdrawal\_reverse']) ? 'yes' : ''; |
  |  | 111 | if ($withdrawal\_reverse && !empty($disallow\_payment\_methods) && in\_array($payment\_method, array\_keys($disallow\_payment\_methods))) { |
  |  | 112 | $is\_auto\_withdrawal = 1; |
  |  | 113 | } |
  |  | 114 |  |
  |  | 115 | // Set Shipping Status Complete for Virtual Products |
  |  | 116 | if (!$order->get\_formatted\_shipping\_address()) { |
  |  | 117 | $shipping\_status = 'completed'; |
  |  | 118 | } |
  |  | 119 |  |
  |  | 120 | // Ger Shipping Vendor Packages |
  |  | 121 | $vendor\_shipping = array(); |
  |  | 122 | if ($WCFMmp && $WCFMmp->wcfmmp\_shipping) { |
  |  | 123 | $vendor\_shipping = $WCFMmp->wcfmmp\_shipping->get\_order\_vendor\_shipping($order); |
  |  | 124 | } |
  |  | 125 |  |
  |  | 126 | $items = $order->get\_items('line\_item'); |
  |  | 127 | if (!empty($items)) { |
  |  | 128 |  |
  | 126 | 129 | $processed\_item = array(); |
  | 127 | 130 | $remaining\_shipping\_cost = $vendor\_shipping; |
  | 128 | 131 | $total\_shipping\_after\_commission = array(); |
  | 129 | 132 |  |
  | 130 |  | foreach~~( $items as $item\_id => $item~~ ) { |
  | 131 |  |  |
  |  | 133 | foreach ($items as $item\_id => $item) { |
  |  | 134 |  |
  | 132 | 135 | $order\_item\_id = $item->get\_id(); |
  | 133 |  |  |
  |  | 136 |  |
  | 134 | 137 | // Check whether order item already processed or not |
  | 135 |  | $order\_item\_processed = wc\_get\_order\_item\_meta(~~$order\_item\_id, '\_wcfmmp\_order\_item\_processed', true~~ ); |
  | 136 |  | if~~( $order\_item\_processed~~ ) continue; |
  | 137 |  |  |
  | 138 |  | $line\_item = new WC\_Order\_Item\_Product(~~$item~~ ); |
  |  | 138 | $order\_item\_processed = wc\_get\_order\_item\_meta($order\_item\_id, '\_wcfmmp\_order\_item\_processed', true); |
  |  | 139 | if ($order\_item\_processed) continue; |
  |  | 140 |  |
  |  | 141 | $line\_item = new WC\_Order\_Item\_Product($item); |
  | 139 | 142 | $product  = $line\_item->get\_product(); |
  | 140 | 143 | $product\_id = $line\_item->get\_product\_id(); |
  | 141 | 144 | $variation\_id = $line\_item->get\_variation\_id(); |
  | 142 |  |  |
  | 143 |  | if~~( $product\_id~~ ) { |
  | 144 |  | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post(~~$product\_id~~ ); |
  | 145 |  |  |
  | 146 |  | if~~( $vendor\_id~~ ) { |
  | 147 |  |  |
  |  | 145 |  |
  |  | 146 | if ($product\_id) { |
  |  | 147 | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post($product\_id); |
  |  | 148 |  |
  |  | 149 | if ($vendor\_id) { |
  |  | 150 |  |
  | 148 | 151 | // Updating Order Item meta with Vendor ID |
  | 149 |  | wc\_update\_order\_item\_meta(~~$order\_item\_id, '\_vendor\_id', $vendor\_id~~ ); |
  | 150 |  |  |
  |  | 152 | wc\_update\_order\_item\_meta($order\_item\_id, '\_vendor\_id', $vendor\_id); |
  |  | 153 |  |
  | 151 | 154 | $discount\_amount   = 0; |
  | 152 | 155 | $discount\_type     = ''; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L160) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L163) |  |
  | 160 | 163 | $total\_commission  = $commission\_tax = $commission\_amount = $tax\_cost = $shipping\_cost = $shipping\_tax = $transaction\_charge = 0; |
  | 161 | 164 | $is\_partially\_refunded = 0; |
  | 162 |  |  |
  |  | 165 |  |
  | 163 | 166 | // Item Refunded Amount |
  | 164 |  | if (~~$refunded\_amount = $order->get\_total\_refunded\_for\_item( absint( $order\_item\_id ) )~~ ) { |
  | 165 |  | $refunded\_qty = $order->get\_qty\_refunded\_for\_item(~~absint( $order\_item\_id )~~ ); |
  |  | 167 | if ($refunded\_amount = $order->get\_total\_refunded\_for\_item(absint($order\_item\_id))) { |
  |  | 168 | $refunded\_qty = $order->get\_qty\_refunded\_for\_item(absint($order\_item\_id)); |
  | 166 | 169 | $refunded\_qty = $refunded\_qty \* -1; |
  | 167 | 170 | $is\_partially\_refunded = 1; |
  | 168 | 171 | $refund\_status = 'completed'; |
  | 169 | 172 | } |
  | 170 |  |  |
  | 171 |  |  |
  | 172 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_bundle\_product\_commission\_support', false )~~ ) { |
  | 173 |  | if~~( $line\_item->get\_subtotal() == 0~~ ) |
  |  | 173 |  |
  |  | 174 |  |
  |  | 175 | if (apply\_filters('wcfmmp\_is\_allow\_bundle\_product\_commission\_support', false)) { |
  |  | 176 | if ($line\_item->get\_subtotal() == 0) |
  | 174 | 177 | continue; |
  | 175 | 178 | } |
  | 176 |  |  |
  |  | 179 |  |
  | 177 | 180 | // Item commission calculation |
  | 178 | 181 | $commission\_rule = ''; |
  | 179 |  | if~~( $WCFMmp->wcfmmp\_vendor->is\_vendor\_deduct\_discount( $vendor\_id, $order\_id )~~ ) { |
  | 180 |  | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule(~~$product\_id, $variation\_id, $vendor\_id, ( $line\_item->get\_total() - $refunded\_amount ), ( $line\_item->get\_quantity() - $refunded\_qty ), $order\_id~~ ); |
  | 181 |  | $commission\_amount = $this->wcfmmp\_get\_order\_item\_commission(~~$order\_id, $vendor\_id, $product\_id, $variation\_id, ( $line\_item->get\_total() - $refunded\_amount ), ( $line\_item->get\_quantity() - $refunded\_qty ), $commission\_rule~~ ); |
  |  | 182 | if ($WCFMmp->wcfmmp\_vendor->is\_vendor\_deduct\_discount($vendor\_id, $order\_id)) { |
  |  | 183 | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule($product\_id, $variation\_id, $vendor\_id, ($line\_item->get\_total() - $refunded\_amount), ($line\_item->get\_quantity() - $refunded\_qty), $order\_id); |
  |  | 184 | $commission\_amount = $this->wcfmmp\_get\_order\_item\_commission($order\_id, $vendor\_id, $product\_id, $variation\_id, ($line\_item->get\_total() - $refunded\_amount), ($line\_item->get\_quantity() - $refunded\_qty), $commission\_rule); |
  | 182 | 185 | $grosse\_total      = $line\_item->get\_total(); |
  | 183 | 186 | $commission\_rule['coupon\_deduct'] = 'yes'; |
  | 184 | 187 | } else { |
  | 185 |  | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule(~~$product\_id, $variation\_id, $vendor\_id, ( $line\_item->get\_subtotal() - $refunded\_amount ), ( $line\_item->get\_quantity() - $refunded\_qty ), $order\_id~~ ); |
  | 186 |  | $commission\_amount = $this->wcfmmp\_get\_order\_item\_commission(~~$order\_id, $vendor\_id, $product\_id, $variation\_id, ( $line\_item->get\_subtotal() - $refunded\_amount ), ( $line\_item->get\_quantity() - $refunded\_qty ), $commission\_rule~~ ); |
  |  | 188 | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule($product\_id, $variation\_id, $vendor\_id, ($line\_item->get\_subtotal() - $refunded\_amount), ($line\_item->get\_quantity() - $refunded\_qty), $order\_id); |
  |  | 189 | $commission\_amount = $this->wcfmmp\_get\_order\_item\_commission($order\_id, $vendor\_id, $product\_id, $variation\_id, ($line\_item->get\_subtotal() - $refunded\_amount), ($line\_item->get\_quantity() - $refunded\_qty), $commission\_rule); |
  | 187 | 190 | $grosse\_total      = $line\_item->get\_subtotal(); |
  | 188 | 191 | } |
  | 189 | 192 | $gross\_sales\_total   = $grosse\_total; |
  | 190 | 193 | $total\_commission    = $commission\_amount; |
  | 191 |  |  |
  | 192 |  | $discount\_amount     = (~~$line\_item->get\_subtotal() - $line\_item->get\_total()~~ ); |
  | 193 |  |  |
  |  | 194 |  |
  |  | 195 | $discount\_amount     = ($line\_item->get\_subtotal() - $line\_item->get\_total()); |
  |  | 196 |  |
  | 194 | 197 | // Shipping commission calculation |
  | 195 |  | if (~~!empty($vendor\_shipping) && isset($vendor\_shipping[$vendor\_id]) && $product->needs\_shipping()~~ ) { |
  | 196 |  |  |
  | 197 |  | $processed\_item[$vendor\_id] = !isset(~~$processed\_item[$vendor\_id]~~ ) ? 1 : ++$processed\_item[$vendor\_id]; |
  | 198 |  |  |
  | 199 |  | if~~( $processed\_item[$vendor\_id] != $vendor\_shipping[$vendor\_id]['package\_qty']~~ ) { |
  |  | 198 | if (!empty($vendor\_shipping) && isset($vendor\_shipping[$vendor\_id]) && $product->needs\_shipping()) { |
  |  | 199 |  |
  |  | 200 | $processed\_item[$vendor\_id] = !isset($processed\_item[$vendor\_id]) ? 1 : ++$processed\_item[$vendor\_id]; |
  |  | 201 |  |
  |  | 202 | if ($processed\_item[$vendor\_id] != $vendor\_shipping[$vendor\_id]['package\_qty']) { |
  | 200 | 203 | $shipping\_cost  = (float) round(($vendor\_shipping[$vendor\_id]['shipping'] / $vendor\_shipping[$vendor\_id]['package\_qty']) \* $line\_item->get\_quantity(), 2); |
  | 201 | 204 | $remaining\_shipping\_cost[$vendor\_id]['shipping'] = $remaining\_shipping\_cost[$vendor\_id]['shipping'] - $shipping\_cost; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L210) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L213) |  |
  | 210 | 213 | $gross\_shipping\_cost = $shipping\_cost; |
  | 211 | 214 | $gross\_shipping\_tax  = $shipping\_tax; |
  | 212 |  | $shipping\_cost       = apply\_filters(~~'wcfmmmp\_commission\_shipping\_cost', ( $shipping\_cost - $refunded\_shipping\_amount ), $vendor\_shipping, $order\_id, $vendor\_id, $product\_id, $commission\_rule~~ ); |
  | 213 |  | $shipping\_tax        = apply\_filters(~~'wcfmmmp\_commission\_shipping\_tax', ( $shipping\_tax - $refunded\_shipping\_tax ), $vendor\_shipping, $order\_id, $vendor\_id, $product\_id, $commission\_rule~~ ); |
  | 214 |  |  |
  |  | 215 | $shipping\_cost       = apply\_filters('wcfmmmp\_commission\_shipping\_cost', ($shipping\_cost - $refunded\_shipping\_amount), $vendor\_shipping, $order\_id, $vendor\_id, $product\_id, $commission\_rule); |
  |  | 216 | $shipping\_tax        = apply\_filters('wcfmmmp\_commission\_shipping\_tax', ($shipping\_tax - $refunded\_shipping\_tax), $vendor\_shipping, $order\_id, $vendor\_id, $product\_id, $commission\_rule); |
  |  | 217 |  |
  | 215 | 218 | // Commission Rule on Shipping Cost - by default false |
  | 216 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_on\_shipping', false )~~ ) { |
  | 217 |  | if~~( isset( $processed\_item[$vendor\_id] )~~ ) { |
  | 218 |  | if~~( $processed\_item[$vendor\_id] != $vendor\_shipping[$vendor\_id]['package\_qty']~~ ) { |
  | 219 |  | $shipping\_cost = round(~~$this->wcfmmp\_generate\_commission\_cost( $shipping\_cost, apply\_filters( 'wcfmmmp\_shipping\_commission\_rule', $commission\_rule ) ), 2~~ ); |
  | 220 |  |  |
  | 221 |  | if~~( ! isset( $total\_shipping\_after\_commission[$vendor\_id] )~~ ) { |
  |  | 219 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_on\_shipping', false)) { |
  |  | 220 | if (isset($processed\_item[$vendor\_id])) { |
  |  | 221 | if ($processed\_item[$vendor\_id] != $vendor\_shipping[$vendor\_id]['package\_qty']) { |
  |  | 222 | $shipping\_cost = round($this->wcfmmp\_generate\_commission\_cost($shipping\_cost, apply\_filters('wcfmmmp\_shipping\_commission\_rule', $commission\_rule)), 2); |
  |  | 223 |  |
  |  | 224 | if (!isset($total\_shipping\_after\_commission[$vendor\_id])) { |
  | 222 | 225 | $total\_shipping\_after\_commission[$vendor\_id] = 0; |
  | 223 | 226 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L225) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L228) |  |
  | 225 | 228 | $total\_shipping\_after\_commission[$vendor\_id] += $shipping\_cost; |
  | 226 | 229 | } else { |
  | 227 |  | $shipping\_cost = round(~~$this->wcfmmp\_generate\_commission\_cost( $vendor\_shipping[$vendor\_id]['shipping'], apply\_filters( 'wcfmmmp\_shipping\_commission\_rule', $commission\_rule ) ) - $total\_shipping\_after\_commission[$vendor\_id], 2~~ ); |
  |  | 230 | $shipping\_cost = round($this->wcfmmp\_generate\_commission\_cost($vendor\_shipping[$vendor\_id]['shipping'], apply\_filters('wcfmmmp\_shipping\_commission\_rule', $commission\_rule)) - $total\_shipping\_after\_commission[$vendor\_id], 2); |
  | 228 | 231 | } |
  | 229 | 232 | } |
  | 230 | 233 |  |
  | 231 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_on\_shipping\_tax', true )~~ ) { |
  | 232 |  | $shipping\_tax  = $this->wcfmmp\_generate\_commission\_cost(~~$shipping\_tax, apply\_filters( 'wcfmmmp\_shipping\_commission\_rule', $commission\_rule )~~ ); |
  |  | 234 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_on\_shipping\_tax', true)) { |
  |  | 235 | $shipping\_tax  = $this->wcfmmp\_generate\_commission\_cost($shipping\_tax, apply\_filters('wcfmmmp\_shipping\_commission\_rule', $commission\_rule)); |
  | 233 | 236 | } |
  | 234 | 237 | } |
  | 235 |  |  |
  |  | 238 |  |
  | 236 | 239 | $commission\_rules['shipping\_for'] = 'admin'; |
  | 237 |  | if~~( $get\_shipping = $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_shipping( $vendor\_id )~~ ) { |
  |  | 240 | if ($get\_shipping = $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_shipping($vendor\_id)) { |
  | 238 | 241 | $grosse\_total       += (float) $gross\_shipping\_cost; |
  | 239 | 242 | $total\_commission += (float) $shipping\_cost; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L241) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L244) |  |
  | 241 | 244 | } |
  | 242 | 245 | $gross\_sales\_total  += (float) $gross\_shipping\_cost; |
  | 243 |  |  |
  |  | 246 |  |
  | 244 | 247 | // Tax commission calculation |
  | 245 | 248 | $gross\_tax\_cost = $line\_item->get\_total\_tax(); |
  | 246 |  | if (~~wc\_tax\_enabled()~~ ) { |
  |  | 249 | if (wc\_tax\_enabled()) { |
  | 247 | 250 | $order\_taxes         = $order->get\_taxes(); |
  | 248 | 251 | $tax\_data = $item->get\_taxes(); |
  | 249 |  | if (~~! empty( $tax\_data )~~ ) { |
  | 250 |  | foreach (~~$order\_taxes as $tax\_item~~ ) { |
  |  | 252 | if (!empty($tax\_data)) { |
  |  | 253 | foreach ($order\_taxes as $tax\_item) { |
  | 251 | 254 | $tax\_item\_id         = $tax\_item['rate\_id']; |
  | 252 |  | $refunded\_total\_tax += $order->get\_tax\_refunded\_for\_item(~~$order\_item\_id, $tax\_item\_id~~ ); |
  |  | 255 | $refunded\_total\_tax += $order->get\_tax\_refunded\_for\_item($order\_item\_id, $tax\_item\_id); |
  | 253 | 256 | } |
  | 254 | 257 | } |
  | 255 | 258 | } |
  | 256 |  | $tax\_cost       = apply\_filters(~~'wcfmmmp\_commission\_tax\_cost', ( $line\_item->get\_total\_tax() - $refunded\_total\_tax ), $commission\_amount, $order\_id, $vendor\_id, $product\_id, $commission\_rule~~ ); |
  | 257 |  |  |
  |  | 259 | $tax\_cost       = apply\_filters('wcfmmmp\_commission\_tax\_cost', ($line\_item->get\_total\_tax() - $refunded\_total\_tax), $commission\_amount, $order\_id, $vendor\_id, $product\_id, $commission\_rule); |
  |  | 260 |  |
  | 258 | 261 | // Commission Rule on Tax Cost - by default false |
  | 259 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_on\_tax', false )~~ ) { |
  | 260 |  | $tax\_cost = $this->wcfmmp\_generate\_commission\_cost(~~$tax\_cost, apply\_filters( 'wcfmmmp\_tax\_commission\_rule', $commission\_rule )~~ ); |
  | 261 |  | } |
  | 262 |  |  |
  |  | 262 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_on\_tax', false)) { |
  |  | 263 | $tax\_cost = $this->wcfmmp\_generate\_commission\_cost($tax\_cost, apply\_filters('wcfmmmp\_tax\_commission\_rule', $commission\_rule)); |
  |  | 264 | } |
  |  | 265 |  |
  | 263 | 266 | $commission\_rules['tax\_for'] = 'admin'; |
  | 264 |  | if~~( $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_tax( $vendor\_id )~~ ) { |
  |  | 267 | if ($WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_tax($vendor\_id)) { |
  | 265 | 268 | $grosse\_total       += (float) $gross\_tax\_cost; |
  | 266 | 269 | $total\_commission += (float) $tax\_cost; |
  | 267 |  | if~~( $get\_shipping && apply\_filters( 'wcfmmp\_is\_allow\_vendor\_get\_shipping\_tax', true )~~ ) { |
  |  | 270 | if ($get\_shipping && apply\_filters('wcfmmp\_is\_allow\_vendor\_get\_shipping\_tax', true)) { |
  | 268 | 271 | $grosse\_total       += (float) $gross\_shipping\_tax; |
  | 269 | 272 | $total\_commission += (float) $shipping\_tax; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L273) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L276) |  |
  | 273 | 276 | $gross\_sales\_total  += (float) $gross\_tax\_cost; |
  | 274 | 277 | $gross\_sales\_total  += (float) $gross\_shipping\_tax; |
  | 275 |  |  |
  |  | 278 |  |
  | 276 | 279 | // Purchase Price |
  | 277 |  | $purchase\_price = get\_post\_meta(~~$product\_id, '\_purchase\_price', true~~ ); |
  | 278 |  | if~~( !$purchase\_price~~ ) $purchase\_price = $product->get\_price(); |
  | 279 |  |  |
  | 280 |  | $is\_auto\_withdrawal = apply\_filters(~~'wcfmmp\_is\_auto\_withdrawal', $is\_auto\_withdrawal, $vendor\_id, $order\_id, $order, $payment\_method~~ ); |
  | 281 |  |  |
  |  | 280 | $purchase\_price = get\_post\_meta($product\_id, '\_purchase\_price', true); |
  |  | 281 | if (!$purchase\_price) $purchase\_price = $product->get\_price(); |
  |  | 282 |  |
  |  | 283 | $is\_auto\_withdrawal = apply\_filters('wcfmmp\_is\_auto\_withdrawal', $is\_auto\_withdrawal, $vendor\_id, $order\_id, $order, $payment\_method); |
  |  | 284 |  |
  | 282 | 285 | // Transaction Charge Calculation |
  | 283 |  | if~~( isset( $commission\_rule['transaction\_charge\_type'] ) && ( $commission\_rule['transaction\_charge\_type'] != 'no' )~~ ) { |
  | 284 |  | $vendor\_order\_amount = $this->wcfmmp\_calculate\_vendor\_order\_commission(~~$vendor\_id, $order\_id, $order, false~~ ); |
  | 285 |  | $vendor\_order\_total\_commission = apply\_filters(~~'wcfmmp\_transaction\_charge\_calculate\_on\_amount', (float)$vendor\_order\_amount['commission\_amount'], $vendor\_id, $product\_id, $order\_id, $gross\_sales\_total, $total\_commission, $commission\_rule~~ ); |
  | 286 |  | $vendor\_order\_total\_item       = apply\_filters(~~'wcfmmp\_transaction\_charge\_calculate\_on\_item\_count', absint( $vendor\_order\_amount['item\_count'] ), $vendor\_id, $product\_id, $order\_id, $gross\_sales\_total, $total\_commission, $commission\_rule~~ ); |
  |  | 286 | if (isset($commission\_rule['transaction\_charge\_type']) && ($commission\_rule['transaction\_charge\_type'] != 'no')) { |
  |  | 287 | $vendor\_order\_amount = $this->wcfmmp\_calculate\_vendor\_order\_commission($vendor\_id, $order\_id, $order, false); |
  |  | 288 | $vendor\_order\_total\_commission = apply\_filters('wcfmmp\_transaction\_charge\_calculate\_on\_amount', (float)$vendor\_order\_amount['commission\_amount'], $vendor\_id, $product\_id, $order\_id, $gross\_sales\_total, $total\_commission, $commission\_rule); |
  |  | 289 | $vendor\_order\_total\_item       = apply\_filters('wcfmmp\_transaction\_charge\_calculate\_on\_item\_count', absint($vendor\_order\_amount['item\_count']), $vendor\_id, $product\_id, $order\_id, $gross\_sales\_total, $total\_commission, $commission\_rule); |
  | 287 | 290 | $total\_transaction\_charge = 0; |
  | 288 |  | if~~( ( $commission\_rule['transaction\_charge\_type'] == 'percent' ) || ( $commission\_rule['transaction\_charge\_type'] == 'percent\_fixed' )~~ ) { |
  | 289 |  | $total\_transaction\_charge  += $vendor\_order\_total\_commission \* (~~(float)$commission\_rule['transaction\_charge\_percent'] / 100~~ ); |
  |  | 291 | if (($commission\_rule['transaction\_charge\_type'] == 'percent') || ($commission\_rule['transaction\_charge\_type'] == 'percent\_fixed')) { |
  |  | 292 | $total\_transaction\_charge  += $vendor\_order\_total\_commission \* ((float)$commission\_rule['transaction\_charge\_percent'] / 100); |
  | 290 | 293 | } |
  | 291 |  | if~~( ( $commission\_rule['transaction\_charge\_type'] == 'fixed' ) || ( $commission\_rule['transaction\_charge\_type'] == 'percent\_fixed' )~~ ) { |
  |  | 294 | if (($commission\_rule['transaction\_charge\_type'] == 'fixed') || ($commission\_rule['transaction\_charge\_type'] == 'percent\_fixed')) { |
  | 292 | 295 | $total\_transaction\_charge  += (float)$commission\_rule['transaction\_charge\_fixed']; |
  | 293 | 296 | } |
  | 294 |  | $total\_transaction\_charge = round(~~$total\_transaction\_charge, 2~~ ); |
  |  | 297 | $total\_transaction\_charge = round($total\_transaction\_charge, 2); |
  | 295 | 298 | $transaction\_charge       = (float) $total\_transaction\_charge / $vendor\_order\_total\_item; |
  | 296 |  | $transaction\_charge       = apply\_filters(~~'wcfmmp\_commission\_deducted\_transaction\_charge', $transaction\_charge, $vendor\_id, $product\_id, $order\_id, $total\_commission, $commission\_rule, $order\_item\_id~~ ); |
  | 297 |  |  |
  |  | 299 | $transaction\_charge       = apply\_filters('wcfmmp\_commission\_deducted\_transaction\_charge', $transaction\_charge, $vendor\_id, $product\_id, $order\_id, $total\_commission, $commission\_rule, $order\_item\_id); |
  |  | 300 |  |
  | 298 | 301 | // $transaction\_charge round check |
  | 299 |  | if~~( !get\_post\_meta( $order\_id, '\_wcfmmp\_vendor\_transacton\_charge\_adjusted\_'.$vendor\_id, true )~~ ) { |
  |  | 302 | if (!$order->get\_meta('\_wcfmmp\_vendor\_transacton\_charge\_adjusted\_' . $vendor\_id)) { |
  | 300 | 303 | $re\_total\_transaction\_charge = round($transaction\_charge, 2) \* $vendor\_order\_total\_item; |
  | 301 |  | if~~( $re\_total\_transaction\_charge != $total\_transaction\_charge~~ ) { |
  | 302 |  | $transaction\_charge += (~~$total\_transaction\_charge - $re\_total\_transaction\_charge~~ ); |
  |  | 304 | if ($re\_total\_transaction\_charge != $total\_transaction\_charge) { |
  |  | 305 | $transaction\_charge += ($total\_transaction\_charge - $re\_total\_transaction\_charge); |
  | 303 | 306 | } |
  | 304 |  | update\_post\_meta( $order\_id, '\_wcfmmp\_vendor\_transacton\_charge\_adjusted\_'.$vendor\_id, 'yes' ); |
  |  | 307 | $order->update\_meta\_data('\_wcfmmp\_vendor\_transacton\_charge\_adjusted\_' . $vendor\_id, 'yes'); |
  |  | 308 | $order->save(); |
  | 305 | 309 | } |
  | 306 |  |  |
  |  | 310 |  |
  | 307 | 311 | $total\_commission      -= (float) $transaction\_charge; |
  | 308 | 312 | } |
  | 309 |  |  |
  |  | 313 |  |
  | 310 | 314 | // Commission Tax Calculation |
  | 311 |  | if~~( isset( $commission\_rule['tax\_enable'] ) && ( $commission\_rule['tax\_enable'] == 'yes' )~~ ) { |
  | 312 |  | $commission\_tax = $total\_commission \* (~~(float)$commission\_rule['tax\_percent'] / 100~~ ); |
  | 313 |  | $commission\_tax = apply\_filters(~~'wcfmmp\_commission\_deducted\_tax', $commission\_tax, $vendor\_id, $product\_id, $variation\_id, $order\_id, $total\_commission, $commission\_rule, $order\_item\_id, 0~~ ); |
  |  | 315 | if (isset($commission\_rule['tax\_enable']) && ($commission\_rule['tax\_enable'] == 'yes')) { |
  |  | 316 | $commission\_tax = $total\_commission \* ((float)$commission\_rule['tax\_percent'] / 100); |
  |  | 317 | $commission\_tax = apply\_filters('wcfmmp\_commission\_deducted\_tax', $commission\_tax, $vendor\_id, $product\_id, $variation\_id, $order\_id, $total\_commission, $commission\_rule, $order\_item\_id, 0); |
  | 314 | 318 | $total\_commission -= (float) $commission\_tax; |
  | 315 | 319 | } |
  | 316 |  |  |
  |  | 320 |  |
  | 317 | 321 | // Withdrawal Charges Calculation |
  | 318 |  | if~~( !$is\_auto\_withdrawal~~ ) { |
  | 319 |  | $withdraw\_charges = $WCFMmp->wcfmmp\_withdraw->calculate\_withdrawal\_charges(~~$total\_commission, $vendor\_id~~ ); |
  | 320 |  | } |
  | 321 |  |  |
  |  | 322 | if (!$is\_auto\_withdrawal) { |
  |  | 323 | $withdraw\_charges = $WCFMmp->wcfmmp\_withdraw->calculate\_withdrawal\_charges($total\_commission, $vendor\_id); |
  |  | 324 | } |
  |  | 325 |  |
  | 322 | 326 | $wpdb->query( |
  | 323 |  | $wpdb->prepare( |
  | 324 |  | "INSERT INTO `{$wpdb->prefix}wcfm\_marketplace\_orders` |
  | 325 |  | ( vendor\_id |
  | 326 |  | , order\_id |
  | 327 |  | , customer\_id |
  | 328 |  | , payment\_method |
  | 329 |  | , product\_id |
  | 330 |  | , variation\_id |
  | 331 |  | , quantity |
  | 332 |  | , product\_price |
  | 333 |  | , purchase\_price |
  | 334 |  | , item\_id |
  | 335 |  | , item\_type |
  | 336 |  | , item\_sub\_total |
  | 337 |  | , item\_total |
  | 338 |  | , shipping |
  | 339 |  | , tax |
  | 340 |  | , shipping\_tax\_amount |
  | 341 |  | , commission\_amount |
  | 342 |  | , discount\_amount |
  | 343 |  | , discount\_type |
  | 344 |  | , other\_amount |
  | 345 |  | , other\_amount\_type |
  | 346 |  | , refunded\_amount |
  | 347 |  | , withdraw\_charges |
  | 348 |  | , total\_commission |
  | 349 |  | , order\_status |
  | 350 |  | , commission\_status |
  | 351 |  | , shipping\_status |
  | 352 |  | , is\_withdrawable |
  | 353 |  | , is\_auto\_withdrawal |
  | 354 |  | , is\_partially\_refunded |
  | 355 |  | , refund\_status |
  | 356 |  | , created |
  | 357 |  | ) VALUES ( %d |
  | 358 |  | , %d |
  | 359 |  | , %d |
  | 360 |  | , %s |
  | 361 |  | , %d |
  | 362 |  | , %d |
  | 363 |  | , %d |
  | 364 |  | , %s |
  | 365 |  | , %s |
  | 366 |  | , %s |
  | 367 |  | , %s |
  | 368 |  | , %s |
  | 369 |  | , %s |
  | 370 |  | , %s |
  | 371 |  | , %s |
  | 372 |  | , %s |
  | 373 |  | , %s |
  | 374 |  | , %s |
  | 375 |  | , %s |
  | 376 |  | , %s |
  | 377 |  | , %s |
  | 378 |  | , %s |
  | 379 |  | , %s |
  | 380 |  | , %s |
  | 381 |  | , %s |
  | 382 |  | , %s |
  | 383 |  | , %s |
  | 384 |  | , %d |
  | 385 |  | , %d |
  | 386 |  | , %d |
  | 387 |  | , %s |
  | 388 |  | , %s |
  | 389 |  | ) ON DUPLICATE KEY UPDATE `item\_id` = %d" |
  | 390 |  | , $vendor\_id |
  | 391 |  | , $order\_id |
  | 392 |  | , $customer\_id |
  | 393 |  | , $payment\_method |
  | 394 |  | , $product\_id |
  | 395 |  | , $variation\_id |
  | 396 |  | , $line\_item->get\_quantity() |
  | 397 |  | , $product->get\_price() |
  | 398 |  | , $purchase\_price |
  | 399 |  | , $order\_item\_id |
  | 400 |  | , $line\_item->get\_type() |
  | 401 |  | , $line\_item->get\_subtotal() |
  | 402 |  | , $line\_item->get\_total() |
  | 403 |  | , $shipping\_cost |
  | 404 |  | , $tax\_cost |
  | 405 |  | , $shipping\_tax |
  | 406 |  | , round($commission\_amount, 2) |
  | 407 |  | , round($discount\_amount, 2) |
  | 408 |  | , $discount\_type |
  | 409 |  | , round($other\_amount, 2) |
  | 410 |  | , $other\_amount\_type |
  | 411 |  | , ( $refunded\_amount + $refunded\_total\_tax + $refunded\_shipping\_amount + $refunded\_shipping\_tax ) |
  | 412 |  | , $withdraw\_charges |
  | 413 |  | , round($total\_commission, 2) |
  | 414 |  | , $order\_status |
  | 415 |  | , $commission\_status |
  | 416 |  | , $shipping\_status |
  | 417 |  | , $is\_withdrawable |
  | 418 |  | , $is\_auto\_withdrawal |
  | 419 |  | , $is\_partially\_refunded |
  | 420 |  | , $refund\_status |
  | 421 |  | , date( 'Y-m-d H:i:s', current\_time( 'timestamp', 0 ) ) |
  | 422 |  | , $order\_item\_id |
  |  | 327 | $wpdb->prepare( |
  |  | 328 | "INSERT INTO `{$wpdb->prefix}wcfm\_marketplace\_orders` |
  |  | 329 | ( |
  |  | 330 | vendor\_id, |
  |  | 331 | order\_id, |
  |  | 332 | customer\_id, |
  |  | 333 | payment\_method, |
  |  | 334 | product\_id, |
  |  | 335 | variation\_id, |
  |  | 336 | quantity, |
  |  | 337 | product\_price, |
  |  | 338 | purchase\_price, |
  |  | 339 | item\_id, |
  |  | 340 | item\_type, |
  |  | 341 | item\_sub\_total, |
  |  | 342 | item\_total, |
  |  | 343 | shipping, |
  |  | 344 | tax, |
  |  | 345 | shipping\_tax\_amount, |
  |  | 346 | commission\_amount, |
  |  | 347 | discount\_amount, |
  |  | 348 | discount\_type, |
  |  | 349 | other\_amount, |
  |  | 350 | other\_amount\_type, |
  |  | 351 | refunded\_amount, |
  |  | 352 | withdraw\_charges, |
  |  | 353 | total\_commission, |
  |  | 354 | order\_status, |
  |  | 355 | commission\_status, |
  |  | 356 | shipping\_status , |
  |  | 357 | is\_withdrawable, |
  |  | 358 | is\_auto\_withdrawal, |
  |  | 359 | is\_partially\_refunded, |
  |  | 360 | refund\_status, |
  |  | 361 | created |
  |  | 362 | ) |
  |  | 363 | VALUES |
  |  | 364 | ( |
  |  | 365 | %d, |
  |  | 366 | %d, |
  |  | 367 | %d, |
  |  | 368 | %s, |
  |  | 369 | %d, |
  |  | 370 | %d , |
  |  | 371 | %d, |
  |  | 372 | %s, |
  |  | 373 | %s, |
  |  | 374 | %s, |
  |  | 375 | %s, |
  |  | 376 | %s, |
  |  | 377 | %s, |
  |  | 378 | %s, |
  |  | 379 | %s, |
  |  | 380 | %s, |
  |  | 381 | %s, |
  |  | 382 | %s, |
  |  | 383 | %s, |
  |  | 384 | %s, |
  |  | 385 | %s, |
  |  | 386 | %s, |
  |  | 387 | %s, |
  |  | 388 | %s, |
  |  | 389 | %s, |
  |  | 390 | %s, |
  |  | 391 | %s, |
  |  | 392 | %d, |
  |  | 393 | %d, |
  |  | 394 | %d, |
  |  | 395 | %s, |
  |  | 396 | %s |
  |  | 397 | ) |
  |  | 398 | ON DUPLICATE KEY UPDATE `item\_id` = %d", |
  |  | 399 | $vendor\_id, |
  |  | 400 | $order\_id, |
  |  | 401 | $customer\_id, |
  |  | 402 | $payment\_method, |
  |  | 403 | $product\_id, |
  |  | 404 | $variation\_id, |
  |  | 405 | $line\_item->get\_quantity(), |
  |  | 406 | $product->get\_price(), |
  |  | 407 | $purchase\_price, |
  |  | 408 | $order\_item\_id, |
  |  | 409 | $line\_item->get\_type(), |
  |  | 410 | $line\_item->get\_subtotal(), |
  |  | 411 | $line\_item->get\_total(), |
  |  | 412 | $shipping\_cost, |
  |  | 413 | $tax\_cost, |
  |  | 414 | $shipping\_tax, |
  |  | 415 | round($commission\_amount, 2), |
  |  | 416 | round($discount\_amount, 2), |
  |  | 417 | $discount\_type, |
  |  | 418 | round($other\_amount, 2), |
  |  | 419 | $other\_amount\_type, |
  |  | 420 | ($refunded\_amount + $refunded\_total\_tax + $refunded\_shipping\_amount + $refunded\_shipping\_tax), |
  |  | 421 | $withdraw\_charges, |
  |  | 422 | round($total\_commission, 2), |
  |  | 423 | $order\_status, |
  |  | 424 | $commission\_status, |
  |  | 425 | $shipping\_status, |
  |  | 426 | $is\_withdrawable, |
  |  | 427 | $is\_auto\_withdrawal, |
  |  | 428 | $is\_partially\_refunded, |
  |  | 429 | $refund\_status, |
  |  | 430 | date('Y-m-d H:i:s', current\_time('timestamp', 0)), |
  |  | 431 | $order\_item\_id |
  | 423 | 432 | ) |
  | 424 | 433 | ); |
  | 425 | 434 | $commission\_id = $wpdb->insert\_id; |
  | 426 |  |  |
  |  | 435 |  |
  | 427 | 436 | // Update Commission Metas |
  | 428 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'currency', $order->get\_currency()~~ ); |
  | 429 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'gross\_total', round($grosse\_total, 2)~~ ); |
  | 430 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'gross\_sales\_total', round($gross\_sales\_total, 2)~~ ); |
  | 431 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'gross\_shipping\_cost', round($gross\_shipping\_cost, 2)~~ ); |
  | 432 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'gross\_shipping\_tax', round($gross\_shipping\_tax, 2)~~ ); |
  | 433 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'gross\_tax\_cost', round($gross\_tax\_cost, 2)~~ ); |
  | 434 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'commission\_tax', round($commission\_tax, 2)~~ ); |
  | 435 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'transaction\_charge', round($transaction\_charge, 2)~~ ); |
  | 436 |  | $this->wcfmmp\_update\_commission\_meta(~~$commission\_id, 'commission\_rule', serialize( $commission\_rule )~~ ); |
  | 437 |  |  |
  | 438 |  | do\_action(~~'wcfmmp\_order\_item\_processed', $commission\_id, $order\_id, $order, $vendor\_id, $product\_id, $order\_item\_id, $grosse\_total, $total\_commission, $is\_auto\_withdrawal, $commission\_rule~~ ); |
  | 439 |  |  |
  |  | 437 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'currency', $order->get\_currency()); |
  |  | 438 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'gross\_total', round($grosse\_total, 2)); |
  |  | 439 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'gross\_sales\_total', round($gross\_sales\_total, 2)); |
  |  | 440 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'gross\_shipping\_cost', round($gross\_shipping\_cost, 2)); |
  |  | 441 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'gross\_shipping\_tax', round($gross\_shipping\_tax, 2)); |
  |  | 442 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'gross\_tax\_cost', round($gross\_tax\_cost, 2)); |
  |  | 443 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'commission\_tax', round($commission\_tax, 2)); |
  |  | 444 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'transaction\_charge', round($transaction\_charge, 2)); |
  |  | 445 | $this->wcfmmp\_update\_commission\_meta($commission\_id, 'commission\_rule', serialize($commission\_rule)); |
  |  | 446 |  |
  |  | 447 | do\_action('wcfmmp\_order\_item\_processed', $commission\_id, $order\_id, $order, $vendor\_id, $product\_id, $order\_item\_id, $grosse\_total, $total\_commission, $is\_auto\_withdrawal, $commission\_rule); |
  |  | 448 |  |
  | 440 | 449 | // Updating Order Item meta processed |
  | 441 |  | wc\_update\_order\_item\_meta(~~$order\_item\_id, '\_wcfmmp\_order\_item\_processed', $commission\_id~~ ); |
  | 442 |  | } |
  | 443 |  |  |
  |  | 450 | wc\_update\_order\_item\_meta($order\_item\_id, '\_wcfmmp\_order\_item\_processed', $commission\_id); |
  |  | 451 | } |
  |  | 452 |  |
  | 444 | 453 | $wcfmmp\_order\_processed = true; |
  | 445 | 454 | } |
  | 446 |  |  |
  |  | 455 |  |
  | 447 | 456 | // Affiliate Unset from Session |
  | 448 |  | if( apply\_filters( 'wcfmmp\_is\_allow\_reset\_affiliate\_after\_order\_process', false ) && WC()->session && WC()->session->get( 'wcfm\_affiliate' ) ) { |
  | 449 |  | WC()->session->\_\_unset( 'wcfm\_affiliate' ); |
  | 450 |  | } |
  | 451 |  | } |
  | 452 |  | } |
  | 453 |  |  |
  | 454 |  | if( $wcfmmp\_order\_processed ) { |
  | 455 |  | update\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', 'yes' ); |
  | 456 |  |  |
  | 457 |  | $wcfmmp\_order\_email\_triggered = get\_post\_meta( $order\_id, '\_wcfmmp\_order\_email\_triggered', true ); |
  | 458 |  | if( !$wcfmmp\_order\_email\_triggered ) { |
  |  | 457 | if (apply\_filters('wcfmmp\_is\_allow\_reset\_affiliate\_after\_order\_process', false) && WC()->session && WC()->session->get('wcfm\_affiliate')) { |
  |  | 458 | WC()->session->\_\_unset('wcfm\_affiliate'); |
  |  | 459 | } |
  |  | 460 | } |
  |  | 461 | } |
  |  | 462 |  |
  |  | 463 | if ($wcfmmp\_order\_processed) { |
  |  | 464 | $order->update\_meta\_data('\_wcfmmp\_order\_processed', 'yes'); |
  |  | 465 | $order->save(); |
  |  | 466 |  |
  |  | 467 | $wcfmmp\_order\_email\_triggered = $order->get\_meta('\_wcfmmp\_order\_email\_triggered'); |
  |  | 468 | if (!$wcfmmp\_order\_email\_triggered) { |
  | 459 | 469 | $store\_new\_order\_email\_allowed\_order\_status = get\_wcfm\_store\_new\_order\_email\_allowed\_order\_status(); |
  | 460 |  | $current\_order\_status = 'wc-'~~.~~$order\_status; |
  | 461 |  | if~~( isset( $store\_new\_order\_email\_allowed\_order\_status[$current\_order\_status] )~~ ) { |
  |  | 470 | $current\_order\_status = 'wc-' . $order\_status; |
  |  | 471 | if (isset($store\_new\_order\_email\_allowed\_order\_status[$current\_order\_status])) { |
  | 462 | 472 | $wcfmmp\_email = WC()->mailer()->emails['WCFMmp\_Email\_Store\_new\_order']; |
  | 463 |  | if( $wcfmmp\_email ) { |
  | 464 |  | $wcfmmp\_email->trigger( $order\_id ); |
  | 465 |  | update\_post\_meta( $order\_id, '\_wcfmmp\_order\_email\_triggered', 'yes' ); |
  | 466 |  | } |
  | 467 |  | } |
  | 468 |  | } |
  | 469 |  |  |
  | 470 |  | do\_action( 'wcfmmp\_order\_processed', $order\_id, $is\_auto\_withdrawal ); |
  | 471 |  | } |
  | 472 |  |  |
  |  | 473 | if ($wcfmmp\_email) { |
  |  | 474 | $wcfmmp\_email->trigger($order\_id); |
  |  | 475 | $order->update\_meta\_data('\_wcfmmp\_order\_email\_triggered', 'yes'); |
  |  | 476 | $order->save(); |
  |  | 477 | } |
  |  | 478 | } |
  |  | 479 | } |
  |  | 480 |  |
  |  | 481 | do\_action('wcfmmp\_order\_processed', $order\_id, $is\_auto\_withdrawal); |
  |  | 482 | } |
  |  | 483 |  |
  | 473 | 484 | return; |
  | 474 | 485 | } |
  | 475 |  |  |
  |  | 486 |  |
  | 476 | 487 | /\*\* |
  | 477 | 488 | \* Generate payment arguments for Stripe Split Pay. |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L481) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L492) |  |
  | 481 | 492 | \* @return array  Stripe Split Pay payment arguments. |
  | 482 | 493 | \*/ |
  | 483 |  | public function wcfmmp\_split\_pay\_vendor\_list(~~$order, $postData, $split\_method = 'stripe'~~ ) { |
  |  | 494 | public function wcfmmp\_split\_pay\_vendor\_list($order, $postData, $split\_method = 'stripe') { |
  | 484 | 495 | global $WCFM, $WCFMmp; |
  | 485 | 496 | $args = array(); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L488) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L499) |  |
  | 488 | 499 | $total\_vendor\_commission = 0; |
  | 489 | 500 | $vendor\_wise\_gross\_sales = $this->wcfmmp\_split\_pay\_vendor\_wise\_gross\_sales($order); |
  | 490 |  |  |
  | 491 |  | if~~( $vendor\_wise\_gross\_sales && is\_array($vendor\_wise\_gross\_sales)~~ ) { |
  | 492 |  | foreach~~( $vendor\_wise\_gross\_sales as $vendor\_id => $distribution\_info~~ ) { |
  | 493 |  | $vendor\_payment\_method = $WCFMmp->wcfmmp\_vendor->get\_vendor\_payment\_method(~~$vendor\_id~~ ); |
  | 494 |  | if~~( ( $vendor\_payment\_method == $split\_method ) && apply\_filters( 'wcfmmp\_is\_allow\_vendor\_'.$split\_method.'\_split\_pay', true, $vendor\_id )~~ ) { |
  | 495 |  |  |
  |  | 501 |  |
  |  | 502 | if ($vendor\_wise\_gross\_sales && is\_array($vendor\_wise\_gross\_sales)) { |
  |  | 503 | foreach ($vendor\_wise\_gross\_sales as $vendor\_id => $distribution\_info) { |
  |  | 504 | $vendor\_payment\_method = $WCFMmp->wcfmmp\_vendor->get\_vendor\_payment\_method($vendor\_id); |
  |  | 505 | if (($vendor\_payment\_method == $split\_method) && apply\_filters('wcfmmp\_is\_allow\_vendor\_' . $split\_method . '\_split\_pay', true, $vendor\_id)) { |
  |  | 506 |  |
  | 496 | 507 | $vendor\_connected = 0; |
  | 497 | 508 | $vendor\_connect\_user\_id = ''; |
  | 498 |  |  |
  | 499 |  | switch~~( $split\_method~~ ) { |
  |  | 509 |  |
  |  | 510 | switch ($split\_method) { |
  | 500 | 511 | case 'stripe': |
  | 501 |  | ~~$vendor\_connected = get\_user\_meta( $vendor\_id, 'vendor\_connected', true~~ ); |
  | 502 |  | ~~$vendor\_connect\_user\_id = get\_user\_meta( $vendor\_id, 'stripe\_user\_id', true~~ ); |
  | 503 |  | break; |
  | 504 |  |  |
  |  | 512 | $vendor\_connected = get\_user\_meta($vendor\_id, 'vendor\_connected', true); |
  |  | 513 | $vendor\_connect\_user\_id = get\_user\_meta($vendor\_id, 'stripe\_user\_id', true); |
  |  | 514 | break; |
  |  | 515 |  |
  | 505 | 516 | case 'wirecard': |
  | 506 |  | $vendor\_connected       = get\_user\_meta(~~$vendor\_id, 'vendor\_wirecard\_token', true~~ ); |
  | 507 |  | $vendor\_connect\_user\_id = get\_user\_meta(~~$vendor\_id, 'vendor\_wirecard\_account', true~~ ); |
  |  | 517 | $vendor\_connected       = get\_user\_meta($vendor\_id, 'vendor\_wirecard\_token', true); |
  |  | 518 | $vendor\_connect\_user\_id = get\_user\_meta($vendor\_id, 'vendor\_wirecard\_account', true); |
  | 508 | 519 | break; |
  | 509 | 520 | } |
  | 510 |  |  |
  | 511 |  | if~~( $vendor\_connected && $vendor\_connect\_user\_id~~ ) { |
  | 512 |  | $vendor\_order\_amount = $this->wcfmmp\_calculate\_vendor\_order\_commission(~~$vendor\_id, $order->get\_id(), $order~~ ); |
  | 513 |  | $vendor\_commission = round(~~$vendor\_order\_amount['commission\_amount'], 2~~ ); |
  |  | 521 |  |
  |  | 522 | if ($vendor\_connected && $vendor\_connect\_user\_id) { |
  |  | 523 | $vendor\_order\_amount = $this->wcfmmp\_calculate\_vendor\_order\_commission($vendor\_id, $order->get\_id(), $order); |
  |  | 524 | $vendor\_commission = round($vendor\_order\_amount['commission\_amount'], 2); |
  | 514 | 525 | //wcfm\_stripe\_log( "Stripe Split Pay:: #" . $order->get\_id() . " => " . $vendor\_id . " => " . $vendor\_commission ); |
  | 515 |  | if~~( $vendor\_commission > 0~~ ) { |
  |  | 526 | if ($vendor\_commission > 0) { |
  | 516 | 527 | $split\_payers[$vendor\_id] = array( |
  | 517 | 528 | 'destination' => $vendor\_connect\_user\_id, |
  | 518 | 529 | 'commission'  => $vendor\_commission, |
  | 519 | 530 | ); |
  | 520 |  | if~~( isset( $vendor\_wise\_gross\_sales[$vendor\_id] ) ) $split\_payers[$vendor\_id]['gross\_sales'] = round( $vendor\_wise\_gross\_sales[$vendor\_id], 2~~ ); |
  |  | 531 | if (isset($vendor\_wise\_gross\_sales[$vendor\_id])) $split\_payers[$vendor\_id]['gross\_sales'] = round($vendor\_wise\_gross\_sales[$vendor\_id], 2); |
  | 521 | 532 | } |
  | 522 | 533 | $total\_vendor\_commission += $vendor\_commission; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L530) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L541) |  |
  | 530 | 541 | $args = array( |
  | 531 | 542 | 'total\_amount'   => number\_format($order->get\_total(), 2, '.', ''), |
  | 532 |  | 'stripe\_source'  => isset(~~$postData['stripe\_source']~~ ) ? $postData['stripe\_source'] : '', |
  | 533 |  | 'stripe\_token'   => isset(~~$postData['stripe\_token']~~ ) ? $postData['stripe\_token'] : array(), |
  |  | 543 | 'stripe\_source'  => isset($postData['stripe\_source']) ? $postData['stripe\_source'] : '', |
  |  | 544 | 'stripe\_token'   => isset($postData['stripe\_token']) ? $postData['stripe\_token'] : array(), |
  | 534 | 545 | 'currency'       => $order->get\_currency(), |
  | 535 | 546 | 'transfer\_group' => \_\_('Split Pay for Order #', 'wc-multivendor-marketplace') . $order->get\_order\_number(), |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L538) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L549) |  |
  | 538 | 549 |  |
  | 539 | 550 | $args['distribution\_list'] = $split\_payers; |
  | 540 |  |  |
  | 541 |  | $args = apply\_filters(~~'wcfmmp\_'.$split\_method.'\_split\_pay\_payment\_args', $args, $order~~ ); |
  |  | 551 |  |
  |  | 552 | $args = apply\_filters('wcfmmp\_' . $split\_method . '\_split\_pay\_payment\_args', $args, $order); |
  | 542 | 553 |  |
  | 543 | 554 | return $args; |
  | 544 | 555 | } |
  | 545 |  |  |
  |  | 556 |  |
  | 546 | 557 | public function wcfmmp\_split\_pay\_vendor\_wise\_gross\_sales($order) { |
  | 547 | 558 | global $WCFM, $WCFMmp; |
  | 548 |  |  |
  |  | 559 |  |
  | 549 | 560 | $vendor\_wise\_gross\_sales = array(); |
  | 550 |  | if(!$order) { |
  |  | 561 | if (!$order) { |
  | 551 | 562 | return $vendor\_wise\_gross\_sales; |
  | 552 | 563 | } |
  | 553 |  |  |
  |  | 564 |  |
  | 554 | 565 | $items = $order->get\_items('line\_item'); |
  | 555 | 566 | foreach ($items as $order\_item\_id => $item) { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L557) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L568) |  |
  | 557 | 568 | $product\_id = $line\_item->get\_product\_id(); |
  | 558 | 569 | if ($product\_id) { |
  | 559 |  | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post(~~$product\_id~~ ); |
  | 560 |  | if~~( $vendor\_id~~ ) { |
  |  | 570 | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post($product\_id); |
  |  | 571 | if ($vendor\_id) { |
  | 561 | 572 | $line\_item\_total = $line\_item->get\_total() + $line\_item->get\_total\_tax(); |
  | 562 | 573 |  |
  | 563 |  | if(isset($vendor\_wise\_gross\_sales[$vendor\_id])) $vendor\_wise\_gross\_sales[$vendor\_id] = $vendor\_wise\_gross\_sales[$vendor\_id] + $line\_item\_total; |
  |  | 574 | if (isset($vendor\_wise\_gross\_sales[$vendor\_id])) $vendor\_wise\_gross\_sales[$vendor\_id] = $vendor\_wise\_gross\_sales[$vendor\_id] + $line\_item\_total; |
  | 564 | 575 | else $vendor\_wise\_gross\_sales[$vendor\_id] = $line\_item\_total; |
  | 565 | 576 | } |
  | 566 | 577 | } |
  | 567 | 578 | } |
  | 568 |  |  |
  |  | 579 |  |
  | 569 | 580 | $shipping\_items = $order->get\_items('shipping'); |
  | 570 | 581 | foreach ($shipping\_items as $shipping\_item\_id => $shipping\_item) { |
  | 571 | 582 | $order\_item\_shipping = new WC\_Order\_Item\_Shipping($shipping\_item\_id); |
  | 572 | 583 | $shipping\_vendor\_id = $order\_item\_shipping->get\_meta('vendor\_id', true); |
  | 573 |  | if($shipping\_vendor\_id > 0) { |
  |  | 584 | if ($shipping\_vendor\_id > 0) { |
  | 574 | 585 | $shipping\_item\_total = $order\_item\_shipping->get\_total() + $order\_item\_shipping->get\_total\_tax(); |
  | 575 |  |  |
  | 576 |  | if(isset($vendor\_wise\_gross\_sales[$shipping\_vendor\_id])) $vendor\_wise\_gross\_sales[$shipping\_vendor\_id] = $vendor\_wise\_gross\_sales[$shipping\_vendor\_id] + $shipping\_item\_total; |
  |  | 586 |  |
  |  | 587 | if (isset($vendor\_wise\_gross\_sales[$shipping\_vendor\_id])) $vendor\_wise\_gross\_sales[$shipping\_vendor\_id] = $vendor\_wise\_gross\_sales[$shipping\_vendor\_id] + $shipping\_item\_total; |
  | 577 | 588 | else $vendor\_wise\_gross\_sales[$shipping\_vendor\_id] = $shipping\_item\_total; |
  | 578 | 589 | } |
  | 579 | 590 | } |
  | 580 |  |  |
  |  | 591 |  |
  | 581 | 592 | return $vendor\_wise\_gross\_sales; |
  | 582 | 593 | } |
  | 583 |  |  |
  | 584 |  | public function wcfmmp\_calculate\_vendor\_order\_commission(~~$vendor\_id, $order\_id, $order, $deduct\_transaction\_charge = true~~ ) { |
  |  | 594 |  |
  |  | 595 | public function wcfmmp\_calculate\_vendor\_order\_commission($vendor\_id, $order\_id, $order, $deduct\_transaction\_charge = true) { |
  | 585 | 596 | global $WCFM, $WCFMmp; |
  | 586 |  |  |
  |  | 597 |  |
  | 587 | 598 | $item\_count        = 0; |
  | 588 | 599 | $commission\_amount = 0; |
  | 589 |  |  |
  |  | 600 |  |
  | 590 | 601 | $items = $order->get\_items('line\_item'); |
  | 591 | 602 | foreach ($items as $item\_id => $item) { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L595) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L606) |  |
  | 595 | 606 | $variation\_id = $line\_item->get\_variation\_id(); |
  | 596 | 607 | if ($product\_id) { |
  | 597 |  | $pvendor\_id = wcfm\_get\_vendor\_id\_by\_post(~~$product\_id~~ ); |
  | 598 |  | if~~( $pvendor\_id && ( $pvendor\_id == $vendor\_id )~~ ) { |
  | 599 |  | if~~( $WCFMmp->wcfmmp\_vendor->is\_vendor\_deduct\_discount( $vendor\_id, $order\_id )~~ ) { |
  | 600 |  | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule(~~$product\_id, $variation\_id, $vendor\_id, $line\_item->get\_total(), $line\_item->get\_quantity(), $order\_id~~ ); |
  | 601 |  | $commission\_amount += $this->wcfmmp\_get\_order\_item\_commission(~~$order\_id, $vendor\_id, $product\_id, $variation\_id, $line\_item->get\_total(), $line\_item->get\_quantity(), $commission\_rule~~ ); |
  |  | 608 | $pvendor\_id = wcfm\_get\_vendor\_id\_by\_post($product\_id); |
  |  | 609 | if ($pvendor\_id && ($pvendor\_id == $vendor\_id)) { |
  |  | 610 | if ($WCFMmp->wcfmmp\_vendor->is\_vendor\_deduct\_discount($vendor\_id, $order\_id)) { |
  |  | 611 | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule($product\_id, $variation\_id, $vendor\_id, $line\_item->get\_total(), $line\_item->get\_quantity(), $order\_id); |
  |  | 612 | $commission\_amount += $this->wcfmmp\_get\_order\_item\_commission($order\_id, $vendor\_id, $product\_id, $variation\_id, $line\_item->get\_total(), $line\_item->get\_quantity(), $commission\_rule); |
  | 602 | 613 | } else { |
  | 603 |  | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule(~~$product\_id, $variation\_id, $vendor\_id, $line\_item->get\_subtotal(), $line\_item->get\_quantity(), $order\_id~~ ); |
  | 604 |  | $commission\_amount += $this->wcfmmp\_get\_order\_item\_commission(~~$order\_id, $vendor\_id, $product\_id, $variation\_id, $line\_item->get\_subtotal(), $line\_item->get\_quantity(), $commission\_rule~~ ); |
  | 605 |  | } |
  | 606 |  |  |
  | 607 |  | if~~( $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_tax( $vendor\_id )~~ ) { |
  | 608 |  | $tax\_cost       = apply\_filters(~~'wcfmmmp\_commission\_tax\_cost', $line\_item->get\_total\_tax(), $commission\_amount, $order\_id, $vendor\_id, $product\_id, $commission\_rule~~ ); |
  | 609 |  |  |
  | 610 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_on\_tax', false )~~ ) { |
  | 611 |  | $tax\_cost = $this->wcfmmp\_generate\_commission\_cost(~~$tax\_cost, apply\_filters( 'wcfmmmp\_tax\_commission\_rule', $commission\_rule )~~ ); |
  | 612 |  | } |
  | 613 |  |  |
  |  | 614 | $commission\_rule   = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule($product\_id, $variation\_id, $vendor\_id, $line\_item->get\_subtotal(), $line\_item->get\_quantity(), $order\_id); |
  |  | 615 | $commission\_amount += $this->wcfmmp\_get\_order\_item\_commission($order\_id, $vendor\_id, $product\_id, $variation\_id, $line\_item->get\_subtotal(), $line\_item->get\_quantity(), $commission\_rule); |
  |  | 616 | } |
  |  | 617 |  |
  |  | 618 | if ($WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_tax($vendor\_id)) { |
  |  | 619 | $tax\_cost       = apply\_filters('wcfmmmp\_commission\_tax\_cost', $line\_item->get\_total\_tax(), $commission\_amount, $order\_id, $vendor\_id, $product\_id, $commission\_rule); |
  |  | 620 |  |
  |  | 621 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_on\_tax', false)) { |
  |  | 622 | $tax\_cost = $this->wcfmmp\_generate\_commission\_cost($tax\_cost, apply\_filters('wcfmmmp\_tax\_commission\_rule', $commission\_rule)); |
  |  | 623 | } |
  |  | 624 |  |
  | 614 | 625 | $commission\_amount = $commission\_amount + $tax\_cost; |
  | 615 | 626 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L618) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L629) |  |
  | 618 | 629 | } |
  | 619 | 630 | } |
  | 620 |  |  |
  | 621 |  | if~~( $get\_shipping = $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_shipping( $vendor\_id )~~ ) { |
  |  | 631 |  |
  |  | 632 | if ($get\_shipping = $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_shipping($vendor\_id)) { |
  | 622 | 633 | $shipping\_items = $order->get\_items('shipping'); |
  | 623 | 634 | foreach ($shipping\_items as $shipping\_item\_id => $shipping\_item) { |
  | 624 | 635 | $order\_item\_shipping = new WC\_Order\_Item\_Shipping($shipping\_item\_id); |
  | 625 | 636 | $shipping\_vendor\_id = $order\_item\_shipping->get\_meta('vendor\_id', true); |
  | 626 |  | if~~( $shipping\_vendor\_id > 0 && ( $shipping\_vendor\_id == $vendor\_id )~~ ) { |
  | 627 |  |  |
  | 628 |  | $shipping\_cost       = apply\_filters(~~'wcfmmmp\_commission\_shipping\_cost', $order\_item\_shipping->get\_total(), $shipping\_items, $order\_id, $vendor\_id, $product\_id, $commission\_rule~~ ); |
  |  | 637 | if ($shipping\_vendor\_id > 0 && ($shipping\_vendor\_id == $vendor\_id)) { |
  |  | 638 |  |
  |  | 639 | $shipping\_cost       = apply\_filters('wcfmmmp\_commission\_shipping\_cost', $order\_item\_shipping->get\_total(), $shipping\_items, $order\_id, $vendor\_id, $product\_id, $commission\_rule); |
  | 629 | 640 | $shipping\_tax        = $order\_item\_shipping->get\_total\_tax(); |
  | 630 |  |  |
  |  | 641 |  |
  | 631 | 642 | // Commission Rule on Shipping Cost - by default false |
  | 632 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_on\_shipping', false )~~ ) { |
  | 633 |  | $shipping\_cost = $this->wcfmmp\_generate\_commission\_cost(~~$shipping\_cost, apply\_filters( 'wcfmmmp\_shipping\_commission\_rule',  $commission\_rule )~~ ); |
  | 634 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_on\_shipping\_tax', true )~~ ) { |
  | 635 |  | $shipping\_tax  = $this->wcfmmp\_generate\_commission\_cost(~~$shipping\_tax, apply\_filters( 'wcfmmmp\_shipping\_commission\_rule',  $commission\_rule )~~ ); |
  | 636 |  | } |
  | 637 |  | } |
  | 638 |  |  |
  |  | 643 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_on\_shipping', false)) { |
  |  | 644 | $shipping\_cost = $this->wcfmmp\_generate\_commission\_cost($shipping\_cost, apply\_filters('wcfmmmp\_shipping\_commission\_rule',  $commission\_rule)); |
  |  | 645 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_on\_shipping\_tax', true)) { |
  |  | 646 | $shipping\_tax  = $this->wcfmmp\_generate\_commission\_cost($shipping\_tax, apply\_filters('wcfmmmp\_shipping\_commission\_rule',  $commission\_rule)); |
  |  | 647 | } |
  |  | 648 | } |
  |  | 649 |  |
  | 639 | 650 | $commission\_amount = $commission\_amount + $shipping\_cost; |
  | 640 |  | if~~( $WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_tax( $vendor\_id ) && apply\_filters( 'wcfmmp\_is\_allow\_vendor\_get\_shipping\_tax', true )~~ ) { |
  |  | 651 | if ($WCFMmp->wcfmmp\_vendor->is\_vendor\_get\_tax($vendor\_id) && apply\_filters('wcfmmp\_is\_allow\_vendor\_get\_shipping\_tax', true)) { |
  | 641 | 652 | $commission\_amount += $shipping\_tax; |
  | 642 | 653 | } |
  | 643 |  |  |
  | 644 |  | } |
  | 645 |  | } |
  | 646 |  | } |
  | 647 |  |  |
  |  | 654 | } |
  |  | 655 | } |
  |  | 656 | } |
  |  | 657 |  |
  | 648 | 658 | // Transaction Charge Calculation |
  | 649 |  | if~~( $deduct\_transaction\_charge~~ ) { |
  |  | 659 | if ($deduct\_transaction\_charge) { |
  | 650 | 660 | $transaction\_charge = 0; |
  | 651 |  | if~~( isset( $commission\_rule['transaction\_charge\_type'] ) && ( $commission\_rule['transaction\_charge\_type'] != 'no' )~~ ) { |
  | 652 |  | if~~( ( $commission\_rule['transaction\_charge\_type'] == 'percent' ) || ( $commission\_rule['transaction\_charge\_type'] == 'percent\_fixed' )~~ ) { |
  | 653 |  | $transaction\_charge  += $commission\_amount \* (~~(float)$commission\_rule['transaction\_charge\_percent'] / 100~~ ); |
  | 654 |  | } |
  | 655 |  | if~~( ( $commission\_rule['transaction\_charge\_type'] == 'fixed' ) || ( $commission\_rule['transaction\_charge\_type'] == 'percent\_fixed' )~~ ) { |
  |  | 661 | if (isset($commission\_rule['transaction\_charge\_type']) && ($commission\_rule['transaction\_charge\_type'] != 'no')) { |
  |  | 662 | if (($commission\_rule['transaction\_charge\_type'] == 'percent') || ($commission\_rule['transaction\_charge\_type'] == 'percent\_fixed')) { |
  |  | 663 | $transaction\_charge  += $commission\_amount \* ((float)$commission\_rule['transaction\_charge\_percent'] / 100); |
  |  | 664 | } |
  |  | 665 | if (($commission\_rule['transaction\_charge\_type'] == 'fixed') || ($commission\_rule['transaction\_charge\_type'] == 'percent\_fixed')) { |
  | 656 | 666 | $transaction\_charge  += (float)$commission\_rule['transaction\_charge\_fixed']; |
  | 657 | 667 | } |
  | 658 |  | $transaction\_charge     = apply\_filters(~~'wcfmmp\_commission\_deducted\_transaction\_charge', $transaction\_charge, $vendor\_id, $product\_id, $order\_id, $commission\_amount, $commission\_rule, $order\_item\_id~~ ); |
  |  | 668 | $transaction\_charge     = apply\_filters('wcfmmp\_commission\_deducted\_transaction\_charge', $transaction\_charge, $vendor\_id, $product\_id, $order\_id, $commission\_amount, $commission\_rule, $order\_item\_id); |
  | 659 | 669 | $commission\_amount     -= (float) $transaction\_charge; |
  | 660 | 670 | } |
  | 661 | 671 | } |
  | 662 |  |  |
  |  | 672 |  |
  | 663 | 673 | // Commission Tax Calculation - Have something wrong here!!!! |
  | 664 |  | if~~( isset( $commission\_rule['tax\_enable'] ) && ( $commission\_rule['tax\_enable'] == 'yes' )~~ ) { |
  | 665 |  | $commission\_tax = $commission\_amount \* (~~(float)$commission\_rule['tax\_percent'] / 100~~ ); |
  | 666 |  | $commission\_tax = apply\_filters(~~'wcfmmp\_commission\_deducted\_tax', $commission\_tax, $vendor\_id, $product\_id, $variation\_id, $order\_id, $commission\_amount, $commission\_rule, $order\_item\_id, 0~~ ); |
  |  | 674 | if (isset($commission\_rule['tax\_enable']) && ($commission\_rule['tax\_enable'] == 'yes')) { |
  |  | 675 | $commission\_tax = $commission\_amount \* ((float)$commission\_rule['tax\_percent'] / 100); |
  |  | 676 | $commission\_tax = apply\_filters('wcfmmp\_commission\_deducted\_tax', $commission\_tax, $vendor\_id, $product\_id, $variation\_id, $order\_id, $commission\_amount, $commission\_rule, $order\_item\_id, 0); |
  | 667 | 677 | $commission\_amount -= (float) $commission\_tax; |
  | 668 | 678 | } |
  | 669 |  |  |
  | 670 |  | return array(~~'commission\_amount' => $commission\_amount, 'item\_count' => $item\_count~~ ); |
  | 671 |  | } |
  | 672 |  |  |
  |  | 679 |  |
  |  | 680 | return array('commission\_amount' => $commission\_amount, 'item\_count' => $item\_count); |
  |  | 681 | } |
  |  | 682 |  |
  | 673 | 683 | /\*\* |
  | 674 | 684 | \* Update Commission metas |
  | 675 | 685 | \*/ |
  | 676 |  | public function wcfmmp\_update\_commission\_meta(~~$commission\_id, $key, $value~~ ) { |
  | 677 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 678 |  |  |
  |  | 686 | public function wcfmmp\_update\_commission\_meta($commission\_id, $key, $value) { |
  |  | 687 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 688 |  |
  | 679 | 689 | $wpdb->query( |
  | 680 |  | $wpdb->prepare( |
  | 681 |  | "INSERT INTO `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  | 682 |  | ( order\_commission\_id |
  | 683 |  | , `key` |
  | 684 |  | , `value` |
  | 685 |  | ) VALUES ( %d |
  | 686 |  | , %s |
  | 687 |  | , %s |
  | 688 |  | )" |
  | 689 |  | , $commission\_id |
  | 690 |  | , $key |
  | 691 |  | , $value |
  |  | 690 | $wpdb->prepare( |
  |  | 691 | "INSERT INTO `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  |  | 692 | ( |
  |  | 693 | order\_commission\_id, |
  |  | 694 | `key`, |
  |  | 695 | `value` |
  |  | 696 | ) |
  |  | 697 | VALUES |
  |  | 698 | ( |
  |  | 699 | %d, |
  |  | 700 | %s, |
  |  | 701 | %s |
  |  | 702 | )", |
  |  | 703 | $commission\_id, |
  |  | 704 | $key, |
  |  | 705 | $value |
  | 692 | 706 | ) |
  | 693 | 707 | ); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L695) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L709) |  |
  | 695 | 709 | return $commission\_meta\_id; |
  | 696 | 710 | } |
  | 697 |  |  |
  |  | 711 |  |
  | 698 | 712 | /\*\* |
  | 699 | 713 | \* Get Commission metas |
  | 700 | 714 | \*/ |
  | 701 |  | public function wcfmmp\_get\_commission\_meta(~~$commission\_id, $key~~ ) { |
  | 702 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 703 |  |  |
  | 704 |  | $commission\_meta = $wpdb->get\_var( |
  | 705 |  | $wpdb->prepare( |
  | 706 |  | ~~"SELECT `value` FROM `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta~~` |
  | 707 |  | ~~WHERE~~ |
  | 708 |  | ~~`order\_commission\_id` = %d~~ |
  | 709 |  | ~~AND `key` = %s~~ |
  | 710 |  | ~~"~~ |
  | 711 |  | ~~, $commission\_id~~ |
  | 712 |  | ~~,~~ $key |
  |  | 715 | public function wcfmmp\_get\_commission\_meta($commission\_id, $key) { |
  |  | 716 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 717 |  |
  |  | 718 | $commission\_meta = $wpdb->get\_var( |
  |  | 719 | $wpdb->prepare( |
  |  | 720 | "SELECT `value` |
  |  | 721 | FROM `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  |  | 722 | WHERE |
  |  | 723 | `order\_commission\_id` = %d |
  |  | 724 | AND `key` = %s", |
  |  | 725 | $commission\_id, |
  |  | 726 | $key |
  | 713 | 727 | ) |
  | 714 | 728 | ); |
  | 715 | 729 | return $commission\_meta; |
  | 716 | 730 | } |
  | 717 |  |  |
  |  | 731 |  |
  | 718 | 732 | /\*\* |
  | 719 | 733 | \* Get Commission metas SUM |
  | 720 | 734 | \*/ |
  | 721 |  | public function wcfmmp\_get\_commission\_meta\_sum( $commission\_ids, $key ) { |
  | 722 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 723 |  |  |
  | 724 |  | if( empty( $commission\_ids ) || !is\_array( $commission\_ids ) ) return 0; |
  | 725 |  |  |
  | 726 |  | $commission\_meta = $wpdb->get\_var( |
  | 727 |  | $wpdb->prepare( |
  | 728 |  | "SELECT SUM(`value`) FROM `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  | 729 |  | WHERE |
  | 730 |  | `order\_commission\_id` in ('" . implode( "','", $commission\_ids ) . "') |
  | 731 |  | AND `key` = %s |
  | 732 |  | " |
  | 733 |  | , $key |
  | 734 |  | ) |
  | 735 |  | ); |
  | 736 |  | return $commission\_meta; |
  | 737 |  | } |
  | 738 |  |  |
  | 739 |  | /\*\* |
  | 740 |  | \* Delete Commission metas |
  | 741 |  | \*/ |
  | 742 |  | public function wcfmmp\_delete\_commission\_meta( $commission\_id, $key ) { |
  | 743 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 744 |  |  |
  | 745 |  | $commission\_meta = $wpdb->query( |
  | 746 |  | $wpdb->prepare( |
  | 747 |  | "DELETE FROM `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  | 748 |  | WHERE |
  | 749 |  | `order\_commission\_id` = %d |
  | 750 |  | AND `key` = %s |
  | 751 |  | " |
  | 752 |  | , $commission\_id |
  | 753 |  | , $key |
  |  | 735 | public function wcfmmp\_get\_commission\_meta\_sum($commission\_ids, $key) { |
  |  | 736 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 737 |  |
  |  | 738 | if (empty($commission\_ids) || !is\_array($commission\_ids)) return 0; |
  |  | 739 |  |
  |  | 740 | $commission\_meta = $wpdb->get\_var( |
  |  | 741 | $wpdb->prepare( |
  |  | 742 | "SELECT SUM(`value`) |
  |  | 743 | FROM `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  |  | 744 | WHERE |
  |  | 745 | `order\_commission\_id` in ('" . implode("','", $commission\_ids) . "') |
  |  | 746 | AND `key` = %s", |
  |  | 747 | $key |
  | 754 | 748 | ) |
  | 755 | 749 | ); |
  | 756 | 750 | return $commission\_meta; |
  | 757 | 751 | } |
  | 758 |  |  |
  |  | 752 |  |
  |  | 753 | /\*\* |
  |  | 754 | \* Delete Commission metas |
  |  | 755 | \*/ |
  |  | 756 | public function wcfmmp\_delete\_commission\_meta($commission\_id, $key) { |
  |  | 757 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 758 |  |
  |  | 759 | $commission\_meta = $wpdb->query( |
  |  | 760 | $wpdb->prepare( |
  |  | 761 | "DELETE FROM `{$wpdb->prefix}wcfm\_marketplace\_orders\_meta` |
  |  | 762 | WHERE |
  |  | 763 | `order\_commission\_id` = %d |
  |  | 764 | AND `key` = %s", |
  |  | 765 | $commission\_id, |
  |  | 766 | $key |
  |  | 767 | ) |
  |  | 768 | ); |
  |  | 769 | return $commission\_meta; |
  |  | 770 | } |
  |  | 771 |  |
  | 759 | 772 | /\*\* |
  | 760 | 773 | \* New Order check on WC New Order |
  | 761 | 774 | \*/ |
  | 762 |  | function wcfmmp\_new\_order\_check(~~$order, $updated\_props~~ ) { |
  | 763 |  | if~~( !$order || !is\_a($order , 'WC\_Order')~~ ) return; |
  | 764 |  |  |
  |  | 775 | function wcfmmp\_new\_order\_check($order, $updated\_props) { |
  |  | 776 | if (!$order || !is\_a($order, 'WC\_Order')) return; |
  |  | 777 |  |
  | 765 | 778 | $order\_id = $order->get\_id(); |
  | 766 |  |  |
  |  | 779 |  |
  | 767 | 780 | // YiTH Request a Quote Support |
  | 768 |  | $is\_quote = get\_post\_meta( $order\_id, 'ywraq\_raq', true ); |
  | 769 |  | if( $is\_quote ) { |
  | 770 |  | if ( get\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', true ) ) { |
  | 771 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 772 |  | do\_action( 'wcfm\_manual\_order\_reset', $order\_id, true ); |
  | 773 |  | $order\_posted = get\_post( $order\_id ); |
  | 774 |  | do\_action( 'wcfm\_manual\_order\_processed', $order\_id, $order\_posted, $order ); |
  |  | 781 | $is\_quote = $order->get\_meta('ywraq\_raq'); |
  |  | 782 | if ($is\_quote) { |
  |  | 783 | if ($order->get\_meta('\_wcfmmp\_order\_processed')) { |
  |  | 784 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 785 | $order->save(); |
  |  | 786 | do\_action('wcfm\_manual\_order\_reset', $order\_id, true); |
  |  | 787 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? wc\_get\_order($order\_id) : get\_post($order\_id); |
  |  | 788 | do\_action('wcfm\_manual\_order\_processed', $order\_id, $order\_posted, $order); |
  | 775 | 789 | return; |
  | 776 | 790 | } |
  | 777 |  | } |
  | 778 |  |  |
  |  | 791 | } |
  |  | 792 |  |
  | 779 | 793 | $created\_via = $order->get\_created\_via(); |
  | 780 |  | if~~( !$created\_via || !in\_array( $created\_via, apply\_filters( 'wcfmmp\_new\_order\_check\_created\_via', array( 'wepos', 'wc\_deposits' ) ) )~~ ) { |
  | 781 |  | if~~( defined( 'WCFM\_MANUAL\_ORDER' )~~ ) return; |
  | 782 |  | if~~( defined( 'WC\_BOOKINGS\_VERSION' )~~ ) return; |
  | 783 |  | if~~( defined( 'WC\_APPOINTMENTS\_VERSION' )~~ ) return; |
  | 784 |  | if~~( defined( 'WC\_POS\_VERSION' )~~ ) return; |
  | 785 |  | } |
  | 786 |  | if~~( $order\_id~~ ) { |
  | 787 |  | if (~~get\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', true )~~ ) return; |
  | 788 |  | $order\_posted = ~~get\_post( $order\_id~~ ); |
  | 789 |  | $this->wcfmmp\_checkout\_order\_processed(~~$order\_id, $order\_posted, $order~~ ); |
  | 790 |  | } |
  | 791 |  | } |
  | 792 |  |  |
  |  | 794 | if (!$created\_via || !in\_array($created\_via, apply\_filters('wcfmmp\_new\_order\_check\_created\_via', array('wepos', 'wc\_deposits')))) { |
  |  | 795 | if (defined('WCFM\_MANUAL\_ORDER')) return; |
  |  | 796 | if (defined('WC\_BOOKINGS\_VERSION')) return; |
  |  | 797 | if (defined('WC\_APPOINTMENTS\_VERSION')) return; |
  |  | 798 | if (defined('WC\_POS\_VERSION')) return; |
  |  | 799 | } |
  |  | 800 | if ($order\_id) { |
  |  | 801 | if ($order->get\_meta('\_wcfmmp\_order\_processed')) return; |
  |  | 802 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? wc\_get\_order($order\_id) : get\_post($order\_id); |
  |  | 803 | $this->wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted, $order); |
  |  | 804 | } |
  |  | 805 | } |
  |  | 806 |  |
  | 793 | 807 | /\*\* |
  | 794 | 808 | \* WC POS New Order Check |
  | 795 | 809 | \*/ |
  | 796 |  | function wcfmmp\_pos\_order\_check( $order\_id, $data ) { |
  | 797 |  | if( $order\_id && !is\_array( $order\_id ) ) { |
  | 798 |  | wcfm\_log( "POS Order: #" . $order\_id ); |
  | 799 |  | if ( get\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', true ) ) return; |
  | 800 |  | $order\_posted = get\_post( $order\_id ); |
  | 801 |  | $this->wcfmmp\_checkout\_order\_processed( $order\_id, $order\_posted ); |
  | 802 |  | } |
  | 803 |  | } |
  | 804 |  |  |
  |  | 810 | function wcfmmp\_pos\_order\_check($order\_id, $data) { |
  |  | 811 | $order = wc\_get\_order($order\_id); |
  |  | 812 |  |
  |  | 813 | if ($order\_id && !is\_array($order\_id) && $order) { |
  |  | 814 | wcfm\_log("POS Order: #" . $order\_id); |
  |  | 815 | if ($order->get\_meta('\_wcfmmp\_order\_processed')) return; |
  |  | 816 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 817 | $this->wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted); |
  |  | 818 | } |
  |  | 819 | } |
  |  | 820 |  |
  | 805 | 821 | /\*\* |
  | 806 | 822 | \* Marketplace Order for WC Subscription Renewal Order |
  | 807 | 823 | \*/ |
  | 808 |  | function wcfmmp\_renewal\_order\_processed(~~$renewal\_order, $subscription~~ ) { |
  | 809 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 810 |  | wcfm\_log(~~"RENEWAL ORDER ::" . $renewal\_order->get\_id()~~ ); |
  | 811 |  | if~~( $renewal\_order~~ ) { |
  |  | 824 | function wcfmmp\_renewal\_order\_processed($renewal\_order, $subscription) { |
  |  | 825 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 826 | wcfm\_log("RENEWAL ORDER ::" . $renewal\_order->get\_id()); |
  |  | 827 | if ($renewal\_order) { |
  | 812 | 828 | $order\_id = $renewal\_order->get\_id(); |
  | 813 |  | $order\_posted = get\_post( $order\_id ); |
  | 814 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 815 |  | $this->wcfmmp\_checkout\_order\_processed( $order\_id, $order\_posted, $renewal\_order ); |
  | 816 |  | $WCFM->wcfm\_notification->wcfm\_message\_on\_new\_order( $order\_id, true ); |
  | 817 |  | } |
  | 818 |  |  |
  |  | 829 | $order = wc\_get\_order($order\_id); |
  |  | 830 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 831 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 832 | $order->save(); |
  |  | 833 | $this->wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted, $renewal\_order); |
  |  | 834 | $WCFM->wcfm\_notification->wcfm\_message\_on\_new\_order($order\_id, true); |
  |  | 835 | } |
  |  | 836 |  |
  | 819 | 837 | return $renewal\_order; |
  | 820 | 838 | } |
  | 821 |  |  |
  |  | 839 |  |
  | 822 | 840 | /\*\* |
  | 823 | 841 | \* Marketplace Order for Manual Booking Order |
  | 824 | 842 | \*/ |
  | 825 |  | function wcfmmp\_manual\_booking\_order\_processed(~~$new\_booking~~ ) { |
  |  | 843 | function wcfmmp\_manual\_booking\_order\_processed($new\_booking) { |
  | 826 | 844 | $order\_id = $new\_booking->get\_order\_id(); |
  | 827 |  | if~~( $order\_id~~ ) { |
  | 828 |  | wcfm\_log(~~"Manual Booking Order: #" . $order\_id~~ ); |
  | 829 |  | ~~//if ( get\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', true ) ) return~~; |
  | 830 |  | ~~delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed'~~ ); |
  | 831 |  | $order~~\_posted = get\_post( $order\_id~~ ); |
  | 832 |  | $order~~= wc\_get\_order( $order\_id~~ ); |
  | 833 |  | $this->wcfmmp\_checkout\_order\_processed(~~$order\_id, $order\_posted, $order~~ ); |
  | 834 |  | } |
  | 835 |  | } |
  | 836 |  |  |
  |  | 845 | if ($order\_id) { |
  |  | 846 | wcfm\_log("Manual Booking Order: #" . $order\_id); |
  |  | 847 | $order = wc\_get\_order($order\_id); |
  |  | 848 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 849 | $order->save(); |
  |  | 850 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 851 | $this->wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted, $order); |
  |  | 852 | } |
  |  | 853 | } |
  |  | 854 |  |
  | 837 | 855 | /\*\* |
  | 838 | 856 | \* Marketplace Order for Manual Appointment Order |
  | 839 | 857 | \*/ |
  | 840 |  | function wcfmmp\_manual\_appointment\_order\_processed(~~$order\_id~~ ) { |
  | 841 |  | if~~( $order\_id~~ ) { |
  | 842 |  | wcfm\_log(~~"Manual Appointment Order: #" . $order\_id~~ ); |
  | 843 |  | ~~//if ( get\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed', true ) ) return~~; |
  | 844 |  | ~~delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed'~~ ); |
  | 845 |  | $order~~\_posted = get\_post( $order\_id~~ ); |
  | 846 |  | $order~~= wc\_get\_order( $order\_id~~ ); |
  | 847 |  | $this->wcfmmp\_checkout\_order\_processed(~~$order\_id, $order\_posted, $order~~ ); |
  | 848 |  | } |
  | 849 |  | } |
  | 850 |  |  |
  |  | 858 | function wcfmmp\_manual\_appointment\_order\_processed($order\_id) { |
  |  | 859 | if ($order\_id) { |
  |  | 860 | wcfm\_log("Manual Appointment Order: #" . $order\_id); |
  |  | 861 | $order = wc\_get\_order($order\_id); |
  |  | 862 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 863 | $order->save(); |
  |  | 864 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 865 | $this->wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted, $order); |
  |  | 866 | } |
  |  | 867 | } |
  |  | 868 |  |
  | 851 | 869 | /\*\* |
  | 852 | 870 | \* Marketplace Order Status update on WC Order status change |
  | 853 | 871 | \*/ |
  | 854 |  | function wcfmmp\_order\_status\_changed(~~$order\_id, $status\_from, $status\_to~~ ) { |
  | 855 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 856 |  |  |
  | 857 |  | $withdrawal\_auto\_complate\_order\_status = apply\_filters(~~'wcfmmp\_withdrawal\_auto\_complate\_order\_status', array( 'processing', 'completed' )~~ ); |
  | 858 |  | $withdrawal\_auto\_cancel\_order\_status   = apply\_filters(~~'wcfmmp\_withdrawal\_auto\_cancel\_order\_status', array( 'cancelled', 'failed', 'refunded' )~~ ); |
  | 859 |  | $commission\_trashed\_order\_status       = apply\_filters(~~'wcfmmp\_commission\_trashed\_order\_status', array( 'cancelled' )~~ ); |
  | 860 |  | $commission\_failed\_order\_status        = apply\_filters(~~'wcfmmp\_commission\_failed\_order\_status', array( 'failed' )~~ ); |
  | 861 |  |  |
  |  | 872 | function wcfmmp\_order\_status\_changed($order\_id, $status\_from, $status\_to) { |
  |  | 873 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 874 |  |
  |  | 875 | $withdrawal\_auto\_complate\_order\_status = apply\_filters('wcfmmp\_withdrawal\_auto\_complate\_order\_status', array('processing', 'completed')); |
  |  | 876 | $withdrawal\_auto\_cancel\_order\_status   = apply\_filters('wcfmmp\_withdrawal\_auto\_cancel\_order\_status', array('cancelled', 'failed', 'refunded')); |
  |  | 877 | $commission\_trashed\_order\_status       = apply\_filters('wcfmmp\_commission\_trashed\_order\_status', array('cancelled')); |
  |  | 878 | $commission\_failed\_order\_status        = apply\_filters('wcfmmp\_commission\_failed\_order\_status', array('failed')); |
  |  | 879 |  |
  | 862 | 880 | // Update Commission Order status by Main Order Status |
  | 863 |  | if~~( apply\_filters( 'wcfm\_is\_allow\_status\_update\_by\_main\_order\_status', true, $order\_id, $status\_to )~~ ) { |
  |  | 881 | if (apply\_filters('wcfm\_is\_allow\_status\_update\_by\_main\_order\_status', true, $order\_id, $status\_to)) { |
  | 864 | 882 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('commission\_status' => $status\_to, 'order\_status' => $status\_to), array('order\_id' => $order\_id), array('%s', '%s'), array('%d')); |
  | 865 | 883 | } |
  | 866 |  |  |
  |  | 884 |  |
  | 867 | 885 | // Withdrawal Threshold check by Order Completed date |
  | 868 |  | if~~( apply\_filters( 'wcfm\_is\_allow\_withdrwal\_check\_by\_order\_complete\_date', false ) && ( $status\_to == 'completed' )~~ ) { |
  | 869 |  | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array(~~'created' => date( 'Y-m-d H:i:s', current\_time( 'timestamp', 0 ) )~~ ), array('order\_id' => $order\_id), array('%s'), array('%d')); |
  | 870 |  | } |
  | 871 |  |  |
  | 872 |  | $order = wc\_get\_order(~~$order\_id~~ ); |
  | 873 |  |  |
  |  | 886 | if (apply\_filters('wcfm\_is\_allow\_withdrwal\_check\_by\_order\_complete\_date', false) && ($status\_to == 'completed')) { |
  |  | 887 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('created' => date('Y-m-d H:i:s', current\_time('timestamp', 0))), array('order\_id' => $order\_id), array('%s'), array('%d')); |
  |  | 888 | } |
  |  | 889 |  |
  |  | 890 | $order = wc\_get\_order($order\_id); |
  |  | 891 |  |
  | 874 | 892 | // Fetch commission ids for this order |
  | 875 | 893 | $sql = 'SELECT ID, is\_auto\_withdrawal, vendor\_id  FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission'; |
  | 876 | 894 | $sql .= ' WHERE 1=1'; |
  | 877 | 895 | $sql .= " AND `order\_id` = " . $order\_id; |
  | 878 |  | $commissions = $wpdb->get\_results(~~$sql~~ ); |
  | 879 |  |  |
  | 880 |  | if~~( !empty( $commissions )~~ ) { |
  | 881 |  | foreach~~( $commissions as $commission~~ ) { |
  |  | 896 | $commissions = $wpdb->get\_results($sql); |
  |  | 897 |  |
  |  | 898 | if (!empty($commissions)) { |
  |  | 899 | foreach ($commissions as $commission) { |
  | 882 | 900 | // Update commission ledger status |
  | 883 |  | $WCFMmp->wcfmmp\_ledger->wcfmmp\_ledger\_status\_update(~~$commission->ID, $status\_to~~ ); |
  | 884 |  |  |
  |  | 901 | $WCFMmp->wcfmmp\_ledger->wcfmmp\_ledger\_status\_update($commission->ID, $status\_to); |
  |  | 902 |  |
  | 885 | 903 | // Update auto withdrawal complated |
  | 886 |  | if~~( in\_array( $status\_to, $withdrawal\_auto\_complate\_order\_status ) && $commission->is\_auto\_withdrawal && apply\_filters( 'wcfm\_is\_pref\_withdrawal', true )~~ ) { |
  | 887 |  | $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdraw\_status\_update\_by\_commission(~~$commission->ID, 'completed'~~ ); |
  | 888 |  | } |
  | 889 |  |  |
  |  | 904 | if (in\_array($status\_to, $withdrawal\_auto\_complate\_order\_status) && $commission->is\_auto\_withdrawal && apply\_filters('wcfm\_is\_pref\_withdrawal', true)) { |
  |  | 905 | $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdraw\_status\_update\_by\_commission($commission->ID, 'completed'); |
  |  | 906 | } |
  |  | 907 |  |
  | 890 | 908 | // Update auto withdrawal Status cancelled |
  | 891 |  | if~~( in\_array( $status\_to, $withdrawal\_auto\_cancel\_order\_status )~~ ) { |
  | 892 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_withdrawal', true ) && $commission->is\_auto\_withdrawal~~ ) { |
  | 893 |  | $WCFMmp->wcfmmp\_withdraw->wcfmmp\_reverse\_withdraw\_status\_update\_by\_commission(~~$commission->ID, 'cancelled'~~ ); |
  | 894 |  | } |
  | 895 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_withdrawal', true )~~ ) { |
  | 896 |  | $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdraw\_status\_update\_by\_commission(~~$commission->ID, 'cancelled'~~ ); |
  | 897 |  | } |
  | 898 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_refund', true ) && ( $status\_to != 'refunded' )~~ ) { |
  | 899 |  | $WCFMmp->wcfmmp\_refund->wcfmmp\_refund\_status\_update\_by\_commission(~~$commission->ID, 'cancelled'~~ ); |
  | 900 |  | } |
  | 901 |  | } |
  | 902 |  |  |
  | 903 |  | do\_action(~~'wcfmmp\_order\_status\_'.$status\_to, $order\_id, $commission->ID, $order~~ ); |
  | 904 |  | } |
  | 905 |  | } |
  | 906 |  |  |
  |  | 909 | if (in\_array($status\_to, $withdrawal\_auto\_cancel\_order\_status)) { |
  |  | 910 | if (apply\_filters('wcfm\_is\_pref\_withdrawal', true) && $commission->is\_auto\_withdrawal) { |
  |  | 911 | $WCFMmp->wcfmmp\_withdraw->wcfmmp\_reverse\_withdraw\_status\_update\_by\_commission($commission->ID, 'cancelled'); |
  |  | 912 | } |
  |  | 913 | if (apply\_filters('wcfm\_is\_pref\_withdrawal', true)) { |
  |  | 914 | $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdraw\_status\_update\_by\_commission($commission->ID, 'cancelled'); |
  |  | 915 | } |
  |  | 916 | if (apply\_filters('wcfm\_is\_pref\_refund', true) && ($status\_to != 'refunded')) { |
  |  | 917 | $WCFMmp->wcfmmp\_refund->wcfmmp\_refund\_status\_update\_by\_commission($commission->ID, 'cancelled'); |
  |  | 918 | } |
  |  | 919 | } |
  |  | 920 |  |
  |  | 921 | do\_action('wcfmmp\_order\_status\_' . $status\_to, $order\_id, $commission->ID, $order); |
  |  | 922 | } |
  |  | 923 | } |
  |  | 924 |  |
  | 907 | 925 | // Vendor Notification |
  | 908 |  | if~~( !wcfm\_is\_vendor() && apply\_filters( 'wcfm\_is\_allow\_status\_update\_by\_main\_order\_status', true, $order\_id, $status\_to )~~ ) { |
  | 909 |  | $wcfmmp\_order\_email\_triggered = ~~get\_post\_meta( $order\_id, '\_wcfmmp\_order\_email\_triggered', true~~ ); |
  | 910 |  | if~~( $wcfmmp\_order\_email\_triggered~~ ) { |
  | 911 |  | if~~( !empty( $commissions )~~ ) { |
  |  | 926 | if (!wcfm\_is\_vendor() && apply\_filters('wcfm\_is\_allow\_status\_update\_by\_main\_order\_status', true, $order\_id, $status\_to)) { |
  |  | 927 | $wcfmmp\_order\_email\_triggered = $order->get\_meta('\_wcfmmp\_order\_email\_triggered'); |
  |  | 928 | if ($wcfmmp\_order\_email\_triggered) { |
  |  | 929 | if (!empty($commissions)) { |
  | 912 | 930 | $processed\_vendors = array(); |
  | 913 |  | foreach~~( $commissions as $commission~~ ) { |
  |  | 931 | foreach ($commissions as $commission) { |
  | 914 | 932 | $vendor\_id = $commission->vendor\_id; |
  | 915 |  | if~~( !empty( $processed\_vendors ) && in\_array( $vendor\_id, $processed\_vendors )~~ ) continue; |
  |  | 933 | if (!empty($processed\_vendors) && in\_array($vendor\_id, $processed\_vendors)) continue; |
  | 916 | 934 | $processed\_vendors[$vendor\_id] = $vendor\_id; |
  | 917 |  | if~~( $vendor\_id~~ ) { |
  | 918 |  | if~~( apply\_filters( 'wcfm\_is\_allow\_order\_status\_update\_vendor\_notification', true, $vendor\_id, $order\_id, $status\_to )~~ ) { |
  | 919 |  | $wcfm\_messages = sprintf(~~\_\_( '<b>%s</b> order status updated to <b>%s</b>', 'wc-multivendor-marketplace' ), '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name( $status\_to )~~ ); |
  |  | 935 | if ($vendor\_id) { |
  |  | 936 | if (apply\_filters('wcfm\_is\_allow\_order\_status\_update\_vendor\_notification', true, $vendor\_id, $order\_id, $status\_to)) { |
  |  | 937 | $wcfm\_messages = sprintf(\_\_('<b>%s</b> order status updated to <b>%s</b>', 'wc-multivendor-marketplace'), '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($status\_to)); |
  | 920 | 938 |  |
  | 921 | 939 | $raw\_message = [ |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L926) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L944) |  |
  | 926 | 944 | 'function'  => 'sprintf', |
  | 927 | 945 | 'args'      => [ |
  | 928 |  | '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', |
  | 929 |  | $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name(~~$status\_to~~ ) |
  |  | 946 | '#<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . get\_wcfm\_view\_order\_url($order\_id) . '">' . $order->get\_order\_number() . '</a>', |
  |  | 947 | $WCFMmp->wcfmmp\_vendor->wcfmmp\_vendor\_order\_status\_name($status\_to) |
  | 930 | 948 | ] |
  | 931 | 949 | ] |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L933) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L951) |  |
  | 933 | 951 | ]; |
  | 934 | 952 |  |
  | 935 |  | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(~~-1, $vendor\_id, 1, 0, $wcfm\_messages, 'status-update', true, $raw\_message~~ ); |
  |  | 953 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(-1, $vendor\_id, 1, 0, $wcfm\_messages, 'status-update', true, $raw\_message); |
  | 936 | 954 | } |
  | 937 | 955 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L940) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L958) |  |
  | 940 | 958 | } |
  | 941 | 959 | } |
  | 942 |  |  |
  |  | 960 |  |
  | 943 | 961 | // Trashed Commission Order for Cancelled Orders |
  | 944 |  | if~~( apply\_filters( 'wcfm\_is\_allow\_trashed\_cancelled\_orders', true )~~ ) { |
  | 945 |  | if~~( in\_array( $status\_to, $commission\_trashed\_order\_status )~~ ) { |
  | 946 |  | $this->wcfmmp\_commission\_order\_trash(~~$order\_id~~ ); |
  |  | 962 | if (apply\_filters('wcfm\_is\_allow\_trashed\_cancelled\_orders', true)) { |
  |  | 963 | if (in\_array($status\_to, $commission\_trashed\_order\_status)) { |
  |  | 964 | $this->wcfmmp\_commission\_order\_trash($order\_id); |
  | 947 | 965 | } else { |
  | 948 |  | ~~$this->wcfmmp\_commission\_order\_untrash( $order\_id~~ ); |
  | 949 |  | } |
  | 950 |  | } |
  | 951 |  |  |
  |  | 966 | $this->wcfmmp\_commission\_order\_untrash($order\_id); |
  |  | 967 | } |
  |  | 968 | } |
  |  | 969 |  |
  | 952 | 970 | // Delete Commission Order for Failed Orders |
  | 953 |  | if~~( apply\_filters( 'wcfm\_is\_allow\_delete\_failed\_orders', true )~~ ) { |
  | 954 |  | if~~( in\_array( $status\_to, $commission\_failed\_order\_status )~~ ) { |
  | 955 |  | $this->wcfmmp\_commission\_order\_reset(~~$order\_id~~ ); |
  | 956 |  | } |
  | 957 |  | } |
  | 958 |  | do\_action(~~'wcfmmp\_order\_status\_updated', $order\_id, $status\_from, $status\_to, $order~~ ); |
  | 959 |  | } |
  | 960 |  |  |
  |  | 971 | if (apply\_filters('wcfm\_is\_allow\_delete\_failed\_orders', true)) { |
  |  | 972 | if (in\_array($status\_to, $commission\_failed\_order\_status)) { |
  |  | 973 | $this->wcfmmp\_commission\_order\_reset($order\_id); |
  |  | 974 | } |
  |  | 975 | } |
  |  | 976 | do\_action('wcfmmp\_order\_status\_updated', $order\_id, $status\_from, $status\_to, $order); |
  |  | 977 | } |
  |  | 978 |  |
  | 961 | 979 | /\*\* |
  | 962 | 980 | \* Commission withdrawal Update on complete |
  | 963 | 981 | \*/ |
  | 964 |  | function wcfmmp\_commission\_withdrawal\_id\_update(~~$withdrawal\_id, $commission\_id~~ ) { |
  | 965 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 966 |  |  |
  | 967 |  | if~~( !$withdrawal\_id~~ ) return; |
  | 968 |  | if~~( !$commission\_id~~ ) return; |
  | 969 |  |  |
  |  | 982 | function wcfmmp\_commission\_withdrawal\_id\_update($withdrawal\_id, $commission\_id) { |
  |  | 983 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 984 |  |
  |  | 985 | if (!$withdrawal\_id) return; |
  |  | 986 | if (!$commission\_id) return; |
  |  | 987 |  |
  | 970 | 988 | // Set Withdrawal ID at Vendor Orders table |
  | 971 |  | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('withdrawal\_id' => $withdrawal\_id, 'withdraw\_status' => 'completed', 'commission\_paid\_date' => date('Y-m-d H:i:s', current\_time(~~'timestamp', 0~~ ))), array('ID' => $commission\_id), array('%d', '%s', '%s'), array('%d')); |
  | 972 |  | } |
  | 973 |  |  |
  |  | 989 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('withdrawal\_id' => $withdrawal\_id, 'withdraw\_status' => 'completed', 'commission\_paid\_date' => date('Y-m-d H:i:s', current\_time('timestamp', 0))), array('ID' => $commission\_id), array('%d', '%s', '%s'), array('%d')); |
  |  | 990 | } |
  |  | 991 |  |
  | 974 | 992 | /\*\* |
  | 975 | 993 | \* Shipping and Tax Commission Rule Hanfler to set Fixed cost "0" to avoid multiple times apply |
  | 976 | 994 | \*/ |
  | 977 |  | function wcfmmp\_shipping\_tax\_commission\_rule\_fixed\_handler(~~$commission\_rule~~ ) { |
  | 978 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 979 |  | if~~( isset( $commission\_rule['fixed'] )~~ ) $commission\_rule['fixed'] = 0; |
  |  | 995 | function wcfmmp\_shipping\_tax\_commission\_rule\_fixed\_handler($commission\_rule) { |
  |  | 996 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 997 | if (isset($commission\_rule['fixed'])) $commission\_rule['fixed'] = 0; |
  | 980 | 998 | return $commission\_rule; |
  | 981 | 999 | } |
  | 982 |  |  |
  |  | 1000 |  |
  | 983 | 1001 | /\*\* |
  | 984 | 1002 | \* Tax on Commission Admin Mode Handler |
  | 985 | 1003 | \*/ |
  | 986 |  | function wcfmmp\_commission\_deducted\_tax\_admin\_mode\_handler(~~$commission\_tax, $vendor\_id, $product\_id, $variation\_id, $order\_id, $total\_commission, $commission\_rule, $item\_id, $item\_total = 0~~ ) { |
  | 987 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 988 |  |  |
  | 989 |  | if~~( apply\_filters( 'wcfm\_is\_admin\_fee\_mode', false )~~ ) { |
  | 990 |  | if~~( isset( $commission\_rule['tax\_enable'] ) && ( $commission\_rule['tax\_enable'] == 'yes' )~~ ) { |
  | 991 |  | $order = wc\_get\_order(~~$order\_id~~ ); |
  |  | 1004 | function wcfmmp\_commission\_deducted\_tax\_admin\_mode\_handler($commission\_tax, $vendor\_id, $product\_id, $variation\_id, $order\_id, $total\_commission, $commission\_rule, $item\_id, $item\_total = 0) { |
  |  | 1005 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1006 |  |
  |  | 1007 | if (apply\_filters('wcfm\_is\_admin\_fee\_mode', false)) { |
  |  | 1008 | if (isset($commission\_rule['tax\_enable']) && ($commission\_rule['tax\_enable'] == 'yes')) { |
  |  | 1009 | $order = wc\_get\_order($order\_id); |
  | 992 | 1010 | $vendor\_wise\_gross\_sales = 0; |
  | 993 | 1011 | $quantity  = 0; |
  | 994 |  |  |
  |  | 1012 |  |
  | 995 | 1013 | $items = $order->get\_items('line\_item'); |
  | 996 | 1014 | foreach ($items as $order\_item\_id => $item) { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L999) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L1017) |  |
  | 999 | 1017 | $pvariation\_id = $line\_item->get\_variation\_id(); |
  | 1000 | 1018 | $quantity      = $line\_item->get\_quantity(); |
  | 1001 |  | if~~( ( $pvariation\_id && $variation\_id && ( $variation\_id == $pvariation\_id ) ) || ( !$pvariation\_id && $pproduct\_id && ( $product\_id == $pproduct\_id ) )~~ ) { |
  | 1002 |  | $pvendor\_id = wcfm\_get\_vendor\_id\_by\_post(~~$product\_id~~ ); |
  | 1003 |  | if~~( $pvendor\_id && ( $pvendor\_id == $vendor\_id )~~ ) { |
  | 1004 |  | if~~( !$item\_total~~ ) { |
  |  | 1019 | if (($pvariation\_id && $variation\_id && ($variation\_id == $pvariation\_id)) || (!$pvariation\_id && $pproduct\_id && ($product\_id == $pproduct\_id))) { |
  |  | 1020 | $pvendor\_id = wcfm\_get\_vendor\_id\_by\_post($product\_id); |
  |  | 1021 | if ($pvendor\_id && ($pvendor\_id == $vendor\_id)) { |
  |  | 1022 | if (!$item\_total) { |
  | 1005 | 1023 | $line\_item\_total = $line\_item->get\_total() + $line\_item->get\_total\_tax(); |
  | 1006 | 1024 | $vendor\_wise\_gross\_sales += $line\_item\_total; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L1011) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L1029) |  |
  | 1011 | 1029 | } |
  | 1012 | 1030 | } |
  | 1013 |  |  |
  |  | 1031 |  |
  | 1014 | 1032 | $shipping\_items = $order->get\_items('shipping'); |
  | 1015 | 1033 | foreach ($shipping\_items as $shipping\_item\_id => $shipping\_item) { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L1017) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L1035) |  |
  | 1017 | 1035 | $shipping\_vendor\_id  = $order\_item\_shipping->get\_meta('vendor\_id', true); |
  | 1018 | 1036 | $package\_qty = $order\_item\_shipping->get\_meta('package\_qty', true); |
  | 1019 |  | if~~( ( $shipping\_vendor\_id > 0 ) && ( $shipping\_vendor\_id == $vendor\_id )~~ ) { |
  |  | 1037 | if (($shipping\_vendor\_id > 0) && ($shipping\_vendor\_id == $vendor\_id)) { |
  | 1020 | 1038 | $shipping\_item\_total = $order\_item\_shipping->get\_total() + $order\_item\_shipping->get\_total\_tax(); |
  | 1021 |  | $shipping\_item\_total = ($shipping\_item\_total~~/$package\_qty) \* $quantity~~ ; |
  | 1022 |  |  |
  |  | 1039 | $shipping\_item\_total = ($shipping\_item\_total / $package\_qty) \* $quantity; |
  |  | 1040 |  |
  | 1023 | 1041 | $vendor\_wise\_gross\_sales += $shipping\_item\_total; |
  | 1024 | 1042 | } |
  | 1025 | 1043 | } |
  | 1026 |  |  |
  |  | 1044 |  |
  | 1027 | 1045 | $admin\_fee = (float) $vendor\_wise\_gross\_sales - (float) $total\_commission; |
  | 1028 |  | $commission\_tax = $admin\_fee \* (~~(float)$commission\_rule['tax\_percent'] / 100~~ ); |
  |  | 1046 | $commission\_tax = $admin\_fee \* ((float)$commission\_rule['tax\_percent'] / 100); |
  | 1029 | 1047 | } |
  | 1030 | 1048 | } |
  | 1031 | 1049 | return $commission\_tax; |
  | 1032 | 1050 | } |
  | 1033 |  |  |
  |  | 1051 |  |
  | 1034 | 1052 | /\*\* |
  | 1035 | 1053 | \* Generate commission for an item cost |
  | 1036 | 1054 | \*/ |
  | 1037 |  | public function wcfmmp\_generate\_commission\_cost(~~$item\_price, $commission\_rule, $quantity = 1~~ ) { |
  | 1038 |  |  |
  | 1039 |  | if~~( !$item\_price~~ ) return 0; |
  | 1040 |  | if~~( !$quantity && apply\_filters( 'wcfmmp\_is\_allow\_zero\_qty\_item\_commission\_zero', true )~~ ) return 0; |
  | 1041 |  |  |
  |  | 1055 | public function wcfmmp\_generate\_commission\_cost($item\_price, $commission\_rule, $quantity = 1) { |
  |  | 1056 |  |
  |  | 1057 | if (!$item\_price) return 0; |
  |  | 1058 | if (!$quantity && apply\_filters('wcfmmp\_is\_allow\_zero\_qty\_item\_commission\_zero', true)) return 0; |
  |  | 1059 |  |
  | 1042 | 1060 | $item\_commission = 0; |
  | 1043 |  | if~~( $commission\_rule && is\_array( $commission\_rule )~~ ) { |
  | 1044 |  | switch~~( $commission\_rule['mode']~~ ) { |
  |  | 1061 | if ($commission\_rule && is\_array($commission\_rule)) { |
  |  | 1062 | switch ($commission\_rule['mode']) { |
  | 1045 | 1063 | case 'percent': |
  | 1046 |  | $item\_commission = $item\_price \* ((float) $commission\_rule['percent']~~/~~100); |
  | 1047 |  | break; |
  | 1048 |  |  |
  |  | 1064 | $item\_commission = $item\_price \* ((float) $commission\_rule['percent'] / 100); |
  |  | 1065 | break; |
  |  | 1066 |  |
  | 1049 | 1067 | case 'fixed': |
  | 1050 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_fixed\_per\_unit', true )~~ ) { |
  |  | 1068 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_fixed\_per\_unit', true)) { |
  | 1051 | 1069 | $item\_commission = (float) $commission\_rule['fixed'] \* $quantity; |
  | 1052 | 1070 | } else { |
  | 1053 | 1071 | $item\_commission = (float) $commission\_rule['fixed']; |
  | 1054 | 1072 | } |
  | 1055 |  | break; |
  | 1056 |  |  |
  |  | 1073 | break; |
  |  | 1074 |  |
  | 1057 | 1075 | case 'percent\_fixed': |
  | 1058 |  | $item\_commission  = (float) $item\_price \* ((float) $commission\_rule['percent']~~/~~100); |
  | 1059 |  | if~~( apply\_filters( 'wcfmmp\_is\_allow\_commission\_fixed\_per\_unit', true )~~ ) { |
  |  | 1076 | $item\_commission  = (float) $item\_price \* ((float) $commission\_rule['percent'] / 100); |
  |  | 1077 | if (apply\_filters('wcfmmp\_is\_allow\_commission\_fixed\_per\_unit', true)) { |
  | 1060 | 1078 | $item\_commission += (float) $commission\_rule['fixed'] \* $quantity; |
  | 1061 | 1079 | } else { |
  | 1062 | 1080 | $item\_commission += (float) $commission\_rule['fixed']; |
  | 1063 | 1081 | } |
  | 1064 |  | break; |
  | 1065 |  | } |
  | 1066 |  |  |
  |  | 1082 | break; |
  |  | 1083 | } |
  |  | 1084 |  |
  | 1067 | 1085 | // Negative commission value By Pass |
  | 1068 |  | if~~( (float) $item\_price < (float) $item\_commission~~ ) { |
  |  | 1086 | if ((float) $item\_price < (float) $item\_commission) { |
  | 1069 | 1087 | $item\_commission = $item\_price; |
  | 1070 | 1088 | } |
  | 1071 |  |  |
  | 1072 |  | $admin\_fee\_mode = apply\_filters(~~'wcfm\_is\_admin\_fee\_mode', false~~ ); |
  | 1073 |  | if~~( $admin\_fee\_mode~~ ) { |
  |  | 1089 |  |
  |  | 1090 | $admin\_fee\_mode = apply\_filters('wcfm\_is\_admin\_fee\_mode', false); |
  |  | 1091 | if ($admin\_fee\_mode) { |
  | 1074 | 1092 | $item\_commission = (float) $item\_price - (float) $item\_commission; |
  | 1075 | 1093 | } |
  | 1076 | 1094 | } |
  | 1077 | 1095 | //wcfm\_log( "Item Commission:: " . $item\_commission ); |
  | 1078 |  |  |
  |  | 1096 |  |
  | 1079 | 1097 | return $item\_commission; |
  | 1080 | 1098 | } |
  | 1081 |  |  |
  |  | 1099 |  |
  | 1082 | 1100 | /\*\* |
  | 1083 | 1101 | \* Generate commission for an Order Item |
  | 1084 | 1102 | \*/ |
  | 1085 |  | public function wcfmmp\_get\_order\_item\_commission(~~$order\_id, $vendor\_id, $product\_id, $variation\_id, $item\_price, $quantity, $commission\_rule = ''~~ ) { |
  | 1086 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1087 |  |  |
  | 1088 |  | $item\_price = apply\_filters(~~'wcfmmp\_order\_item\_price', $item\_price, $product\_id, $variation\_id, $quantity, $vendor\_id, $order\_id~~ ); |
  | 1089 |  |  |
  | 1090 |  | $quantity = apply\_filters(~~'wcfmmp\_order\_item\_quantity', $quantity, $product\_id, $variation\_id, $item\_price, $vendor\_id, $order\_id~~ ); |
  | 1091 |  |  |
  | 1092 |  | if~~( !$commission\_rule~~ ) |
  | 1093 |  | $commission\_rule = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule(~~$product\_id, $variation\_id, $vendor\_id, $item\_price, $quantity, $order\_id~~ ); |
  | 1094 |  |  |
  | 1095 |  | $item\_commission = $this->wcfmmp\_generate\_commission\_cost(~~$item\_price, $commission\_rule, $quantity~~ ); |
  | 1096 |  |  |
  | 1097 |  | return apply\_filters(~~'wcfmmp\_order\_item\_commission', $item\_commission, $vendor\_id, $product\_id, $variation\_id, $item\_price, $quantity, $commission\_rule, $order\_id~~ ); |
  | 1098 |  | } |
  | 1099 |  |  |
  |  | 1103 | public function wcfmmp\_get\_order\_item\_commission($order\_id, $vendor\_id, $product\_id, $variation\_id, $item\_price, $quantity, $commission\_rule = '') { |
  |  | 1104 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1105 |  |
  |  | 1106 | $item\_price = apply\_filters('wcfmmp\_order\_item\_price', $item\_price, $product\_id, $variation\_id, $quantity, $vendor\_id, $order\_id); |
  |  | 1107 |  |
  |  | 1108 | $quantity = apply\_filters('wcfmmp\_order\_item\_quantity', $quantity, $product\_id, $variation\_id, $item\_price, $vendor\_id, $order\_id); |
  |  | 1109 |  |
  |  | 1110 | if (!$commission\_rule) |
  |  | 1111 | $commission\_rule = $WCFMmp->wcfmmp\_product->wcfmmp\_get\_product\_commission\_rule($product\_id, $variation\_id, $vendor\_id, $item\_price, $quantity, $order\_id); |
  |  | 1112 |  |
  |  | 1113 | $item\_commission = $this->wcfmmp\_generate\_commission\_cost($item\_price, $commission\_rule, $quantity); |
  |  | 1114 |  |
  |  | 1115 | return apply\_filters('wcfmmp\_order\_item\_commission', $item\_commission, $vendor\_id, $product\_id, $variation\_id, $item\_price, $quantity, $commission\_rule, $order\_id); |
  |  | 1116 | } |
  |  | 1117 |  |
  | 1100 | 1118 | /\*\* |
  | 1101 | 1119 | \* Generate Commission Rule by Vendor Sales |
  | 1102 | 1120 | \*/ |
  | 1103 |  | public function wcfmmp\_get\_commission\_rule\_by\_sales\_rule(~~$vendor\_id, $vendor\_commission\_sales\_rules, $commission\_rule = array()~~ ) { |
  | 1104 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1105 |  |  |
  | 1106 |  | if~~( !$vendor\_id~~ ) return false; |
  | 1107 |  |  |
  | 1108 |  | if~~( !$commission\_rule ) $commission\_rule = array( 'rule' => 'by\_sales', 'mode' => 'fixed', 'percent' => 0, 'fixed' => 0, 'tax\_enable' => 'no', 'tax\_name' => '', 'tax\_percent' => ''~~ ); |
  | 1109 |  | if~~( empty( $vendor\_commission\_sales\_rules )~~ ) { |
  |  | 1121 | public function wcfmmp\_get\_commission\_rule\_by\_sales\_rule($vendor\_id, $vendor\_commission\_sales\_rules, $commission\_rule = array()) { |
  |  | 1122 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1123 |  |
  |  | 1124 | if (!$vendor\_id) return false; |
  |  | 1125 |  |
  |  | 1126 | if (!$commission\_rule) $commission\_rule = array('rule' => 'by\_sales', 'mode' => 'fixed', 'percent' => 0, 'fixed' => 0, 'tax\_enable' => 'no', 'tax\_name' => '', 'tax\_percent' => ''); |
  |  | 1127 | if (empty($vendor\_commission\_sales\_rules)) { |
  | 1110 | 1128 | $commission\_rule['mode'] = 'fixed'; |
  | 1111 | 1129 | $commission\_rule['fixed'] = 0; |
  | 1112 | 1130 | return $commission\_rule; |
  | 1113 | 1131 | } |
  | 1114 |  |  |
  | 1115 |  | $vendor\_gross\_sales\_duration = apply\_filters(~~'wcfmmp\_commission\_vendor\_gross\_sales\_duration', 'all', $vendor\_id, $vendor\_commission\_sales\_rules~~ ); |
  | 1116 |  |  |
  | 1117 |  | $vendor\_gross\_sales = $WCFM->wcfm\_vendor\_support->wcfm\_get\_gross\_sales\_by\_vendor(~~$vendor\_id, $vendor\_gross\_sales\_duration~~ ); |
  | 1118 |  |  |
  |  | 1132 |  |
  |  | 1133 | $vendor\_gross\_sales\_duration = apply\_filters('wcfmmp\_commission\_vendor\_gross\_sales\_duration', 'all', $vendor\_id, $vendor\_commission\_sales\_rules); |
  |  | 1134 |  |
  |  | 1135 | $vendor\_gross\_sales = $WCFM->wcfm\_vendor\_support->wcfm\_get\_gross\_sales\_by\_vendor($vendor\_id, $vendor\_gross\_sales\_duration); |
  |  | 1136 |  |
  | 1119 | 1137 | $matched\_rule\_price = 0; |
  | 1120 |  | foreach~~( $vendor\_commission\_sales\_rules as $vendor\_commission\_sales\_rule~~ ) { |
  |  | 1138 | foreach ($vendor\_commission\_sales\_rules as $vendor\_commission\_sales\_rule) { |
  | 1121 | 1139 | $rule\_price = $vendor\_commission\_sales\_rule['sales']; |
  | 1122 | 1140 | $rule = $vendor\_commission\_sales\_rule['rule']; |
  | 1123 |  |  |
  | 1124 |  | if~~( ( $rule == 'upto' ) && ( (float)$vendor\_gross\_sales <= (float)$rule\_price ) && ( !$matched\_rule\_price || ( (float)$rule\_price <= (float)$matched\_rule\_price ) )~~ ) { |
  |  | 1141 |  |
  |  | 1142 | if (($rule == 'upto') && ((float)$vendor\_gross\_sales <= (float)$rule\_price) && (!$matched\_rule\_price || ((float)$rule\_price <= (float)$matched\_rule\_price))) { |
  | 1125 | 1143 | $matched\_rule\_price         = $rule\_price; |
  | 1126 | 1144 | $commission\_rule['mode']    = $vendor\_commission\_sales\_rule['type']; |
  | 1127 | 1145 | $commission\_rule['percent'] = $vendor\_commission\_sales\_rule['commission']; |
  | 1128 |  | $commission\_rule['fixed']   = isset(~~$vendor\_commission\_sales\_rule['commission\_fixed']~~ ) ? $vendor\_commission\_sales\_rule['commission\_fixed'] : $vendor\_commission\_sales\_rule['commission']; |
  | 1129 |  | } elseif~~( ( $rule == 'greater' ) && ( (float)$vendor\_gross\_sales > (float)$rule\_price ) && ( !$matched\_rule\_price || ( (float)$rule\_price >= (float)$matched\_rule\_price ) )~~ ) { |
  |  | 1146 | $commission\_rule['fixed']   = isset($vendor\_commission\_sales\_rule['commission\_fixed']) ? $vendor\_commission\_sales\_rule['commission\_fixed'] : $vendor\_commission\_sales\_rule['commission']; |
  |  | 1147 | } elseif (($rule == 'greater') && ((float)$vendor\_gross\_sales > (float)$rule\_price) && (!$matched\_rule\_price || ((float)$rule\_price >= (float)$matched\_rule\_price))) { |
  | 1130 | 1148 | $matched\_rule\_price         = $rule\_price; |
  | 1131 | 1149 | $commission\_rule['mode']    = $vendor\_commission\_sales\_rule['type']; |
  | 1132 | 1150 | $commission\_rule['percent'] = $vendor\_commission\_sales\_rule['commission']; |
  | 1133 |  | $commission\_rule['fixed']   = isset(~~$vendor\_commission\_sales\_rule['commission\_fixed']~~ ) ? $vendor\_commission\_sales\_rule['commission\_fixed'] : $vendor\_commission\_sales\_rule['commission']; |
  | 1134 |  | } |
  | 1135 |  | } |
  | 1136 |  | return apply\_filters(~~'wcfmmp\_commission\_rule\_by\_sales\_rule', $commission\_rule, $vendor\_id, $vendor\_commission\_sales\_rules~~ ); |
  | 1137 |  | } |
  | 1138 |  |  |
  |  | 1151 | $commission\_rule['fixed']   = isset($vendor\_commission\_sales\_rule['commission\_fixed']) ? $vendor\_commission\_sales\_rule['commission\_fixed'] : $vendor\_commission\_sales\_rule['commission']; |
  |  | 1152 | } |
  |  | 1153 | } |
  |  | 1154 | return apply\_filters('wcfmmp\_commission\_rule\_by\_sales\_rule', $commission\_rule, $vendor\_id, $vendor\_commission\_sales\_rules); |
  |  | 1155 | } |
  |  | 1156 |  |
  | 1139 | 1157 | /\*\* |
  | 1140 | 1158 | \* Generate Commission Rule by Product Price |
  | 1141 | 1159 | \*/ |
  | 1142 |  | public function wcfmmp\_get\_commission\_rule\_by\_product\_rule(~~$product\_id, $item\_price, $quantity, $vendor\_commission\_product\_rules = array(), $commission\_rule = array()~~ ) { |
  | 1143 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1144 |  |  |
  | 1145 |  | if~~( !$product\_id~~ ) return false; |
  | 1146 |  |  |
  | 1147 |  | if~~( !$commission\_rule )  $commission\_rule = array( 'rule' => 'by\_products', 'mode' => 'fixed', 'percent' => 0, 'fixed' => 0, 'tax\_enable' => 'no', 'tax\_name' => '', 'tax\_percent' => ''~~ ); |
  | 1148 |  | if~~( empty( $vendor\_commission\_product\_rules )~~ ) { |
  |  | 1160 | public function wcfmmp\_get\_commission\_rule\_by\_product\_rule($product\_id, $item\_price, $quantity, $vendor\_commission\_product\_rules = array(), $commission\_rule = array()) { |
  |  | 1161 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1162 |  |
  |  | 1163 | if (!$product\_id) return false; |
  |  | 1164 |  |
  |  | 1165 | if (!$commission\_rule)  $commission\_rule = array('rule' => 'by\_products', 'mode' => 'fixed', 'percent' => 0, 'fixed' => 0, 'tax\_enable' => 'no', 'tax\_name' => '', 'tax\_percent' => ''); |
  |  | 1166 | if (empty($vendor\_commission\_product\_rules)) { |
  | 1149 | 1167 | $commission\_rule['mode'] = 'fixed'; |
  | 1150 | 1168 | $commission\_rule['fixed'] = 0; |
  | 1151 | 1169 | return $commission\_rule; |
  | 1152 | 1170 | } |
  | 1153 |  |  |
  | 1154 |  | if~~( !$item\_price~~ ) { |
  | 1155 |  | $product = wc\_get\_product(~~$product\_id~~ ); |
  |  | 1171 |  |
  |  | 1172 | if (!$item\_price) { |
  |  | 1173 | $product = wc\_get\_product($product\_id); |
  | 1156 | 1174 | $item\_price = (float)$product->get\_price() \* (int)$quantity; |
  | 1157 | 1175 | } |
  | 1158 |  |  |
  |  | 1176 |  |
  | 1159 | 1177 | $matched\_rule\_price = 0; |
  | 1160 |  | foreach~~( $vendor\_commission\_product\_rules as $vendor\_commission\_product\_rule~~ ) { |
  |  | 1178 | foreach ($vendor\_commission\_product\_rules as $vendor\_commission\_product\_rule) { |
  | 1161 | 1179 | $rule\_price = $vendor\_commission\_product\_rule['cost']; |
  | 1162 | 1180 | $rule = $vendor\_commission\_product\_rule['rule']; |
  | 1163 |  |  |
  | 1164 |  | if~~( ( $rule == 'upto' ) && ( (float) $item\_price <= (float)$rule\_price ) && ( !$matched\_rule\_price || ( (float)$rule\_price <= (float)$matched\_rule\_price ) )~~ ) { |
  |  | 1181 |  |
  |  | 1182 | if (($rule == 'upto') && ((float) $item\_price <= (float)$rule\_price) && (!$matched\_rule\_price || ((float)$rule\_price <= (float)$matched\_rule\_price))) { |
  | 1165 | 1183 | $matched\_rule\_price         = $rule\_price; |
  | 1166 | 1184 | $commission\_rule['mode']    = $vendor\_commission\_product\_rule['type']; |
  | 1167 | 1185 | $commission\_rule['percent'] = $vendor\_commission\_product\_rule['commission']; |
  | 1168 |  | $commission\_rule['fixed']   = isset(~~$vendor\_commission\_product\_rule['commission\_fixed']~~ ) ? $vendor\_commission\_product\_rule['commission\_fixed'] : $vendor\_commission\_product\_rule['commission']; |
  | 1169 |  | } elseif~~( ( $rule == 'greater' ) && ( (float) $item\_price > (float)$rule\_price ) && ( !$matched\_rule\_price || ( (float)$rule\_price >= (float)$matched\_rule\_price ) )~~ ) { |
  |  | 1186 | $commission\_rule['fixed']   = isset($vendor\_commission\_product\_rule['commission\_fixed']) ? $vendor\_commission\_product\_rule['commission\_fixed'] : $vendor\_commission\_product\_rule['commission']; |
  |  | 1187 | } elseif (($rule == 'greater') && ((float) $item\_price > (float)$rule\_price) && (!$matched\_rule\_price || ((float)$rule\_price >= (float)$matched\_rule\_price))) { |
  | 1170 | 1188 | $matched\_rule\_price         = $rule\_price; |
  | 1171 | 1189 | $commission\_rule['mode']    = $vendor\_commission\_product\_rule['type']; |
  | 1172 | 1190 | $commission\_rule['percent'] = $vendor\_commission\_product\_rule['commission']; |
  | 1173 |  | $commission\_rule['fixed']   = isset(~~$vendor\_commission\_product\_rule['commission\_fixed']~~ ) ? $vendor\_commission\_product\_rule['commission\_fixed'] : $vendor\_commission\_product\_rule['commission']; |
  | 1174 |  | } |
  | 1175 |  | } |
  | 1176 |  | return apply\_filters(~~'wcfmmp\_commission\_rule\_by\_product\_rule', $commission\_rule, $product\_id, $item\_price, $quantity, $vendor\_commission\_product\_rules~~ ); |
  | 1177 |  | } |
  | 1178 |  |  |
  |  | 1191 | $commission\_rule['fixed']   = isset($vendor\_commission\_product\_rule['commission\_fixed']) ? $vendor\_commission\_product\_rule['commission\_fixed'] : $vendor\_commission\_product\_rule['commission']; |
  |  | 1192 | } |
  |  | 1193 | } |
  |  | 1194 | return apply\_filters('wcfmmp\_commission\_rule\_by\_product\_rule', $commission\_rule, $product\_id, $item\_price, $quantity, $vendor\_commission\_product\_rules); |
  |  | 1195 | } |
  |  | 1196 |  |
  | 1179 | 1197 | /\*\* |
  | 1180 | 1198 | \* Generate Commission Rule by Product Purchase Quantity |
  | 1181 | 1199 | \*/ |
  | 1182 |  | public function wcfmmp\_get\_commission\_rule\_by\_quantity\_rule($product\_id, $item\_price, $quantity, $vendor\_commission\_quantity\_rules = array(), $commission\_rule = array()) { |
  | 1183 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1184 |  |  |
  | 1185 |  | if~~( !$product\_id~~ ) return false; |
  | 1186 |  |  |
  | 1187 |  | if~~( !$commission\_rule )  $commission\_rule = array( 'rule' => 'by\_quantity', 'mode' => 'fixed', 'percent' => 0, 'fixed' => 0, 'tax\_enable' => 'no', 'tax\_name' => '', 'tax\_percent' => ''~~ ); |
  | 1188 |  | if~~( empty( $vendor\_commission\_quantity\_rules )~~ ) { |
  |  | 1200 | public function wcfmmp\_get\_commission\_rule\_by\_quantity\_rule($product\_id, $item\_price, $quantity, $vendor\_commission\_quantity\_rules = array(), $commission\_rule = array()) { |
  |  | 1201 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1202 |  |
  |  | 1203 | if (!$product\_id) return false; |
  |  | 1204 |  |
  |  | 1205 | if (!$commission\_rule)  $commission\_rule = array('rule' => 'by\_quantity', 'mode' => 'fixed', 'percent' => 0, 'fixed' => 0, 'tax\_enable' => 'no', 'tax\_name' => '', 'tax\_percent' => ''); |
  |  | 1206 | if (empty($vendor\_commission\_quantity\_rules)) { |
  | 1189 | 1207 | $commission\_rule['mode'] = 'fixed'; |
  | 1190 | 1208 | $commission\_rule['fixed'] = 0; |
  | 1191 | 1209 | return $commission\_rule; |
  | 1192 | 1210 | } |
  | 1193 |  |  |
  |  | 1211 |  |
  | 1194 | 1212 | $matched\_rule\_quantity = 0; |
  | 1195 |  | foreach~~( $vendor\_commission\_quantity\_rules as $vendor\_commission\_quantity\_rule~~ ) { |
  |  | 1213 | foreach ($vendor\_commission\_quantity\_rules as $vendor\_commission\_quantity\_rule) { |
  | 1196 | 1214 | $rule\_quantity = $vendor\_commission\_quantity\_rule['quantity']; |
  | 1197 | 1215 | $rule = $vendor\_commission\_quantity\_rule['rule']; |
  | 1198 |  |  |
  | 1199 |  | if~~( ( $rule == 'upto' ) && ( (float) $quantity <= (float)$rule\_quantity ) && ( !$matched\_rule\_quantity || ( (float)$rule\_quantity <= (float)$matched\_rule\_quantity ) )~~ ) { |
  |  | 1216 |  |
  |  | 1217 | if (($rule == 'upto') && ((float) $quantity <= (float)$rule\_quantity) && (!$matched\_rule\_quantity || ((float)$rule\_quantity <= (float)$matched\_rule\_quantity))) { |
  | 1200 | 1218 | $matched\_rule\_quantity      = $rule\_quantity; |
  | 1201 | 1219 | $commission\_rule['mode']    = $vendor\_commission\_quantity\_rule['type']; |
  | 1202 | 1220 | $commission\_rule['percent'] = $vendor\_commission\_quantity\_rule['commission']; |
  | 1203 |  | $commission\_rule['fixed']   = isset(~~$vendor\_commission\_quantity\_rule['commission\_fixed']~~ ) ? $vendor\_commission\_quantity\_rule['commission\_fixed'] : 0; |
  | 1204 |  | } elseif~~( ( $rule == 'greater' ) && ( (float) $quantity > (float)$rule\_quantity ) && ( !$matched\_rule\_quantity || ( (float)$rule\_quantity >= (float)$matched\_rule\_quantity ) )~~ ) { |
  |  | 1221 | $commission\_rule['fixed']   = isset($vendor\_commission\_quantity\_rule['commission\_fixed']) ? $vendor\_commission\_quantity\_rule['commission\_fixed'] : 0; |
  |  | 1222 | } elseif (($rule == 'greater') && ((float) $quantity > (float)$rule\_quantity) && (!$matched\_rule\_quantity || ((float)$rule\_quantity >= (float)$matched\_rule\_quantity))) { |
  | 1205 | 1223 | $matched\_rule\_quantity      = $rule\_quantity; |
  | 1206 | 1224 | $commission\_rule['mode']    = $vendor\_commission\_quantity\_rule['type']; |
  | 1207 | 1225 | $commission\_rule['percent'] = $vendor\_commission\_quantity\_rule['commission']; |
  | 1208 |  | $commission\_rule['fixed']   = isset(~~$vendor\_commission\_quantity\_rule['commission\_fixed']~~ ) ? $vendor\_commission\_quantity\_rule['commission\_fixed'] : 0; |
  | 1209 |  | } |
  | 1210 |  | } |
  | 1211 |  | return apply\_filters(~~'wcfmmp\_commission\_rule\_by\_quantity\_rule', $commission\_rule, $product\_id, $item\_price, $quantity, $vendor\_commission\_quantity\_rules~~ ); |
  | 1212 |  | } |
  | 1213 |  |  |
  |  | 1226 | $commission\_rule['fixed']   = isset($vendor\_commission\_quantity\_rule['commission\_fixed']) ? $vendor\_commission\_quantity\_rule['commission\_fixed'] : 0; |
  |  | 1227 | } |
  |  | 1228 | } |
  |  | 1229 | return apply\_filters('wcfmmp\_commission\_rule\_by\_quantity\_rule', $commission\_rule, $product\_id, $item\_price, $quantity, $vendor\_commission\_quantity\_rules); |
  |  | 1230 | } |
  |  | 1231 |  |
  | 1214 | 1232 | /\*\* |
  | 1215 | 1233 | \* Commission Order item refresh on Order Item Refund - WC Order Action |
  | 1216 | 1234 | \*/ |
  | 1217 |  | function wcfmmp\_commission\_order\_item\_refund( $order\_id, $refund\_id ) { |
  | 1218 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1219 |  |  |
  | 1220 |  | if ( did\_action( 'wp\_ajax\_woocommerce\_refund\_line\_items' ) ) { |
  |  | 1235 | function wcfmmp\_commission\_order\_item\_refund($order\_id, $refund\_id) { |
  |  | 1236 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1237 |  |
  |  | 1238 | if (did\_action('wp\_ajax\_woocommerce\_refund\_line\_items')) { |
  |  | 1239 | $order = wc\_get\_order($order\_id); |
  | 1221 | 1240 | // Reset WCFMmp Comission Orders |
  | 1222 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 1223 |  | //delete\_post\_meta( $order\_id, '\_wcfm\_store\_invoices' ); |
  | 1224 |  | //$this->wcfmmp\_commission\_order\_reset( $order\_id ); |
  | 1225 |  |  |
  | 1226 |  | $order = wc\_get\_order( $order\_id ); |
  | 1227 |  |  |
  | 1228 |  | $items = $order->get\_items( 'line\_item' ); |
  | 1229 |  | if( !empty( $items ) ) { |
  | 1230 |  | foreach( $items as $item\_id => $item ) { |
  |  | 1241 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 1242 | $order->save(); |
  |  | 1243 |  |
  |  | 1244 | $items = $order->get\_items('line\_item'); |
  |  | 1245 | if (!empty($items)) { |
  |  | 1246 | foreach ($items as $item\_id => $item) { |
  | 1231 | 1247 | $order\_item\_id = $item->get\_id(); |
  | 1232 |  | $order\_item\_processed = wc\_get\_order\_item\_meta(~~$order\_item\_id, '\_wcfmmp\_order\_item\_processed', true~~ ); |
  | 1233 |  | if~~( $order\_item\_processed~~ ) { |
  |  | 1248 | $order\_item\_processed = wc\_get\_order\_item\_meta($order\_item\_id, '\_wcfmmp\_order\_item\_processed', true); |
  |  | 1249 | if ($order\_item\_processed) { |
  | 1234 | 1250 | $sql = 'SELECT ID, withdraw\_status FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission'; |
  | 1235 | 1251 | $sql .= ' WHERE 1=1'; |
  | 1236 | 1252 | $sql .= " AND `item\_id` = " . $order\_item\_id; |
  | 1237 |  | $commission\_infos = $wpdb->get\_results(~~$sql~~ ); |
  | 1238 |  | if~~( !empty( $commission\_infos )~~ ) { |
  | 1239 |  | foreach~~( $commission\_infos as $commission\_info~~ ) { |
  | 1240 |  | if~~( $commission\_info->withdraw\_status != 'completed'~~ ) { |
  | 1241 |  | wc\_delete\_order\_item\_meta(~~$order\_item\_id, '\_wcfmmp\_order\_item\_processed'~~ ); |
  | 1242 |  | $this->wcfmmp\_commission\_order\_reset\_by\_commission(~~$commission\_info->ID~~ ); |
  |  | 1253 | $commission\_infos = $wpdb->get\_results($sql); |
  |  | 1254 | if (!empty($commission\_infos)) { |
  |  | 1255 | foreach ($commission\_infos as $commission\_info) { |
  |  | 1256 | if ($commission\_info->withdraw\_status != 'completed') { |
  |  | 1257 | wc\_delete\_order\_item\_meta($order\_item\_id, '\_wcfmmp\_order\_item\_processed'); |
  |  | 1258 | $this->wcfmmp\_commission\_order\_reset\_by\_commission($commission\_info->ID); |
  | 1243 | 1259 | } |
  | 1244 | 1260 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L1247) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L1263) |  |
  | 1247 | 1263 | } |
  | 1248 | 1264 | } |
  | 1249 |  |  |
  | 1250 |  | $order\_posted = ~~get\_post( $order\_id~~ ); |
  | 1251 |  | do\_action(~~'wcfm\_manual\_order\_processed', $order\_id, $order\_posted, $order~~ ); |
  | 1252 |  | } |
  | 1253 |  | } |
  | 1254 |  |  |
  |  | 1265 |  |
  |  | 1266 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 1267 | do\_action('wcfm\_manual\_order\_processed', $order\_id, $order\_posted, $order); |
  |  | 1268 | } |
  |  | 1269 | } |
  |  | 1270 |  |
  | 1255 | 1271 | /\*\* |
  | 1256 | 1272 | \* Comission order item create on New Item added to the order - WC Order Action |
  | 1257 | 1273 | \*/ |
  | 1258 |  | function wcfmmp\_commission\_order\_item\_add( $added\_items, $order ) { |
  | 1259 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1260 |  |  |
  | 1261 |  | delete\_post\_meta( $order->get\_id(), '\_wcfmmp\_order\_processed' ); |
  | 1262 |  |  |
  | 1263 |  | $order\_posted = get\_post( $order->get\_id() ); |
  | 1264 |  | do\_action( 'wcfm\_manual\_order\_processed', $order->get\_id(), $order\_posted, $order ); |
  | 1265 |  | } |
  | 1266 |  |  |
  |  | 1274 | function wcfmmp\_commission\_order\_item\_add($added\_items, $order) { |
  |  | 1275 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1276 |  |
  |  | 1277 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 1278 | $order->save(); |
  |  | 1279 |  |
  |  | 1280 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order->get\_id()); |
  |  | 1281 | do\_action('wcfm\_manual\_order\_processed', $order->get\_id(), $order\_posted, $order); |
  |  | 1282 | } |
  |  | 1283 |  |
  | 1267 | 1284 | /\*\* |
  | 1268 | 1285 | \* Commission Order item refresh on Order Item edit - WC Order Action |
  | 1269 | 1286 | \*/ |
  | 1270 |  | function wcfmmp\_commission\_order\_item\_edit( $order\_id, $items ) { |
  | 1271 |  | global $WCFM, $WCFMmp, $wpdb; |
  | 1272 |  |  |
  | 1273 |  | if ( did\_action( 'wp\_ajax\_woocommerce\_save\_order\_items' ) ) { |
  |  | 1287 | function wcfmmp\_commission\_order\_item\_edit($order\_id, $items) { |
  |  | 1288 | global $WCFM, $WCFMmp, $wpdb; |
  |  | 1289 |  |
  |  | 1290 | if (did\_action('wp\_ajax\_woocommerce\_save\_order\_items')) { |
  |  | 1291 | $order = wc\_get\_order($order\_id); |
  | 1274 | 1292 | // Reset WCFMmp Comission Orders |
  | 1275 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 1276 |  | //delete\_post\_meta( $order\_id, '\_wcfm\_store\_invoices' ); |
  | 1277 |  | //$this->wcfmmp\_commission\_order\_reset( $order\_id ); |
  | 1278 |  |  |
  | 1279 |  | if( !empty( $items ) && isset( $items['order\_item\_id'] ) ) { |
  | 1280 |  | foreach ( $items['order\_item\_id'] as $item\_id ) { |
  | 1281 |  | $item = WC\_Order\_Factory::get\_order\_item( absint( $item\_id ) ); |
  |  | 1293 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 1294 | $order->save(); |
  |  | 1295 |  |
  |  | 1296 | if (!empty($items) && isset($items['order\_item\_id'])) { |
  |  | 1297 | foreach ($items['order\_item\_id'] as $item\_id) { |
  |  | 1298 | $item = WC\_Order\_Factory::get\_order\_item(absint($item\_id)); |
  | 1282 | 1299 | $order\_item\_id = $item->get\_id(); |
  | 1283 |  | $order\_item\_processed = wc\_get\_order\_item\_meta(~~$order\_item\_id, '\_wcfmmp\_order\_item\_processed', true~~ ); |
  | 1284 |  | if~~( $order\_item\_processed~~ ) { |
  |  | 1300 | $order\_item\_processed = wc\_get\_order\_item\_meta($order\_item\_id, '\_wcfmmp\_order\_item\_processed', true); |
  |  | 1301 | if ($order\_item\_processed) { |
  | 1285 | 1302 | $sql = 'SELECT ID, withdraw\_status FROM ' . $wpdb->prefix . 'wcfm\_marketplace\_orders AS commission'; |
  | 1286 | 1303 | $sql .= ' WHERE 1=1'; |
  | 1287 | 1304 | $sql .= " AND `item\_id` = " . $order\_item\_id; |
  | 1288 |  | $commission\_infos = $wpdb->get\_results(~~$sql~~ ); |
  | 1289 |  | if~~( !empty( $commission\_infos )~~ ) { |
  | 1290 |  | foreach~~( $commission\_infos as $commission\_info~~ ) { |
  | 1291 |  | if~~( $commission\_info->withdraw\_status != 'completed'~~ ) { |
  | 1292 |  | wc\_delete\_order\_item\_meta(~~$order\_item\_id, '\_wcfmmp\_order\_item\_processed'~~ ); |
  | 1293 |  | $this->wcfmmp\_commission\_order\_reset\_by\_commission(~~$commission\_info->ID~~ ); |
  |  | 1305 | $commission\_infos = $wpdb->get\_results($sql); |
  |  | 1306 | if (!empty($commission\_infos)) { |
  |  | 1307 | foreach ($commission\_infos as $commission\_info) { |
  |  | 1308 | if ($commission\_info->withdraw\_status != 'completed') { |
  |  | 1309 | wc\_delete\_order\_item\_meta($order\_item\_id, '\_wcfmmp\_order\_item\_processed'); |
  |  | 1310 | $this->wcfmmp\_commission\_order\_reset\_by\_commission($commission\_info->ID); |
  | 1294 | 1311 | } |
  | 1295 | 1312 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=2848338#L1298) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-commission.php?rev=3000763#L1315) |  |
  | 1298 | 1315 | } |
  | 1299 | 1316 | } |
  | 1300 |  |  |
  | 1301 |  | $order\_posted = ~~get\_post( $order\_id~~ ); |
  | 1302 |  | do\_action(~~'wcfm\_manual\_order\_processed', $order\_id, $order\_posted, wc\_get\_order( $order\_id )~~ ); |
  | 1303 |  | } |
  | 1304 |  | } |
  | 1305 |  |  |
  |  | 1317 |  |
  |  | 1318 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 1319 | do\_action('wcfm\_manual\_order\_processed', $order\_id, $order\_posted, $order); |
  |  | 1320 | } |
  |  | 1321 | } |
  |  | 1322 |  |
  | 1306 | 1323 | /\*\* |
  | 1307 | 1324 | \* Commission Order Delete on Order Item Delete - WC Order Action |
  | 1308 | 1325 | \*/ |
  | 1309 |  | function wcfmmp\_commission\_order\_item\_delete(~~$item\_id~~ ) { |
  |  | 1326 | function wcfmmp\_commission\_order\_item\_delete($item\_id) { |
  | 1310 | 1327 | global $wpdb; |
  | 1311 |  |  |
  | 1312 |  | $marketplace\_orders = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_orders WHERE `item\_id` = %d", $item\_id )~~ ); |
  | 1313 |  | foreach~~( $marketplace\_orders as $marketplace\_order~~ ) { |
  | 1314 |  |  |
  |  | 1328 |  |
  |  | 1329 | $marketplace\_orders = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_orders WHERE `item\_id` = %d", $item\_id)); |
  |  | 1330 | foreach ($marketplace\_orders as $marketplace\_order) { |
  |  | 1331 |  |
  | 1315 | 1332 | // Order Meta |
  | 1316 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders\_meta WHERE order\_commission\_id = %d", $marketplace\_order->ID )~~ ); |
  | 1317 |  |  |
  |  | 1333 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders\_meta WHERE order\_commission\_id = %d", $marketplace\_order->ID)); |
  |  | 1334 |  |
  | 1318 | 1335 | // Ledger Data |
  | 1319 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_order->ID )~~ ); |
  | 1320 |  |  |
  |  | 1336 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_order->ID)); |
  |  | 1337 |  |
  | 1321 | 1338 | // Withdrawals |
  | 1322 |  | $marketplace\_withdrawals = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $marketplace\_order->ID )~~ ); |
  | 1323 |  | foreach~~( $marketplace\_withdrawals as $marketplace\_withdrawal~~ ) { |
  | 1324 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_withdrawal->ID )~~ ); |
  | 1325 |  | } |
  | 1326 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $marketplace\_order->ID )~~ ); |
  | 1327 |  |  |
  |  | 1339 | $marketplace\_withdrawals = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $marketplace\_order->ID)); |
  |  | 1340 | foreach ($marketplace\_withdrawals as $marketplace\_withdrawal) { |
  |  | 1341 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_withdrawal->ID)); |
  |  | 1342 | } |
  |  | 1343 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $marketplace\_order->ID)); |
  |  | 1344 |  |
  | 1328 | 1345 | // Reverse Withdrawals |
  | 1329 |  | $marketplace\_reveerse\_withdrawals = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $marketplace\_order->ID )~~ ); |
  | 1330 |  | foreach~~( $marketplace\_reveerse\_withdrawals as $marketplace\_reveerse\_withdrawal~~ ) { |
  | 1331 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_reveerse\_withdrawal->ID )~~ ); |
  | 1332 |  | } |
  | 1333 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $marketplace\_order->ID )~~ ); |
  | 1334 |  |  |
  |  | 1346 | $marketplace\_reveerse\_withdrawals = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $marketplace\_order->ID)); |
  |  | 1347 | foreach ($marketplace\_reveerse\_withdrawals as $marketplace\_reveerse\_withdrawal) { |
  |  | 1348 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_reveerse\_withdrawal->ID)); |
  |  | 1349 | } |
  |  | 1350 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $marketplace\_order->ID)); |
  |  | 1351 |  |
  | 1335 | 1352 | // Refund Requests |
  | 1336 |  | $marketplace\_refunds = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $marketplace\_order->ID )~~ ); |
  | 1337 |  | foreach~~( $marketplace\_refunds as $marketplace\_refund~~ ) { |
  | 1338 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_refund->ID )~~ ); |
  | 1339 |  | } |
  | 1340 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $marketplace\_order->ID )~~ ); |
  | 1341 |  | } |
  | 1342 |  |  |
  | 1343 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders WHERE `item\_id` = %d", $item\_id )~~ ); |
  | 1344 |  | } |
  | 1345 |  |  |
  |  | 1353 | $marketplace\_refunds = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $marketplace\_order->ID)); |
  |  | 1354 | foreach ($marketplace\_refunds as $marketplace\_refund) { |
  |  | 1355 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_refund->ID)); |
  |  | 1356 | } |
  |  | 1357 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $marketplace\_order->ID)); |
  |  | 1358 | } |
  |  | 1359 |  |
  |  | 1360 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders WHERE `item\_id` = %d", $item\_id)); |
  |  | 1361 | } |
  |  | 1362 |  |
  | 1346 | 1363 | /\*\* |
  | 1347 | 1364 | \* Commission Order Un Trash on Order Retrive |
  | 1348 | 1365 | \*/ |
  | 1349 |  | function wcfmmp\_commission\_order\_untrash(~~$order\_id~~ ) { |
  |  | 1366 | function wcfmmp\_commission\_order\_untrash($order\_id) { |
  | 1350 | 1367 | global $wpdb; |
  | 1351 | 1368 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('is\_trashed' => 0), array('order\_id' => $order\_id), array('%d'), array('%d')); |
  | 1352 | 1369 | } |
  | 1353 |  |  |
  |  | 1370 |  |
  | 1354 | 1371 | /\*\* |
  | 1355 | 1372 | \* Commission Order Trash on Order Trashed |
  | 1356 | 1373 | \*/ |
  | 1357 |  | function wcfmmp\_commission\_order\_trash(~~$order\_id~~ ) { |
  |  | 1374 | function wcfmmp\_commission\_order\_trash($order\_id) { |
  | 1358 | 1375 | global $wpdb; |
  | 1359 |  |  |
  | 1360 |  | if (~~in\_array( get\_post\_type( $order\_id ), wc\_get\_order\_types(), true )~~ ) { |
  | 1361 |  | $order = wc\_get\_order(~~$order\_id~~ ); |
  | 1362 |  | if (~~is\_a( $order , 'WC\_Order' )~~ ) { |
  |  | 1376 |  |
  |  | 1377 | if (OrderUtil::is\_order($order\_id, wc\_get\_order\_types())) { |
  |  | 1378 | $order = wc\_get\_order($order\_id); |
  |  | 1379 | if (is\_a($order, 'WC\_Order')) { |
  | 1363 | 1380 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('is\_trashed' => 1), array('order\_id' => $order\_id), array('%d'), array('%d')); |
  | 1364 |  | $this->wcfmmp\_commission\_order\_reset(~~$order\_id, false~~ ); |
  | 1365 |  | } |
  | 1366 |  | } |
  | 1367 |  | } |
  | 1368 |  |  |
  |  | 1381 | $this->wcfmmp\_commission\_order\_reset($order\_id, false); |
  |  | 1382 | } |
  |  | 1383 | } |
  |  | 1384 | } |
  |  | 1385 |  |
  | 1369 | 1386 | /\*\* |
  | 1370 | 1387 | \* Commission Order Delete on Order Delete |
  | 1371 | 1388 | \*/ |
  | 1372 |  | function wcfmmp\_commission\_order\_delete(~~$order\_id~~ ) { |
  |  | 1389 | function wcfmmp\_commission\_order\_delete($order\_id) { |
  | 1373 | 1390 | global $wpdb; |
  | 1374 |  |  |
  | 1375 |  | if (~~in\_array( get\_post\_type( $order\_id ), wc\_get\_order\_types(), true )~~ ) { |
  | 1376 |  | $order = wc\_get\_order(~~$order\_id~~ ); |
  | 1377 |  | if (~~is\_a( $order , 'WC\_Order' )~~ ) { |
  | 1378 |  | $this->wcfmmp\_commission\_order\_reset(~~$order\_id~~ ); |
  | 1379 |  | } |
  | 1380 |  | } |
  | 1381 |  | } |
  | 1382 |  |  |
  |  | 1391 |  |
  |  | 1392 | if (OrderUtil::is\_order($order\_id, wc\_get\_order\_types())) { |
  |  | 1393 | $order = wc\_get\_order($order\_id); |
  |  | 1394 | if (is\_a($order, 'WC\_Order')) { |
  |  | 1395 | $this->wcfmmp\_commission\_order\_reset($order\_id); |
  |  | 1396 | } |
  |  | 1397 | } |
  |  | 1398 | } |
  |  | 1399 |  |
  | 1383 | 1400 | /\*\* |
  | 1384 | 1401 | \* Commission Order Reset by Order |
  | 1385 | 1402 | \*/ |
  | 1386 |  | public function wcfmmp\_commission\_order\_reset(~~$order\_id, $commission\_order = true~~ ) { |
  |  | 1403 | public function wcfmmp\_commission\_order\_reset($order\_id, $commission\_order = true) { |
  | 1387 | 1404 | global $wpdb; |
  | 1388 |  |  |
  |  | 1405 |  |
  | 1389 | 1406 | // Commission Orders |
  | 1390 |  | if~~( $commission\_order~~ ) { |
  | 1391 |  | $marketplace\_orders = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID, item\_id from {$wpdb->prefix}wcfm\_marketplace\_orders WHERE order\_id = %d", $order\_id )~~ ); |
  | 1392 |  | foreach~~( $marketplace\_orders as $marketplace\_order~~ ) { |
  |  | 1407 | if ($commission\_order) { |
  |  | 1408 | $marketplace\_orders = $wpdb->get\_results($wpdb->prepare("SELECT ID, item\_id from {$wpdb->prefix}wcfm\_marketplace\_orders WHERE order\_id = %d", $order\_id)); |
  |  | 1409 | foreach ($marketplace\_orders as $marketplace\_order) { |
  | 1393 | 1410 | // Order Item Meta |
  | 1394 |  | wc\_delete\_order\_item\_meta(~~$marketplace\_order->item\_id, '\_wcfmmp\_order\_item\_processed'~~ ); |
  | 1395 |  |  |
  |  | 1411 | wc\_delete\_order\_item\_meta($marketplace\_order->item\_id, '\_wcfmmp\_order\_item\_processed'); |
  |  | 1412 |  |
  | 1396 | 1413 | // Order Meta |
  | 1397 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders\_meta WHERE order\_commission\_id = %d", $marketplace\_order->ID )~~ ); |
  | 1398 |  |  |
  |  | 1414 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders\_meta WHERE order\_commission\_id = %d", $marketplace\_order->ID)); |
  |  | 1415 |  |
  | 1399 | 1416 | // Ledger Data |
  | 1400 |  | $wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_order->ID ) ); |
  | 1401 |  | } |
  | 1402 |  | $wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders WHERE order\_id = %d", $order\_id ) ); |
  | 1403 |  |  |
  | 1404 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 1405 |  | delete\_post\_meta( $order\_id, '\_wcfm\_store\_invoices' ); |
  | 1406 |  | delete\_post\_meta( $order\_id, '\_wcfm\_store\_invoice\_ids' ); |
  | 1407 |  | } |
  | 1408 |  |  |
  |  | 1417 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_order->ID)); |
  |  | 1418 | } |
  |  | 1419 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders WHERE order\_id = %d", $order\_id)); |
  |  | 1420 |  |
  |  | 1421 | $order = wc\_get\_order($order\_id); |
  |  | 1422 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 1423 | $order->delete\_meta\_data('\_wcfm\_store\_invoices'); |
  |  | 1424 | $order->delete\_meta\_data('\_wcfm\_store\_invoice\_ids'); |
  |  | 1425 | $order->save(); |
  |  | 1426 | } |
  |  | 1427 |  |
  | 1409 | 1428 | // Withdrawals |
  | 1410 |  | $marketplace\_withdrawals = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE order\_ids = %s", $order\_id )~~ ); |
  | 1411 |  | foreach~~( $marketplace\_withdrawals as $marketplace\_withdrawal~~ ) { |
  | 1412 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_withdrawal->ID )~~ ); |
  | 1413 |  | } |
  | 1414 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE order\_ids = %s", $order\_id )~~ ); |
  | 1415 |  |  |
  |  | 1429 | $marketplace\_withdrawals = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE order\_ids = %s", $order\_id)); |
  |  | 1430 | foreach ($marketplace\_withdrawals as $marketplace\_withdrawal) { |
  |  | 1431 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_withdrawal->ID)); |
  |  | 1432 | } |
  |  | 1433 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE order\_ids = %s", $order\_id)); |
  |  | 1434 |  |
  | 1416 | 1435 | // Reverse Withdrawals |
  | 1417 |  | $marketplace\_reveerse\_withdrawals = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE order\_id = %s", $order\_id )~~ ); |
  | 1418 |  | foreach~~( $marketplace\_reveerse\_withdrawals as $marketplace\_reveerse\_withdrawal~~ ) { |
  | 1419 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_reveerse\_withdrawal->ID )~~ ); |
  | 1420 |  | } |
  | 1421 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE order\_id = %s", $order\_id )~~ ); |
  | 1422 |  |  |
  |  | 1436 | $marketplace\_reveerse\_withdrawals = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE order\_id = %s", $order\_id)); |
  |  | 1437 | foreach ($marketplace\_reveerse\_withdrawals as $marketplace\_reveerse\_withdrawal) { |
  |  | 1438 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_reveerse\_withdrawal->ID)); |
  |  | 1439 | } |
  |  | 1440 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE order\_id = %s", $order\_id)); |
  |  | 1441 |  |
  | 1423 | 1442 | // Refund Requests |
  | 1424 |  | $marketplace\_refunds = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE order\_id = %d", $order\_id )~~ ); |
  | 1425 |  | foreach~~( $marketplace\_refunds as $marketplace\_refund~~ ) { |
  | 1426 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_refund->ID )~~ ); |
  | 1427 |  | } |
  | 1428 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE order\_id = %d", $order\_id )~~ ); |
  | 1429 |  | } |
  | 1430 |  |  |
  |  | 1443 | $marketplace\_refunds = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE order\_id = %d", $order\_id)); |
  |  | 1444 | foreach ($marketplace\_refunds as $marketplace\_refund) { |
  |  | 1445 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_refund->ID)); |
  |  | 1446 | } |
  |  | 1447 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE order\_id = %d", $order\_id)); |
  |  | 1448 | } |
  |  | 1449 |  |
  | 1431 | 1450 | /\*\* |
  | 1432 | 1451 | \* Commission Order reset by Commission |
  | 1433 | 1452 | \*/ |
  | 1434 |  | public function wcfmmp\_commission\_order\_reset\_by\_commission(~~$commission\_id~~ ) { |
  |  | 1453 | public function wcfmmp\_commission\_order\_reset\_by\_commission($commission\_id) { |
  | 1435 | 1454 | global $wpdb; |
  | 1436 |  |  |
  |  | 1455 |  |
  | 1437 | 1456 | // Order Item Meta |
  | 1438 |  | $marketplace\_orders = $wpdb->get\_results(~~$wpdb->prepare( "SELECT item\_id from {$wpdb->prefix}wcfm\_marketplace\_orders WHERE ID = %d", $commission\_id )~~ ); |
  | 1439 |  | foreach~~( $marketplace\_orders as $marketplace\_order~~ ) { |
  | 1440 |  | wc\_delete\_order\_item\_meta(~~$marketplace\_order->item\_id, '\_wcfmmp\_order\_item\_processed'~~ ); |
  | 1441 |  | } |
  | 1442 |  |  |
  |  | 1457 | $marketplace\_orders = $wpdb->get\_results($wpdb->prepare("SELECT item\_id from {$wpdb->prefix}wcfm\_marketplace\_orders WHERE ID = %d", $commission\_id)); |
  |  | 1458 | foreach ($marketplace\_orders as $marketplace\_order) { |
  |  | 1459 | wc\_delete\_order\_item\_meta($marketplace\_order->item\_id, '\_wcfmmp\_order\_item\_processed'); |
  |  | 1460 | } |
  |  | 1461 |  |
  | 1443 | 1462 | // Commission Orders |
  | 1444 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $commission\_id )~~ ); |
  | 1445 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders WHERE ID = %d", $commission\_id )~~ ); |
  | 1446 |  |  |
  |  | 1463 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $commission\_id)); |
  |  | 1464 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_orders WHERE ID = %d", $commission\_id)); |
  |  | 1465 |  |
  | 1447 | 1466 | // Withdrawals |
  | 1448 |  | $marketplace\_withdrawals = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $commission\_id )~~ ); |
  | 1449 |  | foreach~~( $marketplace\_withdrawals as $marketplace\_withdrawal~~ ) { |
  | 1450 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_withdrawal->ID )~~ ); |
  | 1451 |  | } |
  | 1452 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $commission\_id )~~ ); |
  | 1453 |  |  |
  |  | 1467 | $marketplace\_withdrawals = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $commission\_id)); |
  |  | 1468 | foreach ($marketplace\_withdrawals as $marketplace\_withdrawal) { |
  |  | 1469 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_withdrawal->ID)); |
  |  | 1470 | } |
  |  | 1471 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_withdraw\_request WHERE commission\_ids = %s", $commission\_id)); |
  |  | 1472 |  |
  | 1454 | 1473 | // Reverse Withdrawals |
  | 1455 |  | $marketplace\_reveerse\_withdrawals = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $commission\_id )~~ ); |
  | 1456 |  | foreach~~( $marketplace\_reveerse\_withdrawals as $marketplace\_reveerse\_withdrawal~~ ) { |
  | 1457 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_reveerse\_withdrawal->ID )~~ ); |
  | 1458 |  | } |
  | 1459 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $commission\_id )~~ ); |
  | 1460 |  |  |
  |  | 1474 | $marketplace\_reveerse\_withdrawals = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $commission\_id)); |
  |  | 1475 | foreach ($marketplace\_reveerse\_withdrawals as $marketplace\_reveerse\_withdrawal) { |
  |  | 1476 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_reveerse\_withdrawal->ID)); |
  |  | 1477 | } |
  |  | 1478 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal WHERE commission\_id = %s", $commission\_id)); |
  |  | 1479 |  |
  | 1461 | 1480 | // Refund Requests |
  | 1462 |  | $marketplace\_refunds = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $commission\_id )~~ ); |
  | 1463 |  | foreach~~( $marketplace\_refunds as $marketplace\_refund~~ ) { |
  | 1464 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_refund->ID )~~ ); |
  | 1465 |  | } |
  | 1466 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $commission\_id )~~ ); |
  |  | 1481 | $marketplace\_refunds = $wpdb->get\_results($wpdb->prepare("SELECT ID from {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $commission\_id)); |
  |  | 1482 | foreach ($marketplace\_refunds as $marketplace\_refund) { |
  |  | 1483 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_vendor\_ledger WHERE reference\_id = %d", $marketplace\_refund->ID)); |
  |  | 1484 | } |
  |  | 1485 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_marketplace\_refund\_request WHERE commission\_id = %d", $commission\_id)); |
  | 1467 | 1486 | } |
  | 1468 | 1487 | } |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php")

  | [r2887030](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=2887030#L375 "Show revision 2887030 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=3000763#L375 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 375 | 375 | function wcfmmp\_checkout\_user\_location\_save( $order\_id ) { |
  | 376 | 376 | if( apply\_filters( 'wcfmmp\_is\_allow\_checkout\_user\_location', true ) ) { |
  |  | 377 | $order = wc\_get\_order( $order\_id ); |
  |  | 378 |  |
  | 377 | 379 | if ( ! empty( $\_POST['wcfmmp\_user\_location'] ) ) { |
  | 378 |  | ~~update\_post\_meta( $order\_id, '\_wcfmmp\_user\_location', sanitize\_text\_field( $\_POST['wcfmmp\_user\_location'] )~~ ); |
  |  | 380 | $order->update\_meta\_data('\_wcfmmp\_user\_location',sanitize\_text\_field( $\_POST['wcfmmp\_user\_location'] )); |
  | 379 | 381 | } |
  | 380 | 382 | if ( ! empty( $\_POST['wcfmmp\_user\_location\_lat'] ) ) { |
  | 381 |  | ~~update\_post\_meta( $order\_id, '\_wcfmmp\_user\_location\_lat', sanitize\_text\_field( $\_POST['wcfmmp\_user\_location\_lat'] )~~ ); |
  |  | 383 | $order->update\_meta\_data('\_wcfmmp\_user\_location\_lat',sanitize\_text\_field( $\_POST['wcfmmp\_user\_location\_lat'] )); |
  | 382 | 384 | } |
  | 383 | 385 | if ( ! empty( $\_POST['wcfmmp\_user\_location\_lng'] ) ) { |
  | 384 |  | update\_post\_meta( $order\_id, '\_wcfmmp\_user\_location\_lng', sanitize\_text\_field( $\_POST['wcfmmp\_user\_location\_lng'] ) ); |
  | 385 |  | } |
  |  | 386 | $order->update\_meta\_data('\_wcfmmp\_user\_location\_lng',sanitize\_text\_field( $\_POST['wcfmmp\_user\_location\_lng'] )); |
  |  | 387 | } |
  |  | 388 |  |
  |  | 389 | $order->save(); |
  | 386 | 390 | } |
  | 387 | 391 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=2887030#L392) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=3000763#L396) |  |
  | 392 | 396 | function wcfmmp\_order\_details\_user\_location\_show( $order ) { |
  | 393 | 397 | if( apply\_filters( 'wcfmmp\_is\_allow\_checkout\_user\_location', true ) ) { |
  | 394 |  | $address = ~~get\_post\_meta( $order->get\_id(), '\_wcfmmp\_user\_location', true~~ ); |
  | 395 |  | $lat     = ~~get\_post\_meta( $order->get\_id(), '\_wcfmmp\_user\_location\_lat', true~~ ); |
  | 396 |  | $lng     = ~~get\_post\_meta( $order->get\_id(), '\_wcfmmp\_user\_location\_lng', true~~ ); |
  |  | 398 | $address = $order->get\_meta('\_wcfmmp\_user\_location'); |
  |  | 399 | $lat     = $order->get\_meta('\_wcfmmp\_user\_location\_lat'); |
  |  | 400 | $lng     = $order->get\_meta('\_wcfmmp\_user\_location\_lng'); |
  | 397 | 401 | if( $address ) { |
  | 398 | 402 | $address = '<a href="https://google.com/maps/place/' . rawurlencode( $address ) . '/@' . esc\_attr($lat) . ',' . esc\_attr($lng) . '" target="\_blank"><span>' . esc\_attr($address) . '</span></a>'; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=2887030#L404) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-frontend.php?rev=3000763#L408) |  |
  | 404 | 408 | function wcfmmp\_order\_list\_user\_location\_show( $shipping\_address, $order\_id ) { |
  | 405 | 409 | if( apply\_filters( 'wcfmmp\_is\_allow\_checkout\_user\_location', true ) ) { |
  | 406 |  | $address = get\_post\_meta( $order\_id, '\_wcfmmp\_user\_location', true ); |
  | 407 |  | $lat     = get\_post\_meta( $order\_id, '\_wcfmmp\_user\_location\_lat', true ); |
  | 408 |  | $lng     = get\_post\_meta( $order\_id, '\_wcfmmp\_user\_location\_lng', true ); |
  |  | 410 | $order = wc\_get\_order( $order\_id ); |
  |  | 411 | $address = $order->get\_meta('\_wcfmmp\_user\_location'); |
  |  | 412 | $lat     = $order->get\_meta('\_wcfmmp\_user\_location\_lat'); |
  |  | 413 | $lng     = $order->get\_meta('\_wcfmmp\_user\_location\_lng'); |
  | 409 | 414 | if( $address ) { |
  | 410 | 415 | $address = '<a href="https://google.com/maps/place/' . rawurlencode( $address ) . '/@' . esc\_attr($lat) . ',' . esc\_attr($lng) . '" target="\_blank"><span>' . esc\_attr($address) . '</span></a>'; |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php")

  | [r2628122](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php?rev=2628122#L10 "Show revision 2628122 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php?rev=3000763#L10 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \* @version   1.0.0 |
  | 11 | 11 | \*/ |
  | 12 |  |  |
  |  | 12 |  |
  | 13 | 13 | class WCFMmp\_Library { |
  | 14 |  |  |
  |  | 14 |  |
  | 15 | 15 | public $lib\_path; |
  | 16 |  |  |
  | 17 |  | public $lib\_url; |
  | 18 |  |  |
  | 19 |  | public $php\_lib\_path; |
  | 20 |  |  |
  | 21 |  | public $php\_lib\_url; |
  | 22 |  |  |
  | 23 |  | public $js\_lib\_path; |
  | 24 |  |  |
  | 25 |  | public $js\_lib\_url; |
  | 26 |  |  |
  | 27 |  | public $css\_lib\_path; |
  | 28 |  |  |
  | 29 |  | public $css\_lib\_url; |
  | 30 |  |  |
  | 31 |  | public $views\_path; |
  | 32 |  |  |
  |  | 16 |  |
  |  | 17 | public $lib\_url; |
  |  | 18 |  |
  |  | 19 | public $php\_lib\_path; |
  |  | 20 |  |
  |  | 21 | public $php\_lib\_url; |
  |  | 22 |  |
  |  | 23 | public $js\_lib\_path; |
  |  | 24 |  |
  |  | 25 | public $js\_lib\_url; |
  |  | 26 |  |
  |  | 27 | public $js\_lib\_url\_min; |
  |  | 28 |  |
  |  | 29 | public $css\_lib\_path; |
  |  | 30 |  |
  |  | 31 | public $css\_lib\_url; |
  |  | 32 |  |
  |  | 33 | public $css\_lib\_url\_min; |
  |  | 34 |  |
  |  | 35 | public $views\_path; |
  |  | 36 |  |
  | 33 | 37 | public function \_\_construct() { |
  | 34 |  | global $WCFMmp; |
  | 35 |  |  |
  | 36 |  | $this->lib\_path = $WCFMmp->plugin\_path . 'assets/'; |
  | 37 |  |  |
  | 38 |  | $this->lib\_url = $WCFMmp->plugin\_url . 'assets/'; |
  | 39 |  |  |
  | 40 |  | $this->php\_lib\_path = $this->lib\_path . 'php/'; |
  | 41 |  |  |
  | 42 |  | $this->php\_lib\_url = $this->lib\_url . 'php/'; |
  | 43 |  |  |
  | 44 |  | $this->js\_lib\_path = $this->lib\_path . 'js/'; |
  | 45 |  |  |
  | 46 |  | $this->js\_lib\_url = $this->lib\_url . 'js/'; |
  | 47 |  |  |
  | 48 |  | $this->js\_lib\_url\_min = $this->js\_lib\_url . 'min/'; |
  | 49 |  |  |
  | 50 |  | $this->css\_lib\_path = $this->lib\_path . 'css/'; |
  | 51 |  |  |
  | 52 |  | $this->css\_lib\_url = $this->lib\_url . 'css/'; |
  | 53 |  |  |
  | 54 |  | $this->css\_lib\_url\_min = $this->css\_lib\_url . 'min/'; |
  | 55 |  |  |
  | 56 |  | $this->views\_path = $WCFMmp->plugin\_path . 'views/'; |
  | 57 |  |  |
  | 58 |  | // Load wcfmmp Scripts |
  | 59 |  | ~~add\_action( 'wcfm\_load\_scripts', array( &$this, 'load\_scripts' )~~ ); |
  | 60 |  | ~~add\_action( 'after\_wcfm\_load\_scripts', array( &$this, 'load\_scripts' )~~ ); |
  | 61 |  |  |
  | 62 |  | // Load wcfmmp Styles |
  | 63 |  | ~~add\_action( 'wcfm\_load\_styles', array( &$this, 'load\_styles' )~~ ); |
  | 64 |  | ~~add\_action( 'after\_wcfm\_load\_styles', array( &$this, 'load\_styles' )~~ ); |
  | 65 |  |  |
  | 66 |  | // Load wcfmmp views |
  | 67 |  | ~~add\_action( 'wcfm\_load\_views', array( &$this, 'load\_views' )~~ ); |
  | 68 |  | } |
  | 69 |  |  |
  | 70 |  | ~~public function load\_scripts( $end\_point~~ ) { |
  | 71 |  | global $WCFM, $WCFMmp; |
  | 72 |  |  |
  | 73 |  | ~~switch( $end\_point~~ ) { |
  | 74 |  |  |
  | 75 |  | case 'wcfm-dashboard': |
  | 76 |  |  |
  | 77 |  | break; |
  | 78 |  |  |
  | 79 |  | case 'wcfm-products-manage': |
  | 80 |  | ~~if( !wcfm\_is\_vendor()~~ ) { |
  | 81 |  | ~~wp\_enqueue\_script( 'wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true~~ ); |
  | 82 |  | } |
  | 83 |  | break; |
  | 84 |  |  |
  | 85 |  | case 'wcfm-settings': |
  | 86 |  | ~~if( !wcfm\_is\_vendor()~~ ) { |
  | 87 |  | ~~wp\_enqueue\_script( 'wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true~~ ); |
  | 88 |  |  |
  | 89 |  | $wcfm\_store\_color\_setting\_options = $WCFMmp->wcfmmp\_settings->wcfmmp\_store\_color\_setting\_options(); |
  | 90 |  | wp\_localize\_script(~~'wcfmmp\_settings\_js', 'wcfm\_store\_color\_setting\_options', $wcfm\_store\_color\_setting\_options~~ ); |
  | 91 |  |  |
  | 92 |  | wp\_enqueue\_script(~~'jquery-ui-autocomplete'~~ ); |
  |  | 38 | global $WCFMmp; |
  |  | 39 |  |
  |  | 40 | $this->lib\_path = $WCFMmp->plugin\_path . 'assets/'; |
  |  | 41 |  |
  |  | 42 | $this->lib\_url = $WCFMmp->plugin\_url . 'assets/'; |
  |  | 43 |  |
  |  | 44 | $this->php\_lib\_path = $this->lib\_path . 'php/'; |
  |  | 45 |  |
  |  | 46 | $this->php\_lib\_url = $this->lib\_url . 'php/'; |
  |  | 47 |  |
  |  | 48 | $this->js\_lib\_path = $this->lib\_path . 'js/'; |
  |  | 49 |  |
  |  | 50 | $this->js\_lib\_url = $this->lib\_url . 'js/'; |
  |  | 51 |  |
  |  | 52 | $this->js\_lib\_url\_min = $this->js\_lib\_url . 'min/'; |
  |  | 53 |  |
  |  | 54 | $this->css\_lib\_path = $this->lib\_path . 'css/'; |
  |  | 55 |  |
  |  | 56 | $this->css\_lib\_url = $this->lib\_url . 'css/'; |
  |  | 57 |  |
  |  | 58 | $this->css\_lib\_url\_min = $this->css\_lib\_url . 'min/'; |
  |  | 59 |  |
  |  | 60 | $this->views\_path = $WCFMmp->plugin\_path . 'views/'; |
  |  | 61 |  |
  |  | 62 | // Load wcfmmp Scripts |
  |  | 63 | add\_action('wcfm\_load\_scripts', array(&$this, 'load\_scripts')); |
  |  | 64 | add\_action('after\_wcfm\_load\_scripts', array(&$this, 'load\_scripts')); |
  |  | 65 |  |
  |  | 66 | // Load wcfmmp Styles |
  |  | 67 | add\_action('wcfm\_load\_styles', array(&$this, 'load\_styles')); |
  |  | 68 | add\_action('after\_wcfm\_load\_styles', array(&$this, 'load\_styles')); |
  |  | 69 |  |
  |  | 70 | // Load wcfmmp views |
  |  | 71 | add\_action('wcfm\_load\_views', array(&$this, 'load\_views')); |
  |  | 72 | } |
  |  | 73 |  |
  |  | 74 | public function load\_scripts($end\_point) { |
  |  | 75 | global $WCFM, $WCFMmp; |
  |  | 76 |  |
  |  | 77 | switch ($end\_point) { |
  |  | 78 |  |
  |  | 79 | case 'wcfm-dashboard': |
  |  | 80 |  |
  |  | 81 | break; |
  |  | 82 |  |
  |  | 83 | case 'wcfm-products-manage': |
  |  | 84 | if (!wcfm\_is\_vendor()) { |
  |  | 85 | wp\_enqueue\_script('wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true); |
  |  | 86 | } |
  |  | 87 | break; |
  |  | 88 |  |
  |  | 89 | case 'wcfm-settings': |
  |  | 90 | if (!wcfm\_is\_vendor()) { |
  |  | 91 | wp\_enqueue\_script('wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true); |
  |  | 92 |  |
  |  | 93 | $wcfm\_store\_color\_setting\_options = $WCFMmp->wcfmmp\_settings->wcfmmp\_store\_color\_setting\_options(); |
  |  | 94 | wp\_localize\_script('wcfmmp\_settings\_js', 'wcfm\_store\_color\_setting\_options', $wcfm\_store\_color\_setting\_options); |
  |  | 95 |  |
  |  | 96 | wp\_enqueue\_script('jquery-ui-autocomplete'); |
  | 93 | 97 | $this->load\_map\_lib(); |
  | 94 |  |  |
  |  | 98 |  |
  | 95 | 99 | // Default Map Location |
  | 96 |  | $default\_geolocation = isset(~~$WCFMmp->wcfmmp\_marketplace\_options['default\_geolocation']~~ ) ? $WCFMmp->wcfmmp\_marketplace\_options['default\_geolocation'] : array(); |
  | 97 |  | $default\_lat         = isset(~~$default\_geolocation['lat'] ) ? esc\_attr( $default\_geolocation['lat'] ) : apply\_filters( 'wcfmmp\_map\_default\_lat', 30.0599153~~ ); |
  | 98 |  | $default\_lng         = isset(~~$default\_geolocation['lng'] ) ? esc\_attr( $default\_geolocation['lng'] ) : apply\_filters( 'wcfmmp\_map\_default\_lng', 31.2620199~~ ); |
  | 99 |  | $default\_zoom        =  apply\_filters(~~'wcfmmp\_map\_default\_zoom\_level', 15~~ ); |
  | 100 |  |  |
  | 101 |  | $store\_icon = apply\_filters(~~'wcfmmp\_map\_store\_icon', esc\_url($WCFMmp->plugin\_url . 'assets/images/wcfmmp\_map\_icon.png'), 0, ''~~ ); |
  | 102 |  |  |
  | 103 |  | wp\_localize\_script(~~'wcfmmp\_settings\_js', 'wcfmmp\_setting\_map\_options', array( 'search\_location' => \_\_( 'Insert your address ..', 'wc-multivendor-marketplace' ), 'is\_geolocate' => apply\_filters( 'wcfmmp\_is\_allow\_store\_list\_by\_user\_location', true ), 'default\_lat' => $default\_lat, 'default\_lng' => $default\_lng, 'default\_zoom' => absint( $default\_zoom ), 'store\_icon' => $store\_icon, 'icon\_width' => apply\_filters( 'wcfmmp\_map\_icon\_width', 40 ), 'icon\_height' => apply\_filters( 'wcfmmp\_map\_icon\_height', 57 ), 'is\_rtl' => is\_rtl() )~~ ); |
  | 104 |  |  |
  |  | 100 | $default\_geolocation = isset($WCFMmp->wcfmmp\_marketplace\_options['default\_geolocation']) ? $WCFMmp->wcfmmp\_marketplace\_options['default\_geolocation'] : array(); |
  |  | 101 | $default\_lat         = isset($default\_geolocation['lat']) ? esc\_attr($default\_geolocation['lat']) : apply\_filters('wcfmmp\_map\_default\_lat', 30.0599153); |
  |  | 102 | $default\_lng         = isset($default\_geolocation['lng']) ? esc\_attr($default\_geolocation['lng']) : apply\_filters('wcfmmp\_map\_default\_lng', 31.2620199); |
  |  | 103 | $default\_zoom        =  apply\_filters('wcfmmp\_map\_default\_zoom\_level', 15); |
  |  | 104 |  |
  |  | 105 | $store\_icon = apply\_filters('wcfmmp\_map\_store\_icon', esc\_url($WCFMmp->plugin\_url . 'assets/images/wcfmmp\_map\_icon.png'), 0, ''); |
  |  | 106 |  |
  |  | 107 | wp\_localize\_script('wcfmmp\_settings\_js', 'wcfmmp\_setting\_map\_options', array('search\_location' => \_\_('Insert your address ..', 'wc-multivendor-marketplace'), 'is\_geolocate' => apply\_filters('wcfmmp\_is\_allow\_store\_list\_by\_user\_location', true), 'default\_lat' => $default\_lat, 'default\_lng' => $default\_lng, 'default\_zoom' => absint($default\_zoom), 'store\_icon' => $store\_icon, 'icon\_width' => apply\_filters('wcfmmp\_map\_icon\_width', 40), 'icon\_height' => apply\_filters('wcfmmp\_map\_icon\_height', 57), 'is\_rtl' => is\_rtl())); |
  |  | 108 |  |
  | 105 | 109 | //$wcfm\_marketplace\_options = $WCFMmp->wcfmmp\_marketplace\_options; |
  | 106 | 110 | //$api\_key = isset( $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  | 107 | 111 | //if ( $api\_key ) { |
  | 108 |  | //$scheme  = is\_ssl() ? 'https' : 'http'; |
  | 109 |  | //wp\_enqueue\_script( 'jquery-ui-autocomplete' ); |
  | 110 |  | //wp\_enqueue\_script( 'wcfmmp-setting-google-maps', $scheme . '://maps.googleapis.com/maps/api/js?key=' . $api\_key . '&libraries=places' ); |
  |  | 112 | //$scheme  = is\_ssl() ? 'https' : 'http'; |
  |  | 113 | //wp\_enqueue\_script( 'jquery-ui-autocomplete' ); |
  |  | 114 | //wp\_enqueue\_script( 'wcfmmp-setting-google-maps', $scheme . '://maps.googleapis.com/maps/api/js?key=' . $api\_key . '&libraries=places' ); |
  | 111 | 115 | //} |
  | 112 |  | } |
  | 113 |  | break; |
  | 114 |  |  |
  | 115 |  | case 'wcfm-memberships-manage': |
  | 116 |  | case 'wcfm-vendors-new': |
  | 117 |  | ~~if( !wcfm\_is\_vendor()~~ ) { |
  | 118 |  | $WCFM->library->load\_multiinput\_lib(); |
  | 119 |  | ~~wp\_enqueue\_script( 'wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true~~ ); |
  | 120 |  | } |
  | 121 |  | break; |
  | 122 |  |  |
  | 123 |  | case 'wcfm-vendors-manage': |
  | 124 |  | ~~if( !wcfm\_is\_vendor()~~ ) { |
  | 125 |  | $WCFM->library->load\_multiinput\_lib(); |
  | 126 |  | ~~wp\_enqueue\_script( 'wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true~~ ); |
  | 127 |  |  |
  | 128 |  | $WCFM->library->load\_datatable\_lib(); |
  | 129 |  | $WCFM->library->load\_daterangepicker\_lib(); |
  | 130 |  | $WCFM->library->load\_datatable\_download\_lib(); |
  | 131 |  | ~~wp\_enqueue\_script( 'wcfmmp\_vendors\_manager\_js', $this->js\_lib\_url . 'vendors/wcfmmp-script-vendors-manage.js', array('jquery', 'dataTables\_js'), $WCFMmp->version, true~~ ); |
  | 132 |  |  |
  | 133 |  | // Order Columns Defs |
  |  | 116 | } |
  |  | 117 | break; |
  |  | 118 |  |
  |  | 119 | case 'wcfm-memberships-manage': |
  |  | 120 | case 'wcfm-vendors-new': |
  |  | 121 | if (!wcfm\_is\_vendor()) { |
  |  | 122 | $WCFM->library->load\_multiinput\_lib(); |
  |  | 123 | wp\_enqueue\_script('wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true); |
  |  | 124 | } |
  |  | 125 | break; |
  |  | 126 |  |
  |  | 127 | case 'wcfm-vendors-manage': |
  |  | 128 | if (!wcfm\_is\_vendor()) { |
  |  | 129 | $WCFM->library->load\_multiinput\_lib(); |
  |  | 130 | wp\_enqueue\_script('wcfmmp\_settings\_js', $this->js\_lib\_url . 'wcfmmp-script-settings.js', array('jquery'), $WCFMmp->version, true); |
  |  | 131 |  |
  |  | 132 | $WCFM->library->load\_datatable\_lib(); |
  |  | 133 | $WCFM->library->load\_daterangepicker\_lib(); |
  |  | 134 | $WCFM->library->load\_datatable\_download\_lib(); |
  |  | 135 | wp\_enqueue\_script('wcfmmp\_vendors\_manager\_js', $this->js\_lib\_url . 'vendors/wcfmmp-script-vendors-manage.js', array('jquery', 'dataTables\_js'), $WCFMmp->version, true); |
  |  | 136 |  |
  |  | 137 | // Order Columns Defs |
  | 134 | 138 | $wcfm\_datatable\_column\_defs = '[{ "targets": 0, "orderable" : false }, { "targets": 1, "orderable" : false }, { "targets": 2, "orderable" : false }, { "targets": 3, "orderable" : false }, { "targets": 4, "orderable" : false },{ "targets": 5, "orderable" : false },{ "targets": 6, "orderable" : false },{ "targets": 7, "orderable" : false },{ "targets": 8, "orderable" : false },{ "targets": 9, "orderable" : false },{ "targets": 10, "orderable" : false },{ "targets": 11, "orderable" : false },{ "targets": 12, "orderable" : false }]'; |
  | 135 |  |  |
  | 136 |  | $wcfm\_datatable\_column\_defs = apply\_filters(~~'wcfm\_datatable\_column\_defs', $wcfm\_datatable\_column\_defs, 'order'~~ ); |
  | 137 |  |  |
  |  | 139 |  |
  |  | 140 | $wcfm\_datatable\_column\_defs = apply\_filters('wcfm\_datatable\_column\_defs', $wcfm\_datatable\_column\_defs, 'order'); |
  |  | 141 |  |
  | 138 | 142 | // Order Columns Priority |
  | 139 | 143 | $wcfm\_datatable\_column\_priority = '[{ "responsivePriority": 2 },{ "responsivePriority": 1 },{ "responsivePriority": 4 },{ "responsivePriority": 10 },{ "responsivePriority": 6 },{ "responsivePriority": 5 },{ "responsivePriority": 7 },{ "responsivePriority": 11 },{ "responsivePriority": 3 },{ "responsivePriority": 12 },{ "responsivePriority": 8 },{ "responsivePriority": 9 },{ "responsivePriority": 1 }]'; |
  | 140 |  | $wcfm\_datatable\_column\_priority = apply\_filters(~~'wcfm\_datatable\_column\_priority', $wcfm\_datatable\_column\_priority, 'order'~~ ); |
  | 141 |  |  |
  | 142 |  | wp\_localize\_script(~~'dataTables\_js', 'wcfm\_datatable\_columns', array( 'defs' => $wcfm\_datatable\_column\_defs, 'priority' => $wcfm\_datatable\_column\_priority )~~ ); |
  | 143 |  |  |
  |  | 144 | $wcfm\_datatable\_column\_priority = apply\_filters('wcfm\_datatable\_column\_priority', $wcfm\_datatable\_column\_priority, 'order'); |
  |  | 145 |  |
  |  | 146 | wp\_localize\_script('dataTables\_js', 'wcfm\_datatable\_columns', array('defs' => $wcfm\_datatable\_column\_defs, 'priority' => $wcfm\_datatable\_column\_priority)); |
  |  | 147 |  |
  | 144 | 148 | // Screen manager |
  | 145 |  | $wcfm\_screen\_manager = get\_option(~~'wcfm\_screen\_manager', array()~~ ); |
  |  | 149 | $wcfm\_screen\_manager = get\_option('wcfm\_screen\_manager', array()); |
  | 146 | 150 | $wcfm\_screen\_manager\_data = array(); |
  | 147 |  | if~~( isset( $wcfm\_screen\_manager['order'] )~~ ) $wcfm\_screen\_manager\_data = $wcfm\_screen\_manager['order']; |
  | 148 |  | if~~( !isset( $wcfm\_screen\_manager\_data['admin'] )~~ ) { |
  |  | 151 | if (isset($wcfm\_screen\_manager['order'])) $wcfm\_screen\_manager\_data = $wcfm\_screen\_manager['order']; |
  |  | 152 | if (!isset($wcfm\_screen\_manager\_data['admin'])) { |
  | 149 | 153 | $wcfm\_screen\_manager\_data['admin'] = $wcfm\_screen\_manager\_data; |
  | 150 | 154 | $wcfm\_screen\_manager\_data['vendor'] = $wcfm\_screen\_manager\_data; |
  | 151 | 155 | } |
  | 152 |  |  |
  |  | 156 |  |
  | 153 | 157 | $wcfm\_screen\_manager\_data = $wcfm\_screen\_manager\_data['admin']; |
  | 154 |  | if~~( !$WCFM->is\_marketplace || !apply\_filters( 'wcfm\_is\_allow\_view\_commission', true )~~ ) { |
  |  | 158 | if (!$WCFM->is\_marketplace || !apply\_filters('wcfm\_is\_allow\_view\_commission', true)) { |
  | 155 | 159 | $wcfm\_screen\_manager\_data[8] = 'yes'; |
  | 156 | 160 | } |
  | 157 |  | if~~( apply\_filters( 'wcfm\_orders\_additonal\_data\_hidden', true )~~ ) { |
  |  | 161 | if (apply\_filters('wcfm\_orders\_additonal\_data\_hidden', true)) { |
  | 158 | 162 | $wcfm\_screen\_manager\_data[10] = 'yes'; |
  | 159 | 163 | } |
  | 160 |  | if~~( WCFM\_Dependencies::wcfmd\_plugin\_active\_check()~~ ) { |
  |  | 164 | if (WCFM\_Dependencies::wcfmd\_plugin\_active\_check()) { |
  | 161 | 165 | //$wcfm\_screen\_manager\_data[13] = 'yes'; |
  | 162 | 166 | } else { |
  | 163 | 167 | //$wcfm\_screen\_manager\_data[12] = 'yes'; |
  | 164 | 168 | } |
  | 165 |  | $wcfm\_screen\_manager\_data    = apply\_filters(~~'wcfm\_screen\_manager\_data\_columns', $wcfm\_screen\_manager\_data, 'vendor-orders'~~ ); |
  | 166 |  | wp\_localize\_script(~~'wcfmmp\_vendors\_manager\_js', 'wcfm\_orders\_screen\_manage', $wcfm\_screen\_manager\_data~~ ); |
  | 167 |  |  |
  |  | 169 | $wcfm\_screen\_manager\_data    = apply\_filters('wcfm\_screen\_manager\_data\_columns', $wcfm\_screen\_manager\_data, 'vendor-orders'); |
  |  | 170 | wp\_localize\_script('wcfmmp\_vendors\_manager\_js', 'wcfm\_orders\_screen\_manage', $wcfm\_screen\_manager\_data); |
  |  | 171 |  |
  | 168 | 172 | $wcfm\_screen\_manager\_hidden\_data = array(); |
  | 169 | 173 | $wcfm\_screen\_manager\_hidden\_data[3] = 'yes'; |
  | 170 | 174 | $wcfm\_screen\_manager\_hidden\_data[7] = 'yes'; |
  | 171 | 175 | $wcfm\_screen\_manager\_hidden\_data[9] = 'yes'; |
  | 172 |  | $wcfm\_screen\_manager\_hidden\_data    = apply\_filters( 'wcfm\_screen\_manager\_hidden\_columns', $wcfm\_screen\_manager\_hidden\_data ); |
  | 173 |  | wp\_localize\_script( 'wcfmmp\_vendors\_manager\_js', 'wcfm\_orders\_screen\_manage\_hidden', $wcfm\_screen\_manager\_hidden\_data ); |
  | 174 |  |  |
  | 175 |  | wp\_localize\_script( 'wcfmmp\_vendors\_manager\_js', 'wcfm\_orders\_auto\_refresher', array( 'is\_allow' => apply\_filters( 'wcfm\_orders\_is\_allow\_auto\_refresher', false ) ) ); |
  | 176 |  | } |
  | 177 |  | break; |
  | 178 |  |  |
  | 179 |  | } |
  | 180 |  | } |
  | 181 |  |  |
  | 182 |  | public function load\_styles( $end\_point ) { |
  | 183 |  | global $WCFM, $WCFMmp; |
  | 184 |  |  |
  | 185 |  | switch( $end\_point ) { |
  | 186 |  |  |
  | 187 |  | case 'wcfm-memberships-manage': |
  | 188 |  | // wp\_enqueue\_style( 'wcfm\_settings\_css',  $WCFM->library->css\_lib\_url . 'settings/wcfm-style-settings.css', array(), $WCFM->version ); |
  | 189 |  | break; |
  | 190 |  |  |
  | 191 |  | case 'wcfm-vendors-manage': |
  | 192 |  | wp\_enqueue\_style( 'wcfm\_orders\_css',  $WCFM->library->css\_lib\_url . 'orders/wcfm-style-orders.css', array(), $WCFM->version ); |
  | 193 |  | break; |
  | 194 |  | } |
  | 195 |  | } |
  | 196 |  |  |
  | 197 |  | public function load\_views( $end\_point ) { |
  | 198 |  | global $WCFM, $WCFMmp; |
  | 199 |  |  |
  | 200 |  | switch( $end\_point ) { |
  | 201 |  |  |
  | 202 |  | case 'wcfm-analytics': |
  | 203 |  | //$WCFMmp->template->get\_template( 'wcfmmp-view-analytics.php' ); |
  | 204 |  | break; |
  | 205 |  | } |
  | 206 |  | } |
  | 207 |  |  |
  | 208 |  | /\*\* |
  |  | 176 | $wcfm\_screen\_manager\_hidden\_data    = apply\_filters('wcfm\_screen\_manager\_hidden\_columns', $wcfm\_screen\_manager\_hidden\_data); |
  |  | 177 | wp\_localize\_script('wcfmmp\_vendors\_manager\_js', 'wcfm\_orders\_screen\_manage\_hidden', $wcfm\_screen\_manager\_hidden\_data); |
  |  | 178 |  |
  |  | 179 | wp\_localize\_script('wcfmmp\_vendors\_manager\_js', 'wcfm\_orders\_auto\_refresher', array('is\_allow' => apply\_filters('wcfm\_orders\_is\_allow\_auto\_refresher', false))); |
  |  | 180 | } |
  |  | 181 | break; |
  |  | 182 | } |
  |  | 183 | } |
  |  | 184 |  |
  |  | 185 | public function load\_styles($end\_point) { |
  |  | 186 | global $WCFM, $WCFMmp; |
  |  | 187 |  |
  |  | 188 | switch ($end\_point) { |
  |  | 189 |  |
  |  | 190 | case 'wcfm-memberships-manage': |
  |  | 191 | // wp\_enqueue\_style( 'wcfm\_settings\_css',  $WCFM->library->css\_lib\_url . 'settings/wcfm-style-settings.css', array(), $WCFM->version ); |
  |  | 192 | break; |
  |  | 193 |  |
  |  | 194 | case 'wcfm-vendors-manage': |
  |  | 195 | wp\_enqueue\_style('wcfm\_orders\_css',  $WCFM->library->css\_lib\_url . 'orders/wcfm-style-orders.css', array(), $WCFM->version); |
  |  | 196 | break; |
  |  | 197 | } |
  |  | 198 | } |
  |  | 199 |  |
  |  | 200 | public function load\_views($end\_point) { |
  |  | 201 | global $WCFM, $WCFMmp; |
  |  | 202 |  |
  |  | 203 | switch ($end\_point) { |
  |  | 204 |  |
  |  | 205 | case 'wcfm-analytics': |
  |  | 206 | //$WCFMmp->template->get\_template( 'wcfmmp-view-analytics.php' ); |
  |  | 207 | break; |
  |  | 208 | } |
  |  | 209 | } |
  |  | 210 |  |
  |  | 211 | /\*\* |
  | 209 | 212 | \* WCFM Map library |
  | 210 |  | \*/ |
  |  | 213 | \*/ |
  | 211 | 214 | public function load\_map\_lib() { |
  | 212 |  | global $WCFM, $WCFMmp; |
  | 213 |  |  |
  | 214 |  | $api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  | 215 |  | $wcfm\_map\_lib = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
  | 216 |  | if( !$wcfm\_map\_lib && $api\_key ) { $wcfm\_map\_lib = 'google'; } elseif( !$wcfm\_map\_lib && !$api\_key ) { $wcfm\_map\_lib = 'leaftlet'; } |
  | 217 |  | if( ($wcfm\_map\_lib == 'google') && !empty( $api\_key ) ) { |
  |  | 215 | global $WCFM, $WCFMmp; |
  |  | 216 |  |
  |  | 217 | $api\_key = isset($WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api']) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  |  | 218 | $wcfm\_map\_lib = isset($WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib']) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
  |  | 219 | if (!$wcfm\_map\_lib && $api\_key) { |
  |  | 220 | $wcfm\_map\_lib = 'google'; |
  |  | 221 | } elseif (!$wcfm\_map\_lib && !$api\_key) { |
  |  | 222 | $wcfm\_map\_lib = 'leaftlet'; |
  |  | 223 | } |
  |  | 224 | if (($wcfm\_map\_lib == 'google') && !empty($api\_key)) { |
  | 218 | 225 | $this->load\_google\_map\_lib(); |
  | 219 | 226 | } else { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php?rev=2628122#L222) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-library.php?rev=3000763#L229) |  |
  | 222 | 229 | } |
  | 223 | 230 | } |
  | 224 |  |  |
  | 225 |  | /\*\* |
  |  | 231 |  |
  |  | 232 | /\*\* |
  | 226 | 233 | \* Google Map library |
  | 227 |  | \*/ |
  |  | 234 | \*/ |
  | 228 | 235 | public function load\_google\_map\_lib() { |
  | 229 |  | global $WCFM, $WCFMmp; |
  | 230 |  | ~~$api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api']~~ ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  | 231 |  | ~~if( $api\_key~~ ) { |
  | 232 |  | $scheme  = is\_ssl() ? 'https' : 'http'; |
  | 233 |  | ~~wp\_enqueue\_script( 'wcfm-store-google-maps', apply\_filters( 'wcfm\_google\_map\_api\_url', $scheme . '://maps.googleapis.com/maps/api/js?key=' . $api\_key . '&libraries=places', $api\_key )~~ ); |
  | 234 |  | ~~wp\_localize\_script( 'wcfm-store-google-maps', 'wcfm\_maps', array( 'lib' => 'google', 'map\_type' => apply\_filters( 'wcfm\_google\_map\_type', 'roadmap' ) )~~ ); |
  | 235 |  |  |
  | 236 |  | ~~if( apply\_filters( 'wcfmmp\_is\_allow\_map\_pointer\_cluster', true )~~ ) { |
  | 237 |  | ~~wp\_enqueue\_script( 'wcfm-store-google-maps-cluster', 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js', array('jquery' ), $WCFMmp->version, true~~ ); |
  | 238 |  | } |
  | 239 |  | } |
  | 240 |  | } |
  | 241 |  |  |
  | 242 |  |  |
  | 243 |  | /\*\* |
  |  | 236 | global $WCFM, $WCFMmp; |
  |  | 237 | $api\_key = isset($WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api']) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  |  | 238 | if ($api\_key) { |
  |  | 239 | $scheme  = is\_ssl() ? 'https' : 'http'; |
  |  | 240 | wp\_enqueue\_script('wcfm-store-google-maps', apply\_filters('wcfm\_google\_map\_api\_url', $scheme . '://maps.googleapis.com/maps/api/js?key=' . $api\_key . '&libraries=places', $api\_key)); |
  |  | 241 | wp\_localize\_script('wcfm-store-google-maps', 'wcfm\_maps', array('lib' => 'google', 'map\_type' => apply\_filters('wcfm\_google\_map\_type', 'roadmap'))); |
  |  | 242 |  |
  |  | 243 | if (apply\_filters('wcfmmp\_is\_allow\_map\_pointer\_cluster', true)) { |
  |  | 244 | wp\_enqueue\_script('wcfm-store-google-maps-cluster', 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js', array('jquery'), $WCFMmp->version, true); |
  |  | 245 | } |
  |  | 246 | } |
  |  | 247 | } |
  |  | 248 |  |
  |  | 249 |  |
  |  | 250 | /\*\* |
  | 244 | 251 | \* Leaflet Map library |
  | 245 |  | \*/ |
  |  | 252 | \*/ |
  | 246 | 253 | public function load\_leaflet\_map\_lib() { |
  | 247 |  | global $WCFM, $WCFMmp; |
  | 248 |  | ~~wp\_enqueue\_script( 'wcfm-leaflet-map-js', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet.js', array('jquery'), $WCFM->version, true~~ ); |
  | 249 |  | ~~wp\_enqueue\_style( 'wcfm-leaflet-map-style', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet.css', array(), $WCFM->version~~ ); |
  | 250 |  | ~~wp\_localize\_script( 'wcfm-leaflet-map-js', 'wcfm\_maps', array( 'lib' => 'leaflet', 'map\_type' => apply\_filters( 'wcfm\_google\_map\_type', 'roadmap' ) )~~ ); |
  | 251 |  | } |
  | 252 |  |  |
  |  | 254 | global $WCFM, $WCFMmp; |
  |  | 255 | wp\_enqueue\_script('wcfm-leaflet-map-js', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet.js', array('jquery'), $WCFM->version, true); |
  |  | 256 | wp\_enqueue\_style('wcfm-leaflet-map-style', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet.css', array(), $WCFM->version); |
  |  | 257 | wp\_localize\_script('wcfm-leaflet-map-js', 'wcfm\_maps', array('lib' => 'leaflet', 'map\_type' => apply\_filters('wcfm\_google\_map\_type', 'roadmap'))); |
  |  | 258 | } |
  |  | 259 |  |
  | 253 | 260 | /\*\* |
  | 254 | 261 | \* Leaflet Search library |
  | 255 |  | \*/ |
  |  | 262 | \*/ |
  | 256 | 263 | public function load\_leaflet\_search\_lib() { |
  | 257 |  | global $WCFM; |
  | 258 |  | ~~wp\_enqueue\_script( 'wcfm-leaflet-search-js', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet-search.js', array('jquery'), $WCFM->version, true~~ ); |
  | 259 |  | ~~wp\_enqueue\_style( 'wcfm-leaflet-search-style', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet-search.css', array(), $WCFM->version~~ ); |
  |  | 264 | global $WCFM; |
  |  | 265 | wp\_enqueue\_script('wcfm-leaflet-search-js', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet-search.js', array('jquery'), $WCFM->version, true); |
  |  | 266 | wp\_enqueue\_style('wcfm-leaflet-search-style', $WCFM->plugin\_url . 'includes/libs/leaflet/leaflet-search.css', array(), $WCFM->version); |
  | 260 | 267 | } |
  | 261 | 268 | } |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php")

  | [r2894888](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=2894888#L324 "Show revision 2894888 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763#L324 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 324 | 324 | $order\_id = $order->get\_id(); |
  | 325 | 325 |  |
  | 326 |  | $wcfm\_refund\_request = ~~get\_post\_meta($order\_id, '\_wcfm\_refund\_request', true~~); |
  |  | 326 | $wcfm\_refund\_request = $order->get\_meta('\_wcfm\_refund\_request'); |
  | 327 | 327 | if ($wcfm\_refund\_request) return $actions; |
  | 328 | 328 |  |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=2894888#L427) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763#L427) |  |
  | 427 | 427 |  |
  | 428 | 428 | // Set Order Meta |
  | 429 |  | update\_post\_meta($order\_id, '\_wcfm\_refund\_request', 'yes'); |
  |  | 429 | $order = wc\_get\_order( $order\_id ); |
  |  | 430 | $order->update\_meta\_data( '\_wcfm\_refund\_request', 'yes' ); |
  |  | 431 | $order->save(); |
  | 430 | 432 |  |
  | 431 | 433 | do\_action('wcfmmp\_refund\_request\_processed', $refund\_request\_id, $vendor\_id, $order\_id, $commission\_id, $refunded\_amount, $refund\_type); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=2894888#L769) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763#L771) |  |
  | 769 | 771 |  |
  | 770 | 772 | // Order Not Added |
  | 771 |  | $wcfm\_refund\_request\_notified = ~~get\_post\_meta($order\_id, '\_wcfm\_refund\_request\_notified', true~~); |
  |  | 773 | $wcfm\_refund\_request\_notified = $order->get\_meta('\_wcfm\_refund\_request\_notified'); |
  | 772 | 774 | if ($is\_partially\_refunded) { |
  | 773 | 775 | $wcfm\_messages = sprintf(\_\_('Partial Refund Request approved for Order <b>%s</b>.', 'wc-multivendor-marketplace'), '#' . $order->get\_order\_number()); |
  | 774 | 776 | } else { |
  | 775 | 777 | $wcfm\_messages = sprintf(\_\_('Refund Request approved for Order <b>%s</b>.', 'wc-multivendor-marketplace'), '#' . $order->get\_order\_number()); |
  | 776 |  | update\_post\_meta($order\_id, '\_wcfm\_refund\_request\_notified', 1); |
  |  | 778 | $order->update\_meta\_data('\_wcfm\_refund\_request\_notified', 1); |
  |  | 779 | $order->save(); |
  | 777 | 780 | } |
  | 778 | 781 | if ($refund\_note) { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=2894888#L788) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763#L791) |  |
  | 788 | 791 |  |
  | 789 | 792 | // Update Order Meta |
  | 790 |  | delete\_post\_meta($order\_id, '\_wcfm\_refund\_request'); |
  |  | 793 | $order->delete\_meta\_data('\_wcfm\_refund\_request'); |
  |  | 794 | $order->save(); |
  | 791 | 795 |  |
  | 792 | 796 | do\_action('wcfmmp\_refund\_status\_completed', $refund\_id, $order\_id, $vendor\_id, $refund); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=2894888#L855) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763#L859) |  |
  | 855 | 859 |  |
  | 856 | 860 | // Update Order Meta |
  | 857 |  | delete\_post\_meta($order\_id, '\_wcfm\_refund\_request'); |
  |  | 861 | $order->delete\_meta\_data('\_wcfm\_refund\_request'); |
  |  | 862 | $order->save(); |
  | 858 | 863 |  |
  | 859 | 864 | do\_action('wcfmmp\_refund\_status\_' . $status, $refund\_id, $order\_id); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=2894888#L910) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-refund.php?rev=3000763#L915) |  |
  | 910 | 915 |  |
  | 911 | 916 | // Update Order Meta |
  | 912 |  | delete\_post\_meta($order\_id, '\_wcfm\_refund\_request'); |
  |  | 917 | $order = wc\_get\_order( $order\_id ); |
  |  | 918 | $order->delete\_meta\_data('\_wcfm\_refund\_request'); |
  |  | 919 | $order->save(); |
  | 913 | 920 |  |
  | 914 | 921 | do\_action('wcfmmp\_refund\_status\_' . $status, $refund\_id, $order\_id); |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php")

  | [r2628276](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1 "Show revision 2628276 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  | 2 | 3 | /\*\* |
  | 3 | 4 | \* WCFMmp plugin core |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L9) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L10) |  |
  | 9 | 10 | \* @version   1.0.0 |
  | 10 | 11 | \*/ |
  | 11 |  |  |
  |  | 12 |  |
  | 12 | 13 | class WCFMmp\_Settings { |
  | 13 | 14 |  |
  | 14 | 15 | public function \_\_construct() { |
  | 15 | 16 | global $WCFM; |
  | 16 |  |  |
  |  | 17 |  |
  | 17 | 18 | // Marketplace Setting |
  | 18 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_marketplace\_settings' ), 14~~ ); |
  | 19 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_marketplace\_settings\_update' ), 14~~ ); |
  | 20 |  |  |
  |  | 19 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_marketplace\_settings'), 14); |
  |  | 20 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_marketplace\_settings\_update'), 14); |
  |  | 21 |  |
  | 21 | 22 | // Geo Locate Setting |
  | 22 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_geolocate\_settings' ), 14~~ ); |
  | 23 |  |  |
  |  | 23 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_geolocate\_settings'), 14); |
  |  | 24 |  |
  | 24 | 25 | // Order Setting |
  | 25 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_marketplace\_order\_settings' ), 14~~ ); |
  | 26 |  |  |
  |  | 26 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_marketplace\_order\_settings'), 14); |
  |  | 27 |  |
  | 27 | 28 | // Commission Setting |
  | 28 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_commission\_settings' ), 14~~ ); |
  | 29 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_commission\_settings\_update' ), 14~~ ); |
  | 30 |  |  |
  |  | 29 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_commission\_settings'), 14); |
  |  | 30 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_commission\_settings\_update'), 14); |
  |  | 31 |  |
  | 31 | 32 | // Withdrawal Setting |
  | 32 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_withdrawal\_settings' ), 14~~ ); |
  | 33 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_withdrawal\_settings\_update' ), 14~~ ); |
  | 34 |  |  |
  |  | 33 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_withdrawal\_settings'), 14); |
  |  | 34 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_withdrawal\_settings\_update'), 14); |
  |  | 35 |  |
  | 35 | 36 | // Payment Setting |
  | 36 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_payment\_settings' ), 14~~ ); |
  | 37 |  |  |
  |  | 37 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_payment\_settings'), 14); |
  |  | 38 |  |
  | 38 | 39 | // Shipping Setting |
  | 39 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_shipping\_settings' ), 14~~ ); |
  | 40 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_shipping\_settings\_update' ), 14~~ ); |
  | 41 |  |  |
  |  | 40 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_shipping\_settings'), 14); |
  |  | 41 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_shipping\_settings\_update'), 14); |
  |  | 42 |  |
  | 42 | 43 | // Refund Setting |
  | 43 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_refund\_settings' ), 14~~ ); |
  | 44 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_refund\_settings\_update' ), 14~~ ); |
  | 45 |  |  |
  |  | 44 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_refund\_settings'), 14); |
  |  | 45 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_refund\_settings\_update'), 14); |
  |  | 46 |  |
  | 46 | 47 | // Review Setting |
  | 47 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_review\_settings' ), 14~~ ); |
  | 48 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_review\_settings\_update' ), 14~~ ); |
  | 49 |  |  |
  |  | 48 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_review\_settings'), 14); |
  |  | 49 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_review\_settings\_update'), 14); |
  |  | 50 |  |
  | 50 | 51 | // Vendor Registration Setting |
  | 51 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_vendor\_registration\_settings' ), 14~~ ); |
  | 52 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_vendor\_registration\_settings\_update' ), 14~~ ); |
  | 53 |  |  |
  |  | 52 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_vendor\_registration\_settings'), 14); |
  |  | 53 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_vendor\_registration\_settings\_update'), 14); |
  |  | 54 |  |
  | 54 | 55 | // Store Style Setting |
  | 55 |  | add\_action(~~'begin\_wcfm\_settings\_form\_style', array( &$this, 'wcfm\_store\_style\_settings' ), 14~~ ); |
  | 56 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_store\_style\_settings\_update' ), 14~~ ); |
  | 57 |  |  |
  |  | 56 | add\_action('begin\_wcfm\_settings\_form\_style', array(&$this, 'wcfm\_store\_style\_settings'), 14); |
  |  | 57 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_store\_style\_settings\_update'), 14); |
  |  | 58 |  |
  | 58 | 59 | // Old Data Cleanup Setting |
  | 59 |  | add\_action(~~'end\_wcfm\_settings', array( &$this, 'wcfm\_data\_cleanup\_settings' ), 200~~ ); |
  | 60 |  | add\_action(~~'wcfm\_settings\_update', array( &$this, 'wcfm\_data\_cleanup\_settings\_update' ), 200~~ ); |
  | 61 |  | } |
  | 62 |  |  |
  | 63 |  | function wcfm\_marketplace\_settings(~~$wcfm\_options~~ ) { |
  |  | 60 | add\_action('end\_wcfm\_settings', array(&$this, 'wcfm\_data\_cleanup\_settings'), 200); |
  |  | 61 | add\_action('wcfm\_settings\_update', array(&$this, 'wcfm\_data\_cleanup\_settings\_update'), 200); |
  |  | 62 | } |
  |  | 63 |  |
  |  | 64 | function wcfm\_marketplace\_settings($wcfm\_options) { |
  | 64 | 65 | global $WCFM, $WCFMmp; |
  | 65 |  |  |
  | 66 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_marketplace\_manage', true ) ) return;~~ |
  | 67 |  |  |
  | 68 |  | $wcfm\_marketplace\_options = wcfm\_get\_option(~~'wcfm\_marketplace\_options', array()~~ ); |
  | 69 |  |  |
  | 70 |  | $wcfm\_store\_url           = isset(~~$wcfm\_marketplace\_options['wcfm\_store\_url']~~ ) ? $wcfm\_marketplace\_options['wcfm\_store\_url'] : 'store'; |
  | 71 |  | $vendor\_sold\_by           = isset(~~$wcfm\_marketplace\_options['vendor\_sold\_by']~~ ) ? $wcfm\_marketplace\_options['vendor\_sold\_by'] : 'yes'; |
  | 72 |  | $sold\_by\_label            = isset(~~$wcfm\_marketplace\_options['sold\_by\_label']~~ ) ? $wcfm\_marketplace\_options['sold\_by\_label'] : \_\_('Store', 'wc-multivendor-marketplace'); |
  | 73 |  | $vendor\_sold\_by\_template  = isset(~~$wcfm\_marketplace\_options['vendor\_sold\_by\_template']~~ ) ? $wcfm\_marketplace\_options['vendor\_sold\_by\_template'] : 'advanced'; |
  | 74 |  | $vendor\_sold\_by\_position  = isset(~~$wcfm\_marketplace\_options['vendor\_sold\_by\_position']~~ ) ? $wcfm\_marketplace\_options['vendor\_sold\_by\_position'] : 'bellow\_atc'; |
  | 75 |  | $store\_name\_position      = isset(~~$wcfm\_marketplace\_options['store\_name\_position']~~ ) ? $wcfm\_marketplace\_options['store\_name\_position'] : 'on\_banner'; |
  | 76 |  | $store\_list\_sidebar       = isset(~~$wcfm\_marketplace\_options['store\_list\_sidebar']~~ ) ? $wcfm\_marketplace\_options['store\_list\_sidebar'] : 'no'; |
  | 77 |  | $store\_sidebar            = isset(~~$wcfm\_marketplace\_options['store\_sidebar']~~ ) ? $wcfm\_marketplace\_options['store\_sidebar'] : 'yes'; |
  | 78 |  | $store\_sidebar\_pos        = isset(~~$wcfm\_marketplace\_options['store\_sidebar\_pos']~~ ) ? $wcfm\_marketplace\_options['store\_sidebar\_pos'] : 'left'; |
  | 79 |  | $store\_related\_products   =  isset(~~$wcfm\_marketplace\_options['store\_related\_products']~~ ) ? $wcfm\_marketplace\_options['store\_related\_products'] : 'default'; |
  | 80 |  | $store\_ppp                =  isset(~~$wcfm\_marketplace\_options['store\_ppp']~~ ) ? $wcfm\_marketplace\_options['store\_ppp'] : get\_option('posts\_per\_page'); |
  | 81 |  |  |
  |  | 66 |  |
  |  | 67 | if (!apply\_filters('wcfm\_is\_allow\_marketplace\_manage', true)) return; |
  |  | 68 |  |
  |  | 69 | $wcfm\_marketplace\_options = wcfm\_get\_option('wcfm\_marketplace\_options', array()); |
  |  | 70 |  |
  |  | 71 | $wcfm\_store\_url           = isset($wcfm\_marketplace\_options['wcfm\_store\_url']) ? $wcfm\_marketplace\_options['wcfm\_store\_url'] : 'store'; |
  |  | 72 | $vendor\_sold\_by           = isset($wcfm\_marketplace\_options['vendor\_sold\_by']) ? $wcfm\_marketplace\_options['vendor\_sold\_by'] : 'yes'; |
  |  | 73 | $sold\_by\_label            = isset($wcfm\_marketplace\_options['sold\_by\_label']) ? $wcfm\_marketplace\_options['sold\_by\_label'] : \_\_('Store', 'wc-multivendor-marketplace'); |
  |  | 74 | $vendor\_sold\_by\_template  = isset($wcfm\_marketplace\_options['vendor\_sold\_by\_template']) ? $wcfm\_marketplace\_options['vendor\_sold\_by\_template'] : 'advanced'; |
  |  | 75 | $vendor\_sold\_by\_position  = isset($wcfm\_marketplace\_options['vendor\_sold\_by\_position']) ? $wcfm\_marketplace\_options['vendor\_sold\_by\_position'] : 'bellow\_atc'; |
  |  | 76 | $store\_name\_position      = isset($wcfm\_marketplace\_options['store\_name\_position']) ? $wcfm\_marketplace\_options['store\_name\_position'] : 'on\_banner'; |
  |  | 77 | $store\_list\_sidebar       = isset($wcfm\_marketplace\_options['store\_list\_sidebar']) ? $wcfm\_marketplace\_options['store\_list\_sidebar'] : 'no'; |
  |  | 78 | $store\_sidebar            = isset($wcfm\_marketplace\_options['store\_sidebar']) ? $wcfm\_marketplace\_options['store\_sidebar'] : 'yes'; |
  |  | 79 | $store\_sidebar\_pos        = isset($wcfm\_marketplace\_options['store\_sidebar\_pos']) ? $wcfm\_marketplace\_options['store\_sidebar\_pos'] : 'left'; |
  |  | 80 | $store\_related\_products   =  isset($wcfm\_marketplace\_options['store\_related\_products']) ? $wcfm\_marketplace\_options['store\_related\_products'] : 'default'; |
  |  | 81 | $store\_ppp                =  isset($wcfm\_marketplace\_options['store\_ppp']) ? $wcfm\_marketplace\_options['store\_ppp'] : get\_option('posts\_per\_page'); |
  |  | 82 |  |
  | 82 | 83 | //$product\_mulivendor       = isset( $wcfm\_marketplace\_options['product\_mulivendor'] ) ? $wcfm\_marketplace\_options['product\_mulivendor'] : 'yes'; |
  | 83 |  |  |
  | 84 |  | $store\_default\_logo   = !empty(~~$wcfm\_marketplace\_options['store\_default\_logo']~~ ) ? $wcfm\_marketplace\_options['store\_default\_logo'] : $WCFM->plugin\_url . 'assets/images/wcfmmp-blue.png'; |
  | 85 |  | $store\_default\_banner = !empty(~~$wcfm\_marketplace\_options['store\_default\_banner']~~ ) ? $wcfm\_marketplace\_options['store\_default\_banner'] : $WCFMmp->plugin\_url . 'assets/images/default\_banner.jpg'; |
  | 86 |  | $store\_list\_default\_banner = !empty(~~$wcfm\_marketplace\_options['store\_list\_default\_banner']~~ ) ? $wcfm\_marketplace\_options['store\_list\_default\_banner'] : $WCFMmp->plugin\_url . 'assets/images/default\_banner.jpg'; |
  | 87 |  | $store\_banner\_width   = isset(~~$wcfm\_marketplace\_options['store\_banner\_width']~~ ) ? $wcfm\_marketplace\_options['store\_banner\_width'] : '1650'; |
  | 88 |  | $store\_banner\_height  = isset(~~$wcfm\_marketplace\_options['store\_banner\_height']~~ ) ? $wcfm\_marketplace\_options['store\_banner\_height'] : '350'; |
  | 89 |  | $store\_banner\_mwidth  = isset(~~$wcfm\_marketplace\_options['store\_banner\_mwidth']~~ ) ? $wcfm\_marketplace\_options['store\_banner\_mwidth'] : '520'; |
  | 90 |  | $store\_banner\_mheight = isset(~~$wcfm\_marketplace\_options['store\_banner\_mheight']~~ ) ? $wcfm\_marketplace\_options['store\_banner\_mheight'] : '250'; |
  | 91 |  |  |
  | 92 |  | $disable\_wcfm\_store\_setup = isset(~~$wcfm\_marketplace\_options['disable\_wcfm\_store\_setup']~~ ) ? $wcfm\_marketplace\_options['disable\_wcfm\_store\_setup'] : 'no'; |
  | 93 |  |  |
  | 94 |  | $delete\_data\_on\_uninstall = isset(~~$wcfm\_marketplace\_options['delete\_data\_on\_uninstall']~~ ) ? $wcfm\_marketplace\_options['delete\_data\_on\_uninstall'] : 'no'; |
  | 95 |  |  |
  |  | 84 |  |
  |  | 85 | $store\_default\_logo   = !empty($wcfm\_marketplace\_options['store\_default\_logo']) ? $wcfm\_marketplace\_options['store\_default\_logo'] : $WCFM->plugin\_url . 'assets/images/wcfmmp-blue.png'; |
  |  | 86 | $store\_default\_banner = !empty($wcfm\_marketplace\_options['store\_default\_banner']) ? $wcfm\_marketplace\_options['store\_default\_banner'] : $WCFMmp->plugin\_url . 'assets/images/default\_banner.jpg'; |
  |  | 87 | $store\_list\_default\_banner = !empty($wcfm\_marketplace\_options['store\_list\_default\_banner']) ? $wcfm\_marketplace\_options['store\_list\_default\_banner'] : $WCFMmp->plugin\_url . 'assets/images/default\_banner.jpg'; |
  |  | 88 | $store\_banner\_width   = isset($wcfm\_marketplace\_options['store\_banner\_width']) ? $wcfm\_marketplace\_options['store\_banner\_width'] : '1650'; |
  |  | 89 | $store\_banner\_height  = isset($wcfm\_marketplace\_options['store\_banner\_height']) ? $wcfm\_marketplace\_options['store\_banner\_height'] : '350'; |
  |  | 90 | $store\_banner\_mwidth  = isset($wcfm\_marketplace\_options['store\_banner\_mwidth']) ? $wcfm\_marketplace\_options['store\_banner\_mwidth'] : '520'; |
  |  | 91 | $store\_banner\_mheight = isset($wcfm\_marketplace\_options['store\_banner\_mheight']) ? $wcfm\_marketplace\_options['store\_banner\_mheight'] : '250'; |
  |  | 92 |  |
  |  | 93 | $disable\_wcfm\_store\_setup = isset($wcfm\_marketplace\_options['disable\_wcfm\_store\_setup']) ? $wcfm\_marketplace\_options['disable\_wcfm\_store\_setup'] : 'no'; |
  |  | 94 |  |
  |  | 95 | $delete\_data\_on\_uninstall = isset($wcfm\_marketplace\_options['delete\_data\_on\_uninstall']) ? $wcfm\_marketplace\_options['delete\_data\_on\_uninstall'] : 'no'; |
  |  | 96 |  |
  | 96 | 97 | ?> |
  | 97 | 98 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L102) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L103) |  |
  | 102 | 103 | <div class="wcfm-container"> |
  | 103 | 104 | <div id="wcfm\_settings\_form\_marketplace\_expander" class="wcfm-content"> |
  | 104 |  | <h2><?php \_e('Marketplace Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 105 |  | <?php wcfm\_video\_tutorial(~~'https://www.youtube.com/embed/ZKGD1PkdgYI'~~ ); ?> |
  |  | 105 | <h2><?php \_e('Marketplace Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 106 | <?php wcfm\_video\_tutorial('https://www.youtube.com/embed/ZKGD1PkdgYI'); ?> |
  | 106 | 107 | <div class="wcfm\_clearfix"></div> |
  | 107 | 108 | <?php |
  | 108 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_store', array( |
  | 109 |  | ~~"product\_approval" => array('label' => \_\_('Product Approval', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => 'no', 'attributes' => array( 'disabled' => true ), 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => sprintf( \_\_( 'Manager vendor capabilities from %sCapability Setting%s', 'wc-multivendor-marketplace' ), '<a target="\_blank" style="color:#17a2b8;" href="'.get\_wcfm\_capability\_url().'">', '</a>' )~~ ), |
  | 110 |  |  |
  | 111 |  | ~~"vendor\_store\_url" => array('label' => \_\_('Store URL Base', 'wc-multivendor-marketplace') , 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_slug\_input', 'label\_class' => 'wcfm\_title wcfm\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc', 'value' => $wcfm\_store\_url, 'desc' => sprintf( \_\_( 'Define the seller store URL  (%s/[this-text]/[seller-name])', 'wc-multivendor-marketplace' ), get\_site\_url() ), 'custom\_attributes' => array( 'required' => true )~~ ), |
  | 112 |  | ~~"vendor\_sold\_by" => array('label' => \_\_('Visible Sold By', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_sold\_by, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Uncheck this to disable Sold By display for products.', 'wc-multivendor-marketplace' )~~ ), |
  | 113 |  | ~~"sold\_by\_label" => array('label' => \_\_('Sold By Label', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $sold\_by\_label, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Sold By label along with store name under product archive pages.', 'wc-multivendor-marketplace' )~~ ), |
  | 114 |  |  |
  | 115 |  | ~~"vendor\_sold\_by\_template" => array('label' => \_\_('Sold By Template', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array( 'simple' => \_\_( 'Simple', 'wc-multivendor-marketplace' ), 'advanced' => \_\_( 'Advanced', 'wc-multivendor-marketplace' ), 'tab' => \_\_( 'As Tab', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $vendor\_sold\_by\_template, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Single product page Sold By template.', 'wc-multivendor-marketplace' )~~ ), |
  | 116 |  | ~~"sold\_by\_template\_simple" => array( 'type' => 'html', 'class' => 'vendor\_sold\_by\_type vendor\_sold\_by\_type\_simple', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => '<img src="'.esc\_url($WCFMmp->plugin\_url).'assets/images/sold\_by\_simple.png" />', 'attributes' => array( 'style' => 'margin-left:35%;border: 1px dotted #ccc;margin-bottom:15px;' )~~ ), |
  | 117 |  | ~~"sold\_by\_template\_advanced" => array( 'type' => 'html', 'class' => 'vendor\_sold\_by\_type vendor\_sold\_by\_type\_advanced', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => '<img src="'.esc\_url($WCFMmp->plugin\_url).'assets/images/sold\_by\_advanced.png" />', 'attributes' => array( 'style' => 'margin-left:35%;border: 1px dotted #ccc;margin-bottom:15px;' )~~ ), |
  | 118 |  | ~~"sold\_by\_template\_tab" => array( 'type' => 'html', 'class' => 'vendor\_sold\_by\_type vendor\_sold\_by\_type\_tab', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => '<img src="'.esc\_url($WCFMmp->plugin\_url).'assets/images/sold\_by\_tab.png" />', 'attributes' => array( 'style' => 'margin-left:35%;border: 1px dotted #ccc;margin-bottom:15px;' )~~ ), |
  | 119 |  |  |
  | 120 |  | ~~"vendor\_sold\_by\_position" => array( 'label' => \_\_('Sold By Position', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array( 'bellow\_title' => \_\_( 'Below Title', 'wc-multivendor-marketplace' ), 'bellow\_price' => \_\_( 'Below Price', 'wc-multivendor-marketplace' ), 'bellow\_sc' => \_\_( 'Below Short Description', 'wc-multivendor-marketplace' ), 'bellow\_atc' => \_\_( 'Below Add to Cart', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $vendor\_sold\_by\_position, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Sold by display position at Single Product Page.', 'wc-multivendor-marketplace' )~~ ), |
  | 121 |  | ~~"store\_name\_position" => array( 'label' => \_\_('Store Name Position', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array( 'on\_banner' => \_\_( 'On Banner', 'wc-multivendor-marketplace' ), 'on\_header' => \_\_( 'At Header', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_name\_position, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Store name position at Vendor Store Page.', 'wc-multivendor-marketplace' )~~ ), |
  | 122 |  |  |
  | 123 |  | ~~"store\_list\_sidebar" => array( 'label' => \_\_('Store List Sidebar', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $store\_list\_sidebar, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Uncheck this to disable store list sidebar.', 'wc-multivendor-marketplace' )~~ ), |
  | 124 |  | ~~"store\_sidebar" => array( 'label' => \_\_('Store Sidebar', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $store\_sidebar, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Uncheck this to disable vendor store sidebar.', 'wc-multivendor-marketplace' )~~ ), |
  | 125 |  | ~~"store\_sidebar\_pos" => array( 'label' => \_\_('Store Sidebar Position', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array( 'left' => \_\_( 'At Left', 'wc-multivendor-marketplace' ), 'right' => \_\_( 'At Right', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_sidebar\_pos~~ ), |
  | 126 |  |  |
  | 127 |  | ~~"store\_ppp" => array( 'label' => \_\_('Products per page', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_ppp, 'attributes' => array( 'min'=> 1, 'step' => 1 ), 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'No of products at Store per Page.', 'wc-frontend-manager' )~~ ), |
  | 128 |  | ~~"store\_related\_products" => array( 'label' => \_\_('Store Related Products', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array( 'default' => \_\_( 'As per WC Default Rule', 'wc-multivendor-marketplace' ), 'store' => \_\_( 'Only same Store Products', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_related\_products, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Single product page related products rule.', 'wc-frontend-manager' )~~ ), |
  | 129 |  |  |
  | 130 |  | //"product\_mulivendor" => array('label' => \_\_('Product Multi-vendor', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $product\_mulivendor, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Enable this to allow vendors to sell other vendor products, single product multiple seller.', 'wc-multivendor-marketplace' ) ), |
  | 131 |  |  |
  | 132 |  | ~~"store\_default\_logo" => array('label' => \_\_('Store Default Logo', 'wc-multivendor-marketplace') , 'type' => 'upload', 'class' => 'wcfm-text wcfm\_ele wcfm-logo-uploads', 'label\_class' => 'wcfm\_title', 'prwidth' => 75, 'value' => $store\_default\_logo~~ ), |
  | 133 |  | ~~"store\_default\_banner" => array('label' => \_\_('Store Default Banner', 'wc-multivendor-marketplace') , 'type' => 'upload', 'class' => 'wcfm-text wcfm\_ele wcfm-banner-uploads', 'label\_class' => 'wcfm\_title', 'prwidth' => 250, 'value' => $store\_default\_banner~~ ), |
  | 134 |  | ~~"store\_list\_default\_banner" => array('label' => \_\_('Store List Default Banner', 'wc-multivendor-marketplace') , 'type' => 'upload', 'class' => 'wcfm-text wcfm\_ele wcfm-banner-uploads', 'label\_class' => 'wcfm\_title', 'prwidth' => 250, 'value' => $store\_list\_default\_banner~~ ), |
  | 135 |  | ~~"store\_banner\_dimension" => array( 'label' => \_\_('Banner Dimension(s)', 'wc-multivendor-marketplace'), 'type' => 'html', 'label\_class' => 'wcfm\_title wcfm\_full\_ele\_title', 'value' => ''~~ ), |
  | 136 |  | ~~"store\_banner\_width" => array( 'label' => \_\_('Width', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_width, 'hints' => \_\_( 'Store banner preferred width in pixels.', 'wc-multivendor-marketplace' ), 'attributes' => array( 'min' => 1, 'step' => 1 )~~ ), |
  | 137 |  | ~~"store\_banner\_height" => array( 'label' => \_\_('Height', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_height, 'hints' => \_\_( 'Store banner preferred height in pixels.', 'wc-multivendor-marketplace' ), 'attributes' => array( 'min' => 1, 'step' => 1 )~~ ), |
  | 138 |  | ~~"store\_banner\_mwidth" => array( 'label' => \_\_('Width (Mob)', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_mwidth, 'hints' => \_\_( 'Store banner preferred width for mobile in pixels.', 'wc-multivendor-marketplace' ), 'attributes' => array( 'min' => 1, 'step' => 1 )~~ ), |
  | 139 |  | ~~"store\_banner\_mheight" => array( 'label' => \_\_('Height (Mob)', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_mheight, 'hints' => \_\_( 'Store banner preferred heightfor mobile in pixels.', 'wc-multivendor-marketplace' ), 'attributes' => array( 'min' => 1, 'step' => 1 )~~ ), |
  | 140 |  | ~~"store\_banner\_dimension2" => array( 'type' => 'html', 'value' => '<div class="wcfm\_clearfix"></div>'~~ ), |
  | 141 |  |  |
  | 142 |  | ~~"disable\_wcfm\_store\_setup" => array('label' => \_\_('Disable Store Setup Widget', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $disable\_wcfm\_store\_setup~~ ), |
  | 143 |  |  |
  | 144 |  | ~~"delete\_data\_on\_uninstall" => array('label' => \_\_('On Uninstall', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $delete\_data\_on\_uninstall, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Delete all marketplace data on uninstall. Be careful, there is no way to retrieve those data if once deleted!', 'wc-multivendor-marketplace' )~~ ), |
  | 145 |  | ~~) )~~ ); |
  | 146 |  | ?> |
  | 147 |  | <div class="wcfm\_clearfix"></div> |
  |  | 109 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_store', array( |
  |  | 110 | "product\_approval" => array('label' => \_\_('Product Approval', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => 'no', 'attributes' => array('disabled' => true), 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => sprintf(\_\_('Manager vendor capabilities from %sCapability Setting%s', 'wc-multivendor-marketplace'), '<a target="\_blank" style="color:#17a2b8;" href="' . get\_wcfm\_capability\_url() . '">', '</a>')), |
  |  | 111 |  |
  |  | 112 | "vendor\_store\_url" => array('label' => \_\_('Store URL Base', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_slug\_input', 'label\_class' => 'wcfm\_title wcfm\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc', 'value' => $wcfm\_store\_url, 'desc' => sprintf(\_\_('Define the seller store URL  (%s/[this-text]/[seller-name])', 'wc-multivendor-marketplace'), get\_site\_url()), 'custom\_attributes' => array('required' => true)), |
  |  | 113 | "vendor\_sold\_by" => array('label' => \_\_('Visible Sold By', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_sold\_by, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Uncheck this to disable Sold By display for products.', 'wc-multivendor-marketplace')), |
  |  | 114 | "sold\_by\_label" => array('label' => \_\_('Sold By Label', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $sold\_by\_label, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Sold By label along with store name under product archive pages.', 'wc-multivendor-marketplace')), |
  |  | 115 |  |
  |  | 116 | "vendor\_sold\_by\_template" => array('label' => \_\_('Sold By Template', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array('simple' => \_\_('Simple', 'wc-multivendor-marketplace'), 'advanced' => \_\_('Advanced', 'wc-multivendor-marketplace'), 'tab' => \_\_('As Tab', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $vendor\_sold\_by\_template, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Single product page Sold By template.', 'wc-multivendor-marketplace')), |
  |  | 117 | "sold\_by\_template\_simple" => array('type' => 'html', 'class' => 'vendor\_sold\_by\_type vendor\_sold\_by\_type\_simple', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => '<img src="' . esc\_url($WCFMmp->plugin\_url) . 'assets/images/sold\_by\_simple.png" />', 'attributes' => array('style' => 'margin-left:35%;border: 1px dotted #ccc;margin-bottom:15px;')), |
  |  | 118 | "sold\_by\_template\_advanced" => array('type' => 'html', 'class' => 'vendor\_sold\_by\_type vendor\_sold\_by\_type\_advanced', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => '<img src="' . esc\_url($WCFMmp->plugin\_url) . 'assets/images/sold\_by\_advanced.png" />', 'attributes' => array('style' => 'margin-left:35%;border: 1px dotted #ccc;margin-bottom:15px;')), |
  |  | 119 | "sold\_by\_template\_tab" => array('type' => 'html', 'class' => 'vendor\_sold\_by\_type vendor\_sold\_by\_type\_tab', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => '<img src="' . esc\_url($WCFMmp->plugin\_url) . 'assets/images/sold\_by\_tab.png" />', 'attributes' => array('style' => 'margin-left:35%;border: 1px dotted #ccc;margin-bottom:15px;')), |
  |  | 120 |  |
  |  | 121 | "vendor\_sold\_by\_position" => array('label' => \_\_('Sold By Position', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array('bellow\_title' => \_\_('Below Title', 'wc-multivendor-marketplace'), 'bellow\_price' => \_\_('Below Price', 'wc-multivendor-marketplace'), 'bellow\_sc' => \_\_('Below Short Description', 'wc-multivendor-marketplace'), 'bellow\_atc' => \_\_('Below Add to Cart', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $vendor\_sold\_by\_position, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Sold by display position at Single Product Page.', 'wc-multivendor-marketplace')), |
  |  | 122 | "store\_name\_position" => array('label' => \_\_('Store Name Position', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array('on\_banner' => \_\_('On Banner', 'wc-multivendor-marketplace'), 'on\_header' => \_\_('At Header', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_name\_position, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Store name position at Vendor Store Page.', 'wc-multivendor-marketplace')), |
  |  | 123 |  |
  |  | 124 | "store\_list\_sidebar" => array('label' => \_\_('Store List Sidebar', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $store\_list\_sidebar, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Uncheck this to disable store list sidebar.', 'wc-multivendor-marketplace')), |
  |  | 125 | "store\_sidebar" => array('label' => \_\_('Store Sidebar', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $store\_sidebar, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Uncheck this to disable vendor store sidebar.', 'wc-multivendor-marketplace')), |
  |  | 126 | "store\_sidebar\_pos" => array('label' => \_\_('Store Sidebar Position', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array('left' => \_\_('At Left', 'wc-multivendor-marketplace'), 'right' => \_\_('At Right', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_sidebar\_pos), |
  |  | 127 |  |
  |  | 128 | "store\_ppp" => array('label' => \_\_('Products per page', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_ppp, 'attributes' => array('min' => 1, 'step' => 1), 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('No of products at Store per Page.', 'wc-frontend-manager')), |
  |  | 129 | "store\_related\_products" => array('label' => \_\_('Store Related Products', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array('default' => \_\_('As per WC Default Rule', 'wc-multivendor-marketplace'), 'store' => \_\_('Only same Store Products', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $store\_related\_products, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Single product page related products rule.', 'wc-frontend-manager')), |
  |  | 130 |  |
  |  | 131 | //"product\_mulivendor" => array('label' => \_\_('Product Multi-vendor', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $product\_mulivendor, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Enable this to allow vendors to sell other vendor products, single product multiple seller.', 'wc-multivendor-marketplace' ) ), |
  |  | 132 |  |
  |  | 133 | "store\_default\_logo" => array('label' => \_\_('Store Default Logo', 'wc-multivendor-marketplace'), 'type' => 'upload', 'class' => 'wcfm-text wcfm\_ele wcfm-logo-uploads', 'label\_class' => 'wcfm\_title', 'prwidth' => 75, 'value' => $store\_default\_logo), |
  |  | 134 | "store\_default\_banner" => array('label' => \_\_('Store Default Banner', 'wc-multivendor-marketplace'), 'type' => 'upload', 'class' => 'wcfm-text wcfm\_ele wcfm-banner-uploads', 'label\_class' => 'wcfm\_title', 'prwidth' => 250, 'value' => $store\_default\_banner), |
  |  | 135 | "store\_list\_default\_banner" => array('label' => \_\_('Store List Default Banner', 'wc-multivendor-marketplace'), 'type' => 'upload', 'class' => 'wcfm-text wcfm\_ele wcfm-banner-uploads', 'label\_class' => 'wcfm\_title', 'prwidth' => 250, 'value' => $store\_list\_default\_banner), |
  |  | 136 | "store\_banner\_dimension" => array('label' => \_\_('Banner Dimension(s)', 'wc-multivendor-marketplace'), 'type' => 'html', 'label\_class' => 'wcfm\_title wcfm\_full\_ele\_title', 'value' => ''), |
  |  | 137 | "store\_banner\_width" => array('label' => \_\_('Width', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_width, 'hints' => \_\_('Store banner preferred width in pixels.', 'wc-multivendor-marketplace'), 'attributes' => array('min' => 1, 'step' => 1)), |
  |  | 138 | "store\_banner\_height" => array('label' => \_\_('Height', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_height, 'hints' => \_\_('Store banner preferred height in pixels.', 'wc-multivendor-marketplace'), 'attributes' => array('min' => 1, 'step' => 1)), |
  |  | 139 | "store\_banner\_mwidth" => array('label' => \_\_('Width (Mob)', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_mwidth, 'hints' => \_\_('Store banner preferred width for mobile in pixels.', 'wc-multivendor-marketplace'), 'attributes' => array('min' => 1, 'step' => 1)), |
  |  | 140 | "store\_banner\_mheight" => array('label' => \_\_('Height (Mob)', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_half\_ele', 'label\_class' => 'wcfm\_title wcfm\_half\_ele\_title', 'value' => $store\_banner\_mheight, 'hints' => \_\_('Store banner preferred heightfor mobile in pixels.', 'wc-multivendor-marketplace'), 'attributes' => array('min' => 1, 'step' => 1)), |
  |  | 141 | "store\_banner\_dimension2" => array('type' => 'html', 'value' => '<div class="wcfm\_clearfix"></div>'), |
  |  | 142 |  |
  |  | 143 | "disable\_wcfm\_store\_setup" => array('label' => \_\_('Disable Store Setup Widget', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $disable\_wcfm\_store\_setup), |
  |  | 144 |  |
  |  | 145 | "delete\_data\_on\_uninstall" => array('label' => \_\_('On Uninstall', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $delete\_data\_on\_uninstall, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Delete all marketplace data on uninstall. Be careful, there is no way to retrieve those data if once deleted!', 'wc-multivendor-marketplace')), |
  |  | 146 | ))); |
  |  | 147 | ?> |
  |  | 148 | <div class="wcfm\_clearfix"></div> |
  | 148 | 149 | </div> |
  | 149 | 150 | </div> |
  | 150 | 151 | <div class="wcfm\_clearfix"></div> |
  | 151 | 152 | <!-- end collapsible --> |
  | 152 |  |  |
  |  | 153 |  |
  | 153 | 154 | <?php |
  | 154 | 155 | } |
  | 155 |  |  |
  | 156 |  | function wcfm\_marketplace\_order\_settings(~~$wcfm\_options~~ ) { |
  |  | 156 |  |
  |  | 157 | function wcfm\_marketplace\_order\_settings($wcfm\_options) { |
  | 157 | 158 | global $WCFM, $WCFMmp; |
  | 158 |  |  |
  | 159 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_marketplace\_manage', true ) ) return;~~ |
  | 160 |  |  |
  | 161 |  | $wcfm\_marketplace\_options = wcfm\_get\_option(~~'wcfm\_marketplace\_options', array()~~ ); |
  | 162 |  |  |
  | 163 |  | $disable\_multivendor\_checkout = isset(~~$wcfm\_marketplace\_options['disable\_multivendor\_checkout']~~ ) ? $wcfm\_marketplace\_options['disable\_multivendor\_checkout'] : 'no'; |
  | 164 |  | $order\_sync                   = isset(~~$wcfm\_marketplace\_options['order\_sync']~~ ) ? $wcfm\_marketplace\_options['order\_sync'] : 'no'; |
  | 165 |  |  |
  |  | 159 |  |
  |  | 160 | if (!apply\_filters('wcfm\_is\_allow\_marketplace\_manage', true)) return; |
  |  | 161 |  |
  |  | 162 | $wcfm\_marketplace\_options = wcfm\_get\_option('wcfm\_marketplace\_options', array()); |
  |  | 163 |  |
  |  | 164 | $disable\_multivendor\_checkout = isset($wcfm\_marketplace\_options['disable\_multivendor\_checkout']) ? $wcfm\_marketplace\_options['disable\_multivendor\_checkout'] : 'no'; |
  |  | 165 | $order\_sync                   = isset($wcfm\_marketplace\_options['order\_sync']) ? $wcfm\_marketplace\_options['order\_sync'] : 'no'; |
  |  | 166 |  |
  | 166 | 167 | ?> |
  | 167 | 168 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L172) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L173) |  |
  | 172 | 173 | <div class="wcfm-container"> |
  | 173 | 174 | <div id="wcfm\_settings\_form\_marketplace\_order\_expander" class="wcfm-content"> |
  | 174 |  | <h2><?php \_e('Order Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 175 | <h2><?php \_e('Order Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 175 | 176 | <div class="wcfm\_clearfix"></div> |
  | 176 | 177 | <?php |
  | 177 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_order\_settings\_fields\_store', array( |
  | 178 |  | ~~"disable\_multivendor\_checkout" => array('label' => \_\_('Disable Multivendor Checkout', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $disable\_multivendor\_checkout, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Enable this restrict multiple vendors product checkout at same order.', 'wc-multivendor-marketplace' )~~ ), |
  | 179 |  | ~~"order\_sync" => array('label' => \_\_('Order Sync', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $order\_sync, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Enable this to sync WC main order status when vendors update their order status.', 'wc-multivendor-marketplace' )~~ ), |
  | 180 |  | ~~) )~~ ); |
  |  | 178 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_order\_settings\_fields\_store', array( |
  |  | 179 | "disable\_multivendor\_checkout" => array('label' => \_\_('Disable Multivendor Checkout', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $disable\_multivendor\_checkout, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Enable this restrict multiple vendors product checkout at same order.', 'wc-multivendor-marketplace')), |
  |  | 180 | "order\_sync" => array('label' => \_\_('Order Sync', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $order\_sync, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Enable this to sync WC main order status when vendors update their order status.', 'wc-multivendor-marketplace')), |
  |  | 181 | ))); |
  | 181 | 182 | ?> |
  | 182 |  | <div class="wcfm\_clearfix"></div> |
  |  | 183 | <div class="wcfm\_clearfix"></div> |
  | 183 | 184 | </div> |
  | 184 | 185 | </div> |
  | 185 | 186 | <div class="wcfm\_clearfix"></div> |
  | 186 | 187 | <!-- end collapsible --> |
  | 187 |  |  |
  |  | 188 |  |
  | 188 | 189 | <?php |
  | 189 | 190 | } |
  | 190 |  |  |
  | 191 |  | function wcfm\_geolocate\_settings(~~$wcfm\_options~~ ) { |
  |  | 191 |  |
  |  | 192 | function wcfm\_geolocate\_settings($wcfm\_options) { |
  | 192 | 193 | global $WCFM, $WCFMmp; |
  | 193 |  |  |
  | 194 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_marketplace\_manage', true ) ) return;~~ |
  | 195 |  |  |
  |  | 194 |  |
  |  | 195 | if (!apply\_filters('wcfm\_is\_allow\_marketplace\_manage', true)) return; |
  |  | 196 |  |
  | 196 | 197 | $wcfm\_marketplace\_options = $WCFMmp->wcfmmp\_marketplace\_options; |
  | 197 |  |  |
  | 198 |  | $wcfm\_google\_map\_api           = isset( $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  | 199 |  |  |
  | 200 |  | $wcfm\_map\_lib           = isset( $wcfm\_marketplace\_options['wcfm\_map\_lib'] ) ? $wcfm\_marketplace\_options['wcfm\_map\_lib'] : ''; |
  | 201 |  | if( !$wcfm\_map\_lib && $wcfm\_google\_map\_api ) { $wcfm\_map\_lib = 'google'; } |
  | 202 |  |  |
  | 203 |  | $enable\_wcfm\_storelist\_radius  = isset( $wcfm\_marketplace\_options['enable\_wcfm\_storelist\_radius'] ) ? $wcfm\_marketplace\_options['enable\_wcfm\_storelist\_radius'] : 'no'; |
  | 204 |  | $enable\_wcfm\_product\_radius    = isset( $wcfm\_marketplace\_options['enable\_wcfm\_product\_radius'] ) ? $wcfm\_marketplace\_options['enable\_wcfm\_product\_radius'] : 'no'; |
  | 205 |  |  |
  | 206 |  | $max\_radius\_to\_search          = isset( $wcfm\_marketplace\_options['max\_radius\_to\_search'] ) ? $wcfm\_marketplace\_options['max\_radius\_to\_search'] : '100'; |
  | 207 |  |  |
  | 208 |  | $radius\_unit                   = isset( $wcfm\_marketplace\_options['radius\_unit'] ) ? $wcfm\_marketplace\_options['radius\_unit'] : 'km'; |
  | 209 |  |  |
  | 210 |  | $enable\_wcfm\_geo\_locate        = isset( $wcfm\_marketplace\_options['enable\_wcfm\_geo\_locate'] ) ? $wcfm\_marketplace\_options['enable\_wcfm\_geo\_locate'] : 'no'; |
  | 211 |  |  |
  | 212 |  | $show\_product\_location         = isset( $wcfm\_marketplace\_options['show\_product\_location'] ) ? $wcfm\_marketplace\_options['show\_product\_location'] : 'no'; |
  | 213 |  |  |
  | 214 |  | $checkout\_user\_location        = isset( $wcfm\_marketplace\_options['checkout\_user\_location'] ) ? $wcfm\_marketplace\_options['checkout\_user\_location'] : 'no'; |
  | 215 |  |  |
  |  | 198 |  |
  |  | 199 | $wcfm\_google\_map\_api           = isset($wcfm\_marketplace\_options['wcfm\_google\_map\_api']) ? $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  |  | 200 |  |
  |  | 201 | $wcfm\_map\_lib           = isset($wcfm\_marketplace\_options['wcfm\_map\_lib']) ? $wcfm\_marketplace\_options['wcfm\_map\_lib'] : ''; |
  |  | 202 | if (!$wcfm\_map\_lib && $wcfm\_google\_map\_api) { |
  |  | 203 | $wcfm\_map\_lib = 'google'; |
  |  | 204 | } |
  |  | 205 |  |
  |  | 206 | $enable\_wcfm\_storelist\_radius  = isset($wcfm\_marketplace\_options['enable\_wcfm\_storelist\_radius']) ? $wcfm\_marketplace\_options['enable\_wcfm\_storelist\_radius'] : 'no'; |
  |  | 207 | $enable\_wcfm\_product\_radius    = isset($wcfm\_marketplace\_options['enable\_wcfm\_product\_radius']) ? $wcfm\_marketplace\_options['enable\_wcfm\_product\_radius'] : 'no'; |
  |  | 208 |  |
  |  | 209 | $max\_radius\_to\_search          = isset($wcfm\_marketplace\_options['max\_radius\_to\_search']) ? $wcfm\_marketplace\_options['max\_radius\_to\_search'] : '100'; |
  |  | 210 |  |
  |  | 211 | $radius\_unit                   = isset($wcfm\_marketplace\_options['radius\_unit']) ? $wcfm\_marketplace\_options['radius\_unit'] : 'km'; |
  |  | 212 |  |
  |  | 213 | $enable\_wcfm\_geo\_locate        = isset($wcfm\_marketplace\_options['enable\_wcfm\_geo\_locate']) ? $wcfm\_marketplace\_options['enable\_wcfm\_geo\_locate'] : 'no'; |
  |  | 214 |  |
  |  | 215 | $show\_product\_location         = isset($wcfm\_marketplace\_options['show\_product\_location']) ? $wcfm\_marketplace\_options['show\_product\_location'] : 'no'; |
  |  | 216 |  |
  |  | 217 | $checkout\_user\_location        = isset($wcfm\_marketplace\_options['checkout\_user\_location']) ? $wcfm\_marketplace\_options['checkout\_user\_location'] : 'no'; |
  |  | 218 |  |
  | 216 | 219 | // Default Map Location |
  | 217 |  | $default\_geolocation = isset(~~$wcfm\_marketplace\_options['default\_geolocation']~~ ) ? $wcfm\_marketplace\_options['default\_geolocation'] : array(); |
  | 218 |  | $store\_location      = isset(~~$default\_geolocation['location'] ) ? esc\_attr( $default\_geolocation['location']~~ ) : ''; |
  | 219 |  | $map\_address         = isset(~~$default\_geolocation['address'] ) ? esc\_attr( $default\_geolocation['address']~~ ) : ''; |
  | 220 |  | $store\_lat           = isset(~~$default\_geolocation['lat'] ) ? esc\_attr( $default\_geolocation['lat'] ) : apply\_filters( 'wcfmmp\_map\_default\_lat', 30.0599153~~ ); |
  | 221 |  | $store\_lng           = isset(~~$default\_geolocation['lng'] ) ? esc\_attr( $default\_geolocation['lng'] ) : apply\_filters( 'wcfmmp\_map\_default\_lng', 31.2620199~~ ); |
  | 222 |  |  |
  |  | 220 | $default\_geolocation = isset($wcfm\_marketplace\_options['default\_geolocation']) ? $wcfm\_marketplace\_options['default\_geolocation'] : array(); |
  |  | 221 | $store\_location      = isset($default\_geolocation['location']) ? esc\_attr($default\_geolocation['location']) : ''; |
  |  | 222 | $map\_address         = isset($default\_geolocation['address']) ? esc\_attr($default\_geolocation['address']) : ''; |
  |  | 223 | $store\_lat           = isset($default\_geolocation['lat']) ? esc\_attr($default\_geolocation['lat']) : apply\_filters('wcfmmp\_map\_default\_lat', 30.0599153); |
  |  | 224 | $store\_lng           = isset($default\_geolocation['lng']) ? esc\_attr($default\_geolocation['lng']) : apply\_filters('wcfmmp\_map\_default\_lng', 31.2620199); |
  |  | 225 |  |
  | 223 | 226 | ?> |
  | 224 | 227 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L229) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L232) |  |
  | 229 | 232 | <div class="wcfm-container"> |
  | 230 | 233 | <div id="wcfm\_settings\_form\_geolocate\_expander" class="wcfm-content"> |
  | 231 |  | <h2><?php \_e('GEO Location Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 232 |  | <?php //wcfm\_video\_tutorial( 'https://www.youtube.com/embed/ZKGD1PkdgYI' ); ?> |
  |  | 234 | <h2><?php \_e('GEO Location Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 235 | <?php //wcfm\_video\_tutorial( 'https://www.youtube.com/embed/ZKGD1PkdgYI' ); |
  |  | 236 | ?> |
  | 233 | 237 | <div class="wcfm\_clearfix"></div> |
  | 234 | 238 | <?php |
  | 235 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_geo\_locate', array( |
  | 236 |  |  |
  | 237 |  | ~~"wcfm\_map\_lib" => array('label' => \_\_('Map Library', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'options' => apply\_filters( 'wcfm\_google\_map\_lib\_options', array( 'leaflet' => 'Open Street Map', 'google' => 'Google Map' ) ), 'value' => $wcfm\_map\_lib~~ ), |
  | 238 |  |  |
  | 239 |  | ~~"wcfm\_google\_map\_api" => array('label' => \_\_('Google Map API Key', 'wc-multivendor-marketplace') , 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_map\_lib\_field wcfm\_map\_lib\_field\_google', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_map\_lib\_field wcfm\_map\_lib\_field\_google', 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_map\_lib\_field wcfm\_map\_lib\_field\_google', 'value' => $wcfm\_google\_map\_api, 'desc' => sprintf( \_\_( '%sAPI Key%s is needed to display map on store page', 'wc-multivendor-marketplace' ), '<a target="\_blank" href="https://developers.google.com/maps/documentation/javascript/">', '</a>' )~~ ), |
  | 240 |  |  |
  | 241 |  | ~~"enable\_wcfm\_storelist\_radius"  => array('label' => \_\_('Store List Radius Search', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_wcfm\_storelist\_radius, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Check this to enable store list radius filter by user location.', 'wc-multivendor-marketplace' )~~ ), |
  | 242 |  |  |
  | 243 |  | ~~"enable\_wcfm\_product\_radius"  => array('label' => \_\_('Product List Radius Search', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_wcfm\_product\_radius, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Check this to enable product list radius filter by user location.', 'wc-multivendor-marketplace' )~~ ), |
  | 244 |  |  |
  | 245 |  | ~~"max\_radius\_to\_search"  => array('label' => \_\_('Maximum Radius to Search', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'options' => apply\_filters( 'wcfm\_max\_radius\_to\_search\_options', array( '1' => '1', '2' => '2', '3' => '3', '5' => '5', '10' => '10', '15' => '15', '20' => '20', '50' => '50', '100' => '100', '150' => '150', '200' => '200', '500' => '500' ) ), 'value' => $max\_radius\_to\_search, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Set maximum radius allow to search.', 'wc-multivendor-marketplace' )~~ ), |
  | 246 |  |  |
  | 247 |  | ~~"radius\_unit"  => array('label' => \_\_('Radius Unit', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'options' => array( 'km' => 'Kilometer', 'mi' => 'Miles' ), 'value' => $radius\_unit~~ ), |
  | 248 |  |  |
  | 249 |  | ~~"enable\_wcfm\_geo\_locate"  => array('label' => \_\_('Enable Auto Filter', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_wcfm\_geo\_locate, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Check this to enable auto-filter by user\'s location.', 'wc-multivendor-marketplace' )~~ ), |
  | 250 |  |  |
  | 251 |  | ~~"show\_product\_location"  => array('label' => \_\_('Show Product Location', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $show\_product\_location, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Check this to show product\'s location at single product page.', 'wc-multivendor-marketplace' )~~ ), |
  | 252 |  |  |
  | 253 |  | ~~"checkout\_user\_location"  => array('label' => \_\_('Checkout User Location', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $checkout\_user\_location, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Check this to enable user\'s location input using map at checkout.', 'wc-multivendor-marketplace' )~~ ), |
  | 254 |  | ~~) )~~ ); |
  | 255 |  |  |
  | 256 |  | $api\_key = isset(~~$wcfm\_marketplace\_options['wcfm\_google\_map\_api']~~ ) ? $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  | 257 |  | if (~~( $wcfm\_map\_lib != 'google' ) || ( ( $wcfm\_map\_lib == 'google' ) && $api\_key )~~ ) { |
  | 258 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_geo\_locate\_default\_location', array( |
  | 259 |  | ~~"find\_address" => array( 'label' => \_\_( 'Map Default Location', 'wc-frontend-manager' ), 'placeholder' => \_\_( 'Type an address to find', 'wc-frontend-manager' ), 'name' => 'default\_geolocation[address]', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $map\_address~~ ), |
  | 260 |  | ~~"store\_location" => array( 'type' => 'hidden', 'name' => 'default\_geolocation[location]', 'value' => $store\_location~~ ), |
  | 261 |  | ~~"store\_lat" => array( 'type' => 'hidden', 'name' => 'default\_geolocation[lat]', 'value' => $store\_lat~~ ), |
  | 262 |  | ~~"store\_lng" => array( 'type' => 'hidden', 'name' => 'default\_geolocation[lng]', 'value' => $store\_lng~~ ), |
  | 263 |  | ~~) )~~ ); |
  | 264 |  | ?> |
  |  | 239 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_geo\_locate', array( |
  |  | 240 |  |
  |  | 241 | "wcfm\_map\_lib" => array('label' => \_\_('Map Library', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'options' => apply\_filters('wcfm\_google\_map\_lib\_options', array('leaflet' => 'Open Street Map', 'google' => 'Google Map')), 'value' => $wcfm\_map\_lib), |
  |  | 242 |  |
  |  | 243 | "wcfm\_google\_map\_api" => array('label' => \_\_('Google Map API Key', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_map\_lib\_field wcfm\_map\_lib\_field\_google', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_map\_lib\_field wcfm\_map\_lib\_field\_google', 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_map\_lib\_field wcfm\_map\_lib\_field\_google', 'value' => $wcfm\_google\_map\_api, 'desc' => sprintf(\_\_('%sAPI Key%s is needed to display map on store page', 'wc-multivendor-marketplace'), '<a target="\_blank" href="https://developers.google.com/maps/documentation/javascript/">', '</a>')), |
  |  | 244 |  |
  |  | 245 | "enable\_wcfm\_storelist\_radius"  => array('label' => \_\_('Store List Radius Search', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_wcfm\_storelist\_radius, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Check this to enable store list radius filter by user location.', 'wc-multivendor-marketplace')), |
  |  | 246 |  |
  |  | 247 | "enable\_wcfm\_product\_radius"  => array('label' => \_\_('Product List Radius Search', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_wcfm\_product\_radius, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Check this to enable product list radius filter by user location.', 'wc-multivendor-marketplace')), |
  |  | 248 |  |
  |  | 249 | "max\_radius\_to\_search"  => array('label' => \_\_('Maximum Radius to Search', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'options' => apply\_filters('wcfm\_max\_radius\_to\_search\_options', array('1' => '1', '2' => '2', '3' => '3', '5' => '5', '10' => '10', '15' => '15', '20' => '20', '50' => '50', '100' => '100', '150' => '150', '200' => '200', '500' => '500')), 'value' => $max\_radius\_to\_search, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Set maximum radius allow to search.', 'wc-multivendor-marketplace')), |
  |  | 250 |  |
  |  | 251 | "radius\_unit"  => array('label' => \_\_('Radius Unit', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title', 'options' => array('km' => 'Kilometer', 'mi' => 'Miles'), 'value' => $radius\_unit), |
  |  | 252 |  |
  |  | 253 | "enable\_wcfm\_geo\_locate"  => array('label' => \_\_('Enable Auto Filter', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_wcfm\_geo\_locate, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Check this to enable auto-filter by user\'s location.', 'wc-multivendor-marketplace')), |
  |  | 254 |  |
  |  | 255 | "show\_product\_location"  => array('label' => \_\_('Show Product Location', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $show\_product\_location, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Check this to show product\'s location at single product page.', 'wc-multivendor-marketplace')), |
  |  | 256 |  |
  |  | 257 | "checkout\_user\_location"  => array('label' => \_\_('Checkout User Location', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $checkout\_user\_location, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Check this to enable user\'s location input using map at checkout.', 'wc-multivendor-marketplace')), |
  |  | 258 | ))); |
  |  | 259 |  |
  |  | 260 | $api\_key = isset($wcfm\_marketplace\_options['wcfm\_google\_map\_api']) ? $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  |  | 261 | if (($wcfm\_map\_lib != 'google') || (($wcfm\_map\_lib == 'google') && $api\_key)) { |
  |  | 262 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_geo\_locate\_default\_location', array( |
  |  | 263 | "find\_address" => array('label' => \_\_('Map Default Location', 'wc-frontend-manager'), 'placeholder' => \_\_('Type an address to find', 'wc-frontend-manager'), 'name' => 'default\_geolocation[address]', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $map\_address), |
  |  | 264 | "store\_location" => array('type' => 'hidden', 'name' => 'default\_geolocation[location]', 'value' => $store\_location), |
  |  | 265 | "store\_lat" => array('type' => 'hidden', 'name' => 'default\_geolocation[lat]', 'value' => $store\_lat), |
  |  | 266 | "store\_lng" => array('type' => 'hidden', 'name' => 'default\_geolocation[lng]', 'value' => $store\_lng), |
  |  | 267 | ))); |
  |  | 268 | ?> |
  | 265 | 269 | <div class="wcfm\_clearfix"></div><br /> |
  | 266 | 270 | <div class="wcfm-marketplace-google-map" id="wcfm-marketplace-map"></div> |
  | 267 | 271 | <div class="wcfm\_clearfix"></div><br /> |
  | 268 |  | <?php |
  |  | 272 | <?php |
  | 269 | 273 | } |
  | 270 | 274 | ?> |
  | 271 | 275 | <div class="wcfm\_clearfix"></div> |
  | 272 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e( 'Store List Page', 'wc-multivendor-marketplace' ); ?></h2></div> |
  | 273 |  | <?php wcfm\_video\_tutorial( 'https://docs.wclovers.com/store-list/' ); ?> |
  |  | 276 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 277 | <h2><?php \_e('Store List Page', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 278 | </div> |
  |  | 279 | <?php wcfm\_video\_tutorial('https://docs.wclovers.com/store-list/'); ?> |
  | 274 | 280 | <div class="wcfm\_clearfix"></div> |
  | 275 | 281 | <div class="store\_address store\_address\_wrap"> |
  | 276 |  | <p> |
  | 277 |  | <?php |
  | 278 |  | printf( \_\_( "You just have to create a page using short code – %swcfm\_stores%s |
  |  | 282 | <p> |
  |  | 283 | <?php |
  |  | 284 | printf( |
  |  | 285 | \_\_("You just have to create a page using short code – %swcfm\_stores%s |
  | 279 | 286 | You may specify “per\_row” attribute to specify number of store in one row, by default it’s “2”.%s |
  | 280 | 287 | Also specify “per\_page” attribute to set how many stores you want to show in a page. Default value is 10.%s |
  | 281 |  | You may also specify “excludes” attribute (comma separated store ids) to excludes some store from list.", 'wc-multivendor-marketplace' ), |
  | 282 |  | '<b>', '</b><br/>', '<br/>', '<br/>'); |
  | 283 |  | ?> |
  | 284 |  | </p> |
  | 285 |  | <img src="<?php echo esc\_url( $WCFMmp->plugin\_url . 'assets/images/' ); ?>wcfmmp-storelist.png" /> |
  |  | 288 | You may also specify “excludes” attribute (comma separated store ids) to excludes some store from list.", 'wc-multivendor-marketplace'), |
  |  | 289 | '<b>', |
  |  | 290 | '</b><br/>', |
  |  | 291 | '<br/>', |
  |  | 292 | '<br/>' |
  |  | 293 | ); |
  |  | 294 | ?> |
  |  | 295 | </p> |
  |  | 296 | <img src="<?php echo esc\_url($WCFMmp->plugin\_url . 'assets/images/'); ?>wcfmmp-storelist.png" /> |
  | 286 | 297 | </div> |
  | 287 | 298 | </div> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L289) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L300) |  |
  | 289 | 300 | <div class="wcfm\_clearfix"></div> |
  | 290 | 301 | <!-- end collapsible --> |
  | 291 |  |  |
  |  | 302 |  |
  | 292 | 303 | <?php |
  | 293 | 304 | } |
  | 294 |  |  |
  | 295 |  | function wcfm\_marketplace\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 305 |  |
  |  | 306 | function wcfm\_marketplace\_settings\_update($wcfm\_settings\_form) { |
  | 296 | 307 | global $WCFM, $WCFMmp, $\_POST; |
  | 297 |  |  |
  | 298 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_marketplace\_manage', true ) ) return;~~ |
  | 299 |  |  |
  | 300 |  | $wcfm\_marketplace\_options = wcfm\_get\_option(~~'wcfm\_marketplace\_options', array()~~ ); |
  | 301 |  |  |
  | 302 |  | if~~( isset( $wcfm\_settings\_form['vendor\_store\_url'] )~~ ) { |
  | 303 |  | $wcfm\_marketplace\_options['wcfm\_store\_url'] = sanitize\_title(~~$wcfm\_settings\_form['vendor\_store\_url']~~ ); |
  | 304 |  | wcfm\_update\_option(~~'wcfm\_store\_url', sanitize\_title( $wcfm\_settings\_form['vendor\_store\_url'] )~~ ); |
  | 305 |  | } |
  | 306 |  |  |
  | 307 |  | if~~( isset( $wcfm\_settings\_form['vendor\_sold\_by'] )~~ ) { |
  |  | 308 |  |
  |  | 309 | if (!apply\_filters('wcfm\_is\_allow\_marketplace\_manage', true)) return; |
  |  | 310 |  |
  |  | 311 | $wcfm\_marketplace\_options = wcfm\_get\_option('wcfm\_marketplace\_options', array()); |
  |  | 312 |  |
  |  | 313 | if (isset($wcfm\_settings\_form['vendor\_store\_url'])) { |
  |  | 314 | $wcfm\_marketplace\_options['wcfm\_store\_url'] = sanitize\_title($wcfm\_settings\_form['vendor\_store\_url']); |
  |  | 315 | wcfm\_update\_option('wcfm\_store\_url', sanitize\_title($wcfm\_settings\_form['vendor\_store\_url'])); |
  |  | 316 | } |
  |  | 317 |  |
  |  | 318 | if (isset($wcfm\_settings\_form['vendor\_sold\_by'])) { |
  | 308 | 319 | $wcfm\_marketplace\_options['vendor\_sold\_by'] = 'yes'; |
  | 309 | 320 | } else { |
  | 310 | 321 | $wcfm\_marketplace\_options['vendor\_sold\_by'] = 'no'; |
  | 311 | 322 | } |
  | 312 |  |  |
  | 313 |  | if~~( isset( $wcfm\_settings\_form['sold\_by\_label'] )~~ ) { |
  |  | 323 |  |
  |  | 324 | if (isset($wcfm\_settings\_form['sold\_by\_label'])) { |
  | 314 | 325 | $wcfm\_marketplace\_options['sold\_by\_label'] = $wcfm\_settings\_form['sold\_by\_label']; |
  | 315 | 326 | } |
  | 316 |  |  |
  | 317 |  | if~~( isset( $wcfm\_settings\_form['vendor\_sold\_by\_template'] )~~ ) { |
  |  | 327 |  |
  |  | 328 | if (isset($wcfm\_settings\_form['vendor\_sold\_by\_template'])) { |
  | 318 | 329 | $wcfm\_marketplace\_options['vendor\_sold\_by\_template'] = $wcfm\_settings\_form['vendor\_sold\_by\_template']; |
  | 319 | 330 | } |
  | 320 |  |  |
  | 321 |  | if~~( isset( $wcfm\_settings\_form['vendor\_sold\_by\_position'] )~~ ) { |
  |  | 331 |  |
  |  | 332 | if (isset($wcfm\_settings\_form['vendor\_sold\_by\_position'])) { |
  | 322 | 333 | $wcfm\_marketplace\_options['vendor\_sold\_by\_position'] = $wcfm\_settings\_form['vendor\_sold\_by\_position']; |
  | 323 | 334 | } |
  | 324 |  |  |
  | 325 |  | if~~( isset( $wcfm\_settings\_form['store\_name\_position'] )~~ ) { |
  |  | 335 |  |
  |  | 336 | if (isset($wcfm\_settings\_form['store\_name\_position'])) { |
  | 326 | 337 | $wcfm\_marketplace\_options['store\_name\_position'] = $wcfm\_settings\_form['store\_name\_position']; |
  | 327 | 338 | } |
  | 328 |  |  |
  | 329 |  | if~~( isset( $wcfm\_settings\_form['store\_list\_sidebar'] )~~ ) { |
  |  | 339 |  |
  |  | 340 | if (isset($wcfm\_settings\_form['store\_list\_sidebar'])) { |
  | 330 | 341 | $wcfm\_marketplace\_options['store\_list\_sidebar'] = 'yes'; |
  | 331 | 342 | } else { |
  | 332 | 343 | $wcfm\_marketplace\_options['store\_list\_sidebar'] = 'no'; |
  | 333 | 344 | } |
  | 334 |  |  |
  | 335 |  | if~~( isset( $wcfm\_settings\_form['store\_sidebar'] )~~ ) { |
  |  | 345 |  |
  |  | 346 | if (isset($wcfm\_settings\_form['store\_sidebar'])) { |
  | 336 | 347 | $wcfm\_marketplace\_options['store\_sidebar'] = 'yes'; |
  | 337 | 348 | } else { |
  | 338 | 349 | $wcfm\_marketplace\_options['store\_sidebar'] = 'no'; |
  | 339 | 350 | } |
  | 340 |  |  |
  | 341 |  | if~~( isset( $wcfm\_settings\_form['store\_related\_products'] )~~ ) { |
  |  | 351 |  |
  |  | 352 | if (isset($wcfm\_settings\_form['store\_related\_products'])) { |
  | 342 | 353 | $wcfm\_marketplace\_options['store\_related\_products'] = $wcfm\_settings\_form['store\_related\_products']; |
  | 343 | 354 | } |
  | 344 |  |  |
  | 345 |  | if~~( isset( $wcfm\_settings\_form['store\_sidebar\_pos'] )~~ ) { |
  |  | 355 |  |
  |  | 356 | if (isset($wcfm\_settings\_form['store\_sidebar\_pos'])) { |
  | 346 | 357 | $wcfm\_marketplace\_options['store\_sidebar\_pos'] = $wcfm\_settings\_form['store\_sidebar\_pos']; |
  | 347 | 358 | } |
  | 348 |  |  |
  | 349 |  | if~~( isset( $wcfm\_settings\_form['store\_default\_logo'] )~~ ) { |
  |  | 359 |  |
  |  | 360 | if (isset($wcfm\_settings\_form['store\_default\_logo'])) { |
  | 350 | 361 | $wcfm\_marketplace\_options['store\_default\_logo'] = $wcfm\_settings\_form['store\_default\_logo']; |
  | 351 | 362 | } |
  | 352 |  |  |
  | 353 |  | if~~( isset( $wcfm\_settings\_form['store\_default\_banner'] )~~ ) { |
  |  | 363 |  |
  |  | 364 | if (isset($wcfm\_settings\_form['store\_default\_banner'])) { |
  | 354 | 365 | $wcfm\_marketplace\_options['store\_default\_banner'] = $wcfm\_settings\_form['store\_default\_banner']; |
  | 355 | 366 | } |
  | 356 |  |  |
  | 357 |  | if~~( isset( $wcfm\_settings\_form['store\_list\_default\_banner'] )~~ ) { |
  |  | 367 |  |
  |  | 368 | if (isset($wcfm\_settings\_form['store\_list\_default\_banner'])) { |
  | 358 | 369 | $wcfm\_marketplace\_options['store\_list\_default\_banner'] = $wcfm\_settings\_form['store\_list\_default\_banner']; |
  | 359 | 370 | } |
  | 360 |  |  |
  | 361 |  | if~~( isset( $wcfm\_settings\_form['store\_banner\_width'] )~~ ) { |
  |  | 371 |  |
  |  | 372 | if (isset($wcfm\_settings\_form['store\_banner\_width'])) { |
  | 362 | 373 | $wcfm\_marketplace\_options['store\_banner\_width'] = $wcfm\_settings\_form['store\_banner\_width']; |
  | 363 | 374 | } |
  | 364 |  |  |
  | 365 |  | if~~( isset( $wcfm\_settings\_form['store\_banner\_height'] )~~ ) { |
  |  | 375 |  |
  |  | 376 | if (isset($wcfm\_settings\_form['store\_banner\_height'])) { |
  | 366 | 377 | $wcfm\_marketplace\_options['store\_banner\_height'] = $wcfm\_settings\_form['store\_banner\_height']; |
  | 367 | 378 | } |
  | 368 |  |  |
  | 369 |  | if~~( isset( $wcfm\_settings\_form['store\_banner\_mwidth'] )~~ ) { |
  |  | 379 |  |
  |  | 380 | if (isset($wcfm\_settings\_form['store\_banner\_mwidth'])) { |
  | 370 | 381 | $wcfm\_marketplace\_options['store\_banner\_mwidth'] = $wcfm\_settings\_form['store\_banner\_mwidth']; |
  | 371 | 382 | } |
  | 372 |  |  |
  | 373 |  | if~~( isset( $wcfm\_settings\_form['store\_banner\_mheight'] )~~ ) { |
  |  | 383 |  |
  |  | 384 | if (isset($wcfm\_settings\_form['store\_banner\_mheight'])) { |
  | 374 | 385 | $wcfm\_marketplace\_options['store\_banner\_mheight'] = $wcfm\_settings\_form['store\_banner\_mheight']; |
  | 375 | 386 | } |
  | 376 |  |  |
  | 377 |  | if~~( isset( $wcfm\_settings\_form['store\_ppp'] )~~ ) { |
  |  | 387 |  |
  |  | 388 | if (isset($wcfm\_settings\_form['store\_ppp'])) { |
  | 378 | 389 | $wcfm\_marketplace\_options['store\_ppp'] = $wcfm\_settings\_form['store\_ppp']; |
  | 379 | 390 | } |
  | 380 |  |  |
  |  | 391 |  |
  | 381 | 392 | //if( isset( $wcfm\_settings\_form['product\_mulivendor'] ) ) { |
  | 382 |  | //$wcfm\_marketplace\_options['product\_mulivendor'] = 'yes'; |
  |  | 393 | //$wcfm\_marketplace\_options['product\_mulivendor'] = 'yes'; |
  | 383 | 394 | //} else { |
  | 384 |  | $wcfm\_marketplace\_options['product\_mulivendor'] = 'no'; |
  |  | 395 | $wcfm\_marketplace\_options['product\_mulivendor'] = 'no'; |
  | 385 | 396 | //} |
  | 386 |  |  |
  | 387 |  | if~~( isset( $wcfm\_settings\_form['order\_sync'] )~~ ) { |
  |  | 397 |  |
  |  | 398 | if (isset($wcfm\_settings\_form['order\_sync'])) { |
  | 388 | 399 | $wcfm\_marketplace\_options['order\_sync'] = 'yes'; |
  | 389 | 400 | } else { |
  | 390 | 401 | $wcfm\_marketplace\_options['order\_sync'] = 'no'; |
  | 391 | 402 | } |
  | 392 |  |  |
  | 393 |  | if~~( isset( $wcfm\_settings\_form['disable\_multivendor\_checkout'] )~~ ) { |
  |  | 403 |  |
  |  | 404 | if (isset($wcfm\_settings\_form['disable\_multivendor\_checkout'])) { |
  | 394 | 405 | $wcfm\_marketplace\_options['disable\_multivendor\_checkout'] = 'yes'; |
  | 395 | 406 | } else { |
  | 396 | 407 | $wcfm\_marketplace\_options['disable\_multivendor\_checkout'] = 'no'; |
  | 397 | 408 | } |
  | 398 |  |  |
  | 399 |  | if~~( isset( $wcfm\_settings\_form['disable\_wcfm\_store\_setup'] )~~ ) { |
  |  | 409 |  |
  |  | 410 | if (isset($wcfm\_settings\_form['disable\_wcfm\_store\_setup'])) { |
  | 400 | 411 | $wcfm\_marketplace\_options['disable\_wcfm\_store\_setup'] = 'yes'; |
  | 401 | 412 | } else { |
  | 402 | 413 | $wcfm\_marketplace\_options['disable\_wcfm\_store\_setup'] = 'no'; |
  | 403 | 414 | } |
  | 404 |  |  |
  | 405 |  | if~~( isset( $wcfm\_settings\_form['delete\_data\_on\_uninstall'] )~~ ) { |
  |  | 415 |  |
  |  | 416 | if (isset($wcfm\_settings\_form['delete\_data\_on\_uninstall'])) { |
  | 406 | 417 | $wcfm\_marketplace\_options['delete\_data\_on\_uninstall'] = 'yes'; |
  | 407 | 418 | } else { |
  | 408 | 419 | $wcfm\_marketplace\_options['delete\_data\_on\_uninstall'] = 'no'; |
  | 409 | 420 | } |
  | 410 |  |  |
  |  | 421 |  |
  | 411 | 422 | // GEO Location Setting Options |
  | 412 |  | if~~( isset( $wcfm\_settings\_form['enable\_wcfm\_geo\_locate'] )~~ ) { |
  |  | 423 | if (isset($wcfm\_settings\_form['enable\_wcfm\_geo\_locate'])) { |
  | 413 | 424 | $wcfm\_marketplace\_options['enable\_wcfm\_geo\_locate'] = 'yes'; |
  | 414 | 425 | } else { |
  | 415 | 426 | $wcfm\_marketplace\_options['enable\_wcfm\_geo\_locate'] = 'no'; |
  | 416 | 427 | } |
  | 417 |  |  |
  | 418 |  | if~~( isset( $wcfm\_settings\_form['wcfm\_map\_lib'] )~~ ) { |
  |  | 428 |  |
  |  | 429 | if (isset($wcfm\_settings\_form['wcfm\_map\_lib'])) { |
  | 419 | 430 | $wcfm\_marketplace\_options['wcfm\_map\_lib'] = $wcfm\_settings\_form['wcfm\_map\_lib']; |
  | 420 | 431 | } |
  | 421 |  |  |
  | 422 |  | if~~( isset( $wcfm\_settings\_form['wcfm\_google\_map\_api'] )~~ ) { |
  |  | 432 |  |
  |  | 433 | if (isset($wcfm\_settings\_form['wcfm\_google\_map\_api'])) { |
  | 423 | 434 | $wcfm\_marketplace\_options['wcfm\_google\_map\_api'] = $wcfm\_settings\_form['wcfm\_google\_map\_api']; |
  | 424 | 435 | } |
  | 425 |  |  |
  | 426 |  | if~~( isset( $wcfm\_settings\_form['enable\_wcfm\_storelist\_radius'] )~~ ) { |
  |  | 436 |  |
  |  | 437 | if (isset($wcfm\_settings\_form['enable\_wcfm\_storelist\_radius'])) { |
  | 427 | 438 | $wcfm\_marketplace\_options['enable\_wcfm\_storelist\_radius'] = 'yes'; |
  | 428 | 439 | } else { |
  | 429 | 440 | $wcfm\_marketplace\_options['enable\_wcfm\_storelist\_radius'] = 'no'; |
  | 430 | 441 | } |
  | 431 |  |  |
  | 432 |  | if~~( isset( $wcfm\_settings\_form['enable\_wcfm\_product\_radius'] )~~ ) { |
  |  | 442 |  |
  |  | 443 | if (isset($wcfm\_settings\_form['enable\_wcfm\_product\_radius'])) { |
  | 433 | 444 | $wcfm\_marketplace\_options['enable\_wcfm\_product\_radius'] = 'yes'; |
  | 434 | 445 | } else { |
  | 435 | 446 | $wcfm\_marketplace\_options['enable\_wcfm\_product\_radius'] = 'no'; |
  | 436 | 447 | } |
  | 437 |  |  |
  | 438 |  | if~~( isset( $wcfm\_settings\_form['max\_radius\_to\_search'] )~~ ) { |
  |  | 448 |  |
  |  | 449 | if (isset($wcfm\_settings\_form['max\_radius\_to\_search'])) { |
  | 439 | 450 | $wcfm\_marketplace\_options['max\_radius\_to\_search'] = $wcfm\_settings\_form['max\_radius\_to\_search']; |
  | 440 | 451 | } else { |
  | 441 | 452 | $wcfm\_marketplace\_options['max\_radius\_to\_search'] = '100'; |
  | 442 | 453 | } |
  | 443 |  |  |
  | 444 |  | if~~( isset( $wcfm\_settings\_form['radius\_unit'] )~~ ) { |
  |  | 454 |  |
  |  | 455 | if (isset($wcfm\_settings\_form['radius\_unit'])) { |
  | 445 | 456 | $wcfm\_marketplace\_options['radius\_unit'] = $wcfm\_settings\_form['radius\_unit']; |
  | 446 | 457 | } else { |
  | 447 | 458 | $wcfm\_marketplace\_options['radius\_unit'] = 'km'; |
  | 448 | 459 | } |
  | 449 |  |  |
  | 450 |  | if~~( isset( $wcfm\_settings\_form['show\_product\_location'] )~~ ) { |
  |  | 460 |  |
  |  | 461 | if (isset($wcfm\_settings\_form['show\_product\_location'])) { |
  | 451 | 462 | $wcfm\_marketplace\_options['show\_product\_location'] = 'yes'; |
  | 452 | 463 | } else { |
  | 453 | 464 | $wcfm\_marketplace\_options['show\_product\_location'] = 'no'; |
  | 454 | 465 | } |
  | 455 |  |  |
  | 456 |  | if~~( isset( $wcfm\_settings\_form['checkout\_user\_location'] )~~ ) { |
  |  | 466 |  |
  |  | 467 | if (isset($wcfm\_settings\_form['checkout\_user\_location'])) { |
  | 457 | 468 | $wcfm\_marketplace\_options['checkout\_user\_location'] = 'yes'; |
  | 458 | 469 | } else { |
  | 459 | 470 | $wcfm\_marketplace\_options['checkout\_user\_location'] = 'no'; |
  | 460 | 471 | } |
  | 461 |  |  |
  | 462 |  | if~~( isset( $wcfm\_settings\_form['default\_geolocation'] )~~ ) { |
  |  | 472 |  |
  |  | 473 | if (isset($wcfm\_settings\_form['default\_geolocation'])) { |
  | 463 | 474 | $wcfm\_marketplace\_options['default\_geolocation'] = $wcfm\_settings\_form['default\_geolocation']; |
  | 464 | 475 | } |
  | 465 |  |  |
  | 466 |  | wcfm\_update\_option(~~'wcfm\_marketplace\_options', $wcfm\_marketplace\_options~~ ); |
  | 467 |  | } |
  | 468 |  |  |
  | 469 |  | function wcfm\_commission\_settings(~~$wcfm\_options~~ ) { |
  |  | 476 |  |
  |  | 477 | wcfm\_update\_option('wcfm\_marketplace\_options', $wcfm\_marketplace\_options); |
  |  | 478 | } |
  |  | 479 |  |
  |  | 480 | function wcfm\_commission\_settings($wcfm\_options) { |
  | 470 | 481 | global $WCFM, $WCFMmp; |
  | 471 |  |  |
  | 472 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_commission\_manage', true ) ) return;~~ |
  | 473 |  |  |
  | 474 |  | $wcfm\_commission\_options = get\_option(~~'wcfm\_commission\_options', array()~~ ); |
  | 475 |  |  |
  |  | 482 |  |
  |  | 483 | if (!apply\_filters('wcfm\_is\_allow\_commission\_manage', true)) return; |
  |  | 484 |  |
  |  | 485 | $wcfm\_commission\_options = get\_option('wcfm\_commission\_options', array()); |
  |  | 486 |  |
  | 476 | 487 | $wcfm\_commission\_types = get\_wcfm\_marketplace\_commission\_types(); |
  | 477 |  |  |
  | 478 |  | $vendor\_commission\_for         = isset(~~$wcfm\_commission\_options['commission\_for']~~ ) ? $wcfm\_commission\_options['commission\_for'] : 'vendor'; |
  | 479 |  | $vendor\_commission\_mode        = isset(~~$wcfm\_commission\_options['commission\_mode']~~ ) ? $wcfm\_commission\_options['commission\_mode'] : 'percent'; |
  | 480 |  | $vendor\_commission\_fixed       = isset(~~$wcfm\_commission\_options['commission\_fixed']~~ ) ? $wcfm\_commission\_options['commission\_fixed'] : ''; |
  | 481 |  | $vendor\_commission\_percent     = isset(~~$wcfm\_commission\_options['commission\_percent']~~ ) ? $wcfm\_commission\_options['commission\_percent'] : '90'; |
  | 482 |  | $vendor\_commission\_by\_sales    = isset(~~$wcfm\_commission\_options['commission\_by\_sales']~~ ) ? $wcfm\_commission\_options['commission\_by\_sales'] : array(); |
  | 483 |  | $vendor\_commission\_by\_products = isset(~~$wcfm\_commission\_options['commission\_by\_products']~~ ) ? $wcfm\_commission\_options['commission\_by\_products'] : array(); |
  | 484 |  | $vendor\_commission\_by\_quantity = isset(~~$wcfm\_commission\_options['commission\_by\_quantity']~~ ) ? $wcfm\_commission\_options['commission\_by\_quantity'] : array(); |
  | 485 |  | $vendor\_get\_shipping           = isset(~~$wcfm\_commission\_options['get\_shipping']~~ ) ? $wcfm\_commission\_options['get\_shipping'] : 'yes'; |
  | 486 |  | $vendor\_get\_tax                = isset(~~$wcfm\_commission\_options['get\_tax']~~ ) ? $wcfm\_commission\_options['get\_tax'] : 'yes'; |
  | 487 |  | $vendor\_coupon\_deduct          = isset(~~$wcfm\_commission\_options['coupon\_deduct']~~ ) ? $wcfm\_commission\_options['coupon\_deduct'] : 'yes'; |
  | 488 |  | $admin\_coupon\_deduct           = isset(~~$wcfm\_commission\_options['admin\_coupon\_deduct']~~ ) ? $wcfm\_commission\_options['admin\_coupon\_deduct'] : 'yes'; |
  | 489 |  |  |
  | 490 |  | $tax\_enable                    = isset(~~$wcfm\_commission\_options['tax\_enable']~~ ) ? $wcfm\_commission\_options['tax\_enable'] : 'no'; |
  | 491 |  | $tax\_name                      = isset(~~$wcfm\_commission\_options['tax\_name']~~ ) ? $wcfm\_commission\_options['tax\_name'] : ''; |
  | 492 |  | $tax\_percent                   = isset(~~$wcfm\_commission\_options['tax\_percent']~~ ) ? $wcfm\_commission\_options['tax\_percent'] : ''; |
  | 493 |  |  |
  |  | 488 |  |
  |  | 489 | $vendor\_commission\_for         = isset($wcfm\_commission\_options['commission\_for']) ? $wcfm\_commission\_options['commission\_for'] : 'vendor'; |
  |  | 490 | $vendor\_commission\_mode        = isset($wcfm\_commission\_options['commission\_mode']) ? $wcfm\_commission\_options['commission\_mode'] : 'percent'; |
  |  | 491 | $vendor\_commission\_fixed       = isset($wcfm\_commission\_options['commission\_fixed']) ? $wcfm\_commission\_options['commission\_fixed'] : ''; |
  |  | 492 | $vendor\_commission\_percent     = isset($wcfm\_commission\_options['commission\_percent']) ? $wcfm\_commission\_options['commission\_percent'] : '90'; |
  |  | 493 | $vendor\_commission\_by\_sales    = isset($wcfm\_commission\_options['commission\_by\_sales']) ? $wcfm\_commission\_options['commission\_by\_sales'] : array(); |
  |  | 494 | $vendor\_commission\_by\_products = isset($wcfm\_commission\_options['commission\_by\_products']) ? $wcfm\_commission\_options['commission\_by\_products'] : array(); |
  |  | 495 | $vendor\_commission\_by\_quantity = isset($wcfm\_commission\_options['commission\_by\_quantity']) ? $wcfm\_commission\_options['commission\_by\_quantity'] : array(); |
  |  | 496 | $vendor\_get\_shipping           = isset($wcfm\_commission\_options['get\_shipping']) ? $wcfm\_commission\_options['get\_shipping'] : 'yes'; |
  |  | 497 | $vendor\_get\_tax                = isset($wcfm\_commission\_options['get\_tax']) ? $wcfm\_commission\_options['get\_tax'] : 'yes'; |
  |  | 498 | $vendor\_coupon\_deduct          = isset($wcfm\_commission\_options['coupon\_deduct']) ? $wcfm\_commission\_options['coupon\_deduct'] : 'yes'; |
  |  | 499 | $admin\_coupon\_deduct           = isset($wcfm\_commission\_options['admin\_coupon\_deduct']) ? $wcfm\_commission\_options['admin\_coupon\_deduct'] : 'yes'; |
  |  | 500 |  |
  |  | 501 | $tax\_enable                    = isset($wcfm\_commission\_options['tax\_enable']) ? $wcfm\_commission\_options['tax\_enable'] : 'no'; |
  |  | 502 | $tax\_name                      = isset($wcfm\_commission\_options['tax\_name']) ? $wcfm\_commission\_options['tax\_name'] : ''; |
  |  | 503 | $tax\_percent                   = isset($wcfm\_commission\_options['tax\_percent']) ? $wcfm\_commission\_options['tax\_percent'] : ''; |
  |  | 504 |  |
  | 494 | 505 | ?> |
  | 495 | 506 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L500) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L511) |  |
  | 500 | 511 | <div class="wcfm-container"> |
  | 501 | 512 | <div id="wcfm\_settings\_form\_commission\_expander" class="wcfm-content"> |
  | 502 |  | <h2><?php \_e('Marketplace Commission Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 503 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-commission/'~~ ); ?> |
  |  | 513 | <h2><?php \_e('Marketplace Commission Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 514 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-commission/'); ?> |
  | 504 | 515 | <div class="wcfm\_clearfix"></div> |
  | 505 | 516 | <?php |
  | 506 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_commission', array( |
  | 507 |  | ~~"vendor\_commission\_for" => array('label' => \_\_('Commission For', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array( 'vendor' => \_\_( 'Vendor', 'wc-multivendor-marketplace' ), 'admin' => \_\_( 'Admin', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $vendor\_commission\_for~~ ), |
  | 508 |  | ~~"vendor\_commission\_mode" => array('label' => \_\_('Commission Mode', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => $wcfm\_commission\_types, 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $vendor\_commission\_mode~~ ), |
  | 509 |  | ~~"vendor\_commission\_percent" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input commission\_mode\_field commission\_mode\_percent commission\_mode\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele commission\_mode\_field commission\_mode\_percent commission\_mode\_percent\_fixed', 'value' => $vendor\_commission\_percent, 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 510 |  | ~~"vendor\_commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input commission\_mode\_field commission\_mode\_fixed commission\_mode\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele commission\_mode\_field commission\_mode\_fixed commission\_mode\_percent\_fixed', 'value' => $vendor\_commission\_fixed, 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 511 |  | ~~"vendor\_commission\_by\_sales" => array('label' => \_\_('Commission By Sales Rule(s)', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele commission\_mode\_field commission\_mode\_by\_sales', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title commission\_mode\_field commission\_mode\_by\_sales', 'desc\_class' => 'commission\_mode\_field commission\_mode\_by\_sales instructions', 'value' => $vendor\_commission\_by\_sales, 'desc' => sprintf( \_\_( 'Commission rules depending upon vendors total sales. e.g 50&#37; commission when sales < %s1000, 75&#37; commission when sales > %s1000 but < %s2000 and so on. You may define any number of such rules. Please be sure, do not set conflicting rules.', 'wc-multivendor-marketplace' ), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol() ),  'options' => array(~~ |
  | 512 |  | ~~"sales" => array('label' => \_\_('Sales', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_non\_negative\_input wcfm\_ele', 'attributes' => array( 'min' => '1', 'step' => '0.1')~~ ), |
  | 513 |  | ~~"rule" => array('label' => \_\_('Rule', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array( 'upto' => \_\_( 'Up to', 'wc-multivendor-marketplace' ), 'greater' => \_\_( 'More than', 'wc-multivendor-marketplace' ) )~~ ), |
  | 514 |  | ~~"type" => array('label' => \_\_('Commission Type', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array( 'percent' => \_\_( 'Percent', 'wc-multivendor-marketplace' ), 'fixed' => \_\_( 'Fixed', 'wc-multivendor-marketplace' ), 'percent\_fixed' => \_\_( 'Percent + Fixed', 'wc-multivendor-marketplace' ) )~~ ), |
  | 515 |  | ~~"commission" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 516 |  | ~~"commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 517 |  | ~~)~~ ), |
  | 518 |  | ~~"vendor\_commission\_by\_products" => array('label' => \_\_('Commission By Product Price', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele commission\_mode\_field commission\_mode\_by\_products', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title commission\_mode\_field commission\_mode\_by\_products', 'desc\_class' => 'commission\_mode\_field commission\_mode\_by\_products instructions', 'value' => $vendor\_commission\_by\_products, 'desc' => sprintf( \_\_( 'Commission rules depending upon product price. e.g 80&#37; commission when product cost < %s1000, %s100 fixed commission when product cost > %s1000 and so on. You may define any number of such rules. Please be sure, do not set conflicting rules.', 'wc-multivendor-marketplace' ), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol() ),  'options' => array(~~ |
  | 519 |  | ~~"cost" => array('label' => \_\_('Product Cost', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 520 |  | ~~"rule" => array('label' => \_\_('Rule', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array( 'upto' => \_\_( 'Up to', 'wc-multivendor-marketplace' ), 'greater'   => \_\_( 'More than', 'wc-multivendor-marketplace' ) )~~ ), |
  | 521 |  | ~~"type" => array('label' => \_\_('Commission Type', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array( 'percent' => \_\_( 'Percent', 'wc-multivendor-marketplace' ), 'fixed'   => \_\_( 'Fixed', 'wc-multivendor-marketplace' ), 'percent\_fixed' => \_\_( 'Percent + Fixed', 'wc-multivendor-marketplace' ) )~~ ), |
  | 522 |  | ~~"commission" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 523 |  | ~~"commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 524 |  | ~~)~~ ), |
  | 525 |  | ~~"vendor\_commission\_by\_quantity" => array('label' => \_\_('Commission By Purchase Quantity', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele commission\_mode\_field commission\_mode\_by\_quantity', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title commission\_mode\_field commission\_mode\_by\_quantity', 'desc\_class' => 'commission\_mode\_field commission\_mode\_by\_quantity instructions', 'value' => $vendor\_commission\_by\_quantity, 'desc' => \_\_( 'Commission rules depending upon purchased product quantity. e.g 80&#37; commission when purchase quantity 2, 80&#37; commission when purchase quantity > 2 and so on. You may define any number of such rules. Please be sure, do not set conflicting rules.', 'wc-multivendor-marketplace' ),  'options' => array(~~ |
  | 526 |  | ~~"quantity" => array('label' => \_\_('Purchase Quantity', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '1', 'step' => '1')~~ ), |
  | 527 |  | ~~"rule" => array('label' => \_\_('Rule', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array( 'upto' => \_\_( 'Up to', 'wc-multivendor-marketplace' ), 'greater'   => \_\_( 'More than', 'wc-multivendor-marketplace' ) )~~ ), |
  | 528 |  | ~~"type" => array('label' => \_\_('Commission Type', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array( 'percent' => \_\_( 'Percent', 'wc-multivendor-marketplace' ), 'fixed'   => \_\_( 'Fixed', 'wc-multivendor-marketplace' ), 'percent\_fixed' => \_\_( 'Percent + Fixed', 'wc-multivendor-marketplace' ) )~~ ), |
  | 529 |  | ~~"commission" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 530 |  | ~~"commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 531 |  | ~~)~~ ), |
  | 532 |  | ~~"vendor\_get\_shipping" => array('label' => \_\_('Shipping cost goes to vendor?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_get\_shipping~~ ), |
  | 533 |  | ~~"vendor\_get\_tax" => array('label' => \_\_('Tax goes to vendor?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_get\_tax~~ ), |
  | 534 |  | ~~"vendor\_coupon\_deduct" => array('label' => \_\_('Commission after consider Vendor Coupon?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_coupon\_deduct, 'hints' => \_\_( 'Generate vendor commission after deduct Vendor Coupon discounts.', 'wc-multivendor-marketplace' )~~ ), |
  | 535 |  | ~~"admin\_coupon\_deduct" => array('label' => \_\_('Commission after consider Admin Coupon?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $admin\_coupon\_deduct, 'hints' => \_\_( 'Generate vendor commission after deduct Admin Coupon discounts.', 'wc-multivendor-marketplace' )~~ ), |
  | 536 |  | ~~) )~~ ); |
  | 537 |  | ?> |
  | 538 |  |  |
  | 539 |  | <div class="wcfm\_clearfix"></div><br /> |
  | 540 |  | <h2><?php \_e('Commission Tax Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 541 |  | <div class="wcfm\_clearfix"></div> |
  | 542 |  |  |
  |  | 517 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_commission', array( |
  |  | 518 | "vendor\_commission\_for" => array('label' => \_\_('Commission For', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => array('vendor' => \_\_('Vendor', 'wc-multivendor-marketplace'), 'admin' => \_\_('Admin', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $vendor\_commission\_for), |
  |  | 519 | "vendor\_commission\_mode" => array('label' => \_\_('Commission Mode', 'wc-multivendor-marketplace'), 'type' => 'select', 'options' => $wcfm\_commission\_types, 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $vendor\_commission\_mode), |
  |  | 520 | "vendor\_commission\_percent" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input commission\_mode\_field commission\_mode\_percent commission\_mode\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele commission\_mode\_field commission\_mode\_percent commission\_mode\_percent\_fixed', 'value' => $vendor\_commission\_percent, 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 521 | "vendor\_commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input commission\_mode\_field commission\_mode\_fixed commission\_mode\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele commission\_mode\_field commission\_mode\_fixed commission\_mode\_percent\_fixed', 'value' => $vendor\_commission\_fixed, 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 522 | "vendor\_commission\_by\_sales" => array('label' => \_\_('Commission By Sales Rule(s)', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele commission\_mode\_field commission\_mode\_by\_sales', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title commission\_mode\_field commission\_mode\_by\_sales', 'desc\_class' => 'commission\_mode\_field commission\_mode\_by\_sales instructions', 'value' => $vendor\_commission\_by\_sales, 'desc' => sprintf(\_\_('Commission rules depending upon vendors total sales. e.g 50&#37; commission when sales < %s1000, 75&#37; commission when sales > %s1000 but < %s2000 and so on. You may define any number of such rules. Please be sure, do not set conflicting rules.', 'wc-multivendor-marketplace'), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol()),  'options' => array( |
  |  | 523 | "sales" => array('label' => \_\_('Sales', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_non\_negative\_input wcfm\_ele', 'attributes' => array('min' => '1', 'step' => '0.1')), |
  |  | 524 | "rule" => array('label' => \_\_('Rule', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array('upto' => \_\_('Up to', 'wc-multivendor-marketplace'), 'greater' => \_\_('More than', 'wc-multivendor-marketplace'))), |
  |  | 525 | "type" => array('label' => \_\_('Commission Type', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array('percent' => \_\_('Percent', 'wc-multivendor-marketplace'), 'fixed' => \_\_('Fixed', 'wc-multivendor-marketplace'), 'percent\_fixed' => \_\_('Percent + Fixed', 'wc-multivendor-marketplace'))), |
  |  | 526 | "commission" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 527 | "commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 528 | )), |
  |  | 529 | "vendor\_commission\_by\_products" => array('label' => \_\_('Commission By Product Price', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele commission\_mode\_field commission\_mode\_by\_products', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title commission\_mode\_field commission\_mode\_by\_products', 'desc\_class' => 'commission\_mode\_field commission\_mode\_by\_products instructions', 'value' => $vendor\_commission\_by\_products, 'desc' => sprintf(\_\_('Commission rules depending upon product price. e.g 80&#37; commission when product cost < %s1000, %s100 fixed commission when product cost > %s1000 and so on. You may define any number of such rules. Please be sure, do not set conflicting rules.', 'wc-multivendor-marketplace'), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol(), get\_woocommerce\_currency\_symbol()),  'options' => array( |
  |  | 530 | "cost" => array('label' => \_\_('Product Cost', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 531 | "rule" => array('label' => \_\_('Rule', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array('upto' => \_\_('Up to', 'wc-multivendor-marketplace'), 'greater'   => \_\_('More than', 'wc-multivendor-marketplace'))), |
  |  | 532 | "type" => array('label' => \_\_('Commission Type', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array('percent' => \_\_('Percent', 'wc-multivendor-marketplace'), 'fixed'   => \_\_('Fixed', 'wc-multivendor-marketplace'), 'percent\_fixed' => \_\_('Percent + Fixed', 'wc-multivendor-marketplace'))), |
  |  | 533 | "commission" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 534 | "commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 535 | )), |
  |  | 536 | "vendor\_commission\_by\_quantity" => array('label' => \_\_('Commission By Purchase Quantity', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele commission\_mode\_field commission\_mode\_by\_quantity', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title commission\_mode\_field commission\_mode\_by\_quantity', 'desc\_class' => 'commission\_mode\_field commission\_mode\_by\_quantity instructions', 'value' => $vendor\_commission\_by\_quantity, 'desc' => \_\_('Commission rules depending upon purchased product quantity. e.g 80&#37; commission when purchase quantity 2, 80&#37; commission when purchase quantity > 2 and so on. You may define any number of such rules. Please be sure, do not set conflicting rules.', 'wc-multivendor-marketplace'),  'options' => array( |
  |  | 537 | "quantity" => array('label' => \_\_('Purchase Quantity', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '1', 'step' => '1')), |
  |  | 538 | "rule" => array('label' => \_\_('Rule', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array('upto' => \_\_('Up to', 'wc-multivendor-marketplace'), 'greater'   => \_\_('More than', 'wc-multivendor-marketplace'))), |
  |  | 539 | "type" => array('label' => \_\_('Commission Type', 'wc-multivendor-marketplace'), 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'options' => array('percent' => \_\_('Percent', 'wc-multivendor-marketplace'), 'fixed'   => \_\_('Fixed', 'wc-multivendor-marketplace'), 'percent\_fixed' => \_\_('Percent + Fixed', 'wc-multivendor-marketplace'))), |
  |  | 540 | "commission" => array('label' => \_\_('Commission Percent(%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 541 | "commission\_fixed" => array('label' => \_\_('Commission Fixed', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', 'type' => 'number', 'placeholder' => 0, 'class' => 'wcfm-text wcfm\_non\_negative\_input wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 542 | )), |
  |  | 543 | "vendor\_get\_shipping" => array('label' => \_\_('Shipping cost goes to vendor?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_get\_shipping), |
  |  | 544 | "vendor\_get\_tax" => array('label' => \_\_('Tax goes to vendor?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_get\_tax), |
  |  | 545 | "vendor\_coupon\_deduct" => array('label' => \_\_('Commission after consider Vendor Coupon?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $vendor\_coupon\_deduct, 'hints' => \_\_('Generate vendor commission after deduct Vendor Coupon discounts.', 'wc-multivendor-marketplace')), |
  |  | 546 | "admin\_coupon\_deduct" => array('label' => \_\_('Commission after consider Admin Coupon?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $admin\_coupon\_deduct, 'hints' => \_\_('Generate vendor commission after deduct Admin Coupon discounts.', 'wc-multivendor-marketplace')), |
  |  | 547 | ))); |
  |  | 548 | ?> |
  |  | 549 |  |
  |  | 550 | <div class="wcfm\_clearfix"></div><br /> |
  |  | 551 | <h2><?php \_e('Commission Tax Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 552 | <div class="wcfm\_clearfix"></div> |
  |  | 553 |  |
  | 543 | 554 | <?php |
  | 544 |  | ~~$WCFM->wcfm\_fields->wcfm\_generate\_form\_field( apply\_filters( 'wcfm\_marketplace\_settings\_fields\_commission\_tax', array(~~ |
  | 545 |  | ~~'tax\_enable' => array( 'label' => \_\_( 'Enable', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $tax\_enable~~ ), |
  | 546 |  | ~~'tax\_name' => array( 'label' => \_\_( 'Tax Label', 'wc-multivendor-marketplace' ), 'placeholder' => \_\_( 'Tax', 'wc-multivendor-marketplace' ), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $tax\_name~~ ), |
  | 547 |  | ~~'tax\_percent' => array( 'label' => \_\_( 'Tax Percent (%)', 'wc-multivendor-marketplace' ), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input', 'label\_class' => 'wcfm\_title', 'value' => $tax\_percent~~ ), |
  | 548 |  | ~~) )~~ ); |
  |  | 555 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_commission\_tax', array( |
  |  | 556 | 'tax\_enable' => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $tax\_enable), |
  |  | 557 | 'tax\_name' => array('label' => \_\_('Tax Label', 'wc-multivendor-marketplace'), 'placeholder' => \_\_('Tax', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title', 'value' => $tax\_name), |
  |  | 558 | 'tax\_percent' => array('label' => \_\_('Tax Percent (%)', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input', 'label\_class' => 'wcfm\_title', 'value' => $tax\_percent), |
  |  | 559 | ))); |
  | 549 | 560 | ?> |
  | 550 | 561 | </div> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L552) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L563) |  |
  | 552 | 563 | <div class="wcfm\_clearfix"></div> |
  | 553 | 564 | <!-- end collapsible --> |
  | 554 |  |  |
  |  | 565 |  |
  | 555 | 566 | <?php |
  | 556 |  |  |
  | 557 |  | } |
  | 558 |  |  |
  | 559 |  | function wcfm\_commission\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 567 |  |
  |  | 568 | } |
  |  | 569 |  |
  |  | 570 | function wcfm\_commission\_settings\_update($wcfm\_settings\_form) { |
  | 560 | 571 | global $WCFM, $WCFMmp, $\_POST; |
  | 561 |  |  |
  | 562 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_commission\_manage', true ) ) return;~~ |
  | 563 |  |  |
  | 564 |  | $wcfm\_commission\_options = get\_option(~~'wcfm\_commission\_options', array()~~ ); |
  | 565 |  |  |
  | 566 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_for'] )~~ ) { |
  |  | 572 |  |
  |  | 573 | if (!apply\_filters('wcfm\_is\_allow\_commission\_manage', true)) return; |
  |  | 574 |  |
  |  | 575 | $wcfm\_commission\_options = get\_option('wcfm\_commission\_options', array()); |
  |  | 576 |  |
  |  | 577 | if (isset($wcfm\_settings\_form['vendor\_commission\_for'])) { |
  | 567 | 578 | $wcfm\_commission\_options['commission\_for'] = $wcfm\_settings\_form['vendor\_commission\_for']; |
  | 568 | 579 | } |
  | 569 |  |  |
  | 570 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_mode'] )~~ ) { |
  |  | 580 |  |
  |  | 581 | if (isset($wcfm\_settings\_form['vendor\_commission\_mode'])) { |
  | 571 | 582 | $wcfm\_commission\_options['commission\_mode'] = $wcfm\_settings\_form['vendor\_commission\_mode']; |
  | 572 | 583 | } |
  | 573 |  |  |
  | 574 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_fixed'] )~~ ) { |
  |  | 584 |  |
  |  | 585 | if (isset($wcfm\_settings\_form['vendor\_commission\_fixed'])) { |
  | 575 | 586 | $wcfm\_commission\_options['commission\_fixed'] = $wcfm\_settings\_form['vendor\_commission\_fixed']; |
  | 576 | 587 | } |
  | 577 |  |  |
  | 578 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_percent'] )~~ ) { |
  |  | 588 |  |
  |  | 589 | if (isset($wcfm\_settings\_form['vendor\_commission\_percent'])) { |
  | 579 | 590 | $wcfm\_commission\_options['commission\_percent'] = $wcfm\_settings\_form['vendor\_commission\_percent']; |
  | 580 | 591 | } |
  | 581 |  |  |
  | 582 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_by\_sales'] )~~ ) { |
  |  | 592 |  |
  |  | 593 | if (isset($wcfm\_settings\_form['vendor\_commission\_by\_sales'])) { |
  | 583 | 594 | $wcfm\_commission\_options['commission\_by\_sales'] = $wcfm\_settings\_form['vendor\_commission\_by\_sales']; |
  | 584 | 595 | } |
  | 585 |  |  |
  | 586 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_by\_products'] )~~ ) { |
  |  | 596 |  |
  |  | 597 | if (isset($wcfm\_settings\_form['vendor\_commission\_by\_products'])) { |
  | 587 | 598 | $wcfm\_commission\_options['commission\_by\_products'] = $wcfm\_settings\_form['vendor\_commission\_by\_products']; |
  | 588 | 599 | } |
  | 589 |  |  |
  | 590 |  | if~~( isset( $wcfm\_settings\_form['vendor\_commission\_by\_quantity'] )~~ ) { |
  |  | 600 |  |
  |  | 601 | if (isset($wcfm\_settings\_form['vendor\_commission\_by\_quantity'])) { |
  | 591 | 602 | $wcfm\_commission\_options['commission\_by\_quantity'] = $wcfm\_settings\_form['vendor\_commission\_by\_quantity']; |
  | 592 | 603 | } |
  | 593 |  |  |
  | 594 |  | if~~( isset( $wcfm\_settings\_form['vendor\_get\_shipping'] )~~ ) { |
  |  | 604 |  |
  |  | 605 | if (isset($wcfm\_settings\_form['vendor\_get\_shipping'])) { |
  | 595 | 606 | $wcfm\_commission\_options['get\_shipping'] = 'yes'; |
  | 596 | 607 | } else { |
  | 597 | 608 | $wcfm\_commission\_options['get\_shipping'] = 'no'; |
  | 598 | 609 | } |
  | 599 |  |  |
  | 600 |  | if~~( isset( $wcfm\_settings\_form['vendor\_get\_tax'] )~~ ) { |
  |  | 610 |  |
  |  | 611 | if (isset($wcfm\_settings\_form['vendor\_get\_tax'])) { |
  | 601 | 612 | $wcfm\_commission\_options['get\_tax'] = 'yes'; |
  | 602 | 613 | } else { |
  | 603 | 614 | $wcfm\_commission\_options['get\_tax'] = 'no'; |
  | 604 | 615 | } |
  | 605 |  |  |
  | 606 |  | if~~( isset( $wcfm\_settings\_form['vendor\_coupon\_deduct'] )~~ ) { |
  |  | 616 |  |
  |  | 617 | if (isset($wcfm\_settings\_form['vendor\_coupon\_deduct'])) { |
  | 607 | 618 | $wcfm\_commission\_options['coupon\_deduct'] = 'yes'; |
  | 608 | 619 | } else { |
  | 609 | 620 | $wcfm\_commission\_options['coupon\_deduct'] = 'no'; |
  | 610 | 621 | } |
  | 611 |  |  |
  | 612 |  | if~~( isset( $wcfm\_settings\_form['admin\_coupon\_deduct'] )~~ ) { |
  |  | 622 |  |
  |  | 623 | if (isset($wcfm\_settings\_form['admin\_coupon\_deduct'])) { |
  | 613 | 624 | $wcfm\_commission\_options['admin\_coupon\_deduct'] = 'yes'; |
  | 614 | 625 | } else { |
  | 615 | 626 | $wcfm\_commission\_options['admin\_coupon\_deduct'] = 'no'; |
  | 616 | 627 | } |
  | 617 |  |  |
  | 618 |  | if~~( isset( $wcfm\_settings\_form['tax\_enable'] )~~ ) { |
  |  | 628 |  |
  |  | 629 | if (isset($wcfm\_settings\_form['tax\_enable'])) { |
  | 619 | 630 | $wcfm\_commission\_options['tax\_enable'] = 'yes'; |
  | 620 | 631 | } else { |
  | 621 | 632 | $wcfm\_commission\_options['tax\_enable'] = 'no'; |
  | 622 | 633 | } |
  | 623 |  |  |
  | 624 |  | if~~( isset( $wcfm\_settings\_form['tax\_name'] )~~ ) { |
  |  | 634 |  |
  |  | 635 | if (isset($wcfm\_settings\_form['tax\_name'])) { |
  | 625 | 636 | $wcfm\_commission\_options['tax\_name'] = $wcfm\_settings\_form['tax\_name']; |
  | 626 | 637 | } |
  | 627 |  |  |
  | 628 |  | if~~( isset( $wcfm\_settings\_form['tax\_percent'] )~~ ) { |
  |  | 638 |  |
  |  | 639 | if (isset($wcfm\_settings\_form['tax\_percent'])) { |
  | 629 | 640 | $wcfm\_commission\_options['tax\_percent'] = $wcfm\_settings\_form['tax\_percent']; |
  | 630 | 641 | } |
  | 631 |  |  |
  | 632 |  |  |
  | 633 |  | update\_option(~~'wcfm\_commission\_options', $wcfm\_commission\_options~~ ); |
  | 634 |  | } |
  | 635 |  |  |
  | 636 |  | function wcfm\_withdrawal\_settings(~~$wcfm\_options~~ ) { |
  |  | 642 |  |
  |  | 643 |  |
  |  | 644 | update\_option('wcfm\_commission\_options', $wcfm\_commission\_options); |
  |  | 645 | } |
  |  | 646 |  |
  |  | 647 | function wcfm\_withdrawal\_settings($wcfm\_options) { |
  | 637 | 648 | global $WCFM, $WCFMmp; |
  | 638 |  |  |
  | 639 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_withdrawal\_manage', true ) ) return;~~ |
  | 640 |  |  |
  | 641 |  | $wcfm\_withdrawal\_options = get\_option(~~'wcfm\_withdrawal\_options', array()~~ ); |
  | 642 |  |  |
  |  | 649 |  |
  |  | 650 | if (!apply\_filters('wcfm\_is\_allow\_withdrawal\_manage', true)) return; |
  |  | 651 |  |
  |  | 652 | $wcfm\_withdrawal\_options = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 653 |  |
  | 643 | 654 | $wcfm\_marketplace\_withdrwal\_payment\_methods = get\_wcfm\_marketplace\_withdrwal\_payment\_methods(); |
  | 644 | 655 | $wcfm\_marketplace\_withdrawal\_order\_status   = get\_wcfm\_marketplace\_withdrwal\_order\_status(); |
  | 645 | 656 | $wcfm\_marketplace\_disallow\_order\_payment\_methods = get\_wcfm\_marketplace\_disallow\_order\_payment\_methods(); |
  | 646 |  |  |
  | 647 |  | $request\_auto\_approve                 = isset(~~$wcfm\_withdrawal\_options['request\_auto\_approve']~~ ) ? $wcfm\_withdrawal\_options['request\_auto\_approve'] : 'no'; |
  | 648 |  |  |
  | 649 |  | $generate\_auto\_withdrawal             = isset(~~$wcfm\_withdrawal\_options['generate\_auto\_withdrawal']~~ ) ? $wcfm\_withdrawal\_options['generate\_auto\_withdrawal'] : 'no'; |
  | 650 |  | $auto\_withdrawal\_status               = isset(~~$wcfm\_withdrawal\_options['auto\_withdrawal\_status']~~ ) ? $wcfm\_withdrawal\_options['auto\_withdrawal\_status'] : 'wc-processing'; |
  | 651 |  |  |
  | 652 |  | $order\_status                         = isset(~~$wcfm\_withdrawal\_options['order\_status'] ) ? $wcfm\_withdrawal\_options['order\_status'] : array( 'wc-completed', 'wc-processing'~~ ); |
  | 653 |  |  |
  | 654 |  | $withdrawal\_schedule                  = isset(~~$wcfm\_withdrawal\_options['withdrawal\_schedule']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  | 655 |  |  |
  | 656 |  | $withdrawal\_limit                     = isset(~~$wcfm\_withdrawal\_options['withdrawal\_limit']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_limit'] : ''; |
  | 657 |  | $withdrawal\_thresold                  = isset(~~$wcfm\_withdrawal\_options['withdrawal\_thresold']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_thresold'] : ''; |
  | 658 |  |  |
  | 659 |  | if~~( isset( $wcfm\_withdrawal\_options['withdrawal\_mode'] )~~ ) { |
  | 660 |  | $withdrawal\_mode                    = isset(~~$wcfm\_withdrawal\_options['withdrawal\_mode']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  | 661 |  | } elseif~~( $generate\_auto\_withdrawal == 'yes'~~ ) { |
  |  | 657 |  |
  |  | 658 | $request\_auto\_approve                 = isset($wcfm\_withdrawal\_options['request\_auto\_approve']) ? $wcfm\_withdrawal\_options['request\_auto\_approve'] : 'no'; |
  |  | 659 |  |
  |  | 660 | $generate\_auto\_withdrawal             = isset($wcfm\_withdrawal\_options['generate\_auto\_withdrawal']) ? $wcfm\_withdrawal\_options['generate\_auto\_withdrawal'] : 'no'; |
  |  | 661 | $auto\_withdrawal\_status               = isset($wcfm\_withdrawal\_options['auto\_withdrawal\_status']) ? $wcfm\_withdrawal\_options['auto\_withdrawal\_status'] : 'wc-processing'; |
  |  | 662 |  |
  |  | 663 | $order\_status                         = isset($wcfm\_withdrawal\_options['order\_status']) ? $wcfm\_withdrawal\_options['order\_status'] : array('wc-completed', 'wc-processing'); |
  |  | 664 |  |
  |  | 665 | $withdrawal\_schedule                  = isset($wcfm\_withdrawal\_options['withdrawal\_schedule']) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  |  | 666 |  |
  |  | 667 | $withdrawal\_limit                     = isset($wcfm\_withdrawal\_options['withdrawal\_limit']) ? $wcfm\_withdrawal\_options['withdrawal\_limit'] : ''; |
  |  | 668 | $withdrawal\_thresold                  = isset($wcfm\_withdrawal\_options['withdrawal\_thresold']) ? $wcfm\_withdrawal\_options['withdrawal\_thresold'] : ''; |
  |  | 669 |  |
  |  | 670 | if (isset($wcfm\_withdrawal\_options['withdrawal\_mode'])) { |
  |  | 671 | $withdrawal\_mode                    = isset($wcfm\_withdrawal\_options['withdrawal\_mode']) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  |  | 672 | } elseif ($generate\_auto\_withdrawal == 'yes') { |
  | 662 | 673 | $withdrawal\_mode                      = 'by\_order\_status'; |
  | 663 | 674 | } else { |
  | 664 | 675 | $withdrawal\_mode                      = 'by\_manual'; |
  | 665 | 676 | } |
  | 666 |  |  |
  |  | 677 |  |
  | 667 | 678 | $disallow\_order\_payment\_methods       = get\_wcfm\_marketplace\_disallow\_active\_order\_payment\_methods(); //isset( $wcfm\_withdrawal\_options['disallow\_order\_payment\_methods'] ) ? $wcfm\_withdrawal\_options['disallow\_order\_payment\_methods'] : array(); |
  | 668 |  | $withdrawal\_reverse                   = isset(~~$wcfm\_withdrawal\_options['withdrawal\_reverse']~~ ) ? 'yes' : 'no'; |
  | 669 |  | $withdrawal\_reverse\_limit             = isset(~~$wcfm\_withdrawal\_options['withdrawal\_reverse\_limit']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_reverse\_limit'] : ''; |
  | 670 |  |  |
  | 671 |  | if~~( !empty( $disallow\_order\_payment\_methods ) ) $disallow\_order\_payment\_methods = array\_keys( $disallow\_order\_payment\_methods~~ ); |
  | 672 |  |  |
  |  | 679 | $withdrawal\_reverse                   = isset($wcfm\_withdrawal\_options['withdrawal\_reverse']) ? 'yes' : 'no'; |
  |  | 680 | $withdrawal\_reverse\_limit             = isset($wcfm\_withdrawal\_options['withdrawal\_reverse\_limit']) ? $wcfm\_withdrawal\_options['withdrawal\_reverse\_limit'] : ''; |
  |  | 681 |  |
  |  | 682 | if (!empty($disallow\_order\_payment\_methods)) $disallow\_order\_payment\_methods = array\_keys($disallow\_order\_payment\_methods); |
  |  | 683 |  |
  | 673 | 684 | ?> |
  | 674 | 685 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L679) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L690) |  |
  | 679 | 690 | <div class="wcfm-container"> |
  | 680 | 691 | <div id="wcfm\_settings\_form\_withdrawal\_expander" class="wcfm-content"> |
  | 681 |  | <h2><?php \_e('Marketplace Withdrawal Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 682 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-withdrawal/'~~ ); ?> |
  |  | 692 | <h2><?php \_e('Marketplace Withdrawal Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 693 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-withdrawal/'); ?> |
  | 683 | 694 | <div class="wcfm\_clearfix"></div> |
  | 684 | 695 | <div class="store\_address"> |
  | 685 | 696 | <?php |
  | 686 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_withdrawal', array( |
  | 687 |  | ~~"withdrawal\_request\_auto\_approve"     => array('label' => \_\_('Request auto-approve?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[request\_auto\_approve]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $request\_auto\_approve, 'desc\_class' => 'instructions', 'desc' => \_\_( 'Check this to automatically disburse payments to vendors on request, no admin approval required. Auto disbursement only works for auto-payment gateways, e.g. PayPal, Stripe etc. Bank Transfer or other non-autopay mode always requires approval, as these are manual transactions.', 'wc-multivendor-marketplace' )~~ ), |
  | 688 |  |  |
  | 689 |  | ~~"withdrawal\_mode"   => array( 'label' => \_\_( 'Withdrawal Mode', 'wc-multivendor-marketplace' ), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_mode]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele withdrawal\_mode', 'label\_class' => 'wcfm\_title withdrawal\_mode', 'options' => apply\_filters( 'wcfm\_withdrawal\_modes', array( 'by\_manual' => \_\_( 'Manual Withdrawal', 'wc-multivendor-marketplace' ), 'by\_schedule' => \_\_( 'Periodic Withdrawal', 'wc-multivendor-marketplace' ), 'by\_order\_status' => \_\_( 'By Order Status', 'wc-multivendor-marketplace' ) ) ), 'value' => $withdrawal\_mode~~ ), |
  | 690 |  |  |
  | 691 |  | //"withdrawal\_generate\_auto\_withdrawal" => array('label' => \_\_('Generate auto-withdrawal?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[generate\_auto\_withdrawal]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $generate\_auto\_withdrawal, 'desc\_class' => 'instructions', 'desc' => \_\_( 'Check this to generate withdrawal request automatically when order status reach at certain status.', 'wc-multivendor-marketplace' ) ), |
  | 692 |  | ~~"withdrawal\_auto\_withdrawal\_status"   => array( 'label' => \_\_( 'Order Status', 'wc-multivendor-marketplace' ), 'name' => 'wcfm\_withdrawal\_options[auto\_withdrawal\_status]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele auto\_withdrawal\_order\_status', 'label\_class' => 'wcfm\_title auto\_withdrawal\_order\_status', 'options' => $wcfm\_marketplace\_withdrawal\_order\_status, 'value' => $auto\_withdrawal\_status, 'desc\_class' => 'wcfm\_page\_options\_desc auto\_withdrawal\_order\_status', 'desc' => \_\_( 'Order status for generate withdrawal request automatically.', 'wc-multivendor-marketplace' ),~~ ), |
  | 693 |  |  |
  | 694 |  | ~~"withdrawal\_schedule"   => array( 'label' => \_\_( 'Schedule Interval', 'wc-multivendor-marketplace' ), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_schedule]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele schedule\_withdrawal\_threshold\_ele', 'label\_class' => 'wcfm\_title schedule\_withdrawal\_threshold\_ele', 'options' => apply\_filters( 'wcfm\_withdrawal\_schedule\_periods', array( 'day' => \_\_( 'Every Day', 'wc-multivendor-marketplace' ), 'week' => \_\_( 'Every 7 Days (Every Week - Monday)', 'wc-multivendor-marketplace' ), '2weeks' => \_\_( 'Every 15 Days (Every 2 Weeks - Monday)', 'wc-multivendor-marketplace' ), 'month' => \_\_( 'Every 30 Days (Every Month - 1st)', 'wc-multivendor-marketplace' ), '2months' => \_\_( 'Every 60 Days (Every 2 Months - 1st)', 'wc-multivendor-marketplace' ), 'quarter' => \_\_( 'Every 90 Days (Every 3 Months - 1st)', 'wc-multivendor-marketplace' ) ) ), 'value' => $withdrawal\_schedule~~ ), |
  | 695 |  |  |
  | 696 |  | ~~"withdrawal\_order\_status"             => array( 'label' => \_\_( 'Allowed Order Status for Withdrawal', 'wc-multivendor-marketplace' ), 'name' => 'wcfm\_withdrawal\_options[order\_status]', 'type' => 'checklist', 'wrapper\_class' => 'manual\_withdrawal\_ele', 'class' => 'wcfm-checkbox wcfm\_ele payment\_options', 'label\_class' => 'wcfm\_title wcfm\_full\_title manual\_withdrawal\_ele', 'options' => $wcfm\_marketplace\_withdrawal\_order\_status, 'value' => $order\_status, 'desc\_class' => 'instructions manual\_withdrawal\_ele', 'desc' => \_\_( 'Allowed order statuses for which vendor may request for withdrawal.', 'wc-multivendor-marketplace' )~~ ), |
  | 697 |  | ~~), $wcfm\_withdrawal\_options )~~ ); |
  | 698 |  |  |
  | 699 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_withdrawal\_rules', array( |
  | 700 |  | ~~"withdrawal\_limit" => array('label' => \_\_('Minimum Withdraw Limit', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_limit]', 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele withdrawal\_threshold\_ele', 'label\_class' => 'wcfm\_title withdrawal\_threshold\_ele', 'desc\_class'=> 'wcfm\_page\_options\_desc withdrawal\_threshold\_ele', 'value' => $withdrawal\_limit, 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'desc' => \_\_( 'Minimum balance required to make a withdraw request. Leave blank to set no minimum limits.', 'wc-multivendor-marketplace')~~ ), |
  | 701 |  | ~~"withdrawal\_thresold" => array('label' => \_\_('Withdraw Threshold', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_thresold]', 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele withdrawal\_threshold\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele withdrawal\_threshold\_ele', 'value' => $withdrawal\_thresold, 'desc\_class' => 'wcfm\_page\_options\_desc withdrawal\_threshold\_ele', 'attributes' => array( 'min' => '1', 'step' => '1'), 'desc' => \_\_('Withdraw Threshold Days, (Make order matured to make a withdraw request). Leave empty to inactive this option.', 'wc-multivendor-marketplace')~~ ), |
  | 702 |  | ~~), $wcfm\_withdrawal\_options )~~ ); |
  |  | 697 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_withdrawal', array( |
  |  | 698 | "withdrawal\_request\_auto\_approve"     => array('label' => \_\_('Request auto-approve?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[request\_auto\_approve]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $request\_auto\_approve, 'desc\_class' => 'instructions', 'desc' => \_\_('Check this to automatically disburse payments to vendors on request, no admin approval required. Auto disbursement only works for auto-payment gateways, e.g. PayPal, Stripe etc. Bank Transfer or other non-autopay mode always requires approval, as these are manual transactions.', 'wc-multivendor-marketplace')), |
  |  | 699 |  |
  |  | 700 | "withdrawal\_mode"   => array('label' => \_\_('Withdrawal Mode', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_mode]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele withdrawal\_mode', 'label\_class' => 'wcfm\_title withdrawal\_mode', 'options' => apply\_filters('wcfm\_withdrawal\_modes', array('by\_manual' => \_\_('Manual Withdrawal', 'wc-multivendor-marketplace'), 'by\_schedule' => \_\_('Periodic Withdrawal', 'wc-multivendor-marketplace'), 'by\_order\_status' => \_\_('By Order Status', 'wc-multivendor-marketplace'))), 'value' => $withdrawal\_mode), |
  |  | 701 |  |
  |  | 702 | //"withdrawal\_generate\_auto\_withdrawal" => array('label' => \_\_('Generate auto-withdrawal?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[generate\_auto\_withdrawal]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $generate\_auto\_withdrawal, 'desc\_class' => 'instructions', 'desc' => \_\_( 'Check this to generate withdrawal request automatically when order status reach at certain status.', 'wc-multivendor-marketplace' ) ), |
  |  | 703 | "withdrawal\_auto\_withdrawal\_status"   => array('label' => \_\_('Order Status', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[auto\_withdrawal\_status]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele auto\_withdrawal\_order\_status', 'label\_class' => 'wcfm\_title auto\_withdrawal\_order\_status', 'options' => $wcfm\_marketplace\_withdrawal\_order\_status, 'value' => $auto\_withdrawal\_status, 'desc\_class' => 'wcfm\_page\_options\_desc auto\_withdrawal\_order\_status', 'desc' => \_\_('Order status for generate withdrawal request automatically.', 'wc-multivendor-marketplace'),), |
  |  | 704 |  |
  |  | 705 | "withdrawal\_schedule"   => array('label' => \_\_('Schedule Interval', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_schedule]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele schedule\_withdrawal\_threshold\_ele', 'label\_class' => 'wcfm\_title schedule\_withdrawal\_threshold\_ele', 'options' => apply\_filters('wcfm\_withdrawal\_schedule\_periods', array('day' => \_\_('Every Day', 'wc-multivendor-marketplace'), 'week' => \_\_('Every 7 Days (Every Week - Monday)', 'wc-multivendor-marketplace'), '2weeks' => \_\_('Every 15 Days (Every 2 Weeks - Monday)', 'wc-multivendor-marketplace'), 'month' => \_\_('Every 30 Days (Every Month - 1st)', 'wc-multivendor-marketplace'), '2months' => \_\_('Every 60 Days (Every 2 Months - 1st)', 'wc-multivendor-marketplace'), 'quarter' => \_\_('Every 90 Days (Every 3 Months - 1st)', 'wc-multivendor-marketplace'))), 'value' => $withdrawal\_schedule), |
  |  | 706 |  |
  |  | 707 | "withdrawal\_order\_status"             => array('label' => \_\_('Allowed Order Status for Withdrawal', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[order\_status]', 'type' => 'checklist', 'wrapper\_class' => 'manual\_withdrawal\_ele', 'class' => 'wcfm-checkbox wcfm\_ele payment\_options', 'label\_class' => 'wcfm\_title wcfm\_full\_title manual\_withdrawal\_ele', 'options' => $wcfm\_marketplace\_withdrawal\_order\_status, 'value' => $order\_status, 'desc\_class' => 'instructions manual\_withdrawal\_ele', 'desc' => \_\_('Allowed order statuses for which vendor may request for withdrawal.', 'wc-multivendor-marketplace')), |
  |  | 708 | ), $wcfm\_withdrawal\_options)); |
  |  | 709 |  |
  |  | 710 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_withdrawal\_rules', array( |
  |  | 711 | "withdrawal\_limit" => array('label' => \_\_('Minimum Withdraw Limit', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_limit]', 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele withdrawal\_threshold\_ele', 'label\_class' => 'wcfm\_title withdrawal\_threshold\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc withdrawal\_threshold\_ele', 'value' => $withdrawal\_limit, 'attributes' => array('min' => '0.1', 'step' => '0.1'), 'desc' => \_\_('Minimum balance required to make a withdraw request. Leave blank to set no minimum limits.', 'wc-multivendor-marketplace')), |
  |  | 712 | "withdrawal\_thresold" => array('label' => \_\_('Withdraw Threshold', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_thresold]', 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele withdrawal\_threshold\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele withdrawal\_threshold\_ele', 'value' => $withdrawal\_thresold, 'desc\_class' => 'wcfm\_page\_options\_desc withdrawal\_threshold\_ele', 'attributes' => array('min' => '1', 'step' => '1'), 'desc' => \_\_('Withdraw Threshold Days, (Make order matured to make a withdraw request). Leave empty to inactive this option.', 'wc-multivendor-marketplace')), |
  |  | 713 | ), $wcfm\_withdrawal\_options)); |
  | 703 | 714 | ?> |
  | 704 | 715 | </div> |
  | 705 |  |  |
  | 706 |  | <div class="wcfm\_clearfix"></div><br/> |
  |  | 716 |  |
  |  | 717 | <div class="wcfm\_clearfix"></div><br /> |
  | 707 | 718 | <h2><?php \_e('Marketplace Reverse Withdrawal Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 708 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-reverse-withdrawal/'~~ ); ?> |
  |  | 719 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-reverse-withdrawal/'); ?> |
  | 709 | 720 | <div class="wcfm\_clearfix"></div> |
  | 710 | 721 | <div class="store\_address"> |
  | 711 | 722 | <?php |
  | 712 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_reverse\_withdrawal', array( |
  | 713 |  | ~~"withdrawal\_reverse" => array('label' => \_\_('Reverse Withdrawal', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_reverse]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $withdrawal\_reverse, 'desc\_class' => 'instructions', 'desc' => \_\_( 'Enable this to keep track reverse withdrawals. In case vendor receive full payment (e.g. COD) from customer then they have to reverse-pay admin commission. This is only applicable for reverse-withdrawal payment methods.', 'wc-multivendor-marketplace' )~~ ), |
  | 714 |  | ~~"withdrawal\_order\_payment\_methods" => array( 'label' => \_\_( 'Reverse or No Withdrawal Payment Methods', 'wc-multivendor-marketplace' ), 'name' => 'wcfm\_withdrawal\_options[disallow\_order\_payment\_methods]', 'type' => 'checklist', 'wrapper\_class' => 'reverse\_withdrawal\_ele', 'class' => 'wcfm-checkbox wcfm\_ele reverse\_withdrawal\_ele', 'label\_class' => 'wcfm\_title wcfm\_full\_title reverse\_withdrawal\_ele', 'options' => $wcfm\_marketplace\_disallow\_order\_payment\_methods, 'value' => $disallow\_order\_payment\_methods, 'desc\_class' => 'reverse\_withdrawal\_ele', 'desc' => \_\_( 'Order Payment Methods which are not applicable for vendor withdrawal request. e.g Order payment method COD and vendor receiving that amount directly from customers. So, no more require withdrawal request. You may also enable Reverse Withdrawal to track reverse pending payments for such payment options.', 'wc-multivendor-marketplace' )~~ ), |
  | 715 |  | ~~"withdrawal\_setting\_break\_3" => array( 'type' => 'html', 'class' => "reverse\_withdrawal\_ele", 'value' => '<div style="height: 15px;"></div>'~~ ), |
  | 716 |  |  |
  | 717 |  | ~~"withdrawal\_reverse\_limit" => array('label' => \_\_('Reverse Withdraw Limit', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_reverse\_limit]', 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele reverse\_withdrawal\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele reverse\_withdrawal\_ele', 'value' => $withdrawal\_reverse\_limit, 'desc\_class' => 'instructions reverse\_withdrawal\_ele', 'attributes' => array( 'min' => '1', 'step' => '1'), 'desc' => \_\_('Set reverse withdrawal threshold limit, if reverse-pay balance reach this limit then vendor will not allow to withdrawal anymore. Leave empty to inactive this option.', 'wc-multivendor-marketplace')~~ ), |
  | 718 |  | ~~), $wcfm\_withdrawal\_options )~~ ); |
  |  | 723 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_reverse\_withdrawal', array( |
  |  | 724 | "withdrawal\_reverse" => array('label' => \_\_('Reverse Withdrawal', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_reverse]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $withdrawal\_reverse, 'desc\_class' => 'instructions', 'desc' => \_\_('Enable this to keep track reverse withdrawals. In case vendor receive full payment (e.g. COD) from customer then they have to reverse-pay admin commission. This is only applicable for reverse-withdrawal payment methods.', 'wc-multivendor-marketplace')), |
  |  | 725 | "withdrawal\_order\_payment\_methods" => array('label' => \_\_('Reverse or No Withdrawal Payment Methods', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[disallow\_order\_payment\_methods]', 'type' => 'checklist', 'wrapper\_class' => 'reverse\_withdrawal\_ele', 'class' => 'wcfm-checkbox wcfm\_ele reverse\_withdrawal\_ele', 'label\_class' => 'wcfm\_title wcfm\_full\_title reverse\_withdrawal\_ele', 'options' => $wcfm\_marketplace\_disallow\_order\_payment\_methods, 'value' => $disallow\_order\_payment\_methods, 'desc\_class' => 'reverse\_withdrawal\_ele', 'desc' => \_\_('Order Payment Methods which are not applicable for vendor withdrawal request. e.g Order payment method COD and vendor receiving that amount directly from customers. So, no more require withdrawal request. You may also enable Reverse Withdrawal to track reverse pending payments for such payment options.', 'wc-multivendor-marketplace')), |
  |  | 726 | "withdrawal\_setting\_break\_3" => array('type' => 'html', 'class' => "reverse\_withdrawal\_ele", 'value' => '<div style="height: 15px;"></div>'), |
  |  | 727 |  |
  |  | 728 | "withdrawal\_reverse\_limit" => array('label' => \_\_('Reverse Withdraw Limit', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_reverse\_limit]', 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele reverse\_withdrawal\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele reverse\_withdrawal\_ele', 'value' => $withdrawal\_reverse\_limit, 'desc\_class' => 'instructions reverse\_withdrawal\_ele', 'attributes' => array('min' => '1', 'step' => '1'), 'desc' => \_\_('Set reverse withdrawal threshold limit, if reverse-pay balance reach this limit then vendor will not allow to withdrawal anymore. Leave empty to inactive this option.', 'wc-multivendor-marketplace')), |
  |  | 729 | ), $wcfm\_withdrawal\_options)); |
  | 719 | 730 | ?> |
  | 720 | 731 | </div> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L723) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L734) |  |
  | 723 | 734 | <div class="wcfm\_clearfix"></div> |
  | 724 | 735 | <!-- end collapsible --> |
  | 725 |  |  |
  |  | 736 |  |
  | 726 | 737 | <?php |
  | 727 |  |  |
  | 728 |  | } |
  | 729 |  |  |
  | 730 |  | function wcfm\_payment\_settings(~~$wcfm\_options~~ ) { |
  |  | 738 |  |
  |  | 739 | } |
  |  | 740 |  |
  |  | 741 | function wcfm\_payment\_settings($wcfm\_options) { |
  | 731 | 742 | global $WCFM, $WCFMmp; |
  | 732 |  |  |
  | 733 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_withdrawal\_manage', true ) ) return;~~ |
  | 734 |  |  |
  | 735 |  | $wcfm\_withdrawal\_options = get\_option(~~'wcfm\_withdrawal\_options', array()~~ ); |
  | 736 |  |  |
  |  | 743 |  |
  |  | 744 | if (!apply\_filters('wcfm\_is\_allow\_withdrawal\_manage', true)) return; |
  |  | 745 |  |
  |  | 746 | $wcfm\_withdrawal\_options = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 747 |  |
  | 737 | 748 | $wcfm\_marketplace\_withdrwal\_payment\_methods = get\_wcfm\_marketplace\_withdrwal\_payment\_methods(); |
  | 738 |  |  |
  | 739 |  | $payment\_methods                      = isset(~~$wcfm\_withdrawal\_options['payment\_methods'] ) ? $wcfm\_withdrawal\_options['payment\_methods'] : array( 'paypal', 'bank\_transfer'~~ ); |
  | 740 |  | $withdrawal\_test\_mode                 = isset(~~$wcfm\_withdrawal\_options['test\_mode']~~ ) ? 'yes' : 'no'; |
  | 741 |  |  |
  | 742 |  | $withdrawal\_paypal\_client\_id          = isset(~~$wcfm\_withdrawal\_options['paypal\_client\_id']~~ ) ? $wcfm\_withdrawal\_options['paypal\_client\_id'] : ''; |
  | 743 |  | $withdrawal\_paypal\_secret\_key         = isset(~~$wcfm\_withdrawal\_options['paypal\_secret\_key']~~ ) ? $wcfm\_withdrawal\_options['paypal\_secret\_key'] : ''; |
  | 744 |  | $withdrawal\_stripe\_client\_id          = isset(~~$wcfm\_withdrawal\_options['stripe\_client\_id']~~ ) ? $wcfm\_withdrawal\_options['stripe\_client\_id'] : ''; |
  | 745 |  | $withdrawal\_stripe\_published\_key      = isset(~~$wcfm\_withdrawal\_options['stripe\_published\_key']~~ ) ? $wcfm\_withdrawal\_options['stripe\_published\_key'] : ''; |
  | 746 |  | $withdrawal\_stripe\_secret\_key         = isset(~~$wcfm\_withdrawal\_options['stripe\_secret\_key']~~ ) ? $wcfm\_withdrawal\_options['stripe\_secret\_key'] : ''; |
  | 747 |  | $withdrawal\_wirecard\_token            = isset(~~$wcfm\_withdrawal\_options['wirecard\_token']~~ ) ? $wcfm\_withdrawal\_options['wirecard\_token'] : ''; |
  | 748 |  | $withdrawal\_wirecard\_key              = isset(~~$wcfm\_withdrawal\_options['wirecard\_key']~~ ) ? $wcfm\_withdrawal\_options['wirecard\_key'] : ''; |
  | 749 |  | $withdrawal\_wirecard\_public\_key       = isset(~~$wcfm\_withdrawal\_options['wirecard\_public\_key']~~ ) ? $wcfm\_withdrawal\_options['wirecard\_public\_key'] : ''; |
  | 750 |  |  |
  | 751 |  | $withdrawal\_paypal\_test\_client\_id     = isset(~~$wcfm\_withdrawal\_options['paypal\_test\_client\_id']~~ ) ? $wcfm\_withdrawal\_options['paypal\_test\_client\_id'] : ''; |
  | 752 |  | $withdrawal\_paypal\_test\_secret\_key    = isset(~~$wcfm\_withdrawal\_options['paypal\_test\_secret\_key']~~ ) ? $wcfm\_withdrawal\_options['paypal\_test\_secret\_key'] : ''; |
  | 753 |  | $withdrawal\_stripe\_test\_client\_id     = isset(~~$wcfm\_withdrawal\_options['stripe\_test\_client\_id']~~ ) ? $wcfm\_withdrawal\_options['stripe\_test\_client\_id'] : ''; |
  | 754 |  | $withdrawal\_stripe\_test\_published\_key = isset(~~$wcfm\_withdrawal\_options['stripe\_test\_published\_key']~~ ) ? $wcfm\_withdrawal\_options['stripe\_test\_published\_key'] : ''; |
  | 755 |  | $withdrawal\_stripe\_test\_secret\_key    = isset(~~$wcfm\_withdrawal\_options['stripe\_test\_secret\_key']~~ ) ? $wcfm\_withdrawal\_options['stripe\_test\_secret\_key'] : ''; |
  | 756 |  | $withdrawal\_wirecard\_test\_token       = isset(~~$wcfm\_withdrawal\_options['wirecard\_test\_token']~~ ) ? $wcfm\_withdrawal\_options['wirecard\_test\_token'] : ''; |
  | 757 |  | $withdrawal\_wirecard\_test\_key         = isset(~~$wcfm\_withdrawal\_options['wirecard\_test\_key']~~ ) ? $wcfm\_withdrawal\_options['wirecard\_test\_key'] : ''; |
  | 758 |  | $withdrawal\_wirecard\_test\_public\_key  = isset(~~$wcfm\_withdrawal\_options['wirecard\_test\_public\_key']~~ ) ? $wcfm\_withdrawal\_options['wirecard\_test\_public\_key'] : ''; |
  | 759 |  |  |
  | 760 |  | $withdrawal\_stripe\_is\_3d\_secure       = isset(~~$wcfm\_withdrawal\_options['stripe\_3d\_secure']~~ ) ? 'yes' : 'no'; |
  | 761 |  | $withdrawal\_stripe\_split\_pay\_mode     = isset(~~$wcfm\_withdrawal\_options['stripe\_split\_pay\_mode']~~ ) ? $wcfm\_withdrawal\_options['stripe\_split\_pay\_mode'] : 'direct\_charges'; |
  | 762 |  |  |
  | 763 |  | $withdrawal\_charge\_type               = isset(~~$wcfm\_withdrawal\_options['withdrawal\_charge\_type']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_charge\_type'] : 'no'; |
  | 764 |  |  |
  | 765 |  | $withdrawal\_charge                    = isset(~~$wcfm\_withdrawal\_options['withdrawal\_charge']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_charge'] : array(); |
  | 766 |  | $withdrawal\_charge\_paypal             = isset(~~$withdrawal\_charge['paypal']~~ ) ? $withdrawal\_charge['paypal'] : array(); |
  | 767 |  | $withdrawal\_charge\_stripe             = isset(~~$withdrawal\_charge['stripe']~~ ) ? $withdrawal\_charge['stripe'] : array(); |
  | 768 |  | $withdrawal\_charge\_skrill             = isset(~~$withdrawal\_charge['skrill']~~ ) ? $withdrawal\_charge['skrill'] : array(); |
  | 769 |  | $withdrawal\_charge\_bank\_transfer      = isset(~~$withdrawal\_charge['bank\_transfer']~~ ) ? $withdrawal\_charge['bank\_transfer'] : array(); |
  | 770 |  |  |
  |  | 749 |  |
  |  | 750 | $payment\_methods                      = isset($wcfm\_withdrawal\_options['payment\_methods']) ? $wcfm\_withdrawal\_options['payment\_methods'] : array('paypal', 'bank\_transfer'); |
  |  | 751 | $withdrawal\_test\_mode                 = isset($wcfm\_withdrawal\_options['test\_mode']) ? 'yes' : 'no'; |
  |  | 752 |  |
  |  | 753 | $withdrawal\_paypal\_client\_id          = isset($wcfm\_withdrawal\_options['paypal\_client\_id']) ? $wcfm\_withdrawal\_options['paypal\_client\_id'] : ''; |
  |  | 754 | $withdrawal\_paypal\_secret\_key         = isset($wcfm\_withdrawal\_options['paypal\_secret\_key']) ? $wcfm\_withdrawal\_options['paypal\_secret\_key'] : ''; |
  |  | 755 | $withdrawal\_stripe\_client\_id          = isset($wcfm\_withdrawal\_options['stripe\_client\_id']) ? $wcfm\_withdrawal\_options['stripe\_client\_id'] : ''; |
  |  | 756 | $withdrawal\_stripe\_published\_key      = isset($wcfm\_withdrawal\_options['stripe\_published\_key']) ? $wcfm\_withdrawal\_options['stripe\_published\_key'] : ''; |
  |  | 757 | $withdrawal\_stripe\_secret\_key         = isset($wcfm\_withdrawal\_options['stripe\_secret\_key']) ? $wcfm\_withdrawal\_options['stripe\_secret\_key'] : ''; |
  |  | 758 | $withdrawal\_wirecard\_token            = isset($wcfm\_withdrawal\_options['wirecard\_token']) ? $wcfm\_withdrawal\_options['wirecard\_token'] : ''; |
  |  | 759 | $withdrawal\_wirecard\_key              = isset($wcfm\_withdrawal\_options['wirecard\_key']) ? $wcfm\_withdrawal\_options['wirecard\_key'] : ''; |
  |  | 760 | $withdrawal\_wirecard\_public\_key       = isset($wcfm\_withdrawal\_options['wirecard\_public\_key']) ? $wcfm\_withdrawal\_options['wirecard\_public\_key'] : ''; |
  |  | 761 |  |
  |  | 762 | $withdrawal\_paypal\_test\_client\_id     = isset($wcfm\_withdrawal\_options['paypal\_test\_client\_id']) ? $wcfm\_withdrawal\_options['paypal\_test\_client\_id'] : ''; |
  |  | 763 | $withdrawal\_paypal\_test\_secret\_key    = isset($wcfm\_withdrawal\_options['paypal\_test\_secret\_key']) ? $wcfm\_withdrawal\_options['paypal\_test\_secret\_key'] : ''; |
  |  | 764 | $withdrawal\_stripe\_test\_client\_id     = isset($wcfm\_withdrawal\_options['stripe\_test\_client\_id']) ? $wcfm\_withdrawal\_options['stripe\_test\_client\_id'] : ''; |
  |  | 765 | $withdrawal\_stripe\_test\_published\_key = isset($wcfm\_withdrawal\_options['stripe\_test\_published\_key']) ? $wcfm\_withdrawal\_options['stripe\_test\_published\_key'] : ''; |
  |  | 766 | $withdrawal\_stripe\_test\_secret\_key    = isset($wcfm\_withdrawal\_options['stripe\_test\_secret\_key']) ? $wcfm\_withdrawal\_options['stripe\_test\_secret\_key'] : ''; |
  |  | 767 | $withdrawal\_wirecard\_test\_token       = isset($wcfm\_withdrawal\_options['wirecard\_test\_token']) ? $wcfm\_withdrawal\_options['wirecard\_test\_token'] : ''; |
  |  | 768 | $withdrawal\_wirecard\_test\_key         = isset($wcfm\_withdrawal\_options['wirecard\_test\_key']) ? $wcfm\_withdrawal\_options['wirecard\_test\_key'] : ''; |
  |  | 769 | $withdrawal\_wirecard\_test\_public\_key  = isset($wcfm\_withdrawal\_options['wirecard\_test\_public\_key']) ? $wcfm\_withdrawal\_options['wirecard\_test\_public\_key'] : ''; |
  |  | 770 |  |
  |  | 771 | $withdrawal\_stripe\_is\_3d\_secure       = isset($wcfm\_withdrawal\_options['stripe\_3d\_secure']) ? 'yes' : 'no'; |
  |  | 772 | $withdrawal\_stripe\_split\_pay\_mode     = isset($wcfm\_withdrawal\_options['stripe\_split\_pay\_mode']) ? $wcfm\_withdrawal\_options['stripe\_split\_pay\_mode'] : 'direct\_charges'; |
  |  | 773 |  |
  |  | 774 | $withdrawal\_charge\_type               = isset($wcfm\_withdrawal\_options['withdrawal\_charge\_type']) ? $wcfm\_withdrawal\_options['withdrawal\_charge\_type'] : 'no'; |
  |  | 775 |  |
  |  | 776 | $withdrawal\_charge                    = isset($wcfm\_withdrawal\_options['withdrawal\_charge']) ? $wcfm\_withdrawal\_options['withdrawal\_charge'] : array(); |
  |  | 777 | $withdrawal\_charge\_paypal             = isset($withdrawal\_charge['paypal']) ? $withdrawal\_charge['paypal'] : array(); |
  |  | 778 | $withdrawal\_charge\_stripe             = isset($withdrawal\_charge['stripe']) ? $withdrawal\_charge['stripe'] : array(); |
  |  | 779 | $withdrawal\_charge\_skrill             = isset($withdrawal\_charge['skrill']) ? $withdrawal\_charge['skrill'] : array(); |
  |  | 780 | $withdrawal\_charge\_bank\_transfer      = isset($withdrawal\_charge['bank\_transfer']) ? $withdrawal\_charge['bank\_transfer'] : array(); |
  |  | 781 |  |
  | 771 | 782 | $active\_order\_payment\_methods         = get\_wcfm\_marketplace\_disallow\_order\_payment\_methods(); |
  | 772 |  | $transaction\_charge\_type              = isset(~~$wcfm\_withdrawal\_options['transaction\_charge\_type']~~ ) ? $wcfm\_withdrawal\_options['transaction\_charge\_type'] : 'no'; |
  | 773 |  | $transaction\_charge                   = isset(~~$wcfm\_withdrawal\_options['transaction\_charge']~~ ) ? $wcfm\_withdrawal\_options['transaction\_charge'] : array(); |
  |  | 783 | $transaction\_charge\_type              = isset($wcfm\_withdrawal\_options['transaction\_charge\_type']) ? $wcfm\_withdrawal\_options['transaction\_charge\_type'] : 'no'; |
  |  | 784 | $transaction\_charge                   = isset($wcfm\_withdrawal\_options['transaction\_charge']) ? $wcfm\_withdrawal\_options['transaction\_charge'] : array(); |
  | 774 | 785 | ?> |
  | 775 | 786 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L780) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L791) |  |
  | 780 | 791 | <div class="wcfm-container"> |
  | 781 | 792 | <div id="wcfm\_settings\_form\_payment\_expander" class="wcfm-content"> |
  | 782 |  | <h2><?php \_e('Marketplace Payment Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 783 |  | <?php wcfm\_video\_tutorial(~~'https://docs.wclovers.com/vendor-payment/'~~ ); ?> |
  | 784 |  | <div class="wcfm\_clearfix"></div><br/> |
  |  | 793 | <h2><?php \_e('Marketplace Payment Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 794 | <?php wcfm\_video\_tutorial('https://docs.wclovers.com/vendor-payment/'); ?> |
  |  | 795 | <div class="wcfm\_clearfix"></div><br /> |
  | 785 | 796 | <div class="store\_address"> |
  | 786 | 797 | <?php |
  | 787 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_withdrawal\_payment', array( |
  | 788 |  | ~~"withdrawal\_payment\_methods" => array( 'label' => \_\_( 'Withdraw Payment Methods', 'wc-multivendor-marketplace' ), 'name' => 'wcfm\_withdrawal\_options[payment\_methods]', 'type' => 'checklist', 'class' => 'wcfm-checkbox wcfm\_ele payment\_options', 'label\_class' => 'wcfm\_title wcfm\_full\_title', 'options' => $wcfm\_marketplace\_withdrwal\_payment\_methods, 'value' => $payment\_methods~~ ), |
  | 789 |  | ~~"withdrawal\_setting\_break\_1" => array( 'type' => 'html', 'value' => '<div style="height: 15px;"></div>'~~ ), |
  | 790 |  |  |
  | 791 |  | ~~"withdrawal\_stripe\_is\_3d\_secure" => array('label' => \_\_('Stripe 3D Secure and SCA?', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_3d\_secure]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe\_split', 'label\_class' => 'wcfm\_title checkbox\_title withdrawal\_mode withdrawal\_mode\_stripe\_split', 'value' => 'yes', 'dfvalue' => $withdrawal\_stripe\_is\_3d\_secure, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe\_split wcfm\_page\_options\_desc', 'desc' => \_\_( '3D Secure and SCA ready transaction is only supported when both your platform and the connected account (Vendor) are in the same region: both in Europe or both in the U.S.', 'wc-multivendor-marketplace' )~~ ), |
  | 792 |  | ~~"withdrawal\_stripe\_split\_pay\_mode" => array('label' => \_\_('Stripe Split Pay Mode', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_split\_pay\_mode]', 'type' => 'select', 'options' => array( 'direct\_charges' => \_\_( 'Direct Charges',  'wc-multivendor-marketplace' ), 'destination\_charges' => \_\_( 'Destination Charges',  'wc-multivendor-marketplace' ), 'transfers\_charges' => \_\_( 'Transfer Charges',  'wc-multivendor-marketplace' )  ), 'class' => 'wcfm-select wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe\_split withdrawal\_charge\_type\_ele', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe\_split withdrawal\_charge\_type\_ele', 'value' => $withdrawal\_stripe\_split\_pay\_mode, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe\_split wcfm\_page\_options\_desc withdrawal\_charge\_type\_ele', 'desc' => \_\_( 'Set your preferred Stripe Split pay mode.', 'wc-multivendor-marketplace' )~~ ), |
  | 793 |  |  |
  | 794 |  | ~~"withdrawal\_test\_mode" => array('label' => \_\_('Enable Test Mode', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[test\_mode]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $withdrawal\_test\_mode~~ ), |
  | 795 |  | ~~), $wcfm\_withdrawal\_options )~~ ); |
  | 796 |  |  |
  | 797 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_withdrawal\_payment\_keys', array( |
  | 798 |  | ~~"withdrawal\_paypal\_client\_id"     => array('label' => \_\_('PayPal Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'value' => $withdrawal\_paypal\_client\_id~~ ), |
  | 799 |  | ~~"withdrawal\_paypal\_secret\_key"    => array('label' => \_\_('PayPal Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'value' => $withdrawal\_paypal\_secret\_key~~ ), |
  | 800 |  |  |
  | 801 |  | ~~"withdrawal\_stripe\_client\_id"     => array('label' => \_\_('Stripe Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'value' => $withdrawal\_stripe\_client\_id, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live wcfm\_page\_options\_desc', 'desc' => sprintf( \_\_( 'Set redirect URL(s) to your Stripe account - <br/> %s <br />%s', 'wc-multivendor-marketplace' ), get\_wcfm\_settings\_url(), add\_query\_arg( array( 'store-setup' => 'yes', 'step' => 'payment' ), home\_url() ) )~~ ), |
  | 802 |  | ~~"withdrawal\_stripe\_published\_key" => array('label' => \_\_('Stripe Publish Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_published\_key]', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'value' => $withdrawal\_stripe\_published\_key~~ ), |
  | 803 |  | ~~"withdrawal\_stripe\_secret\_key"    => array('label' => \_\_('Stripe Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'value' => $withdrawal\_stripe\_secret\_key~~ ), |
  | 804 |  |  |
  | 805 |  | ~~"withdrawal\_wirecard\_token"       => array('label' => \_\_('Wirecard Token', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_token]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'value' => $withdrawal\_wirecard\_token~~ ), |
  | 806 |  | ~~"withdrawal\_wirecard\_key"         => array('label' => \_\_('Wirecard Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'value' => $withdrawal\_wirecard\_key~~ ), |
  | 807 |  | ~~"withdrawal\_wirecard\_public\_key"  => array('label' => \_\_('Wirecard Publick Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_public\_key]', 'type' => 'textarea', 'class' => 'wcfm-textarea wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'value' => $withdrawal\_wirecard\_public\_key~~ ), |
  | 808 |  | ~~), $wcfm\_withdrawal\_options )~~ ); |
  | 809 |  |  |
  | 810 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_withdrawal\_payment\_test\_keys', array( |
  | 811 |  | ~~"withdrawal\_paypal\_test\_client\_id"      => array('label' => \_\_('PayPal Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_test\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'value' => $withdrawal\_paypal\_test\_client\_id~~ ), |
  | 812 |  | ~~"withdrawal\_paypal\_test\_secret\_key"     => array('label' => \_\_('PayPal Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_test\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'value' => $withdrawal\_paypal\_test\_secret\_key~~ ), |
  | 813 |  |  |
  | 814 |  | ~~"withdrawal\_stripe\_test\_client\_id"      => array('label' => \_\_('Stripe Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_test\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'value' => $withdrawal\_stripe\_test\_client\_id, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test wcfm\_page\_options\_desc', 'desc' => sprintf( \_\_( 'Set redirect URL(s) to your Stripe account - <br/> %s <br />%s', 'wc-multivendor-marketplace' ), get\_wcfm\_settings\_url(), add\_query\_arg( array( 'store-setup' => 'yes', 'step' => 'payment' ), home\_url() ) )~~ ), |
  | 815 |  | ~~"withdrawal\_stripe\_test\_published\_key"  => array('label' => \_\_('Stripe Publish Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_test\_published\_key]', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'value' => $withdrawal\_stripe\_test\_published\_key~~ ), |
  | 816 |  | ~~"withdrawal\_stripe\_test\_secret\_key"     => array('label' => \_\_('Stripe Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_test\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'value' => $withdrawal\_stripe\_test\_secret\_key~~ ), |
  | 817 |  |  |
  | 818 |  | ~~"withdrawal\_wirecard\_test\_token"        => array('label' => \_\_('Wirecard Token', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_test\_token]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'value' => $withdrawal\_wirecard\_test\_token~~ ), |
  | 819 |  | ~~"withdrawal\_wirecard\_test\_key"          => array('label' => \_\_('Wirecard Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_test\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'value' => $withdrawal\_wirecard\_test\_key~~ ), |
  | 820 |  | ~~"withdrawal\_wirecard\_test\_public\_key"   => array('label' => \_\_('Wirecard Publick Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_test\_public\_key]', 'type' => 'textarea', 'class' => 'wcfm-textarea wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'value' => $withdrawal\_wirecard\_test\_public\_key~~ ), |
  | 821 |  | ~~), $wcfm\_withdrawal\_options )~~ ); |
  |  | 798 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_withdrawal\_payment', array( |
  |  | 799 | "withdrawal\_payment\_methods" => array('label' => \_\_('Withdraw Payment Methods', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[payment\_methods]', 'type' => 'checklist', 'class' => 'wcfm-checkbox wcfm\_ele payment\_options', 'label\_class' => 'wcfm\_title wcfm\_full\_title', 'options' => $wcfm\_marketplace\_withdrwal\_payment\_methods, 'value' => $payment\_methods), |
  |  | 800 | "withdrawal\_setting\_break\_1" => array('type' => 'html', 'value' => '<div style="height: 15px;"></div>'), |
  |  | 801 |  |
  |  | 802 | "withdrawal\_stripe\_is\_3d\_secure" => array('label' => \_\_('Stripe 3D Secure and SCA?', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_3d\_secure]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe\_split', 'label\_class' => 'wcfm\_title checkbox\_title withdrawal\_mode withdrawal\_mode\_stripe\_split', 'value' => 'yes', 'dfvalue' => $withdrawal\_stripe\_is\_3d\_secure, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe\_split wcfm\_page\_options\_desc', 'desc' => \_\_('3D Secure and SCA ready transaction is only supported when both your platform and the connected account (Vendor) are in the same region: both in Europe or both in the U.S.', 'wc-multivendor-marketplace')), |
  |  | 803 | "withdrawal\_stripe\_split\_pay\_mode" => array('label' => \_\_('Stripe Split Pay Mode', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_split\_pay\_mode]', 'type' => 'select', 'options' => array('direct\_charges' => \_\_('Direct Charges',  'wc-multivendor-marketplace'), 'destination\_charges' => \_\_('Destination Charges',  'wc-multivendor-marketplace'), 'transfers\_charges' => \_\_('Transfer Charges',  'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe\_split withdrawal\_charge\_type\_ele', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe\_split withdrawal\_charge\_type\_ele', 'value' => $withdrawal\_stripe\_split\_pay\_mode, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe\_split wcfm\_page\_options\_desc withdrawal\_charge\_type\_ele', 'desc' => \_\_('Set your preferred Stripe Split pay mode.', 'wc-multivendor-marketplace')), |
  |  | 804 |  |
  |  | 805 | "withdrawal\_test\_mode" => array('label' => \_\_('Enable Test Mode', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_withdrawal\_options[test\_mode]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $withdrawal\_test\_mode), |
  |  | 806 | ), $wcfm\_withdrawal\_options)); |
  |  | 807 |  |
  |  | 808 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_withdrawal\_payment\_keys', array( |
  |  | 809 | "withdrawal\_paypal\_client\_id"     => array('label' => \_\_('PayPal Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'value' => $withdrawal\_paypal\_client\_id), |
  |  | 810 | "withdrawal\_paypal\_secret\_key"    => array('label' => \_\_('PayPal Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_live', 'value' => $withdrawal\_paypal\_secret\_key), |
  |  | 811 |  |
  |  | 812 | "withdrawal\_stripe\_client\_id"     => array('label' => \_\_('Stripe Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'value' => $withdrawal\_stripe\_client\_id, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live wcfm\_page\_options\_desc', 'desc' => sprintf(\_\_('Set redirect URL(s) to your Stripe account - <br/> %s <br />%s', 'wc-multivendor-marketplace'), get\_wcfm\_settings\_url(), add\_query\_arg(array('store-setup' => 'yes', 'step' => 'payment'), home\_url()))), |
  |  | 813 | "withdrawal\_stripe\_published\_key" => array('label' => \_\_('Stripe Publish Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_published\_key]', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'value' => $withdrawal\_stripe\_published\_key), |
  |  | 814 | "withdrawal\_stripe\_secret\_key"    => array('label' => \_\_('Stripe Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_live', 'value' => $withdrawal\_stripe\_secret\_key), |
  |  | 815 |  |
  |  | 816 | "withdrawal\_wirecard\_token"       => array('label' => \_\_('Wirecard Token', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_token]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'value' => $withdrawal\_wirecard\_token), |
  |  | 817 | "withdrawal\_wirecard\_key"         => array('label' => \_\_('Wirecard Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'value' => $withdrawal\_wirecard\_key), |
  |  | 818 | "withdrawal\_wirecard\_public\_key"  => array('label' => \_\_('Wirecard Publick Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_public\_key]', 'type' => 'textarea', 'class' => 'wcfm-textarea wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_live', 'value' => $withdrawal\_wirecard\_public\_key), |
  |  | 819 | ), $wcfm\_withdrawal\_options)); |
  |  | 820 |  |
  |  | 821 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_withdrawal\_payment\_test\_keys', array( |
  |  | 822 | "withdrawal\_paypal\_test\_client\_id"      => array('label' => \_\_('PayPal Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_test\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'value' => $withdrawal\_paypal\_test\_client\_id), |
  |  | 823 | "withdrawal\_paypal\_test\_secret\_key"     => array('label' => \_\_('PayPal Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[paypal\_test\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_paypal withdrawal\_mode\_test', 'value' => $withdrawal\_paypal\_test\_secret\_key), |
  |  | 824 |  |
  |  | 825 | "withdrawal\_stripe\_test\_client\_id"      => array('label' => \_\_('Stripe Client ID', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_test\_client\_id]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'value' => $withdrawal\_stripe\_test\_client\_id, 'desc\_class' => 'withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test wcfm\_page\_options\_desc', 'desc' => sprintf(\_\_('Set redirect URL(s) to your Stripe account - <br/> %s <br />%s', 'wc-multivendor-marketplace'), get\_wcfm\_settings\_url(), add\_query\_arg(array('store-setup' => 'yes', 'step' => 'payment'), home\_url()))), |
  |  | 826 | "withdrawal\_stripe\_test\_published\_key"  => array('label' => \_\_('Stripe Publish Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_test\_published\_key]', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'value' => $withdrawal\_stripe\_test\_published\_key), |
  |  | 827 | "withdrawal\_stripe\_test\_secret\_key"     => array('label' => \_\_('Stripe Secret Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[stripe\_test\_secret\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_stripe withdrawal\_mode\_stripe\_split withdrawal\_mode\_test', 'value' => $withdrawal\_stripe\_test\_secret\_key), |
  |  | 828 |  |
  |  | 829 | "withdrawal\_wirecard\_test\_token"        => array('label' => \_\_('Wirecard Token', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_test\_token]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'value' => $withdrawal\_wirecard\_test\_token), |
  |  | 830 | "withdrawal\_wirecard\_test\_key"          => array('label' => \_\_('Wirecard Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_test\_key]', 'type' => 'password', 'class' => 'wcfm-text wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'value' => $withdrawal\_wirecard\_test\_key), |
  |  | 831 | "withdrawal\_wirecard\_test\_public\_key"   => array('label' => \_\_('Wirecard Publick Key', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[wirecard\_test\_public\_key]', 'type' => 'textarea', 'class' => 'wcfm-textarea wcfm\_ele withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'label\_class' => 'wcfm\_title withdrawal\_mode withdrawal\_mode\_wirecard withdrawal\_mode\_test', 'value' => $withdrawal\_wirecard\_test\_public\_key), |
  |  | 832 | ), $wcfm\_withdrawal\_options)); |
  | 822 | 833 | ?> |
  | 823 | 834 | </div> |
  | 824 |  |  |
  | 825 |  | <?php if~~( !empty( $active\_order\_payment\_methods )~~ ) { ?> |
  | 826 |  | <div class="wcfm\_clearfix"></div><br/> |
  |  | 835 |  |
  |  | 836 | <?php if (!empty($active\_order\_payment\_methods)) { ?> |
  |  | 837 | <div class="wcfm\_clearfix"></div><br /> |
  | 827 | 838 | <h2><?php \_e('Transaction Charges', 'wc-multivendor-marketplace'); ?></h2> |
  | 828 |  | <p class="description instructions"><?php printf(~~\_\_( 'These charges will be deducted from vendor\'s total order commission depending upon %sOrder Payment Method%s.', 'wc-multivendor-marketplace' ), '<b>', '</b>'~~ ); ?></p> |
  |  | 839 | <p class="description instructions"><?php printf(\_\_('These charges will be deducted from vendor\'s total order commission depending upon %sOrder Payment Method%s.', 'wc-multivendor-marketplace'), '<b>', '</b>'); ?></p> |
  | 829 | 840 | <div class="wcfm\_clearfix"></div> |
  | 830 | 841 | <div class="store\_address"> |
  | 831 | 842 | <?php |
  | 832 | 843 | $transactional\_charges\_fileds = array( |
  | 833 |  | ~~"transaction\_charge\_type" => array('label' => \_\_( 'Charge Type', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[transaction\_charge\_type]', 'type' => 'select', 'options' => array( 'no' => \_\_( 'No Charge', 'wc-multivendor-marketplace' ), 'percent' => \_\_( 'Percent', 'wc-multivendor-marketplace' ), 'fixed'   => \_\_( 'Fixed', 'wc-multivendor-marketplace' ), 'percent\_fixed' => \_\_( 'Percent + Fixed', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc', 'value' => $transaction\_charge\_type~~ ), |
  | 834 |  | ~~"transaction\_setting\_break\_4" => array( 'type' => 'html', 'value' => '<div style="height: 15px;"></div>'~~ ), |
  | 835 |  | ); |
  | 836 |  | ~~foreach( $active\_order\_payment\_methods as $method\_id => $metnohd\_name~~ ) { |
  | 837 |  | ~~$transactional\_charges\_fileds['transaction\_charge\_'.$method\_id] = array( 'label' => $metnohd\_name . ' ' . \_\_('Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[transaction\_charge]['.$method\_id.']', 'class' => 'wcfm\_non\_sortable transaction\_charge\_block transaction\_charge\_'.$method\_id, 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele transaction\_charge\_block transaction\_charge\_'.$method\_id, 'value' => isset( $transaction\_charge[$method\_id] ) ? $transaction\_charge[$method\_id] : array(), 'custom\_attributes' => array( 'limit' => 1~~ ), 'options' => array( |
  | 838 |  | ~~"percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input transaction\_charge\_field transaction\_charge\_percent transaction\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele transaction\_charge\_field transaction\_charge\_percent transaction\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 839 |  | ~~"fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input transaction\_charge\_field transaction\_charge\_fixed transaction\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele transaction\_charge\_field transaction\_charge\_fixed transaction\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 840 |  | //"tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'hints' => \_\_( 'Tax for transaction charge, calculate in percent.', 'wc-multivendor-marketplace' ) ), |
  | 841 |  | ~~)~~ ); |
  | 842 |  | } |
  | 843 |  |  |
  | 844 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters( 'wcfm\_marketplace\_settings\_fields\_transaction\_charges', $transactional\_charges\_fileds , $wcfm\_withdrawal\_options, $transaction\_charge )~~ ); |
  | 845 |  |  |
  |  | 844 | "transaction\_charge\_type" => array('label' => \_\_('Charge Type', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[transaction\_charge\_type]', 'type' => 'select', 'options' => array('no' => \_\_('No Charge', 'wc-multivendor-marketplace'), 'percent' => \_\_('Percent', 'wc-multivendor-marketplace'), 'fixed'   => \_\_('Fixed', 'wc-multivendor-marketplace'), 'percent\_fixed' => \_\_('Percent + Fixed', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc', 'value' => $transaction\_charge\_type), |
  |  | 845 | "transaction\_setting\_break\_4" => array('type' => 'html', 'value' => '<div style="height: 15px;"></div>'), |
  |  | 846 | ); |
  |  | 847 | foreach ($active\_order\_payment\_methods as $method\_id => $metnohd\_name) { |
  |  | 848 | $transactional\_charges\_fileds['transaction\_charge\_' . $method\_id] = array('label' => $metnohd\_name . ' ' . \_\_('Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[transaction\_charge][' . $method\_id . ']', 'class' => 'wcfm\_non\_sortable transaction\_charge\_block transaction\_charge\_' . $method\_id, 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele transaction\_charge\_block transaction\_charge\_' . $method\_id, 'value' => isset($transaction\_charge[$method\_id]) ? $transaction\_charge[$method\_id] : array(), 'custom\_attributes' => array('limit' => 1), 'options' => array( |
  |  | 849 | "percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input transaction\_charge\_field transaction\_charge\_percent transaction\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele transaction\_charge\_field transaction\_charge\_percent transaction\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 850 | "fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input transaction\_charge\_field transaction\_charge\_fixed transaction\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele transaction\_charge\_field transaction\_charge\_fixed transaction\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 851 | //"tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'hints' => \_\_( 'Tax for transaction charge, calculate in percent.', 'wc-multivendor-marketplace' ) ), |
  |  | 852 | )); |
  |  | 853 | } |
  |  | 854 |  |
  |  | 855 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_transaction\_charges', $transactional\_charges\_fileds, $wcfm\_withdrawal\_options, $transaction\_charge)); |
  |  | 856 |  |
  | 846 | 857 | ?> |
  | 847 | 858 | </div> |
  | 848 | 859 | <?php } ?> |
  | 849 |  |  |
  | 850 |  | <div class="wcfm\_clearfix"></div><br/> |
  |  | 860 |  |
  |  | 861 | <div class="wcfm\_clearfix"></div><br /> |
  | 851 | 862 | <h2><?php \_e('Withdrawal Charges', 'wc-multivendor-marketplace'); ?></h2> |
  | 852 |  | <p class="description instructions"><?php printf(~~\_\_( 'These charges will be deducted from vendor\'s withdrawal amount depending upon %sWithdrawal Payment Method%s.', 'wc-multivendor-marketplace' ), '<b>', '</b>'~~ ); ?></p> |
  |  | 863 | <p class="description instructions"><?php printf(\_\_('These charges will be deducted from vendor\'s withdrawal amount depending upon %sWithdrawal Payment Method%s.', 'wc-multivendor-marketplace'), '<b>', '</b>'); ?></p> |
  | 853 | 864 | <div class="wcfm\_clearfix"></div> |
  | 854 | 865 | <div class="store\_address"> |
  | 855 | 866 | <?php |
  | 856 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_withdrawal\_charges', array( |
  | 857 |  | ~~"withdrawal\_charge\_type" => array('label' => \_\_( 'Charge Type', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge\_type]', 'type' => 'select', 'options' => array( 'no' => \_\_( 'No Charge', 'wc-multivendor-marketplace' ), 'percent' => \_\_( 'Percent', 'wc-multivendor-marketplace' ), 'fixed'   => \_\_( 'Fixed', 'wc-multivendor-marketplace' ), 'percent\_fixed' => \_\_( 'Percent + Fixed', 'wc-multivendor-marketplace' ) ), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc', 'value' => $withdrawal\_charge\_type , 'desc' => \_\_('Charges applicable for each withdarwal.', 'wc-multivendor-marketplace')~~ ), |
  | 858 |  | ~~"withdrawal\_setting\_break\_4" => array( 'type' => 'html', 'value' => '<div style="height: 15px;"></div>'~~ ), |
  | 859 |  |  |
  | 860 |  | ~~"withdrawal\_charge\_paypal" => array( 'label' => \_\_('PayPal Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][paypal]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_paypal', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_paypal', 'value' => $withdrawal\_charge\_paypal, 'custom\_attributes' => array( 'limit' => 1~~ ), 'options' => array( |
  | 861 |  | ~~"percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 862 |  | ~~"fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 863 |  | ~~"tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'hints' => \_\_( 'Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace' )~~ ), |
  | 864 |  | ~~)~~ ), |
  | 865 |  | ~~"withdrawal\_charge\_stripe" => array( 'label' => \_\_('Stripe Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][stripe]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_stripe', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_stripe', 'value' => $withdrawal\_charge\_stripe, 'custom\_attributes' => array( 'limit' => 1~~ ), 'options' => array( |
  | 866 |  | ~~"percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 867 |  | ~~"fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 868 |  | ~~"tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'hints' => \_\_( 'Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace' )~~ ), |
  | 869 |  | ~~)~~ ), |
  | 870 |  | ~~"withdrawal\_charge\_skrill" => array( 'label' => \_\_('Skrill Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][skrill]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_skrill', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_skrill', 'value' => $withdrawal\_charge\_skrill, 'custom\_attributes' => array( 'limit' => 1~~ ), 'options' => array( |
  | 871 |  | ~~"percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 872 |  | ~~"fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 873 |  | ~~"tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'hints' => \_\_( 'Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace' )~~ ), |
  | 874 |  | ~~)~~ ), |
  | 875 |  | ~~"withdrawal\_charge\_bank\_transfer" => array( 'label' => \_\_('Bank Transfer Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][bank\_transfer]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_bank\_transfer', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_bank\_transfer', 'value' => $withdrawal\_charge\_bank\_transfer, 'custom\_attributes' => array( 'limit' => 1~~ ), 'options' => array( |
  | 876 |  | ~~"percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 877 |  | ~~"fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array( 'min' => '0.1', 'step' => '0.1')~~ ), |
  | 878 |  | ~~"tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array( 'min' => '0.1', 'step' => '0.1'), 'hints' => \_\_( 'Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace' )~~ ), |
  | 879 |  | ~~)~~ ), |
  | 880 |  | ~~), $wcfm\_withdrawal\_options, $withdrawal\_charge )~~ ); |
  | 881 |  |  |
  |  | 867 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_withdrawal\_charges', array( |
  |  | 868 | "withdrawal\_charge\_type" => array('label' => \_\_('Charge Type', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge\_type]', 'type' => 'select', 'options' => array('no' => \_\_('No Charge', 'wc-multivendor-marketplace'), 'percent' => \_\_('Percent', 'wc-multivendor-marketplace'), 'fixed'   => \_\_('Fixed', 'wc-multivendor-marketplace'), 'percent\_fixed' => \_\_('Percent + Fixed', 'wc-multivendor-marketplace')), 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'desc\_class' => 'wcfm\_page\_options\_desc', 'value' => $withdrawal\_charge\_type, 'desc' => \_\_('Charges applicable for each withdarwal.', 'wc-multivendor-marketplace')), |
  |  | 869 | "withdrawal\_setting\_break\_4" => array('type' => 'html', 'value' => '<div style="height: 15px;"></div>'), |
  |  | 870 |  |
  |  | 871 | "withdrawal\_charge\_paypal" => array('label' => \_\_('PayPal Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][paypal]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_paypal', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_paypal', 'value' => $withdrawal\_charge\_paypal, 'custom\_attributes' => array('limit' => 1), 'options' => array( |
  |  | 872 | "percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 873 | "fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 874 | "tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1'), 'hints' => \_\_('Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace')), |
  |  | 875 | )), |
  |  | 876 | "withdrawal\_charge\_stripe" => array('label' => \_\_('Stripe Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][stripe]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_stripe', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_stripe', 'value' => $withdrawal\_charge\_stripe, 'custom\_attributes' => array('limit' => 1), 'options' => array( |
  |  | 877 | "percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 878 | "fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 879 | "tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1'), 'hints' => \_\_('Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace')), |
  |  | 880 | )), |
  |  | 881 | "withdrawal\_charge\_skrill" => array('label' => \_\_('Skrill Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][skrill]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_skrill', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_skrill', 'value' => $withdrawal\_charge\_skrill, 'custom\_attributes' => array('limit' => 1), 'options' => array( |
  |  | 882 | "percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 883 | "fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 884 | "tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1'), 'hints' => \_\_('Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace')), |
  |  | 885 | )), |
  |  | 886 | "withdrawal\_charge\_bank\_transfer" => array('label' => \_\_('Bank Transfer Charge', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_withdrawal\_options[withdrawal\_charge][bank\_transfer]', 'class' => 'wcfm\_non\_sortable withdraw\_charge\_block withdraw\_charge\_bank\_transfer', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_ele withdraw\_charge\_block withdraw\_charge\_bank\_transfer', 'value' => $withdrawal\_charge\_bank\_transfer, 'custom\_attributes' => array('limit' => 1), 'options' => array( |
  |  | 887 | "percent" => array('label' => \_\_('Percent Charge(%)', 'wc-multivendor-marketplace'),  'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_percent withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 888 | "fixed" => array('label' => \_\_('Fixed Charge', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'label\_class' => 'wcfm\_title wcfm\_ele withdraw\_charge\_field withdraw\_charge\_fixed withdraw\_charge\_percent\_fixed', 'attributes' => array('min' => '0.1', 'step' => '0.1')), |
  |  | 889 | "tax" => array('label' => \_\_('Charge Tax', 'wc-multivendor-marketplace'), 'type' => 'number', 'class' => 'wcfm-text wcfm\_ele wcfm\_non\_negative\_input ', 'label\_class' => 'wcfm\_title wcfm\_ele', 'attributes' => array('min' => '0.1', 'step' => '0.1'), 'hints' => \_\_('Tax for withdrawal charge, calculate in percent.', 'wc-multivendor-marketplace')), |
  |  | 890 | )), |
  |  | 891 | ), $wcfm\_withdrawal\_options, $withdrawal\_charge)); |
  |  | 892 |  |
  | 882 | 893 | ?> |
  | 883 | 894 | </div> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L886) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L897) |  |
  | 886 | 897 | <div class="wcfm\_clearfix"></div> |
  | 887 | 898 | <!-- end collapsible --> |
  | 888 |  |  |
  |  | 899 |  |
  | 889 | 900 | <?php |
  | 890 | 901 | } |
  | 891 |  |  |
  | 892 |  | function wcfm\_withdrawal\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 902 |  |
  |  | 903 | function wcfm\_withdrawal\_settings\_update($wcfm\_settings\_form) { |
  | 893 | 904 | global $WCFM, $WCFMmp, $\_POST; |
  | 894 |  |  |
  | 895 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_withdrawal\_manage', true ) ) return;~~ |
  | 896 |  |  |
  | 897 |  | if~~( isset( $wcfm\_settings\_form['wcfm\_withdrawal\_options'] )~~ ) { |
  | 898 |  |  |
  |  | 905 |  |
  |  | 906 | if (!apply\_filters('wcfm\_is\_allow\_withdrawal\_manage', true)) return; |
  |  | 907 |  |
  |  | 908 | if (isset($wcfm\_settings\_form['wcfm\_withdrawal\_options'])) { |
  |  | 909 |  |
  | 899 | 910 | // Periodic Schedule Reset - Only if any change happend |
  | 900 |  | $wcfm\_withdrawal\_options = get\_option(~~'wcfm\_withdrawal\_options', array()~~ ); |
  | 901 |  |  |
  | 902 |  | $withdrawal\_mode         = isset(~~$wcfm\_withdrawal\_options['withdrawal\_mode']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  | 903 |  | $withdrawal\_schedule     = isset(~~$wcfm\_withdrawal\_options['withdrawal\_schedule']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  | 904 |  | if~~( $withdrawal\_mode && ( $withdrawal\_mode == 'by\_schedule' )~~ ) { |
  | 905 |  | $new\_withdrawal\_mode         = isset(~~$wcfm\_settings\_form['wcfm\_withdrawal\_options'] ) ? $wcfm\_settings\_form['wcfm\_withdrawal\_options~~'] : ''; |
  | 906 |  | $new\_withdrawal\_schedule     = isset(~~$wcfm\_settings\_form['wcfm\_withdrawal\_options'] ) ? $wcfm\_settings\_form['wcfm\_withdrawal\_options~~'] : 'week'; |
  | 907 |  |  |
  | 908 |  | if~~( !$new\_withdrawal\_mode || ( $new\_withdrawal\_mode != 'by\_schedule' )~~ ) { |
  | 909 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_withdrawal\_periodic\_scheduler'~~ ); |
  | 910 |  | if (~~$next~~ ) { |
  | 911 |  | ~~WC()->queue()->cancel\_all( 'wcfmmp\_withdrawal\_periodic\_scheduler'~~ ); |
  | 912 |  | ~~}~~ |
  | 913 |  | ~~} elseif( $new\_withdrawal\_mode && ( $new\_withdrawal\_mode != $withdrawal\_mode ) ) {~~ |
  | 914 |  | ~~$next = WC()->queue()->get\_next( 'wcfmmp\_withdrawal\_periodic\_scheduler' );~~ |
  | 915 |  | ~~if ( $next ) {~~ |
  | 916 |  | WC()->queue()->~~cancel\_all( 'wcfmmp\_withdrawal\_periodic\_scheduler~~' ); |
  |  | 911 | $wcfm\_withdrawal\_options = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 912 |  |
  |  | 913 | $withdrawal\_mode         = isset($wcfm\_withdrawal\_options['withdrawal\_mode']) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  |  | 914 | $withdrawal\_schedule     = isset($wcfm\_withdrawal\_options['withdrawal\_schedule']) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  |  | 915 | if ($withdrawal\_mode && ($withdrawal\_mode == 'by\_schedule')) { |
  |  | 916 | $new\_withdrawal\_mode         = isset($wcfm\_settings\_form['wcfm\_withdrawal\_options']['withdrawal\_mode']) ? $wcfm\_settings\_form['wcfm\_withdrawal\_options']['withdrawal\_mode'] : ''; |
  |  | 917 | $new\_withdrawal\_schedule     = isset($wcfm\_settings\_form['wcfm\_withdrawal\_options']['withdrawal\_schedule']) ? $wcfm\_settings\_form['wcfm\_withdrawal\_options']['withdrawal\_schedule'] : 'week'; |
  |  | 918 |  |
  |  | 919 | if ($new\_withdrawal\_mode != $withdrawal\_mode || $new\_withdrawal\_schedule != $withdrawal\_schedule) { |
  |  | 920 | $next = WC()->queue()->get\_next('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 921 | if ($next) { |
  |  | 922 | $withdrawal\_schedule\_timestamps = wcfmmp\_generate\_timestamp\_for\_period($new\_withdrawal\_schedule); |
  |  | 923 | $period\_interval    = apply\_filters( 'wcfm\_schedule\_period\_interval', $withdrawal\_schedule\_timestamps['days\_in\_period'], $new\_withdrawal\_schedule ); |
  |  | 924 | $period\_starts\_from = apply\_filters( 'wcfm\_schedule\_period\_starts\_from', $withdrawal\_schedule\_timestamps['starting\_timestamp'], $new\_withdrawal\_schedule ); |
  |  | 925 |  |
  |  | 926 | WC()->queue()->cancel\_all('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 927 | WC()->queue()->schedule\_recurring( $period\_starts\_from, ( $period\_interval \* DAY\_IN\_SECONDS ), 'wcfmmp\_withdrawal\_periodic\_scheduler', array(), 'WCFM' ); |
  | 917 | 928 | } |
  | 918 | 929 | } |
  | 919 | 930 | } |
  | 920 |  |  |
  | 921 |  | update\_option(~~'wcfm\_withdrawal\_options', $wcfm\_settings\_form['wcfm\_withdrawal\_options']~~ ); |
  | 922 |  |  |
  |  | 931 |  |
  |  | 932 | update\_option('wcfm\_withdrawal\_options', $wcfm\_settings\_form['wcfm\_withdrawal\_options']); |
  |  | 933 |  |
  | 923 | 934 | $active\_payment\_methods = get\_wcfm\_marketplace\_active\_withdrwal\_payment\_methods(); |
  | 924 |  | if~~( array\_key\_exists( 'wirecard', $active\_payment\_methods )~~ ) { |
  | 925 |  | $wcfm\_withdrawal\_options              = get\_option(~~'wcfm\_withdrawal\_options', array()~~ ); |
  | 926 |  |  |
  | 927 |  | $withdrawal\_test\_mode                 = isset(~~$wcfm\_withdrawal\_options['test\_mode']~~ ) ? 'yes' : 'no'; |
  | 928 |  |  |
  | 929 |  | $withdrawal\_wirecard\_token            = isset(~~$wcfm\_withdrawal\_options['wirecard\_token'] ) ? wc\_clean( $wcfm\_withdrawal\_options['wirecard\_token']~~ ) : ''; |
  | 930 |  | $withdrawal\_wirecard\_key              = isset(~~$wcfm\_withdrawal\_options['wirecard\_key'] ) ? wc\_clean( $wcfm\_withdrawal\_options['wirecard\_key']~~ ) : ''; |
  | 931 |  | $withdrawal\_wirecard\_public\_key       = isset(~~$wcfm\_withdrawal\_options['wirecard\_public\_key'] ) ? wc\_clean( $wcfm\_withdrawal\_options['wirecard\_public\_key']~~ ) : ''; |
  | 932 |  |  |
  | 933 |  | $withdrawal\_wirecard\_test\_token       = isset(~~$wcfm\_withdrawal\_options['wirecard\_test\_token'] ) ? wc\_clean( $wcfm\_withdrawal\_options['wirecard\_test\_token']~~ ) : ''; |
  | 934 |  | $withdrawal\_wirecard\_test\_key         = isset(~~$wcfm\_withdrawal\_options['wirecard\_test\_key'] ) ? wc\_clean( $wcfm\_withdrawal\_options['wirecard\_test\_key']~~ ) : ''; |
  | 935 |  | $withdrawal\_wirecard\_test\_public\_key  = isset(~~$wcfm\_withdrawal\_options['wirecard\_test\_public\_key'] ) ? wc\_clean( $wcfm\_withdrawal\_options['wirecard\_test\_public\_key']~~ ) : ''; |
  | 936 |  |  |
  | 937 |  | $base\_url   = (~~$withdrawal\_test\_mode == 'yes' ) ? esc\_url( 'https://sandbox.moip.com.br/v2/channels' ) : esc\_url( 'https://api.moip.com.br/v2/channels'~~ ); |
  | 938 |  |  |
  | 939 |  | if (~~( $withdrawal\_test\_mode == 'no' ) && ( empty( $withdrawal\_wirecard\_key ) || empty( $withdrawal\_wirecard\_token ) || empty( $withdrawal\_wirecard\_public\_key ) )~~ ) { |
  |  | 935 | if (array\_key\_exists('wirecard', $active\_payment\_methods)) { |
  |  | 936 | $wcfm\_withdrawal\_options              = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 937 |  |
  |  | 938 | $withdrawal\_test\_mode                 = isset($wcfm\_withdrawal\_options['test\_mode']) ? 'yes' : 'no'; |
  |  | 939 |  |
  |  | 940 | $withdrawal\_wirecard\_token            = isset($wcfm\_withdrawal\_options['wirecard\_token']) ? wc\_clean($wcfm\_withdrawal\_options['wirecard\_token']) : ''; |
  |  | 941 | $withdrawal\_wirecard\_key              = isset($wcfm\_withdrawal\_options['wirecard\_key']) ? wc\_clean($wcfm\_withdrawal\_options['wirecard\_key']) : ''; |
  |  | 942 | $withdrawal\_wirecard\_public\_key       = isset($wcfm\_withdrawal\_options['wirecard\_public\_key']) ? wc\_clean($wcfm\_withdrawal\_options['wirecard\_public\_key']) : ''; |
  |  | 943 |  |
  |  | 944 | $withdrawal\_wirecard\_test\_token       = isset($wcfm\_withdrawal\_options['wirecard\_test\_token']) ? wc\_clean($wcfm\_withdrawal\_options['wirecard\_test\_token']) : ''; |
  |  | 945 | $withdrawal\_wirecard\_test\_key         = isset($wcfm\_withdrawal\_options['wirecard\_test\_key']) ? wc\_clean($wcfm\_withdrawal\_options['wirecard\_test\_key']) : ''; |
  |  | 946 | $withdrawal\_wirecard\_test\_public\_key  = isset($wcfm\_withdrawal\_options['wirecard\_test\_public\_key']) ? wc\_clean($wcfm\_withdrawal\_options['wirecard\_test\_public\_key']) : ''; |
  |  | 947 |  |
  |  | 948 | $base\_url   = ($withdrawal\_test\_mode == 'yes') ? esc\_url('https://sandbox.moip.com.br/v2/channels') : esc\_url('https://api.moip.com.br/v2/channels'); |
  |  | 949 |  |
  |  | 950 | if (($withdrawal\_test\_mode == 'no') && (empty($withdrawal\_wirecard\_key) || empty($withdrawal\_wirecard\_token) || empty($withdrawal\_wirecard\_public\_key))) { |
  | 940 | 951 | return; |
  | 941 | 952 | } |
  | 942 | 953 |  |
  | 943 |  | if (~~( $withdrawal\_test\_mode == 'yes' ) && ( empty( $withdrawal\_wirecard\_test\_key ) || empty( $withdrawal\_wirecard\_test\_token ) || empty( $withdrawal\_wirecard\_test\_public\_key ) )~~ ) { |
  |  | 954 | if (($withdrawal\_test\_mode == 'yes') && (empty($withdrawal\_wirecard\_test\_key) || empty($withdrawal\_wirecard\_test\_token) || empty($withdrawal\_wirecard\_test\_public\_key))) { |
  | 944 | 955 | return; |
  | 945 | 956 | } else { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L948) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L959) |  |
  | 948 | 959 | $withdrawal\_wirecard\_public\_key = $withdrawal\_wirecard\_test\_public\_key; |
  | 949 | 960 | } |
  | 950 |  |  |
  | 951 |  | $old\_token\_generator = get\_option(~~'wcfmmp\_wirecard\_token\_generator', ''~~ ); |
  | 952 |  | $cur\_token\_generator = base64\_encode(~~$withdrawal\_wirecard\_token . ':' . $withdrawal\_wirecard\_key~~ ); |
  | 953 |  |  |
  | 954 |  | if~~( $cur\_token\_generator == $old\_token\_generator~~ ) { |
  |  | 961 |  |
  |  | 962 | $old\_token\_generator = get\_option('wcfmmp\_wirecard\_token\_generator', ''); |
  |  | 963 | $cur\_token\_generator = base64\_encode($withdrawal\_wirecard\_token . ':' . $withdrawal\_wirecard\_key); |
  |  | 964 |  |
  |  | 965 | if ($cur\_token\_generator == $old\_token\_generator) { |
  | 955 | 966 | return; |
  | 956 | 967 | } else { |
  | 957 |  | delete\_option(~~'wcfmmp\_wirecard\_app\_id'~~ ); |
  | 958 |  | delete\_option(~~'wcfmmp\_wirecard\_secret'~~ ); |
  | 959 |  | delete\_option(~~'wcfmmp\_wirecard\_access\_token'~~ ); |
  | 960 |  | delete\_option(~~'wcfmmp\_wirecard\_token\_generator'~~ ); |
  |  | 968 | delete\_option('wcfmmp\_wirecard\_app\_id'); |
  |  | 969 | delete\_option('wcfmmp\_wirecard\_secret'); |
  |  | 970 | delete\_option('wcfmmp\_wirecard\_access\_token'); |
  |  | 971 | delete\_option('wcfmmp\_wirecard\_token\_generator'); |
  | 961 | 972 | } |
  | 962 |  |  |
  |  | 973 |  |
  | 963 | 974 | $body = array( |
  | 964 |  | "name"        => get\_bloginfo(~~'name'~~ ), |
  | 965 |  | "description" => get\_bloginfo(~~'description'~~ ), |
  |  | 975 | "name"        => get\_bloginfo('name'), |
  |  | 976 | "description" => get\_bloginfo('description'), |
  | 966 | 977 | "site"        => get\_site\_url(), |
  | 967 |  | "redirectUri" => add\_query\_arg(~~'marketplace\_wirecard', 'yes', get\_wcfm\_settings\_url()~~ ) |
  |  | 978 | "redirectUri" => add\_query\_arg('marketplace\_wirecard', 'yes', get\_wcfm\_settings\_url()) |
  | 968 | 979 | ); |
  | 969 |  |  |
  | 970 |  |  |
  |  | 980 |  |
  |  | 981 |  |
  | 971 | 982 | $headers = array( |
  | 972 | 983 | 'Accept'        => 'json', |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L976) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L987) |  |
  | 976 | 987 | 'Authorization' => 'Basic ' . $cur\_token\_generator, |
  | 977 | 988 | ); |
  | 978 |  |  |
  | 979 |  | if~~( !class\_exists( 'WP\_Http\_Curl' )~~ ) { |
  |  | 989 |  |
  |  | 990 | if (!class\_exists('WP\_Http\_Curl')) { |
  | 980 | 991 | include\_once ABSPATH . 'wp-includes/class-wp-http-curl.php'; |
  | 981 | 992 | } |
  | 982 |  |  |
  |  | 993 |  |
  | 983 | 994 | $wp\_curl = new WP\_Http\_Curl(); |
  | 984 |  |  |
  | 985 |  | $response    = $wp\_curl->request( $base\_url, array( |
  | 986 |  | 'sslverify'   => apply\_filters( 'https\_local\_ssl\_verify', false ), |
  | 987 |  | 'method'      => 'POST', |
  | 988 |  | 'timeout'     => 30, |
  | 989 |  | 'redirection' => 10, |
  | 990 |  | 'httpversion' => '1.1', |
  | 991 |  | 'blocking'    => true, |
  | 992 |  | 'stream'      => false, |
  | 993 |  | 'decompress'  => false, |
  | 994 |  | 'filename'    => '', |
  | 995 |  | 'headers'     => $headers, |
  | 996 |  | 'body'        => json\_encode( $body ) |
  | 997 |  | ) |
  | 998 |  | ); |
  | 999 |  |  |
  | 1000 |  | if ( is\_wp\_error( $response ) ) { |
  | 1001 |  | wcfm\_wirecard\_log( \_\_( 'Wirecard APP: Access Token Generate - Something went wrong Wirecard!', 'wc-multivendor-marketplace' ), 'error' ); |
  |  | 995 |  |
  |  | 996 | $response    = $wp\_curl->request( |
  |  | 997 | $base\_url, |
  |  | 998 | array( |
  |  | 999 | 'sslverify'   => apply\_filters('https\_local\_ssl\_verify', false), |
  |  | 1000 | 'method'      => 'POST', |
  |  | 1001 | 'timeout'     => 30, |
  |  | 1002 | 'redirection' => 10, |
  |  | 1003 | 'httpversion' => '1.1', |
  |  | 1004 | 'blocking'    => true, |
  |  | 1005 | 'stream'      => false, |
  |  | 1006 | 'decompress'  => false, |
  |  | 1007 | 'filename'    => '', |
  |  | 1008 | 'headers'     => $headers, |
  |  | 1009 | 'body'        => json\_encode($body) |
  |  | 1010 | ) |
  |  | 1011 | ); |
  |  | 1012 |  |
  |  | 1013 | if (is\_wp\_error($response)) { |
  |  | 1014 | wcfm\_wirecard\_log(\_\_('Wirecard APP: Access Token Generate - Something went wrong Wirecard!', 'wc-multivendor-marketplace'), 'error'); |
  | 1002 | 1015 | return; |
  | 1003 | 1016 | } |
  | 1004 |  |  |
  | 1005 |  | ~~$response = json\_decode( $response['body']~~ ); |
  | 1006 |  |  |
  | 1007 |  | if (~~isset( $response->ERROR )~~ ) { |
  | 1008 |  | wcfm\_wirecard\_log(~~'Wirecard APP: Access Token Generate - ' . $response->ERROR, 'error'~~ ); |
  |  | 1017 |  |
  |  | 1018 | $response = json\_decode($response['body']); |
  |  | 1019 |  |
  |  | 1020 | if (isset($response->ERROR)) { |
  |  | 1021 | wcfm\_wirecard\_log('Wirecard APP: Access Token Generate - ' . $response->ERROR, 'error'); |
  | 1009 | 1022 | return; |
  | 1010 | 1023 | //return wp\_send\_json\_error( $response->ERROR ); |
  | 1011 | 1024 | } |
  | 1012 |  |  |
  | 1013 |  | if (~~! isset( $response->id, $response->secret, $response->accessToken )~~ ) { |
  |  | 1025 |  |
  |  | 1026 | if (!isset($response->id, $response->secret, $response->accessToken)) { |
  | 1014 | 1027 | return; |
  | 1015 | 1028 | } |
  | 1016 |  |  |
  | 1017 |  | wcfm\_wirecard\_log(~~'Access Token Generated: ' . json\_encode( array( $response ) ), 'info'~~ ); |
  | 1018 |  |  |
  | 1019 |  | update\_option(~~'wcfmmp\_wirecard\_app\_id', $response->id~~ ); |
  | 1020 |  | update\_option(~~'wcfmmp\_wirecard\_secret', $response->secret~~ ); |
  | 1021 |  | update\_option(~~'wcfmmp\_wirecard\_access\_token', $response->accessToken~~ ); |
  | 1022 |  | update\_option(~~'wcfmmp\_wirecard\_token\_generator', base64\_encode( $withdrawal\_wirecard\_token . ':' . $withdrawal\_wirecard\_key )~~ ); |
  |  | 1029 |  |
  |  | 1030 | wcfm\_wirecard\_log('Access Token Generated: ' . json\_encode(array($response)), 'info'); |
  |  | 1031 |  |
  |  | 1032 | update\_option('wcfmmp\_wirecard\_app\_id', $response->id); |
  |  | 1033 | update\_option('wcfmmp\_wirecard\_secret', $response->secret); |
  |  | 1034 | update\_option('wcfmmp\_wirecard\_access\_token', $response->accessToken); |
  |  | 1035 | update\_option('wcfmmp\_wirecard\_token\_generator', base64\_encode($withdrawal\_wirecard\_token . ':' . $withdrawal\_wirecard\_key)); |
  | 1023 | 1036 | } |
  | 1024 | 1037 | } |
  | 1025 | 1038 | } |
  | 1026 |  |  |
  | 1027 |  | function wcfm\_shipping\_settings(~~$wcfm\_options~~ ) { |
  |  | 1039 |  |
  |  | 1040 | function wcfm\_shipping\_settings($wcfm\_options) { |
  | 1028 | 1041 | global $WCFM, $WCFMmp; |
  | 1029 |  |  |
  | 1030 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_store\_shipping', true ) ) return;~~ |
  | 1031 |  |  |
  | 1032 |  | $wcfm\_shipping\_options = get\_option(~~'wcfm\_shipping\_options', array()~~ ); |
  | 1033 |  | $wcfmmp\_store\_shipping\_enabled = isset(~~$wcfm\_shipping\_options['enable\_store\_shipping']~~ ) ? $wcfm\_shipping\_options['enable\_store\_shipping'] : 'yes'; |
  | 1034 |  |  |
  | 1035 |  | $wcfmmp\_marketplace\_shipping\_zone\_options = get\_option(~~'woocommerce\_wcfmmp\_product\_shipping\_by\_zone\_settings', array()~~ ); |
  | 1036 |  | ~~$wcfmmp\_marketplace\_shipping\_zone\_enabled = ( !empty($wcfmmp\_marketplace\_shipping\_zone\_options) && !empty($wcfmmp\_marketplace\_shipping\_zone\_options['enabled'])~~ ) ? $wcfmmp\_marketplace\_shipping\_zone\_options['enabled'] : 'yes'; |
  | 1037 |  |  |
  | 1038 |  | $wcfmmp\_marketplace\_shipping\_options = get\_option(~~'woocommerce\_wcfmmp\_product\_shipping\_by\_country\_settings', array()~~ ); |
  | 1039 |  | ~~$wcfmmp\_marketplace\_shipping\_enabled = ( !empty($wcfmmp\_marketplace\_shipping\_options) && !empty($wcfmmp\_marketplace\_shipping\_options['enabled'])~~ ) ? $wcfmmp\_marketplace\_shipping\_options['enabled'] : 'yes'; |
  | 1040 |  |  |
  | 1041 |  | ~~$wcfmmp\_marketplace\_shipping\_by\_weight\_options = get\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_weight\_settings', array()~~ ); |
  | 1042 |  | ~~$wcfmmp\_marketplace\_shipping\_by\_weight\_enabled = ( !empty($wcfmmp\_marketplace\_shipping\_by\_weight\_options) && !empty($wcfmmp\_marketplace\_shipping\_by\_weight\_options['enabled'])~~ ) ? $wcfmmp\_marketplace\_shipping\_by\_weight\_options['enabled'] : 'yes'; |
  | 1043 |  |  |
  | 1044 |  | ~~$wcfmmp\_marketplace\_shipping\_by\_distance\_options = get\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_distance\_settings', array()~~ ); |
  | 1045 |  | ~~$wcfmmp\_marketplace\_shipping\_by\_distance\_enabled = ( !empty($wcfmmp\_marketplace\_shipping\_by\_distance\_options) && !empty($wcfmmp\_marketplace\_shipping\_by\_distance\_options['enabled'])~~ ) ? $wcfmmp\_marketplace\_shipping\_by\_distance\_options['enabled'] : 'no'; |
  | 1046 |  |  |
  |  | 1042 |  |
  |  | 1043 | if (!apply\_filters('wcfm\_is\_allow\_store\_shipping', true)) return; |
  |  | 1044 |  |
  |  | 1045 | $wcfm\_shipping\_options = get\_option('wcfm\_shipping\_options', array()); |
  |  | 1046 | $wcfmmp\_store\_shipping\_enabled = isset($wcfm\_shipping\_options['enable\_store\_shipping']) ? $wcfm\_shipping\_options['enable\_store\_shipping'] : 'yes'; |
  |  | 1047 |  |
  |  | 1048 | $wcfmmp\_marketplace\_shipping\_zone\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_zone\_settings', array()); |
  |  | 1049 | $wcfmmp\_marketplace\_shipping\_zone\_enabled = (!empty($wcfmmp\_marketplace\_shipping\_zone\_options) && !empty($wcfmmp\_marketplace\_shipping\_zone\_options['enabled'])) ? $wcfmmp\_marketplace\_shipping\_zone\_options['enabled'] : 'yes'; |
  |  | 1050 |  |
  |  | 1051 | $wcfmmp\_marketplace\_shipping\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_country\_settings', array()); |
  |  | 1052 | $wcfmmp\_marketplace\_shipping\_enabled = (!empty($wcfmmp\_marketplace\_shipping\_options) && !empty($wcfmmp\_marketplace\_shipping\_options['enabled'])) ? $wcfmmp\_marketplace\_shipping\_options['enabled'] : 'yes'; |
  |  | 1053 |  |
  |  | 1054 | $wcfmmp\_marketplace\_shipping\_by\_weight\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_weight\_settings', array()); |
  |  | 1055 | $wcfmmp\_marketplace\_shipping\_by\_weight\_enabled = (!empty($wcfmmp\_marketplace\_shipping\_by\_weight\_options) && !empty($wcfmmp\_marketplace\_shipping\_by\_weight\_options['enabled'])) ? $wcfmmp\_marketplace\_shipping\_by\_weight\_options['enabled'] : 'yes'; |
  |  | 1056 |  |
  |  | 1057 | $wcfmmp\_marketplace\_shipping\_by\_distance\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_distance\_settings', array()); |
  |  | 1058 | $wcfmmp\_marketplace\_shipping\_by\_distance\_enabled = (!empty($wcfmmp\_marketplace\_shipping\_by\_distance\_options) && !empty($wcfmmp\_marketplace\_shipping\_by\_distance\_options['enabled'])) ? $wcfmmp\_marketplace\_shipping\_by\_distance\_options['enabled'] : 'no'; |
  |  | 1059 |  |
  | 1047 | 1060 | ?> |
  | 1048 | 1061 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1053) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1066) |  |
  | 1053 | 1066 | <div class="wcfm-container"> |
  | 1054 | 1067 | <div id="wcfm\_settings\_form\_shipping\_expander" class="wcfm-content"> |
  | 1055 |  | ~~<h2><?php echo esc\_attr(apply\_filters( 'wcfm\_sold\_by\_label', '', \_\_( 'Vendor', 'wc-frontend-manager' )~~ )) . ' ' . esc\_html\_\_('Shipping Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 1056 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-store-shipping/'~~ ); ?> |
  |  | 1068 | <h2><?php echo esc\_attr(apply\_filters('wcfm\_sold\_by\_label', '', \_\_('Vendor', 'wc-frontend-manager'))) . ' ' . esc\_html\_\_('Shipping Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1069 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-store-shipping/'); ?> |
  | 1057 | 1070 | <div class="wcfm\_clearfix"></div> |
  | 1058 | 1071 | <div class="store\_address"> |
  | 1059 | 1072 | <?php |
  | 1060 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_shipping', array( |
  | 1061 |  | ~~"enable\_store\_shipping" => array('label' => \_\_('Store Shipping', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $wcfmmp\_store\_shipping\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Uncheck this to disable vendor wise store shipping options.', 'wc-multivendor-marketplace' )~~ ), |
  | 1062 |  | ~~) )~~ ); |
  |  | 1073 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_shipping', array( |
  |  | 1074 | "enable\_store\_shipping" => array('label' => \_\_('Store Shipping', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $wcfmmp\_store\_shipping\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Uncheck this to disable vendor wise store shipping options.', 'wc-multivendor-marketplace')), |
  |  | 1075 | ))); |
  | 1063 | 1076 | ?> |
  | 1064 | 1077 | </div> |
  | 1065 |  |  |
  |  | 1078 |  |
  | 1066 | 1079 | <div id="wcfm\_settings\_form\_shipping\_by\_zone\_expander" class="wcfm\_store\_shipping\_fields" style="margin-top:50px;"> |
  | 1067 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Shipping By Zone', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1068 |  | <div class="wcfm\_clearfix"></div> |
  |  | 1080 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 1081 | <h2><?php \_e('Shipping By Zone', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1082 | </div> |
  |  | 1083 | <div class="wcfm\_clearfix"></div> |
  | 1069 | 1084 | <div class="store\_address"> |
  | 1070 |  |  |
  |  | 1085 |  |
  | 1071 | 1086 | <?php |
  | 1072 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_shipping\_country', array( |
  | 1073 |  | ~~"enable\_marketplace\_shipping\_zone" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_zone\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_( 'Uncheck this to disable zone wise shipping options.', 'wc-multivendor-marketplace' )~~ ), |
  | 1074 |  | ~~) )~~ ); |
  | 1075 |  | ?> |
  | 1076 |  | </div> |
  | 1077 |  | </div> |
  | 1078 |  |  |
  |  | 1087 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_shipping\_country', array( |
  |  | 1088 | "enable\_marketplace\_shipping\_zone" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_zone\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_('Uncheck this to disable zone wise shipping options.', 'wc-multivendor-marketplace')), |
  |  | 1089 | ))); |
  |  | 1090 | ?> |
  |  | 1091 | </div> |
  |  | 1092 | </div> |
  |  | 1093 |  |
  | 1079 | 1094 | <div id="wcfm\_settings\_form\_shipping\_by\_country\_expander" class="wcfm\_store\_shipping\_fields" style="margin-top:50px;"> |
  | 1080 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Shipping By Country', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1081 |  | <div class="wcfm\_clearfix"></div> |
  |  | 1095 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 1096 | <h2><?php \_e('Shipping By Country', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1097 | </div> |
  |  | 1098 | <div class="wcfm\_clearfix"></div> |
  | 1082 | 1099 | <div class="store\_address"> |
  | 1083 |  |  |
  |  | 1100 |  |
  | 1084 | 1101 | <?php |
  | 1085 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( apply\_filters( 'wcfm\_marketplace\_settings\_fields\_shipping\_country', array( |
  | 1086 |  | "enable\_marketplace\_shipping" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_( 'Uncheck this to disable country wise shipping options.', 'wc-multivendor-marketplace' ) ), |
  | 1087 |  | "store\_shipping\_break\_1" => array( 'type' => 'html', 'value' => '<div style="padding-bottom:30px;" class="wcfm\_clearfix"></div>' ), |
  | 1088 |  | ) ) ); |
  | 1089 |  | ?> |
  | 1090 |  |  |
  | 1091 |  | <div class="wcfm\_store\_shipping\_country\_fields"> |
  | 1092 |  | <?php |
  | 1093 |  | $wcfmmp\_shipping\_by\_country = get\_option( '\_wcfmmp\_shipping\_by\_country', array() ); |
  | 1094 |  |  |
  | 1095 |  | $wcfmmp\_country\_rates       = get\_option( '\_wcfmmp\_country\_rates', array() ); |
  | 1096 |  | $wcfmmp\_state\_rates         = get\_option( '\_wcfmmp\_state\_rates', array() ); |
  | 1097 |  |  |
  | 1098 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field ( |
  | 1099 |  | apply\_filters( 'wcfmmp\_settings\_fields\_shipping\_by\_country', array( |
  | 1100 |  | "wcfmmp\_shipping\_type\_price" => array('label' => \_\_('Default Shipping Price', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_shipping\_type\_price]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_shipping\_type\_price']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_shipping\_type\_price'] : '', 'hints' => \_\_('This is the base price and will be the starting shipping price for each product', 'wc-multivendor-marketplace') ), |
  | 1101 |  | "wcfmmp\_additional\_product" => array('label' => \_\_('Per Product Additional Price', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_additional\_product]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_product']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_product'] : '', 'hints' => \_\_('If a customer buys more than one type product from your store, first product of the every second type will be charged with this price', 'wc-multivendor-marketplace') ), |
  | 1102 |  | "wcfmmp\_additional\_qty" => array('label' => \_\_('Per Qty Additional Price', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_additional\_qty]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_qty']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_qty'] : '', 'hints' => \_\_('Every second product of same type will be charged with this price', 'wc-multivendor-marketplace') ), |
  | 1103 |  | "wcfmmp\_byc\_free\_shipping\_amount" => array('label' => \_\_('Free Shipping Minimum Order Amount', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_free\_shipping\_amount]', 'placeholder' => \_\_( 'NO Free Shipping', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_free\_shipping\_amount']) ? $wcfmmp\_shipping\_by\_country['\_free\_shipping\_amount'] : '', 'hints' => \_\_('Free shipping will be available if order amount more than this. Leave empty to disable Free Shipping.', 'wc-multivendor-marketplace') ), |
  | 1104 |  | "wcfmmp\_byc\_enable\_local\_pickup" => array('label' => \_\_('Enable Local Pickup', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_enable\_local\_pickup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title checkbox-title wcfm\_ele', 'value' => 'yes', 'dfvalue' => isset($wcfmmp\_shipping\_by\_country['\_enable\_local\_pickup']) ? 'yes' : '' ), |
  | 1105 |  | "wcfmmp\_byc\_local\_pickup\_cost" => array('label' => \_\_('Local Pickup Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_local\_pickup\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_local\_pickup\_cost']) ? $wcfmmp\_shipping\_by\_country['\_local\_pickup\_cost'] : '' ), |
  | 1106 |  | "wcfmmp\_form\_location" => array('label' => \_\_('Ships from:', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_form\_location]','type' => 'country', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_form\_location']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_form\_location'] : '', 'hints' => \_\_( 'Location from where the products are shipped for delivery. Usually it is same as the store.', 'wc-multivendor-marketplace' ) ), |
  | 1107 |  | ) ) |
  |  | 1102 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_shipping\_country', array( |
  |  | 1103 | "enable\_marketplace\_shipping" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_('Uncheck this to disable country wise shipping options.', 'wc-multivendor-marketplace')), |
  |  | 1104 | "store\_shipping\_break\_1" => array('type' => 'html', 'value' => '<div style="padding-bottom:30px;" class="wcfm\_clearfix"></div>'), |
  |  | 1105 | ))); |
  |  | 1106 | ?> |
  |  | 1107 |  |
  |  | 1108 | <div class="wcfm\_store\_shipping\_country\_fields"> |
  |  | 1109 | <?php |
  |  | 1110 | $wcfmmp\_shipping\_by\_country = get\_option('\_wcfmmp\_shipping\_by\_country', array()); |
  |  | 1111 |  |
  |  | 1112 | $wcfmmp\_country\_rates       = get\_option('\_wcfmmp\_country\_rates', array()); |
  |  | 1113 | $wcfmmp\_state\_rates         = get\_option('\_wcfmmp\_state\_rates', array()); |
  |  | 1114 |  |
  |  | 1115 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 1116 | apply\_filters('wcfmmp\_settings\_fields\_shipping\_by\_country', array( |
  |  | 1117 | "wcfmmp\_shipping\_type\_price" => array('label' => \_\_('Default Shipping Price', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_shipping\_type\_price]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_shipping\_type\_price']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_shipping\_type\_price'] : '', 'hints' => \_\_('This is the base price and will be the starting shipping price for each product', 'wc-multivendor-marketplace')), |
  |  | 1118 | "wcfmmp\_additional\_product" => array('label' => \_\_('Per Product Additional Price', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_additional\_product]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_product']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_product'] : '', 'hints' => \_\_('If a customer buys more than one type product from your store, first product of the every second type will be charged with this price', 'wc-multivendor-marketplace')), |
  |  | 1119 | "wcfmmp\_additional\_qty" => array('label' => \_\_('Per Qty Additional Price', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_additional\_qty]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_qty']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_additional\_qty'] : '', 'hints' => \_\_('Every second product of same type will be charged with this price', 'wc-multivendor-marketplace')), |
  |  | 1120 | "wcfmmp\_byc\_free\_shipping\_amount" => array('label' => \_\_('Free Shipping Minimum Order Amount', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_free\_shipping\_amount]', 'placeholder' => \_\_('NO Free Shipping', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_free\_shipping\_amount']) ? $wcfmmp\_shipping\_by\_country['\_free\_shipping\_amount'] : '', 'hints' => \_\_('Free shipping will be available if order amount more than this. Leave empty to disable Free Shipping.', 'wc-multivendor-marketplace')), |
  |  | 1121 | "wcfmmp\_byc\_enable\_local\_pickup" => array('label' => \_\_('Enable Local Pickup', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_enable\_local\_pickup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title checkbox-title wcfm\_ele', 'value' => 'yes', 'dfvalue' => isset($wcfmmp\_shipping\_by\_country['\_enable\_local\_pickup']) ? 'yes' : ''), |
  |  | 1122 | "wcfmmp\_byc\_local\_pickup\_cost" => array('label' => \_\_('Local Pickup Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_local\_pickup\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_local\_pickup\_cost']) ? $wcfmmp\_shipping\_by\_country['\_local\_pickup\_cost'] : ''), |
  |  | 1123 | "wcfmmp\_form\_location" => array('label' => \_\_('Ships from:', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_country[\_wcfmmp\_form\_location]', 'type' => 'country', 'class' => 'wcfm-select wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => isset($wcfmmp\_shipping\_by\_country['\_wcfmmp\_form\_location']) ? $wcfmmp\_shipping\_by\_country['\_wcfmmp\_form\_location'] : '', 'hints' => \_\_('Location from where the products are shipped for delivery. Usually it is same as the store.', 'wc-multivendor-marketplace')), |
  |  | 1124 | )) |
  |  | 1125 | ); |
  |  | 1126 |  |
  |  | 1127 | $wcfmmp\_shipping\_rates = array(); |
  |  | 1128 | $state\_options = array(); |
  |  | 1129 | if ($wcfmmp\_country\_rates) { |
  |  | 1130 | foreach ($wcfmmp\_country\_rates as $country => $country\_rate) { |
  |  | 1131 | $wcfmmp\_shipping\_state\_rates = array(); |
  |  | 1132 | $state\_options = array(); |
  |  | 1133 | if (!empty($wcfmmp\_state\_rates) && isset($wcfmmp\_state\_rates[$country])) { |
  |  | 1134 | foreach ($wcfmmp\_state\_rates[$country] as $state => $state\_rate) { |
  |  | 1135 | $state\_options[$state] = $state; |
  |  | 1136 | $wcfmmp\_shipping\_state\_rates[] = array( |
  |  | 1137 | 'wcfmmp\_state\_to' => $state, |
  |  | 1138 | 'wcfmmp\_state\_to\_price' => $state\_rate, |
  |  | 1139 | 'option\_values' => $state\_options |
  |  | 1140 | ); |
  |  | 1141 | } |
  |  | 1142 | } |
  |  | 1143 | $wcfmmp\_shipping\_rates[] = array( |
  |  | 1144 | 'wcfmmp\_country\_to' => $country, |
  |  | 1145 | 'wcfmmp\_country\_to\_price' => $country\_rate, |
  |  | 1146 | 'wcfmmp\_shipping\_state\_rates' => $wcfmmp\_shipping\_state\_rates |
  | 1108 | 1147 | ); |
  | 1109 |  |  |
  | 1110 |  | ~~$wcfmmp\_shipping\_rates = array();~~ |
  | 1111 |  | ~~$state\_options = array();~~ |
  | 1112 |  | ~~if ( $wcfmmp\_country\_rates ) {~~ |
  | 1113 |  | ~~foreach ( $wcfmmp\_country\_rates as $country => $country\_rate ) {~~ |
  | 1114 |  | ~~$wcfmmp\_shipping\_state\_rates = array();~~ |
  | 1115 |  | ~~$state\_options = array();~~ |
  | 1116 |  | ~~if ( !empty( $wcfmmp\_state\_rates ) && isset( $wcfmmp\_state\_rates[$country] ) ) {~~ |
  | 1117 |  | ~~foreach ( $wcfmmp\_state\_rates[$country] as $state => $state\_rate ) {~~ |
  | 1118 |  | ~~$state\_options[$state] = $state;~~ |
  | 1119 |  | ~~$wcfmmp\_shipping\_state\_rates[] = array(~~ |
  | 1120 |  | ~~'wcfmmp\_state\_to' => $state,~~ |
  | 1121 |  | ~~'wcfmmp\_state\_to\_price' => $state\_rate,~~ |
  | 1122 |  | ~~'option\_values' => $state\_options~~ |
  | 1123 |  | ~~);~~ |
  | 1124 |  | ~~}~~ |
  | 1125 |  | ~~}~~ |
  | 1126 |  | ~~$wcfmmp\_shipping\_rates[] = array(~~ |
  | 1127 |  | ~~'wcfmmp\_country\_to' => $country,~~ |
  | 1128 |  | ~~'wcfmmp\_country\_to\_price' => $country\_rate,~~ |
  | 1129 |  | ~~'wcfmmp\_shipping\_state\_rates' => $wcfmmp\_shipping\_state\_rates~~ |
  | 1130 |  | ~~);~~ |
  | 1131 |  | ~~}~~ |
  | 1132 | 1148 | } |
  | 1133 |  |  |
  | 1134 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  | 1135 |  | apply\_filters( 'wcfmmp\_settings\_fields\_shipping\_rates\_by\_country', array( |
  | 1136 |  | "wcfmmp\_shipping\_rates" => array( |
  | 1137 |  | 'label' => \_\_('Shipping Rates by Country', 'wc-multivendor-marketplace') , |
  | 1138 |  | 'type' => 'multiinput', |
  | 1139 |  | 'class' => 'wcfm\_admin\_shipping\_setting\_block', |
  | 1140 |  | 'label\_class' => 'wcfm\_title wcfm\_full\_title', |
  | 1141 |  | 'value' => $wcfmmp\_shipping\_rates, |
  | 1142 |  | 'desc' => \_\_( 'Add the countries you deliver your products to. You can specify states as well. If the shipping price is same except some countries, there is an option Everywhere Else, you can use that.', 'wc-multivendor-marketplace' ), |
  | 1143 |  | 'desc\_class' => 'instructions', |
  |  | 1149 | } |
  |  | 1150 |  |
  |  | 1151 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 1152 | apply\_filters('wcfmmp\_settings\_fields\_shipping\_rates\_by\_country', array( |
  |  | 1153 | "wcfmmp\_shipping\_rates" => array( |
  |  | 1154 | 'label' => \_\_('Shipping Rates by Country', 'wc-multivendor-marketplace'), |
  |  | 1155 | 'type' => 'multiinput', |
  |  | 1156 | 'class' => 'wcfm\_admin\_shipping\_setting\_block', |
  |  | 1157 | 'label\_class' => 'wcfm\_title wcfm\_full\_title', |
  |  | 1158 | 'value' => $wcfmmp\_shipping\_rates, |
  |  | 1159 | 'desc' => \_\_('Add the countries you deliver your products to. You can specify states as well. If the shipping price is same except some countries, there is an option Everywhere Else, you can use that.', 'wc-multivendor-marketplace'), |
  |  | 1160 | 'desc\_class' => 'instructions', |
  |  | 1161 | 'options' => array( |
  |  | 1162 | "wcfmmp\_country\_to" => array( |
  |  | 1163 | 'label' => \_\_('Country', 'wc-multivendor-marketplace'), |
  |  | 1164 | 'type' => 'country', |
  |  | 1165 | 'wcfmmp\_shipping\_country' => 1, |
  |  | 1166 | 'class' => 'wcfm-select wcfmmp\_country\_to\_select', |
  |  | 1167 | 'label\_class' => 'wcfm\_title' |
  |  | 1168 | ), |
  |  | 1169 | "wcfmmp\_country\_to\_price" => array( |
  |  | 1170 | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', |
  |  | 1171 | 'type' => 'number', |
  |  | 1172 | 'dfvalue' => 0, |
  |  | 1173 | 'placeholder' => '0.00', |
  |  | 1174 | 'class' => 'wcfm-text', |
  |  | 1175 | 'label\_class' => 'wcfm\_title' |
  |  | 1176 | ), |
  |  | 1177 | "wcfmmp\_shipping\_state\_rates" => array( |
  |  | 1178 | 'label' => \_\_('State Shipping Rates', 'wc-multivendor-marketplace'), |
  |  | 1179 | 'type' => 'multiinput', |
  |  | 1180 | 'label\_class' => 'wcfm\_title wcfmmp\_shipping\_state\_rates\_label', |
  | 1144 | 1181 | 'options' => array( |
  | 1145 |  | "wcfmmp\_country\_to" => array( |
  | 1146 |  | 'label' => \_\_('Country', 'wc-multivendor-marketplace'), |
  | 1147 |  | 'type' => 'country', |
  | 1148 |  | 'wcfmmp\_shipping\_country' => 1, |
  | 1149 |  | 'class' => 'wcfm-select wcfmmp\_country\_to\_select', |
  | 1150 |  | 'label\_class' => 'wcfm\_title' |
  | 1151 |  | ), |
  | 1152 |  | "wcfmmp\_country\_to\_price" => array( |
  | 1153 |  | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . '('.get\_woocommerce\_currency\_symbol().')', |
  | 1154 |  | 'type' => 'number', |
  | 1155 |  | 'dfvalue' => 0, |
  | 1156 |  | 'placeholder' => '0.00', |
  | 1157 |  | 'class' => 'wcfm-text', |
  | 1158 |  | 'label\_class' => 'wcfm\_title' |
  | 1159 |  | ), |
  | 1160 |  | "wcfmmp\_shipping\_state\_rates" => array( |
  | 1161 |  | 'label' => \_\_('State Shipping Rates', 'wc-multivendor-marketplace'), |
  | 1162 |  | 'type' => 'multiinput', |
  | 1163 |  | 'label\_class' => 'wcfm\_title wcfmmp\_shipping\_state\_rates\_label', |
  | 1164 |  | 'options' => array( |
  | 1165 |  | "wcfmmp\_state\_to" => array( |
  | 1166 |  | 'label' => \_\_('State', 'wc-multivendor-marketplace'), |
  | 1167 |  | 'type' => 'select', 'class' => 'wcfm-select wcfmmp\_state\_to\_select', |
  | 1168 |  | 'label\_class' => 'wcfm\_title', |
  | 1169 |  | 'options' => $state\_options |
  | 1170 |  | ), |
  | 1171 |  | "wcfmmp\_state\_to\_price" => array( |
  | 1172 |  | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . '('.get\_woocommerce\_currency\_symbol().')', |
  | 1173 |  | 'type' => 'number', |
  | 1174 |  | 'dfvalue' => 0, |
  | 1175 |  | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  | 1176 |  | 'class' => 'wcfm-text', |
  | 1177 |  | 'label\_class' => 'wcfm\_title' |
  | 1178 |  | ), |
  | 1179 |  |  |
  | 1180 |  | ) |
  | 1181 |  | ) |
  | 1182 |  | ) |
  |  | 1182 | "wcfmmp\_state\_to" => array( |
  |  | 1183 | 'label' => \_\_('State', 'wc-multivendor-marketplace'), |
  |  | 1184 | 'type' => 'select', 'class' => 'wcfm-select wcfmmp\_state\_to\_select', |
  |  | 1185 | 'label\_class' => 'wcfm\_title', |
  |  | 1186 | 'options' => $state\_options |
  |  | 1187 | ), |
  |  | 1188 | "wcfmmp\_state\_to\_price" => array( |
  |  | 1189 | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . '(' . get\_woocommerce\_currency\_symbol() . ')', |
  |  | 1190 | 'type' => 'number', |
  |  | 1191 | 'dfvalue' => 0, |
  |  | 1192 | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  |  | 1193 | 'class' => 'wcfm-text', |
  |  | 1194 | 'label\_class' => 'wcfm\_title' |
  |  | 1195 | ), |
  |  | 1196 |  |
  |  | 1197 | ) |
  |  | 1198 | ) |
  | 1183 | 1199 | ) |
  | 1184 |  | ) ) |
  | 1185 |  | ); |
  |  | 1200 | ) |
  |  | 1201 | )) |
  |  | 1202 | ); |
  | 1186 | 1203 | ?> |
  | 1187 | 1204 | </div> |
  | 1188 |  | </div> |
  | 1189 |  | </div> |
  | 1190 |  |  |
  | 1191 |  |  |
  |  | 1205 | </div> |
  |  | 1206 | </div> |
  |  | 1207 |  |
  |  | 1208 |  |
  | 1192 | 1209 | <div id="wcfm\_settings\_form\_shipping\_by\_weight\_expander" class="wcfm\_store\_shipping\_fields" style="margin-top:50px;"> |
  | 1193 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Shipping By Weight', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1194 |  | <div class="wcfm\_clearfix"></div> |
  |  | 1210 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 1211 | <h2><?php \_e('Shipping By Weight', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1212 | </div> |
  |  | 1213 | <div class="wcfm\_clearfix"></div> |
  | 1195 | 1214 | <div class="store\_address"> |
  | 1196 |  |  |
  |  | 1215 |  |
  | 1197 | 1216 | <?php |
  | 1198 |  | $wcfmmp\_shipping\_by\_weight = get\_option(~~'\_wcfmmp\_shipping\_by\_weight', array()~~ ); |
  | 1199 |  |  |
  | 1200 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters( 'wcfm\_marketplace\_settings\_fields\_shipping\_weight', array(~~ |
  | 1201 |  | ~~"enable\_marketplace\_shipping\_by\_weight" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_by\_weight\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_( 'Uncheck this to disable weight based shipping options.', 'wc-multivendor-marketplace' )~~ ), |
  | 1202 |  | ~~"store\_shipping\_break\_2" => array( 'type' => 'html', 'value' => '<div style="padding-bottom:30px;" class="wcfm\_clearfix"></div>'~~ ), |
  | 1203 |  | ~~"wcfmmp\_byw\_free\_shipping\_amount" => array('label' => \_\_('Free Shipping Minimum Order Amount', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_weight[\_free\_shipping\_amount]', 'placeholder' => \_\_( 'NO Free Shipping', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'value' => isset($wcfmmp\_shipping\_by\_weight['\_free\_shipping\_amount']) ? $wcfmmp\_shipping\_by\_weight['\_free\_shipping\_amount'] : '', 'hints' => \_\_('Free shipping will be available if order amount more than this. Leave empty to disable Free Shipping.', 'wc-multivendor-marketplace')~~ ), |
  | 1204 |  | ~~"wcfmmp\_byw\_enable\_local\_pickup" => array('label' => \_\_('Enable Local Pickup', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_weight[\_enable\_local\_pickup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'label\_class' => 'wcfm\_title checkbox\_title checkbox-title wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'value' => 'yes', 'dfvalue' => isset($wcfmmp\_shipping\_by\_weight['\_enable\_local\_pickup']) ? 'yes' : ''~~ ), |
  | 1205 |  | ~~"wcfmmp\_byw\_local\_pickup\_cost" => array('label' => \_\_('Local Pickup Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_weight[\_local\_pickup\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'value' => isset($wcfmmp\_shipping\_by\_weight['\_local\_pickup\_cost']) ? $wcfmmp\_shipping\_by\_weight['\_local\_pickup\_cost'] : ''~~ ), |
  | 1206 |  | ~~) )~~ ); |
  |  | 1217 | $wcfmmp\_shipping\_by\_weight = get\_option('\_wcfmmp\_shipping\_by\_weight', array()); |
  |  | 1218 |  |
  |  | 1219 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_shipping\_weight', array( |
  |  | 1220 | "enable\_marketplace\_shipping\_by\_weight" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_by\_weight\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_('Uncheck this to disable weight based shipping options.', 'wc-multivendor-marketplace')), |
  |  | 1221 | "store\_shipping\_break\_2" => array('type' => 'html', 'value' => '<div style="padding-bottom:30px;" class="wcfm\_clearfix"></div>'), |
  |  | 1222 | "wcfmmp\_byw\_free\_shipping\_amount" => array('label' => \_\_('Free Shipping Minimum Order Amount', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_weight[\_free\_shipping\_amount]', 'placeholder' => \_\_('NO Free Shipping', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'value' => isset($wcfmmp\_shipping\_by\_weight['\_free\_shipping\_amount']) ? $wcfmmp\_shipping\_by\_weight['\_free\_shipping\_amount'] : '', 'hints' => \_\_('Free shipping will be available if order amount more than this. Leave empty to disable Free Shipping.', 'wc-multivendor-marketplace')), |
  |  | 1223 | "wcfmmp\_byw\_enable\_local\_pickup" => array('label' => \_\_('Enable Local Pickup', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_weight[\_enable\_local\_pickup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'label\_class' => 'wcfm\_title checkbox\_title checkbox-title wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'value' => 'yes', 'dfvalue' => isset($wcfmmp\_shipping\_by\_weight['\_enable\_local\_pickup']) ? 'yes' : ''), |
  |  | 1224 | "wcfmmp\_byw\_local\_pickup\_cost" => array('label' => \_\_('Local Pickup Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_weight[\_local\_pickup\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_weight\_fields', 'value' => isset($wcfmmp\_shipping\_by\_weight['\_local\_pickup\_cost']) ? $wcfmmp\_shipping\_by\_weight['\_local\_pickup\_cost'] : ''), |
  |  | 1225 | ))); |
  | 1207 | 1226 | ?> |
  | 1208 |  |  |
  |  | 1227 |  |
  | 1209 | 1228 | <div class="wcfm\_store\_shipping\_weight\_fields"> |
  | 1210 |  | <?php |
  | 1211 |  | $weight\_unit = strtolower( get\_option( 'woocommerce\_weight\_unit' ) ); |
  | 1212 |  | $wcfmmp\_country\_weight\_rates       = get\_option( '\_wcfmmp\_country\_weight\_rates', array() ); |
  | 1213 |  | $wcfmmp\_country\_weight\_mode  = get\_option( '\_wcfmmp\_country\_weight\_mode', array() ); |
  | 1214 |  | $wcfmmp\_country\_weight\_unit\_cost  = get\_option( '\_wcfmmp\_country\_weight\_unit\_cost', array() ); |
  | 1215 |  | $wcfmmp\_country\_weight\_default\_costs  = get\_option( '\_wcfmmp\_country\_weight\_default\_costs', array() ); |
  | 1216 |  | $wcfmmp\_country\_weight\_shipping\_value = array(); |
  | 1217 |  | if( $wcfmmp\_country\_weight\_rates ) { |
  | 1218 |  | foreach ($wcfmmp\_country\_weight\_rates as $country => $each\_rate ) { |
  | 1219 |  | $wcfmmp\_country\_weight\_shipping\_value[] = array( |
  | 1220 |  | 'wcfmmp\_weightwise\_country\_to' => $country, |
  | 1221 |  | 'wcfmmp\_weightwise\_country\_mode' => isset( $wcfmmp\_country\_weight\_mode[$country]) ? $wcfmmp\_country\_weight\_mode[$country] : 'by\_rule', |
  | 1222 |  | 'wcfmmp\_weightwise\_country\_per\_unit\_cost' => isset( $wcfmmp\_country\_weight\_unit\_cost[$country]) ? $wcfmmp\_country\_weight\_unit\_cost[$country] : 0, |
  | 1223 |  | 'wcfmmp\_weightwise\_country\_default\_cost' => isset( $wcfmmp\_country\_weight\_default\_costs[$country]) ? $wcfmmp\_country\_weight\_default\_costs[$country] : 0, |
  | 1224 |  | 'wcfmmp\_shipping\_country\_weight\_settings' => $each\_rate |
  | 1225 |  | ); |
  | 1226 |  | } |
  |  | 1229 | <?php |
  |  | 1230 | $weight\_unit = strtolower(get\_option('woocommerce\_weight\_unit')); |
  |  | 1231 | $wcfmmp\_country\_weight\_rates       = get\_option('\_wcfmmp\_country\_weight\_rates', array()); |
  |  | 1232 | $wcfmmp\_country\_weight\_mode  = get\_option('\_wcfmmp\_country\_weight\_mode', array()); |
  |  | 1233 | $wcfmmp\_country\_weight\_unit\_cost  = get\_option('\_wcfmmp\_country\_weight\_unit\_cost', array()); |
  |  | 1234 | $wcfmmp\_country\_weight\_default\_costs  = get\_option('\_wcfmmp\_country\_weight\_default\_costs', array()); |
  |  | 1235 | $wcfmmp\_country\_weight\_shipping\_value = array(); |
  |  | 1236 | if ($wcfmmp\_country\_weight\_rates) { |
  |  | 1237 | foreach ($wcfmmp\_country\_weight\_rates as $country => $each\_rate) { |
  |  | 1238 | $wcfmmp\_country\_weight\_shipping\_value[] = array( |
  |  | 1239 | 'wcfmmp\_weightwise\_country\_to' => $country, |
  |  | 1240 | 'wcfmmp\_weightwise\_country\_mode' => isset($wcfmmp\_country\_weight\_mode[$country]) ? $wcfmmp\_country\_weight\_mode[$country] : 'by\_rule', |
  |  | 1241 | 'wcfmmp\_weightwise\_country\_per\_unit\_cost' => isset($wcfmmp\_country\_weight\_unit\_cost[$country]) ? $wcfmmp\_country\_weight\_unit\_cost[$country] : 0, |
  |  | 1242 | 'wcfmmp\_weightwise\_country\_default\_cost' => isset($wcfmmp\_country\_weight\_default\_costs[$country]) ? $wcfmmp\_country\_weight\_default\_costs[$country] : 0, |
  |  | 1243 | 'wcfmmp\_shipping\_country\_weight\_settings' => $each\_rate |
  |  | 1244 | ); |
  | 1227 | 1245 | } |
  | 1228 |  |  |
  | 1229 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  | 1230 |  | apply\_filters( 'wcfmmp\_settings\_fields\_shipping\_rates\_by\_weight', array( |
  | 1231 |  | "wcfmmp\_shipping\_rates\_by\_weight" => array( |
  | 1232 |  | 'label' => \_\_('Country and Weight wise Shipping Rate Calculation', 'wc-multivendor-marketplace') , |
  | 1233 |  | 'type' => 'multiinput', |
  | 1234 |  | 'class' => 'wcfm\_admin\_shipping\_setting\_block', |
  | 1235 |  | 'label\_class' => 'wcfm\_title wcfm\_full\_title', |
  | 1236 |  | 'value' => $wcfmmp\_country\_weight\_shipping\_value, |
  | 1237 |  | 'desc' => \_\_( 'Add the countries you deliver your products to and specify rates for weight range. If the shipping price is same except some countries/states, there is an option Everywhere Else, you can use that.', 'wc-multivendor-marketplace' ), |
  | 1238 |  | 'desc\_class' => 'instructions', |
  |  | 1246 | } |
  |  | 1247 |  |
  |  | 1248 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 1249 | apply\_filters('wcfmmp\_settings\_fields\_shipping\_rates\_by\_weight', array( |
  |  | 1250 | "wcfmmp\_shipping\_rates\_by\_weight" => array( |
  |  | 1251 | 'label' => \_\_('Country and Weight wise Shipping Rate Calculation', 'wc-multivendor-marketplace'), |
  |  | 1252 | 'type' => 'multiinput', |
  |  | 1253 | 'class' => 'wcfm\_admin\_shipping\_setting\_block', |
  |  | 1254 | 'label\_class' => 'wcfm\_title wcfm\_full\_title', |
  |  | 1255 | 'value' => $wcfmmp\_country\_weight\_shipping\_value, |
  |  | 1256 | 'desc' => \_\_('Add the countries you deliver your products to and specify rates for weight range. If the shipping price is same except some countries/states, there is an option Everywhere Else, you can use that.', 'wc-multivendor-marketplace'), |
  |  | 1257 | 'desc\_class' => 'instructions', |
  |  | 1258 | 'options' => array( |
  |  | 1259 | "wcfmmp\_weightwise\_country\_to" => array( |
  |  | 1260 | 'label' => \_\_('Country', 'wc-multivendor-marketplace'), |
  |  | 1261 | 'type' => 'country', |
  |  | 1262 | 'wcfmmp\_shipping\_country' => 1, |
  |  | 1263 | 'class' => 'wcfm-select wcfmmp\_weightwise\_country\_to\_select', |
  |  | 1264 | 'label\_class' => 'wcfm\_title' |
  |  | 1265 | ), |
  |  | 1266 | "wcfmmp\_weightwise\_country\_mode" => array( |
  |  | 1267 | 'label' => \_\_('Calculate cost', 'wc-multivendor-marketplace'), |
  |  | 1268 | 'type' => 'select', |
  |  | 1269 | 'class' => 'wcfm-select wcfmmp\_weightwise\_country\_mode\_select', |
  |  | 1270 | 'label\_class' => 'wcfm\_title', |
  |  | 1271 | 'options' => array('by\_rule' => \_\_('Based on rules', 'wc-multivendor-marketplace'), 'by\_unit' => \_\_('Per unit cost', 'wc-multivendor-marketplace')), |
  |  | 1272 | ), |
  |  | 1273 | "wcfmmp\_weightwise\_country\_per\_unit\_cost" => array( |
  |  | 1274 | 'label' => \_\_('Per unit cost', 'wc-multivendor-marketplace') . ' (' . get\_woocommerce\_currency\_symbol() . '/' . get\_option('woocommerce\_weight\_unit', 'kg') . ')', |
  |  | 1275 | 'type' => 'number', |
  |  | 1276 | 'dfvalue' => 0, |
  |  | 1277 | 'placeholder' => '0.00', |
  |  | 1278 | 'class' => 'wcfm-text wcfm\_ele wcfmmp\_weightwise\_country\_default\_weight\_text wcfmmp\_weightwise\_country\_mode\_by\_unit', |
  |  | 1279 | 'label\_class' => 'wcfm\_title wcfmmp\_weightwise\_country\_mode\_by\_unit', |
  |  | 1280 | 'desc' => \_\_('Shipping cost will be calculated by <b>Per unit cost x Product weight</b>', 'wc-multivendor-marketplace'), |
  |  | 1281 | 'desc\_class' => 'wcfm\_page\_options\_desc wcfmmp\_weightwise\_country\_mode\_by\_unit', |
  |  | 1282 | ), |
  |  | 1283 | "wcfmmp\_weightwise\_country\_default\_cost" => array( |
  |  | 1284 | 'label' => \_\_('Default cost if no matching rule', 'wc-multivendor-marketplace') . ' (' . get\_woocommerce\_currency\_symbol() . ')', |
  |  | 1285 | 'type' => 'number', |
  |  | 1286 | 'dfvalue' => 0, |
  |  | 1287 | 'placeholder' => '0.00', |
  |  | 1288 | 'class' => 'wcfm-text wcfm\_ele wcfmmp\_weightwise\_country\_default\_weight\_text wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  |  | 1289 | 'label\_class' => 'wcfm\_title wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  |  | 1290 | ), |
  |  | 1291 | "wcfmmp\_shipping\_country\_weight\_settings" => array( |
  |  | 1292 | 'label' => \_\_('Weight-Cost Rules', 'wc-multivendor-marketplace'), |
  |  | 1293 | 'type' => 'multiinput', |
  |  | 1294 | 'class' => 'wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  |  | 1295 | 'label\_class' => 'wcfm\_title wcfmmp\_shipping\_weight\_rates\_label wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  |  | 1296 | 'options' => array( |
  |  | 1297 | "wcfmmp\_weight\_rule" => array( |
  |  | 1298 | 'label' => \_\_('Weight Rule', 'wc-multivendor-marketplace'), |
  |  | 1299 | 'type' => 'select', |
  |  | 1300 | 'class' => 'wcfm-select wcfmmp\_weight\_rule\_select', |
  |  | 1301 | 'label\_class' => 'wcfm\_title', |
  | 1239 | 1302 | 'options' => array( |
  | 1240 |  | "wcfmmp\_weightwise\_country\_to" => array( |
  | 1241 |  | 'label' => \_\_('Country', 'wc-multivendor-marketplace'), |
  | 1242 |  | 'type' => 'country', |
  | 1243 |  | 'wcfmmp\_shipping\_country' => 1, |
  | 1244 |  | 'class' => 'wcfm-select wcfmmp\_weightwise\_country\_to\_select', |
  | 1245 |  | 'label\_class' => 'wcfm\_title' |
  | 1246 |  | ), |
  | 1247 |  | "wcfmmp\_weightwise\_country\_mode" => array( |
  | 1248 |  | 'label' => \_\_('Calculate cost', 'wc-multivendor-marketplace'), |
  | 1249 |  | 'type' => 'select', |
  | 1250 |  | 'class' => 'wcfm-select wcfmmp\_weightwise\_country\_mode\_select', |
  | 1251 |  | 'label\_class' => 'wcfm\_title', |
  | 1252 |  | 'options' => array( 'by\_rule' => \_\_( 'Based on rules', 'wc-multivendor-marketplace' ), 'by\_unit' => \_\_( 'Per unit cost', 'wc-multivendor-marketplace' ) ), |
  | 1253 |  | ), |
  | 1254 |  | "wcfmmp\_weightwise\_country\_per\_unit\_cost" => array( |
  | 1255 |  | 'label' => \_\_('Per unit cost', 'wc-multivendor-marketplace') . ' ('.get\_woocommerce\_currency\_symbol().'/'. get\_option( 'woocommerce\_weight\_unit', 'kg' ) . ')', |
  | 1256 |  | 'type' => 'number', |
  | 1257 |  | 'dfvalue' => 0, |
  | 1258 |  | 'placeholder' => '0.00', |
  | 1259 |  | 'class' => 'wcfm-text wcfm\_ele wcfmmp\_weightwise\_country\_default\_weight\_text wcfmmp\_weightwise\_country\_mode\_by\_unit', |
  | 1260 |  | 'label\_class' => 'wcfm\_title wcfmmp\_weightwise\_country\_mode\_by\_unit', |
  | 1261 |  | 'desc' => \_\_( 'Shipping cost will be calculated by <b>Per unit cost x Product weight</b>', 'wc-multivendor-marketplace' ), |
  | 1262 |  | 'desc\_class' => 'wcfm\_page\_options\_desc wcfmmp\_weightwise\_country\_mode\_by\_unit', |
  | 1263 |  | ), |
  | 1264 |  | "wcfmmp\_weightwise\_country\_default\_cost" => array( |
  | 1265 |  | 'label' => \_\_('Default cost if no matching rule', 'wc-multivendor-marketplace') . ' ('.get\_woocommerce\_currency\_symbol().')', |
  | 1266 |  | 'type' => 'number', |
  | 1267 |  | 'dfvalue' => 0, |
  | 1268 |  | 'placeholder' => '0.00', |
  | 1269 |  | 'class' => 'wcfm-text wcfm\_ele wcfmmp\_weightwise\_country\_default\_weight\_text wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  | 1270 |  | 'label\_class' => 'wcfm\_title wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  | 1271 |  | ), |
  | 1272 |  | "wcfmmp\_shipping\_country\_weight\_settings" => array( |
  | 1273 |  | 'label' => \_\_('Weight-Cost Rules', 'wc-multivendor-marketplace'), |
  | 1274 |  | 'type' => 'multiinput', |
  | 1275 |  | 'class' => 'wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  | 1276 |  | 'label\_class' => 'wcfm\_title wcfmmp\_shipping\_weight\_rates\_label wcfmmp\_weightwise\_country\_mode\_by\_rule', |
  | 1277 |  | 'options' => array( |
  | 1278 |  | "wcfmmp\_weight\_rule" => array( |
  | 1279 |  | 'label' => \_\_('Weight Rule', 'wc-multivendor-marketplace'), |
  | 1280 |  | 'type' => 'select', |
  | 1281 |  | 'class' => 'wcfm-select wcfmmp\_weight\_rule\_select', |
  | 1282 |  | 'label\_class' => 'wcfm\_title', |
  | 1283 |  | 'options' => array( |
  | 1284 |  | 'up\_to' => \_\_('Weight up to', 'wc-multivendor-marketplace'), |
  | 1285 |  | 'more\_than' => \_\_('Weight more than', 'wc-multivendor-marketplace') |
  | 1286 |  | ) |
  | 1287 |  | ), |
  | 1288 |  | "wcfmmp\_weight\_unit" => array( |
  | 1289 |  | 'label' => \_\_('Weight', 'wc-multivendor-marketplace') . ' ('.$weight\_unit.')', |
  | 1290 |  | 'type' => 'number', |
  | 1291 |  | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  | 1292 |  | 'class' => 'wcfm-text', |
  | 1293 |  | 'label\_class' => 'wcfm\_title' |
  | 1294 |  | ), |
  | 1295 |  | "wcfmmp\_weight\_price" => array( |
  | 1296 |  | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . ' ('.get\_woocommerce\_currency\_symbol().')', |
  | 1297 |  | 'type' => 'number', |
  | 1298 |  | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  | 1299 |  | 'class' => 'wcfm-text', |
  | 1300 |  | 'label\_class' => 'wcfm\_title' |
  | 1301 |  | ), |
  | 1302 |  |  |
  | 1303 |  | ) |
  | 1304 |  | ) |
  |  | 1303 | 'up\_to' => \_\_('Weight up to', 'wc-multivendor-marketplace'), |
  |  | 1304 | 'more\_than' => \_\_('Weight more than', 'wc-multivendor-marketplace') |
  | 1305 | 1305 | ) |
  |  | 1306 | ), |
  |  | 1307 | "wcfmmp\_weight\_unit" => array( |
  |  | 1308 | 'label' => \_\_('Weight', 'wc-multivendor-marketplace') . ' (' . $weight\_unit . ')', |
  |  | 1309 | 'type' => 'number', |
  |  | 1310 | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  |  | 1311 | 'class' => 'wcfm-text', |
  |  | 1312 | 'label\_class' => 'wcfm\_title' |
  |  | 1313 | ), |
  |  | 1314 | "wcfmmp\_weight\_price" => array( |
  |  | 1315 | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . ' (' . get\_woocommerce\_currency\_symbol() . ')', |
  |  | 1316 | 'type' => 'number', |
  |  | 1317 | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  |  | 1318 | 'class' => 'wcfm-text', |
  |  | 1319 | 'label\_class' => 'wcfm\_title' |
  |  | 1320 | ), |
  |  | 1321 |  |
  | 1306 | 1322 | ) |
  | 1307 |  | )) |
  | 1308 |  | ); |
  | 1309 |  | ?> |
  | 1310 |  | </div> |
  | 1311 |  | </div> |
  | 1312 |  | </div> |
  | 1313 |  |  |
  | 1314 |  | <div id="wcfm\_settings\_form\_shipping\_by\_distance\_expander" class="wcfm\_store\_shipping\_fields" style="margin-top:50px;"> |
  | 1315 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Shipping By Distance', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1316 |  | <div class="wcfm\_clearfix"></div> |
  |  | 1323 | ) |
  |  | 1324 | ) |
  |  | 1325 | ) |
  |  | 1326 | )) |
  |  | 1327 | ); |
  |  | 1328 | ?> |
  |  | 1329 | </div> |
  |  | 1330 | </div> |
  |  | 1331 | </div> |
  |  | 1332 |  |
  |  | 1333 | <div id="wcfm\_settings\_form\_shipping\_by\_distance\_expander" class="wcfm\_store\_shipping\_fields" style="margin-top:50px;"> |
  |  | 1334 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 1335 | <h2><?php \_e('Shipping By Distance', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1336 | </div> |
  |  | 1337 | <div class="wcfm\_clearfix"></div> |
  | 1317 | 1338 | <div class="store\_address"> |
  | 1318 |  |  |
  |  | 1339 |  |
  | 1319 | 1340 | <?php |
  | 1320 |  | $radius\_unit   = isset(~~$WCFMmp->wcfmmp\_marketplace\_options['radius\_unit']~~ ) ? $WCFMmp->wcfmmp\_marketplace\_options['radius\_unit'] : 'km'; |
  | 1321 |  | $wcfmmp\_shipping\_by\_distance = get\_option(~~'\_wcfmmp\_shipping\_by\_distance', array()~~ ); |
  | 1322 |  |  |
  | 1323 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters( 'wcfm\_marketplace\_settings\_fields\_shipping\_distance', array(~~ |
  | 1324 |  | ~~"enable\_marketplace\_shipping\_by\_distance" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_by\_distance\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_( 'Uncheck this to disable distance based shipping options.', 'wc-multivendor-marketplace' )~~ ), |
  | 1325 |  | ~~"store\_shipping\_break\_22" => array( 'type' => 'html', 'value' => '<div style="padding-bottom:30px;" class="wcfm\_clearfix"></div>'~~ ), |
  | 1326 |  | ~~"wcfmmp\_byd\_default\_cost" => array('label' => \_\_('Default Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_default\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_default\_cost']) ? $wcfmmp\_shipping\_by\_distance['\_default\_cost'] : '', 'hints' => \_\_('Default shipping cost, will be added with distance rule cost. Leave empty to consider default cost as `0`.', 'wc-multivendor-marketplace')~~ ), |
  | 1327 |  | ~~"wcfmmp\_byd\_max\_distance" => array('label' => \_\_('Max Distance', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_max\_distance]', 'placeholder' => \_\_('No Limit', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_max\_distance']) ? $wcfmmp\_shipping\_by\_distance['\_max\_distance'] : '', 'hints' => \_\_('Upto maximum distance shipping supported. Leave empty to consider no limit.', 'wc-multivendor-marketplace')~~ ), |
  | 1328 |  | ~~"wcfmmp\_byd\_free\_shipping\_amount" => array('label' => \_\_('Free Shipping Minimum Order Amount', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_free\_shipping\_amount]', 'placeholder' => \_\_( 'NO Free Shipping', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_free\_shipping\_amount']) ? $wcfmmp\_shipping\_by\_distance['\_free\_shipping\_amount'] : '', 'hints' => \_\_('Free shipping will be available if order amount more than this. Leave empty to disable Free Shipping.', 'wc-multivendor-marketplace')~~ ), |
  | 1329 |  | ~~"wcfmmp\_byd\_enable\_local\_pickup" => array('label' => \_\_('Enable Local Pickup', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_enable\_local\_pickup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title checkbox\_title checkbox-title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => 'yes', 'dfvalue' => isset($wcfmmp\_shipping\_by\_distance['\_enable\_local\_pickup']) ? 'yes' : ''~~ ), |
  | 1330 |  | ~~"wcfmmp\_byd\_local\_pickup\_cost" => array('label' => \_\_('Local Pickup Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_local\_pickup\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_local\_pickup\_cost']) ? $wcfmmp\_shipping\_by\_distance['\_local\_pickup\_cost'] : ''~~ ), |
  | 1331 |  | ~~) )~~ ); |
  |  | 1341 | $radius\_unit   = isset($WCFMmp->wcfmmp\_marketplace\_options['radius\_unit']) ? $WCFMmp->wcfmmp\_marketplace\_options['radius\_unit'] : 'km'; |
  |  | 1342 | $wcfmmp\_shipping\_by\_distance = get\_option('\_wcfmmp\_shipping\_by\_distance', array()); |
  |  | 1343 |  |
  |  | 1344 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_shipping\_distance', array( |
  |  | 1345 | "enable\_marketplace\_shipping\_by\_distance" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_store\_shipping\_fields', 'value' => 'yes', 'dfvalue' => $wcfmmp\_marketplace\_shipping\_by\_distance\_enabled, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_store\_shipping\_fields', 'desc' => \_\_('Uncheck this to disable distance based shipping options.', 'wc-multivendor-marketplace')), |
  |  | 1346 | "store\_shipping\_break\_22" => array('type' => 'html', 'value' => '<div style="padding-bottom:30px;" class="wcfm\_clearfix"></div>'), |
  |  | 1347 | "wcfmmp\_byd\_default\_cost" => array('label' => \_\_('Default Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_default\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_default\_cost']) ? $wcfmmp\_shipping\_by\_distance['\_default\_cost'] : '', 'hints' => \_\_('Default shipping cost, will be added with distance rule cost. Leave empty to consider default cost as `0`.', 'wc-multivendor-marketplace')), |
  |  | 1348 | "wcfmmp\_byd\_max\_distance" => array('label' => \_\_('Max Distance', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_max\_distance]', 'placeholder' => \_\_('No Limit', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_max\_distance']) ? $wcfmmp\_shipping\_by\_distance['\_max\_distance'] : '', 'hints' => \_\_('Upto maximum distance shipping supported. Leave empty to consider no limit.', 'wc-multivendor-marketplace')), |
  |  | 1349 | "wcfmmp\_byd\_free\_shipping\_amount" => array('label' => \_\_('Free Shipping Minimum Order Amount', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_free\_shipping\_amount]', 'placeholder' => \_\_('NO Free Shipping', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_free\_shipping\_amount']) ? $wcfmmp\_shipping\_by\_distance['\_free\_shipping\_amount'] : '', 'hints' => \_\_('Free shipping will be available if order amount more than this. Leave empty to disable Free Shipping.', 'wc-multivendor-marketplace')), |
  |  | 1350 | "wcfmmp\_byd\_enable\_local\_pickup" => array('label' => \_\_('Enable Local Pickup', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_enable\_local\_pickup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title checkbox\_title checkbox-title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => 'yes', 'dfvalue' => isset($wcfmmp\_shipping\_by\_distance['\_enable\_local\_pickup']) ? 'yes' : ''), |
  |  | 1351 | "wcfmmp\_byd\_local\_pickup\_cost" => array('label' => \_\_('Local Pickup Cost', 'wc-multivendor-marketplace'), 'name' => 'wcfmmp\_shipping\_by\_distance[\_local\_pickup\_cost]', 'placeholder' => '0.00', 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_store\_shipping\_distance\_fields', 'value' => isset($wcfmmp\_shipping\_by\_distance['\_local\_pickup\_cost']) ? $wcfmmp\_shipping\_by\_distance['\_local\_pickup\_cost'] : ''), |
  |  | 1352 | ))); |
  | 1332 | 1353 | ?> |
  | 1333 |  |  |
  |  | 1354 |  |
  | 1334 | 1355 | <div class="wcfm\_store\_shipping\_distance\_fields"> |
  | 1335 |  | <?php |
  | 1336 |  | $wcfmmp\_shipping\_by\_distance\_rates       = get\_option( '\_wcfmmp\_shipping\_by\_distance\_rates', array() ); |
  | 1337 |  |  |
  | 1338 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  | 1339 |  | apply\_filters( 'wcfmmp\_settings\_fields\_shipping\_rates\_by\_distance', array( |
  | 1340 |  | "wcfmmp\_shipping\_by\_distance\_rates" => array( |
  | 1341 |  | 'label'       => \_\_('Distance-Cost Rules', 'wc-multivendor-marketplace'), |
  | 1342 |  | 'type'        => 'multiinput', |
  | 1343 |  | 'class'       => 'wcfmmp\_distance\_wise\_rule wcfm\_admin\_shipping\_setting\_block', |
  | 1344 |  | 'label\_class' => 'wcfm\_title wcfmmp\_shipping\_distance\_rates\_label wcfmmp\_distance\_wise\_rule', |
  | 1345 |  | 'value'       => $wcfmmp\_shipping\_by\_distance\_rates, |
  |  | 1356 | <?php |
  |  | 1357 | $wcfmmp\_shipping\_by\_distance\_rates       = get\_option('\_wcfmmp\_shipping\_by\_distance\_rates', array()); |
  |  | 1358 |  |
  |  | 1359 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( |
  |  | 1360 | apply\_filters( |
  |  | 1361 | 'wcfmmp\_settings\_fields\_shipping\_rates\_by\_distance', |
  |  | 1362 | array( |
  |  | 1363 | "wcfmmp\_shipping\_by\_distance\_rates" => array( |
  |  | 1364 | 'label'       => \_\_('Distance-Cost Rules', 'wc-multivendor-marketplace'), |
  |  | 1365 | 'type'        => 'multiinput', |
  |  | 1366 | 'class'       => 'wcfmmp\_distance\_wise\_rule wcfm\_admin\_shipping\_setting\_block', |
  |  | 1367 | 'label\_class' => 'wcfm\_title wcfmmp\_shipping\_distance\_rates\_label wcfmmp\_distance\_wise\_rule', |
  |  | 1368 | 'value'       => $wcfmmp\_shipping\_by\_distance\_rates, |
  |  | 1369 | 'options' => array( |
  |  | 1370 | "wcfmmp\_distance\_rule" => array( |
  |  | 1371 | 'label' => \_\_('Distance Rule', 'wc-multivendor-marketplace'), |
  |  | 1372 | 'type' => 'select', |
  |  | 1373 | 'class' => 'wcfm-select wcfmmp\_distance\_rule\_select', |
  |  | 1374 | 'label\_class' => 'wcfm\_title', |
  | 1346 | 1375 | 'options' => array( |
  | 1347 |  | "wcfmmp\_distance\_rule" => array( |
  | 1348 |  | 'label' => \_\_('Distance Rule', 'wc-multivendor-marketplace'), |
  | 1349 |  | 'type' => 'select', |
  | 1350 |  | 'class' => 'wcfm-select wcfmmp\_distance\_rule\_select', |
  | 1351 |  | 'label\_class' => 'wcfm\_title', |
  | 1352 |  | 'options' => array( |
  | 1353 |  | 'up\_to' => \_\_('Distance up to', 'wc-multivendor-marketplace'), |
  | 1354 |  | 'more\_than' => \_\_('Distance more than', 'wc-multivendor-marketplace') |
  | 1355 |  | ) |
  | 1356 |  | ), |
  | 1357 |  | "wcfmmp\_distance\_unit" => array( |
  | 1358 |  | 'label' => \_\_('Distance', 'wc-multivendor-marketplace') . ' ('.$radius\_unit.')', |
  | 1359 |  | 'type' => 'number', |
  | 1360 |  | 'class' => 'wcfm-text', |
  | 1361 |  | 'label\_class' => 'wcfm\_title' |
  | 1362 |  | ), |
  | 1363 |  | "wcfmmp\_distance\_price" => array( |
  | 1364 |  | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . ' ('.get\_woocommerce\_currency\_symbol().')', |
  | 1365 |  | 'type' => 'number', |
  | 1366 |  | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  | 1367 |  | 'class' => 'wcfm-text', |
  | 1368 |  | 'label\_class' => 'wcfm\_title' |
  | 1369 |  | ), |
  |  | 1376 | 'up\_to' => \_\_('Distance up to', 'wc-multivendor-marketplace'), |
  |  | 1377 | 'more\_than' => \_\_('Distance more than', 'wc-multivendor-marketplace') |
  | 1370 | 1378 | ) |
  | 1371 |  | ) |
  | 1372 |  | ) |
  | 1373 |  | ) |
  | 1374 |  | ); |
  | 1375 |  | ?> |
  | 1376 |  | </div> |
  | 1377 |  | </div> |
  | 1378 |  | </div> |
  | 1379 |  |  |
  |  | 1379 | ), |
  |  | 1380 | "wcfmmp\_distance\_unit" => array( |
  |  | 1381 | 'label' => \_\_('Distance', 'wc-multivendor-marketplace') . ' (' . $radius\_unit . ')', |
  |  | 1382 | 'type' => 'number', |
  |  | 1383 | 'class' => 'wcfm-text', |
  |  | 1384 | 'label\_class' => 'wcfm\_title' |
  |  | 1385 | ), |
  |  | 1386 | "wcfmmp\_distance\_price" => array( |
  |  | 1387 | 'label' => \_\_('Cost', 'wc-multivendor-marketplace') . ' (' . get\_woocommerce\_currency\_symbol() . ')', |
  |  | 1388 | 'type' => 'number', |
  |  | 1389 | 'placeholder' => '0.00 (' . \_\_('Free Shipping', 'wc-multivendor-marketplace') . ')', |
  |  | 1390 | 'class' => 'wcfm-text', |
  |  | 1391 | 'label\_class' => 'wcfm\_title' |
  |  | 1392 | ), |
  |  | 1393 | ) |
  |  | 1394 | ) |
  |  | 1395 | ) |
  |  | 1396 | ) |
  |  | 1397 | ); |
  |  | 1398 | ?> |
  |  | 1399 | </div> |
  |  | 1400 | </div> |
  |  | 1401 | </div> |
  |  | 1402 |  |
  | 1380 | 1403 | </div> |
  | 1381 | 1404 | </div> |
  | 1382 | 1405 | <div class="wcfm\_clearfix"></div> |
  | 1383 | 1406 | <!-- end collapsible --> |
  | 1384 |  |  |
  |  | 1407 |  |
  | 1385 | 1408 | <?php |
  | 1386 |  |  |
  | 1387 |  | } |
  | 1388 |  |  |
  | 1389 |  | function wcfm\_shipping\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 1409 |  |
  |  | 1410 | } |
  |  | 1411 |  |
  |  | 1412 | function wcfm\_shipping\_settings\_update($wcfm\_settings\_form) { |
  | 1390 | 1413 | global $WCFM, $WCFMmp, $\_POST; |
  | 1391 |  |  |
  | 1392 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_store\_shipping', true ) ) return;~~ |
  | 1393 |  |  |
  | 1394 |  | if~~( isset( $wcfm\_settings\_form['enable\_store\_shipping'] )~~ ) { |
  |  | 1414 |  |
  |  | 1415 | if (!apply\_filters('wcfm\_is\_allow\_store\_shipping', true)) return; |
  |  | 1416 |  |
  |  | 1417 | if (isset($wcfm\_settings\_form['enable\_store\_shipping'])) { |
  | 1395 | 1418 | $enable\_store\_shipping = 'yes'; |
  | 1396 | 1419 | } else { |
  | 1397 | 1420 | $enable\_store\_shipping = 'no'; |
  | 1398 | 1421 | } |
  | 1399 |  | $wcfm\_shipping\_options = get\_option(~~'wcfm\_shipping\_options', array()~~ ); |
  |  | 1422 | $wcfm\_shipping\_options = get\_option('wcfm\_shipping\_options', array()); |
  | 1400 | 1423 | $wcfm\_shipping\_options['enable\_store\_shipping'] = $enable\_store\_shipping; |
  | 1401 |  | ~~update\_option( 'wcfm\_shipping\_options', $wcfm\_shipping\_options~~ ); |
  | 1402 |  |  |
  | 1403 |  | // Shipping by Zone |
  | 1404 |  | if~~( isset( $wcfm\_settings\_form['enable\_marketplace\_shipping\_zone'] )~~ ) { |
  |  | 1424 | update\_option('wcfm\_shipping\_options', $wcfm\_shipping\_options); |
  |  | 1425 |  |
  |  | 1426 | // Shipping by Zone |
  |  | 1427 | if (isset($wcfm\_settings\_form['enable\_marketplace\_shipping\_zone'])) { |
  | 1405 | 1428 | $enable\_marketplace\_shipping\_zone = 'yes'; |
  | 1406 | 1429 | } else { |
  | 1407 | 1430 | $enable\_marketplace\_shipping\_zone = 'no'; |
  | 1408 | 1431 | } |
  | 1409 |  | $wcfmmp\_marketplace\_shipping\_zone\_options = get\_option(~~'woocommerce\_wcfmmp\_product\_shipping\_by\_zone\_settings', array()~~ ); |
  | 1410 |  | $wcfmmp\_marketplace\_shipping\_zone\_options['enabled'] = $enable\_marketplace\_shipping\_zone; |
  | 1411 |  | ~~update\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_zone\_settings', $wcfmmp\_marketplace\_shipping\_zone\_options~~ ); |
  | 1412 |  |  |
  | 1413 |  | // Shipping by Country |
  | 1414 |  | if~~( isset( $wcfm\_settings\_form['enable\_marketplace\_shipping'] )~~ ) { |
  |  | 1432 | $wcfmmp\_marketplace\_shipping\_zone\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_zone\_settings', array()); |
  |  | 1433 | $wcfmmp\_marketplace\_shipping\_zone\_options['enabled'] = $enable\_marketplace\_shipping\_zone; |
  |  | 1434 | update\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_zone\_settings', $wcfmmp\_marketplace\_shipping\_zone\_options); |
  |  | 1435 |  |
  |  | 1436 | // Shipping by Country |
  |  | 1437 | if (isset($wcfm\_settings\_form['enable\_marketplace\_shipping'])) { |
  | 1415 | 1438 | $enable\_marketplace\_shipping = 'yes'; |
  | 1416 | 1439 | } else { |
  | 1417 | 1440 | $enable\_marketplace\_shipping = 'no'; |
  | 1418 | 1441 | } |
  | 1419 |  | $wcfmmp\_marketplace\_shipping\_options = get\_option(~~'woocommerce\_wcfmmp\_product\_shipping\_by\_country\_settings', array()~~ ); |
  | 1420 |  | $wcfmmp\_marketplace\_shipping\_options['enabled'] = $enable\_marketplace\_shipping; |
  | 1421 |  | ~~update\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_country\_settings', $wcfmmp\_marketplace\_shipping\_options~~ ); |
  | 1422 |  |  |
  | 1423 |  | ~~if( isset( $wcfm\_settings\_form['wcfmmp\_shipping\_by\_country'] )~~ ) { |
  | 1424 |  | update\_option(~~'\_wcfmmp\_shipping\_by\_country', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_country']~~ ); |
  | 1425 |  | } |
  | 1426 |  |  |
  | 1427 |  | if(isset($wcfm\_settings\_form['wcfmmp\_shipping\_rates']) && !empty($wcfm\_settings\_form['wcfmmp\_shipping\_rates'])) { |
  |  | 1442 | $wcfmmp\_marketplace\_shipping\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_country\_settings', array()); |
  |  | 1443 | $wcfmmp\_marketplace\_shipping\_options['enabled'] = $enable\_marketplace\_shipping; |
  |  | 1444 | update\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_country\_settings', $wcfmmp\_marketplace\_shipping\_options); |
  |  | 1445 |  |
  |  | 1446 | if (isset($wcfm\_settings\_form['wcfmmp\_shipping\_by\_country'])) { |
  |  | 1447 | update\_option('\_wcfmmp\_shipping\_by\_country', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_country']); |
  |  | 1448 | } |
  |  | 1449 |  |
  |  | 1450 | if (isset($wcfm\_settings\_form['wcfmmp\_shipping\_rates']) && !empty($wcfm\_settings\_form['wcfmmp\_shipping\_rates'])) { |
  | 1428 | 1451 | $wcfmmp\_country\_rates = array(); |
  | 1429 |  | $wcfmmp\_state\_rates   = array(); |
  | 1430 |  | foreach~~( $wcfm\_settings\_form['wcfmmp\_shipping\_rates'] as $wcfmmp\_shipping\_rates~~ ) { |
  | 1431 |  | if~~( $wcfmmp\_shipping\_rates['wcfmmp\_country\_to']~~ ) { |
  | 1432 |  | if~~( $wcfmmp\_shipping\_rates['wcfmmp\_shipping\_state\_rates'] && !empty( $wcfmmp\_shipping\_rates['wcfmmp\_shipping\_state\_rates'] )~~ ) { |
  | 1433 |  | foreach~~( $wcfmmp\_shipping\_rates['wcfmmp\_shipping\_state\_rates'] as $wcfmmp\_shipping\_state\_rates~~ ) { |
  | 1434 |  | if~~( $wcfmmp\_shipping\_state\_rates['wcfmmp\_state\_to']~~ ) { |
  |  | 1452 | $wcfmmp\_state\_rates   = array(); |
  |  | 1453 | foreach ($wcfm\_settings\_form['wcfmmp\_shipping\_rates'] as $wcfmmp\_shipping\_rates) { |
  |  | 1454 | if ($wcfmmp\_shipping\_rates['wcfmmp\_country\_to']) { |
  |  | 1455 | if ($wcfmmp\_shipping\_rates['wcfmmp\_shipping\_state\_rates'] && !empty($wcfmmp\_shipping\_rates['wcfmmp\_shipping\_state\_rates'])) { |
  |  | 1456 | foreach ($wcfmmp\_shipping\_rates['wcfmmp\_shipping\_state\_rates'] as $wcfmmp\_shipping\_state\_rates) { |
  |  | 1457 | if ($wcfmmp\_shipping\_state\_rates['wcfmmp\_state\_to']) { |
  | 1435 | 1458 | $wcfmmp\_state\_rates[$wcfmmp\_shipping\_rates['wcfmmp\_country\_to']][$wcfmmp\_shipping\_state\_rates['wcfmmp\_state\_to']] = $wcfmmp\_shipping\_state\_rates['wcfmmp\_state\_to\_price']; |
  | 1436 | 1459 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1440) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1463) |  |
  | 1440 | 1463 | } |
  | 1441 | 1464 | } |
  | 1442 |  | update\_option(~~'\_wcfmmp\_country\_rates', $wcfmmp\_country\_rates~~ ); |
  | 1443 |  | update\_option(~~'\_wcfmmp\_state\_rates', $wcfmmp\_state\_rates~~ ); |
  |  | 1465 | update\_option('\_wcfmmp\_country\_rates', $wcfmmp\_country\_rates); |
  |  | 1466 | update\_option('\_wcfmmp\_state\_rates', $wcfmmp\_state\_rates); |
  | 1444 | 1467 | } |
  | 1445 | 1468 |  |
  | 1446 | 1469 | // Shipping by Weight |
  | 1447 |  | ~~if( isset( $wcfm\_settings\_form['enable\_marketplace\_shipping\_by\_weight'] )~~ ) { |
  |  | 1470 | if (isset($wcfm\_settings\_form['enable\_marketplace\_shipping\_by\_weight'])) { |
  | 1448 | 1471 | $enable\_marketplace\_shipping\_by\_weight = 'yes'; |
  | 1449 | 1472 | } else { |
  | 1450 | 1473 | $enable\_marketplace\_shipping\_by\_weight = 'no'; |
  | 1451 | 1474 | } |
  | 1452 |  |  |
  | 1453 |  | if~~( isset( $wcfm\_settings\_form['wcfmmp\_shipping\_by\_weight'] )~~ ) { |
  | 1454 |  | update\_option(~~'\_wcfmmp\_shipping\_by\_weight', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_weight']~~ ); |
  | 1455 |  | } |
  | 1456 |  |  |
  | 1457 |  | ~~$wcfmmp\_marketplace\_shipping\_by\_weight\_options = get\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_weight\_settings', array()~~ ); |
  | 1458 |  | $wcfmmp\_marketplace\_shipping\_by\_weight\_options['enabled'] = $enable\_marketplace\_shipping\_by\_weight; |
  | 1459 |  | ~~update\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_weight\_settings', $wcfmmp\_marketplace\_shipping\_by\_weight\_options~~ ); |
  | 1460 |  |  |
  | 1461 |  | $wcfmmp\_country\_weight\_rates   = array(); |
  | 1462 |  | $wcfmmp\_country\_weight\_mode = array(); |
  | 1463 |  | $wcfmmp\_country\_weight\_unit\_cost = array(); |
  |  | 1475 |  |
  |  | 1476 | if (isset($wcfm\_settings\_form['wcfmmp\_shipping\_by\_weight'])) { |
  |  | 1477 | update\_option('\_wcfmmp\_shipping\_by\_weight', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_weight']); |
  |  | 1478 | } |
  |  | 1479 |  |
  |  | 1480 | $wcfmmp\_marketplace\_shipping\_by\_weight\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_weight\_settings', array()); |
  |  | 1481 | $wcfmmp\_marketplace\_shipping\_by\_weight\_options['enabled'] = $enable\_marketplace\_shipping\_by\_weight; |
  |  | 1482 | update\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_weight\_settings', $wcfmmp\_marketplace\_shipping\_by\_weight\_options); |
  |  | 1483 |  |
  |  | 1484 | $wcfmmp\_country\_weight\_rates   = array(); |
  |  | 1485 | $wcfmmp\_country\_weight\_mode = array(); |
  |  | 1486 | $wcfmmp\_country\_weight\_unit\_cost = array(); |
  | 1464 | 1487 | $wcfmmp\_country\_weight\_default\_costs = array(); |
  | 1465 |  | foreach~~( $wcfm\_settings\_form['wcfmmp\_shipping\_rates\_by\_weight'] as $wcfmmp\_shipping\_rates\_by\_weight~~ ) { |
  | 1466 |  | if~~( $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']~~ ) { |
  | 1467 |  | if~~( $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_shipping\_country\_weight\_settings'] && !empty( $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_shipping\_country\_weight\_settings'] )~~ ) { |
  |  | 1488 | foreach ($wcfm\_settings\_form['wcfmmp\_shipping\_rates\_by\_weight'] as $wcfmmp\_shipping\_rates\_by\_weight) { |
  |  | 1489 | if ($wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']) { |
  |  | 1490 | if ($wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_shipping\_country\_weight\_settings'] && !empty($wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_shipping\_country\_weight\_settings'])) { |
  | 1468 | 1491 | $wcfmmp\_country\_weight\_rates[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_shipping\_country\_weight\_settings']; |
  | 1469 |  | $wcfmmp\_country\_weight\_mode[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = (~~$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_mode'] || $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_mode'] != ""~~ ) ? $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_mode'] : 'by\_rule'; |
  | 1470 |  | ~~$wcfmmp\_country\_weight\_unit\_cost[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = ( $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_per\_unit\_cost'] || $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_per\_unit\_cost'] != ""~~ ) ? $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_per\_unit\_cost'] : 0; |
  | 1471 |  | ~~$wcfmmp\_country\_weight\_default\_costs[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = ( $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_default\_cost'] || $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_default\_cost'] != ""~~ ) ? $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_default\_cost'] : 0; |
  |  | 1492 | $wcfmmp\_country\_weight\_mode[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = ($wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_mode'] || $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_mode'] != "") ? $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_mode'] : 'by\_rule'; |
  |  | 1493 | $wcfmmp\_country\_weight\_unit\_cost[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = ($wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_per\_unit\_cost'] || $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_per\_unit\_cost'] != "") ? $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_per\_unit\_cost'] : 0; |
  |  | 1494 | $wcfmmp\_country\_weight\_default\_costs[$wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_to']] = ($wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_default\_cost'] || $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_default\_cost'] != "") ? $wcfmmp\_shipping\_rates\_by\_weight['wcfmmp\_weightwise\_country\_default\_cost'] : 0; |
  | 1472 | 1495 | } |
  | 1473 | 1496 | } |
  | 1474 | 1497 | } |
  | 1475 |  |  |
  | 1476 |  | update\_option(~~'\_wcfmmp\_country\_weight\_rates', $wcfmmp\_country\_weight\_rates~~ ); |
  | 1477 |  | update\_option(~~'\_wcfmmp\_country\_weight\_mode', $wcfmmp\_country\_weight\_mode~~ ); |
  | 1478 |  | update\_option(~~'\_wcfmmp\_country\_weight\_unit\_cost', $wcfmmp\_country\_weight\_unit\_cost~~ ); |
  | 1479 |  | update\_option(~~'\_wcfmmp\_country\_weight\_default\_costs', $wcfmmp\_country\_weight\_default\_costs~~ ); |
  | 1480 |  |  |
  |  | 1498 |  |
  |  | 1499 | update\_option('\_wcfmmp\_country\_weight\_rates', $wcfmmp\_country\_weight\_rates); |
  |  | 1500 | update\_option('\_wcfmmp\_country\_weight\_mode', $wcfmmp\_country\_weight\_mode); |
  |  | 1501 | update\_option('\_wcfmmp\_country\_weight\_unit\_cost', $wcfmmp\_country\_weight\_unit\_cost); |
  |  | 1502 | update\_option('\_wcfmmp\_country\_weight\_default\_costs', $wcfmmp\_country\_weight\_default\_costs); |
  |  | 1503 |  |
  | 1481 | 1504 | // Shipping by Distance |
  | 1482 |  | ~~if( isset( $wcfm\_settings\_form['enable\_marketplace\_shipping\_by\_distance'] )~~ ) { |
  |  | 1505 | if (isset($wcfm\_settings\_form['enable\_marketplace\_shipping\_by\_distance'])) { |
  | 1483 | 1506 | $enable\_marketplace\_shipping\_by\_distance = 'yes'; |
  | 1484 | 1507 | } else { |
  | 1485 | 1508 | $enable\_marketplace\_shipping\_by\_distance = 'no'; |
  | 1486 | 1509 | } |
  | 1487 |  |  |
  | 1488 |  | if~~( isset( $wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance'] )~~ ) { |
  | 1489 |  | update\_option(~~'\_wcfmmp\_shipping\_by\_distance', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance']~~ ); |
  | 1490 |  | } |
  | 1491 |  |  |
  | 1492 |  | if~~( isset( $wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance\_rates'] )~~ ) { |
  | 1493 |  | update\_option(~~'\_wcfmmp\_shipping\_by\_distance\_rates', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance\_rates']~~ ); |
  | 1494 |  | } |
  | 1495 |  |  |
  | 1496 |  | ~~$wcfmmp\_marketplace\_shipping\_by\_distance\_options = get\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_distance\_settings', array()~~ ); |
  | 1497 |  | $wcfmmp\_marketplace\_shipping\_by\_distance\_options['enabled'] = $enable\_marketplace\_shipping\_by\_distance; |
  | 1498 |  | ~~update\_option( 'woocommerce\_wcfmmp\_product\_shipping\_by\_distance\_settings', $wcfmmp\_marketplace\_shipping\_by\_distance\_options~~ ); |
  | 1499 |  | } |
  | 1500 |  |  |
  | 1501 |  | function wcfm\_refund\_settings(~~$wcfm\_options~~ ) { |
  |  | 1510 |  |
  |  | 1511 | if (isset($wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance'])) { |
  |  | 1512 | update\_option('\_wcfmmp\_shipping\_by\_distance', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance']); |
  |  | 1513 | } |
  |  | 1514 |  |
  |  | 1515 | if (isset($wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance\_rates'])) { |
  |  | 1516 | update\_option('\_wcfmmp\_shipping\_by\_distance\_rates', $wcfm\_settings\_form['wcfmmp\_shipping\_by\_distance\_rates']); |
  |  | 1517 | } |
  |  | 1518 |  |
  |  | 1519 | $wcfmmp\_marketplace\_shipping\_by\_distance\_options = get\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_distance\_settings', array()); |
  |  | 1520 | $wcfmmp\_marketplace\_shipping\_by\_distance\_options['enabled'] = $enable\_marketplace\_shipping\_by\_distance; |
  |  | 1521 | update\_option('woocommerce\_wcfmmp\_product\_shipping\_by\_distance\_settings', $wcfmmp\_marketplace\_shipping\_by\_distance\_options); |
  |  | 1522 | } |
  |  | 1523 |  |
  |  | 1524 | function wcfm\_refund\_settings($wcfm\_options) { |
  | 1502 | 1525 | global $WCFM, $WCFMmp; |
  | 1503 |  |  |
  | 1504 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_refund\_requests', true ) ) return;~~ |
  | 1505 |  |  |
  | 1506 |  | $wcfm\_refund\_options = get\_option(~~'wcfm\_refund\_options', array()~~ ); |
  | 1507 |  |  |
  | 1508 |  | $refund\_auto\_approve = isset(~~$wcfm\_refund\_options['refund\_auto\_approve']~~ ) ? $wcfm\_refund\_options['refund\_auto\_approve'] : 'no'; |
  | 1509 |  | $refund\_by\_customer = isset(~~$wcfm\_refund\_options['refund\_by\_customer']~~ ) ? $wcfm\_refund\_options['refund\_by\_customer'] : 'no'; |
  | 1510 |  | $refund\_threshold = isset(~~$wcfm\_refund\_options['refund\_threshold']~~ ) ? $wcfm\_refund\_options['refund\_threshold'] : ''; |
  | 1511 |  |  |
  |  | 1526 |  |
  |  | 1527 | if (!apply\_filters('wcfm\_is\_allow\_refund\_requests', true)) return; |
  |  | 1528 |  |
  |  | 1529 | $wcfm\_refund\_options = get\_option('wcfm\_refund\_options', array()); |
  |  | 1530 |  |
  |  | 1531 | $refund\_auto\_approve = isset($wcfm\_refund\_options['refund\_auto\_approve']) ? $wcfm\_refund\_options['refund\_auto\_approve'] : 'no'; |
  |  | 1532 | $refund\_by\_customer = isset($wcfm\_refund\_options['refund\_by\_customer']) ? $wcfm\_refund\_options['refund\_by\_customer'] : 'no'; |
  |  | 1533 | $refund\_threshold = isset($wcfm\_refund\_options['refund\_threshold']) ? $wcfm\_refund\_options['refund\_threshold'] : ''; |
  |  | 1534 |  |
  | 1512 | 1535 | ?> |
  | 1513 | 1536 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1518) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1541) |  |
  | 1518 | 1541 | <div class="wcfm-container"> |
  | 1519 | 1542 | <div id="wcfm\_settings\_form\_refund\_expander" class="wcfm-content"> |
  | 1520 |  | ~~<h2><?php echo esc\_attr(apply\_filters( 'wcfm\_sold\_by\_label', '', \_\_( 'Vendor', 'wc-frontend-manager' )~~ )) . ' ' . esc\_html\_\_('Refund Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 1521 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-refund/'~~ ); ?> |
  |  | 1543 | <h2><?php echo esc\_attr(apply\_filters('wcfm\_sold\_by\_label', '', \_\_('Vendor', 'wc-frontend-manager'))) . ' ' . esc\_html\_\_('Refund Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1544 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-refund/'); ?> |
  | 1522 | 1545 | <div class="wcfm\_clearfix"></div> |
  | 1523 | 1546 | <?php |
  | 1524 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_refund', array( |
  | 1525 |  | ~~"refund\_auto\_approve" => array('label' => \_\_('Refund auto-approve?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_refund\_options[refund\_auto\_approve]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $refund\_auto\_approve~~ ), |
  | 1526 |  | ~~"refund\_by\_customer" => array('label' => \_\_('Refund by Customer?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_refund\_options[refund\_by\_customer]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $refund\_by\_customer, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Enable this to allow customers make refund requests. Customers refund requests never auto-approve, admin always has to manually approve this.', 'wc-multivendor-marketplace')~~ ), |
  | 1527 |  | ~~"refund\_threshold" => array('label' => \_\_('Refund Threshold', 'wc-multivendor-marketplace'), 'type' => 'number', 'name' => 'wcfm\_refund\_options[refund\_threshold]', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $refund\_threshold, 'desc\_class' => 'wcfm\_page\_options\_desc', 'attributes' => array( 'min' => '1', 'step' => '1'), 'desc' => \_\_('Refund Threshold Days, (Allow an order available to make a refund request). Leave empty to inactive this option.', 'wc-multivendor-marketplace')~~ ), |
  | 1528 |  | ~~) )~~ ); |
  | 1529 |  | ?> |
  |  | 1547 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_refund', array( |
  |  | 1548 | "refund\_auto\_approve" => array('label' => \_\_('Refund auto-approve?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_refund\_options[refund\_auto\_approve]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $refund\_auto\_approve), |
  |  | 1549 | "refund\_by\_customer" => array('label' => \_\_('Refund by Customer?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_refund\_options[refund\_by\_customer]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $refund\_by\_customer, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Enable this to allow customers make refund requests. Customers refund requests never auto-approve, admin always has to manually approve this.', 'wc-multivendor-marketplace')), |
  |  | 1550 | "refund\_threshold" => array('label' => \_\_('Refund Threshold', 'wc-multivendor-marketplace'), 'type' => 'number', 'name' => 'wcfm\_refund\_options[refund\_threshold]', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele', 'value' => $refund\_threshold, 'desc\_class' => 'wcfm\_page\_options\_desc', 'attributes' => array('min' => '1', 'step' => '1'), 'desc' => \_\_('Refund Threshold Days, (Allow an order available to make a refund request). Leave empty to inactive this option.', 'wc-multivendor-marketplace')), |
  |  | 1551 | ))); |
  |  | 1552 | ?> |
  | 1530 | 1553 | </div> |
  | 1531 | 1554 | </div> |
  | 1532 | 1555 | <div class="wcfm\_clearfix"></div> |
  | 1533 | 1556 | <!-- end collapsible --> |
  | 1534 |  |  |
  |  | 1557 |  |
  | 1535 | 1558 | <?php |
  | 1536 |  |  |
  | 1537 |  | } |
  | 1538 |  |  |
  | 1539 |  | function wcfm\_refund\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 1559 |  |
  |  | 1560 | } |
  |  | 1561 |  |
  |  | 1562 | function wcfm\_refund\_settings\_update($wcfm\_settings\_form) { |
  | 1540 | 1563 | global $WCFM, $WCFMmp, $\_POST; |
  | 1541 |  |  |
  | 1542 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_refund\_requests', true ) ) return;~~ |
  | 1543 |  |  |
  | 1544 |  | if~~( isset( $wcfm\_settings\_form['wcfm\_refund\_options'] )~~ ) { |
  | 1545 |  | update\_option(~~'wcfm\_refund\_options', $wcfm\_settings\_form['wcfm\_refund\_options']~~ ); |
  | 1546 |  | } |
  | 1547 |  | } |
  | 1548 |  |  |
  | 1549 |  | function wcfm\_review\_settings(~~$wcfm\_options~~ ) { |
  |  | 1564 |  |
  |  | 1565 | if (!apply\_filters('wcfm\_is\_allow\_refund\_requests', true)) return; |
  |  | 1566 |  |
  |  | 1567 | if (isset($wcfm\_settings\_form['wcfm\_refund\_options'])) { |
  |  | 1568 | update\_option('wcfm\_refund\_options', $wcfm\_settings\_form['wcfm\_refund\_options']); |
  |  | 1569 | } |
  |  | 1570 | } |
  |  | 1571 |  |
  |  | 1572 | function wcfm\_review\_settings($wcfm\_options) { |
  | 1550 | 1573 | global $WCFM, $WCFMmp; |
  | 1551 |  |  |
  | 1552 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_reviews', true ) ) return;~~ |
  | 1553 |  |  |
  | 1554 |  | $wcfm\_review\_options = get\_option(~~'wcfm\_review\_options', array()~~ ); |
  | 1555 |  |  |
  |  | 1574 |  |
  |  | 1575 | if (!apply\_filters('wcfm\_is\_allow\_reviews', true)) return; |
  |  | 1576 |  |
  |  | 1577 | $wcfm\_review\_options = get\_option('wcfm\_review\_options', array()); |
  |  | 1578 |  |
  | 1556 | 1579 | $wcfm\_default\_review\_categories = get\_wcfm\_marketplace\_default\_review\_categories(); |
  | 1557 |  |  |
  | 1558 |  | $review\_auto\_approve    = isset(~~$wcfm\_review\_options['review\_auto\_approve']~~ ) ? $wcfm\_review\_options['review\_auto\_approve'] : 'no'; |
  | 1559 |  | $review\_only\_store\_user = isset(~~$wcfm\_review\_options['review\_only\_store\_user']~~ ) ? $wcfm\_review\_options['review\_only\_store\_user'] : 'no'; |
  | 1560 |  | $product\_review\_sync    = isset(~~$wcfm\_review\_options['product\_review\_sync']~~ ) ? $wcfm\_review\_options['product\_review\_sync'] : 'no'; |
  | 1561 |  | $wcfm\_review\_categories = isset(~~$wcfm\_review\_options['review\_categories']~~ ) ? $wcfm\_review\_options['review\_categories'] : $wcfm\_default\_review\_categories; |
  | 1562 |  |  |
  |  | 1580 |  |
  |  | 1581 | $review\_auto\_approve    = isset($wcfm\_review\_options['review\_auto\_approve']) ? $wcfm\_review\_options['review\_auto\_approve'] : 'no'; |
  |  | 1582 | $review\_only\_store\_user = isset($wcfm\_review\_options['review\_only\_store\_user']) ? $wcfm\_review\_options['review\_only\_store\_user'] : 'no'; |
  |  | 1583 | $product\_review\_sync    = isset($wcfm\_review\_options['product\_review\_sync']) ? $wcfm\_review\_options['product\_review\_sync'] : 'no'; |
  |  | 1584 | $wcfm\_review\_categories = isset($wcfm\_review\_options['review\_categories']) ? $wcfm\_review\_options['review\_categories'] : $wcfm\_default\_review\_categories; |
  |  | 1585 |  |
  | 1563 | 1586 | ?> |
  | 1564 | 1587 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1569) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1592) |  |
  | 1569 | 1592 | <div class="wcfm-container"> |
  | 1570 | 1593 | <div id="wcfm\_settings\_form\_review\_expander" class="wcfm-content"> |
  | 1571 |  | ~~<h2><?php echo esc\_attr(apply\_filters( 'wcfm\_sold\_by\_label', '', \_\_( 'Vendor', 'wc-frontend-manager' )~~ )) . ' ' . esc\_html\_\_('Review Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 1572 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-reviews/'~~ ); ?> |
  |  | 1594 | <h2><?php echo esc\_attr(apply\_filters('wcfm\_sold\_by\_label', '', \_\_('Vendor', 'wc-frontend-manager'))) . ' ' . esc\_html\_\_('Review Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1595 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-reviews/'); ?> |
  | 1573 | 1596 | <div class="wcfm\_clearfix"></div> |
  | 1574 | 1597 | <?php |
  | 1575 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_review', array( |
  | 1576 |  | ~~"review\_auto\_approve"    => array('label' => \_\_('Review auto-approve?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_review\_options[review\_auto\_approve]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $review\_auto\_approve~~ ), |
  | 1577 |  | ~~"review\_only\_store\_user" => array('label' => \_\_('Review only store users?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_review\_options[review\_only\_store\_user]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $review\_only\_store\_user, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Enable this to allow only users to review the store who already purchased something from this store.', 'wc-multivendor-marketplace' )~~ ), |
  | 1578 |  | ~~"product\_review\_sync"    => array('label' => \_\_('Product review sync?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_review\_options[product\_review\_sync]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $product\_review\_sync, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Enable this to allow vendor\'s products review consider as store review.', 'wc-multivendor-marketplace' )~~ ), |
  | 1579 |  | ~~"wcfm\_review\_categories" => array('label' => \_\_('Review Categories', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_review\_options[review\_categories]', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title', 'value' => $wcfm\_review\_categories, 'options' => array(~~ |
  | 1580 |  | ~~"category" => array('label' => \_\_('Category', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele'~~ ), |
  | 1581 |  | ~~)~~ ), |
  | 1582 |  | ~~) )~~ ); |
  | 1583 |  | ?> |
  |  | 1598 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_review', array( |
  |  | 1599 | "review\_auto\_approve"    => array('label' => \_\_('Review auto-approve?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_review\_options[review\_auto\_approve]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $review\_auto\_approve), |
  |  | 1600 | "review\_only\_store\_user" => array('label' => \_\_('Review only store users?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_review\_options[review\_only\_store\_user]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $review\_only\_store\_user, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Enable this to allow only users to review the store who already purchased something from this store.', 'wc-multivendor-marketplace')), |
  |  | 1601 | "product\_review\_sync"    => array('label' => \_\_('Product review sync?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfm\_review\_options[product\_review\_sync]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $product\_review\_sync, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Enable this to allow vendor\'s products review consider as store review.', 'wc-multivendor-marketplace')), |
  |  | 1602 | "wcfm\_review\_categories" => array('label' => \_\_('Review Categories', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'name' => 'wcfm\_review\_options[review\_categories]', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele wcfm\_full\_title', 'value' => $wcfm\_review\_categories, 'options' => array( |
  |  | 1603 | "category" => array('label' => \_\_('Category', 'wc-multivendor-marketplace'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_ele'), |
  |  | 1604 | )), |
  |  | 1605 | ))); |
  |  | 1606 | ?> |
  | 1584 | 1607 | </div> |
  | 1585 | 1608 | </div> |
  | 1586 | 1609 | <div class="wcfm\_clearfix"></div> |
  | 1587 | 1610 | <!-- end collapsible --> |
  | 1588 |  |  |
  |  | 1611 |  |
  | 1589 | 1612 | <?php |
  | 1590 |  |  |
  | 1591 |  | } |
  | 1592 |  |  |
  | 1593 |  | function wcfm\_review\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 1613 |  |
  |  | 1614 | } |
  |  | 1615 |  |
  |  | 1616 | function wcfm\_review\_settings\_update($wcfm\_settings\_form) { |
  | 1594 | 1617 | global $WCFM, $WCFMmp, $\_POST; |
  | 1595 |  |  |
  | 1596 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_reviews', true ) ) return;~~ |
  | 1597 |  |  |
  | 1598 |  | if~~( isset( $wcfm\_settings\_form['wcfm\_review\_options'] )~~ ) { |
  | 1599 |  | update\_option(~~'wcfm\_review\_options', $wcfm\_settings\_form['wcfm\_review\_options']~~ ); |
  | 1600 |  | } |
  | 1601 |  | } |
  | 1602 |  |  |
  |  | 1618 |  |
  |  | 1619 | if (!apply\_filters('wcfm\_is\_allow\_reviews', true)) return; |
  |  | 1620 |  |
  |  | 1621 | if (isset($wcfm\_settings\_form['wcfm\_review\_options'])) { |
  |  | 1622 | update\_option('wcfm\_review\_options', $wcfm\_settings\_form['wcfm\_review\_options']); |
  |  | 1623 | } |
  |  | 1624 | } |
  |  | 1625 |  |
  | 1603 | 1626 | function wcfm\_vendor\_registration\_settings() { |
  | 1604 | 1627 | global $WCFM, $WCFMmp, $\_POST; |
  | 1605 |  |  |
  | 1606 |  | if~~( !function\_exists( 'get\_wcfm\_memberships\_settings\_url' )~~ ) return; |
  | 1607 |  |  |
  | 1608 |  | $wcfm\_membership\_options = get\_option(~~'wcfm\_membership\_options', array()~~ ); |
  | 1609 |  |  |
  |  | 1628 |  |
  |  | 1629 | if (!function\_exists('get\_wcfm\_memberships\_settings\_url')) return; |
  |  | 1630 |  |
  |  | 1631 | $wcfm\_membership\_options = get\_option('wcfm\_membership\_options', array()); |
  |  | 1632 |  |
  | 1610 | 1633 | $membership\_reject\_rules = array(); |
  | 1611 |  | if~~( isset( $wcfm\_membership\_options['membership\_reject\_rules'] )~~ ) $membership\_reject\_rules = $wcfm\_membership\_options['membership\_reject\_rules']; |
  | 1612 |  | $required\_approval = isset(~~$membership\_reject\_rules['required\_approval']~~ ) ? $membership\_reject\_rules['required\_approval'] : 'no'; |
  | 1613 |  |  |
  |  | 1634 | if (isset($wcfm\_membership\_options['membership\_reject\_rules'])) $membership\_reject\_rules = $wcfm\_membership\_options['membership\_reject\_rules']; |
  |  | 1635 | $required\_approval = isset($membership\_reject\_rules['required\_approval']) ? $membership\_reject\_rules['required\_approval'] : 'no'; |
  |  | 1636 |  |
  | 1614 | 1637 | $membership\_type\_settings = array(); |
  | 1615 |  | if~~( isset( $wcfm\_membership\_options['membership\_type\_settings'] )~~ ) $membership\_type\_settings = $wcfm\_membership\_options['membership\_type\_settings']; |
  | 1616 |  | $email\_verification = isset(~~$membership\_type\_settings['email\_verification']~~ ) ? 'yes' : 'no'; |
  | 1617 |  | $sms\_verification = isset(~~$membership\_type\_settings['sms\_verification']~~ ) ? 'yes' : 'no'; |
  | 1618 |  |  |
  | 1619 |  | $wcfmvm\_registration\_static\_fields = wcfm\_get\_option(~~'wcfmvm\_registration\_static\_fields', array()~~ ); |
  | 1620 |  | $enable\_address = isset(~~$wcfmvm\_registration\_static\_fields['address']~~ ) ? 'yes' : ''; |
  | 1621 |  |  |
  | 1622 |  | $field\_types = apply\_filters(~~'wcfm\_registration\_custom\_filed\_types', array( 'text' => 'Text', 'number' => 'Number', 'textarea' => 'textarea', 'datepicker' => 'Date Picker', 'timepicker' => 'Time Picker', 'checkbox' => 'Check Box', 'select' => 'Select / Drop Down', 'mselect' => 'Multi-Select Drop Down', 'upload' => 'File/Image', 'html' => 'HTML' )~~ ); |
  | 1623 |  | $wcfmvm\_registration\_custom\_fields = wcfm\_get\_option(~~'wcfmvm\_registration\_custom\_fields', array()~~ ); |
  | 1624 |  |  |
  | 1625 |  | $hide\_become\_vendor = wcfm\_get\_option(~~'wcfmvm\_hide\_become\_vendor', 'no'~~ ); |
  | 1626 |  |  |
  |  | 1638 | if (isset($wcfm\_membership\_options['membership\_type\_settings'])) $membership\_type\_settings = $wcfm\_membership\_options['membership\_type\_settings']; |
  |  | 1639 | $email\_verification = isset($membership\_type\_settings['email\_verification']) ? 'yes' : 'no'; |
  |  | 1640 | $sms\_verification = isset($membership\_type\_settings['sms\_verification']) ? 'yes' : 'no'; |
  |  | 1641 |  |
  |  | 1642 | $wcfmvm\_registration\_static\_fields = wcfm\_get\_option('wcfmvm\_registration\_static\_fields', array()); |
  |  | 1643 | $enable\_address = isset($wcfmvm\_registration\_static\_fields['address']) ? 'yes' : ''; |
  |  | 1644 |  |
  |  | 1645 | $field\_types = apply\_filters('wcfm\_registration\_custom\_filed\_types', array('text' => 'Text', 'number' => 'Number', 'textarea' => 'textarea', 'datepicker' => 'Date Picker', 'timepicker' => 'Time Picker', 'checkbox' => 'Check Box', 'select' => 'Select / Drop Down', 'mselect' => 'Multi-Select Drop Down', 'upload' => 'File/Image', 'html' => 'HTML')); |
  |  | 1646 | $wcfmvm\_registration\_custom\_fields = wcfm\_get\_option('wcfmvm\_registration\_custom\_fields', array()); |
  |  | 1647 |  |
  |  | 1648 | $hide\_become\_vendor = wcfm\_get\_option('wcfmvm\_hide\_become\_vendor', 'no'); |
  |  | 1649 |  |
  | 1627 | 1650 | ?> |
  | 1628 | 1651 | <div class="page\_collapsible" id="membership\_settings\_form\_custom\_field\_head"> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1632) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1655) |  |
  | 1632 | 1655 | <div class="wcfm-container"> |
  | 1633 | 1656 | <div id="wcfm\_settings\_form\_custom\_field\_expander" class="wcfm-content"> |
  | 1634 |  | <h2><?php echo esc\_attr(apply\_filters(~~'wcfm\_sold\_by\_label', '', \_\_( 'Vendor', 'wc-frontend-manager' ) )) . ' ' . esc\_html\_\_( 'Registration Settings', 'wc-multivendor-marketplace'~~ ); ?></h2> |
  | 1635 |  | <?php wcfm\_video\_tutorial(~~'https://wclovers.com/knowledgebase/wcfm-marketplace-vendor-registration/'~~ ); ?> |
  |  | 1657 | <h2><?php echo esc\_attr(apply\_filters('wcfm\_sold\_by\_label', '', \_\_('Vendor', 'wc-frontend-manager'))) . ' ' . esc\_html\_\_('Registration Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1658 | <?php wcfm\_video\_tutorial('https://wclovers.com/knowledgebase/wcfm-marketplace-vendor-registration/'); ?> |
  | 1636 | 1659 | <div class="wcfm\_clearfix"></div> |
  | 1637 | 1660 | <?php |
  | 1638 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'membership\_setting\_approval\_fields', array( |
  | 1639 |  | ~~"wcfmvm\_hide\_become\_vendor" => array( 'label' => \_\_( 'Hide "Become a Vendor"?', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $hide\_become\_vendor, 'hints' => \_\_( "Enable this to hide `Become a Vendor` link from `My Account` page.", 'wc-multivendor-marketplace' )~~ ), |
  | 1640 |  | ~~"wcfmvm\_required\_approval" => array( 'label' => \_\_( 'Required Approval', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $required\_approval, 'hints' => \_\_( 'Whether user required Admin Approval to become vendor or not!', 'wc-multivendor-marketplace' )~~ ), |
  | 1641 |  | ~~"wcfmvm\_email\_verification" => array( 'label' => \_\_( 'Email Verification', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $email\_verification~~ ), |
  | 1642 |  | ~~) )~~ ); |
  | 1643 |  |  |
  | 1644 |  | if~~( WCFMmp\_Dependencies::wcfm\_sms\_alert\_plugin\_active\_check() || WCFMmp\_Dependencies::wcfm\_twilio\_plugin\_active\_check() || WCFMmp\_Dependencies::wcfm\_msg91\_plugin\_active\_check() || function\_exists( 'netgsm\_sendSMS\_oneToMany' ) || apply\_filters( 'wcfm\_is\_allow\_custom\_otp\_verification', false )~~ ) { |
  | 1645 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~array(~~ |
  | 1646 |  | ~~"wcfmvm\_sms\_verification" => array( 'label' => \_\_( 'SMS (via OTP) Verification', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $sms\_verification~~ ), |
  | 1647 |  | ~~)~~ ); |
  |  | 1661 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('membership\_setting\_approval\_fields', array( |
  |  | 1662 | "wcfmvm\_hide\_become\_vendor" => array('label' => \_\_('Hide "Become a Vendor"?', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $hide\_become\_vendor, 'hints' => \_\_("Enable this to hide `Become a Vendor` link from `My Account` page.", 'wc-multivendor-marketplace')), |
  |  | 1663 | "wcfmvm\_required\_approval" => array('label' => \_\_('Required Approval', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $required\_approval, 'hints' => \_\_('Whether user required Admin Approval to become vendor or not!', 'wc-multivendor-marketplace')), |
  |  | 1664 | "wcfmvm\_email\_verification" => array('label' => \_\_('Email Verification', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $email\_verification), |
  |  | 1665 | ))); |
  |  | 1666 |  |
  |  | 1667 | if (WCFMmp\_Dependencies::wcfm\_sms\_alert\_plugin\_active\_check() || WCFMmp\_Dependencies::wcfm\_twilio\_plugin\_active\_check() || WCFMmp\_Dependencies::wcfm\_msg91\_plugin\_active\_check() || function\_exists('netgsm\_sendSMS\_oneToMany') || apply\_filters('wcfm\_is\_allow\_custom\_otp\_verification', false)) { |
  |  | 1668 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(array( |
  |  | 1669 | "wcfmvm\_sms\_verification" => array('label' => \_\_('SMS (via OTP) Verification', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $sms\_verification), |
  |  | 1670 | )); |
  | 1648 | 1671 | } |
  | 1649 |  |  |
  |  | 1672 |  |
  | 1650 | 1673 | ?> |
  | 1651 |  | <h2><?php \_e(~~'Registration Form Fields', 'wc-multivendor-marketplace'~~ ); ?></h2> |
  |  | 1674 | <h2><?php \_e('Registration Form Fields', 'wc-multivendor-marketplace'); ?></h2> |
  | 1652 | 1675 | <div class="wcfm\_clearfix"></div> |
  | 1653 | 1676 | <?php |
  | 1654 |  | $terms\_page = isset(~~$wcfmvm\_registration\_static\_fields['terms\_page']~~ ) ? $wcfmvm\_registration\_static\_fields['terms\_page'] : ''; |
  |  | 1677 | $terms\_page = isset($wcfmvm\_registration\_static\_fields['terms\_page']) ? $wcfmvm\_registration\_static\_fields['terms\_page'] : ''; |
  | 1655 | 1678 | $pages\_array = array(); |
  | 1656 |  | if~~( $terms\_page~~ ) { |
  | 1657 |  | ~~$pages\_array[$terms\_page] = get\_post( $terms\_page )->post\_title;~~ |
  |  | 1679 | if ($terms\_page) { |
  |  | 1680 | $pages\_array[$terms\_page] = get\_post($terms\_page) ? get\_post($terms\_page)->post\_title : ''; |
  | 1658 | 1681 | } |
  | 1659 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( apply\_filters( 'wcfmvm\_registration\_static\_fields', array( |
  | 1660 |  | "first\_name"  => array( 'label' => \_\_( 'First Name', 'wc-frontend-manager' ), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[first\_name]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset( $wcfmvm\_registration\_static\_fields['first\_name'] ) ? 'yes' : '' ), |
  | 1661 |  | "last\_name"   => array( 'label' => \_\_( 'Last Name', 'wc-frontend-manager' ), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[last\_name]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset( $wcfmvm\_registration\_static\_fields['last\_name'] ) ? 'yes' : '' ), |
  | 1662 |  | "user\_name"   => array( 'label' => \_\_( 'User Name', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[user\_name]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset( $wcfmvm\_registration\_static\_fields['user\_name'] ) ? 'yes' : '' ), |
  | 1663 |  | "address"     => array( 'label' => \_\_( 'Store Address', 'wc-frontend-manager' ), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[address]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset( $wcfmvm\_registration\_static\_fields['address'] ) ? 'yes' : '' ), |
  | 1664 |  | "phone"       => array( 'label' => \_\_( 'Store Phone', 'wc-frontend-manager' ), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[phone]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset( $wcfmvm\_registration\_static\_fields['phone'] ) ? 'yes' : '' ), |
  | 1665 |  | "terms"       => array( 'label' => \_\_( 'Terms & Conditions', 'wc-multivendor-marketplace' ), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[terms]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset( $wcfmvm\_registration\_static\_fields['terms'] ) ? 'yes' : '' ), |
  | 1666 |  | "terms\_page"  => array( 'label' => \_\_( 'Terms Page', 'wc-multivendor-marketplace' ), 'type' => 'select', 'name' => 'wcfmvm\_registration\_static\_fields[terms\_page]', 'options' => $pages\_array, 'class' => 'wcfm-select wcfm\_ele terms\_page\_ele', 'label\_class' => 'wcfm\_title terms\_page\_ele', 'value' => isset( $wcfmvm\_registration\_static\_fields['terms\_page'] ) ? $wcfmvm\_registration\_static\_fields['terms\_page'] : '' ) |
  | 1667 |  | ) |
  | 1668 |  | ) ); |
  | 1669 |  |  |
  | 1670 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( apply\_filters( 'wcfm\_membership\_registration\_custom\_fields', array( |
  | 1671 |  | "wcfmvm\_registration\_custom\_fields" => array('label' => \_\_( 'Registration Form Custom Fields', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_full\_title', 'value' => $wcfmvm\_registration\_custom\_fields, 'options' => array( |
  | 1672 |  | "enable"   => array('label' => \_\_('Enable', 'wc-frontend-manager'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes'), |
  | 1673 |  | "type" => array( 'label' => \_\_('Field Type', 'wc-frontend-manager'), 'type' => 'select', 'options' => $field\_types, 'class' => 'wcfm-select wcfm\_ele field\_type\_options', 'label\_class' => 'wcfm\_title'), |
  | 1674 |  | "label" => array( 'label' => \_\_('Label', 'wc-frontend-manager'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title'), |
  | 1675 |  | "options" => array( 'label' => \_\_('Options', 'wc-frontend-manager'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele field\_type\_select\_options field\_type\_dropdown\_options', 'label\_class' => 'wcfm\_title field\_type\_select\_options field\_type\_dropdown\_options', 'placeholder' => \_\_( 'Insert option values | separated', 'wc-frontend-manager' ) ), |
  | 1676 |  | "content" => array( 'label' => \_\_('Content', 'wc-frontend-manager'), 'type' => 'textarea', 'class' => 'wcfm-textarea wcfm\_ele field\_type\_html\_options', 'label\_class' => 'wcfm\_title field\_type\_html\_options' ), |
  | 1677 |  | "help\_text" => array( 'label' => \_\_('Help Content', 'wc-frontend-manager'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title' ), |
  | 1678 |  | "required" => array( 'label' => \_\_('Required?', 'wc-frontend-manager'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes' ), |
  | 1679 |  | ) ) |
  | 1680 |  | ) ) ); |
  |  | 1682 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters( |
  |  | 1683 | 'wcfmvm\_registration\_static\_fields', |
  |  | 1684 | array( |
  |  | 1685 | "first\_name"  => array('label' => \_\_('First Name', 'wc-frontend-manager'), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[first\_name]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset($wcfmvm\_registration\_static\_fields['first\_name']) ? 'yes' : ''), |
  |  | 1686 | "last\_name"   => array('label' => \_\_('Last Name', 'wc-frontend-manager'), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[last\_name]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset($wcfmvm\_registration\_static\_fields['last\_name']) ? 'yes' : ''), |
  |  | 1687 | "user\_name"   => array('label' => \_\_('User Name', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[user\_name]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset($wcfmvm\_registration\_static\_fields['user\_name']) ? 'yes' : ''), |
  |  | 1688 | "address"     => array('label' => \_\_('Store Address', 'wc-frontend-manager'), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[address]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset($wcfmvm\_registration\_static\_fields['address']) ? 'yes' : ''), |
  |  | 1689 | "phone"       => array('label' => \_\_('Store Phone', 'wc-frontend-manager'), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[phone]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset($wcfmvm\_registration\_static\_fields['phone']) ? 'yes' : ''), |
  |  | 1690 | "terms"       => array('label' => \_\_('Terms & Conditions', 'wc-multivendor-marketplace'), 'type' => 'checkbox', 'name' => 'wcfmvm\_registration\_static\_fields[terms]', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes', 'dfvalue' => isset($wcfmvm\_registration\_static\_fields['terms']) ? 'yes' : ''), |
  |  | 1691 | "terms\_page"  => array('label' => \_\_('Terms Page', 'wc-multivendor-marketplace'), 'type' => 'select', 'name' => 'wcfmvm\_registration\_static\_fields[terms\_page]', 'options' => $pages\_array, 'class' => 'wcfm-select wcfm\_ele terms\_page\_ele', 'label\_class' => 'wcfm\_title terms\_page\_ele', 'value' => isset($wcfmvm\_registration\_static\_fields['terms\_page']) ? $wcfmvm\_registration\_static\_fields['terms\_page'] : '') |
  |  | 1692 | ) |
  |  | 1693 | )); |
  |  | 1694 |  |
  |  | 1695 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_membership\_registration\_custom\_fields', array( |
  |  | 1696 | "wcfmvm\_registration\_custom\_fields" => array('label' => \_\_('Registration Form Custom Fields', 'wc-multivendor-marketplace'), 'type' => 'multiinput', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title wcfm\_full\_title', 'value' => $wcfmvm\_registration\_custom\_fields, 'options' => array( |
  |  | 1697 | "enable"   => array('label' => \_\_('Enable', 'wc-frontend-manager'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox-title', 'value' => 'yes'), |
  |  | 1698 | "type" => array('label' => \_\_('Field Type', 'wc-frontend-manager'), 'type' => 'select', 'options' => $field\_types, 'class' => 'wcfm-select wcfm\_ele field\_type\_options', 'label\_class' => 'wcfm\_title'), |
  |  | 1699 | "label" => array('label' => \_\_('Label', 'wc-frontend-manager'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title'), |
  |  | 1700 | "options" => array('label' => \_\_('Options', 'wc-frontend-manager'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele field\_type\_select\_options field\_type\_dropdown\_options', 'label\_class' => 'wcfm\_title field\_type\_select\_options field\_type\_dropdown\_options', 'placeholder' => \_\_('Insert option values | separated', 'wc-frontend-manager')), |
  |  | 1701 | "content" => array('label' => \_\_('Content', 'wc-frontend-manager'), 'type' => 'textarea', 'class' => 'wcfm-textarea wcfm\_ele field\_type\_html\_options', 'label\_class' => 'wcfm\_title field\_type\_html\_options'), |
  |  | 1702 | "help\_text" => array('label' => \_\_('Help Content', 'wc-frontend-manager'), 'type' => 'text', 'class' => 'wcfm-text wcfm\_ele', 'label\_class' => 'wcfm\_title'), |
  |  | 1703 | "required" => array('label' => \_\_('Required?', 'wc-frontend-manager'), 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes'), |
  |  | 1704 | )) |
  |  | 1705 | ))); |
  | 1681 | 1706 | ?> |
  | 1682 |  |  |
  |  | 1707 |  |
  | 1683 | 1708 | <div class="wcfm\_clearfix"></div><br /> |
  | 1684 |  | <a id="wcfm\_registration\_advanced\_settings" style="color:#17a2b8;font-weight:600;float:right;" href="<?php echo esc\_url(get\_wcfm\_memberships\_settings\_url()); ?>"><span class="wcfmfa fa-user-plus"></span>&nbsp;<span class="text"><?php esc\_html\_e('Registration Advanced Setting', 'wc-frontend-manager'); ?></span></a> |
  |  | 1709 | <a id="wcfm\_registration\_advanced\_settings" style="color:#17a2b8;font-weight:600;float:right;" href="<?php echo esc\_url(get\_wcfm\_memberships\_settings\_url()); ?>"><span class="wcfmfa fa-user-plus"></span>&nbsp;<span class="text"><?php esc\_html\_e('Registration Advanced Setting', 'wc-frontend-manager'); ?></span></a> |
  | 1685 | 1710 | <div class="wcfm\_clearfix"></div> |
  | 1686 | 1711 | </div> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1690) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1715) |  |
  | 1690 | 1715 | <?php |
  | 1691 | 1716 | } |
  | 1692 |  |  |
  | 1693 |  | function wcfm\_vendor\_registration\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 1717 |  |
  |  | 1718 | function wcfm\_vendor\_registration\_settings\_update($wcfm\_settings\_form) { |
  | 1694 | 1719 | global $WCFM, $WCFMmp, $\_POST; |
  | 1695 |  |  |
  | 1696 |  | if~~( !function\_exists( 'get\_wcfm\_memberships\_settings\_url' )~~ ) return; |
  | 1697 |  |  |
  | 1698 |  | $wcfm\_membership\_options = get\_option(~~'wcfm\_membership\_options', array()~~ ); |
  | 1699 |  |  |
  | 1700 |  | if~~( isset( $wcfm\_settings\_form['wcfmvm\_required\_approval'] )~~ ) { |
  |  | 1720 |  |
  |  | 1721 | if (!function\_exists('get\_wcfm\_memberships\_settings\_url')) return; |
  |  | 1722 |  |
  |  | 1723 | $wcfm\_membership\_options = get\_option('wcfm\_membership\_options', array()); |
  |  | 1724 |  |
  |  | 1725 | if (isset($wcfm\_settings\_form['wcfmvm\_required\_approval'])) { |
  | 1701 | 1726 | $wcfm\_membership\_options['membership\_reject\_rules']['required\_approval'] = 'yes'; |
  | 1702 | 1727 | } else { |
  | 1703 | 1728 | $wcfm\_membership\_options['membership\_reject\_rules']['required\_approval'] = 'no'; |
  | 1704 | 1729 | } |
  | 1705 |  |  |
  | 1706 |  | if~~( isset( $wcfm\_settings\_form['wcfmvm\_email\_verification'] )~~ ) { |
  |  | 1730 |  |
  |  | 1731 | if (isset($wcfm\_settings\_form['wcfmvm\_email\_verification'])) { |
  | 1707 | 1732 | $wcfm\_membership\_options['membership\_type\_settings']['email\_verification'] = 'yes'; |
  | 1708 | 1733 | } else { |
  | 1709 | 1734 | $wcfm\_membership\_options['membership\_type\_settings']['email\_verification'] = 'no'; |
  | 1710 |  | unset(~~$wcfm\_membership\_options['membership\_type\_settings']['email\_verification']~~ ); |
  | 1711 |  | } |
  | 1712 |  |  |
  | 1713 |  | if~~( isset( $wcfm\_settings\_form['wcfmvm\_sms\_verification'] )~~ ) { |
  |  | 1735 | unset($wcfm\_membership\_options['membership\_type\_settings']['email\_verification']); |
  |  | 1736 | } |
  |  | 1737 |  |
  |  | 1738 | if (isset($wcfm\_settings\_form['wcfmvm\_sms\_verification'])) { |
  | 1714 | 1739 | $wcfm\_membership\_options['membership\_type\_settings']['sms\_verification'] = 'yes'; |
  | 1715 | 1740 | } else { |
  | 1716 | 1741 | $wcfm\_membership\_options['membership\_type\_settings']['sms\_verification'] = 'no'; |
  | 1717 |  | unset(~~$wcfm\_membership\_options['membership\_type\_settings']['sms\_verification']~~ ); |
  | 1718 |  | } |
  | 1719 |  |  |
  | 1720 |  | ~~update\_option( 'wcfm\_membership\_options', $wcfm\_membership\_options~~ ); |
  | 1721 |  |  |
  | 1722 |  | ~~if( isset( $wcfm\_settings\_form['wcfmvm\_hide\_become\_vendor'] )~~ ) { |
  | 1723 |  | wcfm\_update\_option(~~'wcfmvm\_hide\_become\_vendor', 'yes'~~ ); |
  | 1724 |  | } else { |
  | 1725 |  | wcfm\_update\_option(~~'wcfmvm\_hide\_become\_vendor', 'no'~~ ); |
  | 1726 |  | } |
  | 1727 |  |  |
  | 1728 |  | if~~( isset( $wcfm\_settings\_form['wcfmvm\_registration\_static\_fields'] )~~ ) { |
  | 1729 |  | ~~wcfm\_update\_option( 'wcfmvm\_registration\_static\_fields', $wcfm\_settings\_form['wcfmvm\_registration\_static\_fields']~~ ); |
  | 1730 |  | } else { |
  | 1731 |  | ~~wcfm\_update\_option( 'wcfmvm\_registration\_static\_fields', array()~~ ); |
  | 1732 |  | } |
  | 1733 |  |  |
  | 1734 |  | ~~if( isset( $wcfm\_settings\_form['wcfmvm\_registration\_custom\_fields'] )~~ ) { |
  | 1735 |  | ~~wcfm\_update\_option( 'wcfmvm\_registration\_custom\_fields', $wcfm\_settings\_form['wcfmvm\_registration\_custom\_fields']~~ ); |
  | 1736 |  | } |
  | 1737 |  | } |
  | 1738 |  |  |
  |  | 1742 | unset($wcfm\_membership\_options['membership\_type\_settings']['sms\_verification']); |
  |  | 1743 | } |
  |  | 1744 |  |
  |  | 1745 | update\_option('wcfm\_membership\_options', $wcfm\_membership\_options); |
  |  | 1746 |  |
  |  | 1747 | if (isset($wcfm\_settings\_form['wcfmvm\_hide\_become\_vendor'])) { |
  |  | 1748 | wcfm\_update\_option('wcfmvm\_hide\_become\_vendor', 'yes'); |
  |  | 1749 | } else { |
  |  | 1750 | wcfm\_update\_option('wcfmvm\_hide\_become\_vendor', 'no'); |
  |  | 1751 | } |
  |  | 1752 |  |
  |  | 1753 | if (isset($wcfm\_settings\_form['wcfmvm\_registration\_static\_fields'])) { |
  |  | 1754 | wcfm\_update\_option('wcfmvm\_registration\_static\_fields', $wcfm\_settings\_form['wcfmvm\_registration\_static\_fields']); |
  |  | 1755 | } else { |
  |  | 1756 | wcfm\_update\_option('wcfmvm\_registration\_static\_fields', array()); |
  |  | 1757 | } |
  |  | 1758 |  |
  |  | 1759 | if (isset($wcfm\_settings\_form['wcfmvm\_registration\_custom\_fields'])) { |
  |  | 1760 | wcfm\_update\_option('wcfmvm\_registration\_custom\_fields', $wcfm\_settings\_form['wcfmvm\_registration\_custom\_fields']); |
  |  | 1761 | } |
  |  | 1762 | } |
  |  | 1763 |  |
  | 1739 | 1764 | function wcfmmp\_store\_color\_setting\_options() { |
  | 1740 | 1765 | global $WCFM; |
  | 1741 |  |  |
  | 1742 |  | $color\_options = apply\_filters(~~'wcfmmp\_store\_color\_setting\_options', array(~~ |
  | 1743 |  | ~~'wcfmmp\_store\_name\_color' => array( 'label' => \_\_( 'Store Name', 'wc-multivendor-marketplace' ), 'name' => 'store\_name', 'default' => '#ffffff', 'element' => '#wcfmmp-store .banner\_text h1, #wcfmmp-store .video\_text h1, #wcfmmp-store .slider\_text h1, #wcfmmp-store h1.wcfm\_store\_title, #wcfmmp-store .address h1.wcfm\_store\_title', 'style' => 'color', 'element2' => '#wcfmmp-store .banner\_text h1:after, #wcfmmp-store .banner\_text h1:before', 'style2' => 'background'~~ ), |
  | 1744 |  | ~~'wcfmmp\_header\_background\_color' => array( 'label' => \_\_( 'Header Background', 'wc-multivendor-marketplace' ), 'name' => 'header\_background', 'default' => '#2f2f2f', 'element' => '#wcfmmp-store #wcfm\_store\_header', 'style' => 'background'~~ ), |
  | 1745 |  | ~~'wcfmmp\_header\_social\_background\_color' => array( 'label' => \_\_( 'Header Social Background', 'wc-multivendor-marketplace' ), 'name' => 'header\_social\_background', 'default' => '#212121', 'element' => '#wcfmmp-store .social\_area', 'style' => 'background'~~ ), |
  | 1746 |  | ~~'wcfmmp\_header\_text\_color' => array( 'label' => \_\_( 'Header Text', 'wc-multivendor-marketplace' ), 'name' => 'header\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-store .address span, #wcfmmp-store .address a, #wcfmmp-store .address h1, #wcfmmp-store .address h2, #wcfmmp-store .social\_area ul li:hover i', 'style' => 'color', 'element2' => '#wcfmmp-store .social\_area ul li', 'style2' => 'background'~~ ), |
  | 1747 |  | ~~'wcfmmp\_header\_icon\_color' => array( 'label' => \_\_( 'Header Icon', 'wc-multivendor-marketplace' ), 'name' => 'header\_icon', 'default' => '#17a2b8', 'element' => '#wcfmmp-store .address i, #wcfmmp-store .bd\_icon i, #wcfmmp-store .social\_area ul li, #wcfmmp-store .social\_area ul li a i', 'style' => 'color', 'element2' => '#wcfmmp-store .social\_area ul li:hover', 'style2' => 'background'~~ ), |
  | 1748 |  | ~~'wcfmmp\_sidebar\_background\_color' => array( 'label' => \_\_( 'Sidebar Background', 'wc-multivendor-marketplace' ), 'name' => 'sidebar\_background', 'default' => '#efefef', 'element' => '#wcfmmp-store .left\_sidebar, #wcfmmp-stores-lists .left\_sidebar', 'style' => 'background'~~ ), |
  | 1749 |  | ~~'wcfmmp\_sidebar\_heading\_color' => array( 'label' => \_\_( 'Sidebar Heading', 'wc-multivendor-marketplace' ), 'name' => 'sidebar\_heading', 'default' => '#525252', 'element' => '#wcfmmp-store .sidebar\_heading h4, #wcfmmp-store .reviews\_heading, #wcfmmp-store h2, #wcfmmp-store .user\_name', 'style' => 'color', 'element2' => '.store-data-container .store-phone i', 'style2' => 'background'~~ ), |
  | 1750 |  | ~~'wcfmmp\_sidebar\_text\_color' => array( 'label' => \_\_( 'Sidebar Text', 'wc-multivendor-marketplace' ), 'name' => 'sidebar\_text', 'default' => '#9f9e9e', 'element' => '#wcfmmp-store .categories\_list ul li a, .store-data-container .store-address, .store-data-container .store-phone', 'style' => 'color'~~ ), |
  | 1751 |  | ~~'wcfmmp\_tabs\_text\_color' => array( 'label' => \_\_( 'Tabs Text', 'wc-multivendor-marketplace' ), 'name' => 'tabs\_text', 'default' => '#999999', 'element' => '#wcfmmp-store .tab\_area .tab\_links li a', 'style' => 'color'~~ ), |
  | 1752 |  | ~~'wcfmmp\_tabs\_active\_text\_color' => array( 'label' => \_\_( 'Tabs Active Text', 'wc-multivendor-marketplace' ), 'name' => 'tabs\_active\_text', 'default' => '#17a2b8', 'element' => '#wcfmmp-store .tab\_area .tab\_links li:hover a, #wcfmmp-store .tab\_area .tab\_links li.active a, .wcfmmp\_store\_hours .wcfmmp-store-hours-day', 'style' => 'color', 'element2' => '#wcfmmp-store .tab\_area .tab\_links li:after', 'style2' => 'background', 'element3' => '#wcfmmp-store .tab\_area .tab\_links li.active', 'style3' => 'border-top-color'~~ ), |
  | 1753 |  | ~~'wcfmmp\_store\_card\_heighlight' => array( 'label' => \_\_( 'Store Card Highlight Color', 'wc-multivendor-marketplace' ), 'name' => 'ctore\_card\_highlight', 'default' => '#17a2b8', 'element' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li.coloum-4 .store-data-container .store-data .store-phone i, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li.coloum-5 .store-data-container .store-data .store-phone i', 'style' => 'color', 'element2' => '#wcfmmp-stores-wrap .paginations ul li span.current, #wcfmmp-stores-wrap .paginations ul li a:hover', 'style2' => 'background', 'element3' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-wrapper .store-content', 'style3' => 'border-bottom-color'~~ ), |
  | 1754 |  | ~~'wcfmmp\_store\_card\_title\_color' => array( 'label' => \_\_( 'Store Card Title Color', 'wc-multivendor-marketplace'~~ ), 'name' => 'ctore\_card\_title\_text', 'default' => '#000000', 'element' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data h2 a', 'style' => 'color'), |
  | 1755 |  | ~~'wcfmmp\_store\_card\_color' => array( 'label' => \_\_( 'Store Card Text Color', 'wc-multivendor-marketplace'~~ ), 'name' => 'ctore\_card\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data-container .store-address, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data-container .store-phone', 'style' => 'color'), |
  | 1756 |  | ~~'wcfmmp\_button\_bg\_color' => array( 'label' => \_\_( 'Button Background', 'wc-multivendor-marketplace' ), 'name' => 'button\_bg', 'default' => '#17a2b8', 'element' => '#wcfmmp-store .add\_review button, #wcfmmp-store .user\_rated, #wcfmmp-store .bd\_icon\_box .follow, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_enquiry, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store, .wcfm\_vacation\_msg, .wcfm\_store\_close\_msg', 'style' => 'background', 'element2' => '#wcfmmp-store .reviews\_heading a, #wcfmmp-store .reviews\_count a', 'style2' => 'color', 'element3' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-content, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store', 'style3' => 'border-bottom-color'~~ ), |
  | 1757 |  | ~~'wcfmmp\_button\_text\_color' => array( 'label' => \_\_( 'Button Text', 'wc-multivendor-marketplace' ), 'name' => 'button\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-store .add\_review button, #wcfmmp-store .user\_rated, #wcfmmp-store .bd\_icon\_box .follow, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_enquiry, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow, #wcfmmp-store .bd\_icon\_box .follow span, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_enquiry span, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow span, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store, .wcfm\_vacation\_msg, .wcfm\_store\_close\_msg', 'style' => 'color'~~ ), |
  | 1758 |  | ~~'wcfmmp\_button\_active\_bg\_color' => array( 'label' => \_\_( 'Button Hover Background', 'wc-multivendor-marketplace' ), 'name' => 'button\_active\_bg', 'default' => '#000000', 'element' => '#wcfmmp-store .add\_review button:hover, #wcfmmp-store .bd\_icon\_box .follow:hover, #wcfmmp-store .bd\_icon\_box:hover .wcfm\_store\_enquiry:hover, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow:hover, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover', 'style' => 'background', 'element2' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover', 'style2' => 'border-bottom-color'~~ ), |
  | 1759 |  | ~~'wcfmmp\_button\_active\_text\_color' => array( 'label' => \_\_( 'Button Hover Text', 'wc-multivendor-marketplace' ), 'name' => 'button\_active\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-store .add\_review button:hover, #wcfmmp-store .bd\_icon\_box a.follow:hover, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_enquiry:hover, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_chatnow:hover, #wcfmmp-store .bd\_icon\_box a.follow:hover span, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_enquiry:hover span, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_chatnow:hover span, #wcfmmp-store .bd\_icon\_box a.follow:hover i, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_enquiry:hover i, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_chatnow:hover i, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover span, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover span', 'style' => 'color'~~ ), |
  | 1760 |  | ~~'wcfmmp\_star\_rating\_color' => array( 'label' => \_\_( 'Star Rating', 'wc-multivendor-marketplace' ), 'name' => 'start\_rating', 'default' => '#FF912C', 'element' => '#wcfmmp-store .rating\_box i.selected, #wcfmmp-store .rating-stars ul > li.star.selected > i.wcfmfa, .store-data-container .star-rating span::before, .logo\_area\_after .wcfmmp-store-rating span:before', 'style' => 'color'~~ ), |
  | 1761 |  | ~~)~~ ); |
  | 1762 |  |  |
  |  | 1766 |  |
  |  | 1767 | $color\_options = apply\_filters('wcfmmp\_store\_color\_setting\_options', array( |
  |  | 1768 | 'wcfmmp\_store\_name\_color' => array('label' => \_\_('Store Name', 'wc-multivendor-marketplace'), 'name' => 'store\_name', 'default' => '#ffffff', 'element' => '#wcfmmp-store .banner\_text h1, #wcfmmp-store .video\_text h1, #wcfmmp-store .slider\_text h1, #wcfmmp-store h1.wcfm\_store\_title, #wcfmmp-store .address h1.wcfm\_store\_title', 'style' => 'color', 'element2' => '#wcfmmp-store .banner\_text h1:after, #wcfmmp-store .banner\_text h1:before', 'style2' => 'background'), |
  |  | 1769 | 'wcfmmp\_header\_background\_color' => array('label' => \_\_('Header Background', 'wc-multivendor-marketplace'), 'name' => 'header\_background', 'default' => '#2f2f2f', 'element' => '#wcfmmp-store #wcfm\_store\_header', 'style' => 'background'), |
  |  | 1770 | 'wcfmmp\_header\_social\_background\_color' => array('label' => \_\_('Header Social Background', 'wc-multivendor-marketplace'), 'name' => 'header\_social\_background', 'default' => '#212121', 'element' => '#wcfmmp-store .social\_area', 'style' => 'background'), |
  |  | 1771 | 'wcfmmp\_header\_text\_color' => array('label' => \_\_('Header Text', 'wc-multivendor-marketplace'), 'name' => 'header\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-store .address span, #wcfmmp-store .address a, #wcfmmp-store .address h1, #wcfmmp-store .address h2, #wcfmmp-store .social\_area ul li:hover i', 'style' => 'color', 'element2' => '#wcfmmp-store .social\_area ul li', 'style2' => 'background'), |
  |  | 1772 | 'wcfmmp\_header\_icon\_color' => array('label' => \_\_('Header Icon', 'wc-multivendor-marketplace'), 'name' => 'header\_icon', 'default' => '#17a2b8', 'element' => '#wcfmmp-store .address i, #wcfmmp-store .bd\_icon i, #wcfmmp-store .social\_area ul li, #wcfmmp-store .social\_area ul li a i', 'style' => 'color', 'element2' => '#wcfmmp-store .social\_area ul li:hover', 'style2' => 'background'), |
  |  | 1773 | 'wcfmmp\_sidebar\_background\_color' => array('label' => \_\_('Sidebar Background', 'wc-multivendor-marketplace'), 'name' => 'sidebar\_background', 'default' => '#efefef', 'element' => '#wcfmmp-store .left\_sidebar, #wcfmmp-stores-lists .left\_sidebar', 'style' => 'background'), |
  |  | 1774 | 'wcfmmp\_sidebar\_heading\_color' => array('label' => \_\_('Sidebar Heading', 'wc-multivendor-marketplace'), 'name' => 'sidebar\_heading', 'default' => '#525252', 'element' => '#wcfmmp-store .sidebar\_heading h4, #wcfmmp-store .reviews\_heading, #wcfmmp-store h2, #wcfmmp-store .user\_name', 'style' => 'color', 'element2' => '.store-data-container .store-phone i', 'style2' => 'background'), |
  |  | 1775 | 'wcfmmp\_sidebar\_text\_color' => array('label' => \_\_('Sidebar Text', 'wc-multivendor-marketplace'), 'name' => 'sidebar\_text', 'default' => '#9f9e9e', 'element' => '#wcfmmp-store .categories\_list ul li a, .store-data-container .store-address, .store-data-container .store-phone', 'style' => 'color'), |
  |  | 1776 | 'wcfmmp\_tabs\_text\_color' => array('label' => \_\_('Tabs Text', 'wc-multivendor-marketplace'), 'name' => 'tabs\_text', 'default' => '#999999', 'element' => '#wcfmmp-store .tab\_area .tab\_links li a', 'style' => 'color'), |
  |  | 1777 | 'wcfmmp\_tabs\_active\_text\_color' => array('label' => \_\_('Tabs Active Text', 'wc-multivendor-marketplace'), 'name' => 'tabs\_active\_text', 'default' => '#17a2b8', 'element' => '#wcfmmp-store .tab\_area .tab\_links li:hover a, #wcfmmp-store .tab\_area .tab\_links li.active a, .wcfmmp\_store\_hours .wcfmmp-store-hours-day', 'style' => 'color', 'element2' => '#wcfmmp-store .tab\_area .tab\_links li:after', 'style2' => 'background', 'element3' => '#wcfmmp-store .tab\_area .tab\_links li.active', 'style3' => 'border-top-color'), |
  |  | 1778 | 'wcfmmp\_store\_card\_heighlight' => array('label' => \_\_('Store Card Highlight Color', 'wc-multivendor-marketplace'), 'name' => 'ctore\_card\_highlight', 'default' => '#17a2b8', 'element' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li.coloum-4 .store-data-container .store-data .store-phone i, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li.coloum-5 .store-data-container .store-data .store-phone i', 'style' => 'color', 'element2' => '#wcfmmp-stores-wrap .paginations ul li span.current, #wcfmmp-stores-wrap .paginations ul li a:hover', 'style2' => 'background', 'element3' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-wrapper .store-content', 'style3' => 'border-bottom-color'), |
  |  | 1779 | 'wcfmmp\_store\_card\_title\_color' => array('label' => \_\_('Store Card Title Color', 'wc-multivendor-marketplace'), 'name' => 'ctore\_card\_title\_text', 'default' => '#000000', 'element' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data h2 a', 'style' => 'color'), |
  |  | 1780 | 'wcfmmp\_store\_card\_color' => array('label' => \_\_('Store Card Text Color', 'wc-multivendor-marketplace'), 'name' => 'ctore\_card\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data-container .store-address, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data-container .store-phone', 'style' => 'color'), |
  |  | 1781 | 'wcfmmp\_button\_bg\_color' => array('label' => \_\_('Button Background', 'wc-multivendor-marketplace'), 'name' => 'button\_bg', 'default' => '#17a2b8', 'element' => '#wcfmmp-store .add\_review button, #wcfmmp-store .user\_rated, #wcfmmp-store .bd\_icon\_box .follow, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_enquiry, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store, .wcfm\_vacation\_msg, .wcfm\_store\_close\_msg', 'style' => 'background', 'element2' => '#wcfmmp-store .reviews\_heading a, #wcfmmp-store .reviews\_count a', 'style2' => 'color', 'element3' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-content, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store', 'style3' => 'border-bottom-color'), |
  |  | 1782 | 'wcfmmp\_button\_text\_color' => array('label' => \_\_('Button Text', 'wc-multivendor-marketplace'), 'name' => 'button\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-store .add\_review button, #wcfmmp-store .user\_rated, #wcfmmp-store .bd\_icon\_box .follow, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_enquiry, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow, #wcfmmp-store .bd\_icon\_box .follow span, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_enquiry span, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow span, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store, .wcfm\_vacation\_msg, .wcfm\_store\_close\_msg', 'style' => 'color'), |
  |  | 1783 | 'wcfmmp\_button\_active\_bg\_color' => array('label' => \_\_('Button Hover Background', 'wc-multivendor-marketplace'), 'name' => 'button\_active\_bg', 'default' => '#000000', 'element' => '#wcfmmp-store .add\_review button:hover, #wcfmmp-store .bd\_icon\_box .follow:hover, #wcfmmp-store .bd\_icon\_box:hover .wcfm\_store\_enquiry:hover, #wcfmmp-store .bd\_icon\_box .wcfm\_store\_chatnow:hover, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover', 'style' => 'background', 'element2' => '#wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover', 'style2' => 'border-bottom-color'), |
  |  | 1784 | 'wcfmmp\_button\_active\_text\_color' => array('label' => \_\_('Button Hover Text', 'wc-multivendor-marketplace'), 'name' => 'button\_active\_text', 'default' => '#ffffff', 'element' => '#wcfmmp-store .add\_review button:hover, #wcfmmp-store .bd\_icon\_box a.follow:hover, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_enquiry:hover, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_chatnow:hover, #wcfmmp-store .bd\_icon\_box a.follow:hover span, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_enquiry:hover span, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_chatnow:hover span, #wcfmmp-store .bd\_icon\_box a.follow:hover i, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_enquiry:hover i, #wcfmmp-store .bd\_icon\_box a.wcfm\_store\_chatnow:hover i, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover, #wcfmmp-stores-wrap ul.wcfmmp-store-wrap li .store-data p.store-enquiry a.wcfm\_catalog\_enquiry:hover span, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover, #wcfmmp-stores-wrap .store-footer a.wcfmmp-visit-store:hover span', 'style' => 'color'), |
  |  | 1785 | 'wcfmmp\_star\_rating\_color' => array('label' => \_\_('Star Rating', 'wc-multivendor-marketplace'), 'name' => 'start\_rating', 'default' => '#FF912C', 'element' => '#wcfmmp-store .rating\_box i.selected, #wcfmmp-store .rating-stars ul > li.star.selected > i.wcfmfa, .store-data-container .star-rating span::before, .logo\_area\_after .wcfmmp-store-rating span:before', 'style' => 'color'), |
  |  | 1786 | )); |
  |  | 1787 |  |
  | 1763 | 1788 | return $color\_options; |
  | 1764 | 1789 | } |
  | 1765 |  |  |
  |  | 1790 |  |
  | 1766 | 1791 | function wcfm\_store\_style\_settings() { |
  | 1767 | 1792 | global $WCFM, $WCFMmp; |
  | 1768 |  |  |
  | 1769 |  | $wcfm\_store\_color\_settings = get\_option(~~'wcfm\_store\_color\_settings', array()~~ ); |
  |  | 1793 |  |
  |  | 1794 | $wcfm\_store\_color\_settings = get\_option('wcfm\_store\_color\_settings', array()); |
  | 1770 | 1795 | ?> |
  | 1771 | 1796 | <div class="page\_collapsible" id="wcfmmp\_settings\_form\_store\_style\_head"> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1775) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1800) |  |
  | 1775 | 1800 | <div class="wcfm-container"> |
  | 1776 | 1801 | <div id="wcfmmp\_settings\_form\_store\_style\_expander" class="wcfm-content"> |
  | 1777 |  | <h2><?php echo esc\_attr(apply\_filters(~~'wcfm\_sold\_by\_label', '', \_\_( 'Vendor', 'wc-frontend-manager' )~~ )) . ' ' . esc\_html\_\_('Page Display Setting', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1802 | <h2><?php echo esc\_attr(apply\_filters('wcfm\_sold\_by\_label', '', \_\_('Vendor', 'wc-frontend-manager'))) . ' ' . esc\_html\_\_('Page Display Setting', 'wc-multivendor-marketplace'); ?></h2> |
  | 1778 | 1803 | <div class="wcfm\_clearfix"></div> |
  | 1779 | 1804 | <?php |
  | 1780 |  | $color\_options = $this->wcfmmp\_store\_color\_setting\_options(); |
  | 1781 |  | $color\_options\_array = array(); |
  | 1782 |  |  |
  | 1783 |  | ~~foreach( $color\_options as $color\_option\_key => $color\_option~~ ) { |
  | 1784 |  | ~~$color\_options\_array[$color\_option['name']] = array( 'label' => $color\_option['label'] , 'type' => 'colorpicker', 'class' => 'wcfm-text wcfm\_ele colorpicker', 'label\_class' => 'wcfm\_title wcfm\_ele', 'name' => 'wcfm\_store\_color\_settings['.$color\_option['name'].']', 'value' => ( isset($wcfm\_store\_color\_settings[$color\_option['name']]) ) ? $wcfm\_store\_color\_settings[$color\_option['name']] : $color\_option['default']~~ ); |
  | 1785 |  | } |
  | 1786 |  | ~~$WCFM->wcfm\_fields->wcfm\_generate\_form\_field( $color\_options\_array~~ ); |
  |  | 1805 | $color\_options = $this->wcfmmp\_store\_color\_setting\_options(); |
  |  | 1806 | $color\_options\_array = array(); |
  |  | 1807 |  |
  |  | 1808 | foreach ($color\_options as $color\_option\_key => $color\_option) { |
  |  | 1809 | $color\_options\_array[$color\_option['name']] = array('label' => $color\_option['label'], 'type' => 'colorpicker', 'class' => 'wcfm-text wcfm\_ele colorpicker', 'label\_class' => 'wcfm\_title wcfm\_ele', 'name' => 'wcfm\_store\_color\_settings[' . $color\_option['name'] . ']', 'value' => (isset($wcfm\_store\_color\_settings[$color\_option['name']])) ? $wcfm\_store\_color\_settings[$color\_option['name']] : $color\_option['default']); |
  |  | 1810 | } |
  |  | 1811 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field($color\_options\_array); |
  | 1787 | 1812 | ?> |
  | 1788 | 1813 | <div class="wcfm\_clearfix"></div> |
  | 1789 |  | <input type="submit" name="reset-store-color-settings" value="<?php \_e(~~'Reset to Default', 'wc-frontend-manager'~~ ); ?>" id="wcfm\_store\_color\_setting\_reset\_button" class="wcfm\_submit\_button" /> |
  |  | 1814 | <input type="submit" name="reset-store-color-settings" value="<?php \_e('Reset to Default', 'wc-frontend-manager'); ?>" id="wcfm\_store\_color\_setting\_reset\_button" class="wcfm\_submit\_button" /> |
  | 1790 | 1815 | <div class="wcfm\_clearfix"></div> |
  | 1791 | 1816 | </div> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1794) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1819) |  |
  | 1794 | 1819 | <?php |
  | 1795 | 1820 | } |
  | 1796 |  |  |
  | 1797 |  | function wcfm\_store\_style\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 1821 |  |
  |  | 1822 | function wcfm\_store\_style\_settings\_update($wcfm\_settings\_form) { |
  | 1798 | 1823 | global $WCFM, $WCFMmp, $\_POST; |
  | 1799 |  |  |
  | 1800 |  | ~~if( isset( $wcfm\_settings\_form['wcfm\_store\_color\_settings'] )~~ ) { |
  | 1801 |  | ~~update\_option( 'wcfm\_store\_color\_settings', $wcfm\_settings\_form['wcfm\_store\_color\_settings']~~ ); |
  | 1802 |  | $this->wcfmmp\_create\_store\_css(); |
  | 1803 |  | } |
  | 1804 |  | } |
  | 1805 |  |  |
  |  | 1824 |  |
  |  | 1825 | if (isset($wcfm\_settings\_form['wcfm\_store\_color\_settings'])) { |
  |  | 1826 | update\_option('wcfm\_store\_color\_settings', $wcfm\_settings\_form['wcfm\_store\_color\_settings']); |
  |  | 1827 | $this->wcfmmp\_create\_store\_css(); |
  |  | 1828 | } |
  |  | 1829 | } |
  |  | 1830 |  |
  | 1806 | 1831 | /\*\* |
  | 1807 | 1832 | \* Create WCFMmp custom Store CSS |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1809) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1834) |  |
  | 1809 | 1834 | function wcfmmp\_create\_store\_css() { |
  | 1810 | 1835 | global $WCFM, $WCFMmp; |
  | 1811 |  |  |
  | 1812 |  | $wcfm\_store\_color\_settings = get\_option(~~'wcfm\_store\_color\_settings', array()~~ ); |
  |  | 1836 |  |
  |  | 1837 | $wcfm\_store\_color\_settings = get\_option('wcfm\_store\_color\_settings', array()); |
  | 1813 | 1838 | $color\_options = $this->wcfmmp\_store\_color\_setting\_options(); |
  | 1814 | 1839 | $custom\_color\_data = ''; |
  | 1815 | 1840 | $custom\_button\_color\_data = ''; |
  | 1816 |  | foreach~~( $color\_options as $color\_option\_key => $color\_option~~ ) { |
  | 1817 |  | $custom\_color\_data .= $color\_option['element'] . '{ ' . "\n"; |
  |  | 1841 | foreach ($color\_options as $color\_option\_key => $color\_option) { |
  |  | 1842 | $custom\_color\_data .= $color\_option['element'] . '{ ' . "\n"; |
  | 1818 | 1843 | $custom\_color\_data .= "\t" . $color\_option['style'] . ': '; |
  | 1819 |  | if( isset( $wcfm\_store\_color\_settings[ $color\_option['name'] ] ) ) { $custom\_color\_data .= $wcfm\_store\_color\_settings[ $color\_option['name'] ]; } else { $custom\_color\_data .= $color\_option['default']; } |
  |  | 1844 | if (isset($wcfm\_store\_color\_settings[$color\_option['name']])) { |
  |  | 1845 | $custom\_color\_data .= $wcfm\_store\_color\_settings[$color\_option['name']]; |
  |  | 1846 | } else { |
  |  | 1847 | $custom\_color\_data .= $color\_option['default']; |
  |  | 1848 | } |
  | 1820 | 1849 | $custom\_color\_data .= '!important;' . "\n"; |
  | 1821 | 1850 | $custom\_color\_data .= '}' . "\n\n"; |
  | 1822 |  |  |
  | 1823 |  | if~~( in\_array( $color\_option\_key, array( 'wcfmvm\_field\_button\_color', 'wcfmvm\_field\_button\_hover\_color', 'wcfmvm\_field\_button\_bg\_color' ) )~~ ) { |
  |  | 1851 |  |
  |  | 1852 | if (in\_array($color\_option\_key, array('wcfmvm\_field\_button\_color', 'wcfmvm\_field\_button\_hover\_color', 'wcfmvm\_field\_button\_bg\_color'))) { |
  | 1824 | 1853 | $custom\_button\_color\_data .= $color\_option['element'] . '{ ' . "\n"; |
  | 1825 | 1854 | $custom\_button\_color\_data .= "\t" . $color\_option['style'] . ': '; |
  | 1826 |  | if( isset( $wcfm\_store\_color\_settings[ $color\_option['name'] ] ) ) { $custom\_button\_color\_data .= $wcfm\_store\_color\_settings[ $color\_option['name'] ]; } else { $custom\_button\_color\_data .= $color\_option['default']; } |
  |  | 1855 | if (isset($wcfm\_store\_color\_settings[$color\_option['name']])) { |
  |  | 1856 | $custom\_button\_color\_data .= $wcfm\_store\_color\_settings[$color\_option['name']]; |
  |  | 1857 | } else { |
  |  | 1858 | $custom\_button\_color\_data .= $color\_option['default']; |
  |  | 1859 | } |
  | 1827 | 1860 | $custom\_button\_color\_data .= '!important;' . "\n"; |
  | 1828 | 1861 | $custom\_button\_color\_data .= '}' . "\n\n"; |
  | 1829 | 1862 | } |
  | 1830 |  |  |
  | 1831 |  | if~~( isset( $color\_option['element2'] ) && isset( $color\_option['style2'] )~~ ) { |
  |  | 1863 |  |
  |  | 1864 | if (isset($color\_option['element2']) && isset($color\_option['style2'])) { |
  | 1832 | 1865 | $custom\_color\_data .= $color\_option['element2'] . '{ ' . "\n"; |
  | 1833 | 1866 | $custom\_color\_data .= "\t" . $color\_option['style2'] . ': '; |
  | 1834 |  | if( isset( $wcfm\_store\_color\_settings[ $color\_option['name'] ] ) ) { $custom\_color\_data .= $wcfm\_store\_color\_settings[ $color\_option['name'] ]; } else { $custom\_color\_data .= $color\_option['default2']; } |
  |  | 1867 | if (isset($wcfm\_store\_color\_settings[$color\_option['name']])) { |
  |  | 1868 | $custom\_color\_data .= $wcfm\_store\_color\_settings[$color\_option['name']]; |
  |  | 1869 | } else { |
  |  | 1870 | $custom\_color\_data .= $color\_option['default2']; |
  |  | 1871 | } |
  | 1835 | 1872 | $custom\_color\_data .= '!important;' . "\n"; |
  | 1836 | 1873 | $custom\_color\_data .= '}' . "\n\n"; |
  | 1837 | 1874 | } |
  | 1838 |  |  |
  | 1839 |  | if~~( isset( $color\_option['element3'] ) && isset( $color\_option['style3'] )~~ ) { |
  |  | 1875 |  |
  |  | 1876 | if (isset($color\_option['element3']) && isset($color\_option['style3'])) { |
  | 1840 | 1877 | $custom\_color\_data .= $color\_option['element3'] . '{ ' . "\n"; |
  | 1841 | 1878 | $custom\_color\_data .= "\t" . $color\_option['style3'] . ': '; |
  | 1842 |  | if( isset( $wcfm\_store\_color\_settings[ $color\_option['name'] ] ) ) { $custom\_color\_data .= $wcfm\_store\_color\_settings[ $color\_option['name'] ]; } else { $custom\_color\_data .= $color\_option['default']; } |
  |  | 1879 | if (isset($wcfm\_store\_color\_settings[$color\_option['name']])) { |
  |  | 1880 | $custom\_color\_data .= $wcfm\_store\_color\_settings[$color\_option['name']]; |
  |  | 1881 | } else { |
  |  | 1882 | $custom\_color\_data .= $color\_option['default']; |
  |  | 1883 | } |
  | 1843 | 1884 | $custom\_color\_data .= '!important;' . "\n"; |
  | 1844 | 1885 | $custom\_color\_data .= '}' . "\n\n"; |
  | 1845 | 1886 | } |
  | 1846 |  |  |
  | 1847 |  | if~~( isset( $color\_option['element4'] ) && isset( $color\_option['style4'] )~~ ) { |
  |  | 1887 |  |
  |  | 1888 | if (isset($color\_option['element4']) && isset($color\_option['style4'])) { |
  | 1848 | 1889 | $custom\_color\_data .= $color\_option['element4'] . '{ ' . "\n"; |
  | 1849 | 1890 | $custom\_color\_data .= "\t" . $color\_option['style4'] . ': '; |
  | 1850 |  | if( isset( $wcfm\_store\_color\_settings[ $color\_option['name'] ] ) ) { $custom\_color\_data .= $wcfm\_store\_color\_settings[ $color\_option['name'] ]; } else { $custom\_color\_data .= $color\_option['default']; } |
  |  | 1891 | if (isset($wcfm\_store\_color\_settings[$color\_option['name']])) { |
  |  | 1892 | $custom\_color\_data .= $wcfm\_store\_color\_settings[$color\_option['name']]; |
  |  | 1893 | } else { |
  |  | 1894 | $custom\_color\_data .= $color\_option['default']; |
  |  | 1895 | } |
  | 1851 | 1896 | $custom\_color\_data .= '!important;' . "\n"; |
  | 1852 | 1897 | $custom\_color\_data .= '}' . "\n\n"; |
  | 1853 | 1898 | } |
  | 1854 |  |  |
  | 1855 |  | if~~( isset( $color\_option['element5'] ) && isset( $color\_option['style5'] )~~ ) { |
  |  | 1899 |  |
  |  | 1900 | if (isset($color\_option['element5']) && isset($color\_option['style5'])) { |
  | 1856 | 1901 | $custom\_color\_data .= $color\_option['element5'] . '{ ' . "\n"; |
  | 1857 | 1902 | $custom\_color\_data .= "\t" . $color\_option['style5'] . ': '; |
  | 1858 |  | if( isset( $wcfm\_store\_color\_settings[ $color\_option['name'] ] ) ) { $custom\_color\_data .= $wcfm\_store\_color\_settings[ $color\_option['name'] ]; } else { $custom\_color\_data .= $color\_option['default']; } |
  |  | 1903 | if (isset($wcfm\_store\_color\_settings[$color\_option['name']])) { |
  |  | 1904 | $custom\_color\_data .= $wcfm\_store\_color\_settings[$color\_option['name']]; |
  |  | 1905 | } else { |
  |  | 1906 | $custom\_color\_data .= $color\_option['default']; |
  |  | 1907 | } |
  | 1859 | 1908 | $custom\_color\_data .= '!important;' . "\n"; |
  | 1860 | 1909 | $custom\_color\_data .= '}' . "\n\n"; |
  | 1861 | 1910 | } |
  | 1862 | 1911 | } |
  | 1863 |  |  |
  |  | 1912 |  |
  | 1864 | 1913 | $upload\_dir      = wp\_upload\_dir(); |
  | 1865 | 1914 |  |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1873) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1922) |  |
  | 1873 | 1922 | ); |
  | 1874 | 1923 |  |
  | 1875 |  | $wcfmmp\_style\_custom = get\_option(~~'wcfmmp\_style\_custom'~~ ); |
  | 1876 |  | if~~(  $wcfmmp\_style\_custom && file\_exists( trailingslashit( $upload\_dir['basedir'] ) . 'wcfm/' . $wcfmmp\_style\_custom )~~ ) { |
  | 1877 |  | unlink(~~trailingslashit( $upload\_dir['basedir'] ) . 'wcfm/' . $wcfmmp\_style\_custom~~ ); |
  | 1878 |  | } |
  | 1879 |  |  |
  | 1880 |  | foreach (~~$files as $file~~ ) { |
  | 1881 |  | if (~~wp\_mkdir\_p( $file['base'] )~~ ) { |
  | 1882 |  | if (~~$file\_handle = @fopen( trailingslashit( $file['base'] ) . $file['file'], 'w' )~~ ) { |
  |  | 1924 | $wcfmmp\_style\_custom = get\_option('wcfmmp\_style\_custom'); |
  |  | 1925 | if ($wcfmmp\_style\_custom && file\_exists(trailingslashit($upload\_dir['basedir']) . 'wcfm/' . $wcfmmp\_style\_custom)) { |
  |  | 1926 | unlink(trailingslashit($upload\_dir['basedir']) . 'wcfm/' . $wcfmmp\_style\_custom); |
  |  | 1927 | } |
  |  | 1928 |  |
  |  | 1929 | foreach ($files as $file) { |
  |  | 1930 | if (wp\_mkdir\_p($file['base'])) { |
  |  | 1931 | if ($file\_handle = @fopen(trailingslashit($file['base']) . $file['file'], 'w')) { |
  | 1883 | 1932 | $wcfmvm\_style\_custom = $file['file']; |
  | 1884 |  | update\_option(~~$file['key'], $file['file']~~ ); |
  | 1885 |  | fwrite(~~$file\_handle, $file['content']~~ ); |
  | 1886 |  | fclose(~~$file\_handle~~ ); |
  |  | 1933 | update\_option($file['key'], $file['file']); |
  |  | 1934 | fwrite($file\_handle, $file['content']); |
  |  | 1935 | fclose($file\_handle); |
  | 1887 | 1936 | } |
  | 1888 | 1937 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1890) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1939) |  |
  | 1890 | 1939 | return $wcfmmp\_style\_custom; |
  | 1891 | 1940 | } |
  | 1892 |  |  |
  | 1893 |  | function wcfm\_data\_cleanup\_settings(~~$wcfm\_options~~ ) { |
  |  | 1941 |  |
  |  | 1942 | function wcfm\_data\_cleanup\_settings($wcfm\_options) { |
  | 1894 | 1943 | global $WCFM, $WCFMmp; |
  | 1895 |  |  |
  | 1896 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_data\_cleanup', true ) ) return;~~ |
  | 1897 |  |  |
  | 1898 |  | $wcfm\_data\_cleanup\_options        = get\_option(~~'wcfm\_data\_cleanup\_options', array()~~ ); |
  | 1899 |  |  |
  | 1900 |  | $enable\_data\_cleanup              = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup'] : 'no'; |
  | 1901 |  |  |
  | 1902 |  | $enable\_data\_cleanup\_messages     = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages'] : 'no'; |
  | 1903 |  | $messages\_data\_cleanup\_more\_than  = isset(~~$wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than']~~ ) ? $wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than'] : '90'; |
  | 1904 |  |  |
  | 1905 |  | $enable\_data\_cleanup\_inquiry      = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry'] : 'no'; |
  | 1906 |  | $inquiry\_data\_cleanup\_more\_than   = isset(~~$wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than']~~ ) ? $wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than'] : '90'; |
  | 1907 |  |  |
  | 1908 |  | $enable\_data\_cleanup\_analytics    = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics'] : 'no'; |
  | 1909 |  | $analytics\_data\_cleanup\_more\_than = isset(~~$wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than']~~ ) ? $wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than'] : '90'; |
  | 1910 |  |  |
  |  | 1944 |  |
  |  | 1945 | if (!apply\_filters('wcfm\_is\_allow\_data\_cleanup', true)) return; |
  |  | 1946 |  |
  |  | 1947 | $wcfm\_data\_cleanup\_options        = get\_option('wcfm\_data\_cleanup\_options', array()); |
  |  | 1948 |  |
  |  | 1949 | $enable\_data\_cleanup              = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup'] : 'no'; |
  |  | 1950 |  |
  |  | 1951 | $enable\_data\_cleanup\_messages     = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages'] : 'no'; |
  |  | 1952 | $messages\_data\_cleanup\_more\_than  = isset($wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than']) ? $wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than'] : '90'; |
  |  | 1953 |  |
  |  | 1954 | $enable\_data\_cleanup\_inquiry      = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry'] : 'no'; |
  |  | 1955 | $inquiry\_data\_cleanup\_more\_than   = isset($wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than']) ? $wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than'] : '90'; |
  |  | 1956 |  |
  |  | 1957 | $enable\_data\_cleanup\_analytics    = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics'] : 'no'; |
  |  | 1958 | $analytics\_data\_cleanup\_more\_than = isset($wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than']) ? $wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than'] : '90'; |
  |  | 1959 |  |
  | 1911 | 1960 | ?> |
  | 1912 | 1961 | <!-- collapsible --> |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=2628276#L1917) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-settings.php?rev=3000763#L1966) |  |
  | 1917 | 1966 | <div class="wcfm-container"> |
  | 1918 | 1967 | <div id="wcfm\_settings\_form\_data\_cleanup\_expander" class="wcfm-content"> |
  | 1919 |  | <h2><?php \_e('Data Cleanup Settings', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1968 | <h2><?php \_e('Data Cleanup Settings', 'wc-multivendor-marketplace'); ?></h2> |
  | 1920 | 1969 | <div class="wcfm\_clearfix"></div> |
  | 1921 | 1970 | <div class="store\_address"> |
  | 1922 | 1971 | <?php |
  | 1923 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_data\_cleanup', array( |
  | 1924 |  | ~~"enable\_data\_cleanup" => array('label' => \_\_('Enable Data Cleanup', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_( 'Check this to enable scheduled cleanup old data. It will not possible to restore this data anymore.', 'wc-multivendor-marketplace' )~~ ), |
  | 1925 |  | ~~) )~~ ); |
  |  | 1972 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_data\_cleanup', array( |
  |  | 1973 | "enable\_data\_cleanup" => array('label' => \_\_('Enable Data Cleanup', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele', 'label\_class' => 'wcfm\_title checkbox\_title', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup, 'desc\_class' => 'wcfm\_page\_options\_desc', 'desc' => \_\_('Check this to enable scheduled cleanup old data. It will not possible to restore this data anymore.', 'wc-multivendor-marketplace')), |
  |  | 1974 | ))); |
  | 1926 | 1975 | ?> |
  | 1927 | 1976 | </div> |
  | 1928 |  |  |
  |  | 1977 |  |
  | 1929 | 1978 | <div id="wcfm\_settings\_form\_data\_cleanup\_for\_messages\_expander" class="wcfm\_data\_cleanup\_fields" style="margin-top:50px;"> |
  | 1930 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Notification Message Cleanup', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1931 |  | <div class="wcfm\_clearfix"></div> |
  |  | 1979 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 1980 | <h2><?php \_e('Notification Message Cleanup', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1981 | </div> |
  |  | 1982 | <div class="wcfm\_clearfix"></div> |
  | 1932 | 1983 | <div class="store\_address"> |
  | 1933 |  |  |
  |  | 1984 |  |
  | 1934 | 1985 | <?php |
  | 1935 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(~~apply\_filters(~~ 'wcfm\_marketplace\_settings\_fields\_data\_cleanup\_messages', array( |
  | 1936 |  | ~~"enable\_data\_cleanup\_messages"    => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup\_messages]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_data\_cleanup\_fields', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup\_messages, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_data\_cleanup\_fields', 'desc' => \_\_( 'Check this to enable scheduled cleanup old notification messages.', 'wc-multivendor-marketplace' )~~ ), |
  | 1937 |  | ~~"messages\_data\_cleanup\_more\_than" => array('label' => \_\_('Cleanup data more than', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[messages\_data\_cleanup\_more\_than]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title wcfm\_data\_cleanup\_fields', 'options' => array( 30 => \_\_( '30 days old', 'wc-multivendor-marketplace' ), 60 => \_\_( '60 days old', 'wc-multivendor-marketplace' ), 90 => \_\_( '90 days old', 'wc-multivendor-marketplace' ), 180 => \_\_( '180 days old', 'wc-multivendor-marketplace' ), 365 => \_\_( '365 days old', 'wc-multivendor-marketplace' ) ), 'value' => $messages\_data\_cleanup\_more\_than~~ ), |
  | 1938 |  | ~~) )~~ ); |
  | 1939 |  | ?> |
  | 1940 |  | </div> |
  | 1941 |  | </div> |
  | 1942 |  |  |
  |  | 1986 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_data\_cleanup\_messages', array( |
  |  | 1987 | "enable\_data\_cleanup\_messages"    => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup\_messages]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_data\_cleanup\_fields', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup\_messages, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_data\_cleanup\_fields', 'desc' => \_\_('Check this to enable scheduled cleanup old notification messages.', 'wc-multivendor-marketplace')), |
  |  | 1988 | "messages\_data\_cleanup\_more\_than" => array('label' => \_\_('Cleanup data more than', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[messages\_data\_cleanup\_more\_than]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title wcfm\_data\_cleanup\_fields', 'options' => array(30 => \_\_('30 days old', 'wc-multivendor-marketplace'), 60 => \_\_('60 days old', 'wc-multivendor-marketplace'), 90 => \_\_('90 days old', 'wc-multivendor-marketplace'), 180 => \_\_('180 days old', 'wc-multivendor-marketplace'), 365 => \_\_('365 days old', 'wc-multivendor-marketplace')), 'value' => $messages\_data\_cleanup\_more\_than), |
  |  | 1989 | ))); |
  |  | 1990 | ?> |
  |  | 1991 | </div> |
  |  | 1992 | </div> |
  |  | 1993 |  |
  | 1943 | 1994 | <div id="wcfm\_settings\_form\_data\_cleanup\_for\_inquiry\_expander" class="wcfm\_data\_cleanup\_fields" style="margin-top:50px;"> |
  | 1944 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Inquiry Messages Cleanup', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1945 |  | <div class="wcfm\_clearfix"></div> |
  |  | 1995 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 1996 | <h2><?php \_e('Inquiry Messages Cleanup', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 1997 | </div> |
  |  | 1998 | <div class="wcfm\_clearfix"></div> |
  | 1946 | 1999 | <div class="store\_address"> |
  | 1947 |  |  |
  |  | 2000 |  |
  | 1948 | 2001 | <?php |
  | 1949 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( apply\_filters( 'wcfm\_marketplace\_settings\_fields\_data\_cleanup\_inquiry', array( |
  | 1950 |  | "enable\_data\_cleanup\_inquiry" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup\_inquiry]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_data\_cleanup\_fields', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup\_inquiry, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_data\_cleanup\_fields', 'desc' => \_\_( 'Check this to enable scheduled cleanup old inquiry messages.', 'wc-multivendor-marketplace' ) ), |
  | 1951 |  | "inquiry\_data\_cleanup\_more\_than" => array('label' => \_\_('Cleanup data more than', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[inquiry\_data\_cleanup\_more\_than]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title wcfm\_data\_cleanup\_fields', 'options' => array( 30 => \_\_( '30 days old', 'wc-multivendor-marketplace' ), 60 => \_\_( '60 days old', 'wc-multivendor-marketplace' ), 90 => \_\_( '90 days old', 'wc-multivendor-marketplace' ), 180 => \_\_( '180 days old', 'wc-multivendor-marketplace' ), 365 => \_\_( '365 days old', 'wc-multivendor-marketplace' ) ), 'value' => $inquiry\_data\_cleanup\_more\_than ), |
  | 1952 |  | ) ) ); |
  | 1953 |  | ?> |
  | 1954 |  | </div> |
  | 1955 |  | </div> |
  | 1956 |  |  |
  | 1957 |  | <?php //if( WCFM\_Dependencies::wcfma\_plugin\_active\_check() ) { ?> |
  | 1958 |  | <div id="wcfm\_settings\_form\_data\_cleanup\_for\_analytics\_expander" class="wcfm\_data\_cleanup\_fields" style="margin-top:50px;"> |
  | 1959 |  | <div class="wcfm\_vendor\_settings\_heading"><h2><?php \_e('Analytics Data Cleanup', 'wc-multivendor-marketplace'); ?></h2></div> |
  | 1960 |  | <div class="wcfm\_clearfix"></div> |
  | 1961 |  | <div class="store\_address"> |
  | 1962 |  |  |
  | 1963 |  | <?php |
  | 1964 |  | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field( apply\_filters( 'wcfm\_marketplace\_settings\_fields\_data\_cleanup\_analytics', array( |
  | 1965 |  | "enable\_data\_cleanup\_analytics"    => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup\_analytics]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_data\_cleanup\_fields', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup\_analytics, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_data\_cleanup\_fields', 'desc' => \_\_( 'Check this to enable scheduled cleanup old notification messages.', 'wc-multivendor-marketplace' ) ), |
  | 1966 |  | "analytics\_data\_cleanup\_more\_than" => array('label' => \_\_('Cleanup data more than', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[analytics\_data\_cleanup\_more\_than]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title wcfm\_data\_cleanup\_fields', 'options' => array( 30 => \_\_( '30 days old', 'wc-multivendor-marketplace' ), 60 => \_\_( '60 days old', 'wc-multivendor-marketplace' ), 90 => \_\_( '90 days old', 'wc-multivendor-marketplace' ), 180 => \_\_( '180 days old', 'wc-multivendor-marketplace' ), 365 => \_\_( '365 days old', 'wc-multivendor-marketplace' ) ), 'value' => $analytics\_data\_cleanup\_more\_than ), |
  | 1967 |  | ) ) ); |
  | 1968 |  | ?> |
  | 1969 |  | </div> |
  |  | 2002 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_data\_cleanup\_inquiry', array( |
  |  | 2003 | "enable\_data\_cleanup\_inquiry" => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup\_inquiry]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_data\_cleanup\_fields', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup\_inquiry, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_data\_cleanup\_fields', 'desc' => \_\_('Check this to enable scheduled cleanup old inquiry messages.', 'wc-multivendor-marketplace')), |
  |  | 2004 | "inquiry\_data\_cleanup\_more\_than" => array('label' => \_\_('Cleanup data more than', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[inquiry\_data\_cleanup\_more\_than]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title wcfm\_data\_cleanup\_fields', 'options' => array(30 => \_\_('30 days old', 'wc-multivendor-marketplace'), 60 => \_\_('60 days old', 'wc-multivendor-marketplace'), 90 => \_\_('90 days old', 'wc-multivendor-marketplace'), 180 => \_\_('180 days old', 'wc-multivendor-marketplace'), 365 => \_\_('365 days old', 'wc-multivendor-marketplace')), 'value' => $inquiry\_data\_cleanup\_more\_than), |
  |  | 2005 | ))); |
  |  | 2006 | ?> |
  | 1970 | 2007 | </div> |
  | 1971 |  | <?php //} ?> |
  |  | 2008 | </div> |
  |  | 2009 |  |
  |  | 2010 | <?php //if( WCFM\_Dependencies::wcfma\_plugin\_active\_check() ) { |
  |  | 2011 | ?> |
  |  | 2012 | <div id="wcfm\_settings\_form\_data\_cleanup\_for\_analytics\_expander" class="wcfm\_data\_cleanup\_fields" style="margin-top:50px;"> |
  |  | 2013 | <div class="wcfm\_vendor\_settings\_heading"> |
  |  | 2014 | <h2><?php \_e('Analytics Data Cleanup', 'wc-multivendor-marketplace'); ?></h2> |
  |  | 2015 | </div> |
  |  | 2016 | <div class="wcfm\_clearfix"></div> |
  |  | 2017 | <div class="store\_address"> |
  |  | 2018 |  |
  |  | 2019 | <?php |
  |  | 2020 | $WCFM->wcfm\_fields->wcfm\_generate\_form\_field(apply\_filters('wcfm\_marketplace\_settings\_fields\_data\_cleanup\_analytics', array( |
  |  | 2021 | "enable\_data\_cleanup\_analytics"    => array('label' => \_\_('Enable', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[enable\_data\_cleanup\_analytics]', 'type' => 'checkbox', 'class' => 'wcfm-checkbox wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title checkbox\_title wcfm\_data\_cleanup\_fields', 'value' => 'yes', 'dfvalue' => $enable\_data\_cleanup\_analytics, 'desc\_class' => 'wcfm\_page\_options\_desc wcfm\_data\_cleanup\_fields', 'desc' => \_\_('Check this to enable scheduled cleanup old notification messages.', 'wc-multivendor-marketplace')), |
  |  | 2022 | "analytics\_data\_cleanup\_more\_than" => array('label' => \_\_('Cleanup data more than', 'wc-multivendor-marketplace'), 'name' => 'wcfm\_data\_cleanup\_options[analytics\_data\_cleanup\_more\_than]', 'type' => 'select', 'class' => 'wcfm-select wcfm\_ele wcfm\_data\_cleanup\_fields', 'label\_class' => 'wcfm\_title wcfm\_data\_cleanup\_fields', 'options' => array(30 => \_\_('30 days old', 'wc-multivendor-marketplace'), 60 => \_\_('60 days old', 'wc-multivendor-marketplace'), 90 => \_\_('90 days old', 'wc-multivendor-marketplace'), 180 => \_\_('180 days old', 'wc-multivendor-marketplace'), 365 => \_\_('365 days old', 'wc-multivendor-marketplace')), 'value' => $analytics\_data\_cleanup\_more\_than), |
  |  | 2023 | ))); |
  |  | 2024 | ?> |
  |  | 2025 | </div> |
  |  | 2026 | </div> |
  |  | 2027 | <?php //} |
  |  | 2028 | ?> |
  | 1972 | 2029 | </div> |
  | 1973 | 2030 | </div> |
  | 1974 | 2031 | <div class="wcfm\_clearfix"></div> |
  | 1975 | 2032 | <!-- end collapsible --> |
  | 1976 |  |  |
  |  | 2033 |  |
  | 1977 | 2034 | <?php |
  | 1978 |  |  |
  | 1979 |  | } |
  | 1980 |  |  |
  | 1981 |  | function wcfm\_data\_cleanup\_settings\_update(~~$wcfm\_settings\_form~~ ) { |
  |  | 2035 |  |
  |  | 2036 | } |
  |  | 2037 |  |
  |  | 2038 | function wcfm\_data\_cleanup\_settings\_update($wcfm\_settings\_form) { |
  | 1982 | 2039 | global $WCFM, $WCFMmp, $\_POST; |
  | 1983 |  |  |
  | 1984 |  | if~~( !apply\_filters( 'wcfm\_is\_allow\_data\_cleanup', true ) ) return;~~ |
  | 1985 |  |  |
  | 1986 |  | if~~( isset( $wcfm\_settings\_form['wcfm\_data\_cleanup\_options'] )~~ ) { |
  | 1987 |  | update\_option(~~'wcfm\_data\_cleanup\_options', $wcfm\_settings\_form['wcfm\_data\_cleanup\_options']~~ ); |
  | 1988 |  | } else { |
  | 1989 |  | update\_option(~~'wcfm\_data\_cleanup\_options', array()~~ ); |
  | 1990 |  | } |
  | 1991 |  |  |
  | 1992 |  | ~~if( !isset( $wcfm\_settings\_form['wcfm\_data\_cleanup\_options'] ) || !isset( $wcfm\_settings\_form['wcfm\_data\_cleanup\_options']['enable\_data\_cleanup'] )~~ ) { |
  | 1993 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  | 1994 |  | if (~~$next~~ ) { |
  | 1995 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  |  | 2040 |  |
  |  | 2041 | if (!apply\_filters('wcfm\_is\_allow\_data\_cleanup', true)) return; |
  |  | 2042 |  |
  |  | 2043 | if (isset($wcfm\_settings\_form['wcfm\_data\_cleanup\_options'])) { |
  |  | 2044 | update\_option('wcfm\_data\_cleanup\_options', $wcfm\_settings\_form['wcfm\_data\_cleanup\_options']); |
  |  | 2045 | } else { |
  |  | 2046 | update\_option('wcfm\_data\_cleanup\_options', array()); |
  |  | 2047 | } |
  |  | 2048 |  |
  |  | 2049 | if (!isset($wcfm\_settings\_form['wcfm\_data\_cleanup\_options']) || !isset($wcfm\_settings\_form['wcfm\_data\_cleanup\_options']['enable\_data\_cleanup'])) { |
  |  | 2050 | $next = WC()->queue()->get\_next('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  |  | 2051 | if ($next) { |
  |  | 2052 | WC()->queue()->cancel\_all('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  | 1996 | 2053 | } |
  | 1997 | 2054 | } |
  | 1998 | 2055 | } |
  | 1999 |  |  |
  | 2000 | 2056 | } |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-store.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-store.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-store.php")

  | [r2887030](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-store.php?rev=2887030#L530 "Show revision 2887030 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-store.php?rev=3000763#L530 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 530 | 530 | \* Get the shop address |
  | 531 | 531 | \* |
  | 532 |  | \* @return ~~array~~ |
  |  | 532 | \* @return string |
  | 533 | 533 | \*/ |
  | 534 | 534 | public function get\_address\_string( $branch\_id = '' ) { |
  | 535 | 535 | $vendor\_data = apply\_filters( 'wcfmmp\_store\_vendor\_data', $this->shop\_data, $this->id, $branch\_id ); |
  | 536 | 536 |  |
  | 537 |  | $address = isset( $vendor\_data['address'] ) ? $vendor\_data['address'] : ''; |
  | 538 |  | $addr\_1  = isset( $vendor\_data['address']['street\_1'] ) ? $vendor\_data['address']['street\_1'] : ''; |
  | 539 |  | $addr\_2  = isset( $vendor\_data['address']['street\_2'] ) ? $vendor\_data['address']['street\_2'] : ''; |
  | 540 |  | $city    = isset( $vendor\_data['address']['city'] ) ? $vendor\_data['address']['city'] : ''; |
  | 541 |  | $zip     = isset( $vendor\_data['address']['zip'] ) ? $vendor\_data['address']['zip'] : ''; |
  | 542 |  | $country = isset( $vendor\_data['address']['country'] ) ? $vendor\_data['address']['country'] : ''; |
  | 543 |  | $state   = isset( $vendor\_data['address']['state'] ) ? $vendor\_data['address']['state'] : ''; |
  | 544 |  |  |
  | 545 |  | // Country -> States |
  | 546 |  | $country\_obj   = new WC\_Countries(); |
  | 547 |  | $countries     = $country\_obj->countries; |
  | 548 |  | $states        = $country\_obj->states; |
  | 549 |  | $country\_name  = ''; |
  | 550 |  | $state\_name    = ''; |
  | 551 |  | if( $country ) $country\_name = $country; |
  | 552 |  | if( $state ) $state\_name = $state; |
  | 553 |  | if( $country && isset( $countries[$country] ) ) { |
  | 554 |  | $country\_name = $countries[$country]; |
  | 555 |  | } |
  | 556 |  | if( $state && isset( $states[$country] ) && is\_array( $states[$country] ) ) { |
  | 557 |  | $state\_name = isset($states[$country][$state]) ? $states[$country][$state] : ''; |
  | 558 |  | } |
  | 559 |  |  |
  | 560 |  | $placeholders = [ |
  | 561 |  | '{address1}'    => $addr\_1, |
  | 562 |  | '{address2}'    => $addr\_2, |
  | 563 |  | '{city}'        => $city, |
  | 564 |  | '{zip}'         => $zip, |
  | 565 |  | '{state}'       => $state\_name, |
  | 566 |  | '{country}'     => $country\_name |
  | 567 |  | ]; |
  | 568 |  |  |
  | 569 |  | $format = apply\_filters( 'wcfmmp\_store\_address\_string\_format', "{address1}, {address2}, {city}, {state}, {country} - {zip}" ); |
  | 570 |  |  |
  | 571 |  | $store\_address = str\_replace( array\_keys( $placeholders ), array\_values( $placeholders ), $format ); |
  | 572 |  |  |
  | 573 |  | $store\_address = str\_replace( '"', '&quot;', $store\_address ); |
  | 574 |  |  |
  |  | 537 | add\_filter( 'woocommerce\_formatted\_address\_force\_country\_display', '\_\_return\_true' ); |
  |  | 538 |  |
  |  | 539 | $store\_address = WC()->countries->get\_formatted\_address([ |
  |  | 540 | 'address\_1'  => $vendor\_data['address']['street\_1'], |
  |  | 541 | 'address\_2'  => $vendor\_data['address']['street\_2'], |
  |  | 542 | 'city'       => $vendor\_data['address']['city'], |
  |  | 543 | 'state'      => $vendor\_data['address']['state'], |
  |  | 544 | 'postcode'   => $vendor\_data['address']['zip'], |
  |  | 545 | 'country'    => $vendor\_data['address']['country'], |
  |  | 546 | ], ', '); |
  |  | 547 |  |
  | 575 | 548 | return apply\_filters( 'wcfmmp\_store\_address\_string', $store\_address, $vendor\_data ); |
  | 576 |  |  |
  | 577 | 549 | } |
  | 578 | 550 |  |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php")

  | [r2757979](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php?rev=2757979#L66 "Show revision 2757979 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php?rev=3000763#L66 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 66 | 66 | global $WCFM, $WCFMmp, $wpdb; |
  | 67 | 67 |  |
  |  | 68 | $order = wc\_get\_order( $order\_id ); |
  |  | 69 |  |
  | 68 | 70 | // Store New Order Email to Vendors |
  | 69 |  | $wcfmmp\_order\_email\_triggered = ~~get\_post\_meta( $order\_id, '\_wcfmmp\_order\_email\_triggered', true~~ ); |
  |  | 71 | $wcfmmp\_order\_email\_triggered = $order->get\_meta('\_wcfmmp\_order\_email\_triggered'); |
  | 70 | 72 | if( !$wcfmmp\_order\_email\_triggered ) { |
  | 71 | 73 | $store\_new\_order\_email\_allowed\_order\_status = get\_wcfm\_store\_new\_order\_email\_allowed\_order\_status(); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php?rev=2757979#L75) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp-withdraw.php?rev=3000763#L77) |  |
  | 75 | 77 | if( $wcfmmp\_email ) { |
  | 76 | 78 | $wcfmmp\_email->trigger( $order\_id ); |
  | 77 |  | update\_post\_meta( $order\_id, '\_wcfmmp\_order\_email\_triggered', 'yes' ); |
  |  | 79 | $order->update\_meta\_data( '\_wcfmmp\_order\_email\_triggered', 'yes' ); |
  |  | 80 | $order->save(); |
  | 78 | 81 | } |
  | 79 | 82 | } |
* ## [wc-multivendor-marketplace/trunk/core/class-wcfmmp.php](/changeset/3000763/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/core/class-wcfmmp.php")

  | [r2757979](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L10 "Show revision 2757979 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L10 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \* @version   1.0.0 |
  | 11 | 11 | \*/ |
  |  | 12 |  |
  |  | 13 | use Automattic\WooCommerce\Utilities\OrderUtil; |
  | 12 | 14 |  |
  | 13 | 15 | class WCFMmp { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L41) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L43) |  |
  | 41 | 43 | public $wcfmmp\_emails; |
  | 42 | 44 | public $wcfmmp\_shipping; |
  | 43 |  | public $wcfmmp\_shipping\_gateways; |
  | 44 |  | public $wcfmmp\_shipping\_zone; |
  |  | 45 | public $wcfmmp\_shipping\_gateways; |
  |  | 46 | public $wcfmmp\_shipping\_zone; |
  | 45 | 47 | public $wcfmmp\_gateways; |
  | 46 | 48 | public $wcfmmp\_abstract\_gateway; |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L69) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L71) |  |
  | 69 | 71 |  |
  | 70 | 72 | $this->file = $file; |
  | 71 |  | $this->plugin\_base\_name = plugin\_basename(~~$file~~ ); |
  |  | 73 | $this->plugin\_base\_name = plugin\_basename($file); |
  | 72 | 74 | $this->plugin\_url = trailingslashit(plugins\_url('', $plugin = $file)); |
  | 73 | 75 | $this->plugin\_path = trailingslashit(dirname($file)); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L75) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L77) |  |
  | 75 | 77 | $this->text\_domain = WCFMmp\_TEXT\_DOMAIN; |
  | 76 | 78 | $this->version = WCFMmp\_VERSION; |
  | 77 |  |  |
  |  | 79 |  |
  | 78 | 80 | // Installer Hook |
  | 79 |  | add\_action(~~'init', array( &$this, 'run\_wcfmmp\_installer' )~~ ); |
  | 80 |  |  |
  | 81 |  | add\_action(~~'init', array( &$this, 'init' ), 8~~ ); |
  | 82 |  |  |
  | 83 |  | add\_action(~~'wcfm\_init', array( &$this, 'init\_wcfmmp' ), 11~~ ); |
  | 84 |  |  |
  | 85 |  | add\_action(~~'woocommerce\_loaded', array( $this, 'load\_wcfmmp' )~~ ); |
  | 86 |  |  |
  | 87 |  | add\_filter(~~'wcfm\_modules',  array( &$this, 'get\_wcfmmp\_modules' )~~ ); |
  | 88 |  |  |
  |  | 81 | add\_action('init', array(&$this, 'run\_wcfmmp\_installer')); |
  |  | 82 |  |
  |  | 83 | add\_action('init', array(&$this, 'init'), 8); |
  |  | 84 |  |
  |  | 85 | add\_action('wcfm\_init', array(&$this, 'init\_wcfmmp'), 11); |
  |  | 86 |  |
  |  | 87 | add\_action('woocommerce\_loaded', array($this, 'load\_wcfmmp')); |
  |  | 88 |  |
  |  | 89 | add\_filter('wcfm\_modules',  array(&$this, 'get\_wcfmmp\_modules')); |
  |  | 90 |  |
  | 89 | 91 | // Generating Marketplace Order for Subscription Renewal Order |
  | 90 |  | add\_filter(~~'wcs\_renewal\_order\_created', array(&$this, 'wcfmmp\_renewal\_order\_processed'), 20, 2~~ ); |
  | 91 |  |  |
  |  | 92 | add\_filter('wcs\_renewal\_order\_created', array(&$this, 'wcfmmp\_renewal\_order\_processed'), 20, 2); |
  |  | 93 |  |
  | 92 | 94 | // Periodic Withdrawal Scheduler Check |
  | 93 |  | add\_action(~~'wcfmmp\_withdrawal\_periodic\_scheduler', array( &$this, 'wcfmmp\_withdrawal\_periodic\_scheduler\_check' )~~ ); |
  | 94 |  |  |
  |  | 95 | add\_action('wcfmmp\_withdrawal\_periodic\_scheduler', array(&$this, 'wcfmmp\_withdrawal\_periodic\_scheduler\_check')); |
  |  | 96 |  |
  | 95 | 97 | // Periodic Data Cleanup Scheduler Check |
  | 96 |  | add\_action(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler', array( &$this, 'wcfmmp\_data\_cleanup\_periodic\_scheduler\_check' )~~ ); |
  | 97 |  | } |
  | 98 |  |  |
  |  | 98 | add\_action('wcfmmp\_data\_cleanup\_periodic\_scheduler', array(&$this, 'wcfmmp\_data\_cleanup\_periodic\_scheduler\_check')); |
  |  | 99 | } |
  |  | 100 |  |
  | 99 | 101 | /\*\* |
  | 100 | 102 | \* Initilize plugin on WP init |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L102) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L104) |  |
  | 102 | 104 | function init() { |
  | 103 | 105 | global $WCFM, $WCFMmp; |
  | 104 |  |  |
  |  | 106 |  |
  | 105 | 107 | // Init Text Domain |
  | 106 | 108 | $this->load\_plugin\_textdomain(); |
  | 107 |  |  |
  | 108 |  |  |
  | 109 |  | $this->vendor\_id = apply\_filters(~~'wcfm\_current\_vendor\_id', get\_current\_user\_id()~~ ); |
  | 110 |  |  |
  | 111 |  | if~~( function\_exists( 'wcfm\_get\_option' )~~ ) { |
  | 112 |  | $this->wcfm\_store\_url               = wcfm\_get\_option(~~'wcfm\_store\_url', 'store'~~ ); |
  | 113 |  | $this->wcfmmp\_marketplace\_options   = wcfm\_get\_option(~~'wcfm\_marketplace\_options', array()~~ ); |
  | 114 |  | $this->wcfmmp\_store\_endpoints       = wcfm\_get\_option(~~'wcfm\_store\_endpoints', array()~~ ); |
  |  | 109 |  |
  |  | 110 |  |
  |  | 111 | $this->vendor\_id = apply\_filters('wcfm\_current\_vendor\_id', get\_current\_user\_id()); |
  |  | 112 |  |
  |  | 113 | if (function\_exists('wcfm\_get\_option')) { |
  |  | 114 | $this->wcfm\_store\_url               = wcfm\_get\_option('wcfm\_store\_url', 'store'); |
  |  | 115 | $this->wcfmmp\_marketplace\_options   = wcfm\_get\_option('wcfm\_marketplace\_options', array()); |
  |  | 116 | $this->wcfmmp\_store\_endpoints       = wcfm\_get\_option('wcfm\_store\_endpoints', array()); |
  | 115 | 117 | } else { |
  | 116 |  | $this->wcfm\_store\_url               = get\_option(~~'wcfm\_store\_url', 'store'~~ ); |
  | 117 |  | $this->wcfmmp\_marketplace\_options   = get\_option(~~'wcfm\_marketplace\_options', array()~~ ); |
  | 118 |  | $this->wcfmmp\_store\_endpoints       = get\_option(~~'wcfm\_store\_endpoints', array()~~ ); |
  | 119 |  | } |
  | 120 |  | $this->wcfmmp\_commission\_options    = get\_option(~~'wcfm\_commission\_options', array()~~ ); |
  | 121 |  | $this->wcfmmp\_withdrawal\_options    = get\_option(~~'wcfm\_withdrawal\_options', array()~~ ); |
  | 122 |  | $this->wcfmmp\_review\_options        = get\_option(~~'wcfm\_review\_options', array()~~ ); |
  | 123 |  | $this->wcfmmp\_refund\_options        = get\_option(~~'wcfm\_refund\_options', array()~~ ); |
  | 124 |  | $this->wcfmmp\_notification\_options  = get\_option(~~'wcfmmp\_notification\_options', array()~~ ); |
  | 125 |  |  |
  |  | 118 | $this->wcfm\_store\_url               = get\_option('wcfm\_store\_url', 'store'); |
  |  | 119 | $this->wcfmmp\_marketplace\_options   = get\_option('wcfm\_marketplace\_options', array()); |
  |  | 120 | $this->wcfmmp\_store\_endpoints       = get\_option('wcfm\_store\_endpoints', array()); |
  |  | 121 | } |
  |  | 122 | $this->wcfmmp\_commission\_options    = get\_option('wcfm\_commission\_options', array()); |
  |  | 123 | $this->wcfmmp\_withdrawal\_options    = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 124 | $this->wcfmmp\_review\_options        = get\_option('wcfm\_review\_options', array()); |
  |  | 125 | $this->wcfmmp\_refund\_options        = get\_option('wcfm\_refund\_options', array()); |
  |  | 126 | $this->wcfmmp\_notification\_options  = get\_option('wcfmmp\_notification\_options', array()); |
  |  | 127 |  |
  | 126 | 128 | // Load WCFM Marketplace setup class |
  | 127 | 129 | // http://localhost/wwd/wp-admin/?page=wcfmmp-setup&step=dashboard |
  | 128 |  | if (~~is\_admin()~~ ) { |
  | 129 |  | $current\_page = filter\_input(~~INPUT\_GET, 'page'~~ ); |
  | 130 |  | if (~~$current\_page && $current\_page == 'wcfmmp-setup'~~ ) { |
  |  | 130 | if (is\_admin()) { |
  |  | 131 | $current\_page = filter\_input(INPUT\_GET, 'page'); |
  |  | 132 | if ($current\_page && $current\_page == 'wcfmmp-setup') { |
  | 131 | 133 | require\_once $this->plugin\_path . 'helpers/class-wcfmmp-setup.php'; |
  | 132 | 134 | } |
  | 133 | 135 | } |
  | 134 |  |  |
  | 135 |  | if~~( function\_exists( 'wcfm\_is\_vendor' ) && wcfm\_is\_vendor()~~ ) { |
  | 136 |  | $current\_page = filter\_input(~~INPUT\_GET, 'store-setup'~~ ); |
  | 137 |  | if (~~$current\_page~~ ) { |
  |  | 136 |  |
  |  | 137 | if (function\_exists('wcfm\_is\_vendor') && wcfm\_is\_vendor()) { |
  |  | 138 | $current\_page = filter\_input(INPUT\_GET, 'store-setup'); |
  |  | 139 | if ($current\_page) { |
  | 138 | 140 | require\_once $this->plugin\_path . 'helpers/class-wcfmmp-store-setup.php'; |
  | 139 | 141 | } |
  | 140 | 142 | } |
  | 141 |  |  |
  |  | 143 |  |
  | 142 | 144 | // Init Admin class |
  | 143 |  | if (~~is\_admin()~~ ) { |
  | 144 |  | $this->load\_class(~~'admin'~~ ); |
  |  | 145 | if (is\_admin()) { |
  |  | 146 | $this->load\_class('admin'); |
  | 145 | 147 | $this->admin = new WCFMmp\_Admin(); |
  | 146 | 148 | } |
  | 147 |  |  |
  |  | 149 |  |
  | 148 | 150 | // Rewrite rules loader |
  | 149 |  | if~~( !class\_exists( 'WCFMmp\_Rewrites' )~~ ) { |
  | 150 |  | $this->load\_class(~~'rewrite'~~ ); |
  |  | 151 | if (!class\_exists('WCFMmp\_Rewrites')) { |
  |  | 152 | $this->load\_class('rewrite'); |
  | 151 | 153 | $this->wcfmmp\_rewrite = new WCFMmp\_Rewrites(); |
  | 152 | 154 | } |
  | 153 |  |  |
  |  | 155 |  |
  | 154 | 156 | // Marketplace Abstract Gateway Load |
  | 155 | 157 | $this->load\_class('abstract-gateway'); |
  | 156 | 158 | } |
  | 157 |  |  |
  |  | 159 |  |
  | 158 | 160 | /\*\* |
  | 159 | 161 | \* Load WCFMmp |
  | 160 | 162 | \*/ |
  | 161 | 163 | function load\_wcfmmp() { |
  | 162 |  |  |
  | 163 |  | if(WCFMmp\_Dependencies::woocommerce\_plugin\_active\_check() && WCFMmp\_Dependencies::wcfm\_plugin\_active\_check()) { |
  |  | 164 |  |
  |  | 165 | if (WCFMmp\_Dependencies::woocommerce\_plugin\_active\_check() && WCFMmp\_Dependencies::wcfm\_plugin\_active\_check()) { |
  | 164 | 166 | // Sidebar and Widgets loader |
  | 165 |  | $this->load\_class(~~'sidebar-widgets'~~ ); |
  |  | 167 | $this->load\_class('sidebar-widgets'); |
  | 166 | 168 | $this->wcfmmp\_sidebar\_widgets = new WCFMmp\_Sidebar\_Widgets(); |
  | 167 |  |  |
  |  | 169 |  |
  | 168 | 170 | // Marketplace Shipping Load |
  | 169 | 171 | $this->load\_class('shipping'); |
  | 170 | 172 | $this->wcfmmp\_shipping = new WCFMmp\_Shipping(); |
  | 171 |  |  |
  |  | 173 |  |
  | 172 | 174 | // Marketplace Shipping Gateway Load |
  | 173 | 175 | $this->load\_class('shipping-gateway'); |
  | 174 | 176 | $this->wcfmmp\_shipping\_gateways = new WCFMmp\_Shipping\_Gateway(); |
  | 175 |  |  |
  |  | 177 |  |
  | 176 | 178 | // Marketplace Shipping Zone Load |
  | 177 |  | $this->load\_class(~~'shipping-zone'~~ ); |
  |  | 179 | $this->load\_class('shipping-zone'); |
  | 178 | 180 | $this->wcfmmp\_shipping\_zone = new WCFMmp\_Shipping\_Zone(); |
  | 179 |  |  |
  |  | 181 |  |
  | 180 | 182 | // Marketplace Emails Load |
  | 181 | 183 | $this->load\_class('emails'); |
  | 182 | 184 | $this->wcfmmp\_emails = new WCFMmp\_Emails(); |
  | 183 |  |  |
  |  | 185 |  |
  | 184 | 186 | // Marketplace Store SEO Load |
  | 185 | 187 | $this->load\_class('store-seo'); |
  | 186 | 188 | $this->wcfmmp\_store\_seo = new WCFMmp\_Store\_SEO(); |
  | 187 | 189 | } |
  | 188 |  |  |
  | 189 |  | do\_action(~~'wcfmmp\_loaded'~~ ); |
  | 190 |  | } |
  | 191 |  |  |
  |  | 190 |  |
  |  | 191 | do\_action('wcfmmp\_loaded'); |
  |  | 192 | } |
  |  | 193 |  |
  | 192 | 194 | /\*\* |
  | 193 | 195 | \* Initilize plugin on WCFM init |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L195) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L197) |  |
  | 195 | 197 | function init\_wcfmmp() { |
  | 196 | 198 | global $WCFM, $WCFMmp; |
  | 197 |  |  |
  | 198 |  | if(!WCFMmp\_Dependencies::woocommerce\_plugin\_active\_check()) { |
  | 199 |  | add\_action(~~'admin\_notices', 'wcfmmp\_woocommerce\_inactive\_notice'~~ ); |
  |  | 199 |  |
  |  | 200 | if (!WCFMmp\_Dependencies::woocommerce\_plugin\_active\_check()) { |
  |  | 201 | add\_action('admin\_notices', 'wcfmmp\_woocommerce\_inactive\_notice'); |
  | 200 | 202 | return; |
  | 201 |  | } |
  | 202 |  |  |
  | 203 |  | if(!WCFMmp\_Dependencies::wcfm\_plugin\_active\_check()) { |
  | 204 |  | add\_action(~~'admin\_notices', 'wcfmmp\_wcfm\_inactive\_notice'~~ ); |
  |  | 203 | } |
  |  | 204 |  |
  |  | 205 | if (!WCFMmp\_Dependencies::wcfm\_plugin\_active\_check()) { |
  |  | 206 | add\_action('admin\_notices', 'wcfmmp\_wcfm\_inactive\_notice'); |
  | 205 | 207 | return; |
  | 206 | 208 | } |
  | 207 |  |  |
  |  | 209 |  |
  | 208 | 210 | // Init library |
  | 209 | 211 | $this->load\_class('library'); |
  | 210 | 212 | $this->library = new WCFMmp\_Library(); |
  | 211 |  |  |
  |  | 213 |  |
  | 212 | 214 | // Init ajax |
  | 213 |  | if~~( defined('DOING\_AJAX') || defined('WCFM\_REST\_API\_CALL')~~ ) { |
  |  | 215 | if (defined('DOING\_AJAX') || defined('WCFM\_REST\_API\_CALL')) { |
  | 214 | 216 | $this->load\_class('ajax'); |
  | 215 | 217 | $this->ajax = new WCFMmp\_Ajax(); |
  | 216 | 218 | } |
  | 217 |  |  |
  |  | 219 |  |
  | 218 | 220 | // Marketplace Setting Load |
  | 219 | 221 | if (!is\_admin() || defined('DOING\_AJAX')) { |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L221) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L223) |  |
  | 221 | 223 | $this->wcfmmp\_settings = new WCFMmp\_Settings(); |
  | 222 | 224 | } |
  | 223 |  |  |
  | 224 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_notification', true )~~ ) { |
  |  | 225 |  |
  |  | 226 | if (apply\_filters('wcfm\_is\_pref\_notification', true)) { |
  | 225 | 227 | $this->load\_class('notification-manager'); |
  | 226 | 228 | $this->wcfmmp\_notification\_manager = new WCFMmp\_Notification\_Manager(); |
  | 227 | 229 | } |
  | 228 |  |  |
  |  | 230 |  |
  | 229 | 231 | // Marketplace Commission Load |
  | 230 | 232 | $this->load\_class('commission'); |
  | 231 | 233 | $this->wcfmmp\_commission = new WCFMmp\_Commission(); |
  | 232 |  |  |
  | 233 |  |  |
  |  | 234 |  |
  |  | 235 |  |
  | 234 | 236 | // Marketplace Withdrawal Load |
  | 235 | 237 | $this->load\_class('withdraw'); |
  | 236 | 238 | $this->wcfmmp\_withdraw = new WCFMmp\_Withdraw(); |
  | 237 |  |  |
  |  | 239 |  |
  | 238 | 240 | // Marketplace Refund module Load |
  | 239 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_refund', true )~~ ) { |
  |  | 241 | if (apply\_filters('wcfm\_is\_pref\_refund', true)) { |
  | 240 | 242 | $this->load\_class('refund'); |
  | 241 | 243 | $this->wcfmmp\_refund = new WCFMmp\_Refund(); |
  | 242 | 244 | } |
  | 243 |  |  |
  |  | 245 |  |
  | 244 | 246 | // Marketplace Reviews module Load |
  | 245 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_vendor\_reviews', true )~~ ) { |
  | 246 |  | $this->load\_class(~~'reviews'~~ ); |
  |  | 247 | if (apply\_filters('wcfm\_is\_pref\_vendor\_reviews', true)) { |
  |  | 248 | $this->load\_class('reviews'); |
  | 247 | 249 | $this->wcfmmp\_reviews = new WCFMmp\_Reviews(); |
  | 248 | 250 | } |
  | 249 |  |  |
  |  | 251 |  |
  | 250 | 252 | // Marketplace Vendor Load |
  | 251 | 253 | $this->load\_class('vendor'); |
  | 252 | 254 | $this->wcfmmp\_vendor = new WCFMmp\_Vendor(); |
  | 253 |  |  |
  |  | 255 |  |
  | 254 | 256 | // Marketplace Store Load |
  | 255 | 257 | $this->load\_class('store'); |
  | 256 | 258 | $this->wcfmmp\_store = new WCFMmp\_Store(); |
  | 257 |  |  |
  |  | 259 |  |
  | 258 | 260 | // Marketplace Store SEO Load |
  | 259 | 261 | //$this->load\_class('store-seo'); |
  | 260 | 262 | //$this->wcfmmp\_store\_seo = new WCFMmp\_Store\_SEO(); |
  | 261 |  |  |
  |  | 263 |  |
  | 262 | 264 | // Marketplace Product Load |
  | 263 | 265 | $this->load\_class('product'); |
  | 264 | 266 | $this->wcfmmp\_product = new WCFMmp\_Product(); |
  | 265 |  |  |
  |  | 267 |  |
  | 266 | 268 | // Marketplace Single Product Multiple Vendor |
  | 267 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_product\_multivendor', true )~~ ) { |
  |  | 269 | if (apply\_filters('wcfm\_is\_pref\_product\_multivendor', true)) { |
  | 268 | 270 | $this->load\_class('product-multivendor'); |
  | 269 | 271 | $this->wcfmmp\_product\_multivendor = new WCFMmp\_Product\_Multivendor(); |
  | 270 | 272 | } |
  | 271 |  |  |
  |  | 273 |  |
  | 272 | 274 | // Marketplace Ledger Load |
  | 273 | 275 | $this->load\_class('ledger'); |
  | 274 | 276 | $this->wcfmmp\_ledger = new WCFMmp\_Ledger(); |
  | 275 |  |  |
  |  | 277 |  |
  | 276 | 278 | // Marketplace Store Hours Load |
  | 277 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_store\_hours', true )~~ ) { |
  |  | 279 | if (apply\_filters('wcfm\_is\_pref\_store\_hours', true)) { |
  | 278 | 280 | if (!is\_admin() || defined('DOING\_AJAX')) { |
  | 279 | 281 | $this->load\_class('store-hours'); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L281) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L283) |  |
  | 281 | 283 | } |
  | 282 | 284 | } |
  | 283 |  |  |
  |  | 285 |  |
  | 284 | 286 | // Load Frontend |
  | 285 |  | if (~~!is\_admin() || defined('DOING\_AJAX')~~ ) { |
  |  | 287 | if (!is\_admin() || defined('DOING\_AJAX')) { |
  | 286 | 288 | $this->load\_class('frontend'); |
  | 287 | 289 | $this->frontend = new WCFMmp\_Frontend(); |
  | 288 | 290 | } |
  | 289 |  |  |
  |  | 291 |  |
  | 290 | 292 | // Load Non-ajax |
  | 291 |  | if~~( !defined('DOING\_AJAX')~~ ) { |
  | 292 |  | $this->load\_class(~~'non-ajax'~~ ); |
  |  | 293 | if (!defined('DOING\_AJAX')) { |
  |  | 294 | $this->load\_class('non-ajax'); |
  | 293 | 295 | $this->wcfmmp\_non\_ajax = new WCFMmp\_Non\_Ajax(); |
  | 294 | 296 | } |
  | 295 |  |  |
  | 296 |  |  |
  |  | 297 |  |
  |  | 298 |  |
  | 297 | 299 | // Load Media Manager |
  | 298 |  | if~~( apply\_filters( 'wcfm\_is\_pref\_media\_manager', true )~~ ) { |
  |  | 300 | if (apply\_filters('wcfm\_is\_pref\_media\_manager', true)) { |
  | 299 | 301 | if (!is\_admin() || defined('DOING\_AJAX')) { |
  | 300 | 302 | $this->load\_class('media'); |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L302) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L304) |  |
  | 302 | 304 | } |
  | 303 | 305 | } |
  | 304 |  |  |
  |  | 306 |  |
  | 305 | 307 | // Template loader |
  | 306 |  | $this->load\_class(~~'template'~~ ); |
  |  | 308 | $this->load\_class('template'); |
  | 307 | 309 | $this->template = new WCFMmp\_Template(); |
  | 308 |  |  |
  |  | 310 |  |
  | 309 | 311 | // Short codes loader |
  | 310 | 312 | //if ( !is\_admin() ) { |
  | 311 |  | ~~$this->load\_class( 'shortcode'~~ ); |
  | 312 |  | $this->wcfmmp\_shortcodes = new WCFMmp\_Shortcode(); |
  |  | 313 | $this->load\_class('shortcode'); |
  |  | 314 | $this->wcfmmp\_shortcodes = new WCFMmp\_Shortcode(); |
  | 313 | 315 | //} |
  | 314 |  |  |
  |  | 316 |  |
  | 315 | 317 | // Marketplace Gateways Load |
  | 316 | 318 | $this->load\_class('gateways'); |
  | 317 | 319 | $this->wcfmmp\_gateways = new WCFMmp\_Gateways(); |
  | 318 |  |  |
  |  | 320 |  |
  | 319 | 321 | //$this->wcfmmp\_fields = $WCFM->wcfm\_fields; |
  | 320 | 322 | } |
  | 321 |  |  |
  |  | 323 |  |
  | 322 | 324 | /\*\* |
  | 323 | 325 | \* Load Localisation files. |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L329) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L331) |  |
  | 329 | 331 | \*/ |
  | 330 | 332 | public function load\_plugin\_textdomain() { |
  | 331 |  | $locale = function\_exists(~~'get\_user\_locale'~~ ) ? get\_user\_locale() : get\_locale(); |
  | 332 |  | $locale = apply\_filters(~~'plugin\_locale', $locale, 'wc-multivendor-marketplace'~~ ); |
  |  | 333 | $locale = function\_exists('get\_user\_locale') ? get\_user\_locale() : get\_locale(); |
  |  | 334 | $locale = apply\_filters('plugin\_locale', $locale, 'wc-multivendor-marketplace'); |
  | 333 | 335 |  |
  | 334 | 336 | //load\_textdomain( 'wc-multivendor-marketplace', WP\_LANG\_DIR . "/wc-multivendor-marketplace/wc-multivendor-marketplace-$locale.mo"); |
  | 335 |  | load\_textdomain('wc-multivendor-marketplace', $this->plugin\_path . "lang/wc-multivendor-marketplace-$locale.mo"); |
  | 336 |  | load\_textdomain('wc-multivendor-marketplace', WP\_LANG\_DIR . "/plugins/wc-multivendor-marketplace-$locale.mo"); |
  | 337 |  | } |
  | 338 |  |  |
  |  | 337 | load\_textdomain('wc-multivendor-marketplace', $this->plugin\_path . "lang/wc-multivendor-marketplace-$locale.mo"); |
  |  | 338 | load\_textdomain('wc-multivendor-marketplace', WP\_LANG\_DIR . "/plugins/wc-multivendor-marketplace-$locale.mo"); |
  |  | 339 | } |
  |  | 340 |  |
  | 339 | 341 | /\*\* |
  | 340 | 342 | \* List of WCFM Marketplace modules |
  | 341 | 343 | \*/ |
  | 342 |  | function get\_wcfmmp\_modules( $wcfm\_modules ) { |
  | 343 |  |  |
  | 344 |  | $wcfmmp\_module\_index = array\_search( 'refund', array\_keys( $wcfm\_modules ) ); |
  | 345 |  | if( !$wcfmmp\_module\_index ) { $wcfmmp\_module\_index = 4; } else { $wcfmmp\_module\_index += 1; } |
  | 346 |  |  |
  |  | 344 | function get\_wcfmmp\_modules($wcfm\_modules) { |
  |  | 345 |  |
  |  | 346 | $wcfmmp\_module\_index = array\_search('refund', array\_keys($wcfm\_modules)); |
  |  | 347 | if (!$wcfmmp\_module\_index) { |
  |  | 348 | $wcfmmp\_module\_index = 4; |
  |  | 349 | } else { |
  |  | 350 | $wcfmmp\_module\_index += 1; |
  |  | 351 | } |
  |  | 352 |  |
  | 347 | 353 | $wcfmmp\_modules = array( |
  | 348 |  | ~~'reviews'               => array( 'label' => \_\_( 'Reviews', 'wc-multivendor-marketplace' )~~ ), |
  | 349 |  | ~~'store\_hours'           => array( 'label' => \_\_( 'Store Hours', 'wc-multivendor-marketplace' )~~ ), |
  | 350 |  | ~~'media'                   => array( 'label' => \_\_( 'Media', 'wc-multivendor-marketplace' )~~ ), |
  | 351 |  | ~~'ledger\_book'           => array( 'label' => \_\_( 'Vendor Ledger', 'wc-multivendor-marketplace' )~~ ), |
  | 352 |  | ~~'product\_mulivendor'    => array( 'label' => \_\_( 'Product Multivendor', 'wc-multivendor-marketplace' ), 'hints' => \_\_( "Keep this enable to allow vendors to sell other vendors' products, single product multiple seller.", 'wc-multivendor-marketplace' )~~ ), |
  | 353 |  | ~~'sell\_items\_catalog'    => array( 'label' => \_\_( 'Add to My Store Catalog', 'wc-multivendor-marketplace' ), 'hints' => \_\_( "Other vendors' products catalog, vendors will able to add those directly to their store.", 'wc-multivendor-marketplace' )~~ ), |
  | 354 |  | ); |
  | 355 |  |  |
  |  | 354 | 'reviews'               => array('label' => \_\_('Reviews', 'wc-multivendor-marketplace')), |
  |  | 355 | 'store\_hours'           => array('label' => \_\_('Store Hours', 'wc-multivendor-marketplace')), |
  |  | 356 | 'media'                   => array('label' => \_\_('Media', 'wc-multivendor-marketplace')), |
  |  | 357 | 'ledger\_book'           => array('label' => \_\_('Vendor Ledger', 'wc-multivendor-marketplace')), |
  |  | 358 | 'product\_mulivendor'    => array('label' => \_\_('Product Multivendor', 'wc-multivendor-marketplace'), 'hints' => \_\_("Keep this enable to allow vendors to sell other vendors' products, single product multiple seller.", 'wc-multivendor-marketplace')), |
  |  | 359 | 'sell\_items\_catalog'    => array('label' => \_\_('Add to My Store Catalog', 'wc-multivendor-marketplace'), 'hints' => \_\_("Other vendors' products catalog, vendors will able to add those directly to their store.", 'wc-multivendor-marketplace')), |
  |  | 360 | ); |
  |  | 361 |  |
  | 356 | 362 | $wcfm\_modules = array\_slice($wcfm\_modules, 0, $wcfmmp\_module\_index, true) + |
  | 357 |  | $wcfmmp\_modules + |
  | 358 |  | ~~array\_slice($wcfm\_modules, $wcfmmp\_module\_index, count($wcfm\_modules) - 1, true)~~ ; |
  | 359 |  |  |
  |  | 363 | $wcfmmp\_modules + |
  |  | 364 | array\_slice($wcfm\_modules, $wcfmmp\_module\_index, count($wcfm\_modules) - 1, true); |
  |  | 365 |  |
  | 360 | 366 | return $wcfm\_modules; |
  | 361 | 367 | } |
  | 362 |  |  |
  |  | 368 |  |
  | 363 | 369 | /\*\* |
  | 364 | 370 | \* Marketplace Order for WC Subscription Renewal Order |
  | 365 | 371 | \*/ |
  | 366 |  | function wcfmmp\_renewal\_order\_processed(~~$renewal\_order, $subscription~~ ) { |
  |  | 372 | function wcfmmp\_renewal\_order\_processed($renewal\_order, $subscription) { |
  | 367 | 373 | global $WCFM, $WCFMmp, $wpdb; |
  | 368 |  | wcfm\_log(~~"RENEWAL ORDER CORE ::" . $renewal\_order->get\_id()~~ ); |
  | 369 |  | if~~( $renewal\_order~~ ) { |
  |  | 374 | wcfm\_log("RENEWAL ORDER CORE ::" . $renewal\_order->get\_id()); |
  |  | 375 | if ($renewal\_order) { |
  | 370 | 376 | $order\_id = $renewal\_order->get\_id(); |
  | 371 |  | $order\_posted = get\_post( $order\_id ); |
  | 372 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 373 |  | $WCFMmp->wcfmmp\_commission->wcfmmp\_checkout\_order\_processed( $order\_id, $order\_posted, $renewal\_order ); |
  | 374 |  | $WCFM->wcfm\_notification->wcfm\_message\_on\_new\_order( $order\_id, true ); |
  | 375 |  | } |
  | 376 |  |  |
  |  | 377 | $order = wc\_get\_order($order\_id); |
  |  | 378 | $order\_posted = (class\_exists('Automattic\WooCommerce\Utilities\OrderUtil') && OrderUtil::custom\_orders\_table\_usage\_is\_enabled()) ? $order : get\_post($order\_id); |
  |  | 379 | $order->delete\_meta\_data('\_wcfmmp\_order\_processed'); |
  |  | 380 | $order->save(); |
  |  | 381 | $WCFMmp->wcfmmp\_commission->wcfmmp\_checkout\_order\_processed($order\_id, $order\_posted, $renewal\_order); |
  |  | 382 | $WCFM->wcfm\_notification->wcfm\_message\_on\_new\_order($order\_id, true); |
  |  | 383 | } |
  |  | 384 |  |
  | 377 | 385 | return $renewal\_order; |
  | 378 | 386 | } |
  | 379 |  |  |
  |  | 387 |  |
  | 380 | 388 | /\*\* |
  | 381 | 389 | \* Periodic Withdrwal Scheduler Check |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L383) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L391) |  |
  | 383 | 391 | function wcfmmp\_withdrawal\_periodic\_scheduler\_check() { |
  | 384 | 392 | global $WCFM, $WCFMmp, $wpdb; |
  | 385 |  |  |
  | 386 |  | $wcfm\_withdrawal\_options = get\_option(~~'wcfm\_withdrawal\_options', array()~~ ); |
  | 387 |  |  |
  | 388 |  | $withdrawal\_mode         = isset(~~$wcfm\_withdrawal\_options['withdrawal\_mode']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  | 389 |  | $withdrawal\_schedule     = isset(~~$wcfm\_withdrawal\_options['withdrawal\_schedule']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  | 390 |  |  |
  | 391 |  | $withdrawal\_limit        = isset(~~$wcfm\_withdrawal\_options['withdrawal\_limit']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_limit'] : ''; |
  | 392 |  | $withdrawal\_thresold     = isset(~~$wcfm\_withdrawal\_options['withdrawal\_thresold']~~ ) ? $wcfm\_withdrawal\_options['withdrawal\_thresold'] : ''; |
  | 393 |  |  |
  | 394 |  |  |
  | 395 |  | if~~( $withdrawal\_mode && ( $withdrawal\_mode == 'by\_schedule' )~~ ) { |
  | 396 |  | wcfm\_withdrawal\_log(~~"PERIODIC WITHDRAWAL SCHEDULER START :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format(), current\_time( 'timestamp', 0 ) )~~ ); // Start Log |
  | 397 |  |  |
  |  | 393 |  |
  |  | 394 | $wcfm\_withdrawal\_options = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 395 |  |
  |  | 396 | $withdrawal\_mode         = isset($wcfm\_withdrawal\_options['withdrawal\_mode']) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  |  | 397 | $withdrawal\_schedule     = isset($wcfm\_withdrawal\_options['withdrawal\_schedule']) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  |  | 398 |  |
  |  | 399 | $withdrawal\_limit        = isset($wcfm\_withdrawal\_options['withdrawal\_limit']) ? $wcfm\_withdrawal\_options['withdrawal\_limit'] : ''; |
  |  | 400 | $withdrawal\_thresold     = isset($wcfm\_withdrawal\_options['withdrawal\_thresold']) ? $wcfm\_withdrawal\_options['withdrawal\_thresold'] : ''; |
  |  | 401 |  |
  |  | 402 |  |
  |  | 403 | if ($withdrawal\_mode && ($withdrawal\_mode == 'by\_schedule')) { |
  |  | 404 | wcfm\_withdrawal\_log("PERIODIC WITHDRAWAL SCHEDULER START :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), current\_time('timestamp', 0))); // Start Log |
  |  | 405 |  |
  | 398 | 406 | $args = array( |
  | 399 |  | ~~'role\_\_in'     => array( 'wcfm\_vendor'~~ ), |
  | 400 |  | ~~'fields'       => array( 'ID', 'display\_name'~~ ) |
  | 401 |  |  |
  | 402 |  | ~~);~~ |
  | 403 |  | $vendors = get\_users(~~$args~~ ); |
  | 404 |  | if~~( !empty( $vendors )~~ ) { |
  | 405 |  | foreach (~~$vendors as $vendor~~ ) { |
  | 406 |  | $disable\_vendor = get\_user\_meta(~~$vendor->ID, '\_disable\_vendor', true~~ ); |
  | 407 |  | if~~( !$disable\_vendor~~ ) { |
  | 408 |  | $shop\_name = $WCFM->wcfm\_vendor\_support->wcfm\_get\_vendor\_store\_name\_by\_vendor(~~absint($vendor->ID)~~ ); |
  | 409 |  |  |
  | 410 |  | wcfm\_withdrawal\_log(~~"Periodic withdrawal start. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  | 411 |  |  |
  | 412 |  | $payment\_method = $WCFMmp->wcfmmp\_vendor->get\_vendor\_payment\_method(~~$vendor->ID~~ ); |
  | 413 |  | if~~( $payment\_method~~ ) { |
  | 414 |  | ~~if ( array\_key\_exists( $payment\_method, $WCFMmp->wcfmmp\_gateways->payment\_gateways )~~ ) { |
  | 415 |  | $withdrawal\_thresold = $WCFMmp->wcfmmp\_withdraw->get\_withdrawal\_thresold(~~$vendor->ID~~ ); |
  | 416 |  | $withdrawal\_limit    = $WCFMmp->wcfmmp\_withdraw->get\_withdrawal\_limit(~~$vendor->ID~~ ); |
  | 417 |  |  |
  |  | 407 | 'role\_\_in'     => array('wcfm\_vendor'), |
  |  | 408 | 'fields'       => array('ID', 'display\_name') |
  |  | 409 |  |
  |  | 410 | ); |
  |  | 411 | $vendors = get\_users($args); |
  |  | 412 | if (!empty($vendors)) { |
  |  | 413 | foreach ($vendors as $vendor) { |
  |  | 414 | $disable\_vendor = get\_user\_meta($vendor->ID, '\_disable\_vendor', true); |
  |  | 415 | if (!$disable\_vendor) { |
  |  | 416 | $shop\_name = $WCFM->wcfm\_vendor\_support->wcfm\_get\_vendor\_store\_name\_by\_vendor(absint($vendor->ID)); |
  |  | 417 |  |
  |  | 418 | wcfm\_withdrawal\_log("Periodic withdrawal start. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name); |
  |  | 419 |  |
  |  | 420 | $payment\_method = $WCFMmp->wcfmmp\_vendor->get\_vendor\_payment\_method($vendor->ID); |
  |  | 421 | if ($payment\_method) { |
  |  | 422 | if (array\_key\_exists($payment\_method, $WCFMmp->wcfmmp\_gateways->payment\_gateways)) { |
  |  | 423 | $withdrawal\_thresold = $WCFMmp->wcfmmp\_withdraw->get\_withdrawal\_thresold($vendor->ID); |
  |  | 424 | $withdrawal\_limit    = $WCFMmp->wcfmmp\_withdraw->get\_withdrawal\_limit($vendor->ID); |
  |  | 425 |  |
  | 418 | 426 | $sql  = "SELECT \* FROM {$wpdb->prefix}wcfm\_marketplace\_orders AS commission"; |
  | 419 | 427 | $sql .= " WHERE 1=1"; |
  | 420 | 428 | $sql .= " AND `vendor\_id` = %d"; |
  | 421 |  | $sql .= apply\_filters(~~'wcfm\_order\_status\_condition', '', 'commission'~~ ); |
  |  | 429 | $sql .= apply\_filters('wcfm\_order\_status\_condition', '', 'commission'); |
  | 422 | 430 | $sql .= " AND commission.withdraw\_status IN ('pending', 'cancelled')"; |
  | 423 | 431 | $sql .= " AND commission.refund\_status != 'requested'"; |
  | 424 | 432 | $sql .= ' AND `is\_withdrawable` = 1 AND `is\_auto\_withdrawal` = 0 AND `is\_refunded` = 0 AND `is\_trashed` = 0'; |
  | 425 |  | if~~( $withdrawal\_thresold~~ ) $sql .= " AND commission.created <= NOW() - INTERVAL {$withdrawal\_thresold} DAY"; |
  | 426 |  |  |
  | 427 |  | $wcfm\_commissions = $wpdb->get\_results(~~$wpdb->prepare( $sql, $vendor->ID )~~ ); |
  | 428 |  |  |
  | 429 |  | if~~( !empty( $wcfm\_commissions )~~ ) { |
  |  | 433 | if ($withdrawal\_thresold) $sql .= " AND commission.created <= NOW() - INTERVAL {$withdrawal\_thresold} DAY"; |
  |  | 434 |  |
  |  | 435 | $wcfm\_commissions = $wpdb->get\_results($wpdb->prepare($sql, $vendor->ID)); |
  |  | 436 |  |
  |  | 437 | if (!empty($wcfm\_commissions)) { |
  | 430 | 438 | $order\_ids = ''; |
  | 431 | 439 | $commission\_ids = ''; |
  | 432 | 440 | $total\_commission = 0; |
  | 433 |  | $no\_of\_commission = count(~~$wcfm\_commissions~~ ); |
  | 434 |  |  |
  | 435 |  | foreach~~( $wcfm\_commissions as $wcfm\_commission~~ ) { |
  | 436 |  | $order = wc\_get\_order(~~$wcfm\_commission->order\_id~~ ); |
  | 437 |  | if~~( !is\_a( $order , 'WC\_Order' )~~ ) continue; |
  | 438 |  |  |
  |  | 441 | $no\_of\_commission = count($wcfm\_commissions); |
  |  | 442 |  |
  |  | 443 | foreach ($wcfm\_commissions as $wcfm\_commission) { |
  |  | 444 | $order = wc\_get\_order($wcfm\_commission->order\_id); |
  |  | 445 | if (!is\_a($order, 'WC\_Order')) continue; |
  |  | 446 |  |
  | 439 | 447 | try { |
  | 440 |  | $line\_item = new WC\_Order\_Item\_Product(~~absint( $wcfm\_commission->item\_id )~~ ); |
  | 441 |  |  |
  |  | 448 | $line\_item = new WC\_Order\_Item\_Product(absint($wcfm\_commission->item\_id)); |
  |  | 449 |  |
  | 442 | 450 | // Refunded Items Skipping |
  | 443 |  | if~~( $refunded\_qty = $order->get\_qty\_refunded\_for\_item( absint( $wcfm\_commission->item\_id ) )~~ ) { |
  |  | 451 | if ($refunded\_qty = $order->get\_qty\_refunded\_for\_item(absint($wcfm\_commission->item\_id))) { |
  | 444 | 452 | $refunded\_qty = $refunded\_qty \* -1; |
  | 445 |  | if~~( $line\_item->get\_quantity() == $refunded\_qty~~ ) { |
  |  | 453 | if ($line\_item->get\_quantity() == $refunded\_qty) { |
  | 446 | 454 | continue; |
  | 447 | 455 | } |
  | 448 | 456 | } |
  | 449 |  | } catch (Exception $e) { |
  |  | 457 | } catch (Exception $e) { |
  | 450 | 458 | continue; |
  | 451 | 459 | } |
  | 452 |  |  |
  | 453 |  | if~~( $order\_ids~~ ) $order\_ids .= ','; |
  |  | 460 |  |
  |  | 461 | if ($order\_ids) $order\_ids .= ','; |
  | 454 | 462 | $order\_ids .= $wcfm\_commission->order\_id; |
  | 455 |  |  |
  | 456 |  | if~~( $commission\_ids~~ ) $commission\_ids .= ','; |
  |  | 463 |  |
  |  | 464 | if ($commission\_ids) $commission\_ids .= ','; |
  | 457 | 465 | $commission\_ids .= $wcfm\_commission->ID; |
  | 458 |  |  |
  | 459 |  | $total\_commission += wc\_format\_decimal(~~$wcfm\_commission->total\_commission~~ ); |
  |  | 466 |  |
  |  | 467 | $total\_commission += wc\_format\_decimal($wcfm\_commission->total\_commission); |
  | 460 | 468 | } |
  | 461 |  |  |
  | 462 |  | if (~~$total\_commission && ( (float) $total\_commission >= (float) $withdrawal\_limit )~~ ) { |
  | 463 |  |  |
  |  | 469 |  |
  |  | 470 | if ($total\_commission && ((float) $total\_commission >= (float) $withdrawal\_limit)) { |
  |  | 471 |  |
  | 464 | 472 | // Reset Commission withdrawal charges as per total withdrawal charge |
  | 465 |  | $withdraw\_charges = $WCFMmp->wcfmmp\_withdraw->calculate\_withdrawal\_charges(~~$total\_commission, $vendor->ID~~ ); |
  | 466 |  | if~~( $withdraw\_charges~~ ) { |
  | 467 |  | $withdraw\_charge\_per\_commission = (float)$withdraw\_charges~~/~~$no\_of\_commission; |
  | 468 |  | foreach~~( $wcfm\_commissions as $commission\_info~~ ) { |
  | 469 |  | $wpdb->update(~~"{$wpdb->prefix}wcfm\_marketplace\_orders", array( 'withdraw\_charges' => wc\_format\_decimal($withdraw\_charge\_per\_commission) ), array( 'ID' => $commission\_info->ID ), array( '%s' ), array( '%d' )~~ ); |
  |  | 473 | $withdraw\_charges = $WCFMmp->wcfmmp\_withdraw->calculate\_withdrawal\_charges($total\_commission, $vendor->ID); |
  |  | 474 | if ($withdraw\_charges) { |
  |  | 475 | $withdraw\_charge\_per\_commission = (float)$withdraw\_charges / $no\_of\_commission; |
  |  | 476 | foreach ($wcfm\_commissions as $commission\_info) { |
  |  | 477 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('withdraw\_charges' => wc\_format\_decimal($withdraw\_charge\_per\_commission)), array('ID' => $commission\_info->ID), array('%s'), array('%d')); |
  | 470 | 478 | } |
  | 471 | 479 | } |
  | 472 |  |  |
  |  | 480 |  |
  | 473 | 481 | // Generate Withdrawal Request |
  | 474 |  | $withdraw\_request\_id = $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdrawal\_processed(~~$vendor->ID, $order\_ids, $commission\_ids, $payment\_method, 0, $total\_commission, $withdraw\_charges, 'requested', 'by\_schedule'~~ ); |
  | 475 |  |  |
  | 476 |  | if~~( $withdraw\_request\_id && !is\_wp\_error( $withdraw\_request\_id )~~ ) { |
  | 477 |  |  |
  |  | 482 | $withdraw\_request\_id = $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdrawal\_processed($vendor->ID, $order\_ids, $commission\_ids, $payment\_method, 0, $total\_commission, $withdraw\_charges, 'requested', 'by\_schedule'); |
  |  | 483 |  |
  |  | 484 | if ($withdraw\_request\_id && !is\_wp\_error($withdraw\_request\_id)) { |
  |  | 485 |  |
  | 478 | 486 | // Set Vendor Order Withdrawal Status Requested |
  | 479 |  | foreach~~( $wcfm\_commissions as $commission\_info~~ ) { |
  |  | 487 | foreach ($wcfm\_commissions as $commission\_info) { |
  | 480 | 488 | $wpdb->update("{$wpdb->prefix}wcfm\_marketplace\_orders", array('withdraw\_status' => 'requested'), array('ID' => $commission\_info->ID), array('%s'), array('%d')); |
  | 481 | 489 | } |
  | 482 |  |  |
  |  | 490 |  |
  | 483 | 491 | // If Auto-approve ON, process withdrawal request |
  | 484 |  | $is\_auto\_approve = $WCFMmp->wcfmmp\_withdraw->is\_withdrawal\_auto\_approve(~~$vendor->ID~~ ); |
  | 485 |  | if~~( $is\_auto\_approve~~ ) { |
  | 486 |  | $payment\_processesing\_status = $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdrawal\_payment\_processesing(~~$withdraw\_request\_id, $vendor->ID, $payment\_method, $total\_commission, $withdraw\_charges~~ ); |
  | 487 |  | if~~( $payment\_processesing\_status~~ ) { |
  | 488 |  | wcfm\_withdrawal\_log(~~'Periodic withdrawal request successfully processed. Withdrawal ID :: ' . sprintf( '%06u', $withdraw\_request\_id ) . ' Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 492 | $is\_auto\_approve = $WCFMmp->wcfmmp\_withdraw->is\_withdrawal\_auto\_approve($vendor->ID); |
  |  | 493 | if ($is\_auto\_approve) { |
  |  | 494 | $payment\_processesing\_status = $WCFMmp->wcfmmp\_withdraw->wcfmmp\_withdrawal\_payment\_processesing($withdraw\_request\_id, $vendor->ID, $payment\_method, $total\_commission, $withdraw\_charges); |
  |  | 495 | if ($payment\_processesing\_status) { |
  |  | 496 | wcfm\_withdrawal\_log('Periodic withdrawal request successfully processed. Withdrawal ID :: ' . sprintf('%06u', $withdraw\_request\_id) . ' Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 489 | 497 | } else { |
  | 490 |  | wcfm\_withdrawal\_log(~~'Periodic withdrawal request processing failed. Withdrawal ID :: ' . sprintf( '%06u', $withdraw\_request\_id ) . ' Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 498 | wcfm\_withdrawal\_log('Periodic withdrawal request processing failed. Withdrawal ID :: ' . sprintf('%06u', $withdraw\_request\_id) . ' Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 491 | 499 | } |
  | 492 | 500 | } else { |
  | 493 | 501 | // Admin Notification |
  | 494 |  | $store\_name = $WCFM->wcfm\_vendor\_support->wcfm\_get\_vendor\_store\_by\_vendor(~~absint($vendor->ID)~~ ); |
  | 495 |  | $wcfm\_messages = sprintf(~~\_\_( 'Vendor <b>%s</b> has placed a Withdrawal Request #%s.', 'wc-frontend-manager' ), $store\_name, '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . add\_query\_arg( 'transaction\_id', $withdraw\_request\_id, wcfm\_withdrawal\_requests\_url() ) . '">' . sprintf( '%06u', $withdraw\_request\_id ) . '</a>'~~ ); |
  |  | 502 | $store\_name = $WCFM->wcfm\_vendor\_support->wcfm\_get\_vendor\_store\_by\_vendor(absint($vendor->ID)); |
  |  | 503 | $wcfm\_messages = sprintf(\_\_('Vendor <b>%s</b> has placed a Withdrawal Request #%s.', 'wc-frontend-manager'), $store\_name, '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . add\_query\_arg('transaction\_id', $withdraw\_request\_id, wcfm\_withdrawal\_requests\_url()) . '">' . sprintf('%06u', $withdraw\_request\_id) . '</a>'); |
  | 496 | 504 |  |
  | 497 | 505 | $raw\_message = [ |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L502) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L510) |  |
  | 502 | 510 | 'function'  => 'sprintf', |
  | 503 | 511 | 'args'      => [ |
  | 504 |  | $store\_name, |
  | 505 |  | '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . add\_query\_arg(~~'transaction\_id', $withdraw\_request\_id, wcfm\_withdrawal\_requests\_url() ) . '">' . sprintf( '%06u', $withdraw\_request\_id~~ ) . '</a>' |
  |  | 512 | $store\_name, |
  |  | 513 | '<a target="\_blank" class="wcfm\_dashboard\_item\_title" href="' . add\_query\_arg('transaction\_id', $withdraw\_request\_id, wcfm\_withdrawal\_requests\_url()) . '">' . sprintf('%06u', $withdraw\_request\_id) . '</a>' |
  | 506 | 514 | ] |
  | 507 | 515 | ] |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L509) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L517) |  |
  | 509 | 517 | ]; |
  | 510 | 518 |  |
  | 511 |  | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message(~~$vendor->ID, 0, 0, 1, $wcfm\_messages, 'withdraw-request', true, $raw\_message~~ ); |
  | 512 |  | wcfm\_withdrawal\_log(~~'Periodic withdrawal request successfully sent. Withdrawal ID :: ' . sprintf( '%06u', $withdraw\_request\_id ) . ' Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 519 | $WCFM->wcfm\_notification->wcfm\_send\_direct\_message($vendor->ID, 0, 0, 1, $wcfm\_messages, 'withdraw-request', true, $raw\_message); |
  |  | 520 | wcfm\_withdrawal\_log('Periodic withdrawal request successfully sent. Withdrawal ID :: ' . sprintf('%06u', $withdraw\_request\_id) . ' Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 513 | 521 | } |
  | 514 |  |  |
  | 515 |  | do\_action(~~'wcfmmp\_withdrawal\_request\_submited', $withdraw\_request\_id, $vendor->ID~~ ); |
  |  | 522 |  |
  |  | 523 | do\_action('wcfmmp\_withdrawal\_request\_submited', $withdraw\_request\_id, $vendor->ID); |
  | 516 | 524 | } else { |
  | 517 |  | wcfm\_withdrawal\_log(~~'Periodic withdrawal request failed. Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 525 | wcfm\_withdrawal\_log('Periodic withdrawal request failed. Vendor :: ' . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 518 | 526 | } |
  | 519 | 527 | } else { |
  | 520 |  | wcfm\_withdrawal\_log(~~"Periodic withdrawal commission less than withdrawal limit. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 528 | wcfm\_withdrawal\_log("Periodic withdrawal commission less than withdrawal limit. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 521 | 529 | } |
  | 522 | 530 | } else { |
  | 523 |  | wcfm\_withdrawal\_log(~~"Periodic withdrawal no pending commission. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 531 | wcfm\_withdrawal\_log("Periodic withdrawal no pending commission. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 524 | 532 | } |
  | 525 | 533 | } else { |
  | 526 |  | wcfm\_withdrawal\_log(~~"Periodic withdrawal payment method missing. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 534 | wcfm\_withdrawal\_log("Periodic withdrawal payment method missing. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 527 | 535 | } |
  | 528 | 536 | } else { |
  | 529 |  | wcfm\_withdrawal\_log(~~"Periodic withdrawal payment method missing. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 537 | wcfm\_withdrawal\_log("Periodic withdrawal payment method missing. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 530 | 538 | } |
  | 531 |  | wcfm\_withdrawal\_log(~~"Periodic withdrawal end. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name~~ ); |
  |  | 539 | wcfm\_withdrawal\_log("Periodic withdrawal end. Vendor :: " . $vendor->ID . ' Store :: ' . $shop\_name); |
  | 532 | 540 | } |
  | 533 | 541 | } |
  | 534 | 542 | } |
  | 535 |  |  |
  | 536 |  |  |
  | 537 |  | wcfm\_withdrawal\_log(~~"PERIODIC WITHDRAWAL SCHEDULER END :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format(), current\_time( 'timestamp', 0 ) )~~ ); // End Log |
  | 538 |  | } |
  | 539 |  | } |
  | 540 |  |  |
  |  | 543 |  |
  |  | 544 |  |
  |  | 545 | wcfm\_withdrawal\_log("PERIODIC WITHDRAWAL SCHEDULER END :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), current\_time('timestamp', 0))); // End Log |
  |  | 546 | } |
  |  | 547 | } |
  |  | 548 |  |
  | 541 | 549 | /\*\* |
  | 542 | 550 | \* Periodic Data Cleanup Schduler Check |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L544) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L552) |  |
  | 544 | 552 | function wcfmmp\_data\_cleanup\_periodic\_scheduler\_check() { |
  | 545 | 553 | global $WCFM, $WCFMmp, $wpdb; |
  | 546 |  |  |
  | 547 |  | $wcfm\_data\_cleanup\_options        = get\_option(~~'wcfm\_data\_cleanup\_options', array()~~ ); |
  | 548 |  |  |
  | 549 |  | $enable\_data\_cleanup              = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup'] : 'no'; |
  | 550 |  |  |
  | 551 |  | $enable\_data\_cleanup\_messages     = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages'] : 'no'; |
  | 552 |  | $messages\_data\_cleanup\_more\_than  = isset(~~$wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than']~~ ) ? $wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than'] : '90'; |
  | 553 |  |  |
  | 554 |  | $enable\_data\_cleanup\_inquiry      = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry'] : 'no'; |
  | 555 |  | $inquiry\_data\_cleanup\_more\_than   = isset(~~$wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than']~~ ) ? $wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than'] : '90'; |
  | 556 |  |  |
  | 557 |  | $enable\_data\_cleanup\_analytics    = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics'] : 'no'; |
  | 558 |  | $analytics\_data\_cleanup\_more\_than = isset(~~$wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than']~~ ) ? $wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than'] : '90'; |
  | 559 |  |  |
  | 560 |  | if~~( $enable\_data\_cleanup == 'yes'~~ ) { |
  | 561 |  | wcfm\_cleanup\_log(~~"PERIODIC DATA CLEANUP SCHEDULER START :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format(), current\_time( 'timestamp', 0 ) )~~ ); // Start Log |
  | 562 |  |  |
  |  | 554 |  |
  |  | 555 | $wcfm\_data\_cleanup\_options        = get\_option('wcfm\_data\_cleanup\_options', array()); |
  |  | 556 |  |
  |  | 557 | $enable\_data\_cleanup              = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup'] : 'no'; |
  |  | 558 |  |
  |  | 559 | $enable\_data\_cleanup\_messages     = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_messages'] : 'no'; |
  |  | 560 | $messages\_data\_cleanup\_more\_than  = isset($wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than']) ? $wcfm\_data\_cleanup\_options['messages\_data\_cleanup\_more\_than'] : '90'; |
  |  | 561 |  |
  |  | 562 | $enable\_data\_cleanup\_inquiry      = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_inquiry'] : 'no'; |
  |  | 563 | $inquiry\_data\_cleanup\_more\_than   = isset($wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than']) ? $wcfm\_data\_cleanup\_options['inquiry\_data\_cleanup\_more\_than'] : '90'; |
  |  | 564 |  |
  |  | 565 | $enable\_data\_cleanup\_analytics    = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup\_analytics'] : 'no'; |
  |  | 566 | $analytics\_data\_cleanup\_more\_than = isset($wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than']) ? $wcfm\_data\_cleanup\_options['analytics\_data\_cleanup\_more\_than'] : '90'; |
  |  | 567 |  |
  |  | 568 | if ($enable\_data\_cleanup == 'yes') { |
  |  | 569 | wcfm\_cleanup\_log("PERIODIC DATA CLEANUP SCHEDULER START :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), current\_time('timestamp', 0))); // Start Log |
  |  | 570 |  |
  | 563 | 571 | // Notification data cleaup |
  | 564 |  | if~~( $enable\_data\_cleanup\_messages == 'yes'~~ ) { |
  | 565 |  | wcfm\_cleanup\_log(~~"PERIODIC NOTIFICATION DATA CLEANUP SCHEDULER START. Older than :: " . $messages\_data\_cleanup\_more\_than~~ ); |
  | 566 |  |  |
  |  | 572 | if ($enable\_data\_cleanup\_messages == 'yes') { |
  |  | 573 | wcfm\_cleanup\_log("PERIODIC NOTIFICATION DATA CLEANUP SCHEDULER START. Older than :: " . $messages\_data\_cleanup\_more\_than); |
  |  | 574 |  |
  | 567 | 575 | // Fetching Old Messages |
  | 568 |  | $messages = $wpdb->get\_results(~~"SELECT ID, created FROM {$wpdb->prefix}wcfm\_messages WHERE `created` <= DATE\_SUB(SYSDATE(), INTERVAL {$messages\_data\_cleanup\_more\_than} DAY)"~~ ); |
  | 569 |  | if~~( !empty( $messages )~~ ) { |
  | 570 |  | foreach~~( $messages as $message~~ ) { |
  | 571 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_messages WHERE ID = %d", $message->ID )~~ ); |
  | 572 |  |  |
  |  | 576 | $messages = $wpdb->get\_results("SELECT ID, created FROM {$wpdb->prefix}wcfm\_messages WHERE `created` <= DATE\_SUB(SYSDATE(), INTERVAL {$messages\_data\_cleanup\_more\_than} DAY)"); |
  |  | 577 | if (!empty($messages)) { |
  |  | 578 | foreach ($messages as $message) { |
  |  | 579 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_messages WHERE ID = %d", $message->ID)); |
  |  | 580 |  |
  | 573 | 581 | // Meta Cleanup |
  | 574 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_messages\_modifier WHERE `message` = %d", $message->ID )~~ ); |
  | 575 |  |  |
  | 576 |  | wcfm\_cleanup\_log(~~"Notification data cleanup processed. ID :: " . $message->ID . " Created :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format() , strtotime( $message->created ) )~~ ); |
  |  | 582 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_messages\_modifier WHERE `message` = %d", $message->ID)); |
  |  | 583 |  |
  |  | 584 | wcfm\_cleanup\_log("Notification data cleanup processed. ID :: " . $message->ID . " Created :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), strtotime($message->created))); |
  | 577 | 585 | } |
  | 578 | 586 | } |
  | 579 |  |  |
  | 580 |  | wcfm\_cleanup\_log(~~"PERIODIC NOTIFICATION DATA CLEANUP SCHEDULER END. Older than :: " . $messages\_data\_cleanup\_more\_than~~ ); |
  |  | 587 |  |
  |  | 588 | wcfm\_cleanup\_log("PERIODIC NOTIFICATION DATA CLEANUP SCHEDULER END. Older than :: " . $messages\_data\_cleanup\_more\_than); |
  | 581 | 589 | } else { |
  | 582 |  | wcfm\_cleanup\_log(~~"Notification data cleanup disabled."~~ ); |
  | 583 |  | } |
  | 584 |  |  |
  |  | 590 | wcfm\_cleanup\_log("Notification data cleanup disabled."); |
  |  | 591 | } |
  |  | 592 |  |
  | 585 | 593 | // Inquiry data cleaup |
  | 586 |  | if~~( $enable\_data\_cleanup\_inquiry == 'yes'~~ ) { |
  | 587 |  | wcfm\_cleanup\_log(~~"PERIODIC INQUIRY DATA CLEANUP SCHEDULER START. Older than :: " . $inquiry\_data\_cleanup\_more\_than~~ ); |
  | 588 |  |  |
  |  | 594 | if ($enable\_data\_cleanup\_inquiry == 'yes') { |
  |  | 595 | wcfm\_cleanup\_log("PERIODIC INQUIRY DATA CLEANUP SCHEDULER START. Older than :: " . $inquiry\_data\_cleanup\_more\_than); |
  |  | 596 |  |
  | 589 | 597 | // Fetching Old Inquiries |
  | 590 |  | $inquiries = $wpdb->get\_results(~~"SELECT ID, posted FROM {$wpdb->prefix}wcfm\_enquiries WHERE `posted` <= DATE\_SUB(SYSDATE(), INTERVAL {$inquiry\_data\_cleanup\_more\_than} DAY)"~~ ); |
  | 591 |  | if~~( !empty( $inquiries )~~ ) { |
  | 592 |  | foreach~~( $inquiries as $inquiry~~ ) { |
  | 593 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_enquiries WHERE ID = %d", $inquiry->ID )~~ ); |
  | 594 |  |  |
  |  | 598 | $inquiries = $wpdb->get\_results("SELECT ID, posted FROM {$wpdb->prefix}wcfm\_enquiries WHERE `posted` <= DATE\_SUB(SYSDATE(), INTERVAL {$inquiry\_data\_cleanup\_more\_than} DAY)"); |
  |  | 599 | if (!empty($inquiries)) { |
  |  | 600 | foreach ($inquiries as $inquiry) { |
  |  | 601 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_enquiries WHERE ID = %d", $inquiry->ID)); |
  |  | 602 |  |
  | 595 | 603 | // Meta Cleanup |
  | 596 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_enquiries\_meta WHERE `enquiry\_id` = %d", $inquiry->ID )~~ ); |
  | 597 |  |  |
  |  | 604 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_enquiries\_meta WHERE `enquiry\_id` = %d", $inquiry->ID)); |
  |  | 605 |  |
  | 598 | 606 | // Inquiry Reply Cleanup |
  | 599 |  | $inquiry\_replies = $wpdb->get\_results(~~$wpdb->prepare( "SELECT ID FROM {$wpdb->prefix}wcfm\_enquiries\_response WHERE `enquiry\_id` = %d", $inquiry->ID )~~ ); |
  | 600 |  | if~~( !empty( $inquiry\_replies )~~ ) { |
  | 601 |  | foreach~~( $inquiry\_replies as $inquiry\_reply~~ ) { |
  | 602 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_enquiries\_response WHERE `ID` = %d", $inquiry\_reply->ID )~~ ); |
  | 603 |  |  |
  |  | 607 | $inquiry\_replies = $wpdb->get\_results($wpdb->prepare("SELECT ID FROM {$wpdb->prefix}wcfm\_enquiries\_response WHERE `enquiry\_id` = %d", $inquiry->ID)); |
  |  | 608 | if (!empty($inquiry\_replies)) { |
  |  | 609 | foreach ($inquiry\_replies as $inquiry\_reply) { |
  |  | 610 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_enquiries\_response WHERE `ID` = %d", $inquiry\_reply->ID)); |
  |  | 611 |  |
  | 604 | 612 | // Reply Meta Cleanup |
  | 605 |  | $wpdb->query(~~$wpdb->prepare( "DELETE FROM {$wpdb->prefix}wcfm\_enquiries\_response\_meta WHERE `enquiry\_response\_id` = %d", $inquiry\_reply->ID )~~ ); |
  |  | 613 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_enquiries\_response\_meta WHERE `enquiry\_response\_id` = %d", $inquiry\_reply->ID)); |
  | 606 | 614 | } |
  | 607 | 615 | } |
  | 608 |  |  |
  | 609 |  | wcfm\_cleanup\_log(~~"Inquiry data cleanup processed. ID :: " . $inquiry->ID . " Created :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format() , strtotime( $inquiry->posted ) )~~ ); |
  |  | 616 |  |
  |  | 617 | wcfm\_cleanup\_log("Inquiry data cleanup processed. ID :: " . $inquiry->ID . " Created :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), strtotime($inquiry->posted))); |
  | 610 | 618 | } |
  | 611 | 619 | } |
  | 612 |  |  |
  | 613 |  | wcfm\_cleanup\_log(~~"PERIODIC INQUIRY DATA CLEANUP SCHEDULER END. Older than :: " . $inquiry\_data\_cleanup\_more\_than~~ ); |
  |  | 620 |  |
  |  | 621 | wcfm\_cleanup\_log("PERIODIC INQUIRY DATA CLEANUP SCHEDULER END. Older than :: " . $inquiry\_data\_cleanup\_more\_than); |
  | 614 | 622 | } else { |
  | 615 |  | wcfm\_cleanup\_log(~~"Inquiry data cleanup disabled."~~ ); |
  | 616 |  | } |
  | 617 |  |  |
  |  | 623 | wcfm\_cleanup\_log("Inquiry data cleanup disabled."); |
  |  | 624 | } |
  |  | 625 |  |
  | 618 | 626 | // Analytics data cleaup |
  | 619 | 627 | //if( WCFM\_Dependencies::wcfma\_plugin\_active\_check() ) { |
  | 620 |  | if( $enable\_data\_cleanup\_analytics == 'yes' ) { |
  | 621 |  | wcfm\_cleanup\_log( "PERIODIC ANALYTICS DATA CLEANUP SCHEDULER START. Older than :: " . $analytics\_data\_cleanup\_more\_than ); |
  | 622 |  |  |
  | 623 |  | // Daily Analytics Data Cleanup |
  | 624 |  | $analytics = $wpdb->get\_results( "SELECT ID, visited FROM {$wpdb->prefix}wcfm\_daily\_analysis WHERE `visited` <= DATE\_SUB(SYSDATE(), INTERVAL {$analytics\_data\_cleanup\_more\_than} DAY)" ); |
  | 625 |  | if( !empty( $analytics ) ) { |
  | 626 |  | foreach( $analytics as $analytic ) { |
  | 627 |  | $wpdb->query( $wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_daily\_analysis WHERE ID = %d", $analytic->ID ) ); |
  | 628 |  | wcfm\_cleanup\_log( "Daily Analytics data cleanup processed. ID :: " . $analytic->ID . " Created :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format() , strtotime( $analytic->visited ) ) ); |
  | 629 |  | } |
  |  | 628 | if ($enable\_data\_cleanup\_analytics == 'yes') { |
  |  | 629 | wcfm\_cleanup\_log("PERIODIC ANALYTICS DATA CLEANUP SCHEDULER START. Older than :: " . $analytics\_data\_cleanup\_more\_than); |
  |  | 630 |  |
  |  | 631 | // Daily Analytics Data Cleanup |
  |  | 632 | $analytics = $wpdb->get\_results("SELECT ID, visited FROM {$wpdb->prefix}wcfm\_daily\_analysis WHERE `visited` <= DATE\_SUB(SYSDATE(), INTERVAL {$analytics\_data\_cleanup\_more\_than} DAY)"); |
  |  | 633 | if (!empty($analytics)) { |
  |  | 634 | foreach ($analytics as $analytic) { |
  |  | 635 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_daily\_analysis WHERE ID = %d", $analytic->ID)); |
  |  | 636 | wcfm\_cleanup\_log("Daily Analytics data cleanup processed. ID :: " . $analytic->ID . " Created :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), strtotime($analytic->visited))); |
  | 630 | 637 | } |
  | 631 |  |  |
  | 632 |  | // Detailed Analytics Data Cleanup |
  | 633 |  | ~~$analytics = $wpdb->get\_results( "SELECT ID, visited FROM {$wpdb->prefix}wcfm\_detailed\_analysis WHERE `visited` <= DATE\_SUB(SYSDATE(), INTERVAL {$analytics\_data\_cleanup\_more\_than} DAY)" );~~ |
  | 634 |  | ~~if( !empty( $analytics ) ) {~~ |
  | 635 |  | ~~foreach( $analytics as $analytic~~ ) { |
  | 636 |  | ~~$wpdb->query( $wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_detailed\_analysis WHERE ID = %d", $analytic->ID ) );~~ |
  | 637 |  | ~~wcfm\_cleanup\_log( "Detailed Analytics data cleanup processed. ID :: " . $analytic->ID . " Created :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format() , strtotime( $analytic->visited ) )~~ ); |
  | 638 |  | ~~}~~ |
  |  | 638 | } |
  |  | 639 |  |
  |  | 640 | // Detailed Analytics Data Cleanup |
  |  | 641 | $analytics = $wpdb->get\_results("SELECT ID, visited FROM {$wpdb->prefix}wcfm\_detailed\_analysis WHERE `visited` <= DATE\_SUB(SYSDATE(), INTERVAL {$analytics\_data\_cleanup\_more\_than} DAY)"); |
  |  | 642 | if (!empty($analytics)) { |
  |  | 643 | foreach ($analytics as $analytic) { |
  |  | 644 | $wpdb->query($wpdb->prepare("DELETE FROM {$wpdb->prefix}wcfm\_detailed\_analysis WHERE ID = %d", $analytic->ID)); |
  |  | 645 | wcfm\_cleanup\_log("Detailed Analytics data cleanup processed. ID :: " . $analytic->ID . " Created :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), strtotime($analytic->visited))); |
  | 639 | 646 | } |
  | 640 |  |  |
  | 641 |  | wcfm\_cleanup\_log( "PERIODIC ANALYTICS DATA CLEANUP SCHEDULER END. Older than :: " . $analytics\_data\_cleanup\_more\_than ); |
  | 642 |  | } else { |
  | 643 |  | wcfm\_cleanup\_log( "Analytics data cleanup disabled." ); |
  | 644 |  | } |
  |  | 647 | } |
  |  | 648 |  |
  |  | 649 | wcfm\_cleanup\_log("PERIODIC ANALYTICS DATA CLEANUP SCHEDULER END. Older than :: " . $analytics\_data\_cleanup\_more\_than); |
  |  | 650 | } else { |
  |  | 651 | wcfm\_cleanup\_log("Analytics data cleanup disabled."); |
  |  | 652 | } |
  | 645 | 653 | //} |
  | 646 |  |  |
  | 647 |  | wcfm\_cleanup\_log(~~"PERIODIC DATA CLEANUP SCHEDULER END :: " . date\_i18n( wc\_date\_format() . ' ' . wc\_time\_format(), current\_time( 'timestamp', 0 ) )~~ ); // End Log |
  |  | 654 |  |
  |  | 655 | wcfm\_cleanup\_log("PERIODIC DATA CLEANUP SCHEDULER END :: " . date\_i18n(wc\_date\_format() . ' ' . wc\_time\_format(), current\_time('timestamp', 0))); // End Log |
  | 648 | 656 | } |
  | 649 | 657 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L651) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L659) |  |
  | 651 | 659 | public function load\_class($class\_name = '') { |
  | 652 | 660 | if ('' != $class\_name && '' != $this->token) { |
  | 653 |  | require\_once('class-' . esc\_attr($this->token) . '-' . esc\_attr($class\_name) . '.php'); |
  |  | 661 | require\_once('class-' . esc\_attr($this->token) . '-' . esc\_attr($class\_name) . '.php'); |
  | 654 | 662 | } // End If Statement |
  | 655 | 663 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L665) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L673) |  |
  | 665 | 673 | static function activate\_wcfmmp() { |
  | 666 | 674 | global $WCFM, $WCFMmp, $wp\_roles; |
  | 667 |  |  |
  |  | 675 |  |
  | 668 | 676 | // Rewrite rules loader |
  | 669 |  | $WCFMmp->load\_class(~~'rewrite'~~ ); |
  |  | 677 | $WCFMmp->load\_class('rewrite'); |
  | 670 | 678 | $WCFMmp->wcfmmp\_rewrite = new WCFMmp\_Rewrites(); |
  | 671 |  |  |
  | 672 |  | require\_once~~( $WCFMmp->plugin\_path . 'helpers/class-wcfmmp-install.php'~~ ); |
  |  | 679 |  |
  |  | 680 | require\_once($WCFMmp->plugin\_path . 'helpers/class-wcfmmp-install.php'); |
  | 673 | 681 | $WCFMmp\_Install = new WCFMmp\_Install(); |
  | 674 |  |  |
  | 675 |  | update\_option(~~'wcfmmp\_updated\_3\_3\_10', 1~~ ); |
  | 676 |  | update\_option(~~'wcfmmp\_installed', 1~~ ); |
  | 677 |  | } |
  | 678 |  |  |
  |  | 682 |  |
  |  | 683 | update\_option('wcfmmp\_updated\_3\_3\_10', 1); |
  |  | 684 | update\_option('wcfmmp\_installed', 1); |
  |  | 685 | } |
  |  | 686 |  |
  | 679 | 687 | /\*\* |
  | 680 | 688 | \* Check Installer upon load. |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L685) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L693) |  |
  | 685 | 693 | function run\_wcfmmp\_installer() { |
  | 686 | 694 | global $WCFM, $WCFMmp, $wpdb; |
  | 687 |  |  |
  | 688 |  | $wcfm\_marketplace\_tables = $wpdb->query("SHOW tables like '{$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal\_meta'"); |
  | 689 |  | if~~( !$wcfm\_marketplace\_tables~~ ) { |
  | 690 |  | delete\_option(~~'wcfmmp\_updated\_3\_3\_10'~~ ); |
  | 691 |  | delete\_option(~~'wcfmmp\_table\_install'~~ ); |
  | 692 |  | } |
  | 693 |  |  |
  | 694 |  | if~~( !get\_option( 'wcfmmp\_updated\_3\_3\_10' )~~ ) { |
  | 695 |  | delete\_option(~~'wcfmmp\_table\_install'~~ ); |
  | 696 |  | require\_once~~( $WCFMmp->plugin\_path . 'helpers/class-wcfmmp-install.php'~~ ); |
  |  | 695 |  |
  |  | 696 | $wcfm\_marketplace\_tables = $wpdb->query("SHOW tables like '{$wpdb->prefix}wcfm\_marketplace\_reverse\_withdrawal\_meta'"); |
  |  | 697 | if (!$wcfm\_marketplace\_tables) { |
  |  | 698 | delete\_option('wcfmmp\_updated\_3\_3\_10'); |
  |  | 699 | delete\_option('wcfmmp\_table\_install'); |
  |  | 700 | } |
  |  | 701 |  |
  |  | 702 | if (!get\_option('wcfmmp\_updated\_3\_3\_10')) { |
  |  | 703 | delete\_option('wcfmmp\_table\_install'); |
  |  | 704 | require\_once($WCFMmp->plugin\_path . 'helpers/class-wcfmmp-install.php'); |
  | 697 | 705 | $WCFMmp\_Install = new WCFMmp\_Install(); |
  | 698 |  | update\_option(~~'wcfmmp\_updated\_3\_3\_10', 1~~ ); |
  | 699 |  | } |
  | 700 |  |  |
  | 701 |  | if (~~!get\_option("wcfmmp\_page\_install") || !get\_option("wcfmmp\_table\_install")~~ ) { |
  | 702 |  | require\_once~~( $WCFMmp->plugin\_path . 'helpers/class-wcfmmp-install.php'~~ ); |
  |  | 706 | update\_option('wcfmmp\_updated\_3\_3\_10', 1); |
  |  | 707 | } |
  |  | 708 |  |
  |  | 709 | if (!get\_option("wcfmmp\_page\_install") || !get\_option("wcfmmp\_table\_install")) { |
  |  | 710 | require\_once($WCFMmp->plugin\_path . 'helpers/class-wcfmmp-install.php'); |
  | 703 | 711 | $WCFMmp\_Install = new WCFMmp\_Install(); |
  | 704 |  |  |
  |  | 712 |  |
  | 705 | 713 | update\_option('wcfmmp\_installed', 1); |
  | 706 | 714 | } |
  | 707 |  |  |
  |  | 715 |  |
  | 708 | 716 | // Removing old Schedule |
  | 709 |  | if (~~class\_exists( 'WooCommerce' )~~ ) { |
  | 710 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_periodic\_withdrawal\_scheduler'~~ ); |
  | 711 |  | if (~~$next~~ ) { |
  | 712 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_periodic\_withdrawal\_scheduler'~~ ); |
  | 713 |  | } |
  | 714 |  |  |
  |  | 717 | if (class\_exists('WooCommerce')) { |
  |  | 718 | $next = WC()->queue()->get\_next('wcfmmp\_periodic\_withdrawal\_scheduler'); |
  |  | 719 | if ($next) { |
  |  | 720 | WC()->queue()->cancel\_all('wcfmmp\_periodic\_withdrawal\_scheduler'); |
  |  | 721 | } |
  |  | 722 |  |
  | 715 | 723 | // Init Periodic Withdrawal Scheduler |
  | 716 |  | $wcfm\_withdrawal\_options = get\_option( 'wcfm\_withdrawal\_options', array() ); |
  | 717 |  |  |
  | 718 |  | $withdrawal\_mode         = isset( $wcfm\_withdrawal\_options['withdrawal\_mode'] ) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  | 719 |  | $withdrawal\_schedule     = isset( $wcfm\_withdrawal\_options['withdrawal\_schedule'] ) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  | 720 |  | if( $withdrawal\_mode && ( $withdrawal\_mode == 'by\_schedule' ) ) { |
  | 721 |  |  |
  | 722 |  | $period\_interval    = 1; |
  | 723 |  | $period\_starts\_from = time(); |
  | 724 |  | switch( $withdrawal\_schedule ) { |
  | 725 |  | case 'week': |
  | 726 |  | $period\_interval    = 7; |
  | 727 |  | $period\_starts\_from = strtotime( "next monday", time() ); |
  | 728 |  | break; |
  | 729 |  |  |
  | 730 |  | case '2weeks': |
  | 731 |  | $period\_interval = 14; |
  | 732 |  | $period\_starts\_from = strtotime( "next monday", time() ); |
  | 733 |  | break; |
  | 734 |  |  |
  | 735 |  | case 'month': |
  | 736 |  | $period\_interval = 30; |
  | 737 |  | $period\_starts\_from = strtotime('first day of next month'); |
  | 738 |  | break; |
  | 739 |  |  |
  | 740 |  | case '2months': |
  | 741 |  | $period\_interval = 60; |
  | 742 |  | $period\_starts\_from = strtotime('first day of next month'); |
  | 743 |  | break; |
  | 744 |  |  |
  | 745 |  | case 'quarter': |
  | 746 |  | $period\_interval = 90; |
  | 747 |  | $period\_starts\_from = strtotime('first day of next month'); |
  | 748 |  | break; |
  | 749 |  | } |
  | 750 |  |  |
  | 751 |  | $period\_interval    = apply\_filters( 'wcfm\_schedule\_period\_interval', $period\_interval, $withdrawal\_schedule ); |
  | 752 |  | $period\_starts\_from = apply\_filters( 'wcfm\_schedule\_period\_starts\_from', $period\_starts\_from, $withdrawal\_schedule ); |
  | 753 |  |  |
  | 754 |  |  |
  | 755 |  | $next = WC()->queue()->get\_next( 'wcfmmp\_withdrawal\_periodic\_scheduler' ); |
  | 756 |  | if ( ! $next ) { |
  | 757 |  | WC()->queue()->cancel\_all( 'wcfmmp\_withdrawal\_periodic\_scheduler' ); |
  | 758 |  | WC()->queue()->schedule\_recurring( $period\_starts\_from, ( $period\_interval \* DAY\_IN\_SECONDS ), 'wcfmmp\_withdrawal\_periodic\_scheduler', array(), 'WCFM' ); |
  |  | 724 | $wcfm\_withdrawal\_options = get\_option('wcfm\_withdrawal\_options', array()); |
  |  | 725 |  |
  |  | 726 | $withdrawal\_mode         = isset($wcfm\_withdrawal\_options['withdrawal\_mode']) ? $wcfm\_withdrawal\_options['withdrawal\_mode'] : ''; |
  |  | 727 | $withdrawal\_schedule     = isset($wcfm\_withdrawal\_options['withdrawal\_schedule']) ? $wcfm\_withdrawal\_options['withdrawal\_schedule'] : 'week'; |
  |  | 728 | if ($withdrawal\_mode && ($withdrawal\_mode == 'by\_schedule')) { |
  |  | 729 | $withdrawal\_schedule\_timestamps = wcfmmp\_generate\_timestamp\_for\_period($withdrawal\_schedule); |
  |  | 730 | $period\_interval    = apply\_filters('wcfm\_schedule\_period\_interval', $withdrawal\_schedule\_timestamps['days\_in\_period'], $withdrawal\_schedule); |
  |  | 731 | $period\_starts\_from = apply\_filters('wcfm\_schedule\_period\_starts\_from', $withdrawal\_schedule\_timestamps['starting\_timestamp'], $withdrawal\_schedule); |
  |  | 732 |  |
  |  | 733 | $next = WC()->queue()->get\_next('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 734 | if (!$next) { |
  |  | 735 | WC()->queue()->schedule\_recurring($period\_starts\_from, ($period\_interval \* DAY\_IN\_SECONDS), 'wcfmmp\_withdrawal\_periodic\_scheduler', array(), 'WCFM'); |
  | 759 | 736 | } |
  | 760 | 737 | } else { |
  | 761 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_withdrawal\_periodic\_scheduler'~~ ); |
  | 762 |  | if (~~$next~~ ) { |
  | 763 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_withdrawal\_periodic\_scheduler'~~ ); |
  | 764 |  | } |
  | 765 |  | } |
  | 766 |  |  |
  |  | 738 | $next = WC()->queue()->get\_next('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 739 | if ($next) { |
  |  | 740 | WC()->queue()->cancel\_all('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 741 | } |
  |  | 742 | } |
  |  | 743 |  |
  | 767 | 744 | // Init Periodic Data Cleanup Scheduler |
  | 768 |  | $wcfm\_data\_cleanup\_options = get\_option(~~'wcfm\_data\_cleanup\_options', array()~~ ); |
  | 769 |  |  |
  | 770 |  | $enable\_data\_cleanup = isset(~~$wcfm\_data\_cleanup\_options['enable\_data\_cleanup']~~ ) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup'] : 'no'; |
  | 771 |  | if~~( $enable\_data\_cleanup == 'yes'~~ ) { |
  | 772 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  | 773 |  | if (~~! $next~~ ) { |
  | 774 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  | 775 |  | WC()->queue()->schedule\_recurring(~~time(), DAY\_IN\_SECONDS, 'wcfmmp\_data\_cleanup\_periodic\_scheduler', array(), 'WCFM'~~ ); |
  |  | 745 | $wcfm\_data\_cleanup\_options = get\_option('wcfm\_data\_cleanup\_options', array()); |
  |  | 746 |  |
  |  | 747 | $enable\_data\_cleanup = isset($wcfm\_data\_cleanup\_options['enable\_data\_cleanup']) ? $wcfm\_data\_cleanup\_options['enable\_data\_cleanup'] : 'no'; |
  |  | 748 | if ($enable\_data\_cleanup == 'yes') { |
  |  | 749 | $next = WC()->queue()->get\_next('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  |  | 750 | if (!$next) { |
  |  | 751 | WC()->queue()->cancel\_all('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  |  | 752 | WC()->queue()->schedule\_recurring(time(), DAY\_IN\_SECONDS, 'wcfmmp\_data\_cleanup\_periodic\_scheduler', array(), 'WCFM'); |
  | 776 | 753 | } |
  | 777 | 754 | } else { |
  | 778 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  | 779 |  | if (~~$next~~ ) { |
  | 780 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  |  | 755 | $next = WC()->queue()->get\_next('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  |  | 756 | if ($next) { |
  |  | 757 | WC()->queue()->cancel\_all('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  | 781 | 758 | } |
  | 782 | 759 | } |
  | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=2757979#L792) | […](/browser/wc-multivendor-marketplace/trunk/core/class-wcfmmp.php?rev=3000763#L769) |  |
  | 792 | 769 | static function deactivate\_wcfmmp() { |
  | 793 | 770 | global $WCFM, $WCFMmp; |
  | 794 |  |  |
  |  | 771 |  |
  | 795 | 772 | // Delete Periodic Scheduler |
  | 796 |  | if (~~class\_exists( 'WooCommerce' )~~ ) { |
  | 797 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_withdrawal\_periodic\_scheduler'~~ ); |
  | 798 |  | if (~~$next~~ ) { |
  | 799 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_withdrawal\_periodic\_scheduler'~~ ); |
  | 800 |  | } |
  | 801 |  |  |
  | 802 |  | $next = WC()->queue()->get\_next(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  | 803 |  | if (~~$next~~ ) { |
  | 804 |  | WC()->queue()->cancel\_all(~~'wcfmmp\_data\_cleanup\_periodic\_scheduler'~~ ); |
  | 805 |  | } |
  | 806 |  | } |
  | 807 |  |  |
  | 808 |  | $wcfm\_marketplace\_options = get\_option(~~'wcfm\_marketplace\_options', array()~~ ); |
  | 809 |  | $delete\_data\_on\_uninstall = isset(~~$wcfm\_marketplace\_options['delete\_data\_on\_uninstall']~~ ) ? $wcfm\_marketplace\_options['delete\_data\_on\_uninstall'] : 'no'; |
  | 810 |  |  |
  | 811 |  | if~~( $delete\_data\_on\_uninstall == 'yes'~~ ) { |
  | 812 |  | require\_once~~( $WCFMmp->plugin\_path . 'helpers/class-wcfmmp-uninstall.php'~~ ); |
  |  | 773 | if (class\_exists('WooCommerce')) { |
  |  | 774 | $next = WC()->queue()->get\_next('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 775 | if ($next) { |
  |  | 776 | WC()->queue()->cancel\_all('wcfmmp\_withdrawal\_periodic\_scheduler'); |
  |  | 777 | } |
  |  | 778 |  |
  |  | 779 | $next = WC()->queue()->get\_next('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  |  | 780 | if ($next) { |
  |  | 781 | WC()->queue()->cancel\_all('wcfmmp\_data\_cleanup\_periodic\_scheduler'); |
  |  | 782 | } |
  |  | 783 | } |
  |  | 784 |  |
  |  | 785 | $wcfm\_marketplace\_options = get\_option('wcfm\_marketplace\_options', array()); |
  |  | 786 | $delete\_data\_on\_uninstall = isset($wcfm\_marketplace\_options['delete\_data\_on\_uninstall']) ? $wcfm\_marketplace\_options['delete\_data\_on\_uninstall'] : 'no'; |
  |  | 787 |  |
  |  | 788 | if ($delete\_data\_on\_uninstall == 'yes') { |
  |  | 789 | require\_once($WCFMmp->plugin\_path . 'helpers/class-wcfmmp-uninstall.php'); |
  | 813 | 790 | $WCFMmp\_Uninstall = new WCFMmp\_Uninstall(); |
  | 814 | 791 | } |
  | 815 |  |  |
  |  | 792 |  |
  | 816 | 793 | delete\_option('wcfmmp\_installed'); |
  | 817 | 794 | } |
  | 818 |  |  |
  | 819 | 795 | } |
* ## [wc-multivendor-marketplace/trunk/helpers/wcfmmp-core-functions.php](/changeset/3000763/wc-multivendor-marketplace/trunk/helpers/wcfmmp-core-functions.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/helpers/wcfmmp-core-functions.php")

  | [r2894888](/browser/wc-multivendor-marketplace/trunk/helpers/wcfmmp-core-functions.php?rev=2894888#L1126 "Show revision 2894888 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/helpers/wcfmmp-core-functions.php?rev=3000763#L1126 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 1126 | 1126 | } |
  | 1127 | 1127 | } |
  |  | 1128 |  |
  |  | 1129 | if (!function\_exists('wcfmmp\_generate\_timestamp\_for\_period')) { |
  |  | 1130 | function wcfmmp\_generate\_timestamp\_for\_period($time\_period) { |
  |  | 1131 | switch ($time\_period) { |
  |  | 1132 | case 'week': |
  |  | 1133 | $days\_in\_period = 7; |
  |  | 1134 | $starting\_timestamp = strtotime("next monday", time()); |
  |  | 1135 | break; |
  |  | 1136 |  |
  |  | 1137 | case '2weeks': |
  |  | 1138 | $days\_in\_period = 14; |
  |  | 1139 | $starting\_timestamp = strtotime("next monday", time()); |
  |  | 1140 | break; |
  |  | 1141 |  |
  |  | 1142 | case 'month': |
  |  | 1143 | $days\_in\_period = 30; |
  |  | 1144 | $starting\_timestamp = strtotime('first day of next month'); |
  |  | 1145 | break; |
  |  | 1146 |  |
  |  | 1147 | case '2months': |
  |  | 1148 | $days\_in\_period = 60; |
  |  | 1149 | $starting\_timestamp = strtotime('first day of next month'); |
  |  | 1150 | break; |
  |  | 1151 |  |
  |  | 1152 | case 'quarter': |
  |  | 1153 | $days\_in\_period = 90; |
  |  | 1154 | $starting\_timestamp = strtotime('first day of next month'); |
  |  | 1155 | break; |
  |  | 1156 |  |
  |  | 1157 | default: |
  |  | 1158 | $days\_in\_period = 1; |
  |  | 1159 | $starting\_timestamp = time(); |
  |  | 1160 | } |
  |  | 1161 |  |
  |  | 1162 | return [ |
  |  | 1163 | 'days\_in\_period' => $days\_in\_period, |
  |  | 1164 | 'starting\_timestamp' => $starting\_timestamp |
  |  | 1165 | ]; |
  |  | 1166 | } |
  |  | 1167 | } |
  | 1128 | 1168 | ?> |
* ## [wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php](/changeset/3000763/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php")

  | [r2654703](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php?rev=2654703#L17 "Show revision 2654703 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe.php?rev=3000763#L17 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 17 | 17 | private $client\_secret; |
  | 18 | 18 | private $published\_key; |
  |  | 19 | private $secret\_key; |
  | 19 | 20 |  |
  | 20 | 21 | private $is\_testmode = false; |
* ## [wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe\_split.php](/changeset/3000763/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php")

  | [r2654703](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=2654703#L25 "Show revision 2654703 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=3000763#L25 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 25 | 25 | private $client\_secret; |
  | 26 | 26 | private $published\_key; |
  |  | 27 | private $secret\_key; |
  | 27 | 28 | private $is\_3d\_secure = false; |
  | 28 | 29 |  |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=2654703#L36) | […](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=3000763#L37) |  |
  | 36 | 37 | private $access\_token; |
  | 37 | 38 | private $token\_type; |
  |  | 39 | private $charge\_type; |
  |  | 40 | private $debug; |
  | 38 | 41 |  |
  | 39 | 42 | public function \_\_construct() { |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=2654703#L986) | […](/browser/wc-multivendor-marketplace/trunk/includes/payment-gateways/class-wcfmmp-gateway-stripe_split.php?rev=3000763#L989) |  |
  | 986 | 989 | global $wpdb; |
  | 987 | 990 |  |
  |  | 991 | $order = wc\_get\_order( $order\_id ); |
  |  | 992 |  |
  | 988 | 993 | $wpdb->delete( $wpdb->prefix . 'wcfm\_marketplace\_orders', array( 'order\_id' => $order\_id ), array( '%d' ) ); |
  | 989 |  | delete\_post\_meta( $order\_id, '\_wcfmmp\_order\_processed' ); |
  | 990 |  | delete\_post\_meta( $order\_id, '\_wcfm\_store\_invoices' ); |
  |  | 994 | $order->delete\_meta\_data( '\_wcfmmp\_order\_processed' ); |
  |  | 995 | $order->delete\_meta\_data( '\_wcfm\_store\_invoices' ); |
  |  | 996 | $order->save(); |
  | 991 | 997 |  |
  | 992 | 998 | // Order Item Meta Reset - Order rest already performing this |
  | 993 |  | ~~$order        = wc\_get\_order( $order\_id );~~ |
  | 994 | 999 | $line\_items = $order->get\_items( 'line\_item' ); |
  | 995 | 1000 | if( !empty( $line\_items ) ) { |
* ## [wc-multivendor-marketplace/trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php](/changeset/3000763/wc-multivendor-marketplace/trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php")

  | [r2414753](/browser/wc-multivendor-marketplace/trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php?rev=2414753#L20 "Show revision 2414753 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/includes/shipping-gateways/class-wcfmmp-shipping-by-zone.php?rev=3000763#L20 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | \* Table Rates from Database |
  | 21 | 21 | \*/ |
  | 22 |  | public $default~~\_option~~; |
  |  | 22 | public $default; |
  | 23 | 23 |  |
  | 24 | 24 | /\*\* |
* ## [wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php](/changeset/3000763/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php")

  | [r2848338](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=2848338#L3 "Show revision 2848338 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763#L3 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | exit; |
  | 4 | 4 | } |
  |  | 5 |  |
  |  | 6 | use Automattic\WooCommerce\Utilities\OrderUtil; |
  | 5 | 7 |  |
  | 6 | 8 | /\*\* |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=2848338#L109) | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763#L111) |  |
  | 109 | 111 | $order\_id = WCFM\_Stripe\_Helper::is\_wc\_lt( '3.0' ) ? $order->id : $order->get\_id(); |
  | 110 | 112 |  |
  | 111 |  | delete\_post\_meta( $order\_id, self::META\_NAME\_FEE ); |
  | 112 |  | delete\_post\_meta( $order\_id, self::LEGACY\_META\_NAME\_FEE ); |
  |  | 113 | $order = wc\_get\_order( $order\_id ); |
  |  | 114 | $order->delete\_meta\_data( self::META\_NAME\_FEE ); |
  |  | 115 | $order->delete\_meta\_data( self::LEGACY\_META\_NAME\_FEE ); |
  |  | 116 | $order->save(); |
  | 113 | 117 | } |
  | 114 | 118 |  |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=2848338#L172) | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763#L176) |  |
  | 172 | 176 | $order\_id = WCFM\_Stripe\_Helper::is\_wc\_lt( '3.0' ) ? $order->id : $order->get\_id(); |
  | 173 | 177 |  |
  | 174 |  | delete\_post\_meta( $order\_id, self::META\_NAME\_NET ); |
  | 175 |  | delete\_post\_meta( $order\_id, self::LEGACY\_META\_NAME\_NET ); |
  |  | 178 | $order = wc\_get\_order( $order\_id ); |
  |  | 179 | $order->delete\_meta\_data( self::META\_NAME\_NET ); |
  |  | 180 | $order->delete\_meta\_data( self::LEGACY\_META\_NAME\_NET ); |
  |  | 181 | $order->save(); |
  | 176 | 182 | } |
  | 177 | 183 |  |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=2848338#L402) | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763#L408) |  |
  | 402 | 408 | global $wpdb; |
  | 403 | 409 |  |
  | 404 |  | $order\_id = $wpdb->get\_var( $wpdb->prepare( "SELECT DISTINCT ID FROM $wpdb->posts as posts LEFT JOIN $wpdb->postmeta as meta ON posts.ID = meta.post\_id WHERE meta.meta\_value = %s AND meta.meta\_key = %s", $source\_id, '\_stripe\_source\_id' ) ); |
  |  | 410 | if ( class\_exists( 'Automattic\WooCommerce\Utilities\OrderUtil' ) && OrderUtil::custom\_orders\_table\_usage\_is\_enabled() ) { |
  |  | 411 | $orders   = wc\_get\_orders( |
  |  | 412 | [ |
  |  | 413 | 'limit'      => 1, |
  |  | 414 | 'meta\_query' => [ |
  |  | 415 | [ |
  |  | 416 | 'key'   => '\_stripe\_source\_id', |
  |  | 417 | 'value' => $source\_id, |
  |  | 418 | ], |
  |  | 419 | ], |
  |  | 420 | ] |
  |  | 421 | ); |
  |  | 422 | $order\_id = current( $orders ) ? current( $orders )->get\_id() : false; |
  |  | 423 | } else { |
  |  | 424 | $order\_id = $wpdb->get\_var( $wpdb->prepare( "SELECT DISTINCT ID FROM $wpdb->posts as posts LEFT JOIN $wpdb->postmeta as meta ON posts.ID = meta.post\_id WHERE meta.meta\_value = %s AND meta.meta\_key = %s", $source\_id, '\_stripe\_source\_id' ) ); |
  |  | 425 | } |
  | 405 | 426 |  |
  | 406 | 427 | if ( ! empty( $order\_id ) ) { |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=2848338#L425) | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763#L446) |  |
  | 425 | 446 | } |
  | 426 | 447 |  |
  | 427 |  | $order\_id = $wpdb->get\_var( $wpdb->prepare( "SELECT DISTINCT ID FROM $wpdb->posts as posts LEFT JOIN $wpdb->postmeta as meta ON posts.ID = meta.post\_id WHERE meta.meta\_value = %s AND meta.meta\_key = %s", $charge\_id, '\_transaction\_id' ) ); |
  |  | 448 | if ( class\_exists( 'Automattic\WooCommerce\Utilities\OrderUtil' ) && OrderUtil::custom\_orders\_table\_usage\_is\_enabled() ) { |
  |  | 449 | $orders   = wc\_get\_orders( |
  |  | 450 | [ |
  |  | 451 | 'limit'      => 1, |
  |  | 452 | 'meta\_query' => [ |
  |  | 453 | [ |
  |  | 454 | 'key'   => '\_transaction\_id', |
  |  | 455 | 'value' => $charge\_id, |
  |  | 456 | ], |
  |  | 457 | ], |
  |  | 458 | ] |
  |  | 459 | ); |
  |  | 460 | $order\_id = current( $orders ) ? current( $orders )->get\_id() : false; |
  |  | 461 | } else { |
  |  | 462 | $order\_id = $wpdb->get\_var( $wpdb->prepare( "SELECT DISTINCT ID FROM $wpdb->posts as posts LEFT JOIN $wpdb->postmeta as meta ON posts.ID = meta.post\_id WHERE meta.meta\_value = %s AND meta.meta\_key = %s", $charge\_id, '\_transaction\_id' ) ); |
  |  | 463 | } |
  | 428 | 464 |  |
  | 429 | 465 | if ( ! empty( $order\_id ) ) { |
  | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=2848338#L444) | […](/browser/wc-multivendor-marketplace/trunk/includes/wcfm-stripe/class-wcfm-stripe-helper.php?rev=3000763#L480) |  |
  | 444 | 480 | global $wpdb; |
  | 445 | 481 |  |
  | 446 |  | $order\_id = $wpdb->get\_var( $wpdb->prepare( "SELECT DISTINCT ID FROM $wpdb->posts as posts LEFT JOIN $wpdb->postmeta as meta ON posts.ID = meta.post\_id WHERE meta.meta\_value = %s AND meta.meta\_key = %s", $intent\_id, '\_stripe\_intent\_id' ) ); |
  |  | 482 | if ( class\_exists( 'Automattic\WooCommerce\Utilities\OrderUtil' ) && OrderUtil::custom\_orders\_table\_usage\_is\_enabled() ) { |
  |  | 483 | $orders   = wc\_get\_orders( |
  |  | 484 | [ |
  |  | 485 | 'limit'      => 1, |
  |  | 486 | 'meta\_query' => [ |
  |  | 487 | [ |
  |  | 488 | 'key'   => '\_stripe\_intent\_id', |
  |  | 489 | 'value' => $intent\_id, |
  |  | 490 | ], |
  |  | 491 | ], |
  |  | 492 | ] |
  |  | 493 | ); |
  |  | 494 | $order\_id = current( $orders ) ? current( $orders )->get\_id() : false; |
  |  | 495 | } else { |
  |  | 496 | $order\_id = $wpdb->get\_var( $wpdb->prepare( "SELECT DISTINCT ID FROM $wpdb->posts as posts LEFT JOIN $wpdb->postmeta as meta ON posts.ID = meta.post\_id WHERE meta.meta\_value = %s AND meta.meta\_key = %s", $intent\_id, '\_stripe\_intent\_id' ) ); |
  |  | 497 | } |
  | 447 | 498 |  |
  | 448 | 499 | if ( ! empty( $order\_id ) ) { |
* ## [wc-multivendor-marketplace/trunk/readme.txt](/changeset/3000763/wc-multivendor-marketplace/trunk/readme.txt "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/readme.txt")

  | [r2974835](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=2974835#L6 "Show revision 2974835 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=3000763#L6 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.3 |
  | 7 | 7 | WC requires at least: 3.0 |
  | 8 |  | WC tested up to: 8.~~1~~.0 |
  |  | 8 | WC tested up to: 8.3.0 |
  | 9 | 9 | Requires PHP: 5.6 |
  | 10 |  | Stable tag: 3.6.~~2~~ |
  |  | 10 | Stable tag: 3.6.3 |
  | 11 | 11 | License: GPLv2 or later |
  | 12 | 12 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=2974835#L255) | […](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=3000763#L255) |  |
  | 255 | 255 |  |
  | 256 | 256 | == Changelog == |
  |  | 257 |  |
  |  | 258 | = 3.6.3 = |
  |  | 259 | \*Updated - 23/11/2023\* |
  |  | 260 |  |
  |  | 261 | \* Enhance - WooCommerce 8.3+ compatibility check added |
  |  | 262 | \* Enhance - WooComerce HPOS compatibility added |
  |  | 263 | \* Fixed   - Short code Cross site scripting(XSS) issue fixed |
  | 257 | 264 |  |
  | 258 | 265 | = 3.6.2 = |
  | […](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=2974835#L1648) | […](/browser/wc-multivendor-marketplace/trunk/readme.txt?rev=3000763#L1655) |  |
  | 1648 | 1655 | == Upgrade Notice == |
  | 1649 | 1656 |  |
  | 1650 |  | = 3.6.2 = |
  | 1651 |  | \* Enhance - WordPress 6.3+ compatibility check added |
  | 1652 |  | \* Enhance - WooCommerce 8.1+ compatibility check added |
  |  | 1657 | = 3.6.3 = |
  |  | 1658 | \* Enhance - WooCommerce 8.3+ compatibility check added |
  |  | 1659 | \* Enhance - WooComerce HPOS compatibility added |
  |  | 1660 | \* Fixed   - Short code Cross site scripting(XSS) issue fixed |
* ## [wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php](/changeset/3000763/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php")

  | [r2654703](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=2654703#L1 "Show revision 2654703 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=3000763#L1 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  | 2 | 3 | /\*\* |
  | 3 | 4 | \* The Template for displaying product list. |
  | […](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=2654703#L9) | […](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=3000763#L10) |  |
  | 9 | 10 | \*/ |
  | 10 | 11 |  |
  | 11 |  | if (~~! defined( 'ABSPATH' )~~ ) exit; // Exit if accessed directly |
  |  | 12 | if (!defined('ABSPATH')) exit; // Exit if accessed directly |
  | 12 | 13 |  |
  | 13 | 14 | global $WCFM, $WCFMmp, $post; |
  | 14 | 15 |  |
  | 15 |  | $api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  | 16 |  | $wcfm\_map\_lib = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
  | 17 |  | if( !$wcfm\_map\_lib && $api\_key ) { $wcfm\_map\_lib = 'google'; } elseif( !$wcfm\_map\_lib && !$api\_key ) { $wcfm\_map\_lib = 'leaftlet'; } |
  | 18 |  | if ( ($wcfm\_map\_lib == 'google') && !$api\_key ) return; |
  | 19 |  | if( !apply\_filters( 'wcfmmp\_is\_allow\_product\_list\_map', true ) ) return; |
  |  | 16 | $api\_key = isset($WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api']) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
  |  | 17 | $wcfm\_map\_lib = isset($WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib']) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
  |  | 18 | if (!$wcfm\_map\_lib && $api\_key) { |
  |  | 19 | $wcfm\_map\_lib = 'google'; |
  |  | 20 | } elseif (!$wcfm\_map\_lib && !$api\_key) { |
  |  | 21 | $wcfm\_map\_lib = 'leaftlet'; |
  |  | 22 | } |
  |  | 23 | if (($wcfm\_map\_lib == 'google') && !$api\_key) return; |
  |  | 24 | if (!apply\_filters('wcfmmp\_is\_allow\_product\_list\_map', true)) return; |
  | 20 | 25 | ?> |
  | 21 | 26 |  |
  | […](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=2654703#L23) | […](/browser/wc-multivendor-marketplace/trunk/views/product-geolocate/wcfmmp-view-product-lists-map.php?rev=3000763#L28) |  |
  | 23 | 28 |  |
  | 24 | 29 | <script> |
  | 25 |  | ~~$map\_zoom~~ = <?php echo absint($map\_zoom); ?>; |
  | 26 |  | ~~$auto\_zoom~~  = '<?php echo esc\_attr($auto\_zoom); ?>'; |
  | 27 |  | ~~$per\_row~~  = ''; |
  | 28 |  | $per\_page = '-1'; |
  | 29 |  | $includes ~~= '<?php echo implode(",", $includes~~ ); ?>'; |
  | 30 |  | $excludes = ''; |
  |  | 30 | $map\_zoom = <?php echo absint($map\_zoom); ?>; |
  |  | 31 | $auto\_zoom = '<?php echo esc\_attr($auto\_zoom); ?>'; |
  |  | 32 | $per\_row = ''; |
  |  | 33 | $per\_page = '-1'; |
  |  | 34 | $includes = '<?php echo esc\_attr(implode(",", $includes)); ?>'; |
  |  | 35 | $excludes = ''; |
  | 31 | 36 | $has\_product = 'yes'; |
  | 32 |  | $sidebar = 'no'; |
  |  | 37 | $sidebar = 'no'; |
  | 33 | 38 | $has\_orderby = ''; |
  | 34 |  | $theme = ''; |
  |  | 39 | $theme = ''; |
  | 35 | 40 | </script> |
* ## [wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists-map.php](/changeset/3000763/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists-map.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists-map.php")

  | [r2851929](/browser/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists-map.php?rev=2851929#L28 "Show revision 2851929 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists-map.php?rev=3000763#L28 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 28 | 28 | $per\_row     = '<?php echo esc\_attr($per\_row); ?>'; |
  | 29 | 29 | $per\_page    = '<?php echo esc\_attr($limit); ?>'; |
  | 30 |  | $includes    = '<?php echo ~~implode(",", $includes~~ ); ?>'; |
  |  | 30 | $includes    = '<?php echo esc\_attr(implode(",", $includes )); ?>'; |
  | 31 | 31 | $excludes    = '<?php echo esc\_attr($excludes); ?>'; |
  | 32 | 32 | $has\_product = '<?php echo esc\_attr($has\_product); ?>'; |
* ## [wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists.php](/changeset/3000763/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists.php")

  | [r2851929](/browser/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists.php?rev=2851929#L205 "Show revision 2851929 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/views/store-lists/wcfmmp-view-store-lists.php?rev=3000763#L205 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 205 | 205 | $per\_row     = '<?php echo esc\_attr($per\_row); ?>'; |
  | 206 | 206 | $per\_page    = '<?php echo esc\_attr($limit); ?>'; |
  | 207 |  | $includes    = '<?php echo ~~implode(",", $includes~~ ); ?>'; |
  |  | 207 | $includes    = '<?php echo esc\_attr(implode(",", $includes )); ?>'; |
  | 208 | 208 | $excludes    = '<?php echo esc\_attr($excludes); ?>'; |
  | 209 | 209 | $has\_product = '<?php echo esc\_attr($has\_product); ?>'; |
* ## [wc-multivendor-marketplace/trunk/wc-multivendor-marketplace-config.php](/changeset/3000763/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace-config.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/wc-multivendor-marketplace-config.php")

  | [r2974835](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace-config.php?rev=2974835#L5 "Show revision 2974835 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace-config.php?rev=3000763#L5 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | define('WCFMmp\_TEXT\_DOMAIN', 'wc-multivendor-marketplace'); |
  | 6 | 6 |  |
  | 7 |  | define('WCFMmp\_VERSION', '3.6.~~2~~'); |
  |  | 7 | define('WCFMmp\_VERSION', '3.6.3'); |
  | 8 | 8 |  |
  | 9 | 9 | define('WCFMmp\_SERVER\_URL', 'https://wclovers.com'); |
* ## [wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php](/changeset/3000763/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php "Show the changeset 3000763 restricted to wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php")

  | [r2974835](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=2974835#L5 "Show revision 2974835 of this file in browser") | [r3000763](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=3000763#L5 "Show revision 3000763 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Description: Most featured and flexible marketplace solution for your e-commerce store. Simply and Smoothly. |
  | 6 | 6 | \* Author: WC Lovers |
  | 7 |  | \* Version: 3.6.~~2~~ |
  |  | 7 | \* Version: 3.6.3 |
  | 8 | 8 | \* Author URI: https://wclovers.com |
  | 9 | 9 | \* |
  | […](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=2974835#L12) | […](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=3000763#L12) |  |
  | 12 | 12 | \* |
  | 13 | 13 | \* WC requires at least: 3.0.0 |
  | 14 |  | \* WC tested up to: 8.~~1~~.0 |
  |  | 14 | \* WC tested up to: 8.3.0 |
  | 15 | 15 | \* |
  | 16 | 16 | \*/ |
  | […](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=2974835#L40) | […](/browser/wc-multivendor-marketplace/trunk/wc-multivendor-marketplace.php?rev=3000763#L40) |  |
  | 40 | 40 | // Deactivation Hooks |
  | 41 | 41 | register\_deactivation\_hook( \_\_FILE\_\_, array('wcfmmp', 'deactivate\_wcfmmp') ); |
  |  | 42 |  |
  |  | 43 | /\*\* |
  |  | 44 | \*  Declaring WooCommerce High-Performance Order Storage(HPOS) compatibility |
  |  | 45 | \*/ |
  |  | 46 | add\_action( 'before\_woocommerce\_init', function() { |
  |  | 47 | if ( class\_exists( \Automattic\WooCommerce\Utilities\FeaturesUtil::class ) ) { |
  |  | 48 | \Automattic\WooCommerce\Utilities\FeaturesUtil::declare\_compatibility( 'custom\_order\_tables', \_\_FILE\_\_, true ); |
  |  | 49 | } |
  |  | 50 | } ); |
  | 42 | 51 | } |
  | 43 | 52 | ?> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3000763)
* [Zip Archive](?format=zip&new=3000763)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_fe71049f_20250115_102224.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwc-multivendor-marketplace%2Ftags%2F3.6.1%2Fcore%2Fclass-wcfmmp-shortcode.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php)

---

# [source:](/browser?order=name "Go to repository root") [wc-multivendor-marketplace](/browser/wc-multivendor-marketplace?order=name "View wc-multivendor-marketplace")/[tags](/browser/wc-multivendor-marketplace/tags?order=name "View tags")/[3.6.1](/browser/wc-multivendor-marketplace/tags/3.6.1?order=name "View 3.6.1")/[core](/browser/wc-multivendor-marketplace/tags/3.6.1/core?order=name "View core")/[class-wcfmmp-shortcode.php](/browser/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php?order=name "View class-wcfmmp-shortcode.php")

View diff against:

View revision:

| [Last change](/changeset/2939091/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php "View differences") on this file was [2939091](/changeset/2939091/ "View changeset 2939091"), checked in by wclovers, [18 months ago](/timeline?from=2023-07-16T07%3A05%3A07Z&precision=second "See timeline at 07/16/2023 07:05:07 AM") |
| --- |
| WCFM Marketplace 3.6.1 version update |
| **File size:** 51.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* WCFM Marketplace plugin core |
| [4](#L4) | \* |
| [5](#L5) | \* Plugin shortcode |
| [6](#L6) | \* |
| [7](#L7) | \* @author              WC Lovers |
| [8](#L8) | \* @package     wcfmmp/core |
| [9](#L9) | \* @version   1.0.0 |
| [10](#L10) | \*/ |
| [11](#L11) |  |
| [12](#L12) | class WCFMmp\_Shortcode { |
| [13](#L13) |  |
| [14](#L14) | public $list\_product; |
| [15](#L15) |  |
| [16](#L16) | public function \_\_construct() { |
| [17](#L17) |  |
| [18](#L18) | // WCFM Markeptlace Store List |
| [19](#L19) | add\_shortcode('wcfm\_stores', array(&$this, 'wcfmmp\_stores\_shortcode')); |
| [20](#L20) |  |
| [21](#L21) | // WCFM Markeptlace Store List Map |
| [22](#L22) | add\_shortcode('wcfm\_stores\_map', array(&$this, 'wcfmmp\_stores\_map\_shortcode')); |
| [23](#L23) |  |
| [24](#L24) | // WCFM Marketplace Store Carousel |
| [25](#L25) | add\_shortcode('wcfm\_stores\_carousel', array(&$this, 'wcfmmp\_stores\_carousel\_shortcode')); |
| [26](#L26) |  |
| [27](#L27) | // WCFM Markeplace Store Sold By |
| [28](#L28) | add\_shortcode('wcfm\_store\_sold\_by', array(&$this, 'wcfmmp\_store\_sold\_by\_shortcode')); |
| [29](#L29) |  |
| [30](#L30) | // WCFM Markeplace Store Info |
| [31](#L31) | add\_shortcode('wcfm\_store\_info', array(&$this, 'wcfmmp\_store\_info\_shortcode')); |
| [32](#L32) |  |
| [33](#L33) | // WCFM Markeplace Store Hours |
| [34](#L34) | add\_shortcode('wcfm\_store\_hours', array(&$this, 'wcfmmp\_store\_hours\_shortcode')); |
| [35](#L35) |  |
| [36](#L36) | // WCFM Markeplace Shipping Time |
| [37](#L37) | add\_shortcode('wcfm\_shipping\_time', array(&$this, 'wcfmmp\_shipping\_time\_shortcode')); |
| [38](#L38) |  |
| [39](#L39) | // WCFM Markeplace More Offers |
| [40](#L40) | add\_shortcode('wcfm\_more\_offers', array(&$this, 'wcfmmp\_more\_offers\_shortcode')); |
| [41](#L41) |  |
| [42](#L42) | // WCFM Marketplace Store FB Widget |
| [43](#L43) | add\_shortcode('wcfm\_store\_fb\_feed', array(&$this, 'wcfmmp\_store\_fb\_widget\_shortcode')); |
| [44](#L44) |  |
| [45](#L45) | // WCFM Marketplace Store Twitter Widget |
| [46](#L46) | add\_shortcode('wcfm\_store\_twitter\_feed', array(&$this, 'wcfmmp\_store\_twitter\_widget\_shortcode')); |
| [47](#L47) |  |
| [48](#L48) | // WCFM Marketplace Store Instagram Widget |
| [49](#L49) | //add\_shortcode('wcfm\_store\_instagram\_feed', array(&$this, 'wcfmmp\_store\_instagram\_widget\_shortcode')); |
| [50](#L50) |  |
| [51](#L51) | // Product List Vendor Filter |
| [52](#L52) | add\_shortcode('wcfm\_products\_store\_filter', array(&$this, 'wcfmmp\_products\_store\_filter\_shortcode')); |
| [53](#L53) | } |
| [54](#L54) |  |
| [55](#L55) | /\*\* |
| [56](#L56) | \* WCFM Stores Short Code |
| [57](#L57) | \*/ |
| [58](#L58) | public function wcfmmp\_stores\_shortcode( $atts ) { |
| [59](#L59) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $includes; |
| [60](#L60) | $WCFM->nocache(); |
| [61](#L61) |  |
| [62](#L62) | $defaults = array( |
| [63](#L63) | 'per\_page'              => 12, |
| [64](#L64) | 'sidebar'               => 'yes', |
| [65](#L65) | 'orderby'               => 'newness\_asc', |
| [66](#L66) | 'filter'                => 'yes', |
| [67](#L67) | 'search'                => 'yes', |
| [68](#L68) | 'category'              => 'yes', |
| [69](#L69) | 'country'               => 'yes', |
| [70](#L70) | 'state'                 => 'yes', |
| [71](#L71) | 'radius'                => 'yes', |
| [72](#L72) | 'map'                   => 'yes', |
| [73](#L73) | 'map\_zoom'              => 5, |
| [74](#L74) | 'auto\_zoom'             => 'yes', |
| [75](#L75) | 'per\_row'               => 3, |
| [76](#L76) | 'includes'              => '', |
| [77](#L77) | 'excludes'              => '', |
| [78](#L78) | 'include\_membership'    => '', |
| [79](#L79) | 'exclude\_membership'    => '', |
| [80](#L80) | 'search\_term'           => '', |
| [81](#L81) | 'search\_country'        => '', |
| [82](#L82) | 'search\_state'          => '', |
| [83](#L83) | 'search\_city'           => '', |
| [84](#L84) | 'search\_zip'            => '', |
| [85](#L85) | 'search\_category'       => '', |
| [86](#L86) | 'search\_radius\_range'   => '', |
| [87](#L87) | 'search\_radius\_lat'     => '', |
| [88](#L88) | 'search\_radius\_lng'     => '', |
| [89](#L89) | 'store\_category'        => '', |
| [90](#L90) | 'theme'                 => 'classic', |
| [91](#L91) | 'has\_orderby'           => 'yes', |
| [92](#L92) | 'has\_product'           => 'no', |
| [93](#L93) | 'has\_sidebar'           => 'yes', |
| [94](#L94) | 'has\_filter'            => 'yes', |
| [95](#L95) | 'has\_search'            => 'yes', |
| [96](#L96) | 'has\_category'          => 'yes', |
| [97](#L97) | 'has\_country'           => 'yes', |
| [98](#L98) | 'has\_state'             => 'yes', |
| [99](#L99) | 'has\_city'              => 'no', |
| [100](#L100) | 'has\_zip'               => 'no', |
| [101](#L101) | 'has\_radius'            => 'yes', |
| [102](#L102) | 'has\_map'               => 'yes', |
| [103](#L103) | ); |
| [104](#L104) |  |
| [105](#L105) | $attr   = shortcode\_atts( apply\_filters( 'wcfmmp\_stores\_default\_args', $defaults ), $atts ); |
| [106](#L106) | $paged  = max( 1, get\_query\_var( 'paged' ) ); |
| [107](#L107) | $length = apply\_filters( 'wcfmmp\_stores\_per\_page', $attr['per\_page'] ); |
| [108](#L108) | $offset = ( $paged - 1 ) \* absint( $length ); |
| [109](#L109) |  |
| [110](#L110) | $search\_country = isset( $attr['search\_country'] ) ? $attr['search\_country'] : ''; |
| [111](#L111) | $search\_state   = isset( $attr['search\_state'] ) ? $attr['search\_state'] : ''; |
| [112](#L112) |  |
| [113](#L113) | // GEO Locate Support |
| [114](#L114) | if( apply\_filters( 'wcfmmp\_is\_allow\_store\_list\_by\_user\_location', true ) ) { |
| [115](#L115) | if( is\_user\_logged\_in() && !$search\_country ) { |
| [116](#L116) | $user\_location = get\_user\_meta( get\_current\_user\_id(), 'wcfm\_user\_location', true ); |
| [117](#L117) | if( $user\_location ) { |
| [118](#L118) | $search\_country = $user\_location['country']; |
| [119](#L119) | $search\_state   = $user\_location['state']; |
| [120](#L120) | } |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | if( apply\_filters( 'wcfm\_is\_allow\_wc\_geolocate', true ) && class\_exists( 'WC\_Geolocation' ) && !$search\_country ) { |
| [124](#L124) | $user\_location = WC\_Geolocation::geolocate\_ip(); |
| [125](#L125) | $search\_country = $user\_location['country']; |
| [126](#L126) | $search\_state   = $user\_location['state']; |
| [127](#L127) | } |
| [128](#L128) | } |
| [129](#L129) |  |
| [130](#L130) | $orderby          = isset( $\_GET['orderby'] ) ? sanitize\_sql\_orderby( $\_GET['orderby'] ) : apply\_filters( 'wcfmmp\_stores\_default\_orderby', $attr['orderby'] ); |
| [131](#L131) | $search\_term      = isset( $\_GET['wcfmmp\_store\_search'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_search'] ) : $attr['search\_term']; |
| [132](#L132) |  |
| [133](#L133) | $search\_country   = isset( $\_GET['wcfmmp\_store\_country'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_country'] ) : ''; |
| [134](#L134) | $search\_state     = isset( $\_GET['wcfmmp\_store\_state'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_state'] ) : ''; |
| [135](#L135) | $search\_city      = isset( $\_GET['wcfmmp\_store\_city'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_city'] ) : $attr['search\_city']; |
| [136](#L136) | $search\_zip       = isset( $\_GET['wcfmmp\_store\_zip'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_zip'] ) : $attr['search\_zip']; |
| [137](#L137) |  |
| [138](#L138) | $search\_category  = isset( $\_GET['wcfmmp\_store\_category'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_category'] ) : $attr['search\_category']; |
| [139](#L139) | $store\_category   = isset( $\_GET['wcfmsc\_store\_categories'] ) ? sanitize\_text\_field( $\_GET['wcfmsc\_store\_categories'] ) : $attr['store\_category']; |
| [140](#L140) |  |
| [141](#L141) | $search\_radius\_range    = isset( $\_GET['wcfmmp\_radius\_range'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_range'] ) : $attr['search\_radius\_range']; |
| [142](#L142) | $search\_radius\_lat      = isset( $\_GET['wcfmmp\_radius\_lat'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_lat'] ) : $attr['search\_radius\_lat']; |
| [143](#L143) | $search\_radius\_lng              = isset( $\_GET['wcfmmp\_radius\_lng'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_lng'] ) : $attr['search\_radius\_lng']; |
| [144](#L144) |  |
| [145](#L145) | $search\_category  = apply\_filters( 'wcfmmp\_stores\_default\_search\_category', $search\_category ); |
| [146](#L146) | $has\_product      = apply\_filters( 'wcfmmp\_stores\_list\_has\_product', wc\_string\_to\_bool( $attr['has\_product'] ) ); |
| [147](#L147) |  |
| [148](#L148) | $has\_sidebar      = isset( $attr['sidebar'] ) ? $attr['sidebar'] : 'yes'; |
| [149](#L149) | $has\_sidebar      = isset( $attr['has\_sidebar'] ) ? $attr['has\_sidebar'] : $has\_sidebar; |
| [150](#L150) |  |
| [151](#L151) | $has\_filter       = isset( $attr['filter'] ) ? $attr['filter'] : 'yes'; |
| [152](#L152) | $has\_filter       = isset( $attr['has\_filter'] ) ? $attr['has\_filter'] : $has\_filter; |
| [153](#L153) |  |
| [154](#L154) | $has\_search       = isset( $attr['search'] ) ? $attr['search'] : 'yes'; |
| [155](#L155) | $has\_search       = isset( $attr['has\_search'] ) ? $attr['has\_search'] : $has\_search; |
| [156](#L156) |  |
| [157](#L157) | $has\_category     = isset( $attr['category'] ) ? $attr['category'] : 'yes'; |
| [158](#L158) | $has\_category     = isset( $attr['has\_category'] ) ? $attr['has\_category'] : $has\_category; |
| [159](#L159) |  |
| [160](#L160) | $has\_country      = isset( $attr['country'] ) ? $attr['country'] : 'yes'; |
| [161](#L161) | $has\_country      = isset( $attr['has\_country'] ) ? $attr['has\_country'] : $has\_country; |
| [162](#L162) |  |
| [163](#L163) | $has\_state        = isset( $attr['state'] ) ? $attr['state'] : 'yes'; |
| [164](#L164) | $has\_state        = isset( $attr['has\_state'] ) ? $attr['has\_state'] : $has\_state; |
| [165](#L165) |  |
| [166](#L166) | $has\_city         = isset( $attr['has\_city'] ) ? $attr['has\_city'] : 'no'; |
| [167](#L167) |  |
| [168](#L168) | $has\_zip          = isset( $attr['has\_zip'] ) ? $attr['has\_zip'] : 'no'; |
| [169](#L169) |  |
| [170](#L170) | $has\_radius       = isset( $attr['radius'] ) ? $attr['radius'] : 'yes'; |
| [171](#L171) | $has\_radius       = isset( $attr['has\_radius'] ) ? $attr['has\_radius'] : $has\_radius; |
| [172](#L172) |  |
| [173](#L173) | $has\_map          = isset( $attr['map'] ) ? $attr['map'] : 'yes'; |
| [174](#L174) | $has\_map          = isset( $attr['has\_map'] ) ? $attr['has\_map'] : $has\_map; |
| [175](#L175) |  |
| [176](#L176) | $search\_data     = array(); |
| [177](#L177) | if( $store\_category ) { |
| [178](#L178) | $search\_data['wcfmsc\_store\_categories'] = $store\_category; |
| [179](#L179) | } |
| [180](#L180) | if( $search\_country ) { |
| [181](#L181) | $search\_data['wcfmmp\_store\_country'] = $search\_country; |
| [182](#L182) | } |
| [183](#L183) | if( $search\_state ) { |
| [184](#L184) | $search\_data['wcfmmp\_store\_state'] = $search\_state; |
| [185](#L185) | } |
| [186](#L186) | if( $search\_city ) { |
| [187](#L187) | $search\_data['wcfmmp\_store\_city'] = $search\_city; |
| [188](#L188) | } |
| [189](#L189) | if( $search\_zip ) { |
| [190](#L190) | $search\_data['wcfmmp\_store\_zip'] = $search\_zip; |
| [191](#L191) | } |
| [192](#L192) | if( $search\_radius\_range ) { |
| [193](#L193) | $search\_data['wcfmmp\_radius\_range'] = $search\_radius\_range; |
| [194](#L194) | } |
| [195](#L195) | if( $search\_radius\_lat ) { |
| [196](#L196) | $search\_data['wcfmmp\_radius\_lat'] = $search\_radius\_lat; |
| [197](#L197) | } |
| [198](#L198) | if( $search\_radius\_lng ) { |
| [199](#L199) | $search\_data['wcfmmp\_radius\_lng'] = $search\_radius\_lng; |
| [200](#L200) | } |
| [201](#L201) | if( isset( $\_POST['search\_data'] ) ) { |
| [202](#L202) | parse\_str($\_POST['search\_data'], $search\_data); |
| [203](#L203) | $search\_data = wc\_clean( wp\_unslash( $search\_data ) ); |
| [204](#L204) | } elseif( isset( $\_GET['orderby'] ) ) { |
| [205](#L205) | $search\_data = wc\_clean( wp\_unslash($\_GET) ); |
| [206](#L206) | } else { |
| [207](#L207) | $search\_data['orderby'] = $orderby; |
| [208](#L208) | } |
| [209](#L209) |  |
| [210](#L210) | // Exclude Membership |
| [211](#L211) | $exclude\_members = array(); |
| [212](#L212) | $exclude\_membership = isset( $attr['exclude\_membership'] ) ? sanitize\_text\_field( $attr['exclude\_membership'] ) : ''; |
| [213](#L213) | if( $exclude\_membership ) $exclude\_membership = explode(",", $exclude\_membership); |
| [214](#L214) | if( !empty( $exclude\_membership ) && is\_array( $exclude\_membership ) ) { |
| [215](#L215) | foreach( $exclude\_membership as $wcfm\_membership ) { |
| [216](#L216) | $membership\_users = (array) get\_post\_meta( $wcfm\_membership, 'membership\_users', true ); |
| [217](#L217) | $exclude\_members  = array\_merge( $exclude\_members, $membership\_users ); |
| [218](#L218) | } |
| [219](#L219) | } |
| [220](#L220) | if( $exclude\_members ) $exclude\_members = implode(",", $exclude\_members); |
| [221](#L221) | else $exclude\_members = ''; |
| [222](#L222) |  |
| [223](#L223) | // Excluded Stores from List |
| [224](#L224) | $excludes = !empty( $attr['excludes'] ) ? sanitize\_text\_field( $attr['excludes'] ) : $exclude\_members; |
| [225](#L225) | $search\_data['excludes'] = $excludes; |
| [226](#L226) |  |
| [227](#L227) | // Include Membership |
| [228](#L228) | $include\_members = array(); |
| [229](#L229) | $include\_membership = isset( $attr['include\_membership'] ) ? sanitize\_text\_field( $attr['include\_membership'] ) : ''; |
| [230](#L230) | if( $include\_membership ) $include\_membership = explode(",", $include\_membership); |
| [231](#L231) | if( !empty( $include\_membership ) && is\_array( $include\_membership ) ) { |
| [232](#L232) | foreach( $include\_membership as $wcfm\_membership ) { |
| [233](#L233) | $membership\_users = (array) get\_post\_meta( $wcfm\_membership, 'membership\_users', true ); |
| [234](#L234) | $include\_members  = array\_merge( $include\_members, $membership\_users ); |
| [235](#L235) | } |
| [236](#L236) | } |
| [237](#L237) | if( $include\_members ) $include\_members = implode(",", $include\_members); |
| [238](#L238) | else $include\_members = ''; |
| [239](#L239) |  |
| [240](#L240) | // Include Store List |
| [241](#L241) | $includes = !empty( $attr['includes'] ) ? sanitize\_text\_field( $attr['includes'] ) : $include\_members; |
| [242](#L242) | if( $includes ) $includes = explode(",", $includes); |
| [243](#L243) | else $includes = array(); |
| [244](#L244) |  |
| [245](#L245) | // Radious Search |
| [246](#L246) | $enable\_wcfm\_storelist\_radius  = isset( $WCFMmp->wcfmmp\_marketplace\_options['enable\_wcfm\_storelist\_radius'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['enable\_wcfm\_storelist\_radius'] : 'no'; |
| [247](#L247) | $has\_radius = wc\_string\_to\_bool( $has\_radius); |
| [248](#L248) | if( ( $enable\_wcfm\_storelist\_radius == 'yes' ) && $has\_radius ) $has\_radius = true; |
| [249](#L249) | else $has\_radius = false; |
| [250](#L250) | $api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
| [251](#L251) | $wcfm\_map\_lib = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
| [252](#L252) | if( !$wcfm\_map\_lib && $api\_key ) { $wcfm\_map\_lib = 'google'; } elseif( !$wcfm\_map\_lib && !$api\_key ) { $wcfm\_map\_lib = 'leaftlet'; } |
| [253](#L253) | if ( ($wcfm\_map\_lib == 'google') && empty( $api\_key ) ) $has\_radius = false; |
| [254](#L254) | if( $has\_radius ) { |
| [255](#L255) | $has\_country = 'no'; |
| [256](#L256) | $has\_state   = 'no'; |
| [257](#L257) | $has\_city    = 'no'; |
| [258](#L258) | $has\_zipcode = 'no'; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $search\_data = apply\_filters( 'wcfmmp\_stores\_search\_data', $search\_data ); |
| [262](#L262) |  |
| [263](#L263) | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_search\_vendor\_list( true, $offset, $length, $search\_term, $search\_category, $search\_data, $has\_product, $includes ); |
| [264](#L264) |  |
| [265](#L265) | $template\_args = apply\_filters( 'wcfmmp\_stores\_args', array( |
| [266](#L266) | 'stores'                        => $stores, |
| [267](#L267) | 'limit'                         => $length, |
| [268](#L268) | 'offset'                        => $offset, |
| [269](#L269) | 'includes'                      => $includes, |
| [270](#L270) | 'excludes'                      => $excludes, |
| [271](#L271) | 'paged'                         => $paged, |
| [272](#L272) | 'image\_size'                    => 'full', |
| [273](#L273) | 'orderby'                       => $orderby, |
| [274](#L274) | 'search\_term'                   => $search\_term, |
| [275](#L275) | 'search\_country'                => $search\_country, |
| [276](#L276) | 'search\_state'                  => $search\_state, |
| [277](#L277) | 'search\_city'                   => $search\_city, |
| [278](#L278) | 'search\_zip'                    => $search\_zip, |
| [279](#L279) | 'search\_category'               => $search\_category, |
| [280](#L280) | 'store\_category'                => $store\_category, |
| [281](#L281) | 'search\_radius\_range'   => $search\_radius\_range, |
| [282](#L282) | 'search\_radius\_lat'     => $search\_radius\_lat, |
| [283](#L283) | 'search\_radius\_lng'     => $search\_radius\_lng, |
| [284](#L284) | 'search\_data'                   => $search\_data, |
| [285](#L285) | 'has\_product'                   => $has\_product, |
| [286](#L286) | 'has\_orderby'                   => wc\_string\_to\_bool( $attr['has\_orderby'] ), |
| [287](#L287) | 'sidebar'                       => wc\_string\_to\_bool( $has\_sidebar ), |
| [288](#L288) | 'filter'                        => wc\_string\_to\_bool( $has\_filter ), |
| [289](#L289) | 'search'                        => wc\_string\_to\_bool( $has\_search ), |
| [290](#L290) | 'category'                      => wc\_string\_to\_bool( $has\_category ), |
| [291](#L291) | 'country'                       => wc\_string\_to\_bool( $has\_country ), |
| [292](#L292) | 'state'                         => wc\_string\_to\_bool( $has\_state ), |
| [293](#L293) | 'has\_city'                      => wc\_string\_to\_bool( $has\_city ), |
| [294](#L294) | 'has\_zip'                       => wc\_string\_to\_bool( $has\_zip ), |
| [295](#L295) | 'map'                           => wc\_string\_to\_bool( $has\_map ), |
| [296](#L296) | 'radius'                        => $has\_radius, |
| [297](#L297) | 'map\_zoom'                      => apply\_filters( 'wcfmmp\_map\_default\_zoom\_level', $attr['map\_zoom'] ), |
| [298](#L298) | 'auto\_zoom'                     => wc\_string\_to\_bool( apply\_filters( 'wcfmmp\_is\_allow\_map\_auto\_zoom', $attr['auto\_zoom'] ) ), |
| [299](#L299) | 'per\_row'                       => $attr['per\_row'], |
| [300](#L300) | 'theme'                         => $attr['theme'] |
| [301](#L301) | ), $attr, $search\_data ); |
| [302](#L302) |  |
| [303](#L303) | ob\_start(); |
| [304](#L304) | $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists.php', $template\_args ); |
| [305](#L305) | return ob\_get\_clean(); |
| [306](#L306) | } |
| [307](#L307) |  |
| [308](#L308) | /\*\* |
| [309](#L309) | \* WCFM Stores Map Short Code |
| [310](#L310) | \*/ |
| [311](#L311) | public function wcfmmp\_stores\_map\_shortcode( $atts ) { |
| [312](#L312) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query; |
| [313](#L313) | $WCFM->nocache(); |
| [314](#L314) |  |
| [315](#L315) | $defaults = array( |
| [316](#L316) | 'filter'                => 'yes', |
| [317](#L317) | 'search'                => 'yes', |
| [318](#L318) | 'category'              => 'yes', |
| [319](#L319) | 'country'               => 'yes', |
| [320](#L320) | 'state'                 => 'yes', |
| [321](#L321) | 'radius'                => 'yes', |
| [322](#L322) | 'map'                   => 'yes', |
| [323](#L323) | 'map\_zoom'              => 5, |
| [324](#L324) | 'auto\_zoom'             => 'yes', |
| [325](#L325) | 'limit'                 => 10, |
| [326](#L326) | 'per\_row'               => 3, |
| [327](#L327) | 'includes'              => '', |
| [328](#L328) | 'excludes'              => '', |
| [329](#L329) | 'include\_membership'    => '', |
| [330](#L330) | 'exclude\_membership'    => '', |
| [331](#L331) | 'search\_term'           => '', |
| [332](#L332) | 'search\_city'           => '', |
| [333](#L333) | 'search\_zip'            => '', |
| [334](#L334) | 'search\_category'       => '', |
| [335](#L335) | 'search\_radius\_range'   => '', |
| [336](#L336) | 'search\_radius\_lat'     => '', |
| [337](#L337) | 'search\_radius\_lng'     => '', |
| [338](#L338) | 'store\_category'        => '', |
| [339](#L339) | 'theme'                 => 'classic', |
| [340](#L340) | 'has\_product'           => 'no', |
| [341](#L341) | 'has\_sidebar'           => 'yes', |
| [342](#L342) | 'has\_filter'            => 'yes', |
| [343](#L343) | 'has\_search'            => 'yes', |
| [344](#L344) | 'has\_category'          => 'yes', |
| [345](#L345) | 'has\_country'           => 'yes', |
| [346](#L346) | 'has\_state'             => 'yes', |
| [347](#L347) | 'has\_city'              => 'no', |
| [348](#L348) | 'has\_zip'               => 'no', |
| [349](#L349) | 'has\_radius'            => 'yes', |
| [350](#L350) | 'has\_map'               => 'yes', |
| [351](#L351) | ); |
| [352](#L352) |  |
| [353](#L353) | $attr   = shortcode\_atts( apply\_filters( 'wcfmmp\_stores\_map\_default\_args', $defaults ), $atts ); |
| [354](#L354) |  |
| [355](#L355) | $search\_term      = isset( $\_GET['wcfmmp\_store\_search'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_search'] ) : $attr['search\_term']; |
| [356](#L356) |  |
| [357](#L357) | $search\_country   = isset( $\_GET['wcfmmp\_store\_country'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_country'] ) : ''; |
| [358](#L358) | $search\_state     = isset( $\_GET['wcfmmp\_store\_state'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_state'] ) : ''; |
| [359](#L359) | $search\_city      = isset( $\_GET['wcfmmp\_store\_city'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_city'] ) : $attr['search\_city']; |
| [360](#L360) | $search\_zip       = isset( $\_GET['wcfmmp\_store\_zip'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_zip'] ) : $attr['search\_zip']; |
| [361](#L361) |  |
| [362](#L362) | $search\_category  = isset( $\_GET['wcfmmp\_store\_category'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_category'] ) : $attr['search\_category']; |
| [363](#L363) | $store\_category   = isset( $\_GET['wcfmsc\_store\_categories'] ) ? sanitize\_text\_field( $\_GET['wcfmsc\_store\_categories'] ) : $attr['store\_category']; |
| [364](#L364) |  |
| [365](#L365) | $search\_radius\_range    = isset( $\_GET['wcfmmp\_radius\_range'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_range'] ) : $attr['search\_radius\_range']; |
| [366](#L366) | $search\_radius\_lat      = isset( $\_GET['wcfmmp\_radius\_lat'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_lat'] ) : $attr['search\_radius\_lat']; |
| [367](#L367) | $search\_radius\_lng              = isset( $\_GET['wcfmmp\_radius\_lng'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_radius\_lng'] ) : $attr['search\_radius\_lng']; |
| [368](#L368) |  |
| [369](#L369) | $has\_product      = apply\_filters( 'wcfmmp\_stores\_list\_has\_product', wc\_string\_to\_bool( $attr['has\_product'] ) ); |
| [370](#L370) |  |
| [371](#L371) | $has\_filter       = isset( $attr['filter'] ) ? $attr['filter'] : 'yes'; |
| [372](#L372) | $has\_filter       = isset( $attr['has\_filter'] ) ? $attr['has\_filter'] : $has\_filter; |
| [373](#L373) |  |
| [374](#L374) | $has\_search       = isset( $attr['search'] ) ? $attr['search'] : 'yes'; |
| [375](#L375) | $has\_search       = isset( $attr['has\_search'] ) ? $attr['has\_search'] : $has\_search; |
| [376](#L376) |  |
| [377](#L377) | $has\_category     = isset( $attr['category'] ) ? $attr['category'] : 'yes'; |
| [378](#L378) | $has\_category     = isset( $attr['has\_category'] ) ? $attr['has\_category'] : $has\_category; |
| [379](#L379) |  |
| [380](#L380) | $has\_country      = isset( $attr['country'] ) ? $attr['country'] : 'yes'; |
| [381](#L381) | $has\_country      = isset( $attr['has\_country'] ) ? $attr['has\_country'] : $has\_country; |
| [382](#L382) |  |
| [383](#L383) | $has\_state        = isset( $attr['state'] ) ? $attr['state'] : 'yes'; |
| [384](#L384) | $has\_state        = isset( $attr['has\_state'] ) ? $attr['has\_state'] : $has\_state; |
| [385](#L385) |  |
| [386](#L386) | $has\_city         = isset( $attr['has\_city'] ) ? $attr['has\_city'] : 'no'; |
| [387](#L387) |  |
| [388](#L388) | $has\_zip          = isset( $attr['has\_zip'] ) ? $attr['has\_zip'] : 'no'; |
| [389](#L389) |  |
| [390](#L390) | $has\_radius       = isset( $attr['radius'] ) ? $attr['radius'] : 'yes'; |
| [391](#L391) | $has\_radius       = isset( $attr['has\_radius'] ) ? $attr['has\_radius'] : $has\_radius; |
| [392](#L392) |  |
| [393](#L393) | $has\_map          = isset( $attr['map'] ) ? $attr['map'] : 'yes'; |
| [394](#L394) | $has\_map          = isset( $attr['has\_map'] ) ? $attr['has\_map'] : $has\_map; |
| [395](#L395) |  |
| [396](#L396) | $search\_data     = array(); |
| [397](#L397) | if( $store\_category ) { |
| [398](#L398) | $search\_data['wcfmsc\_store\_categories'] = $store\_category; |
| [399](#L399) | } |
| [400](#L400) | if( $search\_country ) { |
| [401](#L401) | $search\_data['wcfmmp\_store\_country'] = $search\_country; |
| [402](#L402) | } |
| [403](#L403) | if( $search\_state ) { |
| [404](#L404) | $search\_data['wcfmmp\_store\_state'] = $search\_state; |
| [405](#L405) | } |
| [406](#L406) | if( $search\_city ) { |
| [407](#L407) | $search\_data['wcfmmp\_store\_city'] = $search\_city; |
| [408](#L408) | } |
| [409](#L409) | if( $search\_zip ) { |
| [410](#L410) | $search\_data['wcfmmp\_store\_zip'] = $search\_zip; |
| [411](#L411) | } |
| [412](#L412) | if( $search\_radius\_range ) { |
| [413](#L413) | $search\_data['wcfmmp\_radius\_range'] = $search\_radius\_range; |
| [414](#L414) | } |
| [415](#L415) | if( $search\_radius\_lat ) { |
| [416](#L416) | $search\_data['wcfmmp\_radius\_lat'] = $search\_radius\_lat; |
| [417](#L417) | } |
| [418](#L418) | if( $search\_radius\_lng ) { |
| [419](#L419) | $search\_data['wcfmmp\_radius\_lng'] = $search\_radius\_lng; |
| [420](#L420) | } |
| [421](#L421) | if( isset( $\_POST['search\_data'] ) ) { |
| [422](#L422) | parse\_str($\_POST['search\_data'], $search\_data); |
| [423](#L423) | $search\_data = wc\_clean( wp\_unslash( $search\_data ) ); |
| [424](#L424) | } |
| [425](#L425) |  |
| [426](#L426) | // Exclude Membership |
| [427](#L427) | $exclude\_members = array(); |
| [428](#L428) | $exclude\_membership = isset( $attr['exclude\_membership'] ) ? sanitize\_text\_field( $attr['exclude\_membership'] ) : ''; |
| [429](#L429) | if( $exclude\_membership ) $exclude\_membership = explode(",", $exclude\_membership); |
| [430](#L430) | if( !empty( $exclude\_membership ) && is\_array( $exclude\_membership ) ) { |
| [431](#L431) | foreach( $exclude\_membership as $wcfm\_membership ) { |
| [432](#L432) | $membership\_users = (array) get\_post\_meta( $wcfm\_membership, 'membership\_users', true ); |
| [433](#L433) | $exclude\_members  = array\_merge( $exclude\_members, $membership\_users ); |
| [434](#L434) | } |
| [435](#L435) | } |
| [436](#L436) | if( $exclude\_members ) $exclude\_members = implode(",", $exclude\_members); |
| [437](#L437) | else $exclude\_members = ''; |
| [438](#L438) |  |
| [439](#L439) | // Excluded Stores from List |
| [440](#L440) | $excludes = !empty( $attr['excludes'] ) ? sanitize\_text\_field( $attr['excludes'] ) : $exclude\_members; |
| [441](#L441) | $search\_data['excludes'] = $excludes; |
| [442](#L442) |  |
| [443](#L443) | // Include Membership |
| [444](#L444) | $include\_members = array(); |
| [445](#L445) | $include\_membership = isset( $attr['include\_membership'] ) ? sanitize\_text\_field( $attr['include\_membership'] ) : ''; |
| [446](#L446) | if( $include\_membership ) $include\_membership = explode(",", $include\_membership); |
| [447](#L447) | if( !empty( $include\_membership ) && is\_array( $include\_membership ) ) { |
| [448](#L448) | foreach( $include\_membership as $wcfm\_membership ) { |
| [449](#L449) | $membership\_users = (array) get\_post\_meta( $wcfm\_membership, 'membership\_users', true ); |
| [450](#L450) | $include\_members  = array\_merge( $include\_members, $membership\_users ); |
| [451](#L451) | } |
| [452](#L452) | } |
| [453](#L453) | if( $include\_members ) $include\_members = implode(",", $include\_members); |
| [454](#L454) | else $include\_members = ''; |
| [455](#L455) |  |
| [456](#L456) | // Include Store List |
| [457](#L457) | $includes = !empty( $attr['includes'] ) ? sanitize\_text\_field( $attr['includes'] ) : $include\_members; |
| [458](#L458) | if( $includes ) $includes = explode(",", $includes); |
| [459](#L459) | else $includes = array(); |
| [460](#L460) |  |
| [461](#L461) | $pagination\_base = ''; |
| [462](#L462) |  |
| [463](#L463) | // Radious Search |
| [464](#L464) | $enable\_wcfm\_storelist\_radius  = isset( $WCFMmp->wcfmmp\_marketplace\_options['enable\_wcfm\_storelist\_radius'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['enable\_wcfm\_storelist\_radius'] : 'no'; |
| [465](#L465) | $has\_radius = wc\_string\_to\_bool( $has\_radius); |
| [466](#L466) | if( ( $enable\_wcfm\_storelist\_radius == 'yes' ) && $has\_radius ) $has\_radius = true; |
| [467](#L467) | else $has\_radius = false; |
| [468](#L468) | $api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
| [469](#L469) | $wcfm\_map\_lib = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
| [470](#L470) | if( !$wcfm\_map\_lib && $api\_key ) { $wcfm\_map\_lib = 'google'; } elseif( !$wcfm\_map\_lib && !$api\_key ) { $wcfm\_map\_lib = 'leaftlet'; } |
| [471](#L471) | if ( ($wcfm\_map\_lib == 'google') && empty( $api\_key ) ) $has\_radius = false; |
| [472](#L472) | if( $has\_radius ) { |
| [473](#L473) | $has\_country = 'no'; |
| [474](#L474) | $has\_state   = 'no'; |
| [475](#L475) | $has\_city    = 'no'; |
| [476](#L476) | $has\_zipcode = 'no'; |
| [477](#L477) | } |
| [478](#L478) |  |
| [479](#L479) | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_search\_vendor\_list( true, '', $attr['limit'], $search\_term, $search\_category, $search\_data, $has\_product, $includes ); |
| [480](#L480) |  |
| [481](#L481) | $template\_args = apply\_filters( 'wcfmmp\_stores\_map\_args', array( |
| [482](#L482) | 'stores'                        => $stores, |
| [483](#L483) | 'offset'                        => 0, |
| [484](#L484) | 'excludes'                      => $excludes, |
| [485](#L485) | 'search\_term'                   => $search\_term, |
| [486](#L486) | 'search\_country'                => $search\_country, |
| [487](#L487) | 'search\_state'                  => $search\_state, |
| [488](#L488) | 'search\_city'                   => $search\_city, |
| [489](#L489) | 'search\_zip'                    => $search\_zip, |
| [490](#L490) | 'search\_category'               => $search\_category, |
| [491](#L491) | 'store\_category'                => $store\_category, |
| [492](#L492) | 'search\_radius\_range'   => $search\_radius\_range, |
| [493](#L493) | 'search\_radius\_lat'     => $search\_radius\_lat, |
| [494](#L494) | 'search\_radius\_lng'     => $search\_radius\_lng, |
| [495](#L495) | 'search\_data'                   => $search\_data, |
| [496](#L496) | 'pagination\_base'               => $pagination\_base, |
| [497](#L497) | 'has\_product'                   => $has\_product, |
| [498](#L498) | 'filter'                        => wc\_string\_to\_bool( $has\_filter ), |
| [499](#L499) | 'search'                        => wc\_string\_to\_bool( $has\_search ), |
| [500](#L500) | 'category'                      => wc\_string\_to\_bool( $has\_category ), |
| [501](#L501) | 'country'                       => wc\_string\_to\_bool( $has\_country ), |
| [502](#L502) | 'state'                         => wc\_string\_to\_bool( $has\_state ), |
| [503](#L503) | 'has\_city'                      => wc\_string\_to\_bool( $has\_city ), |
| [504](#L504) | 'has\_zip'                       => wc\_string\_to\_bool( $has\_zip ), |
| [505](#L505) | 'map'                           => wc\_string\_to\_bool( $has\_map ), |
| [506](#L506) | 'radius'                        => $has\_radius, |
| [507](#L507) | 'map\_zoom'                      => apply\_filters( 'wcfmmp\_map\_default\_zoom\_level', $attr['map\_zoom'] ), |
| [508](#L508) | 'auto\_zoom'                     => wc\_string\_to\_bool( apply\_filters( 'wcfmmp\_is\_allow\_map\_auto\_zoom', $attr['auto\_zoom'] ) ), |
| [509](#L509) | 'includes'                      => $includes, |
| [510](#L510) | 'per\_row'                       => $attr['per\_row'], |
| [511](#L511) | 'limit'                         => $attr['limit'], |
| [512](#L512) | 'orderby'                       => '', |
| [513](#L513) | 'has\_orderby'                   => wc\_string\_to\_bool( 'no' ), |
| [514](#L514) | 'sidebar'                       => wc\_string\_to\_bool( 'no' ), |
| [515](#L515) | 'theme'                         => 'simple' |
| [516](#L516) | ) ); |
| [517](#L517) |  |
| [518](#L518) | ob\_start(); |
| [519](#L519) | echo '<div id="wcfmmp-stores-map-wrapper">'; |
| [520](#L520) | $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-map.php', $template\_args ); |
| [521](#L521) | if( wc\_string\_to\_bool( $has\_filter ) ) { |
| [522](#L522) | if( wc\_string\_to\_bool( $has\_search ) || $has\_radius || wc\_string\_to\_bool( $has\_category ) || wc\_string\_to\_bool( $has\_country ) || wc\_string\_to\_bool( $has\_state ) || wc\_string\_to\_bool( $has\_city ) || wc\_string\_to\_bool( $has\_zip ) ) { $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-search-form.php', $template\_args ); } |
| [523](#L523) | } |
| [524](#L524) | echo '</div>'; |
| [525](#L525) | echo '<div class="wcfm-clearfix"></div>'; |
| [526](#L526) | return ob\_get\_clean(); |
| [527](#L527) | } |
| [528](#L528) |  |
| [529](#L529) |  |
| [530](#L530) | /\*\* |
| [531](#L531) | \* WCFM Stores Carousal Short Code |
| [532](#L532) | \*/ |
| [533](#L533) | public function wcfmmp\_stores\_carousel\_shortcode( $atts ) { |
| [534](#L534) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $includes; |
| [535](#L535) | $WCFM->nocache(); |
| [536](#L536) |  |
| [537](#L537) | $defaults = array( |
| [538](#L538) | 'per\_page'           => 20, |
| [539](#L539) | 'category'           => 'yes', |
| [540](#L540) | 'country'            => 'yes', |
| [541](#L541) | 'state'              => 'yes', |
| [542](#L542) | 'has\_category'       => 'yes', |
| [543](#L543) | 'has\_country'        => 'yes', |
| [544](#L544) | 'has\_state'          => 'yes', |
| [545](#L545) | 'has\_city'           => 'no', |
| [546](#L546) | 'has\_zip'            => 'no', |
| [547](#L547) | 'has\_loop'           => 'yes', |
| [548](#L548) | 'has\_autoplay'       => 'yes', |
| [549](#L549) | 'has\_nav'            => 'yes', |
| [550](#L550) | 'per\_row'            => 3, |
| [551](#L551) | 'includes'           => '', |
| [552](#L552) | 'excludes'           => '', |
| [553](#L553) | 'include\_membership' => '', |
| [554](#L554) | 'exclude\_membership' => '', |
| [555](#L555) | 'search\_term'        => '', |
| [556](#L556) | 'search\_city'        => '', |
| [557](#L557) | 'search\_zip'         => '', |
| [558](#L558) | 'search\_category'    => '', |
| [559](#L559) | 'store\_category'     => '', |
| [560](#L560) | 'has\_product'        => '', |
| [561](#L561) | 'theme'              => 'classic' |
| [562](#L562) | ); |
| [563](#L563) |  |
| [564](#L564) | $attr   = shortcode\_atts( apply\_filters( 'wcfmmp\_stores\_carousel\_default\_args', $defaults ), $atts ); |
| [565](#L565) | $paged  = max( 1, get\_query\_var( 'paged' ) ); |
| [566](#L566) | $length = apply\_filters( 'wcfmmp\_stores\_per\_page', $attr['per\_page'] ); |
| [567](#L567) | $offset = ( $paged - 1 ) \* $length; |
| [568](#L568) |  |
| [569](#L569) | $search\_country = ''; |
| [570](#L570) | $search\_state   = ''; |
| [571](#L571) |  |
| [572](#L572) | // GEO Locate Support |
| [573](#L573) | if( apply\_filters( 'wcfmmp\_is\_allow\_store\_list\_by\_user\_location', true ) ) { |
| [574](#L574) | if( is\_user\_logged\_in() && !$search\_country ) { |
| [575](#L575) | $user\_location = get\_user\_meta( get\_current\_user\_id(), 'wcfm\_user\_location', true ); |
| [576](#L576) | if( $user\_location ) { |
| [577](#L577) | $search\_country = $user\_location['country']; |
| [578](#L578) | $search\_state   = $user\_location['state']; |
| [579](#L579) | } |
| [580](#L580) | } |
| [581](#L581) |  |
| [582](#L582) | if( apply\_filters( 'wcfm\_is\_allow\_wc\_geolocate', true ) && class\_exists( 'WC\_Geolocation' ) && !$search\_country ) { |
| [583](#L583) | $user\_location = WC\_Geolocation::geolocate\_ip(); |
| [584](#L584) | $search\_country = $user\_location['country']; |
| [585](#L585) | $search\_state   = $user\_location['state']; |
| [586](#L586) | } |
| [587](#L587) | } |
| [588](#L588) |  |
| [589](#L589) | $search\_term      = isset( $\_GET['wcfmmp\_store\_search'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_search'] ) : $attr['search\_term']; |
| [590](#L590) |  |
| [591](#L591) | $search\_country   = isset( $\_GET['wcfmmp\_store\_country'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_country'] ) : $search\_country; |
| [592](#L592) | $search\_state     = isset( $\_GET['wcfmmp\_store\_state'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_state'] ) : $search\_state; |
| [593](#L593) | $search\_city      = isset( $\_GET['wcfmmp\_store\_city'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_city'] ) : $attr['search\_city']; |
| [594](#L594) | $search\_zip       = isset( $\_GET['wcfmmp\_store\_zip'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_zip'] ) : $attr['search\_zip']; |
| [595](#L595) |  |
| [596](#L596) | $search\_category  = isset( $\_GET['wcfmmp\_store\_category'] ) ? sanitize\_text\_field( $\_GET['wcfmmp\_store\_category'] ) : $attr['search\_category']; |
| [597](#L597) | $store\_category   = isset( $\_GET['wcfmsc\_store\_categories'] ) ? sanitize\_text\_field( $\_GET['wcfmsc\_store\_categories'] ) : $attr['store\_category']; |
| [598](#L598) |  |
| [599](#L599) | $search\_category  = apply\_filters( 'wcfmmp\_stores\_default\_search\_category', $search\_category ); |
| [600](#L600) | $has\_product      = apply\_filters( 'wcfmmp\_stores\_list\_has\_product', $attr['has\_product'] ); |
| [601](#L601) |  |
| [602](#L602) | $has\_category     = isset( $attr['category'] ) ? $attr['category'] : 'yes'; |
| [603](#L603) | $has\_category     = isset( $attr['has\_category'] ) ? $attr['has\_category'] : $has\_category; |
| [604](#L604) |  |
| [605](#L605) | $has\_country      = isset( $attr['country'] ) ? $attr['country'] : 'yes'; |
| [606](#L606) | $has\_country      = isset( $attr['has\_country'] ) ? $attr['has\_country'] : $has\_country; |
| [607](#L607) |  |
| [608](#L608) | $has\_state        = isset( $attr['state'] ) ? $attr['state'] : 'yes'; |
| [609](#L609) | $has\_state        = isset( $attr['has\_state'] ) ? $attr['has\_state'] : $has\_state; |
| [610](#L610) |  |
| [611](#L611) | $has\_city         = isset( $attr['has\_city'] ) ? $attr['has\_city'] : 'no'; |
| [612](#L612) |  |
| [613](#L613) | $has\_zip          = isset( $attr['has\_zip'] ) ? $attr['has\_zip'] : 'no'; |
| [614](#L614) |  |
| [615](#L615) | $search\_data     = array(); |
| [616](#L616) | if( $store\_category ) { |
| [617](#L617) | $search\_data['wcfmsc\_store\_categories'] = $store\_category; |
| [618](#L618) | } |
| [619](#L619) | if( $search\_country ) { |
| [620](#L620) | $search\_data['wcfmmp\_store\_country'] = $search\_country; |
| [621](#L621) | } |
| [622](#L622) | if( $search\_state ) { |
| [623](#L623) | $search\_data['wcfmmp\_store\_state'] = $search\_state; |
| [624](#L624) | } |
| [625](#L625) | if( $search\_city ) { |
| [626](#L626) | $search\_data['wcfmmp\_store\_city'] = $search\_city; |
| [627](#L627) | } |
| [628](#L628) | if( $search\_zip ) { |
| [629](#L629) | $search\_data['wcfmmp\_store\_zip'] = $search\_zip; |
| [630](#L630) | } |
| [631](#L631) | if( isset( $\_POST['search\_data'] ) ) { |
| [632](#L632) | parse\_str($\_POST['search\_data'], $search\_data); |
| [633](#L633) | $search\_data = wc\_clean( wp\_unslash( $search\_data ) ); |
| [634](#L634) | } |
| [635](#L635) |  |
| [636](#L636) | // Exclude Membership |
| [637](#L637) | $exclude\_members = array(); |
| [638](#L638) | $exclude\_membership = isset( $attr['exclude\_membership'] ) ? sanitize\_text\_field( $attr['exclude\_membership'] ) : ''; |
| [639](#L639) | if( $exclude\_membership ) $exclude\_membership = explode(",", $exclude\_membership); |
| [640](#L640) | if( !empty( $exclude\_membership ) && is\_array( $exclude\_membership ) ) { |
| [641](#L641) | foreach( $exclude\_membership as $wcfm\_membership ) { |
| [642](#L642) | $membership\_users = (array) get\_post\_meta( $wcfm\_membership, 'membership\_users', true ); |
| [643](#L643) | $exclude\_members  = array\_merge( $exclude\_members, $membership\_users ); |
| [644](#L644) | } |
| [645](#L645) | } |
| [646](#L646) | if( $exclude\_members ) $exclude\_members = implode(",", $exclude\_members); |
| [647](#L647) | else $exclude\_members = ''; |
| [648](#L648) |  |
| [649](#L649) | // Excluded Stores from List |
| [650](#L650) | $excludes = !empty( $attr['excludes'] ) ? sanitize\_text\_field( $attr['excludes'] ) : $exclude\_members; |
| [651](#L651) | $search\_data['excludes'] = $excludes; |
| [652](#L652) |  |
| [653](#L653) | // Include Membership |
| [654](#L654) | $include\_members = array(); |
| [655](#L655) | $include\_membership = isset( $attr['include\_membership'] ) ? sanitize\_text\_field( $attr['include\_membership'] ) : ''; |
| [656](#L656) | if( $include\_membership ) $include\_membership = explode(",", $include\_membership); |
| [657](#L657) | if( !empty( $include\_membership ) && is\_array( $include\_membership ) ) { |
| [658](#L658) | foreach( $include\_membership as $wcfm\_membership ) { |
| [659](#L659) | $membership\_users = (array) get\_post\_meta( $wcfm\_membership, 'membership\_users', true ); |
| [660](#L660) | $include\_members  = array\_merge( $include\_members, $membership\_users ); |
| [661](#L661) | } |
| [662](#L662) | } |
| [663](#L663) | if( $include\_members ) $include\_members = implode(",", $include\_members); |
| [664](#L664) | else $include\_members = ''; |
| [665](#L665) |  |
| [666](#L666) | // Include Store List |
| [667](#L667) | $includes = !empty( $attr['includes'] ) ? sanitize\_text\_field( $attr['includes'] ) : $include\_members; |
| [668](#L668) | if( $includes ) $includes = explode(",", $includes); |
| [669](#L669) | else $includes = array(); |
| [670](#L670) |  |
| [671](#L671) |  |
| [672](#L672) | $stores = $WCFMmp->wcfmmp\_vendor->wcfmmp\_search\_vendor\_list( true, $offset, $length, $search\_term, $search\_category, $search\_data, $has\_product, $includes ); |
| [673](#L673) |  |
| [674](#L674) | $template\_args = apply\_filters( 'wcfmmp\_stores\_args', array( |
| [675](#L675) | 'stores'          => $stores, |
| [676](#L676) | 'limit'           => $length, |
| [677](#L677) | 'offset'          => $offset, |
| [678](#L678) | 'includes'        => $includes, |
| [679](#L679) | 'excludes'        => $excludes, |
| [680](#L680) | 'search\_term'     => $search\_term, |
| [681](#L681) | 'search\_country'  => $search\_country, |
| [682](#L682) | 'search\_state'    => $search\_state, |
| [683](#L683) | 'search\_city'     => $search\_city, |
| [684](#L684) | 'search\_zip'      => $search\_zip, |
| [685](#L685) | 'search\_category' => $search\_category, |
| [686](#L686) | 'store\_category'  => $store\_category, |
| [687](#L687) | 'search\_data'     => $search\_data, |
| [688](#L688) | 'has\_product'     => $has\_product, |
| [689](#L689) | 'category'        => wc\_string\_to\_bool( $has\_category ), |
| [690](#L690) | 'country'         => wc\_string\_to\_bool( $has\_country ), |
| [691](#L691) | 'state'           => wc\_string\_to\_bool( $has\_state ), |
| [692](#L692) | 'has\_city'        => wc\_string\_to\_bool( $has\_city ), |
| [693](#L693) | 'has\_zip'         => wc\_string\_to\_bool( $has\_zip ), |
| [694](#L694) | 'has\_loop'        => wc\_string\_to\_bool( $attr['has\_loop'] ), |
| [695](#L695) | 'has\_autoplay'    => wc\_string\_to\_bool( $attr['has\_autoplay'] ), |
| [696](#L696) | 'has\_nav'         => wc\_string\_to\_bool( $attr['has\_nav'] ), |
| [697](#L697) | 'per\_row'         => $attr['per\_row'], |
| [698](#L698) | 'theme'           => $attr['theme'] |
| [699](#L699) | ), $attr, $search\_data); |
| [700](#L700) |  |
| [701](#L701) | ob\_start(); |
| [702](#L702) | $WCFMmp->template->get\_template( 'store-lists/wcfmmp-view-store-lists-carousel.php', $template\_args ); |
| [703](#L703) | return ob\_get\_clean(); |
| [704](#L704) | } |
| [705](#L705) |  |
| [706](#L706) | /\*\* |
| [707](#L707) | \* WCFM Marketplace Store Sold By Shortcode |
| [708](#L708) | \*/ |
| [709](#L709) | public function wcfmmp\_store\_sold\_by\_shortcode( $attr ) { |
| [710](#L710) | global $WCFM, $WCFMmp, $post; |
| [711](#L711) |  |
| [712](#L712) | if( !$post ) return; |
| [713](#L713) | if( !wcfm\_is\_vendor( $post->post\_author ) ) return; |
| [714](#L714) |  |
| [715](#L715) | $store\_user   = wcfmmp\_get\_store( $post->post\_author ); |
| [716](#L716) | $store\_info   = $store\_user->get\_shop\_info(); |
| [717](#L717) |  |
| [718](#L718) | $is\_store\_offline = get\_user\_meta( $store\_user->get\_id(), '\_wcfm\_store\_offline', true ); |
| [719](#L719) | if ( $is\_store\_offline ) { |
| [720](#L720) | return; |
| [721](#L721) | } |
| [722](#L722) |  |
| [723](#L723) | ob\_start(); |
| [724](#L724) |  |
| [725](#L725) | do\_action( 'wcfmmp\_store\_before\_sidebar\_info', $store\_user->get\_id() ); |
| [726](#L726) |  |
| [727](#L727) | $vendor\_sold\_by\_template = $WCFMmp->wcfmmp\_vendor->get\_vendor\_sold\_by\_template(); |
| [728](#L728) |  |
| [729](#L729) | if( $vendor\_sold\_by\_template == 'advanced' ) { |
| [730](#L730) | $WCFMmp->template->get\_template( 'sold-by/wcfmmp-view-sold-by-advanced.php', array( 'vendor\_id' => $store\_user->get\_id() ) ); |
| [731](#L731) | } else { |
| [732](#L732) | $WCFMmp->template->get\_template( 'sold-by/wcfmmp-view-sold-by-simple.php', array( 'vendor\_id' => $store\_user->get\_id() ) ); |
| [733](#L733) | } |
| [734](#L734) | wp\_enqueue\_style( 'wcfmmp\_product\_css',  $WCFMmp->library->css\_lib\_url\_min . 'store/wcfmmp-style-product.css', array(), $WCFMmp->version ); |
| [735](#L735) |  |
| [736](#L736) | do\_action( 'wcfmmp\_store\_after\_sidebar\_info', $store\_user->get\_id() ); |
| [737](#L737) |  |
| [738](#L738) | $content = ob\_get\_clean(); |
| [739](#L739) | return $content; |
| [740](#L740) | } |
| [741](#L741) |  |
| [742](#L742) | /\*\* |
| [743](#L743) | \* WCFM Marketplace Store Info Shortcode |
| [744](#L744) | \*/ |
| [745](#L745) | public function wcfmmp\_store\_info\_shortcode( $attr ) { |
| [746](#L746) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $post; |
| [747](#L747) |  |
| [748](#L748) | $store\_id = ''; |
| [749](#L749) | if ( isset( $attr['id'] ) && !empty( $attr['id'] ) ) { $store\_id = absint($attr['id']); } |
| [750](#L750) |  |
| [751](#L751) | if ( !$store\_id && wcfm\_is\_store\_page() ) { |
| [752](#L752) | $wcfm\_store\_url = wcfm\_get\_option( 'wcfm\_store\_url', 'store' ); |
| [753](#L753) | $store\_name = apply\_filters( 'wcfmmp\_store\_query\_var', get\_query\_var( $wcfm\_store\_url ) ); |
| [754](#L754) | $store\_id  = 0; |
| [755](#L755) | if ( !empty( $store\_name ) ) { |
| [756](#L756) | $store\_user = get\_user\_by( 'slug', $store\_name ); |
| [757](#L757) | } |
| [758](#L758) | $store\_id               = $store\_user->ID; |
| [759](#L759) | } |
| [760](#L760) |  |
| [761](#L761) | if( !$store\_id && is\_product() ) { |
| [762](#L762) | $store\_id = $post->post\_author; |
| [763](#L763) | } |
| [764](#L764) |  |
| [765](#L765) | if( !$store\_id && is\_single() && $post && is\_object( $post ) && wcfm\_is\_vendor( $post->post\_author ) ) { |
| [766](#L766) | $store\_id = $post->post\_author; |
| [767](#L767) | } |
| [768](#L768) |  |
| [769](#L769) | $data\_info = ''; |
| [770](#L770) | if ( isset( $attr['data'] ) && !empty( $attr['data'] ) ) { $data\_info = $attr['data']; } |
| [771](#L771) |  |
| [772](#L772) | if( !$store\_id ) return; |
| [773](#L773) | if( !$data\_info ) return; |
| [774](#L774) |  |
| [775](#L775) | $is\_store\_offline = get\_user\_meta( $store\_id, '\_wcfm\_store\_offline', true ); |
| [776](#L776) | if ( $is\_store\_offline ) { |
| [777](#L777) | return; |
| [778](#L778) | } |
| [779](#L779) |  |
| [780](#L780) | $label = ''; |
| [781](#L781) | if ( isset( $attr['label'] ) && !empty( $attr['label'] ) ) { $label = $attr['label']; } |
| [782](#L782) |  |
| [783](#L783) | $icon = ''; |
| [784](#L784) | if ( isset( $attr['icon'] ) && !empty( $attr['icon'] ) ) { $icon = $attr['icon']; } |
| [785](#L785) |  |
| [786](#L786) | $store\_user  = wcfmmp\_get\_store( $store\_id ); |
| [787](#L787) | $store\_info  = $store\_user->get\_shop\_info(); |
| [788](#L788) |  |
| [789](#L789) | $content = '<div class="wcfmmp\_store\_info wcfmmp\_store\_info\_' . $data\_info . '">'; |
| [790](#L790) |  |
| [791](#L791) | if( $icon ) { |
| [792](#L792) | $content .= '<i style="display:inline-block" class="wcfmfa fa-' . $icon . ' wcfmmp\_store\_info\_icon wcfmmp\_store\_info\_iconl\_' . $data\_info . '"></i>&nbsp&nbsp'; |
| [793](#L793) | } |
| [794](#L794) |  |
| [795](#L795) | if( $label ) { |
| [796](#L796) | $content .= '<span style="display:inline-block" class="wcfmmp\_store\_info\_label wcfmmp\_store\_info\_label\_' . $data\_info . '">' . $label . '</span>:&nbsp'; |
| [797](#L797) | } |
| [798](#L798) |  |
| [799](#L799) | switch( $data\_info ) { |
| [800](#L800) | case 'store\_name': |
| [801](#L801) | $content .= $WCFM->wcfm\_vendor\_support->wcfm\_get\_vendor\_store\_name\_by\_vendor( $store\_id ); |
| [802](#L802) | break; |
| [803](#L803) |  |
| [804](#L804) | case 'store\_url': |
| [805](#L805) | $content .=  $WCFM->wcfm\_vendor\_support->wcfm\_get\_vendor\_store\_by\_vendor( $store\_id ); |
| [806](#L806) | break; |
| [807](#L807) |  |
| [808](#L808) | case 'store\_address': |
| [809](#L809) | $content .= '<span style="display:inline-block" class="wcfmmp\_store\_info\_content wcfmmp\_store\_info\_content\_' . $data\_info . '">' . apply\_filters( 'wcfmmp\_additional\_store\_info', $store\_user->get\_address\_string(), $data\_info, $store\_id ) . '</span>'; |
| [810](#L810) | break; |
| [811](#L811) |  |
| [812](#L812) | case 'store\_email': |
| [813](#L813) | $content .= '<span style="display:inline-block" class="wcfmmp\_store\_info\_content wcfmmp\_store\_info\_content\_' . $data\_info . '">' . apply\_filters( 'wcfmmp\_additional\_store\_info', apply\_filters( 'wcfmmp\_mailto\_email', $store\_user->get\_email(), $store\_id ), $data\_info, $store\_id ) . '</span>'; |
| [814](#L814) | break; |
| [815](#L815) |  |
| [816](#L816) | case 'store\_phone': |
| [817](#L817) | $content .=  '<span style="display:inline-block" class="wcfmmp\_store\_info\_content wcfmmp\_store\_info\_content\_' . $data\_info . '">' . apply\_filters( 'wcfmmp\_additional\_store\_info', $store\_user->get\_phone(), $data\_info, $store\_id ) . '</span>'; |
| [818](#L818) | break; |
| [819](#L819) |  |
| [820](#L820) | case 'store\_gravatar': |
| [821](#L821) | $content .=  '<img src="' . esc\_url( $store\_user->get\_avatar() ) . '" />'; |
| [822](#L822) | break; |
| [823](#L823) |  |
| [824](#L824) | case 'store\_banner': |
| [825](#L825) | $content .=  '<img src="' . esc\_url( $store\_user->get\_banner() ) . '" />'; |
| [826](#L826) | break; |
| [827](#L827) |  |
| [828](#L828) | case 'store\_support': |
| [829](#L829) | $content .=  $store\_user->get\_customer\_support\_details(); |
| [830](#L830) | break; |
| [831](#L831) |  |
| [832](#L832) | case 'store\_social': |
| [833](#L833) | ob\_start(); |
| [834](#L834) | $WCFMmp->template->get\_template( 'store/wcfmmp-view-store-social.php', array( 'store\_user' => $store\_user, 'store\_info' => $store\_info ) ); |
| [835](#L835) | $content .=  ob\_get\_clean(); |
| [836](#L836) | if( !wcfmmp\_is\_store\_page() && !is\_product() ) { |
| [837](#L837) | wp\_enqueue\_style( 'wcfmmp\_product\_css',  $WCFMmp->library->css\_lib\_url . 'store/wcfmmp-style-product.css', array(), $WCFMmp->version ); |
| [838](#L838) | } |
| [839](#L839) | break; |
| [840](#L840) |  |
| [841](#L841) | case 'store\_location': |
| [842](#L842) | $api\_key = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_google\_map\_api'] : ''; |
| [843](#L843) | $wcfm\_map\_lib = isset( $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] ) ? $WCFMmp->wcfmmp\_marketplace\_options['wcfm\_map\_lib'] : ''; |
| [844](#L844) | if( !$wcfm\_map\_lib && $api\_key ) { $wcfm\_map\_lib = 'google'; } elseif( !$wcfm\_map\_lib && !$api\_key ) { $wcfm\_map\_lib = 'leaftlet'; } |
| [845](#L845) | $store\_lat    = isset( $store\_info['store\_lat'] ) ? esc\_attr( $store\_info['store\_lat'] ) : 0; |
| [846](#L846) | $store\_lng    = isset( $store\_info['store\_lng'] ) ? esc\_attr( $store\_info['store\_lng'] ) : 0; |
| [847](#L847) |  |
| [848](#L848) | if ( ( ( ($wcfm\_map\_lib == 'google') && !empty( $api\_key ) ) || ($wcfm\_map\_lib == 'leaflet') ) && !empty( $store\_lat ) && !empty( $store\_lng ) ) { |
| [849](#L849) | ob\_start(); |
| [850](#L850) | $WCFMmp->template->get\_template( 'store/widgets/wcfmmp-view-store-location.php', array( |
| [851](#L851) | 'store\_user' => $store\_user, |
| [852](#L852) | 'store\_info' => $store\_info, |
| [853](#L853) | 'store\_lat'  => $store\_lat, |
| [854](#L854) | 'store\_lng'  => $store\_lng, |
| [855](#L855) | 'map\_id'     => 'wcfm\_sold\_by\_widget\_map\_'.rand(10,100) |
| [856](#L856) | ) ); |
| [857](#L857) | $content .=  ob\_get\_clean(); |
| [858](#L858) |  |
| [859](#L859) | if( !wcfmmp\_is\_store\_page() ) { |
| [860](#L860) | wp\_enqueue\_style( 'wcfmmp\_product\_css',  $WCFMmp->library->css\_lib\_url . 'store/wcfmmp-style-product.css', array(), $WCFMmp->version ); |
| [861](#L861) | wp\_enqueue\_script( 'wcfmmp\_store\_js', $WCFMmp->library->js\_lib\_url . 'store/wcfmmp-script-store.js', array('jquery' ), $WCFMmp->version, true ); |
| [862](#L862) | $WCFMmp->library->load\_map\_lib(); |
| [863](#L863) | } |
| [864](#L864) | } |
| [865](#L865) | break; |
| [866](#L866) |  |
| [867](#L867) | case 'store\_rating': |
| [868](#L868) | ob\_start(); |
| [869](#L869) | $store\_user->show\_star\_rating(); |
| [870](#L870) | $content .=  ob\_get\_clean(); |
| [871](#L871) | break; |
| [872](#L872) |  |
| [873](#L873) | case 'store\_badges': |
| [874](#L874) | ob\_start(); |
| [875](#L875) | do\_action('wcfmmp\_single\_product\_sold\_by\_badges', $store\_id ); |
| [876](#L876) | $content .=  ob\_get\_clean(); |
| [877](#L877) | break; |
| [878](#L878) |  |
| [879](#L879) | case 'register\_on': |
| [880](#L880) | $data\_value = get\_user\_meta( $store\_id, 'wcfm\_register\_on', true ); |
| [881](#L881) | if( $data\_value ) { |
| [882](#L882) | $content .=  '<span style="display:inline-block" class="wcfmmp\_store\_info\_content wcfmmp\_store\_info\_content\_' . $data\_info . '">' . apply\_filters( 'wcfmmp\_additional\_store\_info', date( wc\_date\_format(), $data\_value ), $data\_info, $store\_id ) . '</span>'; |
| [883](#L883) | } |
| [884](#L884) | break; |
| [885](#L885) |  |
| [886](#L886) | default: |
| [887](#L887) | $data\_value = get\_user\_meta( $store\_id, $data\_info, true ); |
| [888](#L888) | if( $data\_value && is\_array( $data\_value ) ) { |
| [889](#L889) | $data\_value = implode( ", ", $data\_value ); |
| [890](#L890) | } |
| [891](#L891) | $content .=  '<span style="display:inline-block" class="wcfmmp\_store\_info\_content wcfmmp\_store\_info\_content\_' . $data\_info . '">' . apply\_filters( 'wcfmmp\_additional\_store\_info', $data\_value, $data\_info, $store\_id ) . '</span>'; |
| [892](#L892) | break; |
| [893](#L893) | } |
| [894](#L894) |  |
| [895](#L895) | $content .= '</div>'; |
| [896](#L896) |  |
| [897](#L897) | return $content; |
| [898](#L898) |  |
| [899](#L899) | } |
| [900](#L900) |  |
| [901](#L901) | /\*\* |
| [902](#L902) | \* WCFM Marketplace Store Hours Shortcode |
| [903](#L903) | \*/ |
| [904](#L904) | public function wcfmmp\_store\_hours\_shortcode( $attr ) { |
| [905](#L905) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $post; |
| [906](#L906) |  |
| [907](#L907) | if( !apply\_filters( 'wcfm\_is\_pref\_store\_hours', true ) ) return; |
| [908](#L908) |  |
| [909](#L909) | $store\_id = ''; |
| [910](#L910) | if ( isset( $attr['id'] ) && !empty( $attr['id'] ) ) { $store\_id = absint($attr['id']); } |
| [911](#L911) |  |
| [912](#L912) | if (  wcfm\_is\_store\_page() ) { |
| [913](#L913) | $wcfm\_store\_url = wcfm\_get\_option( 'wcfm\_store\_url', 'store' ); |
| [914](#L914) | $store\_name = get\_query\_var( $wcfm\_store\_url ); |
| [915](#L915) | $store\_id  = 0; |
| [916](#L916) | if ( !empty( $store\_name ) ) { |
| [917](#L917) | $store\_user = get\_user\_by( 'slug', $store\_name ); |
| [918](#L918) | } |
| [919](#L919) | $store\_id               = $store\_user->ID; |
| [920](#L920) | } |
| [921](#L921) |  |
| [922](#L922) | if( is\_product() ) { |
| [923](#L923) | $store\_id = $post->post\_author; |
| [924](#L924) | } |
| [925](#L925) |  |
| [926](#L926) | if( !$store\_id ) return; |
| [927](#L927) |  |
| [928](#L928) | $is\_store\_offline = get\_user\_meta( $store\_id, '\_wcfm\_store\_offline', true ); |
| [929](#L929) | if ( $is\_store\_offline ) { |
| [930](#L930) | return; |
| [931](#L931) | } |
| [932](#L932) |  |
| [933](#L933) | if( !$WCFM->wcfm\_vendor\_support->wcfm\_vendor\_has\_capability( $store\_id, 'store\_hours' ) ) return; |
| [934](#L934) |  |
| [935](#L935) | $store\_user  = wcfmmp\_get\_store( $store\_id ); |
| [936](#L936) |  |
| [937](#L937) | $wcfm\_vendor\_store\_hours = get\_user\_meta( $store\_id, 'wcfm\_vendor\_store\_hours', true ); |
| [938](#L938) | if( !$wcfm\_vendor\_store\_hours ) { |
| [939](#L939) | return; |
| [940](#L940) | } |
| [941](#L941) |  |
| [942](#L942) | $wcfm\_store\_hours\_enable = isset( $wcfm\_vendor\_store\_hours['enable'] ) ? 'yes' : 'no'; |
| [943](#L943) | if( $wcfm\_store\_hours\_enable != 'yes' ) return; |
| [944](#L944) |  |
| [945](#L945) | $wcfm\_store\_hours\_off\_days  = isset( $wcfm\_vendor\_store\_hours['off\_days'] ) ? $wcfm\_vendor\_store\_hours['off\_days'] : array(); |
| [946](#L946) | $wcfm\_store\_hours\_day\_times = isset( $wcfm\_vendor\_store\_hours['day\_times'] ) ? $wcfm\_vendor\_store\_hours['day\_times'] : array(); |
| [947](#L947) | if( empty( $wcfm\_store\_hours\_day\_times ) ) return; |
| [948](#L948) |  |
| [949](#L949) | $weekdays = array( 0 => \_\_( 'Monday', 'wc-multivendor-marketplace' ), 1 => \_\_( 'Tuesday', 'wc-multivendor-marketplace' ), 2 => \_\_( 'Wednesday', 'wc-multivendor-marketplace' ), 3 => \_\_( 'Thursday', 'wc-multivendor-marketplace' ), 4 => \_\_( 'Friday', 'wc-multivendor-marketplace' ), 5 => \_\_( 'Saturday', 'wc-multivendor-marketplace' ), 6 => \_\_( 'Sunday', 'wc-multivendor-marketplace') ); |
| [950](#L950) |  |
| [951](#L951) | $content = '<div class="wcfmmp\_store\_hours">'; |
| [952](#L952) | $content .= '<span class="wcfmmp-store-hours widget-title"><span class="wcfmfa fa-clock"></span>&nbsp;' . apply\_filters( 'wcfm\_store\_hours\_label', \_\_( 'Store Hours', 'wc-multivendor-marketplace' ) ) . '</span><div class="wcfm\_clearfix"></div>'; |
| [953](#L953) |  |
| [954](#L954) | ob\_start(); |
| [955](#L955) | $WCFMmp->template->get\_template( 'store/widgets/wcfmmp-view-store-hours.php', array( |
| [956](#L956) | 'wcfm\_store\_hours\_day\_times' => $wcfm\_store\_hours\_day\_times, |
| [957](#L957) | 'wcfm\_store\_hours\_off\_days'  => $wcfm\_store\_hours\_off\_days, |
| [958](#L958) | 'weekdays' => $weekdays, |
| [959](#L959) | 'store\_id' => $store\_id, |
| [960](#L960) | ) ); |
| [961](#L961) | $content .= ob\_get\_clean(); |
| [962](#L962) |  |
| [963](#L963) | $content .= '</div>'; |
| [964](#L964) |  |
| [965](#L965) | return $content; |
| [966](#L966) | } |
| [967](#L967) |  |
| [968](#L968) | /\*\* |
| [969](#L969) | \* WCFM Marketplace Shipping Time Shortcode |
| [970](#L970) | \*/ |
| [971](#L971) | function wcfmmp\_shipping\_time\_shortcode() { |
| [972](#L972) | global $WCFM, $WCFMmp, $post; |
| [973](#L973) |  |
| [974](#L974) | if( !apply\_filters( 'wcfm\_is\_allow\_store\_shipping', true ) ) return; |
| [975](#L975) | if( !apply\_filters( 'wcfm\_is\_allow\_shipping\_processing\_time\_info', true ) ) return; |
| [976](#L976) | if( !is\_product() ) return; |
| [977](#L977) |  |
| [978](#L978) | $wcfm\_shipping\_options = get\_option( 'wcfm\_shipping\_options', array() ); |
| [979](#L979) | $wcfmmp\_store\_shipping\_enabled = isset( $wcfm\_shipping\_options['enable\_store\_shipping'] ) ? $wcfm\_shipping\_options['enable\_store\_shipping'] : 'yes'; |
| [980](#L980) | if( $wcfmmp\_store\_shipping\_enabled != 'yes' ) return; |
| [981](#L981) |  |
| [982](#L982) | $vendor\_id = 0; |
| [983](#L983) | $product\_id = 0; |
| [984](#L984) | if( is\_product() && $post && is\_object( $post ) ) { |
| [985](#L985) | $product\_id = $post->ID; |
| [986](#L986) | $vendor\_id = wcfm\_get\_vendor\_id\_by\_post( $product\_id ); |
| [987](#L987) | } |
| [988](#L988) | if( !$product\_id ) return; |
| [989](#L989) | if( !$WCFM || !$WCFM->frontend || !$WCFM->frontend->is\_wcfm\_needs\_shipping( $product\_id ) ) return; |
| [990](#L990) | if( !$vendor\_id ) return; |
| [991](#L991) |  |
| [992](#L992) | if( $WCFMmp->wcfmmp\_vendor->is\_vendor\_sold\_by( $vendor\_id ) ) { |
| [993](#L993) | ob\_start(); |
| [994](#L994) | $WCFMmp->template->get\_template( 'shipping/wcfmmp-view-shipping-info.php', array( 'vendor\_id' => $vendor\_id, 'product\_id' => $product\_id ) ); |
| [995](#L995) | $content = ob\_get\_clean(); |
| [996](#L996) | return $content; |
| [997](#L997) | } |
| [998](#L998) | } |
| [999](#L999) |  |
| [1000](#L1000) | /\*\* |
| [1001](#L1001) | \* WCFM Marketplace Store Hours Shortcode |
| [1002](#L1002) | \*/ |
| [1003](#L1003) | public function wcfmmp\_more\_offers\_shortcode( $attr ) { |
| [1004](#L1004) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $post; |
| [1005](#L1005) |  |
| [1006](#L1006) | if( !apply\_filters( 'wcfm\_is\_pref\_product\_multivendor', true ) ) return; |
| [1007](#L1007) |  |
| [1008](#L1008) | if( !is\_product() ) return; |
| [1009](#L1009) |  |
| [1010](#L1010) | //$content = '<div class="wcfmmp\_more\_offers">'; |
| [1011](#L1011) | //$content .= '<span class="wcfmmp-more-offers widget-title"><span class="wcfmfa fa-clock"></span>&nbsp;' . apply\_filters( 'wcfm\_store\_hours\_label', \_\_( 'Store Hours', 'wc-multivendor-marketplace' ) ) . '</span><div class="wcfm\_clearfix"></div>'; |
| [1012](#L1012) |  |
| [1013](#L1013) | ob\_start(); |
| [1014](#L1014) | $WCFMmp->template->get\_template( 'product\_multivendor/wcfmmp-view-more-offers.php' ); |
| [1015](#L1015) | $content = ob\_get\_clean(); |
| [1016](#L1016) |  |
| [1017](#L1017) | //$content .= '</div>'; |
| [1018](#L1018) |  |
| [1019](#L1019) | return $content; |
| [1020](#L1020) | } |
| [1021](#L1021) |  |
| [1022](#L1022) | /\*\* |
| [1023](#L1023) | \* WCFM Marketplace Store FB Widget Shortcode |
| [1024](#L1024) | \*/ |
| [1025](#L1025) | public function wcfmmp\_store\_fb\_widget\_shortcode( $attr ) { |
| [1026](#L1026) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $post; |
| [1027](#L1027) |  |
| [1028](#L1028) | $store\_id  = 0; |
| [1029](#L1029) | if (  wcfm\_is\_store\_page() ) { |
| [1030](#L1030) | $wcfm\_store\_url = wcfm\_get\_option( 'wcfm\_store\_url', 'store' ); |
| [1031](#L1031) | $store\_name = get\_query\_var( $wcfm\_store\_url ); |
| [1032](#L1032) | if ( !empty( $store\_name ) ) { |
| [1033](#L1033) | $store\_user = get\_user\_by( 'slug', $store\_name ); |
| [1034](#L1034) | } |
| [1035](#L1035) | $store\_id               = $store\_user->ID; |
| [1036](#L1036) | } |
| [1037](#L1037) |  |
| [1038](#L1038) | if( is\_product() ) { |
| [1039](#L1039) | $store\_id = $post->post\_author; |
| [1040](#L1040) | } |
| [1041](#L1041) |  |
| [1042](#L1042) | if( !$store\_id ) return; |
| [1043](#L1043) |  |
| [1044](#L1044) | $store\_user   = wcfmmp\_get\_store( $store\_id ); |
| [1045](#L1045) | $store\_info   = $store\_user->get\_shop\_info(); |
| [1046](#L1046) |  |
| [1047](#L1047) | if( !isset( $store\_info['social']['fb'] ) || empty( $store\_info['social']['fb'] ) ) return; |
| [1048](#L1048) |  |
| [1049](#L1049) | $facebook\_url = wcfmmp\_generate\_social\_url( $store\_info['social']['fb'], 'facebook' ); |
| [1050](#L1050) |  |
| [1051](#L1051) | if( !$facebook\_url ) return; |
| [1052](#L1052) |  |
| [1053](#L1053) | $custom\_css = apply\_filters( 'wcfmmp\_fb\_widget\_custom\_style', '' ); |
| [1054](#L1054) |  |
| [1055](#L1055) | $content = ''; |
| [1056](#L1056) |  |
| [1057](#L1057) | ob\_start(); |
| [1058](#L1058) |  |
| [1059](#L1059) | echo '<div class="wcfm\_store\_fb\_widget" style="margin-bottom:50px;">'; |
| [1060](#L1060) |  |
| [1061](#L1061) | echo '<div id="fb-root"></div>'; |
| [1062](#L1062) | echo '<div class="fb-page" data-href="' . esc\_url($facebook\_url) . '" |
| [1063](#L1063) | data-width="400" |
| [1064](#L1064) | data-height="500" |
| [1065](#L1065) | data-small-header="true" |
| [1066](#L1066) | data-adapt-container-width="true" |
| [1067](#L1067) | data-hide-cover="false" |
| [1068](#L1068) | data-show-facepile="false" |
| [1069](#L1069) | data-show-posts="true" |
| [1070](#L1070) | style="' . $custom\_css . '"></div>'; |
| [1071](#L1071) |  |
| [1072](#L1072) | echo '</div>'; |
| [1073](#L1073) |  |
| [1074](#L1074) | $content .= ob\_get\_clean(); |
| [1075](#L1075) |  |
| [1076](#L1076) | wp\_register\_script( 'wcfm\_store\_fb\_widget\_script', $WCFMmp->library->js\_lib\_url\_min . 'store/wcfmmp-script-fb-widget.js', array('jquery') ); |
| [1077](#L1077) | wp\_enqueue\_script( 'wcfm\_store\_fb\_widget\_script' ); |
| [1078](#L1078) | $local\_variables = array( 'app\_id' => '503595753002055', 'select\_lng' => 'en\_US' ); |
| [1079](#L1079) | wp\_localize\_script( 'wcfm\_store\_fb\_widget\_script', 'wcfm\_store\_fb\_widget\_vars', $local\_variables ); |
| [1080](#L1080) |  |
| [1081](#L1081) | return $content; |
| [1082](#L1082) | } |
| [1083](#L1083) |  |
| [1084](#L1084) | /\*\* |
| [1085](#L1085) | \* WCFM Marketplace Store Twitter Widget Shortcode |
| [1086](#L1086) | \*/ |
| [1087](#L1087) | public function wcfmmp\_store\_twitter\_widget\_shortcode( $attr ) { |
| [1088](#L1088) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $post; |
| [1089](#L1089) |  |
| [1090](#L1090) | $store\_id  = 0; |
| [1091](#L1091) | if (  wcfm\_is\_store\_page() ) { |
| [1092](#L1092) | $wcfm\_store\_url = wcfm\_get\_option( 'wcfm\_store\_url', 'store' ); |
| [1093](#L1093) | $store\_name = get\_query\_var( $wcfm\_store\_url ); |
| [1094](#L1094) | if ( !empty( $store\_name ) ) { |
| [1095](#L1095) | $store\_user = get\_user\_by( 'slug', $store\_name ); |
| [1096](#L1096) | } |
| [1097](#L1097) | $store\_id               = $store\_user->ID; |
| [1098](#L1098) | } |
| [1099](#L1099) |  |
| [1100](#L1100) | if( is\_product() ) { |
| [1101](#L1101) | $store\_id = $post->post\_author; |
| [1102](#L1102) | } |
| [1103](#L1103) |  |
| [1104](#L1104) | if( !$store\_id ) return; |
| [1105](#L1105) |  |
| [1106](#L1106) | $store\_user   = wcfmmp\_get\_store( $store\_id ); |
| [1107](#L1107) | $store\_info   = $store\_user->get\_shop\_info(); |
| [1108](#L1108) |  |
| [1109](#L1109) | if( !isset( $store\_info['social']['twitter'] ) || empty( $store\_info['social']['twitter'] ) ) return; |
| [1110](#L1110) |  |
| [1111](#L1111) | $twitter\_url = wcfmmp\_generate\_social\_url( $store\_info['social']['twitter'], 'twitter' ); |
| [1112](#L1112) |  |
| [1113](#L1113) | if( !$twitter\_url ) return; |
| [1114](#L1114) |  |
| [1115](#L1115) | $custom\_css = apply\_filters( 'wcfmmp\_twitter\_widget\_custom\_style', '' ); |
| [1116](#L1116) |  |
| [1117](#L1117) | $oembed\_params = array( 'omit\_script' => 1, 'lang' => 'en', 'maxwidth' => 300, 'maxheight' => 400, 'chrome' => '', 'url' => $twitter\_url ); |
| [1118](#L1118) |  |
| [1119](#L1119) | $QUEUE\_HANDLE = 'twitter-wjs'; |
| [1120](#L1120) | $URI = 'https://platform.twitter.com/widgets.js'; |
| [1121](#L1121) | $script = 'window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src=' . wp\_json\_encode( $URI ) . ';fjs.parentNode.insertBefore(js,fjs);t.\_e=[];t.ready=function(f){t.\_e.push(f);};return t;}(document,"script",' . wp\_json\_encode( $QUEUE\_HANDLE ) . '));'; |
| [1122](#L1122) |  |
| [1123](#L1123) | $content = ''; |
| [1124](#L1124) |  |
| [1125](#L1125) | ob\_start(); |
| [1126](#L1126) |  |
| [1127](#L1127) | echo '<div class="wcfm\_store\_twitter\_widget" style="margin-bottom:50px;">'; |
| [1128](#L1128) |  |
| [1129](#L1129) | echo '<div class=" wcfmmp\_twitter twitter-timeline-profile"> |
| [1130](#L1130) | <a class="twitter-timeline" data-lang="en" |
| [1131](#L1131) | data-width="100%" |
| [1132](#L1132) | data-height="400" |
| [1133](#L1133) | href="' . esc\_url($twitter\_url) . '?ref\_src=twsrc%5Etfw">Recent Tweets</a></div>'; |
| [1134](#L1134) |  |
| [1135](#L1135) | echo '<script>' . esc\_js($script) . '</script>'; |
| [1136](#L1136) |  |
| [1137](#L1137) | echo '</div>'; |
| [1138](#L1138) |  |
| [1139](#L1139) | $content .= ob\_get\_clean(); |
| [1140](#L1140) |  |
| [1141](#L1141) | return $content; |
| [1142](#L1142) | } |
| [1143](#L1143) |  |
| [1144](#L1144) | /\*\* |
| [1145](#L1145) | \* WCFM Marketplace Store Instagram Widget Shortcode |
| [1146](#L1146) | \*/ |
| [1147](#L1147) | public function wcfmmp\_store\_instagram\_widget\_shortcode( $attr ) { |
| [1148](#L1148) | global $WCFM, $WCFMmp, $wp, $WCFM\_Query, $post; |
| [1149](#L1149) |  |
| [1150](#L1150) | $store\_id  = 0; |
| [1151](#L1151) | if (  wcfm\_is\_store\_page() ) { |
| [1152](#L1152) | $wcfm\_store\_url = wcfm\_get\_option( 'wcfm\_store\_url', 'store' ); |
| [1153](#L1153) | $store\_name = get\_query\_var( $wcfm\_store\_url ); |
| [1154](#L1154) | if ( !empty( $store\_name ) ) { |
| [1155](#L1155) | $store\_user = get\_user\_by( 'slug', $store\_name ); |
| [1156](#L1156) | } |
| [1157](#L1157) | $store\_id               = $store\_user->ID; |
| [1158](#L1158) | } |
| [1159](#L1159) |  |
| [1160](#L1160) | if( is\_product() ) { |
| [1161](#L1161) | $store\_id = $post->post\_author; |
| [1162](#L1162) | } |
| [1163](#L1163) |  |
| [1164](#L1164) | if( !$store\_id ) return; |
| [1165](#L1165) |  |
| [1166](#L1166) | $store\_user   = wcfmmp\_get\_store( $store\_id ); |
| [1167](#L1167) | $store\_info   = $store\_user->get\_shop\_info(); |
| [1168](#L1168) |  |
| [1169](#L1169) | if( !isset( $store\_info['social']['instagram'] ) || empty( $store\_info['social']['instagram'] ) ) return; |
| [1170](#L1170) |  |
| [1171](#L1171) | $instagram\_url = wcfmmp\_generate\_social\_url( $store\_info['social']['instagram'], 'instagram' ); |
| [1172](#L1172) |  |
| [1173](#L1173) | if( !$instagram\_url ) return; |
| [1174](#L1174) |  |
| [1175](#L1175) | ob\_start(); |
| [1176](#L1176) |  |
| [1177](#L1177) | echo '<div class="wcfm\_store\_instagram\_widget" style="margin-bottom:50px;">'; |
| [1178](#L1178) |  |
| [1179](#L1179) |  |
| [1180](#L1180) |  |
| [1181](#L1181) | echo '</div>'; |
| [1182](#L1182) |  |
| [1183](#L1183) | $content .= ob\_get\_clean(); |
| [1184](#L1184) |  |
| [1185](#L1185) | return $content; |
| [1186](#L1186) | } |
| [1187](#L1187) |  |
| [1188](#L1188) | /\*\* |
| [1189](#L1189) | \* WCFM Marketplace Product List Store Filter Widget Shortcode |
| [1190](#L1190) | \*/ |
| [1191](#L1191) | function wcfmmp\_products\_store\_filter\_shortcode( $attr ) { |
| [1192](#L1192) | global $WCFM, $WCFMmp, $wp; |
| [1193](#L1193) |  |
| [1194](#L1194) | if ( ! is\_shop() && ! is\_product\_taxonomy() ) { |
| [1195](#L1195) | return; |
| [1196](#L1196) | } |
| [1197](#L1197) |  |
| [1198](#L1198) | $args = array(); // For future use |
| [1199](#L1199) |  |
| [1200](#L1200) | ob\_start(); |
| [1201](#L1201) | $WCFMmp->template->get\_template( 'product-geolocate/wcfmmp-view-product-lists-vendor-filter.php', $args ); |
| [1202](#L1202) | return ob\_get\_clean(); |
| [1203](#L1203) | } |
| [1204](#L1204) |  |
| [1205](#L1205) | /\*\* |
| [1206](#L1206) | \* Helper Functions |
| [1207](#L1207) | \*/ |
| [1208](#L1208) |  |
| [1209](#L1209) | /\*\* |
| [1210](#L1210) | \* Shortcode Wrapper |
| [1211](#L1211) | \* |
| [1212](#L1212) | \* @access public |
| [1213](#L1213) | \* @param mixed $function |
| [1214](#L1214) | \* @param array $atts (default: array()) |
| [1215](#L1215) | \* @return string |
| [1216](#L1216) | \*/ |
| [1217](#L1217) | public function shortcode\_wrapper($function, $atts = array()) { |
| [1218](#L1218) | ob\_start(); |
| [1219](#L1219) | call\_user\_func($function, $atts); |
| [1220](#L1220) | return ob\_get\_clean(); |
| [1221](#L1221) | } |
| [1222](#L1222) |  |
| [1223](#L1223) | /\*\* |
| [1224](#L1224) | \* Shortcode CLass Loader |
| [1225](#L1225) | \* |
| [1226](#L1226) | \* @access public |
| [1227](#L1227) | \* @param mixed $class\_name |
| [1228](#L1228) | \* @return void |
| [1229](#L1229) | \*/ |
| [1230](#L1230) | public function load\_class($class\_name = '') { |
| [1231](#L1231) | global $WCFM; |
| [1232](#L1232) | if ('' != $class\_name && '' != $WCFM->token) { |
| [1233](#L1233) | require\_once ( $WCFM->plugin\_path . 'includes/shortcodes/class-' . esc\_attr($WCFM->token) . '-shortcode-' . esc\_attr($class\_name) . '.php' ); |
| [1234](#L1234) | } |
| [1235](#L1235) | } |
| [1236](#L1236) |  |
| [1237](#L1237) | } |
| [1238](#L1238) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php?format=txt)
* [Original Format](/export/3222765/wc-multivendor-marketplace/tags/3.6.1/core/class-wcfmmp-shortcode.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


