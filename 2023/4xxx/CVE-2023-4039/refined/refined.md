```
{
  "CVE-2023-4039": {
    "Description": "GCC's stack smashing protection, which keeps attackers from exploiting stack buffer overflow bugs in code it compiles, has no effect when the vulnerable buffer is a variable-length array or `alloca()` allocation and the target architecture is 64-bit ARM.",
    "Root cause": "GCC's AArch64 backend places dynamic stack allocations below saved registers, including the return address, without an intervening stack guard. This is different from how other architectures and compilers handle stack frame layout.",
    "Weaknesses": [
      "The `-fstack-protector` mechanism in GCC fails to protect against stack overflows of dynamically sized local variables (VLAs and `alloca()` allocations) on AArch64.",
      "The stack guard, meant to detect buffer overflows, is placed above the dynamic allocations in the stack frame, making it ineffective for overflows targeting these areas."
    ],
    "Impact": "Attackers can exploit stack buffer overflows in dynamically allocated memory regions to overwrite the return address and gain control of program execution, despite the presence of stack smashing protection.",
    "Attack vectors": "A contiguous stack buffer overflow by providing an overly long input into a dynamically allocated variable-length array or a buffer allocated using `alloca()`.",
    "Required attacker capabilities": "The attacker needs to control the size of the dynamic allocation and the content written into it, to overwrite the return address located after that allocation in the stack frame. No user interaction or special privileges are required."
  }
}
```