```
{
  "vulnerability_details": {
    "root_cause": "The `Validity_check` function in Totolink firmware attempts to prevent OS command injection by blacklisting certain characters. However, it fails to account for format string vulnerabilities. The `doSystem` function uses `vsnprintf` to format a command string, which is then executed using `system`. The use of format specifiers (e.g., %x, %s) in the input allows an attacker to inject arbitrary commands.",
    "weaknesses": [
      "Insufficient input validation",
      "Format string vulnerability",
      "OS command injection"
    ],
    "impact": "Remote OS command injection, leading to arbitrary code execution on the device.",
    "attack_vectors": "By injecting format string specifiers (e.g. `%whoami`, `%x`, absolute path to executable like `/bin/sh`) into the IP address field of the ping or traceroute feature in the web interface. The `Validity_check` function does not filter `%` character.",
    "required_capabilities": "An attacker needs to be authenticated to access the web interface and use the ping or traceroute functionality. However, some older versions might be vulnerable without authentication."
  }
}
```