=== Content from github.com_5bcba279_20250115_084602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Freleases%2Ftag%2Fv1.51.2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Freleases%2Ftag%2Fv1.51.2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=litestar-org%2Flitestar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[litestar-org](/litestar-org)
/
**[litestar](/litestar-org/litestar)**
Public

* [Notifications](/login?return_to=%2Flitestar-org%2Flitestar) You must be signed in to change notification settings
* [Fork
  390](/login?return_to=%2Flitestar-org%2Flitestar)
* [Star
   5.8k](/login?return_to=%2Flitestar-org%2Flitestar)

* [Code](/litestar-org/litestar/tree/v1.51.2)
* [Issues
  181](/litestar-org/litestar/issues)
* [Pull requests
  15](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects
  3](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

Additional navigation options

* [Code](/litestar-org/litestar/tree/v1.51.2)
* [Issues](/litestar-org/litestar/issues)
* [Pull requests](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

1. [Releases](/litestar-org/litestar/releases)
2. [v1.51.2](/litestar-org/litestar/releases/tag/v1.51.2)

# v1.51.2

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/litestar-org/litestar/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.51.2)

 Loading

[View all tags](/litestar-org/litestar/tags)

![@peterschutt](https://avatars.githubusercontent.com/u/20659309?s=40&v=4)
[peterschutt](/peterschutt)
released this
15 Feb 01:26

[v1.51.2](/litestar-org/litestar/tree/v1.51.2)

[`95c84e9`](/litestar-org/litestar/commit/95c84e96227222f6324a911c389f38a65b2642e3)

## What's Changed

* Fix for security advisory [GHSA-p24m-863f-fm6q](https://github.com/litestar-org/litestar/security/advisories/GHSA-p24m-863f-fm6q "GHSA-p24m-863f-fm6q") ([9674fe8](https://github.com/litestar-org/litestar/commit/9674fe803628f986c03fe60769048cbc55b5bf83))

**Full Changelog**: [v1.51.1...v1.51.2](https://github.com/litestar-org/litestar/compare/v1.51.1...v1.51.2)

 Assets
2

 Loading

 ðŸš€
3
 leynier, dialvarezs, and Leon0824 reacted with rocket emoji

All reactions

* ðŸš€
  3 reactions

 3 people reacted

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_c4ff7604_20250115_084600.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fcommit%2F9674fe803628f986c03fe60769048cbc55b5bf83)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fcommit%2F9674fe803628f986c03fe60769048cbc55b5bf83)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=litestar-org%2Flitestar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[litestar-org](/litestar-org)
/
**[litestar](/litestar-org/litestar)**
Public

* [Notifications](/login?return_to=%2Flitestar-org%2Flitestar) You must be signed in to change notification settings
* [Fork
  390](/login?return_to=%2Flitestar-org%2Flitestar)
* [Star
   5.8k](/login?return_to=%2Flitestar-org%2Flitestar)

* [Code](/litestar-org/litestar)
* [Issues
  181](/litestar-org/litestar/issues)
* [Pull requests
  15](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects
  3](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

Additional navigation options

* [Code](/litestar-org/litestar)
* [Issues](/litestar-org/litestar/issues)
* [Pull requests](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

## Commit

[Permalink](/litestar-org/litestar/commit/9674fe803628f986c03fe60769048cbc55b5bf83)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-p24m-863f-fm6q](https://github.com/advisories/GHSA-p24m-863f-fm6q "GHSA-p24m-863f-fm6q")

[Browse files](/litestar-org/litestar/tree/9674fe803628f986c03fe60769048cbc55b5bf83)
Browse the repository at this point in the history

```
* implement limitation to form multipart parts

* Adds multipart_form_part_limit config to Body function.

A limit defined through the Body function takes precedence over the app limit.

* Replace "DDoS" with "DoS" in docstrings.

* Provide `maxsplit` arg to `body.split()`.

`multipart_form_part_limit + 3` parts are required to determine if body
exceeds limit.

We discard the first item of the result via [1:] (+1) and we discard the
last item of the result [:-1] (+1) and need to observe whether there are
N+1 items (+1), which gets us to 3 extra items after multipart_form_part_limit. (thanks [@das7pad](https://github.com/das7pad)).

* Fix type errors.

---------

Co-authored-by: Na'aman Hirschfeld <nhirschfeld@gmail.com>
```

* Loading branch information

[![@peterschutt](https://avatars.githubusercontent.com/u/20659309?s=40&v=4)](/peterschutt) [![@Goldziher](https://avatars.githubusercontent.com/u/30733348?s=40&v=4)](/Goldziher)

[peterschutt](/litestar-org/litestar/commits?author=peterschutt "View all commits by peterschutt")
and
[Goldziher](/litestar-org/litestar/commits?author=Goldziher "View all commits by Goldziher")
authored
Feb 15, 2023

1 parent
[cbd10bb](/litestar-org/litestar/commit/cbd10bba035f9f6f48ac4f93804f6c5c4cd6568b)

commit 9674fe8

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**149 additions**
and
**56 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* starlite

  + starlite/app.py
    [app.py](#diff-1f19d4c4cba667167db9254376b7f7a4210c45ac68ffa3a43ce6dd0c8bd7fb40)
  + config

    - starlite/config/app.py
      [app.py](#diff-395640e6d13c6ffbe181fbe992df41a6484472ef28fb19fdd3a5da99210007b6)
  + connection

    - starlite/connection/request.py
      [request.py](#diff-a9354d58ec3e2b98b22c2bef37e1b182a767f7fa246766042ecffd3e52087ef6)
  + kwargs

    - starlite/kwargs/extractors.py
      [extractors.py](#diff-6d92cef54f9224e45d93297bb2c39234ef4d5c1e42503b96e6b461bc6d5ba5c6)
  + starlite/multipart.py
    [multipart.py](#diff-ad7dc3d7409a6fa8eca8492d50f3852f80a2f48ea8f9b10dfe9778c3ea49569f)
  + starlite/params.py
    [params.py](#diff-fe372365789e1817016f357e43ddbe7783bbbe8f0a6a2bc5e0a358eab8a61f00)
  + testing

    - starlite/testing/create\_test\_client.py
      [create\_test\_client.py](#diff-53051aae7aebcceaf7b7fba392d416f2105c0cc70bb0ca08f37ba30621a45421)
* tests

  + app

    - tests/app/test\_app\_config.py
      [test\_app\_config.py](#diff-510c0e14a902ecd817c7d0f039ebaa5824e2aa16083fc04ce58c0684defdac2f)
  + kwargs

    - tests/kwargs/test\_multipart\_data.py
      [test\_multipart\_data.py](#diff-569b93816b27799178c5cda36af2005cd9c0e138af9a75ede6bdcfc5b49e7c3b)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[starlite/app.py](#diff-1f19d4c4cba667167db9254376b7f7a4210c45ac68ffa3a43ce6dd0c8bd7fb40 "starlite/app.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/app.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -135,6 +135,7 @@ class Starlite(Router): |
|  |  | "get\_logger", |
|  |  | "logger", |
|  |  | "logging\_config", |
|  |  | "multipart\_form\_part\_limit", |
|  |  | "on\_shutdown", |
|  |  | "on\_startup", |
|  |  | "openapi\_config", |
| Expand Down  Expand Up | | @@ -175,6 +176,7 @@ def \_\_init\_\_( |
|  |  | initial\_state: Optional["InitialStateType"] = None, |
|  |  | logging\_config: Union["BaseLoggingConfig", "EmptyType", None] = Empty, |
|  |  | middleware: Optional[List["Middleware"]] = None, |
|  |  | multipart\_form\_part\_limit: int = 1000, |
|  |  | on\_app\_init: Optional[List["OnAppInitHandler"]] = None, |
|  |  | on\_shutdown: Optional[List["LifeSpanHandler"]] = None, |
|  |  | on\_startup: Optional[List["LifeSpanHandler"]] = None, |
| Expand Down  Expand Up | | @@ -238,6 +240,8 @@ def \_\_init\_\_( |
|  |  | initial\_state: An object from which to initialize the app state. |
|  |  | logging\_config: A subclass of :class:`BaseLoggingConfig <starlite.config.logging.BaseLoggingConfig>`. |
|  |  | middleware: A list of :class:`Middleware <starlite.types.Middleware>`. |
|  |  | multipart\_form\_part\_limit: The maximal number of allowed parts in a multipart/formdata request. |
|  |  | This limit is intended to protect from DoS attacks. |
|  |  | on\_app\_init: A sequence of :class:`OnAppInitHandler <starlite.types.OnAppInitHandler>` instances. Handlers receive |
|  |  | an instance of :class:`AppConfig <starlite.config.app.AppConfig>` that will have been initially populated with |
|  |  | the parameters passed to :class:`Starlite <starlite.app.Starlite>`, and must return an instance of same. If more |
| Expand Down  Expand Up | | @@ -300,6 +304,7 @@ def \_\_init\_\_( |
|  |  | initial\_state=initial\_state or {}, |
|  |  | logging\_config=logging\_config if logging\_config is not Empty else LoggingConfig() if debug else None, # type: ignore[arg-type] |
|  |  | middleware=middleware or [], |
|  |  | multipart\_form\_part\_limit=multipart\_form\_part\_limit, |
|  |  | on\_shutdown=on\_shutdown or [], |
|  |  | on\_startup=on\_startup or [], |
|  |  | openapi\_config=openapi\_config, |
| Expand Down  Expand Up | | @@ -343,6 +348,7 @@ def \_\_init\_\_( |
|  |  | self.static\_files\_config = config.static\_files\_config |
|  |  | self.template\_engine = config.template\_config.engine\_instance if config.template\_config else None |
|  |  | self.websocket\_class = config.websocket\_class or WebSocket |
|  |  | self.multipart\_form\_part\_limit = config.multipart\_form\_part\_limit |
|  |  |  |
|  |  | super().\_\_init\_\_( |
|  |  | after\_request=config.after\_request, |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[starlite/config/app.py](#diff-395640e6d13c6ffbe181fbe992df41a6484472ef28fb19fdd3a5da99210007b6 "starlite/config/app.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/config/app.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -178,6 +178,8 @@ class Config(BaseConfig): |
|  |  | """A mapping of types to callables that transform them into types supported for serialization.""" |
|  |  | websocket\_class: Optional[Type[WebSocket]] |
|  |  | """An optional subclass of :class:`WebSocket <starlite.connection.websocket.WebSocket>` to use for websocket connections.""" |
|  |  | multipart\_form\_part\_limit: int |
|  |  | """The maximal number of allowed parts in a multipart/formdata request. This limit is intended to protect from DoS attacks.""" |
|  |  |  |
|  |  | @validator("allowed\_hosts", always=True) |
|  |  | def validate\_allowed\_hosts( # pylint: disable=no-self-argument |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[starlite/connection/request.py](#diff-a9354d58ec3e2b98b22c2bef37e1b182a767f7fa246766042ecffd3e52087ef6 "starlite/connection/request.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/connection/request.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -150,7 +150,9 @@ async def form(self) -> FormMultiDict: |
|  |  | content\_type, options = self.content\_type |
|  |  | if content\_type == RequestEncodingType.MULTI\_PART: |
|  |  | self.\_form = self.scope["\_form"] = form\_values = parse\_multipart\_form( # type: ignore[typeddict-item] |
|  |  | body=await self.body(), boundary=options.get("boundary", "").encode() |
|  |  | body=await self.body(), |
|  |  | boundary=options.get("boundary", "").encode(), |
|  |  | multipart\_form\_part\_limit=self.app.multipart\_form\_part\_limit, |
|  |  | ) |
|  |  | return FormMultiDict(form\_values) |
|  |  | if content\_type == RequestEncodingType.URL\_ENCODED: |
| Expand Down | |  |

13 changes: 12 additions & 1 deletion

13
[starlite/kwargs/extractors.py](#diff-6d92cef54f9224e45d93297bb2c39234ef4d5c1e42503b96e6b461bc6d5ba5c6 "starlite/kwargs/extractors.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/kwargs/extractors.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,7 @@ |
|  |  | from starlite.enums import ParamType, RequestEncodingType |
|  |  | from starlite.exceptions import ValidationException |
|  |  | from starlite.multipart import parse\_multipart\_form |
|  |  | from starlite.params import BodyKwarg |
|  |  | from starlite.parsers import ( |
|  |  | parse\_headers, |
|  |  | parse\_query\_string, |
| Expand Down  Expand Up | | @@ -289,15 +290,25 @@ def create\_multipart\_extractor( |
|  |  | Returns: |
|  |  | An extractor function. |
|  |  | """ |
|  |  | body\_kwarg\_multipart\_form\_part\_limit: Optional[int] = None |
|  |  | if signature\_field.kwarg\_model and isinstance(signature\_field.kwarg\_model, BodyKwarg): |
|  |  | body\_kwarg\_multipart\_form\_part\_limit = signature\_field.kwarg\_model.multipart\_form\_part\_limit |
|  |  |  |
|  |  | async def extract\_multipart( |
|  |  | connection: "Request[Any, Any]", |
|  |  | ) -> Any: |
|  |  | multipart\_form\_part\_limit = ( |
|  |  | body\_kwarg\_multipart\_form\_part\_limit |
|  |  | if body\_kwarg\_multipart\_form\_part\_limit is not None |
|  |  | else connection.app.multipart\_form\_part\_limit |
|  |  | ) |
|  |  | connection.scope["\_form"] = form\_values = ( # type: ignore[typeddict-item] |
|  |  | connection.scope["\_form"] # type: ignore[typeddict-item] |
|  |  | if "\_form" in connection.scope |
|  |  | else parse\_multipart\_form( |
|  |  | body=await connection.body(), boundary=connection.content\_type[-1].get("boundary", "").encode() |
|  |  | body=await connection.body(), |
|  |  | boundary=connection.content\_type[-1].get("boundary", "").encode(), |
|  |  | multipart\_form\_part\_limit=multipart\_form\_part\_limit, |
|  |  | ) |
|  |  | ) |
|  |  |  |
| Expand Down | |  |

128 changes: 76 additions & 52 deletions

128
[starlite/multipart.py](#diff-ad7dc3d7409a6fa8eca8492d50f3852f80a2f48ea8f9b10dfe9778c3ea49569f "starlite/multipart.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/multipart.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,10 +30,11 @@ |
|  |  | from urllib.parse import unquote |
|  |  |  |
|  |  | from starlite.datastructures.upload\_file import UploadFile |
|  |  | from starlite.exceptions import SerializationException |
|  |  | from starlite.exceptions import SerializationException, ValidationException |
|  |  | from starlite.utils.serialization import decode\_json |
|  |  |  |
|  |  | \_token, \_quoted = r"([\w!#$%&'\*+\-.^\_`|~]+)", r'"([^"]\*)"' |
|  |  | \_token = r"([\w!#$%&'\*+\-.^\_`|~]+)" |
|  |  | \_quoted = r'"([^"]\*)"' |
|  |  | \_param = re.compile(rf";\s\*{\_token}=(?:{\_token}|{\_quoted})", re.ASCII) |
|  |  | \_firefox\_quote\_escape = re.compile(r'\\"(?!; |\s\*$)') |
|  |  |  |
| Expand All | | @@ -59,67 +60,90 @@ def parse\_content\_header(value: str) -> Tuple[str, Dict[str, str]]: |
|  |  | return value.strip().lower(), options |
|  |  |  |
|  |  |  |
|  |  | def parse\_multipart\_form(body: bytes, boundary: bytes) -> Dict[str, Any]: |
|  |  | def parse\_body(body: bytes, boundary: bytes, multipart\_form\_part\_limit: int) -> List[bytes]: |
|  |  | """Split the body using the boundary |
|  |  | and validate the number of form parts is within the allowed limit. |
|  |  |  |
|  |  | :param body: The form body. |
|  |  | :param boundary: The boundary used to separate form components. |
|  |  | :param multipart\_form\_part\_limit: The limit of allowed form components |
|  |  | :return: |
|  |  | A list of form components. |
|  |  | """ |
|  |  | if not (body and boundary): |
|  |  | return [] |
|  |  |  |
|  |  | form\_parts = body.split(boundary, multipart\_form\_part\_limit + 3)[1:-1] |
|  |  |  |
|  |  | if len(form\_parts) > multipart\_form\_part\_limit: |
|  |  | raise ValidationException( |
|  |  | f"number of multipart components exceeds the allowed limit of {multipart\_form\_part\_limit}, " |
|  |  | f"this potentially indicates a DoS attack" |
|  |  | ) |
|  |  |  |
|  |  | return form\_parts |
|  |  |  |
|  |  |  |
|  |  | def parse\_multipart\_form(body: bytes, boundary: bytes, multipart\_form\_part\_limit: int = 1000) -> Dict[str, Any]: |
|  |  | """Parse multipart form data. |
|  |  |  |
|  |  | Args: |
|  |  | body: Body of the request. |
|  |  | boundary: Boundary of the multipart message. |
|  |  | multipart\_form\_part\_limit: Limit of the number of parts allowed. |
|  |  |  |
|  |  | Returns: |
|  |  | A dictionary of parsed results. |
|  |  | """ |
|  |  |  |
|  |  | fields: DefaultDict[str, List[Any]] = defaultdict(list) |
|  |  |  |
|  |  | if body and boundary: |
|  |  | form\_parts = body.split(boundary) |
|  |  | for form\_part in form\_parts[1:-1]: |
|  |  | file\_name = None |
|  |  | content\_type = "text/plain" |
|  |  | content\_charset = "utf-8" |
|  |  | field\_name = None |
|  |  | line\_index = 2 |
|  |  | line\_end\_index = 0 |
|  |  | headers: List[Tuple[str, str]] = [] |
|  |  |  |
|  |  | while line\_end\_index != -1: |
|  |  | line\_end\_index = form\_part.find(b"\r\n", line\_index) |
|  |  | form\_line = form\_part[line\_index:line\_end\_index].decode("utf-8") |
|  |  |  |
|  |  | if not form\_line: |
|  |  | break |
|  |  |  |
|  |  | line\_index = line\_end\_index + 2 |
|  |  | colon\_index = form\_line.index(":") |
|  |  | current\_idx = colon\_index + 2 |
|  |  | form\_header\_field = form\_line[0:colon\_index].lower() |
|  |  | form\_header\_value, form\_parameters = parse\_content\_header(form\_line[current\_idx:]) |
|  |  |  |
|  |  | if form\_header\_field == "content-disposition": |
|  |  | field\_name = form\_parameters.get("name") |
|  |  | file\_name = form\_parameters.get("filename") |
|  |  |  |
|  |  | if file\_name is None and (filename\_with\_asterisk := form\_parameters.get("filename\*")): |
|  |  | encoding, \_, value = decode\_rfc2231(filename\_with\_asterisk) |
|  |  | file\_name = unquote(value, encoding=encoding or content\_charset) |
|  |  |  |
|  |  | elif form\_header\_field == "content-type": |
|  |  | content\_type = form\_header\_value |
|  |  | content\_charset = form\_parameters.get("charset", "utf-8") |
|  |  | headers.append((form\_header\_field, form\_header\_value)) |
|  |  |  |
|  |  | if field\_name: |
|  |  | post\_data = form\_part[line\_index:-4].lstrip(b"\r\n") |
|  |  | if file\_name: |
|  |  | form\_file = UploadFile( |
|  |  | content\_type=content\_type, filename=file\_name, file\_data=post\_data, headers=dict(headers) |
|  |  | ) |
|  |  | fields[field\_name].append(form\_file) |
|  |  | else: |
|  |  | try: |
|  |  | fields[field\_name].append(decode\_json(post\_data)) |
|  |  | except SerializationException: |
|  |  | fields[field\_name].append(post\_data.decode(content\_charset)) |
|  |  | for form\_part in parse\_body(body=body, boundary=boundary, multipart\_form\_part\_limit=multipart\_form\_part\_limit): |
|  |  | file\_name = None |
|  |  | content\_type = "text/plain" |
|  |  | content\_charset = "utf-8" |
|  |  | field\_name = None |
|  |  | line\_index = 2 |
|  |  | line\_end\_index = 0 |
|  |  | headers: List[Tuple[str, str]] = [] |
|  |  |  |
|  |  | while line\_end\_index != -1: |
|  |  | line\_end\_index = form\_part.find(b"\r\n", line\_index) |
|  |  | form\_line = form\_part[line\_index:line\_end\_index].decode("utf-8") |
|  |  |  |
|  |  | if not form\_line: |
|  |  | break |
|  |  |  |
|  |  | line\_index = line\_end\_index + 2 |
|  |  | colon\_index = form\_line.index(":") |
|  |  | current\_idx = colon\_index + 2 |
|  |  | form\_header\_field = form\_line[0:colon\_index].lower() |
|  |  | form\_header\_value, form\_parameters = parse\_content\_header(form\_line[current\_idx:]) |
|  |  |  |
|  |  | if form\_header\_field == "content-disposition": |
|  |  | field\_name = form\_parameters.get("name") |
|  |  | file\_name = form\_parameters.get("filename") |
|  |  |  |
|  |  | if file\_name is None and (filename\_with\_asterisk := form\_parameters.get("filename\*")): |
|  |  | encoding, \_, value = decode\_rfc2231(filename\_with\_asterisk) |
|  |  | file\_name = unquote(value, encoding=encoding or content\_charset) |
|  |  |  |
|  |  | elif form\_header\_field == "content-type": |
|  |  | content\_type = form\_header\_value |
|  |  | content\_charset = form\_parameters.get("charset", "utf-8") |
|  |  | headers.append((form\_header\_field, form\_header\_value)) |
|  |  |  |
|  |  | if field\_name: |
|  |  | post\_data = form\_part[line\_index:-4].lstrip(b"\r\n") |
|  |  | if file\_name: |
|  |  | form\_file = UploadFile( |
|  |  | content\_type=content\_type, filename=file\_name, file\_data=post\_data, headers=dict(headers) |
|  |  | ) |
|  |  | fields[field\_name].append(form\_file) |
|  |  | else: |
|  |  | try: |
|  |  | fields[field\_name].append(decode\_json(post\_data)) |
|  |  | except SerializationException: |
|  |  | fields[field\_name].append(post\_data.decode(content\_charset)) |
|  |  |  |
|  |  | return {k: v if len(v) > 1 else v[0] for k, v in fields.items()} |

8 changes: 7 additions & 1 deletion

8
[starlite/params.py](#diff-fe372365789e1817016f357e43ddbe7783bbbe8f0a6a2bc5e0a358eab8a61f00 "starlite/params.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/params.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -286,6 +286,8 @@ class BodyKwarg: |
|  |  |  |
|  |  | Equivalent to pattern in the OpenAPI specification. |
|  |  | """ |
|  |  | multipart\_form\_part\_limit: Optional[int] = field(default=None) |
|  |  | """The maximal number of allowed parts in a multipart/formdata request. This limit is intended to protect from DoS attacks.""" |
|  |  |  |
|  |  | def \_\_hash\_\_(self) -> int: # pragma: no cover |
|  |  | """Hash the dataclass in a safe way. |
| Expand Down  Expand Up | | @@ -315,7 +317,8 @@ def Body( |
|  |  | max\_items: Optional[int] = None, |
|  |  | min\_length: Optional[int] = None, |
|  |  | max\_length: Optional[int] = None, |
|  |  | regex: Optional[str] = None |
|  |  | regex: Optional[str] = None, |
|  |  | multipart\_form\_part\_limit: Optional[int] = None |
|  |  | ) -> Any: |
|  |  | """Create an extended request body kwarg definition. |
|  |  |  |
| Expand Down  Expand Up | | @@ -354,6 +357,8 @@ def Body( |
|  |  | maxLength in the OpenAPI specification. |
|  |  | regex: A string representing a regex against which the given string will be matched. |
|  |  | Equivalent to pattern in the OpenAPI specification. |
|  |  | multipart\_form\_part\_limit: The maximal number of allowed parts in a multipart/formdata request. |
|  |  | This limit is intended to protect from DoS attacks. |
|  |  | """ |
|  |  | return BodyKwarg( |
|  |  | media\_type=media\_type, |
| Expand All | | @@ -374,6 +379,7 @@ def Body( |
|  |  | min\_length=min\_length, |
|  |  | max\_length=max\_length, |
|  |  | regex=regex, |
|  |  | multipart\_form\_part\_limit=multipart\_form\_part\_limit, |
|  |  | ) |
|  |  |  |
|  |  |  |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[starlite/testing/create\_test\_client.py](#diff-53051aae7aebcceaf7b7fba392d416f2105c0cc70bb0ca08f37ba30621a45421 "starlite/testing/create_test_client.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/starlite/testing/create_test_client.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -78,6 +78,7 @@ def create\_test\_client( |
|  |  | initial\_state: Optional[Union["ImmutableState", Dict[str, Any], Iterable[Tuple[str, Any]]]] = None, |
|  |  | logging\_config: Optional["BaseLoggingConfig"] = None, |
|  |  | middleware: Optional[List["Middleware"]] = None, |
|  |  | multipart\_form\_part\_limit: int = 1000, |
|  |  | on\_app\_init: Optional[List["OnAppInitHandler"]] = None, |
|  |  | on\_shutdown: Optional[List["LifeSpanHandler"]] = None, |
|  |  | on\_startup: Optional[List["LifeSpanHandler"]] = None, |
| Expand Down  Expand Up | | @@ -160,6 +161,8 @@ def test\_my\_handler() -> None: |
|  |  | initial\_state: An object from which to initialize the app state. |
|  |  | logging\_config: A subclass of :class:`BaseLoggingConfig <starlite.config.logging.BaseLoggingConfig>`. |
|  |  | middleware: A list of :class:`Middleware <starlite.types.Middleware>`. |
|  |  | multipart\_form\_part\_limit: The maximal number of allowed parts in a multipart/formdata request. |
|  |  | This limit is intended to protect from DoS attacks. |
|  |  | on\_app\_init: A sequence of :class:`OnAppInitHandler <starlite.types.OnAppInitHandler>` instances. Handlers receive |
|  |  | an instance of :class:`AppConfig <starlite.config.app.AppConfig>` that will have been initially populated with |
|  |  | the parameters passed to :class:`Starlite <starlite.app.Starlite>`, and must return an instance of same. If more |
| Expand Down  Expand Up | | @@ -210,6 +213,7 @@ def test\_my\_handler() -> None: |
|  |  | initial\_state=initial\_state, |
|  |  | logging\_config=logging\_config, |
|  |  | middleware=middleware, |
|  |  | multipart\_form\_part\_limit=multipart\_form\_part\_limit, |
|  |  | on\_app\_init=on\_app\_init, |
|  |  | on\_shutdown=on\_shutdown, |
|  |  | on\_startup=on\_startup, |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[tests/app/test\_app\_config.py](#diff-510c0e14a902ecd817c7d0f039ebaa5824e2aa16083fc04ce58c0684defdac2f "tests/app/test_app_config.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/tests/app/test_app_config.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,7 @@ def app\_config\_object() -> AppConfig: |
|  |  | initial\_state={}, |
|  |  | logging\_config=None, |
|  |  | middleware=[], |
|  |  | multipart\_form\_part\_limit=1000, |
|  |  | on\_shutdown=[], |
|  |  | on\_startup=[], |
|  |  | openapi\_config=None, |
| Expand Down | |  |

39 changes: 38 additions & 1 deletion

39
[tests/kwargs/test\_multipart\_data.py](#diff-569b93816b27799178c5cda36af2005cd9c0e138af9a75ede6bdcfc5b49e7c3b "tests/kwargs/test_multipart_data.py")

Show comments

[View file](/litestar-org/litestar/blob/9674fe803628f986c03fe60769048cbc55b5bf83/tests/kwargs/test_multipart_data.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,7 +10,7 @@ |
|  |  |  |
|  |  | from starlite import Body, Request, RequestEncodingType, post |
|  |  | from starlite.datastructures import UploadFile |
|  |  | from starlite.status\_codes import HTTP\_201\_CREATED |
|  |  | from starlite.status\_codes import HTTP\_201\_CREATED, HTTP\_400\_BAD\_REQUEST |
|  |  | from starlite.testing import create\_test\_client |
|  |  | from tests import Person, PersonFactory |
|  |  | from tests.kwargs import Form |
| Expand Down  Expand Up | | @@ -405,3 +405,40 @@ async def hello\_world(data: Optional[UploadFile] = Body(media\_type=RequestEncodi |
|  |  | with create\_test\_client(route\_handlers=[hello\_world]) as client: |
|  |  | response = client.post("/") |
|  |  | assert response.status\_code == HTTP\_201\_CREATED |
|  |  |  |
|  |  |  |
|  |  | @pytest.mark.parametrize("limit", (1000, 100, 10)) |
|  |  | def test\_multipart\_form\_part\_limit(limit: int) -> None: |
|  |  | @post("/") |
|  |  | async def hello\_world(data: List[UploadFile] = Body(media\_type=RequestEncodingType.MULTI\_PART)) -> None: |
|  |  | assert len(data) == limit |
|  |  |  |
|  |  | with create\_test\_client(route\_handlers=[hello\_world], multipart\_form\_part\_limit=limit) as client: |
|  |  | data = {str(i): "a" for i in range(limit)} |
|  |  | response = client.post("/", files=data) |
|  |  | assert response.status\_code == HTTP\_201\_CREATED |
|  |  |  |
|  |  | data = {str(i): "a" for i in range(limit)} |
|  |  | data[str(limit + 1)] = "b" |
|  |  | response = client.post("/", files=data) |
|  |  | assert response.status\_code == HTTP\_400\_BAD\_REQUEST |
|  |  |  |
|  |  |  |
|  |  | def test\_multipart\_form\_part\_limit\_body\_param\_precedence() -> None: |
|  |  | app\_limit = 100 |
|  |  | route\_limit = 10 |
|  |  |  |
|  |  | @post("/") |
|  |  | async def hello\_world( |
|  |  | data: List[UploadFile] = Body(media\_type=RequestEncodingType.MULTI\_PART, multipart\_form\_part\_limit=route\_limit) |
|  |  | ) -> None: |
|  |  | assert len(data) == route\_limit |
|  |  |  |
|  |  | with create\_test\_client(route\_handlers=[hello\_world], multipart\_form\_part\_limit=app\_limit) as client: |
|  |  | data = {str(i): "a" for i in range(route\_limit)} |
|  |  | response = client.post("/", files=data) |
|  |  | assert response.status\_code == HTTP\_201\_CREATED |
|  |  |  |
|  |  | data = {str(i): "a" for i in range(route\_limit + 1)} |
|  |  | response = client.post("/", files=data) |
|  |  | assert response.status\_code == HTTP\_400\_BAD\_REQUEST |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9674fe8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fcommit%2F9674fe803628f986c03fe60769048cbc55b5bf83) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_8910fafb_20250115_084604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fsecurity%2Fadvisories%2FGHSA-p24m-863f-fm6q)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flitestar-org%2Flitestar%2Fsecurity%2Fadvisories%2FGHSA-p24m-863f-fm6q)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=litestar-org%2Flitestar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[litestar-org](/litestar-org)
/
**[litestar](/litestar-org/litestar)**
Public

* [Notifications](/login?return_to=%2Flitestar-org%2Flitestar) You must be signed in to change notification settings
* [Fork
  390](/login?return_to=%2Flitestar-org%2Flitestar)
* [Star
   5.8k](/login?return_to=%2Flitestar-org%2Flitestar)

* [Code](/litestar-org/litestar)
* [Issues
  181](/litestar-org/litestar/issues)
* [Pull requests
  15](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects
  3](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

Additional navigation options

* [Code](/litestar-org/litestar)
* [Issues](/litestar-org/litestar/issues)
* [Pull requests](/litestar-org/litestar/pulls)
* [Discussions](/litestar-org/litestar/discussions)
* [Actions](/litestar-org/litestar/actions)
* [Projects](/litestar-org/litestar/projects)
* [Security](/litestar-org/litestar/security)
* [Insights](/litestar-org/litestar/pulse)

# DoS vulnerability when parsing multipart request body

High

[peterschutt](/peterschutt)
published
GHSA-p24m-863f-fm6q
Feb 15, 2023

## Package

pip

starlite
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<=1.51.1

## Patched versions

1.51.2

## Description

### Summary

The request body parsing in `starlite` allows a potentially unauthenticated

attacker to consume a large amount of CPU time and RAM.

### Details

The multipart body parser processes an unlimited number of file parts.

The multipart body parser processes an unlimited number of field parts.

### Impact

This is a remote, potentially unauthenticated Denial of Service vulnerability.

This vulnerability affects applications with a request handler that accepts

a `Body(media_type=RequestEncodingType.MULTI_PART)`.

The large amount of CPU time required for processing requests can block all

available worker processes and significantly delay or slow down the processing

of legitimate user requests.

The large amount of RAM accumulated while processing requests can lead to

Out-Of-Memory kills.

Complete DoS is achievable by sending many concurrent multipart requests in a

loop.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-25578

### Weaknesses

[CWE-770](/advisories?query=cwe%3A770)

### Credits

* [![@das7pad](https://avatars.githubusercontent.com/u/17931887?s=40&v=4)](/das7pad)
  [das7pad](/das7pad)
  Reporter

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


