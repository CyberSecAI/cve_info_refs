```
{
  "vulnerability": {
    "root_cause": "The telemetry job in TimescaleDB was running queries without a properly locked down `search_path`. This allowed a malicious user to create functions that would be executed by the telemetry job.",
    "weaknesses": [
      "Incorrect access control",
      "Lack of proper `search_path` restriction for telemetry jobs"
    ],
    "impact": "Privilege escalation. A malicious user could create functions that would be executed by the telemetry job, effectively gaining the privileges of the user running the telemetry job.",
    "attack_vectors": [
      "Malicious user creates objects in a database",
       "A superuser installs TimescaleDB into the database (or non-superusers in case of trusted extensions)."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to create objects in a database and then get a superuser to install TimescaleDB into their database.  When TimescaleDB is installed as a trusted extension, non-superusers can install the extension without help from a superuser.",
    "additional_details": "The vulnerability is not exploitable on instances in Timescale Cloud and Managed Service for TimescaleDB due to additional security provisions. The fix involves locking down the search_path in SPI calls."
  }
}
```