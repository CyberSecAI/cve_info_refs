=== Content from www.mozilla.org_7e9e9b8c_20250115_094623.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-09

## Security Vulnerabilities fixed in Firefox 111

Announced
March 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 111

#### [#CVE-2023-28159: Fullscreen Notification could have been hidden by download popups on Android](#CVE-2023-28159)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

The fullscreen notification could have been hidden on Firefox for Android by using download popups, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1783561](https://bugzilla.mozilla.org/show_bug.cgi?id=1783561)

#### [#CVE-2023-25748: Fullscreen Notification could have been hidden by window prompts on Android](#CVE-2023-25748)

Reporter
Hafiizh
Impact
high
##### Description

By displaying a prompt with a long description, the fullscreen notification could have been hidden, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1798798](https://bugzilla.mozilla.org/show_bug.cgi?id=1798798)

#### [#CVE-2023-25749: Firefox for Android may have opened third-party apps without a prompt](#CVE-2023-25749)

Reporter
Kirtikumar Anandrao Ramchandani
Impact
high
##### Description

Android applications with unpatched vulnerabilities can be launched from a browser using Intents, exposing users to these vulnerabilities. Firefox will now confirm with users that they want to launch an external application before doing so.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1810705](https://bugzilla.mozilla.org/show_bug.cgi?id=1810705)

#### [#CVE-2023-25750: Potential ServiceWorker cache leak during private browsing mode](#CVE-2023-25750)

Reporter
Kagami Rosylight
Impact
high
##### Description

Under certain circumstances, a ServiceWorker's offline cache may have leaked to the file system when using private browsing mode.

##### References

* [Bug 1814733](https://bugzilla.mozilla.org/show_bug.cgi?id=1814733)

#### [#CVE-2023-25751: Incorrect code generation during JIT compilation](#CVE-2023-25751)

Reporter
Lukas Bernhard
Impact
high
##### Description

Sometimes, when invalidating JIT code while following an iterator, the newly generated code could be overwritten incorrectly. This could lead to a potentially exploitable crash.

##### References

* [Bug 1814899](https://bugzilla.mozilla.org/show_bug.cgi?id=1814899)

#### [#CVE-2023-28160: Redirect to Web Extension files may have leaked local path](#CVE-2023-28160)

Reporter
Rob Wu
Impact
moderate
##### Description

When following a redirect to a publicly accessible web extension file, the URL may have been translated to the actual local path, leaking potentially sensitive information.

##### References

* [Bug 1802385](https://bugzilla.mozilla.org/show_bug.cgi?id=1802385)

#### [#CVE-2023-28164: URL being dragged from a removed cross-origin iframe into the same tab triggered navigation](#CVE-2023-28164)

Reporter
Luan Herrera
Impact
moderate
##### Description

Dragging a URL from a cross-origin iframe that was removed during the drag could have led to user confusion and website spoofing attacks.

##### References

* [Bug 1809122](https://bugzilla.mozilla.org/show_bug.cgi?id=1809122)

#### [#CVE-2023-28161: One-time permissions granted to a local file were extended to other local files loaded in the same tab](#CVE-2023-28161)

Reporter
Khiem Tran
Impact
moderate
##### Description

If temporary "one-time" permissions, such as the ability to use the Camera, were granted to a document loaded using a file: URL, that permission persisted in that tab for all other documents loaded from a file: URL. This is potentially dangerous if the local files came from different sources, such as in a download directory.

##### References

* [Bug 1811181](https://bugzilla.mozilla.org/show_bug.cgi?id=1811181)

#### [#CVE-2023-28162: Invalid downcast in Worklets](#CVE-2023-28162)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

While implementing AudioWorklets, some code may have casted one type to another, invalid, dynamic type. This could have led to a potentially exploitable crash.

##### References

* [Bug 1811327](https://bugzilla.mozilla.org/show_bug.cgi?id=1811327)

#### [#CVE-2023-25752: Potential out-of-bounds when accessing throttled streams](#CVE-2023-25752)

Reporter
Ronald Crane
Impact
moderate
##### Description

When accessing throttled streams, the count of available bytes needed to be checked in the calling function to be within bounds. This may have lead future code to be incorrect and vulnerable.

##### References

* [Bug 1811627](https://bugzilla.mozilla.org/show_bug.cgi?id=1811627)

#### [#CVE-2023-28163: Windows Save As dialog resolved environment variables](#CVE-2023-28163)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When downloading files through the Save As dialog on Windows with suggested filenames containing environment variable names, Windows would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1817768](https://bugzilla.mozilla.org/show_bug.cgi?id=1817768)

#### [#CVE-2023-28176: Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](#CVE-2023-28176)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110 and Firefox ESR 102.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1808352%2C1811637%2C1815904%2C1817442%2C1818674)

#### [#CVE-2023-28177: Memory safety bugs fixed in Firefox 111](#CVE-2023-28177)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Calixte Denizet, Gabriele Svelto, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1803109%2C1808832%2C1809542%2C1817336)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_9633abff_20250115_094621.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1798798)
* [XML](/show_bug.cgi?ctype=xml&id=1798798)

Closed
[Bug 1798798](/show_bug.cgi?id=1798798)
(CVE-2023-25748)

Opened 2 years ago
Closed 2 years ago

# Window prompt with long description hides fullscreen notification, leads to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Window prompt with long description hides fullscreen notification, leads to spoof

## Categories

### (Fenix :: Browser Engine, defect, P1)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=Browser%20Engine#Browser%20Engine)

Browser Engine
▾

Fenix :: Browser Engine
Bugs related to web pages, prompts, error messages, text selection.
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=Browser%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=Browser%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=Browser%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox109 wontfix, firefox110 wontfix, firefox111+ fixed, firefox112+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

112 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) |
| firefox112 | [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox109 |  | wontfix |
| firefox110 |  | wontfix |
| firefox111 | + | fixed |
| firefox112 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: petru)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2535b2a6f3c9de3bd9f6a53bbe17835e?d=mm&size=40)  [petru](/user_profile?user_id=613831)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1819254](/show_bug.cgi?id=1819254 "RESOLVED FIXED - When trying to change quality or speed of full screen YouTube video, video exits full screen and landscape changes to portrait")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1871012](/show_bug.cgi?id=1871012 "RESOLVED DUPLICATE - window.prompt() with long description hides fullscreen notification, leads to spoof")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-25743](/show_bug.cgi?id=1800203 "VERIFIED FIXED - fullscreen notification not shown when fullscreen lead to spoof (firefox focus - android)"), [1871012](/show_bug.cgi?id=1871012 "RESOLVED DUPLICATE - window.prompt() with long description hides fullscreen notification, leads to spoof")

[mozilla-hub.atlassian.net/browse/FXDR...](https://mozilla-hub.atlassian.net/browse/FXDROID-6 "https://mozilla-hub.atlassian.net/browse/FXDROID-6")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][geckoview][fxdroid][adv-main111+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25748

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][geckoview][fxdroid][adv-main111+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a9581270_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=9301665)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   5.28 KB, text/html |  | [Details](/attachment.cgi?id=9301665&action=edit) |
| --- | --- | --- |
| [google.jpg](/attachment.cgi?id=9301666)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   22.18 KB, image/jpeg |  | [Details](/attachment.cgi?id=9301666&action=edit) |
| [video\_2022-11-03\_05-04-07.mp4](/attachment.cgi?id=9301667)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   1.63 MB, video/mp4 |  | [Details](/attachment.cgi?id=9301667&action=edit) |
| [Support\_exiting\_from\_prompts.patch](/attachment.cgi?id=9315393)  [2 years ago](#c11)  [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)   23.11 KB, patch | amejia : [review+](#c12 "2 years ago")  RyanVM : [approval-mozilla-beta+](#c20 "2 years ago")  tjr : [sec-approval+](#c14 "2 years ago") | [Details](/attachment.cgi?id=9315393&action=edit) | [Diff](/attachment.cgi?id=9315393&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393) |
| [advisory.txt](/attachment.cgi?id=9322416)  [2 years ago](#c22)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   310 bytes, text/plain |  | [Details](/attachment.cgi?id=9322416&action=edit) |
| [advisory.txt](/attachment.cgi?id=9322423)  [2 years ago](#c23)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   328 bytes, text/plain |  | [Details](/attachment.cgi?id=9322423&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1798798#c0)• 2 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9301665)
— [Details](attachment.cgi?id=9301665&action=edit)

I found a vulnerability in firefox android where a window prompt with a long description can cover fullscreen notifications which can lead to spoofs.

steps to produce

1. open <http://103.186.0.20/poc2.html> or open poc.html
2. Click the open to google button
3. Then a dialog prompt window appears with a long description and covers the fullscreen notification

   4 then click ok

OS: Android 10 (Samsung M31)

i attached the poc video files.

thank you

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1798798#c1)• 2 years ago |
|  | |

Attached image
[google.jpg](attachment.cgi?id=9301666)
— [Details](attachment.cgi?id=9301666&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1798798#c2)• 2 years ago |
|  | |

Attached video
[video\_2022-11-03\_05-04-07.mp4](attachment.cgi?id=9301667)
— [Details](attachment.cgi?id=9301667&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a409_159069)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → Security: AndroidProduct: Firefox → Fenix

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a81415_406194)• 2 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a116893_430528)• 2 years ago |

Component: Security: Android → General

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a364701_430528)• 2 years ago |

Severity: -- → S3

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1798798#c3)• 2 years ago |
|  | |

Dev Note: the POC shows a static fake URL bar that isn't convincing if you touch it, but that's just an implementation detail. In a real attack you could make the "url bar" as realistic-feeling as you had time to put into it.

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1798798#c4)• 2 years ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:cpeterson, could you consider increasing the severity of this security bug?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#severity_high_security.py).

Flags: needinfo?(cpeterson)

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a1205102_406670)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][geckoview]

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1798798#c5)• 2 years ago |
|  | |

sec-high P2/S2

We might need to make the alert tab-modal or change the alert's z ordering.

Severity: S3 → S2Flags: needinfo?(cpeterson)Priority: -- → P2Summary: Window prompt with long description hide fullscreen notification lead to spoof → Window prompt with long description hides fullscreen notification, leads to spoof

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a1281466_430528)• 2 years ago |

See Also: → [CVE-2023-25743](/show_bug.cgi?id=1800203 "VERIFIED FIXED - fullscreen notification not shown when fullscreen lead to spoof (firefox focus - android)")

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1798798#c6)• 2 years ago |
|  | |

Wanted to confirm that this will not be solved by the patch from <https://bugzilla.mozilla.org/show_bug.cgi?id=1783561>.

The prompt discussed here is a dialog (has it's own Window separate from the app layout and shown on top of it) which expands to cover ~all of the available space.

A quick fix which would try to limit the number of characters shown would probably still be problematic on small screens, especially in landscape mode where the available screen height is still small.

I'd say the easiest solution (still complex) would be to migrate the dialog to a normal view inside app's layout.

With more dialogs having similar issues we would probably get to have a framework to handle them all - all in all it would be a big effort.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1798798#c7)• 2 years ago |
|  | |

Was thinking that a simpler approach may be to have the snackbar shown when entering fullscreen block further prompts until it disappears (a few seconds) or we even add an action button for it to disappear and then just queue different prompts requests.

This would ensure users are aware of the fullscreen change.

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1798798#c8)• 2 years ago |
|  | |

Jira issue: <https://mozilla-hub.atlassian.net/browse/FXDROID-6>

See Also: → <https://mozilla-hub.atlassian.net/browse/FXDROID-6>

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a4309174_430528)• 2 years ago |

OS: Unspecified → Android

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a6772403_613831)• 2 years ago |

Assignee: nobody → petru.lingurarStatus: NEW → ASSIGNED

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1798798#c9)• 2 years ago |
|  | |

Saw that in such cases both Chrome Desktop/Mobile and Firefox Desktop will exit fullscreen.

Seems like a good (and easy) solution for this scenario.

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1798798#c10)• 2 years ago |
|  | |

P1 because Petru is working on this bug now. We should consider uplifting the fix to Beta 110.

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)Component: General → Browser EnginePriority: P2 → P1

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a7659861_613831)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][geckoview] → [reporter-external] [client-bounty-form] [verif?][geckoview][fxdroid]

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1798798#c11)• 2 years ago |
|  | |

Attached patch

[Support\_exiting\_from\_prompts.patch](attachment.cgi?id=9315393&action=diff)
— [Details](attachment.cgi?id=9315393&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393)

Exit fullscreen for any new request to show a prompt based on the account of:

* multiple prompts having the ability to block the snackbar notification
* other browsers having a similar behavior

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a7839721_613831)• 2 years ago |

[Attachment #9315393](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") -
Flags: review?(amejiamarmol)

|  | [Arturo Mejia [:amejia]](/user_profile?user_id=623634) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1798798#c12)• 2 years ago |
|  | |

Comment on [attachment 9315393](/attachment.cgi?id=9315393 "Support_exiting_from_prompts.patch") [[details]](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") [[diff]](/attachment.cgi?id=9315393&action=diff "Support_exiting_from_prompts.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393)
Support\_exiting\_from\_prompts.patch
Review of [attachment 9315393](/attachment.cgi?id=9315393 "Support_exiting_from_prompts.patch") [[details]](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") [[diff]](/attachment.cgi?id=9315393&action=diff "Support_exiting_from_prompts.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393):
-----------------------------------------------------------------
Looks good!
I tested manually, with this patch after clicking the "OK" button the browser was not longer in full screen mode, and I was able to interact with it.
[Attachment #9315393](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") -
Flags: review?(amejiamarmol) → review+

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1798798#c13)• 2 years ago |
|  | |

Comment on [attachment 9315393](/attachment.cgi?id=9315393 "Support_exiting_from_prompts.patch") [[details]](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") [[diff]](/attachment.cgi?id=9315393&action=diff "Support_exiting_from_prompts.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393)

Support\_exiting\_from\_prompts.patch

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch / commit does not indicate a security issue. With a note that other browsers have the same behavior it should not raise suspicions.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: That same patch can be applied to older branches also.
* **How likely is this patch to cause regressions; how much testing does it need?**: Low risk. Small change.
* **Is Android affected?**: Yes
[Attachment #9315393](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1798798#c14)• 2 years ago |
|  | |

Comment on [attachment 9315393](/attachment.cgi?id=9315393 "Support_exiting_from_prompts.patch") [[details]](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") [[diff]](/attachment.cgi?id=9315393&action=diff "Support_exiting_from_prompts.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393)

Support\_exiting\_from\_prompts.patch

Approved to land and request uplift

[Attachment #9315393](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a8920321_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1798798#c15)• 2 years ago |
|  | |

Patch landed in <https://github.com/mozilla-mobile/firefox-android/pull/789>.

Asking Chris if we should also look into uplifting this, maybe after a few days of baking in Nightly.

Status: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fix-optional)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)Flags: needinfo?(cpeterson)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1798798#c16)• 2 years ago |
|  | |

This is a sec-high. We should absolutely uplift this once it's had sufficient Nightly bake time. Also note that uplifting was part of the sec-approval decision.

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fix-optional) → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)Flags: needinfo?(cpeterson) → needinfo?(petru.lingurar)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1798798#c17)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1798798&comment_id=16285494 "1 revision") |
|  | |

Petru, feel free to uplift your fix to Beta 111 whenever you're ready. ~~As Ryan said, Beta uplift was already approved as part of the sec-approval decision.~~

I see that Ryan set the status flag for firefox110 = wontfix, so you don't need to uplift your fix to the 110 release branch.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1798798#c18)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1798798&comment_id=16285566 "1 revision") |
|  | |

(In reply to Chris Peterson [:cpeterson] from [comment #17](/show_bug.cgi?id=1798798#c17 "RESOLVED FIXED - Window prompt with long description hides fullscreen notification, leads to spoof"))

> Beta uplift was already approved as part of the sec-approval decision.

No, sec-approval is separate from Beta approval. We still need a backport PR with a Beta approval request before it can land.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1798798#c19)• 2 years ago |
| uplift | |

Thank you for the support!

Uplift to 111 landed in <https://github.com/mozilla-mobile/firefox-android/pull/923>.

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Flags: needinfo?(petru.lingurar)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1798798#c20)• 2 years ago |
|  | |

Comment on [attachment 9315393](/attachment.cgi?id=9315393 "Support_exiting_from_prompts.patch") [[details]](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") [[diff]](/attachment.cgi?id=9315393&action=diff "Support_exiting_from_prompts.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1798798&attachment=9315393)

Support\_exiting\_from\_prompts.patch

Retroactively setting approval-mozilla-beta+ on this. In the future, please do request Beta approval before landing uplifts. Security approval is not the same thing.

[Attachment #9315393](/attachment.cgi?id=9315393&action=edit "Support_exiting_from_prompts.patch") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a9559945_75935)• 2 years ago |

Group: mobile-core-security → core-security-releaseTarget Milestone: --- → 112 Branch

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1798798#c21)• 2 years ago |
|  | |

> In the future, please do request Beta approval before landing uplifts. Security approval is not the same thing.

Chris Peterson asked in <https://bugzilla.mozilla.org/show_bug.cgi?id=1798798#c17> to uplift this to Beta.

I took that as an approval for the uplift but did not know of the separate approval needed for the attachment.

Noted for the next time. Thank you!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a9581270_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a10263729_695136)• 2 years ago |

Regressions: [1819254](/show_bug.cgi?id=1819254 "RESOLVED FIXED - When trying to change quality or speed of full screen YouTube video, video exits full screen and landscape changes to portrait")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a11033791_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][geckoview][fxdroid] → [reporter-external] [client-bounty-form] [verif?][geckoview][fxdroid][adv-main111+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1798798#c22)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9322416) (obsolete)
— [Details](attachment.cgi?id=9322416&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1798798#c23)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9322423)
— [Details](attachment.cgi?id=9322423&action=edit)

[Attachment #9322416](/attachment.cgi?id=9322416&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a11301337_578488)• 2 years ago |

Alias: CVE-2023-25748

|  | [Giorgio Maone [:ma1]](/user_profile?user_id=151994) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1798798#c24)• 2 years ago |
|  | |

While trying to backport this patch on Tor Browser for Android, we've noticed that the fix is pretty unreliable (especially on our browser based on ESR, but the problem can be reproduced on Firefox as well).

It seems that sometimes (almost always on our side) we try to exit from fullscreen before the fullscreen status is actually committed (probably because of some race condition), and therefore the mitigation fails and the "attack" succeed.

I've shipped a work-around in NoScript 11.4.19 (currently in AMO's review queue) which proxies alert/confirm/prompt and forces `exitFullscreen()` *after the call returns*, but we believe a more reliable fix is still needed upstream.

Thank you!

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1798798#c25)• 2 years ago |
|  | |

@Giorgio Can you offer some steps to reproduce the issue in Fenix? A video of what you're seeing would also help.

If we exit from fullscreen then the spoof described here would not happen - since the real toolbar would be shown again.

If we enter fullscreen, immediately exit and then enter again the user should see the Toast informing about the tab entering fullscreen.

Flags: needinfo?(g.maone)

|  | [Giorgio Maone [:ma1]](/user_profile?user_id=151994) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1798798#c26)• 2 years ago |
|  | |

@Petru, on my devices I could actually (and consistently) reproduce only on our Tor Browser with the backported fix.

But my colleague Piero reported *intermittent* failures on Firefox as well (*"Hard to reproduce, but I've managed to, a couple of times."*) : I'm redirecting the needinfo to him, maybe he can provide more details.

Flags: needinfo?(g.maone) → needinfo?(pierov)

|  | [Pier Angelo Vendrame](/user_profile?user_id=697330) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1798798#c27)• 2 years ago |
|  | |

Hi Petru,

as Giorgio wrote, I managed to get a race condition a few times on my Pixel 4a and on an old phone I use for testing purposes.

I recorded this video: <https://people.torproject.org/~pierov/bugs/41679/ScreenRecording_20230321_092447.mp4>

Since the bug is still confidential, I've added a basic auth.

Username: `1798798`

Password: `r4c3___c0nd1t10n`

As you can see in the video, the race condition is quite difficult to trigger on Firefox.

I click on the button, and then press back on the prompt just to be quicker to test, but it can happen when accepting the prompt, too.

When we get the same problem in Tor Browser, we get this message on logcat:

```
GeckoConsole            org.torproject.torbrowser_debug      E  [JavaScript Error: "TypeError: Not in fullscreen mode" {file: "resource://gre/modules/GeckoViewContent.jsm" line: 126}]

```

I haven't tried to see if I can get the same error in logcat with the latest Fenix, but I'd expect it to be there.

Flags: needinfo?(pierov)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1798798#c28)• 2 years ago |
|  | |

Thank you for these details!

So it seems that somehow we can get into the scenario of the prompt being shown but not also exiting fullscreen mode.

If a quick succession of prompts is needed to force this and the quick dismissal of the prompt is the source of this scenario I would say that the security impact is small since the user would see the prompt about the site entering in fullscreen after the quick prompt dismissal.

Fenix also moved to show a Toast instead of a Snackbar for the fullscreen message (similar to Chrome also) which would always inform the user about the tab entering in fullscreen mode so to me this scenario seem to be more of a UX issue - an inconsistent behavior regarding exiting fullscreen for specific prompts.

Opened [bug 1823859](/show_bug.cgi?id=1823859 "NEW") for more investigations.

|  | [Pier Angelo Vendrame](/user_profile?user_id=697330) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1798798#c29)• 2 years ago |
|  | |

(In reply to Petru-Mugurel Lingurar [:petru] from [comment #28](/show_bug.cgi?id=1798798#c28 "RESOLVED FIXED - Window prompt with long description hides fullscreen notification, leads to spoof"))

> If a quick succession of prompts is needed to force this and the quick dismissal of the prompt is the source of this scenario I would say that the security impact is small since the user would see the prompt about the site entering in fullscreen after the quick prompt dismissal.

I think one could be enough, at least it is for us downstream.

For the official Fenix, I had to try several times because the race condition seems to be much more unlikely to happen (maybe better performances?).

> Opened [bug 1823859](/show_bug.cgi?id=1823859 "NEW") for more investigations.

Could you please CC me in?

Thanks!

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1798798#c30)• 2 years ago |
|  | |

Done.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a12677584_75935)• 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) → ---

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a30173203_1689)• 1 year ago |

Group: core-security-release

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a35639324_159069)• 1 year ago |

See Also: → [1871012](/show_bug.cgi?id=1871012 "RESOLVED DUPLICATE - window.prompt() with long description hides fullscreen notification, leads to spoof")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a35729333_159069)• 1 year ago |

Duplicate of this bug: [1871012](/show_bug.cgi?id=1871012 "RESOLVED DUPLICATE - window.prompt() with long description hides fullscreen notification, leads to spoof")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1798798#a49664889_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1798798&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


