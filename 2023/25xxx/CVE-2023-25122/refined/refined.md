The provided content is related to CVE-2023-25122.

**Root cause of vulnerability:**
The root cause is the usage of `sprintf` with user-controlled data within the `vtysh_ubus` binary of Milesight UR32L routers. Specifically, the `set_openvpn_client` function uses `sprintf` to format a command string based on user-supplied values for `old_remote_subnet` and `old_remote_mask`.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflow (CWE-121) due to unbounded string copy via `sprintf`.

**Impact of exploitation:**
- Arbitrary code execution by overflowing the `vtysh_command_buffer`.
- Device compromise.

**Attack vectors:**
- Sending a specially crafted HTTP POST request to the `/cgi` endpoint.
- The request must target the `yruo_vpn_openvpn_client` core with the `set` function.

**Required attacker capabilities/position:**
- The attacker needs to be a high-privileged user to send the crafted HTTP requests.
- The attacker needs to be able to send HTTP requests to the router's `/cgi` endpoint.

**Details specific to CVE-2023-25122:**

- The vulnerability is located within the `set_openvpn_client` function.
- The `sprintf` call is reached when processing the `old_remote_subnet` and `old_remote_mask` parameters with `action=2`
- Specifically, the vulnerable `sprintf` call is:
  ```c
  sprintf(vtysh_command_buffer,"no remote subnet %s mask %s",old_remote_subnet,old_remote_mask);
  ```
- The proof of concept shows a sample JSON payload that triggers a crash by providing a large string for `old_remote_subnet`.