```
{
  "Root cause of vulnerability": "The vulnerability is caused by the use of `sprintf` with user-controlled data within the `vtysh_ubus` binary. Specifically, the `firewall_handler_set` function parses JSON data, and the values associated with the keys `src` and `dmz` are used to create a command string using `sprintf` that is then executed.",
  "Weaknesses/vulnerabilities present": "The primary vulnerability is a stack-based buffer overflow (CWE-121). The `sprintf` function is used to construct a command string for the `vtysh` service, but it does not perform bounds checking on the input data which is taken from user controlled JSON parameters, allowing an attacker to provide an overly long input string and overwrite the stack.",
  "Impact of exploitation": "Successful exploitation of this vulnerability leads to arbitrary code execution on the affected device. An attacker can achieve this by sending a crafted HTTP request, leading to complete control over the router.",
  "Attack vectors": "The attack vector is through sending a specially crafted HTTP POST request to the `/cgi` endpoint of the router. The request must include a JSON payload with specific keys (`src`, `dmz`) set to overly long strings.",
  "Required attacker capabilities/position": "The attacker needs to have high privileges on the Milesight UR32L router to be able to send the crafted HTTP requests required to trigger the vulnerability.  The attacker would need to authenticate to the device."
}
```