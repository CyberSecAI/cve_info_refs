- **Root cause of vulnerability**: The `vtysh_ubus` binary uses `sprintf` with user-controlled data, leading to buffer overflows. Specifically, multiple functions parse data from `blobmsg` structures and then use `sprintf` to compose commands, without proper bounds checking.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflows (CWE-121) due to the usage of `sprintf` with unbounded user-controlled data.
- **Impact of exploitation**: Arbitrary code execution can be achieved through carefully crafted HTTP requests.
- **Attack vectors**: Sending a specially crafted HTTP POST request to the `/cgi` endpoint with a vulnerable `core` and `function` , with oversized input via JSON keys.
- **Required attacker capabilities/position**: The attacker needs to be a high-privileged user to send the vulnerable HTTP requests.
- **Specific details for CVE-2023-25106**:
    - The vulnerability exists in the `set_gre` function of the `vpn_gre_handler_set` functionality.
    - The `local_virtual_ip` and `local_virtual_mask` JSON keys are used to fetch user controlled data.
    - The vulnerable `sprintf` is: `sprintf(vtysh_command_buffer,"ip address local %s %s",local_virtual_ip,local_virtual_mask);`
    - A buffer overflow occurs in the `vtysh_command_buffer` buffer when the values of the `local_virtual_ip` and/or the `local_virtual_mask` keys are too large.