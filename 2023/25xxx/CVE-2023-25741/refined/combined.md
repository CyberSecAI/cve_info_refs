=== Content from bugzilla.mozilla.org_d8dcc46f_20250114_210701.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1437126)
* [XML](/show_bug.cgi?ctype=xml&id=1437126)

Open
[Bug 1437126](/show_bug.cgi?id=1437126)

Opened 7 years ago
Updated 7 months ago

# drag/dropping image from one tab into another should drop the image, not the URL.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

drag/dropping image from one tab into another should drop the image, not the URL.

## Categories

### (Core :: DOM: Copy & Paste and Drag & Drop, enhancement, P5)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop#DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)

DOM: Copy & Paste and Drag & Drop
▾

Core :: DOM: Copy & Paste and Drag & Drop
All issues with copy-and-paste and drag-and-drop can be reported here, be it with the web API or the platform backends. This includes clipboard issues.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

enhancement

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P5

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

NEW

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

NEW

---

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox109 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed) |
| firefox110 | --- | [disabled](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=disabled) |
| firefox111 | --- | [disabled](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=disabled) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | fixed |
| firefox110 |  | disabled |
| firefox111 |  | disabled |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mhoye, Assigned: evilpies)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/6bb31f7207fc068158047b9c8ad4592d?d=mm&size=40)  [evilpies](/user_profile?user_id=393835)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/84c91e272e53299e85953c84e7b4501a?d=mm&size=40)  [mhoye](/user_profile?user_id=461850)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1802904](/show_bug.cgi?id=1802904 "RESOLVED INCOMPLETE - Intermittent dom/events/test/test_drag_image_file.html | single tracking bug"), [1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped"), [CVE-2023-25741](/show_bug.cgi?id=1813376 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop"), [1814388](/show_bug.cgi?id=1814388 "RESOLVED FIXED - [Yahoo] Emojis get enlarged if using Drag & Drop")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1000690](/show_bug.cgi?id=1000690 "RESOLVED DUPLICATE - I should be able to drag an image from a webpage to the browse button of an <input type=file>"), [1787627](/show_bug.cgi?id=1787627 "RESOLVED DUPLICATE - Dragging images between tabs to Google Photos does not work"), [1801499](/show_bug.cgi?id=1801499 "RESOLVED DUPLICATE - drive.google.com - it's not possible to drag images across tabs to Google Drive")

[1864756](/show_bug.cgi?id=1864756 "RESOLVED DUPLICATE - Allow to drag files from websites for uploading them")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1732528](/show_bug.cgi?id=1732528 "RESOLVED FIXED - Stop putting Blobs into nsITransferable when converting from DataTransfer")

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

1

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1437126 - Support imgIContainer as a file type in DataTransfer. r?nika](/attachment.cgi?id=9304307)  [2 years ago](#c1)  [Tom S](/user_profile?user_id=393835)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9304307&action=edit) | [Review](/attachment.cgi?id=9304307) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mike Hoye [:mhoye]](/user_profile?user_id=461850)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1437126#c0)• 7 years ago |
|  | |

Feature request:
If you've got an image in one tab and an input box that accepts it in another (e.g. Slack) then dragging an image out of one tab into another should bring over the image, not the URL.

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a36279247_6102)• 6 years ago |

Priority: -- → P5

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a143580358_434964)• 2 years ago |

Blocks: [1787627](/show_bug.cgi?id=1787627 "RESOLVED DUPLICATE - Dragging images between tabs to Google Photos does not work")

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a147324207_546015)• 2 years ago |

Severity: normal → S3

|  | [08xjcec48](/user_profile?user_id=452201) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a150692211_452201)• 2 years ago |

Depends on: [1801499](/show_bug.cgi?id=1801499 "RESOLVED DUPLICATE - drive.google.com - it's not possible to drag images across tabs to Google Drive")

|  | [08xjcec48](/user_profile?user_id=452201) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a150692318_452201)• 2 years ago |

Blocks: [1801499](/show_bug.cgi?id=1801499 "RESOLVED DUPLICATE - drive.google.com - it's not possible to drag images across tabs to Google Drive")No longer depends on: [1801499](/show_bug.cgi?id=1801499 "RESOLVED DUPLICATE - drive.google.com - it's not possible to drag images across tabs to Google Drive")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1437126#c1)• 2 years ago |
|  | |

Attached file
[Bug 1437126 - Support imgIContainer as a file type in DataTransfer. r?nika](attachment.cgi?id=9304307)
— [Details](attachment.cgi?id=9304307&action=edit)

When using images with drag & drop (or the clipboard) we use two or more different types:

* When dragging an image we put it into the DataTransfer object using the

  type kNativeImageMime and the data as an imgIContainer object.
* When dropping an image we want to have some kind of image/ type,

  but the data is already supposed to be a File or nsIInputStream when it comes from the OS.

This weird split usually works fine, because in our GTK, Windows and macOS code

we first convert imgIContainer to whatever native image format is required when

dragging something and then convert back to a file (or stream) when dropping.

What however doesn't work is when we never actually round-trip through the OS.

In that case we have the imgIContainer that we can't drop in a meaningful way.

(I actually already ran into this issue in [bug 1396587](/show_bug.cgi?id=1396587 "NEW - Colors of pasted image differ from original image (incorrect TIFF -> PNG/JPG conversion?)") with the clipboard,

but we kind of resolved this by always doing the roundtrip through the OS's clipboard)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a150749349_600971)• 2 years ago |

Assignee: nobody → evilpiesStatus: NEW → ASSIGNED

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1437126#c2)• 2 years ago |
|  | |

The only real downside of this approach is that we aren't dragging the original file, but that would probably be harder to solve. We would have to

* Actually download the file from the promise URL
* or, actually put the original image bytes onto DataTransfer (not sure if those still exists when dragging)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1437126#c3)• 2 years ago |
|  | |

Pushed by evilpies@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/045be3cab17d>
Support imgIContainer as a file type in DataTransfer. r=nika

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a151170737_393835)• 2 years ago |

Duplicate of this bug: [1801499](/show_bug.cgi?id=1801499 "RESOLVED DUPLICATE - drive.google.com - it's not possible to drag images across tabs to Google Drive")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a151170747_393835)• 2 years ago |

No longer blocks: [1801499](/show_bug.cgi?id=1801499 "RESOLVED DUPLICATE - drive.google.com - it's not possible to drag images across tabs to Google Drive")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a151170868_393835)• 2 years ago |

No longer blocks: [1787627](/show_bug.cgi?id=1787627 "RESOLVED DUPLICATE - Dragging images between tabs to Google Photos does not work")Duplicate of this bug: [1787627](/show_bug.cgi?id=1787627 "RESOLVED DUPLICATE - Dragging images between tabs to Google Photos does not work")

|  | [Serban Stanca [:SerbanS]](/user_profile?user_id=713502) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1437126#c6)• 2 years ago |
|  | |

Backed out for causing mochitests failures on test\_drag\_image\_file.html.

* [Backout link](https://hg.mozilla.org/integration/autoland/rev/0ec844261b11e484d6d4d504d89e0b3cf201e624)
* [Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&resultStatus=testfailed%2Cbusted%2Cexception%2Cusercancel&fromchange=045be3cab17db62b0e47361147a4b531e1fd8713&tochange=0ec844261b11e484d6d4d504d89e0b3cf201e624&selectedTaskRun=DBVnxP6QTh-YXzcf8Jb9fQ.0)
* [Failure Log](https://treeherder.mozilla.org/logviewer?job_id=397689925&repo=autoland)
* Failure line: TEST-UNEXPECTED-FAIL | dom/events/test/test\_drag\_image\_file.html | Test timed out. -
Flags: needinfo?(evilpies)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1437126#c7)• 2 years ago |
|  | |

Pushed by evilpies@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/0b1c624fed3f>
Support imgIContainer as a file type in DataTransfer. r=nika

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a151443152_393835)• 2 years ago |

Flags: needinfo?(evilpies)

|  | [Serban Stanca [:SerbanS]](/user_profile?user_id=713502) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1437126#c8)• 2 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/0b1c624fed3f>

Status: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 109 Branch

|  | [Iulian Moraru](/user_profile?user_id=682863) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a151554738_682863)• 2 years ago |

Regressions: [1802904](/show_bug.cgi?id=1802904 "RESOLVED INCOMPLETE - Intermittent dom/events/test/test_drag_image_file.html | single tracking bug")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a153346716_393835)• 2 years ago |

Duplicate of this bug: [1000690](/show_bug.cgi?id=1000690 "RESOLVED DUPLICATE - I should be able to drag an image from a webpage to the browse button of an <input type=file>")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a153350509_393835)• 2 years ago |

See Also: → [1732528](/show_bug.cgi?id=1732528 "RESOLVED FIXED - Stop putting Blobs into nsITransferable when converting from DataTransfer")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a156554135_393835)• 2 years ago |

Regressions: [1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a157056419_393835)• 2 years ago |

Regressions: [CVE-2023-25741](/show_bug.cgi?id=1813376 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop")

|  | [Ardelean Oana, Desktop Test Engineering [:oardelean]](/user_profile?user_id=700963) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a157060262_700963)• 2 years ago |

Regressions: [1814388](/show_bug.cgi?id=1814388 "RESOLVED FIXED - [Yahoo] Emojis get enlarged if using Drag & Drop")

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1437126#c10)• 2 years ago |
|  | |

This was disabled by default in [bug 1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped"). Not sure when I will have time to fix these issues.

Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a160129829_75935)• 2 years ago |

Status: REOPENED → NEW
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=disabled)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=disabled)Target Milestone: 109 Branch → ---

|  | [Tom S](/user_profile?user_id=393835)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1437126#a181844706_393835)• 1 year ago |

Duplicate of this bug: [1864756](/show_bug.cgi?id=1864756 "RESOLVED DUPLICATE - Allow to drag files from websites for uploading them")

|  | [u752148](/user_profile?user_id=752148) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1437126#c12)• 7 months ago |
|  | |

Tom, can you please raise the priority of this bug? It's still set to P5, even though you worked on `dom.events.dataTransfer.imageAsFile.enabled` years ago.

This feature is supported by Chromium browsers and is more relevant now - with the proliferation of web apps - than it was back when this issue was created.

You need to [log in](/show_bug.cgi?id=1437126&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom S](/user_profile?user_id=393835)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_3f00ab64_20250114_210704.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1812611)
* [XML](/show_bug.cgi?ctype=xml&id=1812611)

Closed
[Bug 1812611](/show_bug.cgi?id=1812611)

Opened 2 years ago
Closed 2 years ago

# Drag and Drop dataTransfer.files populated when some types of Image element dropped

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Drag and Drop dataTransfer.files populated when some types of Image element dropped

## Categories

### (Core :: DOM: Copy & Paste and Drag & Drop, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop#DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)

DOM: Copy & Paste and Drag & Drop
▾

Core :: DOM: Copy & Paste and Drag & Drop
All issues with copy-and-paste and drag-and-drop can be reported here, be it with the web API or the platform backends. This includes clipboard issues.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 109

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 | + | verified |
| firefox111 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: services, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3972b32ad192bd79ed1d3d68bc59dda1?d=mm&size=40)  [services](/user_profile?user_id=721188)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2023-25741](/show_bug.cgi?id=1813376 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop")

Dependency [tree](/showdependencytree.cgi?id=1812611&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1812611)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-25741](/show_bug.cgi?id=1813376 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop")

## Details

### (Keywords: regression)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [WIP: Bug 1812611 - Detect same page drags and don't provide images as files in that case](/attachment.cgi?id=9314699)  [2 years ago](#c7)  [Tom S](/user_profile?user_id=393835)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9314699&action=edit) | [Review](/attachment.cgi?id=9314699) |
| --- | --- | --- |
| [Bug 1812611 - Disable image dragging as files by default again. r?nika](/attachment.cgi?id=9315376)  [2 years ago](#c11)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c20 "2 years ago") | [Details](/attachment.cgi?id=9315376&action=edit) | [Review](/attachment.cgi?id=9315376) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [services](/user_profile?user_id=721188)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1812611#c0)• 2 years ago |
|  | |

User Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:109.0) Gecko/20100101 Firefox/109.0

Steps to reproduce:

After update from Firefox 108 to 109, a drop action between elements in a Vaadin web application no longer worked. After investigation, it appears the problem is application is interpreting drop as a FileDrop (file upload) rather than a regular DOM element drop, because the dataTransfer object is populating files array. See example jsfiddle:

<https://jsfiddle.net/ksgvyhjm/2/>

Issue is happening in Firefox on Linux and Windows desktops.

Actual results:

Dragging an image within the page to a drop target triggers a drop event containing files in the dataTransfer.files array, even though there is no actual usable file path. In the example, the dragged image with a jpeg source is actually reported as as having filename "image.png" and type "image/png", neither of which is actually true.

Dragging the other image on the page does not populate the files array.

Dragging a file from the OS file system does report the file information as expected.

Expected results:

Dragging image elements within the page to the drop target within the same page should not be populating the dataTransfer.files list.

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a2602_293623)• 2 years ago |

Component: Untriaged → DOM: Copy & Paste and Drag & DropProduct: Firefox → Core

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a2706_455480)• 2 years ago |

Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1812611#c1)• 2 years ago |
|  | |

This is an intentional change from [bug 1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.").

Regressed by: [1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a5932_393835)• 2 years ago |

Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a7326_575867)• 2 years ago |

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [services](/user_profile?user_id=721188)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1812611#c2)• 2 years ago |
|  | |

Is there a way to define a draggable img so that it will not be added to the Files as a pseudo-file?

For example, the breaking case on the existing application is where a visual thumbnail/icon image is being dragged to a grid control as part of a database record edit form. The target should not respond to drops of files from the OS in this case, and would not expect the dragged visual element to be reported as a file.

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1812611#c3)• 2 years ago |
|  | |

> Is there a way to define a draggable img so that it will not be added to the Files as a pseudo-file?

Not really. You could prevent it from being dragged in the first place though. You can also check `event.dataTransfer.mozSourceNode !== null` on the drop handler.

We might consider not putting the image data into DataTransfer for a drag&drop on the same. That seems like a hack to me though, when it works (differently) dragging across from another tab.

|  | [services](/user_profile?user_id=721188)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1812611#c4)• 2 years ago |
|  | |

Agree that treating image drag from same page differently from other tab would be a terrible hack.

Unfortunately, the 1437126 fix has broken apps built on top of Vaadin 8 drag and drop, which may be a sizeable code base, and I fear the easiest solution is people will just switch to using Chrome which doesn't seem to do the populating Files for dragged IMG.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1812611#c5)• 2 years ago |
|  | |

needinfoing evilpie for ideas of how to not break Vaadin 8.

It seems to me that Vaadin 8 itself has been EOLed and apps are supposed to upgrade. As these things go, it seems quite possible that the old version will continue to be deployed out there after EOL.

Flags: needinfo?(evilpies)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1812611#c6)• 2 years ago |
|  | |

I tried to come up with something that let's us detect same page drags, but somehow that turned out to be more difficult than I expected. `DataTransfer::mIsExternal` doesn't seem to work for this. The closest match I have found is `nsContentUtils::GetDragSession()` returning null? I produce a somewhat ugly patch for this. Maybe Nika has some ideas.

Flags: needinfo?(evilpies) → needinfo?(nika)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1812611#c7)• 2 years ago |
|  | |

Attached file
[WIP: Bug 1812611 - Detect same page drags and don't provide images as files in that case](attachment.cgi?id=9314699) (obsolete)
— [Details](attachment.cgi?id=9314699&action=edit)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a412106_393835)• 2 years ago |

See Also: → [CVE-2023-25741](/show_bug.cgi?id=1813376 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop")

|  | [services](/user_profile?user_id=721188)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1812611#c8)• 2 years ago |
|  | |

FWIW, I am working around this issue by constructing the draggable image as an empty div with the background-image css set to the required image. That seems to be the only semantic way that I can declare my 'intent' that a drop target should not interpret the dragged element as an image file.

The W3C spec seems to permit the Files array in the dataTransfer to refer to actual OS files or dynamically created / in-memory objects, as long as they have a 'filename' and a data stream.

The use case addressed in 1437126 appears just as valid as the issue highlighted here.. It is a benefit to the user to be able to drag an image element as if it were a file in cases where they want to submit that image data to a web form.

It feels like the ideal solution would be some way to declare that a draggable element should/should not be presented as a file (i.e. something cleaner than using background image approach).. perhaps there is a way to do this already in the spec but I have missed it?

Thank you Tom S. I appreciate your prompt and earnest efforts with this issue.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1812611#c9)• 2 years ago |
|  | |

(In reply to Tom S [:evilpie] from [comment #6](/show_bug.cgi?id=1812611#c6 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped"))

> I tried to come up with something that let's us detect same page drags, but somehow that turned out to be more difficult than I expected. `DataTransfer::mIsExternal` doesn't seem to work for this. The closest match I have found is `nsContentUtils::GetDragSession()` returning null? I produce a somewhat ugly patch for this. Maybe Nika has some ideas.

I'm not sure I love the approach of making same-page drags dramatically different from cross-page drags in e.g. what values are added to the drag session.

I'm a bit curious what behaviour other browsers like chrome have in this situation around dragging an image element. It seems desirable that we align with their behaviour in general to be as compatible as possible.

Flags: needinfo?(nika)

|  | [services](/user_profile?user_id=721188)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1812611#c10)• 2 years ago |
|  | |

Testing drop event using the original JSFiddle example in Chrome 109.0.5414.74 :

Drag the corgi IMG on same page to target:

dataTransfer.files is empty

Drag the corgi IMG from a different Chromium tab:

dataTransfer.files[0]

lastModified: 1675200212654

lastModifiedDate: Tue Jan 31 2023 16:23:32 GMT-0500 (Eastern Standard Time) {}

name: "Pembroke-Welsh-Corgi-320x240.jpg"

size: 53026

type: "image/jpeg"

webkitRelativePath: ""

Drag an actual copy of the corgi jpg on disk from OS file manager (modifiedDate is on-disk file time):

dataTransfer.files[0]

lastModified: 1675199955773

lastModifiedDate: Tue Jan 31 2023 16:19:15 GMT-0500 (Eastern Standard Time) {}

name: "Pembroke-Welsh-Corgi-320x240.jpg"

size: 53026

type: "image/jpeg"

webkitRelativePath: ""

Drag the corgi IMG to Chrome from the page opened in Firefox (size reported as 0):

lastModified: 1675200413596

lastModifiedDate: Tue Jan 31 2023 16:26:53 GMT-0500 (Eastern Standard Time) {}

name: "Pembroke-Welsh-Corgi-320x240.jpeg"

size: 0

type: "image/jpeg"

webkitRelativePath: ""

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1812611#c11)• 2 years ago |
|  | |

Attached file
[Bug 1812611 - Disable image dragging as files by default again. r?nika](attachment.cgi?id=9315376)
— [Details](attachment.cgi?id=9315376&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a514198_600971)• 2 years ago |

Assignee: nobody → tschusterStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1812611#c12)• 2 years ago |
|  | |

We didn't support for dragging images as files for almost 10 years, so probably nobody depends on this terribly. This patch should also be easy to uplift to fix the other regressions.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1812611#c13)• 2 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a515972_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a515997_75935)• 2 years ago |

[tracking-firefox110](/buglist.cgi?f1=cf_tracking_firefox110&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)

|  | [j.niegowski](/user_profile?user_id=721528) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1812611#c14)• 2 years ago |
|  | |

Since Firefox 109, access to the `DataTransfer#files` became extremely slow/expensive. This was reported by CKEditor 5 user as a regression in <https://github.com/ckeditor/ckeditor5/issues/13366>.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1812611#c15)• 2 years ago |
|  | |

(In reply to j.niegowski from [comment #14](/show_bug.cgi?id=1812611#c14 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped"))

> Since Firefox 109, access to the `DataTransfer#files` became extremely slow/expensive. This was reported by CKEditor 5 user as a regression in <https://github.com/ckeditor/ckeditor5/issues/13366>.

Thanks for the report. Please file a new bug for this (in the same component as this one) as that will make it easier to track multiple regressions.

Flags: needinfo?(j.niegowski)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1812611#c16)• 2 years ago |
|  | |

Pushed by tschuster@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/eb43450f5957>
Disable image dragging as files by default again. r=nika

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a545336_1689)• 2 years ago |

Blocks: [CVE-2023-25741](/show_bug.cgi?id=1813376 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop")

|  | [Atila Butkovits](/user_profile?user_id=661920) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1812611#c17)• 2 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/eb43450f5957>

Status: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 111 Branch

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a586364_600971)• 2 years ago |

[Attachment #9314699](/attachment.cgi?id=9314699&action=edit "WIP: Bug 1812611 - Detect same page drags and don't provide images as files in that case") -
Attachment is obsolete: true

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1812611#c18)• 2 years ago |
|  | |

Please request uplift to our last beta, thanks!

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1812611#c19)• 2 years ago |
|  | |

Comment on [attachment 9315376](/attachment.cgi?id=9315376 "Bug 1812611 - Disable image dragging as files by default again. r?nika") [[details]](/attachment.cgi?id=9315376&action=edit "Bug 1812611 - Disable image dragging as files by default again. r?nika")

[Bug 1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped") - Disable image dragging as files by default again. r?nika

### Beta/Release Uplift Approval Request

* **User impact if declined**: Performance, usability issues on different websites. Other regressions.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: We disable a new feature that was only on in one release.
* **String changes made/needed**:
* **Is Android affected?**: Unknown
Flags: needinfo?(tschuster)
[Attachment #9315376](/attachment.cgi?id=9315376&action=edit "Bug 1812611 - Disable image dragging as files by default again. r?nika") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1812611#c20)• 2 years ago |
|  | |

Comment on [attachment 9315376](/attachment.cgi?id=9315376 "Bug 1812611 - Disable image dragging as files by default again. r?nika") [[details]](/attachment.cgi?id=9315376&action=edit "Bug 1812611 - Disable image dragging as files by default again. r?nika")

[Bug 1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped") - Disable image dragging as files by default again. r?nika

Approved for our last 110 beta, thanks.

[Attachment #9315376](/attachment.cgi?id=9315376&action=edit "Bug 1812611 - Disable image dragging as files by default again. r?nika") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1812611#c21)• 2 years ago |
| bugherder uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/89be7eb4b569>

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a664761_553429)• 2 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a665307_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1812611#c22)• 2 years ago |
|  | |

Reproduced the initial issue described in [comment 0](/show_bug.cgi?id=1812611#c0 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped") using an old Nightly build from 2023-01-26, verified using the test case from [comment 0](/show_bug.cgi?id=1812611#c0 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped") that this is no longer an issue using latest Nightly build from today and latest Beta build 110.0b9 across platforms (Windows 10, macOS 13 and Ubuntu 22.04).

Status: RESOLVED → VERIFIED
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified)Flags: qe-verify+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1812611#a39687751_406194)• 9 months ago |

Flags: needinfo?(j.niegowski)
You need to [log in](/show_bug.cgi?id=1812611&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tom S](/user_profile?user_id=393835)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ce722dd0_20250114_210706.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-05

## Security Vulnerabilities fixed in Firefox 110

Announced
February 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 110

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-25743: Fullscreen notification not shown in Firefox Focus](#CVE-2023-25743)

Reporter
Hafiizh
Impact
high
##### Description

A lack of in app notification for entering fullscreen mode could have lead to a malicious website spoofing browser chrome.
*This bug only affects Firefox Focus. Other versions of Firefox are unaffected.*

##### References

* [Bug 1800203](https://bugzilla.mozilla.org/show_bug.cgi?id=1800203)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25740: Opening local .scf files could cause unexpected network loads](#CVE-2023-25740)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

After downloading a Windows `.scf` script from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1812354](https://bugzilla.mozilla.org/show_bug.cgi?id=1812354)

#### [#CVE-2023-25731: Prototype pollution when rendering URLPreview](#CVE-2023-25731)

Reporter
pyakovlev & Alexander Volkov
Impact
low
##### Description

Due to URL previews in the network panel of developer tools improperly storing URLs, query parameters could potentially be used to overwrite global objects in privileged code.

##### References

* [Bug 1801542](https://bugzilla.mozilla.org/show_bug.cgi?id=1801542)

#### [#CVE-2023-25733: Possible null pointer dereference in TaskbarPreviewCallback](#CVE-2023-25733)

Reporter
Ronald Crane
Impact
low
##### Description

The return value from `gfx::SourceSurfaceSkia::Map()` wasn't being verified which could have potentially lead to a null pointer dereference.

##### References

* [Bug 1808632](https://bugzilla.mozilla.org/show_bug.cgi?id=1808632)

#### [#CVE-2023-25736: Invalid downcast in GetTableSelectionMode](#CVE-2023-25736)

Reporter
Lukas Bernhard
Impact
low
##### Description

An invalid downcast from `nsHTMLDocument` to `nsIContent` could have lead to undefined behavior.

##### References

* [Bug 1811331](https://bugzilla.mozilla.org/show_bug.cgi?id=1811331)

#### [#CVE-2023-25741: Same-origin policy leak via image drag and drop](#CVE-2023-25741)

Reporter
Dohyun Lee (@l33d0hyun) of SSD Labs
Impact
low
##### Description

When dragging and dropping an image cross-origin, the image's size could potentially be leaked. This behavior was shipped in 109 and caused web compatibility problems as well as this security concern, so the behavior was disabled until further review.

##### References

* [Bug 1813376](https://bugzilla.mozilla.org/show_bug.cgi?id=1813376)
* [Bug 1437126](https://bugzilla.mozilla.org/show_bug.cgi?id=1437126)
* [Bug 1812611](https://bugzilla.mozilla.org/show_bug.cgi?id=1812611)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25745: Memory safety bugs fixed in Firefox 110](#CVE-2023-25745)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Gabriele Svelto, Jeff Muizelaar and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1688592%2C1797186%2C1804998%2C1806521%2C1813284)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_f8abd48d_20250114_210706.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1813376)
* [XML](/show_bug.cgi?ctype=xml&id=1813376)

Closed
[Bug 1813376](/show_bug.cgi?id=1813376)
(CVE-2023-25741)

Opened 2 years ago
Closed 2 years ago

# Same-Origin Policy Bypass Image Size Leak in Drag and Drop

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Same-Origin Policy Bypass Image Size Leak in Drag and Drop

## Categories

### (Core :: DOM: Copy & Paste and Drag & Drop, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop#DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)

DOM: Copy & Paste and Drag & Drop
▾

Core :: DOM: Copy & Paste and Drag & Drop
All issues with copy-and-paste and drag-and-drop can be reported here, be it with the web API or the platform backends. This includes clipboard issues.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 109

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified) |
| firefox112 | --- | [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | unaffected |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 | + | verified |
| firefox111 | + | verified |
| firefox112 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: d4ni31, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9f3fb4858f5405493513e52dfce6dc62?d=mm&size=40)  [d4ni31](/user_profile?user_id=683497)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1813376&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1813376)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1264873 "https://bugs.chromium.org/p/chromium/issues/detail?id=1264873")

[bugs.webkit.org/show\_bug.cgi?id=245058](https://bugs.webkit.org/show_bug.cgi?id=245058 "https://bugs.webkit.org/show_bug.cgi?id=245058")

## Details

### (4 keywords, Whiteboard: [disclosure deadline 2023-04-29][adv-main110+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25741

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[disclosure deadline 2023-04-29][adv-main110+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a811016_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=9314748)  [2 years ago](#c0)  [D4ni31 [:d4ni31]](/user_profile?user_id=683497)   847 bytes, text/html |  | [Details](/attachment.cgi?id=9314748&action=edit) |
| --- | --- | --- |
| [leak.jpg](/attachment.cgi?id=9314749)  [2 years ago](#c1)  [D4ni31 [:d4ni31]](/user_profile?user_id=683497)   84.62 KB, image/jpeg |  | [Details](/attachment.cgi?id=9314749&action=edit) |
| [advisory.txt](/attachment.cgi?id=9317101)  [2 years ago](#c15)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   158 bytes, text/plain |  | [Details](/attachment.cgi?id=9317101&action=edit) |
| [advisory.txt](/attachment.cgi?id=9317335)  [2 years ago](#c18)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   183 bytes, text/plain |  | [Details](/attachment.cgi?id=9317335&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1813376#c0)• 2 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9314748)
— [Details](attachment.cgi?id=9314748&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36

Steps to reproduce:

## Title

* Same-Origin Policy Bypass Image Size Leak in Drag and Drop

## Summary

* A Same-Origin Policy Bypass vulnerability exists in the Drag and Drop
* If this vulnerability is exploited, it is possible to bypass the Same-Origin Policy and leak the size of the Image.

## Test environment

* Product : Mozilla Firefox 109
* OS : Windows 10 (21H2), macOS Ventura 13.2

## Proof-of-Concept

* Please check the attached file!

## Reproduce

* Open the server and access the poc page.
* When you drag and drop an image, the size of the image is leaked.

## CREDIT Information

* Dohyun Lee (@l33d0hyun) of SSD Labs

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1813376#c1)• 2 years ago |
|  | |

Attached image
[leak.jpg](attachment.cgi?id=9314749)
— [Details](attachment.cgi?id=9314749&action=edit)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1813376#c2)• 2 years ago |
|  | |

similar case:

[CVE-2022-42824](https://www.cve.org/CVERecord?id=CVE-2022-42824) : Same-Origin Policy Bypass Image Size Leak in Apple Safari

<https://support.apple.com/ko-kr/HT213495>

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1813376#c3)• 2 years ago |
|  | |

```
This bug is subject to a 90-day disclosure deadline. If a fix for this
issue is made available to users before the end of the 90-day deadline,
this bug report will become public 30 days after the fix was made
available. Otherwise, this bug report will become public at the deadline.
The scheduled deadline is 2023-04-29.

```

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a114909_406194)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Untriaged → DOM: Copy & Paste and Drag & DropProduct: Firefox → Core

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1813376#c4)• 2 years ago |
|  | |

[Bug 1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped") should fix this case, we would simply not allow access to the image data when dragging in the same tab.

See Also: → [1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1813376#c5)• 2 years ago |
|  | |

Does that mean this is also a regression from [bug 1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a188698_406194)• 2 years ago |

Flags: needinfo?(evilpies)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a188726_406194)• 2 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a265379_393835)• 2 years ago |

Flags: needinfo?(evilpies)Regressed by: [1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1813376#c6)• 2 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1437126](/show_bug.cgi?id=1437126 "NEW - drag/dropping image from one tab into another should drop the image, not the URL.")

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1813376#c7)• 2 years ago |
|  | |

This vulnerability works in the same way as the Safari SOP Bypass vulnerabilities I recently reported to Apple, [CVE-2022-42824](https://www.cve.org/CVERecord?id=CVE-2022-42824) and [CVE-2022-46698](https://www.cve.org/CVERecord?id=CVE-2022-46698).

There was no mention of firefox, but the PoC([CVE-2022-42824](https://www.cve.org/CVERecord?id=CVE-2022-42824), [CVE-2022-46698](https://www.cve.org/CVERecord?id=CVE-2022-46698)) for it has been released to some people, so a quick patch may be needed.

+crbug.com/1264873 has a very similar poc.

* Please set the sec-level and severity.
Flags: needinfo?(evilpies)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a273357_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[tracking-firefox110](/buglist.cgi?f1=cf_tracking_firefox110&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a280381_406194)• 2 years ago |

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1264873>

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1813376#c8)• 2 years ago |
|  | |

We'll look at this bug later today in our security triage meeting and assign a rating, hopefully.

Flags: needinfo?(evilpies)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a302513_1689)• 2 years ago |

Depends on: [1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped")Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)See Also: → <https://bugs.webkit.org/show_bug.cgi?id=245058>Whiteboard: [disclosure deadline 2023-04-29]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a302551_1689)• 2 years ago |

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a309754_683497)• 2 years ago |

Flags: sec-bounty?

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1813376#c9)• 2 years ago |
|  | |

The bug is marked as tracked for firefox110 (beta) and tracked for firefox111 (nightly). We have limited time to fix this, the soft freeze is in 7 days. However, the bug still isn't assigned.

:hsinyi, could you please find an assignee for this tracked bug? Given that it is a regression and we know the cause, we could also simply backout the regressor. If you disagree with the tracking decision, please talk with the release managers.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#tracked_attention.py).

Flags: needinfo?(htsai)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1813376#c10)• 2 years ago |
|  | |

Tom, could you mark this bug as fixed if it was indeed entirely fixed by [bug 1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped")? Thanks.

Assignee: nobody → tschusterFlags: needinfo?(htsai) → needinfo?(tschuster)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a364078_406194)• 2 years ago |

Severity: -- → S2Priority: -- → P2

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1813376#c11)• 2 years ago |
|  | |

This indeed entirely fixed by disabling the feature as done in [bug 1812611](/show_bug.cgi?id=1812611 "VERIFIED FIXED - Drag and Drop dataTransfer.files populated when some types of Image element dropped").

Status: NEW → RESOLVEDClosed: 2 years agoFlags: needinfo?(tschuster)Resolution: --- → FIXED

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1813376#c12)• 2 years ago |
|  | |

Hi!

can i get a cve id??

Flags: needinfo?(tschuster)

|  | [Tom S](/user_profile?user_id=393835) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1813376#c13)• 2 years ago |
|  | |

Please stop need-infoing me. Other people will look at this.

Flags: needinfo?(tschuster)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a365743_406194)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a366011_24572)• 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1813376#c14)• 2 years ago |
|  | |

(In reply to DoHyun Lee from [comment #12](/show_bug.cgi?id=1813376#c12 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop"))

> can i get a cve id??

CVEs are typically assigned closer to release of the versions where fixes are shipped. If you are wondering about bug bounties, the bug bounty committee typically meets once a week to make decisions about those. This bug will be updated when either of those things happens.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a405091_75935)• 2 years ago |

Group: dom-core-security → core-security-releaseTarget Milestone: --- → 111 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a811016_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1813376#c15)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317101) (obsolete)
— [Details](attachment.cgi?id=9317101&action=edit)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1813376#c16)• 2 years ago |
|  | |

CREDIT Information,

Dohyun Lee (@l33d0hyun) of SSD Labs

Thanks!

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a1060263_578488)• 2 years ago |

Whiteboard: [disclosure deadline 2023-04-29] → [disclosure deadline 2023-04-29][adv-main110+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a1288596_428608)• 2 years ago |

Alias: CVE-2023-25741

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1813376#c17)• 2 years ago |
|  | |

(In reply to DoHyun Lee from [comment #16](/show_bug.cgi?id=1813376#c16 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop"))

> CREDIT Information,
>
> Dohyun Lee (@l33d0hyun) of SSD Labs
>
> Thanks!

Please check [comment 16](/show_bug.cgi?id=1813376#c16 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop")!

Flags: needinfo?(tom)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1813376#c18)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317335)
— [Details](attachment.cgi?id=9317335&action=edit)

[Attachment #9317101](/attachment.cgi?id=9317101&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1813376#c19)• 2 years ago |
|  | |

Done.

Flags: needinfo?(tom)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1813376#c20)• 2 years ago |
|  | |

Thank you :)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a3115267_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify+

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1813376#c21)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1813376&comment_id=16313427 "4 revisions") |
|  | |

Reproduced the issue with Firefox 111.0a1 (2023-01-29) on Windows 10x64. Loaded the attached test case inside a simple python server and dragged an image which resulted in showing the image size in an alert box.

The image size alert box is no longer displayed when dragging the images from the attached test case with Firefox 110.0.1, 111.0b8 and 112.0a1 (2023-03-05) on Windows 10x64, macOS 12 and Ubuntu 20.04.

Just to be extra safe, is the above verification enough? I am not sure if I should look for anything else in order to verify this issue. Thank you in advance!

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1813376#c22)• 2 years ago |
|  | |

Thanks Alexandru!

> Just to be extra safe, is the above verification enough? I am not sure if I should look for anything else in order to verify this issue. Thank you in advance!

That is good enough. I had previously verified the fix on Nightly myself as well.

Flags: needinfo?(tschuster)

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1813376#c23)• 2 years ago |
|  | |

(In reply to Tom Schuster (MoCo) from [comment #22](/show_bug.cgi?id=1813376#c22 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop"))

> Thanks Alexandru!
>
> > Just to be extra safe, is the above verification enough? I am not sure if I should look for anything else in order to verify this issue. Thank you in advance!
>
> That is good enough. I had previously verified the fix on Nightly myself as well.

Thank you!

Closing per [comment 21](/show_bug.cgi?id=1813376#c21 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop") and [comment 22](/show_bug.cgi?id=1813376#c22 "VERIFIED FIXED - Same-Origin Policy Bypass Image Size Leak in Drag and Drop").

Status: RESOLVED → VERIFIED
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a22610424_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813376#a42102483_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1813376&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [D4ni31 [:d4ni31]](/user_profile?user_id=683497)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


