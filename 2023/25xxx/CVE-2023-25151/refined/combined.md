=== Content from github.com_9b660eb4_20250115_091758.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go%2Fblob%2Fv1.12.0%2Fsemconv%2Finternal%2Fv2%2Fhttp.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go%2Fblob%2Fv1.12.0%2Fsemconv%2Finternal%2Fv2%2Fhttp.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go](/open-telemetry/opentelemetry-go)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go)
* [Star
   5.4k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go)

* [Code](/open-telemetry/opentelemetry-go/tree/v1.12.0)
* [Issues
  156](/open-telemetry/opentelemetry-go/issues)
* [Pull requests
  34](/open-telemetry/opentelemetry-go/pulls)
* [Discussions](/open-telemetry/opentelemetry-go/discussions)
* [Actions](/open-telemetry/opentelemetry-go/actions)
* [Projects
  5](/open-telemetry/opentelemetry-go/projects)
* [Security](/open-telemetry/opentelemetry-go/security)
* [Insights](/open-telemetry/opentelemetry-go/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go/tree/v1.12.0)
* [Issues](/open-telemetry/opentelemetry-go/issues)
* [Pull requests](/open-telemetry/opentelemetry-go/pulls)
* [Discussions](/open-telemetry/opentelemetry-go/discussions)
* [Actions](/open-telemetry/opentelemetry-go/actions)
* [Projects](/open-telemetry/opentelemetry-go/projects)
* [Security](/open-telemetry/opentelemetry-go/security)
* [Insights](/open-telemetry/opentelemetry-go/pulse)

## Files

Â v1.12.0
## Breadcrumbs

1. [opentelemetry-go](/open-telemetry/opentelemetry-go/tree/v1.12.0)
2. /[semconv](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv)
3. /[internal](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal)
4. /[v2](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal/v2)
/
# http.go

Copy path Blame  Blame
## Latest commit

## History

[History](/open-telemetry/opentelemetry-go/commits/v1.12.0/semconv/internal/v2/http.go)405 lines (364 loc) Â· 11.5 KBÂ v1.12.0
## Breadcrumbs

1. [opentelemetry-go](/open-telemetry/opentelemetry-go/tree/v1.12.0)
2. /[semconv](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv)
3. /[internal](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal)
4. /[v2](/open-telemetry/opentelemetry-go/tree/v1.12.0/semconv/internal/v2)
/
# http.go

Top
## File metadata and controls

* Code
* Blame

405 lines (364 loc) Â· 11.5 KB[Raw](https://github.com/open-telemetry/opentelemetry-go/raw/refs/tags/v1.12.0/semconv/internal/v2/http.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405// Copyright The OpenTelemetry Authors//// Licensed under the Apache License, Version 2.0 (the "License");// you may not use this file except in compliance with the License.// You may obtain a copy of the License at//// http://www.apache.org/licenses/LICENSE-2.0//// Unless required by applicable law or agreed to in writing, software// distributed under the License is distributed on an "AS IS" BASIS,// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.// See the License for the specific language governing permissions and// limitations under the License.
package internal // import "go.opentelemetry.io/otel/semconv/internal/v2"
import ( "fmt" "net/http" "strings"
 "go.opentelemetry.io/otel/attribute" "go.opentelemetry.io/otel/codes")
// HTTPConv are the HTTP semantic convention attributes defined for a version// of the OpenTelemetry specification.type HTTPConv struct { NetConv \*NetConv
 EnduserIDKey attribute.Key HTTPClientIPKey attribute.Key HTTPFlavorKey attribute.Key HTTPMethodKey attribute.Key HTTPRequestContentLengthKey attribute.Key HTTPResponseContentLengthKey attribute.Key HTTPRouteKey attribute.Key HTTPSchemeHTTP attribute.KeyValue HTTPSchemeHTTPS attribute.KeyValue HTTPStatusCodeKey attribute.Key HTTPTargetKey attribute.Key HTTPURLKey attribute.Key HTTPUserAgentKey attribute.Key}
// ClientResponse returns attributes for an HTTP response received by a client// from a server. The following attributes are returned if the related values// are defined in resp: "http.status.code", "http.response\_content\_length".//// This does not add all OpenTelemetry required attributes for an HTTP event,// it assumes ClientRequest was used to create the span with a complete set of// attributes. If a complete set of attributes can be generated using the// request contained in resp. For example://// append(ClientResponse(resp), ClientRequest(resp.Request)...)func (c \*HTTPConv) ClientResponse(resp \*http.Response) []attribute.KeyValue { var n int if resp.StatusCode > 0 { n++ } if resp.ContentLength > 0 { n++ }
 attrs := make([]attribute.KeyValue, 0, n) if resp.StatusCode > 0 { attrs = append(attrs, c.HTTPStatusCodeKey.Int(resp.StatusCode)) } if resp.ContentLength > 0 { attrs = append(attrs, c.HTTPResponseContentLengthKey.Int(int(resp.ContentLength))) } return attrs}
// ClientRequest returns attributes for an HTTP request made by a client. The// following attributes are always returned: "http.url", "http.flavor",// "http.method", "net.peer.name". The following attributes are returned if the// related values are defined in req: "net.peer.port", "http.user\_agent",// "http.request\_content\_length", "enduser.id".func (c \*HTTPConv) ClientRequest(req \*http.Request) []attribute.KeyValue { n := 3 // URL, peer name, proto, and method. var h string if req.URL != nil { h = req.URL.Host } peer, p := firstHostPort(h, req.Header.Get("Host")) port := requiredHTTPPort(req.URL != nil && req.URL.Scheme == "https", p) if port > 0 { n++ } useragent := req.UserAgent() if useragent != "" { n++ } if req.ContentLength > 0 { n++ } userID, \_, hasUserID := req.BasicAuth() if hasUserID { n++ } attrs := make([]attribute.KeyValue, 0, n)
 attrs = append(attrs, c.method(req.Method)) attrs = append(attrs, c.proto(req.Proto))
 var u string if req.URL != nil { // Remove any username/password info that may be in the URL. userinfo := req.URL.User req.URL.User = nil u = req.URL.String() // Restore any username/password info that was removed. req.URL.User = userinfo } attrs = append(attrs, c.HTTPURLKey.String(u))
 attrs = append(attrs, c.NetConv.PeerName(peer)) if port > 0 { attrs = append(attrs, c.NetConv.PeerPort(port)) }
 if useragent != "" { attrs = append(attrs, c.HTTPUserAgentKey.String(useragent)) }
 if l := req.ContentLength; l > 0 { attrs = append(attrs, c.HTTPRequestContentLengthKey.Int64(l)) }
 if hasUserID { attrs = append(attrs, c.EnduserIDKey.String(userID)) }
 return attrs}
// ServerRequest returns attributes for an HTTP request received by a server.//// The server must be the primary server name if it is known. For example this// would be the ServerName directive// (https://httpd.apache.org/docs/2.4/mod/core.html#servername) for an Apache// server, and the server\_name directive// (http://nginx.org/en/docs/http/ngx\_http\_core\_module.html#server\_name) for an// nginx server. More generically, the primary server name would be the host// header value that matches the default virtual host of an HTTP server. It// should include the host identifier and if a port is used to route to the// server that port identifier should be included as an appropriate port// suffix.//// If the primary server name is not known, server should be an empty string.// The req Host will be used to determine the server instead.//// The following attributes are always returned: "http.method", "http.scheme",// "http.flavor", "http.target", "net.host.name". The following attributes are// returned if they related values are defined in req: "net.host.port",// "net.sock.peer.addr", "net.sock.peer.port", "http.user\_agent", "enduser.id",// "http.client\_ip".func (c \*HTTPConv) ServerRequest(server string, req \*http.Request) []attribute.KeyValue { n := 5 // Method, scheme, target, proto, and host name. var host string var p int if server == "" { host, p = splitHostPort(req.Host) } else { // Prioritize the primary server name. host, p = splitHostPort(server) if p < 0 { \_, p = splitHostPort(req.Host) } } hostPort := requiredHTTPPort(req.TLS != nil, p) if hostPort > 0 { n++ } peer, peerPort := splitHostPort(req.RemoteAddr) if peer != "" { n++ if peerPort > 0 { n++ } } useragent := req.UserAgent() if useragent != "" { n++ } userID, \_, hasUserID := req.BasicAuth() if hasUserID { n++ } clientIP := serverClientIP(req.Header.Get("X-Forwarded-For")) if clientIP != "" { n++ } attrs := make([]attribute.KeyValue, 0, n)
 attrs = append(attrs, c.method(req.Method)) attrs = append(attrs, c.scheme(req.TLS != nil)) attrs = append(attrs, c.proto(req.Proto)) attrs = append(attrs, c.NetConv.HostName(host))
 if req.URL != nil { attrs = append(attrs, c.HTTPTargetKey.String(req.URL.RequestURI())) } else { // This should never occur if the request was generated by the net/http // package. Fail gracefully, if it does though. attrs = append(attrs, c.HTTPTargetKey.String(req.RequestURI)) }
 if hostPort > 0 { attrs = append(attrs, c.NetConv.HostPort(hostPort)) }
 if peer != "" { // The Go HTTP server sets RemoteAddr to "IP:port", this will not be a // file-path that would be interpreted with a sock family. attrs = append(attrs, c.NetConv.SockPeerAddr(peer)) if peerPort > 0 { attrs = append(attrs, c.NetConv.SockPeerPort(peerPort)) } }
 if useragent != "" { attrs = append(attrs, c.HTTPUserAgentKey.String(useragent)) }
 if hasUserID { attrs = append(attrs, c.EnduserIDKey.String(userID)) }
 if clientIP != "" { attrs = append(attrs, c.HTTPClientIPKey.String(clientIP)) }
 return attrs}
func (c \*HTTPConv) method(method string) attribute.KeyValue { if method == "" { return c.HTTPMethodKey.String(http.MethodGet) } return c.HTTPMethodKey.String(method)}
func (c \*HTTPConv) scheme(https bool) attribute.KeyValue { // nolint:revive if https { return c.HTTPSchemeHTTPS } return c.HTTPSchemeHTTP}
func (c \*HTTPConv) proto(proto string) attribute.KeyValue { switch proto { case "HTTP/1.0": return c.HTTPFlavorKey.String("1.0") case "HTTP/1.1": return c.HTTPFlavorKey.String("1.1") case "HTTP/2": return c.HTTPFlavorKey.String("2.0") case "HTTP/3": return c.HTTPFlavorKey.String("3.0") default: return c.HTTPFlavorKey.String(proto) }}
func serverClientIP(xForwardedFor string) string { if idx := strings.Index(xForwardedFor, ","); idx >= 0 { xForwardedFor = xForwardedFor[:idx] } return xForwardedFor}
func requiredHTTPPort(https bool, port int) int { // nolint:revive if https { if port > 0 && port != 443 { return port } } else { if port > 0 && port != 80 { return port } } return -1}
// Return the request host and port from the first non-empty source.func firstHostPort(source ...string) (host string, port int) { for \_, hostport := range source { host, port = splitHostPort(hostport) if host != "" || port > 0 { break } } return}
// RequestHeader returns the contents of h as OpenTelemetry attributes.func (c \*HTTPConv) RequestHeader(h http.Header) []attribute.KeyValue { return c.header("http.request.header", h)}
// ResponseHeader returns the contents of h as OpenTelemetry attributes.func (c \*HTTPConv) ResponseHeader(h http.Header) []attribute.KeyValue { return c.header("http.response.header", h)}
func (c \*HTTPConv) header(prefix string, h http.Header) []attribute.KeyValue { key := func(k string) attribute.Key { k = strings.ToLower(k) k = strings.ReplaceAll(k, "-", "\_") k = fmt.Sprintf("%s.%s", prefix, k) return attribute.Key(k) }
 attrs := make([]attribute.KeyValue, 0, len(h)) for k, v := range h { attrs = append(attrs, key(k).StringSlice(v)) } return attrs}
// ClientStatus returns a span status code and message for an HTTP status code// value received by a client.func (c \*HTTPConv) ClientStatus(code int) (codes.Code, string) { stat, valid := validateHTTPStatusCode(code) if !valid { return stat, fmt.Sprintf("Invalid HTTP status code %d", code) } return stat, ""}
// ServerStatus returns a span status code and message for an HTTP status code// value returned by a server. Status codes in the 400-499 range are not// returned as errors.func (c \*HTTPConv) ServerStatus(code int) (codes.Code, string) { stat, valid := validateHTTPStatusCode(code) if !valid { return stat, fmt.Sprintf("Invalid HTTP status code %d", code) }
 if code/100 == 4 { return codes.Unset, "" } return stat, ""}
type codeRange struct { fromInclusive int toInclusive int}
func (r codeRange) contains(code int) bool { return r.fromInclusive <= code && code <= r.toInclusive}
var validRangesPerCategory = map[int][]codeRange{ 1: { {http.StatusContinue, http.StatusEarlyHints}, }, 2: { {http.StatusOK, http.StatusAlreadyReported}, {http.StatusIMUsed, http.StatusIMUsed}, }, 3: { {http.StatusMultipleChoices, http.StatusUseProxy}, {http.StatusTemporaryRedirect, http.StatusPermanentRedirect}, }, 4: { {http.StatusBadRequest, http.StatusTeapot}, // yes, teapot is so usefulâ¦ {http.StatusMisdirectedRequest, http.StatusUpgradeRequired}, {http.StatusPreconditionRequired, http.StatusTooManyRequests}, {http.StatusRequestHeaderFieldsTooLarge, http.StatusRequestHeaderFieldsTooLarge}, {http.StatusUnavailableForLegalReasons, http.StatusUnavailableForLegalReasons}, }, 5: { {http.StatusInternalServerError, http.StatusLoopDetected}, {http.StatusNotExtended, http.StatusNetworkAuthenticationRequired}, },}
// validateHTTPStatusCode validates the HTTP status code and returns// corresponding span status code. If the `code` is not a valid HTTP status// code, returns span status Error and false.func validateHTTPStatusCode(code int) (codes.Code, bool) { category := code / 100 ranges, ok := validRangesPerCategory[category] if !ok { return codes.Error, false } ok = false for \_, crange := range ranges { ok = crange.contains(code) if ok { break } } if !ok { return codes.Error, false } if category > 0 && category < 4 { return codes.Unset, true } return codes.Error, true}

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_318b00d5_20250115_091757.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fsecurity%2Fadvisories%2FGHSA-5r5m-65gx-7vrh)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-telemetry%2Fopentelemetry-go-contrib%2Fsecurity%2Fadvisories%2FGHSA-5r5m-65gx-7vrh)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=open-telemetry%2Fopentelemetry-go-contrib)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-telemetry](/open-telemetry)
/
**[opentelemetry-go-contrib](/open-telemetry/opentelemetry-go-contrib)**
Public

* [Notifications](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib) You must be signed in to change notification settings
* [Fork
  584](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)
* [Star
   1.3k](/login?return_to=%2Fopen-telemetry%2Fopentelemetry-go-contrib)

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues
  191](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests
  59](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects
  3](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

Additional navigation options

* [Code](/open-telemetry/opentelemetry-go-contrib)
* [Issues](/open-telemetry/opentelemetry-go-contrib/issues)
* [Pull requests](/open-telemetry/opentelemetry-go-contrib/pulls)
* [Actions](/open-telemetry/opentelemetry-go-contrib/actions)
* [Projects](/open-telemetry/opentelemetry-go-contrib/projects)
* [Security](/open-telemetry/opentelemetry-go-contrib/security)
* [Insights](/open-telemetry/opentelemetry-go-contrib/pulse)

# DoS vulnerability for high cardinality metrics in otelhttp and otelbeego

High

[Aneurysm9](/Aneurysm9)
published
GHSA-5r5m-65gx-7vrh
Feb 8, 2023

## Package

gomod

go.opentelemetry.io/contrib/instrumentation/github.com/astaxie/beego/otelbeego
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

v0.38.0

## Patched versions

v0.39.0

gomod

go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp
([Go](/advisories?query=ecosystem%3Ago))

v0.38.0

v0.39.0

## Description

### Impact

The [v0.38.0](https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.13.0) release of [`go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp`](https://github.com/open-telemetry/opentelemetry-go-contrib/blob/463c2e7cd69d25f40b0a595b05394eeb26c68ae2/instrumentation/net/http/otelhttp/handler.go#L218) uses the [`httpconv.ServerRequest`](https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159) function to annotate metric measurements for the `http.server.request_content_length`, `http.server.response_content_length`, and `http.server.duration` instruments.

The `ServerRequest` function sets the `http.target` attribute value to be the whole request URI (including the query string)[1](#user-content-fn-1-3319ce88d6ef41b00dbebd28f031de14). The metric instruments do not "forget" previous measurement attributes when `cumulative` temporality is used, this means the cardinality of the measurements allocated is directly correlated with the unique URIs handled. If the query string is constantly random, this will result in a constant increase in memory allocation that can be used in a denial-of-service attack.

Pseudo-attack:

```
for infinite loop {
  r := generate_random_string()
  do_http_request("/some/path?random="+r)
}

```
### Patches

* `go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp` - v0.39.0
* `go.opentelemetry.io/contrib/instrumentation/github.com/astaxie/beego/otelbeego` - v0.39.0

## Footnotes

1. <https://github.com/open-telemetry/opentelemetry-go/blob/6cb5718eaaed5c408c3bf4ad1aecee5c20ccdaa9/semconv/internal/v2/http.go#L202-L208> [â©](#user-content-fnref-1-3319ce88d6ef41b00dbebd28f031de14)

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-25151

### Weaknesses

No CWEs

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


