=== Content from www.mozilla.org_cf43900c_20250115_100332.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-10

## Security Vulnerabilities fixed in Firefox ESR 102.9

Announced
March 14, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.9

#### [#CVE-2023-25751: Incorrect code generation during JIT compilation](#CVE-2023-25751)

Reporter
Lukas Bernhard
Impact
high
##### Description

Sometimes, when invalidating JIT code while following an iterator, the newly generated code could be overwritten incorrectly. This could lead to a potentially exploitable crash.

##### References

* [Bug 1814899](https://bugzilla.mozilla.org/show_bug.cgi?id=1814899)

#### [#CVE-2023-28164: URL being dragged from a removed cross-origin iframe into the same tab triggered navigation](#CVE-2023-28164)

Reporter
Luan Herrera
Impact
moderate
##### Description

Dragging a URL from a cross-origin iframe that was removed during the drag could have led to user confusion and website spoofing attacks.

##### References

* [Bug 1809122](https://bugzilla.mozilla.org/show_bug.cgi?id=1809122)

#### [#CVE-2023-28162: Invalid downcast in Worklets](#CVE-2023-28162)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

While implementing AudioWorklets, some code may have casted one type to another, invalid, dynamic type. This could have led to a potentially exploitable crash.

##### References

* [Bug 1811327](https://bugzilla.mozilla.org/show_bug.cgi?id=1811327)

#### [#CVE-2023-25752: Potential out-of-bounds when accessing throttled streams](#CVE-2023-25752)

Reporter
Ronald Crane
Impact
moderate
##### Description

When accessing throttled streams, the count of available bytes needed to be checked in the calling function to be within bounds. This may have lead future code to be incorrect and vulnerable.

##### References

* [Bug 1811627](https://bugzilla.mozilla.org/show_bug.cgi?id=1811627)

#### [#CVE-2023-28163: Windows Save As dialog resolved environment variables](#CVE-2023-28163)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When downloading files through the Save As dialog on Windows with suggested filenames containing environment variable names, Windows would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1817768](https://bugzilla.mozilla.org/show_bug.cgi?id=1817768)

#### [#CVE-2023-28176: Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](#CVE-2023-28176)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110 and Firefox ESR 102.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1808352%2C1811637%2C1815904%2C1817442%2C1818674)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_8e489e31_20250115_100334.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-11

## Security Vulnerabilities fixed in Thunderbird 102.9

Announced
March 14, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.9

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-25751: Incorrect code generation during JIT compilation](#CVE-2023-25751)

Reporter
Lukas Bernhard
Impact
high
##### Description

Sometimes, when invalidating JIT code while following an iterator, the newly generated code could be overwritten incorrectly. This could lead to a potentially exploitable crash.

##### References

* [Bug 1814899](https://bugzilla.mozilla.org/show_bug.cgi?id=1814899)

#### [#CVE-2023-28164: URL being dragged from a removed cross-origin iframe into the same tab triggered navigation](#CVE-2023-28164)

Reporter
Luan Herrera
Impact
moderate
##### Description

Dragging a URL from a cross-origin iframe that was removed during the drag could have led to user confusion and website spoofing attacks.

##### References

* [Bug 1809122](https://bugzilla.mozilla.org/show_bug.cgi?id=1809122)

#### [#CVE-2023-28162: Invalid downcast in Worklets](#CVE-2023-28162)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

While implementing AudioWorklets, some code may have casted one type to another, invalid, dynamic type. This could have led to a potentially exploitable crash.

##### References

* [Bug 1811327](https://bugzilla.mozilla.org/show_bug.cgi?id=1811327)

#### [#CVE-2023-25752: Potential out-of-bounds when accessing throttled streams](#CVE-2023-25752)

Reporter
Ronald Crane
Impact
moderate
##### Description

When accessing throttled streams, the count of available bytes needed to be checked in the calling function to be within bounds. This may have lead future code to be incorrect and vulnerable.

##### References

* [Bug 1811627](https://bugzilla.mozilla.org/show_bug.cgi?id=1811627)

#### [#CVE-2023-28163: Windows Save As dialog resolved environment variables](#CVE-2023-28163)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When downloading files through the Save As dialog on Windows with suggested filenames containing environment variable names, Windows would have resolved those in the context of the current user.
*This bug only affects Thunderbird on Windows. Other versions of Thunderbird are unaffected.*

##### References

* [Bug 1817768](https://bugzilla.mozilla.org/show_bug.cgi?id=1817768)

#### [#CVE-2023-28176: Memory safety bugs fixed in Thunderbird 102.9](#CVE-2023-28176)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1808352%2C1811637%2C1815904%2C1817442%2C1818674)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_47bed93c_20250115_100330.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1814899)
* [XML](/show_bug.cgi?ctype=xml&id=1814899)

Closed
[Bug 1814899](/show_bug.cgi?id=1814899)
(CVE-2023-25751)

Opened 2 years ago
Closed 2 years ago

# MOZ\_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

MOZ\_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71

## Categories

### (Core :: JavaScript Engine: JIT, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
▾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

112 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [111+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=111%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) |
| firefox112 | [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 111+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox110 |  | wontfix |
| firefox111 | + | fixed |
| firefox112 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: lukas.bernhard, Assigned: iain)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1243fc5f2c1c56a2f77ca1be38837e68?d=mm&size=40)  [iain](/user_profile?user_id=623993)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/59307c6d3ba87d521f5443530ecf72a9?d=mm&size=40)  [lukas.bernhard](/user_profile?user_id=656084)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Blocks 2 open bugs)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sm-opt-jits](/show_bug.cgi?id=1729509 "NEW - [meta] Optimizing Compiler"), [l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing")

Dependency [tree](/showdependencytree.cgi?id=1814899&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1814899)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-high, Whiteboard: [adv-main111+][adv-esr102.9+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25751

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main111+][adv-esr102.9+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3386943_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c18 "2 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1814899: Ensure more OsiSpace r=jandem](/attachment.cgi?id=9316683)  [2 years ago](#c6)  [Iain Ireland [:iain]](/user_profile?user_id=623993)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-beta+](#c12 "2 years ago")  dmeehan : [approval-mozilla-esr102+](#c14 "2 years ago")  tjr : [sec-approval+](#c9 "2 years ago") | [Details](/attachment.cgi?id=9316683&action=edit) | [Review](/attachment.cgi?id=9316683) |
| --- | --- | --- |
| [Bug 1814899: Add testcase r=jandem](/attachment.cgi?id=9316684)  [2 years ago](#c7)  [Iain Ireland [:iain]](/user_profile?user_id=623993)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9316684&action=edit) | [Review](/attachment.cgi?id=9316684) |
| [advisory.txt](/attachment.cgi?id=9322636)  [2 years ago](#c16)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   245 bytes, text/plain |  | [Details](/attachment.cgi?id=9322636&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1814899#c0)• 2 years ago |
|  | |

Steps to reproduce:

The attached sample crashes the js-shell on commit a7156afbfa575f12f60b1c8bf099d547c29bcadf when executed via commandline `--fuzzing-safe --gc-zeal=10`. The crash is flaky, but running it via `rr record --chaos` for some time should yield a crash. While the crash is in line `MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr));`, the instruction is `mov rax,QWORD PTR [rbx+0x30]` instead of a normal assertion failure.

```
function f0(a1) {
    const v5 = [0,0,0,0,0,0,0,0];
    const v10 = new SharedArrayBuffer(1000, {});
    const v12 = new Int16Array();
    for (const v14 in v5.join(a1)) { }
}
f0.toString = f0;
for (let v15 = 0; v15 < 100; v15++) {
    f0(f0);
}
f0();
this.unscopables;

```
```
#0  js::jit::JSJitFrameIter::checkInvalidation (this=<optimized out>, ionScriptOut=0x7ffe1b63b5c0)
    at js/src/jit/JSJitFrameIter.cpp:71
#1  0x00005564199cbe93 in js::jit::TraceIonJSFrame (trc=0x7ffe1b63b938, frame=...)
    at js/src/jit/JitFrames.cpp:947
#2  js::jit::TraceJitActivation (trc=0x7ffe1b63b938, activation=<optimized out>)
    at js/src/jit/JitFrames.cpp:1358
#3  js::jit::TraceJitActivations (cx=<optimized out>, trc=0x7ffe1b63b938) at js/src/jit/JitFrames.cpp:1400
#4  0x00005564193b6560 in js::gc::GCRuntime::traceRuntimeCommon (this=0x6d0133323788, trc=0x7ffe1b63b938,
    traceOrMark=js::gc::GCRuntime::MarkRuntime) at js/src/gc/RootMarking.cpp:303
#5  0x00005564193b6300 in js::gc::GCRuntime::traceRuntimeForMajorGC (this=0x6d0133323788, trc=0x7ffe1b63b938, session=...)
    at js/src/gc/RootMarking.cpp:242
#6  0x000055641931cc57 in js::gc::GCRuntime::updateRuntimePointersToRelocatedCells (this=0x6d0133323788, session=...)
    at js/src/gc/Compacting.cpp:802
#7  js::gc::GCRuntime::compactPhase (this=0x6d0133323788, reason=JS::GCReason::DEBUG_GC, sliceBudget=..., session=...)
    at js/src/gc/Compacting.cpp:103
#8  0x0000556419341b8c in js::gc::GCRuntime::incrementalSlice (this=0x6d0133323788, budget=..., reason=JS::GCReason::DEBUG_GC,
    budgetWasIncreased=<optimized out>) at js/src/gc/GC.cpp:3696
#9  0x0000556419346109 in js::gc::GCRuntime::gcCycle (this=0x6d0133323788, nonincrementalByAPI=false, budgetArg=...,
    reason=JS::GCReason::DEBUG_GC) at js/src/gc/GC.cpp:4160
#10 0x0000556419346f63 in js::gc::GCRuntime::collect (this=0x6d0133323788, nonincrementalByAPI=<optimized out>, budget=...,
    reason=JS::GCReason::DEBUG_GC) at js/src/gc/GC.cpp:4348
#11 0x0000556419311542 in js::gc::GCRuntime::runDebugGC (this=0x6d0133323788) at js/src/gc/GC.cpp:4795
#12 js::gc::GCRuntime::gcIfNeededAtAllocation (this=<optimized out>, cx=<optimized out>)
    at js/src/gc/Allocator.cpp:412
#13 js::gc::GCRuntime::checkAllocatorState<(js::AllowGC)1> (this=0x6d0133323788, cx=0x6d0133336600,
    kind=js::gc::AllocKind::OBJECT2_BACKGROUND) at js/src/gc/Allocator.cpp:376
#14 0x000055641931095c in js::gc::detail::AllocateObject<(js::AllowGC)1> (cx=0x6d0133336600, kind=<optimized out>, nDynamicSlots=0,
    heap=js::gc::TenuredHeap, clasp=0x556419f27090 <js::PropertyIteratorObject::class_>, site=0x0)
    at js/src/gc/Allocator.cpp:56
#15 0x00005564188f3319 in js::gc::CellAllocator::NewCell<js::NativeObject, (js::AllowGC)1, js::gc::AllocKind&, unsigned long const&, js::gc::InitialHeap&, JSClass const*&, js::gc
::AllocSite*&> (cx=0x6d0133336600, args=<optimized out>, args=<optimized out>,
--Type <RET> for more, q to quit, c to continue without paging--
     args=<optimized out>, args=<optimized out>) at js/src/gc/Allocator.h:123
#16 JSContext::newCell<js::NativeObject, (js::AllowGC)1, js::gc::AllocKind&, unsigned long const&, js::gc::InitialHeap&, JSClass const*&, js::gc::AllocSite*&> (this=0x6d013333660
0, args=<optimized out>, args=<optimized out>, args=<optimized out>, args=<optimized out>,
    args=<optimized out>) at js/src/vm/JSContext.h:266
#17 js::NativeObject::create (cx=0x6d0133336600, kind=js::gc::AllocKind::OBJECT2_BACKGROUND, heap=js::gc::TenuredHeap, shape=...,
    site=0x0) at js/src/vm/NativeObject-inl.h:446
#18 0x0000556418b84b50 in NewPropertyIteratorObject (cx=0x6d0133336600) at js/src/vm/Iteration.cpp:803
#19 CreatePropertyIterator (cx=0x6d0133336600, objBeingIterated=..., props=..., supportsIndices=false, indices=0x0, numShapes=0)
    at js/src/vm/Iteration.cpp:845
#20 0x0000556418b7f0eb in GetIteratorImpl<false> (obj=..., cx=<optimized out>)
    at js/src/vm/Iteration.cpp:1262
#21 js::GetIterator (cx=0x6d0133336600, obj=...) at js/src/vm/Iteration.cpp:1293
#22 0x0000556418b86112 in js::ValueToIterator (cx=0x6d0133336600, vp=...) at js/src/vm/Iteration.cpp:1619

```

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a21_656084)• 2 years ago |

Blocks: [l11d-js-fuzzing](/show_bug.cgi?id=1758541 "NEW - [meta] Lukas JavaScript engine Fuzzing"), [sm-runtime](/show_bug.cgi?id=1729514 "NEW - [meta] SpiderMonkey Runtime")Group: firefox-core-security → core-securityComponent: Untriaged → JavaScript: GCProduct: Firefox → Core

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a47_75935)• 2 years ago |

Group: core-security → javascript-core-security

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1814899#c1)• 2 years ago |
|  | |

NI Iain because this is in the for-in iterator code.

Flags: needinfo?(iireland)

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1814899#c2)• 2 years ago |
|  | |

Thanks for the report.

When generating code for `for (const v14 in v5.join(a1)) { }`, we emit a call to array\_join, followed immediately by a call to ValueToIterator. Because f0.toString has been overwritten to point to f0, the join call enters f0 recursively. If we do a major GC inside ValueToIterator, then we run into problems while invalidating:

```
[IonInvalidate] Invalidating all frames for GC
[IonInvalidate] BEGIN invalidating activation
[IonInvalidate] #1 exit frame @ 7ffeefb24120
[IonInvalidate] #2 Optimized JS frame @ 7ffeefb24180, [...] (fun: 1abac7685890, [...], pc ***1aa5081073be***) // >1<
[IonInvalidate]    ! Invalidate ionScript 7f50c0227600 (inv count 1) -> patching osipoint 1aa508107674
[IonInvalidate] #3 rectifier frame @ 7ffeefb241b0
[IonInvalidate] END invalidating activation
[IonInvalidate] Invalidating all frames for GC
[IonInvalidate] BEGIN invalidating activation
[IonInvalidate] #1 exit frame @ 7ffeefb251d8
[IonInvalidate] #2 Optimized JS frame @ 7ffeefb25230 [...] (fun: 1abac7685890, [...], pc 1aa5081070d8)
[IonInvalidate]    ! Invalidate ionScript 7f50c0227600 (inv count 2) -> patching osipoint ***1aa5081073b6*** // >2<
[IonInvalidate] #3 baseline stub frame @ 7ffeefb25270
[IonInvalidate] #4 Baseline JS frame @ 7ffeefb252f0, [...] (fun: 0, script: 1abac76900b0, pc 1aa5080c7e58)
[IonInvalidate] END invalidating activation

```

The issue here is that the first frame we invalidate (`>1<`) has resume pc 0x1aa5081073be, meaning that we [write the delta](https://searchfox.org/mozilla-central/rev/4fcb729dc98138af00570c0a378fbff90a167d79/js/src/jit/Ion.cpp#2361-2373) starting at address 0x1aa5081073ba. But later, when we invalidate a frame for the same script (`>2<`), the address where we [patch the OSI point](https://searchfox.org/mozilla-central/rev/4fcb729dc98138af00570c0a378fbff90a167d79/js/src/jit/Ion.cpp#2384) is 0x1aa5081073b6. We write [5 bytes](https://searchfox.org/mozilla-central/rev/4fcb729dc98138af00570c0a378fbff90a167d79/js/src/jit/x86-shared/Assembler-x86-shared.h#4818) (0xE8 for the call, and a four byte offset). The most significant byte of the offset clobbers the least significant byte of the delta we wrote for the previous frame. Later, we trace the frame, try to check the invalidation, and crash because the delta does not point to the location of a valid IonScript.

This is obviously not supposed to happen, but I can't find the code that prevents it. We have [ensureOsiSpace](https://searchfox.org/mozilla-central/rev/4fcb729dc98138af00570c0a378fbff90a167d79/js/src/jit/shared/CodeGenerator-shared.cpp#809) that seems like it's intended to avoid this, but AFAICT that only prevents OSI patching from being clobbered, not the delta. (It also looks like we never actually generate any nops using that code.)

I don't think this is directly related to my for-in changes. Unless I'm missing something, ValueToIterator just happens to be the easiest way to have a VM call immediately following another call, with no intervening guards.

I think the fix is probably to somehow beef up ensureOsiSpace?

Flags: needinfo?(iireland)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1814899#c3)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1814899&comment_id=16271351 "2 revisions") |
|  | |

(In reply to Iain Ireland [:iain] from [comment #2](/show_bug.cgi?id=1814899#c2 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"))

> I think the fix is probably to somehow beef up ensureOsiSpace?

Yes. This is the way!

`ensureOsiSpace` is used to ensure that the code that we generate for invalidation (i-e. a bailout) does not overlap with the return address of the call of another instruction. Otherwise, we might have random code execution. [overlapping-patches]

When invalidated, we patch the code and store the delta-offset from the return location to the invalidation epilogue. This is useful as if we lose the reference of the current function, then the space might be reclaimed and reused before we return to the invalidated function, and we might once again have random code execution. [exec-after-free]

Ion is limited, It can execute only a single potentially-invalidating call per LIR instruction. If we have more than one, then we risk returning to an invalidated code base where non-code (the delta-offset to the invalidation offset) is written in place of the code. Which can be assimilated to random code execution (except that it is limited to small offsets). [exec-after-patch]

However, we have not forbidden generating multiple potentially-invalidating calls in the same LIR, as we already had use cases for multiple calls on different branches, which is safe as long as we do not re-enter a potentially-invaliding call before reaching the end of the LIR instruction.

(In reply to Iain Ireland [:iain] from [comment #2](/show_bug.cgi?id=1814899#c2 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"))

> This is obviously not supposed to happen, but I can't find the code that prevents it. We have [ensureOsiSpace](https://searchfox.org/mozilla-central/rev/4fcb729dc98138af00570c0a378fbff90a167d79/js/src/jit/shared/CodeGenerator-shared.cpp#809) that seems like it's intended to avoid this, but AFAICT that only prevents OSI patching from being clobbered, not the delta. (It also looks like we never actually generate any nops using that code.)

On RISCV this might be another story.

I suspect the problem you are facing is that `ensureOsiSpace` only inserts nop-slides if the last `ensureOsiSpace` was not too close, but at the moment it is only called under `LOsiPoint`, which is the problem.

All potentially invalidating call should be checking that `lastOsiPointOffset_` is far away enough (by calling `ensureOsiSpace`) to insert a nop-slide to safely encode the bailing jump (`PatchWrite_NearCall`). Which is most likely the problem you are seeing if a potentially-invalidating call instruction is generated directly after an `LOsiPoint`:

```
  LOsiPoint
  LPotentiallyInvalidatingCall

```

Calling `ensureOsiSpace()` before the call instruction of `LPotentiallyInvalidatingCall` should do the trick ;)

Blocks: [sm-opt-jits](/show_bug.cgi?id=1729509 "NEW - [meta] Optimizing Compiler")
No longer blocks: [sm-runtime](/show_bug.cgi?id=1729514 "NEW - [meta] SpiderMonkey Runtime")Severity: -- → S2Priority: -- → P1

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a420013_422187)• 2 years ago |

Component: JavaScript: GC → JavaScript Engine: JIT

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1814899#c4)• 2 years ago |
|  | |

is `this.unscopables` limited to the JS Shell? I don't see it in a Firefox document context (not even a privileged one). Is that a necessary part of the problem, or is that just the statement that revealed the problem that had already happened, such that this could be a problem in web content as well?

Calling this sec-high on the worst-case presumption that web content could trigger this. If that's false feel free to lower the severity appropriately.

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1814899#c5)• 2 years ago |
|  | |

Unfortunately I don't see anything preventing this from being triggered by web content. The only requirement is being able to trigger a compacting GC at exactly the right time.

Here's a more robust version of the testcase that doesn't depend on exact allocation counts:

```
function bar(x) {
  with ({}) {}
  switch (x) {
  case 1:
    foo(2);
    break;
  case 2:
    gczeal(14, 1); // Trigger a major GC for the next allocation, which is the PropertyIteratorObject in ValueToIterator
    break;
  }
  return "a sufficiently long string";
}

function foo(x) {
  for (var s in bar(x)) { gczeal(0); }
}

with ({}) {}
for (var i = 0; i < 100; i++) {
  foo(0);
}
foo(1);

```

In this particular case, the victim is a VM call, and calling ensureOsiSpace just before [masm.callJit](https://searchfox.org/mozilla-central/rev/e66cff951667dacd0faa95dfde830564a58a8a3f/js/src/jit/CodeGenerator.cpp#351) in callVMInternal fixes the bug. I think we probably want to call ensureOsiSpace before the call whenever we mark a safepoint. I'll put up a patch.

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1814899#c6)• 2 years ago |
|  | |

Attached file
[Bug 1814899: Ensure more OsiSpace r=jandem](attachment.cgi?id=9316683)
— [Details](attachment.cgi?id=9316683&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a469679_600971)• 2 years ago |

Assignee: nobody → iirelandStatus: NEW → ASSIGNED

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1814899#c7)• 2 years ago |
|  | |

Attached file
[Bug 1814899: Add testcase r=jandem](attachment.cgi?id=9316684)
— [Details](attachment.cgi?id=9316684&action=edit)

Depends on D169274

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1814899#c8)• 2 years ago |
|  | |

Comment on [attachment 9316683](/attachment.cgi?id=9316683 "Bug 1814899: Ensure more OsiSpace r=jandem") [[details]](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem")

[Bug 1814899](/show_bug.cgi?id=1814899 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"): Ensure more OsiSpace r=jandem

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: I think it's reasonable for a smart, sufficiently motivated attacker to deduce the general shape of the bug by looking at where we're adding more NOPs. It might be tricky to deduce the exact sequence of events that I used to trigger it (triggering a major GC in a call to ValueToIterator), but there might be other ways to get at the same bug. Once you can trigger the bug, it seems like there's plenty of room to build an exploit.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: I think this patch should apply cleanly.
* **How likely is this patch to cause regressions; how much testing does it need?**: We generate a few nops in particularly rare cases. It's fairly unlikely to cause regressions.
* **Is Android affected?**: Yes
[Attachment #9316683](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1814899#c9)• 2 years ago |
|  | |

Comment on [attachment 9316683](/attachment.cgi?id=9316683 "Bug 1814899: Ensure more OsiSpace r=jandem") [[details]](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem")

[Bug 1814899](/show_bug.cgi?id=1814899 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"): Ensure more OsiSpace r=jandem

Approved to request uplift and land

[Attachment #9316683](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a874278_578488)• 2 years ago |

Whiteboard: [reminder-test 2023-04-24]

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1814899#c10)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1814899&comment_id=16278933 "1 revision") |
|  | |

Comment on [attachment 9316683](/attachment.cgi?id=9316683 "Bug 1814899: Ensure more OsiSpace r=jandem") [[details]](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem")

[Bug 1814899](/show_bug.cgi?id=1814899 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"): Ensure more OsiSpace r=jandem

### Beta/Release Uplift Approval Request

* **User impact if declined**: Potentially exploitable sec-high bug
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: We insert a few extra nops in rare circumstances. At worst there could be a tiny performance regression.
* **String changes made/needed**: None
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Sec-high bug
* **User impact if declined**: Potential exploitation
* **Fix Landed on Version**: 112
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: We insert a few extra nops in rare circumstances. At worst there could be a tiny performance regression.
[Attachment #9316683](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem") -
Flags: approval-mozilla-esr102?
[Attachment #9316683](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a911852_75935)• 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox112](/buglist.cgi?f1=cf_tracking_firefox112&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox112&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [111+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=111%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1814899#c11)• 2 years ago |
|  | |

Ensure more OsiSpace r=jandem

<https://hg.mozilla.org/integration/autoland/rev/4378074a655475cf79ddb17cce8ed286f4f22f1f>

<https://hg.mozilla.org/mozilla-central/rev/4378074a6554>

Group: javascript-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 112 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1814899#c12)• 2 years ago |
|  | |

Comment on [attachment 9316683](/attachment.cgi?id=9316683 "Bug 1814899: Ensure more OsiSpace r=jandem") [[details]](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem")

[Bug 1814899](/show_bug.cgi?id=1814899 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"): Ensure more OsiSpace r=jandem

Approved for 111.0b5

[Attachment #9316683](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1814899#c13)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/4ceae239742c>

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1814899#c14)• 2 years ago |
|  | |

Comment on [attachment 9316683](/attachment.cgi?id=9316683 "Bug 1814899: Ensure more OsiSpace r=jandem") [[details]](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem")

[Bug 1814899](/show_bug.cgi?id=1814899 "RESOLVED FIXED - MOZ_ASSERT(ionScript->containsReturnAddress(returnAddr)) at jit/JSJitFrameIter.cpp:71"): Ensure more OsiSpace r=jandem

Approved for 102.9esr.

[Attachment #9316683](/attachment.cgi?id=9316683&action=edit "Bug 1814899: Ensure more OsiSpace r=jandem") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1814899#c15)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/207a0ca14a75>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a2669498_551058)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a3025217_578488)• 2 years ago |

Whiteboard: [reminder-test 2023-04-24] → [reminder-test 2023-04-24][adv-main111+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a3029066_578488)• 2 years ago |

Whiteboard: [reminder-test 2023-04-24][adv-main111+] → [reminder-test 2023-04-24][adv-main111+][adv-esr102.9+]

|  | [lukas.bernhard](/user_profile?user_id=656084)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a3129082_656084)• 2 years ago |

Flags: sec-bounty?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1814899#c16)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9322636)
— [Details](attachment.cgi?id=9322636&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a3292780_578488)• 2 years ago |

Alias: CVE-2023-25751

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a3386943_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1814899#c17)• 2 years ago |
|  | |

2 months ago, Tom Ritter [:tjr] placed a reminder on the bug using the whiteboard tag `[reminder-test 2023-04-24]` .

iain, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(iireland)Whiteboard: [reminder-test 2023-04-24][adv-main111+][adv-esr102.9+] → [adv-main111+][adv-esr102.9+]

|  | [Iain Ireland [:iain]](/user_profile?user_id=623993)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a7005612_623993)• 2 years ago |

Flags: needinfo?(iireland)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1814899#c18)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/0e73c493db8f>

Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a22164646_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1814899#a41656503_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1814899&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Iain Ireland [:iain]](/user_profile?user_id=623993)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_7e9e9b8c_20250115_100331.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-09

## Security Vulnerabilities fixed in Firefox 111

Announced
March 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 111

#### [#CVE-2023-28159: Fullscreen Notification could have been hidden by download popups on Android](#CVE-2023-28159)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

The fullscreen notification could have been hidden on Firefox for Android by using download popups, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1783561](https://bugzilla.mozilla.org/show_bug.cgi?id=1783561)

#### [#CVE-2023-25748: Fullscreen Notification could have been hidden by window prompts on Android](#CVE-2023-25748)

Reporter
Hafiizh
Impact
high
##### Description

By displaying a prompt with a long description, the fullscreen notification could have been hidden, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1798798](https://bugzilla.mozilla.org/show_bug.cgi?id=1798798)

#### [#CVE-2023-25749: Firefox for Android may have opened third-party apps without a prompt](#CVE-2023-25749)

Reporter
Kirtikumar Anandrao Ramchandani
Impact
high
##### Description

Android applications with unpatched vulnerabilities can be launched from a browser using Intents, exposing users to these vulnerabilities. Firefox will now confirm with users that they want to launch an external application before doing so.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1810705](https://bugzilla.mozilla.org/show_bug.cgi?id=1810705)

#### [#CVE-2023-25750: Potential ServiceWorker cache leak during private browsing mode](#CVE-2023-25750)

Reporter
Kagami Rosylight
Impact
high
##### Description

Under certain circumstances, a ServiceWorker's offline cache may have leaked to the file system when using private browsing mode.

##### References

* [Bug 1814733](https://bugzilla.mozilla.org/show_bug.cgi?id=1814733)

#### [#CVE-2023-25751: Incorrect code generation during JIT compilation](#CVE-2023-25751)

Reporter
Lukas Bernhard
Impact
high
##### Description

Sometimes, when invalidating JIT code while following an iterator, the newly generated code could be overwritten incorrectly. This could lead to a potentially exploitable crash.

##### References

* [Bug 1814899](https://bugzilla.mozilla.org/show_bug.cgi?id=1814899)

#### [#CVE-2023-28160: Redirect to Web Extension files may have leaked local path](#CVE-2023-28160)

Reporter
Rob Wu
Impact
moderate
##### Description

When following a redirect to a publicly accessible web extension file, the URL may have been translated to the actual local path, leaking potentially sensitive information.

##### References

* [Bug 1802385](https://bugzilla.mozilla.org/show_bug.cgi?id=1802385)

#### [#CVE-2023-28164: URL being dragged from a removed cross-origin iframe into the same tab triggered navigation](#CVE-2023-28164)

Reporter
Luan Herrera
Impact
moderate
##### Description

Dragging a URL from a cross-origin iframe that was removed during the drag could have led to user confusion and website spoofing attacks.

##### References

* [Bug 1809122](https://bugzilla.mozilla.org/show_bug.cgi?id=1809122)

#### [#CVE-2023-28161: One-time permissions granted to a local file were extended to other local files loaded in the same tab](#CVE-2023-28161)

Reporter
Khiem Tran
Impact
moderate
##### Description

If temporary "one-time" permissions, such as the ability to use the Camera, were granted to a document loaded using a file: URL, that permission persisted in that tab for all other documents loaded from a file: URL. This is potentially dangerous if the local files came from different sources, such as in a download directory.

##### References

* [Bug 1811181](https://bugzilla.mozilla.org/show_bug.cgi?id=1811181)

#### [#CVE-2023-28162: Invalid downcast in Worklets](#CVE-2023-28162)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

While implementing AudioWorklets, some code may have casted one type to another, invalid, dynamic type. This could have led to a potentially exploitable crash.

##### References

* [Bug 1811327](https://bugzilla.mozilla.org/show_bug.cgi?id=1811327)

#### [#CVE-2023-25752: Potential out-of-bounds when accessing throttled streams](#CVE-2023-25752)

Reporter
Ronald Crane
Impact
moderate
##### Description

When accessing throttled streams, the count of available bytes needed to be checked in the calling function to be within bounds. This may have lead future code to be incorrect and vulnerable.

##### References

* [Bug 1811627](https://bugzilla.mozilla.org/show_bug.cgi?id=1811627)

#### [#CVE-2023-28163: Windows Save As dialog resolved environment variables](#CVE-2023-28163)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When downloading files through the Save As dialog on Windows with suggested filenames containing environment variable names, Windows would have resolved those in the context of the current user.
*This bug only affects Firefox on Windows. Other versions of Firefox are unaffected.*

##### References

* [Bug 1817768](https://bugzilla.mozilla.org/show_bug.cgi?id=1817768)

#### [#CVE-2023-28176: Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](#CVE-2023-28176)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110 and Firefox ESR 102.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111 and Firefox ESR 102.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1808352%2C1811637%2C1815904%2C1817442%2C1818674)

#### [#CVE-2023-28177: Memory safety bugs fixed in Firefox 111](#CVE-2023-28177)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Calixte Denizet, Gabriele Svelto, Andrew McCreight, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 110. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 111](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1803109%2C1808832%2C1809542%2C1817336)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


