The provided content is related to CVE-2023-25119.

**Root Cause of Vulnerability:**
The root cause is the usage of `sprintf` with user-controlled data within the `vtysh_ubus` binary of Milesight UR32L routers. The `sprintf` function is used to format strings based on user supplied input, and these strings are then used to construct commands for execution. Since the size of the buffer where `sprintf` writes is fixed, an attacker can cause a buffer overflow by supplying overly large strings as input.

**Weaknesses/Vulnerabilities:**
The vulnerability is a stack-based buffer overflow (CWE-121) present in multiple functions within the `vtysh_ubus` binary. The common pattern involves parsing parameters from `blobmsg` structures received in HTTP requests and using `sprintf` to compose commands for another service. By controlling the data passed to `sprintf`, an attacker can overflow the buffer allocated for the command. This specific CVE is triggered via the `remote_subnet` and `remote_mask` parameters within the `set_pptp` function.

**Impact of Exploitation:**
Successful exploitation can lead to arbitrary code execution on the affected device. This can allow an attacker to completely take over the router, potentially leading to data exfiltration, denial of service, or pivoting to other devices within the same network.

**Attack Vectors:**
The attack vector is through specially crafted HTTP POST requests to the `/cgi` endpoint of the Milesight router. The attacker needs to send a JSON payload with specific "core" and "function" values, along with specially crafted "values" with oversized strings that will cause the buffer overflow within the `sprintf` command in the `set_pptp` function, specifically the `remote_subnet` and `remote_mask` fields.

**Required Attacker Capabilities/Position:**
The attacker needs to have high privileges on the router to send the malicious HTTP requests which trigger the vulnerabilities. This implies the attacker may already have some level of access to the device, either through compromised credentials or other exploits.

**Specific details related to CVE-2023-25119:**
The vulnerability exists in the `set_pptp` function. The `remote_subnet` and `remote_mask` JSON keys are used to fetch values that will be passed to a `sprintf` function:
```
is_equal = strcmp(table_key,"remote_subnet");
if (is_equal == 0) {
	[...]
	if (table_value != (char *)0x0) {
		remote_subnet = (char *)blobmsg_data(table_value);
	}
}
else {
	is_equal = strcmp(table_key,"remote_mask");
	[...]
	if ((is_equal == 0) && ([...], table_value != (char *)0x0)) {
		remote_mask = (char *)blobmsg_data(table_value);
	}
}
```
The vulnerability is triggered when the `sprintf` function is called with these values:
```
sprintf(vtysh_command_buffer,"remote subnet %s %s",remote_subnet,remote_mask);
```
An example of a payload:
```
{
	"id": 9,
	"execute": 1,
	"core": "yruo_vpn_pptp",
	"function": "set",
	"values": [
		{
			"base": "yruo_vpn_pptp",
			"index": 1,
			"value": {
				"remote_subnet": "A"*0x600,
				"remote_mask": "POC",
			}
		}
	]
}
```