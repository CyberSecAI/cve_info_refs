=== Content from lists.debian.org_bdc4043c_20250114_181309.html ===


---

[[Date Prev](msg00033.html)][Date Next]
[[Thread Prev](msg00033.html)][Thread Next]
[[Date Index](maillist.html#00034)]
[[Thread Index](threads.html#00034)]

# [SECURITY] [DLA 3513-1] tiff security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3513-1] tiff security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Mon, 31 Jul 2023 23:56:20 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZMhKJKxZFUd888sD%40localhost)Â [ZMhKJKxZFUd888sD@localhost](msg00034.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3513-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
July 31, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : tiff
Version        : 4.1.0+git191117-2~deb10u8
CVE ID         : CVE-2023-2908 CVE-2023-3316 CVE-2023-3618 CVE-2023-25433
                 CVE-2023-26965 CVE-2023-26966 CVE-2023-38288 CVE-2023-38289
Debian Bug     : 1040945

Multiple vulnerabilities were found in tiff, a library and tools
providing support for the Tag Image File Format (TIFF).

CVE-2023-2908

    NULL pointer dereference in tif_dir.c

CVE-2023-3316

    NULL pointer dereference in TIFFClose()

CVE-2023-3618

    Buffer overflow in tiffcrop

CVE-2023-25433

    Buffer overflow in tiffcrop

CVE-2023-26965

    Use after free in tiffcrop

CVE-2023-26966

    Buffer overflow in uv_encode()

CVE-2023-38288

    Integer overflow in tiffcp

CVE-2023-38289

    Integer overflow in raw2tiff

For Debian 10 buster, these problems have been fixed in version
4.1.0+git191117-2~deb10u8.

We recommend that you upgrade your tiff packages.

For the detailed security status of tiff please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/tiff>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmTISiQACgkQiNJCh6LY
mLE4oxAAsLoU6HtnZqYIurv0h/+D1aJ1AkSSlp9pfLvJiuPl5nWa5h5E+jYEGkK1
O39SOJNVXoDqixLv4LfCqhyGWffY8NZB+d9fidV5lHml7PwOjsLECAN2to4WJW7m
tsCzG0STEwGn9W1kS12zGBKJt8La+h8V4T4ZrCZIW41RzkOhmUhFYIpKCrB1Z0qs
Z2wGLR2zBnMBr9RiwGVEHKiogZgOYr0VS0g0pZasDFGR++ra/JZfjotzIxmWTt4v
Nkued+JWymGMmieiM93SHPA6BRbWI3fU0bQ4mKXuJppMBy0wDL3DXdu9HG+NlU9T
U9WVWLoY5xqUGBaYaMirDcVslPTjYAuTyCiUtHIlkv8EV+6Eafl1CBZnzNPdyGId
wuMxCHPQjAScUue3WpYX8hd2xSpgC1M0q+CLUde1sav7v9idOJFNe4jZ656cMcKY
6NS5ZxIwHEj8GnbN15qvkpuvIfsrOfXQhkNr9TLE4iOs2V4bSBWumGK7FsML7uMR
HfHtZk1CYojq59yQFNIbV58oqLghsmDuJBgQOEOTnS9Kau0Bbjum5+I/LSlmdweF
Qjpv1ARfc5SMoDYSA6/Yl0Zwx0j58hWopK2wDyzY6HQduTCNk4XkRWHROCEaSmiC
G2wKf9KsM6lgruHhHNB1r817J5bwNZ42X6ClGvP5Je+WHBJffyY=
=GGoQ
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.com_0321d82d_20250114_181307.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# heap-buffer-overflow in processCropSelections() at /libtiff/tools/tiffcrop.c:8499 (SIGSEGV)

# Summary

An SIGSEGV caused when using tiffcrop.

AddressSanitizer reports it as heap-buffer-overflow.

# Version

```
$ ./tools/tiffcrop  -v
Library Release: LIBTIFF, Version 4.5.0
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.
Tiffcp code: Copyright (c) 1988-1997 Sam Leffler
           : Copyright (c) 1991-1997 Silicon Graphics, Inc
Tiffcrop additions: Copyright (c) 2007-2010 Richard Nolde

$ git log --oneline -1
a63e18ca (HEAD -> master, origin/master, origin/HEAD) Merge branch 'add_windows_DLL_versioninfo' into 'master'
```

# Steps to reproduce

## make

```
git clone https://gitlab.com/libtiff/libtiff.git
cd libtiff
./autogen.sh
./configure
make
```

## run

```
./tools/tiffcrop -Z 12:50,12:99 -R 270 poc /dev/null
TIFFReadDirectoryCheckOrder: Warning, Invalid TIFF directory; tags are not sorted in ascending order.
TIFFReadDirectory: Warning, Unknown field with tag 12336 (0x3030) encountered.
TIFFFetchNormalTag: Defined set_field_type of custom tag 12336 (Tag 12336) is TIFF_SETGET_UNDEFINED and thus tag is not read from file.
TIFFReadDirectory: Warning, Sum of Photometric type-related color channels and ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as ExtraSamples..
TIFFAdvanceDirectory: Error fetching directory count.
loadImage: Image lacks Photometric interpretation tag.
Fax4Decode: Uncompressed data (not supported) at line 0 of strip 0 (x 10).

(... too long ignore)

fish: Job 1, './tools/tiffcrop  -Z 12:50,12:9â€¦' terminated by signal SIGSEGV (Address boundary error)
```

# Platform

```
$ uname -a
Linux 13579 5.15.0-56-generic #62~20.04.1-Ubuntu SMP Tue Nov 22 21:24:20 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux

$ gcc --version
gcc (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Copyright (C) 2019 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
```

# ASAN report

```
==3490861==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fb40a368a45 at pc 0x7fb40d6e7f3d bp 0x7ffca5726e70 sp 0x7ffca5726618
WRITE of size 296067 at 0x7fb40a368a45 thread T0
    #0 0x7fb40d6e7f3c in __interceptor_memset ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:762
    #1 0x7fb40d614fb7 in _TIFFmemset /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/libtiff/tif_unix.c:341
    #2 0x560accbdb18a in processCropSelections /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/tiffcrop.c:8499
    #3 0x560accbbe0e9 in main /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/tiffcrop.c:2807
    #4 0x7fb40d0d8082 in __libc_start_main ../csu/libc-start.c:308
    #5 0x560accbb4b6d in _start (/home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/.libs/tiffcrop+0x9b6d)

0x7fb40a368a45 is located 0 bytes to the right of 148037-byte region [0x7fb40a344800,0x7fb40a368a45)
allocated by thread T0 here:
    #0 0x7fb40d78d808 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cc:144
    #1 0x7fb40d614f03 in _TIFFmalloc /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/libtiff/tif_unix.c:326
    #2 0x560accbb4d00 in limitMalloc /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/tiffcrop.c:710
    #3 0x560accbe005e in rotateImage /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/tiffcrop.c:9605
    #4 0x560accbdb9f3 in processCropSelections /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/tiffcrop.c:8566
    #5 0x560accbbe0e9 in main /home/a13579/fuzz_lib_tiff/report/libtiff_asan/libtiff/tools/tiffcrop.c:2807
    #6 0x7fb40d0d8082 in __libc_start_main ../csu/libc-start.c:308

SUMMARY: AddressSanitizer: heap-buffer-overflow ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:762 in __interceptor_memset
Shadow bytes around the buggy address:
  0x0ff7014650f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff701465100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff701465110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff701465120: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff701465130: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0ff701465140: 00 00 00 00 00 00 00 00[05]fa fa fa fa fa fa fa
  0x0ff701465150: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff701465160: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff701465170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff701465180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff701465190: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==3490861==ABORTING
```

# poc

[poc](/-/project/4720790/uploads/434e1926d806f413edafb3b81cde4b54/poc)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_76e81881_20250114_181308.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# tiffcrop correctly update buffersize after rotateImage() fix#520

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/libtiff/libtiff/-/merge_requests/467.patch)
* [Plain diff](/libtiff/libtiff/-/merge_requests/467.diff)

[Su Laus](/Su_Laus) requested to merge  [Su\_Laus/libtiff:tiffcrop\_correctly\_update\_buffersize\_after\_rotate\_fix#520](/Su_Laus/libtiff/-/tree/tiffcrop_correctly_update_buffersize_after_rotate_fix%23520 "Su_Laus/libtiff:tiffcrop_correctly_update_buffersize_after_rotate_fix#520")
 into [master](/libtiff/libtiff/-/tree/master "master") Feb 03, 2023

* [Overview
  2](/libtiff/libtiff/-/merge_requests/467)
* [Commits
  2](/libtiff/libtiff/-/merge_requests/467/commits)
* [Pipelines
  2](/libtiff/libtiff/-/merge_requests/467/pipelines)
* [Changes
  1](/libtiff/libtiff/-/merge_requests/467/diffs)

Expand

rotateImage() set up a new buffer and calculates its size individually. Therefore, seg\_buffs[] size needs to be updated accordingly. Before this fix, the seg\_buffs buffer size was calculated with a different formula than within rotateImage().

Closes [#520 (closed)](/libtiff/libtiff/-/issues/520 "heap-buffer-overflow in processCropSelections() at /libtiff/tools/tiffcrop.c:8499 (SIGSEGV)")

Edited Feb 03, 2023 by [Su Laus](/Su_Laus)

## Merge request reports

Assignee
Loading

Reviewers
Loading

Select reviewersRequest review fromLoading

Time tracking
Loading

Loading


