=== Content from github.com_758d0cee_20250115_093617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatahub-project%2Fdatahub%2Fsecurity%2Fadvisories%2FGHSA-3974-hxjh-m3jj)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatahub-project%2Fdatahub%2Fsecurity%2Fadvisories%2FGHSA-3974-hxjh-m3jj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=datahub-project%2Fdatahub)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[datahub-project](/datahub-project)
/
**[datahub](/datahub-project/datahub)**
Public

* [Notifications](/login?return_to=%2Fdatahub-project%2Fdatahub) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fdatahub-project%2Fdatahub)
* [Star
   10.1k](/login?return_to=%2Fdatahub-project%2Fdatahub)

* [Code](/datahub-project/datahub)
* [Issues
  202](/datahub-project/datahub/issues)
* [Pull requests
  146](/datahub-project/datahub/pulls)
* [Actions](/datahub-project/datahub/actions)
* [Projects
  1](/datahub-project/datahub/projects)
* [Security](/datahub-project/datahub/security)
* [Insights](/datahub-project/datahub/pulse)

Additional navigation options

* [Code](/datahub-project/datahub)
* [Issues](/datahub-project/datahub/issues)
* [Pull requests](/datahub-project/datahub/pulls)
* [Actions](/datahub-project/datahub/actions)
* [Projects](/datahub-project/datahub/projects)
* [Security](/datahub-project/datahub/security)
* [Insights](/datahub-project/datahub/pulse)

# Failure to Invalidate Session on Logout (`GHSL-2022-083`)

Moderate

[david-leifker](/david-leifker)
published
GHSA-3974-hxjh-m3jj
Jan 6, 2023

## Package

datahub-frontend
(Java)

## Affected versions

<v0.8.45

## Patched versions

v0.8.45

## Description

### Impact

This issue may lead to an authentication bypass.

### Severity

Moderate

6.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
High

Privileges required
High

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N

### CVE ID

CVE-2023-25562

### Weaknesses

No CWEs

### Credits

* [![@p-](https://avatars.githubusercontent.com/u/176818?s=40&v=4)](/p-)
  [p-](/p-)
  Analyst
* [![@jorgectf](https://avatars.githubusercontent.com/u/46056498?s=40&v=4)](/jorgectf)
  [jorgectf](/jorgectf)
  Analyst
* [![@pwntester](https://avatars.githubusercontent.com/u/125701?s=40&v=4)](/pwntester)
  [pwntester](/pwntester)
  Analyst
* [![@artsploit](https://avatars.githubusercontent.com/u/44605151?s=40&v=4)](/artsploit)
  [artsploit](/artsploit)
  Analyst
* [![@Kwstubbs](https://avatars.githubusercontent.com/u/11400619?s=40&v=4)](/Kwstubbs)
  [Kwstubbs](/Kwstubbs)
  Analyst
* [![@sylwia-budzynska](https://avatars.githubusercontent.com/u/102833689?s=40&v=4)](/sylwia-budzynska)
  [sylwia-budzynska](/sylwia-budzynska)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6912c03c_20250115_093617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatahub-project%2Fdatahub%2Fblob%2Faa146db611e3a4ca3aa17bb740783f789d4444d3%2Fdatahub-frontend%2Fapp%2Fauth%2FAuthUtils.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdatahub-project%2Fdatahub%2Fblob%2Faa146db611e3a4ca3aa17bb740783f789d4444d3%2Fdatahub-frontend%2Fapp%2Fauth%2FAuthUtils.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=datahub-project%2Fdatahub)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[datahub-project](/datahub-project)
/
**[datahub](/datahub-project/datahub)**
Public

* [Notifications](/login?return_to=%2Fdatahub-project%2Fdatahub) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fdatahub-project%2Fdatahub)
* [Star
   10.1k](/login?return_to=%2Fdatahub-project%2Fdatahub)

* [Code](/datahub-project/datahub)
* [Issues
  202](/datahub-project/datahub/issues)
* [Pull requests
  146](/datahub-project/datahub/pulls)
* [Actions](/datahub-project/datahub/actions)
* [Projects
  1](/datahub-project/datahub/projects)
* [Security](/datahub-project/datahub/security)
* [Insights](/datahub-project/datahub/pulse)

Additional navigation options

* [Code](/datahub-project/datahub)
* [Issues](/datahub-project/datahub/issues)
* [Pull requests](/datahub-project/datahub/pulls)
* [Actions](/datahub-project/datahub/actions)
* [Projects](/datahub-project/datahub/projects)
* [Security](/datahub-project/datahub/security)
* [Insights](/datahub-project/datahub/pulse)

## Files

 aa146db
## Breadcrumbs

1. [datahub](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3)
2. /[datahub-frontend](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend)
3. /[app](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend/app)
4. /[auth](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend/app/auth)
/
# AuthUtils.java

Copy path Blame  Blame
## Latest commit

## History

[History](/datahub-project/datahub/commits/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend/app/auth/AuthUtils.java)106 lines (91 loc) · 4.67 KB aa146db
## Breadcrumbs

1. [datahub](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3)
2. /[datahub-frontend](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend)
3. /[app](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend/app)
4. /[auth](/datahub-project/datahub/tree/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend/app/auth)
/
# AuthUtils.java

Top
## File metadata and controls

* Code
* Blame

106 lines (91 loc) · 4.67 KB[Raw](https://github.com/datahub-project/datahub/raw/aa146db611e3a4ca3aa17bb740783f789d4444d3/datahub-frontend/app/auth/AuthUtils.java)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106package auth;
import com.linkedin.common.urn.CorpuserUrn;import lombok.extern.slf4j.Slf4j;import play.mvc.Http;
import java.time.Duration;import java.time.temporal.ChronoUnit;
@Slf4jpublic class AuthUtils {
 /\*\* \* The config path that determines whether Metadata Service Authentication is enabled. \* \* When enabled, the frontend server will proxy requests to the Metadata Service without requiring them to have a valid \* frontend-issued Session Cookie. This effectively means delegating the act of authentication to the Metadata Service. It \* is critical that if Metadata Service authentication is enabled at the frontend service layer, it is also enabled in the \* Metadata Service itself. Otherwise, unauthenticated traffic may reach the Metadata itself. \* \* When disabled, the frontend server will require that all requests have a valid Session Cookie associated with them. Otherwise, \* requests will be denied with an Unauthorized error. \*/ public static final String METADATA\_SERVICE\_AUTH\_ENABLED\_CONFIG\_PATH = "metadataService.auth.enabled";
 /\*\* \* The attribute inside session cookie representing a GMS-issued access token \*/ public static final String SESSION\_COOKIE\_GMS\_TOKEN\_NAME = "token";
 /\*\* \* An ID used to identify system callers that are internal to DataHub. Provided via configuration. \*/ public static final String SYSTEM\_CLIENT\_ID\_CONFIG\_PATH = "systemClientId";
 /\*\* \* An Secret used to authenticate system callers that are internal to DataHub. Provided via configuration. \*/ public static final String SYSTEM\_CLIENT\_SECRET\_CONFIG\_PATH = "systemClientSecret";
 public static final String SESSION\_TTL\_CONFIG\_PATH = "auth.session.ttlInHours"; public static final Integer DEFAULT\_SESSION\_TTL\_HOURS = 720; public static final CorpuserUrn DEFAULT\_ACTOR\_URN = new CorpuserUrn("datahub");
 public static final String LOGIN\_ROUTE = "/login"; public static final String USER\_NAME = "username"; public static final String PASSWORD = "password"; public static final String ACTOR = "actor"; public static final String ACCESS\_TOKEN = "token"; public static final String FULL\_NAME = "fullName"; public static final String EMAIL = "email"; public static final String TITLE = "title"; public static final String INVITE\_TOKEN = "inviteToken"; public static final String RESET\_TOKEN = "resetToken";
 /\*\* \* Determines whether the inbound request should be forward to downstream Metadata Service. Today, this simply \* checks for the presence of an "Authorization" header or the presence of a valid session cookie issued \* by the frontend. \* \* Note that this method DOES NOT actually verify the authentication token of an inbound request. That will \* be handled by the downstream Metadata Service. Until then, the request should be treated as UNAUTHENTICATED. \* \* Returns true if the request is eligible to be forwarded to GMS, false otherwise. \*/ public static boolean isEligibleForForwarding(Http.Context ctx) { return hasValidSessionCookie(ctx) || hasAuthHeader(ctx); }
 /\*\* \* Returns true if a request has a valid session cookie issued by the frontend server. \* Note that this DOES NOT verify whether the token within the session cookie will be accepted \* by the downstream GMS service. \* \* Note that we depend on the presence of 2 cookies, one accessible to the browser and one not, \* as well as their agreement to determine authentication status. \*/ public static boolean hasValidSessionCookie(final Http.Context ctx) { return ctx.session().containsKey(ACTOR) && ctx.request().cookie(ACTOR) != null && ctx.session().get(ACTOR).equals(ctx.request().cookie(ACTOR).value()); }
 /\*\* \* Returns true if a request includes the Authorization header, false otherwise \*/ public static boolean hasAuthHeader(final Http.Context ctx) { return ctx.request().getHeaders().contains(Http.HeaderNames.AUTHORIZATION); }
 /\*\* \* Creates a client authentication cookie (actor cookie) with a specified TTL in hours. \* \* @param actorUrn the urn of the authenticated actor, e.g. "urn:li:corpuser:datahub" \* @param ttlInHours the number of hours until the actor cookie expires after being set \*/ public static Http.Cookie createActorCookie(final String actorUrn, final Integer ttlInHours) { return Http.Cookie.builder(ACTOR, actorUrn) .withHttpOnly(false) .withMaxAge(Duration.of(ttlInHours, ChronoUnit.HOURS)) .build(); }
 private AuthUtils() { }
}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


