=== Content from bugzilla.mozilla.org_c94d96e0_20250114_202227.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1811852)
* [XML](/show_bug.cgi?ctype=xml&id=1811852)

Closed
[Bug 1811852](/show_bug.cgi?id=1811852)
(CVE-2023-25738)

Opened 2 years ago
Closed 2 years ago

# Firefox crashes on Windows when printing a page (sometimes)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox crashes on Windows when printing a page (sometimes)

## Categories

### (Toolkit :: Printing, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Printing#Printing)

Printing
▾

Toolkit :: Printing
Print Preview and other toolkit elements of printing.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Printing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Printing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Printing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 109

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 110+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 | + | fixed |
| firefox111 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mashupmark, Assigned: bobowen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/17ee32d16cf9433737bcb30ea0f0d965?d=mm&size=40)  [mashupmark](/user_profile?user_id=687521)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8407f1551cb10122bad1fc181e6177ac?d=mm&size=40)  [mstriemer](/user_profile?user_id=492360)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uninitialized, reporter-external, sec-high, Whiteboard: [adv-main110+][adv-esr102.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25738

[Keywords:](/describekeywords.cgi)

[csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main110+][adv-esr102.8+]

QA Whiteboard:

[qa-triaged] [post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ memcpy | nsPrintSettingsWin::CopyDevMode ]](https://crash-stats.mozilla.org/signature/?signature=memcpy%20%7C%20nsPrintSettingsWin%3A%3ACopyDevMode)

[[@ memcpy | nsPrintSettingsWin::SetDevMode ]](https://crash-stats.mozilla.org/signature/?signature=memcpy%20%7C%20nsPrintSettingsWin%3A%3ASetDevMode)

[[@ memcpy\_repmovs | nsPrintSettingsWin::CopyDevMode ]](https://crash-stats.mozilla.org/signature/?signature=memcpy_repmovs%20%7C%20nsPrintSettingsWin%3A%3ACopyDevMode)

[[@ memcpy\_repmovs | nsPrintSettingsWin::SetDevMode ]](https://crash-stats.mozilla.org/signature/?signature=memcpy_repmovs%20%7C%20nsPrintSettingsWin%3A%3ASetDevMode)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!](/attachment.cgi?id=9314548)  [2 years ago](#c28)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c41 "2 years ago")  pascalc : [approval-mozilla-esr102+](#c43 "2 years ago")  tjr : [sec-approval+](#c31 "2 years ago") | [Details](/attachment.cgi?id=9314548&action=edit) | [Review](/attachment.cgi?id=9314548) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9317094)  [2 years ago](#c51)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   407 bytes, text/plain |  | [Details](/attachment.cgi?id=9317094&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1811852#c0)• 2 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0

Steps to reproduce:

Visit a long URL, such as: <https://crm1.mozilla.com/survey.php?firstname=Lisa&lastname=Smith&assignedto=Town&postcode=NE1%202AE&telephonehome=07777754&email=lisasmith@hotmail.co.uk&address1=13%20Front%20Street&city=Newcastle&source=Search%20Engine%20(Google,%20Yahoo%20etc)&surveydate=2023-01-25T14:00>

(I've used fake data above, but can provide a real URL if you need).

Then click print, print dialogue box shows up, then firefox crashes.

Actual results:

Browser crashes fully. All windows and tabs close.

Expected results:

Browser should print the page.

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a239_691597)• 2 years ago |

Component: Untriaged → PrintingProduct: Firefox → Toolkit

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1811852#c1)• 2 years ago |
|  | |

That didn't crash for me on Mac OS, but I wouldn't be surprised if the print preview code is different on different OSes.

Are you on Windows? Could you please go to about:crashes and post the crash-stats.mozilla.org here? Thanks. This probably isn't a security issue, which maybe we can tell from the crash report.

Flags: needinfo?(mashupmark)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1811852#c2)• 2 years ago |
|  | |

Hi the report is here: <https://crash-stats.mozilla.org/report/index/082e9494-99c5-4752-b225-edcb90230123#tab-details>

Flags: needinfo?(mashupmark)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1811852#c3)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #1](/show_bug.cgi?id=1811852#c1 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> That didn't crash for me on Mac OS, but I wouldn't be surprised if the print preview code is different on different OSes.
>
> Are you on Windows? Could you please go to about:crashes and post the crash-stats.mozilla.org here? Thanks. This probably isn't a security issue, which maybe we can tell from the crash report.

Yes on Windows 10, latest updates.

This has happened on multiple versions of Firefox from as far back as 2 years ago.

I can't see crash stats, but I can post the report here: <https://crash-stats.mozilla.org/report/index/082e9494-99c5-4752-b225-edcb90230123#tab-details>

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1811852#c4)• 2 years ago |
|  | |

Thanks.

Wow, that's not what I was expecting at all. We're crashing inside TraceProtoAndIfaceCache. Very weird.

Group: firefox-core-security → dom-core-securityCrash Signature: [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ]Component: Printing → DOM: Bindings (WebIDL)Product: Toolkit → Core

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1811852#c5)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #4](/show_bug.cgi?id=1811852#c4 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Thanks.
>
> Wow, that's not what I was expecting at all. We're crashing inside TraceProtoAndIfaceCache. Very weird.

Indeed! An interesting one. Is it the url length or special characters maybe?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1811852#c6)• 2 years ago |
|  | |

Bob, any chance you could take a look? I moved this to DOM bindings, but I guess it is still most likely the issue originates in printing somehow. Thanks.

Flags: needinfo?(bobowencode)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1811852#c7)• 2 years ago |
|  | |

Can you reproduce this issue without any extensions enabled? The URL there isn't all that long in the grand scheme of things, and this crash doesn't appear to be very common, so we want to figure out if there's something unique about your setup that might cause this issue so we can fix it. Thanks.

Flags: needinfo?(mashupmark)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1811852#c8)• 2 years ago |
|  | |

I guess I'll move this back to printing for now. Sorry about my indecisiveness.

Group: dom-core-security → firefox-core-securityComponent: DOM: Bindings (WebIDL) → PrintingProduct: Core → Toolkit

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1811852#c9)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #6](/show_bug.cgi?id=1811852#c6 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Bob, any chance you could take a look? I moved this to DOM bindings, but I guess it is still most likely the issue originates in printing somehow. Thanks.

I'm not really sure I can help much at the moment.

While it appears to be triggered by printing, there isn't even any printing specific code on the stack when it crashes.

We could probably do with someone who understands the interactions of GC and the tracing, to work out what type of thing might be causing this.

Even then given where it is crashing, I guess the issue will be in JS code rather than the native printing code.

In addition, I don't seem to be able to reproduce.

Flags: needinfo?(bobowencode)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1811852#c10)• 2 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #9](/show_bug.cgi?id=1811852#c9 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> (In reply to Andrew McCreight [:mccr8] from [comment #6](/show_bug.cgi?id=1811852#c6 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
>
> > Bob, any chance you could take a look? I moved this to DOM bindings, but I guess it is still most likely the issue originates in printing somehow. Thanks.
>
> I'm not really sure I can help much at the moment.
>
> While it appears to be triggered by printing, there isn't even any printing specific code on the stack when it crashes.
>
> We could probably do with someone who understands the interactions of GC and the tracing, to work out what type of thing might be causing this.
>
> Even then given where it is crashing, I guess the issue will be in JS code rather than the native printing code.
>
> In addition, I don't seem to be able to reproduce.

For what it's worth. The page I'm trying to print is a flat HTML document. No javascript on the page at all (I presume you mean JS in firefox and not the page being printed).

How do I start FF with all plugins disabled?

Flags: needinfo?(mashupmark)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1811852#c11)• 2 years ago |
|  | |

This page describes [how to start in Troubleshooting mode](https://support.mozilla.org/en-US/kb/diagnose-firefox-issues-using-troubleshoot-mode), which will hopefully will do the trick.

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1811852#c12)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #11](/show_bug.cgi?id=1811852#c11 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> This page describes [how to start in Troubleshooting mode](https://support.mozilla.org/en-US/kb/diagnose-firefox-issues-using-troubleshoot-mode), which will hopefully will do the trick.

Hi all, crashed again in troubleshooting mode with all plugins disabled: <https://crash-stats.mozilla.org/report/index/f006003a-94fc-458d-8498-176b70230124>

Flags: needinfo?(continuation)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1811852#c13)• 2 years ago |
|  | |

The bug has a crash signature, thus the bug will be considered confirmed.

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1811852#c14)• 2 years ago |
|  | |

(In reply to Mark from [comment #12](/show_bug.cgi?id=1811852#c12 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Hi all, crashed again in troubleshooting mode with all plugins disabled: <https://crash-stats.mozilla.org/report/index/f006003a-94fc-458d-8498-176b70230124>

Thanks. The stack in that crash is actually printing code so that makes a little more sense.

Flags: needinfo?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a94524_406194)• 2 years ago |

Crash Signature: [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] → [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] [@ memcpy | nsPrintSettingsWin::CopyDevMode ]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1811852#c15)• 2 years ago |
|  | |

One of the crashes with that signature has the comment: "firefox crashes when I use my default printer. It pretended to print once (nothing is in the print queue.) I got it to use another printer, but when I switched back to default it crashed after the print preview. I restarted and it crashed when I hit ctrl+p. I didn't even get a preview. This has been happening for a couple days now."

Maybe flipping the printer back and forth got it into a broken state or something?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1811852#c16)• 2 years ago |
|  | |

> I can't see crash stats, but I can post the report here

That's extremely odd—that's a public URL and should load just fine. Are you on a network with content filtering that for some reason considers that a "bad site"? Do you get any kind of error when you try to load that URL? Or does it just act like that site doesn't exist?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1811852#c17)• 2 years ago |
|  | |

The `mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace` crash has happened at a low level for a long time on both linux, android, and windows (32 crashes in 6 months). There are no comments on any of these crashes.

The `memcpy | nsPrintSettingsWin::CopyDevMode` crash is higher volume, only on Windows, and started with Firefox 106 (95 crashes in 3 months). Lots of user comments about printing. CopyDevMode is inlined (which crash-stats didn't handle in the past) and called by SetDevMode so I looked at that to see about signature changes. Crashes at [@ memcpy | nsPrintSettingsWin::SetDevMode ] affect Firefox 105 but not 106 which bolsters the argument for signature drift. But it can't be simply the crash-stats inline change because lower versions (especially Firefox 102 ESR releases) continue to crash at the same SetDevMode line, and I would have expected a mix of 105 and 106 versions in both signatures on either side of the change-over date.

At least one of the comments said it happened once during print-preview, and these days it looks like pages can trigger that directly with `window.print()`. The print function itself is old, but it used to require an additional step from the user to get to the preview. More convenient (less clicking) for the user, but does mean this code is reachable if this crash turns out to be a vulnerability.

The memcpy() part of the signature is certainly scary. All the crashes are READs so I think we calculated a size that was too large and read off the end of the source data. We only get here if we successfully allocated the too-large destination buffer so that doesn't look exploitable if I'm correct. I didn't dig too deeply, but it looks like the two values we use to calculate the size come from a Windows API structure. Did we forget to check for error responses at some earlier point and are using bogus/uninitialized values? Is there anything more dangerous we could end up doing with those values that would be even more dangerous if we managed to avoid crashing at this spot?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1811852#c18)• 2 years ago |
|  | |

I think the length of the URL is a red herring. most of the ones I could see in crash-stats (non-public data) were a reasonable length.

Summary: Firefox crashes when printing a page from a long URL link → Firefox crashes on Windows when printing a page (sometimes)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a144168_1689)• 2 years ago |

Crash Signature: [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] [@ memcpy | nsPrintSettingsWin::CopyDevMode ] → [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] [@ memcpy | nsPrintSettingsWin::CopyDevMode ][@ memcpy | nsPrintSettingsWin::SetDevMode ]
[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a144268_1689)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1811852#c19)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #16](/show_bug.cgi?id=1811852#c16 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> > I can't see crash stats, but I can post the report here
>
> That's extremely odd—that's a public URL and should load just fine. Are you on a network with content filtering that for some reason considers that a "bad site"? Do you get any kind of error when you try to load that URL? Or does it just act like that site doesn't exist?

No content filtering. Just a standard site and standard internet connection. The site exists and is always online.

Crash Signature: [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] [@ memcpy | nsPrintSettingsWin::CopyDevMode ][@ memcpy | nsPrintSettingsWin::SetDevMode ] → [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ]

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1811852#c20)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #18](/show_bug.cgi?id=1811852#c18 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> I think the length of the URL is a red herring. most of the ones I could see in crash-stats (non-public data) were a reasonable length.

The reason I mentioned this, is that if I remove the string after the URL, the page prints without error.

Could it be an encoding issue or mismatch from FF to the printspooler? (sorry, not an expert in this area, just hypothesising).

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1811852#c21)• 2 years ago |
|  | |

OK that latest crash report makes much more sense, I'll take a look.

Assignee: nobody → bobowencodeStatus: NEW → ASSIGNEDCrash Signature: [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] → [@ memcpy | nsPrintSettingsWin::CopyDevMode ]
[@ memcpy | nsPrintSettingsWin::SetDevMode ]

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1811852#c22)• 2 years ago |
|  | |

Hi Mark, would you let me know what printer and if possible printer driver you are using?

Flags: needinfo?(mashupmark)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1811852#c23)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1811852&comment_id=16251388 "1 revision") |
|  | |

It looks like [`aInDevMode->dmDriverExtra` is either wrong or garbage here](https://searchfox.org/mozilla-central/rev/df68a65540f2227e27a12ed0b491188e2927f6d5/widget/windows/nsPrintSettingsWin.cpp#235).

So, we need to be [checking that here](https://searchfox.org/mozilla-central/rev/df68a65540f2227e27a12ed0b491188e2927f6d5/widget/windows/nsPrintSettingsWin.cpp#178).

Although I think we could safely set `dmDriverExtra` to zero and just copy the standard `DEVMODEW` data.

We do allocate [twice as much as it tells us](https://searchfox.org/mozilla-central/rev/df68a65540f2227e27a12ed0b491188e2927f6d5/widget/windows/nsPrinterWin.cpp#327) for the `DEVMODEW`, because of similar code in chrome, but clearly if `dmDriverExtra` is garbage that's not going to help us here.

Hmm, I wonder if a driver is adding on to `dmDriverExtra` (and maybe `dmSize`) instead of setting it.

So, we should probably set the array held by `devmodeStorageWLock` to zeros before we call `::DocumentPropertiesW`.

It would be nice if I could reproduce with a specific driver.

Either way these would be sound changes.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a204261_1689)• 2 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1811852#c24)• 2 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #22](/show_bug.cgi?id=1811852#c22 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Hi Mark, would you let me know what printer and if possible printer driver you are using?

It's a Xerox VersaLink C405 latest driver, but the crash has happened for at least 2 years. I don't know if Xerox have updated their driver in that time.

Crash Signature: [@ memcpy | nsPrintSettingsWin::CopyDevMode ]
[@ memcpy | nsPrintSettingsWin::SetDevMode ] → [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ]Flags: needinfo?(mashupmark)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1811852#c25)• 2 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #23](/show_bug.cgi?id=1811852#c23 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> It looks like [`aInDevMode->dmDriverExtra` is either wrong or garbage here](https://searchfox.org/mozilla-central/rev/df68a65540f2227e27a12ed0b491188e2927f6d5/widget/windows/nsPrintSettingsWin.cpp#235).
>
> We do allocate [twice as much as it tells us](https://searchfox.org/mozilla-central/rev/df68a65540f2227e27a12ed0b491188e2927f6d5/widget/windows/nsPrinterWin.cpp#327) for the `DEVMODEW`, because of similar code in chrome, but clearly if `dmDriverExtra` is garbage that's not going to help us here.

Oddly enough, my work around was to copy the link, paste it in to chrome and print from there, as it printed without issue in chrome.

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1811852#c26)• 2 years ago |
|  | |

Just an update, I installed the generic PPD driver from here: <https://www.support.xerox.com/en-us/product/versalink-c405/downloads?platform=win10&category=drivers&language=en_GB&attributeId=>

```
Generic PPD

The driver package contains the Generic PPD to be installed using the Windows Add Printer Wizard.

    Released: 04/16/2019
    Version: 5.662.0.0
    Size: 455.50 KB
    Filename: VersaLink_C400_5.662.0.0_PPD_English.exe
    Tags: PPD, V3 Driver

```

During the install I added the printer via IP address in the setup. It's now installed as an "MS Publisher Color Printer".

It prints without any crashes now.

So you may be right in it being a driver issue.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a347387_406194)• 2 years ago |

Crash Signature: [@ mozilla::dom::ProtoAndIfaceCache::PageTableCache::Trace ] → [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ]

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1811852#c27)• 2 years ago |
|  | |

Thanks, I couldn't reproduce with the Xerox VersaLink C405 driver, but I'm pretty sure I've worked out what is going on.

We do check the return from `::DocumentPropertiesW`, but we don't clear the array in `mDefaultDevmodeWStorage`, so next time round we think we've already read the details and use the uninitialized data in `mDefaultDevmodeWStorage`.

Patch incoming.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1811852#c28)• 2 years ago |
|  | |

Attached file
[Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!](attachment.cgi?id=9314548)
— [Details](attachment.cgi?id=9314548&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a348858_406194)• 2 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---) → [csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1811852#c29)• 2 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #27](/show_bug.cgi?id=1811852#c27 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Thanks, I couldn't reproduce with the Xerox VersaLink C405 driver, but I'm pretty sure I've worked out what is going on.
>
> We do check the return from `::DocumentPropertiesW`, but we don't clear the array in `mDefaultDevmodeWStorage`, so next time round we think we've already read the details and use the uninitialized data in `mDefaultDevmodeWStorage`.
>
> Patch incoming.

Awesome to see this bug get squished live! Thanks everyone :)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1811852#c30)• 2 years ago |
|  | |

Comment on [attachment 9314548](/attachment.cgi?id=9314548 "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") [[details]](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!")

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The issue is fairly obvious from the patch, but we don't know of a way to exploit it.

  In addition to trigger the issue would require a printer driver to return an error while retrieving the DEVMODEW.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Pretty unlikely, if printer drivers were returning incorrect sizes they'd probably already be causing problems.
* **Is Android affected?**: No
[Attachment #9314548](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1811852#c31)• 2 years ago |
|  | |

Comment on [attachment 9314548](/attachment.cgi?id=9314548 "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") [[details]](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!")

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!

Approved to land if you and relman are okay uplifting this late in cycle.

[Attachment #9314548](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") -
Flags: sec-approval? → sec-approval+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1811852#c32)• 2 years ago |
|  | |

I searched for Windows crashes with InitWithInitializer in the proto signature, and I found two other signatures which look like the same issue, and they are much more common.

Crash Signature: [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ] → [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ] [@ memcpy\_repmovs | nsPrintSettingsWin::CopyDevMode ] [@ memcpy\_repmovs | nsPrintSettingsWin::SetDevMode ]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a697727_406194)• 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1811852#c33)• 2 years ago |
|  | |

Comment on [attachment 9314548](/attachment.cgi?id=9314548 "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") [[details]](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!")

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!

### Beta/Release Uplift Approval Request

* **User impact if declined**: Intermittent browser crashes when printing.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Simple new size checks and clearing of a structure on failure to prevent subsequent re-use.

  Obviously, It would be a good idea to include some manual printing regression tests if those are not normally part of the Beta and RC testing.
* **String changes made/needed**: None
* **Is Android affected?**: No
[Attachment #9314548](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1811852#c34)• 2 years ago |
|  | |

Note that ESR is affected so we would need a request for this branch as well (and make sure that the patch does apply to this older codebase).

Thanks.

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1811852#c35)• 2 years ago |
|  | |

(In reply to Pascal Chevrel:pascalc from [comment #34](/show_bug.cgi?id=1811852#c34 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Note that ESR is affected so we would need a request for this branch as well (and make sure that the patch does apply to this older codebase).
>
> Thanks.

Coming up, just didn't think it was worth it if we weren't going to take it. :-)

It applies to all branches.

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1811852#c36)• 2 years ago |
|  | |

Comment on [attachment 9314548](/attachment.cgi?id=9314548 "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") [[details]](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!")

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-high
* **User impact if declined**: Intermittent browser crashes when printing.
* **Fix Landed on Version**: 111
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Simple new size checks and clearing of a structure on failure to prevent subsequent re-use.

  Obviously, It would be a good idea to include some manual printing regression tests.
[Attachment #9314548](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") -
Flags: approval-mozilla-esr102?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a711092_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[tracking-firefox110](/buglist.cgi?f1=cf_tracking_firefox110&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1811852#c37)• 2 years ago |
|  | |

Bob, feel free to land, I'll uplift in out last beta that builds tomorrow.

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1811852#c38)• 2 years ago |
|  | |

(In reply to Pascal Chevrel:pascalc from [comment #37](/show_bug.cgi?id=1811852#c37 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> Bob, feel free to land, I'll uplift in out last beta that builds tomorrow.

OK thanks.

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1811852#c39)• 2 years ago |
|  | |

Pushed by bobowencode@gmail.com:

<https://hg.mozilla.org/integration/autoland/rev/55ccf3adadb5c4b4bd679d366afbe090410d5d37>

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1811852#c40)• 2 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/55ccf3adadb5>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 111 Branch

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1811852#c41)• 2 years ago |
|  | |

Comment on [attachment 9314548](/attachment.cgi?id=9314548 "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") [[details]](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!")

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!

Approved for our last 110 beta, thanks.

[Attachment #9314548](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1811852#c42)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/581bd69d544a>

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1811852#c43)• 2 years ago |
|  | |

Comment on [attachment 9314548](/attachment.cgi?id=9314548 "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") [[details]](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!")

[Bug 1811852](/show_bug.cgi?id=1811852 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"): Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!

Approved for ESR 102.8.0, thanks.

[Attachment #9314548](/attachment.cgi?id=9314548&action=edit "Bug 1811852: Clear default DEVMODEW storage on failure, so that we try again next time. r=emilio!") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1811852#c44)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/e74b2a8d649e>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a922180_553429)• 2 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a927476_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Catalin Sasca, Desktop Test Engineering [:csasca]](/user_profile?user_id=612754) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1811852#c45)• 2 years ago |
|  | |

We tried reproducing the crash but we were unable to do so on two different Windows 10 systems and two different printers set as default (HP OfficeJet 6950 and HP DeskJet 3700) with the provided link in [Comment 0](/show_bug.cgi?id=1811852#c0 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)") (seems like it isn't working anymore and may be why we are unable to reproduce it).

Mark, can you please look over the builds where the fix is implemented and see that the issue is no longer reproducible ? Here's the link for [Nightly 111.0a1](https://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central/), for [Beta 110.0b9](https://archive.mozilla.org/pub/firefox/candidates/110.0b9-candidates/build1/win64/en-US/) and for [ESR102](https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/fSj_H4G8RZ2i7Spyd4-YWw/runs/0/artifacts/public/build/target.zip). Thank you!

Flags: qe-verify+ → needinfo?(mashupmark)

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1811852#c46)• 2 years ago |
|  | |

(In reply to Catalin Sasca, QA [:csasca] from [comment #45](/show_bug.cgi?id=1811852#c45 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> We tried reproducing the crash but we were unable to do so on two different Windows 10 systems and two different printers set as default (HP OfficeJet 6950 and HP DeskJet 3700) with the provided link in [Comment 0](/show_bug.cgi?id=1811852#c0 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)") (seems like it isn't working anymore and may be why we are unable to reproduce it).
>
> Mark, can you please look over the builds where the fix is implemented and see that the issue is no longer reproducible ? Here's the link for [Nightly 111.0a1](https://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central/), for [Beta 110.0b9](https://archive.mozilla.org/pub/firefox/candidates/110.0b9-candidates/build1/win64/en-US/) and for [ESR102](https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/fSj_H4G8RZ2i7Spyd4-YWw/runs/0/artifacts/public/build/target.zip). Thank you!

I can't I'm afraid. I've uninstalled that printer and installed a generic driver under "MS Publisher Color Printer" as I needed to actually print!

Do you think it was the driver that was bugged and causing the crash?

Crash Signature: [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ] [@ memcpy\_repmovs | nsPrintSettingsWin::CopyDevMode ] [@ memcpy\_repmovs | nsPrintSettingsWin::SetDevMode ] → [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ]Flags: needinfo?(mashupmark)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1811852#c47)• 2 years ago |
|  | |

(In reply to Mark from [comment #46](/show_bug.cgi?id=1811852#c46 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

...

> Do you think it was the driver that was bugged and causing the crash?

It wasn't necessarily that the driver had a bug, but if the call to get the settings failed then it triggered the issue in our code.

It's possible that the generic driver is less likely to fail, because it doesn't communicate with the printer.

I imagine it will mean that some device specific settings on the printer may not work.

That would be more likely to affect the system dialog for the printer than our print preview I would guess.

Crash Signature: [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ] → [@ memcpy | nsPrintSettingsWin::CopyDevMode ] [@ memcpy | nsPrintSettingsWin::SetDevMode ] [@ memcpy\_repmovs | nsPrintSettingsWin::CopyDevMode ] [@ memcpy\_repmovs | nsPrintSettingsWin::SetDevMode ]

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1811852#c48)• 2 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #47](/show_bug.cgi?id=1811852#c47 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> (In reply to Mark from [comment #46](/show_bug.cgi?id=1811852#c46 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
>
> ...
>
> That would be more likely to affect the system dialog for the printer than our print preview I would guess.

Hmm. I could print to PDFs and other devices that show the print preview dialogue. It was just when selecting that installed printer, it would flash up for half a second then full browser crash.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1811852#c49)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1811852&comment_id=16270429 "1 revision") |
|  | |

(In reply to Mark from [comment #48](/show_bug.cgi?id=1811852#c48 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> (In reply to Bob Owen (:bobowen) from [comment #47](/show_bug.cgi?id=1811852#c47 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
>
> > (In reply to Mark from [comment #46](/show_bug.cgi?id=1811852#c46 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
> >
> > ...
> >
> > That would be more likely to affect the system dialog for the printer than our print preview I would guess.
>
> Hmm. I could print to PDFs and other devices that show the print preview dialogue. It was just when selecting that installed printer, it would flash up for half a second then full browser crash.

Sorry, I think I made that comment confusing.

Each printer installed (including the ones that print to file) has a printer driver associated with it and it is possible that the device specific one for your Xerox VersaLink C405 communicates with the printer while retrieving its settings and sometimes that can fail, which triggers this bug in Firefox code.

By installing the generic driver it might mean that the communication doesn't happen, because it no longer communicates with the printer and only uses the standard settings structure.

I was just pointing out that having the generic driver installed might mean that the system print dialog is missing some device specific settings, because the device specific driver might normally interact with that dialog to show extra settings.

I don't think it would affect the Firefox Print Preview, because we only use the standard print settings structure that all devices have to return.

Hopefully, once the next version of Firefox rolls out next Tuesday, you will be able to reinstall the device specific driver.

The fix is already on [Beta, Nightly](https://www.mozilla.org/en-US/firefox/channel/desktop/) and Extended Support Release.

If you were able to test this it would be great.

The Beta build by default installs to the same location as Release Firefox, so I would select a custom install and change the folder/directory to "Mozilla Firefox Beta".

When you launch it, it should create a new separate profile for that installation.

|  | [Mark](/user_profile?user_id=687521)  Reporter |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1811852#c50)• 2 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #49](/show_bug.cgi?id=1811852#c49 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))

> (In reply to Mark from [comment #48](/show_bug.cgi?id=1811852#c48 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
>
> > (In reply to Bob Owen (:bobowen) from [comment #47](/show_bug.cgi?id=1811852#c47 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
> >
> > > (In reply to Mark from [comment #46](/show_bug.cgi?id=1811852#c46 "RESOLVED FIXED - Firefox crashes on Windows when printing a page (sometimes)"))
> > >
> > > ...
> > >
> > > That would be more likely to affect the system dialog for the printer than our print preview I would guess.
> >
> > Hmm. I could print to PDFs and other devices that show the print preview dialogue. It was just when selecting that installed printer, it would flash up for half a second then full browser crash.
>
> Sorry, I think I made that comment confusing.
>
> Each printer installed (including the ones that print to file) has a printer driver associated with it and it is possible that the device specific one for your Xerox VersaLink C405 communicates with the printer while retrieving its settings and sometimes that can fail, which triggers this bug in Firefox code.
>
> By installing the generic driver it might mean that the communication doesn't happen, because it no longer communicates with the printer and only uses the standard settings structure.
>
> A was just pointing out that having the generic driver installed might mean that the system print dialog is missing some device specific settings, because the device specific driver might normally interact with that dialog to show extra settings.
>
> I don't think it would affect the Firefox Print Preview, because we only use the standard print settings structure that all devices have to return.
>
> Hopefully, once the next version of Firefox rolls out next Tuesday, you will be able to reinstall the device specific driver.
>
> The fix is already on [Beta, Nightly](https://www.mozilla.org/en-US/firefox/channel/desktop/) and Extended Support Release.
>
> If you were able to test this it would be great.
>
> The Beta build by default installs to the same location as Release Firefox, so I would select a custom install and change the folder/directory to "Mozilla Firefox Beta".
>
> When you launch it, it should create a new separate profile for that installation.

Ah ok, will check Tuesday when it's live. Thanks for your help!

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1811852#c51)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317094)
— [Details](attachment.cgi?id=9317094&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a1565333_578488)• 2 years ago |

Whiteboard: [adv-main110+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a1567104_578488)• 2 years ago |

Whiteboard: [adv-main110+] → [adv-main110+][adv-esr102.8+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a1793760_428608)• 2 years ago |

Alias: CVE-2023-25738

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a3619985_551058)• 2 years ago |

QA Whiteboard: [qa-triaged] → [qa-triaged] [post-critsmash-triage]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1811852#a23115598_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1811852#c52)• 8 months ago |
|  | |

Sorry for the burst of bugspam: filter on tinkling-glitter-filtrate

Adding `reporter-external` keyword to security bugs found by non-employees for accounting reasons

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1811852&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bob Owen (:bobowen)](/user_profile?user_id=458623)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_38b9263f_20250114_202228.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-07

## Security Vulnerabilities fixed in Thunderbird 102.8

Announced
February 15, 2023
Impact
low
Products
Thunderbird
Fixed in

* Thunderbird 102.8

*Except for CVE-2023--0616, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-0616: User Interface lockup with messages combining S/MIME and OpenPGP](#CVE-2023-0616)

Reporter
Kai Engert
Impact
low
##### Description

If a MIME email combines OpenPGP and OpenPGP MIME data in a certain way Thunderbird repeatedly attempts to process and display the message, which could cause Thunderbird's user interface to lock up and no longer respond to the user's actions. An attacker could send a crafted message with this structure to attempt a DoS attack.

##### References

* [Bug 1806507](https://bugzilla.mozilla.org/show_bug.cgi?id=1806507)

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Thunderbird with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25746: Memory safety bugs fixed in Thunderbird 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368%2C1789449%2C1803628%2C1810536)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_ce722dd0_20250114_202227.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-05

## Security Vulnerabilities fixed in Firefox 110

Announced
February 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 110

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-25743: Fullscreen notification not shown in Firefox Focus](#CVE-2023-25743)

Reporter
Hafiizh
Impact
high
##### Description

A lack of in app notification for entering fullscreen mode could have lead to a malicious website spoofing browser chrome.
*This bug only affects Firefox Focus. Other versions of Firefox are unaffected.*

##### References

* [Bug 1800203](https://bugzilla.mozilla.org/show_bug.cgi?id=1800203)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25740: Opening local .scf files could cause unexpected network loads](#CVE-2023-25740)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

After downloading a Windows `.scf` script from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1812354](https://bugzilla.mozilla.org/show_bug.cgi?id=1812354)

#### [#CVE-2023-25731: Prototype pollution when rendering URLPreview](#CVE-2023-25731)

Reporter
pyakovlev & Alexander Volkov
Impact
low
##### Description

Due to URL previews in the network panel of developer tools improperly storing URLs, query parameters could potentially be used to overwrite global objects in privileged code.

##### References

* [Bug 1801542](https://bugzilla.mozilla.org/show_bug.cgi?id=1801542)

#### [#CVE-2023-25733: Possible null pointer dereference in TaskbarPreviewCallback](#CVE-2023-25733)

Reporter
Ronald Crane
Impact
low
##### Description

The return value from `gfx::SourceSurfaceSkia::Map()` wasn't being verified which could have potentially lead to a null pointer dereference.

##### References

* [Bug 1808632](https://bugzilla.mozilla.org/show_bug.cgi?id=1808632)

#### [#CVE-2023-25736: Invalid downcast in GetTableSelectionMode](#CVE-2023-25736)

Reporter
Lukas Bernhard
Impact
low
##### Description

An invalid downcast from `nsHTMLDocument` to `nsIContent` could have lead to undefined behavior.

##### References

* [Bug 1811331](https://bugzilla.mozilla.org/show_bug.cgi?id=1811331)

#### [#CVE-2023-25741: Same-origin policy leak via image drag and drop](#CVE-2023-25741)

Reporter
Dohyun Lee (@l33d0hyun) of SSD Labs
Impact
low
##### Description

When dragging and dropping an image cross-origin, the image's size could potentially be leaked. This behavior was shipped in 109 and caused web compatibility problems as well as this security concern, so the behavior was disabled until further review.

##### References

* [Bug 1813376](https://bugzilla.mozilla.org/show_bug.cgi?id=1813376)
* [Bug 1437126](https://bugzilla.mozilla.org/show_bug.cgi?id=1437126)
* [Bug 1812611](https://bugzilla.mozilla.org/show_bug.cgi?id=1812611)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25745: Memory safety bugs fixed in Firefox 110](#CVE-2023-25745)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Gabriele Svelto, Jeff Muizelaar and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1688592%2C1797186%2C1804998%2C1806521%2C1813284)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_ecd4389d_20250114_202228.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-06

## Security Vulnerabilities fixed in Firefox ESR 102.8

Announced
February 14, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.8

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25746: Memory safety bugs fixed in Firefox ESR 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


