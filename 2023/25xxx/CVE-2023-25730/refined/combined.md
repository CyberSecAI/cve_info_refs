=== Content from www.mozilla.org_ce722dd0_20250114_220845.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-05

## Security Vulnerabilities fixed in Firefox 110

Announced
February 14, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 110

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-25743: Fullscreen notification not shown in Firefox Focus](#CVE-2023-25743)

Reporter
Hafiizh
Impact
high
##### Description

A lack of in app notification for entering fullscreen mode could have lead to a malicious website spoofing browser chrome.
*This bug only affects Firefox Focus. Other versions of Firefox are unaffected.*

##### References

* [Bug 1800203](https://bugzilla.mozilla.org/show_bug.cgi?id=1800203)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25740: Opening local .scf files could cause unexpected network loads](#CVE-2023-25740)

Reporter
Axel Chong (@Haxatron)
Impact
moderate
##### Description

After downloading a Windows `.scf` script from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1812354](https://bugzilla.mozilla.org/show_bug.cgi?id=1812354)

#### [#CVE-2023-25731: Prototype pollution when rendering URLPreview](#CVE-2023-25731)

Reporter
pyakovlev & Alexander Volkov
Impact
low
##### Description

Due to URL previews in the network panel of developer tools improperly storing URLs, query parameters could potentially be used to overwrite global objects in privileged code.

##### References

* [Bug 1801542](https://bugzilla.mozilla.org/show_bug.cgi?id=1801542)

#### [#CVE-2023-25733: Possible null pointer dereference in TaskbarPreviewCallback](#CVE-2023-25733)

Reporter
Ronald Crane
Impact
low
##### Description

The return value from `gfx::SourceSurfaceSkia::Map()` wasn't being verified which could have potentially lead to a null pointer dereference.

##### References

* [Bug 1808632](https://bugzilla.mozilla.org/show_bug.cgi?id=1808632)

#### [#CVE-2023-25736: Invalid downcast in GetTableSelectionMode](#CVE-2023-25736)

Reporter
Lukas Bernhard
Impact
low
##### Description

An invalid downcast from `nsHTMLDocument` to `nsIContent` could have lead to undefined behavior.

##### References

* [Bug 1811331](https://bugzilla.mozilla.org/show_bug.cgi?id=1811331)

#### [#CVE-2023-25741: Same-origin policy leak via image drag and drop](#CVE-2023-25741)

Reporter
Dohyun Lee (@l33d0hyun) of SSD Labs
Impact
low
##### Description

When dragging and dropping an image cross-origin, the image's size could potentially be leaked. This behavior was shipped in 109 and caused web compatibility problems as well as this security concern, so the behavior was disabled until further review.

##### References

* [Bug 1813376](https://bugzilla.mozilla.org/show_bug.cgi?id=1813376)
* [Bug 1437126](https://bugzilla.mozilla.org/show_bug.cgi?id=1437126)
* [Bug 1812611](https://bugzilla.mozilla.org/show_bug.cgi?id=1812611)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25745: Memory safety bugs fixed in Firefox 110](#CVE-2023-25745)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Timothy Nikkel, Gabriele Svelto, Jeff Muizelaar and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1688592%2C1797186%2C1804998%2C1806521%2C1813284)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_38b9263f_20250114_220846.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-07

## Security Vulnerabilities fixed in Thunderbird 102.8

Announced
February 15, 2023
Impact
low
Products
Thunderbird
Fixed in

* Thunderbird 102.8

*Except for CVE-2023--0616, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-0616: User Interface lockup with messages combining S/MIME and OpenPGP](#CVE-2023-0616)

Reporter
Kai Engert
Impact
low
##### Description

If a MIME email combines OpenPGP and OpenPGP MIME data in a certain way Thunderbird repeatedly attempts to process and display the message, which could cause Thunderbird's user interface to lock up and no longer respond to the user's actions. An attacker could send a crafted message with this structure to attempt a DoS attack.

##### References

* [Bug 1806507](https://bugzilla.mozilla.org/show_bug.cgi?id=1806507)

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Thunderbird with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25746: Memory safety bugs fixed in Thunderbird 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Thunderbird 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368%2C1789449%2C1803628%2C1810536)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_ecd4389d_20250114_220846.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-06

## Security Vulnerabilities fixed in Firefox ESR 102.8

Announced
February 14, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.8

#### [#CVE-2023-25728: Content security policy leak in violation reports using iframes](#CVE-2023-25728)

Reporter
Johan Carlsson
Impact
high
##### Description

The `Content-Security-Policy-Report-Only` header could allow an attacker to leak a child iframe's unredacted URI when interaction with that iframe triggers a redirect.

##### References

* [Bug 1790345](https://bugzilla.mozilla.org/show_bug.cgi?id=1790345)

#### [#CVE-2023-25730: Screen hijack via browser fullscreen mode](#CVE-2023-25730)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A background script invoking `requestFullscreen` and then blocking the main thread could force the browser into fullscreen mode indefinitely, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1794622](https://bugzilla.mozilla.org/show_bug.cgi?id=1794622)

#### [#CVE-2023-0767: Arbitrary memory write via PKCS 12 in NSS](#CVE-2023-0767)

Reporter
Christian Holler
Impact
high
##### Description

An attacker could construct a PKCS 12 cert bundle in such a way that could allow for arbitrary memory writes via PKCS 12 Safe Bag attributes being mishandled.

##### References

* [Bug 1804640](https://bugzilla.mozilla.org/show_bug.cgi?id=1804640)

#### [#CVE-2023-25735: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-25735)

Reporter
Samuel Groß
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free after unwrapping the proxy.

##### References

* [Bug 1810711](https://bugzilla.mozilla.org/show_bug.cgi?id=1810711)

#### [#CVE-2023-25737: Invalid downcast in SVGUtils::SetupStrokeGeometry](#CVE-2023-25737)

Reporter
Lukas Bernhard
Impact
high
##### Description

An invalid downcast from `nsTextNode` to `SVGElement` could have lead to undefined behavior.

##### References

* [Bug 1811464](https://bugzilla.mozilla.org/show_bug.cgi?id=1811464)

#### [#CVE-2023-25738: Printing on Windows could potentially crash Firefox with some device drivers](#CVE-2023-25738)

Reporter
Mark
Impact
high
##### Description

Members of the `DEVMODEW` struct set by the printer device driver weren't being validated and could have resulted in invalid values which in turn would cause the browser to attempt out of bounds access to related variables.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1811852](https://bugzilla.mozilla.org/show_bug.cgi?id=1811852)

#### [#CVE-2023-25739: Use-after-free in mozilla::dom::ScriptLoadContext::~ScriptLoadContext](#CVE-2023-25739)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

Module load requests that failed were not being checked as to whether or not they were cancelled causing a use-after-free in `ScriptLoadContext`.

##### References

* [Bug 1811939](https://bugzilla.mozilla.org/show_bug.cgi?id=1811939)

#### [#CVE-2023-25729: Extensions could have opened external schemes without user knowledge](#CVE-2023-25729)

Reporter
Vitor Torres
Impact
moderate
##### Description

Permission prompts for opening external schemes were only shown for `ContentPrincipals` resulting in extensions being able to open them without user interaction via `ExpandedPrincipals`. This could lead to further malicious actions such as downloading files or interacting with software already installed on the system.

##### References

* [Bug 1792138](https://bugzilla.mozilla.org/show_bug.cgi?id=1792138)

#### [#CVE-2023-25732: Out of bounds memory write from EncodeInputStream](#CVE-2023-25732)

Reporter
Ronald Crane
Impact
moderate
##### Description

When encoding data from an `inputStream` in `xpcom` the size of the input being encoded was not correctly calculated potentially leading to an out of bounds memory write.

##### References

* [Bug 1804564](https://bugzilla.mozilla.org/show_bug.cgi?id=1804564)

#### [#CVE-2023-25734: Opening local .url files could cause unexpected network loads](#CVE-2023-25734)

Reporter
Ameen Basha M K and Shaheen Fazim
Impact
moderate
##### Description

After downloading a Windows `.url` shortcut from the local filesystem, an attacker could supply a remote path that would lead to unexpected network requests from the operating system. This also had the potential to leak NTLM credentials to the resource.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1809923](https://bugzilla.mozilla.org/show_bug.cgi?id=1809923)
* [Bug 1784451](https://bugzilla.mozilla.org/show_bug.cgi?id=1784451)
* [Bug 1810143](https://bugzilla.mozilla.org/show_bug.cgi?id=1810143)
* [Bug 1812338](https://bugzilla.mozilla.org/show_bug.cgi?id=1812338)

#### [#CVE-2023-25742: Web Crypto ImportKey crashes tab](#CVE-2023-25742)

Reporter
Goras Francesco
Impact
low
##### Description

When importing a SPKI RSA public key as ECDSA P-256, the key would be handled incorrectly causing the tab to crash.

##### References

* [Bug 1813424](https://bugzilla.mozilla.org/show_bug.cgi?id=1813424)

#### [#CVE-2023-25744: Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](#CVE-2023-25744)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Kershaw Chang and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 109 and Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 110 and Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1789449%2C1803628%2C1810536)

#### [#CVE-2023-25746: Memory safety bugs fixed in Firefox ESR 102.8](#CVE-2023-25746)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Philipp and Gabriele Svelto reported memory safety bugs present in Firefox ESR 102.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox ESR 102.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1544127%2C1762368)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_8080c4ee_20250114_220845.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1794622)
* [XML](/show_bug.cgi?ctype=xml&id=1794622)

Closed
[Bug 1794622](/show_bug.cgi?id=1794622)
(CVE-2023-25730)

Opened 2 years ago
Closed 2 years ago

# requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

111 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified) |
| firefox111 | [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 110+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 | + | verified |
| firefox111 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: edgar)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f65ba150a7cf6313efc23c96c9206cd8?d=mm&size=40)  [edgar](/user_profile?user_id=455480)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1800482](/show_bug.cgi?id=1800482 "RESOLVED FIXED - Consider tracking fullscreen-request-origin on browsing context of chrome window"), [1801391](/show_bug.cgi?id=1801391 "RESOLVED FIXED - Consider having a way to tracking why widget goes into fullscreen mode")

[CVE-2022-46877](/show_bug.cgi?id=1795139 "RESOLVED FIXED - Consider showing fullscreen notification as soon as browser window goes into fullscreen mode")

[1800207](/show_bug.cgi?id=1800207 "RESOLVED FIXED - Make test browser_fullscreen-document-mutation-navigation.js more robust")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1800895](/show_bug.cgi?id=1800895 "RESOLVED FIXED - Add test for bug 1794622")

Dependency [tree](/showdependencytree.cgi?id=1794622&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1794622)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [adv-esr102.8+][adv-main110+][reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-25730

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-esr102.8+][adv-main110+][reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a9085339_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c22 "2 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [testcase.bundle.html](/attachment.cgi?id=9298016)  [2 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.10 KB, text/html |  | [Details](/attachment.cgi?id=9298016&action=edit) |
| --- | --- | --- |
| [Firefox - requestFullscreen without fullscreen notification toast with unresponsive script + navigate to another website.mp4](/attachment.cgi?id=9298017)  [2 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   1.59 MB, video/mp4 |  | [Details](/attachment.cgi?id=9298017&action=edit) |
| [Bug 1794622; r?smaug](/attachment.cgi?id=9301748)  [2 years ago](#c5)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c18 "2 years ago")  tjr : [sec-approval+](#c10 "2 years ago") | [Details](/attachment.cgi?id=9301748&action=edit) | [Review](/attachment.cgi?id=9301748) |
| [Bug 1794622; r?smaug](/attachment.cgi?id=9309348)  [2 years ago](#c8)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9309348&action=edit) | [Review](/attachment.cgi?id=9309348) |
| [[ESR102] Bug 1794622; r=smaug](/attachment.cgi?id=9313636)  [2 years ago](#c15)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   8.13 KB, text/plain | RyanVM : [approval-mozilla-esr102+](#c21 "2 years ago") | [Details](/attachment.cgi?id=9313636&action=edit) |
| [advisory.txt](/attachment.cgi?id=9317085)  [2 years ago](#c24)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   273 bytes, text/plain |  | [Details](/attachment.cgi?id=9317085&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1794622#c0)• 2 years ago |
|  | |

Attached file
[testcase.bundle.html](attachment.cgi?id=9298016)
— [Details](attachment.cgi?id=9298016&action=edit)

When invoke `requestFullscreen` then run unresponsive script that blocking the main thread or freeze the page then simultaneously navigate to another website, interestingly the browser goes fullscreen without fullscreen notification toast on another website.

When in the fullscreen mode the page is still responsive and interactable as usual, the browser will stays in full screen mode as long as the unresponsive script is running in the background, when unresponsive script is over the browser will exit the full screen mode.

## Tested on:

* Firefox 105.0.3 (64-bit) on Arch Linux
* Firefox 105.0.3 (64-bit) on Windows 11
* Firefox Nightly 107.0a1 (2022-10-11) (64-bit) on Arch Linux
* Firefox Nightly 107.0a1 (2022-10-11) (64-bit) on Windows 11

## Steps to reproduce:

1. Visit attached testcase.bundle.html
2. Click "Launch"
3. Click anywhere on the page
4. Browser goes fullscreen without fullscreen notification toast
Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1794622#c1)• 2 years ago |
|  | |

Attached video
[Firefox - requestFullscreen without fullscreen notification toast with unresponsive script + navigate to another website.mp4](attachment.cgi?id=9298017)
— [Details](attachment.cgi?id=9298017&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a2034_159069)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Core & HTMLProduct: Firefox → Core

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a60034_455480)• 2 years ago |

Severity: -- → S2Flags: needinfo?(echen)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1794622#c2)• 2 years ago |
|  | |

It's interesting that we were able to show the transition to black but not the toast. Are those drawn by two separate processes?

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1794622#c3)• 2 years ago |
|  | |

They are both drawn by parent process, the notification happens later when content process notify the parent process that web content has been in fullscreen mode, but content process is busy on executing script. [Bug 1795139](/show_bug.cgi?id=1795139 "RESOLVED FIXED - Consider showing fullscreen notification as soon as browser window goes into fullscreen mode") could help that. But I think the core issue is that the we don't exit fullscreen mode while page navigates away, and it is also because of content process is busy on executing script, maybe we should detect that in native code (in parent process?), instead of relying on the status of JSActor.

Assignee: nobody → echenFlags: needinfo?(echen)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1794622#c4)• 2 years ago |
|  | |

Update - as [comment 3](/show_bug.cgi?id=1794622#c3 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"), [bug 1795139](/show_bug.cgi?id=1795139 "RESOLVED FIXED - Consider showing fullscreen notification as soon as browser window goes into fullscreen mode") helped some part of this issue. There are some navigation errors that Edgar is still working on.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1794622#c5)• 2 years ago |
|  | |

Attached file
[Bug 1794622; r?smaug](attachment.cgi?id=9301748)
— [Details](attachment.cgi?id=9301748&action=edit)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1794622#c6)• 2 years ago |
|  | |

Update - after this patch, now parent process will exit fullscreen on chrome document once remote document is navigating away, but this patch make a fullscreen test fail, I am still working on figuring what's happen there.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1794622#c7)• 2 years ago |
|  | |

With some investigation, so far there are two things that might cause the test fails with the patch here,

* The test browser\_fullscreen-document-mutation.js itself isn't robust enough, the patch here changes some timing and cause the flaws much easy to reproduce.
* The way we tracking the fullscreen events has some potential racing problems, the current intermittent failures ([bug 1785951](/show_bug.cgi?id=1785951 "RESOLVED INCOMPLETE - Intermittent dom/html/test/browser_fullscreen-document-mutation.js | single tracking bug") and [bug 1785951](/show_bug.cgi?id=1785951 "RESOLVED INCOMPLETE - Intermittent dom/html/test/browser_fullscreen-document-mutation.js | single tracking bug")) seems like the same root cause. The timing changes in this bug seems cause the flaws worse. It's probably fine in practice, as they are corner cases and we ends up rejecting the fullscreen request which won't cause security problems. But it would be nice if we could fix that to have reliable fullscreen tests.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a2661850_455480)• 2 years ago |

Depends on: [1800207](/show_bug.cgi?id=1800207 "RESOLVED FIXED - Make test browser_fullscreen-document-mutation-navigation.js more robust")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a2937238_455480)• 2 years ago |

Depends on: [1800482](/show_bug.cgi?id=1800482 "RESOLVED FIXED - Consider tracking fullscreen-request-origin on browsing context of chrome window")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a3104768_455480)• 2 years ago |

Depends on: [1800895](/show_bug.cgi?id=1800895 "RESOLVED FIXED - Add test for bug 1794622")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a3104789_455480)• 2 years ago |

Blocks: [1800895](/show_bug.cgi?id=1800895 "RESOLVED FIXED - Add test for bug 1794622")No longer depends on: [1800895](/show_bug.cgi?id=1800895 "RESOLVED FIXED - Add test for bug 1794622")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a4397549_600971)• 2 years ago |

[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Attachment description: Bug 1794622; → Bug 1794622; r?smaug

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a5555727_455480)• 2 years ago |

Depends on: [1801391](/show_bug.cgi?id=1801391 "RESOLVED FIXED - Consider having a way to tracking why widget goes into fullscreen mode")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1794622#c8)• 2 years ago |
|  | |

Attached file
[Bug 1794622; r?smaug](attachment.cgi?id=9309348) (obsolete)
— [Details](attachment.cgi?id=9309348&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D161133>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a6123673_600971)• 2 years ago |

[Attachment #9309348](/attachment.cgi?id=9309348&action=edit "Bug 1794622; r?smaug") -
Attachment is obsolete: true

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1794622#c9)• 2 years ago |
|  | |

Comment on [attachment 9301748](/attachment.cgi?id=9301748 "Bug 1794622; r?smaug") [[details]](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug")

[Bug 1794622](/show_bug.cgi?id=1794622 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"); r?smaug

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Patch clearly shows the issue is related to fullscreen, but I don't think it is trivial to know what the exact problem is.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: This patch makes the existing intermittent failures on some fullscreen tests worse due to timing of exiting fullscreen is changed. We would need to uplift [bug 1800482](/show_bug.cgi?id=1800482 "RESOLVED FIXED - Consider tracking fullscreen-request-origin on browsing context of chrome window"), [bug 1801391](/show_bug.cgi?id=1801391 "RESOLVED FIXED - Consider having a way to tracking why widget goes into fullscreen mode") and [bug 1800207](/show_bug.cgi?id=1800207 "RESOLVED FIXED - Make test browser_fullscreen-document-mutation-navigation.js more robust") to solve the intermittent failures.
* **How likely is this patch to cause regressions; how much testing does it need?**: Should be safe as patch only affects when page navigates.
* **Is Android affected?**: No
[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1794622#c10)• 2 years ago |
|  | |

Comment on [attachment 9301748](/attachment.cgi?id=9301748 "Bug 1794622; r?smaug") [[details]](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug")

[Bug 1794622](/show_bug.cgi?id=1794622 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"); r?smaug

Approved to land and uplift. It sounds like we may just want to disable some tests on ESR instead of uplifting...

[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1794622#c11)• 2 years ago |
|  | |

r=smaug

<https://hg.mozilla.org/integration/autoland/rev/7dbd6ad926bea4689a45a74c4ec2ea30d9362369>

<https://hg.mozilla.org/mozilla-central/rev/7dbd6ad926be>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 111 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a8550805_695136)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)
[tracking-firefox111](/buglist.cgi?f1=cf_tracking_firefox111&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox111&o1=equals&v1=%2B)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a8550822_695136)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) → ---
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) → ---

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a8673798_75935)• 2 years ago |

[status-firefox109](/buglist.cgi?f1=cf_status_firefox109&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix)
[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox110](/buglist.cgi?f1=cf_tracking_firefox110&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox110&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [110+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=110%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1794622#c12)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:edgar, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox110` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1794622#c13)• 2 years ago |
|  | |

Comment on [attachment 9301748](/attachment.cgi?id=9301748 "Bug 1794622; r?smaug") [[details]](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug")

[Bug 1794622](/show_bug.cgi?id=1794622 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"); r?smaug

### Beta/Release Uplift Approval Request

* **User impact if declined**: After [bug 1795139](/show_bug.cgi?id=1795139 "RESOLVED FIXED - Consider showing fullscreen notification as soon as browser window goes into fullscreen mode"), we are no longer having issue on showing fullscreen notification, but browser don't exit fullscreen mode while page navigates away if oop iframe is busy on executing script, which is still confusing the user.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Follow steps in <https://bugzilla.mozilla.org/show_bug.cgi?id=1794622#c0>
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Should be safe as patch only affects when page navigates. And the bugs that improves the intermittent failures ([bug 1800482](/show_bug.cgi?id=1800482 "RESOLVED FIXED - Consider tracking fullscreen-request-origin on browsing context of chrome window"), [bug 1801391](/show_bug.cgi?id=1801391 "RESOLVED FIXED - Consider having a way to tracking why widget goes into fullscreen mode") and [bug 1800207](/show_bug.cgi?id=1800207 "RESOLVED FIXED - Make test browser_fullscreen-document-mutation-navigation.js more robust")) are already in beta.
* **String changes made/needed**: None
* **Is Android affected?**: No
Flags: needinfo?(echen)
[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Flags: approval-mozilla-beta?

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a8961645_455480)• 2 years ago |

Flags: qe-verify+

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1794622#c14)• 2 years ago |
|  | |

(I am working on preparing a backport for esr)

Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1794622#c15)• 2 years ago |
|  | |

Attached file
[[ESR102] Bug 1794622; r=smaug](attachment.cgi?id=9313636)
— [Details](attachment.cgi?id=9313636&action=edit)

Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1794622#c16)• 2 years ago |
|  | |

Comment on [attachment 9313636](/attachment.cgi?id=9313636 "[ESR102] Bug 1794622; r=smaug") [[details]](/attachment.cgi?id=9313636&action=edit "[ESR102] Bug 1794622; r=smaug")

[ESR102] [Bug 1794622](/show_bug.cgi?id=1794622 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"); r=smaug

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug.
* **User impact if declined**: After [bug 1795139](/show_bug.cgi?id=1795139 "RESOLVED FIXED - Consider showing fullscreen notification as soon as browser window goes into fullscreen mode"), we are no longer having issue on showing fullscreen notification, but browser don't exit fullscreen mode while page navigates away if oop iframe is busy on executing script, which is still confusing the user.
* **Fix Landed on Version**: 111
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: Should be safe as patch only affects when page navigates. But this patch makes the existing intermittent failures on some fullscreen tests worse, we might need to disable those tests if thing goes too bad as we probably don't want to uplift other improving bugs.
[Attachment #9313636](/attachment.cgi?id=9313636&action=edit "[ESR102] Bug 1794622; r=smaug") -
Flags: approval-mozilla-esr102?

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a8999302_455480)• 2 years ago |

[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Flags: approval-mozilla-esr102?

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a8999327_455480)• 2 years ago |

[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Flags: approval-mozilla-esr102?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a9085317_1689)• 2 years ago |

Depends on: [CVE-2022-46877](/show_bug.cgi?id=1795139 "RESOLVED FIXED - Consider showing fullscreen notification as soon as browser window goes into fullscreen mode")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a9085339_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a9139498_551058)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1794622#c17)• 2 years ago |
|  | |

I have reproduced this issue with STR from [comment 0](/show_bug.cgi?id=1794622#c0 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"), on an affected Nightly build (2020-10-11) running macOS 11.

The issue is verified as fixed on latest Nightly 111.0a1, across platforms: Win 10 x64, macOS 11 and Ubuntu 18.04 x64.

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=verified)Flags: qe-verify+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1794622#c18)• 2 years ago |
|  | |

Comment on [attachment 9301748](/attachment.cgi?id=9301748 "Bug 1794622; r?smaug") [[details]](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug")

[Bug 1794622](/show_bug.cgi?id=1794622 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"); r?smaug

Approved for 110 beta 6, thanks.

[Attachment #9301748](/attachment.cgi?id=9301748&action=edit "Bug 1794622; r?smaug") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1794622#c19)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3e3d29deeef9>

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1794622#c20)• 2 years ago |
|  | |

This is also verified as fixed on 110.0b6 under macOS 11, Ubuntu 18.04 x64 and Win 10 x64.

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=verified)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1794622#c21)• 2 years ago |
|  | |

Comment on [attachment 9313636](/attachment.cgi?id=9313636 "[ESR102] Bug 1794622; r=smaug") [[details]](/attachment.cgi?id=9313636&action=edit "[ESR102] Bug 1794622; r=smaug")

[ESR102] [Bug 1794622](/show_bug.cgi?id=1794622 "VERIFIED FIXED - requestFullscreen without fullscreen notification toast with unresponsive script and navigate to another website"); r=smaug

Approved for 102.8esr.

[Attachment #9313636](/attachment.cgi?id=9313636&action=edit "[ESR102] Bug 1794622; r=smaug") -
Flags: approval-mozilla-esr102? → approval-mozilla-esr102+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1794622#c22)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/6a1323351df3>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)Flags: in-testsuite+

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1794622#c23)• 2 years ago |
|  | |

I have also verified this as fixed on 102.8esr with Win 7 x64, macOS 11 and Ubuntu 18.04 x64.

Status: RESOLVED → VERIFIED
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1794622#c24)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9317085)
— [Details](attachment.cgi?id=9317085&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a10546750_578488)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [adv-main110+][reporter-external] [client-bounty-form] [verif?]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a10548560_578488)• 2 years ago |

Whiteboard: [adv-main110+][reporter-external] [client-bounty-form] [verif?] → [adv-esr102.8+][adv-main110+][reporter-external] [client-bounty-form] [verif?]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a10775260_428608)• 2 years ago |

Alias: CVE-2023-25730

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a32097114_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1794622#a51588972_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1794622&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


