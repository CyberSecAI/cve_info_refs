=== Content from bugs.debian.org_624fbd7a_20250114_185849.html ===

# Debian Bug report logs - #942737 libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu (CVE-2023-25824)

[![version graph](version.cgi?height=2;width=2;absolute=0;found=mod-gnutls%2F0.9.0-1;fixed=0.9.0-1.1%2Brm;collapse=1;package=libapache2-mod-gnutls)](version.cgi?absolute=0;found=mod-gnutls%2F0.9.0-1;collapse=1;package=libapache2-mod-gnutls;fixed=0.9.0-1.1%2Brm;info=1)

Package:
[libapache2-mod-gnutls](pkgreport.cgi?package=libapache2-mod-gnutls);
Maintainer for [libapache2-mod-gnutls](pkgreport.cgi?package=libapache2-mod-gnutls) is [Daniel Kahn Gillmor <dkg@fifthhorseman.net>](pkgreport.cgi?maint=dkg%40fifthhorseman.net); Source for [libapache2-mod-gnutls](pkgreport.cgi?package=libapache2-mod-gnutls) is [src:mod-gnutls](pkgreport.cgi?src=mod-gnutls) ([PTS](https://tracker.debian.org/pkg/mod-gnutls), [buildd](https://buildd.debian.org/mod-gnutls), [popcon](https://qa.debian.org/popcon.php?package=mod-gnutls)).

Reported by: [Nicolas <nicolas@progweb.com>](pkgreport.cgi?submitter=nicolas%40progweb.com)

Date: Sun, 20 Oct 2019 18:21:01 UTC

Severity: *grave*

Tags: security, upstream

Found in version mod-gnutls/0.9.0-1

Fixed in version 0.9.0-1.1+rm

**Done:** Debian FTP Masters <ftpmaster@ftp-master.debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=942737;mbox=yes), [status mbox](bugreport.cgi?bug=942737;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=942737;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sun, 20 Oct 2019 18:21:04 GMT) ([full text](bugreport.cgi?bug=942737;msg=2), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Nicolas <nicolas@progweb.com>`:

New Bug report received and forwarded. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sun, 20 Oct 2019 18:21:04 GMT) ([full text](bugreport.cgi?bug=942737;msg=4), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=5), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=nicolas%40progweb.com)
From: Nicolas <nicolas@progweb.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Sun, 20 Oct 2019 20:16:32 +0200
```
Package: libapache2-mod-gnutls
Version: 0.9.0-1
Severity: grave
Tags: upstream
Justification: renders package unusable

Dear Maintainer,

I have updated apache2 & mod gnutls application. In testing with a basic html page,
I notice that apache2 process loops infinitly, "ps" output:

www-data  6103 92.8  0.1  29696  9708 ?        R    19:37  28:24 /usr/sbin/apache2 -k start

I try with ssl module:

<IfModule mod_ssl.c>
	SSLEngine On
	SSLCertificateFile /etc/apache2/ssl/domain.com.crt
	SSLCertificateKeyFile /etc/apache2/ssl/domain.com.key
</IfModule>

<IfModule mod_gnutls.c>
	GnuTLSEnable on
	GnuTLSCertificateFile /etc/apache2/ssl/domain.com.crt
	GnuTLSKeyFile /etc/apache2/ssl/domain.com.key
	GnuTLSPriorities PFS:-VERS-ALL:+VERS-TLS1.3:+VERS-TLS1.2:%SERVER_PRECEDENCE
</IfModule>

I have the issue only with gnutls module.

To check, I attach a gdb session:

(gdb) bt
#0  0x00007f78b4cfb92f in ?? () from target:/usr/lib/x86_64-linux-gnu/libgnutls.so.30
#1  0x00007f78b4cfdf7c in ?? () from target:/usr/lib/x86_64-linux-gnu/libgnutls.so.30
#2  0x00007f78b4e90f38 in ?? () from target:/usr/lib/apache2/modules/mod_gnutls.so
#3  0x00007f78b4e91ad2 in mgs_filter_input () from target:/usr/lib/apache2/modules/mod_gnutls.so
#4  0x000055c220cd08e1 in ap_rgetline_core ()
#5  0x000055c220cd336c in ap_read_request ()
#6  0x000055c220cfe7a8 in ?? ()
#7  0x000055c220cf38b0 in ap_run_process_connection ()
#8  0x00007f78b3bd23df in ?? () from target:/usr/lib/apache2/modules/mod_mpm_prefork.so
#9  0x00007f78b3bd26d4 in ?? () from target:/usr/lib/apache2/modules/mod_mpm_prefork.so
#10 0x00007f78b3bd272f in ?? () from target:/usr/lib/apache2/modules/mod_mpm_prefork.so
#11 0x00007f78b3bd32f3 in ?? () from target:/usr/lib/apache2/modules/mod_mpm_prefork.so
#12 0x000055c220ccc67e in ap_run_mpm ()
#13 0x000055c220cc4f57 in main ()

I don't know how to fix the issue and how to help you.

-- System Information:
Debian Release: 10.1
  APT prefers stable-updates
  APT policy: (500, 'stable-updates'), (500, 'stable')
Architecture: amd64 (x86_64)

Kernel: Linux 4.19.0-6-amd64 (SMP w/4 CPU cores)
Kernel taint flags: TAINT_OOT_MODULE, TAINT_UNSIGNED_MODULE
Locale: LANG=fr_FR.UTF-8, LC_CTYPE=fr_FR.UTF-8 (charmap=UTF-8), LANGUAGE=fr_FR.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)
LSM: AppArmor: enabled

Versions of packages libapache2-mod-gnutls depends on:
ii  apache2-bin [apache2-api-20120211]  2.4.38-3+deb10u3
ii  libc6                               2.28-10
ii  libgnutls30                         3.6.7-4
ii  libmsv1                             1.1.1-3

libapache2-mod-gnutls recommends no packages.

libapache2-mod-gnutls suggests no packages.

-- no debconf information

Available to do tests and more.

Nico

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sun, 24 Nov 2019 12:33:05 GMT) ([full text](bugreport.cgi?bug=942737;msg=7), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Fiona Klute <fiona.klute@gmx.de>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sun, 24 Nov 2019 12:33:05 GMT) ([full text](bugreport.cgi?bug=942737;msg=9), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=10), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=fiona.klute%40gmx.de)
From: Fiona Klute <fiona.klute@gmx.de>
To: 942737@bugs.debian.org
Subject: Can't reproduce, please try dbgsym packages for backtrace
Date: Sun, 24 Nov 2019 13:31:00 +0100
```
Hi Nico,

I tried to reproduce the issue but couldn't. Exactly how are you sending
the requests? I've tried both curl and hand-typing over gnutls-cli.

If you still have this issue, could you try enabling the appropriate
debug repositories (see <https://wiki.debian.org/AutomaticDebugPackages>)
and installing the relevant *-dbgsym packages to see which functions
loop in the backtrace? I assume you'll need at least these:
apache2-bin-dbgsym libapache2-mod-gnutls-dbgsym libgnutls30-dbgsym

Best regards,
Fiona

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Mon, 16 Dec 2019 01:48:06 GMT) ([full text](bugreport.cgi?bug=942737;msg=12), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Bernhard Übelacker <bernhardu@mailbox.org>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Mon, 16 Dec 2019 01:48:06 GMT) ([full text](bugreport.cgi?bug=942737;msg=14), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=15), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=bernhardu%40mailbox.org)
From: Bernhard Übelacker <bernhardu@mailbox.org>
To: 942737@bugs.debian.org
Cc: Fiona Klute <fiona.klute@gmx.de>, Nicolas <nicolas@progweb.com>
Subject: Re: Bug#942737: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Mon, 16 Dec 2019 02:37:50 +0100
```
Dear Maintainer,
tried to reconstruct the given backtrace with debug symbols
in a gdb session and came to following, maybe it could be
of some help.
(Still a proper backtrace with dbgsym packages
installed would be better.)

Kind regards,
Bernhard

Reconstructed:
#0  0x00007f78b4cfb92f in gnutls_assert_val_int at ../../lib/errors.h:139 from libgnutls.so.30
#1  0x00007f78b4cfdf7c in _gnutls_recv_int at ../../lib/record.c:1773 from libgnutls.so.30
                       in gnutls_record_recv at ../../lib/record.c:2281
#2  0x00007f78b4e90f38 in gnutls_io_input_read at gnutls_io.c:246 from mod_gnutls.so
#3  0x00007f78b4e91ad2 in gnutls_io_input_getline at gnutls_io.c:342 from mod_gnutls.so
                       in mgs_filter_input at gnutls_io.c:595
                       in ap_get_brigade at util_filter.c:553
#4  0x000055c220cd08e1 in ap_rgetline_core at protocol.c:246
#5  0x000055c220cd336c in read_request_line at protocol.c:682
                       in ap_read_request at protocol.c:1322
#6  0x000055c220cfe7a8 in ap_process_http_sync_connection at http_core.c:192
#7  0x000055c220cf38b0 in ap_run_process_connection at connection.c:42
                       in ap_process_connection at connection.c:219
#8  0x00007f78b3bd23df in child_main at prefork.c:615 from mod_mpm_prefork.so
#9  0x00007f78b3bd26d4 in make_child at prefork.c:717 from mod_mpm_prefork.so
#10 0x00007f78b3bd272f in startup_children at prefork.c:735 from mod_mpm_prefork.so
#11 0x00007f78b3bd32f3 in prefork_run at prefork.c:897 from mod_mpm_prefork.so
#12 0x000055c220ccc67e in ap_run_mpm at mpm_common.c:94
#13 0x000055c220cc4f57 in main at main.c:819

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sun, 01 Nov 2020 07:39:03 GMT) ([full text](bugreport.cgi?bug=942737;msg=17), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Emanuel Larios <anubes19@yahoo.com>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sun, 01 Nov 2020 07:39:03 GMT) ([full text](bugreport.cgi?bug=942737;msg=19), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=20), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=anubes19%40yahoo.com)
From: Emanuel Larios <anubes19@yahoo.com>
To: 942737@bugs.debian.org
Subject: Bug
Date: Sun, 1 Nov 2020 00:30:51 -0700
```

Sent from my iPhone

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sat, 28 Nov 2020 21:00:02 GMT) ([full text](bugreport.cgi?bug=942737;msg=22), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Félix Arreola Rodríguez <fgatuno.123@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sat, 28 Nov 2020 21:00:02 GMT) ([full text](bugreport.cgi?bug=942737;msg=24), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=25), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=fgatuno.123%40gmail.com)
From: Félix Arreola Rodríguez <fgatuno.123@gmail.com>
To: 942737@bugs.debian.org
Subject: Re: Bug#942737: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Sat, 28 Nov 2020 14:56:51 -0600
```
[[Message part 1](bugreport.cgi?att=0;bug=942737;msg=25) (text/plain, inline)]
```
```
On Mon, 16 Dec 2019 02:37:50 +0100 =?UTF-8?Q?Bernhard_=c3=9cbelacker?=
<bernhardu@mailbox.org> wrote:
> Dear Maintainer,
> tried to reconstruct the given backtrace with debug symbols
> in a gdb session and came to following, maybe it could be
> of some help.
> (Still a proper backtrace with dbgsym packages
> installed would be better.)
>
> Kind regards,
> Bernhard
>
>

Dear Maintainer:

I came across this bugs too. The problem is a infinite loop between
mod-reqtimeout and mod-gnutls. The mod-gnutls (and underlaying gnutls)
tries to read some bytes when the client hasn't sent any (like an empty
tcp conn) and the mod-reqtimeout returns a timeout, causing mod-gnutls
to loop endless trying to read more. Either mod-reqtimeout is broken,
or either mod-gnutls doesn't handle correctly the timeouts.

After debugging a lot with gdb, I can reconstruct the loop as follow:

The code starts at function gnutls_io_input_read from gnutls_io.c from
mod_gnutls, line 246, the "while(1)" loop.

The code calls gnutls_record_recv, from gnutls, which in turns calls
_gnutls_recv_int. gnutls_recv_int is called with
type=GNUTLS_APPLICATION_DATA asking for 8192 bytes. Next it calls
check_session_status, which checks if there is an EOF, and there is
NO EOF. Also, check_session_status says that the
session->internals.recv_state is RECV_STATE_0, whichs makes
check_session_status return 1.

Next, it calls get_data_from_buffers, which returns 0, which means
there is no data in the buffer to consume. Next, it
calls _gnutls_recv_in_buffers. _gnutls_recv_in_buffers calls
recv_headers, which tries to read the header (which is 5). it calls
_gnutls_io_read_buffered for 5 bytes. _gnutls_io_read_buffered ask for
5 bytes to _gnutls_read, which in turn uses _gnutls_stream_read to
complete the request.

_gnutls_stream_read returns back to mod-gnutls using the "pull_func"
mgs_transport_read. msg_transport_read is located at gnutls_io.c:824
mgs_transport_read tries to use ap_get_brigade to get some bytes from
the underlaying socket.

ap_get_brigade tries to read from the "next" ap_filter_t, which (in my
case) is "reqtimeout". reqtimeout_filter function calls
check_time_left, which returns APR_TIMEUP. When it returns APR_TIMEUP,
it logs "Request %s read timeout". So, back to mgs_transport_read, it
reads APR_TIMEUP from the ap_get_brigade. BUT, it handles wrong this
timeout and converts it to EAGAIN, which makes this whole stack run
back.

This is a big, 'nice' nasty bug, I have to say.

As a workout around, I disabled module reqtimeout. Seems to solve the
cpu usage issue. But, the bug is way more big than 'disabling'
reqtimeout. Because, the problem is between mod-gnutls and
mod-reqtimeout

Steps to reproduce:
Enable apache2 with the modules mod-gnutls, and mod-reqtimeout. Setup a
reqtimeout like: RequestReadTimeout header=20-40,minrate=500 and open
an openssl s_client:

openssl s_client -connect IP:port

Don't send any data over the openssl connect. Just wait for the timeout
to happen. After the timeout, the CPU usage will increase. Also, you
can quit the openssl s_client and the apache process will be stuck in
the endless loop.

--
Atte. Félix Arreola
Firmado con GPG 0x1e249ee4

```
```
[[Message part 2](bugreport.cgi?att=1;bug=942737;msg=25) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sat, 28 Nov 2020 21:09:02 GMT) ([full text](bugreport.cgi?bug=942737;msg=27), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Félix Arreola Rodríguez <fgatuno.123@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sat, 28 Nov 2020 21:09:02 GMT) ([full text](bugreport.cgi?bug=942737;msg=29), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=30), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=fgatuno.123%40gmail.com)
From: Félix Arreola Rodríguez <fgatuno.123@gmail.com>
To: 942737@bugs.debian.org
Subject: Re: Bug#942737: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Sat, 28 Nov 2020 15:08:07 -0600
```
[[Message part 1](bugreport.cgi?att=0;bug=942737;msg=30) (text/plain, inline)]
```
```
Now I think this bug, this could be used as DOS, should we call the
security team to handle this?

--
Atte. Félix Arreola
Firmado con GPG 0x1e249ee4

```
```
[[Message part 2](bugreport.cgi?att=1;bug=942737;msg=30) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sun, 29 Nov 2020 03:21:03 GMT) ([full text](bugreport.cgi?bug=942737;msg=32), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `Félix Arreola Rodríguez <fgatuno.123@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sun, 29 Nov 2020 03:21:03 GMT) ([full text](bugreport.cgi?bug=942737;msg=34), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=35), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=fgatuno.123%40gmail.com)
From: Félix Arreola Rodríguez <fgatuno.123@gmail.com>
To: 942737@bugs.debian.org
Subject: Re: Bug#942737: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Sat, 28 Nov 2020 21:16:23 -0600
```
[[Message part 1](bugreport.cgi?att=0;bug=942737;msg=35) (text/plain, inline)]
```
```
Tags 942737 security
thanks

--
Atte. Félix Arreola
Firmado con GPG 0x1e249ee4

```
```
[[Message part 2](bugreport.cgi?att=1;bug=942737;msg=35) (application/pgp-signature, inline)]
```

---

**Added tag(s) security.**
Request was from `Félix Arreola Rodríguez <fgatuno.123@gmail.com>`
to `control@bugs.debian.org`.
(Sun, 29 Nov 2020 03:39:02 GMT) ([full text](bugreport.cgi?bug=942737;msg=37), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=37), [link](#36)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Sun, 05 Jun 2022 20:09:05 GMT) ([full text](bugreport.cgi?bug=942737;msg=39), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=39), [link](#38)).

---

**Acknowledgement sent**
to `Félix Arreola Rodríguez <fgatuno.123@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Sun, 05 Jun 2022 20:09:06 GMT) ([full text](bugreport.cgi?bug=942737;msg=41), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=42), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=fgatuno.123%40gmail.com)
From: Félix Arreola Rodríguez <fgatuno.123@gmail.com>
To: 942737@bugs.debian.org
Subject: Re: Bug#942737: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Sun, 5 Jun 2022 15:06:10 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=942737;msg=42) (text/plain, inline)]
```
```
Finally managed to write a patch. This patch applies ok on mod-gnutls
0.9.0 and not sure if it will work for buster.

--
Atte. Félix Arreola
Firmado con GPG 0x1e249ee4

```
```
[[fix_timeout.patch](bugreport.cgi?att=1;bug=942737;filename=fix_timeout.patch;msg=42) (text/x-patch, attachment)]
```
```
[[Message part 3](bugreport.cgi?att=2;bug=942737;msg=42) (application/pgp-signature, inline)]
```

---

**Changed Bug title to 'libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu (CVE-2023-25824)' from 'libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 24 Feb 2023 09:00:02 GMT) ([full text](bugreport.cgi?bug=942737;msg=44), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=44), [link](#43)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Daniel Kahn Gillmor <dkg@fifthhorseman.net>`:

`Bug#942737`; Package `libapache2-mod-gnutls`.
(Fri, 24 Feb 2023 19:54:03 GMT) ([full text](bugreport.cgi?bug=942737;msg=46), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=46), [link](#45)).

---

**Acknowledgement sent**
to `Félix Arreola Rodríguez <fgatuno.123@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Daniel Kahn Gillmor <dkg@fifthhorseman.net>`.
(Fri, 24 Feb 2023 19:54:03 GMT) ([full text](bugreport.cgi?bug=942737;msg=48), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=48), [link](#47)).

---

[Message #49](#49) received at 942737@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=49), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=49), reply):

![](/cgi-bin/libravatar.cgi?email=fgatuno.123%40gmail.com)
From: Félix Arreola Rodríguez <fgatuno.123@gmail.com>
To: 942737@bugs.debian.org
Subject: Re: Bug#942737: libapache2-mod-gnutls: mod\_gnutls consumes 100% cpu
Date: Fri, 24 Feb 2023 13:55:13 -0600
```
[[Message part 1](bugreport.cgi?att=0;bug=942737;msg=49) (text/plain, inline)]
```
```
As the bug is now fixed upstream [1], can we get a patch for the current
stable (bullseye)? Because it's impossible to have SSL on apache without
the mod-gnutls

I know maybe it's impossible to re-insert a removed package to stable, but,
I beg the Debian people to let this package come back directly to stable,
because it is pretty much needed.

[1]
<https://lists.gnupg.org/pipermail/mod_gnutls-devel/2023-February/000221.html>

El dom, 5 jun 2022 a la(s) 15:04, Félix Arreola Rodríguez (
fgatuno.123@gmail.com) escribió:

> Finally managed to write a patch. This patch applies ok on mod-gnutls
> 0.9.0 and not sure if it will work for buster.
>
> --
> Atte. Félix Arreola
> Firmado con GPG 0x1e249ee4
>

--
Atte. Félix Arreola Rodríguez,
«Sin firma GPG»

```
```
[[Message part 2](bugreport.cgi?att=1;bug=942737;msg=49) (text/html, inline)]
```

---

**Reply sent**
to `Debian FTP Masters <ftpmaster@ftp-master.debian.org>`:

You have taken responsibility.
(Tue, 22 Oct 2024 17:27:11 GMT) ([full text](bugreport.cgi?bug=942737;msg=51), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=51), [link](#50)).

---

**Notification sent**
to `Nicolas <nicolas@progweb.com>`:

Bug acknowledged by developer.
(Tue, 22 Oct 2024 17:27:11 GMT) ([full text](bugreport.cgi?bug=942737;msg=53), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=53), [link](#52)).

---

[Message #54](#54) received at 942737-done@bugs.debian.org ([full text](bugreport.cgi?bug=942737;msg=54), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=54), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 506029-done@bugs.debian.org,523060-done@bugs.debian.org,576676-done@bugs.debian.org,602957-done@bugs.debian.org,615009-done@bugs.debian.org,642357-done@bugs.debian.org,699211-done@bugs.debian.org,728755-done@bugs.debian.org,741557-done@bugs.debian.org,742713-done@bugs.debian.org,787048-done@bugs.debian.org,799249-done@bugs.debian.org,923302-done@bugs.debian.org,926433-done@bugs.debian.org,942737-done@bugs.debian.org,1050670-done@bugs.debian.org,1072582-done@bugs.debian.org,
Cc: mod-gnutls@packages.debian.org
Subject: Bug#1081990: Removed package(s) from unstable
Date: Tue, 22 Oct 2024 17:25:52 +0000
```
Version: 0.9.0-1.1+rm

Dear submitter,

as the package mod-gnutls has just been removed from the Debian archive
unstable we hereby close the associated bug reports.  We are sorry
that we couldn't deal with your issue properly.

For details on the removal, please see <https://bugs.debian.org/1081990>

The version of this package that was in Debian prior to this removal
can still be found using <https://snapshot.debian.org/>.

Please note that the changes have been done on the master archive and
will not propagate to any mirrors until the next dinstall run at the
earliest.

This message was generated automatically; if you believe that there is
a problem with it please contact the archive administrators by mailing
ftpmaster@ftp-master.debian.org.

Debian distribution maintenance software
pp.
Thorsten Alteholz (the ftpmaster behind the curtain)

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 20 Nov 2024 07:26:53 GMT) ([full text](bugreport.cgi?bug=942737;msg=56), [mbox](bugreport.cgi?bug=942737;mbox=yes;msg=56), [link](#55)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=942737).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Tue Jan 14 18:58:48 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from github.com_4f4104be_20250114_185851.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairtower-luna%2Fmod_gnutls%2Fsecurity%2Fadvisories%2FGHSA-6cfv-fvgm-7pc8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairtower-luna%2Fmod_gnutls%2Fsecurity%2Fadvisories%2FGHSA-6cfv-fvgm-7pc8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=airtower-luna%2Fmod_gnutls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airtower-luna](/airtower-luna)
/
**[mod\_gnutls](/airtower-luna/mod_gnutls)**
Public

* [Notifications](/login?return_to=%2Fairtower-luna%2Fmod_gnutls) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fairtower-luna%2Fmod_gnutls)
* [Star
   14](/login?return_to=%2Fairtower-luna%2Fmod_gnutls)

* [Code](/airtower-luna/mod_gnutls)
* [Issues
  2](/airtower-luna/mod_gnutls/issues)
* [Pull requests
  1](/airtower-luna/mod_gnutls/pulls)
* [Actions](/airtower-luna/mod_gnutls/actions)
* [Wiki](/airtower-luna/mod_gnutls/wiki)
* [Security](/airtower-luna/mod_gnutls/security)
* [Insights](/airtower-luna/mod_gnutls/pulse)

Additional navigation options

* [Code](/airtower-luna/mod_gnutls)
* [Issues](/airtower-luna/mod_gnutls/issues)
* [Pull requests](/airtower-luna/mod_gnutls/pulls)
* [Actions](/airtower-luna/mod_gnutls/actions)
* [Wiki](/airtower-luna/mod_gnutls/wiki)
* [Security](/airtower-luna/mod_gnutls/security)
* [Insights](/airtower-luna/mod_gnutls/pulse)

# Infinite Loop on request read timeout in mod\_gnutls

High

[airtower-luna](/airtower-luna)
published
GHSA-6cfv-fvgm-7pc8
Feb 23, 2023

## Package

mod\_gnutls

## Affected versions

>= 0.9.0, <= 0.12.0

## Patched versions

0.12.1

## Description

### Impact

Mod\_gnutls versions from 0.9.0 to 0.12.0 (including) did not properly fail blocking read operations on TLS connections when the transport hit timeouts. Instead it entered an endless loop retrying the read operation, consuming CPU resources. This could be exploited for denial of service attacks. If trace level logging was enabled, it would also produce an excessive amount of log output during the loop, consuming disk space.

### Patches

The problem has been fixed in commit [d7eec4e](https://github.com/airtower-luna/mod_gnutls/commit/d7eec4e598158ab6a98bf505354e84352f9715ec), please update to version 0.12.1.

### Workarounds

There's no workaround, users who cannot update should apply the errno fix:

```
@@ -1003,7 +1008,7 @@ ssize_t mgs_transport_read(gnutls_transport_ptr_t ptr,
             && APR_BRIGADE_EMPTY(ctxt->input_bb))
         {
             ctxt->input_rc = rc;
-            gnutls_transport_set_errno(ctxt->session, EAGAIN);
+            gnutls_transport_set_errno(ctxt->session, ETIMEDOUT);
             return -1;
         }

```
### References

There's a [detailed analysis of the bug](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=942737#25) on the Debian bug tracker. Many thanks to Félix Arreola Rodríguez!

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2023-25824

### Weaknesses

[CWE-835](/advisories?query=cwe%3A835)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_35c16efd_20250114_185850.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairtower-luna%2Fmod_gnutls%2Fcommit%2Fd7eec4e598158ab6a98bf505354e84352f9715ec)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairtower-luna%2Fmod_gnutls%2Fcommit%2Fd7eec4e598158ab6a98bf505354e84352f9715ec)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=airtower-luna%2Fmod_gnutls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[airtower-luna](/airtower-luna)
/
**[mod\_gnutls](/airtower-luna/mod_gnutls)**
Public

* [Notifications](/login?return_to=%2Fairtower-luna%2Fmod_gnutls) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fairtower-luna%2Fmod_gnutls)
* [Star
   14](/login?return_to=%2Fairtower-luna%2Fmod_gnutls)

* [Code](/airtower-luna/mod_gnutls)
* [Issues
  2](/airtower-luna/mod_gnutls/issues)
* [Pull requests
  1](/airtower-luna/mod_gnutls/pulls)
* [Actions](/airtower-luna/mod_gnutls/actions)
* [Wiki](/airtower-luna/mod_gnutls/wiki)
* [Security](/airtower-luna/mod_gnutls/security)
* [Insights](/airtower-luna/mod_gnutls/pulse)

Additional navigation options

* [Code](/airtower-luna/mod_gnutls)
* [Issues](/airtower-luna/mod_gnutls/issues)
* [Pull requests](/airtower-luna/mod_gnutls/pulls)
* [Actions](/airtower-luna/mod_gnutls/actions)
* [Wiki](/airtower-luna/mod_gnutls/wiki)
* [Security](/airtower-luna/mod_gnutls/security)
* [Insights](/airtower-luna/mod_gnutls/pulse)

## Commit

[Permalink](/airtower-luna/mod_gnutls/commit/d7eec4e598158ab6a98bf505354e84352f9715ec)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix loop in blocking read on transport timeout

[Browse files](/airtower-luna/mod_gnutls/tree/d7eec4e598158ab6a98bf505354e84352f9715ec)
Browse the repository at this point in the history

```
The loop was cased by an incorrect errno if the transport read in
mgs_transport_read() fails with an APR TIMEUP status, as happens when
mod_reqtimeout limits are exceeded. Setting the transport errno to
EGAIN meant that a blocking read would be retried endlessly, setting
ETIMEDOUT instead makes the read fail as it should.

The bug was introduced in commit [92cb0cc](https://github.com/airtower-luna/mod_gnutls/commit/92cb0cca41af946055307e373b6ab6d76d34f356),
first release to include it was 0.9.0.

Many thanks to Félix Arreola Rodríguez for the detailed analysis [1]
on the Debian bug tracker!

[1] <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=942737#25>
```

* Loading branch information

[![@airtower-luna](https://avatars.githubusercontent.com/u/5814919?s=40&v=4)](/airtower-luna)

[airtower-luna](/airtower-luna/mod_gnutls/commits?author=airtower-luna "View all commits by airtower-luna")
committed
Feb 23, 2023

1 parent
[3855d9e](/airtower-luna/mod_gnutls/commit/3855d9ee2461fba7fa75429260e0d714a1cfd694)

commit d7eec4e

Showing
**1 changed file**
with
**7 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

9 changes: 7 additions & 2 deletions

9
[src/gnutls\_io.c](#diff-f0eaf7fbbb49e74b36e95f32056eee3646cc8c017cb01d648147e07da16f4f6f "src/gnutls_io.c")

Show comments

[View file](/airtower-luna/mod_gnutls/blob/d7eec4e598158ab6a98bf505354e84352f9715ec/src/gnutls_io.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,7 +2,7 @@ |
|  |  | \* Copyright 2004-2005 Paul Querna |
|  |  | \* Copyright 2008 Nikos Mavrogiannopoulos |
|  |  | \* Copyright 2011 Dash Shendy |
|  |  | \* Copyright 2015-2020 Fiona Klute |
|  |  | \* Copyright 2015-2022 Fiona Klute |
|  |  | \* |
|  |  | \* Licensed under the Apache License, Version 2.0 (the "License"); |
|  |  | \* you may not use this file except in compliance with the License. |
| Expand Down  Expand Up | | @@ -277,6 +277,11 @@ static apr\_status\_t gnutls\_io\_input\_read(mgs\_handle\_t \* ctxt, |
|  |  | gnutls\_alert\_get\_name(rc)); |
|  |  | ctxt->input\_rc = APR\_EGENERAL; |
|  |  | break; |
|  |  | } else if (rc == GNUTLS\_E\_PULL\_ERROR |
|  |  | && APR\_STATUS\_IS\_TIMEUP(ctxt->input\_rc)) { |
|  |  | ap\_log\_cerror( |
|  |  | APLOG\_MARK, APLOG\_TRACE2, ctxt->input\_rc, ctxt->c, |
|  |  | "%s: transport read timed out", \_\_func\_\_); |
|  |  | } else { |
|  |  | /\* Some Other Error. Report it. Die. \*/ |
|  |  | if (gnutls\_error\_is\_fatal(rc)) { |
| Expand Down  Expand Up | | @@ -1003,7 +1008,7 @@ ssize\_t mgs\_transport\_read(gnutls\_transport\_ptr\_t ptr, |
|  |  | && APR\_BRIGADE\_EMPTY(ctxt->input\_bb)) |
|  |  | { |
|  |  | ctxt->input\_rc = rc; |
|  |  | gnutls\_transport\_set\_errno(ctxt->session, EAGAIN); |
|  |  | gnutls\_transport\_set\_errno(ctxt->session, ETIMEDOUT); |
|  |  | return -1; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d7eec4e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fairtower-luna%2Fmod_gnutls%2Fcommit%2Fd7eec4e598158ab6a98bf505354e84352f9715ec) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


