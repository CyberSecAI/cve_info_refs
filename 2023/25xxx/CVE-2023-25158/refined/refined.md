Based on the provided information, this content is related to CVE-2023-25158.

**Root cause of vulnerability:**
The root cause is improper handling of user-provided input when constructing SQL queries within the GeoTools library, specifically when processing OGC Filter expressions with JDBCDataStore implementations. This leads to SQL injection vulnerabilities.

**Weaknesses/vulnerabilities present:**
-  SQL Injection vulnerabilities in multiple filters and functions:
   - `PropertyIsLike` filter
   - `strEndsWith` function
   - `strStartsWith` function
   - `FeatureId` filter
   - `jsonArrayContains` function
   - `DWithin` filter

**Impact of exploitation:**
Successful exploitation allows an attacker to execute arbitrary SQL commands, potentially leading to:
   - Data exfiltration
   - Data modification
   - Denial of service
   - Other impacts depending on database permissions

**Attack vectors:**
The attack vector is network-based, exploiting the vulnerability through the GeoTools library's handling of OGC Filter expressions.

**Required attacker capabilities/position:**
- An attacker needs to be able to provide malicious OGC Filter expressions to the GeoTools library when using a vulnerable JDBCDataStore.
- No privileges or user interaction is required for exploitation.

**Vulnerability details:**

1.  `PropertyIsLike` filter: Vulnerable with PostGIS when "encode functions" is enabled or any JDBCDataStore with String fields. The fix involves correctly escaping the pattern in the `LikeFilterImpl.convertToSQL92` method.
2.  `strEndsWith` and `strStartsWith` functions: Vulnerable with PostGIS when "encode functions" is enabled.
3.  `FeatureId` filter: Vulnerable in any JDBCDataStore with prepared statements disabled, and a table with a String primary key.
4.  `jsonArrayContains` function: Vulnerable in PostGIS and Oracle DataStore with String or JSON fields.
5.  `DWithin` filter: Vulnerable in Oracle DataStore.

**Additional details from the commit diffs:**

-   The commit introduces an `escapeLiteral` method in `FilterToSQL.java`, which leverages `EscapeSql.escapeLiteral` to properly escape string literals in SQL queries.
-   `EscapeSql.java` contains the logic to escape single quotes, backslashes and double quotes.
-   The `convertToSQL92` method in `LikeFilterImpl.java` was modified to correctly escape single quotes.
-   Test cases were added to verify the correct escaping in `FilterToSQLTest.java` and `FilterTest.java`.
-   The `SQLDialect.java` file was modified to include a way of unwrapping connections to get to the native connection object.

This information provides a detailed breakdown of the SQL injection vulnerabilities addressed by the commit.