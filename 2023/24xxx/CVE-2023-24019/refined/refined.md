- **Root cause of vulnerability**: The `http_connection_readcb` function in `urvpn_client` does not perform bounds checking when parsing the HTTP response status message, leading to a stack-based buffer overflow.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-120). The `http_status_message` buffer, which is 52 bytes long, is vulnerable to overflow because the size of the received response line is not checked before being parsed into it using `sscanf`. The `urvpn_client` also does not verify the server certificate making a MITM attack possible.
- **Impact of exploitation**: An attacker can potentially achieve arbitrary code execution on the device via a crafted network packet.
- **Attack vectors**: A malicious actor can send a crafted HTTP response with a long status message to trigger the vulnerability. This can be done via a man-in-the-middle attack due to the client not verifying the server certificate (TALOS-2023-1705).
- **Required attacker capabilities/position**: The attacker needs to be in a position to intercept and modify network traffic between the Milesight UR32L router and the Milesight VPN server, and the Milesight VPN service has to be enabled by the admin.