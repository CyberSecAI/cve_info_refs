- **Root cause of vulnerability**: The `modify_user_password` function does not properly sanitize user-provided input, specifically the new password, before passing it to the `system_user_script` function. This function constructs a shell command by concatenating the user provided password into a string, and then executes the command via `system()`.
- **Weaknesses/vulnerabilities present**: OS command injection vulnerability (CWE-78). The `system_user_script` function uses `snprintf` to construct a command string, which is then passed to `system()`. The user-supplied password is included in this command string without proper sanitization, allowing for arbitrary command execution.
- **Impact of exploitation**: An attacker can execute arbitrary operating system commands with the privileges of the user running the vulnerable application. This can lead to complete system compromise, including data theft, denial of service, and further network attacks.
- **Attack vectors**: The vulnerability can be triggered by sending a sequence of commands to the router's CLI through the telnet or ssh interface. Specifically, modifying the password of an existing user using the `user <username> password <new_password>` command.
- **Required attacker capabilities/position**: The attacker needs to have valid credentials for accessing the router's CLI (telnet/ssh) with admin privileges, be able to issue commands to the router and know at least one existing user besides the superuser to be able to exploit the vulnerability by changing its password.