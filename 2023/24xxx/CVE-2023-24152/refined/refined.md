The content is related to CVE-2023-24152.

**Root cause of vulnerability:**
The `meshSlaveUpdate` function in TOTOLINK T8 routers does not properly sanitize user input for the "serverIp" parameter received through MQTT packets.

**Weaknesses/vulnerabilities present:**
Command injection vulnerability. The lack of input sanitization allows an attacker to inject arbitrary commands into the "serverIp" parameter.

**Impact of exploitation:**
An attacker can execute arbitrary commands on the router's operating system.

**Attack vectors:**
By sending a crafted MQTT packet to the router's MQTT service with a malicious "serverIp" parameter.

**Required attacker capabilities/position:**
The attacker needs to be able to send MQTT packets to the router. The router's MQTT service is running, and the attacker needs to know the topic. In the example given the attacker connected to 192.168.0.1 on port 1883 and the MQTT topic was "totolink/router/meshSlaveUpdate"