=== Content from github.com_9031cacb_20250114_183205.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fissues%2F1358)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fissues%2F1358)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=dgtlmoon%2Fchangedetection.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dgtlmoon](/dgtlmoon)
/
**[changedetection.io](/dgtlmoon/changedetection.io)**
Public

* [Notifications](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)
* [Star
   21.1k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)

* [Code](/dgtlmoon/changedetection.io)
* [Issues
  223](/dgtlmoon/changedetection.io/issues)
* [Pull requests
  35](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects
  0](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

Additional navigation options

* [Code](/dgtlmoon/changedetection.io)
* [Issues](/dgtlmoon/changedetection.io/issues)
* [Pull requests](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdgtlmoon%2Fchangedetection.io%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Security] Stored XSS in main page #1358

Closed

[edoardottt](/edoardottt) opened this issue
Jan 28, 2023
¬∑ 10 comments
 ¬∑ Fixed by [#1359](https://github.com/dgtlmoon/changedetection.io/pull/1359)

Closed

# [[Security] Stored XSS in main page](#top) #1358

[edoardottt](/edoardottt) opened this issue
Jan 28, 2023
¬∑ 10 comments
 ¬∑ Fixed by [#1359](https://github.com/dgtlmoon/changedetection.io/pull/1359)

Assignees
[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&v=4)](/dgtlmoon)

Labels
[bug](/dgtlmoon/changedetection.io/labels/bug)
Something isn't working
[security](/dgtlmoon/changedetection.io/labels/security)

## Comments

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=80&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)

Copy link

### **[edoardottt](/edoardottt)** commented [Jan 28, 2023](#issue-1561030802) ‚Ä¢ edited Loading

| **Describe the bug** It's possible to inject arbitrary Javascript code in the main page of changedetection.io. This can result in a stored cross site scripting attack. Since in `/settings#api` it's exposed the plaintext API Key, the attacker can read also the api key with an XSS attack.  **Version** I'm using *v0.39.20.4*, but I'm sure other version could be affected as well.  **To Reproduce**  Steps to reproduce the behavior:   1. Go to the main page. 2. Under *Add a new change detection watch* add as URL `javascript:alert(document.domain)` 3. Click *Watch* 4. A new row is added under the websites watched 5. Click CTRL+ click with mouse on the link taking to a new tab 6. Javascript payload is being executed.   Reproduce the vulnerability with <https://changedetection.io/share/LpbICKx5Rbca>  **Expected behavior** `javascript` protocol should be blocked like `file://` for security reasons.  **Screenshots** [Screenshot from 2023-01-28 23-10-19](https://user-images.githubusercontent.com/35783570/215293357-d36b0b7c-d8e6-49a1-8541-1853c06ce23e.png)  **Desktop (please complete the following information):**   * OS: `Linux edoardottt 5.19.0-29-generic` * Browser: Chrome Version 109.0.5414.119 (Official Build) (64-bit) * Changedetetion.io Version: v0.39.20.4 |
| --- |
| The text was updated successfully, but these errors were encountered: |

 ‚ù§Ô∏è
1
 dgtlmoon reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=40&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)
[edoardottt](/edoardottt)
added
the
[triage](/dgtlmoon/changedetection.io/labels/triage)
label
[Jan 28, 2023](#event-8380590138)

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=40&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)
[edoardottt](/edoardottt)
assigned [dgtlmoon](/dgtlmoon)
[Jan 28, 2023](#event-8380590150)

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=80&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)

Copy link

Owner

### **[dgtlmoon](/dgtlmoon)** commented [Jan 28, 2023](#issuecomment-1407499937)

| Hey thanks! yeah interesting, If i just click on the link, I get `about:blank#blocked` but if I ctrl+click it will run the JS |
| --- |

All reactions

Sorry, something went wrong.

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=80&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)

Copy link

Author

### **[edoardottt](/edoardottt)** commented [Jan 28, 2023](#issuecomment-1407500261) ‚Ä¢ edited Loading

| Yeah I know. That's why I specified that thing. It's a security measure taken by the modern browsers, but if you use an older one it will execute normally. (Even if I normally click it with ctrl pressed ü§ß)  Can you give some info on the versions affected? You are the one knowing the entire codebase :P |
| --- |

All reactions

Sorry, something went wrong.

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=80&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)

Copy link

Owner

### **[dgtlmoon](/dgtlmoon)** commented [Jan 28, 2023](#issuecomment-1407500473)

| Hmm i'm wondering if a better future-proof fix is to only allow `^http(s)+/` links by default |
| --- |

 üëç
1
 edoardottt reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=80&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)

Copy link

Author

### **[edoardottt](/edoardottt)** commented [Jan 28, 2023](#issuecomment-1407500789)

| Strongly agreed. |
| --- |

All reactions

Sorry, something went wrong.

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)
[dgtlmoon](/dgtlmoon)
mentioned this issue
[Jan 28, 2023](#ref-pullrequest-1561043178)

[Possible stored XSS in watch list - Only permit HTTP/HTTP/FTP by default - override with env var `SAFE_PROTOCOL_REGEX`
#1359](/dgtlmoon/changedetection.io/pull/1359)
 Merged

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=80&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)

Copy link

Owner

### **[dgtlmoon](/dgtlmoon)** commented [Jan 28, 2023](#issuecomment-1407506762) ‚Ä¢ edited Loading

| [@edoardottt](https://github.com/edoardottt) whats your thoughts on [#1359](https://github.com/dgtlmoon/changedetection.io/pull/1359) ? I guess this is kinda mitigated by the fact that you'de need to ctrl+click on it |
| --- |

All reactions

Sorry, something went wrong.

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)
[dgtlmoon](/dgtlmoon)
added
[bug](/dgtlmoon/changedetection.io/labels/bug)
Something isn't working
[security](/dgtlmoon/changedetection.io/labels/security)
and removed
[triage](/dgtlmoon/changedetection.io/labels/triage)
labels
[Jan 28, 2023](#event-8380671185)

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=80&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)

Copy link

Owner

### **[dgtlmoon](/dgtlmoon)** commented [Jan 29, 2023](#issuecomment-1407517499) ‚Ä¢ edited Loading

| [@edoardottt](https://github.com/edoardottt) this is further mitigated by the 'share' receiving server now checking for 'javascript:' , so it wont be possible to share that kind of URL, so you'de have to paste that URL in (which is possible I guess)  <https://changedetection.io/share/LpbICKx5Rbca> was deleted from the share database |
| --- |

All reactions

Sorry, something went wrong.

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=80&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)

Copy link

Author

### **[edoardottt](/edoardottt)** commented [Jan 29, 2023](#issuecomment-1407602562)

| I can confirm the share feature is behaving correctly handling `javascript` protocol (imo it was the best option to deliver the attack payload). For the other mitigations it seems okay üëç |
| --- |

All reactions

Sorry, something went wrong.

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=80&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)

Copy link

Author

### **[edoardottt](/edoardottt)** commented [Jan 29, 2023](#issuecomment-1407616772)

| For the sake of completeness, this attack can be carried out also using the `Import` feature with this payload:  ``` {    "client":{       "local":1    },    "data":[       {          "name":"javascript:alert(document.domain)",          "uri":"javascript:alert(document.domain)",          "config":"{\"selections\":[]}",          "tags":[]       }    ] }  ```  but now it looks fixed |
| --- |

All reactions

Sorry, something went wrong.

[![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=80&u=0d92158553af9725b6864d4a3838e2c8f89cac92&v=4)](/edoardottt)

Copy link

Author

### **[edoardottt](/edoardottt)** commented [Jan 29, 2023](#issuecomment-1407617102) ‚Ä¢ edited by dgtlmoon Loading

| Another idea, since in `http://BASE_URL/settings#api` we have plaintext API Key, the attacker can read also the api key with a XSS attack. |
| --- |

All reactions

Sorry, something went wrong.

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=80&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)

Copy link

Owner

### **[dgtlmoon](/dgtlmoon)** commented [Jan 29, 2023](#issuecomment-1407620290)

| go easy on the emoticons :) yeah but that should be resolved on that PR, I'll merge it in and make a release |
| --- |

All reactions

Sorry, something went wrong.

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&u=94abd34c8fa06db18e09f1e6ade5a3f4f1202f9f&v=4)](/dgtlmoon)
[dgtlmoon](/dgtlmoon)
closed this as [completed](/dgtlmoon/changedetection.io/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 29, 2023](#event-8381481354)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fissues%2F1358)

Assignees

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&v=4)](/dgtlmoon) [dgtlmoon](/dgtlmoon)

Labels

[bug](/dgtlmoon/changedetection.io/labels/bug)
Something isn't working
[security](/dgtlmoon/changedetection.io/labels/security)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Possible stored XSS in watch list - Only permit HTTP/HTTP/FTP by default - override with env var `SAFE_PROTOCOL_REGEX`](/dgtlmoon/changedetection.io/pull/1359)
 [dgtlmoon/changedetection.io](/dgtlmoon/changedetection.io)

2 participants

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=52&v=4)](/dgtlmoon) [![@edoardottt](https://avatars.githubusercontent.com/u/35783570?s=52&v=4)](/edoardottt)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


