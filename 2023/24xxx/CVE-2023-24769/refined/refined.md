Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The application allowed arbitrary `javascript:` URLs to be added as part of a "watch" configuration.  These URLs were then rendered as clickable links on the main page.  When a user interacted with these links (specifically with a `ctrl+click`), the javascript payload was executed.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):**  The primary vulnerability is a stored XSS flaw.  The injected javascript payload was saved in the application's data store and executed when the affected page was viewed.
*   **Inadequate Input Validation:** The application did not properly validate or sanitize URLs provided by the user. Specifically, it failed to block the `javascript:` protocol.
*   **Lack of Output Encoding:** The application did not properly encode the user-provided URL, rendering it directly as a clickable link.

**Impact of Exploitation:**

*   **Arbitrary Javascript Execution:** An attacker can execute arbitrary javascript code within the context of the victim's browser session when the user interacts with the malicious link in the main page.
*   **API Key Exposure:** The injected javascript can be used to access the API key which is exposed in plaintext on the `/settings#api` page which may allow the attacker to perform other actions.
*   **Account Compromise:** An attacker can potentially perform actions on behalf of the logged-in user or steal session cookies, leading to account compromise.

**Attack Vectors:**

*   **Direct Input:** Attackers can directly input `javascript:` URLs into the "Add a new change detection watch" field on the main page.
*   **Import Feature:** The vulnerability can be exploited using the import feature to import a configuration containing a malicious javascript URL.
*   **Share Feature (Mitigated):**  The share feature was initially vulnerable; however, it was later mitigated by server side check for 'javascript:'.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to access the main page of the application and create or import "watch" configurations.
*   No special privileges are required; any user able to add a new watch is vulnerable.

**Additional Notes:**
*   The vulnerability is present in versions prior to the fix which was deployed in pull request #1359.
*   The issue was initially mitigated by modern browsers which blocked the `javascript:` protocol when a user simply clicked the link. However, the exploit could be triggered using `ctrl+click`.
*   The fix introduces a regular expression to only allow http(s)+/ links by default and adds a server side check for `javascript:` in the share feature. This can be overridden by an environment variable.