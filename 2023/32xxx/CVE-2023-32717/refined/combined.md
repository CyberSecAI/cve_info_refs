=== Content from advisory.splunk.com_b8b78a0c_20250114_201341.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Role-based Access Control (RBAC) Bypass on '/services/indexing/preview' REST Endpoint Can Overwrite Search Results

**Advisory ID:** SVD-2023-0612

**CVE ID:** [CVE-2023-32717](https://www.cve.org/CVERecord?id=CVE-2023-32717)

**Published:** 2023-06-01

**Last Update:** 2023-06-01

**CVSSv3.1 Score:** 4.3, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**CWE:** [CWE-285](https://cwe.mitre.org/data/definitions/285.html)

**Bug ID:** SPL-237454

## Description

An unauthorized user can access the ‘/services/indexing/preview’ REST endpoint to overwrite search results if they know the search ID (SID) of an existing search job. This is because the endpoint does not honor role-based access controls (RBAC) with respect to SID ownership. The exploit requires that the user hold a role that has the ‘edit\_monitor’ and ‘edit\_upload\_and\_index’ capabilities assigned to it.

## Solution

For Splunk Enterprise, upgrade to versions 9.0.5, 8.2.11, or 8.1.14 and higher.

For Splunk Cloud Platform, Splunk is monitoring and patching affected instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.1 | Splunk Web | 8.1.0 to 8.1.13 | 8.1.14 |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.10 | 8.2.11 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.4 | 9.0.5 |
| Splunk Cloud Platform |  | Splunk Web | 9.0.2303 and below | 9.0.2303.100 |

## Mitigations and Workarounds

Remove the ‘edit\_monitor’ and ‘edit\_upload\_and\_index’ capabilities from roles that low-privilege user accounts hold. Ensure that all REST endpoints have the proper access control lists (ACLs) applied to them.

## Detections

* [Splunk RBAC Bypass on indexing preview REST Endpoint](https://research.splunk.com/application/bbe26f95-1655-471d-8abd-3d32fafa86f8/)

This detection search provides information on possible role-based access control bypass exploits in versions of Splunk Enterprise below 9.0.5, 8.2.11, and 8.1.14.

## Severity

Splunk rated this vulnerability as Medium, 4.3, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N.

## Acknowledgments

Scott Calvert, Splunk

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)

=== Content from research.splunk.com_16080cd2_20250114_201343.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk RBAC Bypass On Indexing Preview REST Endpoint

Updated Date: 2024-10-17
ID: bbe26f95-1655-471d-8abd-3d32fafa86f8
Author: Rod Soto
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies unauthorized attempts to use the /services/indexing/preview REST endpoint in Splunk. It detects POST requests to this endpoint by monitoring the \_internal index for specific URI patterns. This activity is significant because it indicates a potential RBAC (Role-Based Access Control) bypass, allowing unauthorized users to overwrite search results if they know the search ID (SID) of an existing job. If confirmed malicious, this could lead to data manipulation, unauthorized access to sensitive information, and compromised integrity of search results.

### Search

```
1`splunkda` method="POST" uri="*/services/indexing/preview*"
2| table host clientip status useragent user uri_path
3| `splunk_rbac_bypass_on_indexing_preview_rest_endpoint_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunkda](https://github.com/splunk/security_content/blob/develop/macros/splunkda.yml) | `index=_internal sourcetype=splunkd_access` |
| splunk\_rbac\_bypass\_on\_indexing\_preview\_rest\_endpoint\_filter | `search *` |

`splunk_rbac_bypass_on_indexing_preview_rest_endpoint_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1134](https://attack.mitre.org/techniques/T1134/) | Access Token Manipulation | Defense Evasion |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

Blue Mockingbird
FIN6

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

This search does not require additional data ingestion. It requires the ability to search \_internal index.

### Known False Positives

This is a hunting search which provides verbose results against this endpoint. Operator must consider things such as IP address, useragent and user(specially low privelege) and host to investigate possible attack.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Review $clientip$ access to indexing preview endpoint from low privilege user | 15 | 30 | 50 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1134/splunk/splunk_rbac_bypass_on_indexing_preview_rest_endpoint.log) | `splunkd_access.log` | `splunkd_access` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1134/splunk/splunk_rbac_bypass_on_indexing_preview_rest_endpoint.log) | `splunkd_access.log` | `splunkd_access` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_rbac_bypass_on_indexing_preview_rest_endpoint.yml) |
Version: **3**

[Detection: Splunk protocol impersonation weak encryption simplerequest](https://research.splunk.com/application/839d12a6-b119-4d44-ac4f-13eed95412c8/ "Detection: Splunk protocol impersonation weak encryption simplerequest")

[Detection: Splunk RCE Through Arbitrary File Write to Windows System Root](https://research.splunk.com/application/c97e0704-d9c6-454d-89ba-1510a987bf72/ "Detection: Splunk RCE Through Arbitrary File Write to Windows System Root")

Â© 2005 - 2024 Splunk LLC All rights reserved.


