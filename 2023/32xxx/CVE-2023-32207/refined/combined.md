=== Content from security.gentoo.org_897e22ca_20250114_181731.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from security.gentoo.org_16b7ab9d_20250114_181731.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202312-03**

Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could lead to remote code execution.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **102.12** |
| Unaffected versions | >= **102.12** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.12** |
| Unaffected versions | >= **102.12** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-102.12"

```

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-102.12"

```
### References

* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)

**Release date**

December 20, 2023

**Latest revision**

December 20, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908246](https://bugs.gentoo.org/show_bug.cgi?id=908246)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_9c4ab3df_20250114_181732.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-16

## Security Vulnerabilities fixed in Firefox 113

Announced
May 9, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 113

#### [#CVE-2023-32205: Browser prompts could have been obscured by popups](#CVE-2023-32205)

Reporter
Alesandro Ortiz
Impact
high
##### Description

In multiple cases browser prompts could have been obscured by popups controlled by content. These could have led to potential user confusion and spoofing attacks.

##### References

* [Bug 1753339](https://bugzilla.mozilla.org/show_bug.cgi?id=1753339)
* [Bug 1753341](https://bugzilla.mozilla.org/show_bug.cgi?id=1753341)

#### [#CVE-2023-32206: Crash in RLBox Expat driver](#CVE-2023-32206)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bound read could have led to a crash in the RLBox Expat driver.

##### References

* [Bug 1824892](https://bugzilla.mozilla.org/show_bug.cgi?id=1824892)

#### [#CVE-2023-32207: Potential permissions request bypass via clickjacking](#CVE-2023-32207)

Reporter
Hafiizh
Impact
high
##### Description

A missing delay in popup notifications could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1826116](https://bugzilla.mozilla.org/show_bug.cgi?id=1826116)

#### [#CVE-2023-32208: Leak of script base URL in service workers via import()](#CVE-2023-32208)

Reporter
Anne van Kesteren
Impact
moderate
##### Description

Service workers could reveal script base URL due to dynamic `import()`.

##### References

* [Bug 1646034](https://bugzilla.mozilla.org/show_bug.cgi?id=1646034)

#### [#CVE-2023-32209: Persistent DoS via favicon image](#CVE-2023-32209)

Reporter
Sam Ezeh
Impact
moderate
##### Description

A maliciously crafted favicon could have led to an out of memory crash.

##### References

* [Bug 1767194](https://bugzilla.mozilla.org/show_bug.cgi?id=1767194)

#### [#CVE-2023-32210: Incorrect principal object ordering](#CVE-2023-32210)

Reporter
Nika Layzell
Impact
moderate
##### Description

Documents were incorrectly assuming an ordering of principal objects when ensuring we were loading an appropriately privileged principal. In certain circumstances it might have been possible to cause a document to be loaded with a higher privileged principal than intended.

##### References

* [Bug 1776755](https://bugzilla.mozilla.org/show_bug.cgi?id=1776755)

#### [#CVE-2023-32211: Content process crash due to invalid wasm code](#CVE-2023-32211)

Reporter
P1umer and xmzyshypnc
Impact
moderate
##### Description

A type checking bug would have led to invalid code being compiled.

##### References

* [Bug 1823379](https://bugzilla.mozilla.org/show_bug.cgi?id=1823379)

#### [#CVE-2023-32212: Potential spoof due to obscured address bar](#CVE-2023-32212)

Reporter
Hafiizh
Impact
moderate
##### Description

An attacker could have positioned a `datalist` element to obscure the address bar.

##### References

* [Bug 1826622](https://bugzilla.mozilla.org/show_bug.cgi?id=1826622)

#### [#CVE-2023-32213: Potential memory corruption in FileReader::DoReadData()](#CVE-2023-32213)

Reporter
Ronald Crane
Impact
moderate
##### Description

When reading a file, an uninitialized value could have been used as read limit.

##### References

* [Bug 1826666](https://bugzilla.mozilla.org/show_bug.cgi?id=1826666)

#### [#MFSA-TMP-2023-0002: Race condition in dav1d decoding](#MFSA-TMP-2023-0002)

Reporter
Tyson Smith
Impact
moderate
##### Description

A race condition during dav1d decoding could have led to an out-of-bounds memory access, potentially leading to memory corruption and execution of malicious code.

##### References

* [Bug 1814790](https://bugzilla.mozilla.org/show_bug.cgi?id=1814790)
* [Bug 1819796](https://bugzilla.mozilla.org/show_bug.cgi?id=1819796)
* [Bug 1814560](https://bugzilla.mozilla.org/show_bug.cgi?id=1814560)

#### [#CVE-2023-32214: Potential DoS via exposed protocol handlers](#CVE-2023-32214)

Reporter
Edward Prior
Impact
low
##### Description

Protocol handlers `ms-cxh` and `ms-cxh-full` could have been leveraged to trigger a denial of service.
*Note: This attack only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1828716](https://bugzilla.mozilla.org/show_bug.cgi?id=1828716)

#### [#CVE-2023-32215: Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](#CVE-2023-32215)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Andrew Osmond, Emily McDonough, Sebastian Hengst, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 112 and Firefox ESR 102.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540883%2C1751943%2C1814856%2C1820210%2C1821480%2C1827019%2C1827024%2C1827144%2C1827359%2C1830186)

#### [#CVE-2023-32216: Memory safety bugs fixed in Firefox 113](#CVE-2023-32216)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Ronald Crane, Andrew McCreight, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 112. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 113](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746479%2C1806852%2C1815987%2C1820359%2C1823568%2C1824803%2C1824834%2C1825170%2C1827020%2C1828130)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_6ad555e3_20250114_181734.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-18

## Security Vulnerabilities fixed in Thunderbird 102.11

Announced
May 10, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.11

#### [#CVE-2023-32205: Browser prompts could have been obscured by popups](#CVE-2023-32205)

Reporter
Alesandro Ortiz
Impact
high
##### Description

In multiple cases browser prompts could have been obscured by popups controlled by content. These could have led to potential user confusion and spoofing attacks.

##### References

* [Bug 1753339](https://bugzilla.mozilla.org/show_bug.cgi?id=1753339)
* [Bug 1753341](https://bugzilla.mozilla.org/show_bug.cgi?id=1753341)

#### [#CVE-2023-32206: Crash in RLBox Expat driver](#CVE-2023-32206)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bound read could have led to a crash in the RLBox Expat driver.

##### References

* [Bug 1824892](https://bugzilla.mozilla.org/show_bug.cgi?id=1824892)

#### [#CVE-2023-32207: Potential permissions request bypass via clickjacking](#CVE-2023-32207)

Reporter
Hafiizh
Impact
high
##### Description

A missing delay in popup notifications could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1826116](https://bugzilla.mozilla.org/show_bug.cgi?id=1826116)

#### [#CVE-2023-32211: Content process crash due to invalid wasm code](#CVE-2023-32211)

Reporter
P1umer and xmzyshypnc
Impact
moderate
##### Description

A type checking bug would have led to invalid code being compiled.

##### References

* [Bug 1823379](https://bugzilla.mozilla.org/show_bug.cgi?id=1823379)

#### [#CVE-2023-32212: Potential spoof due to obscured address bar](#CVE-2023-32212)

Reporter
Hafiizh
Impact
moderate
##### Description

An attacker could have positioned a `datalist` element to obscure the address bar.

##### References

* [Bug 1826622](https://bugzilla.mozilla.org/show_bug.cgi?id=1826622)

#### [#CVE-2023-32213: Potential memory corruption in FileReader::DoReadData()](#CVE-2023-32213)

Reporter
Ronald Crane
Impact
moderate
##### Description

When reading a file, an uninitialized value could have been used as read limit.

##### References

* [Bug 1826666](https://bugzilla.mozilla.org/show_bug.cgi?id=1826666)

#### [#CVE-2023-32214: Potential DoS via exposed protocol handlers](#CVE-2023-32214)

Reporter
Edward Prior
Impact
low
##### Description

Protocol handlers `ms-cxh` and `ms-cxh-full` could have been leveraged to trigger a denial of service.
*Note: This attack only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1828716](https://bugzilla.mozilla.org/show_bug.cgi?id=1828716)

#### [#CVE-2023-32215: Memory safety bugs fixed in Thunderbird 102.11](#CVE-2023-32215)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Andrew Osmond, Emily McDonough, Sebastian Hengst, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540883%2C1751943%2C1814856%2C1820210%2C1821480%2C1827019%2C1827024%2C1827144%2C1827359%2C1830186)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a3bfb17e_20250114_181733.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-17

## Security Vulnerabilities fixed in Firefox ESR 102.11

Announced
May 9, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.11

#### [#CVE-2023-32205: Browser prompts could have been obscured by popups](#CVE-2023-32205)

Reporter
Alesandro Ortiz
Impact
high
##### Description

In multiple cases browser prompts could have been obscured by popups controlled by content. These could have led to potential user confusion and spoofing attacks.

##### References

* [Bug 1753339](https://bugzilla.mozilla.org/show_bug.cgi?id=1753339)
* [Bug 1753341](https://bugzilla.mozilla.org/show_bug.cgi?id=1753341)

#### [#CVE-2023-32206: Crash in RLBox Expat driver](#CVE-2023-32206)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bound read could have led to a crash in the RLBox Expat driver.

##### References

* [Bug 1824892](https://bugzilla.mozilla.org/show_bug.cgi?id=1824892)

#### [#CVE-2023-32207: Potential permissions request bypass via clickjacking](#CVE-2023-32207)

Reporter
Hafiizh
Impact
high
##### Description

A missing delay in popup notifications could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1826116](https://bugzilla.mozilla.org/show_bug.cgi?id=1826116)

#### [#CVE-2023-32211: Content process crash due to invalid wasm code](#CVE-2023-32211)

Reporter
P1umer and xmzyshypnc
Impact
moderate
##### Description

A type checking bug would have led to invalid code being compiled.

##### References

* [Bug 1823379](https://bugzilla.mozilla.org/show_bug.cgi?id=1823379)

#### [#CVE-2023-32212: Potential spoof due to obscured address bar](#CVE-2023-32212)

Reporter
Hafiizh
Impact
moderate
##### Description

An attacker could have positioned a `datalist` element to obscure the address bar.

##### References

* [Bug 1826622](https://bugzilla.mozilla.org/show_bug.cgi?id=1826622)

#### [#CVE-2023-32213: Potential memory corruption in FileReader::DoReadData()](#CVE-2023-32213)

Reporter
Ronald Crane
Impact
moderate
##### Description

When reading a file, an uninitialized value could have been used as read limit.

##### References

* [Bug 1826666](https://bugzilla.mozilla.org/show_bug.cgi?id=1826666)

#### [#CVE-2023-32214: Potential DoS via exposed protocol handlers](#CVE-2023-32214)

Reporter
Edward Prior
Impact
low
##### Description

Protocol handlers `ms-cxh` and `ms-cxh-full` could have been leveraged to trigger a denial of service.
*Note: This attack only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1828716](https://bugzilla.mozilla.org/show_bug.cgi?id=1828716)

#### [#CVE-2023-32215: Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](#CVE-2023-32215)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Andrew Osmond, Emily McDonough, Sebastian Hengst, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 112 and Firefox ESR 102.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540883%2C1751943%2C1814856%2C1820210%2C1821480%2C1827019%2C1827024%2C1827144%2C1827359%2C1830186)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b7072c50_20250114_181731.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1826116)
* [XML](/show_bug.cgi?ctype=xml&id=1826116)

Closed
[Bug 1826116](/show_bug.cgi?id=1826116)
(CVE-2023-32207)

Opened 2 years ago
Closed 2 years ago

# Clickjacking to allowed location permission (bypassing button-enable delay)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Clickjacking to allowed location permission (bypassing button-enable delay)

## Categories

### (Firefox :: Site Permissions, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Site%20Permissions#Site%20Permissions)

Site Permissions
▾

Firefox :: Site Permissions
Bugs and feature requests for the Firefox UI to give or revoke web page permissions to access device functionality such as camera, microphone, geolocation or notifications.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Permissions&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Permissions&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Site%20Permissions)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

114 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [113+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=113%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified) |
| firefox112 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix) |
| firefox113 | [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=verified) |
| firefox114 | [+](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 | 113+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox112 |  | wontfix |
| firefox113 | + | verified |
| firefox114 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: emz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[CVE-2023-4047](/show_bug.cgi?id=1839073 "VERIFIED FIXED - Bypass site permission clickjacking protections on Desktop by opening a new tab with window.open() and closing it after the permission timeout has expired")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1840785](/show_bug.cgi?id=1840785 "RESOLVED DUPLICATE - Firefox Browser Desktop Permission Prompt Tapjacking"), [1865465](/show_bug.cgi?id=1865465 "RESOLVED DUPLICATE - PopupNotifications Clickjacking: Bypass full screen prompt restrictions (Bug 1522120) and extended security delay (Bug 1857430)")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-32207

[Keywords:](/describekeywords.cgi)

[csectype-clickjacking](/buglist.cgi?keywords=csectype-clickjacking&resolution=---),
[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+]

QA Whiteboard:

---

Has STR:

yes

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2519617_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | [in-testsuite](#c44 "2 years ago") | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (16 files)

| [bandicam 2023-04-03 21-21-19-749.mp4](/attachment.cgi?id=9326638)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   1.12 MB, video/mp4 |  | [Details](/attachment.cgi?id=9326638&action=edit) |
| --- | --- | --- |
| [bandicam 2023-04-03 21-27-15-258.mp4](/attachment.cgi?id=9326639)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   789.49 KB, video/mp4 |  | [Details](/attachment.cgi?id=9326639&action=edit) |
| [clickjacking.html](/attachment.cgi?id=9326640)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   1.51 KB, text/html |  | [Details](/attachment.cgi?id=9326640&action=edit) |
| [camera.html](/attachment.cgi?id=9327261)  [2 years ago](#c6)  [Hafiizh](/user_profile?user_id=694415)   1.61 KB, text/html |  | [Details](/attachment.cgi?id=9327261&action=edit) |
| [setto5000.mp4](/attachment.cgi?id=9327366)  [2 years ago](#c9)  [Hafiizh](/user_profile?user_id=694415)   3.57 MB, video/mp4 |  | [Details](/attachment.cgi?id=9327366&action=edit) |
| [setto5000restart.mp4](/attachment.cgi?id=9327367)  [2 years ago](#c11)  [Hafiizh](/user_profile?user_id=694415)   7.08 MB, video/mp4 |  | [Details](/attachment.cgi?id=9327367&action=edit) |
| [mouse\_setting.jpg](/attachment.cgi?id=9327368)  [2 years ago](#c12)  [Hafiizh](/user_profile?user_id=694415)   169.30 KB, image/jpeg |  | [Details](/attachment.cgi?id=9327368&action=edit) |
| [specificationlaptop.jpg](/attachment.cgi?id=9327369)  [2 years ago](#c13)  [Hafiizh](/user_profile?user_id=694415)   299.30 KB, image/jpeg |  | [Details](/attachment.cgi?id=9327369&action=edit) |
| [camerapermission.mp4](/attachment.cgi?id=9327372)  [2 years ago](#c15)  [Hafiizh](/user_profile?user_id=694415)   723.40 KB, video/mp4 |  | [Details](/attachment.cgi?id=9327372&action=edit) |
| [bandicam 2023-04-15 18-25-44-428.mp4](/attachment.cgi?id=9328666)  [2 years ago](#c18)  [Hafiizh](/user_profile?user_id=694415)   5.67 MB, video/mp4 |  | [Details](/attachment.cgi?id=9328666&action=edit) |
| [Bug 1826116 r=Gijs!](/attachment.cgi?id=9329740)  [2 years ago](#c22)  [Emma Zühlcke [:emz]](/user_profile?user_id=636491)   48 bytes, text/x-phabricator-request | dveditz : [approval-mozilla-beta+](#c28 "2 years ago")  dveditz : [approval-mozilla-esr102+](#c28 "2 years ago")  dveditz : [sec-approval+](#c28 "2 years ago") | [Details](/attachment.cgi?id=9329740&action=edit) | [Review](/attachment.cgi?id=9329740) |
| [Bug 1826116 - Test r=Gijs!](/attachment.cgi?id=9330606)  [2 years ago](#c24)  [Emma Zühlcke [:emz]](/user_profile?user_id=636491)   48 bytes, text/x-phabricator-request | dveditz : [approval-mozilla-beta+](#c29 "2 years ago")  dveditz : [approval-mozilla-esr102+](#c29 "2 years ago")  dveditz : [sec-approval+](#c29 "2 years ago") | [Details](/attachment.cgi?id=9330606&action=edit) | [Review](/attachment.cgi?id=9330606) |
| [resolutionandscalefactor.png](/attachment.cgi?id=9330816)  [2 years ago](#c36)  [Hafiizh](/user_profile?user_id=694415)   447.11 KB, image/png |  | [Details](/attachment.cgi?id=9330816&action=edit) |
| [perm\_00.gif](/attachment.cgi?id=9331121)  [2 years ago](#c39)  [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815)   466.08 KB, image/gif |  | [Details](/attachment.cgi?id=9331121&action=edit) |
| [Peek 2023-05-02 13-45.gif](/attachment.cgi?id=9331122)  [2 years ago](#c40)  [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815)   92.99 KB, image/gif |  | [Details](/attachment.cgi?id=9331122&action=edit) |
| [advisory.txt](/attachment.cgi?id=9331271)  [2 years ago](#c43)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   186 bytes, text/plain |  | [Details](/attachment.cgi?id=9331271&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1826116#c0)• 2 years ago |
|  | |

Attached video
[bandicam 2023-04-03 21-21-19-749.mp4](attachment.cgi?id=9326638)
— [Details](attachment.cgi?id=9326638&action=edit)

i found a vulnerability where user can fall for clickjacking to allow location permission

I tested on Firefox version 111.0.1 (64-bit)

steps to reproduce:

1. open <https://pipabajabakrie.com/upload/geofullscreen6.html>
2. Click the "try it" button. then it will appear in fullscreen mode
3. Quickly click the "try it" button 3 times without moving the mouse then the location permission will be allowed

I am attaching 2 videos. one video on firefox and another on chrome where in chrome the mouse click doesn't work in notification permission with same steps to reproduces

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1826116#c1)• 2 years ago |
|  | |

Attached video
[bandicam 2023-04-03 21-27-15-258.mp4](attachment.cgi?id=9326639)
— [Details](attachment.cgi?id=9326639&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1826116#c2)• 2 years ago |
|  | |

Attached file
[clickjacking.html](attachment.cgi?id=9326640)
— [Details](attachment.cgi?id=9326640&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a75257_159069)• 2 years ago |

Component: Security → Site Permissions

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1826116#c3)• 2 years ago |
|  | |

Is the security dialog activation delay on permission prompts gone? That was supposed to prevent exactly this kind of attack ([bug 162020](/show_bug.cgi?id=162020 "RESOLVED FIXED - pop up XPInstall/security dialog when user is about to click"))

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1826116#c4)• 2 years ago |
|  | |

I'm not overly concerned about location permission, and the particular testcase here doesn't work at all for any of us (spacing is way off, but fixable), but if it's the fault of the permission code it would apply to more serious permissions like camera/mic access, extension installs, etc.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1826116#c5)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #3](/show_bug.cgi?id=1826116#c3 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)"))

> Is the security dialog activation delay on permission prompts gone? That was supposed to prevent exactly this kind of attack ([bug 162020](/show_bug.cgi?id=162020 "RESOLVED FIXED - pop up XPInstall/security dialog when user is about to click"))

I don't know. 302 Paul who knows this code better than I do. <https://searchfox.org/mozilla-central/rev/da8f8e5fd1cc02a9be7ce26b7d3f91deb18159bf/toolkit/modules/PopupNotifications.sys.mjs#1872-1879> certainly still looks like it's there.

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(pbz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1826116#c6)• 2 years ago |
|  | |

Attached file
[camera.html](attachment.cgi?id=9327261)
— [Details](attachment.cgi?id=9327261&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1826116#c7)• 2 years ago |
|  | |

poc for camera permission

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1826116#c8)• 2 years ago |
|  | |

The test cases presented so far don't seem very reliable. I can't get them to work on my machine at all (both Ubuntu and Windows10). May require specific positioning for different resolutions or OS. Also the attacker would need to get the user to spam-click the button.

Testing the clickjacking delay manually on <https://permission.site> it works fine and logs:

```
PopupNotifications._onButtonEvent: Button click happened before the security delay: 276.8355469999806ms

```

The click jack delay is rather short, so perhaps we're running over that.

Reporter, could you set the pref `security.notification_enable_delay` to a higher number, like `5000` (5 seconds) to see if the issue still reproduces? I want to find out if this is bypassing our delay mechanism. Thanks!

I'm also wondering if it has to do with the way we remove PopupNotifications when entering fullscreen or how we leave fullscreen when a PopupNotification is shown.

Flags: needinfo?(pbz) → needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1826116#c9)• 2 years ago |
|  | |

Attached video
[setto5000.mp4](attachment.cgi?id=9327366)
— [Details](attachment.cgi?id=9327366&action=edit)

Flags: needinfo?(sas.kunz)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1826116#c10)• 2 years ago |
|  | |

Sorry I forgot to mention, you may need to restart Firefox after setting the pref in order for this to apply. Could you please check again? Much appreciated!

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1826116#c11)• 2 years ago |
|  | |

Attached video
[setto5000restart.mp4](attachment.cgi?id=9327367)
— [Details](attachment.cgi?id=9327367&action=edit)

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1826116#c12)• 2 years ago |
|  | |

Attached image
[mouse\_setting.jpg](attachment.cgi?id=9327368)
— [Details](attachment.cgi?id=9327368&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1826116#c13)• 2 years ago |
|  | |

Attached image
[specificationlaptop.jpg](attachment.cgi?id=9327369)
— [Details](attachment.cgi?id=9327369&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1826116#c14)• 2 years ago |
|  | |

i use v-track gaming mouse f4

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1826116#c15)• 2 years ago |
|  | |

Attached video
[camerapermission.mp4](attachment.cgi?id=9327372)
— [Details](attachment.cgi?id=9327372&action=edit)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1826116#c16)• 2 years ago |
|  | |

Thank you, that's very helpful. So it looks like this bypasses the delay somehow.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1826116#c17)• 2 years ago |
|  | |

Paul, are you still investigating this further based on the latest update from the reporter?

Flags: needinfo?(pbz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1826116#c18)• 2 years ago |
|  | |

Attached video
[bandicam 2023-04-15 18-25-44-428.mp4](attachment.cgi?id=9328666)
— [Details](attachment.cgi?id=9328666&action=edit)

i tested on other notebook , it is affected too . i tested on HP elitebook 830 G6 with same configuration. (WIndows 10 Pro 64 Bit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1826116#c19)• 2 years ago |
|  | |

I find it quite concerning if a rapid, well-positioned click can bypass our "security delay". Let's start with `sec-moderate`, but one could argue this is `sec-high` - especially if it uncovers that the delay is bypassable in our various other dialogs.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a1539542_636491)• 2 years ago |

Assignee: nobody → pbzSeverity: -- → S2Status: NEW → ASSIGNEDFlags: needinfo?(pbz)Priority: -- → P1

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1826116#c20)• 2 years ago |
|  | |

I can reproduce on a Windows 10 VM. The issue is here: <https://searchfox.org/mozilla-central/rev/a4fb94aab371d8650d194558c77879f5b8842380/toolkit/modules/PopupNotifications.sys.mjs#1871>

where `notification.timeShown` is `null` which leads to `timeSinceShown < buttonDelay` to always evaluate to `false`. Still investigating the root cause.

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1826116#c21)• 2 years ago |
|  | |

For the open call of the affected popup notification we run into this case: <https://searchfox.org/mozilla-central/rev/a4fb94aab371d8650d194558c77879f5b8842380/toolkit/modules/PopupNotifications.sys.mjs#1247,1266>

We assume that the panel is already open and thus skip the remaining open steps. Which means we never end up setting `n.timeShown` further down in that method: <https://searchfox.org/mozilla-central/rev/a4fb94aab371d8650d194558c77879f5b8842380/toolkit/modules/PopupNotifications.sys.mjs#1287>

I assume there is a race condition, since the PoC code causes \_showPanel to be called two times (while doing the fullscreen transition).

Generally I'm wondering if we could tie the `timeShown` timestamp closer to the actual show call. That would make the code a lot more resilient against these types of attacks.

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1826116#c22)• 2 years ago |
|  | |

Attached file
[Bug 1826116 r=Gijs!](attachment.cgi?id=9329740)
— [Details](attachment.cgi?id=9329740&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a1575946_600971)• 2 years ago |

[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Attachment description: WIP: Bug 1826116 - Ensure notification.timeShown is set on PopupNotification button command. → WIP: Bug 1826116 - Ensure notification.timeShown is set before before PopupNotification button events.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a1575975_600971)• 2 years ago |

[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Attachment description: WIP: Bug 1826116 - Ensure notification.timeShown is set before before PopupNotification button events. → WIP: Bug 1826116 - Ensure notification.timeShown is set before PopupNotification button events.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a1886058_600971)• 2 years ago |

[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Attachment description: WIP: Bug 1826116 - Ensure notification.timeShown is set before PopupNotification button events. → Bug 1826116 - Ensure notification.timeShown is set before PopupNotification button events. r=Gijs!

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1826116#c23)• 2 years ago |
|  | |

I don't understand why it is set to sec-moderate, I have tried to bypass the camera permission and it worked and it also affected the other permissions

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1826116#c24)• 2 years ago |
|  | |

Attached file
[Bug 1826116 - Test r=Gijs!](attachment.cgi?id=9330606)
— [Details](attachment.cgi?id=9330606&action=edit)

Depends on D176174

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2072102_600971)• 2 years ago |

[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Attachment description: Bug 1826116 - Ensure notification.timeShown is set before PopupNotification button events. r=Gijs! → Bug 1826116 r=Gijs!

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2072637_636491)• 2 years ago |

[Attachment #9330606](/attachment.cgi?id=9330606&action=edit "Bug 1826116 - Test r=Gijs!") -
Flags: sec-approval?

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1826116#c25)• 2 years ago |
|  | |

Comment on [attachment 9329740](/attachment.cgi?id=9329740 "Bug 1826116 r=Gijs!") [[details]](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!")

[Bug 1826116](/show_bug.cgi?id=1826116 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)") r=Gijs!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The patch makes it obvious that there is a bug with our security delay in PopupNotifications. It does however not show the exact conditions that are needed in order for this to be exploited.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all supported branches (including ESR)
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Should be fairly easy to create backports if the patch doesn't apply as-is already.
* **How likely is this patch to cause regressions; how much testing does it need?**: There is the low risk of further breaking our security delay checks, because we updated our timestamp logic (timeShown). We have an automated test that covers the patch. The test has been verified locally.

Here is a try run (without the new test): <https://treeherder.mozilla.org/jobs?repo=try&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=e6775b4db0be61cbaed658af85fc2f123aa4c50c&selectedTaskRun=aN3D-CFASBeIrCPwN4G3Xw.0>

* **Is Android affected?**: No
[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Flags: sec-approval?

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1826116#c26)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1826116&comment_id=16388917 "1 revision") |
|  | |

[Tracking Requested - why for this release]: sec-medium, potential sec-high, may be worth getting into late Fx113 or RC. sec-approval pending above.

[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%3F)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1826116#c27)• 2 years ago |
|  | |

(In reply to Hafiizh from [comment #23](/show_bug.cgi?id=1826116#c23 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)"))

> I don't understand why it is set to sec-moderate, I have tried to bypass the camera permission and it worked and it also affected the other permissions

The camera/mic permission clearly raises the stakes--after all, that was the primary Flash POC that launched the very term "clickjacking".

But mainly this was rated moderate because the POCs didn't work against most of us which raises doubts about how reliable it could be. Also some thought the multiple clicks required were clunky and would be hard to elicit, greatly reducing the potential affected population. Personally I'm still concerned about the reliability of the click targeting on different systems (can you reliably detect the scaling factor in use?), but I have no trouble imagining a scenario where a victim *wants* to go into fullscreen (show a movie or game? there's one free click), and then interactive content (ok, not a movie) could come up with any number of reasons the user would want to click or double-click in the right spot.

sec-high is a reasonable rating.

You showed us a bunch of detail about your system and I may have missed it, but I didn't see the bits that I suspect are most relevant to the click targeting: your screen resolution and the "scaling factor" in your OS settings. I'm sure you can detect the screen resolution (especially once you know you're in fullscreen) but I'm less sure about scaling.

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B)
[tracking-firefox114](/buglist.cgi?f1=cf_tracking_firefox114&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [113+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=113%2B)Flags: needinfo?(sas.kunz)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1826116#c28)• 2 years ago |
|  | |

Comment on [attachment 9329740](/attachment.cgi?id=9329740 "Bug 1826116 r=Gijs!") [[details]](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!")

[Bug 1826116](/show_bug.cgi?id=1826116 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)") r=Gijs!

sec-approval a=dveditz for right now so we can get it into the 113 release

beta-uplift and ESR-102 uplift approved, a=dveditz

I don't believe we need a release branch approval as long as it lands before the RC branch is tagged.

[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Flags: sec-approval?
[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Flags: sec-approval+
[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Flags: approval-mozilla-esr102+
[Attachment #9329740](/attachment.cgi?id=9329740&action=edit "Bug 1826116 r=Gijs!") -
Flags: approval-mozilla-beta+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1826116#c29)• 2 years ago |
|  | |

Comment on [attachment 9330606](/attachment.cgi?id=9330606 "Bug 1826116 - Test r=Gijs!") [[details]](/attachment.cgi?id=9330606&action=edit "Bug 1826116 - Test r=Gijs!")

[Bug 1826116](/show_bug.cgi?id=1826116 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)") - Test r=Gijs!

This test looks un-revealing enough to land with the patch

[Attachment #9330606](/attachment.cgi?id=9330606&action=edit "Bug 1826116 - Test r=Gijs!") -
Flags: sec-approval?
[Attachment #9330606](/attachment.cgi?id=9330606&action=edit "Bug 1826116 - Test r=Gijs!") -
Flags: sec-approval+
[Attachment #9330606](/attachment.cgi?id=9330606&action=edit "Bug 1826116 - Test r=Gijs!") -
Flags: approval-mozilla-esr102+
[Attachment #9330606](/attachment.cgi?id=9330606&action=edit "Bug 1826116 - Test r=Gijs!") -
Flags: approval-mozilla-beta+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1826116#c30)• 2 years ago |
|  | |

> I don't believe we need a release branch approval as long as it lands before the RC branch is tagged.

Ideally land ASAP so we can get a bit of nightly testing over the weekend, but that could be problematic since it's a 4-day weekend for a lot of our European employees.

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1826116#c31)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1826116&comment_id=16389476 "1 revision") |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #30](/show_bug.cgi?id=1826116#c30 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)"))

> > I don't believe we need a release branch approval as long as it lands before the RC branch is tagged.
>
> Ideally land ASAP so we can get a bit of nightly testing over the weekend, but that could be problematic since it's a 4-day weekend for a lot of our European employees.

Thanks for the quick turnaround!

I had queued it on autoland shortly after approval: <https://hg.mozilla.org/integration/autoland/rev/edf238a3c42594f877ab3094aac3cb024fe7d653>

Hasn’t landed yet.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1826116#c32)• 2 years ago |
|  | |

Landed:

<https://hg.mozilla.org/integration/autoland/rev/edf238a3c42594f877ab3094aac3cb024fe7d653>

<https://hg.mozilla.org/integration/autoland/rev/4b3e3f8ff22ec6c70d792bedf72d0a5b583895d3>

Backed out for causing bc failures in browser\_popupNotification\_security\_delay.js:

<https://hg.mozilla.org/integration/autoland/rev/b102da10b16823efed532ce69484071b3b98edae>

[Push with failure](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=RqEdJJ5kR2CwWiUQfh4qiQ.0&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=4b3e3f8ff22ec6c70d792bedf72d0a5b583895d3)

[Failure log](https://treeherder.mozilla.org/logviewer?job_id=414029462&repo=autoland)

```
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - TEST-PASS | browser/base/content/test/popupNotifications/browser_popupNotification_security_delay.js | at least one notification displayed -
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - Triggering main command for notification foo-notification
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - Buffered messages finished
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - TEST-UNEXPECTED-FAIL | browser/base/content/test/popupNotifications/browser_popupNotification_security_delay.js | PopupNotification should still be open. -
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - Stack trace:
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - chrome://mochikit/content/browser-test.js:test_ok:1584
[task 2023-04-27T21:22:44.253Z] 21:22:44     INFO - chrome://mochitests/content/browser/browser/base/content/test/popupNotifications/browser_popupNotification_security_delay.js:test_timeShownMultipleNotifications:129

```
Flags: needinfo?(pbz)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1826116#c33)• 2 years ago |
|  | |

I re-landed just D176174 given the time pressures here.

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1826116#c34)• 2 years ago |
|  | |

r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/5ad4faf072188938989cf493a69ec38c768d1807>

<https://hg.mozilla.org/mozilla-central/rev/5ad4faf07218>

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1826116#c35)• 2 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #33](/show_bug.cgi?id=1826116#c33 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)"))

> I re-landed just D176174 given the time pressures here.

Thank you! The test passes on its own (tested on Ubuntu, macOS, Win10), just not when running the entire folder. Seems fine to land next week.

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1826116#c36)• 2 years ago |
|  | |

Attached image
[resolutionandscalefactor.png](attachment.cgi?id=9330816)
— [Details](attachment.cgi?id=9330816&action=edit)

the display resolution is 1920x1080 and the scale factor :125 (on MSI A11SB)

Flags: needinfo?(sas.kunz)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1826116#c37)• 2 years ago |
|  | |

Thinking about this more, I'm closing the bug to reflect that the actual fix did land (which will also make uplift tracking easier as we're going into RC week). We can either land the test here still or spin that off into another bug - whatever you prefer, Paul.

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=fixed)Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)Resolution: --- → FIXEDTarget Milestone: --- → 114 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1826116#c38)• 2 years ago |
| uplift | |

Landed for 113.0rc1 and 102.11esr.

<https://hg.mozilla.org/releases/mozilla-beta/rev/c4479291ff86>

<https://hg.mozilla.org/releases/mozilla-esr102/rev/8e1b5870b322>

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2447086_486634)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main113+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2448297_486634)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main113+] → [reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+]

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2477455_551058)• 2 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2479978_553429)• 2 years ago |

QA Whiteboard: [qa-triaged]

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1826116#c39)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1826116&comment_id=16393639 "3 revisions") |
|  | |

Attached image
[perm\_00.gif](attachment.cgi?id=9331121)
— [Details](attachment.cgi?id=9331121&action=edit)

Reproduced the issue with Firefox 111.0.1 and 112.0.2 on Windows 10x64 by following steps from [comment 0](/show_bug.cgi?id=1826116#c0 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)") while the browser was fullscreen. The location access is granted after clicking the Try it button multiple times.

I can no longer reproduce the issue by following the above steps while fullscreen with Firefox 113.0RC1, 102.11.0esr and Firefox 114.0a1 (2023-05-01) on macOS 12, Windows 10x64 and Ubuntu 20.04.

However just to be safe of the current behavior here. Before this patch, the permission door hanger was moved under the address bar after clicking the Try It button. Therefore, clicking multiple times will allow the location permission in this case. On the latest builds the permission door hanger is displayed on the top-left side of the screen after following the steps from [comment 0](/show_bug.cgi?id=1826116#c0 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)"). Is this the expected behavior or should I look for something else in order to verify this issue? (attached a screen rec from win10x64)

Also as a side note on Ubuntu 20.04 the permission door hanger is still moved under the address bar for 113.0RC1 and Firefox 114.0a1 (2023-05-01) but the issue cannot be reproduced. Clicking multiple times will result in checking/unchecking the Remember this decision option. Is this expected? Thank you in advance!

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1826116#c40)• 2 years ago |
|  | |

Attached image
[Peek 2023-05-02 13-45.gif](attachment.cgi?id=9331122)
— [Details](attachment.cgi?id=9331122&action=edit)

This is the behavior on Ubuntu 20.04.

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1826116#c41)• 2 years ago |
|  | |

The patch does not change the location of the PopupNotification doorhanger. The fact that it gets anchored weirdly after a fullscreen exit is a pre-existing bug (I can't find the bug right now). For this bug we're mostly concerned about bypassing the security delay, so if you can't get the notification buttons to line up with the try-it button I recommend testing it like this:

1. Set `security.notification_enable_delay` to `5000` (5 seconds) via `about:config`
2. Restart the browser for the pref to apply
3. Use the PoC code and spam the try-it button in full-screen until the notification is shown.
4. Quickly click the "allow" button of the notification

With patch:

Within the 5 seconds window after fullscreen exit the button should not close the notification. After 5 seconds it should work as usual and close the notification, granting the requested permission.

Without patch:

Click on the button directly closes the notification (also before the 5 second timer runs out)

Flags: needinfo?(pbz) → needinfo?(alexandru.trif)

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1826116#c42)• 2 years ago |
|  | |

Oh, I understand now. Thank you very much for the detailed information. I have managed to reproduce the issue by following the str from [comment 41](/show_bug.cgi?id=1826116#c41 "VERIFIED FIXED - Clickjacking to allowed location permission (bypassing button-enable delay)") on Windows 10x64 with Firefox 112.0.2 and 113.0a1 (2023-04-03) by having the button aligned and unaligned with the Try It button. The permission can be granted before reaching 5 seconds after spamming the try-it button in fullscreen.

The issue is verified fixed with Firefox 113.0RC1, 114.0a1 (2023-05-01) and 102.11.0esr on Windows 10x64, macOS 12 and Ubuntu 20.04. The permission is no longer confirmed after spamming the try-it button in fullscreen and then clicking the allow button of the notification before reaching 5 seconds.

Status: RESOLVED → VERIFIEDHas STR: --- → yesQA Whiteboard: [qa-triaged]
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=verified)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=verified)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(alexandru.trif)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2519617_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+Summary: Clickjacking to allowed location permission → Clickjacking to allowed location permission (bypassing button-enable delay)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1826116#c43)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9331271)
— [Details](attachment.cgi?id=9331271&action=edit)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1826116#c44)• 2 years ago |
|  | |

Test r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/2478df336d8cae55e8c4fbffe8b5726ab0956674>

<https://hg.mozilla.org/mozilla-central/rev/2478df336d8c>

Flags: in-testsuite+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2684071_578488)• 2 years ago |

Alias: CVE-2023-32207

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1826116#c45)• 2 years ago |
|  | |

is there any decision how many bounties that i receive?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a2695921_694415)• 2 years ago |

Flags: needinfo?(dveditz)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a3115372_578488)• 2 years ago |

Flags: needinfo?(dveditz)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a6894425_636491)• 2 years ago |

Regressions: [CVE-2023-4047](/show_bug.cgi?id=1839073 "VERIFIED FIXED - Bypass site permission clickjacking protections on Desktop by opening a new tab with window.open() and closing it after the permission timeout has expired")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a7453129_1689)• 2 years ago |

See Also: → [1840785](/show_bug.cgi?id=1840785 "RESOLVED DUPLICATE - Firefox Browser Desktop Permission Prompt Tapjacking")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a17068259_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a21273262_1689)• 1 year ago |

See Also: → [1865465](/show_bug.cgi?id=1865465 "RESOLVED DUPLICATE - PopupNotifications Clickjacking: Bypass full screen prompt restrictions (Bug 1522120) and extended security delay (Bug 1857430)")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a36559789_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1826116#a36844122_1689)• 8 months ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---) → [csectype-clickjacking](/buglist.cgi?keywords=csectype-clickjacking&resolution=---)
You need to [log in](/show_bug.cgi?id=1826116&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


