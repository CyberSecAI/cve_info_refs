=== Content from research.splunk.com_007ec2a5_20250114_194024.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk DOS Via Dump SPL Command

Updated Date: 2024-10-17
ID: fb0e6823-365f-48ed-b09e-272ac4c1dad6
Author: Rod Soto
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies a potential Denial of Service (DoS) attack exploiting the dump SPL command in vulnerable Splunk Enterprise versions. It detects this activity by searching the `splunk_crash_log` for segmentation fault entries, indicating a crash of the Splunk daemon. This activity is significant for a SOC because it can disrupt the availability of Splunk services, impacting monitoring and incident response capabilities. If confirmed malicious, this attack could render Splunk Enterprise unusable, severely hindering an organization's ability to detect and respond to other security threats.

### Search

```
1`splunk_crash_log` "*Segmentation fault*"
2| stats count by host _time
3| `splunk_dos_via_dump_spl_command_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunk\_crash\_log](https://github.com/splunk/security_content/blob/develop/macros/splunk_crash_log.yml) | `(index=_internal AND sourcetype=splunkd_crash_log)` |
| splunk\_dos\_via\_dump\_spl\_command\_filter | `search *` |

`splunk_dos_via_dump_spl_command_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1499.004](https://attack.mitre.org/techniques/T1499/004/) | Application or System Exploitation | Impact |

KillChainPhase.ACTIONS\_ON\_OBJECTIVES

NistCategory.DE\_AE

Cis18Value.CIS\_10

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

This search does not require additional ingestion of data. Requires the ability to search \_internal index and monitor segmentation faults.

### Known False Positives

Segmentation faults may occur due to other causes, so this search may produce false positives

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Possible denial of service attack with Victim $host$ | 100 | 100 | 100 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1499.004/splunk/splunk_dos_via_dump_spl_command.log) | `/opt/splunk/var/log/splunk/splunkd.log` | `splunkd_crash_log` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1499.004/splunk/splunk_dos_via_dump_spl_command.log) | `/opt/splunk/var/log/splunk/splunkd.log` | `splunkd_crash_log` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_dos_via_dump_spl_command.yml) |
Version: **3**

[Detection: Splunk DoS Using Malformed SAML Request](https://research.splunk.com/application/8e8a86d5-f323-4567-95be-8e817e2baee6/ "Detection: Splunk DoS Using Malformed SAML Request")

[Detection: Splunk DoS via POST Request Datamodel Endpoint](https://research.splunk.com/application/45766810-dbb2-44d4-b889-b4ba3ee0d1f5/ "Detection: Splunk DoS via POST Request Datamodel Endpoint")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_02343ed6_20250114_194023.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Denial of Service via the 'dump' SPL command

**Advisory ID:** SVD-2023-0611

**CVE ID:** [CVE-2023-32716](https://www.cve.org/CVERecord?id=CVE-2023-32716)

**Published:** 2023-06-01

**Last Update:** 2023-06-01

**CVSSv3.1 Score:** 6.5, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H)

**CWE:** [CWE-754](https://cwe.mitre.org/data/definitions/754.html)

**Bug ID:** SPL-235572

## Description

An attacker can exploit a vulnerability in the ‘dump’ SPL command to cause a denial of service by crashing the Splunk daemon. If the attacker supplies a longer-than-expected filename with the command, a memory access violation, or segmentation fault, occurs, which results in a crash of the Splunk platform instance.

## Solution

For Splunk Enterprise, upgrade to versions 9.0.5, 8.2.11, 8.1.14, and higher.

For Splunk Cloud Platform, Splunk is actively monitoring and patching affected instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.1 | Splunk Web | 8.1.0 to 8.1.13 | 8.1.14 |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.10 | 8.2.11 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.4 | 9.0.5 |
| Splunk Cloud Platform |  | Splunk Web | 9.0.2303 and below | 9.0.2303.100 |

## Mitigations and Workarounds

Remove the ‘run\_dump’ capability from any roles that users hold.

## Detections

* [Splunk DoS via dump SPL command](https://research.splunk.com/application/fb0e6823-365f-48ed-b09e-272ac4c1dad6/)

This hunting detection search provides information about possible denial of service exploitation attempts in Splunk Enterprise versions below 9.0.5, 8.2.11, and 8.1.14.

## Severity

Splunk rated this vulnerability as Medium, 6.5, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H.

## Acknowledgments

Danylo Dmytriiev (DDV\_UA)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
