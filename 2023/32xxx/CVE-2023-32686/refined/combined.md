=== Content from kiwitcms.org_ab60c189_20250114_195230.html ===

[![Kiwi TCMS Logo](/theme/images/Kiwi-TCMS-logo-header.svg)](/)

[![Kiwi TCMS Logo](/theme/images/Kiwi-TCMS-logo-header.svg)](/)
* [Features](/features/)
* [Documentation](http://kiwitcms.readthedocs.io)
* [Community](/community/)
* [Support](/support/)
* [Blog](/blog/)
* [Team](/team/)

* [Features](/features/)
* [Documentation](http://kiwitcms.readthedocs.io)
* [Community](/community/)
* [Support](/support/)
* [Blog](/blog/)
* [Team](/team/)
* Get Started

  [Explore latest version](https://public.tenant.kiwitcms.org)
  [Explore subscriptions](/#subscriptions)
  [Run as Docker container](https://kiwitcms.readthedocs.io/en/latest/installing_docker.html)
  [Integration with GitHub](https://github.com/marketplace/kiwi-tcms/)

# Kiwi TCMS 12.3

## security updates, general improvements and new translations

Posted by
[Kiwi TCMS Team](https://kiwitcms.org/blog/kiwi-tcms-team/)
on Mon 22 May 2023
under
[releases](https://kiwitcms.org/blog/tags/releases/)

We're happy to announce Kiwi TCMS version 12.3!

**IMPORTANT:** this is a small release which contains security related updates,
general improvements and new translations!

You can explore everything at
[https://public.tenant.kiwitcms.org](https://public.tenant.kiwitcms.org/)!

> Supported upgrade paths:
>
> ```
>
> 5.3   (or older) -> 5.3.1
> 5.3.1 (or newer) -> 6.0.1
> 6.0.1            -> 6.1
> 6.1              -> 6.1.1
> 6.1.1            -> 6.2 (or newer)
>
> ```

---

> Upstream container images (x86\_64):
>
> ```
>
> kiwitcms/kiwi   latest  1cbaba8640d9    594MB
>
> ```

**IMPORTANT:** version tagged and multi-arch
[container](/containers/) images are available only to
[subscribers](/#subscriptions)!

## Changes since Kiwi TCMS 12.2

### Security

* Update Django from 4.1.8 to 4.2.1 which contains a fix for
  [CVE-2023-31047](https://docs.djangoproject.com/en/4.2/releases/4.2.1/).
  We believe this does not affect Kiwi TCMS
* Implement better scanning for embedded <script> tags in uploaded files
* Force Content-Type: text/plain when serving uploaded files. See
  [GHSA-x7c2-7wvg-jpx7](https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-x7c2-7wvg-jpx7)
* Explicitly configure top-level permissions for CI jobs as read-all
* Pass untrusted input via intermediate ENV variables in CI jobs

### Improvements

* Update nginx from 1.20 to 1.22
* Update django-grappelli from 3.0.5 to 3.0.6
* Update pygithub from 1.58.1 to 1.58.2
* Add Helm chart examples (Michael Abramovich)

### Refactoring and testing

* Update node\_modules/webpack-cli from 5.0.1 to 5.1.1
* Update node\_modules/webpack from 5.80.0 to 5.83.1
* Update node\_modules/eslint from 8.38.0 to 8.40.0
* Update tests/bugzilla/fedora from 37 to 38
* Enable the checkov static linter

### Translations

* Updated [Russian translation](https://crowdin.com/project/kiwitcms/ru)

## Kiwi TCMS Enterprise v12.3-mt

* Based on Kiwi TCMS v12.3
* Update dj-database-url from 1.3.0 to 2.0.0
* Update django-ses from 3.3.0 to 3.5.0
* Update kiwitcms-tenants from 2.5.0 to 2.5.1
* Explicitly set permissions to read-all
* Enable checkov linter

  > Private images:
  >
  > ```
  >
  > quay.io/kiwitcms/version            12.3 (aarch64)          8bf8cd56c565    22 May 2023     601MB
  > quay.io/kiwitcms/version            12.3 (x86_64)           1cbaba8640d9    22 May 2023     592MB
  > quay.io/kiwitcms/enterprise         12.3-mt (aarch64)       36d6670c3fca    22 May 2023     845MB
  > quay.io/kiwitcms/enterprise         12.3-mt (x86_64)        e769e6bdb5c1    22 May 2023     835MB
  >
  > ```

**IMPORTANT:** version tagged, multi-arch and Enterprise
[container](/containers/) images are available only to
[subscribers](/#subscriptions)!

## How to upgrade

[Backup](/blog/atodorov/2018/07/30/how-to-backup-docker-volumes-for-kiwi-tcms/) first!
Then execute the commands:

```

cd path/containing/docker-compose/
docker-compose down
docker-compose pull
docker-compose up -d
docker exec -it kiwi_web /Kiwi/manage.py upgrade

```

Refer to
[our documentation](https://kiwitcms.readthedocs.io/en/latest/installing_docker.html#upgrading)
for more details!

Happy testing!

---

If you like what we're doing and how Kiwi TCMS supports various communities
please help us grow!

* [Give ‚≠ê on GitHub](https://github.com/kiwitcms/Kiwi/stargazers);
* [Give üëç on GitLab](https://gitlab.com/gitlab-org/gitlab/-/issues/334558);
* [Donate via Open Collective](https://opencollective.com/kiwitcms/donate) as low as 1 EUR;
* [Join our newsletter](https://kiwitcms.us17.list-manage.com/subscribe/post?u=9b57a21155a3b7c655ae8f922&id=c970a37581)
  and follow all project news;
* [Become a contributor](https://kiwitcms.readthedocs.io/en/latest/contribution.html)
  and an awesome open source hacker;
* [Become a subscriber](/#subscriptions) and help us sustain development

Please enable JavaScript to view the comments

![](/theme/images/Kiwi-TCMS-logo-footer.svg)

Kiwi TCMS is collecting donations via [Open Collective](https://opencollective.com/kiwitcms).

Except where otherwise noted, content on this site is licensed under a
[Creative Commons Attribution 4.0 International license.](https://creativecommons.org/licenses/by/4.0/)

[Legal](/legal/) |
[Privacy](/privacy/) |
[Terms](/terms/)

### Contribute

[/kiwitcms](https://github.com/kiwitcms/Kiwi)

### Follow

[@KiwiTCMS](https://twitter.com/KiwiTCMS)

### Watch

[Kiwi TCMS](https://www.youtube.com/channel/UCC0KsZRFkF8nhPnES8G-KYw/videos)

### Join

[r/KiwiTCMS](https://www.reddit.com/r/KiwiTCMS/)

### Join our newsletter.

Project news only, GDPR compliant.

[Sign me up](https://kiwitcms.us17.list-manage.com/subscribe/post?u=9b57a21155a3b7c655ae8f922&id=c970a37581)



=== Content from github.com_7af0a980_20250114_195227.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkiwitcms%2FKiwi%2Fsecurity%2Fadvisories%2FGHSA-x7c2-7wvg-jpx7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkiwitcms%2FKiwi%2Fsecurity%2Fadvisories%2FGHSA-x7c2-7wvg-jpx7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=kiwitcms%2FKiwi)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kiwitcms](/kiwitcms)
/
**[Kiwi](/kiwitcms/Kiwi)**
Public

* [Notifications](/login?return_to=%2Fkiwitcms%2FKiwi) You must be signed in to change notification settings
* [Fork
  296](/login?return_to=%2Fkiwitcms%2FKiwi)
* [Star
   999](/login?return_to=%2Fkiwitcms%2FKiwi)

* [Code](/kiwitcms/Kiwi)
* [Issues
  130](/kiwitcms/Kiwi/issues)
* [Pull requests
  13](/kiwitcms/Kiwi/pulls)
* [Actions](/kiwitcms/Kiwi/actions)
* [Projects
  1](/kiwitcms/Kiwi/projects)
* [Security](/kiwitcms/Kiwi/security)
* [Insights](/kiwitcms/Kiwi/pulse)

Additional navigation options

* [Code](/kiwitcms/Kiwi)
* [Issues](/kiwitcms/Kiwi/issues)
* [Pull requests](/kiwitcms/Kiwi/pulls)
* [Actions](/kiwitcms/Kiwi/actions)
* [Projects](/kiwitcms/Kiwi/projects)
* [Security](/kiwitcms/Kiwi/security)
* [Insights](/kiwitcms/Kiwi/pulse)

# Stored XSS via unrestricted files upload

High

[atodorov](/atodorov)
published
GHSA-x7c2-7wvg-jpx7
May 21, 2023

## Package

Kiwi TCMS

## Affected versions

<=12.2

## Patched versions

12.3

pip

kiwitcms
([pip](/advisories?query=ecosystem%3Apip))

<=12.2

12.3

## Description

### Impact

Kiwi TCMS allows users to upload attachments to test plans, test cases, etc. Earlier versions of Kiwi TCMS had introduced upload validators in order to prevent potentially dangerous files from being uploaded, see [GHSA-fwcf-753v-fgcj](https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-fwcf-753v-fgcj) and Content-Security-Policy definition to prevent cross-site-scripting attacks, see [GHSA-2wcr-87wf-cf9j](https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j).

The upload validation checks were not robust enough which left the possibility of an attacker to circumvent them and upload a potentially dangerous file. Exploting this flaw a combination of files could be uploaded so that they work together to circumvent the existing Content-Security-Policy and allow execution of arbitrary JavaScript in the browser.

### Patches

* File upload validation code has been improved
* Kiwi TCMS will now force `Content-Type: text/plain` when serving uploaded files

### Workarounds

1. Force the Content-Type header via a custom Django middleware, see `ExtraHeadersMiddleware` in <https://github.com/kiwitcms/Kiwi/blob/master/tcms/core/middleware.py#L23> and/or
2. Force the Content-Type header via Nginx overrides, see `location /uploads/` in <https://github.com/kiwitcms/Kiwi/blob/master/etc/nginx.conf>

### References

Disclosed by [Antonio Spataro](https://huntr.dev/bounties/db75275f-8bcd-482b-ae12-feff660d4794) and [ek1ng](https://huntr.dev/bounties/46d5b535-bdff-4b98-8691-a907591fcf10/). Additional credits to [Ahmed Rabeaa Mosa](https://huntr.dev/bounties/cbc2676a-90ff-457f-9cdc-2a7981f960f3/).

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N

### CVE ID

CVE-2023-32686

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79) [CWE-434](/advisories?query=cwe%3A434)

### Credits

* [![@antoniospataro](https://avatars.githubusercontent.com/u/44066875?s=40&v=4)](/antoniospataro)
  [antoniospataro](/antoniospataro)
  Analyst
* [![@mosaa404](https://avatars.githubusercontent.com/u/43794501?s=40&v=4)](/mosaa404)
  [mosaa404](/mosaa404)
  Analyst
* [![@ek1ng](https://avatars.githubusercontent.com/u/72065582?s=40&v=4)](/ek1ng)
  [ek1ng](/ek1ng)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


