=== Content from github.com_9c878dbf_20250115_102228.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fcommit%2F1328274e1a3d04ab87d7daee90229ff47b3bc35e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fcommit%2F1328274e1a3d04ab87d7daee90229ff47b3bc35e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=saleor%2Fsaleor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[saleor](/saleor)
/
**[saleor](/saleor/saleor)**
Public

* [Notifications](/login?return_to=%2Fsaleor%2Fsaleor) You must be signed in to change notification settings
* [Fork
  5.5k](/login?return_to=%2Fsaleor%2Fsaleor)
* [Star
   21k](/login?return_to=%2Fsaleor%2Fsaleor)

* [Code](/saleor/saleor)
* [Issues
  295](/saleor/saleor/issues)
* [Pull requests
  48](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects
  1](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

Additional navigation options

* [Code](/saleor/saleor)
* [Issues](/saleor/saleor/issues)
* [Pull requests](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

## Commit

[Permalink](/saleor/saleor/commit/1328274e1a3d04ab87d7daee90229ff47b3bc35e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add webhooks logic

[Browse files](/saleor/saleor/tree/1328274e1a3d04ab87d7daee90229ff47b3bc35e)
Browse the repository at this point in the history

* Loading branch information

[![@IKarbowiak](https://avatars.githubusercontent.com/u/40886528?s=40&v=4)](/IKarbowiak)

Maciej Korycinski
authored and
[IKarbowiak](/saleor/saleor/commits?author=IKarbowiak "View all commits by IKarbowiak")
committed
Jul 28, 2020

1 parent
[77c9484](/saleor/saleor/commit/77c9484c2585a845aa7b675fbebb08949601dd4c)

commit 1328274

 Show file tree

 Hide file tree

Showing
**9 changed files**
with
**554 additions**
and
**16 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* saleor

  + graphql

    - saleor/graphql/schema.graphql
      [schema.graphql](#diff-0de7d822ed8c0bc0dc7b823b647b689cad8ce15c8e9b5784b6c89a5b9fc16236)
  + order

    - saleor/order/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-5dd70f650a921ae560d999017909c4eef293777e67a6158f05607255892643cd)
    - saleor/order/events.py
      [events.py](#diff-d69e2aba76cd715d7585b2e9efdced294f7403da6610aae1509da56949483ed2)
  + payment

    - saleor/payment/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-bd3c88e9f54c9e10abef04d44c753678419ccb5beda78e10972051ac3acfd64c)
    - gateways/adyen

      * saleor/payment/gateways/adyen/plugin.py
        [plugin.py](#diff-a3f01c70c83748f7ea71b9b5d31ec2e41633996c11e514384bc89ba6a6868349)
      * saleor/payment/gateways/adyen/utils.py
        [utils.py](#diff-bc5653fc2a33917a227e6e77ce951b9e6daf97ff63aba93bcc1441ef8278cf28)
      * saleor/payment/gateways/adyen/webhooks.py
        [webhooks.py](#diff-d3d82ee962d3105a5b11e276de233912bbcc524c5ee827b965a8082231914b5b)
    - migrations

      * saleor/payment/migrations/0019\_auto\_20200721\_1313.py
        [0019\_auto\_20200721\_1313.py](#diff-6edf6b8820e93ea47c335b6a792539fa1b9673833483eea1ba8bbc437f1ccd4e)
    - saleor/payment/utils.py
      [utils.py](#diff-d236b14a274fe4e7a0a8db63f9fbfd0b39e61484e371e5410fd32250fcde75ba)

## There are no files selected for viewing

10 changes: 8 additions & 2 deletions

10
[saleor/graphql/schema.graphql](#diff-0de7d822ed8c0bc0dc7b823b647b689cad8ce15c8e9b5784b6c89a5b9fc16236 "saleor/graphql/schema.graphql")

Show comments

[View file](/saleor/saleor/blob/1328274e1a3d04ab87d7daee90229ff47b3bc35e/saleor/graphql/schema.graphql)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2750,7 +2750,7 @@ type Mutation { |
|  |  | exportProducts(input: ExportProductsInput!): ExportProducts |
|  |  | checkoutAddPromoCode(checkoutId: ID!, promoCode: String!): CheckoutAddPromoCode |
|  |  | checkoutBillingAddressUpdate(billingAddress: AddressInput!, checkoutId: ID!): CheckoutBillingAddressUpdate |
|  |  | checkoutComplete(checkoutId: ID!, redirectUrl: String, storeSource: Boolean = false): CheckoutComplete |
|  |  | checkoutComplete(checkoutId: ID!, paymentData: JSONString, redirectUrl: String, storeSource: Boolean = false): CheckoutComplete |
|  |  | checkoutCreate(input: CheckoutCreateInput!): CheckoutCreate |
|  |  | checkoutCustomerAttach(checkoutId: ID!, customerId: ID): CheckoutCustomerAttach |
|  |  | checkoutCustomerDetach(checkoutId: ID!): CheckoutCustomerDetach |
| Expand Down  Expand Up | | @@ -3063,6 +3063,7 @@ enum OrderEventsEnum { |
|  |  | EMAIL\_SENT |
|  |  | PAYMENT\_AUTHORIZED |
|  |  | PAYMENT\_CAPTURED |
|  |  | PAYMENT\_GATEWAY\_NOTIFICATION |
|  |  | PAYMENT\_REFUNDED |
|  |  | PAYMENT\_VOIDED |
|  |  | PAYMENT\_FAILED |
| Expand Down  Expand Up | | @@ -3387,10 +3388,13 @@ type PaymentCapture { |
|  |  |  |
|  |  | enum PaymentChargeStatusEnum { |
|  |  | NOT\_CHARGED |
|  |  | PENDING |
|  |  | PARTIALLY\_CHARGED |
|  |  | FULLY\_CHARGED |
|  |  | PARTIALLY\_REFUNDED |
|  |  | FULLY\_REFUNDED |
|  |  | REFUSED |
|  |  | CANCELLED |
|  |  | } |
|  |  |  |
|  |  | type PaymentCountableConnection { |
| Expand Down  Expand Up | | @@ -3435,7 +3439,6 @@ type PaymentGateway { |
|  |  | input PaymentInput { |
|  |  | gateway: String! |
|  |  | token: String |
|  |  | paymentData: JSONString |
|  |  | amount: Decimal |
|  |  | billingAddress: AddressInput |
|  |  | } |
| Expand Down  Expand Up | | @@ -5023,10 +5026,13 @@ enum TransactionError { |
|  |  |  |
|  |  | enum TransactionKind { |
|  |  | AUTH |
|  |  | PENDING |
|  |  | REFUND |
|  |  | REFUND\_ONGOING |
|  |  | CAPTURE |
|  |  | VOID |
|  |  | CONFIRM |
|  |  | CANCEL |
|  |  | } |
|  |  |  |
|  |  | union TranslatableItem = ProductTranslatableContent | CollectionTranslatableContent | CategoryTranslatableContent | AttributeTranslatableContent | AttributeValueTranslatableContent | ProductVariantTranslatableContent | PageTranslatableContent | ShippingMethodTranslatableContent | SaleTranslatableContent | VoucherTranslatableContent | MenuItemTranslatableContent |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[saleor/order/\_\_init\_\_.py](#diff-5dd70f650a921ae560d999017909c4eef293777e67a6158f05607255892643cd "saleor/order/__init__.py")

Show comments

[View file](/saleor/saleor/blob/1328274e1a3d04ab87d7daee90229ff47b3bc35e/saleor/order/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,6 +51,7 @@ class OrderEvents: |
|  |  | PAYMENT\_REFUNDED = "payment\_refunded" |
|  |  | PAYMENT\_VOIDED = "payment\_voided" |
|  |  | PAYMENT\_FAILED = "payment\_failed" |
|  |  | PAYMENT\_GATEWAY\_NOTIFICATION = "payment\_gateway\_notification" |
|  |  |  |
|  |  | INVOICE\_REQUESTED = "invoice\_requested" |
|  |  | INVOICE\_GENERATED = "invoice\_generated" |
| Expand Down  Expand Up | | @@ -80,6 +81,7 @@ class OrderEvents: |
|  |  | (EMAIL\_SENT, "The email was sent"), |
|  |  | (PAYMENT\_AUTHORIZED, "The payment was authorized"), |
|  |  | (PAYMENT\_CAPTURED, "The payment was captured"), |
|  |  | (PAYMENT\_GATEWAY\_NOTIFICATION, "Notification from payment gateway"), |
|  |  | (PAYMENT\_REFUNDED, "The payment was refunded"), |
|  |  | (PAYMENT\_VOIDED, "The payment was voided"), |
|  |  | (PAYMENT\_FAILED, "The payment was failed"), |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[saleor/order/events.py](#diff-d69e2aba76cd715d7585b2e9efdced294f7403da6610aae1509da56949483ed2 "saleor/order/events.py")

Show comments

[View file](/saleor/saleor/blob/1328274e1a3d04ab87d7daee90229ff47b3bc35e/saleor/order/events.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -260,6 +260,24 @@ def payment\_failed\_event( |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def payment\_gateway\_notification\_event( |
|  |  | \*, order: Order, user: UserType, message: str, payment: Payment |
|  |  | ) -> OrderEvent: |
|  |  | if not \_user\_is\_valid(user): |
|  |  | user = None |
|  |  | parameters = {"message": message} |
|  |  |  |
|  |  | if payment: |
|  |  | parameters.update({"gateway": payment.gateway, "payment\_id": payment.token}) |
|  |  |  |
|  |  | return OrderEvent.objects.create( |
|  |  | order=order, |
|  |  | type=OrderEvents.PAYMENT\_GATEWAY\_NOTIFICATION, |
|  |  | user=user, |
|  |  | parameters=parameters, |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def fulfillment\_canceled\_event( |
|  |  | \*, order: Order, user: UserType, fulfillment: Fulfillment |
|  |  | ) -> OrderEvent: |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[saleor/payment/\_\_init\_\_.py](#diff-bd3c88e9f54c9e10abef04d44c753678419ccb5beda78e10972051ac3acfd64c "saleor/payment/__init__.py")

Show comments

[View file](/saleor/saleor/blob/1328274e1a3d04ab87d7daee90229ff47b3bc35e/saleor/payment/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -59,11 +59,15 @@ class TransactionKind: |
|  |  |  |
|  |  | AUTH = "auth" |
|  |  | CAPTURE = "capture" |
|  |  | CAPTURE\_FAILED = "capture\_failed" |
|  |  | VOID = "void" |
|  |  | PENDING = "pending" |
|  |  | REFUND = "refund" |
|  |  | REFUND\_ONGOING = "refund\_ongoing" |
|  |  | REFUND\_FAILED = "refund\_failed" |
|  |  | REFUND\_REVERSED = "refund\_reversed" |
|  |  | CONFIRM = "confirm" |
|  |  | CANCEL = "cancel" |
|  |  | # FIXME we could use another status like WAITING\_FOR\_AUTH for transactions |
|  |  | # Which were authorized, but needs to be confirmed manually by staff |
|  |  | # eg. Braintree with "submit\_for\_settlement" enabled |
| Expand All | | @@ -75,6 +79,7 @@ class TransactionKind: |
|  |  | (CAPTURE, "Capture"), |
|  |  | (VOID, "Void"), |
|  |  | (CONFIRM, "Confirm"), |
|  |  | (CANCEL, "Cancel"), |
|  |  | ] |
|  |  |  |
|  |  |  |
| Expand All | | @@ -97,6 +102,8 @@ class ChargeStatus: |
|  |  | FULLY\_CHARGED = "fully-charged" |
|  |  | PARTIALLY\_REFUNDED = "partially-refunded" |
|  |  | FULLY\_REFUNDED = "fully-refunded" |
|  |  | REFUSED = "refused" |
|  |  | CANCELLED = "cancelled" |
|  |  |  |
|  |  | CHOICES = [ |
|  |  | (NOT\_CHARGED, "Not charged"), |
| Expand All | | @@ -105,4 +112,6 @@ class ChargeStatus: |
|  |  | (FULLY\_CHARGED, "Fully charged"), |
|  |  | (PARTIALLY\_REFUNDED, "Partially refunded"), |
|  |  | (FULLY\_REFUNDED, "Fully refunded"), |
|  |  | (REFUSED, "Refused"), |
|  |  | (CANCELLED, "Cancelled"), |
|  |  | ] |

43 changes: 31 additions & 12 deletions

43
[saleor/payment/gateways/adyen/plugin.py](#diff-a3f01c70c83748f7ea71b9b5d31ec2e41633996c11e514384bc89ba6a6868349 "saleor/payment/gateways/adyen/plugin.py")

Show comments

[View file](/saleor/saleor/blob/1328274e1a3d04ab87d7daee90229ff47b3bc35e/saleor/payment/gateways/adyen/plugin.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,10 +1,11 @@ |
|  |  | import json |
|  |  | from typing import Optional |
|  |  | from typing import List, Optional |
|  |  |  |
|  |  | import Adyen |
|  |  | from babel.numbers import get\_currency\_precision |
|  |  | from django.contrib.auth.hashers import make\_password |
|  |  | from django.core.handlers.wsgi import WSGIRequest |
|  |  | from django.http import HttpResponse, JsonResponse |
|  |  | from django.http import HttpResponse, HttpResponseNotFound, JsonResponse |
|  |  | from graphql\_relay import from\_global\_id |
|  |  |  |
|  |  | from ....checkout.models import Checkout |
| Expand All | | @@ -21,6 +22,7 @@ |
|  |  | request\_data\_for\_payment, |
|  |  | request\_for\_payment\_refund, |
|  |  | ) |
|  |  | from .webhooks import handle\_webhook |
|  |  |  |
|  |  | GATEWAY\_NAME = "Adyen" |
|  |  |  |
| Expand Down  Expand Up | | @@ -50,7 +52,6 @@ class AdyenGatewayPlugin(BasePlugin): |
|  |  | {"name": "Origin Key", "value": ""}, |
|  |  | {"name": "Origin Url", "value": ""}, |
|  |  | {"name": "Live", "value": ""}, |
|  |  | {"name": "Enable notifications", "value": True}, |
|  |  | {"name": "Automatically mark payment as a capture", "value": True}, |
|  |  | {"name": "HMAC secret key", "value": ""}, |
|  |  | {"name": "Notification user", "value": ""}, |
| Expand Down  Expand Up | | @@ -109,8 +110,7 @@ class AdyenGatewayPlugin(BasePlugin): |
|  |  | "type": ConfigurationTypeField.BOOLEAN, |
|  |  | "help\_text": ( |
|  |  | "Enable the support for processing the Adyen's webhooks. The Saleor " |
|  |  | "webhook url is <your-backend-url>/plugins/mirumee.payments.adyen/" |
|  |  | "webhooks/ " |
|  |  | "webhook url is http(s)://<your-backend-url>/plugins/mirumee.payments.adyen/webhooks/ " |
|  |  | "https://docs.adyen.com/development-resources/webhooks" |
|  |  | ), |
|  |  | "label": "Enable notifications", |
| Expand All | | @@ -134,7 +134,8 @@ class AdyenGatewayPlugin(BasePlugin): |
|  |  | "help\_text": ( |
|  |  | "Provide secret key generated on Adyen side." |
|  |  | "https://docs.adyen.com/development-resources/webhooks#set-up-notificat" |
|  |  | "ions-in-your-customer-area" |
|  |  | "ions-in-your-customer-area. The Saleor webhook url is " |
|  |  | "http(s)://<your-backend-url>/plugins/mirumee.payments.adyen/webhooks/" |
|  |  | ), |
|  |  | "label": "HMAC secret key", |
|  |  | }, |
| Expand All | | @@ -143,7 +144,9 @@ class AdyenGatewayPlugin(BasePlugin): |
|  |  | "help\_text": ( |
|  |  | "Base User provided on the Adyen side for authenticate incoming " |
|  |  | "notifications. https://docs.adyen.com/development-resources/webhooks#" |
|  |  | "set-up-notifications-in-your-customer-area" |
|  |  | "set-up-notifications-in-your-customer-area " |
|  |  | "The Saleor webhook url is " |
|  |  | "http(s)://<your-backend-url>/plugins/mirumee.payments.adyen/webhooks/" |
|  |  | ), |
|  |  | "label": "Notification user", |
|  |  | }, |
| Expand All | | @@ -152,7 +155,9 @@ class AdyenGatewayPlugin(BasePlugin): |
|  |  | "help\_text": ( |
|  |  | "User password provided on the Adyen side for authenticate incoming " |
|  |  | "notifications. https://docs.adyen.com/development-resources/webhooks#" |
|  |  | "set-up-notifications-in-your-customer-area" |
|  |  | "set-up-notifications-in-your-customer-area " |
|  |  | "The Saleor webhook url is " |
|  |  | "http(s)://<your-backend-url>/plugins/mirumee.payments.adyen/webhooks/" |
|  |  | ), |
|  |  | "label": "Notification password", |
|  |  | }, |
| Expand All | | @@ -163,23 +168,28 @@ def \_\_init\_\_(self, \*args, \*\*kwargs): |
|  |  | configuration = {item["name"]: item["value"] for item in self.configuration} |
|  |  | self.config = GatewayConfig( |
|  |  | gateway\_name=GATEWAY\_NAME, |
|  |  | auto\_capture=True, # FIXME check this |
|  |  | auto\_capture=configuration[ |
|  |  | "Automatically mark payment as a capture" |
|  |  | ], # FIXME check this |
|  |  | supported\_currencies=configuration["Supported currencies"], |
|  |  | connection\_params={ |
|  |  | "api\_key": configuration["API key"], |
|  |  | "merchant\_account": configuration["Merchant Account"], |
|  |  | "return\_url": configuration["Return Url"], |
|  |  | "origin\_key": configuration["Origin Key"], |
|  |  | "origin\_url": configuration["Origin Url"], |
|  |  | "live": configuration["Live"], |
|  |  | "webhook\_hmac": configuration["HMAC secret key"], |
|  |  | "webhook\_user": configuration["Notification user"], |
|  |  | "webhook\_user\_password": configuration["Notification password"], |
|  |  | }, |
|  |  | ) |
|  |  | api\_key = self.config.connection\_params["api\_key"] |
|  |  | self.adyen = Adyen.Adyen(xapikey=api\_key) |
|  |  |  |
|  |  | def webhook(self, request: WSGIRequest, path: str, previous\_value) -> HttpResponse: |
|  |  |  |
|  |  | print(request.body) |
|  |  | return HttpResponse("[accepted]") |
|  |  | config = self.\_get\_gateway\_config() |
|  |  | return handle\_webhook(request, config) |
|  |  |  |
|  |  | def \_get\_gateway\_config(self) -> GatewayConfig: |
|  |  | return self.config |
| Expand Down  Expand Up | | @@ -238,6 +248,15 @@ def process\_payment( |
|  |  | raw\_response=result.message, |
|  |  | ) |
|  |  |  |
|  |  | @classmethod |
|  |  | def \_update\_config\_items( |
|  |  | cls, configuration\_to\_update: List[dict], current\_config: List[dict] |
|  |  | ): |
|  |  | super().\_update\_config\_items(configuration\_to\_update, current\_config) |
|  |  | for item in current\_config: |
|  |  | if item.get("name") == "Notification password": |
|  |  | item["value"] = make\_password(item["value"]) |
|  |  |  |
|  |  | @require\_active\_plugin |
|  |  | def get\_payment\_config(self, previous\_value): |
|  |  | return [] |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[saleor/payment/gateways/adyen/utils.py](#diff-bc5653fc2a33917a227e6e77ce951b9e6daf97ff63aba93bcc1441ef8278cf28 "saleor/payment/gateways/adyen/utils.py")

Show comments

[View file](/saleor/saleor/blob/1328274e1a3d04ab87d7daee90229ff47b3bc35e/saleor/payment/gateways/adyen/utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,13 @@ |
|  |  | logger = logging.getLogger(\_\_name\_\_) |
|  |  |  |
|  |  |  |
|  |  | def convert\_adyen\_price\_format(value: str, currency: str): |
|  |  | value = Decimal(value) |
|  |  | precision = get\_currency\_precision(currency) |
|  |  | number\_places = Decimal(10) \*\* -precision |
|  |  | return value \* number\_places |
|  |  |  |
|  |  |  |
|  |  | def get\_price\_amount(value: Decimal, currency: str): |
|  |  | """Adyen doesn't use values with comma. |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1328274`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fcommit%2F1328274e1a3d04ab87d7daee90229ff47b3bc35e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_805033e0_20250115_102229.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fsecurity%2Fadvisories%2FGHSA-3rqj-9v87-2x3f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fsecurity%2Fadvisories%2FGHSA-3rqj-9v87-2x3f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=saleor%2Fsaleor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[saleor](/saleor)
/
**[saleor](/saleor/saleor)**
Public

* [Notifications](/login?return_to=%2Fsaleor%2Fsaleor) You must be signed in to change notification settings
* [Fork
  5.5k](/login?return_to=%2Fsaleor%2Fsaleor)
* [Star
   21k](/login?return_to=%2Fsaleor%2Fsaleor)

* [Code](/saleor/saleor)
* [Issues
  295](/saleor/saleor/issues)
* [Pull requests
  48](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects
  1](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

Additional navigation options

* [Code](/saleor/saleor)
* [Issues](/saleor/saleor/issues)
* [Pull requests](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

# Non-constant time HMAC comparison in Adyen plugin

Moderate

[NyanKiyoshi](/NyanKiyoshi)
published
GHSA-3rqj-9v87-2x3f
May 24, 2023

## Package

saleor
(GHCR)

## Affected versions

>= 2.11.0, < 3.7.68
>= 3.8.0, < 3.8.40
>= 3.9.0, < 3.9.49
>= 3.10.0, < 3.10.36
>= 3.11.0, < 3.11.35
>= 3.12.0, < 3.12.25
>= 3.13.0, < 3.13.16

## Patched versions

3.7.68
3.8.40
3.9.49
3.10.36
3.11.35
3.12.25
3.13.16

## Description

Saleor's `validate_hmac_signature` function is vulnerable to timing attacks.

### Impact

Malicious users could abuse this vulnerability on Saleor deployments having the Adyen plugin enabled in order to determine the secret key and forge fake events, this could affect the database integrity such as marking an order as paid when it is not.

This issue has been patched in versions 3.13.16, 3.12.25, 3.11.35, 3.10.36, 3.9.49, 3.8.40, and 3.7.68.

### Workarounds

We strongly recommend upgrading to the latest versions, in case of inability to upgrade straight away, possible workarounds are:

* Add rate-limit to the `/plugins/channel/<channel>/mirumee.payments.adyen/webhooks` endpoint
* Disable the Saleor Adyen plugin

### References

* Commit introducing the issue: [1328274](https://github.com/saleor/saleor/commit/1328274e1a3d04ab87d7daee90229ff47b3bc35e)
* [780ff3e](https://github.com/saleor/saleor/commit/780ff3e54ea6bd19f6843824347e4c4b1f3d0111) (main branch)
* <https://github.com/saleor/saleor/releases/tag/3.7.68>
* <https://github.com/saleor/saleor/releases/tag/3.8.40>
* <https://github.com/saleor/saleor/releases/tag/3.9.49>
* <https://github.com/saleor/saleor/releases/tag/3.10.36>
* <https://github.com/saleor/saleor/releases/tag/3.11.35>
* <https://github.com/saleor/saleor/releases/tag/3.12.25>
* <https://github.com/saleor/saleor/releases/tag/3.13.16>

### Severity

Moderate

4.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N

### CVE ID

CVE-2023-32694

### Weaknesses

[CWE-203](/advisories?query=cwe%3A203) [CWE-208](/advisories?query=cwe%3A208)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


