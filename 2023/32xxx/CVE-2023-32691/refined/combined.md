=== Content from github.com_0583639a_20250115_080308.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fginuerzh%2Fgost%2Fsecurity%2Fadvisories%2FGHSA-qjrq-hm79-49ww)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fginuerzh%2Fgost%2Fsecurity%2Fadvisories%2FGHSA-qjrq-hm79-49ww)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ginuerzh%2Fgost)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ginuerzh](/ginuerzh)
/
**[gost](/ginuerzh/gost)**
Public

* [Notifications](/login?return_to=%2Fginuerzh%2Fgost) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fginuerzh%2Fgost)
* [Star
   16.3k](/login?return_to=%2Fginuerzh%2Fgost)

* [Code](/ginuerzh/gost)
* [Issues
  270](/ginuerzh/gost/issues)
* [Pull requests
  7](/ginuerzh/gost/pulls)
* [Actions](/ginuerzh/gost/actions)
* [Projects
  0](/ginuerzh/gost/projects)
* [Wiki](/ginuerzh/gost/wiki)
* [Security](/ginuerzh/gost/security)
* [Insights](/ginuerzh/gost/pulse)

Additional navigation options

* [Code](/ginuerzh/gost)
* [Issues](/ginuerzh/gost/issues)
* [Pull requests](/ginuerzh/gost/pulls)
* [Actions](/ginuerzh/gost/actions)
* [Projects](/ginuerzh/gost/projects)
* [Wiki](/ginuerzh/gost/wiki)
* [Security](/ginuerzh/gost/security)
* [Insights](/ginuerzh/gost/pulse)

# Timing Attack in ginuerzh/gost

Moderate

[ginuerzh](/ginuerzh)
published
GHSA-qjrq-hm79-49ww
May 21, 2023

## Package

gomod

gost
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= 2.11.5

## Patched versions

None

## Description

[Timing attacks](https://en.wikipedia.org/wiki/Timing_attack) occur when an attacker can guess a secret by observing a difference in processing time for valid and invalid inputs. Sensitive secrets such as passwords, token and API keys should be compared only using a constant-time comparision function.

More information on this attack type can be found in [this blog post](https://verboselogging.com/2012/08/20/a-timing-attack-in-action).

# Root Cause Analysis

In this case, the vulnerability occurs due to the following code.

[gost/auth.go](https://github.com/ginuerzh/gost/blob/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go#L46-L46)

Line 46
in
[1c62376](/ginuerzh/gost/commit/1c62376e0880e4094bd3731e06bd4f7842638f6a)

|  | return ok && (v == "" || password == v) |
| --- | --- |

Here, a untrusted input, sourced from a HTTP header, is compared directly with a secret.

Since, this comparision is not secure, an attacker can mount a side-channel timing attack to guess the password.

# Remediation

This can be easily fixed using a constant time comparing function such as `crypto/subtle`'s `ConstantTimeCompare`.

An example fix can be found in [runatlantis/atlantis@4887091](https://github.com/runatlantis/atlantis/commit/48870911974adddaa4c99c8089e79b7d787fa820) Alternatively, one can apply the patch below

```
From d18cff85e1a565f688f717fd8f2cacea62ff9dbf Mon Sep 17 00:00:00 2001
From: Porcupiney Hairs <porcupiney.hairs@protonmail.com>
Date: Sun, 7 May 2023 01:03:33 +0530
Subject: [PATCH] Fix : Timing attack

---
 auth.go | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/auth.go b/auth.go
index 1be96e9..be13f23 100644
--- a/auth.go
+++ b/auth.go
@@ -2,6 +2,7 @@ package gost

 import (
 	"bufio"
+	"crypto/subtle"
 	"io"
 	"strings"
 	"sync"
@@ -43,7 +44,8 @@ func (au *LocalAuthenticator) Authenticate(user, password string) bool {
 	}

 	v, ok := au.kvs[user]
-	return ok && (v == "" || password == v)
+	passOk := subtle.ConstantTimeCompare([]byte(password), []byte(v)) == 0
+	return ok && (v == "" || passOk)
 }

 // Add adds a key-value pair to the Authenticator.
--
2.25.1

```

### Severity

Moderate

### CVE ID

CVE-2023-32691

### Weaknesses

[CWE-203](/advisories?query=cwe%3A203)

### Credits

* [![@porcupineyhairs](https://avatars.githubusercontent.com/u/61983466?s=40&v=4)](/porcupineyhairs)
  [porcupineyhairs](/porcupineyhairs)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ffd090c1_20250115_080307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fginuerzh%2Fgost%2Fblob%2F1c62376e0880e4094bd3731e06bd4f7842638f6a%2Fauth.go)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fginuerzh%2Fgost%2Fblob%2F1c62376e0880e4094bd3731e06bd4f7842638f6a%2Fauth.go)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ginuerzh%2Fgost)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ginuerzh](/ginuerzh)
/
**[gost](/ginuerzh/gost)**
Public

* [Notifications](/login?return_to=%2Fginuerzh%2Fgost) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fginuerzh%2Fgost)
* [Star
   16.3k](/login?return_to=%2Fginuerzh%2Fgost)

* [Code](/ginuerzh/gost)
* [Issues
  270](/ginuerzh/gost/issues)
* [Pull requests
  7](/ginuerzh/gost/pulls)
* [Actions](/ginuerzh/gost/actions)
* [Projects
  0](/ginuerzh/gost/projects)
* [Wiki](/ginuerzh/gost/wiki)
* [Security](/ginuerzh/gost/security)
* [Insights](/ginuerzh/gost/pulse)

Additional navigation options

* [Code](/ginuerzh/gost)
* [Issues](/ginuerzh/gost/issues)
* [Pull requests](/ginuerzh/gost/pulls)
* [Actions](/ginuerzh/gost/actions)
* [Projects](/ginuerzh/gost/projects)
* [Wiki](/ginuerzh/gost/wiki)
* [Security](/ginuerzh/gost/security)
* [Insights](/ginuerzh/gost/pulse)

## Files

 1c62376
## Breadcrumbs

1. [gost](/ginuerzh/gost/tree/1c62376e0880e4094bd3731e06bd4f7842638f6a)
/
# auth.go

Copy path Blame  Blame
## Latest commit

## History

[History](/ginuerzh/gost/commits/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go)155 lines (130 loc) · 2.86 KB 1c62376
## Breadcrumbs

1. [gost](/ginuerzh/gost/tree/1c62376e0880e4094bd3731e06bd4f7842638f6a)
/
# auth.go

Top
## File metadata and controls

* Code
* Blame

155 lines (130 loc) · 2.86 KB[Raw](https://github.com/ginuerzh/gost/raw/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155package gost
import ( "bufio" "io" "strings" "sync" "time")
// Authenticator is an interface for user authentication.type Authenticator interface { Authenticate(user, password string) bool}
// LocalAuthenticator is an Authenticator that authenticates client by local key-value pairs.type LocalAuthenticator struct { kvs map[string]string period time.Duration stopped chan struct{} mux sync.RWMutex}
// NewLocalAuthenticator creates an Authenticator that authenticates client by local infos.func NewLocalAuthenticator(kvs map[string]string) \*LocalAuthenticator { return &LocalAuthenticator{ kvs: kvs, stopped: make(chan struct{}), }}
// Authenticate checks the validity of the provided user-password pair.func (au \*LocalAuthenticator) Authenticate(user, password string) bool { if au == nil { return true }
 au.mux.RLock() defer au.mux.RUnlock()
 if len(au.kvs) == 0 { return true }
 v, ok := au.kvs[user] return ok && (v == "" || password == v)}
// Add adds a key-value pair to the Authenticator.func (au \*LocalAuthenticator) Add(k, v string) { au.mux.Lock() defer au.mux.Unlock() if au.kvs == nil { au.kvs = make(map[string]string) } au.kvs[k] = v}
// Reload parses config from r, then live reloads the Authenticator.func (au \*LocalAuthenticator) Reload(r io.Reader) error { var period time.Duration kvs := make(map[string]string)
 if r == nil || au.Stopped() { return nil }
 // splitLine splits a line text by white space. // A line started with '#' will be ignored, otherwise it is valid. split := func(line string) []string { if line == "" { return nil } line = strings.Replace(line, "\t", " ", -1) line = strings.TrimSpace(line)
 if strings.IndexByte(line, '#') == 0 { return nil }
 var ss []string for \_, s := range strings.Split(line, " ") { if s = strings.TrimSpace(s); s != "" { ss = append(ss, s) } } return ss }
 scanner := bufio.NewScanner(r) for scanner.Scan() { line := scanner.Text() ss := split(line) if len(ss) == 0 { continue }
 switch ss[0] { case "reload": // reload option if len(ss) > 1 { period, \_ = time.ParseDuration(ss[1]) } default: var k, v string k = ss[0] if len(ss) > 1 { v = ss[1] } kvs[k] = v } }
 if err := scanner.Err(); err != nil { return err }
 au.mux.Lock() defer au.mux.Unlock()
 au.period = period au.kvs = kvs
 return nil}
// Period returns the reload period.func (au \*LocalAuthenticator) Period() time.Duration { if au.Stopped() { return -1 }
 au.mux.RLock() defer au.mux.RUnlock()
 return au.period}
// Stop stops reloading.func (au \*LocalAuthenticator) Stop() { select { case <-au.stopped: default: close(au.stopped) }}
// Stopped checks whether the reloader is stopped.func (au \*LocalAuthenticator) Stopped() bool { select { case <-au.stopped: return true default: return false }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


