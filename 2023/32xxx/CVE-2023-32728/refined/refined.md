- **Root cause of vulnerability:** The Zabbix Agent 2 item key `smart.disk.get` does not sanitize its parameters before passing them to a shell command.
- **Weaknesses/vulnerabilities present:** Improper Input Validation (CWE-20) leading to code injection.
- **Impact of exploitation:** An attacker can execute arbitrary code on any device running a vulnerable Zabbix Agent 2 instance with `smartctl` installed. This results in Remote Code Execution (RCE).
- **Attack vectors:** Remote, network-based attack.
- **Required attacker capabilities/position:** An attacker needs network access to a vulnerable Zabbix Agent 2 and the ability to influence the parameters sent to the `smart.disk.get` item. The attacker also needs to have an account that has privileges to request such action from the agent. The vulnerability is present in the `smartctl` plugin of `zabbix_agent2`.