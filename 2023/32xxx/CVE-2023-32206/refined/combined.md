=== Content from www.mozilla.org_9c4ab3df_20250115_100921.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-16

## Security Vulnerabilities fixed in Firefox 113

Announced
May 9, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 113

#### [#CVE-2023-32205: Browser prompts could have been obscured by popups](#CVE-2023-32205)

Reporter
Alesandro Ortiz
Impact
high
##### Description

In multiple cases browser prompts could have been obscured by popups controlled by content. These could have led to potential user confusion and spoofing attacks.

##### References

* [Bug 1753339](https://bugzilla.mozilla.org/show_bug.cgi?id=1753339)
* [Bug 1753341](https://bugzilla.mozilla.org/show_bug.cgi?id=1753341)

#### [#CVE-2023-32206: Crash in RLBox Expat driver](#CVE-2023-32206)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bound read could have led to a crash in the RLBox Expat driver.

##### References

* [Bug 1824892](https://bugzilla.mozilla.org/show_bug.cgi?id=1824892)

#### [#CVE-2023-32207: Potential permissions request bypass via clickjacking](#CVE-2023-32207)

Reporter
Hafiizh
Impact
high
##### Description

A missing delay in popup notifications could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1826116](https://bugzilla.mozilla.org/show_bug.cgi?id=1826116)

#### [#CVE-2023-32208: Leak of script base URL in service workers via import()](#CVE-2023-32208)

Reporter
Anne van Kesteren
Impact
moderate
##### Description

Service workers could reveal script base URL due to dynamic `import()`.

##### References

* [Bug 1646034](https://bugzilla.mozilla.org/show_bug.cgi?id=1646034)

#### [#CVE-2023-32209: Persistent DoS via favicon image](#CVE-2023-32209)

Reporter
Sam Ezeh
Impact
moderate
##### Description

A maliciously crafted favicon could have led to an out of memory crash.

##### References

* [Bug 1767194](https://bugzilla.mozilla.org/show_bug.cgi?id=1767194)

#### [#CVE-2023-32210: Incorrect principal object ordering](#CVE-2023-32210)

Reporter
Nika Layzell
Impact
moderate
##### Description

Documents were incorrectly assuming an ordering of principal objects when ensuring we were loading an appropriately privileged principal. In certain circumstances it might have been possible to cause a document to be loaded with a higher privileged principal than intended.

##### References

* [Bug 1776755](https://bugzilla.mozilla.org/show_bug.cgi?id=1776755)

#### [#CVE-2023-32211: Content process crash due to invalid wasm code](#CVE-2023-32211)

Reporter
P1umer and xmzyshypnc
Impact
moderate
##### Description

A type checking bug would have led to invalid code being compiled.

##### References

* [Bug 1823379](https://bugzilla.mozilla.org/show_bug.cgi?id=1823379)

#### [#CVE-2023-32212: Potential spoof due to obscured address bar](#CVE-2023-32212)

Reporter
Hafiizh
Impact
moderate
##### Description

An attacker could have positioned a `datalist` element to obscure the address bar.

##### References

* [Bug 1826622](https://bugzilla.mozilla.org/show_bug.cgi?id=1826622)

#### [#CVE-2023-32213: Potential memory corruption in FileReader::DoReadData()](#CVE-2023-32213)

Reporter
Ronald Crane
Impact
moderate
##### Description

When reading a file, an uninitialized value could have been used as read limit.

##### References

* [Bug 1826666](https://bugzilla.mozilla.org/show_bug.cgi?id=1826666)

#### [#MFSA-TMP-2023-0002: Race condition in dav1d decoding](#MFSA-TMP-2023-0002)

Reporter
Tyson Smith
Impact
moderate
##### Description

A race condition during dav1d decoding could have led to an out-of-bounds memory access, potentially leading to memory corruption and execution of malicious code.

##### References

* [Bug 1814790](https://bugzilla.mozilla.org/show_bug.cgi?id=1814790)
* [Bug 1819796](https://bugzilla.mozilla.org/show_bug.cgi?id=1819796)
* [Bug 1814560](https://bugzilla.mozilla.org/show_bug.cgi?id=1814560)

#### [#CVE-2023-32214: Potential DoS via exposed protocol handlers](#CVE-2023-32214)

Reporter
Edward Prior
Impact
low
##### Description

Protocol handlers `ms-cxh` and `ms-cxh-full` could have been leveraged to trigger a denial of service.
*Note: This attack only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1828716](https://bugzilla.mozilla.org/show_bug.cgi?id=1828716)

#### [#CVE-2023-32215: Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](#CVE-2023-32215)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Andrew Osmond, Emily McDonough, Sebastian Hengst, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 112 and Firefox ESR 102.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540883%2C1751943%2C1814856%2C1820210%2C1821480%2C1827019%2C1827024%2C1827144%2C1827359%2C1830186)

#### [#CVE-2023-32216: Memory safety bugs fixed in Firefox 113](#CVE-2023-32216)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Ronald Crane, Andrew McCreight, Randell Jesup and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 112. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 113](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746479%2C1806852%2C1815987%2C1820359%2C1823568%2C1824803%2C1824834%2C1825170%2C1827020%2C1828130)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_6ad555e3_20250115_100924.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-18

## Security Vulnerabilities fixed in Thunderbird 102.11

Announced
May 10, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102.11

#### [#CVE-2023-32205: Browser prompts could have been obscured by popups](#CVE-2023-32205)

Reporter
Alesandro Ortiz
Impact
high
##### Description

In multiple cases browser prompts could have been obscured by popups controlled by content. These could have led to potential user confusion and spoofing attacks.

##### References

* [Bug 1753339](https://bugzilla.mozilla.org/show_bug.cgi?id=1753339)
* [Bug 1753341](https://bugzilla.mozilla.org/show_bug.cgi?id=1753341)

#### [#CVE-2023-32206: Crash in RLBox Expat driver](#CVE-2023-32206)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bound read could have led to a crash in the RLBox Expat driver.

##### References

* [Bug 1824892](https://bugzilla.mozilla.org/show_bug.cgi?id=1824892)

#### [#CVE-2023-32207: Potential permissions request bypass via clickjacking](#CVE-2023-32207)

Reporter
Hafiizh
Impact
high
##### Description

A missing delay in popup notifications could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1826116](https://bugzilla.mozilla.org/show_bug.cgi?id=1826116)

#### [#CVE-2023-32211: Content process crash due to invalid wasm code](#CVE-2023-32211)

Reporter
P1umer and xmzyshypnc
Impact
moderate
##### Description

A type checking bug would have led to invalid code being compiled.

##### References

* [Bug 1823379](https://bugzilla.mozilla.org/show_bug.cgi?id=1823379)

#### [#CVE-2023-32212: Potential spoof due to obscured address bar](#CVE-2023-32212)

Reporter
Hafiizh
Impact
moderate
##### Description

An attacker could have positioned a `datalist` element to obscure the address bar.

##### References

* [Bug 1826622](https://bugzilla.mozilla.org/show_bug.cgi?id=1826622)

#### [#CVE-2023-32213: Potential memory corruption in FileReader::DoReadData()](#CVE-2023-32213)

Reporter
Ronald Crane
Impact
moderate
##### Description

When reading a file, an uninitialized value could have been used as read limit.

##### References

* [Bug 1826666](https://bugzilla.mozilla.org/show_bug.cgi?id=1826666)

#### [#CVE-2023-32214: Potential DoS via exposed protocol handlers](#CVE-2023-32214)

Reporter
Edward Prior
Impact
low
##### Description

Protocol handlers `ms-cxh` and `ms-cxh-full` could have been leveraged to trigger a denial of service.
*Note: This attack only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1828716](https://bugzilla.mozilla.org/show_bug.cgi?id=1828716)

#### [#CVE-2023-32215: Memory safety bugs fixed in Thunderbird 102.11](#CVE-2023-32215)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Andrew Osmond, Emily McDonough, Sebastian Hengst, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 102.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 102.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540883%2C1751943%2C1814856%2C1820210%2C1821480%2C1827019%2C1827024%2C1827144%2C1827359%2C1830186)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_16b7ab9d_20250115_100919.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple Vulnerabilities — GLSA **202312-03**

Multiple vulnerabilities have been found in Mozilla Thunderbird, the worst of which could lead to remote code execution.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **102.12** |
| Unaffected versions | >= **102.12** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **102.12** |
| Unaffected versions | >= **102.12** |

### Background

Mozilla Thunderbird is a popular open-source email client from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-bin-102.12"

```

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-102.12"

```
### References

* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)

**Release date**

December 20, 2023

**Latest revision**

December 20, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908246](https://bugs.gentoo.org/show_bug.cgi?id=908246)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_a3bfb17e_20250115_100923.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-17

## Security Vulnerabilities fixed in Firefox ESR 102.11

Announced
May 9, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 102.11

#### [#CVE-2023-32205: Browser prompts could have been obscured by popups](#CVE-2023-32205)

Reporter
Alesandro Ortiz
Impact
high
##### Description

In multiple cases browser prompts could have been obscured by popups controlled by content. These could have led to potential user confusion and spoofing attacks.

##### References

* [Bug 1753339](https://bugzilla.mozilla.org/show_bug.cgi?id=1753339)
* [Bug 1753341](https://bugzilla.mozilla.org/show_bug.cgi?id=1753341)

#### [#CVE-2023-32206: Crash in RLBox Expat driver](#CVE-2023-32206)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bound read could have led to a crash in the RLBox Expat driver.

##### References

* [Bug 1824892](https://bugzilla.mozilla.org/show_bug.cgi?id=1824892)

#### [#CVE-2023-32207: Potential permissions request bypass via clickjacking](#CVE-2023-32207)

Reporter
Hafiizh
Impact
high
##### Description

A missing delay in popup notifications could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1826116](https://bugzilla.mozilla.org/show_bug.cgi?id=1826116)

#### [#CVE-2023-32211: Content process crash due to invalid wasm code](#CVE-2023-32211)

Reporter
P1umer and xmzyshypnc
Impact
moderate
##### Description

A type checking bug would have led to invalid code being compiled.

##### References

* [Bug 1823379](https://bugzilla.mozilla.org/show_bug.cgi?id=1823379)

#### [#CVE-2023-32212: Potential spoof due to obscured address bar](#CVE-2023-32212)

Reporter
Hafiizh
Impact
moderate
##### Description

An attacker could have positioned a `datalist` element to obscure the address bar.

##### References

* [Bug 1826622](https://bugzilla.mozilla.org/show_bug.cgi?id=1826622)

#### [#CVE-2023-32213: Potential memory corruption in FileReader::DoReadData()](#CVE-2023-32213)

Reporter
Ronald Crane
Impact
moderate
##### Description

When reading a file, an uninitialized value could have been used as read limit.

##### References

* [Bug 1826666](https://bugzilla.mozilla.org/show_bug.cgi?id=1826666)

#### [#CVE-2023-32214: Potential DoS via exposed protocol handlers](#CVE-2023-32214)

Reporter
Edward Prior
Impact
low
##### Description

Protocol handlers `ms-cxh` and `ms-cxh-full` could have been leveraged to trigger a denial of service.
*Note: This attack only affects Windows. Other operating systems are not affected.*

##### References

* [Bug 1828716](https://bugzilla.mozilla.org/show_bug.cgi?id=1828716)

#### [#CVE-2023-32215: Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](#CVE-2023-32215)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Andrew Osmond, Emily McDonough, Sebastian Hengst, Andrew McCreight and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 112 and Firefox ESR 102.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 113 and Firefox ESR 102.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1540883%2C1751943%2C1814856%2C1820210%2C1821480%2C1827019%2C1827024%2C1827144%2C1827359%2C1830186)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_897e22ca_20250115_100919.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_e160fda2_20250115_100919.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1824892)
* [XML](/show_bug.cgi?ctype=xml&id=1824892)

Closed
[Bug 1824892](/show_bug.cgi?id=1824892)
(CVE-2023-32206)

Opened 2 years ago
Closed 2 years ago

# [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer

## Categories

### (Core :: XML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XML#XML)

XML
▾

Core :: XML
For bugs in our XML handling. For example, parser errors, or errors in wellformedness error reporting.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

114 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | [113+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=113%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed) |
| firefox112 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix) |
| firefox113 | [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed) |
| firefox114 | [+](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 | 113+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox112 |  | wontfix |
| firefox113 | + | fixed |
| firefox114 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: shravanrn)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a4537e36a1c5cce6f9cc43505696448a?d=mm&size=40)  [shravanrn](/user_profile?user_id=639827)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1825445](/show_bug.cgi?id=1825445 "RESOLVED FIXED - Access violation on mozHunspell::Check with long string")

## Details

### (5 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+][qa-triaged])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-32206

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+][qa-triaged]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3075761_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a3033795_551058 "2 years ago") | + |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [testcase-0x2.html](/attachment.cgi?id=9325353)  [2 years ago](#c0)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   729.79 KB, text/html |  | [Details](/attachment.cgi?id=9325353&action=edit) |
| --- | --- | --- |
| [testcase-0x2-minidump.txt](/attachment.cgi?id=9325354)  [2 years ago](#c1)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   3.58 KB, text/plain |  | [Details](/attachment.cgi?id=9325354&action=edit) |
| [testcase-0x4.html](/attachment.cgi?id=9325358)  [2 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   863.40 KB, text/html |  | [Details](/attachment.cgi?id=9325358&action=edit) |
| [testcase-0x4-minidump.txt](/attachment.cgi?id=9325359)  [2 years ago](#c3)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   3.58 KB, text/plain |  | [Details](/attachment.cgi?id=9325359&action=edit) |
| [Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley](/attachment.cgi?id=9328469)  [2 years ago](#c12)  [Shravan Narayan](/user_profile?user_id=639827)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c23 "2 years ago")  RyanVM : [approval-mozilla-esr102+](#c23 "2 years ago")  tjr : [sec-approval+](#c21 "2 years ago") | [Details](/attachment.cgi?id=9328469&action=edit) | [Review](/attachment.cgi?id=9328469) |
| [advisory.txt](/attachment.cgi?id=9331512)  [2 years ago](#c34)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   110 bytes, text/plain |  | [Details](/attachment.cgi?id=9331512&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1824892#c0)• 2 years ago |
|  | |

Attached file
[testcase-0x2.html](attachment.cgi?id=9325353)
— [Details](attachment.cgi?id=9325353&action=edit)

When running `new DOMParser().parseFromString(document.documentElement.outerHTML, 'application/xml')` on large HTML continuously in loop, Firefox 32-bit able to crash with `AV_READ` on `nsExpatDriver::HandleError()` at changeable address that depends on DOM size or the length of HTML.

When running the testcase on Firefox single process `./mach run --disable-e10s` then attach gdb debugger, the crash is shown at following code:

```
954    // Last character will be '^'.
955    int32_t last = aColNumber - 1;
956    int32_t i;
957    uint32_t minuses = 0;
958    for (i = 0; i < last; ++i) {
→ 959      if (aSourceLine[i] == '\t') {
960        // Since this uses |white-space: pre;| a tab stop equals 8 spaces.
961        uint32_t add = 8 - (minuses % 8);
962        aSourceString.AppendASCII("--------", add);
963        minuses += add;
964      } else {

```

It looks like Firefox tried to accessing out-of-bounds element on `aSourceLine` array. In case the `aSourceLine` array address is `0x25ce0008` then the crash address is `0x25cff000`.

## Tested on:

* Firefox Nightly 113.0a1 (2023-03-27) (32-bit) on Windows 11
* Firefox 111.0.1 (32-bit) on Windows 11
* Firefox ESR 102.9.0esr (32-bit) on Windows 11

## Steps to reproduce:

1. Visit attached testcase-0x2.html
2. After a few seconds, the Firefox tab crashes

If Firefox tab doesn't crash after a while, try close the tab and try again.

Flags: sec-bounty?

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1824892#c1)• 2 years ago |
|  | |

Attached file
[testcase-0x2-minidump.txt](attachment.cgi?id=9325354)
— [Details](attachment.cgi?id=9325354&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1824892#c2)• 2 years ago |
|  | |

Attached file
[testcase-0x4.html](attachment.cgi?id=9325358)
— [Details](attachment.cgi?id=9325358&action=edit)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1824892#c3)• 2 years ago |
|  | |

Attached file
[testcase-0x4-minidump.txt](attachment.cgi?id=9325359)
— [Details](attachment.cgi?id=9325359&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a19192_159069)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → XMLProduct: Firefox → Core

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1824892#c4)• 2 years ago |
|  | |

peterv, you might be familiar with the relevant code.

Flags: needinfo?(peterv)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a36761_1689)• 2 years ago |

Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)Hardware: Unspecified → x86Summary: Access violation on nsExpatDriver::HandleError -> AppendErrorPointer → [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1824892#c5)• 2 years ago |
|  | |

I see some OOM crashes here in crash-stats, but that's a bit different from an access violation. Two examples in this area are [bug 1674989](/show_bug.cgi?id=1674989 "NEW - Crash in [@ OOM | large | NS_ABORT_OOM | nsTSubstring<T>::Append | nsExpatDriver::ConsumeToken]") and <https://crash-stats.mozilla.org/signature/?proto_signature=~nsExpatDriver%3A%3AHandleError&date=%3E%3D2023-03-21T14%3A24%3A00.000Z&date=%3C2023-03-28T14%3A24%3A00.000Z&_sort=-date&signature=OOM%20%7C%20large%20%7C%20NS_ABORT_OOM%20%7C%20nsTSubstring%3CT%3E%3A%3AAllocFailed%20%7C%20nsTSubstring%3CT%3E%3A%3AAppend%20%7C%20AppendErrorPointer>

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a127777_24295)• 2 years ago |

Assignee: nobody → petervStatus: NEW → ASSIGNEDFlags: needinfo?(peterv)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a142163_406194)• 2 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1824892#c6)• 2 years ago |
|  | |

When visiting the testcase on Firefox 64-bit, it also possible to crash on out-of-bounds address.

But the Firefox tab process have to fill OS free memory which take a couple of seconds, it's faster to see the crash on lower system RAM, when the crash doesn't occur after the page has loaded, try reloading the page until it crashes.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1824892#c7)• 2 years ago |
|  | |

Marking S2, since I expected rlbox to catch this (or maybe this is how rlbox catching it manifests?). peterv, please downgrade if this should be S3 instead.

Severity: -- → S2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1824892#c8)• 2 years ago |
|  | |

This could be similar to [bug 1825445](/show_bug.cgi?id=1825445 "RESOLVED FIXED - Access violation on mozHunspell::Check with long string").

See Also: → [1825445](/show_bug.cgi?id=1825445 "RESOLVED FIXED - Access violation on mozHunspell::Check with long string")

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1824892#c9)• 2 years ago |
|  | |

Looking at this briefly, the situation appears to be that we accept an integer |colNumber| from the RLBoxed expat [without verifying it](https://searchfox.org/mozilla-central/rev/2ce39261ea6a69e49d87f76a119494b2a7a7e42a/parser/htmlparser/nsExpatDriver.cpp#1040), then [pass it to AppendErrorPointer](https://searchfox.org/mozilla-central/rev/2ce39261ea6a69e49d87f76a119494b2a7a7e42a/parser/htmlparser/nsExpatDriver.cpp#1059), where it's used to [index an array](https://searchfox.org/mozilla-central/rev/2ce39261ea6a69e49d87f76a119494b2a7a7e42a/parser/htmlparser/nsExpatDriver.cpp#960).

Which is not good, since we're supposed to assume that |colNumber| is potentially attacker-controlled. I'm guessing we missed this because the earlier usage of |colNumber| just passes it into a format string. Luckily it's only a read, and I don't see any obvious way to exploit it beyond triggering a segfault.

(In reply to Andrew McCreight [:mccr8] from [comment #8](/show_bug.cgi?id=1824892#c8 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"))

> This could be similar to [bug 1825445](/show_bug.cgi?id=1825445 "RESOLVED FIXED - Access violation on mozHunspell::Check with long string").

Yes, looks like Irvan is poking at RLBox and trying to break it, which is awesome — thanks Irvan! By the way — I assume you've seen our [Exploit Mitigation Bug Bounty Program](https://www.mozilla.org/en-US/security/client-bug-bounty/#exploit-mitigation-bounty), but I wanted to make sure you're aware that it's permissible to explicitly introduce a memory corruption flaw into the sandboxed library.

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1824892#c10)• 2 years ago |
|  | |

@bholley This does appear to be removing tainting early. Investigating more now.

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1824892#c11)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824892&comment_id=16367920 "2 revisions") |
|  | |

In my attempt to repro the crash, I am only seeing valid OOMs from Firefox. That said, after examination of the code, it is entirely possible that the code path mentioned in the original post could have occurred. I am working a patch to ensure the codepath mentioned in the original post (and other similar codepaths in this file) does not lead to OOB access

@peterv: I'm marking myself as the Assignee for this bug. Let me know if you have any concerns

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a1366570_639827)• 2 years ago |

Assignee: peterv → shravanrn

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1824892#c12)• 2 years ago |
|  | |

Attached file
[Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley](attachment.cgi?id=9328469)
— [Details](attachment.cgi?id=9328469&action=edit)

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1824892#c13)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824892&comment_id=16369622 "1 revision") |
|  | |

Patch is up for this. Copying over the comment I had in the phab here, so we have a record

```
When investigating Bug 1824892 I saw some other anti-pattern instances of removing tainting earlier. While, for the most, the issue identified in Bug 1824892 is the only major OOB read (apart from non-null terminated string reads, which we are ok with in this context), I did more generally try to fix any anti-patterns I saw in this file.

```

Additionally, I did want to discuss a separate question

@bholley: Typically bugs like this are exploitable only if we find a memory safety violation in the sandboxed code. However, here, we seem to be potentially triggering the same code path because, we don't abort on sandbox OOM. This makes sense because of how Wasm sandboxed code is setup. Today, if a Wasm sandbox attempts to grow (to support a malloc call from sandboxed code) and there is no more space, the malloc returns null and the sandboxed program continuous to execute (Most of this code doesn't check that malloc return nonnull). This continued execution corrupts the internal sandbox memory, and the sandbox returns garbage. Assuming correct tainted checks, this shouldn't be an issue. However, I was thinking we may want to employ a defense in depth here.

Should we consider "abort on memorygrowth/malloc fail" behavior to avoid scenarios like this in the future.

We do interpose on memory growth/malloc failures of sandboxed code, but we use this as an only to annotate crash reports.

Flags: needinfo?(bholley)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a1513339_313730)• 2 years ago |

Flags: needinfo?(bholley)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1824892#c14)• 2 years ago |
|  | |

(In reply to Shravan Narayan from [comment #13](/show_bug.cgi?id=1824892#c13 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"))

> Should we consider "abort on memorygrowth/malloc fail" behavior to avoid scenarios like this in the future.
>
> We do interpose on memory growth/malloc failures of sandboxed code, but we use this as an only to annotate crash reports.

(discussed elsewhere)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1824892#c15)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824892&comment_id=16378367 "1 revision") |
|  | |

Backed out for crashes on nsExpatDriver.cpp.

Backout link: <https://hg.mozilla.org/integration/autoland/rev/14b2b1ada6301a671e004fef1899cce5fb56577f>

Log link: <https://treeherder.mozilla.org/logviewer?job_id=413091487&repo=autoland&lineNumber=2650>"

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a1981296_47192)• 2 years ago |

Flags: needinfo?(shravanrn)

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1824892#c16)• 2 years ago |
|  | |

I have updated the patch now. Waiting for tests to complete. Assuming they pass, we can land this

Flags: needinfo?(shravanrn)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1824892#c17)• 2 years ago |
|  | |

I'm not sure it exactly matters given that it already landed, but this should have gotten sec-approval prior to the initial landing.

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=%3F)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1824892#c18)• 2 years ago |
|  | |

We should still do the sec-approval request on this for posterity. Also, we're nearing the end of the cycle before building RCs next week, so we'll need approval requests on this soon.

Flags: needinfo?(shravanrn)

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1824892#c19)• 2 years ago |
|  | |

Comment on [attachment 9328469](/attachment.cgi?id=9328469 "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") [[details]](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley")

[Bug 1824892](/show_bug.cgi?id=1824892 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"): Fix tainting use in the nsExpatDriver r=glandium,bholley

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: This allows a memory safety error in expat to potentially lead to an out of bounds read. However, this process contains no secrets, so this is not the worst cased.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**:
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely
* **Is Android affected?**: Yes
Flags: needinfo?(shravanrn)
[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a2556375_75935)• 2 years ago |

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[tracking-firefox113](/buglist.cgi?f1=cf_tracking_firefox113&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox113&o1=equals&v1=%2B)
[tracking-firefox114](/buglist.cgi?f1=cf_tracking_firefox114&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox114&o1=equals&v1=%2B)
[tracking-firefox-esr102](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=isnotempty):
--- → [113+](/buglist.cgi?f1=cf_tracking_firefox_esr102&o1=equals&v1=113%2B)

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1824892#c20)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1824892&comment_id=16387628 "2 revisions") |
|  | |

Comment on [attachment 9328469](/attachment.cgi?id=9328469 "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") [[details]](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley")

[Bug 1824892](/show_bug.cgi?id=1824892 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"): Fix tainting use in the nsExpatDriver r=glandium,bholley

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Low risk and at worst will help avoid crashes in low memory env.
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Minimum change that only prevents error paths

### Beta/Release Uplift Approval Request

* **User impact if declined**:
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Minimum change that only prevents error paths
* **String changes made/needed**:
* **Is Android affected?**: Yes
[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: approval-mozilla-esr102?
[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: approval-mozilla-beta?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1824892#c21)• 2 years ago |
|  | |

Comment on [attachment 9328469](/attachment.cgi?id=9328469 "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") [[details]](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley")

[Bug 1824892](/show_bug.cgi?id=1824892 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"): Fix tainting use in the nsExpatDriver r=glandium,bholley

approved to land

[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: sec-approval? → sec-approval+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1824892#c22)• 2 years ago |
|  | |

Fix tainting use in the nsExpatDriver r=glandium

<https://hg.mozilla.org/integration/autoland/rev/c7a3230cea33b1d1ea2cf9441c3abe8d678ca458>

<https://hg.mozilla.org/mozilla-central/rev/c7a3230cea33>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 114 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1824892#c23)• 2 years ago |
|  | |

Comment on [attachment 9328469](/attachment.cgi?id=9328469 "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") [[details]](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley")

[Bug 1824892](/show_bug.cgi?id=1824892 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"): Fix tainting use in the nsExpatDriver r=glandium,bholley

Approved for 113.0b9 and 102.11esr.

[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: approval-mozilla-esr102?
[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: approval-mozilla-esr102+
[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: approval-mozilla-beta?
[Attachment #9328469](/attachment.cgi?id=9328469&action=edit "Bug 1824892: Fix tainting use in the nsExpatDriver r=glandium,bholley") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1824892#c24)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/87cbe7735c4a>

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1824892#c25)• 2 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr102/rev/01e361964afb>

[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=fixed)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a2999481_486634)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main113+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a3004799_486634)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main113+] → [reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+]

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a3033795_551058)• 2 years ago |

Flags: qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a3035762_553429)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+] → [reporter-external] [client-bounty-form] [verif?][adv-main113+][adv-ESR102.11+][qa-triaged]

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1824892#c26)• 2 years ago |
|  | |

I managed to reproduce the crash following the steps mentioned in the description of the bug on Windows 11 on both Firefox Nightly 113.0a1 (2023-03-27) (32-bit) and (64-bit).

I still could reproduce the crash on all the latest Firefox versions(Nightly 114.0a1(2023-05-01), Firefox 113-candidate and on Firefox 102.11esr) on both Firefox 32-bit and 64-bit.

Irvan, could you please check if the issue is reproducible also on your end or if there are other steps not mentioned that I should follow.

Thanks.

Flags: needinfo?(susah.yak)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a3060815_553429)• 2 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1824892#c27)• 2 years ago |
|  | |

(In reply to Hani Yacoub, Desktop QA from [comment #26](/show_bug.cgi?id=1824892#c26 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"))

> I managed to reproduce the crash following the steps mentioned in the description of the bug on Windows 11 on both Firefox Nightly 113.0a1 (2023-03-27) (32-bit) and (64-bit).
>
> I still could reproduce the crash on all the latest Firefox versions(Nightly 114.0a1(2023-05-01), Firefox 113-candidate and on Firefox 102.11esr) on both Firefox 32-bit and 64-bit.
>
> Irvan, could you please check if the issue is reproducible also on your end or if there are other steps not mentioned that I should follow.
>
> Thanks.

After testing this repeatedly on Firefox Nightly 114.0a1 (2023-05-01) (32-bit) on Windows 11, I'm no longer able to crash the tab on `EXCEPTION_ACCESS_VIOLATION_READ` (as on attached minidump.txt), the testcase still able to crash the tab, but now it crashed at `EXCEPTION_BREAKPOINT` on [nsExpatDriver.cpp:977](https://searchfox.org/mozilla-central/source/parser/htmlparser/nsExpatDriver.cpp#977) at below assertion code:

```
MOZ_RELEASE_ASSERT(val <= aSourceLineLength,
                       "Unexpected value of last column");

```

The assertion was added recently from [current bug patch](https://phabricator.services.mozilla.com/D175433) which intended to fix the `AV_READ` OOB issue.

Flags: needinfo?(susah.yak)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a3075761_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1824892#c28)• 2 years ago |
|  | |

Hmm... this is interesting. In theory this shouldn't happen, but given that description we can at least confirm that RLBox is now operating as expected and stopping the issue from escalating into anything serious. I will try to look into the root cause of why the MOZ\_RELEASE\_ASSERT is being hit.

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1824892#c29)• 2 years ago |
|  | |

> After testing this repeatedly on Firefox Nightly 114.0a1 (2023-05-01) (32-bit) on Windows 11, I'm no longer able to crash the tab on `EXCEPTION_ACCESS_VIOLATION_READ` (as on attached minidump.txt), the testcase still able to crash the tab, but now it crashed at `EXCEPTION_BREAKPOINT` on [nsExpatDriver.cpp:977](https://searchfox.org/mozilla-central/source/parser/htmlparser/nsExpatDriver.cpp#977) at below assertion code:
>
> ```
> MOZ_RELEASE_ASSERT(val <= aSourceLineLength,
>                        "Unexpected value of last column");
>
> ```
>
> The assertion was added recently from [current bug patch](https://phabricator.services.mozilla.com/D175433) which intended to fix the `AV_READ` OOB issue.

The crash isn't reproducible on my end using Firefox Nightly 113.0a1 (2023-03-27) (32-bit) and (64-bit) with Windows 11, accessing both of the 2 test cases attached (testcase-0x2-minidump.txt and testcase-0x4-minidump.txt).

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1824892#c30)• 2 years ago |
|  | |

(In reply to Hani Yacoub, Desktop QA from [comment #29](/show_bug.cgi?id=1824892#c29 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"))

> The crash isn't reproducible on my end using Firefox Nightly 113.0a1 (2023-03-27) (32-bit) and (64-bit) with Windows 11, accessing both of the 2 test cases attached (testcase-0x2-minidump.txt and testcase-0x4-minidump.txt).

No, the minidump.txt is crash information output from the Firefox crash, I was getting the output.txt when visiting the testcase-0x2.html or testcase-0x4.html by launching Firefox Nightly 113.0a1 (2023-03-27) (32-bit) through FFPuppet.

(In reply to Hani Yacoub, Desktop QA from [comment #26](/show_bug.cgi?id=1824892#c26 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"))

> I still could reproduce the crash on all the latest Firefox versions(Nightly 114.0a1(2023-05-01), Firefox 113-candidate and on Firefox 102.11esr) on both Firefox 32-bit and 64-bit.

Can you submit the crash reports (from about:crashes) and share the crash report link? I think it will be the same as [Comment 27](/show_bug.cgi?id=1824892#c27 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer") crash at `MOZ_RELEASE_ASSERT(val <= aSourceLineLength, "Unexpected value of last column");` or another `EXCEPTION_BREAKPOINT`

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1824892#c31)• 2 years ago |
|  | |

The crash report on Firefox 113.0 (32-bit): <https://crash-stats.mozilla.org/report/index/c5bafb28-6c61-46d5-8604-b07d80230503>

The crash report on Firefox 102.11.0esr (32-bit): <https://crash-stats.mozilla.org/report/index/d1c4b84b-a615-4e61-88e5-e30530230503>

I didn't manage to catch the crash on Firefox Nightly this time, the page kept loading without crashing.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1824892#c32)• 2 years ago |
|  | |

(In reply to Hani Yacoub, Desktop QA from [comment #31](/show_bug.cgi?id=1824892#c31 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer"))

> The crash report on Firefox 113.0 (32-bit): <https://crash-stats.mozilla.org/report/index/c5bafb28-6c61-46d5-8604-b07d80230503>
>
> The crash report on Firefox 102.11.0esr (32-bit): <https://crash-stats.mozilla.org/report/index/d1c4b84b-a615-4e61-88e5-e30530230503>
>
> I didn't manage to catch the crash on Firefox Nightly this time, the page kept loading without crashing.

These are both OOM crashes, different from what Irvan is describing in [comment 27](/show_bug.cgi?id=1824892#c27 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer").

Regardless, I don't think we need Hani to reproduce that failure just yet. I think the next step is for Shravan to investigate as he offered to do in [comment 28](/show_bug.cgi?id=1824892#c28 "RESOLVED FIXED - [32-bit] Access violation on nsExpatDriver::HandleError -> AppendErrorPointer").

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1824892#c33)• 2 years ago |
|  | |

I did get the `MOZ_RELEASE_ASSERT(val <= aSourceLineLength, "Unexpected value of last column");` to hit, although it is inconsistent. I am investigating further.

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1824892#c34)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9331512)
— [Details](attachment.cgi?id=9331512&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a3240528_578488)• 2 years ago |

Alias: CVE-2023-32206

|  | [Shravan Narayan](/user_profile?user_id=639827)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1824892#c35)• 2 years ago |
|  | |

> Hmm... this is interesting. In theory this shouldn't happen, but given that description we can at least confirm that RLBox is now operating as expected and stopping the issue from escalating into anything serious. I will try to look into the root cause of why the MOZ\_RELEASE\_ASSERT is being hit.

> I did get the MOZ\_RELEASE\_ASSERT(val <= aSourceLineLength, "Unexpected value of last column"); to hit, although it is inconsistent. I am investigating further.

This issue and fix is now being tracked in [Bug 1831654](/show_bug.cgi?id=1831654 "RESOLVED FIXED - Graceful failures for out of range column number in expat error handling").

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a17624723_1689)• 1 year ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1824892#a37116225_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1824892&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


