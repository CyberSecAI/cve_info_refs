```
{
  "CVE-2023-32700": {
    "description": "LuaTeX before 1.17.0 allows execution of arbitrary shell commands when compiling a TeX file obtained from an untrusted source. This occurs because luatex-core.lua lets the original io.popen be accessed. This also affects TeX Live before 2023 r66984 and MiKTeX before 23.5.",
    "root_cause": "The vulnerability exists because the luatex-core.lua file allowed access to the original `io.popen` function. This original function was not checked against shell escape restrictions and allowed execution of arbitrary shell commands.",
    "vulnerabilities": [
      "Arbitrary code execution vulnerability."
    ],
    "impact": "An attacker can execute arbitrary shell commands on the user's machine. This can lead to complete system compromise.",
    "attack_vectors": [
      "Convincing a user to compile a malicious TeX document using a vulnerable LuaTeX version."
      ,"Compiling any document in an attacker-controlled working directory."
    ],
    "attacker_capabilities": "An attacker would need to either convince a user to compile a malicious TeX document or have a user compile a document in an attacker-controlled working directory. The attacker would not need any special privileges or access other than the ability to get the user to compile a document.",
     "additional_information": "This issue affects LuaTeX versions 1.04-1.16.1, which were included in TeX Live 2017-2023. The vulnerability can be triggered at compile time, not after document compilation.  The vulnerability affects all 4 LuaTeX engines: LuaTeX, LuaHBTeX, LuaJITTeX, and LuaJITHBTeX. The vulnerability is not exploitable with the `--safer` flag, but this flag is rarely used due to disabling of TTF/OTF font loading.  The vulnerability affects Plain LuaTeX, LuaLaTeX, and OpTeX. ConTeXt is not affected, since it always has shell-escape enabled. This vulnerability affects all operating systems and architectures.  The fix is to implement the wrapper function in C, where we can no longer access the internals from Lua."
  }
}
```