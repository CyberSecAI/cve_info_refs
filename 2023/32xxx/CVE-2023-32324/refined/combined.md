=== Content from lists.debian.org_8ad869cc_20250114_231619.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3440-1] cups security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3440-1] cups security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Thu, 1 Jun 2023 21:26:45 +0000 (UTC)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/alpine.DEB.2.21.2306012125190.32453%40postfach.intern.alteholz.me)Â [alpine.DEB.2.21.2306012125190.32453@postfach.intern.alteholz.me](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3440-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                    Thorsten Alteholz
June 01, 2023                                 <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : cups
Version        : 2.2.10-6+deb10u7
CVE ID         : CVE-2023-32324

An issue has been found in cups, the Common UNIX Printing System.
Due to a buffer overflow vulnerability in the function format_log_line()

```
a remote attackers could cause a denial-of-service(DoS). The vulnerability
can be triggered when the configuration file cupsd.conf sets the value of
"loglevel" to "DEBUG".
```

For Debian 10 buster, this problem has been fixed in version
2.2.10-6+deb10u7.

We recommend that you upgrade your cups packages.

For the detailed security status of cups please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/cups>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAmR5DRVfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEcBlA//cBaLIKhAOzMADdc9oNWLTU0jrrYO/HWL/b5ao8IqQ10j9QeGI1gYD4a3
M7YkFi4V4XTZYCQz6ORHG4lwHpOlAKqPoxfkFfipRyBxo5Xtt1d/swSNAdj1k9CB
H2u9XwhmaXqPMThZcOaUiHiPa12GA9FKQtVTLIjIpgvEQIa5gZYXSj3pIf6ZfoLY
VrtoHzcBMOdIa74kkU7S4O6gGB2xhWXXPuHYcVrc8dD97FxDpyGUKop3nFDYI+JL
BlLMQidRczE85QthOFSPU3948Iqs+sX0o9xV9P+eybmtx8d3hgpJ7RGp5uErVpbk
xR26dFGvPndfT+QzQ4jJpEYyE3xyHObmmfFY8weccSEXBC9gPwdQdbceLuz/cm8j
KdXqw8ceta+MRH0oigQLRH2Q0husceX5Lvila3X1fAQN1AfibBN1fELoQYn/ZheK
ejkXUY9xbLB+mWJTS3GtuYzw2hPZMkME/fXE95us1vYhTRtg3g+6OWZ+foVGsDOQ
tCJ0+/7YIcJrYNGwXD0EyxJ0x8uo1x5q0FHlOtFjWv6iitmRJvx52Ee8d6c+CVl4
kgj4J/KdJWWClPrQAYCX8uVVO43hLRfC7/hIo/X9yqvCc7ERwzNFSVdWVJxsNbkT
wUxsLzoZrZinrttuKwgjyCOLnK7LiPb64BXsGe+oVlOvD20cxYk=
=oZJ7
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_ffbf7bdf_20250114_231618.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups%2Fsecurity%2Fadvisories%2FGHSA-cxc6-w2g7-69p7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups%2Fsecurity%2Fadvisories%2FGHSA-cxc6-w2g7-69p7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=OpenPrinting%2Fcups)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenPrinting](/OpenPrinting)
/
**[cups](/OpenPrinting/cups)**
Public

* [Notifications](/login?return_to=%2FOpenPrinting%2Fcups) You must be signed in to change notification settings
* [Fork
  209](/login?return_to=%2FOpenPrinting%2Fcups)
* [Star
   1.1k](/login?return_to=%2FOpenPrinting%2Fcups)

* [Code](/OpenPrinting/cups)
* [Issues
  28](/OpenPrinting/cups/issues)
* [Pull requests
  13](/OpenPrinting/cups/pulls)
* [Discussions](/OpenPrinting/cups/discussions)
* [Actions](/OpenPrinting/cups/actions)
* [Projects
  0](/OpenPrinting/cups/projects)
* [Wiki](/OpenPrinting/cups/wiki)
* [Security](/OpenPrinting/cups/security)
* [Insights](/OpenPrinting/cups/pulse)

Additional navigation options

* [Code](/OpenPrinting/cups)
* [Issues](/OpenPrinting/cups/issues)
* [Pull requests](/OpenPrinting/cups/pulls)
* [Discussions](/OpenPrinting/cups/discussions)
* [Actions](/OpenPrinting/cups/actions)
* [Projects](/OpenPrinting/cups/projects)
* [Wiki](/OpenPrinting/cups/wiki)
* [Security](/OpenPrinting/cups/security)
* [Insights](/OpenPrinting/cups/pulse)

# Heap buffer overflow in cupsd

High

[zdohnal](/zdohnal)
published
GHSA-cxc6-w2g7-69p7
Jun 1, 2023

## Package

actions

cups
([GitHub Actions](/advisories?query=ecosystem%3Aactions))

## Affected versions

â‰¤v2.4.2

## Patched versions

None

## Description

### Summary

A heap buffer overflow vulnerability would allow a remote attacker to lauch a dos attack.

### Details

A buffer overflow vulnerability in the function `format_log_line` could allow remote attackers to cause a denial-of-service(DoS) on the affected system (not verified for possible arbitrary code execution).

The vulnerability affects the commit #c0c4037 and the latest commit #4310a07 on the GitHub master branch as well as the latest release version v2.4.2. I have only tested these versions so far.

Exploitation of the vulnerability can be triggered when the configuration file `cupsd.conf` sets the value of `loglevel` to `DEBUG`.

Please refer to the ASAN information for the location of the vulnerability:

[![image](https://user-images.githubusercontent.com/44093631/238519064-719ef001-b3f1-4a36-a859-e90d270da449.png)](https://user-images.githubusercontent.com/44093631/238519064-719ef001-b3f1-4a36-a859-e90d270da449.png)

### Reproduce

```
git clone https://github.com/OpenPrinting/cups.git
cd cups
./configure -with-tls=no CC=clang CXX=clang+ --disable-shared

# Then modify the Makedef
# add "-fPIE" to CFLAGS CXXFLAGS
# add asan option like "-g -fsanitize=address" to CFLAGS CXXFLAGS LDFALGS

# Now complile cups
make -j
```

We then use make test to get the configuration file, or use the default cupsd.conf in ./conf/ directory (but remember to change loglevel)

```
make test  # or timeout -k 0 --preserve-status 1m make test
```

Run cups and replay the crash.raw

```
./scheduler/cupsd -c /tmp/cups-ubuntu/cupsd.conf -f
# or /scheduler/cupsd -c ./conf/cupsd.conf -f # bug remember to change the log level in conf

nc 127.0.0.1 8631 < ./crash.raw

```
### PoC

Sorry I couldn't upload the zip and the original packet, so I changed the suffix to jpg.

But github doesn't seem to change the jpg file, so you can just replay this jpg file, which I tested.

[![crash](https://user-images.githubusercontent.com/44093631/238519737-3970b338-c9cf-4fa5-8733-6ba440b3573c.png)](https://user-images.githubusercontent.com/44093631/238519737-3970b338-c9cf-4fa5-8733-6ba440b3573c.png)

### Impact

Heap buffer overflow.

### Severity

High

### CVE ID

CVE-2023-32324

### Weaknesses

No CWEs

### Credits

* [![@songxpu](https://avatars.githubusercontent.com/u/44093631?s=40&v=4)](/songxpu)
  [songxpu](/songxpu)
  Reporter

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


