=== Content from github.com_8572f93e_20250114_185339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoala%2Fgit-url-parse%2Fblob%2Fmaster%2Fgiturlparse%2Fparser.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoala%2Fgit-url-parse%2Fblob%2Fmaster%2Fgiturlparse%2Fparser.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=coala%2Fgit-url-parse)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[coala](/coala)
/
**[git-url-parse](/coala/git-url-parse)**
Public

* [Notifications](/login?return_to=%2Fcoala%2Fgit-url-parse) You must be signed in to change notification settings
* [Fork
  16](/login?return_to=%2Fcoala%2Fgit-url-parse)
* [Star
   29](/login?return_to=%2Fcoala%2Fgit-url-parse)

* [Code](/coala/git-url-parse)
* [Issues
  7](/coala/git-url-parse/issues)
* [Pull requests
  2](/coala/git-url-parse/pulls)
* [Actions](/coala/git-url-parse/actions)
* [Security](/coala/git-url-parse/security)
* [Insights](/coala/git-url-parse/pulse)

Additional navigation options

* [Code](/coala/git-url-parse)
* [Issues](/coala/git-url-parse/issues)
* [Pull requests](/coala/git-url-parse/pulls)
* [Actions](/coala/git-url-parse/actions)
* [Security](/coala/git-url-parse/security)
* [Insights](/coala/git-url-parse/pulse)

## Files

¬†master
## Breadcrumbs

1. [git-url-parse](/coala/git-url-parse/tree/master)
2. /[giturlparse](/coala/git-url-parse/tree/master/giturlparse)
/
# parser.py

Copy path Blame  Blame
## Latest commit

## History

[History](/coala/git-url-parse/commits/master/giturlparse/parser.py)114 lines (100 loc) ¬∑ 3.57 KB¬†master
## Breadcrumbs

1. [git-url-parse](/coala/git-url-parse/tree/master)
2. /[giturlparse](/coala/git-url-parse/tree/master/giturlparse)
/
# parser.py

Top
## File metadata and controls

* Code
* Blame

114 lines (100 loc) ¬∑ 3.57 KB[Raw](https://github.com/coala/git-url-parse/raw/refs/heads/master/giturlparse/parser.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114# vim: tabstop=4 shiftwidth=4 softtabstop=4
# Copyright (c) 2017 John Dewey## Permission is hereby granted, free of charge, to any person obtaining a copy# of this software and associated documentation files (the "Software"), to# deal in the Software without restriction, including without limitation the# rights to use, copy, modify, merge, publish, distribute, sublicense, and/or# sell copies of the Software, and to permit persons to whom the Software is# furnished to do so, subject to the following conditions:## The above copyright notice and this permission notice shall be included in# all copies or substantial portions of the Software.## THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER# DEALINGS IN THE SOFTWARE.
import collectionsimport re
Parsed = collections.namedtuple('Parsed', [ 'pathname', 'protocols', 'protocol', 'href', 'resource', 'user', 'port', 'name', 'owner',])
POSSIBLE\_REGEXES = ( re.compile(r'^(?P<protocol>https?|git|ssh|rsync)\://' r'(?:(?P<user>.+)@)\*' r'(?P<resource>[a-z0-9\_.-]\*)' r'[:/]\*' r'(?P<port>[\d]+){0,1}' r'(?P<pathname>\/((?P<owner>[\w\-]+)\/)?' r'((?P<name>[\w\-\.]+?)(\.git|\/)?)?)$'), re.compile(r'(git\+)?' r'((?P<protocol>\w+)://)' r'((?P<user>\w+)@)?' r'((?P<resource>[\w\.\-]+))' r'(:(?P<port>\d+))?' r'(?P<pathname>(\/(?P<owner>\w+)/)?' r'(\/?(?P<name>[\w\-]+)(\.git|\/)?)?)$'), re.compile(r'^(?:(?P<user>.+)@)\*' r'(?P<resource>[a-z0-9\_.-]\*)[:]\*' r'(?P<port>[\d]+){0,1}' r'(?P<pathname>\/?(?P<owner>.+)/(?P<name>.+).git)$'), re.compile(r'((?P<user>\w+)@)?' r'((?P<resource>[\w\.\-]+))' r'[\:\/]{1,2}' r'(?P<pathname>((?P<owner>\w+)/)?' r'((?P<name>[\w\-]+)(\.git|\/)?)?)$'),)
class ParserError(Exception): """ Error raised when a URL can't be parsed. """ pass
class Parser(object): """ A class responsible for parsing a GIT URL and return a `Parsed` object. """
 def \_\_init\_\_(self, url): self.\_url = url
 def parse(self): """ Parses a GIT URL and returns an object. Raises an exception on invalid URL.
 :returns: Parsed object :raise: :class:`.ParserError` """ d = { 'pathname': None, 'protocols': self.\_get\_protocols(), 'protocol': 'ssh', 'href': self.\_url, 'resource': None, 'user': None, 'port': None, 'name': None, 'owner': None, } for regex in POSSIBLE\_REGEXES: match = regex.search(self.\_url) if match: d.update(match.groupdict()) break else: msg = "Invalid URL '{}'".format(self.\_url) raise ParserError(msg)
 return Parsed(\*\*d)
 def \_get\_protocols(self): try: index = self.\_url.index('://') except ValueError: return []
 return self.\_url[:index].split('+')

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from pypi.org_d6c63a4a_20250114_185346.html ===

![Error Icon](/_fs-ch-1T1wmsGaOgGaSxcX/assets/errorIcon.svg)
JavaScript is disabled in your browser.
Please enable JavaScript to proceed.

A required part of this site couldn‚Äôt load. This may be due to a browser
extension, network issues, or browser settings. Please check your
connection, disable any ad blockers, or try using a different browser.



=== Content from github.com_e94bca07_20250114_185340.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7611)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7611)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=semgrep%2Fsemgrep)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[semgrep](/semgrep)
/
**[semgrep](/semgrep/semgrep)**
Public

* [Notifications](/login?return_to=%2Fsemgrep%2Fsemgrep) You must be signed in to change notification settings
* [Fork
  643](/login?return_to=%2Fsemgrep%2Fsemgrep)
* [Star
   10.9k](/login?return_to=%2Fsemgrep%2Fsemgrep)

* [Code](/semgrep/semgrep)
* [Issues
  766](/semgrep/semgrep/issues)
* [Pull requests
  8](/semgrep/semgrep/pulls)
* [Discussions](/semgrep/semgrep/discussions)
* [Actions](/semgrep/semgrep/actions)
* [Security](/semgrep/semgrep/security)
* [Insights](/semgrep/semgrep/pulse)

Additional navigation options

* [Code](/semgrep/semgrep)
* [Issues](/semgrep/semgrep/issues)
* [Pull requests](/semgrep/semgrep/pulls)
* [Discussions](/semgrep/semgrep/discussions)
* [Actions](/semgrep/semgrep/actions)
* [Security](/semgrep/semgrep/security)
* [Insights](/semgrep/semgrep/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsemgrep%2Fsemgrep%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsemgrep%2Fsemgrep%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix(cli): git URL parsing for subgroups #7611

 Merged

[brandonspark](/brandonspark)
merged 4 commits into
[develop](/semgrep/semgrep/tree/develop "semgrep/semgrep:develop")
from
[brandon/fix-subgroup-url-parsing](/semgrep/semgrep/tree/brandon/fix-subgroup-url-parsing "semgrep/semgrep:brandon/fix-subgroup-url-parsing")

Apr 25, 2023

 Merged

# [fix(cli): git URL parsing for subgroups](#top) #7611

[brandonspark](/brandonspark)
merged 4 commits into
[develop](/semgrep/semgrep/tree/develop "semgrep/semgrep:develop")
from
[brandon/fix-subgroup-url-parsing](/semgrep/semgrep/tree/brandon/fix-subgroup-url-parsing "semgrep/semgrep:brandon/fix-subgroup-url-parsing")

Apr 25, 2023

[Conversation
3](/semgrep/semgrep/pull/7611)
[Commits
4](/semgrep/semgrep/pull/7611/commits)
[Checks
0](/semgrep/semgrep/pull/7611/checks)
[Files changed](/semgrep/semgrep/pull/7611/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![brandonspark](https://avatars.githubusercontent.com/u/49291449?s=60&v=4)](/brandonspark)

Copy link

Contributor

### @brandonspark **[brandonspark](/brandonspark)** commented [Apr 24, 2023](#issue-1681786265) ‚Ä¢ edited Loading

y'all would have thought this was Lagrange's theorem, because today we're talking about subgroups

## What:

This PR fixes URL parsing for URLs which have a "subgroup" structure, which is to say that it is in a "nested grouping structure". Previously, we would butcher these URLs, and produce things like `https://https//gitlab.com/r2cexamples2/group2/group3/chess-game` from `https://gitlab.com/r2cexamples2/group2/group3/chess-game.git`.

## Why:

We want clickable URLs.

## How:

Made it such that when parsing the "owner" of a project, it can include slashes (so it might be multiple such entries in the URL, instead of just one).

## Test plan:

Added a test suite for git URL parsing, which we can use for the future.

I don't actually know what the end target URL is supposed to look like, but I presume it should look similar to what the working example is (which produces `https://gitlab.com/r2cexamples2/webgoat` from `https://gitlab.com/r2cexamples2/webgoat.git`)

Closes [PA-2669](https://linear.app/r2c/issue/PA-2669)

PR checklist:

* Purpose of the code is [evident to future readers](https://semgrep.dev/docs/contributing/contributing-code/#explaining-code)
* Tests included or PR comment includes a reproducible test plan
* Documentation is up-to-date
* A changelog entry was [added to changelog.d](https://semgrep.dev/docs/contributing/contributing-code/#adding-a-changelog-entry) for any user-facing change
* Change has no security implications (otherwise, ping security team)

If you're unsure about any of this, please see:

* [Contribution guidelines](https://semgrep.dev/docs/contributing/contributing-code)!
* [One of the more specific guides located here](https://semgrep.dev/docs/contributing/contributing/)

Sorry, something went wrong.

All reactions

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&u=6d8dc818973b445aa9843ed97bbddf1c8198b9e9&v=4)](/brandonspark)
[brandonspark](/brandonspark)
changed the title
~~fix: git URL parsing for subgroups~~
fix(cli): git URL parsing for subgroups
[Apr 24, 2023](#event-9084454985)

 [![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&u=6d8dc818973b445aa9843ed97bbddf1c8198b9e9&v=4)](/brandonspark)
[brandonspark](/brandonspark)
requested a review
from [chmccreery](/chmccreery)
[April 24, 2023 18:10](#event-9084455869)

[![@linear](https://avatars.githubusercontent.com/in/20150?s=80&v=4)](/apps/linear)

Copy link

### **[linear](/apps/linear) bot** commented [Apr 24, 2023](#issuecomment-1520616105)

| [PA-2669 Hyperlinks don't work when the GitLab repo has two or more groups](https://linear.app/r2c/issue/PA-2669/hyperlinks-dont-work-when-the-gitlab-repo-has-two-or-more-groups)   Hyperlinks are not working when the GitLab repo has subgroups, example:  <https://gitlab.com/r2cexamples2/group2/group3/chess-game.git>  Steps to reproduce the issue:   1. git clone <https://gitlab.com/r2cexamples2/group2/group3/chess-game.git> 2. cd chess-game 3. semgrep ci 4. Go to Semgrep App and check hyperlinks, the url has not been built correctly.   Note: It doesn't happen for projects with only one group such as: <https://gitlab.com/r2cexamples2/webgoat.git> |
| --- |

All reactions

Sorry, something went wrong.

[![chmccreery](https://avatars.githubusercontent.com/u/25408780?s=60&v=4)](/chmccreery)

**[chmccreery](/chmccreery)**
approved these changes
[Apr 24, 2023](#pullrequestreview-1398564309)

 [View reviewed changes](/semgrep/semgrep/pull/7611/files)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

Contributor

### **[github-actions](/apps/github-actions) bot** commented [Apr 24, 2023](#issuecomment-1520631535)

| üì∏ The pytest shapshots changed in your PR. Please carefully review these changes and make sure they are intended:   1. Review the changes at [aa93263](https://github.com/semgrep/semgrep/commit/aa932638ab83329102304ea566577ae36a01cc6b) 2. Accept the new snapshots with     ```    git fetch origin && git cherry-pick aa932638ab83329102304ea566577ae36a01cc6b && git push        ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=80&u=6d8dc818973b445aa9843ed97bbddf1c8198b9e9&v=4)](/brandonspark)

Copy link

Contributor

Author

### **[brandonspark](/brandonspark)** commented [Apr 25, 2023](#issuecomment-1521214391)

| ignore the snapshot changes, they were from a previous iteration of the PR |
| --- |

All reactions

Sorry, something went wrong.

 [brandonspark](/brandonspark)
added 4 commits
[April 25, 2023 07:59](#commits-pushed-76907e5)

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&v=4)](/brandonspark)

`[fix: git URL parsing for subgroups](/semgrep/semgrep/pull/7611/commits/76907e5f5b5ceddc1c4f88f94b3ea9831b571269 "fix: git URL parsing for subgroups")`

`[76907e5](/semgrep/semgrep/pull/7611/commits/76907e5f5b5ceddc1c4f88f94b3ea9831b571269)`

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&v=4)](/brandonspark)

`[tests: add tests for git url parsing](/semgrep/semgrep/pull/7611/commits/3ecd4d26ac5993694fbc1cacbab4fe76a59ff80e "tests: add tests for git url parsing")`

`[3ecd4d2](/semgrep/semgrep/pull/7611/commits/3ecd4d26ac5993694fbc1cacbab4fe76a59ff80e)`

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&v=4)](/brandonspark)

`[add changelog](/semgrep/semgrep/pull/7611/commits/2e180229050c6f9ebaeddb0adc5a1ccec3ec712e "add changelog")`

`[2e18022](/semgrep/semgrep/pull/7611/commits/2e180229050c6f9ebaeddb0adc5a1ccec3ec712e)`

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&v=4)](/brandonspark)

`[silly: committed a print](/semgrep/semgrep/pull/7611/commits/92beac6889f6fdf12275de4c2396171944916a03 "silly: committed a print")`

`[92beac6](/semgrep/semgrep/pull/7611/commits/92beac6889f6fdf12275de4c2396171944916a03)`

 [![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&u=6d8dc818973b445aa9843ed97bbddf1c8198b9e9&v=4)](/brandonspark)
[brandonspark](/brandonspark)
[force-pushed](/semgrep/semgrep/compare/a71b604f57c9d8092c340bb6733ca95612885eff..92beac6889f6fdf12275de4c2396171944916a03)
the
brandon/fix-subgroup-url-parsing

branch
from
[`a71b604`](/semgrep/semgrep/commit/a71b604f57c9d8092c340bb6733ca95612885eff) to
[`92beac6`](/semgrep/semgrep/commit/92beac6889f6fdf12275de4c2396171944916a03)  [Compare](/semgrep/semgrep/compare/a71b604f57c9d8092c340bb6733ca95612885eff..92beac6889f6fdf12275de4c2396171944916a03)
[April 25, 2023 15:01](#event-9093510908)

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&u=6d8dc818973b445aa9843ed97bbddf1c8198b9e9&v=4)](/brandonspark)
[brandonspark](/brandonspark)
merged commit [`52d6328`](/semgrep/semgrep/commit/52d6328f1e42aad840804282e090d5f26ccb6335)
into
develop

[Apr 25, 2023](https://github.com/semgrep/semgrep/pull/7611#event-9094123430)

 [![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=40&u=6d8dc818973b445aa9843ed97bbddf1c8198b9e9&v=4)](/brandonspark)
[brandonspark](/brandonspark)
deleted the
brandon/fix-subgroup-url-parsing

branch
[April 25, 2023 15:58](#event-9094123607)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[May 15, 2023](#ref-issue-1709315618)

[x/vulndb: potential Go vuln in github.com/returntocorp/semgrep: CVE-2023-32758
golang/vulndb#1779](/golang/vulndb/issues/1779)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7611)

Reviewers

[![@chmccreery](https://avatars.githubusercontent.com/u/25408780?s=40&v=4)](/chmccreery) [chmccreery](/chmccreery)

chmccreery approved these changes

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@brandonspark](https://avatars.githubusercontent.com/u/49291449?s=52&v=4)](/brandonspark) [![@chmccreery](https://avatars.githubusercontent.com/u/25408780?s=52&v=4)](/chmccreery)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_8dbb5340_20250114_185345.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7955)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7955)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=semgrep%2Fsemgrep)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[semgrep](/semgrep)
/
**[semgrep](/semgrep/semgrep)**
Public

* [Notifications](/login?return_to=%2Fsemgrep%2Fsemgrep) You must be signed in to change notification settings
* [Fork
  643](/login?return_to=%2Fsemgrep%2Fsemgrep)
* [Star
   10.9k](/login?return_to=%2Fsemgrep%2Fsemgrep)

* [Code](/semgrep/semgrep)
* [Issues
  766](/semgrep/semgrep/issues)
* [Pull requests
  8](/semgrep/semgrep/pulls)
* [Discussions](/semgrep/semgrep/discussions)
* [Actions](/semgrep/semgrep/actions)
* [Security](/semgrep/semgrep/security)
* [Insights](/semgrep/semgrep/pulse)

Additional navigation options

* [Code](/semgrep/semgrep)
* [Issues](/semgrep/semgrep/issues)
* [Pull requests](/semgrep/semgrep/pulls)
* [Discussions](/semgrep/semgrep/discussions)
* [Actions](/semgrep/semgrep/actions)
* [Security](/semgrep/semgrep/security)
* [Insights](/semgrep/semgrep/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsemgrep%2Fsemgrep%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsemgrep%2Fsemgrep%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix other source of slowness in git URL parser + limit URL length to 1024 #7955

 Merged

[mjambon](/mjambon)
merged 4 commits into
[develop](/semgrep/semgrep/tree/develop "semgrep/semgrep:develop")
from
[mj-fix-other-redos](/semgrep/semgrep/tree/mj-fix-other-redos "semgrep/semgrep:mj-fix-other-redos")

Jun 6, 2023

 Merged

# [Fix other source of slowness in git URL parser + limit URL length to 1024](#top) #7955

[mjambon](/mjambon)
merged 4 commits into
[develop](/semgrep/semgrep/tree/develop "semgrep/semgrep:develop")
from
[mj-fix-other-redos](/semgrep/semgrep/tree/mj-fix-other-redos "semgrep/semgrep:mj-fix-other-redos")

Jun 6, 2023

[Conversation
1](/semgrep/semgrep/pull/7955)
[Commits
4](/semgrep/semgrep/pull/7955/commits)
[Checks
0](/semgrep/semgrep/pull/7955/checks)
[Files changed](/semgrep/semgrep/pull/7955/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mjambon](https://avatars.githubusercontent.com/u/343265?s=60&v=4)](/mjambon)

Copy link

Member

### @mjambon **[mjambon](/mjambon)** commented [Jun 6, 2023](#issue-1742841694) ‚Ä¢ edited Loading

This fixes more of the same problems as [#7943](https://github.com/semgrep/semgrep/pull/7943)

test plan:

* CI for correctness
* For performance, follow these steps:

```
~/semgrep/cli/src $ python3
Python 3.8.10 (default, Mar 13 2023, 10:26:41)
[GCC 9.4.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from semgrep.meta import get_repo_name_from_repo_url
>>> get_repo_name_from_repo_url('0' * 1024)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/martin/semgrep/cli/src/semgrep/meta.py", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File "/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py", line 123, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: Invalid URL '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'

```

should fail instantly by Python standards.

The following should fail even faster with a different error message:

```
>>> get_repo_name_from_repo_url('0' * 1025)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/martin/semgrep/cli/src/semgrep/meta.py", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File "/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py", line 115, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: URL exceeds maximum supported length of 1024: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

```

PR checklist:

* Purpose of the code is [evident to future readers](https://semgrep.dev/docs/contributing/contributing-code/#explaining-code)
* Tests included or PR comment includes a reproducible test plan
* Documentation is up-to-date
* A changelog entry was [added to changelog.d](https://semgrep.dev/docs/contributing/contributing-code/#adding-a-changelog-entry) for any user-facing change
* Change has no security implications (otherwise, ping security team)

If you're unsure about any of this, please see:

* [Contribution guidelines](https://semgrep.dev/docs/contributing/contributing-code)!
* [One of the more specific guides located here](https://semgrep.dev/docs/contributing/contributing/)

Sorry, something went wrong.

All reactions

 [mjambon](/mjambon)
added 4 commits
[June 5, 2023 16:20](#commits-pushed-8f35683)

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Require port value to follow ':' and avoid CPU blowup.](/semgrep/semgrep/pull/7955/commits/8f35683fb2593ed4012700dc43a5bdbb4b8a38b1 "Require port value to follow ':' and avoid CPU blowup.")`

`[8f35683](/semgrep/semgrep/pull/7955/commits/8f35683fb2593ed4012700dc43a5bdbb4b8a38b1)`

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Impose 1024-byte limit on git URLs for performance/security reasons](/semgrep/semgrep/pull/7955/commits/2c70e93fc007374057464954f73af79b7f317cf2 "Impose 1024-byte limit on git URLs for performance/security reasons")`

`[2c70e93](/semgrep/semgrep/pull/7955/commits/2c70e93fc007374057464954f73af79b7f317cf2)`

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Add comment and update copy of Python file](/semgrep/semgrep/pull/7955/commits/0c989949f55020402ddf5d2c94f66932a926b363 "Add comment and update copy of Python file")`

`[0c98994](/semgrep/semgrep/pull/7955/commits/0c989949f55020402ddf5d2c94f66932a926b363)`

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Update changelog](/semgrep/semgrep/pull/7955/commits/43efaed4c6878c20365bb31c872bca79a0c49a38 "Update changelog")`

`[43efaed](/semgrep/semgrep/pull/7955/commits/43efaed4c6878c20365bb31c872bca79a0c49a38)`

 [![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
requested review from
[aryx](/aryx) and
[sabrinabrogren](/sabrinabrogren)
[June 6, 2023 00:15](#event-9439787350)

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=80&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)

Copy link

Member

Author

### **[mjambon](/mjambon)** commented [Jun 6, 2023](#issuecomment-1577717976)

| [@aryx](https://github.com/aryx) [@sabrinabrogren](https://github.com/sabrinabrogren) GitHub says you recently edited these files ü§∑ so you're the reviewers. |
| --- |

All reactions

Sorry, something went wrong.

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
merged commit [`7a232ef`](/semgrep/semgrep/commit/7a232efa57ec61f3bc6b58f7dd45e8fc64c2ade6)
into
develop

[Jun 6, 2023](https://github.com/semgrep/semgrep/pull/7955#event-9440267271)

 [![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
deleted the
mj-fix-other-redos

branch
[June 6, 2023 01:44](#event-9440267354)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7955)

Reviewers

[![@aryx](https://avatars.githubusercontent.com/u/332336?s=40&v=4)](/aryx) [aryx](/aryx)

 Awaiting requested review from aryx

[![@sabrinabrogren](https://avatars.githubusercontent.com/u/15618941?s=40&v=4)](/sabrinabrogren) [sabrinabrogren](/sabrinabrogren)

 Awaiting requested review from sabrinabrogren

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=52&v=4)](/mjambon)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_ca546c1b_20250114_185342.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7943)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7943)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=semgrep%2Fsemgrep)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[semgrep](/semgrep)
/
**[semgrep](/semgrep/semgrep)**
Public

* [Notifications](/login?return_to=%2Fsemgrep%2Fsemgrep) You must be signed in to change notification settings
* [Fork
  643](/login?return_to=%2Fsemgrep%2Fsemgrep)
* [Star
   10.9k](/login?return_to=%2Fsemgrep%2Fsemgrep)

* [Code](/semgrep/semgrep)
* [Issues
  766](/semgrep/semgrep/issues)
* [Pull requests
  8](/semgrep/semgrep/pulls)
* [Discussions](/semgrep/semgrep/discussions)
* [Actions](/semgrep/semgrep/actions)
* [Security](/semgrep/semgrep/security)
* [Insights](/semgrep/semgrep/pulse)

Additional navigation options

* [Code](/semgrep/semgrep)
* [Issues](/semgrep/semgrep/issues)
* [Pull requests](/semgrep/semgrep/pulls)
* [Discussions](/semgrep/semgrep/discussions)
* [Actions](/semgrep/semgrep/actions)
* [Security](/semgrep/semgrep/security)
* [Insights](/semgrep/semgrep/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsemgrep%2Fsemgrep%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsemgrep%2Fsemgrep%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix for ReDoS vulnerability #7943

 Merged

[mjambon](/mjambon)
merged 3 commits into
[develop](/semgrep/semgrep/tree/develop "semgrep/semgrep:develop")
from
[mj-fix-vuln-regex](/semgrep/semgrep/tree/mj-fix-vuln-regex "semgrep/semgrep:mj-fix-vuln-regex")

Jun 3, 2023

 Merged

# [Fix for ReDoS vulnerability](#top) #7943

[mjambon](/mjambon)
merged 3 commits into
[develop](/semgrep/semgrep/tree/develop "semgrep/semgrep:develop")
from
[mj-fix-vuln-regex](/semgrep/semgrep/tree/mj-fix-vuln-regex "semgrep/semgrep:mj-fix-vuln-regex")

Jun 3, 2023

[Conversation
0](/semgrep/semgrep/pull/7943)
[Commits
3](/semgrep/semgrep/pull/7943/commits)
[Checks
0](/semgrep/semgrep/pull/7943/checks)
[Files changed](/semgrep/semgrep/pull/7943/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mjambon](https://avatars.githubusercontent.com/u/343265?s=60&v=4)](/mjambon)

Copy link

Member

### @mjambon **[mjambon](/mjambon)** commented [Jun 3, 2023](#issue-1738989728) ‚Ä¢ edited Loading

test plan:

The last command `get_repo_name_from_repo_url(payl)` should return (and fail) instantly as shown below. It should not get stuck in a long computation.

```
~/semgrep/cli/src $ python3
Python 3.8.10 (default, Mar 13 2023, 10:26:41)
[GCC 9.4.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from semgrep.meta import get_repo_name_from_repo_url
>>> from semgrep.meta import get_url_from_sstp_url
>>> payl = 'git://' + '@' * 10000
>>> get_repo_name_from_repo_url(payl)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/martin/semgrep/cli/src/semgrep/meta.py", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File "/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py", line 117, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: Invalid URL 'git://@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'

```

PR checklist:

* Purpose of the code is [evident to future readers](https://semgrep.dev/docs/contributing/contributing-code/#explaining-code)
* Tests included or PR comment includes a reproducible test plan
* Documentation is up-to-date
* A changelog entry was [added to changelog.d](https://semgrep.dev/docs/contributing/contributing-code/#adding-a-changelog-entry) for any user-facing change
* Change has no security implications (otherwise, ping security team)

If you're unsure about any of this, please see:

* [Contribution guidelines](https://semgrep.dev/docs/contributing/contributing-code)!
* [One of the more specific guides located here](https://semgrep.dev/docs/contributing/contributing/)

Sorry, something went wrong.

All reactions

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Potential fix for ReDoS vulnerability](/semgrep/semgrep/pull/7943/commits/db648a59c6ea2b4c29fa142983b53db90f7fd086 "Potential fix for ReDoS vulnerability")`

`[db648a5](/semgrep/semgrep/pull/7943/commits/db648a59c6ea2b4c29fa142983b53db90f7fd086)`

 [![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
requested a review
from [werrett](/werrett)
[June 3, 2023 00:24](#event-9419015951)

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
changed the title
~~Potential fix for ReDoS vulnerability~~
Fix for ReDoS vulnerability
[Jun 3, 2023](#event-9419053616)

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Update changelog](/semgrep/semgrep/pull/7943/commits/627fb232934116c339d9e95f34cd3fecfe0c2c2e "Update changelog")`

`[627fb23](/semgrep/semgrep/pull/7943/commits/627fb232934116c339d9e95f34cd3fecfe0c2c2e)`

 [![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
requested review from
a team,
[ihji](/ihji) and
[emjin](/emjin)
and removed request for
a team
[June 3, 2023 00:55](#event-9419100670)

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&v=4)](/mjambon)

`[Update changelog](/semgrep/semgrep/pull/7943/commits/3fe97612d708fdbaf833a2bf2541eb8406ba4293 "Update changelog")`

`[3fe9761](/semgrep/semgrep/pull/7943/commits/3fe97612d708fdbaf833a2bf2541eb8406ba4293)`

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
merged commit [`55cafa9`](/semgrep/semgrep/commit/55cafa9bdefbced0d8d0d75f36f335fa24c6cafe)
into
develop

[Jun 3, 2023](https://github.com/semgrep/semgrep/pull/7943#event-9419412412)

 [![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
deleted the
mj-fix-vuln-regex

branch
[June 3, 2023 02:16](#event-9419412487)

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)
[mjambon](/mjambon)
mentioned this pull request
[Jun 6, 2023](#ref-pullrequest-1742841694)

[Fix other source of slowness in git URL parser + limit URL length to 1024
#7955](/semgrep/semgrep/pull/7955)
 Merged

5 tasks

[mjambon](/mjambon)
added a commit
that referenced
this pull request
[Jun 6, 2023](#ref-commit-7a232ef)
[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=40&u=75efc59650c21e39a21b7829853ebdfd9d3859ff&v=4)](/mjambon)

`[Fix other source of slowness in git URL parser + limit URL length to ‚Ä¶](/semgrep/semgrep/commit/7a232efa57ec61f3bc6b58f7dd45e8fc64c2ade6 "Fix other source of slowness in git URL parser + limit URL length to 1024 (#7955)

This fixes more of the same problems as
https://github.com/returntocorp/semgrep/pull/7943

test plan:
* CI for correctness
* For performance, follow these steps:

```
~/semgrep/cli/src $ python3
Python 3.8.10 (default, Mar 13 2023, 10:26:41)
[GCC 9.4.0] on linux
Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.
>>> from semgrep.meta import get_repo_name_from_repo_url
>>> get_repo_name_from_repo_url('0' * 1024)
Traceback (most recent call last):
  File \"<stdin>\", line 1, in <module>
  File \"/home/martin/semgrep/cli/src/semgrep/meta.py\", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File \"/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py\", line 123, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: Invalid URL '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
```
should fail instantly by Python standards.

The following should fail even faster with a different error message:
```
>>> get_repo_name_from_repo_url('0' * 1025)
Traceback (most recent call last):
  File \"<stdin>\", line 1, in <module>
  File \"/home/martin/semgrep/cli/src/semgrep/meta.py\", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File \"/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py\", line 115, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: URL exceeds maximum supported length of 1024: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

PR checklist:

- [x] Purpose of the code is [evident to future
readers](https://semgrep.dev/docs/contributing/contributing-code/#explaining-code)
- [x] Tests included or PR comment includes a reproducible test plan
- [x] Documentation is up-to-date
- [x] A changelog entry was [added to
changelog.d](https://semgrep.dev/docs/contributing/contributing-code/#adding-a-changelog-entry)
for any user-facing change
- [ ] Change has no security implications (otherwise, ping security
team)

If you're unsure about any of this, please see:

- [Contribution
guidelines](https://semgrep.dev/docs/contributing/contributing-code)!
- [One of the more specific guides located
here](https://semgrep.dev/docs/contributing/contributing/)

---------

Co-authored-by: Martin Jambon <martin@semgrep.com>")`
‚Ä¶

`[7a232ef](/semgrep/semgrep/commit/7a232efa57ec61f3bc6b58f7dd45e8fc64c2ade6)`

```
‚Ä¶1024 ([#7955](https://github.com/semgrep/semgrep/pull/7955))

This fixes more of the same problems as
[#7943](https://github.com/semgrep/semgrep/pull/7943)

test plan:
* CI for correctness
* For performance, follow these steps:

```
~/semgrep/cli/src $ python3
Python 3.8.10 (default, Mar 13 2023, 10:26:41)
[GCC 9.4.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from semgrep.meta import get_repo_name_from_repo_url
>>> get_repo_name_from_repo_url('0' * 1024)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/martin/semgrep/cli/src/semgrep/meta.py", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File "/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py", line 123, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: Invalid URL '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
```
should fail instantly by Python standards.

The following should fail even faster with a different error message:
```
>>> get_repo_name_from_repo_url('0' * 1025)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/martin/semgrep/cli/src/semgrep/meta.py", line 60, in get_repo_name_from_repo_url
    result = p.parse()
  File "/home/martin/semgrep/cli/src/semgrep/external/git_url_parser.py", line 115, in parse
    raise ParserError(msg)
semgrep.external.git_url_parser.ParserError: URL exceeds maximum supported length of 1024: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

PR checklist:

- [x] Purpose of the code is [evident to future
readers](<https://semgrep.dev/docs/contributing/contributing-code/#explaining-code>)
- [x] Tests included or PR comment includes a reproducible test plan
- [x] Documentation is up-to-date
- [x] A changelog entry was [added to
changelog.d](<https://semgrep.dev/docs/contributing/contributing-code/#adding-a-changelog-entry>)
for any user-facing change
- [ ] Change has no security implications (otherwise, ping security
team)

If you're unsure about any of this, please see:

- [Contribution
guidelines](<https://semgrep.dev/docs/contributing/contributing-code>)!
- [One of the more specific guides located
here](<https://semgrep.dev/docs/contributing/contributing/>)

---------

Co-authored-by: Martin Jambon <martin@semgrep.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsemgrep%2Fsemgrep%2Fpull%2F7943)

Reviewers

[![@werrett](https://avatars.githubusercontent.com/u/335226?s=40&v=4)](/werrett) [werrett](/werrett)

 Awaiting requested review from werrett

[![@ihji](https://avatars.githubusercontent.com/u/61807?s=40&v=4)](/ihji) [ihji](/ihji)

 Awaiting requested review from ihji

 ihji was automatically assigned from semgrep/pa

[![@emjin](https://avatars.githubusercontent.com/u/5942585?s=40&v=4)](/emjin) [emjin](/emjin)

 Awaiting requested review from emjin

 emjin was automatically assigned from semgrep/pa

Assignees

No one assigned

Labels

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@mjambon](https://avatars.githubusercontent.com/u/343265?s=52&v=4)](/mjambon)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


