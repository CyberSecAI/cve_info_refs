=== Content from securitylab.github.com_2041f47f_20250115_090102.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 7, 2023
# GHSL-2023-081\_GHSL-2023-082: Tar Slip vulnerabilities in Autolab - CVE-2023-32676, CVE-2023-32317

[![Author avatar](https://avatars.githubusercontent.com/u/176818)
Peter Stöckli](https://github.com/p-)

## Coordinated Disclosure Timeline

* 2023-04-12: Reported vulnerability via GitHub’s [private vulnerability reporting](https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability) feature.
* 2023-05-21 Vulnerabilities were fixed and advisories were published [1](https://github.com/autolab/Autolab/security/advisories/GHSA-x9hj-r9q4-832c), [2](https://github.com/autolab/Autolab/security/advisories/GHSA-h8g5-vhm4-wx6g).

## Summary

Two Tar Slip vulnerabilities were found in Autolab. Those vulnerabilities could have allowed attackers to create or replace files on the file system that in the worst case could have been executed by the application or system itself.

## Product

Autolab

## Tested Version

[v2.10.0](https://github.com/autolab/Autolab/releases/tag/v2.10.0)

## Details

### Issue 1: Tar slip in Install Assessment functionality (`GHSL-2023-081`)

A Tar slip vulnerability was found in the Install assessment functionality of Autolab. To exploit this vulnerability an authenticated attacker with instructor permissions needs to upload a specially crafted Tar file.
Using the install assessment functionality an attacker can feed a Tar file that contain files with paths pointing outside of the target directory (e.g., `../../../../tmp/tarslipped1.sh`). When the Install assessment form is submitted the files inside of the archives are expanded to the attacker-chosen locations.

[Following line](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/assessments_controller.rb#L199-L199) inside the method [`importAsmtFromTar`](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/assessments_controller.rb#L146) writes the file to the destination defined by the attacker:

```
File.open(File.join(course_root, relative_pathname), "wb") do |f|

```

This `relative_pathname` variable uses the `full_name` [retrieved from the archive](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/assessments_controller.rb#L192).

```
relative_pathname = entry.full_name

```

This vulnerability was discovered with the help of [CodeQL](https://codeql.github.com/).

#### Proof of Concept

Preconditions:

1. Attacker needs to be logged in as instructor
2. There needs to be an existing course where the instructor has access permissions

The attacker can then visit the following link in the browser to install an assessment:

```
https://<autolab-host>/courses/<course-slug>/assessments/install_assessment

```

On this page the attacker can specify a specially crafted tar ball (see `exploitlab.tar` in Resources) in the “Import from tarball” section.
After selecting the malicious tar ball the form is submitted and the tar ball unzipped.

In the case of a successful exploitation, a file named `tarslipped1.sh` should appear in the `/tmp` folder of the exploited system.

#### Impact

This issue may lead to arbitrary file write. It may lead up to Remote Code Execution if it’s possible to write to a file which is later executed.

#### Resources

To reproduce the vulnerability a tar archive of an existing assessment can be extended as follows:

* Create a file in `/tmp/`:

```
touch /tmp/tarslipped1.sh

```

* Append the newly created file to the existing assessment tar archive (named `exploitlab.tar`):
  ```
  tar -rf exploitlab.tar ../../../../../../../../tmp/tarslipped1.sh

  ```

### Issue 2: Tar slip in cheat checker functionality (`GHSL-2023-082`)

A Tar slip vulnerability was found in the MOSS cheat checker functionality of Autolab. To exploit this vulnerability an authenticated attacker with instructor permissions needs to upload a specially crafted Tar file. Both “Base File Tar” and “Additional file archive” can be fed with Tar files that contain paths outside their target directories (e.g., `../../../../tmp/tarslipped2.sh`). When the MOSS cheat checker is started the files inside of the archives are expanded to the attacker-chosen locations.

[Following line](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/courses_controller.rb#L1109-L1109) inside the method [`extract_tar_for_moss`](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/courses_controller.rb#L1065) writes the file to the destination defined by the attacker:

```
File.open(destination, "wb") do |out|

```

This `destination` variable uses the `pathname` [retrieved from the archive](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/courses_controller.rb#L1098).

```
pathname = Archive.get_entry_name(entry)

```

It looks like the same method contains [a sanitizer of sorts](https://github.com/autolab/Autolab/blob/b31a620ea6e9c015fcd59f555c2e562734fe68d7/app/controllers/courses_controller.rb#L1107) that might have been intended to prevent such scenarios:

```
pathname.gsub!(%r{/}, "-")

```

Unfortunately, the variable `pathname` is not used anymore after this line.

This vulnerability was discovered with the help of [CodeQL](https://codeql.github.com/).

#### Proof of Concept

Preconditions:

1. Attacker needs to be logged in as instructor
2. There needs to be an existing course where the instructor has access permissions

The attacker can then visit the following in the browser to run the MOSS cheat checker:

```
https://<autolab-host>/courses/<course-slug>/moss

```

On this page the attacker can specify a specially crafted tar ball (see `tarslip.tar` in Resources). The Tar ball can either be submitted under “Step 2” as “Base file” (“Base File tar” needs to be enabled as well) or under “Step 3” as “Additional file archive”.
After specifying a malicious tar ball the attacker can submit the form by clicking on “GO!”.

In the case of a successful exploitation, a file named `tarslipped2.sh` should appear in the `/tmp` folder of the exploited system.

#### Impact

This issue may lead to arbitrary file write. It may lead up to Remote Code Execution if it’s possible to write to a file which is later executed.

#### Resources

To reproduce the vulnerability a tar archive can be created as follows:

* Create a file in `/tmp/`:

```
touch /tmp/tarslipped2.sh

```

* Create a tar file:
  ```
  tar -cvf tarslip.tar ../../../../../../../../tmp/tarslipped2.sh

  ```

In the case of a successful exploitation, a file named `tarslipped2.sh` should appear in the `/tmp` folder of the exploited system.

## CVE

* CVE-2023-32676 Tar slip in Install Assessment functionality
* CVE-2023-32317 Tar slip in cheat checker functionality

## Credit

These issues were discovered and reported by GHSL team member [@p- (Peter Stöckli)](https://github.com/p-).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-081` or `GHSL-2023-082` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_40259195_20250115_090101.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fsecurity%2Fadvisories%2FGHSA-h8g5-vhm4-wx6g)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fsecurity%2Fadvisories%2FGHSA-h8g5-vhm4-wx6g)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=autolab%2FAutolab)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[autolab](/autolab)
/
**[Autolab](/autolab/Autolab)**
Public

* [Notifications](/login?return_to=%2Fautolab%2FAutolab) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2Fautolab%2FAutolab)
* [Star
   771](/login?return_to=%2Fautolab%2FAutolab)

* [Code](/autolab/Autolab)
* [Issues
  147](/autolab/Autolab/issues)
* [Pull requests
  14](/autolab/Autolab/pulls)
* [Discussions](/autolab/Autolab/discussions)
* [Actions](/autolab/Autolab/actions)
* [Projects
  0](/autolab/Autolab/projects)
* [Wiki](/autolab/Autolab/wiki)
* [Security](/autolab/Autolab/security)
* [Insights](/autolab/Autolab/pulse)

Additional navigation options

* [Code](/autolab/Autolab)
* [Issues](/autolab/Autolab/issues)
* [Pull requests](/autolab/Autolab/pulls)
* [Discussions](/autolab/Autolab/discussions)
* [Actions](/autolab/Autolab/actions)
* [Projects](/autolab/Autolab/projects)
* [Wiki](/autolab/Autolab/wiki)
* [Security](/autolab/Autolab/security)
* [Insights](/autolab/Autolab/pulse)

# Tar slip in cheat checker functionality (`GHSL-2023-082`)

Moderate

[damianhxy](/damianhxy)
published
GHSA-h8g5-vhm4-wx6g
May 21, 2023

## Package

bundler

Autolab
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

<= 2.10.0

## Patched versions

2.11.0

## Description

### Impact

A Tar slip vulnerability was found in Autolab's MOSS functionality, whereby an instructor with access to the feature can perform an arbitrary file write.

### Patches

The vulnerability has been patched in v2.11.0.

### Workarounds

There are no feasible workarounds for this issue.

### References

* [Zip Slip Vulnerability](https://security.snyk.io/research/zip-slip-vulnerability)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in <https://github.com/autolab/Autolab/>
* Email us at autolab-dev@andrew.cmu.edu

### Severity

Moderate

6.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H

### CVE ID

CVE-2023-32317

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@p-](https://avatars.githubusercontent.com/u/176818?s=40&v=4)](/p-)
  [p-](/p-)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_37a9a4dd_20250115_090101.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fcommit%2F410a9228ee265f80692334d75eb2c3b4dac6f9e5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fcommit%2F410a9228ee265f80692334d75eb2c3b4dac6f9e5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=autolab%2FAutolab)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[autolab](/autolab)
/
**[Autolab](/autolab/Autolab)**
Public

* [Notifications](/login?return_to=%2Fautolab%2FAutolab) You must be signed in to change notification settings
* [Fork
  226](/login?return_to=%2Fautolab%2FAutolab)
* [Star
   771](/login?return_to=%2Fautolab%2FAutolab)

* [Code](/autolab/Autolab)
* [Issues
  147](/autolab/Autolab/issues)
* [Pull requests
  14](/autolab/Autolab/pulls)
* [Discussions](/autolab/Autolab/discussions)
* [Actions](/autolab/Autolab/actions)
* [Projects
  0](/autolab/Autolab/projects)
* [Wiki](/autolab/Autolab/wiki)
* [Security](/autolab/Autolab/security)
* [Insights](/autolab/Autolab/pulse)

Additional navigation options

* [Code](/autolab/Autolab)
* [Issues](/autolab/Autolab/issues)
* [Pull requests](/autolab/Autolab/pulls)
* [Discussions](/autolab/Autolab/discussions)
* [Actions](/autolab/Autolab/actions)
* [Projects](/autolab/Autolab/projects)
* [Wiki](/autolab/Autolab/wiki)
* [Security](/autolab/Autolab/security)
* [Insights](/autolab/Autolab/pulse)

## Commit

[Permalink](/autolab/Autolab/commit/410a9228ee265f80692334d75eb2c3b4dac6f9e5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-h8g5-vhm4-wx6g](https://github.com/autolab/Autolab/security/advisories/GHSA-h8g5-vhm4-wx6g "GHSA-h8g5-vhm4-wx6g")

[Browse files](/autolab/Autolab/tree/410a9228ee265f80692334d75eb2c3b4dac6f9e5)
Browse the repository at this point in the history

* Loading branch information

[![@damianhxy](https://avatars.githubusercontent.com/u/9074856?s=40&v=4)](/damianhxy)

[damianhxy](/autolab/Autolab/commits?author=damianhxy "View all commits by damianhxy")
authored
May 17, 2023

1 parent
[1940740](/autolab/Autolab/commit/1940740544008ff03f9766bffe10b38fa3804e16)

commit 410a922

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**21 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* app/controllers

  + app/controllers/courses\_controller.rb
    [courses\_controller.rb](#diff-6587ddd8f759a5e02861d5421da0cf20bdfd264f22b6b3ab83e1caff3b154973)
* lib

  + lib/archive.rb
    [archive.rb](#diff-d635a71cae7753686a4b5642c383c644bb124fd4a195d97228d0228ca94416e5)

## There are no files selected for viewing

16 changes: 10 additions & 6 deletions

16
[app/controllers/courses\_controller.rb](#diff-6587ddd8f759a5e02861d5421da0cf20bdfd264f22b6b3ab83e1caff3b154973 "app/controllers/courses_controller.rb")

Show comments

[View file](/autolab/Autolab/blob/410a9228ee265f80692334d75eb2c3b4dac6f9e5/app/controllers/courses_controller.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,7 @@ |
|  |  | require "archive" |
|  |  | require "csv" |
|  |  | require "fileutils" |
|  |  | require "pathname" |
|  |  | require "statistics" |
|  |  |  |
|  |  | class CoursesController < ApplicationController |
| Expand Down  Expand Up | | @@ -1107,15 +1108,18 @@ def extract\_tar\_for\_moss(tmp\_dir, external\_tar, archive) |
|  |  | pathname = Archive.get\_entry\_name(entry) |
|  |  | next if Archive.looks\_like\_directory?(pathname) |
|  |  |  |
|  |  | destination = if archive |
|  |  | File.join(extFilesDir, |
|  |  | pathname) |
|  |  | output\_dir = if archive |
|  |  | extFilesDir |
|  |  | else |
|  |  | File.join(baseFilesDir, pathname) |
|  |  | baseFilesDir |
|  |  | end |
|  |  | pathname.gsub!(%r{/}, "-") |
|  |  | output\_file = File.join(output\_dir, pathname) |
|  |  |  |
|  |  | # skip if the file lies outside the archive |
|  |  | next unless Archive.in\_dir?(Pathname(output\_file), Pathname(output\_dir)) |
|  |  |  |
|  |  | # make sure all subdirectories are there |
|  |  | File.open(destination, "wb") do |out| |
|  |  | File.open(output\_file, "wb") do |out| |
|  |  | out.write Archive.read\_entry\_file(entry) |
|  |  | begin |
|  |  | out.fsync |
| Expand Down | |  |

11 changes: 11 additions & 0 deletions

11
[lib/archive.rb](#diff-d635a71cae7753686a4b5642c383c644bb124fd4a195d97228d0228ca94416e5 "lib/archive.rb")

Show comments

[View file](/autolab/Autolab/blob/410a9228ee265f80692334d75eb2c3b4dac6f9e5/lib/archive.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -232,4 +232,15 @@ def self.create\_zip(paths) |
|  |  | def self.looks\_like\_directory?(pathname) |
|  |  | pathname.ends\_with?("/") |
|  |  | end |
|  |  |  |
|  |  | # Check if a path lies (strictly) within a directory |
|  |  | # Takes two Pathname objects |
|  |  | # https://gist.github.com/henrik/48e8bb74de9d887770dfb3cc6efaa9b2 |
|  |  | def self.in\_dir?(path, dir) |
|  |  | path\_parts = path.expand\_path.each\_filename.to\_a |
|  |  | dir\_parts = dir.expand\_path.each\_filename.to\_a |
|  |  | return false if path\_parts == dir\_parts |
|  |  |  |
|  |  | dir\_parts.zip(path\_parts).all? { |x, y| x == y } |
|  |  | end |
|  |  | end |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `410a922`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fautolab%2FAutolab%2Fcommit%2F410a9228ee265f80692334d75eb2c3b4dac6f9e5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


