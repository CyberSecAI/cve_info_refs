=== Content from advisory.splunk.com_8b9a1e14_20250114_191825.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# HTTP Response Splitting via the ‘rest’ SPL Command

**Advisory ID:** SVD-2023-0603

**CVE ID:** [CVE-2023-32708](https://www.cve.org/CVERecord?id=CVE-2023-32708)

**Published:** 2023-06-01

**Last Update:** 2023-06-01

**CVSSv3.1 Score:** 7.2, High

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

**CWE:** [CWE-113](https://cwe.mitre.org/data/definitions/113.html)

**Bug ID:** SPL-235203

## Description

A low-privileged user can trigger an HTTP response splitting vulnerability with the ‘rest’ SPL command that lets them potentially access other REST endpoints in the system arbitrarily, including viewing restricted content.

## Solution

For Splunk Enterprise, upgrade versions to 9.0.5, 8.2.11, 8.1.14, or higher.

For Splunk Cloud Platform, Splunk is monitoring and patching affected instances.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 8.1 | Splunk Web | 8.1.0 to 8.1.13 | 8.1.14 |
| Splunk Enterprise | 8.2 | Splunk Web | 8.2.0 to 8.2.10 | 8.2.11 |
| Splunk Enterprise | 9.0 | Splunk Web | 9.0.0 to 9.0.4 | 9.0.5 |
| Splunk Cloud Platform |  | Splunk Web | 9.0.2303 and lower | 9.0.2303.100 |

## Mitigations and Workarounds

For Splunk Enterprise, limit the number of searches a process can run by editing the limits.conf configuration file and giving the ‘max\_searches\_per\_process’ setting a value of either 1 or 0.

For Splunk Cloud Platform, file a support ticket to adjust this configuration setting.

## Detections

* [Splunk http response splitting via rest SPL command](https://research.splunk.com/application/e615a0e1-a1b2-4196-9865-8aa646e1708c/)

This detection search provides information about a possible HTTP response splitting exploitation In Splunk Enterprise versions below 9.0.5, 8.2.11, and 8.1.14.

## Severity

Splunk rated the vulnerability as High, 7.2, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H.

## Acknowledgments

Danylo Dmytriiev (DDV\_UA)

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)

=== Content from research.splunk.com_ffda93dc_20250114_191827.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk HTTP Response Splitting Via Rest SPL Command

Updated Date: 2024-10-17
ID: e615a0e1-a1b2-4196-9865-8aa646e1708c
Author: Rod Soto, Chase Franklin
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies attempts to exploit an HTTP response splitting vulnerability via the rest SPL command in Splunk. It detects this activity by analyzing audit logs for specific search commands that include REST methods like POST, PUT, PATCH, or DELETE. This behavior is significant because it indicates a potential attempt to access restricted REST endpoints, which could lead to unauthorized access to sensitive information. If confirmed malicious, this activity could allow an attacker to access restricted content, such as password files, by injecting commands into HTTP requests.

### Search

```
1`audit_searches` AND search IN ("*
2|*rest*POST*","*
3|*rest*PUT*","*
4|*rest*PATCH*","*
5|*rest*DELETE*") AND NOT search="*audit_searches*"
6| table user info has_error_msg search _time
7| `splunk_http_response_splitting_via_rest_spl_command_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [audit\_searches](https://github.com/splunk/security_content/blob/develop/macros/audit_searches.yml) | `index=_audit sourcetype=audittrail action=search` |
| splunk\_http\_response\_splitting\_via\_rest\_spl\_command\_filter | `search *` |

`splunk_http_response_splitting_via_rest_spl_command_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1027.006](https://attack.mitre.org/techniques/T1027/006/) | HTML Smuggling | Defense Evasion |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

APT29

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

This detection does not require you to ingest any new data. The detection does require the ability to search the \_audit index. This search may assist in detecting possible http response splitting exploitation attemptss.

### Known False Positives

This search may have produce false positives as malformed or erroneous requests made to this endpoint may be executed willingly or erroneously by operators.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Suspicious access by $user$ | 25 | 50 | 50 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1027.006/splunk/splunk_http_response_splitting_via_rest_spl_command.log) | `audittrail` | `audittrail` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1027.006/splunk/splunk_http_response_splitting_via_rest_spl_command.log) | `audittrail` | `audittrail` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_http_response_splitting_via_rest_spl_command.yml) |
Version: **3**

[Detection: Splunk Enterprise KV Store Incorrect Authorization](https://research.splunk.com/application/8f0e8380-a835-4f2b-b749-9ce119364df0/ "Detection: Splunk Enterprise KV Store Incorrect Authorization")

[Detection: Splunk Identified SSL TLS Certificates](https://research.splunk.com/network/620fbb89-86fd-4e2e-925f-738374277586/ "Detection: Splunk Identified SSL TLS Certificates")

Â© 2005 - 2024 Splunk LLC All rights reserved.


