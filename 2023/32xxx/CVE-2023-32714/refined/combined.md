=== Content from research.splunk.com_e53dde80_20250114_224738.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk Path Traversal In Splunk App For Lookup File Edit

Updated Date: 2024-10-17
ID: 8ed58987-738d-4917-9e44-b8ef6ab948a6
Author: Rod Soto, Eric McGinnis
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

The following analytic identifies path traversal attempts in the Splunk App for Lookup File Editing. It detects specially crafted web requests targeting lookup files by analyzing the `uri_query` field in the `_internal` index. This activity is significant because it allows low-privilege users to read and write to restricted areas of the Splunk installation directory, potentially accessing sensitive files like password hashes. If confirmed malicious, this could lead to unauthorized access, data breaches, and further exploitation of the Splunk environment.

### Search

```
1`splunkda` uri_query=*lookup_file*
2| table clientip uri_query lookup_file owner namespace  version
3| stats count by clientip namespace lookup_file uri_query
4| `splunk_path_traversal_in_splunk_app_for_lookup_file_edit_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunkda](https://github.com/splunk/security_content/blob/develop/macros/splunkda.yml) | `index=_internal sourcetype=splunkd_access` |
| splunk\_path\_traversal\_in\_splunk\_app\_for\_lookup\_file\_edit\_filter | `search *` |

`splunk_path_traversal_in_splunk_app_for_lookup_file_edit_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1083](https://attack.mitre.org/techniques/T1083/) | File and Directory Discovery | Discovery |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

APT18
APT28
APT3
APT32
APT38
APT39
APT41
APT5
Aoqin Dragon
BRONZE BUTLER
Chimera
Confucius
Dark Caracal
Darkhotel
Dragonfly
FIN13
Fox Kitten
Gamaredon Group
HAFNIUM
Inception
Ke3chang
Kimsuky
Lazarus Group
Leafminer
LuminousMoth
Magic Hound
MuddyWater
Mustang Panda
Patchwork
Play
RedCurl
Sandworm Team
Scattered Spider
Sidewinder
Sowbug
TeamTNT
ToddyCat
Tropic Trooper
Turla
Volt Typhoon
Windigo
Winnti Group
Winter Vivern
admin@338
menuPass

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

This detection does not require you to ingest any new data. The detection does require the ability to search the \_internal index. This detection is meant for on premise environments, and if executed on internet facing servers without a WAF may produce a lot of results. This detection will not work against obfuscated path traversal requests.

### Known False Positives

This search may find additional path traversal exploitation attempts or malformed requests.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Path traversal exploitation attempt from $clientip$ | 40 | 50 | 80 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1083/splunk/splunk_path_traversal_in_splunk_app_for_lookup_file_edit.log) | `splunkd_access` | `splunkd_access` |
| Integration | â Passing | [Dataset](https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1083/splunk/splunk_path_traversal_in_splunk_app_for_lookup_file_edit.log) | `splunkd_access` | `splunkd_access` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_path_traversal_in_splunk_app_for_lookup_file_edit.yml) |
Version: **3**

[Detection: Splunk Low-Priv Search as nobody SplunkDeploymentServerConfig App](https://research.splunk.com/application/f765c3fe-c3b6-4afe-a932-11dd4f3a024f/ "Detection: Splunk Low-Priv Search as nobody SplunkDeploymentServerConfig App")

[Detection: Splunk Persistent XSS via Props Conf](https://research.splunk.com/application/d7b5aa71-157f-4359-9c34-e35752b1d0a2/ "Detection: Splunk Persistent XSS via Props Conf")

Â© 2005 - 2024 Splunk LLC All rights reserved.



=== Content from advisory.splunk.com_20eefdc0_20250114_224736.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Path Traversal in Splunk App for Lookup File Editing

**Advisory ID:** SVD-2023-0608

**CVE ID:** [CVE-2023-32714](https://www.cve.org/CVERecord?id=CVE-2023-32714)

**Published:** 2023-06-01

**Last Update:** 2023-06-01

**CVSSv3.1 Score:** 8.1, High

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)

**CWE:** [CWE-35](https://cwe.mitre.org/data/definitions/35.html)

**Bug ID:** LOOKUP-177

## Description

A low-privileged user with access to the Splunk App for Lookup File Editing can, with a specially crafted web request, trigger a path traversal exploit that can then be used to read and write to restricted areas of the Splunk installation directory.

## Solution

Upgrade the Splunk App for Lookup Editing to version 4.0.1 or higher.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk App for Lookup File Editing | 4.0 |  | 4.0 and lower | 4.0.1 |

## Mitigations and Workarounds

N/A

## Detections

* [Splunk path traversal in Splunk App for Lookup file edit](https://research.splunk.com/application/8ed58987-738d-4917-9e44-b8ef6ab948a6/)

This detection search provides information about path traversal exploitation attempts in Splunk Enterprise versions below 9.0.5, 8.2.11, and 8.1.14.

## Severity

Splunk rated the vulnerability as High, 8.1, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N.

## Acknowledgments

Torjus Bryne Retterstøl, Binary Security

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)
