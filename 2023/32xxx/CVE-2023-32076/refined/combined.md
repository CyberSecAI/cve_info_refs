=== Content from github.com_d80f9d2d_20250114_223733.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fspecification%2Fsecurity%2Fadvisories%2FGHSA-p86f-xmg6-9q4x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fspecification%2Fsecurity%2Fadvisories%2FGHSA-p86f-xmg6-9q4x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=in-toto%2Fspecification)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[in-toto](/in-toto)
/
**[specification](/in-toto/specification)**
Public

* [Notifications](/login?return_to=%2Fin-toto%2Fspecification) You must be signed in to change notification settings
* [Fork
  27](/login?return_to=%2Fin-toto%2Fspecification)
* [Star
   42](/login?return_to=%2Fin-toto%2Fspecification)

* [Code](/in-toto/specification)
* [Issues
  7](/in-toto/specification/issues)
* [Pull requests
  2](/in-toto/specification/pulls)
* [Actions](/in-toto/specification/actions)
* [Projects
  0](/in-toto/specification/projects)
* [Security](/in-toto/specification/security)
* [Insights](/in-toto/specification/pulse)

Additional navigation options

* [Code](/in-toto/specification)
* [Issues](/in-toto/specification/issues)
* [Pull requests](/in-toto/specification/pulls)
* [Actions](/in-toto/specification/actions)
* [Projects](/in-toto/specification/projects)
* [Security](/in-toto/specification/security)
* [Insights](/in-toto/specification/pulse)

# Functionaries Do Not Perform Verification

High

[adityasaky](/adityasaky)
published
GHSA-p86f-xmg6-9q4x
Apr 4, 2023

## Package

No package listed

## Affected versions

<=0.9

## Patched versions

None

## Description

### Impact

This security audit describes a vulnerability in the in-toto architecture, which allows an attacker, who controls the product in transit, to compromise the whole supply chain and stay undetected.

This is achieved by modifying the product in transit in such a way that the product itself can compromise a subsequent functionary, in order to (1) introduce malicious artifacts into the supply chain and (2) fake the corresponding link metadata.

To stay undetected the material hashes in the link metadata must be faked to match the original product, as reported by the preceding link metadata, and not the tampered one, which was actually used as material.

While in-toto is not designed to protect against the compromise of individual functionaries, beyond supporting link metadata thresholds, this specific case of functionary compromise needs to be taken seriously, because the in-toto threat model indeed claims that it protects against unauthorized modification of the product in transit.

An example of this compromise uses the following simple supply chain scenario:

* A 'tag' step has source code files as products.
* A 'build' step has source code files as materials and a binary as a product.
* A layout defines that materials of 'build' must match products of 'tag', and that the final product must match the product of 'build'.

This attack is successful when:

* The attacker can modify the source code between ‘tag’ and ‘build’ steps. Some examples of how this may occur are by compromising the functionary performing the tag or by being a man-in-the-middle on the network if insecure protocols are used.
* The functionary, who builds the attacker-modified source code, unwittingly produces
  + a compromised product, and
  + incorrect link metadata, which lists the benign source code files as materials, instead of the tampered ones that were actually used.
* No other step in the supply chain detects the mismatch between the products reported by the 'tag' step and the tampered ones.

Note that a malicious functionary could always have performed whatever malicious action they like on the products they produce. However, this vulnerability gives them the additional ability to compromise later functionaries in some cases. This can not only hide the location of the compromise, but may also be used to cause later functionaries to fail to perform their steps (e.g., validate, test, fuzz, package, etc.) correctly.

### Patches

### Workarounds

#### Partial verification of layouts

Security auditors recommend to "have each functionary verify the steps before to ensure all actions are performed on trusted data".

The idea of partial verification of layouts is not new to the in-toto team (see references), but has intentionally not been adopted, in order to not sacrifice generality or require drastic specification changes, because:

* The order of steps in an in-toto layout does not necessarily reflect the order in which steps are carried out.
* The artifact rules of any step may reference the artifacts of any other step in the supply chain, not only adjacent ones.
* Functionaries otherwise don't need to have access to any other link or layout metadata.
* The only way of matching local artifacts with the artifacts reported from link metadata is by the use of inspections. However, the layout cannot define inspections to be executed mid-way.

The volume of required changes and workaround in order to solve the reported issue with partial layout verification makes this solution undesirable.

#### Custom verification of preceding links

Alternatively, a non-in-toto-compliant functionary-side verification could be developed, which considers only the preceding link metadata file, and matches its products to the local artifacts used by the functionary. This feature was added strictly for convenience to the [in-toto reference implementation](https://github.com/in-toto/in-toto/pull/589).

However, relying on this feature is not recommended as it requires an out-of-band negotiation about what the preceding link metadata is, who is authorized to sign it, and how it relates to the materials the verifying functionary is operating on.

These prerequisites amount to a similar set of policies as an in-toto layout would cover. Creating a custom protocol to promote and verify these policies seems undesirable.

#### Verification of partial layouts

A non-custom and specification compliant solution would be that project owners provide additional partial layouts to each functionary who can then perform a full in-toto-compliant verification prior to performing their functionary task.

This is already possible without specification or implementation change, and may be listed as a solution to the described issue in in-toto usage documentation. However, acknowledging the complexity of creating a single layout for a project, UX implications of this recommendations should be considered carefully.

#### Encourage sandboxing of functionaries (recommended)

There is an orthogonal solution, which does not require per-functionary verification of preceding subgraphs of the supply chain. Instead this solution mitigates the impact of a functionary compromise. That is, functionaries should be encouraged to strictly separate the routines that generate and sign link metadata, and the ones that run functionary specific code.

This recommendation also aligns with the SLSA Level 3 requirement for Provenance generation that ["Provenance is Non-forgeable"](https://slsa.dev/spec/v1.0/requirements#provenance-non-forgeable) and can be applied without changes to the in-toto specification.

We suggest adopting this solution by acknowledging the described attack vector and recommending the usage of sandboxing technology in in-toto documentation. In addition, we suggest documenting usage recommendations and security pitfalls for in-toto tools that generate and sign link metadata.

For instance, the in-toto-run CLI/API generates and signs link metadata in the parent process, and executes untrusted functionary code in a subprocess. This means that the untrusted code can inherit the privileges of the trusted code, e.g. to access files or environment variables, unless the subprocess is additionally isolated, e.g. using container technology.

Similarly, the in-toto-record CLI/API, uses separate processes to generate and sign link metadata, and to run untrusted functionary code. This is susceptible to the same pitfalls as in-toto-run, if the processes are run with the same privileges.

In both cases, we recommend that one drops all possible privileges before executing functionary specific code. This is especially critical for any functionary code that executes portions of its materials.

### References

"Enable partial verification" [in-toto/in-toto#116](https://github.com/in-toto/in-toto/issues/116)

### Severity

High

### CVE ID

No known CVE

### Weaknesses

[CWE-345](/advisories?query=cwe%3A345)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7d9e3273_20250114_223737.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fin-toto%2Fcommit%2F3a21d84f40811b7d191fa7bd17265c1f99599afd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fin-toto%2Fcommit%2F3a21d84f40811b7d191fa7bd17265c1f99599afd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=in-toto%2Fin-toto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[in-toto](/in-toto)
/
**[in-toto](/in-toto/in-toto)**
Public

* [Notifications](/login?return_to=%2Fin-toto%2Fin-toto) You must be signed in to change notification settings
* [Fork
  141](/login?return_to=%2Fin-toto%2Fin-toto)
* [Star
   896](/login?return_to=%2Fin-toto%2Fin-toto)

* [Code](/in-toto/in-toto)
* [Issues
  40](/in-toto/in-toto/issues)
* [Pull requests
  5](/in-toto/in-toto/pulls)
* [Actions](/in-toto/in-toto/actions)
* [Projects
  0](/in-toto/in-toto/projects)
* [Security](/in-toto/in-toto/security)
* [Insights](/in-toto/in-toto/pulse)

Additional navigation options

* [Code](/in-toto/in-toto)
* [Issues](/in-toto/in-toto/issues)
* [Pull requests](/in-toto/in-toto/pulls)
* [Actions](/in-toto/in-toto/actions)
* [Projects](/in-toto/in-toto/projects)
* [Security](/in-toto/in-toto/security)
* [Insights](/in-toto/in-toto/pulse)

## Commit

[Permalink](/in-toto/in-toto/commit/3a21d84f40811b7d191fa7bd17265c1f99599afd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-wc64-c5rv-32pf](https://github.com/advisories/GHSA-wc64-c5rv-32pf "GHSA-wc64-c5rv-32pf")

[Browse files](/in-toto/in-toto/tree/3a21d84f40811b7d191fa7bd17265c1f99599afd)
Browse the repository at this point in the history

```
Drop user_settings module
```

* Loading branch information

[![@adityasaky](https://avatars.githubusercontent.com/u/8928778?s=40&v=4)](/adityasaky)

[adityasaky](/in-toto/in-toto/commits?author=adityasaky "View all commits by adityasaky")
authored
May 10, 2023

2 parents
[3989c84](/in-toto/in-toto/commit/3989c84a462a82366d7fce69ca0ddf462f13bab2)
+
[9835aae](/in-toto/in-toto/commit/9835aae17bc60b600713962b2bb66e6b7abe9325)

commit 3a21d84

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**6 additions**
and
**418 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* doc/source

  + doc/source/settings.rst
    [settings.rst](#diff-086df2707cf453c7f624bdeb886556699f208758be18e9d7bfa8265c56c6d4b7)
* in\_toto

  + in\_toto/in\_toto\_record.py
    [in\_toto\_record.py](#diff-308d4807caa12cf06f82560f1e5a0e465ba0726813ae2f73249aff1fefa937e5)
  + in\_toto/in\_toto\_run.py
    [in\_toto\_run.py](#diff-ca265f06036b9b278a1ffa7ab80261995e2a4f2e7ee5e9ea22994492a3c82db4)
  + in\_toto/runlib.py
    [runlib.py](#diff-40f0ea7898882c994402200f6f9c27e7b8e1934971eda4ba81b853b3d9673466)
  + in\_toto/settings.py
    [settings.py](#diff-8dc42045f910e901db3ae62166767fb50a51f5eae5643fcfc3208adb41b7783b)
  + in\_toto/user\_settings.py
    [user\_settings.py](#diff-85dd01461c71c2f599252b72cefa0f095aa135605a567b593b7b333309879975)
* tests

  + tests/test\_user\_settings.py
    [test\_user\_settings.py](#diff-b655cdfc0c88b8484bbc1a174f0577abb3588e80a282e71fd17d2a230223f8a5)

## There are no files selected for viewing

53 changes: 5 additions & 48 deletions

53
[doc/source/settings.rst](#diff-086df2707cf453c7f624bdeb886556699f208758be18e9d7bfa8265c56c6d4b7 "doc/source/settings.rst")

Show comments

[View file](/in-toto/in-toto/blob/3a21d84f40811b7d191fa7bd17265c1f99599afd/doc/source/settings.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,53 +1,10 @@ |
|  |  | Settings |
|  |  | ======== |
|  |  |  |
|  |  | For historical reasons some command line options may also be configured via |
|  |  | rcfiles in one of the following locations \*.in\_totorc\*, \*~/.in\_totorc\*, |
|  |  | \*~/.in\_toto/config\*, \*~/.config/in\_toto\*, \*~/.config/in\_toto/config\*, |
|  |  | \*/etc/in\_totorc\*, \*/etc/in\_toto/config\* or via environment variables in above |
|  |  | presented order of precedence. |
|  |  |  |
|  |  | Default values for these settings are defined in the `in\_toto.settings |
|  |  | <https://github.com/in-toto/in-toto/blob/develop/in\_toto/settings.py>`\_ module. |
|  |  | Settings names are case sensitive and settings values that contain colons are |
|  |  | parsed as list. |
|  |  | Default values for some in-toto CLI/API arguments are defined in global variables of the |
|  |  | ``in\_toto.settings`` module. Historically, configuration required modifying these |
|  |  | globals directly in source code or at runtime. This method is discouraged. Instead, |
|  |  | CLI/API arguments should be used. |
|  |  |  |
|  |  | .. note:: |
|  |  | Settings configured via rcfiles and environment variables are \*\*only\*\* |
|  |  | considered if in-toto is invoked form the \*\*command line\*\*, and ignored when |
|  |  | using the API. |
|  |  | The default ``in\_toto.settings``, on the other hand, are considered in both |
|  |  | cases, unless overridden via API function arguments or, in the case of CLI |
|  |  | usage, environment variables, rcfiles, or CLI arguments. |
|  |  |  |
|  |  |  |
|  |  | Setting Types |
|  |  | ------------- |
|  |  |  |
|  |  | - ``ARTIFACT\_EXCLUDE\_PATTERNS`` -- gitignore-style paths patterns exclude |
|  |  | artifacts from being recorded. |
|  |  | - ``ARTIFACT\_BASE\_PATH`` -- material and product paths passed to |
|  |  | ``in-toto-run`` are searched relative to the base path. The base path itself |
|  |  | is not included in the link metadata. Default is the current working |
|  |  | directory. |
|  |  | - ``LINK\_CMD\_EXEC\_TIMEOUT`` -- maximum timeout setting for the in-toto-run |
|  |  | command. |
|  |  |  |
|  |  |  |
|  |  | Example Usage |
|  |  | ------------- |
|  |  |  |
|  |  | .. code-block:: sh |
|  |  |  |
|  |  | # Configure settings via bash-style environment variable export |
|  |  | export IN\_TOTO\_ARTIFACT\_BASE\_PATH='/home/user/project' |
|  |  | export IN\_TOTO\_ARTIFACT\_EXCLUDE\_PATTERNS='\*.link:.gitignore' |
|  |  | export IN\_TOTO\_LINK\_CMD\_EXEC\_TIMEOUT='10' |
|  |  |  |
|  |  | .. code-block:: sh |
|  |  |  |
|  |  | # Configure settings via ~/.in\_totorc |
|  |  | [in-toto settings] |
|  |  | ARTIFACT\_BASE\_PATH=/home/user/project |
|  |  | ARTIFACT\_EXCLUDE\_PATTERNS=\*.link:.gitignore |
|  |  | LINK\_CMD\_EXEC\_TIMEOUT=10 |
|  |  | The globals ``DEBUG`` and ``LINK\_CMD\_EXEC\_TIMEOUT`` can only be configured directly. |

4 changes: 0 additions & 4 deletions

4
[in\_toto/in\_toto\_record.py](#diff-308d4807caa12cf06f82560f1e5a0e465ba0726813ae2f73249aff1fefa937e5 "in_toto/in_toto_record.py")

Show comments

[View file](/in-toto/in-toto/blob/3a21d84f40811b7d191fa7bd17265c1f99599afd/in_toto/in_toto_record.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,7 +33,6 @@ |
|  |  | from securesystemslib import interface |
|  |  |  |
|  |  | import in\_toto.runlib |
|  |  | import in\_toto.user\_settings |
|  |  | from in\_toto import \_\_version\_\_ |
|  |  | from in\_toto.common\_args import ( |
|  |  | BASE\_PATH\_ARGS, |
| Expand Down  Expand Up | | @@ -233,9 +232,6 @@ def main(): |
|  |  |  |
|  |  | LOG.setLevelVerboseOrQuiet(args.verbose, args.quiet) |
|  |  |  |
|  |  | # Override defaults in settings.py with environment variables and RCfiles |
|  |  | in\_toto.user\_settings.set\_settings() |
|  |  |  |
|  |  | # Regular signing and GPG signing are mutually exclusive |
|  |  | if (args.key is None) == (args.gpg is None): |
|  |  | parser.print\_usage() |
| Expand Down | |  |

4 changes: 0 additions & 4 deletions

4
[in\_toto/in\_toto\_run.py](#diff-ca265f06036b9b278a1ffa7ab80261995e2a4f2e7ee5e9ea22994492a3c82db4 "in_toto/in_toto_run.py")

Show comments

[View file](/in-toto/in-toto/blob/3a21d84f40811b7d191fa7bd17265c1f99599afd/in_toto/in_toto_run.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,7 +32,6 @@ |
|  |  |  |
|  |  | from securesystemslib import interface |
|  |  |  |
|  |  | import in\_toto.user\_settings |
|  |  | from in\_toto import \_\_version\_\_, runlib |
|  |  | from in\_toto.common\_args import ( |
|  |  | BASE\_PATH\_ARGS, |
| Expand Down  Expand Up | | @@ -254,9 +253,6 @@ def main(): |
|  |  |  |
|  |  | LOG.setLevelVerboseOrQuiet(args.verbose, args.quiet) |
|  |  |  |
|  |  | # Override defaults in settings.py with environment variables and RCfiles |
|  |  | in\_toto.user\_settings.set\_settings() |
|  |  |  |
|  |  | # Regular signing and GPG signing are mutually exclusive |
|  |  | if (args.key is None) == (args.gpg is None): |
|  |  | parser.print\_usage() |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[in\_toto/runlib.py](#diff-40f0ea7898882c994402200f6f9c27e7b8e1934971eda4ba81b853b3d9673466 "in_toto/runlib.py")

Show comments

[View file](/in-toto/in-toto/blob/3a21d84f40811b7d191fa7bd17265c1f99599afd/in_toto/runlib.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -111,8 +111,7 @@ def record\_artifacts\_as\_dict( |
|  |  | exclude\_patterns: (optional) |
|  |  | Artifacts matched by the pattern are excluded from the result. |
|  |  | Exclude patterns can be passed as argument or specified via |
|  |  | ARTIFACT\_EXCLUDE\_PATTERNS setting (see `in\_toto.settings`) or |
|  |  | via envvars or rcfiles (see `in\_toto.user\_settings`). |
|  |  | ARTIFACT\_EXCLUDE\_PATTERNS setting (see `in\_toto.settings`). |
|  |  | If passed, patterns specified via settings are overriden. |
|  |  |  |
|  |  | base\_path: (optional) |
| Expand Down | |  |

6 changes: 0 additions & 6 deletions

6
[in\_toto/settings.py](#diff-8dc42045f910e901db3ae62166767fb50a51f5eae5643fcfc3208adb41b7783b "in_toto/settings.py")

Show comments

[View file](/in-toto/in-toto/blob/3a21d84f40811b7d191fa7bd17265c1f99599afd/in_toto/settings.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,14 +25,8 @@ |
|  |  | import in\_toto.settings |
|  |  | in\_toto.settings.ARTIFACT\_BASE\_PATH = "/home/user/project" |
|  |  | ``` |
|  |  | - or, when using in-toto via command line tooling, with environment variables |
|  |  | or RCfiles, see the `in\_toto.user\_settings` module |
|  |  |  |
|  |  | """ |
|  |  | # The debug setting is used to set to the in-toto base logger to logging.DEBUG |
|  |  | # TODO: This setting is currently not available via environment variables or |
|  |  | # rcfiles, partially because at the moment it is read before we parse |
|  |  | # envvars/rcfiles. Do we want to make it available to those as well? |
|  |  | DEBUG = False |
|  |  |  |
|  |  | # See docstring of `in-toto.record\_artifacts\_as\_dict` for how this is used |
| Expand Down | |  |

227 changes: 0 additions & 227 deletions

227
[in\_toto/user\_settings.py](#diff-85dd01461c71c2f599252b72cefa0f095aa135605a567b593b7b333309879975 "in_toto/user_settings.py")

Show comments

[View file](/in-toto/in-toto/blob/3989c84a462a82366d7fce69ca0ddf462f13bab2/in_toto/user_settings.py)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3a21d84`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fin-toto%2Fcommit%2F3a21d84f40811b7d191fa7bd17265c1f99599afd) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d9766f6f_20250114_223743.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fin-toto%2Fsecurity%2Fadvisories%2FGHSA-wc64-c5rv-32pf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fin-toto%2Fin-toto%2Fsecurity%2Fadvisories%2FGHSA-wc64-c5rv-32pf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=in-toto%2Fin-toto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[in-toto](/in-toto)
/
**[in-toto](/in-toto/in-toto)**
Public

* [Notifications](/login?return_to=%2Fin-toto%2Fin-toto) You must be signed in to change notification settings
* [Fork
  141](/login?return_to=%2Fin-toto%2Fin-toto)
* [Star
   896](/login?return_to=%2Fin-toto%2Fin-toto)

* [Code](/in-toto/in-toto)
* [Issues
  40](/in-toto/in-toto/issues)
* [Pull requests
  5](/in-toto/in-toto/pulls)
* [Actions](/in-toto/in-toto/actions)
* [Projects
  0](/in-toto/in-toto/projects)
* [Security](/in-toto/in-toto/security)
* [Insights](/in-toto/in-toto/pulse)

Additional navigation options

* [Code](/in-toto/in-toto)
* [Issues](/in-toto/in-toto/issues)
* [Pull requests](/in-toto/in-toto/pulls)
* [Actions](/in-toto/in-toto/actions)
* [Projects](/in-toto/in-toto/projects)
* [Security](/in-toto/in-toto/security)
* [Insights](/in-toto/in-toto/pulse)

# Configuration Read From Local Directory

Moderate

[adityasaky](/adityasaky)
published
GHSA-wc64-c5rv-32pf
May 10, 2023

## Package

pip

in-toto
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<= 1.4.0

## Patched versions

None

## Description

### Impact

The in-toto configuration is read from various directories and allows users to configure the behavior of the framework. The files are from directories following the XDG base directory specification [1]. Among the files read is `.in_totorc` which is a hidden file in the directory in which in-toto is run. If an attacker controls the inputs to a supply chain step, they can mask their activities by also passing in an `.in_totorc` file that includes the necessary exclude patterns and settings.

RC files are widely used in other systems [2] and security issues have been discovered in their implementations as well [3]. We found in our conversations with in-toto adopters that `in_totorc` is not their preferred way to configure in-toto. As none of the options supported in `in_totorc` is unique, and can be set elsewhere using API parameters or CLI arguments, we decided to drop support for `in_totorc`.

### Other Recommendations

Sandbox functionary code as recommended in [GHSA-p86f-xmg6-9q4x](https://github.com/in-toto/specification/security/advisories/GHSA-p86f-xmg6-9q4x "GHSA-p86f-xmg6-9q4x").

### References

[1] <https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html>

[2] <https://spec.editorconfig.org/>

[3] <https://github.blog/2022-04-12-git-security-vulnerability-announced/>

### Severity

Moderate

### CVE ID

CVE-2023-32076

### Weaknesses

[CWE-15](/advisories?query=cwe%3A15)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


