Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**

*   The vulnerability is due to insufficient input sanitization and output escaping of user-supplied attributes within the 'pagelayer\_header\_code', 'pagelayer\_body\_open\_code', and 'pagelayer\_footer\_code' meta fields. This allows the injection of arbitrary web scripts.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):** The plugin is vulnerable to stored XSS, where malicious scripts are injected and stored in the database, and then executed when a user views the affected page.

**Impact of Exploitation:**

*   An authenticated attacker with contributor-level or higher permissions can inject malicious JavaScript code into pages.
*   When a user accesses an infected page, the injected JavaScript code will execute in their browser, potentially allowing the attacker to:
    *   Steal cookies, session tokens, and other sensitive information.
    *   Redirect the user to a malicious website.
    *   Perform actions on behalf of the user.
    *   Deface the website or inject further malware.

**Attack Vectors:**

*   The attack vector is through the WordPress admin panel where users with contributor-level or higher access can modify post meta fields. Specifically, the vulnerable fields are:
    *   `pagelayer_header_code`
    *   `pagelayer_body_open_code`
    *   `pagelayer_footer_code`

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** The attacker needs to have at least contributor-level access to the WordPress admin panel to edit posts and their meta data.
*   **Knowledge of Vulnerable Fields:** The attacker needs to know the specific meta fields that are vulnerable to the XSS attack.

**Additional Details:**

*   The vulnerability was a reintroduction of a previously patched issue in version 1.7.7.
*   The vulnerability is fixed in version 1.7.9 of the plugin.
*   The provided code snippets from `post_metas.php` show the vulnerable `textarea` fields where arbitrary code can be input. The `init.php` file also contains the fix, sanitizing these fields.