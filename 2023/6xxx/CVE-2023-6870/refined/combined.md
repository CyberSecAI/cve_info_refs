=== Content from security.gentoo.org_897e22ca_20250115_094452.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_60c45d8b_20250115_094451.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1823316)
* [XML](/show_bug.cgi?ctype=xml&id=1823316)

Closed
[Bug 1823316](/show_bug.cgi?id=1823316)
(CVE-2023-6870)

Opened 2 years ago
Closed 1 year ago

# open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus

## Categories

### (Fenix :: General, defect, P2)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### (firefox111 unaffected, firefox112 wontfix, firefox113 wontfix, firefox114 wontfix, firefox115 wontfix, firefox117 wontfix, firefox118 wontfix, firefox119 wontfix, firefox120 wontfix, firefox121 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

121 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox111 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=unaffected) |
| firefox112 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix) |
| firefox113 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix) |
| firefox119 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox111 |  | unaffected |
| firefox112 |  | wontfix |
| firefox113 |  | wontfix |
| firefox114 |  | wontfix |
| firefox115 |  | wontfix |
| firefox117 |  | wontfix |
| firefox118 |  | wontfix |
| firefox119 |  | wontfix |
| firefox120 |  | wontfix |
| firefox121 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: towhite)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/22a9310c1f58a884132acc7cea6f3c6b?d=mm&size=40)  [towhite](/user_profile?user_id=715454)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1835469](/show_bug.cgi?id=1835469 "VERIFIED FIXED - Android Firefox Fullscreen Toast Message Hide Using Keyboard inside SplitScreen Mode")

Dependency [tree](/showdependencytree.cgi?id=1823316&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1823316)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1406120 "https://bugs.chromium.org/p/chromium/issues/detail?id=1406120")

[mozilla-hub.atlassian.net/browse/FXDR...](https://mozilla-hub.atlassian.net/browse/FXDROID-514 "https://mozilla-hub.atlassian.net/browse/FXDROID-514")

## Details

### (5 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main121+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6870

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main121+]

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c49 "1 year ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a38912724_578488 "7 months ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
|  | in-testsuite |  |
| --- | --- | --- |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (12 files, 2 obsolete files)

| [poc.apk](/attachment.cgi?id=9323838)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   2.85 MB, application/vnd.android.package-archive |  | [Details](/attachment.cgi?id=9323838&action=edit) |
| --- | --- | --- |
| [video\_2023-03-20\_10-35-58.mp4](/attachment.cgi?id=9323839)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   5.50 MB, video/mp4 |  | [Details](/attachment.cgi?id=9323839&action=edit) |
| [MainActivity.java](/attachment.cgi?id=9323842)  [2 years ago](#c4)  [Hafiizh](/user_profile?user_id=694415)   980 bytes, text/plain |  | [Details](/attachment.cgi?id=9323842&action=edit) |
| [activity\_main.xml](/attachment.cgi?id=9323843)  [2 years ago](#c5)  [Hafiizh](/user_profile?user_id=694415)   298 bytes, text/xml |  | [Details](/attachment.cgi?id=9323843&action=edit) |
| [AndroidManifest.xml](/attachment.cgi?id=9323844)  [2 years ago](#c6)  [Hafiizh](/user_profile?user_id=694415)   658 bytes, text/xml |  | [Details](/attachment.cgi?id=9323844&action=edit) |
| [Fenix original Toast demo.mp4](/attachment.cgi?id=9349862)  [1 year ago](#c23)  [twhite](/user_profile?user_id=715454)   1.80 MB, video/mp4 |  | [Details](/attachment.cgi?id=9349862&action=edit) |
| [Focus original Toast demo.mp4](/attachment.cgi?id=9349863)  [1 year ago](#c24)  [twhite](/user_profile?user_id=715454)   2.15 MB, video/mp4 |  | [Details](/attachment.cgi?id=9349863&action=edit) |
| [Fenix fix Snackbar demo.mp4](/attachment.cgi?id=9349864)  [1 year ago](#c25)  [twhite](/user_profile?user_id=715454)   2.54 MB, video/mp4 |  | [Details](/attachment.cgi?id=9349864&action=edit) |
| [Focus fix Snackbar demo.mp4](/attachment.cgi?id=9349866)  [1 year ago](#c26)  [twhite](/user_profile?user_id=715454)   2.47 MB, video/mp4 |  | [Details](/attachment.cgi?id=9349866&action=edit) |
| [Bug\_1823316\_-\_Use\_Snackbar\_to\_notify\_on\_making\_app\_full-screen.patch](/attachment.cgi?id=9349867)  [1 year ago](#c27)  [twhite](/user_profile?user_id=715454)   11.71 KB, patch | dveditz : [sec-approval+](#c29 "1 year ago") | [Details](/attachment.cgi?id=9349867&action=edit) | [Diff](/attachment.cgi?id=9349867&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9349867) |
| [full\_screen\_notification\_2.patch](/attachment.cgi?id=9360989)  [1 year ago](#c37)  [twhite](/user_profile?user_id=715454)   20.53 KB, patch | jonalmeida : [review+](#c38 "1 year ago") | [Details](/attachment.cgi?id=9360989&action=edit) | [Diff](/attachment.cgi?id=9360989&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9360989) |
| [full\_screen\_notification\_3.patch](/attachment.cgi?id=9361436)  [1 year ago](#c39)  [twhite](/user_profile?user_id=715454)   20.16 KB, patch |  | [Details](/attachment.cgi?id=9361436&action=edit) | [Diff](/attachment.cgi?id=9361436&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9361436) |
| [[mozilla-mobile/firefox-android] Bug 1823316 - Use 'Snackbar' themed Dialog to notify on making app full-screen (#4394)](/attachment.cgi?id=9362337)  [1 year ago](#c44)  [BMO Github Automation](/user_profile?user_id=723884)   59 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=9362337&action=edit) | [Review](/attachment.cgi?id=9362337) |
| [advisory.txt](/attachment.cgi?id=9367997)  [1 year ago](#c47)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   278 bytes, text/plain |  | [Details](/attachment.cgi?id=9367997&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1823316#c0)• 2 years ago |
|  | |

I found a vulnerability where a fullscreen notification toast could be suppressed by a toast running on a background thread

1. Install poc.apk and run poc
2. open <http://103.186.0.20/fullscreenbkp.html>
3. Click on "Open Fullscreen Portrait" button or "Open Fullscreen Landscape" button

   4 when click open full screen portrait it should appear fullscreen notification toast but it is not, because it has been suppressed by the toast running in the background using a thread, and when forcing the poc.apk application to die then a fullscreen notification toast appears

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1823316#c1)• 2 years ago |
|  | |

Attached file
[poc.apk](attachment.cgi?id=9323838)
— [Details](attachment.cgi?id=9323838&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1823316#c2)• 2 years ago |
|  | |

Attached video
[video\_2023-03-20\_10-35-58.mp4](attachment.cgi?id=9323839)
— [Details](attachment.cgi?id=9323839&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1823316#c3)• 2 years ago |
|  | |

this vulnerability happened after fixed from <https://github.com/mozilla-mobile/firefox-android/commit/e2ae2a040d1990cbc775bec5715aebd690cbe4a3>

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1823316#c4)• 2 years ago |
|  | |

Attached file
[MainActivity.java](attachment.cgi?id=9323842)
— [Details](attachment.cgi?id=9323842&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1823316#c5)• 2 years ago |
|  | |

Attached file
[activity\_main.xml](attachment.cgi?id=9323843)
— [Details](attachment.cgi?id=9323843&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1823316#c6)• 2 years ago |
|  | |

Attached file
[AndroidManifest.xml](attachment.cgi?id=9323844)
— [Details](attachment.cgi?id=9323844&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1823316#c7)• 2 years ago |
|  | |

i tested on Samsung M31 (Android 10)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a24702_159069)• 2 years ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → Fenix

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1823316#c8)• 2 years ago |
|  | |

If you can get a user to install an app, can't that app just do whatever spoofy thing without needing the browser spoof?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a238215_406194)• 2 years ago |

[Attachment #9323842](/attachment.cgi?id=9323842&action=edit "MainActivity.java") -
Attachment mime type: application/octet-stream → text/plain

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1823316#c9)• 2 years ago |
|  | |

Maybe a non malicious app could accidentally interfere, too.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a238454_406194)• 2 years ago |

Flags: needinfo?(petru.lingurar)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1823316#c10)• 2 years ago |
|  | |

Sounds like a regression from [bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag") if we weren't using these toasts before?

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [CVE-2023-29534](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1823316#c11)• 2 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #9](/show_bug.cgi?id=1823316#c9 "RESOLVED FIXED - open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus"))

> Maybe a non malicious app could accidentally interfere, too.

Yes Non malicious app could accidentally interfere

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1823316#c12)• 2 years ago |
|  | |

Interesting approach.

This to me seems to be a bug in Android and I found here [1] this scenario of showing multiple toasts in a loop being mentioned.

Testing on Android 12 and Android 13 I see the app is not affected (the fullscreen messages are showing as expected) (hinting that the Android bug was solved in the meantime) but on an Android 8 device the message does not appear. Haven't tested on more platforms yet.

Since both us (Fenix) and another application would use the same system `Toast` that other application can effectively starve us by it cycling in a loop through new messages to show.

Not sure why an application would do that other than with ill intent but this is a scenario that affects us and we'd need to avoid it.

I'd expect almost all applications to be affected by this system bug but I'm saying "almost all" because it seems like Chrome has been updated recently to avoid it (Chrome 100 is affected but Chrome 111 is not).

Will look into fixing this for Fenix also.

[1] <https://www.wired.com/story/hack-brief-patch-your-android-phone-to-block-an-evil-toast-attack/>

Assignee: nobody → petru.lingurarStatus: UNCONFIRMED → ASSIGNED
[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=disabled)
[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)Ever confirmed: trueFlags: needinfo?(petru.lingurar)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1823316#c13)• 2 years ago |
|  | |

hi petru , i tested it on android 10. after i read the article you provided, it has something to do with tapjacking i also just read about this on <https://developer.android.com/topic/security/risks/tapjacking?hl=en#risk_custom_toast>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a540581_1689)• 2 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1823316#c14)• 2 years ago |
|  | |

Doesn't seem like we can keep using a `Toast` and ensure it will always be shown.

While the `Toast` would help show the fullscreen message on top of anything in our app fixing all other related spoofing scenarios it being a system functionality that on older Android versions allows for background apps also to show a Toast at the same time with us makes that API a choke point for our messages.

To reconcile showing a message on top of anything in our app while also being able to style that message and having full control over it, also based on recent changes in Chrome[1] which addressed this exact issue it seems like we should show it in a new [Window](https://developer.android.com/reference/android/view/Window).

A new `Window` shown after various prompts (shown in their own `Window` on top of anything in the app) would ensure the message `Window` will be shown on top of the the current `Activity` and any other `Window`s. We could even show the fullscreen snackbar here and so get everything we wanted.

I won't have time to work on this. Tagging Joe to find a suitable owner.

[1] [https://source.chromium.org/chromium/chromium/src/+/main:chrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenToast.java](https://source.chromium.org/chromium/chromium/src/%2B/main%3Achrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenToast.java)

Flags: needinfo?(jmahon)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a738470_613831)• 2 years ago |

Assignee: petru.lingurar → nobodyStatus: ASSIGNED → NEW

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1823316#c15)• 2 years ago |
|  | |

Looks like crbug 1406120 was fixed in Chrome 110 (referenced in the code link above). That PoC used the Android text selection widget to cause problems so the fact that this bug was fixed might be wholly accidental.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1406120>

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a1940441_575867)• 2 years ago |

[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a2567566_430528)• 2 years ago |

Severity: -- → S3Priority: -- → P2Summary: open toast using thread running in background will suppressed fullscreen notification toast on Firefox Android → open toast using thread running in background will suppress fullscreen notification toast on Firefox Android

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1823316#c17)• 2 years ago |
|  | |

Does this bug also affect Focus?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1823316#c18)• 2 years ago |
|  | |

this bug also affect focus i have tested on 113.0a1-202315151641

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a2646544_430528)• 2 years ago |

Summary: open toast using thread running in background will suppress fullscreen notification toast on Firefox Android → open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a2814452_75935)• 2 years ago |

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fix-optional)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a2814483_75935)• 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[disabled](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=disabled) → [unaffected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=unaffected)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1823316#c19)• 2 years ago |
|  | |

hello any updates?

|  | [Joe M [:jmahon]](/user_profile?user_id=706732) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1823316#c20)• 2 years ago |
|  | |

Adding [Bug 1827647](/show_bug.cgi?id=1827647 "RESOLVED WORKSFORME") as a see-also because it seems like there are multiple potential vulnerabilities to balance with regards to fullscreen notifications.

:hafizh we had some recent organizational changes that delayed this; but we're pulling it into our upcoming sprint to pick up Petru's work where he left off.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a6221425_75935)• 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fix-optional)

|  | [Joe M [:jmahon]](/user_profile?user_id=706732) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a7386666_706732)• 2 years ago |

Flags: needinfo?(jmahon)See Also: → <https://mozilla-hub.atlassian.net/browse/FXDROID-514>

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1823316#c21)• 2 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

hello any updates?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1823316#c22)• 1 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

hello any updates?

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1823316#c23)• 1 year ago |
|  | |

Attached video
[Fenix original Toast demo.mp4](attachment.cgi?id=9349862)
— [Details](attachment.cgi?id=9349862&action=edit)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1823316#c24)• 1 year ago |
|  | |

Attached video
[Focus original Toast demo.mp4](attachment.cgi?id=9349863)
— [Details](attachment.cgi?id=9349863&action=edit)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1823316#c25)• 1 year ago |
|  | |

Attached video
[Fenix fix Snackbar demo.mp4](attachment.cgi?id=9349864)
— [Details](attachment.cgi?id=9349864&action=edit)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1823316#c26)• 1 year ago |
|  | |

Attached video
[Focus fix Snackbar demo.mp4](attachment.cgi?id=9349866)
— [Details](attachment.cgi?id=9349866&action=edit)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1823316#c27)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1823316&comment_id=16547551 "1 revision") |
|  | |

Attached patch

[Bug\_1823316\_-\_Use\_Snackbar\_to\_notify\_on\_making\_app\_full-screen.patch](attachment.cgi?id=9349867&action=diff) (obsolete)
— [Details](attachment.cgi?id=9349867&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9349867)

[Security approval request comment]

**How easily could an exploit be constructed based on the patch?** There is no clear indication about scenarios to exploit. This will likely look like a UX decision.

**Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?** No

**Which older supported branches are affected by this flaw?** All versions => 112 (from <https://bugzilla.mozilla.org/show_bug.cgi?id=1816059> which include the previous fix)

**If not all supported branches, which bug introduced the flaw?** <https://bugzilla.mozilla.org/show_bug.cgi?id=1816059>

**Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?** No. Given how small the patch is, the same code can be uplifted.

**How likely is this patch to cause regressions; how much testing does it need?** Small, straightforward change. Don't expect any issue from it.

Assignee: nobody → towhite
[Attachment #9349867](/attachment.cgi?id=9349867&action=edit "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") -
Flags: sec-approval?
[Attachment #9349867](/attachment.cgi?id=9349867&action=edit "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") -
Flags: review?(jonalmeida942)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1823316#c28)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1823316&comment_id=16547566 "1 revision") |
|  | |

My approach to this fix is to revert the Toast added in the original fix and change the view owner of the Snackbar to the highest level fragment, e.g. a full screen DialogFragment will now be the parent to host the Snackbar

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a13945920_75935)• 1 year ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1823316#c29)• 1 year ago |
|  | |

Comment on [attachment 9349867](/attachment.cgi?id=9349867 "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") [[details]](/attachment.cgi?id=9349867&action=edit "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") [[diff]](/attachment.cgi?id=9349867&action=diff "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9349867)

Bug\_1823316\_-\_Use\_Snackbar\_to\_notify\_on\_making\_app\_full-screen.patch

Next time please wait for the patch to be reviewed before requesting sec-approval. But this looks OK to land if it passes review and doesn't un-fix all the previous bugs that were fixed by the toast approach.

[Attachment #9349867](/attachment.cgi?id=9349867&action=edit "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") -
Flags: sec-approval? → sec-approval+

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1823316#c30)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1823316&comment_id=16566668 "2 revisions") |
|  | |

Sure thing David.

Unfortunately, this [initial patch](https://bug1823316.bmoattachments.org/attachment.cgi?id=9349867&t=dj1ndBBnNLiov5MnKEL4mI) will regress <https://bugzilla.mozilla.org/show_bug.cgi?id=1821906>. I have been looking at an alternative method that would involve displaying the `Snackbar` in it's own `view` above all other displayed views.

NB Chrome (& Brave) set a good precedent handling full screen mode (this is captured in comments from Edgar, Pertu & Emilio on 1823316 & 1816059). Perhaps we should look to follow a similar UX flow.

I am on PTO next week, :jonalmeida is planning on continuing work on this during this time.

Assignee: towhite → jonalmeida942

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1823316#c31)• 1 year ago |
|  | |

hello any updates?

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1823316#c32)• 1 year ago |
|  | |

Hi :Hafiizh I am continuing to look into this issue. Unfortunately the initial 'fix' caused a regression.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a16980227_75935)• 1 year ago |

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix)
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fix-optional)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1823316#c33)• 1 year ago |
|  | |

This bug is much less a risk for our users than the bugs we fixed that led to this regression. The others were a broad class of spoofing that attack pages could do all on their own. This one requires a malicious site to first convince the user to install a malicious app that will keep this toast busy when a web site can signal it's about to try this attack (if the toast is busy 100% of the time users will probably notice!).

I'm not even worried about that as a likely attack vector. Not only is the scenario hard to pull off, the malicious app all on its own could pull off more powerful attacks than fullscreen spoofing in a web browser so why would it bother? I think the 'sec-moderate' rating was copied over from the referenced Chrome bug, but that one did not require a confederate malicious application.

It -is- possible that some other app could *inadvertently* interfere with our toast in this way. We should fix this bug so that those users get the messages we intend for them, but it doesn't seem likely to happen often.

If we do switch away from using the Android system toast, consider ways to make this message more noticeable. Many modern phones are so tall that users will easily miss a static message at the bottom of the screen if there's something interesting going on at the top. And sometimes the system-chosen colors get lost on the background. If we create our own widget we can adjust the placement (closer to center?) and add attention-grabbing and harder-to-hide movement as on desktop.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1823316#c34)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1823316&comment_id=16604902 "4 revisions") |
|  | |

Thank you for the update :dveditz.

I’ve had a few more thoughts on a non-regressing 'quick fix' for this. In the short term, we could utilize a custom `AlertDialog` which can get us *close* to how the original `Snackbar` implementation worked. It also provided us some other possibilities, such as:

* require the user to ‘accept’ (the `Dialog`) that the app is now in full screen (e.g. it won't automatically close itself)
* as mentioned by :dveditz change the positioning/style etc

Based on the above, I've created a prototype using a custom `DialogFragment` styled as a `FenixSnackbar` which has *almost* the same behaviour. Changes of note:

* to prevent any regression - other `Dialogs` that could overlay the Alert are not shown if the full screen alert is displayed

**Update**: Remove *fixed* items from 'Changes of note'

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a17057454_715454)• 1 year ago |

Assignee: jonalmeida942 → towhite

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1823316#c35)• 1 year ago |
|  | |

I don't think we can have a non-closing warning. Too many people watch a lot of videos and that extra required touch/click will degrade the experience compared to our competitors. But having it stick around a bit longer than it currently does (maybe with a dismiss button for the impatient people?) could help. Motion and putting the warning closer to where people are looking would help more though (IMHO).

Fullscreen requires a user activation. Could we put the notice near where the user touched (still nicely horizontally centered)? Not too close to the top or bottom because that would look odd—say (handwaving) between 25% and 75% of the screen height. If that's weird, complicated, or ugly, it would still be an improvement to have three fixed positions (picked on aesthetics) for whether the activation was closest to top, bottom, or middle.

There might be UX research / knowledge that could help us best address this problem. We should seek their advice

Chris: is that something you can help arrange?

Flags: needinfo?(cpeterson)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1823316#c36)• 1 year ago |
|  | |

> Chris: is that something you can help arrange?

Yes, the Android team is planning to evaluate the fullscreen UX with our UX designers in Q4 and try to address all of the fullscreen notification corner cases. We will definitely include your suggestions here and can include you in the design review.

Flags: needinfo?(cpeterson)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1823316#c37)• 1 year ago |
|  | |

Attached patch

[full\_screen\_notification\_2.patch](attachment.cgi?id=9360989&action=diff) (obsolete)
— [Details](attachment.cgi?id=9360989&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9360989)

[Attachment #9349867](/attachment.cgi?id=9349867&action=edit "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") -
Attachment is obsolete: true
[Attachment #9349867](/attachment.cgi?id=9349867&action=edit "Bug_1823316_-_Use_Snackbar_to_notify_on_making_app_full-screen.patch") -
Flags: review?(jonalmeida942)
[Attachment #9360989](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") -
Flags: review?(jonalmeida942)

|  | [Jonathan Almeida [:jonalmeida]](/user_profile?user_id=541581) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1823316#c38)• 1 year ago |
|  | |

Comment on [attachment 9360989](/attachment.cgi?id=9360989 "full_screen_notification_2.patch") [[details]](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") [[diff]](/attachment.cgi?id=9360989&action=diff "full_screen_notification_2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9360989)
full\_screen\_notification\_2.patch
Review of [attachment 9360989](/attachment.cgi?id=9360989 "full_screen_notification_2.patch") [[details]](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") [[diff]](/attachment.cgi?id=9360989&action=diff "full_screen_notification_2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9360989):
-----------------------------------------------------------------
This change looks good to me, thanks for putting it together Tom!
We also spoke offline and Tom suggested we ask QA to verify that we aren't regressing any of our other sec bugs that are linked under this meta.
::: android-components/components/feature/prompts/src/main/java/mozilla/components/feature/prompts/dialog/FullScreenNotificationImpl.kt
@@ +35,5 @@
> + \* [DialogFragment] that is configured to match the style and behaviour of a Snackbar.
> + \*
> + \* @property layout the layout to use for the dialog.
> + \*/
> +class FullScreenNotificationImpl(@LayoutRes val layout: Int) :
nit: `Impl` doesn't really tell us much about the thing (we try to avoid it usually). Maybe something like `FullScreenNotificationDialog`, `FullScreenNotificationDialogFragment`, or `FullScreenNotificationFragment`?
[Attachment #9360989](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") -
Flags: review?(jonalmeida942) → review+

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1823316#c39)• 1 year ago |
|  | |

Attached patch

[full\_screen\_notification\_3.patch](attachment.cgi?id=9361436&action=diff)
— [Details](attachment.cgi?id=9361436&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9361436)

[Attachment #9360989](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") -
Attachment is obsolete: true

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1823316#c40)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1823316&comment_id=16649051 "1 revision") |
|  | |

Hi :miralobontiu, could QA provide assistance in verifying this patch against the following potential regressions please?

* [1816007](https://bugzilla.mozilla.org/show_bug.cgi?id=1816007)
* [1821155](https://bugzilla.mozilla.org/show_bug.cgi?id=1821155)
* [1821576](https://bugzilla.mozilla.org/show_bug.cgi?id=1821576)
* [1821906](https://bugzilla.mozilla.org/show_bug.cgi?id=1821906)
* [1822298](https://bugzilla.mozilla.org/show_bug.cgi?id=1822298)
* [1822305](https://bugzilla.mozilla.org/show_bug.cgi?id=1822305)
* [1707956](https://bugzilla.mozilla.org/show_bug.cgi?id=1707956)

I cannot add the Fenix & Focus apk's here as they are too large, I will find an alternative.

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a19575217_715454)• 1 year ago |

Flags: needinfo?(mlobontiuroman)

|  | [Mira Lobontiu (Android QA)](/user_profile?user_id=621020) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1823316#c41)• 1 year ago |
|  | |

Verified on the Fenix & Focus Nightly provided builds, and it seems that there are no regressions.

We've verified all the issues mentioned on [Comment 40](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316#c40).

Tested with Google Pixel 6 (Android 14), and Samsung Galaxy A53 (Android 13).

Flags: needinfo?(mlobontiuroman)

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1823316#c42)• 1 year ago |
|  | |

Comment on [attachment 9360989](/attachment.cgi?id=9360989 "full_screen_notification_2.patch") [[details]](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") [[diff]](/attachment.cgi?id=9360989&action=diff "full_screen_notification_2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9360989)

full\_screen\_notification\_2.patch

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It's clear that Fenix is now using a 'full screen notification' and not displaying the site permissions dialog if the 'full screen notification' is displayed. However, as already noted this is fairly low risk and any exploit against Toast would still require the additional 'Toast blocker' app to be installed
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: 112
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1816059](/show_bug.cgi?id=1816059 "RESOLVED FIXED - Obscuring the Full-Screen Toast in Android Through the Select Tag")
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Testing carried out by QA
* **Is Android affected?**: No
[Attachment #9360989](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") -
Flags: sec-approval?

|  | [twhite](/user_profile?user_id=715454)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a20003903_715454)• 1 year ago |

[Attachment #9361436](/attachment.cgi?id=9361436&action=edit "full_screen_notification_3.patch") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1823316#c43)• 1 year ago |
|  | |

Comment on [attachment 9360989](/attachment.cgi?id=9360989 "full_screen_notification_2.patch") [[details]](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") [[diff]](/attachment.cgi?id=9360989&action=diff "full_screen_notification_2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1823316&attachment=9360989)

full\_screen\_notification\_2.patch

Because this is just a sec-low sec-approval is not required. You can proceed to land this when ready

[Attachment #9360989](/attachment.cgi?id=9360989&action=edit "full_screen_notification_2.patch") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a20016007_578488)• 1 year ago |

[Attachment #9361436](/attachment.cgi?id=9361436&action=edit "full_screen_notification_3.patch") -
Flags: sec-approval?

|  | [BMO Github Automation](/user_profile?user_id=723884) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1823316#c44)• 1 year ago |
|  | |

Attached file
[[mozilla-mobile/firefox-android] Bug 1823316 - Use 'Snackbar' themed Dialog to notify on making app full-screen (#4394)](attachment.cgi?id=9362337)
— [Details](attachment.cgi?id=9362337&action=edit)

|  | [BMO Github Automation](/user_profile?user_id=723884) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1823316#c45)• 1 year ago |
|  | |

Authored by <https://github.com/t-p-white>

<https://github.com/mozilla-mobile/firefox-android/commit/f57ec02d1b234bb5e8ed5fd4ae5795bbde1f3225>

[main] [Bug 1823316](/show_bug.cgi?id=1823316 "RESOLVED FIXED - open toast using thread running in background will suppress fullscreen notification toast on Firefox and Focus") - Use 'Snackbar' themed Dialog to notify on making app full-screen

Status: NEW → RESOLVEDClosed: 1 year ago
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)Flags: qe-verify+Resolution: --- → FIXEDTarget Milestone: --- → 121 Branch

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1823316#c46)• 1 year ago |
|  | |

No need to uplift to Beta 120. This fix can ride the trains with 121.

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a20264119_75935)• 1 year ago |

Group: mobile-core-security → core-security-release

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a23024157_586683)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main121+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1823316#c47)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367997)
— [Details](attachment.cgi?id=9367997&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1823316#c48)• 1 year ago |
|  | |

How is the decision about the bounty? because the sec-bounty flag has not been set

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a23357246_694415)• 1 year ago |

Flags: needinfo?(dveditz)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a23382091_578488)• 1 year ago |

Alias: CVE-2023-6870

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a23455771_578488)• 1 year ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1823316#c49)• 1 year ago |
|  | |

We have decided not to award a bounty for this bug. As noted in our policy we are interested in encouraging research into more severe vulnerabilities and award bounties to sec-low bugs only when they are interesting and novel.

Flags: sec-bounty?Flags: sec-bounty-Flags: needinfo?(dveditz)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a26152450_75935)• 1 year ago |

Blocks: [1835469](/show_bug.cgi?id=1835469 "VERIFIED FIXED - Android Firefox Fullscreen Toast Message Hide Using Keyboard inside SplitScreen Mode")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1823316#c50)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a37809180_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1823316#a38912724_578488)• 7 months ago |

Flags: sec-bounty-hof+
You need to [log in](/show_bug.cgi?id=1823316&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_49d17580_20250115_094452.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-56

## Security Vulnerabilities fixed in Firefox 121

Announced
December 19, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 121

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6135: NSS susceptible to "Minerva" attack](#CVE-2023-6135)

Reporter
George Pantela (Red Hat) and Hubert Kario (Red Hat)
Impact
high
##### Description

Multiple NSS NIST curves were susceptible to a side-channel attack known as "Minerva". This attack could potentially allow an attacker to recover the private key.

##### References

* [Bug 1853908](https://bugzilla.mozilla.org/show_bug.cgi?id=1853908)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6866: TypedArrays lack sufficient exception handling](#CVE-2023-6866)

Reporter
Tom Schuster
Impact
moderate
##### Description

TypedArrays can be fallible and lacked proper exception handling. This could lead to abuse in other APIs which expect TypedArrays to always succeed.

##### References

* [Bug 1849037](https://bugzilla.mozilla.org/show_bug.cgi?id=1849037)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6868: WebPush requests on Firefox for Android did not require VAPID key](#CVE-2023-6868)

Reporter
John-Mark Gurney
Impact
moderate
##### Description

In some instances, the user-agent would allow push requests which lacked a valid VAPID even though the push manager subscription defined one. This could allow empty messages to be sent from unauthorized parties.
*This bug only affects Firefox on Android.*

##### References

* [Bug 1865488](https://bugzilla.mozilla.org/show_bug.cgi?id=1865488)

#### [#CVE-2023-6869: Content can paint outside of sandboxed iframe](#CVE-2023-6869)

Reporter
Oriol Brufau
Impact
low
##### Description

A `<dialog>` element could have been manipulated to paint content outside of a sandboxed iframe. This could allow untrusted content to display under the guise of trusted content.

##### References

* [Bug 1799036](https://bugzilla.mozilla.org/show_bug.cgi?id=1799036)

#### [#CVE-2023-6870: Android Toast notifications may obscure fullscreen event notifications](#CVE-2023-6870)

Reporter
Hafiizh
Impact
low
##### Description

Applications which spawn a Toast notification in a background thread may have obscured fullscreen notifications displayed by Firefox.
*This issue only affects Android versions of Firefox and Firefox Focus.*

##### References

* [Bug 1823316](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316)

#### [#CVE-2023-6871: Lack of protocol handler warning in some instances](#CVE-2023-6871)

Reporter
Edward "JankhJankh" Prior
Impact
low
##### Description

Under certain conditions, Firefox did not display a warning when a user attempted to navigate to a new protocol handler.

##### References

* [Bug 1828334](https://bugzilla.mozilla.org/show_bug.cgi?id=1828334)

#### [#CVE-2023-6872: Browsing history leaked to syslogs via GNOME](#CVE-2023-6872)

Reporter
honorton via Tor Browser
Impact
low
##### Description

Browser tab titles were being leaked by GNOME to system logs. This could potentially expose the browsing habits of users running in a private tab.

##### References

* [Bug 1849186](https://bugzilla.mozilla.org/show_bug.cgi?id=1849186)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Randell Jesup, Valentin Gosu, Karl Tomlinson, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862777%2C1864015)

#### [#CVE-2023-6873: Memory safety bugs fixed in Firefox 121](#CVE-2023-6873)

Reporter
Andrew McCreight, Yury Delendik
Impact
high
##### Description

Memory safety bugs present in Firefox 120. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855327%2C1862089%2C1862723)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


