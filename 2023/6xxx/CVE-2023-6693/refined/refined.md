```
{
  "CVE-2023-6693": {
    "Description": "QEMU: virtio-net: stack buffer overflow in virtio_net_flush_tx()",
    "Root cause": "A stack-based buffer overflow vulnerability exists in the `virtio_net_flush_tx` function of the QEMU virtio-net device when the guest features VIRTIO_NET_F_HASH_REPORT, VIRTIO_F_VERSION_1, and VIRTIO_NET_F_MRG_RXBUF are enabled. The `n->guest_hdr_len` variable can be set to a value larger than the size of the `virtio_net_hdr_mrg_rxbuf` struct leading to a buffer overflow when copying header data into a local variable on the stack.",
    "Weaknesses": [
      "Stack-based buffer overflow"
    ],
    "Impact": "Successful exploitation could lead to disclosure of sensitive information by overwriting local stack variables to read part of process memory and send it out or a denial of service via overwriting local variables on the stack.",
    "Attack vectors": "The vulnerability can be triggered during the flushing of TX data in a QEMU guest with the vulnerable features enabled.",
    "Required attacker capabilities/position": "The attacker must have the ability to control the guest and trigger the vulnerable code path, potentially by sending specific packets through the virtio-net device when the specified features are negotiated.",
     "Additional Information": "The vulnerability occurs because the size of the header can become larger than what the code allocates on the stack. The fix is to use `virtio_net_hdr_v1_hash` structure when copying the vnet header. The affected software includes QEMU versions prior to 8.1.0 and Red Hat Enterprise Linux 8. The vulnerability can potentially lead to information disclosure or a denial of service. A patch has been created to resolve this issue.",
  }
}
```