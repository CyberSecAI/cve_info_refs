=== Content from packetstormsecurity.com_c21ba41d_20250115_081111.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.fortra.com_0f774b2b_20250115_081120.html ===


[Skip to main content](#main-content)

[![Fortra](https://static.fortra.com/fortra-global-assets/fortra-logo-full.svg?l=999695857)
![Data Classification](https://static.fortra.com/fortra-global-assets/fortra-logo-small.svg?l=538426408)](/ "Home")

English

[English](/security)

English

[English](/security)

* [Email Us](/cdn-cgi/l/email-protection#f69f989099b69e939a86858f8582939b85d895999b)
* 800-328-1000

Secondary Navigation

* [Contact Us](/contact-us)
* [Support](/support)
  + [Support Portal](https://support.fortra.com)
  + [Request Support](https://support.fortra.com/support/cases/open)
  + [Product Releases](/support/release-day)
  + [My Products](https://support.fortra.com/account/products)
  + [Release Notes](https://static.fortra.com/releasenotes/Content/HomePage.htm)
  + [View all Support Options](/support)
* [FREE TRIALS](/products)

* [Platform](/platform)
* Solutions
  Toggle Dropdown
  + Column 1
    - [Infrastructure Protection & Data Security](/solutions/infrastructure-protection-data-security)
      * [Vulnerability Management](/solutions/data-security/vulnerability-management)
      * [Offensive Security](/solutions/data-security/offensive-security)
      * [Email Security & Anti-Phishing](/solutions/data-security/email-security-anti-phishing)
      * [Security Awareness Training](/solutions/data-security/security-awareness/training)
      * [Data Protection](/solutions/data-security/data-protection)
      * [Digital Risk Protection](/solutions/data-security/digital-risk-protection)
      * [Secure File Transfer](/solutions/data-security/secure-file-transfer)
      * [Secure Collaboration](/solutions/data-security/secure-collaboration)
  + Column 2
    - [Managed Security Services](/services/managed-services/security)
      * [Managed Detection & Response](/services/managed-security-services/mdr)
      * [Managed Data Loss Prevention](/services/managed-services/dlp)
      * [Managed Digital Risk Protection](/services/managed-services/drp)
      * [Managed Integrity Monitoring](/services/managed-services/integrity-monitoring)
      * [Managed Web Application Firewall](/services/managed-services/waf)
    - [Automation](/solutions/automation)
      * [Robotic Process Automation](/solutions/automation/robotic-process-automation)
      * [Workload Automation](/solutions/automation/workload-automation)
  + Column 3
    - [Threat Research & Intelligence](/solutions/threat-research-intelligence)
    - [IBM i Solutions](/solutions/ibmi-as400)
      * [Automation](/product-lines/robot)
      * [Cybersecurity](/product-lines/powertech)
      * [Business Intelligence](/product-lines/sequel)
      * [IBM i Security Services](/services/managed-services/security/ibm-i)
    - [View all compliance frameworks](/solutions/data-security/compliance)
    - [View all industries](/industry)
    - [View all solutions](/solutions)
* Products
  Toggle Dropdown
  + Column 1
    - [Agari](/product-lines/agari)
    - [Alert Logic](/product-lines/alert-logic)
    - [Automate](/product-lines/automate)
    - [Beyond Security](/product-lines/beyond-security)
    - [Capacity Management](/product-lines/vityl)
    - [Clearswift](/product-lines/clearswift)
    - [Cobalt Strike](/product-lines/cobalt-strike)
    - [Core Security](/product-lines/core-security)
  + Column 2
    - [Data Classification](https://dataclassification.fortra.com)
    - [Digital Defense](/product-lines/digital-defense)
    - [Digital Guardian](/product-lines/digital-guardian)
    - [Document Management](/product-lines/document-management)
    - [FileCatalyst](/product-lines/filecatalyst)
    - [Globalscape](/product-lines/globalscape)
    - [GoAnywhere](/product-lines/goanywhere)
    - [Halcyon](/product-lines/halcyon)
  + Column 3
    - [Intermapper](/product-lines/intermapper)
    - [JAMS](/product-lines/jams)
    - [Outflank](https://outflank.nl)
    - [PhishLabs](/product-lines/phishlabs)
    - [Powertech](/product-lines/powertech)
    - [Robot](/product-lines/robot)
    - [Sequel](/product-lines/sequel)
    - [Showcase](/product-lines/showcase)
  + Column 4
    - [Terranova Security](/product-lines/terranova-security)
    - [Tripwire](/product-lines/tripwire)
    - [Product Bundles](/products/bundles)
    - [View all products](/products)
    - [Chat live with an expert](/contact-us#leadbot-3)
* Services
  Toggle Dropdown
  + [Success Management](/services/customer-engagement/success-management)
  + [Implementation](/services/customer-engagement/implementation)
  + [Product Training](/services/customer-engagement/training)
  + [Penetration Testing](/services/penetration-testing)
  + [Managed Security Services](/services/managed-security-services)
  + [View all services](/services)
* Resources
  Toggle Dropdown
  + Column 1
    - [Upcoming Webinars & Events](/resources?f%5B0%5D=type%3A1340&f%5B2%5D=type%3A1341)
    - [Videos & On-Demand Webinars](/resources?f%5B0%5D=type%3A1339&f%5B1%5D=type%3A1342)
    - [Case Studies](/solutions/use-cases)
    - [Datasheets](/resources?f%5B0%5D=type%3A1335)
  + Column 2
    - [Articles](/resources?f%5B0%5D=type%3A1331)
    - [Guides](/resources?f%5B0%5D=type%3A1337)
    - [Blogs](/blog)
    - [View all resources](/resources)
  + [Featured
    PCI DSS 4.0 Compliance
    Get the Guide](/resources/guides/pci-dss-4-compliance)
* About
  Toggle Dropdown
  + [About Fortra](/about)
  + [Leadership](/about/our-leadership-team)
  + [Diversity, Equity & Inclusion](/about/diversity-equity-inclusion)
  + [Social Good](/about/social-good)
  + [Careers](/about/careers)
  + [Partners](/about/partner-program)
  + [Newsroom](/about/newsroom)
  + [Security & Trust Center](/security)
  + [Awards](/about/awards "Fortra Awards and Recognition")
  + [Contact Us](/contact-us)
* [Pricing](/pricing)

Keywords

Sort
Best matchNewest firstOldest firstTitle A-ZTitle Z-A

1. [Home](/)
2. Fortra® Security & Trust Center

# Fortra® Security & Trust Center

As your cybersecurity ally, Fortra® is on a mission to help you stay ahead of the constantly changing threat environment. The Fortra Security & Trust Center allows you to find information on security concerns impacting Fortra's products and new discoveries from our team of security researchers.

![icon](/sites/default/files/2024-06/marketplace-survey-results.svg)

As a recognized CNA, Fortra issues CVE IDs and security advisories for vulnerabilities found in our own products and those we discover in other products available in the market.

[Learn More](/security/advisories)

![icon](/sites/default/files/2024-06/alerting-users.svg)

Fortra proactively gathers threat intelligence and initiates an emerging threat when we identify new or evolving risks that may critically impact your environment.

[Learn More](/security/emerging-threats)

### CVEs and ETs in Your Inbox

Add our expert research to your must-read feed.

[Subscribe Here](/security/subscribe)

* [Emerging Threats](/security/emerging-threats)
* [Security Advisories](/security/advisories)

  + [Fortra Product CVEs](/security/advisories/product-security)
  + [Fortra Discovered CVEs](/security/advisories/research)
* [Report a Vulnerability](/security/report)
* [Disclosure Policy](/security/policy)
* [Secure Development Lifecycle](/security/secure-development-lifecycle)
* [Threat Research](/security/research)

[![Fortra logo](/themes/custom/fortra_parent_2022/images/logo.svg)](https://www.fortra.com "Home")

* +1 800-328-1000
* [Email Us](/cdn-cgi/l/email-protection#0861666e67486e677a7c7a69266b6765)
* [Start Live Chat](/contact-us#leadbot-3)
* [Request Support](https://support.fortra.com/support/cases/open)
* [Subscribe](/resources/fortra-subscription-center)

* [X Find us on
  X](https://twitter.com/fortraofficial)
* [LinkedIn Find us on
  LinkedIn](https://www.linkedin.com/company/fortra)
* [Youtube Find us on
  Youtube](https://www.youtube.com/channel/UCuiogAh6174TT6ms4bEz3og)
* [Reddit Find us on Reddit](https://www.reddit.com/r/Fortra/)

Footer menu
### [Products & Solutions](/solutions)

* [Infrastructure Protection & Data Security](/solutions/infrastructure-protection-data-security)
* [Managed Security Services](/services/managed-security-services)
* [Automation](/solutions/automation)
* [IBM i Solutions](/solutions/ibmi-as400)
* [All Products](/products)
* [All Solutions](/solutions)

### [Services](/services)

* [Product Services & Training](/services/customer-engagement)
* [Consulting](/services/ibm-power)

### [Resources](/resources)

* [Live Webinars](/resources?f%5B0%5D=type%3A1333)
* [On-Demand Webinars](/resources?f%5B0%5D=type%3A1339&f%5B1%5D=type%3A1342)
* [Guides](/resources?f%5B0%5D=type%3A1337)
* [Articles](/resources?f%5B0%5D=type%3A1331)
* [Case Studies](/resources?f%5B0%5D=type%3A1334)
* [Blogs](/blog)
* [Events](/resources?f%5B0%5D=type%3A1333)
* [Datasheets](/resources?f%5B0%5D=type%3A1335)
* [Glossary](/glossary)
* [Join Our Mailing List](/resources/fortra-subscription-center)

### [Support](/support)

* [Support Portal](https://support.fortra.com)
* [Request Support](https://support.fortra.com/support/cases/open)
* [Product Releases](/support/release-day)
* [My Products](https://support.fortra.com/account/products)
* [Training](/support/training)
* [Release Notes](https://static.fortra.com/releasenotes/Content/HomePage.htm)
* [View All Support Options](https://www.fortra.com/support)
* [License Change Request Form](/support/license-change-request)
* [DR Test Code Request](/support/disaster-recovery-test-code-request)
* [Product Certification](/services/ibm-power/request-certification-test)

### [About](/about)

* [About Fortra](/about)
* [Security & Trust Center](/security)
* [Newsroom](/about/newsroom)
* [Careers](/about/careers)
* [Partners](/about/channel-program)
* [Events](/resources?f%5B0%5D=type%3A1333)
* [Our Team](/about/our-leadership-team)
* [Accessibility](/about/accessibility)
* [[email protected]](/cdn-cgi/l/email-protection#7811161e17381e170a0c0a19561b1715470b0d1a121d1b0c451e170a0c0a19550f1d1a0b110c1d)

### [Contact Information](/contact-us)

### [Privacy Policy](/privacy-policy)

### [Cookie Policy](/cookie-policy)

###

### [Impressum](/impressum)

Copyright © Fortra, LLC and its group of companies. Fortra®, the Fortra® logos, and other identified marks are proprietary trademarks of Fortra, LLC.



=== Content from seclists.org_16a407ff_20250115_081115.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
![Next](/images/right-icon-16x16.png)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
![Next](/images/right-icon-16x16.png)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20231123 :: Uninstall Key Caching in Fortra Digital Guardian Agent Uninstaller

---

*From*: "SEC Consult Vulnerability Lab, Research via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Thu, 23 Nov 2023 07:43:27 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20231123-0 >
=======================================================================
               title: Uninstall Key Caching
             product: Fortra Digital Guardian Agent Uninstaller
                      (Data Loss Prevention)
  vulnerable version: Agent: <7.9.4
       fixed version: Agent: 7.9.4
          CVE number: CVE-2023-6253
              impact: High
            homepage: <https://www.fortra.com/product-lines/digital-guardian>
               found: 2023-05-16
                  by: J. Kruchem (Office Vienna)
                      B. Gründling (Office Vienna)
                      D. Hirschberger (Office Bochum)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Eviden business
                      Europe | Asia

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"Digital Guardian is proud to be part of Fortra’s comprehensive cybersecurity
portfolio. Fortra simplifies today’s complex cybersecurity landscape by bringing
complementary products together to solve problems in innovative ways. These
integrated, scalable solutions address the fast-changing challenges you face in
safeguarding your organization. With the help of the powerful protection from
Digital Guardian and others, Fortra is your relentless ally, here for you every
step of the way throughout your cybersecurity journey."

Source: <https://www.digitalguardian.com/>

Business recommendation:
------------------------
SEC Consult recommends users of this platform to install the latest update.

Furthermore, an in-depth security analysis performed by security professionals is
highly advised, as the software may be affected from other security issues.

Vulnerability overview/description:
-----------------------------------
1) Stored Cross-Site Scripting
The "PDF templates" feature is vulnerable against stored cross-site scripting
because it allows inserting arbitrary HTML. Therefore, an administrator can
create a malicious template which contains JavaScript and can send a link to
this template to authenticated users.

According to the vendor, this feature works as intended and the associated risk
is low, hence it will not be fixed.

2) UninstallKey Cached in Memory / Installer File (CVE-2023-6253)
The Agent Uninstaller handles sensitive data insecurely and caches the Uninstall
key in memory. This key can be used to stop or uninstall the application.
This allows a locally authenticated attacker with administrative privileges
to disable the application temporarily or even remove the application from the
system completely.

Proof of concept:
-----------------
1) Stored Cross-Site Scripting
According to the vendor, this feature works as intended and the associated risk
is low, hence it will not be fixed.

When editing PDF templates in the Digital Guardian Management Console (DGMC)
JavaScript code can be injected. By clicking on "preview" the XSS code gets
triggered.

The "PDF templates" feature can be found in the System -> Configuration menu.
Here, a new template can be uploaded, or an existing one can be edited. To
exploit the issue, malicious JavaScript can be added to a template:

<xss_insert.png>

Afterwards, the XSS is executed when the template is previewed with the
corresponding button:

<xss_trigger.png>

The attacker can also send the direct link to the template to the victim:
<https://DG_HOST/DigitalGuardian/PopUps/PDFTemplatePreview.aspx?name=XSS.htm>

If a victim opens the link while authenticated, the JavaScript code will
be executed.

2) UninstallKey Cached in Memory / Installer File (CVE-2023-6253)
When executing the installer of the DG Agent (.msi) the uninstall key is
pre-configured and can be read out (e.g. via Debugging).

First, the LocalPackage registry hive was identified, which reveals the MSI
installation package located in the Windows directory:

<registry.png>

The file can be executed without local administrator privileges. When executed
and clicked "Next", the Uninstall Key is prefilled as can be seen in the
following figure:

<installer.png>

Note: For demonstration purposes and simplification of the proof of concept, the
provided administrative access to the management console was used to append a
unique string to the uninstall key so it can be found in the memory more
efficiently. An attacker can also find the key without this modification. For
this purpose, the string "sectest" was appended.

WinDbg can be used to extract this key. WinDbg can simply be attached to the
process. Afterwards, the execution is paused in WinDbg and the following command
is used to search for the unique string:

```
> ```
> s -u 0 L?FFFFFFFFFFFFFFFF "sectest"
>
> ```

```

The following figure shows the output of this command (since a very large memory
space is searched, "Break" can be used to stop WinDbg from searching).

<windbg_1.png>

The memory space before "sectest" needs to be viewed to show the uninstall key.
The command db 000001c6`165b63a8 can be used to show the memory, as can be seen
in the following figure:

<windbg_2.png>

Thus, the original uninstall key is "dlpuninstall".

Furthermore, it can be used with the Terminator.exe found in the following path:
"C:\Program Files\[...]\DLP"

Running the application and supplying the key via an elevated command prompt,
it terminates all agent processes:

<terminator.png>

This binary can also be used to brute-force the correct Uninstall key, by
repeatedly calling it with possible Uninstall key candidates:
\.Terminator.exe <key candidate>

Vulnerable / tested versions:
-----------------------------
The following version has been tested:
* Management Console: 8.5.0.0317
* Agent: 7.8.5.0048

The vendor confirmed that all current and previous versions are affected.

Vendor contact timeline:
------------------------
2023-06-12: Contacting vendor through email (info () fortra com);
             asking for security contact, no response.
2023-06-26: Contacting vendor through same email again, no response.
2023-07-28: Contacting vendor through a more direct email-channel, no response.
2023-09-14: Sent another email to various email addresses found on the
             website. Their "security.txt" file only points to inaccessible
             pages (403 Access denied or 404 for the PGP key).
2023-09-14: Vendor response (Fortra support contact): forwarded our email to
             Digital Guardian support team.
             Support team and product security team reply.
2023-09-15: Asked for email encryption, received PGP key.
2023-09-18: Sending encrypted security advisory.
2023-09-19: Confirmation of receipt, team is working on verification and
             development.
2023-10-11: Asking for status update.
             Vendor response: XSS could be replicated but functionality works
             as intended and won't be fixed because of limited exposure.
             Issue 2 could not be verified yet, but engineering has acknowledged
             it as addressable. Fix is planned for Q4. All current and previous
             versions are affected.
2023-10-12: Asking for CVE number and if further input regarding vulnerability 2
             is needed, no response.
2023-10-17: Received ticket notification that next maintenance update version
             7.9.4 should be available for customer testing in the near future.
2023-11-09: Received ticket notification that version 7.9.4 is now GA for all
             customers.
2023-11-13: Sending advisory draft to vendor, asking for CVE number for issue 2
             again, scheduling advisory release for next week.
2023-11-17: Vendor response, no CVE number yet, we will request one ourselves.
2023-11-23: Public release of security advisory.

Solution:
---------
The vendor provides an updated Agent version 7.9.4 which can be downloaded
at the vendor's support page:
<https://www.digitalguardian.com/services/support>

Access controls to the management console along with monitoring and preventive
controls are recommended compensating controls for issue 1 according to the vendor.

Workaround:
-----------
To prevent disclosure of the uninstall key (issue 2) change it immediately after
deploying the DG agent on the system.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult? Send us your application
<https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF J. Kruchem, B. Gründling, D. Hirschberger / @2023
```

[![](att-14/installer.png)](att-14/installer.png)

[![](att-14/registry.png)](att-14/registry.png)

[![](att-14/terminator.png)](att-14/terminator.png)

[![](att-14/windbg_1.png)](att-14/windbg_1.png)

[![](att-14/windbg_2.png)](att-14/windbg_2.png)

[![](att-14/xss_insert.png)](att-14/xss_insert.png)

[![](att-14/xss_trigger.png)](att-14/xss_trigger.png)

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
![Next](/images/right-icon-16x16.png)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
![Next](/images/right-icon-16x16.png)

### Current thread:

* **SEC Consult SA-20231123 :: Uninstall Key Caching in Fortra Digital Guardian Agent Uninstaller** *SEC Consult Vulnerability Lab, Research via Fulldisclosure (Nov 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from r.sec-consult.com_bf0fc4e5_20250115_081119.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/uninstall-key-caching-im-fortra-digital-guardian-agent-uninstaller/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Uninstall Key Caching in Fortra Digital Guardian Agent Uninstaller
# Uninstall Key Caching in Fortra Digital Guardian Agent Uninstaller

Title

Uninstall Key Caching

Product

Fortra Digital Guardian Agent Uninstaller

Vulnerable Version

Agent: <7.9.4

Fixed Version

Agent: 7.9.4

CVE Number

CVE-2023-6253

Impact

high

Homepage

[https://www.fortra.com/product-lines/digital-guardian](https://www.fortra.com/product-lines/digital-guardian "https://www.fortra.com/product-lines/digital-guardian")

Found

16.05.2023

By

J. Kruchem (Office Vienna), B. Gründling (Office Vienna), D. Hirschberger (Office Bochum) | SEC Consult Vulnerability Lab

The Digital Guardian Management Console is vulnerable to a Stored Cross-Site Scripting attack in the PDF Template functionality. The vendor replied that this is an intended feature. The Digital Guardian Agent Uninstaller File also caches the Uninstall Key which can be extracted by an attacker with administrative privileges and be used to terminate and uninstall the agent.

## Vendor description

"*Digital Guardian is proud to be part of Fortra’s comprehensive cybersecurity portfolio. Fortra simplifies today’s complex cybersecurity landscape by bringing complementary products together to solve problems in innovative ways. These integrated, scalable solutions address the fast-changing challenges you face in safeguarding your organization. With the help of the powerful protection from Digital Guardian and others, Fortra is your relentless ally, here for you every step of the way throughout your cybersecurity journey.*"

Source: [https://www.digitalguardian.com/](https://www.digitalguardian.com)

## Business recommendation

SEC Consult recommends users of this platform to install the latest update.

Furthermore, an in-depth security analysis performed by security professionals is highly advised, as the software may be affected from other security issues.

## Vulnerability overview/description

### 1) Stored Cross-Site Scripting

The "PDF templates" feature is vulnerable against stored cross-site scripting because it allows inserting arbitrary HTML. Therefore, an administrator can create a malicious template which contains JavaScript and can send a link to this template to authenticated users.

According to the vendor, this feature works as intended and the associated risk is low, hence it will not be fixed.

### 2) UninstallKey Cached in Memory / Installer File (CVE-2023-6253)

The Agent Uninstaller handles sensitive data insecurely and caches the Uninstall key in memory. This key can be used to stop or uninstall the application. This allows a locally authenticated attacker with administrative privileges to disable the application temporarily or even remove the application from the system completely.

![](/fileadmin/_processed_/2/0/csm_sec-consult-c-fortra-xss_insert_7841cbf009.png)

Figure 1

![](/fileadmin/_processed_/2/f/csm_sec-consult-c-fortra-xss_trigger_74907b900a.png)

Figure 2

## Proof of concept

### 1) Stored Cross-Site Scripting

According to the vendor, this feature works as intended and the associated risk is low, hence it will not be fixed.

When editing PDF templates in the Digital Guardian Management Console (DGMC) JavaScript code can be injected. By clicking on "preview" the XSS code gets triggered.

The "PDF templates" feature can be found in the System -> Configuration menu. Here, a new template can be uploaded, or an existing one can be edited. To exploit the issue, malicious JavaScript can be added to a template (see Figure 1). Afterwards, the XSS is executed when the template is previewed with the corresponding button (Figure 2).

The attacker can also send the direct link to the template to the victim:

```
https:// DG_HOST/DigitalGuardian/PopUps/PDFTemplatePreview.aspx?name=XSS.htm
```

If a victim opens the link while authenticated, the JavaScript code will be executed.

![](/fileadmin/_processed_/e/1/csm_sec-consult-c-fortra-registry_4af167af8e.png)

Figure 3

![](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_11/sec-consult-c-fortra-installer.png)

Figure 4

### 2) UninstallKey Cached in Memory / Installer File (CVE-2023-6253)

When executing the installer of the DG Agent (.msi) the uninstall key is pre-configured and can be read out (e.g. via Debugging). First, the LocalPackage registry hive was identified, which reveals the MSI installation package located in the Windows directory (Figure 3).

The file can be executed without local administrator privileges. When executed and clicked "Next", the Uninstall Key is prefilled as can be seen in figure 4.

Note: For demonstration purposes and simplification of the proof of concept, the provided administrative access to the management console was used to append a unique string to the uninstall key so it can be found in the memory more efficiently. An attacker can also find the key without this modification. For this purpose, the string "sectest" was appended.

WinDbg can be used to extract this key. WinDbg can simply be attached to the process. Afterwards, the execution is paused in WinDbg and the following command is used to search for the unique string:

```
> s -u 0 L?FFFFFFFFFFFFFFFF "sectest"
```
![](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_11/sec-consult-c-fortra-windbg_1.png)

Figure 5

![](/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_11/sec-consult-c-fortra-windbg_2.png)

Figure 6

Figure 5 shows the output of this command (since a very large memory space is searched, "Break" can be used to stop WinDbg from searching).

The memory space before "sectest" needs to be viewed to show the uninstall key. The command db 000001c6`165b63a8 can be used to show the memory, as can be seen in figure 6.

![](/fileadmin/_processed_/9/d/csm_sec-consult-c-fortra-terminator_13341b17ae.png)

Figure 7

Thus, the original uninstall key is "dlpuninstall".

Furthermore, it can be used with the Terminator.exe found in the following path:

```
"C:\Program Files\[...]\DLP"
```

Running the application and supplying the key via an elevated command prompt, it terminates all agent processes (Figure 7).

This binary can also be used to brute-force the correct Uninstall key, by repeatedly calling it with possible Uninstall key candidates:

```
\.Terminator.exe <key candidate>
```
## Vulnerable / tested versions

The following version has been tested:

* Management Console: 8.5.0.0317
* Agent: 7.8.5.0048

The vendor confirmed that all current and previous versions are affected.

## Vendor contact timeline

| 2023-06-12 | Contacting vendor through email (info@fortra.com); asking for security contact, no response. |
| --- | --- |
| 2023-06-26 | Contacting vendor through same email again, no response. |
| 2023-07-28 | Contacting vendor through a more direct email-channel, no response. |
| 2023-09-14 | Sent another email to various email addresses found on the website. Their "security.txt" file only points to inaccessible pages (403 Access denied or 404 for the PGP key). |
| 2023-09-14 | Vendor response (Fortra support contact) forwarded our email to Digital Guardian support team. Support team and product security team reply. |
| 2023-09-15 | Asked for email encryption, received PGP key. |
| 2023-09-18 | Sending encrypted security advisory. |
| 2023-09-19 | Confirmation of receipt, team is working on verification and development. |
| 2023-10-11 | Asking for status update. Vendor response XSS could be replicated but functionality works as intended and won't be fixed because of limited exposure. Issue 2 could not be verified yet, but engineering has acknowledged it as addressable. Fix is planned for Q4. All current and previous versions are affected. |
| 2023-10-12 | Asking for CVE number and if further input regarding vulnerability 2 is needed, no response. |
| 2023-10-17 | Received ticket notification that next maintenance update version 7.9.4 should be available for customer testing in the near future. |
| 2023-11-09 | Received ticket notification that version 7.9.4 is now GA for all customers. |
| 2023-11-13 | Sending advisory draft to vendor, asking for CVE number for issue 2 again, scheduling advisory release for next week. |
| 2023-11-17 | Vendor response, no CVE number yet, we will request one ourselves. |
| 2023-11-23 | Public release of security advisory. |

## Solution

The vendor provides an updated Agent version 7.9.4 which can be downloaded at the vendor's support page:
<https://www.digitalguardian.com/services/support>

Access controls to the management console along with monitoring and preventive controls are recommended compensating controls for issue 1 according to the vendor.

## Workaround

To prevent disclosure of the uninstall key (issue 2) change it immediately after deploying the DG agent on the system.

## Advisory URL

<https://sec-consult.com/vulnerability-lab/>

EOF J. Kruchem, B. Gründling, D. Hirschberger / @2023

*Interested to work with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


