=== Content from cert.pl_a9df13af_20250115_092316.html ===


[Report an incident](https://incydent.cert.pl/#!/lang=en)

Back

* You're in the menu
* About us
  + About us
  + [About our team](../../../../about-us/)
  + [Contact](../../../../contact/)
* [News](../../../../news/)
* For experts
  + For experts
  + [News](../../../../news/)
  + [Publications](../../../../publications/)
  + [The Warning List](../../../../warning-list/)
  + Projects
  + [n6](../../../../n6/)
  + [Artemis](/en/posts/2024/01/artemis-security-scanner/)
  + [MWDB](https://mwdb.cert.pl/)
  + CVD program
  + [CVD policy](../../../../cvd)
  + [Advisories](../../../../cve)

* About us
* [News](../../../../news/)
* For experts

[Report an incident](https://incydent.cert.pl/#!/lang=en)

About us
[About our team](../../../../about-us/)
[Contact](../../../../contact/)

Baza wiedzy
[FaÅszywe inwestycje](/falszywe-inwestycje)
[UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
[FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
[FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
[FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÅstwa OUCH!](/ouch)

For experts
[Publications](../../../../publications/)
[The Warning List](../../../../warning-list/)

Projects
[n6](../../../../n6/)
[Artemis](/en/posts/2024/01/artemis-security-scanner/)
[MWDB](https://mwdb.cert.pl/)

CVD program
[CVD policy](../../../../cvd)
[Advisories](../../../../cve)

Vulnerability in class.upload.php open source library

04 January 2024
| [CERT Polska](../../../../author/cert-polska/) | [#vulnerability](../../../../tag/vulnerability/), [#warning](../../../../tag/warning/), [#cve](../../../../tag/cve/)

| **CVE ID** | [CVE-2023-6551](https://www.cve.org/CVERecord?id=CVE-2023-6551) |
| --- | --- |
| **Publication date** | 04 January 2024 |
| **Vendor** | Colin Verot |
| **Product** | class.upload.php |
| **Vulnerable versions** | All |
| **Vulnerability type (CWE)** | Unrestricted Upload of File with Dangerous Type ([CWE-434](https://cwe.mitre.org/data/definitions/434.html)) |
| **Report source** | Own research |

## Description

As a simple library, [class.upload.php](https://github.com/verot/class.upload.php) does not perform an in-depth check on uploaded files, allowing a Stored XSS vulnerability when the default configuration is used.
Developers must be aware of that fact and use extension whitelisting accompanied by forcing the server to always provide content-type based on the file extension.
The README has been updated to include these guidelines.

The weakness has been confirmed by the vendor and assigned the ID [CVE-2023-6551](https://www.cve.org/CVERecord?id=CVE-2023-6551).

---

More about the coordinated vulnerability disclosure process at CERT Polska can be found at [https://cert.pl/en/cvd/](https://cert.pl/cvd/).

CERT Polska is a team operating within the structures of NASK - National Research Institute,
established in 1996 to respond to computer security incidents. It carries out the role of
CSIRT NASK, one of three such teams operating at the national level within the Polish national
cybersecurity system.

# Social media

[![](/theme/assets/img/img.gif)Facebook](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska_en)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Contact

Address: Kolska 12, 01-045 Warsaw, Poland

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÄczenia: AE:PL-60057-61611-BCEGR-11

E-mail: [[email protected]](/cdn-cgi/l/email-protection#60090e060f20030512144e100c)

Incident reporting: [incydent.cert.pl](https://incydent.cert.pl/#!/lang=en)

[[email protected]](/cdn-cgi/l/email-protection#cfacaabdbb8facaabdbbe1bfa3)

![Co-financed by the Connecting Europe Facility of The European Union](/theme/assets/img/ue-en.png)

* Â© 2025 [NASK](https://nask.pl/)
* [Privacy policy](/uploads/misc/privacy-policy-en.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)



=== Content from cert.pl_80835164_20250115_222428.html ===


[ZgÅoÅ incydent](https://incydent.cert.pl/)

Cofnij

* JesteÅ w nawigacji
* O nas
  + O nas
  + [O zespole](../o-nas/)
  + [Praca](/praca)
  + [Kontakt](../kontakt/)
* [AktualnoÅci](../news/)
* Baza wiedzy
  + Baza wiedzy
  + [FaÅszywe inwestycje](/falszywe-inwestycje)
  + [UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
  + [(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
  + [FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
  + [Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
  + [FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
  + [FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
  + [FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)
  + Biuletyn OUCH!
  + [Porady bezpieczeÅstwa OUCH!](/ouch)
* Dla ekspertÃ³w
  + Dla ekspertÃ³w
  + [AktualnoÅci](../news/)
  + [Publikacje](../publikacje/)
  + [Lista OstrzeÅ¼eÅ](../lista-ostrzezen/)
  + [Kompendium o hasÅach](/hasla/)
  + Projekty
  + [n6](../n6/)
  + [Artemis](/skanowanie/)
  + [MWDB](https://mwdb.cert.pl/)
  + Program CVD
  + [Polityka CVD](../cvd)
  + [Lista podatnoÅci](../cve)

* O nas
* [AktualnoÅci](../news/)
* Baza wiedzy
* Dla ekspertÃ³w

[ZgÅoÅ incydent](https://incydent.cert.pl/)

O nas
[O zespole](../o-nas/)
[Praca](/praca)
[Kontakt](../kontakt/)

Baza wiedzy
[FaÅszywe inwestycje](/falszywe-inwestycje)
[UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
[FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
[FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
[FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÅstwa OUCH!](/ouch)

Dla ekspertÃ³w
[Publikacje](../publikacje/)
[Lista OstrzeÅ¼eÅ](../lista-ostrzezen/)
[Kompendium o hasÅach](/hasla/)

Projekty
[n6](../n6/)
[Artemis](/skanowanie/)
[MWDB](https://mwdb.cert.pl/)

Program CVD
[Polityka CVD](../cvd)
[Lista podatnoÅci](../cve)

ZgÅaszanie i obsÅuga podatnoÅci (CVD)

### Gdzie zgÅosiÄ podatnoÅÄ?

**Przed zgÅoszeniem znalezionej podatnoÅci do CERT Polska i upublicznieniem jej, zgÅaszajÄcy powinien skontaktowaÄ siÄ bezpoÅrednio z wÅaÅcicielem podatnego systemu lub dostawcÄ oprogramowania.**

JeÅli nie jest moÅ¼liwe znalezienie kontaktu, lub kontakt jest utrudniony, podatnoÅÄ naleÅ¼y zgÅosiÄ do wÅaÅciwego CSIRT-u wedÅug obowiÄzujÄcego zakresu odpowiedzialnoÅci, zgodnie z poniÅ¼szym opisem:

**Do zadaÅ CSIRT MON** naleÅ¼y koordynacja obsÅugi zgÅaszanych podatnoÅci w podmiotach podlegÅych Ministrowi Obrony Narodowej lub przez niego nadzorowanych. ZgÅaszanie podatnoÅci do CSIRT MON wg [instrukcji na stronie](https://csirt-mon.wp.mil.pl/pl/pages/zgloszenie-incydentu/).

**Do zadaÅ CSIRT GOV** naleÅ¼y koordynacja obsÅugi podatnoÅci zgÅaszanych m.in. w jednostkach podlegÅych Prezesowi Rady MinistrÃ³w lub przez niego nadzorowanych, podmiotach wchodzÄcych w skÅad infrastruktury krytycznej, organach centralnej administracji rzÄdowej, Narodowym Banku Polskim, Banku Gospodarstwa Krajowego. ZgÅaszanie podatnoÅci do CSIRT GOV wg [instrukcji na stronie](https://csirt.gov.pl/cer/zgloszenie-incydentu/16%2CZgloszenie-incydentu-do-CSIRT-GOV.html).

JeÅli podatnoÅÄ dotyczy innych podmiotÃ³w, lub gdy zgÅaszajÄcy ma wÄtpliwoÅÄ gdzie powinien dokonaÄ zgÅoszenia, naleÅ¼y skorzystaÄ z formularza dostÄpnego pod poniÅ¼szym przyciskiem:

[ZgÅoÅ podatnoÅÄ do CERT Polska/CSIRT NASK](https://incydent.cert.pl/#!/lang=pl,entityType=notObligatedEntity,easyIncidentType=vulnerability)

### Jak wyglÄda obsÅuga zgÅoszenia po stronie CERT Polska / CSIRT NASK?

KaÅ¼de otrzymane zgÅoszenie o podatnoÅci zostanie przez nas przeanalizowane. W przypadku potrzeby uzyskania dodatkowych informacji lub ich uzupeÅnienia, nasi analitycy skontaktujÄ siÄ bezpoÅrednio ze ZgÅaszajÄcym. W razie koniecznoÅci wymiany informacji miÄdzy ZgÅaszajÄcym, a wÅaÅcicielem podatnego systemu, CERT Polska moÅ¼e wesprzeÄ ten proces jako zaufana strona.

**Priorytetowo traktujemy zgÅoszenia, ktÃ³re dotyczÄ wielu producentÃ³w lub podmiotÃ³w i mogÄ mieÄ znaczny wpÅyw na bezpieczeÅstwo krajowe.**

![](/uploads/projects/cvd/infografika_zglaszaniePodatnosci.png)

Po zakoÅczeniu caÅego procesu zgÅaszania podatnoÅci i po zaÅataniu bÅÄdu, CERT Polska moÅ¼e upubliczniÄ na swojej stronie informacje o podatnoÅci w sposÃ³b nie pozwalajÄcy na zidentyfikowanie zgÅaszajÄcego oraz nie wskazujÄcy na jego systemy. Informacja ta bÄdzie zawieraÅa dane zgÅaszajÄcego wyÅÄcznie po wyraÅ¼eniu przez niego zgody.

**Prosimy o niepublikowanie informacji o podatnoÅci przed zakoÅczeniem procesu jej obsÅugi. JeÅli ZgÅaszajÄcy planuje takie dziaÅania, prosimy o informacjÄ wyprzedzajÄcÄ.**

### Jak i kiedy sÄ nadawane numery CVE?

W przypadku gdy podatnoÅÄ dotyczy oprogramowania wykorzystywanego na wielu systemach moÅ¼liwe jest uzyskanie dla niej numeru CVE. WiÄcej o programie CVE moÅ¼na przeczytaÄ pod adresem: <https://www.cve.org/About/Overview>

PrzykÅadowo, podatnoÅÄ wystÄpujÄca na stronie internetowej jednego urzÄdu miasta nie otrzyma numeru CVE, ale podatnoÅÄ w systemie zarzÄdzania treÅciÄ wykorzystywanym przez wiele urzÄdÃ³w moÅ¼e taki numer otrzymaÄ. Numer CVE nie zostanie rÃ³wnieÅ¼ nadany jeÅli podatnoÅÄ wynika z bÅÄdu konfiguracyjnego osoby wdraÅ¼ajÄcej system, a nie systemu samego w sobie.

Wniosek o nadanie CVE powinien zostaÄ wysÅany do wÅaÅciwego podmiotu nadajÄcego, tzw. CVE Numbering Authorities (CNA), zaleÅ¼nie od tego jakiego systemu dotyczy podatnoÅÄ. ListÄ CNA oraz informacjÄ jak wysÅaÄ zgÅoszenie moÅ¼na znaleÅºÄ na stronie: <https://www.cve.org/ReportRequest/ReportRequestForNonCNAs>

JeÅli podatnoÅÄ dotyczy polskiego producenta, ktÃ³ry nie jest CNA, lub jeÅli ZgÅaszajÄcy ma problem z nawiÄzaniem kontaktu z wÅaÅciwym CNA, jako CERT Polska moÅ¼emy wesprzeÄ ZgÅaszajÄcego w procesie nadawania numeru CVE.

ZgÅoszenia podatnoÅci odbywajÄ siÄ wyÅÄcznie [poprzez dedykowany formularz](https://incydent.cert.pl/#!/lang=pl,entityType=notObligatedEntity,easyIncidentType=vulnerability). Przekazujemy te informacje producentowi oprogramowania niezwÅocznie po otrzymaniu zgÅoszenia.

Wpisy CVE publikujemy po 90 dniach od daty przesÅania producentowi szczegÃ³ÅÃ³w wykrytych sÅaboÅci. MoÅ¼e to nastÄpiÄ szybciej w przypadku gdy wydana zostanie aktualizacja usuwajÄca danÄ podatnoÅÄ lub gdy mimo wielokrotnych prÃ³b kontaktu z producentem nie udaje siÄ uzyskaÄ zadowalajÄcej wspÃ³Åpracy. W uzasadnionych przypadkach dopuszczamy rÃ³wnieÅ¼ moÅ¼liwoÅÄ przedÅuÅ¼enia tego okresu.

W przypadku innych pytaÅ zwiÄzanych z procesem ujawniania podatnoÅci prosimy o kontakt pod adresem: [[email protected]](/cdn-cgi/l/email-protection#d8bbaebc98bbbdaaacf6a8b4).

CERT Polska to zespÃ³Å dziaÅajÄcy w strukturach NASK - PaÅstwowego Instytutu Badawczego,
powoÅany w 1996 roku do reagowania na incydenty bezpieczeÅstwa komputerowego. Realizuje
zadania CSIRT NASK, jednego z trzech takich zespoÅÃ³w dziaÅajÄcych na poziomie
krajowym w ramach krajowego systemu cyberbezpieczeÅstwa.

# CERT Polska w social mediach

[![](/theme/assets/img/img.gif)](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Kontakt

ul. Kolska 12, 01-045 Warszawa

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÄczenia: AE:PL-60057-61611-BCEGR-11

e-mail: [[email protected]](/cdn-cgi/l/email-protection#dbb2b5bdb49bb8bea9aff5abb7)

ZgÅaszanie incydentÃ³w: [incydent.cert.pl](https://incydent.cert.pl/)

[[email protected]](/cdn-cgi/l/email-protection#650600171125060017114b1509)

![WspÃ³Åfinansowane przez instrument Unii Europejskiej ÅÄczÄc EuropÄ](/theme/assets/img/ue.png)

* Â© 2025 [NASK](https://nask.pl/)
* [Polityka prywatnoÅci](/uploads/misc/privacy-policy.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)



=== Content from github.com_1ac3531c_20250115_134425.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fverot%2Fclass.upload.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fverot%2Fclass.upload.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=verot%2Fclass.upload.php)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[verot](/verot)
/
**[class.upload.php](/verot/class.upload.php)**
Public

* [Notifications](/login?return_to=%2Fverot%2Fclass.upload.php) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fverot%2Fclass.upload.php)
* [Star
   882](/login?return_to=%2Fverot%2Fclass.upload.php)

This PHP class uploads files and manipulates images very easily. It is in fact as much as an image processing class than it is an upload class. Compatible with PHP 4, 5, 7 and 8. Supports processing of local files, uploaded files, files sent through XMLHttpRequest.

[www.verot.net/php\_class\_upload.htm](http://www.verot.net/php_class_upload.htm "http://www.verot.net/php_class_upload.htm")

### License

[GPL-2.0 license](/verot/class.upload.php/blob/master/LICENSE.txt)

[882
stars](/verot/class.upload.php/stargazers) [359
forks](/verot/class.upload.php/forks) [Branches](/verot/class.upload.php/branches) [Tags](/verot/class.upload.php/tags) [Activity](/verot/class.upload.php/activity)
 [Star](/login?return_to=%2Fverot%2Fclass.upload.php)

 [Notifications](/login?return_to=%2Fverot%2Fclass.upload.php) You must be signed in to change notification settings

* [Code](/verot/class.upload.php)
* [Issues
  4](/verot/class.upload.php/issues)
* [Pull requests
  0](/verot/class.upload.php/pulls)
* [Actions](/verot/class.upload.php/actions)
* [Security](/verot/class.upload.php/security)
* [Insights](/verot/class.upload.php/pulse)

Additional navigation options

* [Code](/verot/class.upload.php)
* [Issues](/verot/class.upload.php/issues)
* [Pull requests](/verot/class.upload.php/pulls)
* [Actions](/verot/class.upload.php/actions)
* [Security](/verot/class.upload.php/security)
* [Insights](/verot/class.upload.php/pulse)

# verot/class.upload.php

    master[Branches](/verot/class.upload.php/branches)[Tags](/verot/class.upload.php/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[112 Commits](/verot/class.upload.php/commits/master/) | | |
| [src](/verot/class.upload.php/tree/master/src "src") | | [src](/verot/class.upload.php/tree/master/src "src") |  |  |
| [test](/verot/class.upload.php/tree/master/test "test") | | [test](/verot/class.upload.php/tree/master/test "test") |  |  |
| [.gitignore](/verot/class.upload.php/blob/master/.gitignore ".gitignore") | | [.gitignore](/verot/class.upload.php/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE.txt](/verot/class.upload.php/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/verot/class.upload.php/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/verot/class.upload.php/blob/master/README.md "README.md") | | [README.md](/verot/class.upload.php/blob/master/README.md "README.md") |  |  |
| [composer.json](/verot/class.upload.php/blob/master/composer.json "composer.json") | | [composer.json](/verot/class.upload.php/blob/master/composer.json "composer.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-2.0 license
# class.upload.php

Homepage : <http://www.verot.net/php_class_upload.htm>

Demo : <http://www.verot.net/php_class_upload_samples.htm>

Donations: <http://www.verot.net/php_class_upload_donate.htm>

Commercial use: <http://www.verot.net/php_class_upload_license.htm>

## What does it do?

This class manages file uploads for you. In short, it manages the uploaded file, and allows you to do whatever you want with the file, especially if it is an image, and as many times as you want.

It is the ideal class to quickly integrate file upload in your site. If the file is an image, you can convert, resize, crop it in many ways. You can also apply filters, add borders, text, watermarks, etc... That's all you need for a gallery script for instance. Supported formats are PNG, JPG, GIF, WEBP and BMP.

You can also use the class to work on local files, which is especially useful to use the image manipulation features. The class also supports Flash uploaders and XMLHttpRequest.

The class works with PHP 5.3+, PHP 7 and PHP 8 (use version 1.x for PHP 4 support), and its error messages can be localized at will.

## Install via composer

Edit your composer.json file to include the following:

```
    {
       "require": {
           "verot/class.upload.php": "*"
       }
    }

```

Or install it directly:

```
    composer require verot/class.upload.php

```

## Demo and examples

Check out the `test/` directory, which you can load in your browser. You can test the class and its different ways to instantiate it, see some code examples, and run some tests.

## How to use it?

Create a simple HTML file, with a form such as:

```
<form enctype="multipart/form-data" method="post" action="upload.php">
  <input type="file" size="32" name="image_field" value="">
  <input type="submit" name="Submit" value="upload">
</form>
```

Create a file called upload.php (into which you have first loaded the class):

```
$handle = new \Verot\Upload\Upload($_FILES['image_field']);
if ($handle->uploaded) {
  $handle->file_new_name_body   = 'image_resized';
  $handle->image_resize         = true;
  $handle->image_x              = 100;
  $handle->image_ratio_y        = true;
  $handle->process('/home/user/files/');
  if ($handle->processed) {
    echo 'image resized';
    $handle->clean();
  } else {
    echo 'error : ' . $handle->error;
  }
}
```

### How does it work?

You instanciate the class with the `$_FILES['my_field']` array where *my\_field* is the field name from your upload form. The class will check if the original file has been uploaded to its temporary location (alternatively, you can instanciate the class with a local filename).

You can then set a number of processing variables to act on the file. For instance, you can rename the file, and if it is an image, convert and resize it in many ways. You can also set what will the class do if the file already exists.

Then you call the function `process()` to actually perform the actions according to the processing parameters you set above. It will create new instances of the original file, so the original file remains the same between each process. The file will be manipulated, and copied to the given location. The processing variables will be reset once it is done.

You can repeat setting up a new set of processing variables, and calling `process()` again as many times as you want. When you have finished, you can call `clean()` to delete the original uploaded file.

If you don't set any processing parameters and call `process()` just after instanciating the class. The uploaded file will be simply copied to the given location without any alteration or checks.

Don't forget to add `enctype="multipart/form-data"` in your form tag `<form>` if you want your form to upload the file.

### Namespacing

The class is now namespaced in the `Verot/Upload` namespace. If you have the error *Fatal error: Class 'Upload' not found*, then `use` the class fully qualified name, or instantiate the class with its fully qualified name:

```
use Verot\Upload\Upload;
$handle = new Upload($_FILES['image_field']);
```

or

```
$handle = new \Verot\Upload\Upload($_FILES['image_field']);
```

### How to process local files?

Instantiate the class with the local filename, as following:

```
$handle = new Upload('/home/user/myfile.jpg');
```

### How to process a file uploaded via XMLHttpRequest?

Instantiate the class with the special *php:* keyword, as following:

```
$handle = new Upload('php:'.$_SERVER['HTTP_X_FILE_NAME']);
```

Prefixing the argument with *php:* tells the class to retrieve the uploaded data in *php://input*, and the rest is the stream's filename, which is generally in `$_SERVER['HTTP_X_FILE_NAME']`. But you can use any other name you see fit:

```
$handle = new Upload('php:mycustomname.ext');
```

### How to process raw file data?

Instantiate the class with the special *data:* keyword, as following:

```
$handle = new Upload('data:'.$file_contents);
```

If your data is base64-encoded, the class provides a simple *base64:* keyword, which will decode your data prior to using it:

```
$handle = new Upload('base64:'.$base64_file_contents);
```

### How to set the language?

Instantiate the class with a second argument being the language code:

```
$handle = new Upload($_FILES['image_field'], 'fr_FR');
$handle = new Upload('/home/user/myfile.jpg', 'fr_FR');
```

### How to output the resulting file or picture directly to the browser?

Simply call `process()` without an argument (or with null as first argument):

```
$handle = new Upload($_FILES['image_field']);
header('Content-type: ' . $handle->file_src_mime);
echo $handle->process();
die();
```

Or if you want to force the download of the file:

```
$handle = new Upload($_FILES['image_field']);
header('Content-type: ' . $handle->file_src_mime);
header("Content-Disposition: attachment; filename=".rawurlencode($handle->file_src_name).";");
echo $handle->process();
die();
```

### Warning about security

By default, the class relies on MIME type detection to assess whether the file can be uploaded or not. Several MIME type detection methods are used, depending on the server configuration. The class relies on a blacklist of dangerous file extensions to prevent uploads (or to rename dangerous scripts as text files), as well as a whitelist of accepted MIME types.

But it is not the purpose of this class to do in-depth checking and heuristics to attempt to detect maliciously crafted files. For instance, an attacker can craft a file that will have the correct MIME type, but will carry a malicious payload, such as a valid GIF file which would contain some code leading to a XSS vulnerability. If this GIF file has a .html extension, it may be uploaded (depending on the class's settings) and display an XSS vulnerability.

However, you can mitigate this by restricting the kind of files that can be uploaded, using `allowed` and `forbidden`, to whitelist and blacklist files depending on their MIME type or extension. *The most secure option would be to only whitelist extensions that you want to allow through, and then making sure that your server always serves the file with the content-type based on the file extension.*

For instance, if you only want to allow one type of file, you could whitelist only its file extension. In the following example, only .html files are let through, and are not converted to a text file:

```
$handle->allowed   = array('html');
$handle->forbidden = array();
$handle->no_script = false;
```

In the end, it is your responsibility to make sure the correct files are uploaded. But more importantly, it is your responsibility to serve the uploaded files correctly, for instance by forcing the server to always provide the content-type based on the file extension.

### Troubleshooting

If the class doesn't do what you want it to do, you can display the log, in order to see in details what the class does. To obtain the log, just add this line at the end of your code:

```
echo $handle->log;
```

Your problem may have been already discussed in the Frequently Asked Questions : <http://www.verot.net/php_class_upload_faq.htm>

Failing that, you can search in the forums, and ask a question there: <http://www.verot.net/php_class_upload_forum.htm>. Please don't use Github issues to ask for help.

## Processing parameters

> Note: all the parameters in this section are reset after each process.

### File handling

* **file\_new\_name\_body** replaces the name body (default: null)

```
$handle->file_new_name_body = 'new name';
```

* **file\_name\_body\_add** appends to the name body (default: null)

```
$handle->file_name_body_add = '_uploaded';
```

* **file\_name\_body\_pre** prepends to the name body (default: null)

```
$handle->file_name_body_pre = 'thumb_';
```

* **file\_new\_name\_ext** replaces the file extension (default: null)

```
$handle->file_new_name_ext = 'txt';
```

* **file\_safe\_name** formats the filename (spaces changed to \_, etc...) (default: true)

```
$handle->file_safe_name = true;
```

* **file\_force\_extension** forces an extension if there isn't any (default: true)

```
$handle->file_force_extension = true;
```

* **file\_overwrite** sets behaviour if file already exists (default: false)

```
$handle->file_overwrite = true;
```

* **file\_auto\_rename** automatically renames file if it already exists (default: true)

```
$handle->file_auto_rename = true;
```

* **dir\_auto\_create** automatically creates destination directory if missing (default: true)

```
$handle->dir_auto_create = true;
```

* **dir\_auto\_chmod** automatically attempts to chmod the destination directory if not writeable (default: true)

```
$handle->dir_auto_chmod = true;
```

* **dir\_chmod** chmod used when creating directory or if directory not writeable (default: 0777)

```
$handle->dir_chmod = 0777;
```

* **file\_max\_size** sets maximum upload size (default: *upload\_max\_filesize* from php.ini)

```
$handle->file_max_size = '1024'; // 1KB
```

* **mime\_check** sets if the class check the MIME against the `allowed` list (default: true)

```
$handle->mime_check = true;
```

* **no\_script** sets if the class turns dangerous scripts into text files (default: true)

```
$handle->no_script = false;
```

* **allowed** array of allowed mime-types or file extensions (or one string). wildcard accepted, as in *image/\** (default: check `init()`)

```
$handle->allowed = array('application/pdf','application/msword', 'image/*');
```

* **forbidden** array of forbidden mime-types or file extensions (or one string). wildcard accepted, as in *image/\** (default: check `init()`)

```
$handle->forbidden = array('application/*');
```

### Image handling

* **image\_convert** if set, image will be converted (possible values : ''|'png'|'webp'|'jpeg'|'gif'|'bmp'; default: '')

```
$handle->image_convert = 'jpg';
```

* **image\_background\_color** if set, will forcibly fill transparent areas with the color, in hexadecimal (default: null)

```
$handle->image_background_color = '#FF00FF';
```

* **image\_default\_color** fallback color background color for non alpha-transparent output formats, such as JPEG or BMP, in hexadecimal (default: #FFFFFF)

```
$handle->image_default_color = '#FF00FF';
```

* **png\_compression** sets the compression level for PNG images, between 1 (fast but large files) and 9 (slow but smaller files) (default: null (Zlib default))

```
$handle->png_compression = 9;
```

* **webp\_quality** sets the compression quality for WEBP images (default: 85)

```
$handle->webp_quality = 50;
```

* **jpeg\_quality** sets the compression quality for JPEG images (default: 85)

```
$handle->jpeg_quality = 50;
```

* **jpeg\_size** if set to a size in bytes, will approximate `jpeg_quality` so the output image fits within the size (default: null)

```
$handle->jpeg_size = 3072;
```

* **image\_interlace** if set to true, the image will be saved interlaced (if it is a JPEG, it will be saved as a progressive PEG) (default: false)

```
$handle->image_interlace = true;
```

### Image checking

The following eight settings can be used to invalidate an upload if the file is an image (note that *open\_basedir* restrictions prevent the use of these settings)

* **image\_max\_width** if set to a dimension in pixels, the upload will be invalid if the image width is greater (default: null)

```
$handle->image_max_width = 200;
```

* **image\_max\_height** if set to a dimension in pixels, the upload will be invalid if the image height is greater (default: null)

```
$handle->image_max_height = 100;
```

* **image\_max\_pixels** if set to a number of pixels, the upload will be invalid if the image number of pixels is greater (default: null)

```
$handle->image_max_pixels = 50000;
```

* **image\_max\_ratio** if set to a aspect ratio (width/height), the upload will be invalid if the image apect ratio is greater (default: null)

```
$handle->image_max_ratio = 1.5;
```

* **image\_min\_width** if set to a dimension in pixels, the upload will be invalid if the image width is lower (default: null)

```
$handle->image_min_width = 100;
```

* **image\_min\_height** if set to a dimension in pixels, the upload will be invalid if the image height is lower (default: null)

```
$handle->image_min_height = 500;
```

* **image\_min\_pixels** if set to a number of pixels, the upload will be invalid if the image number of pixels is lower (default: null)

```
$handle->image_min_pixels = 20000;
```

* **image\_min\_ratio** if set to a aspect ratio (width/height), the upload will be invalid if the image apect ratio is lower (default: null)

```
$handle->image_min_ratio = 0.5;
```

### Image resizing

* **image\_resize** determines is an image will be resized (default: false)

```
$handle->image_resize = true;
```

The following variables are used only if *image\_resize* == true

* **image\_x** destination image width (default: 150)

```
$handle->image_x = 100;
```

* **image\_y** destination image height (default: 150)

```
$handle->image_y = 200;
```

Use either one of the following

* **image\_ratio** if true, resize image conserving the original sizes ratio, using `image_x` **AND** `image_y` as max sizes if true (default: false)

```
$handle->image_ratio = true;
```

* **image\_ratio\_crop** if true, resize image conserving the original sizes ratio, using `image_x` AND `image_y` as max sizes, and cropping excedent to fill the space. setting can also be a string, with one or more from 'TBLR', indicating which side of the image will be kept while cropping (default: false)

```
$handle->image_ratio_crop = true;
```

* **image\_ratio\_fill** if true, resize image conserving the original sizes ratio, using `image_x` AND `image_y` as max sizes, fitting the image in the space and coloring the remaining space. setting can also be a string, with one or more from 'TBLR', indicating which side of the space the image will be in (default: false)

```
$handle->image_ratio_fill = true;
```

* **image\_ratio\_x** if true, resize image, calculating `image_x` from `image_y` and conserving the original sizes ratio (default: false)

```
$handle->image_ratio_x = true;
```

* **image\_ratio\_y** if true, resize image, calculating `image_y` from `image_x` and conserving the original sizes ratio (default: false)

```
$handle->image_ratio_y = true;
```

* **image\_ratio\_pixels** if set to a long integer, resize image, calculating `image_y` and `image_x` to match a the number of pixels (default: false)

```
$handle->image_ratio_pixels = 25000;
```

And eventually prevent enlarging or shrinking images

* **image\_no\_enlarging** cancel resizing if the resized image is bigger than the original image, to prevent enlarging (default: false)

```
$handle->image_no_enlarging = true;
```

* **image\_no\_shrinking** cancel resizing if the resized image is smaller than the original image, to prevent shrinking (default: false)

```
$handle->image_no_shrinking = true;
```

### Image effects

The following image manipulations require GD2+

* **image\_brightness** if set, corrects the brightness. value between -127 and 127 (default: null)

```
$handle->image_brightness = 40;
```

* **image\_contrast** if set, corrects the contrast. value between -127 and 127 (default: null)

```
$handle->image_contrast = 50;
```

* **image\_opacity** if set, changes the image opacity. value between 0 and 100 (default: null)

```
$handle->image_opacity = 50;
```

* **image\_tint\_color** if set, will tint the image with a color, value as hexadecimal #FFFFFF (default: null)

```
$handle->image_tint_color = '#FF0000';
```

* **image\_overlay\_color** if set, will add a colored overlay, value as hexadecimal #FFFFFF (default: null)

```
$handle->image_overlay_color = '#FF0000';
```

* **image\_overlay\_opacity** used when `image_overlay_color` is set, determines the opacity (default: 50)

```
$handle->image_overlay_opacity = 20;
```

* **image\_negative** inverts the colors in the image (default: false)

```
$handle->image_negative = true;
```

* **image\_greyscale** transforms an image into greyscale (default: false)

```
$handle->image_greyscale = true;
```

* **image\_threshold** applies a threshold filter. value between -127 and 127 (default: null)

```
$handle->image_threshold = 20;
```

* **image\_pixelate** pixelate an image, value is block size (default: null)

```
$handle->image_pixelate = 10;
```

* **image\_unsharp** applies an unsharp mask, with alpha transparency support (default: false)

```
$handle->image_unsharp = true;
```

* **image\_unsharp\_amount** unsharp mask amount, typically 50 - 200 (default: 80)

```
$handle->image_unsharp_amount = 120;
```

* **image\_unsharp\_radius** unsharp mask radius, typically 0.5 - 1 (default: 0.5)

```
$handle->image_unsharp_radius = 1;
```

* **image\_unsharp\_threshold** unsharp mask threshold, typically 0 - 5 (default: 1)

```
$handle->image_unsharp_threshold = 0;
```

### Image text

* **image\_text** creates a text label on the image, value is a string, with eventual replacement tokens (default: null)

```
$handle->image_text = 'test';
```

* **image\_text\_direction** text label direction, either 'h' horizontal or 'v' vertical (default: 'h')

```
$handle->image_text_direction = 'v';
```

* **image\_text\_color** text color for the text label, in hexadecimal (default: #FFFFFF)

```
$handle->image_text_color = '#FF0000';
```

* **image\_text\_opacity** text opacity on the text label, integer between 0 and 100 (default: 100)

```
$handle->image_text_opacity = 50;
```

* **image\_text\_background** text label background color, in hexadecimal (default: null)

```
$handle->image_text_background = '#FFFFFF';
```

* **image\_text\_background\_opacity** text label background opacity, integer between 0 and 100 (default: 100)

```
$handle->image_text_background_opacity = 50;
```

* **image\_text\_font** built-in font for the text label, from 1 to 5. 1 is the smallest (default: 5). Value can also be a string, which represents the path to a GDF or TTF font (TrueType).

```
$handle->image_text_font = 4; // or './font.gdf' or './font.ttf'
```

* **image\_text\_size** font size for TrueType fonts, in pixels (GD1) or points (GD1) (default: 16) (TrueType fonts only)

```
$handle->image_text_size = 24;
```

* **image\_text\_angle** text angle for TrueType fonts, in degrees, with 0 degrees being left-to-right reading text(default: null) (TrueType fonts only)

```
$handle->image_text_angle = 45;
```

* **image\_text\_x** absolute text label position, in pixels from the left border. can be negative (default: null)

```
$handle->image_text_x = 5;
```

* **image\_text\_y** absolute text label position, in pixels from the top border. can be negative (default: null)

```
$handle->image_text_y = 5;
```

* **image\_text\_position** text label position withing the image, a combination of one or two from 'TBLR': top, bottom, left, right (default: null)

```
$handle->image_text_position = 'LR';
```

* **image\_text\_padding** text label padding, in pixels. can be overridden by `image_text_padding_x` and `image_text_padding_y` (default: 0)

```
$handle->image_text_padding = 5;
```

* **image\_text\_padding\_x** text label horizontal padding (default: null)

```
$handle->image_text_padding_x = 2;
```

* **image\_text\_padding\_y** text label vertical padding (default: null)

```
$handle->image_text_padding_y = 10;
```

* **image\_text\_alignment** text alignment when text has multiple lines, either 'L', 'C' or 'R' (default: 'C') (GD fonts only)

```
$handle->image_text_alignment = 'R';
```

* **image\_text\_line\_spacing** space between lines in pixels, when text has multiple lines (default: 0) (GD fonts only)

```
$handle->image_text_line_spacing = 3;
```

### Image transformations

* **image\_auto\_rotate** automatically rotates the image according to EXIF data (JPEG only) (default: true, applies even if there is no image manipulations)

```
$handle->image_auto_rotate = false;
```

* **image\_flip** flips image, wither 'h' horizontal or 'v' vertical (default: null)

```
$handle->image_flip = 'h';
```

* **image\_rotate** rotates image. Possible values are 90, 180 and 270 (default: null)

```
$handle->image_rotate = 90;
```

* **image\_crop** crops image. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_crop = array(50,40,30,20); OR '-20 20%'...
```

* **image\_precrop** crops image, before an eventual resizing. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_precrop = array(50,40,30,20); OR '-20 20%'...
```

### Image borders

* **image\_bevel** adds a bevel border to the image. value is thickness in pixels (default: null)

```
$handle->image_bevel = 20;
```

* **image\_bevel\_color1** top and left bevel color, in hexadecimal (default: #FFFFFF)

```
$handle->image_bevel_color1 = '#FFFFFF';
```

* **image\_bevel\_color2** bottom and right bevel color, in hexadecimal (default: #000000)

```
$handle->image_bevel_color2 = '#000000';
```

* **image\_border** adds a unicolor border to the image. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_border = '3px'; OR '-20 20%' OR array(3,2)...
```

* **image\_border\_color** border color, in hexadecimal (default: #FFFFFF)

```
$handle->image_border_color = '#FFFFFF';
```

* **image\_border\_opacity** border opacity, integer between 0 and 100 (default: 100)

```
$handle->image_border_opacity = 50;
```

* **image\_border\_transparent** adds a fading-to-transparent border to the image. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_border_transparent = '3px'; OR '-20 20%' OR array(3,2)...
```

* **image\_frame** type of frame: 1=flat 2=crossed (default: null)

```
$handle->image_frame = 2;
```

* **image\_frame\_colors** list of hex colors, in an array or a space separated string (default: '#FFFFFF #999999 #666666 #000000')

```
$handle->image_frame_colors = array('#999999',  '#FF0000', '#666666', '#333333', '#000000');
```

* **image\_frame\_opacity** frame opacity, integer between 0 and 100 (default: 100)

```
$handle->image_frame_opacity = 50;
```

### Image watermark

* **image\_watermark** adds a watermark on the image, value is a local filename. accepted files are GIF, JPG, BMP, WEBP, PNG and PNG alpha (default: null)

```
$handle->image_watermark = 'watermark.png';
```

* **image\_watermark\_x** absolute watermark position, in pixels from the left border. can be negative (default: null)

```
$handle->image_watermark_x = 5;
```

* **image\_watermark\_y** absolute watermark position, in pixels from the top border. can be negative (default: null)

```
$handle->image_watermark_y = 5;
```

* **image\_watermark\_position** watermark position withing the image, a combination of one or two from 'TBLR': top, bottom, left, right (default: null)

```
$handle->image_watermark_position = 'LR';
```

* **image\_watermark\_no\_zoom\_in** prevents the watermark to be resized up if it is smaller than the image (default: true)

```
$handle->image_watermark_no_zoom_in = false;
```

* **image\_watermark\_no\_zoom\_out** prevents the watermark to be resized down if it is bigger than the image (default: false)

```
$handle->image_watermark_no_zoom_out = true;
```

### Image reflections

* **image\_reflection\_height** if set, a reflection will be added. Format is either in pixels or percentage, such as 40, '40', '40px' or '40%' (default: null)

```
$handle->image_reflection_height = '25%';
```

* **image\_reflection\_space** space in pixels between the source image and the reflection, can be negative (default: null)

```
$handle->image_reflection_space = 3;
```

* **image\_reflection\_color** reflection background color, in hexadecimal. Now deprecated in favor of `image_default_color` (default: #FFFFFF)

```
$handle->image_default_color = '#000000';
```

* **image\_reflection\_opacity** opacity level at which the reflection starts, integer between 0 and 100 (default: 60)

```
$handle->image_reflection_opacity = 60;
```

## Values that can be read before calling `process()`

* **file\_src\_name** Source file name
* **file\_src\_name\_body** Source file name body
* **file\_src\_name\_ext** Source file extension
* **file\_src\_pathname** Source file complete path and name
* **file\_src\_mime** Source file mime type
* **file\_src\_size** Source file size in bytes
* **file\_src\_error** Upload error code
* **file\_is\_image** Boolean flag, true if the file is a supported image type

If the file is a supported image type (and *open\_basedir* restrictions allow it)

* **image\_src\_x** Source file width in pixels
* **image\_src\_y** Source file height in pixels
* **image\_src\_pixels** Source file number of pixels
* **image\_src\_type** Source file type (png, webp, jpg, gif or bmp)
* **image\_src\_bits** Source file color depth

## Values that can be read after calling `process()`

* **file\_dst\_path** Destination file path
* **file\_dst\_name\_body** Destination file name body
* **file\_dst\_name\_ext** Destination file extension
* **file\_dst\_name** Destination file name
* **file\_dst\_pathname** Destination file complete path and name

If the file is a supported image type

* **image\_dst\_type** Destination file type (png, webp, jpg, gif or bmp)
* **image\_dst\_x** Destination file width
* **image\_dst\_y** Destination file height

## Requirements

Most of the image operations require GD. GD2 is greatly recommended

Version 1.x supports PHP 4, 5 and 7, but is not namespaced. Use it if you need support for PHP <5.3

Version 2.x supports PHP 5.3+, PHP 7 and PHP 8.

## About

This PHP class uploads files and manipulates images very easily. It is in fact as much as an image processing class than it is an upload class. Compatible with PHP 4, 5, 7 and 8. Supports processing of local files, uploaded files, files sent through XMLHttpRequest.

[www.verot.net/php\_class\_upload.htm](http://www.verot.net/php_class_upload.htm "http://www.verot.net/php_class_upload.htm")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-2.0 license](#GPL-2.0-1-ov-file)

[Activity](/verot/class.upload.php/activity)
### Stars

[**882**
stars](/verot/class.upload.php/stargazers)
### Watchers

[**80**
watching](/verot/class.upload.php/watchers)
### Forks

[**359**
forks](/verot/class.upload.php/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fverot%2Fclass.upload.php&report=verot+%28user%29)

## [Releases](/verot/class.upload.php/releases)

[30
tags](/verot/class.upload.php/tags)

## [Packages 0](/users/verot/packages?repo_name=class.upload.php)

No packages published

## [Contributors 11](/verot/class.upload.php/graphs/contributors)

* [![@verot](https://avatars.githubusercontent.com/u/4622582?s=64&v=4)](https://github.com/verot)
* [![@peterdd](https://avatars.githubusercontent.com/u/1839154?s=64&v=4)](https://github.com/peterdd)
* [![@Mad182](https://avatars.githubusercontent.com/u/798148?s=64&v=4)](https://github.com/Mad182)
* [![@Seb33300](https://avatars.githubusercontent.com/u/915273?s=64&v=4)](https://github.com/Seb33300)
* [![@EOM](https://avatars.githubusercontent.com/u/1219132?s=64&v=4)](https://github.com/EOM)
* [![@fevangelou](https://avatars.githubusercontent.com/u/1301787?s=64&v=4)](https://github.com/fevangelou)
* [![@lukacat10](https://avatars.githubusercontent.com/u/1473979?s=64&v=4)](https://github.com/lukacat10)
* [![@cyberwani](https://avatars.githubusercontent.com/u/1647283?s=64&v=4)](https://github.com/cyberwani)
* [![@halillusion](https://avatars.githubusercontent.com/u/15546477?s=64&v=4)](https://github.com/halillusion)
* [![@emretulek](https://avatars.githubusercontent.com/u/43541275?s=64&v=4)](https://github.com/emretulek)
* [![@CodeLingoBot](https://avatars.githubusercontent.com/u/45469328?s=64&v=4)](https://github.com/CodeLingoBot)

## Languages

* [PHP
  98.4%](/verot/class.upload.php/search?l=php)
* [HTML
  1.6%](/verot/class.upload.php/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cert.pl_1947879f_20250115_092317.html ===


[ZgÅoÅ incydent](https://incydent.cert.pl/)

Cofnij

* JesteÅ w nawigacji
* O nas
  + O nas
  + [O zespole](../../../../o-nas/)
  + [Praca](/praca)
  + [Kontakt](../../../../kontakt/)
* [AktualnoÅci](../../../../news/)
* Baza wiedzy
  + Baza wiedzy
  + [FaÅszywe inwestycje](/falszywe-inwestycje)
  + [UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
  + [(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
  + [FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
  + [Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
  + [FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
  + [FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
  + [FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)
  + Biuletyn OUCH!
  + [Porady bezpieczeÅstwa OUCH!](/ouch)
* Dla ekspertÃ³w
  + Dla ekspertÃ³w
  + [AktualnoÅci](../../../../news/)
  + [Publikacje](../../../../publikacje/)
  + [Lista OstrzeÅ¼eÅ](../../../../lista-ostrzezen/)
  + [Kompendium o hasÅach](/hasla/)
  + Projekty
  + [n6](../../../../n6/)
  + [Artemis](/skanowanie/)
  + [MWDB](https://mwdb.cert.pl/)
  + Program CVD
  + [Polityka CVD](../../../../cvd)
  + [Lista podatnoÅci](../../../../cve)

* O nas
* [AktualnoÅci](../../../../news/)
* Baza wiedzy
* Dla ekspertÃ³w

[ZgÅoÅ incydent](https://incydent.cert.pl/)

O nas
[O zespole](../../../../o-nas/)
[Praca](/praca)
[Kontakt](../../../../kontakt/)

Baza wiedzy
[FaÅszywe inwestycje](/falszywe-inwestycje)
[UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
[FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
[FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
[FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÅstwa OUCH!](/ouch)

Dla ekspertÃ³w
[Publikacje](../../../../publikacje/)
[Lista OstrzeÅ¼eÅ](../../../../lista-ostrzezen/)
[Kompendium o hasÅach](/hasla/)

Projekty
[n6](../../../../n6/)
[Artemis](/skanowanie/)
[MWDB](https://mwdb.cert.pl/)

Program CVD
[Polityka CVD](../../../../cvd)
[Lista podatnoÅci](../../../../cve)

PodatnoÅÄ w bibliotece class.upload.php

04 stycznia 2024
| [CERT Polska](../../../../author/cert-polska/) | [#podatnoÅÄ](../../../../tag/podatnosc/), [#ostrzeÅ¼enie](../../../../tag/ostrzezenie/), [#cve](../../../../tag/cve/)

| **CVE ID** | [CVE-2023-6551](https://www.cve.org/CVERecord?id=CVE-2023-6551) |
| --- | --- |
| **Data publikacji** | 04 stycznia 2024 |
| **Producent podatnego oprogramowania** | Colin Verot |
| **Nazwa podatnego oprogramowania** | class.upload.php |
| **Podatne wersje** | Wszystkie |
| **Typ podatnoÅci (CWE)** | Unrestricted Upload of File with Dangerous Type ([CWE-434](https://cwe.mitre.org/data/definitions/434.html)) |
| **Å¹rÃ³dÅo zgÅoszenia** | Badania wÅasne |

## Opis podatnoÅci

CERT Polska w ramach badaÅ wÅasnych znalazÅ w otwartoÅºrÃ³dÅowej bibliotece [class.upload.php](https://github.com/verot/class.upload.php) podatnoÅÄ typu Stored XSS, ktÃ³rej nadano identyfikator [CVE-2023-6551](https://www.cve.org/CVERecord?id=CVE-2023-6551). ZwiÄzana jest ona z nieprawidÅowÄ walidacjÄ przesyÅanych danych.

WedÅug deklaracji autora podatnoÅÄ ta nie zostanie usuniÄta z biblioteki. Osoby korzystajÄce z niej muszÄ byÄ Åwiadomi zagroÅ¼eÅ z tego wynikajÄcych i odpowiednio zabezpieczyÄ swojÄ aplikacjÄ poprzez korzystanie z whitelisty rozszerzeÅ plikÃ³w, ktÃ³re moÅ¼na wysyÅaÄ z uÅ¼yciem tej biblioteki, jak rÃ³wnieÅ¼ konfigurujÄc serwer tak, aby zawsze zwracaÅ on rodzaj pliku na podstawie rozszerzenia. Wymienione wyÅ¼ej zalecenie dodane zostaÅy do pliku README projektu.

---

WiÄcej o procesie zgÅaszania podatnoÅci moÅ¼na przeczytaÄ na stronie <https://cert.pl/cvd/>.

CERT Polska to zespÃ³Å dziaÅajÄcy w strukturach NASK - PaÅstwowego Instytutu Badawczego,
powoÅany w 1996 roku do reagowania na incydenty bezpieczeÅstwa komputerowego. Realizuje
zadania CSIRT NASK, jednego z trzech takich zespoÅÃ³w dziaÅajÄcych na poziomie
krajowym w ramach krajowego systemu cyberbezpieczeÅstwa.

# CERT Polska w social mediach

[![](/theme/assets/img/img.gif)Facebook](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Kontakt

ul. Kolska 12, 01-045 Warszawa

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÄczenia: AE:PL-60057-61611-BCEGR-11

e-mail: [[email protected]](/cdn-cgi/l/email-protection#84edeae2ebc4e7e1f6f0aaf4e8)

ZgÅaszanie incydentÃ³w: [incydent.cert.pl](https://incydent.cert.pl/)

[[email protected]](/cdn-cgi/l/email-protection#325157404672515740461c425e)

![WspÃ³Åfinansowane przez instrument Unii Europejskiej ÅÄczÄc EuropÄ](/theme/assets/img/ue.png)

* Â© 2025 [NASK](https://nask.pl/)
* [Polityka prywatnoÅci](/uploads/misc/privacy-policy.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)



=== Content from github.com_1ac3531c_20250115_222432.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fverot%2Fclass.upload.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fverot%2Fclass.upload.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=verot%2Fclass.upload.php)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[verot](/verot)
/
**[class.upload.php](/verot/class.upload.php)**
Public

* [Notifications](/login?return_to=%2Fverot%2Fclass.upload.php) You must be signed in to change notification settings
* [Fork
  359](/login?return_to=%2Fverot%2Fclass.upload.php)
* [Star
   882](/login?return_to=%2Fverot%2Fclass.upload.php)

This PHP class uploads files and manipulates images very easily. It is in fact as much as an image processing class than it is an upload class. Compatible with PHP 4, 5, 7 and 8. Supports processing of local files, uploaded files, files sent through XMLHttpRequest.

[www.verot.net/php\_class\_upload.htm](http://www.verot.net/php_class_upload.htm "http://www.verot.net/php_class_upload.htm")

### License

[GPL-2.0 license](/verot/class.upload.php/blob/master/LICENSE.txt)

[882
stars](/verot/class.upload.php/stargazers) [359
forks](/verot/class.upload.php/forks) [Branches](/verot/class.upload.php/branches) [Tags](/verot/class.upload.php/tags) [Activity](/verot/class.upload.php/activity)
 [Star](/login?return_to=%2Fverot%2Fclass.upload.php)

 [Notifications](/login?return_to=%2Fverot%2Fclass.upload.php) You must be signed in to change notification settings

* [Code](/verot/class.upload.php)
* [Issues
  4](/verot/class.upload.php/issues)
* [Pull requests
  0](/verot/class.upload.php/pulls)
* [Actions](/verot/class.upload.php/actions)
* [Security](/verot/class.upload.php/security)
* [Insights](/verot/class.upload.php/pulse)

Additional navigation options

* [Code](/verot/class.upload.php)
* [Issues](/verot/class.upload.php/issues)
* [Pull requests](/verot/class.upload.php/pulls)
* [Actions](/verot/class.upload.php/actions)
* [Security](/verot/class.upload.php/security)
* [Insights](/verot/class.upload.php/pulse)

# verot/class.upload.php

    master[Branches](/verot/class.upload.php/branches)[Tags](/verot/class.upload.php/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[112 Commits](/verot/class.upload.php/commits/master/) | | |
| [src](/verot/class.upload.php/tree/master/src "src") | | [src](/verot/class.upload.php/tree/master/src "src") |  |  |
| [test](/verot/class.upload.php/tree/master/test "test") | | [test](/verot/class.upload.php/tree/master/test "test") |  |  |
| [.gitignore](/verot/class.upload.php/blob/master/.gitignore ".gitignore") | | [.gitignore](/verot/class.upload.php/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE.txt](/verot/class.upload.php/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/verot/class.upload.php/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/verot/class.upload.php/blob/master/README.md "README.md") | | [README.md](/verot/class.upload.php/blob/master/README.md "README.md") |  |  |
| [composer.json](/verot/class.upload.php/blob/master/composer.json "composer.json") | | [composer.json](/verot/class.upload.php/blob/master/composer.json "composer.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-2.0 license
# class.upload.php

Homepage : <http://www.verot.net/php_class_upload.htm>

Demo : <http://www.verot.net/php_class_upload_samples.htm>

Donations: <http://www.verot.net/php_class_upload_donate.htm>

Commercial use: <http://www.verot.net/php_class_upload_license.htm>

## What does it do?

This class manages file uploads for you. In short, it manages the uploaded file, and allows you to do whatever you want with the file, especially if it is an image, and as many times as you want.

It is the ideal class to quickly integrate file upload in your site. If the file is an image, you can convert, resize, crop it in many ways. You can also apply filters, add borders, text, watermarks, etc... That's all you need for a gallery script for instance. Supported formats are PNG, JPG, GIF, WEBP and BMP.

You can also use the class to work on local files, which is especially useful to use the image manipulation features. The class also supports Flash uploaders and XMLHttpRequest.

The class works with PHP 5.3+, PHP 7 and PHP 8 (use version 1.x for PHP 4 support), and its error messages can be localized at will.

## Install via composer

Edit your composer.json file to include the following:

```
    {
       "require": {
           "verot/class.upload.php": "*"
       }
    }

```

Or install it directly:

```
    composer require verot/class.upload.php

```

## Demo and examples

Check out the `test/` directory, which you can load in your browser. You can test the class and its different ways to instantiate it, see some code examples, and run some tests.

## How to use it?

Create a simple HTML file, with a form such as:

```
<form enctype="multipart/form-data" method="post" action="upload.php">
  <input type="file" size="32" name="image_field" value="">
  <input type="submit" name="Submit" value="upload">
</form>
```

Create a file called upload.php (into which you have first loaded the class):

```
$handle = new \Verot\Upload\Upload($_FILES['image_field']);
if ($handle->uploaded) {
  $handle->file_new_name_body   = 'image_resized';
  $handle->image_resize         = true;
  $handle->image_x              = 100;
  $handle->image_ratio_y        = true;
  $handle->process('/home/user/files/');
  if ($handle->processed) {
    echo 'image resized';
    $handle->clean();
  } else {
    echo 'error : ' . $handle->error;
  }
}
```

### How does it work?

You instanciate the class with the `$_FILES['my_field']` array where *my\_field* is the field name from your upload form. The class will check if the original file has been uploaded to its temporary location (alternatively, you can instanciate the class with a local filename).

You can then set a number of processing variables to act on the file. For instance, you can rename the file, and if it is an image, convert and resize it in many ways. You can also set what will the class do if the file already exists.

Then you call the function `process()` to actually perform the actions according to the processing parameters you set above. It will create new instances of the original file, so the original file remains the same between each process. The file will be manipulated, and copied to the given location. The processing variables will be reset once it is done.

You can repeat setting up a new set of processing variables, and calling `process()` again as many times as you want. When you have finished, you can call `clean()` to delete the original uploaded file.

If you don't set any processing parameters and call `process()` just after instanciating the class. The uploaded file will be simply copied to the given location without any alteration or checks.

Don't forget to add `enctype="multipart/form-data"` in your form tag `<form>` if you want your form to upload the file.

### Namespacing

The class is now namespaced in the `Verot/Upload` namespace. If you have the error *Fatal error: Class 'Upload' not found*, then `use` the class fully qualified name, or instantiate the class with its fully qualified name:

```
use Verot\Upload\Upload;
$handle = new Upload($_FILES['image_field']);
```

or

```
$handle = new \Verot\Upload\Upload($_FILES['image_field']);
```

### How to process local files?

Instantiate the class with the local filename, as following:

```
$handle = new Upload('/home/user/myfile.jpg');
```

### How to process a file uploaded via XMLHttpRequest?

Instantiate the class with the special *php:* keyword, as following:

```
$handle = new Upload('php:'.$_SERVER['HTTP_X_FILE_NAME']);
```

Prefixing the argument with *php:* tells the class to retrieve the uploaded data in *php://input*, and the rest is the stream's filename, which is generally in `$_SERVER['HTTP_X_FILE_NAME']`. But you can use any other name you see fit:

```
$handle = new Upload('php:mycustomname.ext');
```

### How to process raw file data?

Instantiate the class with the special *data:* keyword, as following:

```
$handle = new Upload('data:'.$file_contents);
```

If your data is base64-encoded, the class provides a simple *base64:* keyword, which will decode your data prior to using it:

```
$handle = new Upload('base64:'.$base64_file_contents);
```

### How to set the language?

Instantiate the class with a second argument being the language code:

```
$handle = new Upload($_FILES['image_field'], 'fr_FR');
$handle = new Upload('/home/user/myfile.jpg', 'fr_FR');
```

### How to output the resulting file or picture directly to the browser?

Simply call `process()` without an argument (or with null as first argument):

```
$handle = new Upload($_FILES['image_field']);
header('Content-type: ' . $handle->file_src_mime);
echo $handle->process();
die();
```

Or if you want to force the download of the file:

```
$handle = new Upload($_FILES['image_field']);
header('Content-type: ' . $handle->file_src_mime);
header("Content-Disposition: attachment; filename=".rawurlencode($handle->file_src_name).";");
echo $handle->process();
die();
```

### Warning about security

By default, the class relies on MIME type detection to assess whether the file can be uploaded or not. Several MIME type detection methods are used, depending on the server configuration. The class relies on a blacklist of dangerous file extensions to prevent uploads (or to rename dangerous scripts as text files), as well as a whitelist of accepted MIME types.

But it is not the purpose of this class to do in-depth checking and heuristics to attempt to detect maliciously crafted files. For instance, an attacker can craft a file that will have the correct MIME type, but will carry a malicious payload, such as a valid GIF file which would contain some code leading to a XSS vulnerability. If this GIF file has a .html extension, it may be uploaded (depending on the class's settings) and display an XSS vulnerability.

However, you can mitigate this by restricting the kind of files that can be uploaded, using `allowed` and `forbidden`, to whitelist and blacklist files depending on their MIME type or extension. *The most secure option would be to only whitelist extensions that you want to allow through, and then making sure that your server always serves the file with the content-type based on the file extension.*

For instance, if you only want to allow one type of file, you could whitelist only its file extension. In the following example, only .html files are let through, and are not converted to a text file:

```
$handle->allowed   = array('html');
$handle->forbidden = array();
$handle->no_script = false;
```

In the end, it is your responsibility to make sure the correct files are uploaded. But more importantly, it is your responsibility to serve the uploaded files correctly, for instance by forcing the server to always provide the content-type based on the file extension.

### Troubleshooting

If the class doesn't do what you want it to do, you can display the log, in order to see in details what the class does. To obtain the log, just add this line at the end of your code:

```
echo $handle->log;
```

Your problem may have been already discussed in the Frequently Asked Questions : <http://www.verot.net/php_class_upload_faq.htm>

Failing that, you can search in the forums, and ask a question there: <http://www.verot.net/php_class_upload_forum.htm>. Please don't use Github issues to ask for help.

## Processing parameters

> Note: all the parameters in this section are reset after each process.

### File handling

* **file\_new\_name\_body** replaces the name body (default: null)

```
$handle->file_new_name_body = 'new name';
```

* **file\_name\_body\_add** appends to the name body (default: null)

```
$handle->file_name_body_add = '_uploaded';
```

* **file\_name\_body\_pre** prepends to the name body (default: null)

```
$handle->file_name_body_pre = 'thumb_';
```

* **file\_new\_name\_ext** replaces the file extension (default: null)

```
$handle->file_new_name_ext = 'txt';
```

* **file\_safe\_name** formats the filename (spaces changed to \_, etc...) (default: true)

```
$handle->file_safe_name = true;
```

* **file\_force\_extension** forces an extension if there isn't any (default: true)

```
$handle->file_force_extension = true;
```

* **file\_overwrite** sets behaviour if file already exists (default: false)

```
$handle->file_overwrite = true;
```

* **file\_auto\_rename** automatically renames file if it already exists (default: true)

```
$handle->file_auto_rename = true;
```

* **dir\_auto\_create** automatically creates destination directory if missing (default: true)

```
$handle->dir_auto_create = true;
```

* **dir\_auto\_chmod** automatically attempts to chmod the destination directory if not writeable (default: true)

```
$handle->dir_auto_chmod = true;
```

* **dir\_chmod** chmod used when creating directory or if directory not writeable (default: 0777)

```
$handle->dir_chmod = 0777;
```

* **file\_max\_size** sets maximum upload size (default: *upload\_max\_filesize* from php.ini)

```
$handle->file_max_size = '1024'; // 1KB
```

* **mime\_check** sets if the class check the MIME against the `allowed` list (default: true)

```
$handle->mime_check = true;
```

* **no\_script** sets if the class turns dangerous scripts into text files (default: true)

```
$handle->no_script = false;
```

* **allowed** array of allowed mime-types or file extensions (or one string). wildcard accepted, as in *image/\** (default: check `init()`)

```
$handle->allowed = array('application/pdf','application/msword', 'image/*');
```

* **forbidden** array of forbidden mime-types or file extensions (or one string). wildcard accepted, as in *image/\** (default: check `init()`)

```
$handle->forbidden = array('application/*');
```

### Image handling

* **image\_convert** if set, image will be converted (possible values : ''|'png'|'webp'|'jpeg'|'gif'|'bmp'; default: '')

```
$handle->image_convert = 'jpg';
```

* **image\_background\_color** if set, will forcibly fill transparent areas with the color, in hexadecimal (default: null)

```
$handle->image_background_color = '#FF00FF';
```

* **image\_default\_color** fallback color background color for non alpha-transparent output formats, such as JPEG or BMP, in hexadecimal (default: #FFFFFF)

```
$handle->image_default_color = '#FF00FF';
```

* **png\_compression** sets the compression level for PNG images, between 1 (fast but large files) and 9 (slow but smaller files) (default: null (Zlib default))

```
$handle->png_compression = 9;
```

* **webp\_quality** sets the compression quality for WEBP images (default: 85)

```
$handle->webp_quality = 50;
```

* **jpeg\_quality** sets the compression quality for JPEG images (default: 85)

```
$handle->jpeg_quality = 50;
```

* **jpeg\_size** if set to a size in bytes, will approximate `jpeg_quality` so the output image fits within the size (default: null)

```
$handle->jpeg_size = 3072;
```

* **image\_interlace** if set to true, the image will be saved interlaced (if it is a JPEG, it will be saved as a progressive PEG) (default: false)

```
$handle->image_interlace = true;
```

### Image checking

The following eight settings can be used to invalidate an upload if the file is an image (note that *open\_basedir* restrictions prevent the use of these settings)

* **image\_max\_width** if set to a dimension in pixels, the upload will be invalid if the image width is greater (default: null)

```
$handle->image_max_width = 200;
```

* **image\_max\_height** if set to a dimension in pixels, the upload will be invalid if the image height is greater (default: null)

```
$handle->image_max_height = 100;
```

* **image\_max\_pixels** if set to a number of pixels, the upload will be invalid if the image number of pixels is greater (default: null)

```
$handle->image_max_pixels = 50000;
```

* **image\_max\_ratio** if set to a aspect ratio (width/height), the upload will be invalid if the image apect ratio is greater (default: null)

```
$handle->image_max_ratio = 1.5;
```

* **image\_min\_width** if set to a dimension in pixels, the upload will be invalid if the image width is lower (default: null)

```
$handle->image_min_width = 100;
```

* **image\_min\_height** if set to a dimension in pixels, the upload will be invalid if the image height is lower (default: null)

```
$handle->image_min_height = 500;
```

* **image\_min\_pixels** if set to a number of pixels, the upload will be invalid if the image number of pixels is lower (default: null)

```
$handle->image_min_pixels = 20000;
```

* **image\_min\_ratio** if set to a aspect ratio (width/height), the upload will be invalid if the image apect ratio is lower (default: null)

```
$handle->image_min_ratio = 0.5;
```

### Image resizing

* **image\_resize** determines is an image will be resized (default: false)

```
$handle->image_resize = true;
```

The following variables are used only if *image\_resize* == true

* **image\_x** destination image width (default: 150)

```
$handle->image_x = 100;
```

* **image\_y** destination image height (default: 150)

```
$handle->image_y = 200;
```

Use either one of the following

* **image\_ratio** if true, resize image conserving the original sizes ratio, using `image_x` **AND** `image_y` as max sizes if true (default: false)

```
$handle->image_ratio = true;
```

* **image\_ratio\_crop** if true, resize image conserving the original sizes ratio, using `image_x` AND `image_y` as max sizes, and cropping excedent to fill the space. setting can also be a string, with one or more from 'TBLR', indicating which side of the image will be kept while cropping (default: false)

```
$handle->image_ratio_crop = true;
```

* **image\_ratio\_fill** if true, resize image conserving the original sizes ratio, using `image_x` AND `image_y` as max sizes, fitting the image in the space and coloring the remaining space. setting can also be a string, with one or more from 'TBLR', indicating which side of the space the image will be in (default: false)

```
$handle->image_ratio_fill = true;
```

* **image\_ratio\_x** if true, resize image, calculating `image_x` from `image_y` and conserving the original sizes ratio (default: false)

```
$handle->image_ratio_x = true;
```

* **image\_ratio\_y** if true, resize image, calculating `image_y` from `image_x` and conserving the original sizes ratio (default: false)

```
$handle->image_ratio_y = true;
```

* **image\_ratio\_pixels** if set to a long integer, resize image, calculating `image_y` and `image_x` to match a the number of pixels (default: false)

```
$handle->image_ratio_pixels = 25000;
```

And eventually prevent enlarging or shrinking images

* **image\_no\_enlarging** cancel resizing if the resized image is bigger than the original image, to prevent enlarging (default: false)

```
$handle->image_no_enlarging = true;
```

* **image\_no\_shrinking** cancel resizing if the resized image is smaller than the original image, to prevent shrinking (default: false)

```
$handle->image_no_shrinking = true;
```

### Image effects

The following image manipulations require GD2+

* **image\_brightness** if set, corrects the brightness. value between -127 and 127 (default: null)

```
$handle->image_brightness = 40;
```

* **image\_contrast** if set, corrects the contrast. value between -127 and 127 (default: null)

```
$handle->image_contrast = 50;
```

* **image\_opacity** if set, changes the image opacity. value between 0 and 100 (default: null)

```
$handle->image_opacity = 50;
```

* **image\_tint\_color** if set, will tint the image with a color, value as hexadecimal #FFFFFF (default: null)

```
$handle->image_tint_color = '#FF0000';
```

* **image\_overlay\_color** if set, will add a colored overlay, value as hexadecimal #FFFFFF (default: null)

```
$handle->image_overlay_color = '#FF0000';
```

* **image\_overlay\_opacity** used when `image_overlay_color` is set, determines the opacity (default: 50)

```
$handle->image_overlay_opacity = 20;
```

* **image\_negative** inverts the colors in the image (default: false)

```
$handle->image_negative = true;
```

* **image\_greyscale** transforms an image into greyscale (default: false)

```
$handle->image_greyscale = true;
```

* **image\_threshold** applies a threshold filter. value between -127 and 127 (default: null)

```
$handle->image_threshold = 20;
```

* **image\_pixelate** pixelate an image, value is block size (default: null)

```
$handle->image_pixelate = 10;
```

* **image\_unsharp** applies an unsharp mask, with alpha transparency support (default: false)

```
$handle->image_unsharp = true;
```

* **image\_unsharp\_amount** unsharp mask amount, typically 50 - 200 (default: 80)

```
$handle->image_unsharp_amount = 120;
```

* **image\_unsharp\_radius** unsharp mask radius, typically 0.5 - 1 (default: 0.5)

```
$handle->image_unsharp_radius = 1;
```

* **image\_unsharp\_threshold** unsharp mask threshold, typically 0 - 5 (default: 1)

```
$handle->image_unsharp_threshold = 0;
```

### Image text

* **image\_text** creates a text label on the image, value is a string, with eventual replacement tokens (default: null)

```
$handle->image_text = 'test';
```

* **image\_text\_direction** text label direction, either 'h' horizontal or 'v' vertical (default: 'h')

```
$handle->image_text_direction = 'v';
```

* **image\_text\_color** text color for the text label, in hexadecimal (default: #FFFFFF)

```
$handle->image_text_color = '#FF0000';
```

* **image\_text\_opacity** text opacity on the text label, integer between 0 and 100 (default: 100)

```
$handle->image_text_opacity = 50;
```

* **image\_text\_background** text label background color, in hexadecimal (default: null)

```
$handle->image_text_background = '#FFFFFF';
```

* **image\_text\_background\_opacity** text label background opacity, integer between 0 and 100 (default: 100)

```
$handle->image_text_background_opacity = 50;
```

* **image\_text\_font** built-in font for the text label, from 1 to 5. 1 is the smallest (default: 5). Value can also be a string, which represents the path to a GDF or TTF font (TrueType).

```
$handle->image_text_font = 4; // or './font.gdf' or './font.ttf'
```

* **image\_text\_size** font size for TrueType fonts, in pixels (GD1) or points (GD1) (default: 16) (TrueType fonts only)

```
$handle->image_text_size = 24;
```

* **image\_text\_angle** text angle for TrueType fonts, in degrees, with 0 degrees being left-to-right reading text(default: null) (TrueType fonts only)

```
$handle->image_text_angle = 45;
```

* **image\_text\_x** absolute text label position, in pixels from the left border. can be negative (default: null)

```
$handle->image_text_x = 5;
```

* **image\_text\_y** absolute text label position, in pixels from the top border. can be negative (default: null)

```
$handle->image_text_y = 5;
```

* **image\_text\_position** text label position withing the image, a combination of one or two from 'TBLR': top, bottom, left, right (default: null)

```
$handle->image_text_position = 'LR';
```

* **image\_text\_padding** text label padding, in pixels. can be overridden by `image_text_padding_x` and `image_text_padding_y` (default: 0)

```
$handle->image_text_padding = 5;
```

* **image\_text\_padding\_x** text label horizontal padding (default: null)

```
$handle->image_text_padding_x = 2;
```

* **image\_text\_padding\_y** text label vertical padding (default: null)

```
$handle->image_text_padding_y = 10;
```

* **image\_text\_alignment** text alignment when text has multiple lines, either 'L', 'C' or 'R' (default: 'C') (GD fonts only)

```
$handle->image_text_alignment = 'R';
```

* **image\_text\_line\_spacing** space between lines in pixels, when text has multiple lines (default: 0) (GD fonts only)

```
$handle->image_text_line_spacing = 3;
```

### Image transformations

* **image\_auto\_rotate** automatically rotates the image according to EXIF data (JPEG only) (default: true, applies even if there is no image manipulations)

```
$handle->image_auto_rotate = false;
```

* **image\_flip** flips image, wither 'h' horizontal or 'v' vertical (default: null)

```
$handle->image_flip = 'h';
```

* **image\_rotate** rotates image. Possible values are 90, 180 and 270 (default: null)

```
$handle->image_rotate = 90;
```

* **image\_crop** crops image. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_crop = array(50,40,30,20); OR '-20 20%'...
```

* **image\_precrop** crops image, before an eventual resizing. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_precrop = array(50,40,30,20); OR '-20 20%'...
```

### Image borders

* **image\_bevel** adds a bevel border to the image. value is thickness in pixels (default: null)

```
$handle->image_bevel = 20;
```

* **image\_bevel\_color1** top and left bevel color, in hexadecimal (default: #FFFFFF)

```
$handle->image_bevel_color1 = '#FFFFFF';
```

* **image\_bevel\_color2** bottom and right bevel color, in hexadecimal (default: #000000)

```
$handle->image_bevel_color2 = '#000000';
```

* **image\_border** adds a unicolor border to the image. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_border = '3px'; OR '-20 20%' OR array(3,2)...
```

* **image\_border\_color** border color, in hexadecimal (default: #FFFFFF)

```
$handle->image_border_color = '#FFFFFF';
```

* **image\_border\_opacity** border opacity, integer between 0 and 100 (default: 100)

```
$handle->image_border_opacity = 50;
```

* **image\_border\_transparent** adds a fading-to-transparent border to the image. accepts 4, 2 or 1 values as 'T R B L' or 'TB LR' or 'TBLR'. dimension can be 20, or 20px or 20% (default: null)

```
$handle->image_border_transparent = '3px'; OR '-20 20%' OR array(3,2)...
```

* **image\_frame** type of frame: 1=flat 2=crossed (default: null)

```
$handle->image_frame = 2;
```

* **image\_frame\_colors** list of hex colors, in an array or a space separated string (default: '#FFFFFF #999999 #666666 #000000')

```
$handle->image_frame_colors = array('#999999',  '#FF0000', '#666666', '#333333', '#000000');
```

* **image\_frame\_opacity** frame opacity, integer between 0 and 100 (default: 100)

```
$handle->image_frame_opacity = 50;
```

### Image watermark

* **image\_watermark** adds a watermark on the image, value is a local filename. accepted files are GIF, JPG, BMP, WEBP, PNG and PNG alpha (default: null)

```
$handle->image_watermark = 'watermark.png';
```

* **image\_watermark\_x** absolute watermark position, in pixels from the left border. can be negative (default: null)

```
$handle->image_watermark_x = 5;
```

* **image\_watermark\_y** absolute watermark position, in pixels from the top border. can be negative (default: null)

```
$handle->image_watermark_y = 5;
```

* **image\_watermark\_position** watermark position withing the image, a combination of one or two from 'TBLR': top, bottom, left, right (default: null)

```
$handle->image_watermark_position = 'LR';
```

* **image\_watermark\_no\_zoom\_in** prevents the watermark to be resized up if it is smaller than the image (default: true)

```
$handle->image_watermark_no_zoom_in = false;
```

* **image\_watermark\_no\_zoom\_out** prevents the watermark to be resized down if it is bigger than the image (default: false)

```
$handle->image_watermark_no_zoom_out = true;
```

### Image reflections

* **image\_reflection\_height** if set, a reflection will be added. Format is either in pixels or percentage, such as 40, '40', '40px' or '40%' (default: null)

```
$handle->image_reflection_height = '25%';
```

* **image\_reflection\_space** space in pixels between the source image and the reflection, can be negative (default: null)

```
$handle->image_reflection_space = 3;
```

* **image\_reflection\_color** reflection background color, in hexadecimal. Now deprecated in favor of `image_default_color` (default: #FFFFFF)

```
$handle->image_default_color = '#000000';
```

* **image\_reflection\_opacity** opacity level at which the reflection starts, integer between 0 and 100 (default: 60)

```
$handle->image_reflection_opacity = 60;
```

## Values that can be read before calling `process()`

* **file\_src\_name** Source file name
* **file\_src\_name\_body** Source file name body
* **file\_src\_name\_ext** Source file extension
* **file\_src\_pathname** Source file complete path and name
* **file\_src\_mime** Source file mime type
* **file\_src\_size** Source file size in bytes
* **file\_src\_error** Upload error code
* **file\_is\_image** Boolean flag, true if the file is a supported image type

If the file is a supported image type (and *open\_basedir* restrictions allow it)

* **image\_src\_x** Source file width in pixels
* **image\_src\_y** Source file height in pixels
* **image\_src\_pixels** Source file number of pixels
* **image\_src\_type** Source file type (png, webp, jpg, gif or bmp)
* **image\_src\_bits** Source file color depth

## Values that can be read after calling `process()`

* **file\_dst\_path** Destination file path
* **file\_dst\_name\_body** Destination file name body
* **file\_dst\_name\_ext** Destination file extension
* **file\_dst\_name** Destination file name
* **file\_dst\_pathname** Destination file complete path and name

If the file is a supported image type

* **image\_dst\_type** Destination file type (png, webp, jpg, gif or bmp)
* **image\_dst\_x** Destination file width
* **image\_dst\_y** Destination file height

## Requirements

Most of the image operations require GD. GD2 is greatly recommended

Version 1.x supports PHP 4, 5 and 7, but is not namespaced. Use it if you need support for PHP <5.3

Version 2.x supports PHP 5.3+, PHP 7 and PHP 8.

## About

This PHP class uploads files and manipulates images very easily. It is in fact as much as an image processing class than it is an upload class. Compatible with PHP 4, 5, 7 and 8. Supports processing of local files, uploaded files, files sent through XMLHttpRequest.

[www.verot.net/php\_class\_upload.htm](http://www.verot.net/php_class_upload.htm "http://www.verot.net/php_class_upload.htm")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-2.0 license](#GPL-2.0-1-ov-file)

[Activity](/verot/class.upload.php/activity)
### Stars

[**882**
stars](/verot/class.upload.php/stargazers)
### Watchers

[**80**
watching](/verot/class.upload.php/watchers)
### Forks

[**359**
forks](/verot/class.upload.php/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fverot%2Fclass.upload.php&report=verot+%28user%29)

## [Releases](/verot/class.upload.php/releases)

[30
tags](/verot/class.upload.php/tags)

## [Packages 0](/users/verot/packages?repo_name=class.upload.php)

No packages published

## [Used by 832](/verot/class.upload.php/network/dependents)

[* ![@joepdooper](https://avatars.githubusercontent.com/u/1838958?s=64&v=4)
* ![@amaanbrazil049](https://avatars.githubusercontent.com/u/161102313?s=64&v=4)
* ![@mubeenamanatdev9](https://avatars.githubusercontent.com/u/91336231?s=64&v=4)
* ![@kielmarj](https://avatars.githubusercontent.com/u/184318821?s=64&v=4)
* ![@JoseRodriguez98](https://avatars.githubusercontent.com/u/135857579?s=64&v=4)
* ![@rifki0908](https://avatars.githubusercontent.com/u/66056605?s=64&v=4)
* ![@AdityaSDR](https://avatars.githubusercontent.com/u/185252979?s=64&v=4)
* ![@anferalta](https://avatars.githubusercontent.com/u/150276760?s=64&v=4)

+ 824](/verot/class.upload.php/network/dependents)

## [Contributors 11](/verot/class.upload.php/graphs/contributors)

## Languages

* [PHP
  98.4%](/verot/class.upload.php/search?l=php)
* [HTML
  1.6%](/verot/class.upload.php/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cert.pl_068bdf36_20250115_222429.html ===


[Report an incident](https://incydent.cert.pl/#!/lang=en)

Back

* You're in the menu
* About us
  + About us
  + [About our team](../about-us/)
  + [Contact](../contact/)
* [News](../news/)
* For experts
  + For experts
  + [News](../news/)
  + [Publications](../publications/)
  + [The Warning List](../warning-list/)
  + Projects
  + [n6](../n6/)
  + [Artemis](/en/posts/2024/01/artemis-security-scanner/)
  + [MWDB](https://mwdb.cert.pl/)
  + CVD program
  + [CVD policy](../cvd)
  + [Advisories](../cve)

* About us
* [News](../news/)
* For experts

[Report an incident](https://incydent.cert.pl/#!/lang=en)

About us
[About our team](../about-us/)
[Contact](../contact/)

Baza wiedzy
[FaÅszywe inwestycje](/falszywe-inwestycje)
[UwaÅ¼aj na faÅszywe sklepy online](/falszywe-sklepy)
[(Nie)bezpieczne pÅatnoÅci](/baza-wiedzy/niebezpieczne-platnosci)
[FaÅszywi konsultanci](/baza-wiedzy/falszywi-konsultanci)
[Zadbaj o bezpieczne hasÅa i logowanie](/bezpieczne-hasla)
[FaÅszywe zaÅÄczniki w mailach](/falszywe-zalaczniki)
[FaÅszywe proÅby o szybki przelew](/szybkie-przelewy)
[FaÅszywe SMSy - plaga ostatnich miesiÄcy](/baza-wiedzy/falszywe-smsy)

Biuletyn OUCH!
[Porady bezpieczeÅstwa OUCH!](/ouch)

For experts
[Publications](../publications/)
[The Warning List](../warning-list/)

Projects
[n6](../n6/)
[Artemis](/en/posts/2024/01/artemis-security-scanner/)
[MWDB](https://mwdb.cert.pl/)

CVD program
[CVD policy](../cvd)
[Advisories](../cve)

Coordinated vulnerability disclosure (CVD) policy

### Where to report vulnerabilities?

**Before reporting a vulnerability to CERT Polska and making it public, submitters should contact the system owner or software vendor directly.**

If it is impossible to find the relevant contact information, or if contacting such parties proves difficult, the vulnerability should be reported to the relevant CSIRT according to the applicable area of responsibility, as described below:

**The tasks of CSIRT MON** include coordinating the handling of reported vulnerabilities in entities subordinate to or supervised by the Minister of National Defence. Vulnerabilities must be reported according to [the instructions](https://csirt-mon.wp.mil.pl/en/pages/contact-2019-08-23-c/).

**The tasks of CSIRT GOV** include coordinating the handling of reported vulnerabilities in units subordinate to or supervised by the Prime Minister, as well as in entities comprising critical infrastructure, central government authorities, the National Bank of Poland, and Bank Gospodarstwa Krajowego. Vulnerabilities must be reported according to [the instructions](https://csirt.gov.pl/cee/cyber-security-incident-report/978%2CCyber-security-incident-reporting.html).

If the vulnerability affects other entities, or if submitters are in doubt as to where to submit the notification, they should use the following contact form:

[Report a vulnerability to CERT Polska/CSIRT NASK](https://incydent.cert.pl/#!/lang=en,entityType=notObligatedEntity,easyIncidentType=vulnerability)

### How does CERT Polska/CSIRT NASK handle submissions?

We analyse each vulnerability report we receive. If we require additional information, or if the information provided is incomplete, our analysts will contact the Submitter directly. Where it is necessary to exchange information between the Submitter and the vulnerable systemâs owner, CERT Polska can support this process as a trusted party.

**We prioritise submissions that involve multiple producers or entities and can have a significant impact on national security.**

Once the vulnerability reporting process is completed and the bug has been patched, CERT Polska may publish information about the vulnerability on its website in a manner that makes it impossible to identify the Submitter and the relevant systems. This information will only contain the Submitter's data upon their consent.

**Please do not publish information about the vulnerability before the vulnerability handling process has been completed. Submitters who are planning to do so are asked to inform us in advance.**

### How and when CVE numbers are assigned?

It is possible to obtain a CVE number, where the vulnerability affects a software used on multiple systems. For more information about the CVE programme, visit: <https://www.cve.org/About/Overview>

For example, a vulnerability in a single municipality's website will not be assigned a CVE number; however, a vulnerability in a content management system used by multiple authorities may receive one. Moreover, CVE numbers are not assigned to vulnerabilities resulting from configuration errors made by the persons implementing the system, rather than the system itself.

The CVE request must be submitted to the appropriate CVE Numbering Authority (CNA), depending on which system is affected by the vulnerability. For a list of CNAs and information on how to submit requests, visit: <https://www.cve.org/ReportRequest/ReportRequestForNonCNAs>

If the vulnerability is related to a Polish producer, which is not a CNA, or if the submitter finds it difficult to contact the relevant CNA, CERT Polska can support them in the process of assigning a CVE number.

For vulnerability report please use only [the dedicated form](https://incydent.cert.pl/#!/lang=en,entityType=notObligatedEntity,easyIncidentType=vulnerability). We reach out to vendors immediately notifying them of the findings.

We publish CVE entries 90 days after the date on which the details of the discovered vulnerabilities are sent to the vendor. This may happen sooner if an update addressing the vulnerability is released, or if, despite multiple attempts to contact the vendor, satisfactory cooperation cannot be achieved. In justified cases, we also allow the possibility of extending this period.

For other inquiries related to CVD pleases contact us at [[email protected]](/cdn-cgi/l/email-protection#aecdd8caeecdcbdcda80dec2).

CERT Polska is a team operating within the structures of NASK - National Research Institute,
established in 1996 to respond to computer security incidents. It carries out the role of
CSIRT NASK, one of three such teams operating at the national level within the Polish national
cybersecurity system.

# Social media

[![](/theme/assets/img/img.gif)Facebook](https://www.facebook.com/CERT.Polska/)
[![](/theme/assets/img/img.gif)X](https://x.com/CERT_Polska_en)
[![](/theme/assets/img/img.gif)LinkedIn](https://www.linkedin.com/showcase/cert-polska)
[![](/theme/assets/img/img.gif)GitHub](https://github.com/CERT-Polska)

# Contact

Address: Kolska 12, 01-045 Warsaw, Poland

ePUAP: /NASK-Instytut/SkrytkaESP

e-DorÄczenia: AE:PL-60057-61611-BCEGR-11

E-mail: [[email protected]](/cdn-cgi/l/email-protection#83eaede5ecc3e0e6f1f7adf3ef)

Incident reporting: [incydent.cert.pl](https://incydent.cert.pl/#!/lang=en)

[[email protected]](/cdn-cgi/l/email-protection#0a696f787e4a696f787e247a66)

![Co-financed by the Connecting Europe Facility of The European Union](/theme/assets/img/ue-en.png)

* Â© 2025 [NASK](https://nask.pl/)
* [Privacy policy](/uploads/misc/privacy-policy-en.pdf)
* [CSIRT GOV](https://csirt.gov.pl/)
* [CSIRT MON](https://csirt-mon.wp.mil.pl/)


