=== Content from www.debian.org_5a0d939f_20250114_211613.html ===


---

[[Date Prev](msg00256.html)][[Date Next](msg00258.html)]
[[Thread Prev](msg00256.html)][[Thread Next](msg00258.html)]
[[Date Index](maillist.html#00257)]
[[Thread Index](threads.html#00257)]

# [SECURITY] [DSA 5561-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5561-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 22 Nov 2023 19:19:54 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZV5UWjv1z3EDpYay%40seger.debian.org)Â [ZV5UWjv1z3EDpYay@seger.debian.org](msg00257.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5561-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
November 22, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2023-6204 CVE-2023-6205 CVE-2023-6206 CVE-2023-6207
                 CVE-2023-6208 CVE-2023-6209 CVE-2023-6212

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, information leaks or clickjacking.

For the oldstable distribution (bullseye), these problems have been fixed
in version 115.5.0esr-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 115.5.0esr-1~deb12u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmVeU2MACgkQEMKTtsN8
TjYaBQ//Q0UIc5rK8lkm+CPkloFz8UCwFthZyP5d32mjMI/LzO0mk/JqYc/8n/NI
+eJ34GLzLW1oaF/puNSGtITtwWL3908/qXiE/EfEZSW+NBUV2wRZrchUYuwXSP+S
xxxXKE0+LcuQhfLja/LZMvvB8CNPAT1+zaLmG/CRu/8VN++e8wE+daBbaYg0KOKd
vgDtYDNX+3aV7CEuDfQLbRPJh+RN0AGusDXhMLJdn5FQC4q3mielHIxCm8dMf/DV
PR5ugVPxCIhm4r13zAaTsqI4zQzIAEKss/PZ09Jv0Rn30kFWRr5Jmhv2yWX0HhAg
bx2Ot/LySgHoQkfHjREkYrdV7tS3lh2qraiDZUChuNIR5QxUwn/TA6mXLSCUDk7o
sXTJa/+lAOo0a838cFPNBLYgQxYopWUo6OAu4331nJyNPpvlPbTdZnUpH4UOgBUj
oD/mEq41JwDPkjweP4bYV5TmdHAlPBxnv2ELLcsEavAJRiCcroqEl26rd8CPUFH0
eO1UgSdGZw9HOjW0+OOZQQVYeLHLdMIrbUL5jIPpix1N1aa/IEc7aXzYa8O1F5Qk
I5bcFJ/7yLy7NZs+jXWs53z78bJc1mRoQWs45KQlfAGXtljFYhXIvHy6O45jWi6R
/yr5DJYZhOPhfCkXjh8tWUcKcLhFF5jzZImjPk97TSjkeCoidMI=
=q4yZ
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_0167f1f6_20250114_211612.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DLA 3674-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3674-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 30 Nov 2023 14:26:11 +0000 (GMT)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20231130142611.2FBF12A00F1%40andromeda)Â [20231130142611.2FBF12A00F1@andromeda](msg00030.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3674-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
November 30, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.5.0-1~deb10u1
CVE ID         : CVE-2023-6204 CVE-2023-6205 CVE-2023-6206 CVE-2023-6207
                 CVE-2023-6208 CVE-2023-6209 CVE-2023-6212

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.5.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmVom4AACgkQnUbEiOQ2
gwIsRg/8DPpGw7lm6m9KnWU1B1HLHBk0qiBslBOTF3n8G2P+N3yZ6WxVC1cBIzkC
AkhAxxr4DKIr0vPH5LDx6QpcN/uk8UwYPPBPfqw2pu1cO5gpduNKNEeHyboLhrn6
wH4J9LK62VqPcsRtwm/H+wl/fOPw0+U5j66lMHKCWRhxizlBYqHhZOxnkianAyoM
zpRuz6zXE5a9JT8SdDuLnMXztziowjfyghAZM0vgDlyM4r/UxUisyH3zBip6845q
EjCdCdEUN4uUk5ngELNICiwt/ociRLpIN7NXdAH108qGmBUIDB/mJHIdDOECfiZr
wrM/lg0HqOupHZ8dVfTv9wxXbVmEcVhFx78frIM0Pi1trWrNNN4X5uceZ2GrWiKz
h1tQBcbRA1LVgno2Jdfdk9IA2XSksFEpYHvwte9gp0kc8dGpwkSZJwKjxj+VHg7D
X1/Ldmuqd6D81yKa8Rm84wqgsU9HpXAYWl2amWxLRceeZ1QKIxLrV+p3SdQwMQEe
W2e08hRT4ProNa2e13HL2DWMIcl4ga9H6gVRPpR6NFWR2+RT9NCQtIE6eAbjtcvz
chPbtXXJCRpszxpp/0YAZ9EdRLwhiTFme/RasNBgy7okDfUB5oR0j8+HnpCAN5fs
uZvSijNmtwprIc2TrpUl0tPcc2T8rnO1WRneoXzja8vJoz2yXEg=
=kU0m
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_bb4a7e76_20250114_211611.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 3661-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3661-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 23 Nov 2023 23:42:30 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20231123224230.101062A00DC%40andromeda)Â [20231123224230.101062A00DC@andromeda](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3661-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
November 23, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.5.0esr-1~deb10u1
CVE ID         : CVE-2023-6204 CVE-2023-6205 CVE-2023-6206 CVE-2023-6207
                 CVE-2023-6208 CVE-2023-6209 CVE-2023-6212

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, information leaks or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.5.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmVf1VMACgkQnUbEiOQ2
gwKx2g//cqVwCVC+aoRuCgS8+4sqTngnc0uNIaRmGIDH7AzQiKzUlpeRgytHXbqn
l5BUjdfPFyNH/HVNlArklkyyCIfoRRuF/Ts6oEGUDdQlT5gRwFIf1HRSajE+VcGW
4cK1urBuATPTQiBaVpVz21liVKdnWCxpf2ELOzp2/4z2uiI78OZJgNvprcWcNa5T
fhQK2KIhv4S/4d0E43olBSp4sm4v37PUmKXvEbn7C84qox9RUJL/eFF7YauXX2zz
KTwJBPfmwshhgbWIVDwv8msI7zvJPTtZlqqyRhLOpyPsTCawr8DYJvyKd4ErB5Sz
tYvuHezd7M5LzU+dhG402oG2hjMXaUvD9wsGvEbMaZYjDjYi+9Ep3gZO6D8a5/rJ
U/hAg+gIRl3NSrBJ3E/RDp4FKKMdaTQAYUQyzruGOrkROgxXAF2909aCIK7dFbBR
VwjeyJWeWvcE9rg8ea1my3gu0/7t3EkkCba9e81I/lDE16cRyD5F7WAvQbxkm3FH
fNlHaUn6gxW3jk2T+9deGq7CQFaGwmAiuPn/MDFDzXNG92SNG3FYPUryne7Lz06D
CRtI3Hq/asww2++hG9HKvGXPJh7F6MBVCik87ShuHD5jGFMy9vu1D5wuIPY5dZys
l00Bz3iddvQyGhoBwixFICrI1NKgbvn5nJZpxblQ6wwJW4ytKPg=
=zSdd
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_c8ea4c9e_20250114_211615.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-52

## Security Vulnerabilities fixed in Thunderbird 115.5

Announced
November 21, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.5

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-6204: Out-of-bound memory access in WebGL2 blitFramebuffer](#CVE-2023-6204)

Reporter
JSec of Hayyim Security
Impact
high
##### Description

On some systemsâ€”depending on the graphics settings and driversâ€”it was possible to force an out-of-bounds read and leak memory data into the images created on the canvas element.

##### References

* [Bug 1841050](https://bugzilla.mozilla.org/show_bug.cgi?id=1841050)

#### [#CVE-2023-6205: Use-after-free in MessagePort::Entangled](#CVE-2023-6205)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

It was possible to cause the use of a MessagePort after it had already
been freed, which could potentially have led to an exploitable crash.

##### References

* [Bug 1854076](https://bugzilla.mozilla.org/show_bug.cgi?id=1854076)

#### [#CVE-2023-6206: Clickjacking permission prompts using the fullscreen transition](#CVE-2023-6206)

Reporter
Hafiizh
Impact
high
##### Description

The black fade animation when exiting fullscreen is roughly
the length of the anti-clickjacking delay on permission prompts.
It was possible to use this fact to surprise users by luring them
to click where the permission grant button would be about to appear.

##### References

* [Bug 1857430](https://bugzilla.mozilla.org/show_bug.cgi?id=1857430)

#### [#CVE-2023-6207: Use-after-free in ReadableByteStreamQueueEntry::Buffer](#CVE-2023-6207)

Reporter
M. Coolie
Impact
high
##### Description

Ownership mismanagement led to a use-after-free in ReadableByteStreams

##### References

* [Bug 1861344](https://bugzilla.mozilla.org/show_bug.cgi?id=1861344)

#### [#CVE-2023-6208: Using Selection API would copy contents into X11 primary selection.](#CVE-2023-6208)

Reporter
turistu
Impact
moderate
##### Description

When using X11, text selected by the page using the Selection API was erroneously copied into the primary selection, a temporary storage not unlike the clipboard.
*This bug only affects Thunderbird on X11. Other systems are unaffected.*

##### References

* [Bug 1855345](https://bugzilla.mozilla.org/show_bug.cgi?id=1855345)

#### [#CVE-2023-6209: Incorrect parsing of relative URLs starting with "///"](#CVE-2023-6209)

Reporter
Rachmat Abdul Rokhim
Impact
moderate
##### Description

Relative URLs starting with three slashes were incorrectly parsed, and a
path-traversal "/../" part in the path could be used to override the
specified host. This could contribute to security problems in web sites.

##### References

* [Bug 1858570](https://bugzilla.mozilla.org/show_bug.cgi?id=1858570)

#### [#CVE-2023-6212: Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](#CVE-2023-6212)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1658432%2C1820983%2C1829252%2C1856072%2C1856091%2C1859030%2C1860943%2C1862782)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_fb2ddc41_20250114_211611.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1854076)
* [XML](/show_bug.cgi?ctype=xml&id=1854076)

Closed
[Bug 1854076](/show_bug.cgi?id=1854076)
(CVE-2023-6205)

Opened 1 year ago
Closed 1 year ago

# heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled

## Categories

### (Core :: DOM: postMessage, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20postMessage#DOM%3A%20postMessage)

DOM: postMessage
â–¾

Core :: DOM: postMessage
For bugs with all postMessage() APIs (i.e., with serializing, deserializing, and transferring), including [BroadcastChannel](https://html.spec.whatwg.org/multipage/web-messaging.html#broadcasting-to-other-browsing-contexts), [MessageChannel](https://html.spec.whatwg.org/multipage/web-messaging.html#message-channels), and [window.postMessage()](https://html.spec.whatwg.org/multipage/web-messaging.html#web-messaging).
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20postMessage&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20postMessage&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20postMessage)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

121 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [120+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=120%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix) |
| firefox119 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix) |
| firefox120 | [+](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=verified) |
| firefox121 | [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 120+ | verified |
| firefox-esr128 | --- | --- |
| firefox117 |  | wontfix |
| firefox118 |  | wontfix |
| firefox119 |  | wontfix |
| firefox120 | + | verified |
| firefox121 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: m.cooolie, Assigned: asuth)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/75b1e0d00a677e73b24efe34917fa1e9?d=mm&size=40)  [asuth](/user_profile?user_id=151407)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a2afc3e713a960c7119ae73ca1cd5e8e?d=mm&size=40)  [m.cooolie](/user_profile?user_id=689709)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1858809](/show_bug.cgi?id=1858809 "VERIFIED FIXED - Assertion failure: aWorkerPrivate, at /builds/worker/checkouts/gecko/dom/workers/WorkerRunnable.cpp:62")

Dependency [tree](/showdependencytree.cgi?id=1854076&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1854076)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, reporter-external, sec-high, Whiteboard: [adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6205

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4186577_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [poc.zip](/attachment.cgi?id=9354066)  [1 year ago](#c0)  [m.cooolie](/user_profile?user_id=689709)   49.54 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9354066&action=edit) |
| --- | --- | --- |
| [log\_ffp\_asan\_21324.log.42648.txt](/attachment.cgi?id=9354067)  [1 year ago](#c1)  [m.cooolie](/user_profile?user_id=689709)   30.18 KB, text/plain |  | [Details](/attachment.cgi?id=9354067&action=edit) |
| [Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!](/attachment.cgi?id=9359937)  [1 year ago](#c10)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c20 "1 year ago")  tjr : [sec-approval+](#c13 "1 year ago") | [Details](/attachment.cgi?id=9359937&action=edit) | [Review](/attachment.cgi?id=9359937) |
| [Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!](/attachment.cgi?id=9360076)  [1 year ago](#c11)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-esr115+](#c22 "1 year ago")  tjr : [sec-approval+](#c14 "1 year ago") | [Details](/attachment.cgi?id=9360076&action=edit) | [Review](/attachment.cgi?id=9360076) |
| [advisory.txt](/attachment.cgi?id=9364409)  [1 year ago](#c24)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   136 bytes, text/plain |  | [Details](/attachment.cgi?id=9364409&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [m.cooolie](/user_profile?user_id=689709)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1854076#c0)â€¢ 1 year ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=9354066)
â€” [Details](attachment.cgi?id=9354066&action=edit)

#Summary

heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled

#Reproduce

OS:Win10 X64

119.0a1 (2023-09-20) (64-bit)

step:

1. python -m http.server 1337
2. python -m ffpuppet firefox.exe -p prefs.js -d -u <http://localhost:1337/poc_heavy_but_stable.html>

NOTE!

poc\_heavy\_but\_stable.html (Samples before minimization can reproduce the issue stably)

poc\_mini\_not\_stable.html (Minimizing the sample may be helpful for analysis, but it cannot be stably reproduced)

#Type of crash

Tab process

#Analysis

MessagePortChild uses mPort to hold the original pointer of MessagePort.

The comment explains that it is because "this child is owned by this MessagePort", but this comment seems incorrect.

Searching the code found that MessagePortChild was created at [2] and assigned to MessagePort at [3].

```
class MessagePortChild final : public PMessagePortChild {
  friend class PMessagePortChild;

 public:
  NS_INLINE_DECL_REFCOUNTING(MessagePortChild)

  MessagePortChild();

  void SetPort(MessagePort* aPort) { mPort = aPort; }
---CUT---

  // This is a raw pointer because this child is owned by this MessagePort.
  MessagePort* mPort;
};

```

[2]

<https://searchfox.org/mozilla-central/source/ipc/glue/BackgroundChildImpl.cpp#441>

RefPtr<dom::MessagePortChild> agent = new dom::MessagePortChild(); // found in mozilla::ipc::BackgroundChildImpl::AllocPMessagePortChild

[3]

<https://searchfox.org/mozilla-central/source/dom/messagechannel/MessagePort.cpp#794>

mActor = static\_cast<MessagePortChild\*>(actor); // found in mozilla::dom::MessagePort::ConnectToPBackground

#FIX Suggestion

If the above analysis is correct,RefPtr can be used to resolve the issue.

Flags: sec-bounty?

|  | [m.cooolie](/user_profile?user_id=689709)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1854076#c1)â€¢ 1 year ago |
|  | |

Attached file
[log\_ffp\_asan\_21324.log.42648.txt](attachment.cgi?id=9354067)
â€” [Details](attachment.cgi?id=9354067&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a25550_406194)â€¢ 1 year ago |

Group: firefox-core-security â†’ dom-core-securityComponent: Security â†’ DOM: postMessageKeywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)Product: Firefox â†’ Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1854076#c2)â€¢ 1 year ago |
|  | |

Andrew, do you know who might be able to look at this issue? Thanks.

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a29461_151407)â€¢ 1 year ago |

Assignee: nobody â†’ bugmailStatus: NEW â†’ ASSIGNEDFlags: needinfo?(bugmail)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1854076#c3)â€¢ 1 year ago |
|  | |

I'll guess this is old because it looks like MessagePort hasn't changed much recently.

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1854076#c4)â€¢ 1 year ago |
|  | |

Haven't confirmed this, but assuming it can be triggered reliably this sounds like a sec-high issue.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a560545_151407)â€¢ 1 year ago |

Severity: -- â†’ S3Priority: -- â†’ P2

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1854076#c5)â€¢ 1 year ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:asuth, could you consider increasing the severity of this security bug?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#severity_high_security.py).

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a621470_151407)â€¢ 1 year ago |

Severity: S3 â†’ S2Flags: needinfo?(bugmail)

|  | [m.cooolie](/user_profile?user_id=689709)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1854076#c6)â€¢ 1 year ago |
|  | |

Is the security issue of 'sec-high' only a P2 priority? I didn't find a clear description in the relevant documentation, but it's clear that it is a P1 priority in the Chromium project.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1854076#c7)â€¢ 1 year ago |
|  | |

Our tracking is centered more [around the Severity field](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html#defect-severity) than the Priority field (as you can see from the bot that complained when this was S3). S2 issues, particularly sec-high ones, we try to fix in the next release or two. S1 is reserved for only the most severe issues, like an actively exploited zero day or if WebExtensions don't work for any Firefox user.

More specifically to what I expect you are getting at, I spoke to asuth about this issue yesterday, and despite the lack of activity here he has been actively looking into it. I think he got bogged down a bit because he was making sure there were not any other similar lifetime issues with these MessagePort classes, which are a bit complicated. Hopefully he'll be able to post a fix soon.

|  | [m.cooolie](/user_profile?user_id=689709)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1854076#c8)â€¢ 1 year ago |
|  | |

Thank you for your detailed explanation.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1854076#c9)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1854076&comment_id=16609710 "1 revision") |
|  | |

The problem here seems to be more subtle than an ownership problem; the confusing state machine around entangling and UpdateMustKeepAlive which maintains a self-induced strong-ref through at least entangling means that the state machine is largely correct. And changing the reference held by the MessagePortChild to a strong reference inherently would interfere with cycle collection[1]. That said, the raw pointer is inherently dangerous and the destructor and cycle collection unlink logic does not go far enough to ensure that the dangerous raw pointer is cleaned up.

By inspection, I suspect the issue here is that if we fail to create the WorkerRef we directly advanced the state machine to eStateDisentangled and call UpdateMustKeepAlive but without taking any action to ensure the actor is detached/cleaned up. UpdateMustKeepAlive will drop our strong ref, and setting the state to disentangled defeats any actions that might be taken to clean up the actor properly.

I don't believe this is possible for the normal Worker.postMessage, but this is possible due to an unfortunate timing of events related to our implementation of RTCRtpScriptTransform which this POC uses. [This is the WorkerRun implementation of EventWithOptionsRunnable that was forked from MessageEventRunnable for RTCRtpScriptTransform](https://searchfox.org/mozilla-central/rev/6602bdf9fff5020fbc8e248c963ddddf09a77b1b/dom/workers/EventWithOptionsRunnable.cpp#132-162). [This is the WorkerRun implementation of MessageEventRunnable](https://searchfox.org/mozilla-central/rev/6602bdf9fff5020fbc8e248c963ddddf09a77b1b/dom/workers/MessageEventRunnable.cpp#109-148). They do not look the same. They should look the same. [This is what is missing from EventWithOptionsRunnable](https://searchfox.org/mozilla-central/rev/6602bdf9fff5020fbc8e248c963ddddf09a77b1b/dom/workers/MessageEventRunnable.cpp#140-144) that would have prevented the MessagePort from being deserialized when the WorkerRef could not be created. The problem is the code was forked just prior to the landing of the changes to MessageEventRunnable.

So there's a couple fixes here for tomorrow:

* Bring EventWithOptionsRunnable up-to-date.
* Add failsafes to MessagePort so that we drop the actor no matter what in our destructor, asserting very hard if we have to do that since it means there was a state machine problem.
  + Ensure the actor can handle the MessagePort not existing. (It may already do this.)
* Correct the logic for when we can't create the WorkerRef to shut down the actor correctly/safely. We may also want to diagnostic assert a bit in this case because it should no longer be possible at this point to attempt to create a MessagePort after we've reached cancellation thanks to Eden's other cleanups.

In terms of follow-ups:

* We likely need to revisit how we're handling cycle collection for the MessagePort. Right now we keep it alive entirely if it's entangled, but we really should be switching to doing `KeepAliveIfHasListenersFor(nsGkAtoms::onmessage);` like we do for BroadcastChannel once we've reached the entangled stage. (But we absolutely do need to keep the extra reference until the entanglement state machine is completed based on how it's currently structured.)

In terms of specific regressing versions, this specific thing we're seeing will have started in v117 with the landing of [bug 1631263](/show_bug.cgi?id=1631263 "RESOLVED FIXED - Support RTCRtpScriptTransform (formerly webrtc insertable streams)") and will not be present in ESR. It's not clear if a different variation would be possible in versions prior to that. The cancellation refactor [bug 1800659](/show_bug.cgi?id=1800659 "RESOLVED FIXED - WorkerRunnable/WorkerDebuggeeRunnable refactoring (eliminate cancellation and therefore ClearMainEventQueue)") landed in v116 and would have eliminated prior variants. In v115 and earlier cancellation would be likely to make it very hard to create the problem, although not impossible, so I expect an ESR uplift of everything but changes to EventWithOptionsRunnable would be appropriate.

1: As noted above, the current cycle collection is not particularly cycle-collecty, so in a follow-up we should probably improve that.

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a1954557_151407)â€¢ 1 year ago |

Blocks: [1858809](/show_bug.cgi?id=1858809 "VERIFIED FIXED - Assertion failure: aWorkerPrivate, at /builds/worker/checkouts/gecko/dom/workers/WorkerRunnable.cpp:62")

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1854076#c10)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!](attachment.cgi?id=9359937)
â€” [Details](attachment.cgi?id=9359937&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a2977911_600971)â€¢ 1 year ago |

[Attachment #9359937](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") -
Attachment description: Bug 1854076 - Improve MessagePort state machine. r=#dom-workers! â†’ Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a2978143_600971)â€¢ 1 year ago |

[Attachment #9359937](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") -
Attachment description: Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers! â†’ Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1854076#c11)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!](attachment.cgi?id=9360076)
â€” [Details](attachment.cgi?id=9360076&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a2978234_600971)â€¢ 1 year ago |

[Attachment #9360076](/attachment.cgi?id=9360076&action=edit "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!") -
Flags: approval-mozilla-esr115?

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1854076#c12)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359937](/attachment.cgi?id=9359937 "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") [[details]](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!")

[Bug 1854076](/show_bug.cgi?id=1854076 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") - Improve MessagePort state machine. r=#dom-workers!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Moderate concern:

* Patch clarity: The patch does not identify the exact steps required to make the UAF happen, but it's fairly clear that there's something going on with worker shutdown from the non-EventWithOptionsRunnable steps, and for EventWithOptionsRunnable a trivial investigation into the history of the class or its class hierarchy should make it clear RTCRtpScriptTransform is involved.
* Exploitability:
  + From [comment 0](/show_bug.cgi?id=1854076#c0 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") it sounds like it's not entirely trivial to cause the detected UAF to occur. But attempts to cause the UAF to occur will not cause a crash or destabilize the process, so one could keep at it for a while.
  + However, in the event the freed MessagePort memory has not been repurposed, we expect the UAF to result in a write to the freed, poisoned area, followed by a crash as we try and deref a poisoned nsTArray header pointer. So failure to repurpose the memory quite possibly would crash the process immediately in a way we'd see in crash-stats.
  + Timing of when the free and UAF happen would probably have a wide variability.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: ESR has the same underlying MessagePort state machine problem, but it should be significantly less exploitable because [bug 1631263](/show_bug.cgi?id=1631263 "RESOLVED FIXED - Support RTCRtpScriptTransform (formerly webrtc insertable streams)")'s introduction of EventWithOptionsRunnable or the changes to worker cancellation
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1631263](/show_bug.cgi?id=1631263 "RESOLVED FIXED - Support RTCRtpScriptTransform (formerly webrtc insertable streams)")
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: This is low risk because all changes relate to edge cases where a bad thing is already happening if the new logic comes into play.
* **Is Android affected?**: Yes
[Attachment #9359937](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") -
Flags: sec-approval?

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a2978593_151407)â€¢ 1 year ago |

[Attachment #9360076](/attachment.cgi?id=9360076&action=edit "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a3142513_75935)â€¢ 1 year ago |

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix)
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected)
[tracking-firefox120](/buglist.cgi?f1=cf_tracking_firefox120&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%2B)
[tracking-firefox121](/buglist.cgi?f1=cf_tracking_firefox121&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [120+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=120%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1854076#c13)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359937](/attachment.cgi?id=9359937 "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") [[details]](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!")

[Bug 1854076](/show_bug.cgi?id=1854076 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") - Improve MessagePort state machine. r=#dom-workers!

Approved to land

[Attachment #9359937](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") -
Flags: sec-approval? â†’ sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1854076#c14)â€¢ 1 year ago |
|  | |

Comment on [attachment 9360076](/attachment.cgi?id=9360076 "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!") [[details]](/attachment.cgi?id=9360076&action=edit "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!")

[Bug 1854076](/show_bug.cgi?id=1854076 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") - ESR115 Improve MessagePort state machine. r=#dom-workers!

sec-approved

[Attachment #9360076](/attachment.cgi?id=9360076&action=edit "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!") -
Flags: sec-approval? â†’ sec-approval+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1854076#c15)â€¢ 1 year ago |
|  | |

Pushed by bugmail@asutherland.org:
<https://hg.mozilla.org/integration/autoland/rev/b6d6a9c84257>
Improve MessagePort state machine. r=dom-worker-reviewers,edenchuang

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1854076#c16)â€¢ 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b6d6a9c84257>

Group: dom-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 1 year ago
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 121 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1854076#c17)â€¢ 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:asuth, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox120` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1854076#c18)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359937](/attachment.cgi?id=9359937 "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") [[details]](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!")

[Bug 1854076](/show_bug.cgi?id=1854076 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") - Improve MessagePort state machine. r=#dom-workers!

### Beta/Release Uplift Approval Request

* **User impact if declined**: See [comment 12](/show_bug.cgi?id=1854076#c12 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled").
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Quoting [comment 12](/show_bug.cgi?id=1854076#c12 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled"):

> This is low risk because all changes relate to edge cases where a bad thing is already happening if the new logic comes into play.

* **String changes made/needed**:
* **Is Android affected?**: Yes
Flags: needinfo?(bugmail)
[Attachment #9359937](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") -
Flags: approval-mozilla-beta?

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1854076#c19)â€¢ 1 year ago |
|  | |

I should also say I'm not entirely clear on whether I would push my ESR fix directly to ESR or use lando given the recent announcements about uplift requests via phabricator/lando. (The announcement came after I uploaded the patch.)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1854076#c20)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359937](/attachment.cgi?id=9359937 "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") [[details]](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!")

[Bug 1854076](/show_bug.cgi?id=1854076 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") - Improve MessagePort state machine. r=#dom-workers!

Approved for 120.0b5

[Attachment #9359937](/attachment.cgi?id=9359937&action=edit "Bug 1854076 - Improve MessagePort state machine. r=#dom-workers!") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1854076#c21)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/cc2e02baaa14>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a3490899_690067)â€¢ 1 year ago |

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fixed)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1854076#c22)â€¢ 1 year ago |
|  | |

Comment on [attachment 9360076](/attachment.cgi?id=9360076 "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!") [[details]](/attachment.cgi?id=9360076&action=edit "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!")

[Bug 1854076](/show_bug.cgi?id=1854076 "VERIFIED FIXED - heap-use-after-free messagechannel/MessagePort.cpp:574 in mozilla::dom::MessagePort::Entangled") - ESR115 Improve MessagePort state machine. r=#dom-workers!

Approved for 115.5esr

[Attachment #9360076](/attachment.cgi?id=9360076&action=edit "Bug 1854076 - ESR115 Improve MessagePort state machine. r=#dom-workers!") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1854076#c23)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/d04b0067e2ec>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a3516844_690067)â€¢ 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a4186577_1689)â€¢ 1 year ago |

Flags: sec-bounty? â†’ sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a4937662_1689)â€¢ 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] â†’ [adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1854076#c24)â€¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9364409)
â€” [Details](attachment.cgi?id=9364409&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a5289048_428608)â€¢ 1 year ago |

Alias: CVE-2023-6205

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a5869387_553429)â€¢ 1 year ago |

Flags: qe-verify+Whiteboard: [adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?] â†’ [adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a5872729_553429)â€¢ 1 year ago |

QA Whiteboard: [qa-triaged]

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1854076#c25)â€¢ 1 year ago |
|  | |

HI @Andrew, I tried to reproduce this issue on my end with a Windows 10 machine and Firefox Nightly 119.0a1 (2023-09-20) but I keep getting the"

Pass

assert\_equals("registered", "registered")

/poc\_heavy\_but\_stable.html:51:34

There is no crash on my end.

I copied everything from the poc.zip file in the Firefox installation folder, started the server from cmd with the "python -m http.server 1337" command and then ran the python -m ffpuppet firefox.exe -p prefs.js -d -u <http://localhost:1337/poc_heavy_but_stable.html> where it would start Firefox and go to that page, but no crashes occurs on my side, do I need a debug build or something similar ? am I missing some steps ?

Flags: needinfo?(bugmail)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1854076#c26)â€¢ 1 year ago |
|  | |

@m.coolie can you please take a look in our latest ESR build 115.5 you can find it here:

<https://ftp.mozilla.org/pub/firefox/candidates/115.5.0esr-candidates/build1/win64/en-US/>

as well as our latest Beta 121.0b4:

<https://ftp.mozilla.org/pub/firefox/candidates/121.0b4-candidates/build1/win64/en-US/>

and see if the issue still occurs with these builds ?

Or maybe a different test case in order to reproduce this issue on our end ?

Flags: needinfo?(m.cooolie)

|  | [m.cooolie](/user_profile?user_id=689709)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1854076#c27)â€¢ 1 year ago |
|  | |

I don't get crash on latest ESR build 115.5.

But if it is expected to crash, you may need the ASAN version to confirm.

Flags: needinfo?(m.cooolie)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1854076#c28)â€¢ 1 year ago |
|  | |

That was the issue, I was able to reproduce this issue with asan builds and I was able to verify the fix. Thanks @m.coolie.

Status: RESOLVED â†’ VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=verified)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(bugmail)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1854076#c29)â€¢ 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1854076#a21894466_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1854076&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [m.cooolie](/user_profile?user_id=689709)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8af6ca9e_20250114_211614.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-50

## Security Vulnerabilities fixed in Firefox ESR 115.5.0

Announced
November 21, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.5

#### [#CVE-2023-6204: Out-of-bound memory access in WebGL2 blitFramebuffer](#CVE-2023-6204)

Reporter
JSec of Hayyim Security
Impact
high
##### Description

On some systemsâ€”depending on the graphics settings and driversâ€”it was possible to force an out-of-bounds read and leak memory data into the images created on the canvas element.

##### References

* [Bug 1841050](https://bugzilla.mozilla.org/show_bug.cgi?id=1841050)

#### [#CVE-2023-6205: Use-after-free in MessagePort::Entangled](#CVE-2023-6205)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

It was possible to cause the use of a MessagePort after it had already
been freed, which could potentially have led to an exploitable crash.

##### References

* [Bug 1854076](https://bugzilla.mozilla.org/show_bug.cgi?id=1854076)

#### [#CVE-2023-6206: Clickjacking permission prompts using the fullscreen transition](#CVE-2023-6206)

Reporter
Hafiizh
Impact
high
##### Description

The black fade animation when exiting fullscreen is roughly
the length of the anti-clickjacking delay on permission prompts.
It was possible to use this fact to surprise users by luring them
to click where the permission grant button would be about to appear.

##### References

* [Bug 1857430](https://bugzilla.mozilla.org/show_bug.cgi?id=1857430)

#### [#CVE-2023-6207: Use-after-free in ReadableByteStreamQueueEntry::Buffer](#CVE-2023-6207)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

Ownership mismanagement led to a use-after-free in ReadableByteStreams

##### References

* [Bug 1861344](https://bugzilla.mozilla.org/show_bug.cgi?id=1861344)

#### [#CVE-2023-6208: Using Selection API would copy contents into X11 primary selection.](#CVE-2023-6208)

Reporter
turistu
Impact
moderate
##### Description

When using X11, text selected by the page using the Selection API was erroneously copied into the primary selection, a temporary storage not unlike the clipboard.
*This bug only affects Firefox on X11. Other systems are unaffected.*

##### References

* [Bug 1855345](https://bugzilla.mozilla.org/show_bug.cgi?id=1855345)

#### [#CVE-2023-6209: Incorrect parsing of relative URLs starting with "///"](#CVE-2023-6209)

Reporter
Rachmat Abdul Rokhim
Impact
moderate
##### Description

Relative URLs starting with three slashes were incorrectly parsed, and a
path-traversal "/../" part in the path could be used to override the
specified host. This could contribute to security problems in web sites.

##### References

* [Bug 1858570](https://bugzilla.mozilla.org/show_bug.cgi?id=1858570)

#### [#CVE-2023-6212: Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](#CVE-2023-6212)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1658432%2C1820983%2C1829252%2C1856072%2C1856091%2C1859030%2C1860943%2C1862782)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_5dc69d60_20250114_211613.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-49

## Security Vulnerabilities fixed in Firefox 120

Announced
November 21, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 120

#### [#CVE-2023-6204: Out-of-bound memory access in WebGL2 blitFramebuffer](#CVE-2023-6204)

Reporter
JSec of Hayyim Security
Impact
high
##### Description

On some systemsâ€”depending on the graphics settings and driversâ€”it was possible to force an out-of-bounds read and leak memory data into the images created on the canvas element.

##### References

* [Bug 1841050](https://bugzilla.mozilla.org/show_bug.cgi?id=1841050)

#### [#CVE-2023-6205: Use-after-free in MessagePort::Entangled](#CVE-2023-6205)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

It was possible to cause the use of a MessagePort after it had already
been freed, which could potentially have led to an exploitable crash.

##### References

* [Bug 1854076](https://bugzilla.mozilla.org/show_bug.cgi?id=1854076)

#### [#CVE-2023-6206: Clickjacking permission prompts using the fullscreen transition](#CVE-2023-6206)

Reporter
Hafiizh
Impact
high
##### Description

The black fade animation when exiting fullscreen is roughly
the length of the anti-clickjacking delay on permission prompts.
It was possible to use this fact to surprise users by luring them
to click where the permission grant button would be about to appear.

##### References

* [Bug 1857430](https://bugzilla.mozilla.org/show_bug.cgi?id=1857430)

#### [#CVE-2023-6207: Use-after-free in ReadableByteStreamQueueEntry::Buffer](#CVE-2023-6207)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

Ownership mismanagement led to a use-after-free in ReadableByteStreams

##### References

* [Bug 1861344](https://bugzilla.mozilla.org/show_bug.cgi?id=1861344)

#### [#CVE-2023-6208: Using Selection API would copy contents into X11 primary selection.](#CVE-2023-6208)

Reporter
turistu
Impact
moderate
##### Description

When using X11, text selected by the page using the Selection API was erroneously copied into the primary selection, a temporary storage not unlike the clipboard.
*This bug only affects Firefox on X11. Other systems are unaffected.*

##### References

* [Bug 1855345](https://bugzilla.mozilla.org/show_bug.cgi?id=1855345)

#### [#CVE-2023-6209: Incorrect parsing of relative URLs starting with "///"](#CVE-2023-6209)

Reporter
Rachmat Abdul Rokhim
Impact
moderate
##### Description

Relative URLs starting with three slashes were incorrectly parsed, and a
path-traversal "/../" part in the path could be used to override the
specified host. This could contribute to security problems in web sites.

##### References

* [Bug 1858570](https://bugzilla.mozilla.org/show_bug.cgi?id=1858570)

#### [#CVE-2023-6210: Mixed-content resources not blocked in a javascript: pop-up](#CVE-2023-6210)

Reporter
Godson Bastin
Impact
low
##### Description

When an https: web page created a pop-up from a "javascript:" URL,
that pop-up was incorrectly allowed to load blockable content such
as iframes from insecure http: URLs

##### References

* [Bug 1801501](https://bugzilla.mozilla.org/show_bug.cgi?id=1801501)

#### [#CVE-2023-6211: Clickjacking to load insecure pages in HTTPS-only mode](#CVE-2023-6211)

Reporter
Muneaki Nishimura
Impact
low
##### Description

If an attacker needed a user to load an insecure http: page and knew
that user had enabled HTTPS-only mode, the attacker could have
tricked the user into clicking to grant an HTTPS-only exception
if they could get the user to participate in a clicking game.

##### References

* [Bug 1850200](https://bugzilla.mozilla.org/show_bug.cgi?id=1850200)

#### [#CVE-2023-6212: Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](#CVE-2023-6212)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1658432%2C1820983%2C1829252%2C1856072%2C1856091%2C1859030%2C1860943%2C1862782)

#### [#CVE-2023-6213: Memory safety bugs fixed in Firefox 120](#CVE-2023-6213)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1849265%2C1851118%2C1854911)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


