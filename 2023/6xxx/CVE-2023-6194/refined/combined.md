=== Content from gitlab.eclipse.org_28c6fc38_20250114_221253.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# XXE in Eclipse Memory Analyzer report definition files

## Basic information

**Project name:** Eclipse Memory Analyzer

**Project id:** tools.mat

## What are the affected versions?

All versions prior to 1.15.0 including 1.14.0 and earlier.

## Details of the issue

A user can choose to create a report in Eclipse Memory Analyzer using an external report definition file from an untrusted source defined in XML. If this report definition file has been configured to have a XML External Entity (XXE) processing attack then Eclipse Memory Analyzer could access unexpected external data. This attack may lead to the disclosure of confidential data, denial of service, server side request forgery, port scanning from the perspective of the machine where the parser is located, and other system impacts.
However, in general, users should not run untrusted external report definition files with Eclipse Memory Analyzer as the report definition is like a script and could run any defined Memory Analyzer query or report.

## Steps to reproduce

Take a Eclipse Memory Analyzer report file.
Add a sample XXE attack to the XML, for example:

```
<!DOCTYPE root_element SYSTEM "file:///c:/mysecret.txt">
```

and used the Memory Analyzer 'Run Report' menu option to select and run the report XML on the current heap dump snapshot. Look for an error message in the error log.

```
java.io.FileNotFoundException: c:\mysecret.txt (The system cannot find the file specified)
	at java.base/java.io.FileInputStream.open(Unknown Source)
	at java.base/java.io.FileInputStream.<init>(Unknown Source)
	at java.base/java.io.FileInputStream.<init>(Unknown Source)
	at java.base/sun.net.www.protocol.file.FileURLConnection.connect(Unknown Source)
	at java.base/sun.net.www.protocol.file.FileURLConnection.getInputStream(Unknown Source)
	at java.xml/com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(Unknown Source)
```

## Do you know any mitigations of the issue?

Run Eclipse Memory Analyzer with these JVM options in `MemoryAnalyzer.ini`.

```
-Djavax.xml.accessExternalSchema=
-Djavax.xml.accessExternalDTD=
```

Eclipse Memory Analyzer version 1.15.0 will contain a fix for this issue. See [bug 582681](https://bugs.eclipse.org/bugs/show_bug.cgi?id=582631).

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Copyright © Eclipse Foundation, Inc. All Rights Reserved.     [Privacy Policy](https://www.eclipse.org/legal/privacy.php) | [Terms of Use](https://www.eclipse.org/legal/termsofuse.php) | [Copyright Agent](https://www.eclipse.org/legal/copyright.php)



=== Content from gitlab.eclipse.org_a73a1ac8_20250114_221253.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# XXE in Eclipse Memory Analyzer report definition files

The Eclipse Foundation is a [Common Vulnerabilities and Exposures](https://cve.mitre.org/) (CVE) Numbering Authority. This issue it used to request and track the progress of the assignment of a CVE for a vulnerability in the project code for an Eclipse open source project.

## Basic information

**Project name:** Eclipse Memory Analyzer

**Project id:** tools.mat

**Request type:** reservation

**Versions affected:** [0.7, 1.14.0]

**Common Weakness Enumeration:**

* [CWE-611](https://cwe.mitre.org/data/definitions/611.html)

**Common Vulnerability Scoring System:** [3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:L/E:U/RL:W/RC:C/CR:X/IR:X/AR:X/MAV:L/MAC:L/MPR:L/MUI:R/MS:U/MC:L/MI:N/MA:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:L/E:U/RL:W/RC:C/CR:X/IR:X/AR:X/MAV:L/MAC:L/MPR:L/MUI:R/MS:U/MC:L/MI:N/MA:L&version=3.1)

**Summary:**

In Eclipse Memory Analyzer versions 0.7 to 1.14.0, report definition XML files are not filtered to prohibit
document type definition (DTD) references to external entities.
This means that if a user chooses to use a malicious report definition XML file containing an external entity reference
to generate a report then Eclipse Memory Analyzer may access external files or URLs defined via a DTD in the report definition.

**Workaround:**

A workaround for Eclipse Memory Analyzer 1.14.0 and earlier is to run MAT with the following system properties set in MemoryAnalyzer.ini

```
-Djavax.xml.accessExternalSchema=
-Djavax.xml.accessExternalDTD=
```

**Links:**

* <https://bugs.eclipse.org/bugs/show_bug.cgi?id=582631>
* [vulnerability-reports#169 (closed)](https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/169 "XXE in Eclipse Memory Analyzer report definition files")

## Tracking

**This section will completed by the project team**.

* Reserve an entry only
* We're ready for this issue to be reported to the central authority (i.e., make this public now)

Note that for those projects that host their repositories on GitHub, the use of GitHub Security Advisories is recommended but is not required.

**This section will be completed by the EMO**.

**CVE:** {cve}

* All required information is provided
* CVE Assigned
* Pushed to Mitre

Edited Dec 11, 2023 by [Marta Rybczynska](/mrybczyn)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Copyright © Eclipse Foundation, Inc. All Rights Reserved.     [Privacy Policy](https://www.eclipse.org/legal/privacy.php) | [Terms of Use](https://www.eclipse.org/legal/termsofuse.php) | [Copyright Agent](https://www.eclipse.org/legal/copyright.php)



=== Content from bugs.eclipse.org_77c9b09a_20250114_221252.html ===


[![logo]()](https://www.eclipse.org/)

* [Download](https://www.eclipse.org/downloads/)
* [Getting Started](https://www.eclipse.org/users/)
* [Members](https://www.eclipse.org/membership/)
* [Projects](https://www.eclipse.org/projects/)
* Community
  + [Marketplace](http://marketplace.eclipse.org)
  + [Events](http://events.eclipse.org)
  + [Planet Eclipse](http://www.planeteclipse.org/)
  + [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
  + [Videos](https://www.youtube.com/user/EclipseFdn)
* Participate
  + [Report a Bug](https://bugs.eclipse.org/bugs/)
  + [Forums](https://www.eclipse.org/forums/)
  + [Mailing Lists](https://www.eclipse.org/mail/)
  + [Wiki](https://wiki.eclipse.org/)
  + [IRC](https://wiki.eclipse.org/IRC)
  + [How to Contribute](https://www.eclipse.org/contribute/)
* Working Groups
  + [Automotive](http://wiki.eclipse.org/Auto_IWG)
  + [Internet of Things](http://iot.eclipse.org)
  + [LocationTech](http://locationtech.org)
  + [Long-Term Support](http://lts.eclipse.org)
  + [PolarSys](http://polarsys.org)
  + [Science](http://science.eclipse.org)
  + [OpenMDM](http://www.openmdm.org)
* More
  + - **Community**
    - [Marketplace](http://marketplace.eclipse.org)
    - [Events](http://events.eclipse.org)
    - [Planet Eclipse](http://www.planeteclipse.org/)
    - [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
    - [Videos](https://www.youtube.com/user/EclipseFdn)
    - **Participate**
    - [Report a Bug](https://bugs.eclipse.org/bugs/)
    - [Forums](https://www.eclipse.org/forums/)
    - [Mailing Lists](https://www.eclipse.org/mail/)
    - [Wiki](https://wiki.eclipse.org/)
    - [IRC](https://wiki.eclipse.org/IRC)
    - [How to Contribute](https://www.eclipse.org/contribute/)
    - **Working Groups**
    - [Automotive](http://wiki.eclipse.org/Auto_IWG)
    - [Internet of Things](http://iot.eclipse.org)
    - [LocationTech](http://locationtech.org)
    - [Long-Term Support](http://lts.eclipse.org)
    - [PolarSys](http://polarsys.org)
    - [Science](http://science.eclipse.org)
    - [OpenMDM](http://www.openmdm.org)

Toggle navigation

[![logo](/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png)](https://www.eclipse.org/)

Bugzilla – Bug 582631
Validate XML report files against schema and restrict external entity access.
Last modified: 2023-12-11 11:16:03 EST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=582631&GoAheadAndLogIn=1)

  [x]
| * [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
| * [Copyright Agent](http://www.eclipse.org/legal/copyright.php)

This Bugzilla instance is deprecated, and most Eclipse projects now use
[GitHub](https://github.com/eclipse) or [Eclipse GitLab](https://gitlab.eclipse.org/eclipse/). Please see the [deprecation plan](https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan) for details.

[**Bug 582631**](show_bug.cgi?id=582631)
- Validate XML report files against schema and restrict external entity access.

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Validate XML report files against schema and restrict external entity access.

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | MAT | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Tools | | [Component:](describecomponents.cgi?product=MAT "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Core ([show other bugs](buglist.cgi?component=Core&product=MAT&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 1.14   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal ([vote](page.cgi?id=voting/user.html&bug_id=582631#vote_582631)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 1.15.0   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Andrew Johnson [CLA](https://wiki.eclipse.org/ECA) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2023-11-14 04:43 EST by Andrew Johnson [CLA](https://wiki.eclipse.org/ECA) | | --- | --- | | Modified: | 2023-12-11 11:16 EST ([History](show_activity.cgi?id=582631)) | | CC List: | 4 users (show)  jkoch kevin.grigorenko krum.tsvetkov marta.rybczynska | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=582631&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=582631&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=582631#c0)  Andrew Johnson [CLA](https://wiki.eclipse.org/ECA)    2023-11-14 04:43:23 EST  ``` An Memory Analyzer reports are defined via an XML file. <https://help.eclipse.org/latest/index.jsp?topic=%2Forg.eclipse.mat.ui.help%2Fdoc%2Forg_eclipse_mat_report_report.html>  We aleady have a schema, so should validate the XML against the schema and give warnings messages to the user if the report definition is not quite correct.  Also, we should be aware of XML external entity processing vulnerabilities.  [https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_%28XXE%29_Processing) <https://cwe.mitre.org/data/definitions/611.html>  In general the reports don't need access an external entity, so we should disable this when the reports are executed. ```  [Comment 1](show_bug.cgi?id=582631#c1)  Andrew Johnson [CLA](https://wiki.eclipse.org/ECA)    2023-11-14 05:10:42 EST  ``` This is similar to <https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/8>  We use the SAX parser for reading report definitions and so a malicious external report definition could do something unexpected if run by a user. I've confirmed that using add <!DOCTYPE root_element SYSTEM file:///c:/mysecret.txt> to the beginning of a report  However running an untrusted report could already do a denial of service, so I wonder how big an issue this is?   I've got a fix for the parsing, and I have added some extra code to validate the report XML against the schema.  [https://git.eclipse.org/r/c/mat/org.eclipse.mat/+/205415](https://git.eclipse.org/r/c/mat/org.eclipse.mat/%2B/205415)         <https://git.eclipse.org/c/mat/org.eclipse.mat.git/commit/?id=979835dab651c35be5b51155303c33e728ce2d11>  Existing code should have stopped this problem but didn’t. saxXmlReader.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true); <https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/parsers/SAXParser.html#setProperty(java.lang.String,java.lang.Object>) <https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/XMLConstants.html#FEATURE_SECURE_PROCESSING> <https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/XMLConstants.html#ACCESS_EXTERNAL_DTD> "When FEATURE_SECURE_PROCESSING is enabled, it is recommended that implementations restrict external connections by default, though this may cause problems for applications that process XML/XSD/XSL with external references."  The workaround for MAT 1.14.0 from <https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/XMLConstants.html#ACCESS_EXTERNAL_DTD> and <https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/XMLConstants.html#ACCESS_EXTERNAL_SCHEMA> is to run MAT with the following system properties set in MemoryAnalyzer.ini -Djavax.xml.accessExternalSchema= -Djavax.xml.accessExternalDTD= ```  [Comment 2](show_bug.cgi?id=582631#c2)  Andrew Johnson [CLA](https://wiki.eclipse.org/ECA)    2023-11-14 05:15:28 EST  ``` Possible plan:  1. Apply patch [https://git.eclipse.org/r/c/mat/org.eclipse.mat/+/205415](https://git.eclipse.org/r/c/mat/org.eclipse.mat/%2B/205415). Done. 2. Other people test the patch – do we need more? 3. Copy build to 2023-12/M3 prepare sim-rel 4. Update our SimRel contribution (Krum) – by Monday / Tuesday? ready for M3 SimRel. 5. Open bug (mark security, private). Done - this bug. 6. Discuss whether we need a CVE. 7. Write CVE (if needed). 8. Publish CVE (if needed). 9. At some point publish the bug – with the workaround for don’t run untrusted XML reports – read them first? 10. Announce on MAT mailing list. 11. Update new and noteworthy - need to get into 2023-12/RC1. 12. MAT 1.15.0 when released on December 6 2023 should have the fix. ```  [Comment 3](show_bug.cgi?id=582631#c3)  Andrew Johnson [CLA](https://wiki.eclipse.org/ECA)    2023-11-14 11:53:15 EST  ``` See <https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/169> ```  [Comment 4](show_bug.cgi?id=582631#c4)  Krum Tsvetkov [CLA](https://wiki.eclipse.org/ECA)    2023-11-14 13:32:16 EST  ``` > See <https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/169>  I can't see it, even after I log in. ```  [Comment 5](show_bug.cgi?id=582631#c5)  Marta Rybczynska [CLA](https://wiki.eclipse.org/ECA)    2023-11-15 02:22:33 EST  ``` We need to add all people one by one to that ticket. Please come with a list and I will do that. ```  [Comment 6](show_bug.cgi?id=582631#c6)  Andrew Johnson [CLA](https://wiki.eclipse.org/ECA)    2023-11-21 04:01:21 EST  ``` From the plan:  1. Apply patch [https://git.eclipse.org/r/c/mat/org.eclipse.mat/+/205415](https://git.eclipse.org/r/c/mat/org.eclipse.mat/%2B/205415). Done. 2. Other people test the patch – do we need more? 3. Copy build to 2023-12/M3 prepare sim-rel. Done 4. Update our SimRel contribution (Krum) – by Monday / Tuesday? ready for M3 SimRel. Done. 5. Open bug (mark security, private). Done - this bug. 6. Discuss whether we need a CVE. Done. 7. Write CVE (if needed). CVE number assigned. All information present for CVE. Done. 8. Publish CVE (if needed). 9. At some point publish the bug – with the workaround for don’t run untrusted XML reports – read them first  / use system properties. 10. Announce on MAT mailing list. 11. Update new and noteworthy - need to get into 2023-12/RC1. - will be web-only version. 12. MAT 1.15.0 when released on December 6 2023 should have the fix. ```  [Comment 7](show_bug.cgi?id=582631#c7)  Marta Rybczynska [CLA](https://wiki.eclipse.org/ECA)    2023-12-11 09:09:25 EST  ``` The CVE has been published, I'm making this issue public too. ```  [Comment 8](show_bug.cgi?id=582631#c8)  Andrew Johnson [CLA](https://wiki.eclipse.org/ECA)    2023-12-11 11:16:03 EST  ``` The fixes are in Eclipse Memory Analyzer 1.15.0 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=582631)
* - [XML](show_bug.cgi?ctype=xml&id=582631)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=582631)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=582631&GoAheadAndLogIn=1)

    [x]
  | + [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
  | + [Copyright Agent](http://www.eclipse.org/legal/copyright.php)


