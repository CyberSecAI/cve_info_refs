The provided content relates to CVE-2023-6627.

**Root cause of vulnerability:**
The vulnerability stems from improper handling of REST API routes within the WP Go Maps plugin. The plugin uses regular expressions on `$_SERVER['REQUEST_URI']` and `$_SERVER['REQUEST_METHOD']` to determine which code should be executed. This approach is flawed because the WordPress REST API allows users to override the HTTP method via the `_method` parameter, bypassing intended access controls based on HTTP method. Additionally, there are logic issues with decoding HTML entities within already sanitized HTML content.

**Weaknesses/vulnerabilities present:**
- Unauthenticated Stored XSS.
- Insecure handling of REST API routes by relying on string matching on `$_SERVER['REQUEST_URI']` and `$_SERVER['REQUEST_METHOD']`.
- Lack of proper input sanitization and output encoding of user-provided data.
- Bypassing access controls using the `_method` parameter in the REST API.
- Logic errors in decoding HTML entities

**Impact of exploitation:**
Successful exploitation allows unauthenticated attackers to inject malicious HTML/JavaScript code into the website, leading to:
- Arbitrary actions being performed by a logged-in administrator they target.
- Installation of arbitrary plugins.
- Creation of new rogue administrator users.

**Attack vectors:**
-  The vulnerability is exploited through the plugin's REST API.
- The attacker sends a crafted POST request with the `_method` parameter set to 'get' and an XSS payload in the `address` field.
- By accessing a vulnerable marker, the malicious code can be executed.

**Required attacker capabilities/position:**
- The attacker does not need to be authenticated.
-  The attacker needs to be able to send HTTP requests to the vulnerable WordPress site.
- The attacker needs to know the vulnerable endpoint (e.g., `/wp-json/wpgmzA/v1/markers?_method=get&random=/wpgmza/v1/markers/{marker_id}`) and be able to craft the malicious payload.