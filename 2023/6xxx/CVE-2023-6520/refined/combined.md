=== Content from plugins.trac.wordpress.org_65b4fc8a_20250115_084329.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3009922%2540wp-2fa%26old%3D3009922%2540wp-2fa)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3000342/wp-2fa "Changeset 3000342 for wp-2fa")
* [Next Change](/changeset/3009923/wp-2fa "Changeset 3009923 for wp-2fa") →

---

# Changeset [3009922](/changeset/3009922 "Show full changeset") for [wp-2fa](/browser/wp-2fa?rev=3009922 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/14/2023 10:25:58 AM
([13 months](/timeline?from=2023-12-14T10%3A25%3A58Z&precision=second "See timeline at 12/14/2023 10:25:58 AM") ago)

Author:
WPWhiteSecurity
Message:

Uploading 2.6.0

Location:
[wp-2fa/trunk](/browser/wp-2fa/trunk?rev=3009922)
Files:

9 added
1 deleted
58 edited

* [dist/css/admin-style.css](/browser/wp-2fa/trunk/dist/css/admin-style.css?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [dist/css/setup-wizard.css](/browser/wp-2fa/trunk/dist/css/setup-wizard.css?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [dist/css/styles.css](/browser/wp-2fa/trunk/dist/css/styles.css?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [dist/images/c4wp.jpg](/browser/wp-2fa/trunk/dist/images/c4wp.jpg?rev=3009922 "Show entry in browser")
  (modified)
  ([previous](/browser/wp-2fa/trunk/dist/images/c4wp.jpg?rev=2717010 "Show previous version in browser"))
* [dist/images/login-security.jpeg](/browser/wp-2fa/trunk/dist/images/login-security.jpeg?rev=3009922 "Show entry in browser")
  (added)
* [dist/images/wizard-logo.png](/browser/wp-2fa/trunk/dist/images/wizard-logo.png?rev=3009922 "Show entry in browser")
  (modified)
  ([previous](/browser/wp-2fa/trunk/dist/images/wizard-logo.png?rev=2717010 "Show previous version in browser"))
* [dist/images/wp-activity-log.jpeg](/browser/wp-2fa/trunk/dist/images/wp-activity-log.jpeg?rev=3009922 "Show entry in browser")
  (added)
* [dist/js/admin.js](/browser/wp-2fa/trunk/dist/js/admin.js?rev=3009922 "Show entry in browser")
  (modified)
  ([3 diffs](#file7 "Show differences"))
* [dist/js/micromodal.js](/browser/wp-2fa/trunk/dist/js/micromodal.js?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [dist/js/multi-site-select.js](/browser/wp-2fa/trunk/dist/js/multi-site-select.js?rev=2717010 "Show what was removed (content at revision 3009921)")
  (deleted)
* [dist/js/wp-2fa.js](/browser/wp-2fa/trunk/dist/js/wp-2fa.js?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [includes/classes/Admin/Controllers/class-methods.php](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=3009922 "Show entry in browser")
  (modified)
  ([3 diffs](#file11 "Show differences"))
* [includes/classes/Admin/Controllers/class-settings.php](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-settings.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [includes/classes/Admin/Helpers/class-ajax-helper.php](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-ajax-helper.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/Helpers/class-file-writer.php](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922 "Show entry in browser")
  (modified)
  ([7 diffs](#file14 "Show differences"))
* [includes/classes/Admin/Helpers/class-methods-helper.php](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-methods-helper.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/Helpers/class-php-helper.php](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-php-helper.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file16 "Show differences"))
* [includes/classes/Admin/Helpers/class-user-helper.php](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922 "Show entry in browser")
  (modified)
  ([18 diffs](#file17 "Show differences"))
* [includes/classes/Admin/Helpers/class-wp-helper.php](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-wp-helper.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file18 "Show differences"))
* [includes/classes/Admin/Methods/Traits/class-login-attempts.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-login-attempts.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [includes/classes/Admin/Methods/Traits/class-methods-wizards-trait.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-methods-wizards-trait.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/Methods/class-backup-codes.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922 "Show entry in browser")
  (modified)
  ([17 diffs](#file21 "Show differences"))
* [includes/classes/Admin/Methods/class-email-wizard-steps.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-email-wizard-steps.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/Methods/class-email.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-email.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/Methods/class-totp-wizard-steps.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-totp-wizard-steps.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/Methods/class-totp.php](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-totp.php?rev=3009922 "Show entry in browser")
  (added)
* [includes/classes/Admin/SettingsPages/class-settings-page-email.php](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922 "Show entry in browser")
  (modified)
  ([14 diffs](#file26 "Show differences"))
* [includes/classes/Admin/SettingsPages/class-settings-page-general.php](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922 "Show entry in browser")
  (modified)
  ([6 diffs](#file27 "Show differences"))
* [includes/classes/Admin/SettingsPages/class-settings-page-policies.php](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922 "Show entry in browser")
  (modified)
  ([16 diffs](#file28 "Show differences"))
* [includes/classes/Admin/SettingsPages/class-settings-page-render.php](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-render.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file29 "Show differences"))
* [includes/classes/Admin/SettingsPages/class-settings-page-white-label.php](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922 "Show entry in browser")
  (modified)
  ([13 diffs](#file30 "Show differences"))
* [includes/classes/Admin/Views/class-first-time-wizard-steps.php](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922 "Show entry in browser")
  (modified)
  ([9 diffs](#file31 "Show differences"))
* [includes/classes/Admin/Views/class-passord-reset-2fa.php](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file32 "Show differences"))
* [includes/classes/Admin/Views/class-wizard-steps.php](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922 "Show entry in browser")
  (modified)
  ([15 diffs](#file33 "Show differences"))
* [includes/classes/Admin/class-help-contact-us.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=3009922 "Show entry in browser")
  (modified)
  ([4 diffs](#file34 "Show differences"))
* [includes/classes/Admin/class-premium-features.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=3009922 "Show entry in browser")
  (modified)
  ([3 diffs](#file35 "Show differences"))
* [includes/classes/Admin/class-settings-page.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922 "Show entry in browser")
  (modified)
  ([11 diffs](#file36 "Show differences"))
* [includes/classes/Admin/class-setup-wizard.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922 "Show entry in browser")
  (modified)
  ([14 diffs](#file37 "Show differences"))
* [includes/classes/Admin/class-user-notices.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-notices.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file38 "Show differences"))
* [includes/classes/Admin/class-user-profile.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922 "Show entry in browser")
  (modified)
  ([18 diffs](#file39 "Show differences"))
* [includes/classes/App/grace-period/class-grace-period.php](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=3009922 "Show entry in browser")
  (modified)
  ([3 diffs](#file40 "Show differences"))
* [includes/classes/Authenticator/class-authentication.php](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922 "Show entry in browser")
  (modified)
  ([6 diffs](#file41 "Show differences"))
* [includes/classes/Authenticator/class-login.php](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922 "Show entry in browser")
  (modified)
  ([23 diffs](#file42 "Show differences"))
* [includes/classes/Authenticator/class-open-ssl.php](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-open-ssl.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file43 "Show differences"))
* [includes/classes/Authenticator/class-reset-passord.php](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=3009922 "Show entry in browser")
  (modified)
  ([3 diffs](#file44 "Show differences"))
* [includes/classes/Shortcodes/class-shortcodes.php](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=3009922 "Show entry in browser")
  (modified)
  ([3 diffs](#file45 "Show differences"))
* [includes/classes/Utils/class-abstract-migration.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=3009922 "Show entry in browser")
  (modified)
  ([4 diffs](#file46 "Show differences"))
* [includes/classes/Utils/class-date-time-utils.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-date-time-utils.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file47 "Show differences"))
* [includes/classes/Utils/class-debugging.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-debugging.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file48 "Show differences"))
* [includes/classes/Utils/class-generate-modal.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file49 "Show differences"))
* [includes/classes/Utils/class-migration.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-migration.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file50 "Show differences"))
* [includes/classes/Utils/class-request-utils.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-request-utils.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file51 "Show differences"))
* [includes/classes/Utils/class-settings-utils.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file52 "Show differences"))
* [includes/classes/Utils/class-user-utils.php](/browser/wp-2fa/trunk/includes/classes/Utils/class-user-utils.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file53 "Show differences"))
* [includes/classes/class-wp2fa.php](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922 "Show entry in browser")
  (modified)
  ([24 diffs](#file54 "Show differences"))
* [includes/functions/core.php](/browser/wp-2fa/trunk/includes/functions/core.php?rev=3009922 "Show entry in browser")
  (modified)
  ([5 diffs](#file55 "Show differences"))
* [languages/wp-2fa.pot](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922 "Show entry in browser")
  (modified)
  ([30 diffs](#file56 "Show differences"))
* [license.txt](/browser/wp-2fa/trunk/license.txt?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file57 "Show differences"))
* [readme.txt](/browser/wp-2fa/trunk/readme.txt?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file58 "Show differences"))
* [vendor/autoload.php](/browser/wp-2fa/trunk/vendor/autoload.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file59 "Show differences"))
* [vendor/composer/ClassLoader.php](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922 "Show entry in browser")
  (modified)
  ([24 diffs](#file60 "Show differences"))
* [vendor/composer/InstalledVersions.php](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=3009922 "Show entry in browser")
  (modified)
  ([4 diffs](#file61 "Show differences"))
* [vendor/composer/autoload\_classmap.php](/browser/wp-2fa/trunk/vendor/composer/autoload_classmap.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file62 "Show differences"))
* [vendor/composer/autoload\_real.php](/browser/wp-2fa/trunk/vendor/composer/autoload_real.php?rev=3009922 "Show entry in browser")
  (modified)
  ([2 diffs](#file63 "Show differences"))
* [vendor/composer/autoload\_static.php](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=3009922 "Show entry in browser")
  (modified)
  ([4 diffs](#file64 "Show differences"))
* [vendor/composer/installed.json](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=3009922 "Show entry in browser")
  (modified)
  ([5 diffs](#file65 "Show differences"))
* [vendor/composer/installed.php](/browser/wp-2fa/trunk/vendor/composer/installed.php?rev=3009922 "Show entry in browser")
  (modified)
  ([1 diff](#file66 "Show differences"))
* [wp-2fa.php](/browser/wp-2fa/trunk/wp-2fa.php?rev=3009922 "Show entry in browser")
  (modified)
  ([4 diffs](#file67 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-2fa/trunk/dist/css/admin-style.css](/changeset/3009922/wp-2fa/trunk/dist/css/admin-style.css "Show the changeset 3009922 restricted to wp-2fa/trunk/dist/css/admin-style.css")

  | [r2940688](/browser/wp-2fa/trunk/dist/css/admin-style.css?rev=2940688#L1 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/dist/css/admin-style.css?rev=3009922#L1 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | @charset "UTF-8"; |
  | 2 |  | #excluded\_users\_buttons,#excluded\_roles\_buttons,#enforced\_roles\_buttons,#enforced\_users\_buttons,#excluded\_sites\_buttons{display:inline}.wp2fa-setup-content #excluded\_users\_buttons,.wp2fa-setup-content #excluded\_roles\_buttons{display:block;margin-top:20px}.user-btn{position:relative;margin-left:10px !important}.user-btn .remove-item{background:red;height:14px;width:14px;position:absolute;color:#fff;border-radius:7px;line-height:11px;text-align:center;font-size:10px;display:block;right:-7px;top:-5px}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp-2fa-settings-wrapper{max-width:~~970px}.wp-2fa-settings-wrapper h2{margin:3px 0 0}.wp-2fa-settings-wrapper .method-title em{font-style:normal;font-weight:500;position:relative;top:6px}.wp-2fa-settings-wrapper p.description{font-size:13px}.wp-2fa-settings-wrapper:not(.setup-wizard-wrapper) .description fieldset label+label{padding-left:10px !important}label.disabled{opacity:0.5;cursor:default}.button.has-spinner{padding-right:0 !important}.notice-after-button{margin-left:0px !important;padding:5px 10px !important;clear:left;display:block}input.error{border-color:#dc3232;background:#ffebee}.wp-2fa-user-profile-form .button{margin-right:5px}.wp-submenu a[href="wp-2fa-setup"]{display:none !important}@media (min-width:1200px){.min-input-width{min-width:360px}}.wp2fa-form-styles .select2-selection--multiple{min-height:36px;height:auto;overflow-y:auto}.wp2fa-form-styles .select2-container--default .select2-selection--multiple .select2-selection\_\_choice{background-color:#e4e4e4;border:1px solid #aaa;border-radius:4px;cursor:default;float:left;margin-right:5px;margin-top:4px;margin-bottom:0px;padding:0 5px}.wp2fa-form-styles .select2-container .select2-search--inline{float:left;height:15px}.wp2fa-form-styles .select2-container--default .select2-search--inline .select2-search\_\_field{height:13px;margin-top:0px}.wp2fa-form-styles .select2-container--default .select2-selection--multiple{padding-top:3px}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary{color:#555 !important}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary:hover{color:#fff !important}#exclusion\_settings\_wrapper.disabled{height:0;overflow:hidden}#notify-admin-settings-page{text-align:justify}.wp2fa-quota-exceeded-notice .button{margin-right:3px}.method-wrapper{margin-bottom:3px;border-bottom:1px solid #c3c4c7;padding-bottom:20px}.certain-users-only-inputs{margin-bottom:15px}a[href\*="wp-2fa-premium-features"]{color:#ADFF2F !important}.wp-2fa-nag br{display:none}#wp-2fa-side-banner{background:#fff;padding:24px 4px;border:1px solid #bbb;position:fixed;width:280px;right:40px;bottom:40px;text-align:center}#wp-2fa-side-banner p{font-size:16px;font-weight:700}#wp-2fa-side-banner ul{margin-bottom:20px;padding:0 15px}#wp-2fa-side-banner li{padding-left:25px;overflow:hidden;position:relative;margin-bottom:10px;text-align:left}#wp-2fa-side-banner a.link{position:relative;top:5px;margin-left:15px}#wp-2fa-side-banner .dashicons{position:absolute;left:0;color:#5084a4}@media (max-width:1320px){.wp-2fa-settings-wrapper{max-width:580px}}@media (max-width:1040px){#wp-2fa-side-banner{display:none}}@media (min-width:1040px){.ui-dialog{min-width:355px}}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.wp2fa-modal{font-family:helvetica}.modal\_\_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;justify-content:center;align-items:center;z-index:9999}.modal\_\_container{background-color:#fff;padding:40px 40px 30px;max-width:500px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box;z-index:1500}.modal\_\_header{display:flex;justify-content:space-between;align-items:center}.modal\_\_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#222;box-sizing:border-box}.modal\_\_close{border:0;outline:none;z-index:10}.modal\_\_close:hover{cursor:pointer}.modal\_\_header .modal\_\_close:before,.wp2fa-modal .modal\_\_close:before{content:"✕"}.modal\_\_content{font-size:13px;font-weight:500;height:100%;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content p{font-size:13px;font-weight:500;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content label{font-size:14px;line-height:28px;color:#222;margin-top:0;word-break:keep-all;width:100%;display:block}.modal\_\_content p.description{font-size:12px;line-height:24px;opacity:0.9}.modal\_\_content .apps-wrapper{position:relative;overflow:hidden;display:flex}.modal\_\_content .apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.modal\_\_content .apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}.modal\_\_content .wp2fa-setup-actions{clear:both}.modal\_\_content .iti--allow-dropdown{width:100%}.modal\_\_btn-primary{background-color:#00449e;color:#fff}.enable\_styling .modal\_\_content input[type="radio"]{margin-left:0;appearance:auto;width:auto;height:auto;background:transparent}.enable\_styling .modal\_\_content input[type="radio"]:after{display:none}.enable\_styling .modal\_\_content input[type="radio"]:focus{border-color:transparent;box-shadow:none;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):not(.app-key){line-height:1;margin-bottom:10px;min-height:2pc;min-width:15pc;padding:5px;margin:0px;border:none;border-bottom:3px solid #d0e5ff;width:100%;padding:10px 0;font-size:16px;font-weight:700;color:#4498ff;box-shadow:none}.enable\_styling .modal\_\_content input:not([type="radio"]):focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):-internal-autofill-selected{background-color:transparent}.enable\_styling .iti--allow-dropdown input[type=tel]{z-index:100;background:transparent}.enable\_styling .iti\_\_flag-container{width:auto;z-index:101}.enable\_styling .expand-panel .iti\_\_flag-container{width:100%}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .modal\_\_overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .modal\_\_container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .modal\_\_container,.micromodal-slide .modal\_\_overlay{will-change:transform}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp2fa-modal .modal\_\_container{max-height:70vh;max-width:872px;min-width:30vw;position:relative}.wp2fa-modal .modal\_\_close{background:transparent;color:#4498ff !important;font-size:15px;font-weight:700;position:absolute;right:20px;text-decoration:none;top:20px;background-color:transparent !important}.wp2fa-modal .modal\_\_close :hover{color:#888;cursor:pointer}.wp2fa-modal input[type=radio]:checked:before{display:none}.wizard-step:not(.active),.step-setting-wrapper:not(.active){display:none}.wizard-step.active,.step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}#configure-2fa .wp2fa-setup-actions,#configure-2fa-backup-codes .wp2fa-setup-actions{margin-top:25px}.modal\_\_btn+.modal\_\_btn{margin-left:10px}.wp-2fa-configuration-form td.backup-methods-label,.wp-2fa-configuration-form th{display:none}.wp2fa-modal h4,.wp2fa-modal h3{word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}.wp2fa-modal.enable\_styling h4,.wp2fa-modal.enable\_styling h3{font-family:helvetica !important}.wp2fa-modal fieldset{padding:0;border:0}.wp2fa-modal ol{margin:0 0 15px;padding-left:17px}.wp2fa-modal ol li{position:relative;padding:6px}.wp2fa-modal .modal\_\_content code.app-key{font-size:16px;padding:7px 12px;word-break:break-all;background:#efefef;color:#222}label+.verification-response{margin-top:20px}.verification-response:not(:empty){border:3px solid red;font-size:9pt;margin-bottom:15px;padding:10px;background:#ffe4e4;border-radius:10px;font-size:9pt;line-height:24px;width:100%}.default\_styling .verification-response:not(:empty){width:calc(100% - 30px)}.wp-2fa-configuration-form .button.enable\_styling{background-color:#fff !important;color:#3e6bff !important;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff !important;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px}.wp-2fa-configuration-form .button.enable\_styling:hover{background-color:#3e6bff !important;color:#fff !important;border:3px solid #3e6bff !important}.wp2fa-modal.enable\_styling .modal\_\_content .wp2fa-setup-actions .button:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-confirm:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-decline:focus{box-shadow:none}.wp2fa-modal.enable\_styling .button+.button{margin-left:10px}.modal\_\_footer{margin-top:20px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary,.enable\_styling #wizard-api-key button,.enable\_styling #wizard-sid-key button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;transition:all 0.2s ease-in-out}.enable\_styling .wp-2fa-button-secondary{color:#555;border:3px solid #555}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary{color:#555 !important;border:3px solid #555 !important}.enable\_styling .wp-2fa-button-primary:focus,.enable\_styling .wp-2fa-button-secondary:focus{box-shadow:none}.enable\_styling .wp-2fa-button-primary:hover{background-color:#3e6bff;color:#fff;border:3px solid #3e6bff;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-button-secondary:hover{background-color:#555;color:#fff;border:3px solid #555;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary:hover,.enable\_styling #wizard-api-key button:hover,.enable\_styling #wizard-sid-key button:hover{background-color:#555 !important;color:#fff !important;border:3px solid #555 !important}.wp-2fa-configuration-form .button{margin-right:10px}.wp-2fa-configuration-form .button:hover{cursor:pointer}.qr-code-wrapper{position:relative;overflow:hidden;float:right}#notify-users .modal\_\_container \*{opacity:1;transition:all 0.3s ease-in-out}#notify-users .modal\_\_container.saving \*{opacity:0;transition:all 0.3s ease-in-out}.qr-code-wrapper.regenerating img{visibility:hidden}#backup-codes-wrapper{border:none;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;background-color:transparent !important}#backup-codes-wrapper :focus-visible{outline:none}#backup-codes-wrapper:focus-visible{outline:none}.qr-code-wrapper.regenerating:before,#notify-users .modal\_\_container.saving:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner 0.6s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.default\_styling .radio-cells .option-pill{position:relative;margin-bottom:11px}.default\_styling .radio-cells .option-pill label{padding-right:40px;font-size:12px}.default\_styling .wizard-tooltip{display:none !important}.default\_styling input[type=checkbox],.default\_styling input[type=radio]{-webkit-appearance:auto}@media screen and (max-width:1299px){.wp2fa-modal .modal\_\_container{max-width:96vw}#wp-2fa-totp-qrcode{max-width:100%;text-align:center;margin:15px auto;display:block}.qr-code-wrapper{float:none}.step-setting-wrapper br{display:none}.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.enable\_styling .radio-cells .option-pill p{height:100%}.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.enable\_styling .option-pill{margin-bottom:15px}.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .modal\_\_content code br{display:block !important}.wp2fa-modal .modal\_\_content code.app-key{width:100%;display:block;text-align:center;font-size:16px;margin-bottom:30px;background:#efefef;padding:5px;word-break:break-all}.wp2fa-modal .modal\_\_content .apps-wrapper{margin:10px 0}.wp2fa-modal .modal\_\_content a.app-logo{padding:0 5px}.wp2fa-modal .modal\_\_content .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .modal\_\_content .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal .modal\_\_content .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .modal\_\_content .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .modal\_\_content .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .modal\_\_content .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus-visible,.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp-2fa-configuration-form .button{width:auto;display:block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.modal\_\_content input:not([type="radio"]){width:100%;margin-bottom:10px}.hide-on-mobile{display:none}.wp2fa-modal h4,.wp2fa-modal h3{font-size:20px}.wp2fa-modal h4{clear:both}}@media screen and (min-width:1300px){.wp2fa-modal .clear-both{clear:both;display:block;overflow:hidden}.wp2fa-modal .modal-50{width:50%;display:inline-block;float:left}.wp2fa-modal .modal-60{width:70%;display:inline-block;float:left}.wp2fa-modal .modal-60 .radio-cells{width:100%;padding-left:10px}.wp2fa-modal .modal-40{width:30%;float:left;display:flex;justify-content:center}.wp2fa-modal .mb-20{margin-bottom:20px}.wp2fa-modal.enable\_styling p+.radio-cells,.wp2fa-modal.enable\_styling p+fieldset{margin:20px 0;display:flex;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.wp2fa-modal.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{height:100%}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.wp2fa-modal.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.wp2fa-modal.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.wp2fa-modal .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .app-key-wrapper input:focus-visible,.wp2fa-modal .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp2fa-modal .option-pill{margin-bottom:15px}.wp2fa-modal .qr-code{float:left;width:100%;position:relative;left:-2%}.wp2fa-modal .mb-30{margin-bottom:30px}.show-on-mobile{display:none}}@media (max-width:500px){.modal\_\_container{padding:25px}.option-pill:not(last-of-type){margin-bottom:40px}.wp2fa-modal .modal\_\_content .apps-wrapper{display:block}.wp2fa-modal .modal\_\_content a.app-logo{width:calc(33.33333% - 13px);display:inline-block;margin-bottom:5px}.wp2fa-modal h4,.wp2fa-modal h3{font-size:18px;margin-bottom:9px}#configure-2fa-backup-codes .wp2fa-setup-actions,#configure-2fa .wp2fa-setup-actions{margin-top:15px}.wp2fa-modal .modal\_\_content .modal\_\_btn,.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp-2fa-configuration-form .button{display:block;margin-bottom:10px;margin-left:0;margin-right:0;text-align:center;width:auto;padding:10px 15px;font-size:12px}.wp2fa-modal .modal\_\_content .radio-cells .option-pill{flex-basis:unset;flex-grow:1}.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}}@media screen and (min-width:801px) and (max-width:1299px){.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}.modal-50{width:50%;display:inline-block;float:left}.mb-20{margin-bottom:20px}.modal-60{width:70%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.modal-40{width:30%;float:left;display:flex;justify-content:center}}@media screen and (min-width:1024px){.wp2fa-modal .modal\_\_container{min-width:768px}}@media screen and (min-width:501px) and (max-width:800px){.modal-50{width:50%;display:inline-block;float:left}.modal-60{width:60%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.mb-20{margin-bottom:20px}.modal-40{width:40%;float:left;display:flex;justify-content:center}}@media screen and (max-width:800px){.wp2fa-modal .modal\_\_container{max-width:95vw;min-width:80vw}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_close{right:15px;top:15px}}@media screen and (max-width:500px){.mb-20{margin-bottom:15px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{max-width:200px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary{display:block !important;margin-left:0 !important;margin-right:0;width:100% !important}.wp2fa-modal .modal\_\_content .wizard-tooltip{right:5px;bottom:5px}.verification-response:not(:empty){width:auto}}.wizard-custom-counter{counter-reset:step-counter;list-style:none;margin-bottom:0 !important}.wizard-custom-counter li{counter-increment:step-counter}.wizard-custom-counter li:last-of-type{margin-bottom:0 !important}.enable\_styling .wizard-custom-counter li::before{content:counter(step-counter);background:#3e6bff;width:20px;height:20px;color:white;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.enable\_styling #backup-codes-wrapper{border:none;border-bottom:3px solid #d0e5ff;color:#4498ff;font-size:1pc;font-weight:700;line-height:1;margin:0;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;line-height:26px;background-color:transparent !important}.enable\_styling #backup-codes-wrapper :focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling #backup-codes-wrapper:focus-visible{border-bottom:3px solid #4498ff;outline:none}.default\_styling .wizard-custom-counter li::before{content:counter(step-counter);width:20px;height:20px;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.mb-0{margin-bottom:0 !important}.wp-2fa-user-profile-form{margin:20px~~ 0}body:not(.wp-admin) .wp-2fa-user-profile-form td,body:not(.wp-admin) .wp-2fa-user-profile-form th{padding:0;border:none}.wp-2fa-user-profile-form{border:none}.wp-2fa-button-primary+.wp-2fa-button-secondary{margin-left:10px}.modal-logo-wrapper{text-align:center;padding:0;margin:0}.iti\_\_flag-container{width:100%}.iti\_\_country-list{width:100%}.wizard-step label[for="authy-token"]{min-height:70px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel label[for="authy-token"]{min-height:300px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel .authy-step-setting-wrapper{overflow:hidden}.wizard-step.expand-panel .iti\_\_country-list{width:100%;max-height:240px}[aria-describedby="authy-diag"],[aria-describedby="twilio-diag"]{min-width:400px;padding:10px}[aria-describedby="authy-diag"] .ui-dialog-titlebar,[aria-describedby="twilio-diag"] .ui-dialog-titlebar{background:#fff;border-bottom:none;height:auto;font-size:18px;font-weight:600;line-height:2;padding:10px 36px 0 16px;word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}[aria-describedby="authy-diag"] .ui-dialog-buttonpane,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane{background:#fff;border-top:none;padding:16px}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;height:auto;margin-left:0}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button:hover,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button:hover{background-color:#3e6bff;color:#fff}[aria-describedby="authy-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset{float:left}[aria-describedby="authy-diag"] .ui-dialog-content,[aria-describedby="twilio-diag"] .ui-dialog-content{padding:0 16px 9px;overflow:auto}.our-wordpress-plugins{width:100%;max-width:250px;padding:0 20px;box-sizing:border-box;background:#ffffff}.our-wordpress-plugins h3{font-size:17px;line-height:28px;color:#23282D;font-weight:500;margin:0;padding:15px 4px 0px;text-align:center}.our-wordpress-plugins ul{list-style:none;margin:0;padding:20px 0 0;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.our-wordpress-plugins ul li{width:100%;margin-bottom:20px}.our-wordpress-plugins ul li .plugin-box{width:100%;background:#F7F7F7;border:1px solid #D9D9D9}.our-wordpress-plugins ul li .plugin-box .plugin-img img{width:100%;display:block}.our-wordpress-plugins h4{font-size:16px;line-height:19px;color:#23282D;font-weight:600;margin:0;padding-bottom:10px}.plugin-desc{padding:20px 15px;font-size:14px;line-height:22px;font-weight:400;color:#23282D;text-align:center;border-top:1px solid #D9D9D9}.plugin-desc p{margin:0 0 15px 0}.cta-btn a{font-size:14px;line-height:24px;color:#fff;font-weight:700;background:#2B597A;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;display:inline-block;text-decoration:none;padding:5px 15px}.our-wordpress-plugins.full{width:100%;max-width:880px}.our-wordpress-plugins.full ul{margin-left:-15px;margin-right:-15px}.our-wordpress-plugins.full ul li{width:25%;padding:0 10px;box-sizing:border-box}.our-wordpress-plugins.full ul li .plugin-box{height:100%}.our-wordpress-plugins.side-bar{margin-bottom:30px;width:30%;padding:0 20px;box-sizing:border-box;background:#ffffff}.wp2fa-help-section{display:-ms-flexbox;display:flex;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-ms-flex-wrap:wrap;flex-wrap:wrap;justify-content:flex-end;padding-bottom:20px;max-width:1170px}.wp2fa-help-section.nav-tabs{display:-ms-flexbox;display:flex;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-ms-flex-wrap:wrap;flex-wrap:wrap;justify-content:flex-end;padding-bottom:20px;max-width:1170px}.wp2fa-help-main{width:60%;padding:10px 20px}.wp2fa-logo{text-align:center}.wp2fa-logo img{width:100%;max-width:350px}.wp2fa-about p{word-break:break-all}.title h2{font-size:23px;font-weight:400;margin:0;padding:9px 0;line-height:29px}#system-info-textarea{font-family:monospace;white-space:pre;overflow:auto;width:100%;height:400px;margin:0}@media (max-width:991px){.our-wordpress-plugins.full ul li{width:100%;max-width:255px;margin:0 auto;margin-bottom:20px}}@media (max-width:767px){.wp2fa-help-main{width:100%;padding-top:40px}.our-wordpress-plugins.side-bar{width:100%;max-width:100%;margin:0 auto}.wp2fa-help-section.nav-tabs{padding-top:30px}.our-wordpress-plugins ul{margin-right:-15px;margin-left:-15px}.our-wordpress-plugins ul li{width:33.33%;padding:0 15px;box-sizing:border-box}.our-wordpress-plugins ul li .plugin-box{height:100%}}@media (max-width:580px){.our-wordpress-plugins ul li{width:50%;margin:0 auto;margin-bottom:30px}}@media (max-width:400px){.our-wordpress-plugins ul li{width:100%;margin:0 auto;margin-bottom:30px}} |
  |  | 2 | #excluded\_users\_buttons,#excluded\_roles\_buttons,#enforced\_roles\_buttons,#enforced\_users\_buttons,#excluded\_sites\_buttons{display:inline}.wp2fa-setup-content #excluded\_users\_buttons,.wp2fa-setup-content #excluded\_roles\_buttons{display:block;margin-top:20px}.user-btn{position:relative;margin-left:10px !important}.user-btn .remove-item{background:red;height:14px;width:14px;position:absolute;color:#fff;border-radius:7px;line-height:11px;text-align:center;font-size:10px;display:block;right:-7px;top:-5px}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp-2fa-settings-wrapper{max-width:1010px}.wp-2fa-settings-wrapper h2{margin:3px 0 0}.wp-2fa-settings-wrapper .method-title em{font-style:normal;font-weight:500;position:relative;top:6px}.wp-2fa-settings-wrapper p.description{font-size:13px}.wp-2fa-settings-wrapper:not(.setup-wizard-wrapper) .description fieldset label+label{padding-left:10px !important}label.disabled{opacity:0.5;cursor:default}.button.has-spinner{padding-right:0 !important}.notice-after-button{margin-left:0px !important;padding:5px 10px !important;clear:left;display:block}input.error{border-color:#dc3232;background:#ffebee}.wp-2fa-user-profile-form .button{margin-right:5px}.wp-submenu a[href="wp-2fa-setup"]{display:none !important}@media (min-width:1200px){.min-input-width{min-width:360px}}.wp2fa-form-styles .select2-selection--multiple{min-height:36px;height:auto;overflow-y:auto}.wp2fa-form-styles .select2-container--default .select2-selection--multiple .select2-selection\_\_choice{background-color:#e4e4e4;border:1px solid #aaa;border-radius:4px;cursor:default;float:left;margin-right:5px;margin-top:4px;margin-bottom:0px;padding:0 5px}.wp2fa-form-styles .select2-container .select2-search--inline{float:left;height:15px}.wp2fa-form-styles .select2-container--default .select2-search--inline .select2-search\_\_field{height:13px;margin-top:0px}.wp2fa-form-styles .select2-container--default .select2-selection--multiple{padding-top:3px}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary{color:#555 !important}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary:hover{color:#fff !important}#exclusion\_settings\_wrapper.disabled{height:0;overflow:hidden}#notify-admin-settings-page{text-align:justify}.wp2fa-quota-exceeded-notice .button{margin-right:3px}.method-wrapper{margin-bottom:3px;border-bottom:1px solid #c3c4c7;padding-bottom:20px}.certain-users-only-inputs{margin-bottom:15px}a[href\*="wp-2fa-premium-features"]{color:#ADFF2F !important}.wp-2fa-nag br{display:none}#wp-2fa-side-banner{background:#fff;padding:24px 4px;border:1px solid #bbb;position:fixed;width:280px;right:40px;bottom:40px;text-align:center}#wp-2fa-side-banner p{font-size:16px;font-weight:700}#wp-2fa-side-banner ul{margin-bottom:20px;padding:0 15px}#wp-2fa-side-banner li{padding-left:25px;overflow:hidden;position:relative;margin-bottom:10px;text-align:left}#wp-2fa-side-banner a.link{position:relative;top:5px;margin-left:15px}#wp-2fa-side-banner .dashicons{position:absolute;left:0;color:#4776ff}#wp-2fa-side-banner .button-primary{background:#4776ff;border-color:#4776ff;color:#fff;text-decoration:none;text-shadow:none}@media (max-width:1320px){.wp-2fa-settings-wrapper{max-width:580px}}@media (max-width:1040px){#wp-2fa-side-banner{display:none}}@media (min-width:1040px){.ui-dialog{min-width:355px}}.wp-2fa-user-profile-form .qr-btn,.wp-2fa-user-profile-form .click-to-copy{text-decoration:none;font-size:13px;line-height:2.15384615;min-height:30px;margin:0;padding:0 10px;cursor:pointer;border-width:1px;border-style:solid;-webkit-appearance:none;border-radius:3px;white-space:nowrap;box-sizing:border-box;background:#2271b1;border-color:#2271b1;color:#fff;text-decoration:none;text-shadow:none;display:list-item;width:140px}.wp-2fa-user-profile-form .qr-btn:hover,.wp-2fa-user-profile-form .click-to-copy:hover{background:#135e96;border-color:#135e96;color:#fff}.wp-2fa-user-profile-form #app-key-input{min-width:320px}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.wp2fa-modal{font-family:helvetica}.modal\_\_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;justify-content:center;align-items:center;z-index:9999}.modal\_\_container{background-color:#fff;padding:40px 40px 30px;max-width:500px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box;z-index:1500}.modal\_\_header{display:flex;justify-content:space-between;align-items:center}.modal\_\_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#222;box-sizing:border-box}.modal\_\_close{border:0;outline:none;z-index:10}.modal\_\_close:hover{cursor:pointer}.modal\_\_header .modal\_\_close:before,.wp2fa-modal .modal\_\_close:before{content:"✕"}.modal\_\_content{font-size:13px;font-weight:500;height:100%;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content p{font-size:13px;font-weight:500;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content label{font-size:14px;line-height:28px;color:#222;margin-top:0;word-break:keep-all;width:100%;display:block}.modal\_\_content p.description{font-size:12px;line-height:24px;opacity:0.9}.modal\_\_content .apps-wrapper{position:relative;overflow:hidden;display:flex}.modal\_\_content .apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.modal\_\_content .apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}.modal\_\_content .wp2fa-setup-actions{clear:both}.modal\_\_content .iti--allow-dropdown{width:100%}.modal\_\_btn-primary{background-color:#00449e;color:#fff}.enable\_styling .modal\_\_content input[type="radio"]{margin-left:0;appearance:auto;width:auto;height:auto;background:transparent}.enable\_styling .modal\_\_content input[type="radio"]:after{display:none}.enable\_styling .modal\_\_content input[type="radio"]:focus{border-color:transparent;box-shadow:none;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):not(.app-key){line-height:1;margin-bottom:10px;min-height:2pc;min-width:15pc;padding:5px;margin:0px;border:none;border-bottom:3px solid #d0e5ff;width:100%;padding:10px 0;font-size:16px;font-weight:700;color:#4498ff;box-shadow:none}.enable\_styling .modal\_\_content input:not([type="radio"]):focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):-internal-autofill-selected{background-color:transparent}.enable\_styling .iti--allow-dropdown input[type=tel]{z-index:100;background:transparent}.enable\_styling .iti\_\_flag-container{width:auto;z-index:101}.enable\_styling .expand-panel .iti\_\_flag-container{width:100%}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .modal\_\_overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .modal\_\_container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .modal\_\_container,.micromodal-slide .modal\_\_overlay{will-change:transform}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp2fa-modal .modal\_\_container{max-height:70vh;max-width:872px;min-width:30vw;position:relative}.wp2fa-modal .modal\_\_close{background:transparent;color:#4498ff !important;font-size:15px;font-weight:700;position:absolute;right:20px;text-decoration:none;top:20px;background-color:transparent !important}.wp2fa-modal .modal\_\_close :hover{color:#888;cursor:pointer}.wp2fa-modal input[type=radio]:checked:before{display:none}.wizard-step:not(.active),.step-setting-wrapper:not(.active){display:none}.wizard-step.active,.step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}#configure-2fa .wp2fa-setup-actions,#configure-2fa-backup-codes .wp2fa-setup-actions{margin-top:25px}.modal\_\_btn+.modal\_\_btn{margin-left:10px}.wp-2fa-configuration-form td.backup-methods-label,.wp-2fa-configuration-form th{display:none}.wp2fa-modal h4,.wp2fa-modal h3{word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}.wp2fa-modal.enable\_styling h4,.wp2fa-modal.enable\_styling h3{font-family:helvetica !important}.wp2fa-modal fieldset{padding:0;border:0}.wp2fa-modal ol{margin:0 0 15px;padding-left:17px}.wp2fa-modal ol li{position:relative;padding:6px}.wp2fa-modal .modal\_\_content code.app-key{font-size:16px;padding:7px 12px;word-break:break-all;background:#efefef;color:#222}label+.verification-response{margin-top:20px}.verification-response:not(:empty){border:3px solid red;font-size:9pt;margin-bottom:15px;padding:10px;background:#ffe4e4;border-radius:10px;font-size:9pt;line-height:24px;width:100%}.default\_styling .verification-response:not(:empty){width:calc(100% - 30px)}.wp-2fa-configuration-form .button.enable\_styling{background-color:#fff !important;color:#3e6bff !important;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff !important;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px}.wp-2fa-configuration-form .button.enable\_styling:hover{background-color:#3e6bff !important;color:#fff !important;border:3px solid #3e6bff !important}.wp2fa-modal.enable\_styling .modal\_\_content .wp2fa-setup-actions .button:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-confirm:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-decline:focus{box-shadow:none}.wp2fa-modal.enable\_styling .button+.button{margin-left:10px}.modal\_\_footer{margin-top:20px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary,.enable\_styling #wizard-api-key button,.enable\_styling #wizard-sid-key button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;transition:all 0.2s ease-in-out}.enable\_styling .wp-2fa-button-secondary{color:#555;border:3px solid #555}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary{color:#555 !important;border:3px solid #555 !important}.enable\_styling .wp-2fa-button-primary:focus,.enable\_styling .wp-2fa-button-secondary:focus{box-shadow:none}.enable\_styling .wp-2fa-button-primary:hover{background-color:#3e6bff;color:#fff;border:3px solid #3e6bff;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-button-secondary:hover{background-color:#555;color:#fff;border:3px solid #555;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary:hover,.enable\_styling #wizard-api-key button:hover,.enable\_styling #wizard-sid-key button:hover{background-color:#555 !important;color:#fff !important;border:3px solid #555 !important}.wp-2fa-configuration-form .button{margin-right:10px}.wp-2fa-configuration-form .button:hover{cursor:pointer}.qr-code-wrapper{position:relative;overflow:hidden;float:right}#notify-users .modal\_\_container \*{opacity:1;transition:all 0.3s ease-in-out}#notify-users .modal\_\_container.saving \*{opacity:0;transition:all 0.3s ease-in-out}.qr-code-wrapper.regenerating img{visibility:hidden}#backup-codes-wrapper{border:none;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;background-color:transparent !important}#backup-codes-wrapper :focus-visible{outline:none}#backup-codes-wrapper:focus-visible{outline:none}.qr-code-wrapper.regenerating:before,#notify-users .modal\_\_container.saving:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner 0.6s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.default\_styling .radio-cells .option-pill{position:relative;margin-bottom:11px}.default\_styling .radio-cells .option-pill label{padding-right:40px;font-size:12px}.default\_styling .wizard-tooltip{display:none !important}.default\_styling input[type=checkbox],.default\_styling input[type=radio]{-webkit-appearance:auto}@media screen and (max-width:1299px){.wp2fa-modal .modal\_\_container{max-width:96vw}#wp-2fa-totp-qrcode{max-width:100%;text-align:center;margin:15px auto;display:block}.qr-code-wrapper{float:none}.step-setting-wrapper br{display:none}.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.enable\_styling .radio-cells .option-pill p{height:100%}.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.enable\_styling .option-pill{margin-bottom:15px}.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .modal\_\_content code br{display:block !important}.wp2fa-modal .modal\_\_content code.app-key{width:100%;display:block;text-align:center;font-size:16px;margin-bottom:30px;background:#efefef;padding:5px;word-break:break-all}.wp2fa-modal .modal\_\_content .apps-wrapper{margin:10px 0}.wp2fa-modal .modal\_\_content a.app-logo{padding:0 5px}.wp2fa-modal .modal\_\_content .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .modal\_\_content .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal .modal\_\_content .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .modal\_\_content .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .modal\_\_content .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .modal\_\_content .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus-visible,.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp-2fa-configuration-form .button{width:auto;display:block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.modal\_\_content input:not([type="radio"]){width:100%;margin-bottom:10px}.hide-on-mobile{display:none}.wp2fa-modal h4,.wp2fa-modal h3{font-size:20px}.wp2fa-modal h4{clear:both}}@media screen and (min-width:1300px){.wp2fa-modal .clear-both{clear:both;display:block;overflow:hidden}.wp2fa-modal .modal-50{width:50%;display:inline-block;float:left}.wp2fa-modal .modal-60{width:70%;display:inline-block;float:left}.wp2fa-modal .modal-60 .radio-cells{width:100%;padding-left:10px}.wp2fa-modal .modal-40{width:30%;float:left;display:flex;justify-content:center}.wp2fa-modal .mb-20{margin-bottom:20px}.wp2fa-modal.enable\_styling p+.radio-cells,.wp2fa-modal.enable\_styling p+fieldset{margin:20px 0;display:flex;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.wp2fa-modal.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{height:100%}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.wp2fa-modal.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.wp2fa-modal.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.wp2fa-modal .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .app-key-wrapper input:focus-visible,.wp2fa-modal .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp2fa-modal .option-pill{margin-bottom:15px}.wp2fa-modal .qr-code{float:left;width:100%;position:relative;left:-2%}.wp2fa-modal .mb-30{margin-bottom:30px}.show-on-mobile{display:none}}@media (max-width:500px){.modal\_\_container{padding:25px}.option-pill:not(last-of-type){margin-bottom:40px}.wp2fa-modal .modal\_\_content .apps-wrapper{display:block}.wp2fa-modal .modal\_\_content a.app-logo{width:calc(33.33333% - 13px);display:inline-block;margin-bottom:5px}.wp2fa-modal h4,.wp2fa-modal h3{font-size:18px;margin-bottom:9px}#configure-2fa-backup-codes .wp2fa-setup-actions,#configure-2fa .wp2fa-setup-actions{margin-top:15px}.wp2fa-modal .modal\_\_content .modal\_\_btn,.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp-2fa-configuration-form .button{display:block;margin-bottom:10px;margin-left:0;margin-right:0;text-align:center;width:auto;padding:10px 15px;font-size:12px}.wp2fa-modal .modal\_\_content .radio-cells .option-pill{flex-basis:unset;flex-grow:1}.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}}@media screen and (min-width:801px) and (max-width:1299px){.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}.modal-50{width:50%;display:inline-block;float:left}.mb-20{margin-bottom:20px}.modal-60{width:70%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.modal-40{width:30%;float:left;display:flex;justify-content:center}}@media screen and (min-width:1024px){.wp2fa-modal .modal\_\_container{min-width:768px}}@media screen and (min-width:501px) and (max-width:800px){.modal-50{width:50%;display:inline-block;float:left}.modal-60{width:60%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.mb-20{margin-bottom:20px}.modal-40{width:40%;float:left;display:flex;justify-content:center}}@media screen and (max-width:800px){.wp2fa-modal .modal\_\_container{max-width:95vw;min-width:80vw}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_close{right:15px;top:15px}}@media screen and (max-width:500px){.mb-20{margin-bottom:15px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{max-width:200px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary{display:block !important;margin-left:0 !important;margin-right:0;width:100% !important}.wp2fa-modal .modal\_\_content .wizard-tooltip{right:5px;bottom:5px}.verification-response:not(:empty){width:auto}}.wizard-custom-counter{counter-reset:step-counter;list-style:none;margin-bottom:0 !important}.wizard-custom-counter li{counter-increment:step-counter}.wizard-custom-counter li:last-of-type{margin-bottom:0 !important}.enable\_styling .wizard-custom-counter li::before{content:counter(step-counter);background:#3e6bff;width:20px;height:20px;color:white;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.enable\_styling #backup-codes-wrapper{border:none;border-bottom:3px solid #d0e5ff;color:#4498ff;font-size:1pc;font-weight:700;line-height:1;margin:0;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;line-height:26px;background-color:transparent !important}.enable\_styling #backup-codes-wrapper :focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling #backup-codes-wrapper:focus-visible{border-bottom:3px solid #4498ff;outline:none}.default\_styling .wizard-custom-counter li::before{content:counter(step-counter);width:20px;height:20px;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.mb-0{margin-bottom:0 !important}.wp-2fa-user-profile-form{margin:0}.wp-2fa-user-profile-form:first-of-type{margin-top:20px}.wp-2fa-user-profile-form:last-of-type{margin-bottom:20px}.wp-2fa-user-profile-form tr+tr th,.wp-2fa-user-profile-form tr+tr td{padding-top:0}.remove-tr-padding th,.remove-tr-padding td{padding-bottom:0}body:not(.wp-admin) .wp-2fa-user-profile-form td,body:not(.wp-admin) .wp-2fa-user-profile-form th{padding:0;border:none}.wp-2fa-user-profile-form{border:none}.wp-2fa-button-primary+.wp-2fa-button-secondary{margin-left:10px}.modal-logo-wrapper{text-align:center;padding:0;margin:0}.iti\_\_flag-container{width:100%}.iti\_\_country-list{width:100%}.wizard-step label[for="authy-token"]{min-height:70px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel label[for="authy-token"]{min-height:300px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel .authy-step-setting-wrapper{overflow:hidden}.wizard-step.expand-panel .iti\_\_country-list{width:100%;max-height:240px}[aria-describedby="authy-diag"],[aria-describedby="twilio-diag"]{min-width:400px;padding:10px}[aria-describedby="authy-diag"] .ui-dialog-titlebar,[aria-describedby="twilio-diag"] .ui-dialog-titlebar{background:#fff;border-bottom:none;height:auto;font-size:18px;font-weight:600;line-height:2;padding:10px 36px 0 16px;word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}[aria-describedby="authy-diag"] .ui-dialog-buttonpane,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane{background:#fff;border-top:none;padding:16px}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;height:auto;margin-left:0}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button:hover,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button:hover{background-color:#3e6bff;color:#fff}[aria-describedby="authy-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset{float:left}[aria-describedby="authy-diag"] .ui-dialog-content,[aria-describedby="twilio-diag"] .ui-dialog-content{padding:0 16px 9px;overflow:auto}.our-wordpress-plugins{width:100%;max-width:250px;padding:0 20px;box-sizing:border-box;background:#ffffff}.our-wordpress-plugins h3{font-size:17px;line-height:28px;color:#23282D;font-weight:500;margin:0;padding:15px 4px 0px;text-align:center}.our-wordpress-plugins ul{list-style:none;margin:0;padding:20px 0 0;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.our-wordpress-plugins ul li{width:100%;margin-bottom:20px}.our-wordpress-plugins ul li .plugin-box{width:100%;background:#F7F7F7;border:1px solid #D9D9D9}.our-wordpress-plugins ul li .plugin-box .plugin-img img{width:100%;display:block}.our-wordpress-plugins h4{font-size:16px;line-height:19px;color:#23282D;font-weight:600;margin:0;padding-bottom:10px}.plugin-desc{padding:20px 15px;font-size:14px;line-height:22px;font-weight:400;color:#23282D;text-align:center;border-top:1px solid #D9D9D9}.plugin-desc p{margin:0 0 15px 0}.cta-btn a{font-size:14px;line-height:24px;color:#fff;font-weight:700;background:#2B597A;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;display:inline-block;text-decoration:none;padding:5px 15px}.our-wordpress-plugins.full{width:100%;max-width:880px}.our-wordpress-plugins.full ul{margin-left:-15px;margin-right:-15px}.our-wordpress-plugins.full ul li{width:25%;padding:0 10px;box-sizing:border-box}.our-wordpress-plugins.full ul li .plugin-box{height:100%}.our-wordpress-plugins.side-bar{margin-bottom:30px;width:30%;padding:0 20px;box-sizing:border-box;background:#ffffff}.wp2fa-help-section{display:-ms-flexbox;display:flex;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-ms-flex-wrap:wrap;flex-wrap:wrap;justify-content:flex-end;padding-bottom:20px;max-width:1170px}.wp2fa-help-section.nav-tabs{display:-ms-flexbox;display:flex;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-ms-flex-wrap:wrap;flex-wrap:wrap;justify-content:flex-end;padding-bottom:20px;max-width:1170px}.wp2fa-help-main{width:60%;padding:10px 20px}.wp2fa-logo{text-align:center}.wp2fa-logo img{width:100%;max-width:350px}.wp2fa-about p{word-break:break-all}.title h2{font-size:23px;font-weight:400;margin:0;padding:9px 0;line-height:29px}#system-info-textarea{font-family:monospace;white-space:pre;overflow:auto;width:100%;height:400px;margin:0}@media (max-width:991px){.our-wordpress-plugins.full ul li{width:100%;max-width:255px;margin:0 auto;margin-bottom:20px}}@media (max-width:767px){.wp2fa-help-main{width:100%;padding-top:40px}.our-wordpress-plugins.side-bar{width:100%;max-width:100%;margin:0 auto}.wp2fa-help-section.nav-tabs{padding-top:30px}.our-wordpress-plugins ul{margin-right:-15px;margin-left:-15px}.our-wordpress-plugins ul li{width:33.33%;padding:0 15px;box-sizing:border-box}.our-wordpress-plugins ul li .plugin-box{height:100%}}@media (max-width:580px){.our-wordpress-plugins ul li{width:50%;margin:0 auto;margin-bottom:30px}}@media (max-width:400px){.our-wordpress-plugins ul li{width:100%;margin:0 auto;margin-bottom:30px}} |
* ## [wp-2fa/trunk/dist/css/setup-wizard.css](/changeset/3009922/wp-2fa/trunk/dist/css/setup-wizard.css "Show the changeset 3009922 restricted to wp-2fa/trunk/dist/css/setup-wizard.css")

  | [r2940688](/browser/wp-2fa/trunk/dist/css/setup-wizard.css?rev=2940688#L1 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/dist/css/setup-wizard.css?rev=3009922#L1 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | @charset "UTF-8"; |
  | 2 |  | #excluded\_users\_buttons,#excluded\_roles\_buttons,#enforced\_roles\_buttons,#enforced\_users\_buttons,#excluded\_sites\_buttons{display:inline}.wp2fa-setup-content #excluded\_users\_buttons,.wp2fa-setup-content #excluded\_roles\_buttons{display:block;margin-top:20px}.user-btn{position:relative;margin-left:10px !important}.user-btn .remove-item{background:red;height:14px;width:14px;position:absolute;color:#fff;border-radius:7px;line-height:11px;text-align:center;font-size:10px;display:block;right:-7px;top:-5px}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp-2fa-settings-wrapper{max-width:~~970px}.wp-2fa-settings-wrapper h2{margin:3px 0 0}.wp-2fa-settings-wrapper .method-title em{font-style:normal;font-weight:500;position:relative;top:6px}.wp-2fa-settings-wrapper p.description{font-size:13px}.wp-2fa-settings-wrapper:not(.setup-wizard-wrapper) .description fieldset label+label{padding-left:10px !important}label.disabled{opacity:0.5;cursor:default}.button.has-spinner{padding-right:0 !important}.notice-after-button{margin-left:0px !important;padding:5px 10px !important;clear:left;display:block}input.error{border-color:#dc3232;background:#ffebee}.wp-2fa-user-profile-form .button{margin-right:5px}.wp-submenu a[href="wp-2fa-setup"]{display:none !important}@media (min-width:1200px){.min-input-width{min-width:360px}}.wp2fa-form-styles .select2-selection--multiple{min-height:36px;height:auto;overflow-y:auto}.wp2fa-form-styles .select2-container--default .select2-selection--multiple .select2-selection\_\_choice{background-color:#e4e4e4;border:1px solid #aaa;border-radius:4px;cursor:default;float:left;margin-right:5px;margin-top:4px;margin-bottom:0px;padding:0 5px}.wp2fa-form-styles .select2-container .select2-search--inline{float:left;height:15px}.wp2fa-form-styles .select2-container--default .select2-search--inline .select2-search\_\_field{height:13px;margin-top:0px}.wp2fa-form-styles .select2-container--default .select2-selection--multiple{padding-top:3px}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary{color:#555 !important}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary:hover{color:#fff !important}#exclusion\_settings\_wrapper.disabled{height:0;overflow:hidden}#notify-admin-settings-page{text-align:justify}.wp2fa-quota-exceeded-notice .button{margin-right:3px}.method-wrapper{margin-bottom:3px;border-bottom:1px solid #c3c4c7;padding-bottom:20px}.certain-users-only-inputs{margin-bottom:15px}a[href\*="wp-2fa-premium-features"]{color:#ADFF2F !important}.wp-2fa-nag br{display:none}#wp-2fa-side-banner{background:#fff;padding:24px 4px;border:1px solid #bbb;position:fixed;width:280px;right:40px;bottom:40px;text-align:center}#wp-2fa-side-banner p{font-size:16px;font-weight:700}#wp-2fa-side-banner ul{margin-bottom:20px;padding:0 15px}#wp-2fa-side-banner li{padding-left:25px;overflow:hidden;position:relative;margin-bottom:10px;text-align:left}#wp-2fa-side-banner a.link{position:relative;top:5px;margin-left:15px}#wp-2fa-side-banner .dashicons{position:absolute;left:0;color:#5084a4}@media (max-width:1320px){.wp-2fa-settings-wrapper{max-width:580px}}@media (max-width:1040px){#wp-2fa-side-banner{display:none}}@media (min-width:1040px){.ui-dialog{min-width:355px}}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.wp2fa-modal{font-family:helvetica}.modal\_\_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;justify-content:center;align-items:center;z-index:9999}.modal\_\_container{background-color:#fff;padding:40px 40px 30px;max-width:500px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box;z-index:1500}.modal\_\_header{display:flex;justify-content:space-between;align-items:center}.modal\_\_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#222;box-sizing:border-box}.modal\_\_close{border:0;outline:none;z-index:10}.modal\_\_close:hover{cursor:pointer}.modal\_\_header .modal\_\_close:before,.wp2fa-modal .modal\_\_close:before{content:"✕"}.modal\_\_content{font-size:13px;font-weight:500;height:100%;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content p{font-size:13px;font-weight:500;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content label{font-size:14px;line-height:28px;color:#222;margin-top:0;word-break:keep-all;width:100%;display:block}.modal\_\_content p.description{font-size:12px;line-height:24px;opacity:0.9}.modal\_\_content .apps-wrapper{position:relative;overflow:hidden;display:flex}.modal\_\_content .apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.modal\_\_content .apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}.modal\_\_content .wp2fa-setup-actions{clear:both}.modal\_\_content .iti--allow-dropdown{width:100%}.modal\_\_btn-primary{background-color:#00449e;color:#fff}.enable\_styling .modal\_\_content input[type="radio"]{margin-left:0;appearance:auto;width:auto;height:auto;background:transparent}.enable\_styling .modal\_\_content input[type="radio"]:after{display:none}.enable\_styling .modal\_\_content input[type="radio"]:focus{border-color:transparent;box-shadow:none;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):not(.app-key){line-height:1;margin-bottom:10px;min-height:2pc;min-width:15pc;padding:5px;margin:0px;border:none;border-bottom:3px solid #d0e5ff;width:100%;padding:10px 0;font-size:16px;font-weight:700;color:#4498ff;box-shadow:none}.enable\_styling .modal\_\_content input:not([type="radio"]):focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):-internal-autofill-selected{background-color:transparent}.enable\_styling .iti--allow-dropdown input[type=tel]{z-index:100;background:transparent}.enable\_styling .iti\_\_flag-container{width:auto;z-index:101}.enable\_styling .expand-panel .iti\_\_flag-container{width:100%}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .modal\_\_overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .modal\_\_container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .modal\_\_container,.micromodal-slide .modal\_\_overlay{will-change:transform}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp2fa-modal .modal\_\_container{max-height:70vh;max-width:872px;min-width:30vw;position:relative}.wp2fa-modal .modal\_\_close{background:transparent;color:#4498ff !important;font-size:15px;font-weight:700;position:absolute;right:20px;text-decoration:none;top:20px;background-color:transparent !important}.wp2fa-modal .modal\_\_close :hover{color:#888;cursor:pointer}.wp2fa-modal input[type=radio]:checked:before{display:none}.wizard-step:not(.active),.step-setting-wrapper:not(.active){display:none}.wizard-step.active,.step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}#configure-2fa .wp2fa-setup-actions,#configure-2fa-backup-codes .wp2fa-setup-actions{margin-top:25px}.modal\_\_btn+.modal\_\_btn{margin-left:10px}.wp-2fa-configuration-form td.backup-methods-label,.wp-2fa-configuration-form th{display:none}.wp2fa-modal h4,.wp2fa-modal h3{word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}.wp2fa-modal.enable\_styling h4,.wp2fa-modal.enable\_styling h3{font-family:helvetica !important}.wp2fa-modal fieldset{padding:0;border:0}.wp2fa-modal ol{margin:0 0 15px;padding-left:17px}.wp2fa-modal ol li{position:relative;padding:6px}.wp2fa-modal .modal\_\_content code.app-key{font-size:16px;padding:7px 12px;word-break:break-all;background:#efefef;color:#222}label+.verification-response{margin-top:20px}.verification-response:not(:empty){border:3px solid red;font-size:9pt;margin-bottom:15px;padding:10px;background:#ffe4e4;border-radius:10px;font-size:9pt;line-height:24px;width:100%}.default\_styling .verification-response:not(:empty){width:calc(100% - 30px)}.wp-2fa-configuration-form .button.enable\_styling{background-color:#fff !important;color:#3e6bff !important;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff !important;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px}.wp-2fa-configuration-form .button.enable\_styling:hover{background-color:#3e6bff !important;color:#fff !important;border:3px solid #3e6bff !important}.wp2fa-modal.enable\_styling .modal\_\_content .wp2fa-setup-actions .button:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-confirm:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-decline:focus{box-shadow:none}.wp2fa-modal.enable\_styling .button+.button{margin-left:10px}.modal\_\_footer{margin-top:20px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary,.enable\_styling #wizard-api-key button,.enable\_styling #wizard-sid-key button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;transition:all 0.2s ease-in-out}.enable\_styling .wp-2fa-button-secondary{color:#555;border:3px solid #555}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary{color:#555 !important;border:3px solid #555 !important}.enable\_styling .wp-2fa-button-primary:focus,.enable\_styling .wp-2fa-button-secondary:focus{box-shadow:none}.enable\_styling .wp-2fa-button-primary:hover{background-color:#3e6bff;color:#fff;border:3px solid #3e6bff;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-button-secondary:hover{background-color:#555;color:#fff;border:3px solid #555;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary:hover,.enable\_styling #wizard-api-key button:hover,.enable\_styling #wizard-sid-key button:hover{background-color:#555 !important;color:#fff !important;border:3px solid #555 !important}.wp-2fa-configuration-form .button{margin-right:10px}.wp-2fa-configuration-form .button:hover{cursor:pointer}.qr-code-wrapper{position:relative;overflow:hidden;float:right}#notify-users .modal\_\_container \*{opacity:1;transition:all 0.3s ease-in-out}#notify-users .modal\_\_container.saving \*{opacity:0;transition:all 0.3s ease-in-out}.qr-code-wrapper.regenerating img{visibility:hidden}#backup-codes-wrapper{border:none;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;background-color:transparent !important}#backup-codes-wrapper :focus-visible{outline:none}#backup-codes-wrapper:focus-visible{outline:none}.qr-code-wrapper.regenerating:before,#notify-users .modal\_\_container.saving:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner 0.6s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.default\_styling .radio-cells .option-pill{position:relative;margin-bottom:11px}.default\_styling .radio-cells .option-pill label{padding-right:40px;font-size:12px}.default\_styling .wizard-tooltip{display:none !important}.default\_styling input[type=checkbox],.default\_styling input[type=radio]{-webkit-appearance:auto}@media screen and (max-width:1299px){.wp2fa-modal .modal\_\_container{max-width:96vw}#wp-2fa-totp-qrcode{max-width:100%;text-align:center;margin:15px auto;display:block}.qr-code-wrapper{float:none}.step-setting-wrapper br{display:none}.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.enable\_styling .radio-cells .option-pill p{height:100%}.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.enable\_styling .option-pill{margin-bottom:15px}.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .modal\_\_content code br{display:block !important}.wp2fa-modal .modal\_\_content code.app-key{width:100%;display:block;text-align:center;font-size:16px;margin-bottom:30px;background:#efefef;padding:5px;word-break:break-all}.wp2fa-modal .modal\_\_content .apps-wrapper{margin:10px 0}.wp2fa-modal .modal\_\_content a.app-logo{padding:0 5px}.wp2fa-modal .modal\_\_content .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .modal\_\_content .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal .modal\_\_content .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .modal\_\_content .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .modal\_\_content .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .modal\_\_content .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus-visible,.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp-2fa-configuration-form .button{width:auto;display:block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.modal\_\_content input:not([type="radio"]){width:100%;margin-bottom:10px}.hide-on-mobile{display:none}.wp2fa-modal h4,.wp2fa-modal h3{font-size:20px}.wp2fa-modal h4{clear:both}}@media screen and (min-width:1300px){.wp2fa-modal .clear-both{clear:both;display:block;overflow:hidden}.wp2fa-modal .modal-50{width:50%;display:inline-block;float:left}.wp2fa-modal .modal-60{width:70%;display:inline-block;float:left}.wp2fa-modal .modal-60 .radio-cells{width:100%;padding-left:10px}.wp2fa-modal .modal-40{width:30%;float:left;display:flex;justify-content:center}.wp2fa-modal .mb-20{margin-bottom:20px}.wp2fa-modal.enable\_styling p+.radio-cells,.wp2fa-modal.enable\_styling p+fieldset{margin:20px 0;display:flex;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.wp2fa-modal.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{height:100%}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.wp2fa-modal.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.wp2fa-modal.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.wp2fa-modal .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .app-key-wrapper input:focus-visible,.wp2fa-modal .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp2fa-modal .option-pill{margin-bottom:15px}.wp2fa-modal .qr-code{float:left;width:100%;position:relative;left:-2%}.wp2fa-modal .mb-30{margin-bottom:30px}.show-on-mobile{display:none}}@media (max-width:500px){.modal\_\_container{padding:25px}.option-pill:not(last-of-type){margin-bottom:40px}.wp2fa-modal .modal\_\_content .apps-wrapper{display:block}.wp2fa-modal .modal\_\_content a.app-logo{width:calc(33.33333% - 13px);display:inline-block;margin-bottom:5px}.wp2fa-modal h4,.wp2fa-modal h3{font-size:18px;margin-bottom:9px}#configure-2fa-backup-codes .wp2fa-setup-actions,#configure-2fa .wp2fa-setup-actions{margin-top:15px}.wp2fa-modal .modal\_\_content .modal\_\_btn,.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp-2fa-configuration-form .button{display:block;margin-bottom:10px;margin-left:0;margin-right:0;text-align:center;width:auto;padding:10px 15px;font-size:12px}.wp2fa-modal .modal\_\_content .radio-cells .option-pill{flex-basis:unset;flex-grow:1}.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}}@media screen and (min-width:801px) and (max-width:1299px){.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}.modal-50{width:50%;display:inline-block;float:left}.mb-20{margin-bottom:20px}.modal-60{width:70%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.modal-40{width:30%;float:left;display:flex;justify-content:center}}@media screen and (min-width:1024px){.wp2fa-modal .modal\_\_container{min-width:768px}}@media screen and (min-width:501px) and (max-width:800px){.modal-50{width:50%;display:inline-block;float:left}.modal-60{width:60%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.mb-20{margin-bottom:20px}.modal-40{width:40%;float:left;display:flex;justify-content:center}}@media screen and (max-width:800px){.wp2fa-modal .modal\_\_container{max-width:95vw;min-width:80vw}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_close{right:15px;top:15px}}@media screen and (max-width:500px){.mb-20{margin-bottom:15px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{max-width:200px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary{display:block !important;margin-left:0 !important;margin-right:0;width:100% !important}.wp2fa-modal .modal\_\_content .wizard-tooltip{right:5px;bottom:5px}.verification-response:not(:empty){width:auto}}.wizard-custom-counter{counter-reset:step-counter;list-style:none;margin-bottom:0 !important}.wizard-custom-counter li{counter-increment:step-counter}.wizard-custom-counter li:last-of-type{margin-bottom:0 !important}.enable\_styling .wizard-custom-counter li::before{content:counter(step-counter);background:#3e6bff;width:20px;height:20px;color:white;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.enable\_styling #backup-codes-wrapper{border:none;border-bottom:3px solid #d0e5ff;color:#4498ff;font-size:1pc;font-weight:700;line-height:1;margin:0;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;line-height:26px;background-color:transparent !important}.enable\_styling #backup-codes-wrapper :focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling #backup-codes-wrapper:focus-visible{border-bottom:3px solid #4498ff;outline:none}.default\_styling .wizard-custom-counter li::before{content:counter(step-counter);width:20px;height:20px;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.mb-0{margin-bottom:0 !important}.wp-2fa-user-profile-form{margin:20px~~ 0}body:not(.wp-admin) .wp-2fa-user-profile-form td,body:not(.wp-admin) .wp-2fa-user-profile-form th{padding:0;border:none}.wp-2fa-user-profile-form{border:none}.wp-2fa-button-primary+.wp-2fa-button-secondary{margin-left:10px}.modal-logo-wrapper{text-align:center;padding:0;margin:0}.iti\_\_flag-container{width:100%}.iti\_\_country-list{width:100%}.wizard-step label[for="authy-token"]{min-height:70px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel label[for="authy-token"]{min-height:300px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel .authy-step-setting-wrapper{overflow:hidden}.wizard-step.expand-panel .iti\_\_country-list{width:100%;max-height:240px}[aria-describedby="authy-diag"],[aria-describedby="twilio-diag"]{min-width:400px;padding:10px}[aria-describedby="authy-diag"] .ui-dialog-titlebar,[aria-describedby="twilio-diag"] .ui-dialog-titlebar{background:#fff;border-bottom:none;height:auto;font-size:18px;font-weight:600;line-height:2;padding:10px 36px 0 16px;word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}[aria-describedby="authy-diag"] .ui-dialog-buttonpane,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane{background:#fff;border-top:none;padding:16px}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;height:auto;margin-left:0}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button:hover,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button:hover{background-color:#3e6bff;color:#fff}[aria-describedby="authy-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset{float:left}[aria-describedby="authy-diag"] .ui-dialog-content,[aria-describedby="twilio-diag"] .ui-dialog-content{padding:0 16px 9px;overflow:auto}body{min-height:100vh}a{color:#0073aa}a:hover,a:active{color:#00a0d2}a:focus{color:#124964;box-shadow:0 0 0 1px #5b9dd9, 0 0 2px 1px rgba(30, 140, 190, 0.8)}.ie8 a:focus{outline:#5b9dd9 solid 1px}h1,h2{border-bottom:1px solid #ddd;clear:both;color:#666;font-size:24px;padding:0;padding-bottom:7px;font-weight:400}h3{font-size:16px}p,li,dd,dt{padding-bottom:2px;color:#222;font-size:13px;line-height:24px}code,.code{font-family:Consolas, Monaco, monospace}ul,ol,dl{padding:5px 5px 5px 22px}a img{border:0}abbr{border:0;font-variant:normal}fieldset{border:0;padding:0;margin:0}label{cursor:pointer}#logo{margin:6px 0 14px 0;padding:0 0 7px 0;border-bottom:none;text-align:center}#logo a{background-image:url(../images/w-logo-blue.png?ver=20131202);background-image:none, url(../images/wordpress-logo.svg?ver=20131107);background-size:84px;background-position:center top;background-repeat:no-repeat;color:#444;height:84px;font-size:20px;font-weight:400;line-height:1.3;margin:-130px auto 25px;padding:0;text-decoration:none;width:84px;text-indent:-9999px;outline:none;overflow:hidden;display:block}.step{margin:20px 0 15px;text-align:left;padding:0}th{text-align:left;padding:0}.language-chooser.wp-core-ui .step .button.button-large{height:36px;font-size:14px;line-height:2.35714285;vertical-align:middle}textarea{border:1px solid #ddd;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;width:100%;box-sizing:border-box}.form-table{border-collapse:collapse;margin-top:1em;width:100%}.form-table td{margin-bottom:9px;padding:10px 20px 10px 0;font-size:14px;vertical-align:top}.form-table th{font-size:14px;text-align:left;padding:10px 20px 10px 0;width:140px;vertical-align:top}.form-table code{line-height:1.28571428;font-size:14px}.form-table p{margin:4px 0 0 0;font-size:11px}.form-table input{line-height:1.33333333;font-size:15px;padding:3px 5px;border:1px solid #ddd;box-shadow:inset 0 1px 2px rgba(0, 0, 0, 0.07)}input,submit{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif}.form-table input[type=text],.form-table input[type=email],.form-table input[type=url],.form-table input[type=password]{width:218px}#pass-strength-result{width:218px}.form-table th p{font-weight:400}.form-table.install-success th{vertical-align:middle;padding:16px 20px 16px 0}.form-table.install-success td{vertical-align:middle;padding:16px 20px 16px 0}.form-table.install-success td p{margin:0;font-size:14px}.form-table.install-success td code{margin:0;font-size:18px}#error-page{margin-top:50px}#error-page p{font-size:14px;line-height:1.28571428;margin:25px 0 20px}#error-page code{font-family:Consolas, Monaco, monospace}.code{font-family:Consolas, Monaco, monospace}.message{border-left:4px solid #dc3232;padding:0.7em 0.6em;background-color:#fbeaea}#dbname,#uname,#pwd,#dbhost,#prefix,#user\_login,#admin\_email,#pass1,#pass2{direction:ltr}body.rtl{font-family:Tahoma, sans-serif}.rtl textarea,.rtl input,.rtl submit{font-family:Tahoma, sans-serif}:lang(he-il) body.rtl{font-family:Arial, sans-serif}:lang(he-il) .rtl textarea,:lang(he-il) .rtl input,:lang(he-il) .rtl submit{font-family:Arial, sans-serif}@media only screen and (max-width:799px){body{margin-top:115px}#logo a{margin:-125px auto 30px}}@media screen and (max-width:782px){.form-table{margin-top:0}.form-table th,.form-table td{display:block;width:auto;vertical-align:middle}.form-table th{padding:20px 0 0}.form-table td{padding:5px 0;border:0;margin:0}textarea,input{font-size:16px}.form-table td input[type="text"],.form-table td input[type="email"],.form-table td input[type="url"],.form-table td input[type="password"]{width:100%;font-size:16px;line-height:1.5;padding:7px 10px;display:block;max-width:none;box-sizing:border-box}.form-table td select,.form-table td textarea{width:100%;font-size:16px;line-height:1.5;padding:7px 10px;display:block;max-width:none;box-sizing:border-box}.form-table span.description{width:100%;font-size:16px;line-height:1.5;padding:7px 10px;display:block;max-width:none;box-sizing:border-box}.wp-pwd #pass1{padding-right:50px}.wp-pwd .button.wp-hide-pw{right:0}#pass-strength-result{width:100%}}body.language-chooser{max-width:300px}.language-chooser select{padding:8px;width:100%;display:block;border:1px solid #ddd;background:#fff;color:#32373c;font-size:16px;font-family:Arial, sans-serif;font-weight:400}.language-chooser select:focus{color:#32373c}.language-chooser select option:hover,.language-chooser select option:focus{color:#016087}.language-chooser p{text-align:right}.screen-reader-input,.screen-reader-text{border:0;clip:rect(1px, 1px, 1px, 1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal !important}.spinner{background:url(../images/spinner.gif) no-repeat;background-size:20px 20px;visibility:hidden;opacity:0.7;filter:alpha(opacity=70);width:20px;height:20px;margin:2px 5px 0}.step .spinner{display:inline-block;vertical-align:middle;margin-right:15px}.button.hide-if-no-js,.hide-if-no-js{display:none}@media print,(-webkit-min-device-pixel-ratio:1.25),(min-resolution:120dpi){.spinner{background-image:url(../images/spinner-2x.gif)}}body{-webkit-box-shadow:none;box-shadow:none;background:#F8F9FB;padding:0}#wp2fa-logo{border:0;margin:0 0 24px;padding:0;text-align:center}#wp2fa-logo a{color:#3e6bff;text-decoration:none;font-weight:700;font-size:28px;margin-bottom:35px;display:block}#wp2fa-logo img{width:auto;max-width:80px;position:relative;left:-10px}.steps{display:-ms-flexbox;display:flex;list-style-type:none;margin:0;padding:0 0 25px;text-align:center}.steps li{-ms-flex:1 0 auto;flex:1 0 auto;font-weight:700;margin:0 0 5px;color:#b4b9be;padding-bottom:15px;position:relative}.steps li.is-active{color:#3e6bff}.steps li.is-active::before{border:4px solid #3e6bff;background:#3e6bff}.steps li::before{content:"";border:4px solid #b4b9be;border-radius:100%;width:4px;height:4px;position:absolute;bottom:0;left:50%;margin-left:-6px;margin-bottom:-8px;background:#b4b9be}.wp2fa-setup-content{-webkit-box-shadow:0 1px 3px rgba(0, 0, 0, 0.13);box-shadow:0 1px 3px rgba(0, 0, 0, 0.13);padding:30px 40px;margin:0 0 20px;background:#fff;overflow:hidden;zoom:1;border-radius:10px}.wp2fa-setup-content h3{font-size:24px;text-align:center;margin-bottom:30px;margin-top:5px;line-height:36px}.wp2fa-setup-content a{color:#3e6bff !important;text-decoration:none !important}.wp2fa-setup-content h4,.wp2fa-setup-content fieldset{line-height:1.5}.wp2fa-setup-actions{text-align:center;margin:40px auto 10px}.wp2fa-setup-actions .button,.wp2fa-setup-actions .button[data-check-authy-2fa]{background-color:#fff;border:3px solid #3e6bff;border-radius:30px;color:#3e6bff;display:inline-block;font-size:14px;font-weight:800;letter-spacing:0.3px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.wp2fa-setup-actions .button-primary{font-weight:700}.wp2fa-setup-actions .button-secondary{font-weight:700;background-color:#fff;border:2px solid #555;color:#555}.wp2fa-setup-actions .button-secondary:hover,.wp2fa-setup-actions .button-secondary:focus{background:#555;border-color:#555;-webkit-box-shadow:none;box-shadow:none;color:#fff}.wp2fa-setup-actions .button-primary:hover,.wp2fa-setup-actions .button-primary:focus{background:#3e6bff;border-color:#3e6bff;-webkit-box-shadow:none;box-shadow:none;color:#fff !important}.wp2fa-setup-footer{text-align:center}.wp2fa-setup-footer a{color:#3e6bff;font-size:14px;text-decoration:none}.wp2fa-setup-form label[for="editor-users-box"],.wp2fa-setup-form label[for="editor-roles-box"],.wp2fa-setup-form label[for="exuser-query-box"],.wp2fa-setup-form label[for="exrole-query-box"],.wp2fa-setup-form label[for="ipaddr-query-box"]{display:inline-block;margin:5px 0}.wp2fa-setup-form label[for="editor-users-box"] span,.wp2fa-setup-form label[for="editor-roles-box"] span,.wp2fa-setup-form label[for="exuser-query-box"] span,.wp2fa-setup-form label[for="exrole-query-box"] span,.wp2fa-setup-form label[for="ipaddr-query-box"] span{display:inline-block;min-width:100px}.sectoken-user,.sectoken-role,.sectoken-ip,.sectoken-other{display:inline-block;border-width:1px;border-style:solid;padding:2px 4px;margin:2px 0 0 2px;border-radius:3px;cursor:default;line-height:1.3;font-size:14px}.sectoken-user a,.sectoken-role a,.sectoken-ip a,.sectoken-other a{text-decoration:none;font-size:12px;font-weight:bold;color:#FFF;margin-left:2px;background:#BBB;border-radius:25px;height:14px;display:inline-block;vertical-align:middle;width:14px;text-align:center;line-height:12px}.sectoken-user a:hover,.sectoken-role a:hover,.sectoken-ip a:hover{background:#FB9}.sectoken-other{display:table;border-collapse:separate}.sectoken-other a:hover{background:#FB9}.sectoken-role{background:#EFE;border-color:#5B5}.sectoken-user{background:#EFF;border-color:#5BE}.sectoken-ip,.sectoken-other{background:#FFE;border-color:#ED5}p.description{font-size:13px;font-style:normal;margin:6px 0 10px}p.description:empty{display:none}p.description+p{margin:6px 0 10px}.setup-wizard-wrapper{font-family:helvetica;margin:0 auto;padding:20px 20px 10px 20px;-webkit-font-smoothing:subpixel-antialiased;max-width:780px;min-width:780px;top:50%;-ms-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%);position:absolute;left:50%;-webkit-animation:fadein 0.5s;color:#222;font-family:helvetica;color:#222;font-size:13px;font-weight:500;line-height:24px;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}.wp-2fa-settings-wrapper .method-title em{font-weight:700 !important}.wp-2fa-settings-wrapper .disabled ~,.wp-2fa-settings-wrapper .disabled~\*{opacity:0.5 !important}.wp-2fa-settings-wrapper label{font-size:15px}.wp-2fa-settings-wrapper label+p.description{font-size:12px !important;color:#8c8c8c}.wp-2fa-settings-wrapper .method-title{display:none}@keyframes fadein{from{opacity:0}to{opacity:1}}@-moz-keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}@-ms-keyframes fadein{from{opacity:0}to{opacity:1}}@-o-keyframes fadein{from{opacity:0}to{opacity:1}}.wp2fa-setup-content .step-setting-wrapper:not(.active){display:none}.wp2fa-setup-content .step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}.radio-cells .option-pill{text-align:left}.option-pill{text-align:left;padding:0;margin:5px 0px 15px;overflow:visible}.option-pill:last-of-type{margin-bottom:0}.option-pill label{display:block;clear:both}#wp-2fa-totp-qrcode{float:right}.input.wide{margin-top:20px;min-width:50%}.description.error{color:red}.align-center{text-align:center}.wp2fa-setup-content .radio-inline{margin-left:10px}.option-pill ol{margin:0;padding:0 0 0 20px}.resend-email-code{min-width:195px !important}.step-title-wrapper{text-align:center}.step-title{display:inline-block;font-weight:700;margin:0 10px 5px;color:#b4b9be;padding-bottom:15px;position:relative}.step-title:hover{cursor:pointer}.step-title.active-step-title{color:#3e6bff}.step-title span{border:1px solid;width:15px;height:15px;display:inline-block;line-height:15px;font-size:9px;border-radius:50%;position:relative;top:-1px}.app-logo:focus{box-shadow:none !important}.hide-overflow{overflow:hidden}@media (min-width:601px){.apps-wrapper{position:relative;overflow:hidden;display:flex}.apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}}@media (max-width:991px){.setup-wizard-wrapper{min-width:0;position:relative;transform:none;left:0;top:0;padding:15px}#wp2fa-logo img{max-width:240px;width:70%;height:auto}.wp2fa-setup-content{padding:20px 15px}.wp2fa-setup-content h3{font-size:18px;margin-bottom:20px;margin-top:5px;line-height:1.5}body.wp2fa-setup{margin-top:25px;min-width:0}.wp2fa-setup-content \*,p.description{font-size:12px}.steps li{padding-bottom:7px;position:relative;font-size:12px}}@media (max-width:600px){#wp-2fa-totp-qrcode{float:none;width:100%;margin:0 auto 10px}.apps-wrapper{display:block}.apps-wrapper a.app-logo{width:calc(100% / 3 - 5px);display:inline-block;margin-bottom:5px}.apps-wrapper a.app-logo img{margin:0 auto}}@media (max-width:480px){.steps li:not(.is-active){display:none}.wp2fa-setup-content br{clear:both;margin-bottom:15px}input[type="email"]{margin-top:10px}}.wp2fa-setup-content .select2-selection\_\_choice{color:#3c434a !important}.method-wrapper{border-bottom:none !important}.wp2fa-setup-content input[type=checkbox]:checked::before{content:"";font-family:dashicons;display:inline-block;line-height:1;font-weight:400;font-style:normal;speak:never;text-decoration:inherit;text-transform:none;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:20px;height:20px;font-size:20px;vertical-align:top;text-align:center;transition:color 0.1s ease-in;color:#3e6bff;position:relative;left:1px}.wp2fa-setup-content input[type=checkbox].disabled:focus{border-color:#b12222;box-shadow:0 0 0 1px #b12222}.wp2fa-setup-content input[type=checkbox].disabled{border-color:rgba(21, 21, 21, 0.75)}.wp2fa-setup-content input[type=checkbox]{border-radius:50%;margin-top:-2px}input[type=radio]:checked::before{content:"";background-color:#3e6bff !important}label[for="manual-block"]{margin-bottom:-9px;display:block}.setup-wizard-wrapper .button[data-check-authy-2fa],.setup-wizard-wrapper .button[data-check-twilio-2fa]{background-color:#fff;border:2px solid #3e6bff;border-radius:30px;color:#3e6bff;display:inline-block;font-size:12px;font-weight:800;letter-spacing:0.3px;line-height:14px;margin-bottom:10px;outline:none;padding:6px 7pt 4px;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.setup-wizard-wrapper .button[data-check-authy-2fa]:hover,.setup-wizard-wrapper .button[data-check-twilio-2fa]:hover{background-color:#3e6bff;border:2px solid #3e6bff;color:#fff}#wizard-sid-key tr{width:50%;display:inline-grid}#wizard-sid-key tr th{width:100%;padding-bottom:0}#wizard-sid-key tr input{width:100%}.sub-setting-indent{margin-left:20px}.sub-setting-indent+.sub-setting-indent{margin-top:20px} |
  |  | 2 | #excluded\_users\_buttons,#excluded\_roles\_buttons,#enforced\_roles\_buttons,#enforced\_users\_buttons,#excluded\_sites\_buttons{display:inline}.wp2fa-setup-content #excluded\_users\_buttons,.wp2fa-setup-content #excluded\_roles\_buttons{display:block;margin-top:20px}.user-btn{position:relative;margin-left:10px !important}.user-btn .remove-item{background:red;height:14px;width:14px;position:absolute;color:#fff;border-radius:7px;line-height:11px;text-align:center;font-size:10px;display:block;right:-7px;top:-5px}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp-2fa-settings-wrapper{max-width:1010px}.wp-2fa-settings-wrapper h2{margin:3px 0 0}.wp-2fa-settings-wrapper .method-title em{font-style:normal;font-weight:500;position:relative;top:6px}.wp-2fa-settings-wrapper p.description{font-size:13px}.wp-2fa-settings-wrapper:not(.setup-wizard-wrapper) .description fieldset label+label{padding-left:10px !important}label.disabled{opacity:0.5;cursor:default}.button.has-spinner{padding-right:0 !important}.notice-after-button{margin-left:0px !important;padding:5px 10px !important;clear:left;display:block}input.error{border-color:#dc3232;background:#ffebee}.wp-2fa-user-profile-form .button{margin-right:5px}.wp-submenu a[href="wp-2fa-setup"]{display:none !important}@media (min-width:1200px){.min-input-width{min-width:360px}}.wp2fa-form-styles .select2-selection--multiple{min-height:36px;height:auto;overflow-y:auto}.wp2fa-form-styles .select2-container--default .select2-selection--multiple .select2-selection\_\_choice{background-color:#e4e4e4;border:1px solid #aaa;border-radius:4px;cursor:default;float:left;margin-right:5px;margin-top:4px;margin-bottom:0px;padding:0 5px}.wp2fa-form-styles .select2-container .select2-search--inline{float:left;height:15px}.wp2fa-form-styles .select2-container--default .select2-search--inline .select2-search\_\_field{height:13px;margin-top:0px}.wp2fa-form-styles .select2-container--default .select2-selection--multiple{padding-top:3px}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary{color:#555 !important}.wp2fa-form-styles .wp2fa-setup-actions .button-secondary:hover{color:#fff !important}#exclusion\_settings\_wrapper.disabled{height:0;overflow:hidden}#notify-admin-settings-page{text-align:justify}.wp2fa-quota-exceeded-notice .button{margin-right:3px}.method-wrapper{margin-bottom:3px;border-bottom:1px solid #c3c4c7;padding-bottom:20px}.certain-users-only-inputs{margin-bottom:15px}a[href\*="wp-2fa-premium-features"]{color:#ADFF2F !important}.wp-2fa-nag br{display:none}#wp-2fa-side-banner{background:#fff;padding:24px 4px;border:1px solid #bbb;position:fixed;width:280px;right:40px;bottom:40px;text-align:center}#wp-2fa-side-banner p{font-size:16px;font-weight:700}#wp-2fa-side-banner ul{margin-bottom:20px;padding:0 15px}#wp-2fa-side-banner li{padding-left:25px;overflow:hidden;position:relative;margin-bottom:10px;text-align:left}#wp-2fa-side-banner a.link{position:relative;top:5px;margin-left:15px}#wp-2fa-side-banner .dashicons{position:absolute;left:0;color:#4776ff}#wp-2fa-side-banner .button-primary{background:#4776ff;border-color:#4776ff;color:#fff;text-decoration:none;text-shadow:none}@media (max-width:1320px){.wp-2fa-settings-wrapper{max-width:580px}}@media (max-width:1040px){#wp-2fa-side-banner{display:none}}@media (min-width:1040px){.ui-dialog{min-width:355px}}.wp-2fa-user-profile-form .qr-btn,.wp-2fa-user-profile-form .click-to-copy{text-decoration:none;font-size:13px;line-height:2.15384615;min-height:30px;margin:0;padding:0 10px;cursor:pointer;border-width:1px;border-style:solid;-webkit-appearance:none;border-radius:3px;white-space:nowrap;box-sizing:border-box;background:#2271b1;border-color:#2271b1;color:#fff;text-decoration:none;text-shadow:none;display:list-item;width:140px}.wp-2fa-user-profile-form .qr-btn:hover,.wp-2fa-user-profile-form .click-to-copy:hover{background:#135e96;border-color:#135e96;color:#fff}.wp-2fa-user-profile-form #app-key-input{min-width:320px}.mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.wp2fa-modal{font-family:helvetica}.modal\_\_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;justify-content:center;align-items:center;z-index:9999}.modal\_\_container{background-color:#fff;padding:40px 40px 30px;max-width:500px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box;z-index:1500}.modal\_\_header{display:flex;justify-content:space-between;align-items:center}.modal\_\_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#222;box-sizing:border-box}.modal\_\_close{border:0;outline:none;z-index:10}.modal\_\_close:hover{cursor:pointer}.modal\_\_header .modal\_\_close:before,.wp2fa-modal .modal\_\_close:before{content:"✕"}.modal\_\_content{font-size:13px;font-weight:500;height:100%;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content p{font-size:13px;font-weight:500;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content label{font-size:14px;line-height:28px;color:#222;margin-top:0;word-break:keep-all;width:100%;display:block}.modal\_\_content p.description{font-size:12px;line-height:24px;opacity:0.9}.modal\_\_content .apps-wrapper{position:relative;overflow:hidden;display:flex}.modal\_\_content .apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.modal\_\_content .apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}.modal\_\_content .wp2fa-setup-actions{clear:both}.modal\_\_content .iti--allow-dropdown{width:100%}.modal\_\_btn-primary{background-color:#00449e;color:#fff}.enable\_styling .modal\_\_content input[type="radio"]{margin-left:0;appearance:auto;width:auto;height:auto;background:transparent}.enable\_styling .modal\_\_content input[type="radio"]:after{display:none}.enable\_styling .modal\_\_content input[type="radio"]:focus{border-color:transparent;box-shadow:none;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):not(.app-key){line-height:1;margin-bottom:10px;min-height:2pc;min-width:15pc;padding:5px;margin:0px;border:none;border-bottom:3px solid #d0e5ff;width:100%;padding:10px 0;font-size:16px;font-weight:700;color:#4498ff;box-shadow:none}.enable\_styling .modal\_\_content input:not([type="radio"]):focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):-internal-autofill-selected{background-color:transparent}.enable\_styling .iti--allow-dropdown input[type=tel]{z-index:100;background:transparent}.enable\_styling .iti\_\_flag-container{width:auto;z-index:101}.enable\_styling .expand-panel .iti\_\_flag-container{width:100%}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .modal\_\_overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .modal\_\_container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .modal\_\_container,.micromodal-slide .modal\_\_overlay{will-change:transform}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp2fa-modal .modal\_\_container{max-height:70vh;max-width:872px;min-width:30vw;position:relative}.wp2fa-modal .modal\_\_close{background:transparent;color:#4498ff !important;font-size:15px;font-weight:700;position:absolute;right:20px;text-decoration:none;top:20px;background-color:transparent !important}.wp2fa-modal .modal\_\_close :hover{color:#888;cursor:pointer}.wp2fa-modal input[type=radio]:checked:before{display:none}.wizard-step:not(.active),.step-setting-wrapper:not(.active){display:none}.wizard-step.active,.step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}#configure-2fa .wp2fa-setup-actions,#configure-2fa-backup-codes .wp2fa-setup-actions{margin-top:25px}.modal\_\_btn+.modal\_\_btn{margin-left:10px}.wp-2fa-configuration-form td.backup-methods-label,.wp-2fa-configuration-form th{display:none}.wp2fa-modal h4,.wp2fa-modal h3{word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}.wp2fa-modal.enable\_styling h4,.wp2fa-modal.enable\_styling h3{font-family:helvetica !important}.wp2fa-modal fieldset{padding:0;border:0}.wp2fa-modal ol{margin:0 0 15px;padding-left:17px}.wp2fa-modal ol li{position:relative;padding:6px}.wp2fa-modal .modal\_\_content code.app-key{font-size:16px;padding:7px 12px;word-break:break-all;background:#efefef;color:#222}label+.verification-response{margin-top:20px}.verification-response:not(:empty){border:3px solid red;font-size:9pt;margin-bottom:15px;padding:10px;background:#ffe4e4;border-radius:10px;font-size:9pt;line-height:24px;width:100%}.default\_styling .verification-response:not(:empty){width:calc(100% - 30px)}.wp-2fa-configuration-form .button.enable\_styling{background-color:#fff !important;color:#3e6bff !important;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff !important;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px}.wp-2fa-configuration-form .button.enable\_styling:hover{background-color:#3e6bff !important;color:#fff !important;border:3px solid #3e6bff !important}.wp2fa-modal.enable\_styling .modal\_\_content .wp2fa-setup-actions .button:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-confirm:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-decline:focus{box-shadow:none}.wp2fa-modal.enable\_styling .button+.button{margin-left:10px}.modal\_\_footer{margin-top:20px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary,.enable\_styling #wizard-api-key button,.enable\_styling #wizard-sid-key button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;transition:all 0.2s ease-in-out}.enable\_styling .wp-2fa-button-secondary{color:#555;border:3px solid #555}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary{color:#555 !important;border:3px solid #555 !important}.enable\_styling .wp-2fa-button-primary:focus,.enable\_styling .wp-2fa-button-secondary:focus{box-shadow:none}.enable\_styling .wp-2fa-button-primary:hover{background-color:#3e6bff;color:#fff;border:3px solid #3e6bff;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-button-secondary:hover{background-color:#555;color:#fff;border:3px solid #555;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary:hover,.enable\_styling #wizard-api-key button:hover,.enable\_styling #wizard-sid-key button:hover{background-color:#555 !important;color:#fff !important;border:3px solid #555 !important}.wp-2fa-configuration-form .button{margin-right:10px}.wp-2fa-configuration-form .button:hover{cursor:pointer}.qr-code-wrapper{position:relative;overflow:hidden;float:right}#notify-users .modal\_\_container \*{opacity:1;transition:all 0.3s ease-in-out}#notify-users .modal\_\_container.saving \*{opacity:0;transition:all 0.3s ease-in-out}.qr-code-wrapper.regenerating img{visibility:hidden}#backup-codes-wrapper{border:none;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;background-color:transparent !important}#backup-codes-wrapper :focus-visible{outline:none}#backup-codes-wrapper:focus-visible{outline:none}.qr-code-wrapper.regenerating:before,#notify-users .modal\_\_container.saving:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner 0.6s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.default\_styling .radio-cells .option-pill{position:relative;margin-bottom:11px}.default\_styling .radio-cells .option-pill label{padding-right:40px;font-size:12px}.default\_styling .wizard-tooltip{display:none !important}.default\_styling input[type=checkbox],.default\_styling input[type=radio]{-webkit-appearance:auto}@media screen and (max-width:1299px){.wp2fa-modal .modal\_\_container{max-width:96vw}#wp-2fa-totp-qrcode{max-width:100%;text-align:center;margin:15px auto;display:block}.qr-code-wrapper{float:none}.step-setting-wrapper br{display:none}.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.enable\_styling .radio-cells .option-pill p{height:100%}.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.enable\_styling .option-pill{margin-bottom:15px}.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .modal\_\_content code br{display:block !important}.wp2fa-modal .modal\_\_content code.app-key{width:100%;display:block;text-align:center;font-size:16px;margin-bottom:30px;background:#efefef;padding:5px;word-break:break-all}.wp2fa-modal .modal\_\_content .apps-wrapper{margin:10px 0}.wp2fa-modal .modal\_\_content a.app-logo{padding:0 5px}.wp2fa-modal .modal\_\_content .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .modal\_\_content .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal .modal\_\_content .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .modal\_\_content .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .modal\_\_content .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .modal\_\_content .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus-visible,.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp-2fa-configuration-form .button{width:auto;display:block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.modal\_\_content input:not([type="radio"]){width:100%;margin-bottom:10px}.hide-on-mobile{display:none}.wp2fa-modal h4,.wp2fa-modal h3{font-size:20px}.wp2fa-modal h4{clear:both}}@media screen and (min-width:1300px){.wp2fa-modal .clear-both{clear:both;display:block;overflow:hidden}.wp2fa-modal .modal-50{width:50%;display:inline-block;float:left}.wp2fa-modal .modal-60{width:70%;display:inline-block;float:left}.wp2fa-modal .modal-60 .radio-cells{width:100%;padding-left:10px}.wp2fa-modal .modal-40{width:30%;float:left;display:flex;justify-content:center}.wp2fa-modal .mb-20{margin-bottom:20px}.wp2fa-modal.enable\_styling p+.radio-cells,.wp2fa-modal.enable\_styling p+fieldset{margin:20px 0;display:flex;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.wp2fa-modal.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{height:100%}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.wp2fa-modal.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.wp2fa-modal.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.wp2fa-modal .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .app-key-wrapper input:focus-visible,.wp2fa-modal .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp2fa-modal .option-pill{margin-bottom:15px}.wp2fa-modal .qr-code{float:left;width:100%;position:relative;left:-2%}.wp2fa-modal .mb-30{margin-bottom:30px}.show-on-mobile{display:none}}@media (max-width:500px){.modal\_\_container{padding:25px}.option-pill:not(last-of-type){margin-bottom:40px}.wp2fa-modal .modal\_\_content .apps-wrapper{display:block}.wp2fa-modal .modal\_\_content a.app-logo{width:calc(33.33333% - 13px);display:inline-block;margin-bottom:5px}.wp2fa-modal h4,.wp2fa-modal h3{font-size:18px;margin-bottom:9px}#configure-2fa-backup-codes .wp2fa-setup-actions,#configure-2fa .wp2fa-setup-actions{margin-top:15px}.wp2fa-modal .modal\_\_content .modal\_\_btn,.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp-2fa-configuration-form .button{display:block;margin-bottom:10px;margin-left:0;margin-right:0;text-align:center;width:auto;padding:10px 15px;font-size:12px}.wp2fa-modal .modal\_\_content .radio-cells .option-pill{flex-basis:unset;flex-grow:1}.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}}@media screen and (min-width:801px) and (max-width:1299px){.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}.modal-50{width:50%;display:inline-block;float:left}.mb-20{margin-bottom:20px}.modal-60{width:70%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.modal-40{width:30%;float:left;display:flex;justify-content:center}}@media screen and (min-width:1024px){.wp2fa-modal .modal\_\_container{min-width:768px}}@media screen and (min-width:501px) and (max-width:800px){.modal-50{width:50%;display:inline-block;float:left}.modal-60{width:60%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.mb-20{margin-bottom:20px}.modal-40{width:40%;float:left;display:flex;justify-content:center}}@media screen and (max-width:800px){.wp2fa-modal .modal\_\_container{max-width:95vw;min-width:80vw}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_close{right:15px;top:15px}}@media screen and (max-width:500px){.mb-20{margin-bottom:15px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{max-width:200px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary{display:block !important;margin-left:0 !important;margin-right:0;width:100% !important}.wp2fa-modal .modal\_\_content .wizard-tooltip{right:5px;bottom:5px}.verification-response:not(:empty){width:auto}}.wizard-custom-counter{counter-reset:step-counter;list-style:none;margin-bottom:0 !important}.wizard-custom-counter li{counter-increment:step-counter}.wizard-custom-counter li:last-of-type{margin-bottom:0 !important}.enable\_styling .wizard-custom-counter li::before{content:counter(step-counter);background:#3e6bff;width:20px;height:20px;color:white;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.enable\_styling #backup-codes-wrapper{border:none;border-bottom:3px solid #d0e5ff;color:#4498ff;font-size:1pc;font-weight:700;line-height:1;margin:0;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;line-height:26px;background-color:transparent !important}.enable\_styling #backup-codes-wrapper :focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling #backup-codes-wrapper:focus-visible{border-bottom:3px solid #4498ff;outline:none}.default\_styling .wizard-custom-counter li::before{content:counter(step-counter);width:20px;height:20px;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.mb-0{margin-bottom:0 !important}.wp-2fa-user-profile-form{margin:0}.wp-2fa-user-profile-form:first-of-type{margin-top:20px}.wp-2fa-user-profile-form:last-of-type{margin-bottom:20px}.wp-2fa-user-profile-form tr+tr th,.wp-2fa-user-profile-form tr+tr td{padding-top:0}.remove-tr-padding th,.remove-tr-padding td{padding-bottom:0}body:not(.wp-admin) .wp-2fa-user-profile-form td,body:not(.wp-admin) .wp-2fa-user-profile-form th{padding:0;border:none}.wp-2fa-user-profile-form{border:none}.wp-2fa-button-primary+.wp-2fa-button-secondary{margin-left:10px}.modal-logo-wrapper{text-align:center;padding:0;margin:0}.iti\_\_flag-container{width:100%}.iti\_\_country-list{width:100%}.wizard-step label[for="authy-token"]{min-height:70px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel label[for="authy-token"]{min-height:300px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel .authy-step-setting-wrapper{overflow:hidden}.wizard-step.expand-panel .iti\_\_country-list{width:100%;max-height:240px}[aria-describedby="authy-diag"],[aria-describedby="twilio-diag"]{min-width:400px;padding:10px}[aria-describedby="authy-diag"] .ui-dialog-titlebar,[aria-describedby="twilio-diag"] .ui-dialog-titlebar{background:#fff;border-bottom:none;height:auto;font-size:18px;font-weight:600;line-height:2;padding:10px 36px 0 16px;word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}[aria-describedby="authy-diag"] .ui-dialog-buttonpane,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane{background:#fff;border-top:none;padding:16px}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;height:auto;margin-left:0}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button:hover,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button:hover{background-color:#3e6bff;color:#fff}[aria-describedby="authy-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset{float:left}[aria-describedby="authy-diag"] .ui-dialog-content,[aria-describedby="twilio-diag"] .ui-dialog-content{padding:0 16px 9px;overflow:auto}body{min-height:100vh}a{color:#0073aa}a:hover,a:active{color:#00a0d2}a:focus{color:#124964;box-shadow:0 0 0 1px #5b9dd9, 0 0 2px 1px rgba(30, 140, 190, 0.8)}.ie8 a:focus{outline:#5b9dd9 solid 1px}h1,h2{border-bottom:1px solid #ddd;clear:both;color:#666;font-size:24px;padding:0;padding-bottom:7px;font-weight:400}h3{font-size:16px}p,li,dd,dt{padding-bottom:2px;color:#222;font-size:13px;line-height:24px}code,.code{font-family:Consolas, Monaco, monospace}ul,ol,dl{padding:5px 5px 5px 22px}a img{border:0}abbr{border:0;font-variant:normal}fieldset{border:0;padding:0;margin:0}label{cursor:pointer}#logo{margin:6px 0 14px 0;padding:0 0 7px 0;border-bottom:none;text-align:center}#logo a{background-image:url(../images/w-logo-blue.png?ver=20131202);background-image:none, url(../images/wordpress-logo.svg?ver=20131107);background-size:84px;background-position:center top;background-repeat:no-repeat;color:#444;height:84px;font-size:20px;font-weight:400;line-height:1.3;margin:-130px auto 25px;padding:0;text-decoration:none;width:84px;text-indent:-9999px;outline:none;overflow:hidden;display:block}.step{margin:20px 0 15px;text-align:left;padding:0}th{text-align:left;padding:0}.language-chooser.wp-core-ui .step .button.button-large{height:36px;font-size:14px;line-height:2.35714285;vertical-align:middle}textarea{border:1px solid #ddd;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;width:100%;box-sizing:border-box}.form-table{border-collapse:collapse;margin-top:1em;width:100%}.form-table td{margin-bottom:9px;padding:10px 20px 10px 0;font-size:14px;vertical-align:top}.form-table th{font-size:14px;text-align:left;padding:10px 20px 10px 0;width:140px;vertical-align:top}.form-table code{line-height:1.28571428;font-size:14px}.form-table p{margin:4px 0 0 0;font-size:11px}.form-table input{line-height:1.33333333;font-size:15px;padding:3px 5px;border:1px solid #ddd;box-shadow:inset 0 1px 2px rgba(0, 0, 0, 0.07)}input,submit{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif}.form-table input[type=text],.form-table input[type=email],.form-table input[type=url],.form-table input[type=password]{width:218px}#pass-strength-result{width:218px}.form-table th p{font-weight:400}.form-table.install-success th{vertical-align:middle;padding:16px 20px 16px 0}.form-table.install-success td{vertical-align:middle;padding:16px 20px 16px 0}.form-table.install-success td p{margin:0;font-size:14px}.form-table.install-success td code{margin:0;font-size:18px}#error-page{margin-top:50px}#error-page p{font-size:14px;line-height:1.28571428;margin:25px 0 20px}#error-page code{font-family:Consolas, Monaco, monospace}.code{font-family:Consolas, Monaco, monospace}.message{border-left:4px solid #dc3232;padding:0.7em 0.6em;background-color:#fbeaea}#dbname,#uname,#pwd,#dbhost,#prefix,#user\_login,#admin\_email,#pass1,#pass2{direction:ltr}body.rtl{font-family:Tahoma, sans-serif}.rtl textarea,.rtl input,.rtl submit{font-family:Tahoma, sans-serif}:lang(he-il) body.rtl{font-family:Arial, sans-serif}:lang(he-il) .rtl textarea,:lang(he-il) .rtl input,:lang(he-il) .rtl submit{font-family:Arial, sans-serif}@media only screen and (max-width:799px){body{margin-top:115px}#logo a{margin:-125px auto 30px}}@media screen and (max-width:782px){.form-table{margin-top:0}.form-table th,.form-table td{display:block;width:auto;vertical-align:middle}.form-table th{padding:20px 0 0}.form-table td{padding:5px 0;border:0;margin:0}textarea,input{font-size:16px}.form-table td input[type="text"],.form-table td input[type="email"],.form-table td input[type="url"],.form-table td input[type="password"]{width:100%;font-size:16px;line-height:1.5;padding:7px 10px;display:block;max-width:none;box-sizing:border-box}.form-table td select,.form-table td textarea{width:100%;font-size:16px;line-height:1.5;padding:7px 10px;display:block;max-width:none;box-sizing:border-box}.form-table span.description{width:100%;font-size:16px;line-height:1.5;padding:7px 10px;display:block;max-width:none;box-sizing:border-box}.wp-pwd #pass1{padding-right:50px}.wp-pwd .button.wp-hide-pw{right:0}#pass-strength-result{width:100%}}body.language-chooser{max-width:300px}.language-chooser select{padding:8px;width:100%;display:block;border:1px solid #ddd;background:#fff;color:#32373c;font-size:16px;font-family:Arial, sans-serif;font-weight:400}.language-chooser select:focus{color:#32373c}.language-chooser select option:hover,.language-chooser select option:focus{color:#016087}.language-chooser p{text-align:right}.screen-reader-input,.screen-reader-text{border:0;clip:rect(1px, 1px, 1px, 1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal !important}.spinner{background:url(../images/spinner.gif) no-repeat;background-size:20px 20px;visibility:hidden;opacity:0.7;filter:alpha(opacity=70);width:20px;height:20px;margin:2px 5px 0}.step .spinner{display:inline-block;vertical-align:middle;margin-right:15px}.button.hide-if-no-js,.hide-if-no-js{display:none}@media print,(-webkit-min-device-pixel-ratio:1.25),(min-resolution:120dpi){.spinner{background-image:url(../images/spinner-2x.gif)}}body{-webkit-box-shadow:none;box-shadow:none;background:#F8F9FB;padding:0}#wp2fa-logo{border:0;margin:0 0 24px;padding:0;text-align:center}#wp2fa-logo a{color:#3e6bff;text-decoration:none;font-weight:700;font-size:28px;margin-bottom:35px;display:block}#wp2fa-logo img{width:auto;max-width:80px;position:relative;left:-10px}.steps{display:-ms-flexbox;display:flex;list-style-type:none;margin:0;padding:0 0 25px;text-align:center}.steps li{-ms-flex:1 0 auto;flex:1 0 auto;font-weight:700;margin:0 0 5px;color:#b4b9be;padding-bottom:15px;position:relative}.steps li.is-active{color:#3e6bff}.steps li.is-active::before{border:4px solid #3e6bff;background:#3e6bff}.steps li::before{content:"";border:4px solid #b4b9be;border-radius:100%;width:4px;height:4px;position:absolute;bottom:0;left:50%;margin-left:-6px;margin-bottom:-8px;background:#b4b9be}.wp2fa-setup-content{-webkit-box-shadow:0 1px 3px rgba(0, 0, 0, 0.13);box-shadow:0 1px 3px rgba(0, 0, 0, 0.13);padding:30px 40px;margin:0 0 20px;background:#fff;overflow:hidden;zoom:1;border-radius:10px}.wp2fa-setup-content h3{font-size:24px;text-align:center;margin-bottom:30px;margin-top:5px;line-height:36px}.wp2fa-setup-content a{color:#3e6bff !important;text-decoration:none !important}.wp2fa-setup-content h4,.wp2fa-setup-content fieldset{line-height:1.5}.wp2fa-setup-actions{text-align:center;margin:40px auto 10px}.wp2fa-setup-actions .button,.wp2fa-setup-actions .button[data-check-authy-2fa]{background-color:#fff;border:3px solid #3e6bff;border-radius:30px;color:#3e6bff;display:inline-block;font-size:14px;font-weight:800;letter-spacing:0.3px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.wp2fa-setup-actions .button-primary{font-weight:700}.wp2fa-setup-actions .button-secondary{font-weight:700;background-color:#fff;border:2px solid #555;color:#555}.wp2fa-setup-actions .button-secondary:hover,.wp2fa-setup-actions .button-secondary:focus{background:#555;border-color:#555;-webkit-box-shadow:none;box-shadow:none;color:#fff}.wp2fa-setup-actions .button-primary:hover,.wp2fa-setup-actions .button-primary:focus{background:#3e6bff;border-color:#3e6bff;-webkit-box-shadow:none;box-shadow:none;color:#fff !important}.wp2fa-setup-footer{text-align:center}.wp2fa-setup-footer a{color:#3e6bff;font-size:14px;text-decoration:none}.wp2fa-setup-form label[for="editor-users-box"],.wp2fa-setup-form label[for="editor-roles-box"],.wp2fa-setup-form label[for="exuser-query-box"],.wp2fa-setup-form label[for="exrole-query-box"],.wp2fa-setup-form label[for="ipaddr-query-box"]{display:inline-block;margin:5px 0}.wp2fa-setup-form label[for="editor-users-box"] span,.wp2fa-setup-form label[for="editor-roles-box"] span,.wp2fa-setup-form label[for="exuser-query-box"] span,.wp2fa-setup-form label[for="exrole-query-box"] span,.wp2fa-setup-form label[for="ipaddr-query-box"] span{display:inline-block;min-width:100px}.sectoken-user,.sectoken-role,.sectoken-ip,.sectoken-other{display:inline-block;border-width:1px;border-style:solid;padding:2px 4px;margin:2px 0 0 2px;border-radius:3px;cursor:default;line-height:1.3;font-size:14px}.sectoken-user a,.sectoken-role a,.sectoken-ip a,.sectoken-other a{text-decoration:none;font-size:12px;font-weight:bold;color:#FFF;margin-left:2px;background:#BBB;border-radius:25px;height:14px;display:inline-block;vertical-align:middle;width:14px;text-align:center;line-height:12px}.sectoken-user a:hover,.sectoken-role a:hover,.sectoken-ip a:hover{background:#FB9}.sectoken-other{display:table;border-collapse:separate}.sectoken-other a:hover{background:#FB9}.sectoken-role{background:#EFE;border-color:#5B5}.sectoken-user{background:#EFF;border-color:#5BE}.sectoken-ip,.sectoken-other{background:#FFE;border-color:#ED5}p.description{font-size:13px;font-style:normal;margin:6px 0 10px}p.description:empty{display:none}p.description+p{margin:6px 0 10px}.setup-wizard-wrapper{font-family:helvetica;margin:0 auto;padding:20px 20px 10px 20px;-webkit-font-smoothing:subpixel-antialiased;max-width:780px;min-width:780px;top:50%;-ms-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%);position:absolute;left:50%;-webkit-animation:fadein 0.5s;color:#222;font-family:helvetica;color:#222;font-size:13px;font-weight:500;line-height:24px;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}.wp-2fa-settings-wrapper .method-title em{font-weight:700 !important}.wp-2fa-settings-wrapper .disabled ~,.wp-2fa-settings-wrapper .disabled~\*{opacity:0.5 !important}.wp-2fa-settings-wrapper label{font-size:15px}.wp-2fa-settings-wrapper label+p.description{font-size:12px !important;color:#8c8c8c}.wp-2fa-settings-wrapper .method-title{display:none}@keyframes fadein{from{opacity:0}to{opacity:1}}@-moz-keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}@-ms-keyframes fadein{from{opacity:0}to{opacity:1}}@-o-keyframes fadein{from{opacity:0}to{opacity:1}}.wp2fa-setup-content .step-setting-wrapper:not(.active){display:none}.wp2fa-setup-content .step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}.radio-cells .option-pill{text-align:left}.option-pill{text-align:left;padding:0;margin:5px 0px 15px;overflow:visible}.option-pill:last-of-type{margin-bottom:0}.option-pill label{display:block;clear:both}#wp-2fa-totp-qrcode{float:right}.input.wide{margin-top:20px;min-width:50%}.description.error{color:red}.align-center{text-align:center}.wp2fa-setup-content .radio-inline{margin-left:10px}.option-pill ol{margin:0;padding:0 0 0 20px}.resend-email-code{min-width:195px !important}.step-title-wrapper{text-align:center}.step-title{display:inline-block;font-weight:700;margin:0 10px 5px;color:#b4b9be;padding-bottom:15px;position:relative}.step-title:hover{cursor:pointer}.step-title.active-step-title{color:#3e6bff}.step-title span{border:1px solid;width:15px;height:15px;display:inline-block;line-height:15px;font-size:9px;border-radius:50%;position:relative;top:-1px}.app-logo:focus{box-shadow:none !important}.hide-overflow{overflow:hidden}@media (min-width:601px){.apps-wrapper{position:relative;overflow:hidden;display:flex}.apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}}@media (max-width:991px){.setup-wizard-wrapper{min-width:0;position:relative;transform:none;left:0;top:0;padding:15px}#wp2fa-logo img{max-width:240px;width:70%;height:auto}.wp2fa-setup-content{padding:20px 15px}.wp2fa-setup-content h3{font-size:18px;margin-bottom:20px;margin-top:5px;line-height:1.5}body.wp2fa-setup{margin-top:25px;min-width:0}.wp2fa-setup-content \*,p.description{font-size:12px}.steps li{padding-bottom:7px;position:relative;font-size:12px}}@media (max-width:600px){#wp-2fa-totp-qrcode{float:none;width:100%;margin:0 auto 10px}.apps-wrapper{display:block}.apps-wrapper a.app-logo{width:calc(100% / 3 - 5px);display:inline-block;margin-bottom:5px}.apps-wrapper a.app-logo img{margin:0 auto}}@media (max-width:480px){.steps li:not(.is-active){display:none}.wp2fa-setup-content br{clear:both;margin-bottom:15px}input[type="email"]{margin-top:10px}}.wp2fa-setup-content .select2-selection\_\_choice{color:#3c434a !important}.method-wrapper{border-bottom:none !important}.wp2fa-setup-content input[type=checkbox]:checked::before{content:"";font-family:dashicons;display:inline-block;line-height:1;font-weight:400;font-style:normal;speak:never;text-decoration:inherit;text-transform:none;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:20px;height:20px;font-size:20px;vertical-align:top;text-align:center;transition:color 0.1s ease-in;color:#3e6bff;position:relative;left:1px}.wp2fa-setup-content input[type=checkbox].disabled:focus{border-color:#b12222;box-shadow:0 0 0 1px #b12222}.wp2fa-setup-content input[type=checkbox].disabled{border-color:rgba(21, 21, 21, 0.75)}.wp2fa-setup-content input[type=checkbox]{border-radius:50%;margin-top:-2px}input[type=radio]:checked::before{content:"";background-color:#3e6bff !important}label[for="manual-block"]{margin-bottom:-9px;display:block}.setup-wizard-wrapper .button[data-check-authy-2fa],.setup-wizard-wrapper .button[data-check-twilio-2fa]{background-color:#fff;border:2px solid #3e6bff;border-radius:30px;color:#3e6bff;display:inline-block;font-size:12px;font-weight:800;letter-spacing:0.3px;line-height:14px;margin-bottom:10px;outline:none;padding:6px 7pt 4px;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.setup-wizard-wrapper .button[data-check-authy-2fa]:hover,.setup-wizard-wrapper .button[data-check-twilio-2fa]:hover{background-color:#3e6bff;border:2px solid #3e6bff;color:#fff}#wizard-sid-key tr{width:50%;display:inline-grid}#wizard-sid-key tr th{width:100%;padding-bottom:0}#wizard-sid-key tr input{width:100%}.sub-setting-indent{margin-left:20px}.sub-setting-indent+.sub-setting-indent{margin-top:20px} |
* ## [wp-2fa/trunk/dist/css/styles.css](/changeset/3009922/wp-2fa/trunk/dist/css/styles.css "Show the changeset 3009922 restricted to wp-2fa/trunk/dist/css/styles.css")

  | [r2940688](/browser/wp-2fa/trunk/dist/css/styles.css?rev=2940688#L1 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/dist/css/styles.css?rev=3009922#L1 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | @charset "UTF-8"; |
  | 2 |  | .mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.wp2fa-modal{font-family:helvetica}.modal\_\_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;justify-content:center;align-items:center;z-index:9999}.modal\_\_container{background-color:#fff;padding:40px 40px 30px;max-width:500px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box;z-index:1500}.modal\_\_header{display:flex;justify-content:space-between;align-items:center}.modal\_\_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#222;box-sizing:border-box}.modal\_\_close{border:0;outline:none;z-index:10}.modal\_\_close:hover{cursor:pointer}.modal\_\_header .modal\_\_close:before,.wp2fa-modal .modal\_\_close:before{content:"✕"}.modal\_\_content{font-size:13px;font-weight:500;height:100%;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content p{font-size:13px;font-weight:500;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content label{font-size:14px;line-height:28px;color:#222;margin-top:0;word-break:keep-all;width:100%;display:block}.modal\_\_content p.description{font-size:12px;line-height:24px;opacity:0.9}.modal\_\_content .apps-wrapper{position:relative;overflow:hidden;display:flex}.modal\_\_content .apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.modal\_\_content .apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}.modal\_\_content .wp2fa-setup-actions{clear:both}.modal\_\_content .iti--allow-dropdown{width:100%}.modal\_\_btn-primary{background-color:#00449e;color:#fff}.enable\_styling .modal\_\_content input[type="radio"]{margin-left:0;appearance:auto;width:auto;height:auto;background:transparent}.enable\_styling .modal\_\_content input[type="radio"]:after{display:none}.enable\_styling .modal\_\_content input[type="radio"]:focus{border-color:transparent;box-shadow:none;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):not(.app-key){line-height:1;margin-bottom:10px;min-height:2pc;min-width:15pc;padding:5px;margin:0px;border:none;border-bottom:3px solid #d0e5ff;width:100%;padding:10px 0;font-size:16px;font-weight:700;color:#4498ff;box-shadow:none}.enable\_styling .modal\_\_content input:not([type="radio"]):focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):-internal-autofill-selected{background-color:transparent}.enable\_styling .iti--allow-dropdown input[type=tel]{z-index:100;background:transparent}.enable\_styling .iti\_\_flag-container{width:auto;z-index:101}.enable\_styling .expand-panel .iti\_\_flag-container{width:100%}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .modal\_\_overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .modal\_\_container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .modal\_\_container,.micromodal-slide .modal\_\_overlay{will-change:transform}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp2fa-modal .modal\_\_container{max-height:70vh;max-width:872px;min-width:30vw;position:relative}.wp2fa-modal .modal\_\_close{background:transparent;color:#4498ff !important;font-size:15px;font-weight:700;position:absolute;right:20px;text-decoration:none;top:20px;background-color:transparent !important}.wp2fa-modal .modal\_\_close :hover{color:#888;cursor:pointer}.wp2fa-modal input[type=radio]:checked:before{display:none}.wizard-step:not(.active),.step-setting-wrapper:not(.active){display:none}.wizard-step.active,.step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}#configure-2fa .wp2fa-setup-actions,#configure-2fa-backup-codes .wp2fa-setup-actions{margin-top:25px}.modal\_\_btn+.modal\_\_btn{margin-left:10px}.wp-2fa-configuration-form td.backup-methods-label,.wp-2fa-configuration-form th{display:none}.wp2fa-modal h4,.wp2fa-modal h3{word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}.wp2fa-modal.enable\_styling h4,.wp2fa-modal.enable\_styling h3{font-family:helvetica !important}.wp2fa-modal fieldset{padding:0;border:0}.wp2fa-modal ol{margin:0 0 15px;padding-left:17px}.wp2fa-modal ol li{position:relative;padding:6px}.wp2fa-modal .modal\_\_content code.app-key{font-size:16px;padding:7px 12px;word-break:break-all;background:#efefef;color:#222}label+.verification-response{margin-top:20px}.verification-response:not(:empty){border:3px solid red;font-size:9pt;margin-bottom:15px;padding:10px;background:#ffe4e4;border-radius:10px;font-size:9pt;line-height:24px;width:100%}.default\_styling .verification-response:not(:empty){width:calc(100% - 30px)}.wp-2fa-configuration-form .button.enable\_styling{background-color:#fff !important;color:#3e6bff !important;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff !important;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px}.wp-2fa-configuration-form .button.enable\_styling:hover{background-color:#3e6bff !important;color:#fff !important;border:3px solid #3e6bff !important}.wp2fa-modal.enable\_styling .modal\_\_content .wp2fa-setup-actions .button:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-confirm:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-decline:focus{box-shadow:none}.wp2fa-modal.enable\_styling .button+.button{margin-left:10px}.modal\_\_footer{margin-top:20px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary,.enable\_styling #wizard-api-key button,.enable\_styling #wizard-sid-key button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;transition:all 0.2s ease-in-out}.enable\_styling .wp-2fa-button-secondary{color:#555;border:3px solid #555}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary{color:#555 !important;border:3px solid #555 !important}.enable\_styling .wp-2fa-button-primary:focus,.enable\_styling .wp-2fa-button-secondary:focus{box-shadow:none}.enable\_styling .wp-2fa-button-primary:hover{background-color:#3e6bff;color:#fff;border:3px solid #3e6bff;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-button-secondary:hover{background-color:#555;color:#fff;border:3px solid #555;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary:hover,.enable\_styling #wizard-api-key button:hover,.enable\_styling #wizard-sid-key button:hover{background-color:#555 !important;color:#fff !important;border:3px solid #555 !important}.wp-2fa-configuration-form .button{margin-right:10px}.wp-2fa-configuration-form .button:hover{cursor:pointer}.qr-code-wrapper{position:relative;overflow:hidden;float:right}#notify-users .modal\_\_container \*{opacity:1;transition:all 0.3s ease-in-out}#notify-users .modal\_\_container.saving \*{opacity:0;transition:all 0.3s ease-in-out}.qr-code-wrapper.regenerating img{visibility:hidden}#backup-codes-wrapper{border:none;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;background-color:transparent !important}#backup-codes-wrapper :focus-visible{outline:none}#backup-codes-wrapper:focus-visible{outline:none}.qr-code-wrapper.regenerating:before,#notify-users .modal\_\_container.saving:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner 0.6s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.default\_styling .radio-cells .option-pill{position:relative;margin-bottom:11px}.default\_styling .radio-cells .option-pill label{padding-right:40px;font-size:12px}.default\_styling .wizard-tooltip{display:none !important}.default\_styling input[type=checkbox],.default\_styling input[type=radio]{-webkit-appearance:auto}@media screen and (max-width:1299px){.wp2fa-modal .modal\_\_container{max-width:96vw}#wp-2fa-totp-qrcode{max-width:100%;text-align:center;margin:15px auto;display:block}.qr-code-wrapper{float:none}.step-setting-wrapper br{display:none}.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.enable\_styling .radio-cells .option-pill p{height:100%}.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.enable\_styling .option-pill{margin-bottom:15px}.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .modal\_\_content code br{display:block !important}.wp2fa-modal .modal\_\_content code.app-key{width:100%;display:block;text-align:center;font-size:16px;margin-bottom:30px;background:#efefef;padding:5px;word-break:break-all}.wp2fa-modal .modal\_\_content .apps-wrapper{margin:10px 0}.wp2fa-modal .modal\_\_content a.app-logo{padding:0 5px}.wp2fa-modal .modal\_\_content .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .modal\_\_content .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal .modal\_\_content .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .modal\_\_content .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .modal\_\_content .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .modal\_\_content .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus-visible,.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp-2fa-configuration-form .button{width:auto;display:block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.modal\_\_content input:not([type="radio"]){width:100%;margin-bottom:10px}.hide-on-mobile{display:none}.wp2fa-modal h4,.wp2fa-modal h3{font-size:20px}.wp2fa-modal h4{clear:both}}@media screen and (min-width:1300px){.wp2fa-modal .clear-both{clear:both;display:block;overflow:hidden}.wp2fa-modal .modal-50{width:50%;display:inline-block;float:left}.wp2fa-modal .modal-60{width:70%;display:inline-block;float:left}.wp2fa-modal .modal-60 .radio-cells{width:100%;padding-left:10px}.wp2fa-modal .modal-40{width:30%;float:left;display:flex;justify-content:center}.wp2fa-modal .mb-20{margin-bottom:20px}.wp2fa-modal.enable\_styling p+.radio-cells,.wp2fa-modal.enable\_styling p+fieldset{margin:20px 0;display:flex;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.wp2fa-modal.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{height:100%}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.wp2fa-modal.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.wp2fa-modal.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.wp2fa-modal .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .app-key-wrapper input:focus-visible,.wp2fa-modal .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp2fa-modal .option-pill{margin-bottom:15px}.wp2fa-modal .qr-code{float:left;width:100%;position:relative;left:-2%}.wp2fa-modal .mb-30{margin-bottom:30px}.show-on-mobile{display:none}}@media (max-width:500px){.modal\_\_container{padding:25px}.option-pill:not(last-of-type){margin-bottom:40px}.wp2fa-modal .modal\_\_content .apps-wrapper{display:block}.wp2fa-modal .modal\_\_content a.app-logo{width:calc(33.33333% - 13px);display:inline-block;margin-bottom:5px}.wp2fa-modal h4,.wp2fa-modal h3{font-size:18px;margin-bottom:9px}#configure-2fa-backup-codes .wp2fa-setup-actions,#configure-2fa .wp2fa-setup-actions{margin-top:15px}.wp2fa-modal .modal\_\_content .modal\_\_btn,.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp-2fa-configuration-form .button{display:block;margin-bottom:10px;margin-left:0;margin-right:0;text-align:center;width:auto;padding:10px 15px;font-size:12px}.wp2fa-modal .modal\_\_content .radio-cells .option-pill{flex-basis:unset;flex-grow:1}.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}}@media screen and (min-width:801px) and (max-width:1299px){.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}.modal-50{width:50%;display:inline-block;float:left}.mb-20{margin-bottom:20px}.modal-60{width:70%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.modal-40{width:30%;float:left;display:flex;justify-content:center}}@media screen and (min-width:1024px){.wp2fa-modal .modal\_\_container{min-width:768px}}@media screen and (min-width:501px) and (max-width:800px){.modal-50{width:50%;display:inline-block;float:left}.modal-60{width:60%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.mb-20{margin-bottom:20px}.modal-40{width:40%;float:left;display:flex;justify-content:center}}@media screen and (max-width:800px){.wp2fa-modal .modal\_\_container{max-width:95vw;min-width:80vw}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_close{right:15px;top:15px}}@media screen and (max-width:500px){.mb-20{margin-bottom:15px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{max-width:200px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary{display:block !important;margin-left:0 !important;margin-right:0;width:100% !important}.wp2fa-modal .modal\_\_content .wizard-tooltip{right:5px;bottom:5px}.verification-response:not(:empty){width:auto}}.wizard-custom-counter{counter-reset:step-counter;list-style:none;margin-bottom:0 !important}.wizard-custom-counter li{counter-increment:step-counter}.wizard-custom-counter li:last-of-type{margin-bottom:0 !important}.enable\_styling .wizard-custom-counter li::before{content:counter(step-counter);background:#3e6bff;width:20px;height:20px;color:white;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.enable\_styling #backup-codes-wrapper{border:none;border-bottom:3px solid #d0e5ff;color:#4498ff;font-size:1pc;font-weight:700;line-height:1;margin:0;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;line-height:26px;background-color:transparent !important}.enable\_styling #backup-codes-wrapper :focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling #backup-codes-wrapper:focus-visible{border-bottom:3px solid #4498ff;outline:none}.default\_styling .wizard-custom-counter li::before{content:counter(step-counter);width:20px;height:20px;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.mb-0{margin-bottom:0 !important}.wp-2fa-user-profile-form{margin:~~20px~~ 0}body:not(.wp-admin) .wp-2fa-user-profile-form td,body:not(.wp-admin) .wp-2fa-user-profile-form th{padding:0;border:none}.wp-2fa-user-profile-form{border:none}.wp-2fa-button-primary+.wp-2fa-button-secondary{margin-left:10px}.modal-logo-wrapper{text-align:center;padding:0;margin:0}.iti\_\_flag-container{width:100%}.iti\_\_country-list{width:100%}.wizard-step label[for="authy-token"]{min-height:70px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel label[for="authy-token"]{min-height:300px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel .authy-step-setting-wrapper{overflow:hidden}.wizard-step.expand-panel .iti\_\_country-list{width:100%;max-height:240px}[aria-describedby="authy-diag"],[aria-describedby="twilio-diag"]{min-width:400px;padding:10px}[aria-describedby="authy-diag"] .ui-dialog-titlebar,[aria-describedby="twilio-diag"] .ui-dialog-titlebar{background:#fff;border-bottom:none;height:auto;font-size:18px;font-weight:600;line-height:2;padding:10px 36px 0 16px;word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}[aria-describedby="authy-diag"] .ui-dialog-buttonpane,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane{background:#fff;border-top:none;padding:16px}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;height:auto;margin-left:0}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button:hover,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button:hover{background-color:#3e6bff;color:#fff}[aria-describedby="authy-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset{float:left}[aria-describedby="authy-diag"] .ui-dialog-content,[aria-describedby="twilio-diag"] .ui-dialog-content{padding:0 16px 9px;overflow:auto} |
  |  | 2 | .mt-5px{margin-top:7px;display:inline-block}label.radio-inline{padding-left:8px}.wp2fa-modal{font-family:helvetica}.modal\_\_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;justify-content:center;align-items:center;z-index:9999}.modal\_\_container{background-color:#fff;padding:40px 40px 30px;max-width:500px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box;z-index:1500}.modal\_\_header{display:flex;justify-content:space-between;align-items:center}.modal\_\_title{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#222;box-sizing:border-box}.modal\_\_close{border:0;outline:none;z-index:10}.modal\_\_close:hover{cursor:pointer}.modal\_\_header .modal\_\_close:before,.wp2fa-modal .modal\_\_close:before{content:"✕"}.modal\_\_content{font-size:13px;font-weight:500;height:100%;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content p{font-size:13px;font-weight:500;line-height:24px;margin-bottom:2px;color:#222;margin-top:0;word-break:keep-all;width:100%}.modal\_\_content label{font-size:14px;line-height:28px;color:#222;margin-top:0;word-break:keep-all;width:100%;display:block}.modal\_\_content p.description{font-size:12px;line-height:24px;opacity:0.9}.modal\_\_content .apps-wrapper{position:relative;overflow:hidden;display:flex}.modal\_\_content .apps-wrapper .app-logo{display:flex;align-self:center;flex:1;padding:0 13px}.modal\_\_content .apps-wrapper .app-logo img{margin:0 auto;width:auto;max-width:100%}.modal\_\_content .wp2fa-setup-actions{clear:both}.modal\_\_content .iti--allow-dropdown{width:100%}.modal\_\_btn-primary{background-color:#00449e;color:#fff}.enable\_styling .modal\_\_content input[type="radio"]{margin-left:0;appearance:auto;width:auto;height:auto;background:transparent}.enable\_styling .modal\_\_content input[type="radio"]:after{display:none}.enable\_styling .modal\_\_content input[type="radio"]:focus{border-color:transparent;box-shadow:none;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):not(.app-key){line-height:1;margin-bottom:10px;min-height:2pc;min-width:15pc;padding:5px;margin:0px;border:none;border-bottom:3px solid #d0e5ff;width:100%;padding:10px 0;font-size:16px;font-weight:700;color:#4498ff;box-shadow:none}.enable\_styling .modal\_\_content input:not([type="radio"]):focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling .modal\_\_content input:not([type="radio"]):-internal-autofill-selected{background-color:transparent}.enable\_styling .iti--allow-dropdown input[type=tel]{z-index:100;background:transparent}.enable\_styling .iti\_\_flag-container{width:auto;z-index:101}.enable\_styling .expand-panel .iti\_\_flag-container{width:100%}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .modal\_\_overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .modal\_\_container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .modal\_\_container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .modal\_\_container,.micromodal-slide .modal\_\_overlay{will-change:transform}.danger-zone-wrapper{padding:15px;border:1px solid red;border-radius:3px;margin-top:15px}.learn\_more\_link{display:inline-block;margin-left:10px;margin-top:6px}.wp-2fa-settings-wrapper .disabled{opacity:0.5;pointer-events:none}.wp-2fa-settings-wrapper .disabled \*{pointer-events:none}.wp2fa-modal .modal\_\_container{max-height:70vh;max-width:872px;min-width:30vw;position:relative}.wp2fa-modal .modal\_\_close{background:transparent;color:#4498ff !important;font-size:15px;font-weight:700;position:absolute;right:20px;text-decoration:none;top:20px;background-color:transparent !important}.wp2fa-modal .modal\_\_close :hover{color:#888;cursor:pointer}.wp2fa-modal input[type=radio]:checked:before{display:none}.wizard-step:not(.active),.step-setting-wrapper:not(.active){display:none}.wizard-step.active,.step-setting-wrapper.active{-webkit-animation:fadein 0.5s;-moz-animation:fadein 0.5s;-ms-animation:fadein 0.5s;-o-animation:fadein 0.5s;animation:fadein 0.5s}#configure-2fa .wp2fa-setup-actions,#configure-2fa-backup-codes .wp2fa-setup-actions{margin-top:25px}.modal\_\_btn+.modal\_\_btn{margin-left:10px}.wp-2fa-configuration-form td.backup-methods-label,.wp-2fa-configuration-form th{display:none}.wp2fa-modal h4,.wp2fa-modal h3{word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}.wp2fa-modal.enable\_styling h4,.wp2fa-modal.enable\_styling h3{font-family:helvetica !important}.wp2fa-modal fieldset{padding:0;border:0}.wp2fa-modal ol{margin:0 0 15px;padding-left:17px}.wp2fa-modal ol li{position:relative;padding:6px}.wp2fa-modal .modal\_\_content code.app-key{font-size:16px;padding:7px 12px;word-break:break-all;background:#efefef;color:#222}label+.verification-response{margin-top:20px}.verification-response:not(:empty){border:3px solid red;font-size:9pt;margin-bottom:15px;padding:10px;background:#ffe4e4;border-radius:10px;font-size:9pt;line-height:24px;width:100%}.default\_styling .verification-response:not(:empty){width:calc(100% - 30px)}.wp-2fa-configuration-form .button.enable\_styling{background-color:#fff !important;color:#3e6bff !important;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff !important;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px}.wp-2fa-configuration-form .button.enable\_styling:hover{background-color:#3e6bff !important;color:#fff !important;border:3px solid #3e6bff !important}.wp2fa-modal.enable\_styling .modal\_\_content .wp2fa-setup-actions .button:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-confirm:focus,.wp2fa-modal.enable\_styling .modal\_\_content .modal\_\_btn.button-decline:focus{box-shadow:none}.wp2fa-modal.enable\_styling .button+.button{margin-left:10px}.modal\_\_footer{margin-top:20px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary,.enable\_styling #wizard-api-key button,.enable\_styling #wizard-sid-key button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;transition:all 0.2s ease-in-out}.enable\_styling .wp-2fa-button-secondary{color:#555;border:3px solid #555}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary{color:#555 !important;border:3px solid #555 !important}.enable\_styling .wp-2fa-button-primary:focus,.enable\_styling .wp-2fa-button-secondary:focus{box-shadow:none}.enable\_styling .wp-2fa-button-primary:hover{background-color:#3e6bff;color:#fff;border:3px solid #3e6bff;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-button-secondary:hover{background-color:#555;color:#fff;border:3px solid #555;transition:all 0.4s ease-in-out}.enable\_styling .wp-2fa-configuration-form .button.wp-2fa-button-secondary:hover,.enable\_styling #wizard-api-key button:hover,.enable\_styling #wizard-sid-key button:hover{background-color:#555 !important;color:#fff !important;border:3px solid #555 !important}.wp-2fa-configuration-form .button{margin-right:10px}.wp-2fa-configuration-form .button:hover{cursor:pointer}.qr-code-wrapper{position:relative;overflow:hidden;float:right}#notify-users .modal\_\_container \*{opacity:1;transition:all 0.3s ease-in-out}#notify-users .modal\_\_container.saving \*{opacity:0;transition:all 0.3s ease-in-out}.qr-code-wrapper.regenerating img{visibility:hidden}#backup-codes-wrapper{border:none;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;background-color:transparent !important}#backup-codes-wrapper :focus-visible{outline:none}#backup-codes-wrapper:focus-visible{outline:none}.qr-code-wrapper.regenerating:before,#notify-users .modal\_\_container.saving:before{content:"";box-sizing:border-box;position:absolute;top:50%;left:50%;width:20px;height:20px;margin-top:-10px;margin-left:-10px;border-radius:50%;border:2px solid #ccc;border-top-color:#000;animation:spinner 0.6s linear infinite}@keyframes spinner{to{transform:rotate(360deg)}}.default\_styling .radio-cells .option-pill{position:relative;margin-bottom:11px}.default\_styling .radio-cells .option-pill label{padding-right:40px;font-size:12px}.default\_styling .wizard-tooltip{display:none !important}.default\_styling input[type=checkbox],.default\_styling input[type=radio]{-webkit-appearance:auto}@media screen and (max-width:1299px){.wp2fa-modal .modal\_\_container{max-width:96vw}#wp-2fa-totp-qrcode{max-width:100%;text-align:center;margin:15px auto;display:block}.qr-code-wrapper{float:none}.step-setting-wrapper br{display:none}.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.enable\_styling .radio-cells .option-pill p{height:100%}.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.enable\_styling .option-pill{margin-bottom:15px}.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .modal\_\_content code br{display:block !important}.wp2fa-modal .modal\_\_content code.app-key{width:100%;display:block;text-align:center;font-size:16px;margin-bottom:30px;background:#efefef;padding:5px;word-break:break-all}.wp2fa-modal .modal\_\_content .apps-wrapper{margin:10px 0}.wp2fa-modal .modal\_\_content a.app-logo{padding:0 5px}.wp2fa-modal .modal\_\_content .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .modal\_\_content .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal .modal\_\_content .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .modal\_\_content .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .modal\_\_content .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .modal\_\_content .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus-visible,.wp2fa-modal .modal\_\_content .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp-2fa-configuration-form .button{width:auto;display:block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.modal\_\_content input:not([type="radio"]){width:100%;margin-bottom:10px}.hide-on-mobile{display:none}.wp2fa-modal h4,.wp2fa-modal h3{font-size:20px}.wp2fa-modal h4{clear:both}}@media screen and (min-width:1300px){.wp2fa-modal .clear-both{clear:both;display:block;overflow:hidden}.wp2fa-modal .modal-50{width:50%;display:inline-block;float:left}.wp2fa-modal .modal-60{width:70%;display:inline-block;float:left}.wp2fa-modal .modal-60 .radio-cells{width:100%;padding-left:10px}.wp2fa-modal .modal-40{width:30%;float:left;display:flex;justify-content:center}.wp2fa-modal .mb-20{margin-bottom:20px}.wp2fa-modal.enable\_styling p+.radio-cells,.wp2fa-modal.enable\_styling p+fieldset{margin:20px 0;display:flex;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells{display:flex;flex-wrap:wrap;margin:0px 0 20px;width:calc(100% + 10px);position:relative;left:-5px;flex-wrap:wrap}.wp2fa-modal.enable\_styling .radio-cells input:not([type="radio"]){margin-top:5px}.wp2fa-modal.enable\_styling .radio-cells .option-pill{flex-basis:0;flex-grow:1;border:3px solid #eee;border-radius:10px;padding:10px;margin:5px;font-size:11px;position:relative}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{height:100%}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill{flex:33.333%;display:flex;flex-direction:column}.wp2fa-modal.enable\_styling .radio-cells.max-3 .option-pill p{flex:1}.wp2fa-modal.enable\_styling .radio-cells .option-pill.isSelected{border:3px solid #007cba}.wp2fa-modal.enable\_styling .radio-cells .option-pill label{display:block;font-size:13px;line-height:24px;font-weight:500;margin-bottom:2px;height:100%;max-width:calc(100% - 20px)}.wp2fa-modal.enable\_styling .radio-cells .option-pill p{font-size:12px;line-height:23px;opacity:0.9;height:auto}.wp2fa-modal .wizard-tooltip{background:#3e6bff;color:white;height:18px;display:inline-block;width:18px;border-radius:50%;position:absolute;overflow:hidden;text-align:center;line-height:18px;font-weight:700;margin-left:4px;margin-top:3px;bottom:10px;right:17px}.wp2fa-modal .inline-helper{background:#eee;padding:10px;border-radius:10px;display:block;margin-top:10px;font-size:12px;line-height:24px;display:none}.wp2fa-modal.enable\_styling .tooltip-content-wrapper{display:none}.wp2fa-modal .click-to-copy{border:2px solid #3e6bff;border-radius:14px;display:inline-block;font-size:10px;padding:0 9px;font-weight:700;line-height:16px}.wp2fa-modal .click-to-copy.done{background-color:green !important;border:2px solid green;color:white}.wp2fa-modal .click-to-copy:hover{background-color:#3e6bff;color:white;cursor:pointer;opacity:0.5}.wp2fa-modal .app-key-wrapper{background:#eee;border-radius:4px;margin:10px 0 5px;overflow:hidden;padding:3px 7px}.wp2fa-modal .app-key-wrapper input{background:transparent;border:none;display:inline-block;font-size:9pt;margin:0 10px 0 0;max-width:15pc;min-height:0;min-width:200px;padding:0;color:#888}.wp2fa-modal .app-key-wrapper input:focus-visible,.wp2fa-modal .app-key-wrapper input:focus{border:none;background-color:transparent;outline:none}.wp2fa-modal .option-pill{margin-bottom:15px}.wp2fa-modal .qr-code{float:left;width:100%;position:relative;left:-2%}.wp2fa-modal .mb-30{margin-bottom:30px}.show-on-mobile{display:none}}@media (max-width:500px){.modal\_\_container{padding:25px}.option-pill:not(last-of-type){margin-bottom:40px}.wp2fa-modal .modal\_\_content .apps-wrapper{display:block}.wp2fa-modal .modal\_\_content a.app-logo{width:calc(33.33333% - 13px);display:inline-block;margin-bottom:5px}.wp2fa-modal h4,.wp2fa-modal h3{font-size:18px;margin-bottom:9px}#configure-2fa-backup-codes .wp2fa-setup-actions,#configure-2fa .wp2fa-setup-actions{margin-top:15px}.wp2fa-modal .modal\_\_content .modal\_\_btn,.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp-2fa-configuration-form .button{display:block;margin-bottom:10px;margin-left:0;margin-right:0;text-align:center;width:auto;padding:10px 15px;font-size:12px}.wp2fa-modal .modal\_\_content .radio-cells .option-pill{flex-basis:unset;flex-grow:1}.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}}@media screen and (min-width:801px) and (max-width:1299px){.wp2fa-modal .modal\_\_content p+.radio-cells{margin-top:20px}.modal-50{width:50%;display:inline-block;float:left}.mb-20{margin-bottom:20px}.modal-60{width:70%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.modal-40{width:30%;float:left;display:flex;justify-content:center}}@media screen and (min-width:1024px){.wp2fa-modal .modal\_\_container{min-width:768px}}@media screen and (min-width:501px) and (max-width:800px){.modal-50{width:50%;display:inline-block;float:left}.modal-60{width:60%;display:inline-block;float:left}.modal-60 .radio-cells{width:100%;padding-left:10px}.mb-20{margin-bottom:20px}.modal-40{width:40%;float:left;display:flex;justify-content:center}}@media screen and (max-width:800px){.wp2fa-modal .modal\_\_container{max-width:95vw;min-width:80vw}.wp2fa-modal .modal\_\_content .wp2fa-setup-actions .button,.wp2fa-modal .modal\_\_content .modal\_\_btn{width:auto;display:inline-block;margin-bottom:10px;margin-left:0px;margin-right:0px;text-align:center}.wp2fa-modal .modal\_\_close{right:15px;top:15px}}@media screen and (max-width:500px){.mb-20{margin-bottom:15px}.wp2fa-modal .modal\_\_content .app-key-wrapper input{max-width:200px}.enable\_styling .wp-2fa-button-primary,.enable\_styling .wp-2fa-button-secondary{display:block !important;margin-left:0 !important;margin-right:0;width:100% !important}.wp2fa-modal .modal\_\_content .wizard-tooltip{right:5px;bottom:5px}.verification-response:not(:empty){width:auto}}.wizard-custom-counter{counter-reset:step-counter;list-style:none;margin-bottom:0 !important}.wizard-custom-counter li{counter-increment:step-counter}.wizard-custom-counter li:last-of-type{margin-bottom:0 !important}.enable\_styling .wizard-custom-counter li::before{content:counter(step-counter);background:#3e6bff;width:20px;height:20px;color:white;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.enable\_styling #backup-codes-wrapper{border:none;border-bottom:3px solid #d0e5ff;color:#4498ff;font-size:1pc;font-weight:700;line-height:1;margin:0;min-height:2pc;min-width:15pc;padding:10px 0;width:100%;line-height:26px;background-color:transparent !important}.enable\_styling #backup-codes-wrapper :focus-visible{border-bottom:3px solid #4498ff;outline:none}.enable\_styling #backup-codes-wrapper:focus-visible{border-bottom:3px solid #4498ff;outline:none}.default\_styling .wizard-custom-counter li::before{content:counter(step-counter);width:20px;height:20px;text-align:center;display:inline-block;line-height:20px;position:absolute;left:-20px;top:8px;font-size:14px;font-weight:700;border-radius:50px}.mb-0{margin-bottom:0 !important}.wp-2fa-user-profile-form{margin:0}.wp-2fa-user-profile-form:first-of-type{margin-top:20px}.wp-2fa-user-profile-form:last-of-type{margin-bottom:20px}.wp-2fa-user-profile-form tr+tr th,.wp-2fa-user-profile-form tr+tr td{padding-top:0}.remove-tr-padding th,.remove-tr-padding td{padding-bottom:0}body:not(.wp-admin) .wp-2fa-user-profile-form td,body:not(.wp-admin) .wp-2fa-user-profile-form th{padding:0;border:none}.wp-2fa-user-profile-form{border:none}.wp-2fa-button-primary+.wp-2fa-button-secondary{margin-left:10px}.modal-logo-wrapper{text-align:center;padding:0;margin:0}.iti\_\_flag-container{width:100%}.iti\_\_country-list{width:100%}.wizard-step label[for="authy-token"]{min-height:70px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel label[for="authy-token"]{min-height:300px;-webkit-transition:min-height 0.2s ease-in-out;-moz-transition:min-height 0.2s ease-in-out;-ms-transition:min-height 0.2s ease-in-out;-o-transition:min-height 0.2s ease-in-out;transition:min-height 0.2s ease-in-out}.wizard-step.expand-panel .authy-step-setting-wrapper{overflow:hidden}.wizard-step.expand-panel .iti\_\_country-list{width:100%;max-height:240px}[aria-describedby="authy-diag"],[aria-describedby="twilio-diag"]{min-width:400px;padding:10px}[aria-describedby="authy-diag"] .ui-dialog-titlebar,[aria-describedby="twilio-diag"] .ui-dialog-titlebar{background:#fff;border-bottom:none;height:auto;font-size:18px;font-weight:600;line-height:2;padding:10px 36px 0 16px;word-wrap:break-word;font-family:helvetica;font-size:22px;font-weight:700;margin-bottom:15px;margin-top:0;margin:0 0 10px 0}[aria-describedby="authy-diag"] .ui-dialog-buttonpane,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane{background:#fff;border-top:none;padding:16px}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button{background-color:#fff;color:#3e6bff;font-size:14px;line-height:14px;margin-bottom:10px;outline:none;padding:13px 13pt;text-align:center;text-decoration:none;font-weight:800;display:inline-block;border:3px solid #3e6bff;border-radius:30px;text-transform:uppercase;letter-spacing:0.3px;-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;height:auto;margin-left:0}[aria-describedby="authy-diag"] .ui-dialog-buttonset .ui-button:hover,[aria-describedby="twilio-diag"] .ui-dialog-buttonset .ui-button:hover{background-color:#3e6bff;color:#fff}[aria-describedby="authy-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset,[aria-describedby="twilio-diag"] .ui-dialog-buttonpane .ui-dialog-buttonset{float:left}[aria-describedby="authy-diag"] .ui-dialog-content,[aria-describedby="twilio-diag"] .ui-dialog-content{padding:0 16px 9px;overflow:auto} |
* ## [wp-2fa/trunk/dist/js/admin.js](/changeset/3009922/wp-2fa/trunk/dist/js/admin.js "Show the changeset 3009922 restricted to wp-2fa/trunk/dist/js/admin.js")

  | [r2940688](/browser/wp-2fa/trunk/dist/js/admin.js?rev=2940688#L2 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/dist/js/admin.js?rev=3009922#L2 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | try{ |
  | 3 | 3 | jQuery(document).ready(function(){if(jQuery('.wp-2fa-settings-wrapper .notice').length){jQuery('.wp-2fa-settings-wrapper .notice').addClass('2fa-budged');jQuery('.wp-2fa-settings-wrapper .notice').insertBefore('.wp-2fa-settings-wrapper');jQuery('.2fa-budged').css('margin-left','0');} |
  | 4 |  | if(jQuery('#excluded\_sites\_search').length){const usersUrl=`${wp2faData.ajaxURL}?action=get\_all\_network\_sites&wp\_2fa\_nonce=${wp2faData.nonce}`;jQuery('#excluded\_sites\_search').autocomplete({source:usersUrl,minLength:1,focus:function(){return false;},select:function(event,ui){const currentlyExcluded=jQuery('#excluded\_sites').val();if(!currentlyExcluded.includes(ui.item.value)){jQuery('#excluded\_sites').val(`${currentlyExcluded + ui.item.value},`);} |
  |  | 4 | if(jQuery('#excluded\_sites\_search').length){const usersUrl=`${wp2faData.ajaxURL}?action=wp\_2fa\_get\_all\_network\_sites&wp\_2fa\_nonce=${wp2faData.nonce}`;jQuery('#excluded\_sites\_search').autocomplete({source:usersUrl,minLength:1,focus:function(){return false;},select:function(event,ui){const currentlyExcluded=jQuery('#excluded\_sites').val();if(!currentlyExcluded.includes(ui.item.value)){jQuery('#excluded\_sites').val(`${currentlyExcluded + ui.item.value},`);} |
  | 5 | 5 | const excludedUsersArray=jQuery('#excluded\_sites').val().split(',');jQuery('#excluded\_sites\_buttons').html('');jQuery.each(excludedUsersArray,function(i){if(excludedUsersArray[i]){jQuery('#excluded\_sites\_buttons').append(`<a class="user-btn button button-secondary" data-user-value="${excludedUsersArray[i]}">${excludedUsersArray[i].split( ':' )[0]}<span class="remove-item">x</span></a>`);}});jQuery('#excluded\_sites\_search').val('');return false;},open:function(event,ui){jQuery('.ui-menu-item').each(function(i,obj){var originalLabel=jQuery(this).text();jQuery(this).text(originalLabel.split(':')[0]);});}});var excludedUsersArray=jQuery('#excluded\_sites').val().split(',');jQuery.each(excludedUsersArray,function(i){if(excludedUsersArray[i]){jQuery('#excluded\_sites\_buttons').append(`<a class="user-btn button button-secondary" data-user-value="${excludedUsersArray[i]}">${excludedUsersArray[i].split( ':' )[0]}<span class="remove-item">x</span></a>`);}});} |
  | 6 | 6 | jQuery('body').on('click','.remove-item',function(e){e.preventDefault();var textToRemove=jQuery(this).closest('.user-btn').attr('data-user-value');var textToRemove=`${textToRemove},`;var currentlyExcluded=jQuery(this).closest('div').siblings('input[type="hidden"]').val();var currentlyExcluded=currentlyExcluded.replace(textToRemove,'');jQuery(this).closest('div').siblings('input[type="hidden"]').val(currentlyExcluded);jQuery(this).closest('.user-btn').remove();});jQuery('[name="wp\_2fa\_policy[enforcement-policy]"], [name="wp\_2fa\_policy[grace-policy]"]').on("input",function(){if(jQuery('input[name="wp\_2fa\_policy[grace-policy]"]:checked').val()=='no-grace-period'&&jQuery('input[name="wp\_2fa\_policy[enforcement-policy]"]:checked').val()=='all-users'){var userToAdd=jQuery('[data-user-login-name]').attr('data-user-login-name');var targetElement=jQuery('#excluded-users-multi-select');if(jQuery('#exclude-self-from-instant-2fa').length&&!jQuery(targetElement).find('option[value="'+userToAdd+'"]').length){MicroModal.show('exclude-self-from-instant-2fa');}}});jQuery('body').on('click','[data-user-login-name]',function(e){e.preventDefault();var newValue=[];var userToAdd=jQuery('[data-user-login-name]').attr('data-user-login-name');newValue.push(userToAdd);var targetElement=jQuery('#excluded-users-multi-select');if(!jQuery(targetElement).find('option[value="'+newValue+'"]').length){var newState=new Option(newValue,newValue,true,true);jQuery(targetElement).append(newState).trigger('change');}});jQuery('body').on('input','input[type="number"]#grace-period',function(e){var targetElm=jQuery(this);var currentValue=targetElm.val();var newValue=!!currentValue&&0<=Math.abs(currentValue)?Math.abs(currentValue):null;var upperLimit=targetElm.attr('max');if(parseInt(upperLimit)<parseInt(newValue)){newValue=upperLimit;} |
  | 7 | 7 | if(newValue!=currentValue){targetElm.val(newValue);}});jQuery('body').on('focusout','input[type="number"]#grace-period',function(e){var targetElm=jQuery(this);var currentValue=targetElm.val();var minVal=targetElm.attr('min');if(''===jQuery.trim(currentValue)){targetElm.val(minVal);}});jQuery('body').on('click','input[type="checkbox"]#grace-cron',function(e){if(jQuery(this).is(':checked')){jQuery('.destory-session-setting').removeClass('disabled');}else if(jQuery(this).is(':not(:checked)')){jQuery('.destory-session-setting').addClass('disabled');jQuery('input[type="checkbox"]#destory-session').prop('checked',false);}});if(jQuery('input[type="checkbox"]#grace-cron').is(':checked')){jQuery('.destory-session-setting').removeClass('disabled');}else if(jQuery('input[type="checkbox"]#grace-cron').is(':not(:checked)')){jQuery('.destory-session-setting').addClass('disabled');jQuery('input[type="checkbox"]#destory-session').prop('checked',false);} |
  | 8 | 8 | jQuery('body').on('click','input[type="radio"][id\*="use\_custom\_page"]',function(e){if(jQuery(this).attr('id').indexOf('dont')&&jQuery(this).is(':checked')){jQuery(this).closest('table').find('.custom-user-page-setting').removeClass('disabled');if(jQuery('#custom-user-page-url').val().trim().length===0){jQuery('#custom-user-page-url').val('/wp-2fa-config/');}}else{jQuery(this).closest('table').find('.custom-user-page-setting').addClass('disabled');if(jQuery('#custom-user-page-url').val().trim().length===0){jQuery('#custom-user-page-url').val('');}}});jQuery('body').on('click','input[type="checkbox"][name\*="enable\_email"]',function(e){if(jQuery(this).is(':checked')){jQuery(this).parent().parent().find('div.use-different-hotp-mail').removeClass('disabled');}else{jQuery(this).parent().parent().find('div.use-different-hotp-mail').addClass('disabled');}});jQuery('body').on('click','input[type="checkbox"][name\*="enable\_trusted\_devices"]',function(e){if(jQuery(this).is(':checked')){jQuery(this).closest('table').find('.trusted-settings').removeClass('disabled');}else{jQuery(this).closest('table').find('.trusted-settings').addClass('disabled');}});jQuery('body').on('click','input[type="checkbox"][name\*="enable\_oob\_email"]',function(e){if(jQuery(this).is(':checked')){jQuery(this).parent().parent().find('div.use-different-oob-mail').removeClass('disabled');}else{jQuery(this).parent().parent().find('div.use-different-oob-mail').addClass('disabled');}});jQuery('body').on('click','.js-button-test-email-trigger',function(e){e.preventDefault();const button=jQuery(this);const emailId=button.attr('data-email-id');const nonceValue=button.attr('data-nonce');button.append('<span class="spinner is-active"></span>');const spinner=button.find('.spinner');button.siblings('.notice').remove();button.attr('disabled','disabled');button.addClass('has-spinner');jQuery.post(wp2faData.ajaxURL,{action:'wp2fa\_test\_email',email\_id:emailId,\_wpnonce:nonceValue}).done(function(data){let classes='notice notice-after-button notice-';classes+=(data.success)?'success':'error';var message=(data.success)?wp2faData.email\_sent\_success:wp2faData.email\_sent\_failure;if('data'in data){message=data.data;} |
  | 9 |  | button.after(`<span class="${classes}">${message}</span>`);spinner.remove();button.removeClass('has-spinner');button.removeAttr('disabled');});});jQuery('body').on('click','input[type="checkbox"].disabled[data-disabled-hint]',function(e){var text=jQuery(this).attr('data-disabled-hint');jQuery('<p id="setup-warning" style="color: red:>'+text+'</p>').insertAfter(this).delay(2000).remove();});jQuery('.white-labelling-tabs #wp2fa\_links-inner-wrapper a').each(function(i){if(window.location.href==jQuery(this).attr('href')){jQuery(this).addClass('nav-tab-active');}else{jQuery(this).removeClass('nav-tab-active');}});}); |
  |  | 9 | button.after(`<span class="${classes}">${message}</span>`);spinner.remove();button.removeClass('has-spinner');button.removeAttr('disabled');});});jQuery('body').on('click','input[type="checkbox"].disabled[data-disabled-hint]',function(e){var text=jQuery(this).attr('data-disabled-hint');jQuery('<p id="setup-warning" style="color: red:>'+text+'</p>').insertAfter(this).delay(2000).remove();});jQuery('.white-labelling-tabs #wp2fa\_links-inner-wrapper a').each(function(i){if(window.location.href==jQuery(this).attr('href')){jQuery(this).addClass('nav-tab-active');}else{jQuery(this).removeClass('nav-tab-active');}});jQuery('body').on('click','.notice-success.is-dismissible.2fa-budged .notice-dismiss',function(e){jQuery('.notice-success.is-dismissible.2fa-budged').slideUp();});jQuery('.2fa-email-notice').click(function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({type:'POST',url:wp2faData.ajaxURL,async:true,data:{action:'wp2fa\_dismiss\_notice\_mail\_domain',nonce:jQuery('#wp2fa\_dismiss\_notice\_mail\_domain').val()},success:function(data){jQuery(thisNotice).slideUp();}});});}); |
  | 10 | 10 | } |
  | 11 | 11 | catch(e){console.error("An error has occurred settings.js: "+e.stack);} |
  | […](/browser/wp-2fa/trunk/dist/js/admin.js?rev=2940688#L17) | […](/browser/wp-2fa/trunk/dist/js/admin.js?rev=3009922#L17) |  |
  | 17 | 17 | updateStepTitles();jQuery('body').on('click','.step-title',function(e){var currentLabel=jQuery(this).text().substr(2);jQuery('[data-step-title]:not(.hidden)').each(function(){var currentStep=jQuery(this);jQuery('[data-step-title]').removeClass('active');jQuery('.step-title').removeClass('active-step-title');var stepLabel=jQuery(this).attr('data-step-title');jQuery(`[data-step-title="${currentLabel}"]`).addClass('active');});updateStepTitles();});jQuery('[data-unhide-when-checked]').each(function(){if(jQuery(this).is(':checked')){const thingToShow=jQuery(this).attr('data-unhide-when-checked');jQuery(thingToShow).show(0);}});jQuery('body').on('click','[for="all-users"], [for="certain-roles-only"]',function(e){jQuery('.step-setting-wrapper.hidden').removeClass('hidden').addClass('un-hidden');updateStepTitles();});jQuery('body').on('click','[for="do-not-enforce"]',function(e){jQuery('.step-setting-wrapper.un-hidden').removeClass('un-hidden').addClass('hidden');updateStepTitles();});jQuery('body').on('click','.modal\_\_btn',function(e){e.preventDefault();});jQuery('body').on('keypress','.wp2fa-modal',function(event){var keycode=(event.keyCode?event.keyCode:event.which);if('13'==keycode){return false;}});jQuery(document).on('click','[data-open-configure-2fa-wizard]',function(event){event.preventDefault();wp2fa\_fireWizard();});jQuery(document).on('click','.step-setting-wrapper.active .option-pill input[type="checkbox"]',function(e){if('backup-codes'!==this.id&&!jQuery(this).hasClass('disabled')){if(true!==jQuery('#geek').prop('checked')&&true!==jQuery('#basic').prop('checked')){jQuery('#backup-codes').addClass('disabled');jQuery('label[for=\'backup-codes\']').addClass('disabled');window.backupCodes=jQuery('#backup-codes').prop('checked');jQuery('#backup-codes').prop('checked',false);if(jQuery('[name="next\_step\_setting"]').length){jQuery('[name="next\_step\_setting"]').addClass('disabled').attr('name','next\_step\_setting\_disabled');}}else{jQuery('#backup-codes').removeClass('disabled');jQuery('label[for=\'backup-codes\']').removeClass('disabled');if('undefined'!==window.backupCodes){jQuery('#backup-codes').prop('checked',window.backupCodes);} |
  | 18 | 18 | if(jQuery('[name="next\_step\_setting\_disabled"]').length){jQuery('[name="next\_step\_setting\_disabled"]').removeClass('disabled').attr('name','next\_step\_setting');}}}else{if(!jQuery(this).hasClass('disabled')){window.backupCodes=jQuery('#backup-codes').prop('checked');}else{jQuery('#backup-codes').prop('checked',false);}}});jQuery(document).on('click touchend','.radio-cells label, .radio-cells input[type="radio"]',function(e){jQuery('.option-pill').removeClass('isSelected');jQuery('.radio-cells input[type="radio"]:checked').closest('.option-pill').addClass('isSelected');});jQuery('.wizard-tooltip').each(function(){var contentDiv=jQuery(this).attr('data-tooltip-content');var ourItem=jQuery(this);if(jQuery('['+contentDiv+']').length){var content=jQuery('['+contentDiv+']').clone();jQuery(ourItem).append(content);}});jQuery(document).on('click touchend','.wizard-tooltip',function(e){var contentDiv=jQuery(this).attr('data-tooltip-content');var ourItem=jQuery(this);if(jQuery(this).hasClass('isOpen')){jQuery('.inline-helper').slideDown();}else{jQuery('[data-tooltip-content]').removeClass('isOpen');setTimeout(function(){if(jQuery('.inline-helper').length>2){jQuery('.inline-helper').not('['+contentDiv+']').slideUp();}},100);setTimeout(function(){if(jQuery('.inline-helper').length>2){jQuery('.inline-helper').not('['+contentDiv+']').remove();}},600);if(jQuery('['+contentDiv+']').length){var content=jQuery('['+contentDiv+']').html();jQuery('<div class="inline-helper" '+contentDiv+'>'+content+'</div>').insertAfter('.radio-cells');jQuery('.inline-helper').slideDown();} |
  | 19 |  | jQuery(ourItem).addClass('isOpen');}});jQuery(document).on('click','.2fa-method-select input[type="checkbox"]',function(e){let role\_suffix=('global'===jQuery(this).data('role'))?'':'-'+jQuery(this).data('role');if('backup-codes'+role\_suffix!==this.id&&!jQuery(this).hasClass('disabled')){let backDisabled=false;if(true!==jQuery('#totp'+role\_suffix).prop('checked')&&true!==jQuery('#hotp'+role\_suffix).prop('checked')){backDisabled=true;if(jQuery('#oob'+role\_suffix).length){if(true===jQuery('#oob'+role\_suffix).prop('checked')){backDisabled=false;}} |
  |  | 19 | jQuery(ourItem).addClass('isOpen');}});jQuery(document).on('click','.wp-2fa-method-select input[type="checkbox"]',function(e){let role\_suffix=('global'===jQuery(this).data('role'))?'':'-'+jQuery(this).data('role');if('backup-codes'+role\_suffix!==this.id&&!jQuery(this).hasClass('disabled')){let backDisabled=false;if(true!==jQuery('#totp'+role\_suffix).prop('checked')&&true!==jQuery('#hotp'+role\_suffix).prop('checked')){backDisabled=true;if(jQuery('#oob'+role\_suffix).length){if(true===jQuery('#oob'+role\_suffix).prop('checked')){backDisabled=false;}} |
  | 20 | 20 | if(jQuery('#authy'+role\_suffix).length){setTimeout(function(){},2000);if(true===jQuery('#authy'+role\_suffix).prop('checked')){backDisabled=false;}} |
  | 21 | 21 | if(jQuery('#twilio'+role\_suffix).length){setTimeout(function(){},2000);if(true===jQuery('#twilio'+role\_suffix).prop('checked')){backDisabled=false;}}} |
  | 22 |  | if(backDisabled){jQuery('#backup-codes'+role\_suffix).addClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').addClass('disabled');window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');jQuery('#backup-codes'+role\_suffix).prop('checked',false);jQuery('[for="all-users"], [for="certain-roles-only"]').addClass('disabled');}else{jQuery('[for="all-users"], [for="certain-roles-only"]').removeClass('disabled');jQuery('#backup-codes'+role\_suffix).removeClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').removeClass('disabled');if('undefined'!==window.backupCodes){jQuery('#backup-codes'+role\_suffix).prop('checked',window.backupCodes);}}}else{if(!jQuery(this).hasClass('disabled')){window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');}else{jQuery('#backup-codes'+role\_suffix).prop('checked',false);}}});jQuery(document).on('click','.wp2fa-setup-form .~~2fa-method-select input[type="checkbox"]',function(e){~~let twilio=false;let authy=false;if(jQuery('#twilio').length){if(jQuery('#twilio[data-sid-setup-wizard]').length&&jQuery('#wizard-sid-key').is(':visible')){twilio=false;}else{twilio=jQuery('#twilio').prop('checked');}} |
  |  | 22 | if(backDisabled){jQuery('#backup-codes'+role\_suffix).addClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').addClass('disabled');window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');jQuery('#backup-codes'+role\_suffix).prop('checked',false);jQuery('[for="all-users"], [for="certain-roles-only"]').addClass('disabled');}else{jQuery('[for="all-users"], [for="certain-roles-only"]').removeClass('disabled');jQuery('#backup-codes'+role\_suffix).removeClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').removeClass('disabled');if('undefined'!==window.backupCodes){jQuery('#backup-codes'+role\_suffix).prop('checked',window.backupCodes);}}}else{if(!jQuery(this).hasClass('disabled')){window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');}else{jQuery('#backup-codes'+role\_suffix).prop('checked',false);}}});jQuery(document).on('click','.wp2fa-setup-form .wp-2fa-method-select input[type="checkbox"]',function(e){alert('kur');let twilio=false;let authy=false;if(jQuery('#twilio').length){if(jQuery('#twilio[data-sid-setup-wizard]').length&&jQuery('#wizard-sid-key').is(':visible')){twilio=false;}else{twilio=jQuery('#twilio').prop('checked');}} |
  | 23 | 23 | if(jQuery('#authy').length){if(jQuery('#authy[data-api-setup-wizard]').length&&jQuery('#wizard-api-key').is(':visible')){authy=false;}else{authy=jQuery('#authy').prop('checked');}} |
  | 24 | 24 | if(true!==jQuery('#totp').prop('checked')&&true!==jQuery('#hotp').prop('checked')&&true!==jQuery('#oob').prop('checked')&&true!==authy&&true!==twilio){let showAlert=true;if(jQuery(this).is(jQuery('input#authy.disabled'))&&jQuery('#wizard-api-key').is(':visible')){showAlert=false;} |
  | […](/browser/wp-2fa/trunk/dist/js/admin.js?rev=2940688#L30) | […](/browser/wp-2fa/trunk/dist/js/admin.js?rev=3009922#L30) |  |
  | 30 | 30 | if(true===data.responseJSON.success){let nextSubStep=jQuery('#2fa-wizard-config-backup-codes');if(authcode){if(jQuery('#2fa-wizard-backup-methods').length){nextSubStep=jQuery('#2fa-wizard-backup-methods');}else if(jQuery('#2fa-wizard-email-backup-selected').length){nextSubStep=jQuery('#2fa-wizard-email-backup-selected');}} |
  | 31 | 31 | jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper').removeClass('active');jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');jQuery(document).on('click','#select-backup-method',function(e){e.preventDefault();var backupRadio=jQuery("input[name=backup\_method\_select]:checked");jQuery('.wizard-step.active').removeClass('active');jQuery('#'+backupRadio.data('step')).addClass('active');});jQuery(document).on('click','[name="save\_step"], [data-close-2fa-modal]',function(){if('redirectToUrl'in wp2faWizardData&&''!=jQuery.trim(wp2faWizardData.redirectToUrl)){window.location.replace(wp2faWizardData.redirectToUrl);}else{removeShowParam();}});}}},);});jQuery('body').on('click','.contains-hidden-inputs input[type="radio"]',function(e){if(jQuery(this).hasClass('js-nested')){return;} |
  | 32 |  | jQuery(this).closest('.contains-hidden-inputs').find('.hidden').hide(200);if(jQuery(this).is('[data-unhide-when-checked]')){const thingToShow=jQuery(this).attr('data-unhide-when-checked');if(jQuery(this).is(':checked')){jQuery(thingToShow).slideDown(200);}}});jQuery(document).on('click','.dismiss-user-configure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'dismiss\_nag'},complete:function(){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','.dismiss-user-reconfigure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'wp2fa\_dismiss\_reconfigure\_nag'},complete:function(data){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','[data-trigger-account-unlock]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-account-to-unlock');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'unlock\_account',user\_id:account,wp\_2fa\_nonce:nonce}});});jQuery(document).on('click','.remove-2fa',function(e){e.preventDefault();});jQuery(~~document).on('click','.modal\_\_close',function(e){e.preventDefault();if(jQuery(this).parent().find~~('#notify-users').length){MicroModal.show('notify-users');jQuery('.button-confirm').blur();}});jQuery(document).on('click touchend','.button-confirm',function(e){e.preventDefault();MicroModal.close('configure-2fa');MicroModal.close('notify-users');jQuery('.inline-helper').remove();});jQuery(document).on('click touchend','.button-decline',function(e){e.preventDefault();});jQuery(document).on('click','#close-settings',function(e){e.preventDefault();MicroModal.close('notify-admin-settings-page');window.location.replace(jQuery(this).data('redirect-url'));});jQuery(document).on('click','.first-time-wizard',function(e){e.preventDefault();MicroModal.show('notify-admin-settings-page');});jQuery(document).on('click','[data-trigger-remove-2fa]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_user\_2fa',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-trigger-remove-2fa-backup-email]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_backup\_email',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-submit-2fa-form]',function(e){jQuery('#submit').click();});function validateEmail(email){var re=/\S+@\S+\.\S+/;return re.test(email);} |
  |  | 32 | jQuery(this).closest('.contains-hidden-inputs').find('.hidden').hide(200);if(jQuery(this).is('[data-unhide-when-checked]')){const thingToShow=jQuery(this).attr('data-unhide-when-checked');if(jQuery(this).is(':checked')){jQuery(thingToShow).slideDown(200);}}});jQuery(document).on('click','.dismiss-user-configure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'dismiss\_nag'},complete:function(){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','.dismiss-user-reconfigure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'wp2fa\_dismiss\_reconfigure\_nag'},complete:function(data){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','[data-trigger-account-unlock]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-account-to-unlock');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'unlock\_account',user\_id:account,wp\_2fa\_nonce:nonce}});});jQuery(document).on('click','.remove-2fa',function(e){e.preventDefault();});jQuery('body').on('click','#2fa-wizard-totp .button[name="next\_step\_setting"]',function(e){e.preventDefault;const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();});jQuery('body').on('click','.wp2fa-first-time-wizard .button[name="next\_step\_setting"]',function(e){e.preventDefault;const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();});jQuery(document).on('click','.modal\_cancel',function(e){e.preventDefault();if(jQuery('#notify-users').length){MicroModal.show('notify-users');jQuery('.button-confirm').blur();}});jQuery(document).on('click touchend','.button-confirm',function(e){e.preventDefault();MicroModal.close('configure-2fa');MicroModal.close('notify-users');jQuery('.inline-helper').remove();});jQuery(document).on('click touchend','.button-decline',function(e){e.preventDefault();});jQuery(document).on('click','#close-settings',function(e){e.preventDefault();MicroModal.close('notify-admin-settings-page');window.location.replace(jQuery(this).data('redirect-url'));});jQuery(document).on('click','.first-time-wizard',function(e){e.preventDefault();MicroModal.show('notify-admin-settings-page');});jQuery(document).on('click','[data-trigger-remove-2fa]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_user\_2fa',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-trigger-remove-2fa-backup-email]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_backup\_email',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-submit-2fa-form]',function(e){jQuery('#submit').click();});function validateEmail(email){var re=/\S+@\S+\.\S+/;return re.test(email);} |
  | 33 | 33 | jQuery(document).on('click','[data-trigger-setup-email]',function(e){let actionToRun='send\_authentication\_setup\_email';var emailAddress=false;var inputUsed='';if(jQuery('#use\_custom\_email').prop('checked')){emailAddress=jQuery('#custom-email-address').val();inputUsed=jQuery('#custom-email-address');}else{emailAddress=jQuery('#use\_wp\_email').val();inputUsed=jQuery('#use\_wp\_email');} |
  | 34 |  | if(typeof jQuery(this).data('oob-test')!=='undefined'){actionToRun='send\_authentication\_oob\_setup\_email';emailAddress=jQuery('#use\_wp\_oob\_email').val();if(jQuery('#~~custom-oob-email-address').val(~~)){emailAddress=jQuery('#custom-oob-email-address').val();inputUsed=jQuery('#custom-oob-email-address');}} |
  |  | 34 | if(typeof jQuery(this).data('oob-test')!=='undefined'){actionToRun='send\_authentication\_oob\_setup\_email';emailAddress=jQuery('#use\_wp\_oob\_email').val();if(jQuery('#use\_custom\_oob\_email').prop('checked')){emailAddress=jQuery('#custom-oob-email-address').val();inputUsed=jQuery('#custom-oob-email-address');}} |
  | 35 | 35 | if(!validateEmail(emailAddress)||false==emailAddress){e.preventDefault();let errMsg=jQuery('#2fa-error-msg');if(errMsg.length){errMsg.remove();} |
  |  | 36 | if(jQuery(this).hasClass('resend-email-code')){if(jQuery('#wp-2fa-email-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-email-authcode');}else if(jQuery('#wp-2fa-oob-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-oob-authcode');}} |
  | 36 | 37 | jQuery('<span id="2fa-error-msg" style="color:red;">'+wp2faData.invalidEmail+'</span>').insertAfter(inputUsed);return false;} |
  | 37 |  | if(jQuery(this).hasClass('resend-email-code')){var updateBtnText=true;var originalBtnText=jQuery(this).text();}else{const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=currentSubStep.nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');nextSubStep.addClass('active');updateStepTitles();} |
  | 38 |  | const userID=jQuery(this).attr('data-user-id');const nonce=jQuery(this).attr('data-nonce');const thisBtn=jQuery(this);jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,email\_address:emailAddress,user\_id:userID,nonce:nonce},complete:function(data){},success:function(data){if(updateBtnText){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(wp2faWizardData.codeReSentText);jQuery(thisBtn).find('span').fadeTo(100,1);});setTimeout(function(){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(originalBtnText);jQuery(thisBtn).find('span').fadeTo(100,1);});},2500);}}});});jQuery('body').on('click','.button[name="next\_step\_setting"]',function(e){e.preventDefault;const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();});jQuery(document).on('change','[name="wp\_2fa\_enabled\_methods"]',function(event){var step=jQuery('[name="wp\_2fa\_enabled\_methods"]:checked').val();jQuery('.2fa-choose-method[data-next-step]').attr('data-next-step',`2fa-wizard-${step}`);});jQuery('body').on('click','.button[data-name="next\_step\_setting\_modal\_wizard"]',function(e){e.preventDefault;var nextStep=jQuery(this).attr('data-next-step');if(nextStep){const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(`#${nextStep}`);jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper').removeClass('active');jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');}else{const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(currentSubStep).next();jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');} |
  | 39 |  | jQuery('.inline-helper').remove();});jQuery('body').on('click','.button[data-trigger-generate-backup-codes]',function(e){e.preventDefault();const actionToRun='wp2fa\_run\_ajax\_generate\_json';const nonceValue=jQuery(this).attr('data-nonce');jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue},complete:function(data){jQuery('#backup-codes-wrapper').slideUp(0);jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val('');var codes=jQuery.parseJSON(data.responseText);var codes=codes.data['codes'];jQuery.each(codes,function(index,value){var oldValue=jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val();var counter=index+1;jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val(oldValue+counter+': '+`${value} \n`);});jQuery('#backup-codes-wrapper').slideDown(500);jQuery('.close-wizard-link').text(wp2faWizardData.readyText).fadeIn(50);}},);});jQuery('body').on('click','.button[data-trigger-reset-key]',function(e){e.preventDefault();if(jQuery('.qr-code-wrapper').length){jQuery('.qr-code-wrapper').addClass('regenerating');} |
  |  | 38 | if(jQuery(this).hasClass('resend-email-code')){var updateBtnText=true;var originalBtnText=jQuery(this).text();if(jQuery('#wp-2fa-email-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-email-authcode');}else if(jQuery('#wp-2fa-oob-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-oob-authcode');}}else{const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=currentSubStep.nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');nextSubStep.addClass('active');updateStepTitles();} |
  |  | 39 | const userID=jQuery(this).attr('data-user-id');const nonce=jQuery(this).attr('data-nonce');const thisBtn=jQuery(this);jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,email\_address:emailAddress,user\_id:userID,nonce:nonce},error:function(jqXHR,textStatus,errorThrown){if(false===jqXHR.responseJSON.success){let errMsg=jQuery('#2fa-error-msg');if(errMsg.length){errMsg.remove();} |
  |  | 40 | jQuery('<span id="2fa-error-msg" style="color:red;">'+jqXHR.responseJSON.data[0].message+'</span>').insertAfter(inputUsed);}},complete:function(data){},success:function(data){let errMsg=jQuery('#2fa-error-msg');if(errMsg.length){errMsg.remove();} |
  |  | 41 | if(updateBtnText){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(wp2faWizardData.codeReSentText);jQuery(thisBtn).find('span').fadeTo(100,1);});setTimeout(function(){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(originalBtnText);jQuery(thisBtn).find('span').fadeTo(100,1);});},2500);}}});});jQuery(document).on('change','[name="wp\_2fa\_enabled\_methods"]',function(event){var step=jQuery('[name="wp\_2fa\_enabled\_methods"]:checked').val();jQuery('.2fa-choose-method[data-next-step]').attr('data-next-step',`2fa-wizard-${step}`);});jQuery('body').on('click','.button[data-name="next\_step\_setting\_modal\_wizard"]',function(e){e.preventDefault;var nextStep=jQuery(this).attr('data-next-step');if(nextStep){const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(`#${nextStep}`);jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper').removeClass('active');jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');}else{const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(currentSubStep).next();jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');} |
  |  | 42 | jQuery('.inline-helper').remove();});jQuery('body').on('click','.button[data-trigger-generate-backup-codes]',function(e){e.preventDefault();const actionToRun='wp2fa\_run\_ajax\_generate\_json';const nonceValue=jQuery(this).attr('data-nonce');const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue},complete:function(data){jQuery('#backup-codes-wrapper').slideUp(0);jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val('');var codes=jQuery.parseJSON(data.responseText);var codes=codes.data['codes'];jQuery.each(codes,function(index,value){var oldValue=jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val();var counter=index+1;jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val(oldValue+counter+': '+`${value} \n`);});jQuery('#backup-codes-wrapper').slideDown(500);jQuery('.close-wizard-link').text(wp2faWizardData.readyText).fadeIn(50);}},);});jQuery('body').on('click','.button[data-trigger-reset-key]',function(e){e.preventDefault();if(jQuery('.qr-code-wrapper').length){jQuery('.qr-code-wrapper').addClass('regenerating');} |
  | 40 | 43 | var doReload=jQuery(this).attr('data-trigger-reset-key');const thisButton=jQuery(this);const actionToRun='regenerate\_authentication\_key';const nonceValue=jQuery(this).attr('data-nonce');const userID=jQuery(this).attr('data-user-id');jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue,user\_id:userID},complete:function(data){if(jQuery('.change-2fa-confirm.hidden').length){jQuery('.change-2fa-confirm.hidden').trigger('click');} |
  | 41 | 44 | if(jQuery('.app-key').length){jQuery('#wp-2fa-totp-qrcode').attr('src',data.responseJSON.data['qr']);jQuery('.app-key').val(data.responseJSON.data['key']);jQuery('[name="wp-2fa-totp-key"]').val(data.responseJSON.data['key']);setTimeout(function(){jQuery('.qr-code-wrapper').removeClass('regenerating');},500);}}},);});jQuery('body').on('click','.button[data-trigger-backup-code-email]',function(e){e.preventDefault();const thisButton=jQuery(this);const actionToRun='send\_backup\_codes\_email';const nonceValue=jQuery(this).attr('data-nonce');const userID=jQuery(this).attr('data-user-id');const codesWrapper=JSON.stringify(jQuery('.active #backup-codes-wrapper').val());jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue,user\_id:userID,codes:codesWrapper},complete:function(data){jQuery('.button[data-trigger-backup-code-email]').text(wp2faWizardData.backupCodesSent).attr('value',wp2faWizardData.backupCodesSent);}},);});jQuery('body').on('click','.click-to-copy',function(e){var copyText=jQuery(this).prev();copyText.select();if(typeof copyText.setSelectionRange!=="undefined"){copyText.setSelectionRange(0,99999);} |
  | 42 | 45 | navigator.clipboard.writeText(copyText[0].value);jQuery(this).addClass('done').html('Copied');});jQuery('body').on('click','.button[data-trigger-backup-code-copy]',function(e){e.preventDefault();var copyText=jQuery('.active #backup-codes-wrapper');copyText.select();if(typeof copyText.setSelectionRange!=="undefined"){copyText.setSelectionRange(0,99999);} |
  | 43 | 46 | navigator.clipboard.writeText(copyText[0].value);jQuery(this).addClass('done').html('Copied');});jQuery('body').on('click','.button[data-trigger-backup-code-download]',function(e){e.preventDefault();const userName=jQuery(this).attr('data-user');const websiteURL=jQuery(this).attr('data-website-url');const preamble=`${wp2faWizardData.codesPreamble} ${userName} on the website ${websiteURL}:\n\n`;var codesWrapper=jQuery('.active #backup-codes-wrapper').val().split(' ').join('\n');download('backup\_codes.txt',preamble+codesWrapper);});jQuery('body').on('click','.button[data-trigger-print]',function(e){e.preventDefault();const userName=jQuery(this).attr('data-user-id');const websiteURL=jQuery(this).attr('data-website-url');const preamble=`${wp2faWizardData.codesPreamble} ${userName} on the website ${websiteURL}:\n\n`;const divToPrint=jQuery('.active #backup-codes-wrapper').val();const newWin=window.open('','Print-Window');newWin.document.open();newWin.document.write(`<html><body onload="window.print()">${preamble}</br></br>${divToPrint}</body></html>`);newWin.document.close();setTimeout(function(){newWin.close();},10);});function download(filename,text){const element=document.createElement('a');element.setAttribute('href',`data:text/plain;charset=utf-8,${encodeURIComponent( text )}`);element.setAttribute('download',filename);element.style.display='none';document.body.appendChild(element);element.click();document.body.removeChild(element);} |
  | 44 |  | jQuery(document).on('click','#custom-email-address',function(){jQuery('#use\_custom\_email').prop('checked',true);});jQuery(document).on('click','[data-check-on-click]',function(){const thingToCheck=jQuery(this).attr('data-check-on-click');jQuery(thingToCheck).prop('checked',true);});jQuery(document).on('click','[data-trigger-submit-form]',function(e){e.preventDefault();const thingToSubmit=jQuery(this).attr('data-trigger-submit-form');jQuery('.change-2fa-confirm').trigger('click');});jQuery(document).on('click','[data-reload]',function(e){removeShowParam();});window.removeShowParam=function(){let url=new URL(location.href);let params=new URLSearchParams(url.search);params.delete('show');location.replace(`${location.pathname}?${params}`);} |
  |  | 47 | jQuery(document).on('click','#custom-email-address',function(){jQuery('#use\_custom\_email').prop('checked',true);});jQuery(document).on('click','#custom-oob-email-address',function(){jQuery('#use\_custom\_oob\_email').prop('checked',true);});jQuery(document).on('click','[data-check-on-click]',function(){const thingToCheck=jQuery(this).attr('data-check-on-click');jQuery(thingToCheck).prop('checked',true);});jQuery(document).on('click','[data-trigger-submit-form]',function(e){e.preventDefault();const thingToSubmit=jQuery(this).attr('data-trigger-submit-form');jQuery('.change-2fa-confirm').trigger('click');});jQuery(document).on('click','[data-reload]',function(e){removeShowParam();});window.removeShowParam=function(){let url=new URL(location.href);let params=new URLSearchParams(url.search);params.delete('show');location.replace(`${location.pathname}?${params}`);} |
  | 45 | 48 | jQuery('[name="wp\_2fa\_settings[enforcement-policy]"]').on("input",function(){if(jQuery('input[name="wp\_2fa\_settings[enforcement-policy]"]:checked').val()!=='do-not-enforce'){jQuery('[data-step-title="Exclude users"]').removeClass('hidden');updateStepTitles();}else{jQuery('[data-step-title="Exclude users"]').addClass('hidden');updateStepTitles();}});jQuery('body').on('click','.iti\_\_flag-container',function(e){var isExpand=(jQuery('.iti\_\_selected-flag').attr('aria-expanded'))?'expand-panel':'';jQuery(this).closest('.wizard-step.active').toggleClass(isExpand);});jQuery('body').on('click','.step-setting-wrapper #all-users, .step-setting-wrapper #certain-roles-only',function(e){jQuery('.step-setting-wrapper.active .continue-wizard').removeClass('hidden');jQuery('.step-setting-wrapper.active .save-wizard').addClass('hidden');});jQuery('body').on('click','.step-setting-wrapper #do-not-enforce',function(e){jQuery('.step-setting-wrapper.active .continue-wizard').addClass('hidden');jQuery('.step-setting-wrapper.active .save-wizard').removeClass('hidden');});});window.onresize=function(){checkWizardOffset();} |
  | 46 | 49 | function checkWizardOffset(){var elem=document.querySelector('.setup-wizard-wrapper');if(elem){var bounding=elem.getBoundingClientRect();if(bounding.top<0){var clientHeight=bounding.height / 2;elem.style.cssText+='top: '+clientHeight+'px';}}} |
  | 47 | 50 | window.wp2fa\_fireWizard=function(){jQuery('.verification-response span').remove();jQuery('#configure-2fa .wizard-step.active, #configure-2fa .step-setting-wrapper.active').removeClass('active');jQuery('#configure-2fa .wizard-step:first-of-type, #configure-2fa .step-setting-wrapper:first-of-type').addClass('active');jQuery('.modal\_\_content input:not([type="radio"]):not([type="hidden"])').not('.app-key').val('');MicroModal.show('configure-2fa');if(jQuery('input#basic').is(':visible')){jQuery('input#basic').trigger("click");}else{if(jQuery('input#geek').is(':visible')){jQuery('input#geek').trigger("click");}else{if(jQuery('input#oob').length){jQuery('input#oob').trigger("click");}else if(jQuery('input#authy').length){jQuery('input#authy').trigger("click");}else if(jQuery('input#twilio').length){jQuery('input#twilio').trigger("click");}}} |
  | 48 |  | jQuery('[name="wp\_2fa\_enabled\_methods"]').change();if(1===jQuery('.wizard-step.active .option-pill').length){jQuery('.wp-2fa-button-primary.2fa-choose-method').trigger("click");}}; |
  |  | 51 | jQuery('[name="wp\_2fa\_enabled\_methods"]').change();if(1===jQuery('.wizard-step.active .option-pill').length){jQuery('.wp-2fa-button-primary.2fa-choose-method').trigger("click");}else{jQuery('#configure-2fa .wizard-step:first-of-type, #configure-2fa input:radio[name=wp\_2fa\_enabled\_methods]:first').prop("checked",true);jQuery('[name="wp\_2fa\_enabled\_methods"]').change();jQuery('#configure-2fa .wizard-step:first-of-type, #configure-2fa input:radio[name=wp\_2fa\_enabled\_methods]:first').trigger("click");}}; |
  | 49 | 52 | } |
  | 50 | 53 | catch(e){console.error("An error has occurred common.js: "+e.stack);} |
  | 51 | 54 |  |
  | 52 | 55 | try{ |
  | 53 |  | jQuery(function(){const select2Autocomplete=function(source,functionName){jQuery(source).select2({width:'resolve',ajax:{url:`${wp2faData.ajaxURL}?wp\_2fa\_nonce=${wp2faData.nonce}`,dataType:'json',delay:250,data:function(params){return{term:params.term,action:functionName};},processResults:function(data){const options=[];if(data){jQuery.each(data,function(index,text){options.push({id:text['label'],text:text['value']});});} |
  | 54 |  | return{results:options};},cache:true},minimumInputLength:2});};if(jQuery('#excluded-users-multi-select').length){select2Autocomplete('#excluded-users-multi-select','get\_all\_users');} |
  | 55 |  | if(jQuery('#enforced\_users-multi-select').length){select2Autocomplete('#enforced\_users-multi-select','get\_all\_users');} |
  | 56 |  | if(jQuery('#excluded-roles-multi-select').length){jQuery('#excluded-roles-multi-select').select2();} |
  | 57 |  | if(jQuery('#enforced-roles-multi-select').length){jQuery('#enforced-roles-multi-select').select2();} |
  | 58 |  | if(jQuery('#excluded-sites-multi-select').length){select2Autocomplete('#excluded-sites-multi-select','get\_all\_network\_sites');}}); |
  |  | 56 | jQuery(function(){const select2Autocomplete=function(source,functionName){jQuery(source).select2({width:'resolve',ajax:{url:`${wp2faData.ajaxURL}?wp\_2fa\_nonce=${wp2faData.nonce}`,dataType:'json',delay:250,data:function(params){return{term:params.term,action:functionName};},processResults:function(data){var exclData=[];if(source==='#excluded-users-multi-select'){exclData=jQuery('#enforced\_users-multi-select').val();}else if(source==='#enforced\_users-multi-select'){exclData=jQuery('#excluded-users-multi-select').val();}else if(source==='#excluded-roles-multi-select'){exclData=jQuery('#enforced-roles-multi-select').val();}else if(source==='#enforced-roles-multi-select'){exclData=jQuery('#excluded-roles-multi-select').val();}else if(source==='#excluded-sites-multi-select'){exclData=jQuery('#enforced-sites-multi-select').val();}else if(source==='#enforced-sites-multi-select'){exclData=jQuery('#excluded-sites-multi-select').val();} |
  |  | 57 | const options=[];if(data){jQuery.each(data,function(index,text){if(exclData.indexOf(text['label'])===-1){options.push({id:text['label'],text:text['value']});}});} |
  |  | 58 | return{results:options};},cache:true},minimumInputLength:2});};if(jQuery('#excluded-users-multi-select').length){select2Autocomplete('#excluded-users-multi-select','wp\_2fa\_get\_all\_users');} |
  |  | 59 | if(jQuery('#enforced\_users-multi-select').length){select2Autocomplete('#enforced\_users-multi-select','wp\_2fa\_get\_all\_users');} |
  |  | 60 | if(jQuery('#excluded-roles-multi-select').length){select2Autocomplete('#excluded-roles-multi-select','wp\_2fa\_get\_all\_roles');} |
  |  | 61 | if(jQuery('#enforced-roles-multi-select').length){select2Autocomplete('#enforced-roles-multi-select','wp\_2fa\_get\_all\_roles');} |
  |  | 62 | if(jQuery('#excluded-sites-multi-select').length){select2Autocomplete('#excluded-sites-multi-select','wp\_2fa\_get\_all\_network\_sites');} |
  |  | 63 | if(jQuery('#enforced-sites-multi-select').length){select2Autocomplete('#enforced-sites-multi-select','wp\_2fa\_get\_all\_network\_sites');}}); |
  | 59 | 64 | } |
  | 60 | 65 | catch(e){console.error("An error has occurred select2control.js: "+e.stack);} |
* ## [wp-2fa/trunk/dist/js/micromodal.js](/changeset/3009922/wp-2fa/trunk/dist/js/micromodal.js "Show the changeset 3009922 restricted to wp-2fa/trunk/dist/js/micromodal.js")

  | [r2717010](/browser/wp-2fa/trunk/dist/js/micromodal.js?rev=2717010#L240 "Show revision 2717010 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/dist/js/micromodal.js?rev=3009922#L240 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 240 | 240 |  |
  | 241 | 241 | if (event.keyCode === 9) this.retainFocus(event); // tab |
  |  | 242 |  |
  |  | 243 | if (event.keyCode === 13) { // enter |
  |  | 244 | var modal = jQuery('#' + this.modal.id); |
  |  | 245 | modal.find('.button:visible:first').click(); |
  |  | 246 | } |
  | 242 | 247 | } |
  | 243 | 248 | }, { |
* ## [wp-2fa/trunk/dist/js/wp-2fa.js](/changeset/3009922/wp-2fa/trunk/dist/js/wp-2fa.js "Show the changeset 3009922 restricted to wp-2fa/trunk/dist/js/wp-2fa.js")

  | [r2866477](/browser/wp-2fa/trunk/dist/js/wp-2fa.js?rev=2866477#L6 "Show revision 2866477 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/dist/js/wp-2fa.js?rev=3009922#L6 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | updateStepTitles();jQuery('body').on('click','.step-title',function(e){var currentLabel=jQuery(this).text().substr(2);jQuery('[data-step-title]:not(.hidden)').each(function(){var currentStep=jQuery(this);jQuery('[data-step-title]').removeClass('active');jQuery('.step-title').removeClass('active-step-title');var stepLabel=jQuery(this).attr('data-step-title');jQuery(`[data-step-title="${currentLabel}"]`).addClass('active');});updateStepTitles();});jQuery('[data-unhide-when-checked]').each(function(){if(jQuery(this).is(':checked')){const thingToShow=jQuery(this).attr('data-unhide-when-checked');jQuery(thingToShow).show(0);}});jQuery('body').on('click','[for="all-users"], [for="certain-roles-only"]',function(e){jQuery('.step-setting-wrapper.hidden').removeClass('hidden').addClass('un-hidden');updateStepTitles();});jQuery('body').on('click','[for="do-not-enforce"]',function(e){jQuery('.step-setting-wrapper.un-hidden').removeClass('un-hidden').addClass('hidden');updateStepTitles();});jQuery('body').on('click','.modal\_\_btn',function(e){e.preventDefault();});jQuery('body').on('keypress','.wp2fa-modal',function(event){var keycode=(event.keyCode?event.keyCode:event.which);if('13'==keycode){return false;}});jQuery(document).on('click','[data-open-configure-2fa-wizard]',function(event){event.preventDefault();wp2fa\_fireWizard();});jQuery(document).on('click','.step-setting-wrapper.active .option-pill input[type="checkbox"]',function(e){if('backup-codes'!==this.id&&!jQuery(this).hasClass('disabled')){if(true!==jQuery('#geek').prop('checked')&&true!==jQuery('#basic').prop('checked')){jQuery('#backup-codes').addClass('disabled');jQuery('label[for=\'backup-codes\']').addClass('disabled');window.backupCodes=jQuery('#backup-codes').prop('checked');jQuery('#backup-codes').prop('checked',false);if(jQuery('[name="next\_step\_setting"]').length){jQuery('[name="next\_step\_setting"]').addClass('disabled').attr('name','next\_step\_setting\_disabled');}}else{jQuery('#backup-codes').removeClass('disabled');jQuery('label[for=\'backup-codes\']').removeClass('disabled');if('undefined'!==window.backupCodes){jQuery('#backup-codes').prop('checked',window.backupCodes);} |
  | 7 | 7 | if(jQuery('[name="next\_step\_setting\_disabled"]').length){jQuery('[name="next\_step\_setting\_disabled"]').removeClass('disabled').attr('name','next\_step\_setting');}}}else{if(!jQuery(this).hasClass('disabled')){window.backupCodes=jQuery('#backup-codes').prop('checked');}else{jQuery('#backup-codes').prop('checked',false);}}});jQuery(document).on('click touchend','.radio-cells label, .radio-cells input[type="radio"]',function(e){jQuery('.option-pill').removeClass('isSelected');jQuery('.radio-cells input[type="radio"]:checked').closest('.option-pill').addClass('isSelected');});jQuery('.wizard-tooltip').each(function(){var contentDiv=jQuery(this).attr('data-tooltip-content');var ourItem=jQuery(this);if(jQuery('['+contentDiv+']').length){var content=jQuery('['+contentDiv+']').clone();jQuery(ourItem).append(content);}});jQuery(document).on('click touchend','.wizard-tooltip',function(e){var contentDiv=jQuery(this).attr('data-tooltip-content');var ourItem=jQuery(this);if(jQuery(this).hasClass('isOpen')){jQuery('.inline-helper').slideDown();}else{jQuery('[data-tooltip-content]').removeClass('isOpen');setTimeout(function(){if(jQuery('.inline-helper').length>2){jQuery('.inline-helper').not('['+contentDiv+']').slideUp();}},100);setTimeout(function(){if(jQuery('.inline-helper').length>2){jQuery('.inline-helper').not('['+contentDiv+']').remove();}},600);if(jQuery('['+contentDiv+']').length){var content=jQuery('['+contentDiv+']').html();jQuery('<div class="inline-helper" '+contentDiv+'>'+content+'</div>').insertAfter('.radio-cells');jQuery('.inline-helper').slideDown();} |
  | 8 |  | jQuery(ourItem).addClass('isOpen');}});jQuery(document).on('click','.2fa-method-select input[type="checkbox"]',function(e){let role\_suffix=('global'===jQuery(this).data('role'))?'':'-'+jQuery(this).data('role');if('backup-codes'+role\_suffix!==this.id&&!jQuery(this).hasClass('disabled')){let backDisabled=false;if(true!==jQuery('#totp'+role\_suffix).prop('checked')&&true!==jQuery('#hotp'+role\_suffix).prop('checked')){backDisabled=true;if(jQuery('#oob'+role\_suffix).length){if(true===jQuery('#oob'+role\_suffix).prop('checked')){backDisabled=false;}} |
  |  | 8 | jQuery(ourItem).addClass('isOpen');}});jQuery(document).on('click','.wp-2fa-method-select input[type="checkbox"]',function(e){let role\_suffix=('global'===jQuery(this).data('role'))?'':'-'+jQuery(this).data('role');if('backup-codes'+role\_suffix!==this.id&&!jQuery(this).hasClass('disabled')){let backDisabled=false;if(true!==jQuery('#totp'+role\_suffix).prop('checked')&&true!==jQuery('#hotp'+role\_suffix).prop('checked')){backDisabled=true;if(jQuery('#oob'+role\_suffix).length){if(true===jQuery('#oob'+role\_suffix).prop('checked')){backDisabled=false;}} |
  | 9 | 9 | if(jQuery('#authy'+role\_suffix).length){setTimeout(function(){},2000);if(true===jQuery('#authy'+role\_suffix).prop('checked')){backDisabled=false;}} |
  | 10 | 10 | if(jQuery('#twilio'+role\_suffix).length){setTimeout(function(){},2000);if(true===jQuery('#twilio'+role\_suffix).prop('checked')){backDisabled=false;}}} |
  | 11 |  | if(backDisabled){jQuery('#backup-codes'+role\_suffix).addClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').addClass('disabled');window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');jQuery('#backup-codes'+role\_suffix).prop('checked',false);jQuery('[for="all-users"], [for="certain-roles-only"]').addClass('disabled');}else{jQuery('[for="all-users"], [for="certain-roles-only"]').removeClass('disabled');jQuery('#backup-codes'+role\_suffix).removeClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').removeClass('disabled');if('undefined'!==window.backupCodes){jQuery('#backup-codes'+role\_suffix).prop('checked',window.backupCodes);}}}else{if(!jQuery(this).hasClass('disabled')){window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');}else{jQuery('#backup-codes'+role\_suffix).prop('checked',false);}}});jQuery(document).on('click','.wp2fa-setup-form .~~2fa-method-select input[type="checkbox"]',function(e){~~let twilio=false;let authy=false;if(jQuery('#twilio').length){if(jQuery('#twilio[data-sid-setup-wizard]').length&&jQuery('#wizard-sid-key').is(':visible')){twilio=false;}else{twilio=jQuery('#twilio').prop('checked');}} |
  |  | 11 | if(backDisabled){jQuery('#backup-codes'+role\_suffix).addClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').addClass('disabled');window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');jQuery('#backup-codes'+role\_suffix).prop('checked',false);jQuery('[for="all-users"], [for="certain-roles-only"]').addClass('disabled');}else{jQuery('[for="all-users"], [for="certain-roles-only"]').removeClass('disabled');jQuery('#backup-codes'+role\_suffix).removeClass('disabled');jQuery('label[for="backup-codes'+role\_suffix+'"]').removeClass('disabled');if('undefined'!==window.backupCodes){jQuery('#backup-codes'+role\_suffix).prop('checked',window.backupCodes);}}}else{if(!jQuery(this).hasClass('disabled')){window.backupCodes=jQuery('#backup-codes'+role\_suffix).prop('checked');}else{jQuery('#backup-codes'+role\_suffix).prop('checked',false);}}});jQuery(document).on('click','.wp2fa-setup-form .wp-2fa-method-select input[type="checkbox"]',function(e){alert('kur');let twilio=false;let authy=false;if(jQuery('#twilio').length){if(jQuery('#twilio[data-sid-setup-wizard]').length&&jQuery('#wizard-sid-key').is(':visible')){twilio=false;}else{twilio=jQuery('#twilio').prop('checked');}} |
  | 12 | 12 | if(jQuery('#authy').length){if(jQuery('#authy[data-api-setup-wizard]').length&&jQuery('#wizard-api-key').is(':visible')){authy=false;}else{authy=jQuery('#authy').prop('checked');}} |
  | 13 | 13 | if(true!==jQuery('#totp').prop('checked')&&true!==jQuery('#hotp').prop('checked')&&true!==jQuery('#oob').prop('checked')&&true!==authy&&true!==twilio){let showAlert=true;if(jQuery(this).is(jQuery('input#authy.disabled'))&&jQuery('#wizard-api-key').is(':visible')){showAlert=false;} |
  | […](/browser/wp-2fa/trunk/dist/js/wp-2fa.js?rev=2866477#L19) | […](/browser/wp-2fa/trunk/dist/js/wp-2fa.js?rev=3009922#L19) |  |
  | 19 | 19 | if(true===data.responseJSON.success){let nextSubStep=jQuery('#2fa-wizard-config-backup-codes');if(authcode){if(jQuery('#2fa-wizard-backup-methods').length){nextSubStep=jQuery('#2fa-wizard-backup-methods');}else if(jQuery('#2fa-wizard-email-backup-selected').length){nextSubStep=jQuery('#2fa-wizard-email-backup-selected');}} |
  | 20 | 20 | jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper').removeClass('active');jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');jQuery(document).on('click','#select-backup-method',function(e){e.preventDefault();var backupRadio=jQuery("input[name=backup\_method\_select]:checked");jQuery('.wizard-step.active').removeClass('active');jQuery('#'+backupRadio.data('step')).addClass('active');});jQuery(document).on('click','[name="save\_step"], [data-close-2fa-modal]',function(){if('redirectToUrl'in wp2faWizardData&&''!=jQuery.trim(wp2faWizardData.redirectToUrl)){window.location.replace(wp2faWizardData.redirectToUrl);}else{removeShowParam();}});}}},);});jQuery('body').on('click','.contains-hidden-inputs input[type="radio"]',function(e){if(jQuery(this).hasClass('js-nested')){return;} |
  | 21 |  | jQuery(this).closest('.contains-hidden-inputs').find('.hidden').hide(200);if(jQuery(this).is('[data-unhide-when-checked]')){const thingToShow=jQuery(this).attr('data-unhide-when-checked');if(jQuery(this).is(':checked')){jQuery(thingToShow).slideDown(200);}}});jQuery(document).on('click','.dismiss-user-configure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'dismiss\_nag'},complete:function(){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','.dismiss-user-reconfigure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'wp2fa\_dismiss\_reconfigure\_nag'},complete:function(data){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','[data-trigger-account-unlock]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-account-to-unlock');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'unlock\_account',user\_id:account,wp\_2fa\_nonce:nonce}});});jQuery(document).on('click','.remove-2fa',function(e){e.preventDefault();});jQuery(~~document).on('click','.modal\_\_close',function(e){e.preventDefault();if(jQuery(this).parent().find~~('#notify-users').length){MicroModal.show('notify-users');jQuery('.button-confirm').blur();}});jQuery(document).on('click touchend','.button-confirm',function(e){e.preventDefault();MicroModal.close('configure-2fa');MicroModal.close('notify-users');jQuery('.inline-helper').remove();});jQuery(document).on('click touchend','.button-decline',function(e){e.preventDefault();});jQuery(document).on('click','#close-settings',function(e){e.preventDefault();MicroModal.close('notify-admin-settings-page');window.location.replace(jQuery(this).data('redirect-url'));});jQuery(document).on('click','.first-time-wizard',function(e){e.preventDefault();MicroModal.show('notify-admin-settings-page');});jQuery(document).on('click','[data-trigger-remove-2fa]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_user\_2fa',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-trigger-remove-2fa-backup-email]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_backup\_email',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-submit-2fa-form]',function(e){jQuery('#submit').click();});function validateEmail(email){var re=/\S+@\S+\.\S+/;return re.test(email);} |
  |  | 21 | jQuery(this).closest('.contains-hidden-inputs').find('.hidden').hide(200);if(jQuery(this).is('[data-unhide-when-checked]')){const thingToShow=jQuery(this).attr('data-unhide-when-checked');if(jQuery(this).is(':checked')){jQuery(thingToShow).slideDown(200);}}});jQuery(document).on('click','.dismiss-user-configure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'dismiss\_nag'},complete:function(){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','.dismiss-user-reconfigure-nag',function(){const thisNotice=jQuery(this).closest('.notice');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'wp2fa\_dismiss\_reconfigure\_nag'},complete:function(data){jQuery(thisNotice).slideUp();},});});jQuery(document).on('click','[data-trigger-account-unlock]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-account-to-unlock');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'unlock\_account',user\_id:account,wp\_2fa\_nonce:nonce}});});jQuery(document).on('click','.remove-2fa',function(e){e.preventDefault();});jQuery('body').on('click','#2fa-wizard-totp .button[name="next\_step\_setting"]',function(e){e.preventDefault;const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();});jQuery('body').on('click','.wp2fa-first-time-wizard .button[name="next\_step\_setting"]',function(e){e.preventDefault;const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();});jQuery(document).on('click','.modal\_cancel',function(e){e.preventDefault();if(jQuery('#notify-users').length){MicroModal.show('notify-users');jQuery('.button-confirm').blur();}});jQuery(document).on('click touchend','.button-confirm',function(e){e.preventDefault();MicroModal.close('configure-2fa');MicroModal.close('notify-users');jQuery('.inline-helper').remove();});jQuery(document).on('click touchend','.button-decline',function(e){e.preventDefault();});jQuery(document).on('click','#close-settings',function(e){e.preventDefault();MicroModal.close('notify-admin-settings-page');window.location.replace(jQuery(this).data('redirect-url'));});jQuery(document).on('click','.first-time-wizard',function(e){e.preventDefault();MicroModal.show('notify-admin-settings-page');});jQuery(document).on('click','[data-trigger-remove-2fa]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_user\_2fa',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-trigger-remove-2fa-backup-email]',function(){const nonce=jQuery(this).attr('data-nonce');const account=jQuery(this).attr('data-user-id');jQuery.ajax({url:wp2faData.ajaxURL,data:{action:'remove\_backup\_email',user\_id:account,wp\_2fa\_nonce:nonce},complete:function(data){location.reload();},});});jQuery(document).on('click','[data-submit-2fa-form]',function(e){jQuery('#submit').click();});function validateEmail(email){var re=/\S+@\S+\.\S+/;return re.test(email);} |
  | 22 | 22 | jQuery(document).on('click','[data-trigger-setup-email]',function(e){let actionToRun='send\_authentication\_setup\_email';var emailAddress=false;var inputUsed='';if(jQuery('#use\_custom\_email').prop('checked')){emailAddress=jQuery('#custom-email-address').val();inputUsed=jQuery('#custom-email-address');}else{emailAddress=jQuery('#use\_wp\_email').val();inputUsed=jQuery('#use\_wp\_email');} |
  | 23 |  | if(typeof jQuery(this).data('oob-test')!=='undefined'){actionToRun='send\_authentication\_oob\_setup\_email';emailAddress=jQuery('#use\_wp\_oob\_email').val();if(jQuery('#~~custom-oob-email-address').val(~~)){emailAddress=jQuery('#custom-oob-email-address').val();inputUsed=jQuery('#custom-oob-email-address');}} |
  |  | 23 | if(typeof jQuery(this).data('oob-test')!=='undefined'){actionToRun='send\_authentication\_oob\_setup\_email';emailAddress=jQuery('#use\_wp\_oob\_email').val();if(jQuery('#use\_custom\_oob\_email').prop('checked')){emailAddress=jQuery('#custom-oob-email-address').val();inputUsed=jQuery('#custom-oob-email-address');}} |
  | 24 | 24 | if(!validateEmail(emailAddress)||false==emailAddress){e.preventDefault();let errMsg=jQuery('#2fa-error-msg');if(errMsg.length){errMsg.remove();} |
  |  | 25 | if(jQuery(this).hasClass('resend-email-code')){if(jQuery('#wp-2fa-email-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-email-authcode');}else if(jQuery('#wp-2fa-oob-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-oob-authcode');}} |
  | 25 | 26 | jQuery('<span id="2fa-error-msg" style="color:red;">'+wp2faData.invalidEmail+'</span>').insertAfter(inputUsed);return false;} |
  | 26 |  | if(jQuery(this).hasClass('resend-email-code')){var updateBtnText=true;var originalBtnText=jQuery(this).text();}else{const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=currentSubStep.nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');nextSubStep.addClass('active');updateStepTitles();} |
  | 27 |  | const userID=jQuery(this).attr('data-user-id');const nonce=jQuery(this).attr('data-nonce');const thisBtn=jQuery(this);jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,email\_address:emailAddress,user\_id:userID,nonce:nonce},complete:function(data){},success:function(data){if(updateBtnText){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(wp2faWizardData.codeReSentText);jQuery(thisBtn).find('span').fadeTo(100,1);});setTimeout(function(){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(originalBtnText);jQuery(thisBtn).find('span').fadeTo(100,1);});},2500);}}});});jQuery('body').on('click','.button[name="next\_step\_setting"]',function(e){e.preventDefault;const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();});jQuery(document).on('change','[name="wp\_2fa\_enabled\_methods"]',function(event){var step=jQuery('[name="wp\_2fa\_enabled\_methods"]:checked').val();jQuery('.2fa-choose-method[data-next-step]').attr('data-next-step',`2fa-wizard-${step}`);});jQuery('body').on('click','.button[data-name="next\_step\_setting\_modal\_wizard"]',function(e){e.preventDefault;var nextStep=jQuery(this).attr('data-next-step');if(nextStep){const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(`#${nextStep}`);jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper').removeClass('active');jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');}else{const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(currentSubStep).next();jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');} |
  | 28 |  | jQuery('.inline-helper').remove();});jQuery('body').on('click','.button[data-trigger-generate-backup-codes]',function(e){e.preventDefault();const actionToRun='wp2fa\_run\_ajax\_generate\_json';const nonceValue=jQuery(this).attr('data-nonce');jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue},complete:function(data){jQuery('#backup-codes-wrapper').slideUp(0);jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val('');var codes=jQuery.parseJSON(data.responseText);var codes=codes.data['codes'];jQuery.each(codes,function(index,value){var oldValue=jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val();var counter=index+1;jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val(oldValue+counter+': '+`${value} \n`);});jQuery('#backup-codes-wrapper').slideDown(500);jQuery('.close-wizard-link').text(wp2faWizardData.readyText).fadeIn(50);}},);});jQuery('body').on('click','.button[data-trigger-reset-key]',function(e){e.preventDefault();if(jQuery('.qr-code-wrapper').length){jQuery('.qr-code-wrapper').addClass('regenerating');} |
  |  | 27 | if(jQuery(this).hasClass('resend-email-code')){var updateBtnText=true;var originalBtnText=jQuery(this).text();if(jQuery('#wp-2fa-email-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-email-authcode');}else if(jQuery('#wp-2fa-oob-authcode').is(":visible")){inputUsed=jQuery('#wp-2fa-oob-authcode');}}else{const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=currentSubStep.nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');nextSubStep.addClass('active');updateStepTitles();} |
  |  | 28 | const userID=jQuery(this).attr('data-user-id');const nonce=jQuery(this).attr('data-nonce');const thisBtn=jQuery(this);jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,email\_address:emailAddress,user\_id:userID,nonce:nonce},error:function(jqXHR,textStatus,errorThrown){if(false===jqXHR.responseJSON.success){let errMsg=jQuery('#2fa-error-msg');if(errMsg.length){errMsg.remove();} |
  |  | 29 | jQuery('<span id="2fa-error-msg" style="color:red;">'+jqXHR.responseJSON.data[0].message+'</span>').insertAfter(inputUsed);}},complete:function(data){},success:function(data){let errMsg=jQuery('#2fa-error-msg');if(errMsg.length){errMsg.remove();} |
  |  | 30 | if(updateBtnText){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(wp2faWizardData.codeReSentText);jQuery(thisBtn).find('span').fadeTo(100,1);});setTimeout(function(){jQuery(thisBtn).find('span').fadeTo(100,0,function(){jQuery(thisBtn).find('span').delay(100);jQuery(thisBtn).find('span').text(originalBtnText);jQuery(thisBtn).find('span').fadeTo(100,1);});},2500);}}});});jQuery(document).on('change','[name="wp\_2fa\_enabled\_methods"]',function(event){var step=jQuery('[name="wp\_2fa\_enabled\_methods"]:checked').val();jQuery('.2fa-choose-method[data-next-step]').attr('data-next-step',`2fa-wizard-${step}`);});jQuery('body').on('click','.button[data-name="next\_step\_setting\_modal\_wizard"]',function(e){e.preventDefault;var nextStep=jQuery(this).attr('data-next-step');if(nextStep){const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(`#${nextStep}`);jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper').removeClass('active');jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');}else{const currentSubStep=jQuery(this).parent().parent().find('.active').not('.step-setting-wrapper');const nextSubStep=jQuery(currentSubStep).next();jQuery('.wizard-step.active').removeClass('active');jQuery(nextSubStep).addClass('active');} |
  |  | 31 | jQuery('.inline-helper').remove();});jQuery('body').on('click','.button[data-trigger-generate-backup-codes]',function(e){e.preventDefault();const actionToRun='wp2fa\_run\_ajax\_generate\_json';const nonceValue=jQuery(this).attr('data-nonce');const currentSubStep=jQuery(this).closest('.step-setting-wrapper.active');const nextSubStep=jQuery(currentSubStep).nextAll('div:not(.hidden)').filter(':first');jQuery(currentSubStep).removeClass('active');jQuery(nextSubStep).addClass('active');updateStepTitles();jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue},complete:function(data){jQuery('#backup-codes-wrapper').slideUp(0);jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val('');var codes=jQuery.parseJSON(data.responseText);var codes=codes.data['codes'];jQuery.each(codes,function(index,value){var oldValue=jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val();var counter=index+1;jQuery('.wp2fa-modal.is-open #backup-codes-wrapper, .wp2fa-setup-content #backup-codes-wrapper').val(oldValue+counter+': '+`${value} \n`);});jQuery('#backup-codes-wrapper').slideDown(500);jQuery('.close-wizard-link').text(wp2faWizardData.readyText).fadeIn(50);}},);});jQuery('body').on('click','.button[data-trigger-reset-key]',function(e){e.preventDefault();if(jQuery('.qr-code-wrapper').length){jQuery('.qr-code-wrapper').addClass('regenerating');} |
  | 29 | 32 | var doReload=jQuery(this).attr('data-trigger-reset-key');const thisButton=jQuery(this);const actionToRun='regenerate\_authentication\_key';const nonceValue=jQuery(this).attr('data-nonce');const userID=jQuery(this).attr('data-user-id');jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue,user\_id:userID},complete:function(data){if(jQuery('.change-2fa-confirm.hidden').length){jQuery('.change-2fa-confirm.hidden').trigger('click');} |
  | 30 | 33 | if(jQuery('.app-key').length){jQuery('#wp-2fa-totp-qrcode').attr('src',data.responseJSON.data['qr']);jQuery('.app-key').val(data.responseJSON.data['key']);jQuery('[name="wp-2fa-totp-key"]').val(data.responseJSON.data['key']);setTimeout(function(){jQuery('.qr-code-wrapper').removeClass('regenerating');},500);}}},);});jQuery('body').on('click','.button[data-trigger-backup-code-email]',function(e){e.preventDefault();const thisButton=jQuery(this);const actionToRun='send\_backup\_codes\_email';const nonceValue=jQuery(this).attr('data-nonce');const userID=jQuery(this).attr('data-user-id');const codesWrapper=JSON.stringify(jQuery('.active #backup-codes-wrapper').val());jQuery.ajax({type:'POST',dataType:'json',url:wp2faData.ajaxURL,data:{action:actionToRun,\_wpnonce:nonceValue,user\_id:userID,codes:codesWrapper},complete:function(data){jQuery('.button[data-trigger-backup-code-email]').text(wp2faWizardData.backupCodesSent).attr('value',wp2faWizardData.backupCodesSent);}},);});jQuery('body').on('click','.click-to-copy',function(e){var copyText=jQuery(this).prev();copyText.select();if(typeof copyText.setSelectionRange!=="undefined"){copyText.setSelectionRange(0,99999);} |
  | 31 | 34 | navigator.clipboard.writeText(copyText[0].value);jQuery(this).addClass('done').html('Copied');});jQuery('body').on('click','.button[data-trigger-backup-code-copy]',function(e){e.preventDefault();var copyText=jQuery('.active #backup-codes-wrapper');copyText.select();if(typeof copyText.setSelectionRange!=="undefined"){copyText.setSelectionRange(0,99999);} |
  | 32 | 35 | navigator.clipboard.writeText(copyText[0].value);jQuery(this).addClass('done').html('Copied');});jQuery('body').on('click','.button[data-trigger-backup-code-download]',function(e){e.preventDefault();const userName=jQuery(this).attr('data-user');const websiteURL=jQuery(this).attr('data-website-url');const preamble=`${wp2faWizardData.codesPreamble} ${userName} on the website ${websiteURL}:\n\n`;var codesWrapper=jQuery('.active #backup-codes-wrapper').val().split(' ').join('\n');download('backup\_codes.txt',preamble+codesWrapper);});jQuery('body').on('click','.button[data-trigger-print]',function(e){e.preventDefault();const userName=jQuery(this).attr('data-user-id');const websiteURL=jQuery(this).attr('data-website-url');const preamble=`${wp2faWizardData.codesPreamble} ${userName} on the website ${websiteURL}:\n\n`;const divToPrint=jQuery('.active #backup-codes-wrapper').val();const newWin=window.open('','Print-Window');newWin.document.open();newWin.document.write(`<html><body onload="window.print()">${preamble}</br></br>${divToPrint}</body></html>`);newWin.document.close();setTimeout(function(){newWin.close();},10);});function download(filename,text){const element=document.createElement('a');element.setAttribute('href',`data:text/plain;charset=utf-8,${encodeURIComponent( text )}`);element.setAttribute('download',filename);element.style.display='none';document.body.appendChild(element);element.click();document.body.removeChild(element);} |
  | 33 |  | jQuery(document).on('click','#custom-email-address',function(){jQuery('#use\_custom\_email').prop('checked',true);});jQuery(document).on('click','[data-check-on-click]',function(){const thingToCheck=jQuery(this).attr('data-check-on-click');jQuery(thingToCheck).prop('checked',true);});jQuery(document).on('click','[data-trigger-submit-form]',function(e){e.preventDefault();const thingToSubmit=jQuery(this).attr('data-trigger-submit-form');jQuery('.change-2fa-confirm').trigger('click');});jQuery(document).on('click','[data-reload]',function(e){removeShowParam();});window.removeShowParam=function(){let url=new URL(location.href);let params=new URLSearchParams(url.search);params.delete('show');location.replace(`${location.pathname}?${params}`);} |
  |  | 36 | jQuery(document).on('click','#custom-email-address',function(){jQuery('#use\_custom\_email').prop('checked',true);});jQuery(document).on('click','#custom-oob-email-address',function(){jQuery('#use\_custom\_oob\_email').prop('checked',true);});jQuery(document).on('click','[data-check-on-click]',function(){const thingToCheck=jQuery(this).attr('data-check-on-click');jQuery(thingToCheck).prop('checked',true);});jQuery(document).on('click','[data-trigger-submit-form]',function(e){e.preventDefault();const thingToSubmit=jQuery(this).attr('data-trigger-submit-form');jQuery('.change-2fa-confirm').trigger('click');});jQuery(document).on('click','[data-reload]',function(e){removeShowParam();});window.removeShowParam=function(){let url=new URL(location.href);let params=new URLSearchParams(url.search);params.delete('show');location.replace(`${location.pathname}?${params}`);} |
  | 34 | 37 | jQuery('[name="wp\_2fa\_settings[enforcement-policy]"]').on("input",function(){if(jQuery('input[name="wp\_2fa\_settings[enforcement-policy]"]:checked').val()!=='do-not-enforce'){jQuery('[data-step-title="Exclude users"]').removeClass('hidden');updateStepTitles();}else{jQuery('[data-step-title="Exclude users"]').addClass('hidden');updateStepTitles();}});jQuery('body').on('click','.iti\_\_flag-container',function(e){var isExpand=(jQuery('.iti\_\_selected-flag').attr('aria-expanded'))?'expand-panel':'';jQuery(this).closest('.wizard-step.active').toggleClass(isExpand);});jQuery('body').on('click','.step-setting-wrapper #all-users, .step-setting-wrapper #certain-roles-only',function(e){jQuery('.step-setting-wrapper.active .continue-wizard').removeClass('hidden');jQuery('.step-setting-wrapper.active .save-wizard').addClass('hidden');});jQuery('body').on('click','.step-setting-wrapper #do-not-enforce',function(e){jQuery('.step-setting-wrapper.active .continue-wizard').addClass('hidden');jQuery('.step-setting-wrapper.active .save-wizard').removeClass('hidden');});});window.onresize=function(){checkWizardOffset();} |
  | 35 | 38 | function checkWizardOffset(){var elem=document.querySelector('.setup-wizard-wrapper');if(elem){var bounding=elem.getBoundingClientRect();if(bounding.top<0){var clientHeight=bounding.height / 2;elem.style.cssText+='top: '+clientHeight+'px';}}} |
  | 36 | 39 | window.wp2fa\_fireWizard=function(){jQuery('.verification-response span').remove();jQuery('#configure-2fa .wizard-step.active, #configure-2fa .step-setting-wrapper.active').removeClass('active');jQuery('#configure-2fa .wizard-step:first-of-type, #configure-2fa .step-setting-wrapper:first-of-type').addClass('active');jQuery('.modal\_\_content input:not([type="radio"]):not([type="hidden"])').not('.app-key').val('');MicroModal.show('configure-2fa');if(jQuery('input#basic').is(':visible')){jQuery('input#basic').trigger("click");}else{if(jQuery('input#geek').is(':visible')){jQuery('input#geek').trigger("click");}else{if(jQuery('input#oob').length){jQuery('input#oob').trigger("click");}else if(jQuery('input#authy').length){jQuery('input#authy').trigger("click");}else if(jQuery('input#twilio').length){jQuery('input#twilio').trigger("click");}}} |
  | 37 |  | jQuery('[name="wp\_2fa\_enabled\_methods"]').change();if(1===jQuery('.wizard-step.active .option-pill').length){jQuery('.wp-2fa-button-primary.2fa-choose-method').trigger("click");}}; |
  |  | 40 | jQuery('[name="wp\_2fa\_enabled\_methods"]').change();if(1===jQuery('.wizard-step.active .option-pill').length){jQuery('.wp-2fa-button-primary.2fa-choose-method').trigger("click");}else{jQuery('#configure-2fa .wizard-step:first-of-type, #configure-2fa input:radio[name=wp\_2fa\_enabled\_methods]:first').prop("checked",true);jQuery('[name="wp\_2fa\_enabled\_methods"]').change();jQuery('#configure-2fa .wizard-step:first-of-type, #configure-2fa input:radio[name=wp\_2fa\_enabled\_methods]:first').trigger("click");}}; |
  | 38 | 41 | } |
  | 39 | 42 | catch(e){console.error("An error has occurred common.js: "+e.stack);} |
* ## [wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=2940688#L14 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=3009922#L14 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 14 | 14 | use WP2FA\WP2FA; |
  | 15 | 15 | use WP2FA\Admin\Controllers\Settings; |
  |  | 16 | use WP2FA\Extensions\EmailBackup\Email\_Backup; |
  |  | 17 | use WP2FA\Extensions\OutOfBand\Out\_Of\_Band; |
  |  | 18 | use WP2FA\Methods\Backup\_Codes; |
  | 16 | 19 |  |
  | 17 | 20 | defined( 'ABSPATH' ) || exit; // Exit if accessed directly. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=2940688#L49) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=3009922#L52) |  |
  | 49 | 52 | $available\_methods = array(); |
  | 50 | 53 |  |
  | 51 |  | ~~if ( ! empty( Settings::get\_role\_or\_default\_setting( 'enable\_email', 'current' ) ) ) {~~ |
  | 52 |  | ~~$available\_methods[] = 'email';~~ |
  | 53 |  | ~~}~~ |
  | 54 |  |  |
  | 55 |  | ~~if ( ! empty( Settings::get\_role\_or\_default\_setting( 'enable\_totp', 'current' ) ) ) {~~ |
  | 56 |  | ~~$available\_methods[] = 'totp';~~ |
  | 57 |  | ~~}~~ |
  | 58 |  |  |
  | 59 | 54 | /\*\* |
  | 60 | 55 | \* Add an option for external providers to implement their own 2fa methods and set them as available. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=2940688#L83) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-methods.php?rev=3009922#L78) |  |
  | 83 | 78 | foreach ( $providers as $provider ) { |
  | 84 | 79 | if ( Settings::is\_provider\_enabled\_for\_role( $role, $provider ) ) { |
  | 85 |  | if ( ~~'backup\_codes'~~ === $provider ) { |
  |  | 80 | if ( Backup\_Codes::METHOD\_NAME === $provider ) { |
  | 86 | 81 | // Backup codes is a secondary provider - ignore it. |
  | 87 | 82 | continue; |
  | 88 |  | } elseif ( ~~'backup\_email'~~ === $provider ) { |
  |  | 83 | } elseif ( \class\_exists( 'WP2FA\Extensions\EmailBackup\Email\_Backup', false ) && Email\_Backup::METHOD\_NAME === $provider ) { |
  | 89 | 84 | // Backup email codes is a secondary provider - ignore it. |
  | 90 | 85 | continue; |
  | 91 |  | } elseif ( ~~'oob'~~ === $provider ) { |
  |  | 86 | } elseif ( class\_exists( '\WP2FA\Extensions\OutOfBand\Out\_Of\_Band', false ) && Out\_Of\_Band::METHOD\_NAME === $provider ) { |
  | 92 | 87 | self::$enabled\_methods[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable\_' . $provider . '\_email', false, false, $role ); |
  | 93 | 88 | } else { |
* ## [wp-2fa/trunk/includes/classes/Admin/Controllers/class-settings.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Controllers/class-settings.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Controllers/class-settings.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-settings.php?rev=2940688#L15 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Controllers/class-settings.php?rev=3009922#L15 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 |  |
  | 16 | 16 | use WP2FA\WP2FA; |
  | 17 |  | use \WP2FA\Admin\Settings\_Page; |
  |  | 17 | use WP2FA\Admin\Settings\_Page; |
  |  | 18 | use WP2FA\Methods\Backup\_Codes; |
  | 18 | 19 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 19 | 20 | use WP2FA\Admin\Helpers\User\_Helper; |
  |  | 21 | use WP2FA\Extensions\OutOfBand\Out\_Of\_Band; |
  | 20 | 22 | use WP2FA\Admin\SettingsPages\Settings\_Page\_Policies; |
  | 21 | 23 |  |
  | 22 | 24 | defined( 'ABSPATH' ) || exit; // Exit if accessed directly. |
  | 23 | 25 |  |
  | 24 |  | /\*\* |
  | 25 |  | \* WP2FA Settings controller |
  | 26 |  | \*/ |
  | 27 |  | class Settings { |
  | 28 |  |  |
  |  | 26 | if ( ! class\_exists( '\WP2FA\Admin\Controllers\Settings' ) ) { |
  | 29 | 27 | /\*\* |
  | 30 |  | \* The link to the WP admin settings page |
  | 31 |  | \* |
  | 32 |  | \* @var string |
  |  | 28 | \* WP2FA Settings controller |
  | 33 | 29 | \*/ |
  | 34 |  | private static $settings\_page\_link = ''; |
  | 35 |  |  |
  | 36 |  | /\*\* |
  | 37 |  | \* The name of the WP2FA WP admin setup page |
  | 38 |  | \* |
  | 39 |  | \* @var string |
  | 40 |  | \*/ |
  | 41 |  | private static $setup\_page\_name = 'wp-2fa-setup'; |
  | 42 |  |  |
  | 43 |  | /\*\* |
  | 44 |  | \* The link to the WP admin setup page |
  | 45 |  | \* |
  | 46 |  | \* @var string |
  | 47 |  | \*/ |
  | 48 |  | private static $setup\_page\_link = ''; |
  | 49 |  |  |
  | 50 |  | /\*\* |
  | 51 |  | \* The link to the custom settings page (if one is presented) |
  | 52 |  | \* |
  | 53 |  | \* @var string |
  | 54 |  | \*/ |
  | 55 |  | private static $custom\_setup\_page\_link = null; |
  | 56 |  |  |
  | 57 |  | /\*\* |
  | 58 |  | \* Array with all the backup methods available |
  | 59 |  | \* |
  | 60 |  | \* @var array |
  | 61 |  | \* |
  | 62 |  | \* @since 2.0.0 |
  | 63 |  | \*/ |
  | 64 |  | private static $backup\_methods = null; |
  | 65 |  |  |
  | 66 |  | /\*\* |
  | 67 |  | \* All available providers for the plugin |
  | 68 |  | \* For the specific role @see get\_all\_providers\_for\_role() |
  | 69 |  | \* |
  | 70 |  | \* @var array |
  | 71 |  | \* |
  | 72 |  | \* @since 2.2.0 |
  | 73 |  | \*/ |
  | 74 |  | private static $all\_providers = array(); |
  | 75 |  |  |
  | 76 |  | /\*\* |
  | 77 |  | \* All available providers for the plugin with their translated names. |
  | 78 |  | \* |
  | 79 |  | \* @var array |
  | 80 |  | \* |
  | 81 |  | \* @since 2.5.0 |
  | 82 |  | \*/ |
  | 83 |  | private static $all\_providers\_names\_translated = array(); |
  | 84 |  |  |
  | 85 |  | /\*\* |
  | 86 |  | \* All the available providers by user roles |
  | 87 |  | \* |
  | 88 |  | \* @var array |
  | 89 |  | \* |
  | 90 |  | \* @since 2.2.0 |
  | 91 |  | \*/ |
  | 92 |  | private static $all\_providers\_for\_roles = array(); |
  | 93 |  |  |
  | 94 |  | /\*\* |
  | 95 |  | \* Returns the link to the WP admin settings page, based on the current WP install |
  | 96 |  | \* |
  | 97 |  | \* @return string |
  | 98 |  | \*/ |
  | 99 |  | public static function get\_settings\_page\_link() { |
  | 100 |  | if ( '' === self::$settings\_page\_link ) { |
  | 101 |  | self::$settings\_page\_link = add\_query\_arg( 'page', Settings\_Page::TOP\_MENU\_SLUG, network\_admin\_url( 'admin.php' ) ); |
  | 102 |  | } |
  | 103 |  |  |
  | 104 |  | return self::$settings\_page\_link; |
  | 105 |  | } |
  | 106 |  |  |
  | 107 |  | /\*\* |
  | 108 |  | \* Returns the link to the WP admin settings page, based on the current WP install |
  | 109 |  | \* |
  | 110 |  | \* @return string |
  | 111 |  | \*/ |
  | 112 |  | public static function get\_setup\_page\_link() { |
  | 113 |  | if ( '' === self::$setup\_page\_link ) { |
  | 114 |  | if ( WP\_Helper::is\_multisite() ) { |
  | 115 |  | self::$setup\_page\_link = add\_query\_arg( 'show', self::$setup\_page\_name, get\_admin\_url( get\_current\_blog\_id(), 'profile.php' ) ); |
  | 116 |  | } else { |
  | 117 |  | self::$setup\_page\_link = add\_query\_arg( 'show', self::$setup\_page\_name, admin\_url( 'profile.php' ) ); |
  | 118 |  | } |
  | 119 |  | } |
  | 120 |  |  |
  | 121 |  | return self::$setup\_page\_link; |
  | 122 |  | } |
  | 123 |  |  |
  | 124 |  | /\*\* |
  | 125 |  | \* Extracts the custom settings page URL |
  | 126 |  | \* |
  | 127 |  | \* @param mixed $user - User for which to extract the setting, null, \WP\_User or user id - @see get\_role\_or\_default\_setting method of this class. |
  | 128 |  | \* |
  | 129 |  | \* @return string |
  | 130 |  | \*/ |
  | 131 |  | public static function get\_custom\_page\_link( $user = null ): string { |
  | 132 |  | if ( null === self::$custom\_setup\_page\_link ) { |
  | 133 |  | self::$custom\_setup\_page\_link = self::get\_role\_or\_default\_setting( 'custom-user-page-id', $user ); |
  | 134 |  |  |
  | 135 |  | if ( ! empty( self::$custom\_setup\_page\_link ) ) { |
  | 136 |  | $custom\_slug = ''; |
  | 137 |  | if ( WP\_Helper::is\_multisite() ) { |
  | 138 |  | switch\_to\_blog( get\_main\_site\_id() ); |
  | 139 |  |  |
  | 140 |  | $custom\_slug                  = get\_post\_field( 'post\_name', get\_post( self::$custom\_setup\_page\_link ) ); |
  | 141 |  | self::$custom\_setup\_page\_link = trailingslashit( get\_site\_url() ) . $custom\_slug; |
  | 142 |  |  |
  | 143 |  | restore\_current\_blog(); |
  |  | 30 | class Settings { |
  |  | 31 |  |
  |  | 32 | /\*\* |
  |  | 33 | \* The link to the WP admin settings page |
  |  | 34 | \* |
  |  | 35 | \* @var string |
  |  | 36 | \*/ |
  |  | 37 | private static $settings\_page\_link = ''; |
  |  | 38 |  |
  |  | 39 | /\*\* |
  |  | 40 | \* The name of the WP2FA WP admin setup page |
  |  | 41 | \* |
  |  | 42 | \* @var string |
  |  | 43 | \*/ |
  |  | 44 | private static $setup\_page\_name = 'wp-2fa-setup'; |
  |  | 45 |  |
  |  | 46 | /\*\* |
  |  | 47 | \* The link to the WP admin setup page |
  |  | 48 | \* |
  |  | 49 | \* @var string |
  |  | 50 | \*/ |
  |  | 51 | private static $setup\_page\_link = ''; |
  |  | 52 |  |
  |  | 53 | /\*\* |
  |  | 54 | \* The link to the custom settings page (if one is presented) |
  |  | 55 | \* |
  |  | 56 | \* @var string |
  |  | 57 | \*/ |
  |  | 58 | private static $custom\_setup\_page\_link = null; |
  |  | 59 |  |
  |  | 60 | /\*\* |
  |  | 61 | \* Array with all the backup methods available |
  |  | 62 | \* |
  |  | 63 | \* @var array |
  |  | 64 | \* |
  |  | 65 | \* @since 2.0.0 |
  |  | 66 | \*/ |
  |  | 67 | private static $backup\_methods = null; |
  |  | 68 |  |
  |  | 69 | /\*\* |
  |  | 70 | \* All available providers for the plugin |
  |  | 71 | \* For the specific role @see get\_all\_providers\_for\_role() |
  |  | 72 | \* |
  |  | 73 | \* @var array |
  |  | 74 | \* |
  |  | 75 | \* @since 2.2.0 |
  |  | 76 | \*/ |
  |  | 77 | private static $all\_providers = array(); |
  |  | 78 |  |
  |  | 79 | /\*\* |
  |  | 80 | \* All available providers for the plugin with their translated names. |
  |  | 81 | \* |
  |  | 82 | \* @var array |
  |  | 83 | \* |
  |  | 84 | \* @since 2.5.0 |
  |  | 85 | \*/ |
  |  | 86 | private static $all\_providers\_names\_translated = array(); |
  |  | 87 |  |
  |  | 88 | /\*\* |
  |  | 89 | \* All the available providers by user roles |
  |  | 90 | \* |
  |  | 91 | \* @var array |
  |  | 92 | \* |
  |  | 93 | \* @since 2.2.0 |
  |  | 94 | \*/ |
  |  | 95 | private static $all\_providers\_for\_roles = array(); |
  |  | 96 |  |
  |  | 97 | /\*\* |
  |  | 98 | \* Returns the link to the WP admin settings page, based on the current WP install |
  |  | 99 | \* |
  |  | 100 | \* @return string |
  |  | 101 | \*/ |
  |  | 102 | public static function get\_settings\_page\_link() { |
  |  | 103 | if ( '' === self::$settings\_page\_link ) { |
  |  | 104 | self::$settings\_page\_link = add\_query\_arg( 'page', Settings\_Page::TOP\_MENU\_SLUG, network\_admin\_url( 'admin.php' ) ); |
  |  | 105 | } |
  |  | 106 |  |
  |  | 107 | return self::$settings\_page\_link; |
  |  | 108 | } |
  |  | 109 |  |
  |  | 110 | /\*\* |
  |  | 111 | \* Returns the link to the WP admin settings page, based on the current WP install |
  |  | 112 | \* |
  |  | 113 | \* @return string |
  |  | 114 | \*/ |
  |  | 115 | public static function get\_setup\_page\_link() { |
  |  | 116 | if ( '' === self::$setup\_page\_link ) { |
  |  | 117 | self::$setup\_page\_link = self::get\_custom\_page\_link(); |
  |  | 118 |  |
  |  | 119 | if ( empty( self::$setup\_page\_link ) ) { |
  |  | 120 | if ( WP\_Helper::is\_multisite() ) { |
  |  | 121 | self::$setup\_page\_link = add\_query\_arg( 'show', self::$setup\_page\_name, get\_admin\_url( get\_current\_blog\_id(), 'profile.php' ) ); |
  |  | 122 | } else { |
  |  | 123 | self::$setup\_page\_link = add\_query\_arg( 'show', self::$setup\_page\_name, admin\_url( 'profile.php' ) ); |
  |  | 124 | } |
  |  | 125 | } |
  |  | 126 | } |
  |  | 127 |  |
  |  | 128 | return apply\_filters( WP\_2FA\_PREFIX . 'setup\_page\_link', self::$setup\_page\_link ); |
  |  | 129 | } |
  |  | 130 |  |
  |  | 131 | /\*\* |
  |  | 132 | \* Extracts the custom settings page URL |
  |  | 133 | \* |
  |  | 134 | \* @param mixed $user - User for which to extract the setting, null, \WP\_User or user id - @see get\_role\_or\_default\_setting method of this class. |
  |  | 135 | \* |
  |  | 136 | \* @return string |
  |  | 137 | \*/ |
  |  | 138 | public static function get\_custom\_page\_link( $user = null ): string { |
  |  | 139 | if ( null === self::$custom\_setup\_page\_link ) { |
  |  | 140 | self::$custom\_setup\_page\_link = self::get\_role\_or\_default\_setting( 'custom-user-page-id', $user ); |
  |  | 141 |  |
  |  | 142 | if ( ! empty( self::$custom\_setup\_page\_link ) ) { |
  |  | 143 | $custom\_slug = ''; |
  |  | 144 | if ( WP\_Helper::is\_multisite() ) { |
  |  | 145 | switch\_to\_blog( get\_main\_site\_id() ); |
  |  | 146 |  |
  |  | 147 | $custom\_slug                  = get\_post\_field( 'post\_name', get\_post( self::$custom\_setup\_page\_link ) ); |
  |  | 148 | self::$custom\_setup\_page\_link = trailingslashit( get\_site\_url() ) . $custom\_slug; |
  |  | 149 |  |
  |  | 150 | restore\_current\_blog(); |
  |  | 151 | } else { |
  |  | 152 | $custom\_slug                  = get\_post\_field( 'post\_name', get\_post( self::$custom\_setup\_page\_link ) ); |
  |  | 153 | self::$custom\_setup\_page\_link = trailingslashit( get\_site\_url() ) . $custom\_slug; |
  |  | 154 | } |
  | 144 | 155 | } else { |
  | 145 |  | $custom\_slug                  = get\_post\_field( 'post\_name', get\_post( self::$custom\_setup\_page\_link ) ); |
  | 146 |  | self::$custom\_setup\_page\_link = trailingslashit( get\_site\_url() ) . $custom\_slug; |
  | 147 |  | } |
  | 148 |  | } |
  | 149 |  | } |
  | 150 |  |  |
  | 151 |  | return self::$custom\_setup\_page\_link; |
  | 152 |  | } |
  | 153 |  |  |
  | 154 |  | /\*\* |
  | 155 |  | \* Check all the roles for given setting |
  | 156 |  | \* |
  | 157 |  | \* @param string $setting\_name - The name of the setting to check for. |
  | 158 |  | \* |
  | 159 |  | \* @return boolean |
  | 160 |  | \* |
  | 161 |  | \* @since 2.0.0 |
  | 162 |  | \*/ |
  | 163 |  | public static function check\_setting\_in\_all\_roles( string $setting\_name ): bool { |
  | 164 |  | $roles = WP\_Helper::get\_roles(); |
  | 165 |  |  |
  | 166 |  | foreach ( $roles as $role ) { |
  | 167 |  | if ( ! empty( WP2FA::get\_wp2fa\_setting( $setting\_name, false, false, $role ) ) ) { |
  | 168 |  | return true; |
  | 169 |  | } |
  | 170 |  | } |
  | 171 |  |  |
  | 172 |  | return false; |
  | 173 |  | } |
  | 174 |  |  |
  | 175 |  | /\*\* |
  | 176 |  | \* Return setting specific for the given role or default setting (based on user) |
  | 177 |  | \* |
  | 178 |  | \* @param string  $setting\_name - The name of the setting. |
  | 179 |  | \* @param mixed   $user - \WP\_User or any string or null - if string the current user will be used, if null global plugin setting will be used. |
  | 180 |  | \* @param mixed   $role - The name of the role (or null). |
  | 181 |  | \* @param boolean $get\_default\_on\_empty - Get default setting on empty setting value. |
  | 182 |  | \* @param boolean $get\_default\_value - Extracts default value. |
  | 183 |  | \* |
  | 184 |  | \* @return mixed |
  | 185 |  | \* |
  | 186 |  | \* @since 2.0.0 |
  | 187 |  | \*/ |
  | 188 |  | public static function get\_role\_or\_default\_setting( string $setting\_name, $user = null, $role = null, $get\_default\_on\_empty = false, $get\_default\_value = false ) { |
  | 189 |  | if ( null === $role ) { |
  |  | 156 | $custom\_user\_page\_id = (int) self::get\_custom\_settings\_page\_id( '', $user ); |
  |  | 157 | if ( ! empty( $custom\_user\_page\_id ) ) { |
  |  | 158 | self::$custom\_setup\_page\_link = get\_permalink( $custom\_user\_page\_id ); |
  |  | 159 | } |
  |  | 160 | } |
  |  | 161 | } |
  |  | 162 |  |
  |  | 163 | return (string) apply\_filters( WP\_2FA\_PREFIX . 'custom\_setup\_page\_link', self::$custom\_setup\_page\_link, $user ); |
  |  | 164 | } |
  |  | 165 |  |
  |  | 166 | /\*\* |
  |  | 167 | \* Check all the roles for given setting |
  |  | 168 | \* |
  |  | 169 | \* @param string $setting\_name - The name of the setting to check for. |
  |  | 170 | \* |
  |  | 171 | \* @return boolean |
  |  | 172 | \* |
  |  | 173 | \* @since 2.0.0 |
  |  | 174 | \*/ |
  |  | 175 | public static function check\_setting\_in\_all\_roles( string $setting\_name ): bool { |
  |  | 176 | $roles = WP\_Helper::get\_roles(); |
  |  | 177 |  |
  |  | 178 | foreach ( $roles as $role ) { |
  |  | 179 | if ( ! empty( WP2FA::get\_wp2fa\_setting( $setting\_name, false, false, $role ) ) ) { |
  |  | 180 | return true; |
  |  | 181 | } |
  |  | 182 | } |
  |  | 183 |  |
  |  | 184 | return false; |
  |  | 185 | } |
  |  | 186 |  |
  |  | 187 | /\*\* |
  |  | 188 | \* Return setting specific for the given role or default setting (based on user) |
  |  | 189 | \* |
  |  | 190 | \* @param string  $setting\_name - The name of the setting. |
  |  | 191 | \* @param mixed   $user - \WP\_User or any string or null - if string the current user will be used, if null global plugin setting will be used. |
  |  | 192 | \* @param mixed   $role - The name of the role (or null). |
  |  | 193 | \* @param boolean $get\_default\_on\_empty - Get default setting on empty setting value. |
  |  | 194 | \* @param boolean $get\_default\_value - Extracts default value. |
  |  | 195 | \* |
  |  | 196 | \* @return mixed |
  |  | 197 | \* |
  |  | 198 | \* @since 2.0.0 |
  |  | 199 | \*/ |
  |  | 200 | public static function get\_role\_or\_default\_setting( string $setting\_name, $user = null, $role = null, $get\_default\_on\_empty = false, $get\_default\_value = false ) { |
  |  | 201 | if ( null === $role ) { |
  |  | 202 | /\*\* |
  |  | 203 | \* No user specified - get the default settings |
  |  | 204 | \*/ |
  |  | 205 | if ( null === $user || \WP\_2FA\_PREFIX . 'no-user' === $user ) { |
  |  | 206 | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value ); |
  |  | 207 | } |
  |  | 208 |  |
  |  | 209 | /\*\* |
  |  | 210 | \* There is an User - extract the role |
  |  | 211 | \*/ |
  |  | 212 | if ( $user instanceof \WP\_User || is\_int( $user ) ) { |
  |  | 213 | if ( null === $role ) { |
  |  | 214 | $role = User\_Helper::get\_user\_role( $user ); |
  |  | 215 | } |
  |  | 216 | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value, $role ); |
  |  | 217 | } |
  |  | 218 |  |
  |  | 219 | /\*\* |
  |  | 220 | \* No logged in current user, ergo no roles - fall back to defaults |
  |  | 221 | \*/ |
  |  | 222 | if ( 0 === User\_Helper::get\_user\_object()->ID ) { |
  |  | 223 | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value ); |
  |  | 224 | } |
  |  | 225 |  |
  |  | 226 | $role = User\_Helper::get\_user\_role(); |
  |  | 227 | } |
  |  | 228 |  |
  |  | 229 | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value, $role ); |
  |  | 230 | } |
  |  | 231 |  |
  |  | 232 | /\*\* |
  |  | 233 | \* Returns all the backup methods currently supported |
  |  | 234 | \* |
  |  | 235 | \* @return array |
  |  | 236 | \* |
  |  | 237 | \* @since 2.0.0 |
  |  | 238 | \*/ |
  |  | 239 | public static function get\_backup\_methods(): array { |
  |  | 240 |  |
  |  | 241 | if ( null === self::$backup\_methods ) { |
  |  | 242 |  |
  |  | 243 | /\*\* |
  |  | 244 | \* Gives the ability to add additional backup methods |
  |  | 245 | \* |
  |  | 246 | \* @param array The array with all the backup methods currently supported. |
  |  | 247 | \* |
  |  | 248 | \* @since 2.0.0 |
  |  | 249 | \*/ |
  |  | 250 | self::$backup\_methods = apply\_filters( WP\_2FA\_PREFIX . 'backup\_methods\_list', array() ); |
  |  | 251 | } |
  |  | 252 |  |
  |  | 253 | return self::$backup\_methods; |
  |  | 254 | } |
  |  | 255 |  |
  |  | 256 | /\*\* |
  |  | 257 | \* Get backup methods enabled for user based on its role |
  |  | 258 | \* |
  |  | 259 | \* @param \WP\_User $user - The WP user which we must check. |
  |  | 260 | \* |
  |  | 261 | \* @return array |
  |  | 262 | \* |
  |  | 263 | \* @since 2.0.0 |
  |  | 264 | \*/ |
  |  | 265 | public static function get\_enabled\_backup\_methods\_for\_user\_role( \WP\_User $user ): array { |
  |  | 266 | $backup\_methods = self::get\_backup\_methods(); |
  |  | 267 |  |
  | 190 | 268 | /\*\* |
  | 191 |  | \* No user specified - get the default settings |
  | 192 |  | \*/ |
  | 193 |  | if ( null === $user || \WP\_2FA\_PREFIX . 'no-user' === $user ) { |
  | 194 |  | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value ); |
  | 195 |  | } |
  | 196 |  |  |
  | 197 |  | /\*\* |
  | 198 |  | \* There is an User - extract the role |
  | 199 |  | \*/ |
  | 200 |  | if ( $user instanceof \WP\_User || is\_int( $user ) ) { |
  | 201 |  | if ( null === $role ) { |
  | 202 |  | $role = User\_Helper::get\_user\_role( $user ); |
  | 203 |  | } |
  | 204 |  | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value, $role ); |
  | 205 |  | } |
  | 206 |  |  |
  | 207 |  | /\*\* |
  | 208 |  | \* No logged in current user, ergo no roles - fall back to defaults |
  | 209 |  | \*/ |
  | 210 |  | if ( 0 === User\_Helper::get\_user\_object()->ID ) { |
  | 211 |  | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value ); |
  | 212 |  | } |
  | 213 |  |  |
  | 214 |  | $role = User\_Helper::get\_user\_role(); |
  | 215 |  | } |
  | 216 |  |  |
  | 217 |  | return WP2FA::get\_wp2fa\_setting( $setting\_name, $get\_default\_on\_empty, $get\_default\_value, $role ); |
  | 218 |  | } |
  | 219 |  |  |
  | 220 |  | /\*\* |
  | 221 |  | \* Returns all the backup methods currently supported |
  | 222 |  | \* |
  | 223 |  | \* @return array |
  | 224 |  | \* |
  | 225 |  | \* @since 2.0.0 |
  | 226 |  | \*/ |
  | 227 |  | public static function get\_backup\_methods(): array { |
  | 228 |  |  |
  | 229 |  | if ( null === self::$backup\_methods ) { |
  | 230 |  |  |
  | 231 |  | /\*\* |
  | 232 |  | \* Gives the ability to add additional backup methods |
  |  | 269 | \* Extensions could change the enabled backup methods array. |
  | 233 | 270 | \* |
  | 234 |  | \* @param array The array with all the backup methods currently supported. |
  |  | 271 | \* @param array - Backup methods array. |
  |  | 272 | \* @param \WP\_User - The user to check for. |
  | 235 | 273 | \* |
  | 236 | 274 | \* @since 2.0.0 |
  | 237 | 275 | \*/ |
  | 238 |  | self::$backup\_methods = apply\_filters( WP\_2FA\_PREFIX . 'backup\_methods\_list', array() ); |
  | 239 |  | } |
  | 240 |  |  |
  | 241 |  | return self::$backup\_methods; |
  | 242 |  | } |
  | 243 |  |  |
  | 244 |  | /\*\* |
  | 245 |  | \* Get backup methods enabled for user based on its role |
  | 246 |  | \* |
  | 247 |  | \* @param \WP\_User $user - The WP user which we must check. |
  | 248 |  | \* |
  | 249 |  | \* @return array |
  | 250 |  | \* |
  | 251 |  | \* @since 2.0.0 |
  | 252 |  | \*/ |
  | 253 |  | public static function get\_enabled\_backup\_methods\_for\_user\_role( \WP\_User $user ): array { |
  | 254 |  | $backup\_methods = self::get\_backup\_methods(); |
  | 255 |  |  |
  | 256 |  | /\*\* |
  | 257 |  | \* Extensions could change the enabled backup methods array. |
  | 258 |  | \* |
  | 259 |  | \* @param array - Backup methods array. |
  | 260 |  | \* @param \WP\_User - The user to check for. |
  | 261 |  | \* |
  | 262 |  | \* @since 2.0.0 |
  | 263 |  | \*/ |
  | 264 |  | return apply\_filters( WP\_2FA\_PREFIX . 'backup\_methods\_enabled', $backup\_methods, $user ); |
  | 265 |  | } |
  | 266 |  |  |
  | 267 |  | /\*\* |
  | 268 |  | \* Returns all enabled providers for specific role |
  | 269 |  | \* |
  | 270 |  | \* @param string $role - The name of the role to check for. |
  | 271 |  | \* |
  | 272 |  | \* @return array |
  | 273 |  | \* |
  | 274 |  | \* @throws \Exception - if the role is wrong - throws an exception. |
  | 275 |  | \* |
  | 276 |  | \* @since 2.2.0 |
  | 277 |  | \*/ |
  | 278 |  | public static function get\_enabled\_providers\_for\_role( string $role ) { |
  | 279 |  |  |
  | 280 |  | if ( WP\_Helper::is\_role\_exists( $role ) ) { |
  | 281 |  | self::get\_all\_roles\_providers(); |
  | 282 |  |  |
  | 283 |  | return self::$all\_providers\_for\_roles[ $role ]; |
  | 284 |  | } elseif ( '' === $role ) { |
  |  | 276 | return apply\_filters( WP\_2FA\_PREFIX . 'backup\_methods\_enabled', $backup\_methods, $user ); |
  |  | 277 | } |
  |  | 278 |  |
  |  | 279 | /\*\* |
  |  | 280 | \* Returns all enabled providers for specific role |
  |  | 281 | \* |
  |  | 282 | \* @param string $role - The name of the role to check for. |
  |  | 283 | \* |
  |  | 284 | \* @return array |
  |  | 285 | \* |
  |  | 286 | \* @throws \Exception - if the role is wrong - throws an exception. |
  |  | 287 | \* |
  |  | 288 | \* @since 2.2.0 |
  |  | 289 | \*/ |
  |  | 290 | public static function get\_enabled\_providers\_for\_role( string $role ) { |
  |  | 291 |  |
  |  | 292 | if ( WP\_Helper::is\_role\_exists( $role ) ) { |
  |  | 293 | self::get\_all\_roles\_providers(); |
  |  | 294 |  |
  |  | 295 | return self::$all\_providers\_for\_roles[ $role ]; |
  |  | 296 | } elseif ( '' === $role ) { |
  | 285 | 297 | return array(); |
  | 286 |  | ~~} else {~~ |
  | 287 |  | ~~throw new \Exception( 'Role provided does not exists - "' . $role . '"' );~~ |
  | 288 |  | ~~}~~ |
  | 289 |  | ~~}~~ |
  | 290 |  |  |
  | 291 |  | ~~/\*\*~~ |
  | 292 |  | ~~\* Checks if given provider is enabled for the given role.~~ |
  | 293 |  | ~~\*~~ |
  | 294 |  | ~~\* @param string $role - The name of the role.~~ |
  | 295 |  | ~~\* @param string $provider - The name of the provider.~~ |
  | 296 |  | ~~\*~~ |
  | 297 |  | ~~\* @return boolean~~ |
  | 298 |  | ~~\*~~ |
  | 299 |  | ~~\* @throws \Exception - If the provider is not registered in the plugin.~~ |
  | 300 |  | ~~\*~~ |
  | 301 |  | ~~\* @since 2.2.0~~ |
  | 302 |  | ~~\*/~~ |
  | 303 |  | ~~public static function is\_provider\_enabled\_for\_role( string $role, string $provider ): bool {~~ |
  | 304 |  | ~~self::get\_providers();~~ |
  | 305 |  |  |
  | 306 |  | ~~if ( in\_array( $provider, self::$all\_providers, true ) ) {~~ |
  | 307 |  | ~~self::get\_enabled\_providers\_for\_role( $role );~~ |
  | 308 |  | ~~if ( isset( self::$all\_providers\_for\_roles[ $role ][ $provider ] ) ) {~~ |
  | 309 |  | ~~return true;~~ |
  | 310 |  | ~~}~~ |
  | 311 |  |  |
  | 312 |  | ~~return false;~~ |
  | 313 |  | ~~}~~ |
  | 314 |  |  |
  | 315 |  | ~~throw new \Exception( 'Non existing provider ' . $provider );~~ |
  | 316 |  | ~~}~~ |
  | 317 |  |  |
  | 318 |  | ~~/\*\*~~ |
  | 319 |  | ~~\* Returns all providers by roles.~~ |
  | 320 |  | ~~\* If given role does not have specified settings set - falls back to the default settings.~~ |
  | 321 |  | ~~\*~~ |
  | 322 |  | ~~\* @return array~~ |
  | 323 |  | ~~\*~~ |
  | 324 |  | ~~\* @since 2.2.0~~ |
  | 325 |  | ~~\*/~~ |
  | 326 |  | ~~public static function get\_all\_roles\_providers() {~~ |
  | 327 |  | ~~if ( empty( self::$all\_providers\_for\_roles ) ) {~~ |
  | 328 |  | ~~$roles     = WP\_Helper::get\_roles();~~ |
  | 329 |  | ~~$providers = self::get\_providers();~~ |
  | 330 |  |  |
  | 331 |  | ~~foreach ( $roles as $role ) {~~ |
  | 332 |  | ~~self::$all\_providers\_for\_roles[ $role ] = array();~~ |
  | 333 |  | ~~foreach ( $providers as $provider ) {~~ |
  | 334 |  | ~~if ( 'backup\_codes' === $provider ) {~~ |
  | 335 |  | ~~self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( $provider . '\_enabled', false, false, $role );~~ |
  | 336 |  | ~~} elseif ( 'backup\_email' === $provider ) {~~ |
  | 337 |  | ~~self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable-email-backup', false, false, $role );~~ |
  | 338 |  | ~~} elseif ( 'oob' === $provider ) {~~ |
  | 339 |  | ~~self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable\_' . $provider . '\_email', false, false, $role );~~ |
  | 340 |  | ~~} else {~~ |
  | 341 |  | ~~self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable\_' . $provider, false, false, $role );~~ |
  | 342 |  | ~~}~~ |
  | 343 |  | ~~}~~ |
  | 344 |  | ~~self::$all\_providers\_for\_roles[ $role ] = array\_filter( self::$all\_providers\_for\_roles[ $role ] );~~ |
  | 345 |  | ~~}~~ |
  | 346 |  | ~~}~~ |
  | 347 |  |  |
  | 348 |  | ~~return self::$all\_providers\_for\_roles;~~ |
  | 349 |  | ~~}~~ |
  | 350 |  |  |
  | 351 |  | ~~/\*\*~~ |
  | 352 |  | ~~\* Returns an array with all providers and their translated name. Key is the method slug and value is the translated method name.~~ |
  | 353 |  | ~~\*~~ |
  | 354 |  | ~~\* @return array~~ |
  | 355 |  | ~~\*~~ |
  | 356 |  | ~~\* @since 2.5.0~~ |
  | 357 |  | ~~\*/~~ |
  | 358 |  | ~~public static function get\_providers\_translate\_names(): array {~~ |
  | 359 |  | ~~if ( empty( self::$all\_providers\_names\_translated ) ) {~~ |
  | 360 |  | ~~self::$all\_providers\_names\_translated = array(~~ |
  | 361 |  | ~~'totp'         => esc\_html\_\_( 'TOTP (App)', 'wp-2fa' ),~~ |
  | 362 |  | ~~'email'        => esc\_html\_\_( 'HOTP (Email)', 'wp-2fa' ),~~ |
  | 363 |  | ~~'backup\_codes' => esc\_html\_\_( 'Backup codes', 'wp-2fa' ),~~ |
  | 364 |  | ~~);~~ |
  | 365 |  |  |
  | 366 |  | ~~/\*\*~~ |
  | 367 |  | ~~\* Filter the supplied providers.~~ |
  | 368 |  | ~~\*~~ |
  | 369 |  | ~~\* This lets third-parties either remove providers (such as Email), or~~ |
  | 370 |  | ~~\* add their own providers (such as text message or Clef).~~ |
  | 371 |  | ~~\*~~ |
  | 372 |  | ~~\* @param array $provider array if available options.~~ |
  | 373 |  | ~~\*/~~ |
  | 374 |  | ~~self::$all\_providers\_names\_translated = apply\_filters( WP\_2FA\_PREFIX . 'providers\_translated\_names', self::$all\_providers\_names\_translated );~~ |
  | 375 |  | ~~}~~ |
  | 376 |  |  |
  | 377 |  | ~~return self::$all\_providers\_names\_translated;~~ |
  | 378 |  | ~~}~~ |
  | 379 |  |  |
  | 380 |  | ~~/\*\*~~ |
  | 381 |  | ~~\* Grab list of all register providers in the plugin.~~ |
  | 382 |  | ~~\*~~ |
  | 383 |  | ~~\* @return array~~ |
  | 384 |  | ~~\*/~~ |
  | 385 |  | ~~public static function get\_providers() {~~ |
  | 386 |  | ~~if ( empty( self::$all\_providers ) ) {~~ |
  | 387 |  | ~~self::$all\_providers = array(~~ |
  | 388 |  | ~~'totp',~~ |
  | 389 |  | ~~'email',~~ |
  | 390 |  | ~~'backup\_codes',~~ |
  | 391 |  | ~~);~~ |
  | 392 |  |  |
  | 393 |  | ~~/\*\*~~ |
  | 394 |  | ~~\* Filter the supplied providers.~~ |
  | 395 |  | ~~\*~~ |
  | 396 |  | ~~\* This lets third-parties either remove providers (such as Email), or~~ |
  | 397 |  | ~~\* add their own providers (such as text message or Clef).~~ |
  | 398 |  | ~~\*~~ |
  | 399 |  | ~~\* @param array $provider array if available options.~~ |
  | 400 |  | ~~\*/~~ |
  | 401 |  | ~~self::$all\_providers = apply\_filters( WP\_2FA\_PREFIX . 'providers', self::$all\_providers );~~ |
  | 402 |  | ~~}~~ |
  | 403 |  |  |
  | 404 |  | ~~return self::$all\_providers;~~ |
  | 405 |  | ~~}~~ |
  | 406 |  |  |
  | 407 |  | ~~/\*\*~~ |
  | 408 |  | ~~\* Returns the page ID stored in the given role or user, based on the multisite and page URL only.~~ |
  | 409 |  | ~~\*~~ |
  | 410 |  | ~~\* @param string       $role - The role name if any. Default fallback if not role no user is provided.~~ |
  | 411 |  | ~~\* @param \WP\_User|int $user - The user object or user id if any.~~ |
  | 412 |  | ~~\*~~ |
  | 413 |  | ~~\* @return int~~ |
  | 414 |  | ~~\*~~ |
  | 415 |  | ~~\* @since 2.5.0~~ |
  | 416 |  | ~~\*/~~ |
  | 417 |  | ~~public static function get\_custom\_settings\_page\_id( $role = '', $user = '' ) {~~ |
  | 418 |  | ~~if ( ! empty( $role ) ) {~~ |
  | 419 |  | ~~$page\_slug = self::get\_role\_or\_default\_setting( 'custom-user-page-url', '', $role );~~ |
  | 420 |  | ~~} elseif ( ! empty( $user ) ) {~~ |
  | 421 |  | ~~$page\_slug = self::get\_role\_or\_default\_setting( 'custom-user-page-url', $user );~~ |
  | 422 |  | ~~} else {~~ |
  | 423 |  | ~~$page\_slug = self::get\_role\_or\_default\_setting( 'custom-user-page-url', '', '' );~~ |
  | 424 |  | ~~}~~ |
  | 425 |  |  |
  | 426 |  | ~~if ( ! empty( $role ) ) {~~ |
  | 427 |  | ~~$separate\_page = self::get\_role\_or\_default\_setting( 'separate-multisite-page-url', '', $role );~~ |
  | 428 |  | ~~} elseif ( ! empty( $user ) ) {~~ |
  | 429 |  | ~~$separate\_page = self::get\_role\_or\_default\_setting( 'separate-multisite-page-url', $user );~~ |
  | 430 |  | ~~} else {~~ |
  | 431 |  | ~~$separate\_page = self::get\_role\_or\_default\_setting( 'separate-multisite-page-url', '', '' );~~ |
  | 432 |  | ~~}~~ |
  | 433 |  |  |
  | 434 |  | ~~$new\_page\_id = '';~~ |
  | 435 |  |  |
  | 436 |  | ~~// Lets check for multisite first and if that is the case - lets search for that page on the user's default blog.~~ |
  | 437 |  | ~~if ( WP\_Helper::is\_multisite() && false !== $separate\_page ) {~~ |
  | 438 |  | ~~if ( ! empty( $user ) ) {~~ |
  | 439 |  | ~~$blog\_id = User\_Helper::get\_user\_default\_blog( $user );~~ |
  | 440 | 298 | } else { |
  | 441 |  | $blog\_id = \get\_current\_blog\_id(); |
  | 442 |  | } |
  | 443 |  |  |
  | 444 |  | if ( 0 === $blog\_id ) { |
  | 445 |  | $new\_page\_id = ''; |
  |  | 299 | throw new \Exception( 'Role provided does not exists - "' . $role . '"' ); // phpcs:ignore WordPress.Security.EscapeOutput.ExceptionNotEscaped |
  |  | 300 | } |
  |  | 301 | } |
  |  | 302 |  |
  |  | 303 | /\*\* |
  |  | 304 | \* Checks if given provider is enabled for the given role. |
  |  | 305 | \* |
  |  | 306 | \* @param string $role - The name of the role. |
  |  | 307 | \* @param string $provider - The name of the provider. |
  |  | 308 | \* |
  |  | 309 | \* @return boolean |
  |  | 310 | \* |
  |  | 311 | \* @throws \Exception - If the provider is not registered in the plugin. |
  |  | 312 | \* |
  |  | 313 | \* @since 2.2.0 |
  |  | 314 | \*/ |
  |  | 315 | public static function is\_provider\_enabled\_for\_role( string $role, string $provider ): bool { |
  |  | 316 | self::get\_providers(); |
  |  | 317 |  |
  |  | 318 | if ( in\_array( $provider, self::$all\_providers, true ) ) { |
  |  | 319 | self::get\_enabled\_providers\_for\_role( $role ); |
  |  | 320 | if ( isset( self::$all\_providers\_for\_roles[ $role ][ $provider ] ) ) { |
  |  | 321 | return true; |
  |  | 322 | } |
  |  | 323 |  |
  |  | 324 | return false; |
  |  | 325 | } |
  |  | 326 |  |
  |  | 327 | throw new \Exception( 'Non existing provider ' . $provider ); // phpcs:ignore WordPress.Security.EscapeOutput.ExceptionNotEscaped |
  |  | 328 | } |
  |  | 329 |  |
  |  | 330 | /\*\* |
  |  | 331 | \* Returns all providers by roles. |
  |  | 332 | \* If given role does not have specified settings set - falls back to the default settings. |
  |  | 333 | \* |
  |  | 334 | \* @return array |
  |  | 335 | \* |
  |  | 336 | \* @since 2.2.0 |
  |  | 337 | \*/ |
  |  | 338 | public static function get\_all\_roles\_providers() { |
  |  | 339 | if ( empty( self::$all\_providers\_for\_roles ) ) { |
  |  | 340 | $roles     = WP\_Helper::get\_roles(); |
  |  | 341 | $providers = self::get\_providers(); |
  |  | 342 |  |
  |  | 343 | foreach ( $roles as $role ) { |
  |  | 344 | self::$all\_providers\_for\_roles[ $role ] = array(); |
  |  | 345 | foreach ( $providers as $provider ) { |
  |  | 346 | if ( Backup\_Codes::METHOD\_NAME === $provider ) { |
  |  | 347 | self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( $provider . '\_enabled', false, false, $role ); |
  |  | 348 | } elseif ( 'backup\_email' === $provider ) { |
  |  | 349 | self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable-email-backup', false, false, $role ); |
  |  | 350 | } elseif ( class\_exists( '\WP2FA\Extensions\OutOfBand\Out\_Of\_Band', false ) && Out\_Of\_Band::METHOD\_NAME === $provider ) { |
  |  | 351 | self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable\_' . $provider . '\_email', false, false, $role ); |
  |  | 352 | } else { |
  |  | 353 | self::$all\_providers\_for\_roles[ $role ][ $provider ] = WP2FA::get\_wp2fa\_setting( 'enable\_' . $provider, false, false, $role ); |
  |  | 354 | } |
  |  | 355 | } |
  |  | 356 | self::$all\_providers\_for\_roles[ $role ] = array\_filter( self::$all\_providers\_for\_roles[ $role ] ); |
  |  | 357 | } |
  |  | 358 | } |
  |  | 359 |  |
  |  | 360 | return self::$all\_providers\_for\_roles; |
  |  | 361 | } |
  |  | 362 |  |
  |  | 363 | /\*\* |
  |  | 364 | \* Returns an array with all providers and their translated name. Key is the method slug and value is the translated method name. |
  |  | 365 | \* |
  |  | 366 | \* @return array |
  |  | 367 | \* |
  |  | 368 | \* @since 2.5.0 |
  |  | 369 | \*/ |
  |  | 370 | public static function get\_providers\_translate\_names(): array { |
  |  | 371 | if ( empty( self::$all\_providers\_names\_translated ) ) { |
  |  | 372 | /\*\* |
  |  | 373 | \* Filter the supplied providers. |
  |  | 374 | \* |
  |  | 375 | \* This lets third-parties either remove providers (such as Email), or |
  |  | 376 | \* add their own providers (such as text message or Clef). |
  |  | 377 | \* |
  |  | 378 | \* @param array $provider array if available options. |
  |  | 379 | \*/ |
  |  | 380 | self::$all\_providers\_names\_translated = apply\_filters( WP\_2FA\_PREFIX . 'providers\_translated\_names', self::$all\_providers\_names\_translated ); |
  |  | 381 | } |
  |  | 382 |  |
  |  | 383 | return self::$all\_providers\_names\_translated; |
  |  | 384 | } |
  |  | 385 |  |
  |  | 386 | /\*\* |
  |  | 387 | \* Grab list of all register providers in the plugin. |
  |  | 388 | \* |
  |  | 389 | \* @return array |
  |  | 390 | \*/ |
  |  | 391 | public static function get\_providers() { |
  |  | 392 | if ( empty( self::$all\_providers ) ) { |
  |  | 393 | /\*\* |
  |  | 394 | \* Filter the supplied providers. |
  |  | 395 | \* |
  |  | 396 | \* This lets third-parties either remove providers (such as Email), or |
  |  | 397 | \* add their own providers (such as text message or Clef). |
  |  | 398 | \* |
  |  | 399 | \* @param array $provider array if available options. |
  |  | 400 | \*/ |
  |  | 401 | self::$all\_providers = apply\_filters( WP\_2FA\_PREFIX . 'providers', self::$all\_providers ); |
  |  | 402 | } |
  |  | 403 |  |
  |  | 404 | return self::$all\_providers; |
  |  | 405 | } |
  |  | 406 |  |
  |  | 407 | /\*\* |
  |  | 408 | \* Returns the page ID stored in the given role or user, based on the multisite and page URL only. |
  |  | 409 | \* |
  |  | 410 | \* @param string       $role - The role name if any. Default fallback if not role no user is provided. |
  |  | 411 | \* @param \WP\_User|int $user - The user object or user id if any. |
  |  | 412 | \* |
  |  | 413 | \* @return int |
  |  | 414 | \* |
  |  | 415 | \* @since 2.5.0 |
  |  | 416 | \*/ |
  |  | 417 | public static function get\_custom\_settings\_page\_id( $role = '', $user = '' ) { |
  |  | 418 | if ( ! empty( $role ) ) { |
  |  | 419 | $page\_slug = self::get\_role\_or\_default\_setting( 'custom-user-page-url', '', $role ); |
  |  | 420 | } elseif ( ! empty( $user ) ) { |
  |  | 421 | $page\_slug = self::get\_role\_or\_default\_setting( 'custom-user-page-url', $user ); |
  | 446 | 422 | } else { |
  | 447 |  | // Switch to the blog context. |
  | 448 |  | \switch\_to\_blog( $blog\_id ); |
  | 449 |  |  |
  |  | 423 | $page\_slug = self::get\_role\_or\_default\_setting( 'custom-user-page-url', '', '' ); |
  |  | 424 | } |
  |  | 425 |  |
  |  | 426 | if ( ! empty( $role ) ) { |
  |  | 427 | $separate\_page = self::get\_role\_or\_default\_setting( 'separate-multisite-page-url', '', $role ); |
  |  | 428 | } elseif ( ! empty( $user ) ) { |
  |  | 429 | $separate\_page = self::get\_role\_or\_default\_setting( 'separate-multisite-page-url', $user ); |
  |  | 430 | } else { |
  |  | 431 | $separate\_page = self::get\_role\_or\_default\_setting( 'separate-multisite-page-url', '', '' ); |
  |  | 432 | } |
  |  | 433 |  |
  |  | 434 | $new\_page\_id = ''; |
  |  | 435 |  |
  |  | 436 | // Lets check for multisite first and if that is the case - lets search for that page on the user's default blog. |
  |  | 437 | if ( WP\_Helper::is\_multisite() && false !== $separate\_page ) { |
  |  | 438 | if ( ! empty( $user ) ) { |
  |  | 439 | $blog\_id = User\_Helper::get\_user\_default\_blog( $user ); |
  |  | 440 | } else { |
  |  | 441 | $blog\_id = \get\_current\_blog\_id(); |
  |  | 442 | } |
  |  | 443 |  |
  |  | 444 | if ( 0 === $blog\_id ) { |
  |  | 445 | $new\_page\_id = ''; |
  |  | 446 | } else { |
  |  | 447 | // Switch to the blog context. |
  |  | 448 | \switch\_to\_blog( $blog\_id ); |
  |  | 449 |  |
  |  | 450 | $page\_exists = Settings\_Page\_Policies::get\_post\_by\_post\_name( $page\_slug, 'page' ); |
  |  | 451 | // Restore global context. |
  |  | 452 | \restore\_current\_blog(); |
  |  | 453 |  |
  |  | 454 | if ( false !== $page\_exists ) { |
  |  | 455 | $new\_page\_id = $page\_exists->ID; |
  |  | 456 | } |
  |  | 457 | } |
  |  | 458 | } else { |
  | 450 | 459 | $page\_exists = Settings\_Page\_Policies::get\_post\_by\_post\_name( $page\_slug, 'page' ); |
  | 451 |  | ~~// Restore global context.~~ |
  | 452 |  | ~~\restore\_current\_blog();~~ |
  | 453 |  |  |
  | 454 | 460 | if ( false !== $page\_exists ) { |
  | 455 | 461 | $new\_page\_id = $page\_exists->ID; |
  | 456 | 462 | } |
  | 457 | 463 | } |
  | 458 |  | } else { |
  | 459 |  | $page\_exists = Settings\_Page\_Policies::get\_post\_by\_post\_name( $page\_slug, 'page' ); |
  | 460 |  | if ( false !== $page\_exists ) { |
  | 461 |  | $new\_page\_id = $page\_exists->ID; |
  | 462 |  | } |
  | 463 |  | } |
  | 464 |  |  |
  | 465 |  | return $new\_page\_id; |
  |  | 464 |  |
  |  | 465 | return $new\_page\_id; |
  |  | 466 | } |
  | 466 | 467 | } |
  | 467 | 468 | } |
* ## [wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L1 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L1 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 | /\*\* |
  | 3 |  | \* Responsible for the ~~User's~~ operations |
  |  | 3 | \* Responsible for the File writing operations |
  | 4 | 4 | \* |
  | 5 | 5 | \* @package    wp2fa |
  | 6 | 6 | \* @subpackage helpers |
  | 7 |  | \* @since      ~~latest~~ |
  |  | 7 | \* @since      2.4.0 |
  | 8 | 8 | \* @copyright  %%YEAR%% Melapress |
  | 9 | 9 | \* @license    https://www.apache.org/licenses/LICENSE-2.0 Apache License 2.0 |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L16) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L16) |  |
  | 16 | 16 |  |
  | 17 | 17 | /\*\* |
  | 18 |  | \* ~~User's~~ settings class |
  |  | 18 | \* File writer settings class |
  | 19 | 19 | \*/ |
  | 20 | 20 | if ( ! class\_exists( '\WP2FA\Admin\Helpers\File\_Writer' ) ) { |
  | 21 | 21 |  |
  | 22 | 22 | /\*\* |
  | 23 |  | \* All the ~~user related setting~~s must go trough this class. |
  |  | 23 | \* All the file operations must go trough this class. |
  | 24 | 24 | \* |
  | 25 | 25 | \* @since 2.4.0 |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L29) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L29) |  |
  | 29 | 29 | public const SECRET\_NAME = 'WP2FA\_ENCRYPT\_KEY'; |
  | 30 | 30 |  |
  |  | 31 | public const WP2FA\_UPLOADS\_DIR = 'wp-2fa-data'; |
  |  | 32 |  |
  | 31 | 33 | /\*\* |
  | 32 | 34 | \* Saves a secret key in `wp-config.php`. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L52) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L54) |  |
  | 52 | 54 | set\_error\_handler( |
  | 53 | 55 | function ( $err\_severity, $err\_msg, $err\_file, $err\_line, array $err\_context ) { |
  | 54 |  | throw new \Error( $err\_msg, 0, $err\_severity, $err\_file, $err\_line ); |
  |  | 56 | throw new \Error( $err\_msg, 0, $err\_severity, $err\_file, $err\_line ); // phpcs:ignore WordPress.Security.EscapeOutput.ExceptionNotEscaped |
  | 55 | 57 | }, |
  | 56 | 58 | E\_WARNING |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L264) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L266) |  |
  | 264 | 266 | \*/ |
  | 265 | 267 | public static function add\_file\_listing\_protection( string $dir ) { |
  | 266 |  | $dir = rtrim( $dir, ~~'/'~~ ); |
  |  | 268 | $dir = rtrim( $dir, \DIRECTORY\_SEPARATOR ); |
  | 267 | 269 |  |
  | 268 | 270 | if ( ! is\_dir( $dir ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L270) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L272) |  |
  | 270 | 272 | } |
  | 271 | 273 |  |
  | 272 |  | if ( self::exists( ~~"$dir/index.php"~~ ) ) { |
  |  | 274 | if ( self::exists( $dir . \DIRECTORY\_SEPARATOR . 'index.php' ) ) { |
  | 273 | 275 | return true; |
  | 274 | 276 | } |
  | 275 | 277 |  |
  | 276 |  | return self::write( "$dir/index.php", "<?php\n// Silence is golden." ); |
  |  | 278 | return self::write( $dir . \DIRECTORY\_SEPARATOR . '.htaccess', 'Deny from all' ) && |
  |  | 279 | self::write( $dir . \DIRECTORY\_SEPARATOR . 'index.php', "<?php\n// Silence is golden." ); |
  | 277 | 280 | } |
  | 278 | 281 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=2940688#L376) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-file-writer.php?rev=3009922#L379) |  |
  | 376 | 379 |  |
  | 377 | 380 | return false; |
  |  | 381 | } |
  |  | 382 |  |
  |  | 383 | /\*\* |
  |  | 384 | \* Retrieves the full path to plugin's working directory. Returns a folder path with a trailing slash. It also |
  |  | 385 | \* creates the folder unless the $skip\_creation parameter is set to true. |
  |  | 386 | \* |
  |  | 387 | \* Default path is "{uploads folder}/self::WP2FA\_UPLOADS\_DIR/" |
  |  | 388 | \* |
  |  | 389 | \* @param string $path          Optional path relative to the working directory. |
  |  | 390 | \* @param bool   $skip\_creation If true, the folder will not be created. |
  |  | 391 | \* @param bool   $ignore\_site   If true, there will be no sub-site specific subfolder in multisite context. |
  |  | 392 | \* |
  |  | 393 | \* @return string|\WP\_Error |
  |  | 394 | \* |
  |  | 395 | \* @since 2.6.0 |
  |  | 396 | \*/ |
  |  | 397 | public static function get\_upload\_path( $path = '', $skip\_creation = false, $ignore\_site = false ) { |
  |  | 398 | $result = ''; |
  |  | 399 |  |
  |  | 400 | $upload\_dir = wp\_upload\_dir( null, false ); |
  |  | 401 | if ( is\_array( $upload\_dir ) && array\_key\_exists( 'basedir', $upload\_dir ) ) { |
  |  | 402 | $result = $upload\_dir['basedir'] . \DIRECTORY\_SEPARATOR . self::WP2FA\_UPLOADS\_DIR . \DIRECTORY\_SEPARATOR; |
  |  | 403 | } elseif ( defined( 'WP\_CONTENT\_DIR' ) ) { |
  |  | 404 | // Fallback in case there is a problem with filesystem. |
  |  | 405 | $result = WP\_CONTENT\_DIR . \DIRECTORY\_SEPARATOR . 'uploads' . \DIRECTORY\_SEPARATOR . self::WP2FA\_UPLOADS\_DIR . \DIRECTORY\_SEPARATOR; |
  |  | 406 | } |
  |  | 407 |  |
  |  | 408 | if ( empty( $result ) ) { |
  |  | 409 | // Empty result here means invalid custom path or a problem with WordPress (uploads folder issue or mission WP\_CONTENT\_DIR). |
  |  | 410 | return new \WP\_Error( '2fa\_uplaods\_dir\_missing', \_\_( 'The base of WSAL working directory cannot be determined. Custom path is invalid or there is some other issue with your WordPress installation.', 'wp-2fa' ) ); |
  |  | 411 | } |
  |  | 412 |  |
  |  | 413 | // Append site specific subfolder in multisite context. |
  |  | 414 | if ( ! $ignore\_site && WP\_Helper::is\_multisite() ) { |
  |  | 415 | $site\_id = \get\_current\_blog\_id(); |
  |  | 416 | if ( $site\_id > 0 ) { |
  |  | 417 | $result .= 'sites' . \DIRECTORY\_SEPARATOR . $site\_id . \DIRECTORY\_SEPARATOR; |
  |  | 418 | } |
  |  | 419 | } |
  |  | 420 |  |
  |  | 421 | // Append optional path passed as a parameter. |
  |  | 422 | if ( $path && is\_string( $path ) ) { |
  |  | 423 | $result .= $path . \DIRECTORY\_SEPARATOR; |
  |  | 424 | } |
  |  | 425 |  |
  |  | 426 | if ( ! file\_exists( $result ) ) { |
  |  | 427 | if ( ! $skip\_creation ) { |
  |  | 428 | if ( ! \wp\_mkdir\_p( $result ) ) { |
  |  | 429 | return new \WP\_Error( |
  |  | 430 | 'mkdir\_failed', |
  |  | 431 | sprintf( |
  |  | 432 | /\* translators: %s: Directory path. \*/ |
  |  | 433 | \_\_( 'Unable to create directory %s. Is its parent directory writable by the server?', 'wp-2fa' ), |
  |  | 434 | esc\_html( $result ) |
  |  | 435 | ) |
  |  | 436 | ); |
  |  | 437 | } |
  |  | 438 | } |
  |  | 439 |  |
  |  | 440 | self::add\_file\_listing\_protection( $result ); |
  |  | 441 | } |
  |  | 442 |  |
  |  | 443 | return $result; |
  |  | 444 | } |
  |  | 445 |  |
  |  | 446 | /\*\* |
  |  | 447 | \* Remove the supplied file. |
  |  | 448 | \* |
  |  | 449 | \* @param string $file - The name of the file and path. |
  |  | 450 | \* |
  |  | 451 | \* @return bool|WP\_Error Boolean true on success or a WP\_Error object if an error occurs. |
  |  | 452 | \* |
  |  | 453 | \* @since 2.6.0 |
  |  | 454 | \*/ |
  |  | 455 | public static function remove( $file ) { |
  |  | 456 | if ( ! self::exists( $file ) ) { |
  |  | 457 | return true; |
  |  | 458 | } |
  |  | 459 |  |
  |  | 460 | if ( ! PHP\_Helper::is\_callable( 'unlink' ) ) { |
  |  | 461 | return new \WP\_Error( |
  |  | 462 | 'wp-2fa', |
  |  | 463 | // translators: the name of the file. |
  |  | 464 | sprintf( \_\_( 'The file %s could not be removed as the unlink() function is disabled. This is a system configuration issue.', 'wp-2fa' ), $file ) |
  |  | 465 | ); |
  |  | 466 | } |
  |  | 467 |  |
  |  | 468 | $result = @unlink( $file ); // phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged, WordPress.WP.AlternativeFunctions.unlink\_unlink |
  |  | 469 |  |
  |  | 470 | @clearstatcache( true, $file ); // phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged |
  |  | 471 |  |
  |  | 472 | if ( $result ) { |
  |  | 473 | return true; |
  |  | 474 | } |
  |  | 475 |  |
  |  | 476 | return new \WP\_Error( |
  |  | 477 | 'wp-2fa', |
  |  | 478 | sprintf( |
  |  | 479 | // translators: the name of the file. |
  |  | 480 | \_\_( 'Unable to remove %s due to an unknown error.', 'wp-2fa' ), |
  |  | 481 | $file |
  |  | 482 | ) |
  |  | 483 | ); |
  | 378 | 484 | } |
  | 379 | 485 |  |
* ## [wp-2fa/trunk/includes/classes/Admin/Helpers/class-php-helper.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Helpers/class-php-helper.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Helpers/class-php-helper.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-php-helper.php?rev=2940688#L5 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-php-helper.php?rev=3009922#L5 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* @package    wp2fa |
  | 6 | 6 | \* @subpackage helpers |
  | 7 |  | \* @since      ~~latest~~ |
  |  | 7 | \* @since      2.4.0 |
  | 8 | 8 | \* @copyright  %%YEAR%% Melapress |
  | 9 | 9 | \* @license    https://www.apache.org/licenses/LICENSE-2.0 Apache License 2.0 |
* ## [wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L24 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L24 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | use WP2FA\Admin\Settings\_Page; |
  | 25 | 25 | use WP2FA\Utils\Settings\_Utils; |
  | 26 |  | ~~use WP2FA\Authenticator\Open\_SSL;~~ |
  | 27 | 26 | use WP2FA\Freemius\User\_Licensing; |
  | 28 | 27 | use WP2FA\Admin\Controllers\Methods; |
  | 29 | 28 | use WP2FA\Admin\Controllers\Settings; |
  | 30 |  | use ~~WP2FA\Authenticator\Authentication~~; |
  |  | 29 | use wpdb; |
  | 31 | 30 |  |
  | 32 | 31 | /\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L41) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L40) |  |
  | 41 | 40 | class User\_Helper { |
  | 42 | 41 | /\*\* |
  | 43 |  | ~~\* Secret TOTP key meta name.~~ |
  | 44 |  | ~~\*/~~ |
  | 45 |  | ~~public const SECRET\_META\_KEY = WP\_2FA\_PREFIX . 'totp\_key';~~ |
  | 46 |  | ~~/\*\*~~ |
  | 47 | 42 | \* Enabled 2fa method for user meta name. |
  | 48 | 43 | \*/ |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L97) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L92) |  |
  | 97 | 92 | \*/ |
  | 98 | 93 | public const USER\_RESET\_PASSWORD\_VALID = 'reset\_password\_valid'; |
  |  | 94 | /\*\* |
  |  | 95 | \* The nominated global email address for the user. |
  |  | 96 | \*/ |
  |  | 97 | public const USER\_NOMINATED\_EMAIL = WP\_2FA\_PREFIX . 'nominated\_email\_address'; |
  |  | 98 | /\*\* |
  |  | 99 | \* The backup email address for the user - for backup methods when app is in use. |
  |  | 100 | \*/ |
  |  | 101 | public const USER\_BACKUP\_EMAIL = WP\_2FA\_PREFIX . 'backup\_email\_address'; |
  | 99 | 102 | /\*\* |
  | 100 | 103 | \* The default user statuses. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L170) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L173) |  |
  | 170 | 173 |  |
  | 171 | 174 | /\*\* |
  | 172 |  | ~~\* Totp key assigned to user~~ |
  | 173 |  | ~~\*~~ |
  | 174 |  | ~~\* @var string~~ |
  | 175 |  | ~~\*/~~ |
  | 176 |  | ~~private static $totp\_key = '';~~ |
  | 177 |  |  |
  | 178 |  | ~~/\*\*~~ |
  | 179 | 175 | \* Marks the status of the updating process |
  | 180 | 176 | \* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L186) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L182) |  |
  | 186 | 182 |  |
  | 187 | 183 | /\*\* |
  | 188 |  | \* Returns the enable~~d 2FA method for the user.~~ |
  | 189 |  | \* |
  | 190 |  | \* @param ~~int|\WP\_User|null $user - The WP user we should extract the meta data for~~. |
  | 191 |  | \* |
  | 192 |  | \* @return mixed |
  | 193 |  | \* |
  | 194 |  | \* @since 2.~~2~~.0 |
  | 195 |  | \*/ |
  | 196 |  | public static function get\_enabled\_~~method~~\_for\_user( $user = null ) { |
  |  | 184 | \* Returns the enable 2fa backup methods for the given user |
  |  | 185 | \* |
  |  | 186 | \* @param \WP\_User] $user - The user which has to be checked. |
  |  | 187 | \* |
  |  | 188 | \* @return mixed |
  |  | 189 | \* |
  |  | 190 | \* @since 2.6.0 |
  |  | 191 | \*/ |
  |  | 192 | public static function get\_enabled\_backup\_methods\_for\_user( $user = null ) { |
  | 197 | 193 | self::set\_proper\_user( $user ); |
  | 198 | 194 |  |
  | 199 | 195 | /\* |
  | 200 |  | \* Checks the enabled methods fo the user. |
  |  | 196 | \* Checks the enabled methods for the user. |
  | 201 | 197 | \* |
  | 202 | 198 | \* @param mixed - Value of the method. |
  |  | 199 | \* @param array - Array of enabled methods for the user. |
  |  | 200 | \* @param \WP\_User - The user which must be checked. |
  |  | 201 | \* |
  |  | 202 | \* @since 2.6.0 |
  |  | 203 | \*/ |
  |  | 204 | return apply\_filters( WP\_2FA\_PREFIX . 'user\_enabled\_backup\_methods', array(), $user ); |
  |  | 205 | } |
  |  | 206 |  |
  |  | 207 | /\*\* |
  |  | 208 | \* Returns the enabled 2FA method for the user. |
  |  | 209 | \* |
  |  | 210 | \* @param int|\WP\_User|null $user - The WP user we should extract the meta data for. |
  |  | 211 | \* |
  |  | 212 | \* @return mixed |
  |  | 213 | \* |
  |  | 214 | \* @since 2.2.0 |
  |  | 215 | \*/ |
  |  | 216 | public static function get\_enabled\_method\_for\_user( $user = null ) { |
  |  | 217 | self::set\_proper\_user( $user ); |
  |  | 218 |  |
  |  | 219 | /\* |
  |  | 220 | \* Checks the enabled methods for the user. |
  |  | 221 | \* |
  |  | 222 | \* @param mixed - Value of the method. |
  |  | 223 | \* @param string|null $user - Currently enabled method. |
  | 203 | 224 | \* @param \WP\_User - The user which must be checked. |
  | 204 | 225 | \* |
  | 205 | 226 | \* @since 2.0.0 |
  | 206 | 227 | \*/ |
  | 207 |  | return apply\_filters( WP\_2FA\_PREFIX . 'user\_enabled\_methods', self::get\_meta( self::ENABLED\_METHODS\_META\_KEY ) ); |
  |  | 228 | return apply\_filters( WP\_2FA\_PREFIX . 'user\_enabled\_methods', self::get\_meta( self::ENABLED\_METHODS\_META\_KEY ), $user ); |
  | 208 | 229 | } |
  | 209 | 230 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L220) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L241) |  |
  | 220 | 241 | public static function set\_enabled\_method\_for\_user( string $method, $user = null ) { |
  | 221 | 242 | self::set\_proper\_user( $user ); |
  |  | 243 |  |
  |  | 244 | /\* |
  |  | 245 | \* Fires before the user method is set. |
  |  | 246 | \* |
  |  | 247 | \* @param string - Current user method. |
  |  | 248 | \* @param \WP\_User $user - The user for which the method has been set. |
  |  | 249 | \* |
  |  | 250 | \* @since 2.6.0 |
  |  | 251 | \*/ |
  |  | 252 | \do\_action( WP\_2FA\_PREFIX . 'before\_method\_been\_set', self::get\_enabled\_method\_for\_user( self::get\_user() ), self::get\_user() ); |
  | 222 | 253 |  |
  | 223 | 254 | $set\_method = self::set\_meta( self::ENABLED\_METHODS\_META\_KEY, $method ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L248) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L279) |  |
  | 248 | 279 | self::set\_proper\_user( $user ); |
  | 249 | 280 |  |
  |  | 281 | /\* |
  |  | 282 | \* Fires before the user method is removed. |
  |  | 283 | \* |
  |  | 284 | \* @param string - Current user method. |
  |  | 285 | \* @param \WP\_User $user - The user for which the method has been set. |
  |  | 286 | \* |
  |  | 287 | \* @since 2.6.0 |
  |  | 288 | \*/ |
  |  | 289 | \do\_action( WP\_2FA\_PREFIX . 'before\_method\_is\_removed', self::get\_enabled\_method\_for\_user( self::get\_user() ), self::get\_user() ); |
  |  | 290 |  |
  | 250 | 291 | self::remove\_meta( self::ENABLED\_METHODS\_META\_KEY, self::$user ); |
  |  | 292 |  |
  |  | 293 | /\* |
  |  | 294 | \* Fires after the user method is removed. |
  |  | 295 | \* |
  |  | 296 | \* @param \WP\_User $user - The user for which the method has been set. |
  |  | 297 | \* |
  |  | 298 | \* @since 2.6.0 |
  |  | 299 | \*/ |
  |  | 300 | \do\_action( WP\_2FA\_PREFIX . 'after\_method\_is\_removed', self::get\_user() ); |
  | 251 | 301 |  |
  | 252 | 302 | if ( class\_exists( '\WP2FA\Freemius\User\_Licensing' ) ) { |
  | 253 | 303 | $user\_blog\_id = 1; |
  | 254 | 304 | if ( WP\_Helper::is\_multisite() ) { |
  | 255 |  | $user\_blog\_id = \get\_active\_blog\_for\_user( self::$user->ID ); |
  |  | 305 | $user\_blog\_id = \get\_active\_blog\_for\_user( self::$user->ID )->blog\_id; |
  | 256 | 306 | } |
  | 257 | 307 | if ( ( $current\_blog = \get\_current\_blog\_id() ) !== $user\_blog\_id ) { // phpcs:ignore |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L463) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L513) |  |
  | 463 | 513 | self::set\_proper\_user( $user ); |
  | 464 | 514 |  |
  | 465 |  | $status = self::get\_meta( self::USER\_2FA\_STATUS ); |
  |  | 515 | $status = (string) self::get\_meta( self::USER\_2FA\_STATUS ); |
  | 466 | 516 |  |
  | 467 | 517 | if ( '' === trim( $status ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L798) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L848) |  |
  | 798 | 848 | self::$user = \wp\_get\_current\_user(); |
  | 799 | 849 | } |
  | 800 |  | } elseif ( is\_string( $user ) && ! empty( trim( $user ) ) ) { |
  |  | 850 | } elseif ( is\_string( $user ) && ! empty( trim( (string) $user ) ) ) { |
  | 801 | 851 | if ( isset( self::$user ) && $user instanceof \WP\_User && $user === self::$user->ID ) { |
  | 802 | 852 | return; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L899) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L949) |  |
  | 899 | 949 |  |
  | 900 | 950 | if ( $blog\_id instanceof \WP\_Site ) { |
  | 901 |  | return ~~$blog\_id->~~id; |
  |  | 951 | return (int) $blog\_id->blog\_id; |
  | 902 | 952 | } else { |
  | 903 | 953 | return 1; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L926) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L976) |  |
  | 926 | 976 |  |
  | 927 | 977 | return $is\_method\_available; |
  | 928 |  | ~~}~~ |
  | 929 |  |  |
  | 930 |  | ~~/\*\*~~ |
  | 931 |  | ~~\* Deletes the TOTP secret key for a user.~~ |
  | 932 |  | ~~\*~~ |
  | 933 |  | ~~\* @param int|\WP\_User|null $user - The WP user that must be used.~~ |
  | 934 |  | ~~\*~~ |
  | 935 |  | ~~\* @return void~~ |
  | 936 |  | ~~\*/~~ |
  | 937 |  | ~~public static function remove\_user\_totp\_key( $user = null ) {~~ |
  | 938 |  | ~~self::set\_proper\_user( $user );~~ |
  | 939 |  |  |
  | 940 |  | ~~self::remove\_meta( self::SECRET\_META\_KEY, self::$user );~~ |
  | 941 |  |  |
  | 942 |  | ~~self::$totp\_key = '';~~ |
  | 943 |  | ~~}~~ |
  | 944 |  |  |
  | 945 |  | ~~/\*\*~~ |
  | 946 |  | ~~\* Returns the TOTP secret key for a user.~~ |
  | 947 |  | ~~\*~~ |
  | 948 |  | ~~\* @param int|\WP\_User|null $user - The WP user that must be used.~~ |
  | 949 |  | ~~\*~~ |
  | 950 |  | ~~\* @return string~~ |
  | 951 |  | ~~\*/~~ |
  | 952 |  | ~~public static function get\_user\_totp\_key( $user = null ) {~~ |
  | 953 |  | ~~self::set\_proper\_user( $user );~~ |
  | 954 |  |  |
  | 955 |  | ~~return self::get\_meta( self::SECRET\_META\_KEY, self::$user );~~ |
  | 956 |  | ~~}~~ |
  | 957 |  |  |
  | 958 |  | ~~/\*\*~~ |
  | 959 |  | ~~\* Updates the TOTP secret key for a user.~~ |
  | 960 |  | ~~\*~~ |
  | 961 |  | ~~\* @param string            $value - The value of the TOTP key.~~ |
  | 962 |  | ~~\* @param int|\WP\_User|null $user  - The WP user that must be used.~~ |
  | 963 |  | ~~\*~~ |
  | 964 |  | ~~\* @return void~~ |
  | 965 |  | ~~\*~~ |
  | 966 |  | ~~\* @since 2.2.0~~ |
  | 967 |  | ~~\*/~~ |
  | 968 |  | ~~public static function set\_user\_totp\_key( string $value, $user = null ) {~~ |
  | 969 |  | ~~self::set\_proper\_user( $user );~~ |
  | 970 |  |  |
  | 971 |  | ~~self::set\_meta( self::SECRET\_META\_KEY, $value, self::$user );~~ |
  | 972 | 978 | } |
  | 973 | 979 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L997) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1003) |  |
  | 997 | 1003 |  |
  | 998 | 1004 | if ( class\_exists( '\WP2FA\Freemius\User\_Licensing' ) ) { |
  |  | 1005 | $user\_blog\_id = 1; |
  | 999 | 1006 | if ( WP\_Helper::is\_multisite() ) { |
  | 1000 |  | $user\_blog\_id = \get\_active\_blog\_for\_user( self::$user->ID ); |
  | 1001 |  | } |
  | 1002 |  | if ( ( $current\_blog = \get\_current\_blog\_id() ) !== $user\_blog\_id~~->blog\_id ) { // phpcs:igno~~re |
  |  | 1007 | $user\_blog\_id = \get\_active\_blog\_for\_user( self::$user->ID )->blog\_id; |
  |  | 1008 | } |
  |  | 1009 | if ( ( $current\_blog = \get\_current\_blog\_id() ) !== $user\_blog\_id ) { // phpcs:ignore Generic.CodeAnalysis.AssignmentInCondition.Found, Squiz.PHP.DisallowMultipleAssignments.FoundInControlStructure |
  | 1003 | 1010 | if ( WP\_Helper::is\_multisite() ) { |
  | 1004 |  | wp2fa\_freemius()->switch\_to\_blog(~~$user\_blog\_id->blog\_id~~); |
  | 1005 |  | //\switch\_to\_blog( $user\_blog\_id->blog\_id ); |
  |  | 1011 | wp2fa\_freemius()->switch\_to\_blog( $user\_blog\_id ); |
  |  | 1012 | // \switch\_to\_blog( $user\_blog\_id->blog\_id ); |
  | 1006 | 1013 | } |
  | 1007 | 1014 | User\_Licensing::method\_has\_been\_set(); |
  | 1008 | 1015 | if ( WP\_Helper::is\_multisite() ) { |
  | 1009 |  | wp2fa\_freemius()->switch\_to\_blog(~~$current\_blog~~); |
  | 1010 |  | //\switch\_to\_blog( $current\_blog ); |
  |  | 1016 | wp2fa\_freemius()->switch\_to\_blog( $current\_blog ); |
  |  | 1017 | // \switch\_to\_blog( $current\_blog ); |
  | 1011 | 1018 | } |
  | 1012 | 1019 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L1135) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1142) |  |
  | 1135 | 1142 | $state = 'excluded'; |
  | 1136 | 1143 | self::set\_user\_state( $state, $user ); |
  |  | 1144 | self::remove\_enabled\_method\_for\_user( $user ); |
  | 1137 | 1145 | } |
  | 1138 | 1146 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L1292) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1300) |  |
  | 1292 | 1300 |  |
  | 1293 | 1301 | return Settings\_Page::send\_email( $email, $subject, $message ); |
  | 1294 |  | ~~}~~ |
  | 1295 |  |  |
  | 1296 |  | ~~/\*\*~~ |
  | 1297 |  | ~~\* User totp key getter~~ |
  | 1298 |  | ~~\*~~ |
  | 1299 |  | ~~\* @param int|\WP\_User|null $user - The WP user we should extract the meta data for.~~ |
  | 1300 |  | ~~\*~~ |
  | 1301 |  | ~~\* @return string~~ |
  | 1302 |  | ~~\*/~~ |
  | 1303 |  | ~~public static function get\_totp\_key( $user = null ): string {~~ |
  | 1304 |  | ~~self::set\_proper\_user( $user );~~ |
  | 1305 |  |  |
  | 1306 |  | ~~if ( '' === trim( self::$totp\_key ) ) {~~ |
  | 1307 |  | ~~self::$totp\_key = Authentication::get\_user\_totp\_key( self::get\_user()->ID );~~ |
  | 1308 |  | ~~if ( empty( self::$totp\_key ) ) {~~ |
  | 1309 |  | ~~self::$totp\_key = Authentication::generate\_key();~~ |
  | 1310 |  |  |
  | 1311 |  | ~~self::set\_user\_totp\_key( self::$totp\_key, self::get\_user() );~~ |
  | 1312 |  | ~~} elseif ( Open\_SSL::is\_ssl\_available() && false === \strpos( self::$totp\_key, Open\_SSL::SECRET\_KEY\_PREFIX ) ) {~~ |
  | 1313 |  | ~~self::$totp\_key = Open\_SSL::SECRET\_KEY\_PREFIX . Open\_SSL::encrypt( self::$totp\_key );~~ |
  | 1314 |  | ~~self::set\_user\_totp\_key( self::$totp\_key, self::get\_user() );~~ |
  | 1315 |  | ~~}~~ |
  | 1316 |  | ~~}~~ |
  | 1317 |  |  |
  | 1318 |  | ~~return self::$totp\_key;~~ |
  | 1319 |  | ~~}~~ |
  | 1320 |  |  |
  | 1321 |  | ~~/\*\*~~ |
  | 1322 |  | ~~\* Returns the encoded TOTP when we need to show the actual code to the user~~ |
  | 1323 |  | ~~\* If for some reason the code is invalid it recreates it~~ |
  | 1324 |  | ~~\*~~ |
  | 1325 |  | ~~\* @param int|\WP\_User|null $user - The WP user we should extract the meta data for.~~ |
  | 1326 |  | ~~\*~~ |
  | 1327 |  | ~~\* @return string~~ |
  | 1328 |  | ~~\*~~ |
  | 1329 |  | ~~\* @since 2.0.0~~ |
  | 1330 |  | ~~\*/~~ |
  | 1331 |  | ~~public static function get\_totp\_decrypted( $user = null ): string {~~ |
  | 1332 |  | ~~self::set\_proper\_user( $user );~~ |
  | 1333 |  |  |
  | 1334 |  | ~~$key = self::get\_totp\_key();~~ |
  | 1335 |  | ~~if ( Open\_SSL::is\_ssl\_available() && false !== \strpos( $key, 'ssl\_' ) ) {~~ |
  | 1336 |  |  |
  | 1337 |  | ~~/\*\*~~ |
  | 1338 |  | ~~\* Old key detected - convert.~~ |
  | 1339 |  | ~~\*/~~ |
  | 1340 |  | ~~$key = Open\_SSL::decrypt\_legacy( substr( $key, 4 ) );~~ |
  | 1341 |  |  |
  | 1342 |  | ~~self::remove\_user\_totp\_key();~~ |
  | 1343 |  | ~~self::$totp\_key = '';~~ |
  | 1344 |  |  |
  | 1345 |  | ~~$key = self::get\_totp\_key();~~ |
  | 1346 |  | ~~}~~ |
  | 1347 |  |  |
  | 1348 |  | ~~if ( Open\_SSL::is\_ssl\_available() && false !== \strpos( $key, 'wps\_' ) ) {~~ |
  | 1349 |  |  |
  | 1350 |  | ~~/\*\*~~ |
  | 1351 |  | ~~\* Old key detected - convert.~~ |
  | 1352 |  | ~~\*/~~ |
  | 1353 |  | ~~$key = Open\_SSL::decrypt\_wps( substr( $key, 4 ) );~~ |
  | 1354 |  |  |
  | 1355 |  | ~~self::remove\_user\_totp\_key();~~ |
  | 1356 |  |  |
  | 1357 |  | ~~$secret = Open\_SSL::encrypt( $key );~~ |
  | 1358 |  |  |
  | 1359 |  | ~~if ( Open\_SSL::is\_ssl\_available() ) {~~ |
  | 1360 |  | ~~$secret = Open\_SSL::SECRET\_KEY\_PREFIX . $secret;~~ |
  | 1361 |  | ~~}~~ |
  | 1362 |  |  |
  | 1363 |  | ~~self::set\_user\_totp\_key( $secret, self::get\_user()->ID );~~ |
  | 1364 |  |  |
  | 1365 |  | ~~self::$totp\_key = $secret;~~ |
  | 1366 |  | ~~}~~ |
  | 1367 |  |  |
  | 1368 |  | ~~if ( Open\_SSL::is\_ssl\_available() && false !== \strpos( $key, Open\_SSL::SECRET\_KEY\_PREFIX ) ) {~~ |
  | 1369 |  | ~~$key = Open\_SSL::decrypt( substr( $key, 4 ) );~~ |
  | 1370 |  |  |
  | 1371 |  | ~~/\*\*~~ |
  | 1372 |  | ~~\* If for some reason the key is not valid, that means that we have to clear the stored TOTP for the user, and create new on~~ |
  | 1373 |  | ~~\* That could happen if the global stored secret (plugin level) is deleted.~~ |
  | 1374 |  | ~~\*~~ |
  | 1375 |  | ~~\* Lets check and if that is the case - create new one~~ |
  | 1376 |  | ~~\*/~~ |
  | 1377 |  | ~~if ( ! Authentication::validate\_base32\_string( $key ) ) {~~ |
  | 1378 |  | ~~self::$totp\_key = '';~~ |
  | 1379 |  | ~~self::remove\_user\_totp\_key( self::get\_user() );~~ |
  | 1380 |  | ~~$key = self::get\_totp\_key();~~ |
  | 1381 |  | ~~$key = Open\_SSL::decrypt( substr( $key, 4 ) );~~ |
  | 1382 |  | ~~}~~ |
  | 1383 |  | ~~}~~ |
  | 1384 |  |  |
  | 1385 |  | ~~return $key;~~ |
  | 1386 | 1302 | } |
  | 1387 | 1303 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L1781) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1697) |  |
  | 1781 | 1697 | foreach ( $subsites as $subsite ) { |
  | 1782 | 1698 | $subsite\_id = get\_object\_vars( $subsite )['blog\_id']; |
  |  | 1699 |  |
  |  | 1700 | global $wpdb; |
  |  | 1701 |  |
  | 1783 | 1702 | if ( 1 === (int) $subsite\_id ) { |
  | 1784 |  | $users\_caps[] = get\_user\_meta( $user\_id, ~~'wp\_~~capabilities', true ); |
  |  | 1703 | $users\_caps[] = get\_user\_meta( $user\_id, $wpdb->prefix . 'capabilities', true ); |
  | 1785 | 1704 | } else { |
  | 1786 |  | $users\_caps[] = get\_user\_meta( $user\_id, 'wp\_' . $subsite\_id . '\_capabilities', true ); |
  |  | 1705 | $users\_caps[] = get\_user\_meta( $user\_id, $wpdb->prefix . $subsite\_id . '\_capabilities', true ); |
  |  | 1706 | } |
  |  | 1707 | } |
  |  | 1708 |  |
  |  | 1709 | foreach ( $users\_caps as $role\_in\_site ) { |
  |  | 1710 | if ( ! empty( $role\_in\_site ) ) { |
  |  | 1711 | foreach ( array\_keys( $role\_in\_site ) as $role ) { |
  |  | 1712 | if ( in\_array( $role, $enforced\_roles\_array, true ) ) { |
  |  | 1713 | // User is enforced somewhere. |
  |  | 1714 | return true; |
  |  | 1715 | } |
  |  | 1716 | } |
  |  | 1717 | } |
  |  | 1718 | } |
  |  | 1719 | return false; |
  |  | 1720 | } |
  |  | 1721 | } |
  |  | 1722 |  |
  |  | 1723 | if ( Settings\_Utils::string\_to\_bool( WP2FA::get\_wp2fa\_setting( 'superadmins-role-add' ) ) ) { |
  |  | 1724 | return is\_super\_admin( $user\_id ); |
  |  | 1725 | } |
  |  | 1726 | } elseif ( 'enforce-on-multisite' === $current\_policy ) { |
  |  | 1727 | $included\_sites = self::get\_included\_sites(); |
  |  | 1728 |  |
  |  | 1729 | foreach ( $included\_sites as $site\_id ) { |
  |  | 1730 | if ( is\_user\_member\_of\_blog( $user\_id, $site\_id ) ) { |
  |  | 1731 | return true; |
  |  | 1732 | } |
  |  | 1733 | } |
  |  | 1734 | } elseif ( 'all-users' === $current\_policy && ! empty( $enabled\_method ) ) { |
  |  | 1735 | return true; |
  |  | 1736 | } |
  |  | 1737 |  |
  |  | 1738 | return false; |
  |  | 1739 | } |
  |  | 1740 |  |
  |  | 1741 | /\*\* |
  |  | 1742 | \* Runs the necessary checks to figure out if the user is enforced based on current plugin settings. |
  |  | 1743 | \* |
  |  | 1744 | \* @param \WP\_User $user User to evaluate. |
  |  | 1745 | \* @param array    $roles - Array with user roles. |
  |  | 1746 | \* @param string   $user\_login - User login name. |
  |  | 1747 | \* @param int      $user\_id - The id of the user. |
  |  | 1748 | \* |
  |  | 1749 | \* @return bool True if the user is enforced based on current plugin settings. |
  |  | 1750 | \* |
  |  | 1751 | \* @since 2.0.0 |
  |  | 1752 | \* |
  |  | 1753 | \* @since 2.5.0 added params $roles, $user\_login, $user\_id . $user is with highest priority |
  |  | 1754 | \*/ |
  |  | 1755 | public static function is\_user\_enforced( $user = null, $roles = null, $user\_login = null, $user\_id = null ) { |
  |  | 1756 | if ( null !== $user ) { |
  |  | 1757 | $user\_roles = $user->roles; |
  |  | 1758 | $user\_login = $user->user\_login; |
  |  | 1759 | $user\_id    = $user->ID; |
  |  | 1760 | } else { |
  |  | 1761 | /\*\* |
  |  | 1762 | \* Setting that inner class flag because if we are here that means reports are generated, and we dont need to update users meta but just to check what is currently there. |
  |  | 1763 | \*/ |
  |  | 1764 | self::$update\_started = true; |
  |  | 1765 | $user\_roles           = $roles; |
  |  | 1766 | } |
  |  | 1767 |  |
  |  | 1768 | $current\_policy = WP2FA::get\_wp2fa\_setting( 'enforcement-policy' ); |
  |  | 1769 | $user\_eligible  = false; |
  |  | 1770 |  |
  |  | 1771 | if ( Settings\_Utils::string\_to\_bool( WP2FA::get\_wp2fa\_setting( 'superadmins-role-exclude' ) ) && is\_super\_admin( $user\_id ) ) { |
  |  | 1772 | return false; |
  |  | 1773 | } |
  |  | 1774 |  |
  |  | 1775 | // Let's check the policy settings and if the user has setup totp/email by checking for the usermeta. |
  |  | 1776 | if ( WP\_Helper::is\_multisite() && 'superadmins-only' === $current\_policy ) { |
  |  | 1777 | return is\_super\_admin( $user\_id ); |
  |  | 1778 | } elseif ( WP\_Helper::is\_multisite() && 'superadmins-siteadmins-only' === $current\_policy ) { |
  |  | 1779 | return self::is\_admin( $user\_id ); |
  |  | 1780 | } elseif ( 'all-users' === $current\_policy ) { |
  |  | 1781 |  |
  |  | 1782 | $excluded\_users = self::get\_excluded\_users(); |
  |  | 1783 | if ( ! empty( $excluded\_users ) ) { |
  |  | 1784 | // Compare our roles with the users and see if we get a match. |
  |  | 1785 | $result = in\_array( $user\_login, $excluded\_users, true ); |
  |  | 1786 | if ( $result ) { |
  |  | 1787 | return false; |
  |  | 1788 | } |
  |  | 1789 |  |
  |  | 1790 | $user\_eligible = true; |
  |  | 1791 | } |
  |  | 1792 |  |
  |  | 1793 | $excluded\_roles = self::get\_excluded\_roles(); |
  |  | 1794 | if ( ! empty( $excluded\_roles ) ) { |
  |  | 1795 |  |
  |  | 1796 | if ( ! WP\_Helper::is\_multisite() ) { |
  |  | 1797 | // Compare our roles with the users and see if we get a match. |
  |  | 1798 | $result = array\_intersect( $excluded\_roles, $user\_roles ); |
  |  | 1799 |  |
  |  | 1800 | if ( ! empty( $result ) ) { |
  |  | 1801 | return false; |
  |  | 1802 | } |
  |  | 1803 | } else { |
  |  | 1804 | $users\_caps = array(); |
  |  | 1805 | $subsites   = get\_sites(); |
  |  | 1806 | // Check each site and add to our array so we know each users actual roles. |
  |  | 1807 | foreach ( $subsites as $subsite ) { |
  |  | 1808 | $subsite\_id = get\_object\_vars( $subsite )['blog\_id']; |
  |  | 1809 | global $wpdb; |
  |  | 1810 |  |
  |  | 1811 | if ( 1 === (int) $subsite\_id ) { |
  |  | 1812 | $users\_caps[] = get\_user\_meta( $user\_id, $wpdb->base\_prefix . 'capabilities', true ); |
  |  | 1813 | } else { |
  |  | 1814 | $users\_caps[] = get\_user\_meta( $user\_id, $wpdb->base\_prefix . $subsite\_id . '\_capabilities', true ); |
  |  | 1815 | } |
  |  | 1816 | } |
  |  | 1817 |  |
  |  | 1818 | foreach ( $users\_caps as $key => $value ) { |
  |  | 1819 | if ( ! empty( $value ) ) { |
  |  | 1820 | foreach ( $value as $key => $value ) { |
  |  | 1821 | $result = in\_array( $key, $excluded\_roles, true ); |
  |  | 1822 | } |
  |  | 1823 | } |
  |  | 1824 | } |
  |  | 1825 | if ( ! empty( $result ) ) { |
  |  | 1826 | return false; |
  |  | 1827 | } |
  |  | 1828 | } |
  |  | 1829 | } |
  |  | 1830 |  |
  |  | 1831 | if ( true === $user\_eligible ) { |
  |  | 1832 | return true; |
  |  | 1833 | } |
  |  | 1834 | } elseif ( ( 'certain-roles-only' === $current\_policy || 'certain-users-only' === $current\_policy ) ) { |
  |  | 1835 | $enforced\_users = self::get\_enforced\_users(); |
  |  | 1836 | if ( ! empty( $enforced\_users ) ) { |
  |  | 1837 |  |
  |  | 1838 | // Compare our roles with the users and see if we get a match. |
  |  | 1839 | $result = in\_array( $user\_login, $enforced\_users, true ); |
  |  | 1840 | // The user is one of the chosen roles we are forcing 2FA onto, so lets show the nag. |
  |  | 1841 | if ( ! empty( $result ) ) { |
  |  | 1842 | return true; |
  |  | 1843 | } |
  |  | 1844 | } |
  |  | 1845 |  |
  |  | 1846 | $enforced\_roles = self::get\_enforced\_roles(); |
  |  | 1847 | if ( ! empty( $enforced\_roles ) ) { |
  |  | 1848 | // Turn it into an array. |
  |  | 1849 | $enforced\_roles\_array = Settings\_Page::extract\_roles\_from\_input( $enforced\_roles ); |
  |  | 1850 |  |
  |  | 1851 | if ( ! WP\_Helper::is\_multisite() ) { |
  |  | 1852 | // Compare our roles with the users and see if we get a match. |
  |  | 1853 | $result = array\_intersect( $enforced\_roles\_array, $user\_roles ); |
  |  | 1854 |  |
  |  | 1855 | // The user is one of the chosen roles we are forcing 2FA onto, so lets show the nag. |
  |  | 1856 | if ( ! empty( $result ) ) { |
  |  | 1857 | return true; |
  |  | 1858 | } |
  |  | 1859 | } else { |
  |  | 1860 | $users\_caps = array(); |
  |  | 1861 | $subsites   = get\_sites(); |
  |  | 1862 | // Check each site and add to our array so we know each users actual roles. |
  |  | 1863 | foreach ( $subsites as $subsite ) { |
  |  | 1864 | $subsite\_id = get\_object\_vars( $subsite )['blog\_id']; |
  |  | 1865 |  |
  |  | 1866 | global $wpdb; |
  |  | 1867 |  |
  |  | 1868 | if ( 1 === (int) $subsite\_id ) { |
  |  | 1869 | $users\_caps[] = get\_user\_meta( $user\_id, $wpdb->prefix . 'capabilities', true ); |
  |  | 1870 | } else { |
  |  | 1871 | $users\_caps[] = get\_user\_meta( $user\_id, $wpdb->prefix . $subsite\_id . '\_capabilities', true ); |
  | 1787 | 1872 | } |
  | 1788 | 1873 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L1804) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1889) |  |
  | 1804 | 1889 | return is\_super\_admin( $user\_id ); |
  | 1805 | 1890 | } |
  | 1806 |  | } /\* elseif ( 'certain-users-only' === $current\_policy && empty( $enabled\_method ) ) { |
  | 1807 |  | $enforced\_users = self::get\_enforced\_users(); |
  | 1808 |  | if ( ! empty( $enforced\_users ) ) { |
  | 1809 |  | // Compare our roles with the users and see if we get a match. |
  | 1810 |  | $result = in\_array( $user\_login, $enforced\_users, true ); |
  | 1811 |  | // The user is one of the chosen roles we are forcing 2FA onto, so lets show the nag. |
  | 1812 |  | if ( ! empty( $result ) ) { |
  | 1813 |  | return true; |
  | 1814 |  | } |
  | 1815 |  | } |
  | 1816 |  | } \*/ elseif ( 'enforce-on-multisite' === $current\_policy ) { |
  |  | 1891 | } elseif ( 'enforce-on-multisite' === $current\_policy ) { |
  | 1817 | 1892 | $included\_sites = self::get\_included\_sites(); |
  | 1818 | 1893 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L1822) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1897) |  |
  | 1822 | 1897 | } |
  | 1823 | 1898 | } |
  | 1824 |  | ~~} elseif ( 'all-users' === $current\_policy && ! empty( $enabled\_method ) ) {~~ |
  | 1825 |  | ~~return true;~~ |
  | 1826 |  | ~~}~~ |
  | 1827 |  |  |
  | 1828 |  | ~~return false;~~ |
  | 1829 |  | ~~}~~ |
  | 1830 |  |  |
  | 1831 |  | ~~/\*\*~~ |
  | 1832 |  | ~~\* Runs the necessary checks to figure out if the user is enforced based on current plugin settings.~~ |
  | 1833 |  | ~~\*~~ |
  | 1834 |  | ~~\* @param \WP\_User $user User to evaluate.~~ |
  | 1835 |  | ~~\* @param array    $roles - Array with user roles.~~ |
  | 1836 |  | ~~\* @param string   $user\_login - User login name.~~ |
  | 1837 |  | ~~\* @param int      $user\_id - The id of the user.~~ |
  | 1838 |  | ~~\*~~ |
  | 1839 |  | ~~\* @return bool True if the user is enforced based on current plugin settings.~~ |
  | 1840 |  | ~~\*~~ |
  | 1841 |  | ~~\* @since 2.0.0~~ |
  | 1842 |  | ~~\*~~ |
  | 1843 |  | ~~\* @since 2.5.0 added params $roles, $user\_login, $user\_id . $user is with highest priority~~ |
  | 1844 |  | ~~\*/~~ |
  | 1845 |  | ~~public static function is\_user\_enforced( $user = null, $roles = null, $user\_login = null, $user\_id = null ) {~~ |
  | 1846 |  | ~~if ( null !== $user ) {~~ |
  | 1847 |  | ~~$user\_roles = $user->roles;~~ |
  | 1848 |  | ~~$user\_login = $user->user\_login;~~ |
  | 1849 |  | ~~$user\_id    = $user->ID;~~ |
  | 1850 |  | ~~} else {~~ |
  | 1851 |  | ~~/\*\*~~ |
  | 1852 |  | ~~\* Setting that inner class flag because if we are here that means reports are generated, and we dont need to update users meta but just to check what is currently there.~~ |
  | 1853 |  | ~~\*/~~ |
  | 1854 |  | ~~self::$update\_started = true;~~ |
  | 1855 |  | ~~$user\_roles           = $roles;~~ |
  | 1856 |  | ~~}~~ |
  | 1857 |  |  |
  | 1858 |  | ~~$current\_policy = WP2FA::get\_wp2fa\_setting( 'enforcement-policy' );~~ |
  | 1859 |  | ~~$user\_eligible  = false;~~ |
  | 1860 |  |  |
  | 1861 |  | ~~if ( Settings\_Utils::string\_to\_bool( WP2FA::get\_wp2fa\_setting( 'superadmins-role-exclude' ) ) && is\_super\_admin( $user\_id ) ) {~~ |
  | 1862 |  | ~~return false;~~ |
  | 1863 |  | ~~}~~ |
  | 1864 |  |  |
  | 1865 |  | ~~// Let's check the policy settings and if the user has setup totp/email by checking for the usermeta.~~ |
  | 1866 |  | ~~if ( WP\_Helper::is\_multisite() && 'superadmins-only' === $current\_policy ) {~~ |
  | 1867 |  | ~~return is\_super\_admin( $user\_id );~~ |
  | 1868 |  | ~~} elseif ( WP\_Helper::is\_multisite() && 'superadmins-siteadmins-only' === $current\_policy ) {~~ |
  | 1869 |  | ~~return self::is\_admin( $user\_id );~~ |
  | 1870 |  | ~~} elseif ( 'all-users' === $current\_policy ) {~~ |
  | 1871 |  |  |
  | 1872 |  | ~~$excluded\_users = self::get\_excluded\_users();~~ |
  | 1873 |  | ~~if ( ! empty( $excluded\_users ) ) {~~ |
  | 1874 |  | ~~// Compare our roles with the users and see if we get a match.~~ |
  | 1875 |  | ~~$result = in\_array( $user\_login, $excluded\_users, true );~~ |
  | 1876 |  | ~~if ( $result ) {~~ |
  | 1877 |  | ~~return false;~~ |
  | 1878 |  | ~~}~~ |
  | 1879 |  |  |
  | 1880 |  | ~~$user\_eligible = true;~~ |
  | 1881 |  | ~~}~~ |
  | 1882 |  |  |
  | 1883 |  | ~~$excluded\_roles = self::get\_excluded\_roles();~~ |
  | 1884 |  | ~~if ( ! empty( $excluded\_roles ) ) {~~ |
  | 1885 |  |  |
  | 1886 |  | ~~if ( ! WP\_Helper::is\_multisite() ) {~~ |
  | 1887 |  | ~~// Compare our roles with the users and see if we get a match.~~ |
  | 1888 |  | ~~$result = array\_intersect( $excluded\_roles, $user\_roles );~~ |
  | 1889 |  |  |
  | 1890 |  | ~~if ( ! empty( $result ) ) {~~ |
  | 1891 |  | ~~return false;~~ |
  | 1892 |  | ~~}~~ |
  | 1893 |  | ~~} else {~~ |
  | 1894 |  | ~~$users\_caps = array();~~ |
  | 1895 |  | ~~$subsites   = get\_sites();~~ |
  | 1896 |  | ~~// Check each site and add to our array so we know each users actual roles.~~ |
  | 1897 |  | ~~foreach ( $subsites as $subsite ) {~~ |
  | 1898 |  | ~~$subsite\_id = get\_object\_vars( $subsite )['blog\_id'];~~ |
  | 1899 |  | ~~global $wpdb;~~ |
  | 1900 |  |  |
  | 1901 |  | ~~if ( 1 === (int) $subsite\_id ) {~~ |
  | 1902 |  | ~~$users\_caps[] = get\_user\_meta( $user\_id, $wpdb->base\_prefix . 'capabilities', true );~~ |
  | 1903 |  | ~~} else {~~ |
  | 1904 |  | ~~$users\_caps[] = get\_user\_meta( $user\_id, $wpdb->base\_prefix . $subsite\_id . '\_capabilities', true );~~ |
  | 1905 |  | ~~}~~ |
  | 1906 |  | ~~}~~ |
  | 1907 |  |  |
  | 1908 |  | ~~foreach ( $users\_caps as $key => $value ) {~~ |
  | 1909 |  | ~~if ( ! empty( $value ) ) {~~ |
  | 1910 |  | ~~foreach ( $value as $key => $value ) {~~ |
  | 1911 |  | ~~$result = in\_array( $key, $excluded\_roles, true );~~ |
  | 1912 |  | ~~}~~ |
  | 1913 |  | ~~}~~ |
  | 1914 |  | ~~}~~ |
  | 1915 |  | ~~if ( ! empty( $result ) ) {~~ |
  | 1916 |  | ~~return false;~~ |
  | 1917 |  | ~~}~~ |
  | 1918 |  | ~~}~~ |
  | 1919 |  | ~~}~~ |
  | 1920 |  |  |
  | 1921 |  | ~~if ( true === $user\_eligible ) {~~ |
  | 1922 |  | ~~return true;~~ |
  | 1923 |  | ~~}~~ |
  | 1924 |  | ~~} elseif ( ( 'certain-roles-only' === $current\_policy || 'certain-users-only' === $current\_policy ) ) {~~ |
  | 1925 |  | ~~$enforced\_users = self::get\_enforced\_users();~~ |
  | 1926 |  | ~~if ( ! empty( $enforced\_users ) ) {~~ |
  | 1927 |  |  |
  | 1928 |  | ~~// Compare our roles with the users and see if we get a match.~~ |
  | 1929 |  | ~~$result = in\_array( $user\_login, $enforced\_users, true );~~ |
  | 1930 |  | ~~// The user is one of the chosen roles we are forcing 2FA onto, so lets show the nag.~~ |
  | 1931 |  | ~~if ( ! empty( $result ) ) {~~ |
  | 1932 |  | ~~return true;~~ |
  | 1933 |  | ~~}~~ |
  | 1934 |  | ~~}~~ |
  | 1935 |  |  |
  | 1936 |  | ~~$enforced\_roles = self::get\_enforced\_roles();~~ |
  | 1937 |  | ~~if ( ! empty( $enforced\_roles ) ) {~~ |
  | 1938 |  | ~~// Turn it into an array.~~ |
  | 1939 |  | ~~$enforced\_roles\_array = Settings\_Page::extract\_roles\_from\_input( $enforced\_roles );~~ |
  | 1940 |  |  |
  | 1941 |  | ~~if ( ! WP\_Helper::is\_multisite() ) {~~ |
  | 1942 |  | ~~// Compare our roles with the users and see if we get a match.~~ |
  | 1943 |  | ~~$result = array\_intersect( $enforced\_roles\_array, $user\_roles );~~ |
  | 1944 |  |  |
  | 1945 |  | ~~// The user is one of the chosen roles we are forcing 2FA onto, so lets show the nag.~~ |
  | 1946 |  | ~~if ( ! empty( $result ) ) {~~ |
  | 1947 |  | ~~return true;~~ |
  | 1948 |  | ~~}~~ |
  | 1949 |  | ~~} else {~~ |
  | 1950 |  | ~~$users\_caps = array();~~ |
  | 1951 |  | ~~$subsites   = get\_sites();~~ |
  | 1952 |  | ~~// Check each site and add to our array so we know each users actual roles.~~ |
  | 1953 |  | ~~foreach ( $subsites as $subsite ) {~~ |
  | 1954 |  | ~~$subsite\_id = get\_object\_vars( $subsite )['blog\_id'];~~ |
  | 1955 |  | ~~if ( 1 === (int) $subsite\_id ) {~~ |
  | 1956 |  | ~~$users\_caps[] = get\_user\_meta( $user\_id, 'wp\_capabilities', true );~~ |
  | 1957 |  | ~~} else {~~ |
  | 1958 |  | ~~$users\_caps[] = get\_user\_meta( $user\_id, 'wp\_' . $subsite\_id . '\_capabilities', true );~~ |
  | 1959 |  | ~~}~~ |
  | 1960 |  | ~~}~~ |
  | 1961 |  |  |
  | 1962 |  | ~~foreach ( $users\_caps as $key => $value ) {~~ |
  | 1963 |  | ~~if ( ! empty( $value ) ) {~~ |
  | 1964 |  | ~~foreach ( $value as $key => $value ) {~~ |
  | 1965 |  | ~~$result = in\_array( $key, $enforced\_roles\_array, true );~~ |
  | 1966 |  | ~~}~~ |
  | 1967 |  | ~~}~~ |
  | 1968 |  | ~~}~~ |
  | 1969 |  | ~~if ( ! empty( $result ) ) {~~ |
  | 1970 |  | ~~return true;~~ |
  | 1971 |  | ~~}~~ |
  | 1972 |  | ~~}~~ |
  | 1973 |  | ~~}~~ |
  | 1974 |  |  |
  | 1975 |  | ~~if ( Settings\_Utils::string\_to\_bool( WP2FA::get\_wp2fa\_setting( 'superadmins-role-add' ) ) ) {~~ |
  | 1976 |  | ~~return is\_super\_admin( $user\_id );~~ |
  | 1977 |  | ~~}~~ |
  | 1978 |  | ~~} /\* elseif ( 'certain-users-only' === $current\_policy && empty( $enabled\_method ) ) {~~ |
  | 1979 |  | ~~$enforced\_users = self::get\_enforced\_users();~~ |
  | 1980 |  | ~~if ( ! empty( $enforced\_users ) ) {~~ |
  | 1981 |  | ~~// Compare our roles with the users and see if we get a match.~~ |
  | 1982 |  | ~~$result = in\_array( $user\_login, $enforced\_users, true );~~ |
  | 1983 |  | ~~// The user is one of the chosen roles we are forcing 2FA onto, so lets show the nag.~~ |
  | 1984 |  | ~~if ( ! empty( $result ) ) {~~ |
  | 1985 |  | ~~return true;~~ |
  | 1986 |  | ~~}~~ |
  | 1987 |  | ~~}~~ |
  | 1988 |  | ~~} \*/ elseif ( 'enforce-on-multisite' === $current\_policy ) {~~ |
  | 1989 |  | ~~$included\_sites = self::get\_included\_sites();~~ |
  | 1990 |  |  |
  | 1991 |  | ~~foreach ( $included\_sites as $site\_id ) {~~ |
  | 1992 |  | ~~if ( is\_user\_member\_of\_blog( $user\_id, $site\_id ) ) {~~ |
  | 1993 |  | ~~return true;~~ |
  | 1994 |  | ~~}~~ |
  | 1995 |  | ~~}~~ |
  | 1996 | 1899 | } elseif ( 'all-users' === $current\_policy ) { |
  | 1997 | 1900 | return true; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=2940688#L1999) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-user-helper.php?rev=3009922#L1902) |  |
  | 1999 | 1902 |  |
  | 2000 | 1903 | return false; |
  |  | 1904 | } |
  |  | 1905 |  |
  |  | 1906 | /\*\* |
  |  | 1907 | \* Returns the nominated email for user. |
  |  | 1908 | \* |
  |  | 1909 | \* @param int|\WP\_User|null $user - The WP user we should extract the meta data for. |
  |  | 1910 | \* |
  |  | 1911 | \* @return mixed |
  |  | 1912 | \* |
  |  | 1913 | \* @since 2.6.0 |
  |  | 1914 | \*/ |
  |  | 1915 | public static function get\_nominated\_email\_for\_user( $user = null ) { |
  |  | 1916 | self::set\_proper\_user( $user ); |
  |  | 1917 |  |
  |  | 1918 | $email = self::get\_meta( self::USER\_NOMINATED\_EMAIL ); |
  |  | 1919 |  |
  |  | 1920 | if ( empty( $email ) || ! isset( $email ) ) { |
  |  | 1921 | $email = self::get\_user()->user\_email; |
  |  | 1922 | } |
  |  | 1923 |  |
  |  | 1924 | return $email; |
  |  | 1925 | } |
  |  | 1926 |  |
  |  | 1927 | /\*\* |
  |  | 1928 | \* Sets the nominated email for the user. If the email is the same as the current user email from the WP - the meta is not populated. |
  |  | 1929 | \* |
  |  | 1930 | \* @param string            $email - The token to set for the user. |
  |  | 1931 | \* @param int|\WP\_User|null $user  - The WP user we should extract the meta data for. |
  |  | 1932 | \* |
  |  | 1933 | \* @return mixed |
  |  | 1934 | \* |
  |  | 1935 | \* @since 2.6.0 |
  |  | 1936 | \*/ |
  |  | 1937 | public static function set\_nominated\_email\_for\_user( string $email, $user = null ) { |
  |  | 1938 | self::set\_proper\_user( $user ); |
  |  | 1939 |  |
  |  | 1940 | $email = \sanitize\_email( \wp\_unslash( $email ) ); |
  |  | 1941 |  |
  |  | 1942 | if ( ! empty( $email ) ) { |
  |  | 1943 | if ( self::get\_user()->user\_email !== $email ) { |
  |  | 1944 | return self::set\_meta( self::USER\_NOMINATED\_EMAIL, $email ); |
  |  | 1945 | } else { |
  |  | 1946 | self::remove\_nominated\_email\_for\_user( $user ); |
  |  | 1947 | } |
  |  | 1948 | } |
  |  | 1949 |  |
  |  | 1950 | return false; |
  |  | 1951 | } |
  |  | 1952 |  |
  |  | 1953 | /\*\* |
  |  | 1954 | \* Removes the nominated email for the user. |
  |  | 1955 | \* |
  |  | 1956 | \* @param int|\WP\_User|null $user - The WP user we should extract the meta data for. |
  |  | 1957 | \* |
  |  | 1958 | \* @return void |
  |  | 1959 | \* |
  |  | 1960 | \* @since 2.6.0 |
  |  | 1961 | \*/ |
  |  | 1962 | public static function remove\_nominated\_email\_for\_user( $user = null ) { |
  |  | 1963 | self::set\_proper\_user( $user ); |
  |  | 1964 |  |
  |  | 1965 | self::remove\_meta( self::USER\_NOMINATED\_EMAIL, self::$user ); |
  |  | 1966 | } |
  |  | 1967 |  |
  |  | 1968 |  |
  |  | 1969 | /\*\* |
  |  | 1970 | \* Returns the backup email for user. If the data stored in meta is = 'wp\_mail' that means that the user email should be extracted from the WP BE. |
  |  | 1971 | \* |
  |  | 1972 | \* @param int|\WP\_User|null $user - The WP user we should extract the meta data for. |
  |  | 1973 | \* |
  |  | 1974 | \* @return mixed |
  |  | 1975 | \* |
  |  | 1976 | \* @since 2.6.0 |
  |  | 1977 | \*/ |
  |  | 1978 | public static function get\_backup\_email\_for\_user( $user = null ) { |
  |  | 1979 | self::set\_proper\_user( $user ); |
  |  | 1980 |  |
  |  | 1981 | $email = self::get\_meta( self::USER\_BACKUP\_EMAIL ); |
  |  | 1982 |  |
  |  | 1983 | if ( empty( $email ) || ! isset( $email ) ) { |
  |  | 1984 | $email = self::get\_user()->user\_email; |
  |  | 1985 | } |
  |  | 1986 |  |
  |  | 1987 | if ( isset( $email ) && 'wp\_mail' === $email ) { |
  |  | 1988 | $email = self::get\_user()->user\_email; |
  |  | 1989 | } |
  |  | 1990 |  |
  |  | 1991 | return $email; |
  |  | 1992 | } |
  |  | 1993 |  |
  |  | 1994 | /\*\* |
  |  | 1995 | \* Sets the backup email for the user. If the email is the same as the current user email from the WP - the meta is not populated. |
  |  | 1996 | \* |
  |  | 1997 | \* @param string            $email - The token to set for the user. |
  |  | 1998 | \* @param int|\WP\_User|null $user  - The WP user we should extract the meta data for. |
  |  | 1999 | \* |
  |  | 2000 | \* @return mixed |
  |  | 2001 | \* |
  |  | 2002 | \* @since 2.6.0 |
  |  | 2003 | \*/ |
  |  | 2004 | public static function set\_backup\_email\_for\_user( string $email, $user = null ) { |
  |  | 2005 | self::set\_proper\_user( $user ); |
  |  | 2006 |  |
  |  | 2007 | $email = \sanitize\_email( \wp\_unslash( $email ) ); |
  |  | 2008 |  |
  |  | 2009 | if ( ! empty( $email ) ) { |
  |  | 2010 | if ( self::get\_user()->user\_email !== $email ) { |
  |  | 2011 | return self::set\_meta( self::USER\_BACKUP\_EMAIL, $email ); |
  |  | 2012 | } elseif ( self::get\_user()->user\_email === $email ) { |
  |  | 2013 | return self::set\_meta( self::USER\_BACKUP\_EMAIL, 'wp\_mail' ); |
  |  | 2014 | } else { |
  |  | 2015 | self::remove\_backup\_email\_for\_user( $user ); |
  |  | 2016 | } |
  |  | 2017 | } |
  |  | 2018 |  |
  |  | 2019 | return false; |
  |  | 2020 | } |
  |  | 2021 |  |
  |  | 2022 | /\*\* |
  |  | 2023 | \* Removes the backup email for the user. |
  |  | 2024 | \* |
  |  | 2025 | \* @param int|\WP\_User|null $user - The WP user we should extract the meta data for. |
  |  | 2026 | \* |
  |  | 2027 | \* @return void |
  |  | 2028 | \* |
  |  | 2029 | \* @since 2.6.0 |
  |  | 2030 | \*/ |
  |  | 2031 | public static function remove\_backup\_email\_for\_user( $user = null ) { |
  |  | 2032 | self::set\_proper\_user( $user ); |
  |  | 2033 |  |
  |  | 2034 | self::remove\_meta( self::USER\_BACKUP\_EMAIL, self::$user ); |
  | 2001 | 2035 | } |
  | 2002 | 2036 |  |
* ## [wp-2fa/trunk/includes/classes/Admin/Helpers/class-wp-helper.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Helpers/class-wp-helper.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Helpers/class-wp-helper.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-wp-helper.php?rev=2940688#L239 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Helpers/class-wp-helper.php?rev=3009922#L239 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 239 | 239 | self::remove\_unrelated\_actions( 'all\_admin\_notices' ); |
  | 240 | 240 | self::remove\_unrelated\_actions( 'network\_admin\_notices' ); |
  |  | 241 | } |
  |  | 242 |  |
  |  | 243 | /\*\* |
  |  | 244 | \* Creates a nonce for HTML field by given name. |
  |  | 245 | \* |
  |  | 246 | \* @param string $nonce\_name -The name of the nonce to create. |
  |  | 247 | \* |
  |  | 248 | \* @return string |
  |  | 249 | \* |
  |  | 250 | \* @since 2.6.0 |
  |  | 251 | \*/ |
  |  | 252 | public static function create\_data\_nonce( string $nonce\_name ): string { |
  |  | 253 | return ' data-nonce="' . \esc\_attr( \wp\_create\_nonce( $nonce\_name ) ) . '"'; |
  |  | 254 | } |
  |  | 255 |  |
  |  | 256 | /\*\* |
  |  | 257 | \* Extracts the domain part of the given string. |
  |  | 258 | \* |
  |  | 259 | \* @param string $url\_to\_check - The URL string to be checked. |
  |  | 260 | \* |
  |  | 261 | \* @return string |
  |  | 262 | \* |
  |  | 263 | \* @since 2.6.0 |
  |  | 264 | \*/ |
  |  | 265 | public static function extract\_domain( string $url\_to\_check ): string { |
  |  | 266 | // get the full domain. |
  |  | 267 | // $urlparts = parse\_url( \site\_url() );. |
  |  | 268 |  |
  |  | 269 | if ( false !== strpos( $url\_to\_check, '@' ) ) { |
  |  | 270 | $domain = \explode( '@', $url\_to\_check )[1]; |
  |  | 271 |  |
  |  | 272 | return $domain; |
  |  | 273 | } |
  |  | 274 | $urlparts = parse\_url( $url\_to\_check ); |
  |  | 275 | $domain   = $urlparts ['host']; |
  |  | 276 |  |
  |  | 277 | // get the TLD and domain. |
  |  | 278 | $domainparts = explode( '.', $domain ); |
  |  | 279 | $domain      = $domainparts[ count( $domainparts ) - 2 ] . '.' . $domainparts[ count( $domainparts ) - 1 ]; |
  |  | 280 |  |
  |  | 281 | return $domain; |
  | 241 | 282 | } |
  | 242 | 283 |  |
* ## [wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-login-attempts.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-login-attempts.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-login-attempts.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-login-attempts.php?rev=2940688#L4 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/Traits/class-login-attempts.php?rev=3009922#L4 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* @package    wp2fa |
  | 6 |  | \* @subpackage ~~admin\_controller~~s |
  |  | 6 | \* @subpackage traits |
  | 7 | 7 | \* @copyright  %%YEAR%% Melapress |
  | 8 | 8 | \* @license    https://www.apache.org/licenses/LICENSE-2.0 Apache License 2.0 |
* ## [wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L4 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L4 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* |
  | 5 | 5 | \* @package    wp2fa |
  | 6 |  | \* @subpackage ~~backup-code~~s |
  |  | 6 | \* @subpackage methods |
  | 7 | 7 | \* |
  | 8 | 8 | \* @copyright  %%YEAR%% Melapress |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L10) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L10) |  |
  | 10 | 10 | \* |
  | 11 | 11 | \* @see       https://wordpress.org/plugins/wp-2fa/ |
  |  | 12 | \* |
  |  | 13 | \* @since 2.6.0 |
  | 12 | 14 | \*/ |
  | 13 | 15 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L16) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L18) |  |
  | 16 | 18 | namespace WP2FA\Methods; |
  | 17 | 19 |  |
  |  | 20 | use WP2FA\WP2FA; |
  | 18 | 21 | use WP2FA\Admin\Settings\_Page; |
  |  | 22 | use WP2FA\Utils\Settings\_Utils; |
  | 19 | 23 | use WP2FA\Admin\Helpers\User\_Helper; |
  | 20 | 24 | use WP2FA\Admin\Controllers\Settings; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L32) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L36) |  |
  | 32 | 36 | /\*\* |
  | 33 | 37 | \* Backup code class, for handling backup code generation and such. |
  |  | 38 | \* |
  |  | 39 | \* @since 2.6.0 |
  | 34 | 40 | \*/ |
  | 35 | 41 | class Backup\_Codes { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L50) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L56) |  |
  | 50 | 56 | \* |
  | 51 | 57 | \* @var string |
  |  | 58 | \* |
  |  | 59 | \* @since 2.6.0 |
  | 52 | 60 | \*/ |
  | 53 | 61 | public const BACKUP\_CODES\_META\_KEY = 'wp\_2fa\_backup\_codes'; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L57) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L65) |  |
  | 57 | 65 | \* |
  | 58 | 66 | \* @var int |
  |  | 67 | \* |
  |  | 68 | \* @since 2.6.0 |
  | 59 | 69 | \*/ |
  | 60 | 70 | public const NUMBER\_OF\_CODES = 10; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L67) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L77) |  |
  | 67 | 77 | \* @since 2.0.0 |
  | 68 | 78 | \*/ |
  | 69 |  | public ~~static $method\_name~~ = 'backup\_codes'; |
  |  | 79 | public const METHOD\_NAME = 'backup\_codes'; |
  | 70 | 80 |  |
  | 71 | 81 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L79) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L89) |  |
  | 79 | 89 |  |
  | 80 | 90 | /\*\* |
  | 81 |  | \* Lets build! |
  |  | 91 | \* Holds the status of the backup codes functionality |
  |  | 92 | \* |
  |  | 93 | \* @var bool[] |
  |  | 94 | \* |
  |  | 95 | \* @since 2.6.0 |
  |  | 96 | \*/ |
  |  | 97 | private static $backup\_codes\_enabled = array(); |
  |  | 98 |  |
  |  | 99 | /\*\* |
  |  | 100 | \* Default extension settings. |
  |  | 101 | \* |
  |  | 102 | \* @var array |
  |  | 103 | \* |
  |  | 104 | \* @since 2.6.0 |
  |  | 105 | \*/ |
  |  | 106 | private static $settings = array( |
  |  | 107 | 'backup\_codes\_enabled' => 'yes', |
  |  | 108 | ); |
  |  | 109 |  |
  |  | 110 | /\*\* |
  |  | 111 | \* Inits the backup codes class hooks |
  |  | 112 | \* |
  |  | 113 | \* @return void |
  |  | 114 | \* |
  |  | 115 | \* @since 2.6.0 |
  | 82 | 116 | \*/ |
  | 83 | 117 | public static function init() { |
  | 84 | 118 | \add\_filter( WP\_2FA\_PREFIX . 'backup\_methods\_list', array( \_\_CLASS\_\_, 'add\_backup\_method' ), 10, 2 ); |
  | 85 |  | \add\_filter( WP\_2FA\_PREFIX . 'backup\_methods\_enabled', array( \_\_CLASS\_\_, 'check\_backup\_method' ), 10, 2 ); |
  |  | 119 | \add\_filter( WP\_2FA\_PREFIX . 'backup\_methods\_enabled', array( \_\_CLASS\_\_, 'check\_backup\_method\_for\_role' ), 10, 2 ); |
  | 86 | 120 | \add\_action( 'wp\_ajax\_wp2fa\_run\_ajax\_generate\_json', array( \_\_CLASS\_\_, 'run\_ajax\_generate\_json' ) ); |
  | 87 | 121 |  |
  | 88 | 122 | \add\_action( WP\_2FA\_PREFIX . 'remove\_backup\_methods\_for\_user', array( \_\_CLASS\_\_, 'remove\_backup\_methods\_for\_user' ) ); |
  |  | 123 |  |
  |  | 124 | \add\_filter( WP\_2FA\_PREFIX . 'loop\_settings', array( \_\_CLASS\_\_, 'settings\_loop' ), 10, 2 ); |
  |  | 125 |  |
  |  | 126 | \add\_filter( WP\_2FA\_PREFIX . 'default\_settings', array( \_\_CLASS\_\_, 'add\_default\_settings' ) ); |
  |  | 127 |  |
  |  | 128 | \add\_filter( WP\_2FA\_PREFIX . 'providers', array( \_\_CLASS\_\_, 'backup\_codes' ) ); |
  |  | 129 |  |
  |  | 130 | \add\_filter( WP\_2FA\_PREFIX . 'providers\_translated\_names', array( \_\_CLASS\_\_, 'fill\_providers\_array\_with\_method\_name\_translated' ) ); |
  |  | 131 |  |
  |  | 132 | \add\_filter( WP\_2FA\_PREFIX . 'user\_enabled\_backup\_methods', array( \_\_CLASS\_\_, 'method\_enabled\_for\_user' ), 10, 2 ); |
  | 89 | 133 | } |
  | 90 | 134 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L94) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L138) |  |
  | 94 | 138 | \* @param object $user User data. |
  | 95 | 139 | \* @param string $args possible args. |
  |  | 140 | \* |
  |  | 141 | \* @since 2.6.0 |
  | 96 | 142 | \*/ |
  | 97 | 143 | public static function generate\_codes( $user, $args = '' ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L108) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L154) |  |
  | 108 | 154 | // Append or replace (default). |
  | 109 | 155 | if ( isset( $args['method'] ) && 'append' === $args['method'] ) { |
  | 110 |  | $codes\_hashed = (array) get\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, true ); |
  |  | 156 | $codes\_hashed = (array) \get\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, true ); |
  | 111 | 157 | } |
  | 112 | 158 |  |
  | 113 | 159 | for ( $i = 0; $i < $num\_codes; ++$i ) { |
  | 114 | 160 | $code           = Authentication::get\_code(); |
  | 115 |  | $codes\_hashed[] = wp\_hash\_password( $code ); |
  |  | 161 | $codes\_hashed[] = \wp\_hash\_password( $code ); |
  | 116 | 162 | $codes[]        = $code; |
  | 117 | 163 | unset( $code ); |
  | 118 | 164 | } |
  | 119 | 165 |  |
  | 120 |  | update\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, $codes\_hashed ); |
  |  | 166 | \update\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, $codes\_hashed ); |
  | 121 | 167 |  |
  | 122 | 168 | // Unhashed. |
  | 123 | 169 | return $codes; |
  |  | 170 | } |
  |  | 171 |  |
  |  | 172 | /\*\* |
  |  | 173 | \* Fills the array of the enabled backup methods is it is provided for the given user |
  |  | 174 | \* |
  |  | 175 | \* @param array    $array\_methods - Array to fill if the method is enabled for user. |
  |  | 176 | \* @param \WP\_User $user - The user to check for. |
  |  | 177 | \* |
  |  | 178 | \* @return array |
  |  | 179 | \* |
  |  | 180 | \* @since 2.6.0 |
  |  | 181 | \*/ |
  |  | 182 | public static function method\_enabled\_for\_user( array $array\_methods, $user ): array { |
  |  | 183 | if ( self::is\_enabled\_for\_user( $user ) ) { |
  |  | 184 | $array\_methods[ self::METHOD\_NAME ] = self::get\_translated\_name(); |
  |  | 185 | } |
  |  | 186 |  |
  |  | 187 | return $array\_methods; |
  |  | 188 | } |
  |  | 189 |  |
  |  | 190 | /\*\* |
  |  | 191 | \* Adds Backup codes as a provider. |
  |  | 192 | \* |
  |  | 193 | \* @param array $providers - Array with all currently supported providers. |
  |  | 194 | \* |
  |  | 195 | \* @return array |
  |  | 196 | \* |
  |  | 197 | \* @since 2.6.0 |
  |  | 198 | \*/ |
  |  | 199 | public static function backup\_codes( array $providers ) { |
  |  | 200 | array\_push( $providers, self::METHOD\_NAME ); |
  |  | 201 |  |
  |  | 202 | return $providers; |
  |  | 203 | } |
  |  | 204 |  |
  |  | 205 | /\*\* |
  |  | 206 | \* Adds Backup code as a provider. |
  |  | 207 | \* |
  |  | 208 | \* @param array $providers - Array with all currently supported providers and their translated names. |
  |  | 209 | \* |
  |  | 210 | \* @return array |
  |  | 211 | \* |
  |  | 212 | \* @since 2.6.0 |
  |  | 213 | \*/ |
  |  | 214 | public static function fill\_providers\_array\_with\_method\_name\_translated( array $providers ) { |
  |  | 215 | $providers[ self::METHOD\_NAME ] = self::get\_translated\_name(); |
  |  | 216 |  |
  |  | 217 | return $providers; |
  |  | 218 | } |
  |  | 219 |  |
  |  | 220 | /\*\* |
  |  | 221 | \* Returns the name of the provider |
  |  | 222 | \* |
  |  | 223 | \* @return string |
  |  | 224 | \* |
  |  | 225 | \* @since 2.6.0 |
  |  | 226 | \*/ |
  |  | 227 | public static function get\_translated\_name(): string { |
  |  | 228 | return esc\_html\_\_( 'Backup codes', 'wp-2fa' ); |
  | 124 | 229 | } |
  | 125 | 230 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L141) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L246) |  |
  | 141 | 246 | /\*\* |
  | 142 | 247 | \* Generate codes and check remaining amount for user. |
  |  | 248 | \* |
  |  | 249 | \* @return void |
  |  | 250 | \* |
  |  | 251 | \* @since 2.6.0 |
  | 143 | 252 | \*/ |
  | 144 | 253 | public static function run\_ajax\_generate\_json() { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L175) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L284) |  |
  | 175 | 284 | \* Grab number of unused backup codes within the users position. |
  | 176 | 285 | \* |
  | 177 |  | \* @param object $user User data. |
  |  | 286 | \* @param object $user - User data. |
  | 178 | 287 | \* |
  | 179 | 288 | \* @return int Count of codes. |
  |  | 289 | \* |
  |  | 290 | \* @since 2.6.0 |
  | 180 | 291 | \*/ |
  | 181 | 292 | public static function codes\_remaining\_for\_user( $user ) { |
  | 182 |  | $backup\_codes = get\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, true ); |
  |  | 293 | $backup\_codes = \get\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, true ); |
  | 183 | 294 | if ( is\_array( $backup\_codes ) && ! empty( $backup\_codes ) ) { |
  | 184 | 295 | return count( $backup\_codes ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L195) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L306) |  |
  | 195 | 306 | \* |
  | 196 | 307 | \* @return bool Is is valid or not. |
  |  | 308 | \* |
  |  | 309 | \* @since 2.6.0 |
  | 197 | 310 | \*/ |
  | 198 | 311 | public static function validate\_code( $user, $code ) { |
  | 199 | 312 | $backup\_codes = get\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, true ); |
  | 200 | 313 | if ( is\_array( $backup\_codes ) && ! empty( $backup\_codes ) ) { |
  | 201 |  | foreach ( $backup\_codes as $code\_~~index => $code\_~~hashed ) { |
  |  | 314 | foreach ( $backup\_codes as $code\_hashed ) { |
  | 202 | 315 | if ( wp\_check\_password( $code, $code\_hashed, $user->ID ) ) { |
  | 203 | 316 | self::delete\_code( $user, $code\_hashed ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L218) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L331) |  |
  | 218 | 331 | \* @param object $user        User data. |
  | 219 | 332 | \* @param string $code\_hashed Code to delete. |
  |  | 333 | \* |
  |  | 334 | \* @since 2.6.0 |
  | 220 | 335 | \*/ |
  | 221 | 336 | public static function delete\_code( $user, $code\_hashed ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L242) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L357) |  |
  | 242 | 357 | $backup\_methods, |
  | 243 | 358 | array( |
  | 244 |  | self::~~$method\_name~~ => array( |
  |  | 359 | self::METHOD\_NAME => array( |
  | 245 | 360 | 'wizard-step' => '2fa-wizard-config-backup-codes', |
  | 246 | 361 | 'button\_name' => sprintf( |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L262) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L377) |  |
  | 262 | 377 | \* @since 2.0.0 |
  | 263 | 378 | \*/ |
  | 264 |  | public static function check\_backup\_method( array $backup\_methods, \WP\_User $user ): array { |
  | 265 |  | $enabled = ~~Settings\_Page::are\_backup\_codes\_enabled~~( User\_Helper::get\_user\_role( $user ) ); |
  |  | 379 | public static function check\_backup\_method\_for\_role( array $backup\_methods, \WP\_User $user ): array { |
  |  | 380 | $enabled = self::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ); |
  | 266 | 381 |  |
  | 267 | 382 | if ( ! $enabled ) { |
  | 268 |  | unset( $backup\_methods[ self::~~$method\_name~~ ] ); |
  |  | 383 | unset( $backup\_methods[ self::METHOD\_NAME ] ); |
  | 269 | 384 | } |
  | 270 | 385 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=2940688#L278) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Methods/class-backup-codes.php?rev=3009922#L393) |  |
  | 278 | 393 | \*/ |
  | 279 | 394 | public static function get\_method\_name(): string { |
  | 280 |  | return self::$method\_name; |
  |  | 395 | return self::METHOD\_NAME; |
  |  | 396 | } |
  |  | 397 |  |
  |  | 398 | /\*\* |
  |  | 399 | \* Checks if the backup codes option is enabled for the role |
  |  | 400 | \* |
  |  | 401 | \* @param string $role - The role name. |
  |  | 402 | \* |
  |  | 403 | \* @return bool |
  |  | 404 | \* |
  |  | 405 | \* @since 2.6.0 |
  |  | 406 | \*/ |
  |  | 407 | public static function are\_backup\_codes\_enabled\_for\_role( $role = 'global' ) { |
  |  | 408 |  |
  |  | 409 | $role = ( is\_null( $role ) || empty( $role ) ) ? 'global' : $role; |
  |  | 410 |  |
  |  | 411 | if ( ! isset( self::$backup\_codes\_enabled[ $role ] ) ) { |
  |  | 412 | self::$backup\_codes\_enabled[ $role ] = false; |
  |  | 413 |  |
  |  | 414 | if ( 'global' === $role ) { |
  |  | 415 | $setting\_value = Settings::get\_role\_or\_default\_setting( self::get\_settings\_name() ); |
  |  | 416 | } else { |
  |  | 417 | $setting\_value = Settings::get\_role\_or\_default\_setting( self::get\_settings\_name(), 'current', $role ); |
  |  | 418 | } |
  |  | 419 | self::$backup\_codes\_enabled[ $role ] = Settings\_Utils::string\_to\_bool( $setting\_value ); |
  |  | 420 | } |
  |  | 421 |  |
  |  | 422 | return self::$backup\_codes\_enabled[ $role ]; |
  |  | 423 | } |
  |  | 424 |  |
  |  | 425 | /\*\* |
  |  | 426 | \* Checks if the backup codes are enabled for the user. |
  |  | 427 | \* |
  |  | 428 | \* @param int|\WP\_User|null $user - The WP user we should extract the meta data for. |
  |  | 429 | \* |
  |  | 430 | \* @return bool |
  |  | 431 | \* |
  |  | 432 | \* @since 2.6.0 |
  |  | 433 | \* |
  |  | 434 | \* @throws \LogicException - can not extract user from the given parameters. |
  |  | 435 | \*/ |
  |  | 436 | public static function is\_enabled\_for\_user( $user ): bool { |
  |  | 437 | $user = User\_Helper::get\_user\_object( $user ); |
  |  | 438 |  |
  |  | 439 | if ( ! \is\_a( $user, '\WP\_User' ) ) { |
  |  | 440 | throw new \LogicException( 'Not a proper user object provided!' ); |
  |  | 441 | } |
  |  | 442 |  |
  |  | 443 | $codes\_remaining = self::codes\_remaining\_for\_user( $user ); |
  |  | 444 |  |
  |  | 445 | return (bool) $codes\_remaining; |
  |  | 446 | } |
  |  | 447 |  |
  |  | 448 | /\*\* |
  |  | 449 | \* Adds settings names to the extraction array - grabs the values and stores them based on names. |
  |  | 450 | \* |
  |  | 451 | \* @param array $settings - Array with all the settings. |
  |  | 452 | \* |
  |  | 453 | \* @since 2.6.0 |
  |  | 454 | \*/ |
  |  | 455 | public static function settings\_loop( array $settings ): array { |
  |  | 456 | return array\_merge( $settings, array\_keys( self::$settings ) ); |
  |  | 457 | } |
  |  | 458 |  |
  |  | 459 | /\*\* |
  |  | 460 | \* Adds the extension default settings to the main plugin settings. |
  |  | 461 | \* |
  |  | 462 | \* @param array $default\_settings - Array with plugin default settings. |
  |  | 463 | \* |
  |  | 464 | \* @return array |
  |  | 465 | \* |
  |  | 466 | \* @since 2.6.0 |
  |  | 467 | \*/ |
  |  | 468 | public static function add\_default\_settings( array $default\_settings ) { |
  |  | 469 | return array\_merge( $default\_settings, self::$settings ); |
  |  | 470 | } |
  |  | 471 |  |
  |  | 472 | /\*\* |
  |  | 473 | \* Returns the method settings name |
  |  | 474 | \* |
  |  | 475 | \* @return string |
  |  | 476 | \* |
  |  | 477 | \* @since 2.6.0 |
  |  | 478 | \*/ |
  |  | 479 | public static function get\_settings\_name(): string { |
  |  | 480 | return \array\_key\_first( self::$settings ); |
  |  | 481 | } |
  |  | 482 |  |
  |  | 483 | /\*\* |
  |  | 484 | \* Returns the method settings default value |
  |  | 485 | \* |
  |  | 486 | \* @return mixed |
  |  | 487 | \* |
  |  | 488 | \* @since 2.6.0 |
  |  | 489 | \*/ |
  |  | 490 | public static function get\_settings\_default\_value() { |
  |  | 491 | return \reset( self::$settings ); |
  |  | 492 | } |
  |  | 493 |  |
  |  | 494 | /\*\* |
  |  | 495 | \* Validates a backup code. |
  |  | 496 | \* |
  |  | 497 | \* Backup Codes are single use and are deleted upon a successful validation. |
  |  | 498 | \* |
  |  | 499 | \* @since 2.6.0 |
  |  | 500 | \* |
  |  | 501 | \* @param \WP\_User $user \WP\_User object of the logged-in user. |
  |  | 502 | \* |
  |  | 503 | \* @return boolean |
  |  | 504 | \*/ |
  |  | 505 | public static function validate\_backup\_codes( $user ) { |
  |  | 506 | if ( ! isset( $user->ID ) || ! isset( $\_REQUEST['wp-2fa-backup-code'] ) ) { //phpcs:ignore |
  |  | 507 | return false; |
  |  | 508 | } |
  |  | 509 |  |
  |  | 510 | return self::validate\_code( $user, \sanitize\_text\_field( \wp\_unslash( $\_REQUEST['wp-2fa-backup-code'] ) ) ); |
  |  | 511 | } |
  |  | 512 |  |
  |  | 513 | /\*\* |
  |  | 514 | \* Returns the backup codes for the user. |
  |  | 515 | \* |
  |  | 516 | \* @param \WP\_User $user \WP\_User - object of the logged-in user. |
  |  | 517 | \* |
  |  | 518 | \* @return array |
  |  | 519 | \* |
  |  | 520 | \* @since 2.6.0 |
  |  | 521 | \*/ |
  |  | 522 | public static function get\_backup\_codes\_for\_user( $user ): array { |
  |  | 523 | $backup\_codes = get\_user\_meta( $user->ID, self::BACKUP\_CODES\_META\_KEY, true ); |
  |  | 524 |  |
  |  | 525 | if ( ! \is\_array( $backup\_codes ) ) { |
  |  | 526 | return array(); |
  |  | 527 | } |
  |  | 528 |  |
  |  | 529 | return $backup\_codes; |
  |  | 530 | } |
  |  | 531 |  |
  |  | 532 | /\*\* |
  |  | 533 | \* Send email with fresh code, or to setup email 2fa. |
  |  | 534 | \* |
  |  | 535 | \* @param int    $user\_id User id we want to send the message to. |
  |  | 536 | \* @param string $nominated\_email\_address - The user custom address to use (name of the meta key to check for). |
  |  | 537 | \* |
  |  | 538 | \* @return bool |
  |  | 539 | \* |
  |  | 540 | \* @since 2.6.0 |
  |  | 541 | \*/ |
  |  | 542 | public static function send\_backup\_codes\_email( $user\_id, $nominated\_email\_address = 'nominated\_email\_address' ) { |
  |  | 543 |  |
  |  | 544 | // If we have a nonce posted, check it. |
  |  | 545 | if ( \wp\_doing\_ajax() && isset( $\_POST['\_wpnonce'] ) ) { |
  |  | 546 | $nonce\_check = \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_POST['\_wpnonce'] ) ), 'wp-2fa-send-backup-codes-email-nonce' ); |
  |  | 547 | if ( ! $nonce\_check ) { |
  |  | 548 | return false; |
  |  | 549 | } |
  |  | 550 | } else { |
  |  | 551 | \wp\_die(); |
  |  | 552 | } |
  |  | 553 |  |
  |  | 554 | $user = User\_Helper::get\_user\_object(); |
  |  | 555 |  |
  |  | 556 | $enabled\_email\_address = ''; |
  |  | 557 | if ( ! empty( $nominated\_email\_address ) ) { |
  |  | 558 | if ( 'nominated\_email\_address' === $nominated\_email\_address ) { |
  |  | 559 | $enabled\_email\_address = User\_Helper::get\_nominated\_email\_for\_user( $user ); |
  |  | 560 | } else { |
  |  | 561 | $enabled\_email\_address = get\_user\_meta( $user->ID, WP\_2FA\_PREFIX . $nominated\_email\_address, true ); |
  |  | 562 | } |
  |  | 563 | } |
  |  | 564 |  |
  |  | 565 | if ( isset( $\_POST['codes'] ) ) { |
  |  | 566 | $codes = substr( str\_replace( '\\n', '<br>', \sanitize\_text\_field( \wp\_unslash( $\_POST['codes'] ) ) ), 1, -1 ); |
  |  | 567 |  |
  |  | 568 | $posted\_codes = array\_filter( \explode( '<br>', $codes ) ); |
  |  | 569 |  |
  |  | 570 | $stored\_codes = self::get\_backup\_codes\_for\_user( $user ); |
  |  | 571 |  |
  |  | 572 | foreach ( $posted\_codes as $key => $check\_code ) { |
  |  | 573 | $check\_code = trim( \explode( ':', $check\_code )[1] ); |
  |  | 574 | if ( ! wp\_check\_password( $check\_code, $stored\_codes[ $key ], $user->ID ) ) { |
  |  | 575 |  |
  |  | 576 | \wp\_die(); |
  |  | 577 | } |
  |  | 578 | } |
  |  | 579 | } else { |
  |  | 580 | \wp\_die(); |
  |  | 581 | } |
  |  | 582 |  |
  |  | 583 | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'user\_backup\_codes\_email\_subject' ), $user->ID ) ); |
  |  | 584 | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'user\_backup\_codes\_email\_body' ), $user->ID ) ); |
  |  | 585 |  |
  |  | 586 | $final\_output = str\_replace( '{backup\_codes}', $codes, $message ); |
  |  | 587 |  |
  |  | 588 | if ( ! empty( $enabled\_email\_address ) ) { |
  |  | 589 | $email\_address = $enabled\_email\_address; |
  |  | 590 | } else { |
  |  | 591 | $email\_address = $user->user\_email; |
  |  | 592 | } |
  |  | 593 |  |
  |  | 594 | return Settings\_Page::send\_email( $email\_address, $subject, $final\_output ); |
  | 281 | 595 | } |
  | 282 | 596 | } |
* ## [wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L13 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L13 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 |  |
  | 14 | 14 | use WP2FA\Email\_Template; |
  | 15 |  | use ~~\WP2FA\WP2FA as~~ WP2FA; |
  |  | 15 | use WP2FA\WP2FA; |
  | 16 | 16 | use WP2FA\Utils\Debugging; |
  |  | 17 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 17 | 18 | use WP2FA\Admin\Controllers\Settings; |
  | 18 |  | use WP2FA\Utils\Settings\_Utils~~as Settings\_Utils~~; |
  |  | 19 | use WP2FA\Utils\Settings\_Utils; |
  | 19 | 20 |  |
  | 20 | 21 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L114) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L115) |  |
  | 114 | 115 | <span><?php esc\_html\_e( 'Use the email address from the WordPress general settings.', 'wp-2fa' ); ?></span> |
  | 115 | 116 | </label> |
  | 116 |  |  |
  | 117 | 117 | <br/> |
  | 118 | 118 | <label for="use-custom-email"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L123) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L123) |  |
  | 123 | 123 | </label> |
  | 124 | 124 | <fieldset class="hidden custom-from-inputs"> |
  |  | 125 | <p class="description"> |
  |  | 126 | <?php esc\_html\_e( 'A \'From email\' address with a domain different than that of your website domain name, or with a domain that the hosting does not relay might cause the notification emails to be blocked, marked as spam, or not delivered at all. If you are not 100% sure about this change, consult with your web host.', 'wp-2fa' ); ?> |
  |  | 127 | </p> |
  | 125 | 128 | <br/> |
  | 126 | 129 | <span><?php esc\_html\_e( 'Email Address:', 'wp-2fa' ); ?></span> <input type="text" id="custom\_from\_email\_address" name="custom\_from\_email\_address" value="<?php echo esc\_attr( WP2FA::get\_wp2fa\_email\_templates( 'custom\_from\_email\_address' ) ); ?>"><br><br> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L133) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L136) |  |
  | 133 | 136 | </tbody> |
  | 134 | 137 | </table> |
  | 135 |  |  |
  |  | 138 | <div class="description"><i><?php esc\_html\_e( 'Tip: The \'From email\' address should match your website domain. If the "from address" does not match your website domain, the emails may be blocked or marked as spam. If you are not sure about this please consult with your website administrator / developer or ', 'wp-2fa' ); ?><a href="<?php echo esc\_url( 'https://melapress.com/contact/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank"><?php esc\_html\_e( 'contact us', 'wp-2fa' ); ?></a> <?php esc\_html\_e( 'for more information.', 'wp-2fa' ); ?></i></div> |
  | 136 | 139 | <br> |
  | 137 | 140 | <hr> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L145) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L148) |  |
  | 145 | 148 | class="button js-button-test-email-trigger" |
  | 146 | 149 | data-email-id="config\_test" |
  | 147 |  | ~~data-nonce="<?php echo esc\_attr( wp\_create\_nonce( 'wp-2fa-email-test-config\_test' ) ); ?>"~~> |
  |  | 150 | <?php echo WP\_Helper::create\_data\_nonce( 'wp-2fa-email-test-config\_test' ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>> |
  | 148 | 151 | <?php esc\_html\_e( 'Test email delivery', 'wp-2fa' ); ?> |
  | 149 | 152 | </button> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L173) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L176) |  |
  | 173 | 176 |  |
  | 174 | 177 | $result = array( |
  |  | 178 | new Email\_Template( |
  |  | 179 | 'login\_code\_setup', |
  |  | 180 | esc\_html\_\_( '2FA setup code email', 'wp-2fa' ), |
  |  | 181 | esc\_html\_\_( 'This is the email sent to a user when setting up 2FA via email.', 'wp-2fa' ) |
  |  | 182 | ), |
  | 175 | 183 | new Email\_Template( |
  | 176 | 184 | 'login\_code', |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L205) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L213) |  |
  | 205 | 213 | $result = apply\_filters( WP\_2FA\_PREFIX . 'email\_notification\_definitions', $result ); |
  | 206 | 214 |  |
  | 207 |  | if ( count( $result ) > 5 ) { |
  |  | 215 | if ( count( $result ) > 6 ) { |
  |  | 216 | $result[0]->set\_can\_be\_toggled( false ); |
  |  | 217 | $result[1]->set\_can\_be\_toggled( false ); |
  |  | 218 | $result[2]->set\_can\_be\_toggled( false ); |
  |  | 219 | $result[3]->set\_email\_content\_id( 'user\_account\_locked' ); |
  |  | 220 | $result[4]->set\_email\_content\_id( 'user\_account\_unlocked' ); |
  |  | 221 | $result[5]->set\_can\_be\_toggled( false ); |
  |  | 222 | } else { |
  | 208 | 223 | $result[0]->set\_can\_be\_toggled( false ); |
  | 209 | 224 | $result[1]->set\_can\_be\_toggled( false ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L211) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L226) |  |
  | 211 | 226 | $result[3]->set\_email\_content\_id( 'user\_account\_unlocked' ); |
  | 212 | 227 | $result[4]->set\_can\_be\_toggled( false ); |
  | 213 |  | ~~} else {~~ |
  | 214 |  | ~~$result[0]->set\_can\_be\_toggled( false );~~ |
  | 215 |  | ~~$result[1]->set\_email\_content\_id( 'user\_account\_locked' );~~ |
  | 216 |  | ~~$result[2]->set\_email\_content\_id( 'user\_account\_unlocked' );~~ |
  | 217 |  | ~~$result[3]->set\_can\_be\_toggled( false );~~ |
  | 218 | 228 | } |
  | 219 | 229 | return $result; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L276) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L286) |  |
  | 276 | 286 | } |
  | 277 | 287 | $output['custom\_from\_email\_address'] = sanitize\_email( wp\_unslash( $\_POST['custom\_from\_email\_address'] ) ); |
  |  | 288 |  |
  |  | 289 | Settings\_Utils::delete\_option( 'dismiss\_notice\_mail\_domain' ); |
  |  | 290 | } |
  |  | 291 |  |
  |  | 292 | if ( ! isset( $\_POST['email\_from\_setting'] ) ) { |
  |  | 293 | Settings\_Utils::delete\_option( 'dismiss\_notice\_mail\_domain' ); |
  | 278 | 294 | } |
  | 279 | 295 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L301) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L317) |  |
  | 301 | 317 | } |
  | 302 | 318 |  |
  |  | 319 | if ( isset( $\_POST['login\_code\_setup\_email\_subject'] ) ) { |
  |  | 320 | $output['login\_code\_setup\_email\_subject'] = wp\_kses\_post( wp\_unslash( $\_POST['login\_code\_setup\_email\_subject'] ) ); |
  |  | 321 | } |
  |  | 322 |  |
  |  | 323 | if ( isset( $\_POST['login\_code\_setup\_email\_body'] ) ) { |
  |  | 324 | $output['login\_code\_setup\_email\_body'] = wpautop( wp\_kses\_post( wp\_unslash( $\_POST['login\_code\_setup\_email\_body'] ) ) ); |
  |  | 325 | } |
  |  | 326 |  |
  | 303 | 327 | if ( isset( $\_POST['user\_account\_locked\_email\_subject'] ) ) { |
  | 304 | 328 | $output['user\_account\_locked\_email\_subject'] = wp\_kses\_post( wp\_unslash( $\_POST['user\_account\_locked\_email\_subject'] ) ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L315) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L339) |  |
  | 315 | 339 | if ( isset( $\_POST['user\_account\_unlocked\_email\_body'] ) ) { |
  | 316 | 340 | $output['user\_account\_unlocked\_email\_body'] = wpautop( wp\_kses\_post( wp\_unslash( $\_POST['user\_account\_unlocked\_email\_body'] ) ) ); |
  |  | 341 | } |
  |  | 342 |  |
  |  | 343 | if ( isset( $\_POST['reset\_password\_code\_email\_body'] ) ) { |
  |  | 344 | $output['reset\_password\_code\_email\_body'] = wpautop( wp\_kses\_post( wp\_unslash( $\_POST['reset\_password\_code\_email\_body'] ) ) ); |
  |  | 345 | } |
  |  | 346 |  |
  |  | 347 | if ( isset( $\_POST['reset\_password\_code\_email\_subject'] ) ) { |
  |  | 348 | $output['reset\_password\_code\_email\_subject'] = wp\_kses\_post( wp\_unslash( $\_POST['reset\_password\_code\_email\_subject'] ) ); |
  | 317 | 349 | } |
  | 318 | 350 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L325) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L357) |  |
  | 325 | 357 | if ( isset( $\_POST['send\_account\_unlocked\_email'] ) && 'enable\_account\_unlocked\_email' === $\_POST['send\_account\_unlocked\_email'] ) { |
  | 326 | 358 | $output['send\_account\_unlocked\_email'] = sanitize\_text\_field( wp\_unslash( $\_POST['send\_account\_unlocked\_email'] ) ); |
  |  | 359 | } |
  |  | 360 |  |
  |  | 361 | $output['send\_login\_code\_email'] = ''; |
  |  | 362 | if ( isset( $\_POST['send\_login\_code\_email'] ) && 'enable\_send\_login\_code\_email' === $\_POST['send\_login\_code\_email'] ) { |
  |  | 363 | $output['send\_login\_code\_email'] = sanitize\_text\_field( wp\_unslash( $\_POST['send\_login\_code\_email'] ) ); |
  | 327 | 364 | } |
  | 328 | 365 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L419) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L456) |  |
  | 419 | 456 | {user\_display\_name}</br> |
  | 420 | 457 | {login\_code}</br> |
  | 421 |  | {user\_ip\_address} |
  |  | 458 | {user\_ip\_address}</br> |
  |  | 459 | {backup\_codes} |
  | 422 | 460 | <?php |
  | 423 | 461 | if ( ! empty( $custom\_user\_page\_id ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=2940688#L444) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-email.php?rev=3009922#L482) |  |
  | 444 | 482 | class="button js-button-test-email-trigger" |
  | 445 | 483 | data-email-id="<?php echo esc\_attr( $template\_id ); ?>" |
  | 446 |  | ~~data-nonce="<?php echo esc\_attr( wp\_create\_nonce( 'wp-2fa-email-test-' . $template\_id ) ); ?>"~~> |
  |  | 484 | <?php echo WP\_Helper::create\_data\_nonce( 'wp-2fa-email-test-' . $template\_id ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>> |
  | 447 | 485 | <?php esc\_html\_e( 'Send test email', 'wp-2fa' ); ?> |
  | 448 | 486 | </button> |
* ## [wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=2940688#L86 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922#L86 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 86 | 86 | if ( ! in\_array( $simple\_setting, $settings\_to\_turn\_into\_bools, true ) ) { |
  | 87 | 87 | // Is item is not one of our possible settings we want to turn into a bool, process. |
  | 88 |  | $output[ $simple\_setting ] = ( isset( $input[ $simple\_setting ] ) && ! empty( $input[ $simple\_setting ] ) ) ? trim( sanitize\_text\_field( $input[ $simple\_setting ] ) ) : false; |
  |  | 88 | $output[ $simple\_setting ] = ( isset( $input[ $simple\_setting ] ) && ! empty( $input[ $simple\_setting ] ) ) ? trim( (string) sanitize\_text\_field( $input[ $simple\_setting ] ) ) : false; |
  | 89 | 89 | } else { |
  | 90 | 90 | // This item is one we treat as a bool, so process correctly. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=2940688#L98) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922#L98) |  |
  | 98 | 98 | $policies = WP2FA::get\_default\_settings(); |
  | 99 | 99 | } |
  | 100 |  | $policies['2fa\_settings\_last\_updated\_by'] = (int) ~~$input['2fa\_settings\_last\_updated\_by']~~; |
  |  | 100 | $policies['2fa\_settings\_last\_updated\_by'] = (int) get\_current\_user\_id(); |
  | 101 | 101 |  |
  | 102 | 102 | WP2FA::update\_plugin\_settings( $policies ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=2940688#L180) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922#L180) |  |
  | 180 | 180 | ?> |
  | 181 | 181 | <div class="danger-zone-wrapper"> |
  | 182 |  | <h3><?php esc\_html\_e( 'Do you want to delete the plugin data from the database upon uninstall~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 182 | <h3><?php esc\_html\_e( 'Do you want to delete the plugin data from the database upon uninstall', 'wp-2fa' ); ?></h3> |
  | 183 | 183 | <p class="description"> |
  | 184 | 184 | <?php esc\_html\_e( 'The plugin saves its settings in the WordPress database. By default the plugin settings are kept in the database so if it is installed again, you do not have to reconfigure the plugin. Enable this setting to delete the plugin settings from the database upon uninstall.', 'wp-2fa' ); ?> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=2940688#L218) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922#L218) |  |
  | 218 | 218 | ?> |
  | 219 | 219 | <br> |
  | 220 |  | <h3><?php esc\_html\_e( 'Limit 2FA settings access~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 220 | <h3><?php esc\_html\_e( 'Limit 2FA settings access', 'wp-2fa' ); ?></h3> |
  | 221 | 221 | <p class="description"> |
  | 222 | 222 | <?php esc\_html\_e( 'Use this setting to hide this plugin configuration area from all other admins.', 'wp-2fa' ); ?> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=2940688#L250) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922#L250) |  |
  | 250 | 250 | ?> |
  | 251 | 251 | <br> |
  | 252 |  | <h3><?php esc\_html\_e( 'Disable 2FA code brute force protection~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 252 | <h3><?php esc\_html\_e( 'Disable 2FA code brute force protection', 'wp-2fa' ); ?></h3> |
  | 253 | 253 | <p class="description"> |
  | 254 | 254 | <?php esc\_html\_e( 'When using email and SMS 2FA, the plugin sends the users a new one-time code whenever they enter the wrong code when logging in. This is a security enhancement, a sort of brute force protection. You can disable this feature from the below setting, however, it is not recommended.', 'wp-2fa' ); ?> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=2940688#L289) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-general.php?rev=3009922#L289) |  |
  | 289 | 289 | ?> |
  | 290 | 290 | </p> |
  | 291 |  | <h3><?php esc\_html\_e( 'What should the plugin do if the 2FA method used during a user login is unavailable~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 291 | <h3><?php esc\_html\_e( 'What should the plugin do if the 2FA method used during a user login is unavailable', 'wp-2fa' ); ?></h3> |
  | 292 | 292 | <p class="description"> |
  | 293 | 293 | <?php esc\_html\_e( 'There may be cases in which the 2FA service is unavailable when a user is trying to log in. For example, the service is unreachable or there are no credits to complete the action. In this case you can configure the plugin to either block the login process, or allow the user to log in without 2FA authentication.', 'wp-2fa' ); ?> |
* ## [wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L14 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L14 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 14 | 14 | namespace WP2FA\Admin\SettingsPages; |
  | 15 | 15 |  |
  | 16 |  | use WP2FA\Admin\Controllers\Settings; |
  | 17 |  | use WP2FA\Admin\Helpers\User\_Helper; |
  | 18 |  | use WP2FA\Admin\Helpers\WP\_Helper; |
  |  | 16 | use WP2FA\WP2FA; |
  |  | 17 | use WP2FA\Methods\TOTP; |
  |  | 18 | use WP2FA\Methods\Email; |
  |  | 19 | use WP2FA\Utils\Debugging; |
  | 19 | 20 | use WP2FA\Admin\Settings\_Page; |
  | 20 |  | ~~use WP2FA\Admin\Views\First\_Time\_Wizard\_Steps;~~ |
  | 21 |  | ~~use WP2FA\Utils\Debugging;~~ |
  | 22 | 21 | use WP2FA\Utils\Generate\_Modal; |
  | 23 | 22 | use WP2FA\Utils\Settings\_Utils; |
  | 24 |  | use WP2FA\WP2FA; |
  |  | 23 | use WP2FA\Admin\Helpers\WP\_Helper; |
  |  | 24 | use WP2FA\Admin\Helpers\User\_Helper; |
  |  | 25 | use WP2FA\Admin\Controllers\Settings; |
  |  | 26 | use WP2FA\Admin\Views\First\_Time\_Wizard\_Steps; |
  | 25 | 27 |  |
  | 26 | 28 | /\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L77) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L79) |  |
  | 77 | 79 | $new\_page\_modal\_content .= '</p>' . esc\_html\_\_( 'You are about to enforce 2FA instantly on all users, including yourself, however you have not yet configured your own 2FA method. What would you like to do?', 'wp-2fa' ) . '</p>'; |
  | 78 | 80 |  |
  | 79 |  | echo Generate\_Modal::generate\_modal( // phpcs:ignore |
  |  | 81 | echo Generate\_Modal::generate\_modal( // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 80 | 82 | 'exclude-self-from-instant-2fa', |
  | 81 | 83 | false, |
  | 82 |  | $new\_page\_modal\_content, |
  |  | 84 | $new\_page\_modal\_content, // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 83 | 85 | array( |
  | 84 |  | '<a href="#" class="wp-2fa-button-secondary button-secondary" data-close-2fa-modal>' . \_\_( 'Continue anyway', 'wp-2fa' ) . '</a>', |
  | 85 |  | '<a href="#" class="wp-2fa-button-primary button-primary" data-close-2fa-modal data-user-login-name="' . esc\_attr( $user->user\_login ) . '">' . \_\_( 'Exclude myself from 2FA policies', 'wp-2fa' ) . '</a>', |
  |  | 86 | '<a href="#" class="wp-2fa-button-secondary button-secondary" data-close-2fa-modal>' . \_\_( 'Continue anyway', 'wp-2fa' ) . '</a>', // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 87 | '<a href="#" class="wp-2fa-button-primary button-primary" data-close-2fa-modal data-user-login-name="' . esc\_attr( $user->user\_login ) . '">' . \_\_( 'Exclude myself from 2FA policies', 'wp-2fa' ) . '</a>', // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 86 | 88 | ), |
  | 87 | 89 | false, |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L195) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L197) |  |
  | 195 | 197 | $new\_page\_modal\_content .= '</p>'; |
  | 196 | 198 |  |
  | 197 |  | echo Generate\_Modal::generate\_modal( // phpcs:ignore |
  | 198 |  | 'new-page-created' . $role, |
  |  | 199 | echo Generate\_Modal::generate\_modal( // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 200 | 'new-page-created' . $role, // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 199 | 201 | false, |
  | 200 |  | $new\_page\_modal\_content, |
  |  | 202 | $new\_page\_modal\_content, // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 201 | 203 | array( |
  | 202 |  | '<a href="#" class="wp-2fa-button-primary button-primary" data-close-2fa-modal>' . \_\_( 'OK', 'wp-2fa' ) . '</a>', |
  |  | 204 | '<a href="#" class="wp-2fa-button-primary button-primary" data-close-2fa-modal>' . \_\_( 'OK', 'wp-2fa' ) . '</a>', // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 203 | 205 | ), |
  | 204 | 206 | true, |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L234) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L236) |  |
  | 234 | 236 |  |
  | 235 | 237 | $no\_method\_enabled = false; |
  | 236 |  | if ( ! isset( $input[~~'enable\_totp'] ) && ! isset( $input['enable\_email'~~] ) && ! isset( $\_POST['save\_step'] ) ) { |
  |  | 238 | if ( ! isset( $input[ TOTP::POLICY\_SETTINGS\_NAME ] ) && ! isset( $input[ Email::POLICY\_SETTINGS\_NAME ] ) && ! isset( $\_POST['save\_step'] ) ) { |
  | 237 | 239 | /\*\* |
  | 238 | 240 | \* At this point, none of the default providers is set / activated. This filter allows additional providers to change the behavior. Checking the input array for specific values (methods), and based on that we can raise error that none of the allowed methods has bees selected by the user, or dismiss the error otherwise. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L257) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L259) |  |
  | 257 | 259 |  |
  | 258 | 260 | $simple\_settings\_we\_can\_loop = array( |
  | 259 |  | ~~'enable\_totp',~~ |
  | 260 |  | ~~'enable\_email',~~ |
  | 261 |  | ~~'backup\_codes\_enabled',~~ |
  | 262 | 261 | 'grace-policy', |
  | 263 | 262 | 'enable\_destroy\_session', |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L269) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L268) |  |
  | 269 | 268 | 'superadmins-role-add', |
  | 270 | 269 | 'superadmins-role-exclude', |
  | 271 |  | ~~'specify-email\_hotp',~~ |
  | 272 | 270 | 'separate-multisite-page-url', |
  | 273 | 271 | ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L299) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L297) |  |
  | 299 | 297 | if ( ! in\_array( $simple\_setting, $settings\_to\_turn\_into\_bools, true ) ) { |
  | 300 | 298 | // Is item is not one of our possible settings we want to turn into a bool, process. |
  | 301 |  | $output[ $simple\_setting ] = ( isset( $input[ $simple\_setting ] ) && ! empty( $input[ $simple\_setting ] ) ) ? trim( sanitize\_text\_field( $input[ $simple\_setting ] ) ) : false; |
  |  | 299 | $output[ $simple\_setting ] = ( isset( $input[ $simple\_setting ] ) && ! empty( $input[ $simple\_setting ] ) ) ? trim( (string) sanitize\_text\_field( $input[ $simple\_setting ] ) ) : false; |
  | 302 | 300 | } else { |
  | 303 | 301 | // This item is one we treat as a bool, so process correctly. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L307) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L305) |  |
  | 307 | 305 |  |
  | 308 | 306 | if ( $no\_method\_enabled ) { |
  | 309 |  | ~~// No method is enabled, fall back to previous selected one - we don't want to break the logic.~~ |
  | 310 |  | ~~$totp\_enabled  = WP2FA::get\_wp2fa\_setting( 'enable\_totp' );~~ |
  | 311 |  | ~~$email\_enabled = WP2FA::get\_wp2fa\_setting( 'enable\_email' );~~ |
  | 312 |  |  |
  | 313 |  | ~~if ( $totp\_enabled ) {~~ |
  | 314 |  | ~~$output['enable\_totp'] = $totp\_enabled;~~ |
  | 315 |  | ~~}~~ |
  | 316 |  | ~~if ( $email\_enabled ) {~~ |
  | 317 |  | ~~$output['enable\_email'] = $email\_enabled;~~ |
  | 318 |  | ~~}~~ |
  | 319 |  |  |
  | 320 | 307 | /\*\* |
  | 321 | 308 | \* No methods are enabled - return the previous selection. Gives the ability for external providers to set the default values. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L386) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L373) |  |
  | 386 | 373 | if ( ( isset( $input['create-custom-user-page'] ) && 'yes' === $input['create-custom-user-page'] ) && isset( $input['custom-user-page-url'] ) && ! empty( $input['custom-user-page-url'] ) ) { |
  | 387 | 374 | if ( WP2FA::get\_wp2fa\_setting( 'custom-user-page-url' ) !== $input['custom-user-page-url'] ) { |
  | 388 |  | ~~// if ( ! empty( WP2FA::get\_wp2fa\_setting( 'custom-user-page-id' ) ) ) {~~ |
  | 389 |  | ~~// $updated\_post = array(~~ |
  | 390 |  | ~~// 'ID'        => WP2FA::get\_wp2fa\_setting( 'custom-user-page-id' ),~~ |
  | 391 |  | ~~// 'post\_name' => sanitize\_title\_with\_dashes( $input['custom-user-page-url'] ),~~ |
  | 392 |  | ~~// );~~ |
  | 393 |  | ~~// wp\_update\_post( $updated\_post );~~ |
  | 394 |  | ~~// $output['custom-user-page-url'] = sanitize\_title\_with\_dashes( $input['custom-user-page-url'] );~~ |
  | 395 |  | ~~// $output['custom-user-page-id']  = WP2FA::get\_wp2fa\_setting( 'custom-user-page-id' );~~ |
  | 396 |  | ~~// } else~~ |
  | 397 | 375 |  |
  | 398 | 376 | if ( 'yes' === $input['create-custom-user-page'] && ! empty( $input['custom-user-page-url'] ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L470) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L448) |  |
  | 470 | 448 | 'error' |
  | 471 | 449 | ); |
  |  | 450 |  |
  |  | 451 | $output['enforcement-policy'] = 'do-not-enforce'; |
  | 472 | 452 | } |
  | 473 | 453 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L525) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L505) |  |
  | 525 | 505 | } |
  | 526 | 506 |  |
  |  | 507 | /\*\* |
  |  | 508 | \* Allow extensions and 3rd party developers to change or check the settings array. |
  |  | 509 | \* |
  |  | 510 | \* @param array - Array with all the collected and validated data. |
  |  | 511 | \* |
  |  | 512 | \* @since 2.6.0 |
  |  | 513 | \*/ |
  |  | 514 | do\_action( WP\_2FA\_PREFIX . 'before\_settings\_save', $output ); |
  |  | 515 |  |
  | 527 | 516 | // WordPress saves the option to the database, but we still need to do some work when the settings are saved. |
  | 528 | 517 | WP2FA::update\_plugin\_settings( $output, true ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L533) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L522) |  |
  | 533 | 522 | Settings\_Utils::delete\_option( WP\_2FA\_PREFIX . 'default\_settings\_applied' ); |
  | 534 | 523 | Settings\_Utils::delete\_option( 'wizard\_not\_finished' ); |
  |  | 524 |  |
  |  | 525 | /\*\* |
  |  | 526 | \* Notify the extensions and 3rd party developers that the settings array is saved. |
  |  | 527 | \* |
  |  | 528 | \* @param array - Array with all the stored settings. |
  |  | 529 | \* |
  |  | 530 | \* @since 2.6.0 |
  |  | 531 | \*/ |
  |  | 532 | do\_action( WP\_2FA\_PREFIX . 'after\_settings\_save', Settings\_Utils::get\_option( WP\_2FA\_POLICY\_SETTINGS\_NAME, array() ) ); |
  | 535 | 533 |  |
  | 536 | 534 | return $output; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L761) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L759) |  |
  | 761 | 759 | value="separate-multisite-page-url" <?php checked( $separate\_multisite\_page, 'separate-multisite-page-url' ); ?> class="js-nested"> |
  | 762 | 760 | <label for="separate-multisite-page-url"><?php echo \esc\_html\_\_( 'Create User settings page separately for every site', 'wp-2fa' ); ?></label> |
  |  | 761 | <p class="description"><?php echo \esc\_html\_\_( 'When you enable this setting a page with the same slug is created on each site on the network, so the users of each sub site can use this page on their website to configure 2FA.', 'wp-2fa' ); ?></p> |
  | 763 | 762 | </fieldset> |
  | 764 | 763 | </td> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L807) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L806) |  |
  | 807 | 806 | ob\_start(); |
  | 808 | 807 | ?> |
  | 809 |  | <h3><?php esc\_html\_e( 'Do you want to redirect the user to a specific page after completing the 2FA setup wizard~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 808 | <h3><?php esc\_html\_e( 'Do you want to redirect the user to a specific page after completing the 2FA setup wizard', 'wp-2fa' ); ?></h3> |
  | 810 | 809 | <p class="description"> |
  | 811 | 810 | <?php esc\_html\_e( 'Specify a URL of a page where you want to redirect the users once they complete the 2FA setup wizard. Leave empty for default behaviour, in which users are redirected back to the page from where they launched the wizard.', 'wp-2fa' ); ?></a> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L886) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L885) |  |
  | 886 | 885 | \* @since 2.0.0 |
  | 887 | 886 | \*/ |
  | 888 |  | echo \apply\_filters( WP\_2FA\_PREFIX . 'before\_grace\_period\_settings', '', '', 'wp\_2fa\_policy' ); |
  |  | 887 | echo \apply\_filters( WP\_2FA\_PREFIX . 'before\_grace\_period\_settings', '', '', 'wp\_2fa\_policy' ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 889 | 888 |  |
  | 890 | 889 | ?> |
  | 891 | 890 | <br> |
  | 892 |  | <h3><?php esc\_html\_e( 'Should users be asked to setup 2FA instantly or should they have a grace period~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 891 | <h3><?php esc\_html\_e( 'Should users be asked to setup 2FA instantly or should they have a grace period', 'wp-2fa' ); ?></h3> |
  | 893 | 892 | <p class="description"> |
  | 894 | 893 | <?php esc\_html\_e( 'When you enforce 2FA on users they have a grace period to configure 2FA. If they fail to configure it within the configured stipulated time, their account will be locked and have to be unlocked manually. Note that user accounts cannot be unlocked automatically, even if you change the settings. As a security precaution they always have to be unlocked them manually. Maximum grace period is 10 days.', 'wp-2fa' ); ?> <a href="https://melapress.com/support/kb/configure-grace-period-2fa/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank"><?php esc\_html\_e( 'Learn more.', 'wp-2fa' ); ?></a> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=2940688#L931) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-policies.php?rev=3009922#L930) |  |
  | 931 | 930 | ?> |
  | 932 | 931 | <br> |
  | 933 |  | <h3><?php esc\_html\_e( 'Should users be able to disable 2FA on their user profile~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 932 | <h3><?php esc\_html\_e( 'Should users be able to disable 2FA on their user profile', 'wp-2fa' ); ?></h3> |
  | 934 | 933 | <p class="description"> |
  | 935 | 934 | <?php esc\_html\_e( 'Users can configure and also disable 2FA on their profile by clicking the "Remove 2FA" button. Enable this setting to disable the Remove 2FA button so users cannot disable 2FA from their user profile.', 'wp-2fa' ); ?> |
* ## [wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-render.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-render.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-render.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-render.php?rev=2940688#L36 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-render.php?rev=3009922#L36 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 36 | 36 | if ( ! empty( WP2FA::get\_wp2fa\_setting( '2fa\_settings\_last\_updated\_by' ) ) ) { |
  | 37 | 37 | $main\_user = (int) WP2FA::get\_wp2fa\_setting( '2fa\_settings\_last\_updated\_by' ); |
  | 38 |  | } |
  |  | 38 | } |
  | 39 | 39 | ?> |
  | 40 | 40 |  |
* ## [wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L12 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L12 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | namespace WP2FA\Admin\SettingsPages; |
  | 13 | 13 |  |
  | 14 |  | use ~~\~~WP2FA\WP2FA; |
  |  | 14 | use WP2FA\WP2FA; |
  | 15 | 15 | use WP2FA\Utils\Debugging; |
  | 16 | 16 | use WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L60) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L60) |  |
  | 60 | 60 | $output['default-text-code-page'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'default-text-code-page', false, false ); |
  | 61 | 61 |  |
  | 62 |  | if ( isset( $input['default-text-code-page'] ) && '' !== trim( $input['default-text-code-page'] ) ) { |
  |  | 62 | if ( isset( $input['default-text-code-page'] ) && '' !== trim( (string) $input['default-text-code-page'] ) ) { |
  | 63 | 63 | $output['default-text-code-page'] = \wp\_kses\_post( $input['default-text-code-page'] ); |
  | 64 | 64 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L66) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L66) |  |
  | 66 | 66 | $output['default-backup-code-page'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'default-backup-code-page', false, false ); |
  | 67 | 67 |  |
  | 68 |  | if ( isset( $input['default-backup-code-page'] ) && '' !== trim( $input['default-backup-code-page'] ) ) { |
  |  | 68 | if ( isset( $input['default-backup-code-page'] ) && '' !== trim( (string) $input['default-backup-code-page'] ) ) { |
  | 69 | 69 | $output['default-backup-code-page'] = \wp\_strip\_all\_tags( $input['default-backup-code-page'] ); |
  |  | 70 | } |
  |  | 71 |  |
  |  | 72 | $output['use\_custom\_2fa\_message'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'use\_custom\_2fa\_message', false, false ); |
  |  | 73 |  |
  |  | 74 | if ( isset( $input['use\_custom\_2fa\_message'] ) && '' !== trim( (string) $input['use\_custom\_2fa\_message'] ) ) { |
  |  | 75 | $output['use\_custom\_2fa\_message'] = \wp\_strip\_all\_tags( $input['use\_custom\_2fa\_message'] ); |
  |  | 76 | } |
  |  | 77 |  |
  |  | 78 | $output['custom-text-app-code-page'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'custom-text-app-code-page', false, false ); |
  |  | 79 | $output['custom-text-email-code-page'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'custom-text-email-code-page', false, false ); |
  |  | 80 | $output['custom-text-authy-code-page-intro'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'custom-text-authy-code-page-intro', false, false ); |
  |  | 81 | $output['custom-text-authy-code-page-awaiting'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'custom-text-authy-code-page-awaiting', false, false ); |
  |  | 82 | $output['custom-text-authy-code-page'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'custom-text-authy-code-page', false, false ); |
  |  | 83 | $output['custom-text-twilio-code-page'] = WP2FA::get\_wp2fa\_white\_label\_setting( 'custom-text-twilio-code-page', false, false ); |
  |  | 84 |  |
  |  | 85 | if ( isset( $input['custom-text-app-code-page'] ) && '' !== trim( (string) $input['custom-text-app-code-page'] ) ) { |
  |  | 86 | $output['custom-text-app-code-page'] = \wp\_strip\_all\_tags( $input['custom-text-app-code-page'] ); |
  |  | 87 | } |
  |  | 88 |  |
  |  | 89 | if ( isset( $input['custom-text-email-code-page'] ) && '' !== trim( (string) $input['custom-text-email-code-page'] ) ) { |
  |  | 90 | $output['custom-text-email-code-page'] = \wp\_strip\_all\_tags( $input['custom-text-email-code-page'] ); |
  |  | 91 | } |
  |  | 92 |  |
  |  | 93 | if ( isset( $input['custom-text-authy-code-page'] ) && '' !== trim( (string) $input['custom-text-authy-code-page'] ) ) { |
  |  | 94 | $output['custom-text-authy-code-page'] = \wp\_strip\_all\_tags( $input['custom-text-authy-code-page'] ); |
  |  | 95 | } |
  |  | 96 |  |
  |  | 97 | if ( isset( $input['custom-text-authy-code-page-intro'] ) && '' !== trim( (string) $input['custom-text-authy-code-page-intro'] ) ) { |
  |  | 98 | $output['custom-text-authy-code-page-intro'] = \wp\_strip\_all\_tags( $input['custom-text-authy-code-page-intro'] ); |
  |  | 99 | } |
  |  | 100 |  |
  |  | 101 | if ( isset( $input['custom-text-authy-code-page-awaiting'] ) && '' !== trim( (string) $input['custom-text-authy-code-page-awaiting'] ) ) { |
  |  | 102 | $output['custom-text-authy-code-page-awaiting'] = \wp\_strip\_all\_tags( $input['custom-text-authy-code-page-awaiting'] ); |
  |  | 103 | } |
  |  | 104 |  |
  |  | 105 | if ( isset( $input['custom-text-twilio-code-page'] ) && '' !== trim( (string) $input['custom-text-twilio-code-page'] ) ) { |
  |  | 106 | $output['custom-text-twilio-code-page'] = \wp\_strip\_all\_tags( $input['custom-text-twilio-code-page'] ); |
  | 70 | 107 | } |
  | 71 | 108 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L75) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L112) |  |
  | 75 | 112 |  |
  | 76 | 113 | // If we have the input POSTed, we are on the right page so grab it. |
  | 77 |  | if ( isset( $input['enable\_wizard\_styling'] ) && '' !== trim( $input['enable\_wizard\_styling'] ) ) { |
  |  | 114 | if ( isset( $input['enable\_wizard\_styling'] ) && '' !== trim( (string) $input['enable\_wizard\_styling'] ) ) { |
  | 78 | 115 | $output['enable\_wizard\_styling'] = \wp\_strip\_all\_tags( $input['enable\_wizard\_styling'] ); |
  | 79 | 116 | } else { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L85) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L122) |  |
  | 85 | 122 | $output['enable\_wizard\_styling'] = ''; |
  | 86 | 123 | $input['enable\_wizard\_styling']  = ''; |
  | 87 |  |  |
  | 88 | 124 | } |
  | 89 | 125 | } |
  | 90 | 126 |  |
  | 91 |  | if ( isset( $input['show\_help\_text'] ) && '' !== trim( $input['show\_help\_text'] ) ) { |
  |  | 127 | if ( isset( $input['show\_help\_text'] ) && '' !== trim( (string) $input['show\_help\_text'] ) ) { |
  | 92 | 128 | $output['show\_help\_text'] = \wp\_strip\_all\_tags( $input['show\_help\_text'] ); |
  | 93 | 129 | } else { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L103) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L139) |  |
  | 103 | 139 |  |
  | 104 | 140 | // Same as above, but for the optional welcome. |
  | 105 |  | if ( isset( $input['enable\_welcome'] ) && '' !== trim( $input['enable\_welcome'] ) ) { |
  |  | 141 | if ( isset( $input['enable\_welcome'] ) && '' !== trim( (string) $input['enable\_welcome'] ) ) { |
  | 106 | 142 | $output['enable\_welcome'] = \wp\_strip\_all\_tags( $input['enable\_welcome'] ); |
  | 107 | 143 | } elseif ( strpos( $request\_area['query'], 'white-label-sub-section' ) && strpos( $request\_area['query'], 'welcome' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L113) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L149) |  |
  | 113 | 149 | } |
  | 114 | 150 |  |
  | 115 |  | if ( isset( $input['enable\_wizard\_logo'] ) && '' !== trim( $input['enable\_wizard\_logo'] ) ) { |
  |  | 151 | if ( isset( $input['enable\_wizard\_logo'] ) && '' !== trim( (string) $input['enable\_wizard\_logo'] ) ) { |
  | 116 | 152 | $output['enable\_wizard\_logo'] = \wp\_strip\_all\_tags( $input['enable\_wizard\_logo'] ); |
  | 117 | 153 | } elseif ( strpos( $request\_area['query'], 'white-label-sub-section' ) && strpos( $request\_area['query'], 'welcome' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L242) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L278) |  |
  | 242 | 278 | do\_action( WP\_2FA\_PREFIX . 'white\_labeling\_settings\_page\_before\_default\_text' ); |
  | 243 | 279 | ?> |
  | 244 |  |  |
  | 245 |  | <?php |
  | 246 |  | /\* @free:start \*/ |
  | 247 |  | ?> |
  | 248 |  | <h3><?php esc\_html\_e( 'Change the styling of the user 2FA wizards?', 'wp-2fa' ); ?></h3> |
  | 249 |  | <p class="description"> |
  | 250 |  | <?php esc\_html\_e( 'By default, the user 2FA wizards which the users see and use to set up 2FA have our own styling. Disable the below setting so the wizards use the styling of your website\'s theme.', 'wp-2fa' ); ?> |
  | 251 |  | </p> |
  | 252 |  | <table class="form-table"> |
  | 253 |  | <tbody> |
  | 254 |  | <tr> |
  | 255 |  | <th><label for="enable\_wizard\_styling"><?php esc\_html\_e( 'Enable styling', 'wp-2fa' ); ?></label></th> |
  | 256 |  | <td> |
  | 257 |  | <fieldset> |
  | 258 |  | <input type="checkbox" id="enable\_wizard\_styling" name="wp\_2fa\_white\_label[enable\_wizard\_styling]" value="enable\_wizard\_styling" |
  | 259 |  | <?php checked( 'enable\_wizard\_styling', WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_styling' ), true ); ?> |
  | 260 |  | > |
  | 261 |  | <?php esc\_html\_e( 'Enable our CSS within user wizards', 'wp-2fa' ); ?> |
  | 262 |  | </fieldset> |
  | 263 |  | </td> |
  | 264 |  | </tr> |
  | 265 |  | </tbody> |
  | 266 |  | </table> |
  | 267 |  | <?php |
  | 268 |  | /\* @free:end \*/ |
  | 269 |  | ?> |
  | 270 |  |  |
  | 271 |  | <h3><?php esc\_html\_e( 'Change the default text used in the 2FA code page?', 'wp-2fa' ); ?></h3> |
  |  | 280 |  |
  |  | 281 | <?php if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { ?> |
  |  | 282 | <h3><?php esc\_html\_e( '2FA code page text', 'wp-2fa' ); ?></h3> |
  |  | 283 | <p class="description"> |
  |  | 284 | <?php esc\_html\_e( 'Use these settings to customize message shown to users upon login when a 2FA verification code is requested.', 'wp-2fa' ); ?> |
  |  | 285 | </p> |
  |  | 286 | <table class="form-table"> |
  |  | 287 | <tbody> |
  |  | 288 | <tr> |
  |  | 289 | <th><label for="2fa-method"><?php esc\_html\_e( 'Customize code page text', 'wp-2fa' ); ?></label> |
  |  | 290 | </th> |
  |  | 291 | <td> |
  |  | 292 | <fieldset class="contains-hidden-inputs"> |
  |  | 293 | <label for="use-defaults"> |
  |  | 294 | <input type="radio" name="wp\_2fa\_white\_label[use\_custom\_2fa\_message]" id="use-defaults" value="use-defaults" |
  |  | 295 | <?php checked( WP2FA::get\_wp2fa\_white\_label\_setting( 'use\_custom\_2fa\_message' ), 'use-defaults' ); ?> |
  |  | 296 | > |
  |  | 297 | <span><?php esc\_html\_e( 'Show this generic message to all users regardless of the 2FA method they are using.', 'wp-2fa' ); ?></span> |
  |  | 298 | </label> |
  |  | 299 |  |
  |  | 300 | <br/> |
  |  | 301 | <label for="use-custom"> |
  |  | 302 | <input type="radio" name="wp\_2fa\_white\_label[use\_custom\_2fa\_message]" id="use-custom" value="use-custom" |
  |  | 303 | <?php checked( WP2FA::get\_wp2fa\_white\_label\_setting( 'use\_custom\_2fa\_message' ), 'use-custom' ); ?> |
  |  | 304 | data-unhide-when-checked=".custom-from-inputs"> |
  |  | 305 | <span><?php esc\_html\_e( 'Show a message that is specific to the method that the user is using.', 'wp-2fa' ); ?></span> |
  |  | 306 | </label> |
  |  | 307 |  |
  |  | 308 | <fieldset class="hidden custom-from-inputs"> |
  |  | 309 | <p class="description"> |
  |  | 310 | <?php esc\_html\_e( '2FA via app', 'wp-2fa' ); ?> |
  |  | 311 | </p> |
  |  | 312 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'custom-text-app-code-page' ); ?> |
  |  | 313 | <br/> |
  |  | 314 |  |
  |  | 315 | <p class="description"> |
  |  | 316 | <?php esc\_html\_e( '2FA code over email', 'wp-2fa' ); ?> |
  |  | 317 | </p> |
  |  | 318 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'custom-text-email-code-page' ); ?> |
  |  | 319 | <br/> |
  |  | 320 |  |
  |  | 321 | <p class="description"> |
  |  | 322 | <?php esc\_html\_e( '2FA link over email', 'wp-2fa' ); ?> |
  |  | 323 | </p> |
  |  | 324 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'default-text-oob-page' ); ?> |
  |  | 325 | <br/> |
  |  | 326 |  |
  |  | 327 | <p class="description"> |
  |  | 328 | <?php esc\_html\_e( '2FA code over SMS', 'wp-2fa' ); ?> |
  |  | 329 | </p> |
  |  | 330 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'custom-text-twilio-code-page' ); ?> |
  |  | 331 | <br/> |
  |  | 332 |  |
  |  | 333 | <p class="description"> |
  |  | 334 | <?php esc\_html\_e( '2FA with Push Notification - Intro', 'wp-2fa' ); ?> |
  |  | 335 | </p> |
  |  | 336 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'custom-text-authy-code-page-intro' ); ?> |
  |  | 337 | <br/> |
  |  | 338 |  |
  |  | 339 | <p class="description"> |
  |  | 340 | <?php esc\_html\_e( '2FA with Push Notification - Awaiting Response', 'wp-2fa' ); ?> |
  |  | 341 | </p> |
  |  | 342 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'custom-text-authy-code-page-awaiting' ); ?> |
  |  | 343 | <br/> |
  |  | 344 |  |
  |  | 345 | <p class="description"> |
  |  | 346 | <?php esc\_html\_e( '2FA with Push Notification', 'wp-2fa' ); ?> |
  |  | 347 | </p> |
  |  | 348 | <?php echo White\_Labeling\_Render::get\_method\_text\_editor( 'custom-text-authy-code-page' ); ?> |
  |  | 349 | <br/> |
  |  | 350 | </fieldset> |
  |  | 351 |  |
  |  | 352 | </fieldset> |
  |  | 353 | </td> |
  |  | 354 | </tr> |
  |  | 355 | </tbody> |
  |  | 356 | </table> |
  |  | 357 | <?php } ?> |
  |  | 358 |  |
  |  | 359 | <h3><?php esc\_html\_e( 'Change the default text used in the 2FA code page', 'wp-2fa' ); ?></h3> |
  | 272 | 360 | <p class="description"> |
  | 273 | 361 | <?php esc\_html\_e( 'This is the text shown to the users on the page when they are asked to enter the 2FA code. To change the default text, simply type it in the below placeholder.', 'wp-2fa' ); ?> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L279) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L367) |  |
  | 279 | 367 | <th><label for="2fa-method"><?php esc\_html\_e( '2FA code page text', 'wp-2fa' ); ?></label></th> |
  | 280 | 368 | <td> |
  | 281 |  | <?php if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { |
  |  | 369 | <?php |
  |  | 370 | if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { |
  | 282 | 371 | echo White\_Labeling\_Render::get\_method\_text\_editor( 'default-text-code-page' ); // phpcs:ignore |
  | 283 |  | } else {~~?>~~ |
  | 284 |  | ~~<textarea cols="70" rows="10" name="wp\_2fa\_white\_label[default-text-code-page]" id="default-text-code-page"><?php echo \esc\_html( WP2FA::get\_wp2fa\_white\_label\_setting( 'default-text-code-page', true ) ); ?></textarea>~~ |
  | 285 |  | ~~<?php~~ } ?> |
  |  | 372 | } else { |
  |  | 373 | echo self::create\_standard\_editor( WP2FA::get\_wp2fa\_white\_label\_setting( 'default-text-code-page', true ), 'default-text-code-page' ); |
  |  | 374 | } ?> |
  | 286 | 375 | <div style="margin-top: 5px;"><span><strong><i><?php esc\_html\_e( 'Note:', 'wp-2fa' ); ?></i></strong> <?php esc\_html\_e( 'Only plain text is allowed.', 'wp-2fa' ); ?></span></div> |
  | 287 | 376 | </td> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L290) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L379) |  |
  | 290 | 379 | <th><label for="backup-method"><?php esc\_html\_e( 'Backup code page text', 'wp-2fa' ); ?></label></th> |
  | 291 | 380 | <td> |
  | 292 |  | <?php if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { |
  |  | 381 | <?php |
  |  | 382 | if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { |
  | 293 | 383 | echo White\_Labeling\_Render::get\_method\_text\_editor( 'default-backup-code-page' ); // phpcs:ignore |
  | 294 |  | } else { ~~?>~~ |
  | 295 |  | ~~<textarea cols="70" rows="10" name="wp\_2fa\_white\_label[default-backup-code-page]" id="default-backup-code-page"><?php echo \esc\_html( WP2FA::get\_wp2fa\_white\_label\_setting( 'default-backup-code-page', true ) ); ?></textarea>~~ |
  | 296 |  | ~~<?php~~ } ?> |
  |  | 384 | } else { |
  |  | 385 | echo self::create\_standard\_editor( WP2FA::get\_wp2fa\_white\_label\_setting( 'default-backup-code-page', true ), 'default-backup-code-page' ); |
  |  | 386 | } ?> |
  | 297 | 387 | <div style="margin-top: 5px;"><span><strong><i><?php esc\_html\_e( 'Note:', 'wp-2fa' ); ?></i></strong> <?php esc\_html\_e( 'Only plain text is allowed.', 'wp-2fa' ); ?></span></div> |
  | 298 | 388 | </td> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L302) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L392) |  |
  | 302 | 392 | <th><label for="backup-method"><?php esc\_html\_e( 'Text for logged out users trying to access the 2FA configuration page', 'wp-2fa' ); ?></label></th> |
  | 303 | 393 | <td> |
  | 304 |  | <?php if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { |
  |  | 394 | <?php |
  |  | 395 | if ( class\_exists( 'WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render' ) ) { |
  | 305 | 396 | echo White\_Labeling\_Render::get\_method\_text\_editor( 'login-to-view-area' ); // phpcs:ignore |
  | 306 |  | } else {~~?>~~ |
  | 307 |  | ~~<textarea cols="70" rows="10" name="wp\_2fa\_white\_label[login-to-view-area]" id="login-to-view-area"><?php echo \esc\_html( WP2FA::get\_wp2fa\_white\_label\_setting( 'login-to-view-area', true ) ); ?></textarea>~~ |
  | 308 |  | ~~<?php~~ } ?> |
  |  | 397 | } else { |
  |  | 398 | echo self::create\_standard\_editor( WP2FA::get\_wp2fa\_white\_label\_setting( 'login-to-view-area', true ), 'login-to-view-area' ); |
  |  | 399 | } ?> |
  | 309 | 400 | </td> |
  | 310 | 401 | </tr> |
  |  | 402 |  |
  | 311 | 403 | <?php |
  | 312 | 404 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L317) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L409) |  |
  | 317 | 409 | </tbody> |
  | 318 | 410 | </table> |
  |  | 411 |  |
  |  | 412 | <?php |
  |  | 413 | /\* @free:start \*/ |
  |  | 414 | ?> |
  |  | 415 | <h3><?php esc\_html\_e( 'Change the styling of the user 2FA wizards', 'wp-2fa' ); ?></h3> |
  |  | 416 | <p class="description"> |
  |  | 417 | <?php esc\_html\_e( 'By default, the user 2FA wizards which the users see and use to set up 2FA have our own styling. Disable the below setting so the wizards use the styling of your website\'s theme.', 'wp-2fa' ); ?> |
  |  | 418 | </p> |
  |  | 419 | <table class="form-table"> |
  |  | 420 | <tbody> |
  |  | 421 | <tr> |
  |  | 422 | <th><label for="enable\_wizard\_styling"><?php esc\_html\_e( 'Enable styling', 'wp-2fa' ); ?></label></th> |
  |  | 423 | <td> |
  |  | 424 | <fieldset> |
  |  | 425 | <input type="checkbox" id="enable\_wizard\_styling" name="wp\_2fa\_white\_label[enable\_wizard\_styling]" value="enable\_wizard\_styling" |
  |  | 426 | <?php checked( 'enable\_wizard\_styling', WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_styling' ), true ); ?> |
  |  | 427 | > |
  |  | 428 | <?php esc\_html\_e( 'Enable our CSS within user wizards', 'wp-2fa' ); ?> |
  |  | 429 | </fieldset> |
  |  | 430 | </td> |
  |  | 431 | </tr> |
  |  | 432 | </tbody> |
  |  | 433 | </table> |
  |  | 434 | <?php |
  |  | 435 | /\* @free:end \*/ |
  |  | 436 | ?> |
  |  | 437 |  |
  | 319 | 438 | <?php |
  | 320 | 439 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=2940688#L325) | […](/browser/wp-2fa/trunk/includes/classes/Admin/SettingsPages/class-settings-page-white-label.php?rev=3009922#L444) |  |
  | 325 | 444 | do\_action( WP\_2FA\_PREFIX . 'white\_labeling\_settings\_page\_after\_default\_text' ); |
  | 326 | 445 | } |
  |  | 446 |  |
  |  | 447 | /\*\* |
  |  | 448 | \* Simple function to create a neat text editor in free. |
  |  | 449 | \* |
  |  | 450 | \* @param string $content |
  |  | 451 | \* @param string $requested\_slide |
  |  | 452 | \* @return void |
  |  | 453 | \*/ |
  |  | 454 | private static function create\_standard\_editor( $content, $requested\_slide ) { |
  |  | 455 | $settings = array( |
  |  | 456 | 'media\_buttons' => false, |
  |  | 457 | 'editor\_height' => 200, |
  |  | 458 | 'textarea\_name' => 'wp\_2fa\_white\_label[' . $requested\_slide . ']', |
  |  | 459 | ); |
  |  | 460 |  |
  |  | 461 | if ( isset( $content ) ) { |
  |  | 462 | wp\_editor( $content, $requested\_slide, $settings ); |
  |  | 463 | } |
  |  | 464 | } |
  | 327 | 465 | } |
  | 328 | 466 | } |
* ## [wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L5 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L5 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* @package    wp2fa |
  | 6 | 6 | \* @subpackage views |
  |  | 7 | \* @since      1.7.0 |
  | 7 | 8 | \* @copyright  %%YEAR%% Melapress |
  | 8 | 9 | \* @license    https://www.apache.org/licenses/LICENSE-2.0 Apache License 2.0 |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L13) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L14) |  |
  | 13 | 14 |  |
  | 14 | 15 | use WP2FA\WP2FA; |
  |  | 16 | use WP2FA\Methods\Backup\_Codes; |
  | 15 | 17 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 16 | 18 | use WP2FA\Admin\Controllers\Settings; |
  |  | 19 | use WP2FA\Methods\TOTP; |
  | 17 | 20 |  |
  | 18 | 21 | defined( 'ABSPATH' ) || exit; // Exit if accessed directly. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L39) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L42) |  |
  | 39 | 42 | ob\_start(); |
  | 40 | 43 | ?> |
  | 41 |  | <h3><?php esc\_html\_e( 'Which 2FA methods can your users use?', 'wp-2fa' ); ?></h3> |
  | 42 |  | <p class="description"> |
  | 43 |  | <?php esc\_html\_e( 'When you uncheck any of the below 2FA methods it won\'t be available for your users to use. You can always change this later on from the plugin\'s settings.', 'wp-2fa' ); ?> |
  | 44 |  | </p> |
  | 45 |  | <?php |
  | 46 |  | $data\_role = 'data-role="global"'; |
  | 47 |  | if ( ! $setup\_wizard ) { |
  | 48 |  | ?> |
  | 49 |  | <table class="form-table"> |
  | 50 |  | <tbody> |
  | 51 |  | <tr> |
  | 52 |  | <th colspan="2"><?php esc\_html\_e( 'Which of the below 2FA methods can users use?', 'wp-2fa' ); ?></th> |
  | 53 |  | </tr> |
  | 54 |  | <tr> |
  | 55 |  | <th><label for="2fa-method"><?php esc\_html\_e( 'Select the methods', 'wp-2fa' ); ?></label></th> |
  | 56 |  | <td> |
  | 57 |  | <?php } ?> |
  | 58 |  | <fieldset id="2fa-method-select" class="2fa-method-select"> |
  | 59 |  | <div class="method-title"><em><?php esc\_html\_e( 'Primary 2FA methods:', 'wp-2fa' ); ?></em></div> |
  | 60 |  | <br> |
  | 61 |  | <label for="totp"> |
  | 62 |  | <input type="checkbox" id="totp" name="wp\_2fa\_policy[enable\_totp]" value="enable\_totp" |
  | 63 |  | <?php echo $data\_role; // phpcs:ignore ?> |
  | 64 |  | <?php checked( 'enable\_totp', WP2FA::get\_wp2fa\_setting( 'enable\_totp' ), true ); ?> |
  | 65 |  | > |
  | 66 |  | <?php esc\_html\_e( 'One-time code via 2FA App (TOTP)', 'wp-2fa' ); ?> |
  | 67 |  | </label> |
  | 68 |  |  |
  | 69 |  | <?php |
  | 70 |  | if ( $setup\_wizard ) { |
  | 71 |  | echo '<p class="description">'; |
  | 72 |  | printf( |
  | 73 |  | /\* translators: link to the knowledge base website \*/ |
  | 74 |  | esc\_html\_\_( 'When using this method, users will need to configure a 2FA app to get the one-time login code. The plugin supports all standard 2FA apps. Refer to the %s for more information. Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone.', 'wp-2fa' ), |
  | 75 |  | '<a href="https://melapress.com/support/kb/wp-2fa-configuring-2fa-apps/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">' . esc\_html\_\_( 'guide on how to set up 2FA apps', 'wp-2fa' ) . '</a>' |
  | 76 |  | ); |
  | 77 |  | echo '</p>'; |
  | 78 |  | } |
  | 79 |  | ?> |
  |  | 44 | <h3><?php esc\_html\_e( 'Which 2FA methods can your users use?', 'wp-2fa' ); ?></h3> |
  |  | 45 | <p class="description"> |
  |  | 46 | <?php esc\_html\_e( 'When you uncheck any of the below 2FA methods it won\'t be available for your users to use. You can always change this later on from the plugin\'s settings.', 'wp-2fa' ); ?> |
  |  | 47 | </p> |
  |  | 48 | <?php |
  |  | 49 | $data\_role = 'data-role="global"'; |
  |  | 50 | if ( ! $setup\_wizard ) { |
  |  | 51 | ?> |
  |  | 52 | <table class="form-table"> |
  |  | 53 | <tbody> |
  |  | 54 | <tr> |
  |  | 55 | <th colspan="2"><?php esc\_html\_e( 'Which of the below 2FA methods can users use?', 'wp-2fa' ); ?></th> |
  |  | 56 | </tr> |
  |  | 57 | <tr> |
  |  | 58 | <th><label for="2fa-method"><?php esc\_html\_e( 'Select the methods', 'wp-2fa' ); ?></label></th> |
  |  | 59 | <td> |
  |  | 60 | <?php } ?> |
  |  | 61 | <fieldset id="2fa-method-select" class="wp-2fa-method-select"> |
  |  | 62 | <p class="method-title" style="padding-bottom: 20px;"><em><?php esc\_html\_e( 'Primary 2FA methods:', 'wp-2fa' ); ?></em></p> |
  | 80 | 63 | <?php |
  | 81 | 64 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L88) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L71) |  |
  | 88 | 71 | \* @since 2.0.0 |
  | 89 | 72 | \*/ |
  | 90 |  | \do\_action( WP\_2FA\_PREFIX . '~~after\_totp~~\_setup', $setup\_wizard, $data\_role, null ); |
  |  | 73 | \do\_action( WP\_2FA\_PREFIX . 'methods\_setup', $setup\_wizard, $data\_role, null ); |
  | 91 | 74 | ?> |
  | 92 |  | ~~<br/>~~ |
  | 93 |  | ~~<label for="hotp">~~ |
  | 94 |  | ~~<input type="checkbox" id="hotp" name="wp\_2fa\_policy[enable\_email]" value="enable\_email"~~ |
  | 95 |  | ~~<?php echo $data\_role; // phpcs:ignore ?>~~ |
  | 96 |  | ~~<?php checked( WP2FA::get\_wp2fa\_setting( 'enable\_email' ), 'enable\_email' ); ?>~~ |
  | 97 |  | ~~>~~ |
  | 98 |  | ~~<?php~~ |
  | 99 |  | ~~esc\_html\_e( 'One-time code via email (HOTP)', 'wp-2fa' );~~ |
  | 100 |  | ~~esc\_html\_e( ' - ensure email deliverability with the free plugin ', 'wp-2fa' );~~ |
  | 101 |  | ~~echo '<a href="https://wordpress.org/plugins/wp-mail-smtp/" target="\_blank" rel="nofollow">WP Mail SMTP</a>.';~~ |
  | 102 |  | ~~?>~~ |
  | 103 |  | ~~<?php~~ |
  | 104 |  | ~~?>~~ |
  | 105 |  | ~~</label>~~ |
  | 106 |  | ~~<?php~~ |
  | 107 |  | ~~if ( $setup\_wizard ) {~~ |
  | 108 |  | ~~echo '<p class="description">' . esc\_html\_\_( 'When using this method, users will receive the one-time login code over email. Therefore, email deliverability is very important. Users using this method should whitelist the address from which the codes are sent. By default, this is the email address configured in your WordPress. You can run an email test from the plugin\'s settings to confirm email deliverability. If you have had email deliverability / reliability issues, we highly recommend you to install the free plugin ', 'wp-2fa' ) . '<a href="https://wordpress.org/plugins/wp-mail-smtp/" target="\_blank" rel="nofollow">WP Mail SMTP</a><br><br>' . esc\_html\_\_( 'Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone.', 'wp-2fa' ) . '</p>';~~ |
  | 109 |  | ~~}~~ |
  | 110 |  | ~~?>~~ |
  | 111 |  | ~~<?php if ( ! $setup\_wizard ) { ?>~~ |
  | 112 |  | ~~<div class="use-different-hotp-mail<?php echo \esc\_attr( ( false === WP2FA::get\_wp2fa\_setting( 'enable\_email' ) ? ' disabled' : '' ) ); ?>">~~ |
  | 113 |  | ~~<p class="description" style="margin-bottom: 5px; font-style: normal;">~~ |
  | 114 |  | ~~<?php esc\_html\_e( 'Allow user to specify the email address of choice', 'wp-2fa' ); ?>~~ |
  | 115 |  | ~~</p>~~ |
  | 116 |  | ~~<fieldset class="email-hotp-options">~~ |
  | 117 |  | ~~<?php~~ |
  | 118 |  | ~~$options = array(~~ |
  | 119 |  | ~~'yes' => array(~~ |
  | 120 |  | ~~'label' => esc\_html\_\_( 'Yes', 'wp-2fa' ),~~ |
  | 121 |  | ~~'value' => 'specify-email\_hotp',~~ |
  | 122 |  | ~~),~~ |
  | 123 |  | ~~'no'  => array(~~ |
  | 124 |  | ~~'label' => esc\_html\_\_( 'No', 'wp-2fa' ),~~ |
  | 125 |  | ~~'value' => '',~~ |
  | 126 |  | ~~),~~ |
  | 127 |  | ~~);~~ |
  | 128 |  |  |
  | 129 |  | ~~foreach ( $options as $option\_key => $option\_settings ) {~~ |
  | 130 |  | ~~?>~~ |
  | 131 |  | ~~<label for="specify-email\_hotp-<?php echo \esc\_attr( $option\_key ); ?>">~~ |
  | 132 |  | ~~<input type="radio" name="wp\_2fa\_policy[specify-email\_hotp]" id="specify-email\_hotp-<?php echo \esc\_attr( $option\_key ); ?>" value="<?php echo \esc\_attr( $option\_settings['value'] ); ?>" class="js-nested"~~ |
  | 133 |  | ~~<?php checked( Settings::get\_role\_or\_default\_setting( 'specify-email\_hotp', null ), $option\_settings['value'] ); ?>~~ |
  | 134 |  | ~~>~~ |
  | 135 |  | ~~<span><?php echo $option\_settings['label']; // phpcs:ignore ?></span>~~ |
  | 136 |  | ~~</label>~~ |
  | 137 |  | ~~<?php~~ |
  | 138 |  | ~~}~~ |
  | 139 |  | ~~?>~~ |
  | 140 |  | ~~</fieldset>~~ |
  | 141 |  | ~~</div>~~ |
  | 142 |  | ~~<?php } ?>~~ |
  | 143 | 75 | <br /> |
  | 144 | 76 | <?php |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L146) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L78) |  |
  | 146 | 78 | $class = ''; |
  | 147 | 79 |  |
  | 148 |  | if ( '' === trim( ~~Settings::get\_role\_or\_default\_setting( 'enable\_totp', null, null, true ) ) && '' === trim( Settings::get\_role\_or\_default\_setting( 'enable\_email', null, null, true ) ) && '' === trim(~~ Settings::get\_role\_or\_default\_setting( 'enable\_oob\_email', null, null, true ) ) ) { |
  |  | 80 | if ( '' === trim( (string) Settings::get\_role\_or\_default\_setting( TOTP::POLICY\_SETTINGS\_NAME, null, null, true ) ) && '' === trim( (string) Settings::get\_role\_or\_default\_setting( 'enable\_email', null, null, true ) ) && '' === trim( (string) Settings::get\_role\_or\_default\_setting( 'enable\_oob\_email', null, null, true ) ) ) { |
  | 149 | 81 | $class = 'disabled'; |
  | 150 | 82 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L156) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L88) |  |
  | 156 | 88 | <?php echo $data\_role; // phpcs:ignore ?> |
  | 157 | 89 | value="yes" |
  | 158 |  | <?php checked( WP2FA::get\_wp2fa\_setting( ~~'backup\_codes\_enabled' ), 'yes'~~ ); ?> |
  |  | 90 | <?php checked( WP2FA::get\_wp2fa\_setting( Backup\_Codes::get\_settings\_name() ), Backup\_Codes::get\_settings\_default\_value() ); ?> |
  | 159 | 91 | > |
  | 160 | 92 | <?php |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L188) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L120) |  |
  | 188 | 120 | if ( ! $setup\_wizard ) { |
  | 189 | 121 | ?> |
  | 190 |  | </td> |
  | 191 |  | </tr> |
  | 192 |  | </tbody> |
  | 193 |  | </table> |
  | 194 |  | <?php } ?> |
  |  | 122 | </td> |
  |  | 123 | </tr> |
  |  | 124 | </tbody> |
  |  | 125 | </table> |
  |  | 126 | <?php } ?> |
  | 195 | 127 | <?php |
  | 196 | 128 | $output = ob\_get\_clean(); |
  | 197 | 129 |  |
  | 198 | 130 | /\*\* |
  | 199 |  | \* At this point, none of the default providers is set / activated. This filter allows additional providers to change the behavio~~u~~r. Checking the input array for specific values (methods), and based on that we can raise error that none of the allowed methods has bees selected by the user, or dismiss the error otherwise. |
  |  | 131 | \* At this point, none of the default providers is set / activated. This filter allows additional providers to change the behavior. Checking the input array for specific values (methods), and based on that we can raise error that none of the allowed methods has bees selected by the user, or dismiss the error otherwise. |
  | 200 | 132 | \* |
  | 201 | 133 | \* @param string $output - Parsed HTML with the methods. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L222) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L154) |  |
  | 222 | 154 | ob\_start(); |
  | 223 | 155 | ?> |
  | 224 |  | <h3><?php esc\_html\_e( 'Which alternative 2FA methods can users use?', 'wp-2fa' ); ?></h3> |
  | 225 |  | <p class="description"> |
  | 226 |  | <?php esc\_html\_e( 'An alternative 2FA method allows users to configure another 2FA method that can be used as a backup should the primary 2FA method fail. This can happen if, for example, a user forgets their smartphone, the smartphone runs out of battery, or there are email deliverability problems.', 'wp-2fa' ); ?> |
  | 227 |  | </p> |
  | 228 |  | <p class="description"> |
  | 229 |  | <?php esc\_html\_e( 'It is highly recommended to have an alternative 2FA method configured at all times. Below is a list of alternative 2FA methods available through this plugin:', 'wp-2fa' ); ?> |
  | 230 |  | </p> |
  | 231 |  |  |
  | 232 |  | <br> |
  | 233 |  |  |
  | 234 |  | <fieldset> |
  | 235 |  | <label for="backup-codes"> |
  | 236 |  | <input type="checkbox" id="backup-codes-global" name="wp\_2fa\_policy[backup\_codes\_enabled]" value="yes" |
  | 237 |  | ~~<?php checked( WP2FA::get\_wp2fa\_setting( 'backup\_codes\_enabled' ), 'yes'~~ ); ?> |
  | 238 |  | > |
  | 239 |  | <?php esc\_html\_e( 'Backup codes', 'wp-2fa' ); ?> |
  | 240 |  | </label> |
  | 241 |  |  |
  | 242 |  | <?php |
  | 243 |  | echo '<p class="description">'; |
  | 244 |  | ~~echo sprintf(~~ |
  | 245 |  | '%1$1s <a href="https://melapress.com/support/kb/wp-2fa-what-are-2fa-backup-codes/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">%2$1s</a> <br><br>', |
  | 246 |  | esc\_html\_\_( 'Backup codes allow users to log in to WordPress should they find themselves unable to log in via the primary 2FA method. Backup codes are enabled by default and are generated during the 2FA configuration process. Each backup code can be used only once. Once the initial list is exhausted, more backup codes can be generated through the user’s WordPress profile page - ', 'wp-2fa' ), |
  | 247 |  | esc\_html\_\_( 'More information', 'wp-2fa' ) |
  | 248 |  | ); |
  | 249 |  | echo '</p>'; |
  | 250 |  | ?> |
  | 251 |  |  |
  | 252 |  | <?php |
  | 253 |  | echo '<label>'; |
  | 254 |  | ~~echo sprintf(~~ |
  | 255 |  | '%1$1s <a href="https://melapress.com/wordpress-2fa/features/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">%2$1s</a> %3$1s', |
  | 256 |  | esc\_html\_\_( 'Upgrade to WP 2FA Premium for', 'wp-2fa' ), |
  | 257 |  | esc\_html\_\_( 'more alternative 2FA methods', 'wp-2fa' ), |
  | 258 |  | esc\_html\_\_( 'to give your users more options.', 'wp-2fa' ) |
  | 259 |  | ); |
  | 260 |  | echo '<label>'; |
  | 261 |  | ?> |
  | 262 |  | </fieldset> |
  | 263 |  | <?php |
  |  | 156 | <h3><?php esc\_html\_e( 'Which alternative 2FA methods can users use?', 'wp-2fa' ); ?></h3> |
  |  | 157 | <p class="description"> |
  |  | 158 | <?php esc\_html\_e( 'An alternative 2FA method allows users to configure another 2FA method that can be used as a backup should the primary 2FA method fail. This can happen if, for example, a user forgets their smartphone, the smartphone runs out of battery, or there are email deliverability problems.', 'wp-2fa' ); ?> |
  |  | 159 | </p> |
  |  | 160 | <p class="description"> |
  |  | 161 | <?php esc\_html\_e( 'It is highly recommended to have an alternative 2FA method configured at all times. Below is a list of alternative 2FA methods available through this plugin:', 'wp-2fa' ); ?> |
  |  | 162 | </p> |
  |  | 163 |  |
  |  | 164 | <br> |
  |  | 165 |  |
  |  | 166 | <fieldset> |
  |  | 167 | <label for="backup-codes"> |
  |  | 168 | <input type="checkbox" id="backup-codes-global" name="wp\_2fa\_policy[backup\_codes\_enabled]" value="yes" |
  |  | 169 | <?php checked( WP2FA::get\_wp2fa\_setting( Backup\_Codes::get\_settings\_name() ), Backup\_Codes::get\_settings\_default\_value() ); ?> |
  |  | 170 | > |
  |  | 171 | <?php esc\_html\_e( 'Backup codes', 'wp-2fa' ); ?> |
  |  | 172 | </label> |
  |  | 173 |  |
  |  | 174 | <?php |
  |  | 175 | echo '<p class="description">'; |
  |  | 176 | printf( // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 177 | '%1$1s <a href="https://melapress.com/support/kb/wp-2fa-what-are-2fa-backup-codes/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">%2$1s</a> <br><br>', |
  |  | 178 | esc\_html\_\_( 'Backup codes allow users to log in to WordPress should they find themselves unable to log in via the primary 2FA method. Backup codes are enabled by default and are generated during the 2FA configuration process. Each backup code can be used only once. Once the initial list is exhausted, more backup codes can be generated through the user’s WordPress profile page - ', 'wp-2fa' ), |
  |  | 179 | esc\_html\_\_( 'More information', 'wp-2fa' ) |
  |  | 180 | ); |
  |  | 181 | echo '</p>'; |
  |  | 182 | ?> |
  |  | 183 |  |
  |  | 184 | <?php |
  |  | 185 | echo '<label>'; |
  |  | 186 | printf( // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 187 | '%1$1s <a href="https://melapress.com/wordpress-2fa/features/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">%2$1s</a> %3$1s', |
  |  | 188 | esc\_html\_\_( 'Upgrade to WP 2FA Premium for', 'wp-2fa' ), |
  |  | 189 | esc\_html\_\_( 'more alternative 2FA methods', 'wp-2fa' ), |
  |  | 190 | esc\_html\_\_( 'to give your users more options.', 'wp-2fa' ) |
  |  | 191 | ); |
  |  | 192 | echo '<label>'; |
  |  | 193 | ?> |
  |  | 194 | </fieldset> |
  |  | 195 | <?php |
  | 264 | 196 | ?> |
  | 265 | 197 | <?php |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=2940688#L377) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-first-time-wizard-steps.php?rev=3009922#L309) |  |
  | 377 | 309 | <fieldset class="hidden all-sites"> |
  | 378 | 310 | <p> |
  | 379 |  | <label for="~~slim-multi-select"><?php esc\_html\_e( 'Sites :', 'wp-2fa' ); ?></label> <select multiple="multiple" id="slim~~-multi-select" name="wp\_2fa\_policy[included\_sites][]" style="display:none; width:<?php echo ( $setup\_wizard ) ? '100' : '50'; ?>%"> |
  |  | 311 | <label for="enforced-sites-multi-select"><?php esc\_html\_e( 'Sites :', 'wp-2fa' ); ?></label> <select multiple="multiple" id="enforced-sites-multi-select" name="wp\_2fa\_policy[included\_sites][]" style="display:none; width:<?php echo ( $setup\_wizard ) ? '100' : '50'; ?>%"> |
  | 380 | 312 | <?php |
  | 381 | 313 | $selected\_sites = WP2FA::get\_wp2fa\_setting( 'included\_sites' ); |
* ## [wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php?rev=2940688#L130 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php?rev=3009922#L130 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 130 | 130 | ob\_start(); |
  | 131 | 131 | ?> |
  | 132 |  | <h3><?php esc\_html\_e( 'Do you want to require 2FA when users reset their password~~?~~', 'wp-2fa' ); ?></h3> |
  |  | 132 | <h3><?php esc\_html\_e( 'Do you want to require 2FA when users reset their password', 'wp-2fa' ); ?></h3> |
  | 133 | 133 | <p class="description"> |
  | 134 | 134 | <?php esc\_html\_e( 'When you enable this setting users will be required to enter a one-time code sent to them via email when resetting the password.', 'wp-2fa' ); ?> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php?rev=2940688#L141) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-passord-reset-2fa.php?rev=3009922#L141) |  |
  | 141 | 141 | <td> |
  | 142 | 142 | <fieldset class="contains-hidden-inputs"> |
  | 143 |  | <?php echo self::reset\_settings( $role, $name\_prefix, $data\_role, $role\_id ); ?> |
  |  | 143 | <?php echo self::reset\_settings( $role, $name\_prefix, $data\_role, $role\_id ); //phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?> |
  | 144 | 144 | </fieldset> |
  | 145 | 145 | </td> |
* ## [wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L13 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L13 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 |  |
  | 14 | 14 | use WP2FA\WP2FA; |
  |  | 15 | use WP2FA\Methods\Email; |
  | 15 | 16 | use WP2FA\Utils\User\_Utils; |
  |  | 17 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 16 | 18 | use WP2FA\Admin\Helpers\User\_Helper; |
  | 17 | 19 | use WP2FA\Admin\Controllers\Settings; |
  | 18 |  | ~~use WP2FA\Authenticator\Authentication;~~ |
  | 19 | 20 |  |
  | 20 | 21 | defined( 'ABSPATH' ) || exit; // Exit if accessed directly. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L27) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L28) |  |
  | 27 | 28 | \*/ |
  | 28 | 29 | class Wizard\_Steps { |
  | 29 |  |  |
  | 30 |  | ~~/\*\*~~ |
  | 31 |  | ~~\* Is the totp method enabled~~ |
  | 32 |  | ~~\*~~ |
  | 33 |  | ~~\* @since 1.7~~ |
  | 34 |  | ~~\*~~ |
  | 35 |  | ~~\* @var bool~~ |
  | 36 |  | ~~\*/~~ |
  | 37 |  | ~~private static $totp\_enabled = null;~~ |
  | 38 |  |  |
  | 39 |  | ~~/\*\*~~ |
  | 40 |  | ~~\* Is the mail enabled~~ |
  | 41 |  | ~~\*~~ |
  | 42 |  | ~~\* @since 1.7~~ |
  | 43 |  | ~~\*~~ |
  | 44 |  | ~~\* @var bool~~ |
  | 45 |  | ~~\*/~~ |
  | 46 |  | ~~private static $email\_enabled = null;~~ |
  | 47 | 30 |  |
  | 48 | 31 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L143) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L126) |  |
  | 143 | 126 |  |
  | 144 | 127 | /\*\* |
  | 145 |  | ~~\* Shows the initial totp setup options based on enabled methods~~ |
  | 146 |  | ~~\*~~ |
  | 147 |  | ~~\* @since 1.7~~ |
  | 148 |  | ~~\*~~ |
  | 149 |  | ~~\* @return void~~ |
  | 150 |  | ~~\*/~~ |
  | 151 |  | ~~public static function totp\_option() {~~ |
  | 152 |  | ~~if ( self::is\_totp\_enabled() ) {~~ |
  | 153 |  | ~~?>~~ |
  | 154 |  | ~~<div class="option-pill">~~ |
  | 155 |  | ~~<label for="basic">~~ |
  | 156 |  | ~~<input id="basic" name="wp\_2fa\_enabled\_methods" type="radio" value="totp" checked>~~ |
  | 157 |  | ~~<?php esc\_html\_e( 'One-time code via 2FA app', 'wp-2fa' ); ?><span class="wizard-tooltip" data-tooltip-content="data-totp-tooltip-content-wrapper">i</span>~~ |
  | 158 |  | ~~</label>~~ |
  | 159 |  | ~~<?php~~ |
  | 160 |  | ~~echo '<p class="description tooltip-content-wrapper" data-totp-tooltip-content-wrapper>';~~ |
  | 161 |  | ~~printf(~~ |
  | 162 |  | ~~/\* translators: link to the knowledge base website \*/~~ |
  | 163 |  | ~~esc\_html\_\_( 'Refer to the %s for more information on how to setup these apps and which apps are supported.', 'wp-2fa' ),~~ |
  | 164 |  | ~~'<a href="https://melapress.com/support/kb/wp-2fa-configuring-2fa-apps/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">' . esc\_html\_\_( 'guide on how to set up 2FA apps', 'wp-2fa' ) . '</a>'~~ |
  | 165 |  | ~~);~~ |
  | 166 |  | ~~echo '</p>';~~ |
  | 167 |  | ~~?>~~ |
  | 168 |  | ~~</div>~~ |
  | 169 |  | ~~<?php~~ |
  | 170 |  | ~~}~~ |
  | 171 |  | ~~}~~ |
  | 172 |  |  |
  | 173 |  | ~~/\*\*~~ |
  | 174 |  | ~~\* Shows the initial email setup option based on enabled methods~~ |
  | 175 |  | ~~\*~~ |
  | 176 |  | ~~\* @since 1.7~~ |
  | 177 |  | ~~\*~~ |
  | 178 |  | ~~\* @return void~~ |
  | 179 |  | ~~\*/~~ |
  | 180 |  | ~~public static function email\_option() {~~ |
  | 181 |  | ~~if ( self::is\_mail\_enabled() ) {~~ |
  | 182 |  | ~~?>~~ |
  | 183 |  | ~~<div class="option-pill">~~ |
  | 184 |  | ~~<label for="geek">~~ |
  | 185 |  | ~~<input id="geek" name="wp\_2fa\_enabled\_methods" type="radio" value="email">~~ |
  | 186 |  | ~~<?php esc\_html\_e( 'One-time code via email', 'wp-2fa' ); ?>~~ |
  | 187 |  | ~~</label>~~ |
  | 188 |  | ~~</div>~~ |
  | 189 |  | ~~<?php~~ |
  | 190 |  | ~~}~~ |
  | 191 |  | ~~}~~ |
  | 192 |  |  |
  | 193 |  |  |
  | 194 |  | ~~/\*\*~~ |
  | 195 |  | ~~\* Shows the option to reconfigure email (if applicable)~~ |
  | 196 |  | ~~\*~~ |
  | 197 |  | ~~\* @since 1.7~~ |
  | 198 |  | ~~\*~~ |
  | 199 |  | ~~\* @return void~~ |
  | 200 |  | ~~\*/~~ |
  | 201 |  | ~~public static function totp\_re\_configure() {~~ |
  | 202 |  |  |
  | 203 |  | ~~if ( ! self::is\_totp\_enabled() ) {~~ |
  | 204 |  | ~~return;~~ |
  | 205 |  | ~~}~~ |
  | 206 |  |  |
  | 207 |  | ~~$nonce = self::json\_nonce();~~ |
  | 208 |  |  |
  | 209 |  | ~~?>~~ |
  | 210 |  | ~~<div class="option-pill">~~ |
  | 211 |  | ~~<?php echo wp\_kses\_post( WP2FA::contextual\_reconfigure\_text( WP2FA::get\_wp2fa\_white\_label\_setting( 'totp\_reconfigure\_intro', true ), User\_Helper::get\_user\_object()->ID, 'totp' ) ); ?>~~ |
  | 212 |  | ~~<div class="wp2fa-setup-actions">~~ |
  | 213 |  | ~~<a href="#" class="button button-primary wp-2fa-button-primary" data-name="next\_step\_setting\_modal\_wizard" data-trigger-reset-key data-nonce="<?php echo esc\_attr( $nonce ); ?>" data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->ID ); ?>" data-next-step="2fa-wizard-totp"><?php esc\_html\_e( 'Reset Key', 'wp-2fa' ); ?></a>~~ |
  | 214 |  | ~~</div>~~ |
  | 215 |  | ~~</div>~~ |
  | 216 |  | ~~<?php~~ |
  | 217 |  | ~~}~~ |
  | 218 |  |  |
  | 219 |  | ~~/\*\*~~ |
  | 220 |  | ~~\* Shows the option for email method reconfiguring (if applicable)~~ |
  | 221 |  | ~~\*~~ |
  | 222 |  | ~~\* @since 1.7~~ |
  | 223 |  | ~~\*~~ |
  | 224 |  | ~~\* @return void~~ |
  | 225 |  | ~~\*/~~ |
  | 226 |  | ~~public static function email\_re\_configure() {~~ |
  | 227 |  |  |
  | 228 |  | ~~if ( ! self::is\_mail\_enabled() ) {~~ |
  | 229 |  | ~~return;~~ |
  | 230 |  | ~~}~~ |
  | 231 |  |  |
  | 232 |  | ~~$setupnonce = wp\_create\_nonce( 'wp-2fa-send-setup-email' );~~ |
  | 233 |  | ~~?>~~ |
  | 234 |  | ~~<div class="option-pill">~~ |
  | 235 |  | ~~<?php echo wp\_kses\_post( WP2FA::contextual\_reconfigure\_text( WP2FA::get\_wp2fa\_white\_label\_setting( 'hotp\_reconfigure\_intro', true ), User\_Helper::get\_user\_object()->ID, 'hotp' ) ); ?>~~ |
  | 236 |  | ~~<div class="wp2fa-setup-actions">~~ |
  | 237 |  | ~~<a class="button button-primary wp-2fa-button-primary" data-name="next\_step\_setting\_modal\_wizard" value="<?php esc\_attr\_e( 'I\'m Ready', 'wp-2fa' ); ?>" data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->ID ); ?>" data-nonce="<?php echo esc\_attr( $setupnonce ); ?>" data-next-step="2fa-wizard-email"><?php esc\_html\_e( 'Change email address', 'wp-2fa' ); ?></a>~~ |
  | 238 |  | ~~</div>~~ |
  | 239 |  | ~~</div>~~ |
  | 240 |  | ~~<?php~~ |
  | 241 |  | ~~}~~ |
  | 242 |  |  |
  | 243 |  | ~~/\*\*~~ |
  | 244 |  | ~~\* Reconfigures the totp form~~ |
  | 245 |  | ~~\*~~ |
  | 246 |  | ~~\* @since 1.7~~ |
  | 247 |  | ~~\*~~ |
  | 248 |  | ~~\* @return void~~ |
  | 249 |  | ~~\*/~~ |
  | 250 |  | ~~public static function totp\_configure() {~~ |
  | 251 |  |  |
  | 252 |  | ~~if ( ! self::is\_totp\_enabled() ) {~~ |
  | 253 |  | ~~return;~~ |
  | 254 |  | ~~}~~ |
  | 255 |  |  |
  | 256 |  | ~~// Regenerate the code if the method is not in use.~~ |
  | 257 |  | ~~if ( 'totp' !== User\_Helper::get\_enabled\_method\_for\_user() ) {~~ |
  | 258 |  | ~~User\_Helper::remove\_user\_totp\_key();~~ |
  | 259 |  | ~~}~~ |
  | 260 |  |  |
  | 261 |  | ~~/\*\*~~ |
  | 262 |  | ~~\* Active on modal, additional attribute is required on standard HTML (check below)~~ |
  | 263 |  | ~~\*/~~ |
  | 264 |  | ~~$add\_step\_attributes = 'active';~~ |
  | 265 |  |  |
  | 266 |  | ~~/\*\*~~ |
  | 267 |  | ~~\* Closing div for extra modal wrappers see lines above~~ |
  | 268 |  | ~~\*/~~ |
  | 269 |  | ~~$close\_div = '';~~ |
  | 270 |  |  |
  | 271 |  | ~~$qr\_code        = '<img class="qr-code" src="' . ( self::get\_qr\_code() ) . '" id="wp-2fa-totp-qrcode" />';~~ |
  | 272 |  | ~~$open30\_wrapper = '~~ |
  | 273 |  | ~~<div class="mb-30 clear-both">~~ |
  | 274 |  | ~~';~~ |
  | 275 |  | ~~$open60\_wrapper = '~~ |
  | 276 |  | ~~<div class="modal-60">~~ |
  | 277 |  | ~~';~~ |
  | 278 |  | ~~$open40\_wrapper = '~~ |
  | 279 |  | ~~<div class="modal-40">~~ |
  | 280 |  | ~~';~~ |
  | 281 |  | ~~$close\_div      = '~~ |
  | 282 |  | ~~</div>~~ |
  | 283 |  | ~~';~~ |
  | 284 |  | ~~$validate\_nonce = wp\_create\_nonce( 'wp-2fa-validate-authcode' );~~ |
  | 285 |  |  |
  | 286 |  | ~~?>~~ |
  | 287 |  | ~~<div class="step-setting-wrapper <?php echo $add\_step\_attributes; // phpcs:ignore ?>">~~ |
  | 288 |  | ~~<div class="mb-20">~~ |
  | 289 |  | ~~<?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_help\_totp\_intro', true ) ); ?>~~ |
  | 290 |  | ~~</div>~~ |
  | 291 |  | ~~<?php echo $open30\_wrapper . $open40\_wrapper; // phpcs:ignore ?>~~ |
  | 292 |  |  |
  | 293 |  | ~~<div class="qr-code-wrapper">~~ |
  | 294 |  | ~~<?php echo $qr\_code; // phpcs:ignore ?>~~ |
  | 295 |  | ~~</div>~~ |
  | 296 |  | ~~<?php~~ |
  | 297 |  | ~~echo $close\_div; // phpcs:ignore~~ |
  | 298 |  | ~~echo $open60\_wrapper; // phpcs:ignore~~ |
  | 299 |  | ~~?>~~ |
  | 300 |  |  |
  | 301 |  | ~~<div class="radio-cells option-pill mb-0">~~ |
  | 302 |  | ~~<ol class="wizard-custom-counter">~~ |
  | 303 |  | ~~<li><?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_help\_totp\_step\_1', true ) ); ?>~~ |
  | 304 |  | ~~<?php~~ |
  | 305 |  | ~~if ( ! empty( WP2FA::get\_wp2fa\_white\_label\_setting( 'show\_help\_text' ) ) ) {~~ |
  | 306 |  | ~~?>~~ |
  | 307 |  | ~~<span class="wizard-tooltip" data-tooltip-content="data-totp-setup-tooltip-content-wrapper">i</span><?php } ?></li>~~ |
  | 308 |  | ~~<li><?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_help\_totp\_step\_2', true ) ); ?>~~ |
  | 309 |  | ~~<div class="app-key-wrapper">~~ |
  | 310 |  | ~~<input type="text" id="app-key-input" readonly value="<?php echo esc\_html( User\_Helper::get\_totp\_decrypted() ); ?>" class="app-key">~~ |
  | 311 |  | ~~<?php~~ |
  | 312 |  | ~~if ( is\_ssl() ) {~~ |
  | 313 |  | ~~?>~~ |
  | 314 |  | ~~<span class="click-to-copy"><?php esc\_html\_e( 'COPY', 'wp-2fa' ); ?></span>~~ |
  | 315 |  | ~~<?php } ?>~~ |
  | 316 |  | ~~</div>~~ |
  | 317 |  | ~~</li>~~ |
  | 318 |  | ~~<li><?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_help\_totp\_step\_3', true ) ); ?></li>~~ |
  | 319 |  | ~~</ol>~~ |
  | 320 |  | ~~</div>~~ |
  | 321 |  | ~~<?php~~ |
  | 322 |  | ~~echo $close\_div; // phpcs:ignore~~ |
  | 323 |  | ~~echo $close\_div; // phpcs:ignore~~ |
  | 324 |  | ~~?>~~ |
  | 325 |  | ~~<?php if ( ! empty( WP2FA::get\_wp2fa\_white\_label\_setting( 'show\_help\_text' ) ) ) : ?>~~ |
  | 326 |  | ~~<div class="tooltip-content-wrapper" data-totp-setup-tooltip-content-wrapper>~~ |
  | 327 |  | ~~<p class="description"><?php esc\_html\_e( 'Click on the icon of the app that you are using for a detailed guide on how to set it up.', 'wp-2fa' ); ?></p>~~ |
  | 328 |  | ~~<div class="apps-wrapper">~~ |
  | 329 |  | ~~<?php foreach ( Authentication::get\_apps() as $app ) { ?>~~ |
  | 330 |  | ~~<a href="https://melapress.com/support/kb/wp-2fa-configuring-2fa-apps/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa#<?php echo $app['hash']; ?>" target="\_blank" class="app-logo"><img src="<?php echo esc\_url( WP\_2FA\_URL . 'dist/images/' . $app['logo'] ); // phpcs:ignore ?>"></a>~~ |
  | 331 |  | ~~<?php } ?>~~ |
  | 332 |  | ~~</div>~~ |
  | 333 |  | ~~</div>~~ |
  | 334 |  | ~~<?php endif; ?>~~ |
  | 335 |  | ~~<div class="wp2fa-setup-actions">~~ |
  | 336 |  | ~~<button class="button wp-2fa-button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'I\'m Ready', 'wp-2fa' ); ?>" type="button"><?php esc\_html\_e( 'I\'m Ready', 'wp-2fa' ); ?></button>~~ |
  | 337 |  | ~~</div>~~ |
  | 338 |  | ~~</div>~~ |
  | 339 |  | ~~<div class="step-setting-wrapper" data-step-title="<?php esc\_html\_e( 'Verify configuration', 'wp-2fa' ); ?>">~~ |
  | 340 |  | ~~<div class="mb-20">~~ |
  | 341 |  | ~~<?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_verification\_totp\_pre', true ) ); ?>~~ |
  | 342 |  | ~~</div>~~ |
  | 343 |  | ~~<fieldset>~~ |
  | 344 |  | ~~<label for="2fa-totp-authcode">~~ |
  | 345 |  | ~~<?php esc\_html\_e( 'Authentication Code', 'wp-2fa' ); ?>~~ |
  | 346 |  | ~~<input type="tel" name="wp-2fa-totp-authcode" id="wp-2fa-totp-authcode" class="input" value="" size="20" pattern="[0-9]\*" autocomplete="off"/>~~ |
  | 347 |  | ~~<script>~~ |
  | 348 |  | ~~const totp\_authcode = document.getElementById('wp-2fa-totp-authcode');~~ |
  | 349 |  | ~~totp\_authcode.addEventListener('input', function() {~~ |
  | 350 |  | ~~this.value = this.value.trim();~~ |
  | 351 |  | ~~});~~ |
  | 352 |  | ~~</script>~~ |
  | 353 |  | ~~</label>~~ |
  | 354 |  | ~~<div class="verification-response"></div>~~ |
  | 355 |  | ~~</fieldset>~~ |
  | 356 |  | ~~<input type="hidden" name="wp-2fa-totp-key" value="<?php echo esc\_attr( User\_Helper::get\_totp\_decrypted() ); ?>" />~~ |
  | 357 |  |  |
  | 358 |  | ~~<a href="#" class="modal\_\_btn button button-primary wp-2fa-button-primary" data-validate-authcode-ajax data-nonce="<?php echo esc\_attr( $validate\_nonce ); ?>"><?php esc\_html\_e( 'Validate & Save', 'wp-2fa' ); ?></a>~~ |
  | 359 |  | ~~<button class="modal\_\_btn wp-2fa-button-secondary button button-secondary wp-2fa-button-secondary" data-close-2fa-modal aria-label="Close this dialog window"><?php esc\_html\_e( 'Cancel', 'wp-2fa' ); ?></button>~~ |
  | 360 |  | ~~</div>~~ |
  | 361 |  |  |
  | 362 |  | ~~<?php~~ |
  | 363 |  | ~~}~~ |
  | 364 |  |  |
  | 365 |  | ~~/\*\*~~ |
  | 366 |  | ~~\* Reconfigures email form~~ |
  | 367 |  | ~~\*~~ |
  | 368 |  | ~~\* @since 1.7~~ |
  | 369 |  | ~~\*~~ |
  | 370 |  | ~~\* @return void~~ |
  | 371 |  | ~~\*/~~ |
  | 372 |  | ~~public static function email\_configure() {~~ |
  | 373 |  |  |
  | 374 |  | ~~if ( ! self::is\_mail\_enabled() ) {~~ |
  | 375 |  | ~~return;~~ |
  | 376 |  | ~~}~~ |
  | 377 |  |  |
  | 378 |  | ~~$setupnonce = wp\_create\_nonce( 'wp-2fa-send-setup-email' );~~ |
  | 379 |  |  |
  | 380 |  | ~~$validate\_nonce = wp\_create\_nonce( 'wp-2fa-validate-authcode' );~~ |
  | 381 |  | ~~?>~~ |
  | 382 |  | ~~<div class="step-setting-wrapper active">~~ |
  | 383 |  | ~~<div class="mb-20">~~ |
  | 384 |  | ~~<?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_help\_hotp\_intro', true ) ); ?>~~ |
  | 385 |  | ~~</div>~~ |
  | 386 |  | ~~<fieldset class="radio-cells">~~ |
  | 387 |  | ~~<div class="option-pill">~~ |
  | 388 |  | ~~<label for="use\_wp\_email">~~ |
  | 389 |  | ~~<input type="radio" name="wp\_2fa\_email\_address" id="use\_wp\_email" value="<?php echo esc\_attr( User\_Helper::get\_user\_object()->user\_email ); ?>" checked>~~ |
  | 390 |  | ~~<span><?php esc\_html\_e( 'Use my user email (', 'wp-2fa' ); ?><small><?php echo esc\_attr( User\_Helper::get\_user\_object()->user\_email ); ?></small><?php esc\_html\_e( ')', 'wp-2fa' ); ?></span>~~ |
  | 391 |  | ~~</label>~~ |
  | 392 |  | ~~</div>~~ |
  | 393 |  | ~~<?php~~ |
  | 394 |  | ~~if ( Settings::get\_role\_or\_default\_setting( 'specify-email\_hotp', User\_Helper::get\_user\_object() ) ) {~~ |
  | 395 |  | ~~?>~~ |
  | 396 |  | ~~<div class="option-pill">~~ |
  | 397 |  | ~~<label for="use\_custom\_email">~~ |
  | 398 |  | ~~<input type="radio" name="wp\_2fa\_email\_address" id="use\_custom\_email" value="use\_custom\_email">~~ |
  | 399 |  | ~~<span><?php esc\_html\_e( 'Use a different email address:', 'wp-2fa' ); ?></span>~~ |
  | 400 |  | ~~<?php esc\_html\_e( 'Email address', 'wp-2fa' ); ?>~~ |
  | 401 |  | ~~<input type="email" name="custom-email-address" id="custom-email-address" class="input" value=""/>~~ |
  | 402 |  | ~~</label>~~ |
  | 403 |  | ~~</div>~~ |
  | 404 |  | ~~<?php~~ |
  | 405 |  | ~~}~~ |
  | 406 |  | ~~?>~~ |
  | 407 |  | ~~</fieldset>~~ |
  | 408 |  | ~~<p class="description"><?php esc\_html\_e( 'To complete the 2FA configuration you will be sent a one-time code over email, therefore you should have access to the mailbox of this email address. If you do not receive the email with the one-time code please check your spam folder and contact your administrator.', 'wp-2fa' ); ?></p><br>~~ |
  | 409 |  |  |
  | 410 |  | ~~<?php~~ |
  | 411 |  | ~~$from\_email = get\_option( 'admin\_email' );~~ |
  | 412 |  |  |
  | 413 |  | ~~$custom\_mail = WP2FA::get\_wp2fa\_email\_templates( 'custom\_from\_email\_address' );~~ |
  | 414 |  |  |
  | 415 |  | ~~if ( isset( $custom\_mail ) && ! empty( (string) $custom\_mail ) ) {~~ |
  | 416 |  | ~~$from\_email = $custom\_mail;~~ |
  | 417 |  | ~~}~~ |
  | 418 |  | ~~echo sprintf(~~ |
  | 419 |  | ~~'<b>%1$1s</b> %2$1s %3$1s',~~ |
  | 420 |  | ~~esc\_html\_\_( 'IMPORTANT: ', 'wp-2fa' ),~~ |
  | 421 |  | ~~esc\_html\_\_( 'To ensure you always receive the one-time code whitelist the email address from which the codes are sent. This is ', 'wp-2fa' ),~~ |
  | 422 |  | ~~esc\_attr( $from\_email )~~ |
  | 423 |  | ~~);~~ |
  | 424 |  | ~~?>~~ |
  | 425 |  |  |
  | 426 |  | ~~<div class="wp2fa-setup-actions">~~ |
  | 427 |  | ~~<button class="button button-primary wp-2fa-button-primary" name="next\_step\_setting\_email\_verify" value="<?php esc\_attr\_e( 'I\'m Ready', 'wp-2fa' ); ?>" data-trigger-setup-email data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->ID ); ?>" data-nonce="<?php echo esc\_attr( $setupnonce ); ?>" type="button"><?php esc\_html\_e( 'I\'m Ready', 'wp-2fa' ); ?></button>~~ |
  | 428 |  |  |
  | 429 |  | ~~</div>~~ |
  | 430 |  | ~~</div>~~ |
  | 431 |  |  |
  | 432 |  | ~~<div class="step-setting-wrapper" data-step-title="<?php esc\_html\_e( 'Verify configuration', 'wp-2fa' ); ?>" id="2fa-wizard-email">~~ |
  | 433 |  | ~~<div class="mb-20">~~ |
  | 434 |  | ~~<?php echo wp\_kses\_post( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_verification\_hotp\_pre', true ) ); ?>~~ |
  | 435 |  | ~~</div>~~ |
  | 436 |  | ~~<fieldset>~~ |
  | 437 |  | ~~<label for="2fa-email-authcode">~~ |
  | 438 |  | ~~<?php esc\_html\_e( 'Authentication Code', 'wp-2fa' ); ?>~~ |
  | 439 |  | ~~<input type="tel" name="wp-2fa-email-authcode" id="wp-2fa-email-authcode" class="input" value="" size="20" pattern="[0-9]\*" autocomplete="off"/>~~ |
  | 440 |  | ~~<script>~~ |
  | 441 |  | ~~const email\_authcode = document.getElementById('wp-2fa-email-authcode');~~ |
  | 442 |  | ~~email\_authcode.addEventListener('input', function() {~~ |
  | 443 |  | ~~this.value = this.value.trim();~~ |
  | 444 |  | ~~});~~ |
  | 445 |  | ~~</script>~~ |
  | 446 |  | ~~</label>~~ |
  | 447 |  | ~~<div class="verification-response"></div>~~ |
  | 448 |  | ~~</fieldset>~~ |
  | 449 |  | ~~<br />~~ |
  | 450 |  | ~~<a href="#" class="button wp-2fa-button-primary" data-validate-authcode-ajax data-nonce="<?php echo esc\_attr( $validate\_nonce ); ?>"><?php esc\_html\_e( 'Validate & Save', 'wp-2fa' ); ?></a>~~ |
  | 451 |  | ~~<a href="#" class="button wp-2fa-button-primary resend-email-code" data-trigger-setup-email data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->ID ); ?>" data-nonce="<?php echo esc\_attr( $setupnonce ); ?>">~~ |
  | 452 |  | ~~<span class="resend-inner"><?php esc\_html\_e( 'Send me another code', 'wp-2fa' ); ?></span>~~ |
  | 453 |  | ~~</a>~~ |
  | 454 |  | ~~<button class="wp-2fa-button-secondary button" data-close-2fa-modal aria-label="Close this dialog window"><?php esc\_html\_e( 'Cancel', 'wp-2fa' ); ?></button>~~ |
  | 455 |  | ~~</div>~~ |
  | 456 |  | ~~<?php~~ |
  | 457 |  | ~~}~~ |
  | 458 |  |  |
  | 459 |  | ~~/\*\*~~ |
  | 460 | 128 | \* Configure backup codes step |
  | 461 | 129 | \* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L469) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L137) |  |
  | 469 | 137 |  |
  | 470 | 138 | $redirect = self::determine\_redirect\_url(); |
  | 471 |  |  |
  | 472 |  | ~~$nonce = self::json\_nonce();~~ |
  | 473 | 139 | ?> |
  | 474 | 140 | <div class="step-setting-wrapper active"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L486) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L152) |  |
  | 486 | 152 | <div class="wp2fa-setup-actions"> |
  | 487 | 153 | <?php if ( in\_array( 'user\_needs\_to\_setup\_backup\_codes', $user\_type, true ) ) { ?> |
  | 488 |  | <button class="button button-primary wp-2fa-button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Generate backup codes', 'wp-2fa' ); ?>" data-trigger-generate-backup-codes ~~data-nonce="<?php echo esc\_attr( $nonce ); ?>"~~> |
  |  | 154 | <button class="button button-primary wp-2fa-button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Generate backup codes', 'wp-2fa' ); ?>" data-trigger-generate-backup-codes <?php echo WP\_Helper::create\_data\_nonce( self::json\_nonce() ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>> |
  | 489 | 155 | <?php esc\_html\_e( 'Generate list of backup codes', 'wp-2fa' ); ?> |
  | 490 | 156 | </button> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L530) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L196) |  |
  | 530 | 196 | \*/ |
  | 531 | 197 | public static function generate\_backup\_codes() { |
  | 532 |  | ~~$nonce = self::json\_nonce();~~ |
  | 533 |  |  |
  | 534 | 198 | ?> |
  | 535 | 199 | <div class="step-setting-wrapper active" data-step-title="<?php esc\_html\_e( 'Generate codes', 'wp-2fa' ); ?>"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L538) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L202) |  |
  | 538 | 202 | </div> |
  | 539 | 203 | <div class="wp2fa-setup-actions"> |
  | 540 |  | <button class="button button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Generate backup codes', 'wp-2fa' ); ?>" data-trigger-generate-backup-codes ~~data-nonce="<?php echo esc\_attr( $nonce ); ?>"~~> |
  |  | 204 | <button class="button button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Generate backup codes', 'wp-2fa' ); ?>" data-trigger-generate-backup-codes <?php echo WP\_Helper::create\_data\_nonce( self::json\_nonce() ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?>> |
  | 541 | 205 | <?php esc\_html\_e( 'Generate list of backup codes', 'wp-2fa' ); ?> |
  | 542 | 206 | </button> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L563) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L227) |  |
  | 563 | 227 | } |
  | 564 | 228 |  |
  | 565 |  | public static function get\_backup\_codes\_link() { |
  | 566 |  | $nonce = self::json\_nonce(); |
  | 567 |  |  |
  | 568 |  | return '<a href="#" class="button button-primary remove-2fa" data-trigger-generate-backup-codes  data-nonce="' . esc\_attr( $nonce ) . '" onclick="MicroModal.show( \'configure-2fa-backup-codes\' );">' . \_\_( 'Generate list of backup codes', 'wp-2fa' ) . '</a>'; |
  |  | 229 | /\*\* |
  |  | 230 | \* Creates backup codes URL link |
  |  | 231 | \* |
  |  | 232 | \* @return string |
  |  | 233 | \* |
  |  | 234 | \* @since 2.6.0 |
  |  | 235 | \*/ |
  |  | 236 | public static function get\_backup\_codes\_link(): string { |
  |  | 237 | return '<a href="#" class="button button-primary remove-2fa" data-trigger-generate-backup-codes ' . WP\_Helper::create\_data\_nonce( self::json\_nonce() ) . ' onclick="MicroModal.show( \'configure-2fa-backup-codes\' );">' . \_\_( 'Generate list of backup codes', 'wp-2fa' ) . '</a>'; |
  | 569 | 238 | } |
  | 570 | 239 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L579) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L248) |  |
  | 579 | 248 | \*/ |
  | 580 | 249 | public static function generated\_backup\_codes( $backup\_only = false ) { |
  | 581 |  | ~~$nonce = self::json\_nonce();~~ |
  | 582 | 250 |  |
  | 583 | 251 | $redirect = self::determine\_redirect\_url(); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L601) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L269) |  |
  | 601 | 269 | </button> |
  | 602 | 270 | <?php } ?> |
  | 603 |  | <button class="button button-primary wp-2fa-button-primary" type="submit" value="<?php esc\_attr\_e( 'Print', 'wp-2fa' ); ?>" data-trigger-print ~~data-nonce="<?php echo esc\_attr( $nonce ); ?>"~~ data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->display\_name ); ?>" data-website-url="<?php echo esc\_attr( get\_home\_url() ); ?>"> |
  |  | 271 | <button class="button button-primary wp-2fa-button-primary" type="submit" value="<?php esc\_attr\_e( 'Print', 'wp-2fa' ); ?>" data-trigger-print <?php echo WP\_Helper::create\_data\_nonce( self::json\_nonce() ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?> data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->display\_name ); ?>" data-website-url="<?php echo esc\_attr( get\_home\_url() ); ?>"> |
  | 604 | 272 | <?php esc\_html\_e( 'Print', 'wp-2fa' ); ?> |
  | 605 | 273 | </button> |
  | 606 | 274 |  |
  | 607 |  | <button class="button button-primary wp-2fa-button-primary" type="submit" value="<?php esc\_attr\_e( 'Send me the codes via email', 'wp-2fa' ); ?>" data-trigger-backup-code-email ~~data-nonce="<?php echo esc\_attr( wp\_create\_nonce( 'wp-2fa-send-backup-codes-email-nonce' ) ); ?>"~~ data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->ID ); ?>" data-website-url="<?php echo esc\_attr( get\_home\_url() ); ?>"> |
  |  | 275 | <button class="button button-primary wp-2fa-button-primary" type="submit" value="<?php esc\_attr\_e( 'Send me the codes via email', 'wp-2fa' ); ?>" data-trigger-backup-code-email <?php echo WP\_Helper::create\_data\_nonce( 'wp-2fa-send-backup-codes-email-nonce' ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped ?> data-user-id="<?php echo esc\_attr( User\_Helper::get\_user\_object()->ID ); ?>" data-website-url="<?php echo esc\_attr( get\_home\_url() ); ?>"> |
  | 608 | 276 | <?php esc\_html\_e( 'Send me the codes via email', 'wp-2fa' ); ?> |
  | 609 | 277 | </button> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L698) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L366) |  |
  | 698 | 366 | \*/ |
  | 699 | 367 | public static function show\_modal\_methods() { |
  | 700 |  | ~~if ( self::is\_totp\_enabled() ) {~~ |
  | 701 |  | ~~?>~~ |
  | 702 |  | ~~<div class="wizard-step" id="2fa-wizard-totp">~~ |
  | 703 |  | ~~<fieldset>~~ |
  | 704 |  | ~~<?php self::totp\_configure(); ?>~~ |
  | 705 |  | ~~</fieldset>~~ |
  | 706 |  | ~~</div>~~ |
  | 707 |  | ~~<?php~~ |
  | 708 |  | ~~}~~ |
  | 709 |  | ~~if ( self::is\_mail\_enabled() ) {~~ |
  | 710 |  | ~~?>~~ |
  | 711 |  | ~~<div class="wizard-step" id="2fa-wizard-email">~~ |
  | 712 |  | ~~<fieldset>~~ |
  | 713 |  | ~~<?php self::email\_configure(); ?>~~ |
  | 714 |  | ~~</fieldset>~~ |
  | 715 |  | ~~</div>~~ |
  | 716 |  | ~~<?php~~ |
  | 717 |  | ~~}~~ |
  | 718 |  |  |
  | 719 | 368 | /\*\* |
  | 720 | 369 | \* Add an option for external providers to add their own modal methods options. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L761) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L410) |  |
  | 761 | 410 | <?php esc\_html\_e( 'Configure backup 2FA method', 'wp-2fa' ); ?> |
  | 762 | 411 | </a> |
  | 763 |  | <a href="<?php echo esc\_url( $redirect ); ?>" class="button button-secondary wp-2fa-button-secondary close-first-time-wizard"  <?php echo ( ( '' === trim( $redirect ) ) ? 'data-close-it=""' : '' ); ?>  > |
  |  | 412 | <a href="<?php echo esc\_url( $redirect ); ?>" class="button button-secondary wp-2fa-button-secondary close-first-time-wizard"  <?php echo ( ( '' === trim( (string) $redirect ) ) ? 'data-close-it=""' : '' ); ?>  > |
  | 764 | 413 | <?php esc\_html\_e( 'Close wizard & configure 2FA later', 'wp-2fa' ); ?> |
  | 765 | 414 | </a> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L790) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L439) |  |
  | 790 | 439 | if ( null === self::$redirect\_url ) { |
  | 791 | 440 | $redirect\_page      = Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page-global', User\_Helper::get\_user\_object() ); |
  | 792 |  | self::$redirect\_url = ( '' !== trim( $redirect\_page ) ) ? \trailingslashit( get\_site\_url() ) . $redirect\_page : ''; |
  |  | 441 | self::$redirect\_url = ( '' !== trim( (string) $redirect\_page ) ) ? \trailingslashit( get\_site\_url() ) . $redirect\_page : ''; |
  | 793 | 442 |  |
  | 794 | 443 | if ( |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L796) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L445) |  |
  | 796 | 445 | 'yes' === Settings::get\_role\_or\_default\_setting( 'create-custom-user-page' ) ) { |
  | 797 | 446 | if ( |
  | 798 |  | '' !== trim( Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page', User\_Helper::get\_user\_object() ) ) || |
  | 799 |  | '' !== trim( Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page' ) ) ) { |
  |  | 447 | '' !== trim( (string) Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page', User\_Helper::get\_user\_object() ) ) || |
  |  | 448 | '' !== trim( (string) Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page' ) ) ) { |
  | 800 | 449 | if ( 'yes' === Settings::get\_role\_or\_default\_setting( 'create-custom-user-page', User\_Helper::get\_user\_object() ) ) { |
  | 801 | 450 | self::$redirect\_url = trailingslashit( get\_site\_url() ) . Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page', User\_Helper::get\_user\_object() ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=2940688#L819) | […](/browser/wp-2fa/trunk/includes/classes/Admin/Views/class-wizard-steps.php?rev=3009922#L468) |  |
  | 819 | 468 | protected static function json\_nonce() { |
  | 820 | 469 | if ( null === self::$json\_nonce ) { |
  | 821 |  | self::$json\_nonce = ~~wp\_create\_nonce( 'wp-2fa-backup-codes-generate-json-' . User\_Helper::get\_user\_object()->ID )~~; |
  |  | 470 | self::$json\_nonce = 'wp-2fa-backup-codes-generate-json-' . User\_Helper::get\_user\_object()->ID; |
  | 822 | 471 | } |
  | 823 | 472 |  |
  | 824 | 473 | return self::$json\_nonce; |
  | 825 |  | ~~}~~ |
  | 826 |  |  |
  | 827 |  | ~~/\*\*~~ |
  | 828 |  | ~~\* Returns the status of the totp method (enabled | disabled)~~ |
  | 829 |  | ~~\*~~ |
  | 830 |  | ~~\* @since 1.7~~ |
  | 831 |  | ~~\*~~ |
  | 832 |  | ~~\* @return boolean~~ |
  | 833 |  | ~~\*/~~ |
  | 834 |  | ~~private static function is\_totp\_enabled(): bool {~~ |
  | 835 |  | ~~if ( null === self::$totp\_enabled ) {~~ |
  | 836 |  | ~~self::$totp\_enabled = empty( Settings::get\_role\_or\_default\_setting( 'enable\_totp', 'current' ) ) ? false : true;~~ |
  | 837 |  | ~~}~~ |
  | 838 |  |  |
  | 839 |  | ~~return self::$totp\_enabled;~~ |
  | 840 |  | ~~}~~ |
  | 841 |  |  |
  | 842 |  | ~~/\*\*~~ |
  | 843 |  | ~~\* Returns the status of the mail method (enabled | disabled)~~ |
  | 844 |  | ~~\*~~ |
  | 845 |  | ~~\* @since 1.7~~ |
  | 846 |  | ~~\*~~ |
  | 847 |  | ~~\* @return boolean~~ |
  | 848 |  | ~~\*/~~ |
  | 849 |  | ~~private static function is\_mail\_enabled(): bool {~~ |
  | 850 |  | ~~if ( null === self::$email\_enabled ) {~~ |
  | 851 |  | ~~self::$email\_enabled = empty( Settings::get\_role\_or\_default\_setting( 'enable\_email', 'current' ) ) ? false : true;~~ |
  | 852 |  | ~~}~~ |
  | 853 |  |  |
  | 854 |  | ~~return self::$email\_enabled;~~ |
  | 855 |  | ~~}~~ |
  | 856 |  |  |
  | 857 |  | ~~/\*\*~~ |
  | 858 |  | ~~\* Retrieves the QR code~~ |
  | 859 |  | ~~\*~~ |
  | 860 |  | ~~\* @since 1.7~~ |
  | 861 |  | ~~\*~~ |
  | 862 |  | ~~\* @return string~~ |
  | 863 |  | ~~\*/~~ |
  | 864 |  | ~~private static function get\_qr\_code(): string {~~ |
  | 865 |  |  |
  | 866 |  | ~~// Setup site information, used when generating our QR code.~~ |
  | 867 |  | ~~$site\_name = site\_url();~~ |
  | 868 |  | ~~$site\_name = trim( str\_replace( array( 'http://', 'https://' ), '', $site\_name ), '/' );~~ |
  | 869 |  | ~~/\*\*~~ |
  | 870 |  | ~~\* Changing the title of the login screen for the TOTP method.~~ |
  | 871 |  | ~~\*~~ |
  | 872 |  | ~~\* @param string $title - The default title.~~ |
  | 873 |  | ~~\* @param \WP\_User $user - The WP user.~~ |
  | 874 |  | ~~\*~~ |
  | 875 |  | ~~\* @since 2.0.0~~ |
  | 876 |  | ~~\*/~~ |
  | 877 |  | ~~$totp\_title = apply\_filters(~~ |
  | 878 |  | ~~WP\_2FA\_PREFIX . 'totp\_title',~~ |
  | 879 |  | ~~$site\_name . ':' . User\_Helper::get\_user\_object()->user\_login,~~ |
  | 880 |  | ~~User\_Helper::get\_user\_object()~~ |
  | 881 |  | ~~);~~ |
  | 882 |  |  |
  | 883 |  | ~~return Authentication::get\_google\_qr\_code( $totp\_title, User\_Helper::get\_totp\_key(), $site\_name );~~ |
  | 884 | 474 | } |
  | 885 | 475 | } |
* ## [wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=2940688#L13 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=3009922#L13 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | namespace WP2FA\Admin; |
  | 14 | 14 |  |
  | 15 |  | use ~~\~~WP2FA\Admin\Settings\_Page; |
  |  | 15 | use WP2FA\Admin\Settings\_Page; |
  | 16 | 16 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 17 |  | use ~~\WP2FA\WP2FA as~~ WP2FA; |
  |  | 17 | use WP2FA\WP2FA; |
  | 18 | 18 |  |
  | 19 | 19 | if ( ! class\_exists( '\WP2FA\Admin\Help\_Contact\_Us' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=2940688#L52) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=3009922#L52) |  |
  | 52 | 52 | if ( ! empty( WP2FA::get\_wp2fa\_setting( '2fa\_settings\_last\_updated\_by' ) ) ) { |
  | 53 | 53 | $main\_user = (int) WP2FA::get\_wp2fa\_setting( '2fa\_settings\_last\_updated\_by' ); |
  | 54 |  | } |
  |  | 54 | } |
  | 55 | 55 | ?> |
  | 56 |  | <?php if ( ! empty( WP2FA::get\_wp2fa\_general\_setting( 'limit\_access' ) ) && $main\_user !== $current\_user\_id ) : ?> |
  |  | 56 | <?php if ( ! empty( WP2FA::get\_wp2fa\_general\_setting( 'limit\_access' ) ) && $main\_user !== $current\_user\_id ) : ?> |
  | 57 | 57 | </br> |
  | 58 |  | <?php |
  | 59 |  | echo esc\_html\_\_( 'These settings have been disabled by your site administrator, please contact them for further assistance.', 'wp-2fa' ); |
  | 60 |  | ?> |
  |  | 58 | <?php |
  |  | 59 | echo esc\_html\_\_( 'These settings have been disabled by your site administrator, please contact them for further assistance.', 'wp-2fa' ); |
  |  | 60 | ?> |
  | 61 | 61 | <?php else : ?> |
  | 62 | 62 | <div class="wrap help-wrap"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=2940688#L195) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=3009922#L195) |  |
  | 195 | 195 | <div class="plugin-box"> |
  | 196 | 196 | <div class="plugin-img"> |
  | 197 |  | <img src="<?php echo WP\_2FA\_URL; // phpcs:ignore ?>dist/images/wp-~~security-audit-log-img.jp~~g" alt=""> |
  |  | 197 | <img src="<?php echo WP\_2FA\_URL; // phpcs:ignore ?>dist/images/wp-activity-log.jpeg" alt=""> |
  | 198 | 198 | </div> |
  | 199 | 199 | <div class="plugin-desc"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=2940688#L222) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-help-contact-us.php?rev=3009922#L222) |  |
  | 222 | 222 | <div class="plugin-box"> |
  | 223 | 223 | <div class="plugin-img"> |
  | 224 |  | <img src="<?php echo WP\_2FA\_URL; // phpcs:ignore ?>dist/images/~~wp-password-img.jp~~g" alt=""> |
  |  | 224 | <img src="<?php echo WP\_2FA\_URL; // phpcs:ignore ?>dist/images/login-security.jpeg" alt=""> |
  | 225 | 225 | </div> |
  | 226 | 226 | <div class="plugin-desc"> |
* ## [wp-2fa/trunk/includes/classes/Admin/class-premium-features.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/class-premium-features.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=2940688#L59 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=3009922#L59 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 59 | 59 | $banner .= '<li><span class="dashicons dashicons-yes-alt"></span> ' . esc\_html\_\_( 'Many other features', 'wp-2fa' ) . '</li>'; |
  | 60 | 60 | $banner .= '<li><span class="dashicons dashicons-yes-alt"></span> ' . esc\_html\_\_( 'No Ads!', 'wp-2fa' ) . '</li></ul>'; |
  | 61 |  | $banner .= '<a href="https://melapress.com/wordpress-2fa/p~~lugin-trial/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" class="button button-primary" target="\_blank">' . esc\_html\_\_( 'Get a Free 14-day trial', 'wp-2fa' ) . '</a> <a href="https://melapress.com/wordpress-2fa/pricing/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" class="link" target="\_blank">' . esc\_html\_\_( 'Upgrade now~~', 'wp-2fa' ) . '</a>'; |
  |  | 61 | $banner .= '<a href="https://melapress.com/wordpress-2fa/pricing/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" class="button button-primary" target="\_blank">' . esc\_html\_\_( 'Upgrade to Premium', 'wp-2fa' ) . '</a>'; |
  | 62 | 62 | $banner .= '</div>'; |
  | 63 | 63 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=2940688#L202) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=3009922#L202) |  |
  | 202 | 202 | </ul> |
  | 203 | 203 | <div class="premium-cta"> |
  | 204 |  | <a href="<?php echo esc\_url( 'https://melapress.com/wordpress-2fa/plugin-trial/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Get the Free 14-day trial', 'wp-2fa' ); ?></a> |
  | 205 |  | <a class="inverse" href="<?php echo esc\_url( 'https://melapress.com/wordpress-2fa/pricing/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank" rel="noopener"><?php esc\_html\_e( 'UPGRADE NOW', 'wp-2fa' ); ?></a> |
  | 206 |  | <span style="text-align: center; display: block; margin-top: 11px;"><?php esc\_html\_e( '\* No credit card or payment details required for the trial.', 'wp-2fa' ); ?></span> |
  |  | 204 | <a href="<?php echo esc\_url( 'https://melapress.com/wordpress-2fa/pricing/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Upgrade to Premium', 'wp-2fa' ); ?></a> |
  | 207 | 205 | </div> |
  | 208 | 206 | </div> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=2940688#L404) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-premium-features.php?rev=3009922#L402) |  |
  | 404 | 402 |  |
  | 405 | 403 | <div class="premium-cta"> |
  | 406 |  | <a href="<?php echo esc\_url( 'https://melapress.com/wordpress-2fa/plugin-trial/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Get the Free 14-day trial', 'wp-2fa' ); ?></a> |
  | 407 |  | <a class="inverse" href="<?php echo esc\_url( 'https://melapress.com/wordpress-2fa/pricing/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank" rel="noopener"><?php esc\_html\_e( 'UPGRADE NOW', 'wp-2fa' ); ?></a> |
  | 408 |  | <span style="text-align: center; display: block; margin-top: 11px;"><?php esc\_html\_e( '\* No credit card or payment details required for the trial.', 'wp-2fa' ); ?></span> |
  |  | 404 | <a href="<?php echo esc\_url( 'https://melapress.com/wordpress-2fa/pricing/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa' ); ?>" target="\_blank" rel="noopener"><?php esc\_html\_e( 'Upgrade to Premium', 'wp-2fa' ); ?></a> |
  | 409 | 405 | </div> |
  | 410 | 406 | </div> |
* ## [wp-2fa/trunk/includes/classes/Admin/class-settings-page.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/class-settings-page.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L12 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L12 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | namespace WP2FA\Admin; |
  | 13 | 13 |  |
  | 14 |  | use \WP2FA\WP2FA as WP2FA; |
  | 15 |  | use WP2FA\Utils\User\_Utils; |
  | 16 |  | use WP2FA\Utils\Settings\_Utils; |
  |  | 14 | use WP2FA\WP2FA; |
  | 17 | 15 | use WP2FA\Admin\SettingsPages\{ |
  | 18 | 16 | Settings\_Page\_Policies, |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L21) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L19) |  |
  | 21 | 19 | }; |
  | 22 | 20 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 23 |  | ~~use WP2FA\Admin\Helpers\User\_Helper;~~ |
  | 24 | 21 | use WP2FA\Admin\Controllers\Settings; |
  |  | 22 | use WP2FA\Utils\Settings\_Utils; |
  | 25 | 23 |  |
  | 26 | 24 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L34) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L32) |  |
  | 34 | 32 |  |
  | 35 | 33 | const TOP\_MENU\_SLUG = 'wp-2fa-policies'; |
  | 36 |  |  |
  | 37 |  | ~~/\*\*~~ |
  | 38 |  | ~~\* Holds the status of the backup codes functionality~~ |
  | 39 |  | ~~\*~~ |
  | 40 |  | ~~\* @var bool[]~~ |
  | 41 |  | ~~\*/~~ |
  | 42 |  | ~~private static $backup\_codes\_enabled = array();~~ |
  | 43 | 34 |  |
  | 44 | 35 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L113) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L104) |  |
  | 113 | 104 | \*/ |
  | 114 | 105 | do\_action( WP\_2FA\_PREFIX . 'after\_admin\_menu\_created', self::TOP\_MENU\_SLUG, false ); |
  |  | 106 |  |
  |  | 107 | add\_action( WP\_2FA\_PREFIX . 'before\_plugin\_settings', array( \_\_CLASS\_\_, 'check\_email' ) ); |
  | 115 | 108 | } |
  | 116 | 109 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L160) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L153) |  |
  | 160 | 153 | do\_action( WP\_2FA\_PREFIX . 'after\_admin\_menu\_created', self::TOP\_MENU\_SLUG, true ); |
  | 161 | 154 | } |
  | 162 |  |  |
  | 163 |  | ~~/\*\*~~ |
  | 164 |  | ~~\* Get all users~~ |
  | 165 |  | ~~\*~~ |
  | 166 |  | ~~\* @SuppressWarnings(PHPMD.ExitExpression)~~ |
  | 167 |  | ~~\*/~~ |
  | 168 |  | ~~public static function get\_all\_users() {~~ |
  | 169 |  | ~~// Die if user does not have permission to view.~~ |
  | 170 |  | ~~if ( ! current\_user\_can( 'manage\_options' ) ) {~~ |
  | 171 |  | ~~die( 'Access Denied.' );~~ |
  | 172 |  | ~~}~~ |
  | 173 |  | ~~// Filter $\_GET array for security.~~ |
  | 174 |  | ~~$get\_array = filter\_input\_array( INPUT\_GET );~~ |
  | 175 |  |  |
  | 176 |  | ~~// Die if nonce verification failed.~~ |
  | 177 |  | ~~if ( ! wp\_verify\_nonce( sanitize\_text\_field( $get\_array['wp\_2fa\_nonce'] ), 'wp-2fa-settings-nonce' ) ) {~~ |
  | 178 |  | ~~die( esc\_html\_\_( 'Nonce verification failed.', 'wp-2fa' ) );~~ |
  | 179 |  | ~~}~~ |
  | 180 |  |  |
  | 181 |  | ~~$users\_args = array(~~ |
  | 182 |  | ~~'fields' => array( 'ID', 'user\_login' ),~~ |
  | 183 |  | ~~);~~ |
  | 184 |  | ~~if ( WP\_Helper::is\_multisite() ) {~~ |
  | 185 |  | ~~$users\_args['blog\_id'] = 0;~~ |
  | 186 |  | ~~}~~ |
  | 187 |  | ~~$users\_data = User\_Utils::get\_all\_user\_ids\_and\_login\_names( 'query', $users\_args );~~ |
  | 188 |  |  |
  | 189 |  | ~~// Create final array which we will fill in below.~~ |
  | 190 |  | ~~$users = array();~~ |
  | 191 |  |  |
  | 192 |  | ~~foreach ( $users\_data as $user ) {~~ |
  | 193 |  | ~~if ( strpos( $user['user\_login'], $get\_array['term'] ) !== false ) {~~ |
  | 194 |  | ~~array\_push(~~ |
  | 195 |  | ~~$users,~~ |
  | 196 |  | ~~array(~~ |
  | 197 |  | ~~'value' => $user['user\_login'],~~ |
  | 198 |  | ~~'label' => $user['user\_login'],~~ |
  | 199 |  | ~~)~~ |
  | 200 |  | ~~);~~ |
  | 201 |  | ~~}~~ |
  | 202 |  | ~~}~~ |
  | 203 |  |  |
  | 204 |  | ~~echo wp\_json\_encode( $users );~~ |
  | 205 |  | ~~exit;~~ |
  | 206 |  | ~~}~~ |
  | 207 |  |  |
  | 208 |  | ~~/\*\*~~ |
  | 209 |  | ~~\* Get all network sites~~ |
  | 210 |  | ~~\*~~ |
  | 211 |  | ~~\* @SuppressWarnings(PHPMD.ExitExpression)~~ |
  | 212 |  | ~~\*/~~ |
  | 213 |  | ~~public static function get\_all\_network\_sites() {~~ |
  | 214 |  | ~~// Die if user does not have permission to view.~~ |
  | 215 |  | ~~if ( ! current\_user\_can( 'manage\_options' ) ) {~~ |
  | 216 |  | ~~die( 'Access Denied.' );~~ |
  | 217 |  | ~~}~~ |
  | 218 |  | ~~// Filter $\_GET array for security.~~ |
  | 219 |  | ~~$get\_array = filter\_input\_array( INPUT\_GET );~~ |
  | 220 |  | ~~// Die if nonce verification failed.~~ |
  | 221 |  | ~~if ( ! wp\_verify\_nonce( sanitize\_text\_field( $get\_array['wp\_2fa\_nonce'] ), 'wp-2fa-settings-nonce' ) ) {~~ |
  | 222 |  | ~~die( esc\_html\_\_( 'Nonce verification failed.', 'wp-2fa' ) );~~ |
  | 223 |  | ~~}~~ |
  | 224 |  | ~~// Fetch sites.~~ |
  | 225 |  | ~~$sites\_found = array();~~ |
  | 226 |  |  |
  | 227 |  | ~~foreach ( get\_sites() as $site ) {~~ |
  | 228 |  | ~~$subsite\_id                  = get\_object\_vars( $site )['blog\_id'];~~ |
  | 229 |  | ~~$subsite\_name                = get\_blog\_details( $subsite\_id )->blogname;~~ |
  | 230 |  | ~~$site\_details                = '';~~ |
  | 231 |  | ~~$site\_details[ $subsite\_id ] = $subsite\_name;~~ |
  | 232 |  | ~~if ( false !== stripos( $subsite\_name, $get\_array['term'] ) ) {~~ |
  | 233 |  | ~~array\_push(~~ |
  | 234 |  | ~~$sites\_found,~~ |
  | 235 |  | ~~array(~~ |
  | 236 |  | ~~'label' => $subsite\_id,~~ |
  | 237 |  | ~~'value' => $subsite\_name,~~ |
  | 238 |  | ~~)~~ |
  | 239 |  | ~~);~~ |
  | 240 |  | ~~}~~ |
  | 241 |  | ~~}~~ |
  | 242 |  | ~~echo wp\_json\_encode( $sites\_found );~~ |
  | 243 |  | ~~exit;~~ |
  | 244 |  | ~~}~~ |
  | 245 |  |  |
  | 246 |  | ~~/\*\*~~ |
  | 247 |  | ~~\* Unlock users accounts if they have overrun grace period~~ |
  | 248 |  | ~~\*~~ |
  | 249 |  | ~~\* @param  int $user\_id User ID.~~ |
  | 250 |  | ~~\*~~ |
  | 251 |  | ~~\* @SuppressWarnings(PHPMD.ExitExpression)~~ |
  | 252 |  | ~~\*/~~ |
  | 253 |  | ~~public static function unlock\_account( $user\_id ) {~~ |
  | 254 |  | ~~// Die if user does not have permission to view.~~ |
  | 255 |  | ~~if ( ! current\_user\_can( 'manage\_options' ) ) {~~ |
  | 256 |  | ~~die( 'Access Denied.' );~~ |
  | 257 |  | ~~}~~ |
  | 258 |  |  |
  | 259 |  | ~~$grace\_period             = WP2FA::get\_wp2fa\_setting( 'grace-period' );~~ |
  | 260 |  | ~~$grace\_period\_denominator = WP2FA::get\_wp2fa\_setting( 'grace-period-denominator' );~~ |
  | 261 |  | ~~$create\_a\_string          = $grace\_period . ' ' . $grace\_period\_denominator;~~ |
  | 262 |  | ~~// Turn that string into a time.~~ |
  | 263 |  | ~~$grace\_expiry = strtotime( $create\_a\_string );~~ |
  | 264 |  |  |
  | 265 |  | ~~// Filter $\_GET array for security.~~ |
  | 266 |  | ~~$get\_array = filter\_input\_array( INPUT\_GET );~~ |
  | 267 |  | ~~$nonce     = sanitize\_text\_field( $get\_array['wp\_2fa\_nonce'] );~~ |
  | 268 |  |  |
  | 269 |  | ~~// Die if nonce verification failed.~~ |
  | 270 |  | ~~if ( ! wp\_verify\_nonce( $nonce, 'wp-2fa-unlock-account-nonce' ) ) {~~ |
  | 271 |  | ~~die( esc\_html\_\_( 'Nonce verification failed.', 'wp-2fa' ) );~~ |
  | 272 |  | ~~}~~ |
  | 273 |  |  |
  | 274 |  | ~~if ( isset( $get\_array['user\_id'] ) ) {~~ |
  | 275 |  | ~~global $wpdb;~~ |
  | 276 |  | ~~$wpdb->query( // phpcs:ignore~~ |
  | 277 |  | ~~$wpdb->prepare(~~ |
  | 278 |  | ~~"~~ |
  | 279 |  | ~~DELETE FROM $wpdb->usermeta~~ |
  | 280 |  | ~~WHERE user\_id = %d~~ |
  | 281 |  | ~~AND meta\_key IN ( %s, %s )~~ |
  | 282 |  | ~~",~~ |
  | 283 |  | ~~array(~~ |
  | 284 |  | ~~intval( $get\_array['user\_id'] ),~~ |
  | 285 |  | ~~User\_Helper::USER\_GRACE\_KEY,~~ |
  | 286 |  | ~~WP\_2FA\_PREFIX . 'locked\_account\_notification',~~ |
  | 287 |  | ~~)~~ |
  | 288 |  | ~~)~~ |
  | 289 |  | ~~);~~ |
  | 290 |  | ~~User\_Helper::set\_user\_expiry\_date( (string) $grace\_expiry, intval( $get\_array['user\_id'] ) );~~ |
  | 291 |  | ~~self::send\_account\_unlocked\_email( intval( $get\_array['user\_id'] ) );~~ |
  | 292 |  | ~~add\_action( 'admin\_notices', array( \_\_CLASS\_\_, 'user\_unlocked\_notice' ) );~~ |
  | 293 |  | ~~}~~ |
  | 294 |  | ~~}~~ |
  | 295 |  |  |
  | 296 |  | ~~/\*\*~~ |
  | 297 |  | ~~\* Remove user 2fa config~~ |
  | 298 |  | ~~\*~~ |
  | 299 |  | ~~\* @param  int $user\_id User ID.~~ |
  | 300 |  | ~~\*~~ |
  | 301 |  | ~~\* @SuppressWarnings(PHPMD.ExitExpression)~~ |
  | 302 |  | ~~\*/~~ |
  | 303 |  | ~~public static function remove\_user\_2fa( $user\_id ) {~~ |
  | 304 |  | ~~// Filter $\_GET array for security.~~ |
  | 305 |  | ~~$get\_array = filter\_input\_array( INPUT\_GET );~~ |
  | 306 |  | ~~$nonce     = sanitize\_text\_field( $get\_array['wp\_2fa\_nonce'] );~~ |
  | 307 |  |  |
  | 308 |  | ~~if ( ! wp\_verify\_nonce( $nonce, 'wp-2fa-remove-user-2fa-nonce' ) ) {~~ |
  | 309 |  | ~~die( esc\_html\_\_( 'Nonce verification failed.', 'wp-2fa' ) );~~ |
  | 310 |  | ~~}~~ |
  | 311 |  |  |
  | 312 |  | ~~if ( isset( $get\_array['user\_id'] ) ) {~~ |
  | 313 |  | ~~$user\_id = intval( $get\_array['user\_id'] );~~ |
  | 314 |  |  |
  | 315 |  | ~~if ( ! current\_user\_can( 'manage\_options' ) && get\_current\_user\_id() !== $user\_id ) {~~ |
  | 316 |  | ~~return;~~ |
  | 317 |  | ~~}~~ |
  | 318 |  |  |
  | 319 |  | ~~User\_Helper::remove\_2fa\_for\_user( $user\_id );~~ |
  | 320 |  |  |
  | 321 |  | ~~if ( isset( $get\_array['admin\_reset'] ) ) {~~ |
  | 322 |  | ~~add\_action( 'admin\_notices', array( \_\_CLASS\_\_, 'admin\_deleted\_2fa\_notice' ) );~~ |
  | 323 |  | ~~} else {~~ |
  | 324 |  | ~~add\_action( 'admin\_notices', array( \_\_CLASS\_\_, 'user\_deleted\_2fa\_notice' ) );~~ |
  | 325 |  | ~~}~~ |
  | 326 |  | ~~}~~ |
  | 327 |  | ~~}~~ |
  | 328 |  |  |
  | 329 | 155 | /\*\* |
  | 330 | 156 | \* Send account unlocked notification via email. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L382) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L208) |  |
  | 382 | 208 | // add link to the external free trial page in free version and also in premium version if license is not active. |
  | 383 | 209 | if ( ! function\_exists( 'wp2fa\_freemius' ) || ! wp2fa\_freemius()->has\_active\_valid\_license() ) { |
  | 384 |  | $trial\_link = 'https://melapress.com/wordpress-2fa/p~~lugin-trial/?&~~utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa'; |
  |  | 210 | $trial\_link = 'https://melapress.com/wordpress-2fa/pricing/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa'; |
  | 385 | 211 | $links      = array\_merge( |
  | 386 | 212 | array( |
  | 387 |  | '<a style="font-weight:bold" href="' . $trial\_link . '" target="\_blank">' . \_\_( '~~Free 14-day Premium Trial~~', 'wp-2fa' ) . '</a>', |
  |  | 213 | '<a style="font-weight:bold" href="' . $trial\_link . '" target="\_blank">' . \_\_( 'Upgrade to Premium', 'wp-2fa' ) . '</a>', |
  | 388 | 214 | ), |
  | 389 | 215 | $links |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L401) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L227) |  |
  | 401 | 227 |  |
  | 402 | 228 | return $links; |
  | 403 |  | ~~}~~ |
  | 404 |  |  |
  | 405 |  | ~~/\*\*~~ |
  | 406 |  | ~~\* User unlocked notice.~~ |
  | 407 |  | ~~\*/~~ |
  | 408 |  | ~~public static function user\_unlocked\_notice() {~~ |
  | 409 |  | ~~?>~~ |
  | 410 |  | ~~<div class="notice notice-success is-dismissible">~~ |
  | 411 |  | ~~<p><?php esc\_html\_e( 'User account successfully unlocked. User can login again.', 'wp-2fa' ); ?></p>~~ |
  | 412 |  | ~~<button type="button" class="notice-dismiss">~~ |
  | 413 |  | ~~<span class="screen-reader-text"><?php esc\_html\_e( 'Dismiss this notice.', 'wp-2fa' ); ?></span>~~ |
  | 414 |  | ~~</button>~~ |
  | 415 |  | ~~</div>~~ |
  | 416 |  | ~~<?php~~ |
  | 417 |  | ~~}~~ |
  | 418 |  |  |
  | 419 |  | ~~/\*\*~~ |
  | 420 |  | ~~\* User deleted 2FA settings notification~~ |
  | 421 |  | ~~\*/~~ |
  | 422 |  | ~~public static function user\_deleted\_2fa\_notice() {~~ |
  | 423 |  | ~~?>~~ |
  | 424 |  | ~~<div class="notice notice-success is-dismissible">~~ |
  | 425 |  | ~~<p><?php esc\_html\_e( 'Your 2FA settings have been removed.', 'wp-2fa' ); ?></p>~~ |
  | 426 |  | ~~<button type="button" class="notice-dismiss">~~ |
  | 427 |  | ~~<span class="screen-reader-text"><?php esc\_html\_e( 'Dismiss this notice.', 'wp-2fa' ); ?></span>~~ |
  | 428 |  | ~~</button>~~ |
  | 429 |  | ~~</div>~~ |
  | 430 |  | ~~<?php~~ |
  | 431 |  | ~~}~~ |
  | 432 |  |  |
  | 433 |  | ~~/\*\*~~ |
  | 434 |  | ~~\* Admin deleted user 2FA settings notification~~ |
  | 435 |  | ~~\*/~~ |
  | 436 |  | ~~public static function admin\_deleted\_2fa\_notice() {~~ |
  | 437 |  | ~~?>~~ |
  | 438 |  | ~~<div class="notice notice-success is-dismissible">~~ |
  | 439 |  | ~~<p><?php esc\_html\_e( 'User 2FA settings have been removed.', 'wp-2fa' ); ?></p>~~ |
  | 440 |  | ~~<button type="button" class="notice-dismiss">~~ |
  | 441 |  | ~~<span class="screen-reader-text"><?php esc\_html\_e( 'Dismiss this notice.', 'wp-2fa' ); ?></span>~~ |
  | 442 |  | ~~</button>~~ |
  | 443 |  | ~~</div>~~ |
  | 444 |  | ~~<?php~~ |
  | 445 | 229 | } |
  | 446 | 230 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L516) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L300) |  |
  | 516 | 300 | <div class="notice notice-error is-dismissible"> |
  | 517 | 301 | <?php |
  | 518 |  | $error = \~~wp\_unslash( $\_GET['wp\_2fa\_network\_settings\_error']~~ ); |
  |  | 302 | $error = \sanitize\_text\_field( \wp\_unslash( $\_GET['wp\_2fa\_network\_settings\_error'] ) ); |
  | 519 | 303 |  |
  | 520 | 304 | if ( true === \strpos( $error, 'http' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L542) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L326) |  |
  | 542 | 326 | \*/ |
  | 543 | 327 | public static function settings\_saved\_admin\_notice() { |
  | 544 |  | if ( isset( $\_GET['page'] ) && 0 === strpos( ~~$\_GET['page']~~, 'wp-2fa-' ) ) { |
  |  | 328 | if ( isset( $\_GET['page'] ) && 0 === strpos( \sanitize\_text\_field( \wp\_unslash( $\_GET['page'] ) ), 'wp-2fa-' ) ) { |
  | 545 | 329 | if ( isset( $\_GET['settings-updated'] ) && 'true' === $\_GET['settings-updated'] ) { |
  | 546 | 330 | $wp\_settings\_errors = get\_settings\_errors(); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L581) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L365) |  |
  | 581 | 365 | ?> |
  | 582 | 366 | <div class="notice notice-error is-dismissible"> |
  | 583 |  | <p><?php echo \esc\_attr( \esc\_url\_raw( \urldecode\_deep( \~~wp\_unslash( $\_GET['settings\_error']~~ ) ) ) ); ?></p> |
  |  | 367 | <p><?php echo \esc\_attr( \esc\_url\_raw( \urldecode\_deep( \sanitize\_text\_field( \wp\_unslash( $\_GET['settings\_error'] ) ) ) ) ); ?></p> |
  | 584 | 368 | <button type="button" class="notice-dismiss"> |
  | 585 | 369 | <span class="screen-reader-text"><?php esc\_html\_e( 'Dismiss this notice.', 'wp-2fa' ); ?></span> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=2940688#L669) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-settings-page.php?rev=3009922#L453) |  |
  | 669 | 453 |  |
  | 670 | 454 | /\*\* |
  | 671 |  | \* Checks if the backup codes option is enabled for the role |
  | 672 |  | \* |
  | 673 |  | \* @param string $role - The role name. |
  | 674 |  | \* |
  | 675 |  | \* @return bool |
  | 676 |  | \*/ |
  | 677 |  | public static function are\_backup\_codes\_enabled( $role = 'global' ) { |
  | 678 |  |  |
  | 679 |  | $role = ( is\_null( $role ) || empty( $role ) ) ? 'global' : $role; |
  | 680 |  |  |
  | 681 |  | if ( ! isset( self::$backup\_codes\_enabled[ $role ] ) ) { |
  | 682 |  | self::$backup\_codes\_enabled[ $role ] = false; |
  | 683 |  |  |
  | 684 |  | if ( 'global' === $role ) { |
  | 685 |  | $setting\_value = Settings::get\_role\_or\_default\_setting( 'backup\_codes\_enabled' ); |
  |  | 455 | \* Checks the email against the current domain and shows an error message if they do not match. |
  |  | 456 | \* |
  |  | 457 | \* @return void |
  |  | 458 | \* |
  |  | 459 | \* @since 2.6.0 |
  |  | 460 | \*/ |
  |  | 461 | public static function check\_email() { |
  |  | 462 | $is\_dismissed = (bool) Settings\_Utils::get\_option( 'dismiss\_notice\_mail\_domain', false ); |
  |  | 463 | if ( ! $is\_dismissed ) { |
  |  | 464 | $admin\_email = \get\_option( 'admin\_email' ); |
  |  | 465 |  |
  |  | 466 | if ( 'use-custom-email' === WP2FA::get\_wp2fa\_email\_templates( 'email\_from\_setting' ) ) { |
  |  | 467 | $admin\_email = WP2FA::get\_wp2fa\_email\_templates( 'custom\_from\_email\_address' ); |
  |  | 468 | } |
  |  | 469 | $site\_url    = \get\_site\_url(); |
  |  | 470 |  |
  |  | 471 | $email\_domain = WP\_Helper::extract\_domain( $admin\_email ); |
  |  | 472 | $site\_domain  = WP\_Helper::extract\_domain( $site\_url ); |
  |  | 473 |  |
  |  | 474 | if ( $email\_domain !== $site\_domain ) { |
  |  | 475 | $email\_settings\_url = esc\_url( |
  |  | 476 | add\_query\_arg( |
  |  | 477 | array( |
  |  | 478 | 'page' => 'wp-2fa-settings', |
  |  | 479 | 'tab'  => 'email-settings', |
  |  | 480 | ), |
  |  | 481 | network\_admin\_url( 'admin.php' ) |
  |  | 482 | ) |
  |  | 483 | ); |
  |  | 484 | ?> |
  |  | 485 | <div class="notice notice-error"> |
  |  | 486 | <p><?php esc\_html\_e( 'By default, the plugin uses the Administrator\'s email address as configured in WordPress settings as the "from address" when sending emails with the 2FA code for users to log in. This email address is currently configured as: ', 'wp-2fa' ); ?><b><?php echo $admin\_email; ?>.</b></p> |
  |  | 487 | <p> |
  |  | 488 | <a href="<?php echo \esc\_url( $email\_settings\_url ); ?>"><?php esc\_html\_e( 'Configure email address now', 'wp-2fa' ); ?></a> |
  |  | 489 | <a href="#" class="2fa-email-notice" style="margin-left:10px;"> |
  |  | 490 | <?php esc\_html\_e( 'Use the Administrator\'s email address.', 'wp-2fa' ); ?> |
  |  | 491 | </a> |
  |  | 492 | </p> |
  |  | 493 |  |
  |  | 494 | <?php wp\_nonce\_field( 'wp2fa\_dismiss\_notice\_mail\_domain', 'wp2fa\_dismiss\_notice\_mail\_domain', false ); ?> |
  |  | 495 | </div> |
  |  | 496 | <?php |
  | 686 | 497 | } else { |
  | 687 |  | $setting\_value = Settings::get\_role\_or\_default\_setting( 'backup\_codes\_enabled', 'current', $role ); |
  | 688 |  | } |
  | 689 |  | self::$backup\_codes\_enabled[ $role ] = Settings\_Utils::string\_to\_bool( $setting\_value ); |
  | 690 |  | } |
  | 691 |  |  |
  | 692 |  | return self::$backup\_codes\_enabled[ $role ]; |
  |  | 498 | Settings\_Utils::update\_option( 'dismiss\_notice\_mail\_domain', true ); |
  |  | 499 | } |
  |  | 500 | } |
  |  | 501 | } |
  |  | 502 |  |
  |  | 503 | /\*\* |
  |  | 504 | \* Sets the email domain do not match setting as dismissed. |
  |  | 505 | \* |
  |  | 506 | \* @return void |
  |  | 507 | \* |
  |  | 508 | \* @since 2.6.0 |
  |  | 509 | \*/ |
  |  | 510 | public static function dismiss\_notice\_mail\_domain() { |
  |  | 511 | // Verify nonce. |
  |  | 512 | if ( isset( $\_POST['nonce'] ) && \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_POST['nonce'] ) ), 'wp2fa\_dismiss\_notice\_mail\_domain' ) ) { |
  |  | 513 | Settings\_Utils::update\_option( 'dismiss\_notice\_mail\_domain', true ); |
  |  | 514 | die(); |
  |  | 515 | } |
  |  | 516 |  |
  |  | 517 | die( 'Nonce verification failed!' ); |
  | 693 | 518 | } |
  | 694 | 519 | } |
* ## [wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L12 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L12 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | namespace WP2FA\Admin; |
  | 13 | 13 |  |
  | 14 |  | use \WP2FA\Core as Core; |
  | 15 |  | use \WP2FA\WP2FA as WP2FA; |
  |  | 14 | use WP2FA\Methods\TOTP; |
  |  | 15 | use WP2FA\Core; |
  |  | 16 | use WP2FA\Methods\Email; |
  |  | 17 | use WP2FA\WP2FA; |
  |  | 18 | use WP2FA\Methods\Backup\_Codes; |
  | 16 | 19 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 17 | 20 | use WP2FA\Admin\Views\Wizard\_Steps; |
  | 18 | 21 | use WP2FA\Admin\Helpers\User\_Helper; |
  | 19 | 22 | use WP2FA\Admin\Controllers\Settings; |
  | 20 |  | use ~~\WP2FA\Utils\User\_Utils as~~ User\_Utils; |
  |  | 23 | use WP2FA\Utils\User\_Utils; |
  | 21 | 24 | use WP2FA\Admin\Views\First\_Time\_Wizard\_Steps; |
  | 22 |  | use ~~\WP2FA\Admin\Settings\_Page as~~ Settings\_Page; |
  | 23 |  | use WP2FA\Utils\Settings\_Utils~~as Settings\_Utils~~; |
  | 24 |  | use ~~\WP2FA\Utils\Generate\_Modal as~~ Generate\_Modal; |
  | 25 |  | use ~~\~~WP2FA\Admin\SettingsPages\Settings\_Page\_Policies; |
  | 26 |  | use ~~\WP2FA\Authenticator\Authentication as~~ Authentication; |
  |  | 25 | use WP2FA\Admin\Settings\_Page; |
  |  | 26 | use WP2FA\Utils\Settings\_Utils; |
  |  | 27 | use WP2FA\Utils\Generate\_Modal; |
  |  | 28 | use WP2FA\Admin\SettingsPages\Settings\_Page\_Policies; |
  |  | 29 | use WP2FA\Authenticator\Authentication; |
  | 27 | 30 |  |
  | 28 | 31 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L89) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L92) |  |
  | 89 | 92 | $settings       = WP2FA::get\_wp2fa\_setting(); |
  | 90 | 93 | if ( empty( $settings ) || ! isset( $settings ) ) { |
  |  | 94 | $settings\_saved = false; |
  |  | 95 | } |
  |  | 96 |  |
  |  | 97 | if ( Settings\_Utils::get\_option( 'wizard\_not\_finished' ) ) { |
  | 91 | 98 | $settings\_saved = false; |
  | 92 | 99 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L142) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L149) |  |
  | 142 | 149 | } |
  | 143 | 150 |  |
  | 144 |  | // Ensure user has minimum capabi~~tl~~ies needed to be here. |
  |  | 151 | // Ensure user has minimum capabilities needed to be here. |
  | 145 | 152 | if ( in\_array( 'can\_read', $user\_type, true ) && $settings\_saved ) { |
  | 146 | 153 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L163) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L170) |  |
  | 163 | 170 |  |
  | 164 | 171 | // Remove 1st step if only one method is available. |
  | 165 |  | if ( empty( WP2FA::get\_wp2fa\_setting( ~~'enable\_totp' ) ) || empty( WP2FA::get\_wp2fa\_setting( 'enable\_email'~~ ) ) ) { |
  |  | 172 | if ( empty( WP2FA::get\_wp2fa\_setting( TOTP::POLICY\_SETTINGS\_NAME ) ) || empty( WP2FA::get\_wp2fa\_setting( Email::POLICY\_SETTINGS\_NAME ) ) ) { |
  | 166 | 173 | unset( $wizard\_steps['choose\_2fa\_method'] ); |
  | 167 | 174 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L186) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L193) |  |
  | 186 | 193 | self::$current\_step = ! empty( $current\_step ) ? $current\_step : current( array\_keys( self::$wizard\_steps ) ); |
  | 187 | 194 |  |
  | 188 |  | if ( ~~'backup\_codes' === self::$current\_step && ! Settings\_Page::are\_backup\_codes\_enabled~~( User\_Helper::get\_user\_role( $user ) ) ) { |
  |  | 195 | if ( Backup\_Codes::METHOD\_NAME === self::$current\_step && ! Backup\_Codes::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ) ) { |
  | 189 | 196 |  |
  | 190 | 197 | $redirect\_to\_finish = add\_query\_arg( |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L215) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L222) |  |
  | 215 | 222 |  |
  | 216 | 223 | \WP2FA\Core\enqueue\_select2\_scripts(); |
  | 217 |  |  |
  | 218 |  | ~~if ( \WP2FA\Admin\Helpers\WP\_Helper::is\_multisite() ) {~~ |
  | 219 |  | ~~\WP2FA\Core\enqueue\_multi\_select\_scripts();~~ |
  | 220 |  | ~~}~~ |
  | 221 | 224 |  |
  | 222 | 225 | wp\_enqueue\_script( |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L297) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L300) |  |
  | 297 | 300 | <?php wp\_print\_scripts( 'wp\_2fa\_micromodal' ); ?> |
  | 298 | 301 | <?php wp\_print\_scripts( 'wp\_2fa\_admin' ); ?> |
  | 299 |  | ~~<?php wp\_print\_scripts( 'multi-site-select' ); ?>~~ |
  | 300 | 302 | <?php |
  | 301 | 303 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L344) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L346) |  |
  | 344 | 346 | 'notify-admin-settings-page', |
  | 345 | 347 | '', |
  | 346 |  | \_\_( 'If you cancel this wizard, the default plugin settings will be applied. You can always configure the plugin settings and two-factor authentication policies at a later stage from the ', 'wp-2fa' ) . ' <b>' . \_\_( 'WP 2FA', 'wp-2fa' ) . '</b>' . \_\_( ' entry in your WordPress dashboard menu.', 'wp-2fa' ), |
  |  | 348 | \_\_( 'If you cancel this wizard, the default plugin settings will be applied. You can always configure the plugin settings and two-factor authentication policies at a later stage from the ', 'wp-2fa' ) . ' <b>' . \_\_( 'WP 2FA', 'wp-2fa' ) . '</b>' . \_\_( ' entry in your WordPress dashboard menu.', 'wp-2fa' ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 347 | 349 | array( |
  | 348 |  | '<a href="#" id="close-settings" class="button button-primary wp-2fa-button-primary" data-redirect-url="' . esc\_url( $redirect ) . '">' . \_\_( 'OK, close wizard', 'wp-2fa' ) . '</a>', |
  | 349 |  | '<a href="#" class="button button-secondary wp-2fa-button-secondary wp-2fa-button-secondary" data-close-2fa-modal>' . \_\_( 'Continue with wizard', 'wp-2fa' ) . '</a>', |
  |  | 350 | '<a href="#" id="close-settings" class="button button-primary wp-2fa-button-primary" data-redirect-url="' . esc\_url( $redirect ) . '">' . \_\_( 'OK, close wizard', 'wp-2fa' ) . '</a>', // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 351 | '<a href="#" class="button button-secondary wp-2fa-button-secondary wp-2fa-button-secondary" data-close-2fa-modal>' . \_\_( 'Continue with wizard', 'wp-2fa' ) . '</a>', // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 350 | 352 | ), |
  | 351 | 353 | '', |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L453) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L455) |  |
  | 453 | 455 | private static function wp\_2fa\_step\_global\_2fa\_methods() { |
  | 454 | 456 | ?> |
  | 455 |  | <form method="post" class="wp2fa-setup-form wp2fa-form-styles" autocomplete="off"> |
  |  | 457 | <form method="post" class="wp2fa-setup-form wp2fa-form-styles wp2fa-first-time-wizard" autocomplete="off"> |
  | 456 | 458 | <?php wp\_nonce\_field( 'wp2fa-step-choose-method' ); ?> |
  | 457 | 459 | <div class="step-setting-wrapper active" data-step-title="<?php esc\_html\_e( '2FA methods', 'wp-2fa' ); ?>"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L531) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L533) |  |
  | 531 | 533 | \* Send email with fresh code, or to setup email 2fa. |
  | 532 | 534 | \* |
  | 533 |  | \* @param int    $user\_id User id we want to send the message to. |
  |  | 535 | \* @param int    $user\_id - User id we want to send the message to. |
  | 534 | 536 | \* @param string $nominated\_email\_address - The user custom address to use (name of the meta key to check for). |
  |  | 537 | \* @param bool   $is\_reset\_protection - That call is for reset code. |
  | 535 | 538 | \* |
  | 536 | 539 | \* @return bool |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L544) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L547) |  |
  | 544 | 547 | $nonce\_check = \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_POST['nonce'] ) ), 'wp-2fa-send-setup-email' ); |
  | 545 | 548 | if ( ! $nonce\_check ) { |
  |  | 549 | \wp\_send\_json\_error( new \WP\_Error( 400, \esc\_html\_\_( 'Nonce checking failed', 'wp-2fa' ) ), 400 ); |
  | 546 | 550 | return false; |
  | 547 | 551 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L562) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L566) |  |
  | 562 | 566 |  |
  | 563 | 567 | if ( wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
  | 564 |  | ~~update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', $email~~ ); |
  | 565 |  | } |
  | 566 |  |  |
  | 567 |  | $e~~nabled\_e~~mail\_address = ''; |
  |  | 568 | User\_Helper::set\_nominated\_email\_for\_user( $email, $user ); |
  |  | 569 | } |
  |  | 570 |  |
  |  | 571 | $email\_address = ''; |
  | 568 | 572 | if ( ! empty( $nominated\_email\_address ) ) { |
  | 569 |  | $enabled\_email\_address = get\_user\_meta( $user->ID, WP\_2FA\_PREFIX . $nominated\_email\_address, true ); |
  |  | 573 | if ( 'nominated\_email\_address' === $nominated\_email\_address ) { |
  |  | 574 | $email\_address = User\_Helper::get\_nominated\_email\_for\_user( $user ); |
  |  | 575 | } elseif ( 'backup\_email\_address' === $nominated\_email\_address ) { |
  |  | 576 | $email\_address = User\_Helper::get\_backup\_email\_for\_user( $user ); |
  |  | 577 | } |
  |  | 578 | } else { |
  |  | 579 | $email\_address = $user->user\_email; |
  | 570 | 580 | } |
  | 571 | 581 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L577) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L587) |  |
  | 577 | 587 | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'reset\_password\_code\_email\_subject' ), $user->ID ) ); |
  | 578 | 588 | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'reset\_password\_code\_email\_body' ), $user->ID, $token ) ); |
  | 579 |  | } elseif ( wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
  | 580 |  | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_email\_subject' ), $user->ID ) ); |
  |  | 589 | } elseif ( wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
  |  | 590 | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_setup\_email\_subject' ), $user->ID ) ); |
  | 581 | 591 | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_setup\_email\_body' ), $user->ID, $token ) ); |
  | 582 | 592 | } else { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L585) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922#L595) |  |
  | 585 | 595 | } |
  | 586 | 596 |  |
  | 587 |  | ~~if ( ! empty( $enabled\_email\_address ) ) {~~ |
  | 588 |  | ~~$email\_address = $enabled\_email\_address;~~ |
  | 589 |  | ~~} else {~~ |
  | 590 |  | ~~$email\_address = $user->user\_email;~~ |
  | 591 |  | ~~}~~ |
  | 592 |  |  |
  | 593 |  | ~~return Settings\_Page::send\_email( $email\_address, $subject, $message );~~ |
  | 594 |  | ~~}~~ |
  | 595 |  |  |
  | 596 |  | ~~/\*\*~~ |
  | 597 |  | ~~\* Send email with fresh code, or to setup email 2fa.~~ |
  | 598 |  | ~~\*~~ |
  | 599 |  | ~~\* @param int    $user\_id User id we want to send the message to.~~ |
  | 600 |  | ~~\* @param string $nominated\_email\_address - The user custom address to use (name of the meta key to check for).~~ |
  | 601 |  | ~~\*~~ |
  | 602 |  | ~~\* @return bool~~ |
  | 603 |  | ~~\*~~ |
  | 604 |  | ~~\* @SuppressWarnings(PHPMD.ExitExpression)~~ |
  | 605 |  | ~~\*/~~ |
  | 606 |  | ~~public static function send\_backup\_codes\_email( $user\_id, $nominated\_email\_address = 'nominated\_email\_address' ) {~~ |
  | 607 |  |  |
  | 608 | 597 | // If we have a nonce posted, check it. |
  | 609 | 598 | if ( \wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
  | 610 |  | $nonce\_check = \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_POST['nonce'] ) ), 'wp-2fa-send-backup-codes-email-nonce' ); |
  | 611 |  | if ( ! $nonce\_check ) { |
  |  | 599 | $mail\_sent = Settings\_Page::send\_email( $email\_address, $subject, $message ); |
  |  | 600 | if ( ! $mail\_sent ) { |
  |  | 601 | \wp\_send\_json\_error( new \WP\_Error( 500, \esc\_html\_\_( 'Email sending failed', 'wp-2fa' ) ), 400 ); |
  | 612 | 602 | return false; |
  | 613 | 603 | } |
  | 614 |  | } |
  | 615 |  |  |
  | 616 |  | if ( isset( $\_POST['user\_id'] ) ) { |
  | 617 |  | $user = get\_userdata( intval( $\_POST['user\_id'] ) ); |
  | 618 |  | } else { |
  | 619 |  | $user = get\_userdata( $user\_id ); |
  | 620 |  | } |
  | 621 |  |  |
  | 622 |  | // Grab email address is its provided. |
  | 623 |  | if ( isset( $\_POST['email\_address'] ) ) { |
  | 624 |  | $email = sanitize\_email( \wp\_unslash( $\_POST['email\_address'] ) ); |
  | 625 |  | } else { |
  | 626 |  | $email = sanitize\_email( $user->user\_email ); |
  | 627 |  | } |
  | 628 |  |  |
  | 629 |  | $enabled\_email\_address = ''; |
  | 630 |  | if ( ! empty( $nominated\_email\_address ) ) { |
  | 631 |  | $enabled\_email\_address = get\_user\_meta( $user->ID, WP\_2FA\_PREFIX . $nominated\_email\_address, true ); |
  | 632 |  | } |
  | 633 |  |  |
  | 634 |  | $codes = substr( str\_replace( '\\n', '<br>', \sanitize\_text\_field( \wp\_unslash( $\_POST['codes'] ) ) ), 1, -1 ); |
  | 635 |  |  |
  | 636 |  | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'user\_backup\_codes\_email\_subject' ), $user->ID ) ); |
  | 637 |  | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'user\_backup\_codes\_email\_body' ), $user->ID ) ); |
  | 638 |  |  |
  | 639 |  | $final\_output = str\_replace( '{backup\_codes}', $codes, $message ); |
  | 640 |  |  |
  | 641 |  | if ( ! empty( $enabled\_email\_address ) ) { |
  | 642 |  | $email\_address = $enabled\_email\_address; |
  | 643 |  | } else { |
  | 644 |  | $email\_address = $user->user\_email; |
  | 645 |  | } |
  | 646 |  |  |
  | 647 |  | return Settings\_Page::send\_email( $email\_address, $subject, $final\_output ); |
  | 648 |  | } |
  | 649 |  |  |
  | 650 |  | /\*\* |
  | 651 |  | \* Regenerates the TOTP key for the user |
  | 652 |  | \* |
  | 653 |  | \* @return void - JSON - object with "key" - stores the new key and "qr" - stores the new QR code. |
  | 654 |  | \* |
  | 655 |  | \* @since 2.5.0 |
  | 656 |  | \*/ |
  | 657 |  | public static function regenerate\_authentication\_key() { |
  | 658 |  | // Grab current user. |
  | 659 |  | $user = wp\_get\_current\_user(); |
  | 660 |  |  |
  | 661 |  | $key = Authentication::generate\_key(); |
  | 662 |  |  |
  | 663 |  | $site\_name = site\_url(); |
  | 664 |  | $site\_name = trim( str\_replace( array( 'http://', 'https://' ), '', $site\_name ), '/' ); |
  | 665 |  |  |
  | 666 |  | /\*\* |
  | 667 |  | \* Changing the title of the login screen for the TOTP method. |
  | 668 |  | \* |
  | 669 |  | \* @param string $title - The default title. |
  | 670 |  | \* @param \WP\_User $user - The WP user. |
  | 671 |  | \* |
  | 672 |  | \* @since 2.0.0 |
  | 673 |  | \*/ |
  | 674 |  | $totp\_title = apply\_filters( WP\_2FA\_PREFIX . 'totp\_title', $site\_name . ':' . $user->user\_login, $user ); |
  | 675 |  | $new\_qr     = Authentication::get\_google\_qr\_code( $totp\_title, $key, $site\_name ); |
  | 676 |  |  |
  | 677 |  | wp\_send\_json\_success( |
  | 678 |  | array( |
  | 679 |  | 'key' => Authentication::decrypt\_key\_if\_needed( $key ), |
  | 680 |  | 'qr'  => $new\_qr, |
  | 681 |  | ) |
  | 682 |  | ); |
  |  | 604 |  |
  |  | 605 | return $mail\_sent; |
  |  | 606 | } |
  |  | 607 |  |
  |  | 608 | return Settings\_Page::send\_email( $email\_address, $subject, $message ); |
  | 683 | 609 | } |
  | 684 | 610 |  |
* ## [wp-2fa/trunk/includes/classes/Admin/class-user-notices.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/class-user-notices.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/class-user-notices.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-notices.php?rev=2940688#L12 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-notices.php?rev=3009922#L12 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | namespace WP2FA\Admin; |
  | 13 | 13 |  |
  | 14 |  | use \WP2FA\WP2FA as WP2FA; |
  | 15 |  | use WP2FA\Utils\Date\_Time\_Utils; |
  |  | 14 | use WP2FA\WP2FA; |
  | 16 | 15 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 17 | 16 | use WP2FA\Freemius\User\_Licensing; |
  |  | 17 | use WP2FA\Admin\Controllers\Methods; |
  | 18 | 18 | use WP2FA\Admin\Helpers\User\_Helper; |
  | 19 | 19 | use WP2FA\Admin\Controllers\Settings; |
  | 20 | 20 | use WP2FA\Admin\Views\Grace\_Period\_Notifications; |
  |  | 21 | use WP2FA\Extensions\Integrations\Plugins\Woocommerce; |
  |  | 22 | use WP2FA\Extensions\Integrations\WP2FA\_Integrations; |
  | 21 | 23 | use WP2FA\Extensions\WhiteLabeling\White\_Labeling\_Render; |
  | 22 |  | ~~use WP2FA\Admin\Controllers\Methods;~~ |
  | 23 | 24 |  |
  | 24 | 25 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-notices.php?rev=2940688#L135) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-notices.php?rev=3009922#L136) |  |
  | 135 | 136 | if ( $show ) { |
  | 136 | 137 | echo '<div class="' . esc\_attr( $class ) . '">'; |
  | 137 |  | echo wpautop( wp\_kses\_post( WP2FA::replace\_remaining\_grace\_period( $message, (int) $grace\_expiry ) ) ); |
  |  | 138 | echo wpautop( wp\_kses\_post( WP2FA::replace\_remaining\_grace\_period( $message, (int) $grace\_expiry ) ) ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 138 | 139 | echo ' <a href="' . esc\_url( $setup\_url ) . '" class="button button-primary">' . esc\_html\_\_( 'Configure 2FA now', 'wp-2fa' ) . '</a>'; |
  | 139 | 140 | echo ' <a href="#" class="button button-secondary dismiss-user-configure-nag">' . esc\_html\_\_( 'Remind me on next login', 'wp-2fa' ) . '</a></p>'; |
* ## [wp-2fa/trunk/includes/classes/Admin/class-user-profile.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Admin/class-user-profile.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L12 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L12 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | namespace WP2FA\Admin; |
  | 13 | 13 |  |
  | 14 |  | use \WP2FA\WP2FA as WP2FA; |
  | 15 |  | use WP2FA\Admin\Settings\_Page; |
  |  | 14 | use WP2FA\WP2FA; |
  |  | 15 | use WP2FA\Methods\TOTP; |
  |  | 16 | use WP2FA\Utils\User\_Utils; |
  | 16 | 17 | use WP2FA\Methods\Backup\_Codes; |
  | 17 | 18 | use WP2FA\Utils\Generate\_Modal; |
  |  | 19 | use WP2FA\Utils\Settings\_Utils; |
  | 18 | 20 | use WP2FA\Authenticator\Open\_SSL; |
  | 19 | 21 | use WP2FA\Admin\Helpers\WP\_Helper; |
  |  | 22 | use WP2FA\Freemius\User\_Licensing; |
  | 20 | 23 | use WP2FA\Admin\Views\Wizard\_Steps; |
  | 21 | 24 | use WP2FA\Admin\Controllers\Methods; |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L23) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L26) |  |
  | 23 | 26 | use WP2FA\Admin\Controllers\Settings; |
  | 24 | 27 | use WP2FA\Authenticator\Authentication; |
  | 25 |  | use \WP2FA\Utils\User\_Utils as User\_Utils; |
  | 26 |  | use WP2FA\Utils\Settings\_Utils as Settings\_Utils; |
  | 27 |  | use WP2FA\Freemius\User\_Licensing as User\_Licensing; |
  |  | 28 | use WP2FA\Extensions\OutOfBand\Out\_Of\_Band; |
  |  | 29 | use WP2FA\Methods\Email; |
  | 28 | 30 |  |
  | 29 | 31 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L102) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L104) |  |
  | 102 | 104 | User\_Utils::in\_array\_all( array( 'no\_required\_has\_enabled' ), $user\_type ) |
  | 103 | 105 | ) { |
  | 104 |  | // Create wizard link based on which 2fa methods are allowed by admin. |
  | 105 |  | if ( ! empty( Settings::get\_role\_or\_default\_setting( 'enable\_totp', $user ) ) && ! empty( Settings::get\_role\_or\_default\_setting( 'enable\_email', $user ) ) ) { |
  | 106 |  | $setup\_2fa\_url = add\_query\_arg( |
  | 107 |  | array( |
  | 108 |  | 'page'         => 'wp-2fa-setup', |
  | 109 |  | 'current-step' => 'user\_choose\_2fa\_method', |
  | 110 |  | 'wizard\_type'  => 'user\_2fa\_config', |
  | 111 |  | ), |
  | 112 |  | admin\_url( $page\_url ) |
  | 113 |  | ); |
  | 114 |  | } else { |
  | 115 |  | $setup\_2fa\_url = add\_query\_arg( |
  | 116 |  | array( |
  | 117 |  | 'page'         => 'wp-2fa-setup', |
  | 118 |  | 'current-step' => 'reconfigure\_method', |
  | 119 |  | 'wizard\_type'  => 'user\_reconfigure\_config', |
  | 120 |  | ), |
  | 121 |  | admin\_url( $page\_url ) |
  | 122 |  | ); |
  |  | 106 |  |
  |  | 107 | if ( isset( $additional\_args['is\_shortcode'] ) && $additional\_args['is\_shortcode'] ) { |
  |  | 108 | $form\_content = ''; |
  |  | 109 |  |
  |  | 110 | /\*\* |
  |  | 111 | \* Gives the ability to remove the user's settings. |
  |  | 112 | \* |
  |  | 113 | \* @param bool - The status of the settings. |
  |  | 114 | \* |
  |  | 115 | \* @since 2.2.2 |
  |  | 116 | \*/ |
  |  | 117 | $show\_enable2fa = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting', true ); |
  |  | 118 |  |
  |  | 119 | /\*\* |
  |  | 120 | \* Gives the ability to change the user profile description message. |
  |  | 121 | \* |
  |  | 122 | \* @param bool - The status of the settings. |
  |  | 123 | \* |
  |  | 124 | \* @since 2.4.0 |
  |  | 125 | \*/ |
  |  | 126 | $description = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting\_description', $description ); |
  |  | 127 |  |
  |  | 128 | $styling\_class = ( empty( WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_styling' ) ) ) ? 'default\_styling' : 'enable\_styling'; |
  |  | 129 |  |
  |  | 130 | if ( $show\_enable2fa ) { |
  |  | 131 | $form\_content = '<a href="#" class="button button-primary remove-2fa ' . esc\_attr( $styling\_class ) . '" data-open-configure-2fa-wizard>' . esc\_html\_\_( 'Change 2FA settings', 'wp-2fa' ) . '</a>'; |
  |  | 132 | } |
  |  | 133 |  |
  |  | 134 | if ( self::can\_user\_remove\_2fa( $user->ID ) ) { |
  |  | 135 | $form\_content .= '<a href="#" class="button button-primary remove-2fa ' . esc\_attr( $styling\_class ) . '" onclick="MicroModal.show(\'confirm-remove-2fa\');">' . esc\_html\_\_( 'Remove 2FA', 'wp-2fa' ) . '</a>'; |
  |  | 136 | } |
  |  | 137 |  |
  |  | 138 | $form\_content     .= '</td><tr><th class="backup-methods-label">'; |
  |  | 139 | $backup\_codes\_desc = ''; |
  |  | 140 | if ( Backup\_Codes::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ) ) { |
  |  | 141 | $codes\_remaining = Backup\_Codes::codes\_remaining\_for\_user( $user ); |
  |  | 142 | if ( $codes\_remaining > 0 ) { |
  |  | 143 | $backup\_codes\_desc = '<span class="description mt-5px">' . esc\_attr( (int) $codes\_remaining ) . ' ' . esc\_html\_\_( 'unused backup codes remaining.', 'wp-2fa' ) . '</span>'; |
  |  | 144 | } elseif ( 0 === $codes\_remaining ) { |
  |  | 145 | $backup\_codes\_desc = '<a class="learn\_more\_link" href="https://melapress.com/2fa-backup-codes/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">' . esc\_html\_\_( 'Learn more about backup codes', 'wp-2fa' ) . '</a>'; |
  |  | 146 | } |
  |  | 147 |  |
  |  | 148 | if ( ! empty( $backup\_codes\_desc ) ) { |
  |  | 149 | $backup\_codes\_desc = Wizard\_Steps::get\_backup\_codes\_link() . $backup\_codes\_desc; |
  |  | 150 | } |
  |  | 151 | } |
  |  | 152 |  |
  |  | 153 | /\*\* |
  |  | 154 | \* Add an option for external providers to add their own user form buttons. |
  |  | 155 | \* |
  |  | 156 | \* @since 2.0.0 |
  |  | 157 | \*/ |
  |  | 158 | $backup\_codes\_desc = apply\_filters( WP\_2FA\_PREFIX . 'additional\_form\_buttons', $backup\_codes\_desc ); |
  |  | 159 |  |
  |  | 160 | if ( ! empty( $backup\_codes\_desc ) ) { |
  |  | 161 | $form\_content .= Wizard\_Steps::get\_generate\_codes\_label() . $backup\_codes\_desc; |
  |  | 162 | } |
  |  | 163 |  |
  |  | 164 | $form\_content .= '</th></tr>'; |
  | 123 | 165 | } |
  | 124 |  |  |
  | 125 |  | // Create backup codes URL. |
  | 126 |  | $backup\_codes\_url = add\_query\_arg( |
  | 127 |  | array( |
  | 128 |  | 'page'         => 'wp-2fa-setup', |
  | 129 |  | 'current-step' => 'backup\_codes', |
  | 130 |  | 'wizard\_type'  => 'backup\_codes\_config', |
  | 131 |  | ), |
  | 132 |  | admin\_url( $page\_url ) |
  | 133 |  | ); |
  |  | 166 | } |
  |  | 167 |  |
  |  | 168 | $show\_if\_user\_is\_not\_in = array( |
  |  | 169 | 'user\_is\_excluded', |
  |  | 170 | 'has\_enabled\_methods', |
  |  | 171 | 'no\_required\_has\_enabled', |
  |  | 172 | ); |
  |  | 173 |  |
  |  | 174 | // User viewing own profile and needs to enable 2FA. |
  |  | 175 | if ( |
  |  | 176 | User\_Utils::in\_array\_all( array( 'user\_needs\_to\_setup\_2fa' ), $user\_type ) || |
  |  | 177 | User\_Utils::role\_is\_not( $show\_if\_user\_is\_not\_in, $user\_type ) |
  |  | 178 | ) { |
  |  | 179 |  |
  |  | 180 | $first\_time\_setup\_url = Settings::get\_setup\_page\_link(); |
  | 134 | 181 |  |
  | 135 | 182 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L142) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L189) |  |
  | 142 | 189 | $show\_enable2fa = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting', true ); |
  | 143 | 190 |  |
  |  | 191 |  |
  | 144 | 192 | /\*\* |
  | 145 | 193 | \* Gives the ability to change the user profile description message. |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L151) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L199) |  |
  | 151 | 199 | $description = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting\_description', $description ); |
  | 152 | 200 |  |
  |  | 201 | $styling\_class = ( empty( WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_styling' ) ) ) ? 'default\_styling' : 'enable\_styling'; |
  |  | 202 |  |
  | 153 | 203 | if ( $show\_enable2fa ) { |
  | 154 |  | $form\_content .= '<a href="' . esc\_url( $setup\_2fa\_url ) . '" class="button button-primary">' . esc\_html\_\_( 'Change 2FA Settings', 'wp-2fa' ) . '</a>'; |
  | 155 |  | } |
  | 156 |  |  |
  | 157 |  | if ( self::can\_user\_remove\_2fa( $user->ID ) ) { |
  | 158 |  | $form\_content .= '<a href="#" class="button button-primary remove-2fa" onclick="MicroModal.show(\'confirm-remove-2fa\');">' . esc\_html\_\_( 'Remove 2FA', 'wp-2fa' ) . '</a>'; |
  | 159 |  | } |
  | 160 |  |  |
  | 161 |  | $form\_content .= '<br /><br />'; |
  | 162 |  |  |
  | 163 |  | if ( Settings\_Page::are\_backup\_codes\_enabled( User\_Helper::get\_user\_role( $user ) ) ) { |
  | 164 |  | $form\_content .= '<a href="' . esc\_url( $backup\_codes\_url ) . '" class="button button-primary">' . esc\_html\_\_( 'Generate list of Backup Codes', 'wp-2fa' ) . '</a>'; |
  | 165 |  |  |
  | 166 |  | $codes\_remaining = Backup\_Codes::codes\_remaining\_for\_user( $user ); |
  | 167 |  | if ( $codes\_remaining > 0 ) { |
  | 168 |  | $form\_content .= '<span class="description mt-5px">' . esc\_attr( (int) $codes\_remaining ) . ' ' . esc\_html\_\_( 'unused backup codes remaining.', 'wp-2fa' ) . '</span>'; |
  | 169 |  | } elseif ( 0 === $codes\_remaining ) { |
  | 170 |  | $form\_content .= '<a class="learn\_more\_link" href="https://melapress.com/2fa-backup-codes/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">' . esc\_html\_\_( 'Learn more about backup codes', 'wp-2fa' ) . '</a>'; |
  |  | 204 |  |
  |  | 205 | if ( isset( $additional\_args['is\_shortcode'] ) && $additional\_args['is\_shortcode'] ) { |
  |  | 206 | $form\_content .= '<a href="#" class="button button-primary ' . esc\_attr( $styling\_class ) . '" data-open-configure-2fa-wizard>' . esc\_html\_\_( 'Configure 2FA', 'wp-2fa' ) . '</a>'; |
  | 171 | 207 | } |
  | 172 |  | ~~}~~ |
  | 173 |  |  |
  | 174 |  | ~~if ( isset( $additional\_args['is\_shortcode'] ) && $additional\_args['is\_shortcode'] ) {~~ |
  | 175 |  | ~~$form\_content = '';~~ |
  | 176 |  |  |
  | 177 |  | ~~/\*\*~~ |
  | 178 |  | ~~\* Gives the ability to remove the user's settings.~~ |
  | 179 |  | ~~\*~~ |
  | 180 |  | ~~\* @param bool - The status of the settings.~~ |
  | 181 |  | ~~\*~~ |
  | 182 |  | ~~\* @since 2.2.2~~ |
  | 183 |  | ~~\*/~~ |
  | 184 |  | ~~$show\_enable2fa = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting', true );~~ |
  | 185 |  |  |
  | 186 |  | ~~/\*\*~~ |
  | 187 |  | ~~\* Gives the ability to change the user profile description message.~~ |
  | 188 |  | ~~\*~~ |
  | 189 |  | ~~\* @param bool - The status of the settings.~~ |
  | 190 |  | ~~\*~~ |
  | 191 |  | ~~\* @since 2.4.0~~ |
  | 192 |  | ~~\*/~~ |
  | 193 |  | ~~$description = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting\_description', $description );~~ |
  | 194 |  |  |
  | 195 |  | ~~$styling\_class = ( empty( WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_styling' ) ) ) ? 'default\_styling' : 'enable\_styling';~~ |
  | 196 |  |  |
  | 197 |  | ~~if ( $show\_enable2fa ) {~~ |
  | 198 |  | ~~$form\_content = '<a href="#" class="button button-primary remove-2fa ' . esc\_attr\_\_( $styling\_class ) . '" data-open-configure-2fa-wizard>' . esc\_html\_\_( 'Change 2FA settings', 'wp-2fa' ) . '</a>';~~ |
  | 199 |  | ~~}~~ |
  | 200 |  |  |
  | 201 |  | ~~if ( self::can\_user\_remove\_2fa( $user->ID ) ) {~~ |
  | 202 |  | ~~$form\_content .= '<a href="#" class="button button-primary remove-2fa ' . esc\_attr\_\_( $styling\_class ) . '" onclick="MicroModal.show(\'confirm-remove-2fa\');">' . esc\_html\_\_( 'Remove 2FA', 'wp-2fa' ) . '</a>';~~ |
  | 203 |  | ~~}~~ |
  | 204 |  |  |
  | 205 |  | ~~$form\_content     .= '</td><tr><th class="backup-methods-label">';~~ |
  | 206 |  | ~~$backup\_codes\_desc = '';~~ |
  | 207 |  | ~~if ( Settings\_Page::are\_backup\_codes\_enabled( User\_Helper::get\_user\_role( $user ) ) ) {~~ |
  | 208 |  | ~~$codes\_remaining = Backup\_Codes::codes\_remaining\_for\_user( $user );~~ |
  | 209 |  | ~~if ( $codes\_remaining > 0 ) {~~ |
  | 210 |  | ~~$backup\_codes\_desc = '<span class="description mt-5px">' . esc\_attr( (int) $codes\_remaining ) . ' ' . esc\_html\_\_( 'unused backup codes remaining.', 'wp-2fa' ) . '</span>';~~ |
  | 211 |  | ~~} elseif ( 0 === $codes\_remaining ) {~~ |
  | 212 |  | ~~$backup\_codes\_desc = '<a class="learn\_more\_link" href="https://melapress.com/2fa-backup-codes/?utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank">' . esc\_html\_\_( 'Learn more about backup codes', 'wp-2fa' ) . '</a>';~~ |
  | 213 |  | ~~}~~ |
  | 214 |  |  |
  | 215 |  | ~~if ( ! empty( $backup\_codes\_desc ) ) {~~ |
  | 216 |  | ~~$backup\_codes\_desc = Wizard\_Steps::get\_backup\_codes\_link() . $backup\_codes\_desc;~~ |
  | 217 |  | ~~}~~ |
  | 218 |  | ~~}~~ |
  | 219 |  |  |
  | 220 |  | ~~/\*\*~~ |
  | 221 |  | ~~\* Add an option for external providers to add their own user form buttons.~~ |
  | 222 |  | ~~\*~~ |
  | 223 |  | ~~\* @since 2.0.0~~ |
  | 224 |  | ~~\*/~~ |
  | 225 |  | ~~$backup\_codes\_desc = apply\_filters( WP\_2FA\_PREFIX . 'additional\_form\_buttons', $backup\_codes\_desc );~~ |
  | 226 |  |  |
  | 227 |  | ~~if ( ! empty( $backup\_codes\_desc ) ) {~~ |
  | 228 |  | ~~$form\_content .= Wizard\_Steps::get\_generate\_codes\_label() . $backup\_codes\_desc;~~ |
  | 229 |  | ~~}~~ |
  | 230 |  |  |
  | 231 |  | ~~$form\_content .= '</th></tr>';~~ |
  | 232 |  | ~~}~~ |
  | 233 |  | ~~}~~ |
  | 234 |  |  |
  | 235 |  | ~~$show\_if\_user\_is\_not\_in = array(~~ |
  | 236 |  | ~~'user\_is\_excluded',~~ |
  | 237 |  | ~~'has\_enabled\_methods',~~ |
  | 238 |  | ~~'no\_required\_has\_enabled',~~ |
  | 239 |  | ~~);~~ |
  | 240 |  |  |
  | 241 |  | ~~// User viewing own profile and needs to enable 2FA.~~ |
  | 242 |  | ~~if (~~ |
  | 243 |  | ~~User\_Utils::in\_array\_all( array( 'user\_needs\_to\_setup\_2fa' ), $user\_type ) ||~~ |
  | 244 |  | ~~User\_Utils::role\_is\_not( $show\_if\_user\_is\_not\_in, $user\_type )~~ |
  | 245 |  | ~~) {~~ |
  | 246 |  |  |
  | 247 |  | ~~$first\_time\_setup\_url = Settings::get\_setup\_page\_link();~~ |
  | 248 |  |  |
  | 249 |  | ~~/\*\*~~ |
  | 250 |  | ~~\* Gives the ability to remove the user's settings.~~ |
  | 251 |  | ~~\*~~ |
  | 252 |  | ~~\* @param bool - The status of the settings.~~ |
  | 253 |  | ~~\*~~ |
  | 254 |  | ~~\* @since 2.2.2~~ |
  | 255 |  | ~~\*/~~ |
  | 256 |  | ~~$show\_enable2fa = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting', true );~~ |
  | 257 |  |  |
  | 258 |  |  |
  | 259 |  | ~~/\*\*~~ |
  | 260 |  | ~~\* Gives the ability to change the user profile description message.~~ |
  | 261 |  | ~~\*~~ |
  | 262 |  | ~~\* @param bool - The status of the settings.~~ |
  | 263 |  | ~~\*~~ |
  | 264 |  | ~~\* @since 2.4.0~~ |
  | 265 |  | ~~\*/~~ |
  | 266 |  | ~~$description = \apply\_filters( WP\_2FA\_PREFIX . 'enable\_2fa\_user\_setting\_description', $description );~~ |
  | 267 |  |  |
  | 268 |  | ~~$styling\_class = ( empty( WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_styling' ) ) ) ? 'default\_styling' : 'enable\_styling';~~ |
  | 269 |  |  |
  | 270 |  | ~~if ( $show\_enable2fa ) {~~ |
  | 271 |  |  |
  | 272 |  | ~~if ( isset( $additional\_args['is\_shortcode'] ) && $additional\_args['is\_shortcode'] ) {~~ |
  | 273 |  | ~~$form\_content .= '<a href="#" class="button button-primary ' . esc\_attr\_\_( $styling\_class ) . '" data-open-configure-2fa-wizard>' . esc\_html\_\_( 'Configure 2FA', 'wp-2fa' ) . '</a>';~~ |
  | 274 |  | ~~}~~ |
  | 275 | 208 |  |
  | 276 | 209 | if ( empty( $additional\_args ) ) { |
  | 277 |  | $form\_content .= '<a href="' . esc\_url( $first\_time\_setup\_url ) . '" class="button button-primary ' . esc\_attr~~\_\_~~( $styling\_class ) . '">' . esc\_html\_\_( 'Configure Two-factor authentication (2FA)', 'wp-2fa' ) . '</a>'; |
  |  | 210 | $form\_content .= '<a href="' . esc\_url( $first\_time\_setup\_url ) . '" class="button button-primary ' . esc\_attr( $styling\_class ) . '">' . esc\_html\_\_( 'Configure Two-factor authentication (2FA)', 'wp-2fa' ) . '</a>'; |
  | 278 | 211 | } |
  | 279 | 212 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L326) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L259) |  |
  | 326 | 259 |  |
  | 327 | 260 | if ( $show\_form\_table && ! empty( $form\_content ) ) { |
  |  | 261 |  |
  |  | 262 | $enabled\_methods        = User\_Helper::get\_enabled\_method\_for\_user( $user ); |
  |  | 263 | $primary\_label          = ( isset( $enabled\_methods ) && ! empty( $enabled\_methods ) ) ? Settings::get\_providers\_translate\_names()[ $enabled\_methods ] : esc\_html\_\_( 'No enabled primary method', 'wp-2fa' ); |
  |  | 264 | $enabled\_backup\_methods = User\_Helper::get\_enabled\_backup\_methods\_for\_user( $user ); |
  |  | 265 | $backup\_methods\_enabled = esc\_html\_\_( 'No enabled backup methods', 'wp-2fa' ); |
  |  | 266 |  |
  |  | 267 | if ( isset( $enabled\_backup\_methods ) && ! empty( $enabled\_backup\_methods ) ) { |
  |  | 268 | $backup\_methods\_enabled = \implode( ', ', $enabled\_backup\_methods ); |
  |  | 269 | } |
  |  | 270 |  |
  |  | 271 | $form\_output .= '<h3>' . esc\_html\_\_( 'Currently configured:', 'wp-2fa' ) . '</h3>'; |
  |  | 272 |  |
  |  | 273 | $form\_output .= ' |
  |  | 274 | <table class="form-table wp-2fa-user-profile-form" role="presentation"> |
  |  | 275 | <tbody> |
  |  | 276 | <tr> |
  |  | 277 | <th><label>' . esc\_html\_\_( 'Primary method:', 'wp-2fa' ) . '</label></th> |
  |  | 278 | <td> |
  |  | 279 | ' . $primary\_label . ' |
  |  | 280 | </td> |
  |  | 281 | </tr>'; |
  |  | 282 |  |
  |  | 283 | $form\_output .= ' |
  |  | 284 | <tr> |
  |  | 285 | <th><label>' . esc\_html\_\_( 'Secondary method(s):', 'wp-2fa' ) . '</label></th> |
  |  | 286 | <td> |
  |  | 287 | ' . $backup\_methods\_enabled . ' |
  |  | 288 | </td> |
  |  | 289 | </tr>'; |
  |  | 290 |  |
  |  | 291 | $form\_output .= ' |
  |  | 292 | </tbody> |
  |  | 293 | </table>'; |
  |  | 294 |  |
  |  | 295 | $form\_output .= '<h3>' . esc\_html\_\_( '2FA configuration:', 'wp-2fa' ) . '</h3>'; |
  |  | 296 |  |
  |  | 297 | if ( User\_Utils::in\_array\_all( array( 'has\_enabled\_methods', 'viewing\_own\_profile' ), $user\_type ) && isset( $enabled\_methods ) && TOTP::METHOD\_NAME === $enabled\_methods ) { |
  |  | 298 | $form\_output .= ' |
  |  | 299 | <table class="form-table wp-2fa-user-profile-form remove-tr-padding" role="presentation"> |
  |  | 300 | <tbody> |
  |  | 301 | <tr> |
  |  | 302 | <th><label>' . Settings::get\_providers\_translate\_names()[ $enabled\_methods ] . '</label></th> |
  |  | 303 | <td> |
  |  | 304 | <details> |
  |  | 305 | <summary class="qr-btn">' . esc\_html\_\_( 'Show QR code', 'wp-2fa' ) . '</summary> |
  |  | 306 | <p><img class="qr-code" src="' . ( TOTP::get\_qr\_code() ) . '" /></p> |
  |  | 307 | <div class="app-key-wrapper"> |
  |  | 308 | <input type="text" id="app-key-input" readonly value="' . esc\_html( TOTP::get\_totp\_decrypted() ) . '" class="app-key"> |
  |  | 309 | ' . |
  |  | 310 | ( ( is\_ssl() ) ? |
  |  | 311 | '<span class="click-to-copy">' . esc\_html\_\_( 'COPY', 'wp-2fa' ) . '</span>' : '' ) . ' |
  |  | 312 | </div> |
  |  | 313 | </details> |
  |  | 314 | </td> |
  |  | 315 | </tr> |
  |  | 316 | </tbody> |
  |  | 317 | </table>'; |
  |  | 318 | } |
  |  | 319 |  |
  | 328 | 320 | $form\_output .= ' |
  | 329 | 321 | <table class="form-table wp-2fa-user-profile-form" role="presentation"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L370) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L362) |  |
  | 370 | 362 |  |
  | 371 | 363 | if ( User\_Utils::in\_array\_all( array( 'user\_needs\_to\_setup\_2fa', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( 'has\_enabled\_methods', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( 'no\_required\_not\_enabled', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( User\_Helper::USER\_UNDETERMINED\_STATUS, 'viewing\_own\_profile' ), $user\_type ) ) { ?> |
  | 372 |  | <div> |
  | 373 |  | <div class="wp2fa-modal micromodal-slide <?php echo esc\_attr( $styling\_class ); ?>" id="configure-2fa" aria-hidden="true"> |
  | 374 |  | <div class="modal\_\_overlay" tabindex="-1"> |
  | 375 |  | <div class="modal\_\_container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title"> |
  | 376 |  | <?php |
  | 377 |  | echo Generate\_Modal::generate\_modal( // phpcs:ignore |
  | 378 |  | 'notify-users', |
  | 379 |  | \_\_( 'Are you sure?', 'wp-2fa' ), |
  | 380 |  | \_\_( 'Any unsaved changes will be lost!', 'wp-2fa' ), |
  | 381 |  | array( |
  | 382 |  | '<button class="button wp-2fa-button-primary button-primary button-confirm" aria-label="Close this dialog window and the wizard">' . esc\_html\_\_( 'Yes', 'wp-2fa' ) . '</button>', |
  | 383 |  | '<button class="button wp-2fa-button-secondary button-secondary button-decline" data-micromodal-close aria-label="Close this dialog window">' . esc\_html\_\_( 'No', 'wp-2fa' ) . '</button>', |
  | 384 |  | ), |
  | 385 |  | '', |
  | 386 |  | '430px' |
  | 387 |  | ); |
  | 388 |  | ?> |
  | 389 |  | <button class="modal\_\_close" aria-label="Close modal"></button> |
  | 390 |  | <main class="modal\_\_content wp2fa-form-styles" id="modal-1-content"> |
  | 391 |  | <?php |
  | 392 |  | $logo\_url     = WP2FA::get\_wp2fa\_white\_label\_setting( 'logo-code-page', false ); |
  | 393 |  | $logo\_section = ( $logo\_url ) ? '<p class="modal-logo-wrapper"><img style="max-height: 60px;margin: 0 auto 30px;" src="' . esc\_url( $logo\_url ) . '" /></p>' : ''; |
  | 394 |  | $enable\_logo  = WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_logo', false ); |
  | 395 |  |  |
  | 396 |  | if ( $enable\_logo ) { |
  | 397 |  | echo $logo\_section; // phpcs:ignore \*/ |
  | 398 |  | } |
  | 399 |  |  |
  | 400 |  | if ( User\_Utils::in\_array\_all( array( 'user\_needs\_to\_setup\_2fa', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( 'no\_required\_not\_enabled', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( User\_Helper::USER\_UNDETERMINED\_STATUS, 'viewing\_own\_profile' ), $user\_type ) ) { |
  | 401 |  |  |
  | 402 |  | $available\_methods = Methods::get\_enabled\_methods( User\_Helper::get\_user\_role( $user ) ); |
  | 403 |  | $optional\_welcome  = WP2FA::get\_wp2fa\_white\_label\_setting( 'welcome', false ); |
  | 404 |  | $enable\_welcome    = WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_welcome', false ); |
  | 405 |  |  |
  | 406 |  | $intro\_text = ''; |
  | 407 |  | if ( count( $available\_methods[ User\_Helper::get\_user\_role( $user ) ] ) > 1 ) { |
  | 408 |  | $intro\_text = WP2FA::replace\_wizard\_strings( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_selection', true ), $user ); |
  | 409 |  | } elseif ( 1 === count( $available\_methods[ User\_Helper::get\_user\_role( $user ) ] ) ) { |
  | 410 |  | $intro\_text = WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_selection\_single', true ); |
  | 411 |  | } else { |
  | 412 |  | $intro\_text = '<h3>' . \_\_( 'No available 2FA methods set', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Ask your administrator to enable 2FA methods', 'wp-2fa' ) . '</p>'; |
  |  | 364 | <div> |
  |  | 365 | <div class="wp2fa-modal micromodal-slide <?php echo esc\_attr( $styling\_class ); ?>" id="configure-2fa" aria-hidden="true"> |
  |  | 366 | <div class="modal\_\_overlay" tabindex="-1"> |
  |  | 367 | <div class="modal\_\_container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title"> |
  |  | 368 | <?php |
  |  | 369 | echo Generate\_Modal::generate\_modal( // phpcs:ignore |
  |  | 370 | 'notify-users', |
  |  | 371 | \_\_( 'Are you sure?', 'wp-2fa' ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 372 | \_\_( 'Any unsaved changes will be lost!', 'wp-2fa' ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 373 | array( |
  |  | 374 | '<button class="button wp-2fa-button-primary button-primary button-confirm" aria-label="Close this dialog window and the wizard">' . esc\_html\_\_( 'Yes', 'wp-2fa' ) . '</button>', |
  |  | 375 | '<button class="button wp-2fa-button-secondary button-secondary button-decline" data-micromodal-close aria-label="Close this dialog window">' . esc\_html\_\_( 'No', 'wp-2fa' ) . '</button>', |
  |  | 376 | ), |
  |  | 377 | '', |
  |  | 378 | '430px' |
  |  | 379 | ); |
  |  | 380 | ?> |
  |  | 381 | <button class="modal\_\_close modal\_cancel" aria-label="Close modal"></button> |
  |  | 382 | <main class="modal\_\_content wp2fa-form-styles" id="modal-1-content"> |
  |  | 383 | <?php |
  |  | 384 | $logo\_url     = WP2FA::get\_wp2fa\_white\_label\_setting( 'logo-code-page', false ); |
  |  | 385 | $logo\_section = ( $logo\_url ) ? '<p class="modal-logo-wrapper"><img style="max-height: 60px;margin: 0 auto 30px;" src="' . esc\_url( $logo\_url ) . '" /></p>' : ''; |
  |  | 386 | $enable\_logo  = WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_wizard\_logo', false ); |
  |  | 387 |  |
  |  | 388 | if ( $enable\_logo ) { |
  |  | 389 | echo $logo\_section; // phpcs:ignore \*/ |
  | 413 | 390 | } |
  | 414 | 391 |  |
  | 415 |  | if ( ! empty( $optional\_welcome ) && $enable\_welcome ) { |
  | 416 |  | Wizard\_Steps::optional\_user\_welcome\_step(); |
  | 417 |  | } |
  | 418 |  | ?> |
  | 419 |  |  |
  | 420 |  | <div class="wizard-step <?php echo ( empty( $optional\_welcome ) ) ? 'active' : ''; ?>" id="choose-2fa-method"> |
  | 421 |  | <div class="mb-20"><?php echo wp\_kses\_post( $intro\_text ); ?></div> |
  | 422 |  | <fieldset class="radio-cells"> |
  | 423 |  | <?php Wizard\_Steps::totp\_option(); ?> |
  | 424 |  | <?php Wizard\_Steps::email\_option(); ?> |
  | 425 |  |  |
  | 426 |  | <?php |
  | 427 |  | /\*\* |
  | 428 |  | \* Add an option for external providers to add their own 2fa methods options. |
  | 429 |  | \* |
  | 430 |  | \* @since 2.0.0 |
  | 431 |  | \*/ |
  | 432 |  | do\_action( WP\_2FA\_PREFIX . 'methods\_options' ); |
  | 433 |  | ?> |
  | 434 |  | </fieldset> |
  | 435 |  | <br> |
  | 436 |  | <?php |
  | 437 |  | if ( 0 !== count( $available\_methods[ User\_Helper::get\_user\_role( $user ) ] ) ) { |
  | 438 |  | ?> |
  | 439 |  | <a href="#" class="button wp-2fa-button-primary button-primary 2fa-choose-method" data-name="next\_step\_setting\_modal\_wizard" data-next-step><?php esc\_html\_e( 'Next Step', 'wp-2fa' ); ?></a> |
  | 440 |  | <?php |
  |  | 392 | if ( User\_Utils::in\_array\_all( array( 'user\_needs\_to\_setup\_2fa', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( 'no\_required\_not\_enabled', 'viewing\_own\_profile' ), $user\_type ) || User\_Utils::in\_array\_all( array( User\_Helper::USER\_UNDETERMINED\_STATUS, 'viewing\_own\_profile' ), $user\_type ) ) { |
  |  | 393 |  |
  |  | 394 | $available\_methods = Methods::get\_enabled\_methods( User\_Helper::get\_user\_role( $user ) ); |
  |  | 395 | $optional\_welcome  = WP2FA::get\_wp2fa\_white\_label\_setting( 'welcome', false ); |
  |  | 396 | $enable\_welcome    = WP2FA::get\_wp2fa\_white\_label\_setting( 'enable\_welcome', false ); |
  |  | 397 |  |
  |  | 398 | $intro\_text = ''; |
  |  | 399 | if ( count( $available\_methods[ User\_Helper::get\_user\_role( $user ) ] ) > 1 ) { |
  |  | 400 | $intro\_text = WP2FA::replace\_wizard\_strings( WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_selection', true ), $user ); |
  |  | 401 | } elseif ( 1 === count( $available\_methods[ User\_Helper::get\_user\_role( $user ) ] ) ) { |
  |  | 402 | $intro\_text = WP2FA::get\_wp2fa\_white\_label\_setting( 'method\_selection\_single', true ); |
  |  | 403 | } else { |
  |  | 404 | $intro\_text = '<h3>' . \_\_( 'No available 2FA methods set', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Ask your administrator to enable 2FA methods', 'wp-2fa' ) . '</p>'; |
  |  | 405 | } |
  |  | 406 |  |
  |  | 407 | if ( ! empty( $optional\_welcome ) && $enable\_welcome ) { |
  |  | 408 | Wizard\_Steps::optional\_user\_welcome\_step(); |
  | 441 | 409 | } |
  | 442 | 410 | ?> |
  | 443 |  | <button class="button wp-2fa-button-secondary button-secondary" data-close-2fa-modal aria-label="Close this dialog window"><?php esc\_html\_e( 'Cancel', 'wp-2fa' ); ?></button> |
  | 444 |  | </div> |
  | 445 |  | <?php } ?> |
  | 446 |  |  |
  | 447 |  | <?php if ( User\_Utils::in\_array\_all( array( 'has\_enabled\_methods', 'viewing\_own\_profile' ), $user\_type ) ) { ?> |
  | 448 |  | <div class="wizard-step active"> |
  | 449 |  | <fieldset class="radio-cells max-3"> |
  | 450 |  | <?php Wizard\_Steps::totp\_re\_configure(); ?> |
  | 451 |  | <?php Wizard\_Steps::email\_re\_configure(); ?> |
  |  | 411 |  |
  |  | 412 | <div class="wizard-step <?php echo ( empty( $optional\_welcome ) ) ? 'active' : ''; ?>" id="choose-2fa-method"> |
  |  | 413 | <div class="mb-20"><?php echo wp\_kses\_post( $intro\_text ); ?></div> |
  |  | 414 | <fieldset class="radio-cells"> |
  | 452 | 415 | <?php |
  | 453 | 416 | /\*\* |
  | 454 |  | \* Add~~an option for external providers to add their own reconfigure methods options~~. |
  |  | 417 | \* Adds an option for external providers to add their own 2fa methods options. And sorts them (our logic). |
  | 455 | 418 | \* |
  | 456 | 419 | \* @since 2.0.0 |
  | 457 | 420 | \*/ |
  | 458 |  | do\_action( WP\_2FA\_PREFIX . 'methods\_~~reconfigure\_~~options' ); |
  |  | 421 | do\_action( WP\_2FA\_PREFIX . 'methods\_options' ); |
  | 459 | 422 | ?> |
  | 460 |  | </fieldset> |
  |  | 423 | </fieldset> |
  |  | 424 | <br> |
  |  | 425 | <?php |
  |  | 426 | if ( 0 !== count( $available\_methods[ User\_Helper::get\_user\_role( $user ) ] ) ) { |
  |  | 427 | ?> |
  |  | 428 | <a href="#" class="button wp-2fa-button-primary button-primary 2fa-choose-method" data-name="next\_step\_setting\_modal\_wizard" data-next-step><?php esc\_html\_e( 'Next Step', 'wp-2fa' ); ?></a> |
  |  | 429 | <?php |
  |  | 430 | } |
  |  | 431 | ?> |
  |  | 432 | <button class="button wp-2fa-button-secondary button-secondary" data-close-2fa-modal aria-label="Close this dialog window"><?php esc\_html\_e( 'Cancel', 'wp-2fa' ); ?></button> |
  |  | 433 | </div> |
  |  | 434 | <?php } ?> |
  |  | 435 |  |
  |  | 436 | <?php if ( User\_Utils::in\_array\_all( array( 'has\_enabled\_methods', 'viewing\_own\_profile' ), $user\_type ) ) { ?> |
  |  | 437 | <div class="wizard-step active"> |
  |  | 438 | <fieldset class="radio-cells max-3"> |
  |  | 439 | <?php |
  |  | 440 | /\*\* |
  |  | 441 | \* Add an option for external providers to add their own reconfigure methods options. |
  |  | 442 | \* |
  |  | 443 | \* @since 2.0.0 |
  |  | 444 | \*/ |
  |  | 445 | do\_action( WP\_2FA\_PREFIX . 'methods\_reconfigure\_options' ); |
  |  | 446 | ?> |
  |  | 447 | </fieldset> |
  |  | 448 | </div> |
  |  | 449 | <?php } ?> |
  |  | 450 |  |
  |  | 451 | <?php Wizard\_Steps::show\_modal\_methods(); ?> |
  |  | 452 | <?php |
  |  | 453 |  |
  |  | 454 | $backup\_methods = Settings::get\_enabled\_backup\_methods\_for\_user\_role( $user ); |
  |  | 455 |  |
  |  | 456 | if ( count( $backup\_methods ) > 1 ) { |
  |  | 457 | Wizard\_Steps::choose\_backup\_method(); |
  |  | 458 | } |
  |  | 459 |  |
  |  | 460 | /\*\* |
  |  | 461 | \* Add an option for external providers to add their own wizard steps. |
  |  | 462 | \* |
  |  | 463 | \* @since 2.0.0 |
  |  | 464 | \*/ |
  |  | 465 | do\_action( WP\_2FA\_PREFIX . 'additional\_settings\_steps' ); |
  |  | 466 |  |
  |  | 467 | // Create a nonce for use in ajax call to generate codes. |
  |  | 468 | if ( Backup\_Codes::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ) ) { |
  |  | 469 | ?> |
  |  | 470 | <div class="wizard-step" id="2fa-wizard-config-backup-codes"> |
  |  | 471 | <?php Wizard\_Steps::backup\_codes\_configure(); ?> |
  |  | 472 | <?php Wizard\_Steps::generated\_backup\_codes(); ?> |
  |  | 473 | </div> |
  |  | 474 | <?php } else { ?> |
  |  | 475 | <div class="wizard-step" id="2fa-wizard-config-backup-codes"> |
  |  | 476 | <?php Wizard\_Steps::congratulations\_step(); ?> |
  | 461 | 477 | </div> |
  | 462 | 478 | <?php } ?> |
  | 463 |  |  |
  | 464 |  | <?php Wizard\_Steps::show\_modal\_methods(); ?> |
  | 465 |  | <?php |
  | 466 |  |  |
  | 467 |  | $backup\_methods = Settings::get\_enabled\_backup\_methods\_for\_user\_role( $user ); |
  | 468 |  |  |
  | 469 |  | if ( count( $backup\_methods ) > 1 ) { |
  | 470 |  | Wizard\_Steps::choose\_backup\_method(); |
  | 471 |  | } |
  | 472 |  |  |
  | 473 |  | /\*\* |
  | 474 |  | \* Add an option for external providers to add their own wizard steps. |
  | 475 |  | \* |
  | 476 |  | \* @since 2.0.0 |
  | 477 |  | \*/ |
  | 478 |  | do\_action( WP\_2FA\_PREFIX . 'additional\_settings\_steps' ); |
  | 479 |  |  |
  | 480 |  | // Create a nonce for use in ajax call to generate codes. |
  | 481 |  | if ( Settings\_Page::are\_backup\_codes\_enabled( User\_Helper::get\_user\_role( $user ) ) ) { |
  | 482 |  | ?> |
  | 483 |  | <div class="wizard-step" id="2fa-wizard-config-backup-codes"> |
  | 484 |  | <?php Wizard\_Steps::backup\_codes\_configure(); ?> |
  | 485 |  | <?php Wizard\_Steps::generated\_backup\_codes(); ?> |
  | 486 |  | </div> |
  | 487 |  | <?php } else { ?> |
  | 488 |  | <div class="wizard-step" id="2fa-wizard-config-backup-codes"> |
  | 489 |  | <?php Wizard\_Steps::congratulations\_step(); ?> |
  | 490 |  | </div> |
  | 491 |  | <?php } ?> |
  | 492 |  | </main> |
  |  | 479 | </main> |
  |  | 480 | </div> |
  | 493 | 481 | </div> |
  | 494 | 482 | </div> |
  | 495 | 483 | </div> |
  | 496 |  | ~~</div>~~ |
  | 497 | 484 | <?php } ?> |
  | 498 | 485 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L506) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L493) |  |
  | 506 | 493 | ?> |
  | 507 | 494 |  |
  | 508 |  | <?php if ( Settings\_Page::are\_backup\_codes\_enabled( User\_Helper::get\_user\_role( $user ) ) ) { ?> |
  | 509 |  | <div> |
  | 510 |  | <div class="wp2fa-modal micromodal-slide <?php echo esc\_attr( $styling\_class ); ?>" id="configure-2fa-backup-codes" aria-hidden="true"> |
  | 511 |  | <div class="modal\_\_overlay" tabindex="-1"> |
  | 512 |  | <div class="modal\_\_container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title"> |
  | 513 |  | <button class="modal\_\_close" aria-label="Close modal" data-close-2fa-modal></button> |
  | 514 |  | <main class="modal\_\_content wp2fa-form-styles" id="modal-1-content"> |
  | 515 |  | <?php Wizard\_Steps::generated\_backup\_codes( true ); ?> |
  | 516 |  | </main> |
  |  | 495 | <?php if ( Backup\_Codes::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ) ) { ?> |
  |  | 496 | <div> |
  |  | 497 | <div class="wp2fa-modal micromodal-slide <?php echo esc\_attr( $styling\_class ); ?>" id="configure-2fa-backup-codes" aria-hidden="true"> |
  |  | 498 | <div class="modal\_\_overlay" tabindex="-1"> |
  |  | 499 | <div class="modal\_\_container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title"> |
  |  | 500 | <button class="modal\_\_close modal\_cancel" aria-label="Close modal" data-close-2fa-modal></button> |
  |  | 501 | <main class="modal\_\_content wp2fa-form-styles" id="modal-1-content"> |
  |  | 502 | <?php Wizard\_Steps::generated\_backup\_codes( true ); ?> |
  |  | 503 | </main> |
  |  | 504 | </div> |
  | 517 | 505 | </div> |
  | 518 | 506 | </div> |
  | 519 | 507 | </div> |
  | 520 |  | ~~</div>~~ |
  | 521 | 508 | <?php } ?> |
  | 522 |  | <div> |
  |  | 509 | <div> |
  | 523 | 510 | <?php |
  | 524 | 511 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L526) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L513) |  |
  | 526 | 513 | echo Generate\_Modal::generate\_modal( // phpcs:ignore |
  | 527 | 514 | 'confirm-remove-2fa', |
  | 528 |  | \_\_( 'Remove 2FA?', 'wp-2fa' ), |
  | 529 |  | \_\_( 'Are you sure you want to remove two-factor authentication and lower the security of your user account?', 'wp-2fa' ), |
  |  | 515 | \_\_( 'Remove 2FA?', 'wp-2fa' ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 516 | \_\_( 'Are you sure you want to remove two-factor authentication and lower the security of your user account?', 'wp-2fa' ), // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 530 | 517 | array( |
  | 531 |  | '<a href="#" class="button wp-2fa-button-primary button-confirm" data-trigger-remove-2fa data-user-id="' . esc\_attr( $user->ID ) . '" ~~data-nonce="' . wp\_create\_nonce( 'wp-2fa-remove-user-2fa-nonce' ) . '">' . esc\_html\_\_( 'Yes', 'wp-2fa' ) . '</a>',~~ |
  |  | 518 | '<a href="#" class="button wp-2fa-button-primary button-confirm" data-trigger-remove-2fa data-user-id="' . esc\_attr( $user->ID ) . '" ' . WP\_Helper::create\_data\_nonce( 'wp-2fa-remove-user-2fa-nonce' ) . '>' . esc\_html\_\_( 'Yes', 'wp-2fa' ) . '</a>', // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 532 | 519 | '<button class="modal\_\_btn  wp-2fa-button-secondary  button button-decline" data-close-2fa-modal aria-label="Close this dialog window">' . esc\_html\_\_( 'No', 'wp-2fa' ) . '</button>', |
  | 533 | 520 | ) |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L535) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L522) |  |
  | 535 | 522 | endif; |
  | 536 | 523 | ?> |
  | 537 |  | </div> |
  |  | 524 | </div> |
  | 538 | 525 | <?php |
  | 539 | 526 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L547) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L534) |  |
  | 547 | 534 | \* Produces the 2FA configuration form for network users, or any user with no roles. |
  | 548 | 535 | \* |
  | 549 |  | \* @param string  $is\_shortcode - ~~Is it called from the shortcode~~. |
  |  | 536 | \* @param string  $is\_shortcode - Current logic expects that to be set always. |
  | 550 | 537 | \* @param boolean $show\_preamble - Show / hide preamble. |
  | 551 | 538 | \* |
  | 552 | 539 | \* @return void |
  | 553 | 540 | \*/ |
  | 554 |  | public static function inline\_2fa\_profile\_form( $is\_shortcode = '', $show\_preamble = true ) { |
  |  | 541 | public static function inline\_2fa\_profile\_form( $is\_shortcode = 'true', $show\_preamble = true ) { |
  | 555 | 542 |  |
  | 556 | 543 | if ( isset( $\_GET['user\_id'] ) ) { // phpcs:ignore |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L565) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L552) |  |
  | 565 | 552 |  |
  | 566 | 553 | if ( \is\_multisite() ) { |
  | 567 |  | if ( '' === trim( \WP2FA\Admin\Helpers\User\_Helper::get\_user\_role( $user ) ) ) { |
  |  | 554 | if ( '' === trim( (string) \WP2FA\Admin\Helpers\User\_Helper::get\_user\_role( $user ) ) ) { |
  | 568 | 555 | return; |
  | 569 | 556 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L605) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L592) |  |
  | 605 | 592 | $actions['edit\_badges'] = '<a href="' . esc\_url( $url ) . '">' . esc\_html\_\_( 'Unlock user', 'wp-2fa' ) . '</a>'; |
  | 606 | 593 | } |
  |  | 594 |  |
  | 607 | 595 | return $actions; |
  | 608 | 596 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L639) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L627) |  |
  | 639 | 627 | ( ! isset( $\_POST['custom-oob-email-address'] ) || isset( $\_POST['custom-oob-email-address'] ) && empty( $\_POST['custom-oob-email-address'] ) ) ) { |
  | 640 | 628 | if ( isset( $\_POST['email'] ) ) { |
  | 641 |  | ~~update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', $\_POST['email']~~ ); |
  |  | 629 | User\_Helper::set\_nominated\_email\_for\_user( $\_POST['email'], $user ); |
  | 642 | 630 | } elseif ( isset( $\_POST['wp\_2fa\_email\_address'] ) && isset( $\_POST['wp-2fa-totp-authcode'] ) && ! empty( $\_POST['wp-2fa-totp-authcode'] ) ) { |
  | 643 |  | ~~update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', $\_POST['wp\_2fa\_email\_address']~~ ); |
  |  | 631 | User\_Helper::set\_nominated\_email\_for\_user( $\_POST['wp\_2fa\_email\_address'], $user ); |
  | 644 | 632 | } elseif ( isset( $\_POST['wp\_2fa\_email\_oob\_address'] ) && isset( $\_POST['wp-2fa-oob-authcode'] ) && ! empty( $\_POST['wp-2fa-oob-authcode'] ) ) { |
  | 645 | 633 | if ( 'use\_custom\_email' !== $\_POST['wp\_2fa\_email\_oob\_address'] ) { |
  | 646 |  | update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', $\_POST['wp\_2fa\_email\_oob\_address'] ); |
  | 647 |  | } else { |
  | 648 |  | update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', $user->user\_email ); |
  |  | 634 | User\_Helper::set\_nominated\_email\_for\_user( $\_POST['wp\_2fa\_email\_oob\_address'], $user ); |
  | 649 | 635 | } |
  | 650 | 636 | } |
  | 651 | 637 | } elseif ( isset( $\_POST['custom-email-address'] ) && ! empty( $\_POST['custom-email-address'] ) ) { |
  | 652 |  | ~~update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', sanitize\_email( wp\_unslash( $\_POST['custom-email-address'] ) )~~ ); |
  |  | 638 | User\_Helper::set\_nominated\_email\_for\_user( $\_POST['custom-email-address'], $user ); |
  | 653 | 639 | } elseif ( isset( $\_POST['custom-oob-email-address'] ) && ! empty( $\_POST['custom-oob-email-address'] ) ) { |
  | 654 |  | ~~update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', sanitize\_email( wp\_unslash( $\_POST['custom-oob-email-address'] ) )~~ ); |
  |  | 640 | User\_Helper::set\_nominated\_email\_for\_user( $\_POST['custom-oob-email-address'], $user ); |
  | 655 | 641 | } |
  | 656 | 642 |  |
  | 657 | 643 | // Check its one of our options. |
  | 658 |  | if ( ( isset( $\_POST['wp\_2fa\_enabled\_methods'] ) && ~~'totp'~~ === $\_POST['wp\_2fa\_enabled\_methods'] ) || |
  | 659 |  | ( isset( $\_POST['wp\_2fa\_enabled\_methods'] ) && ~~'email'~~ === $\_POST['wp\_2fa\_enabled\_methods'] ) || |
  | 660 |  | ( isset( $\_POST['wp\_2fa\_enabled\_methods'] ) && ~~'oob' === $\_POST['wp\_2fa\_enabled\_methods']~~ ) ) { |
  |  | 644 | if ( ( isset( $\_POST['wp\_2fa\_enabled\_methods'] ) && TOTP::METHOD\_NAME === $\_POST['wp\_2fa\_enabled\_methods'] ) || |
  |  | 645 | ( isset( $\_POST['wp\_2fa\_enabled\_methods'] ) && Email::METHOD\_NAME === $\_POST['wp\_2fa\_enabled\_methods'] ) || |
  |  | 646 | ( isset( $\_POST['wp\_2fa\_enabled\_methods'] ) && ( class\_exists( '\WP2FA\Extensions\OutOfBand\Out\_Of\_Band', false ) && Out\_Of\_Band::METHOD\_NAME === $\_POST['wp\_2fa\_enabled\_methods'] ) ) ) { |
  | 661 | 647 | User\_Helper::set\_enabled\_method\_for\_user(sanitize\_text\_field( wp\_unslash( $\_POST['wp\_2fa\_enabled\_methods'] ) ), $user); |
  | 662 | 648 | self::delete\_expire\_and\_enforced\_keys( $user->ID ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L665) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L651) |  |
  | 665 | 651 |  |
  | 666 | 652 | if ( isset( $\_POST['wp-2fa-email-authcode'] ) && ! empty( $\_POST['wp-2fa-email-authcode'] ) ) { |
  | 667 |  | User\_Helper::set\_enabled\_method\_for\_user( ~~'email'~~, $user ); |
  |  | 653 | User\_Helper::set\_enabled\_method\_for\_user( Email::METHOD\_NAME, $user ); |
  | 668 | 654 | self::delete\_expire\_and\_enforced\_keys( $user->ID ); |
  | 669 | 655 | User\_Helper::set\_user\_status( $user ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L671) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L657) |  |
  | 671 | 657 |  |
  | 672 | 658 | if ( isset( $\_POST['wp-2fa-totp-authcode'] ) && ! empty( $\_POST['wp-2fa-totp-authcode'] ) ) { |
  | 673 |  | ~~User\_Helper::set\_enabled\_method\_for\_user( 'totp', $user );~~ |
  | 674 |  |  |
  | 675 | 659 | $totp\_key = $\_POST['wp-2fa-totp-key']; |
  | 676 | 660 | if ( Authentication::is\_valid\_key( $totp\_key ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L678) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L662) |  |
  | 678 | 662 | $totp\_key = Open\_SSL::SECRET\_KEY\_PREFIX . Open\_SSL::encrypt( $totp\_key ); |
  | 679 | 663 | } |
  | 680 |  | User\_Helper::set\_user\_totp\_key( $totp\_key, $user ); |
  | 681 |  | self::delete\_expire\_and\_enforced\_keys( $user->ID ); |
  | 682 |  | User\_Helper::set\_user\_status( $user ); |
  |  | 664 |  |
  |  | 665 | TOTP::set\_user\_method( $user, $totp\_key ); |
  | 683 | 666 | } |
  | 684 | 667 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=2940688#L787) | […](/browser/wp-2fa/trunk/includes/classes/Admin/class-user-profile.php?rev=3009922#L770) |  |
  | 787 | 770 | // is no grace period. |
  | 788 | 771 | $enforcement\_policy = WP2FA::get\_wp2fa\_setting( 'enforcement-policy' ); |
  |  | 772 |  |
  | 789 | 773 | if ( 'all-users' === $enforcement\_policy ) { |
  | 790 | 774 | // enforced for all users, target user is definitely included. |
  | 791 | 775 | return false; |
  |  | 776 | } |
  |  | 777 |  |
  |  | 778 | if ( 'certain-roles-only' === $enforcement\_policy && ! User\_Helper::is\_enforced( $user\_id ) ) { |
  |  | 779 | // Users specific role is not enforced, allow removal. |
  |  | 780 | return true; |
  | 792 | 781 | } |
  | 793 | 782 |  |
* ## [wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php](/changeset/3009922/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=2940688#L62 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=3009922#L62 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | if ( 'configure-right-away' === Settings::get\_role\_or\_default\_setting( 'grace-policy-after-expire-action', $user ) ) { |
  | 63 | 63 | User\_Helper::set\_user\_enforced\_instantly( true, $user ); |
  |  | 64 |  |
  | 64 | 65 | return false; |
  | 65 | 66 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=2940688#L111) | […](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=3009922#L112) |  |
  | 111 | 112 | public static function is\_set\_up\_immediately\_set( \WP\_User $user ) { |
  | 112 | 113 | if ( 'configure-right-away' === Settings::get\_role\_or\_default\_setting( 'grace-policy-after-expire-action', $user ) ) { |
  |  | 114 |  |
  | 113 | 115 | return true; |
  | 114 | 116 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=2940688#L128) | […](/browser/wp-2fa/trunk/includes/classes/App/grace-period/class-grace-period.php?rev=3009922#L130) |  |
  | 128 | 130 | public static function add\_default\_settings( array $default\_settings ) { |
  | 129 | 131 | $default\_settings['grace-policy-after-expire-action'] = 'configure-right-away'; |
  |  | 132 |  |
  | 130 | 133 | return $default\_settings; |
  | 131 | 134 | } |
* ## [wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=2940688#L18 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922#L18 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 18 | 18 | \*/ |
  | 19 | 19 |  |
  |  | 20 | declare(strict\_types=1); |
  |  | 21 |  |
  | 20 | 22 | namespace WP2FA\Authenticator; |
  | 21 | 23 |  |
  | 22 | 24 | use WP2FA\Authenticator\Open\_SSL; |
  | 23 | 25 | use WP2FA\Admin\Helpers\User\_Helper; |
  |  | 26 | use WP2FA\_Vendor\Endroid\QrCode\QrCode; |
  | 24 | 27 | use WP2FA\Admin\Methods\Traits\Login\_Attempts; |
  | 25 |  | ~~use WP2FA\_Vendor\Endroid\QrCode\QrCode;~~ |
  | 26 | 28 | use WP2FA\_Vendor\Endroid\QrCode\Writer\SvgWriter; |
  | 27 | 29 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=2940688#L152) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922#L154) |  |
  | 152 | 154 |  |
  | 153 | 155 | foreach ( str\_split( $string ) as $character ) { |
  | 154 |  | $binary\_string .= str\_pad( base\_convert( ord( $character ), 10, 2 ), 8, '0', STR\_PAD\_LEFT ); |
  |  | 156 | $binary\_string .= str\_pad( base\_convert( (string) ord( $character ), 10, 2 ), 8, '0', STR\_PAD\_LEFT ); |
  | 155 | 157 | } |
  | 156 | 158 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=2940688#L166) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922#L168) |  |
  | 166 | 168 |  |
  | 167 | 169 | /\*\* |
  | 168 |  | \* Get the TOTP secret key for a user. |
  | 169 |  | \* |
  | 170 |  | \* @param  int $user\_id User ID. |
  | 171 |  | \* |
  | 172 |  | \* @return string |
  | 173 |  | \*/ |
  | 174 |  | public static function get\_user\_totp\_key( $user\_id ) { |
  | 175 |  |  |
  | 176 |  | $key = (string) User\_Helper::get\_user\_totp\_key( $user\_id ); |
  | 177 |  |  |
  | 178 |  | $test = $key; |
  | 179 |  |  |
  | 180 |  | if ( Open\_SSL::is\_ssl\_available() && false !== \strpos( $key, 'ssl\_' ) ) { |
  | 181 |  |  |
  | 182 |  | /\*\* |
  | 183 |  | \* Old key detected - convert. |
  | 184 |  | \*/ |
  | 185 |  | $key = Open\_SSL::decrypt\_legacy( substr( $key, 4 ) ); |
  | 186 |  |  |
  | 187 |  | User\_Helper::remove\_user\_totp\_key(); |
  | 188 |  |  |
  | 189 |  | $secret = Open\_SSL::encrypt( $key ); |
  | 190 |  |  |
  | 191 |  | if ( Open\_SSL::is\_ssl\_available() ) { |
  | 192 |  | $secret = Open\_SSL::SECRET\_KEY\_PREFIX . $secret; |
  | 193 |  | } |
  | 194 |  |  |
  | 195 |  | User\_Helper::set\_user\_totp\_key( $key, $user\_id ); |
  | 196 |  |  |
  | 197 |  | $test = $key = (string) User\_Helper::get\_user\_totp\_key( $user\_id ); // phpcs:ignore |
  | 198 |  | } |
  | 199 |  |  |
  | 200 |  | // We've tried tried to use WP core functionality, but that doesn't work - lets update. |
  | 201 |  | if ( Open\_SSL::is\_ssl\_available() && false !== \strpos( $key, 'wps\_' ) ) { |
  | 202 |  |  |
  | 203 |  | /\*\* |
  | 204 |  | \* Old key detected - convert. |
  | 205 |  | \*/ |
  | 206 |  | $key = Open\_SSL::decrypt\_wps( substr( $key, 4 ) ); |
  | 207 |  |  |
  | 208 |  | User\_Helper::remove\_user\_totp\_key(); |
  | 209 |  |  |
  | 210 |  | $secret = Open\_SSL::encrypt( $key ); |
  | 211 |  |  |
  | 212 |  | if ( Open\_SSL::is\_ssl\_available() ) { |
  | 213 |  | $secret = Open\_SSL::SECRET\_KEY\_PREFIX . $secret; |
  | 214 |  | } |
  | 215 |  |  |
  | 216 |  | User\_Helper::set\_user\_totp\_key( $key, $user\_id ); |
  | 217 |  |  |
  | 218 |  | $test = $key = (string) User\_Helper::get\_user\_totp\_key( $user\_id ); // phpcs:ignore |
  | 219 |  | } |
  | 220 |  |  |
  | 221 |  | self::decrypt\_key\_if\_needed( $test ); |
  | 222 |  |  |
  | 223 |  | if ( ! self::is\_valid\_key( $test ) ) { |
  | 224 |  | $key = self::generate\_key(); |
  | 225 |  | User\_Helper::set\_user\_totp\_key( $key, $user\_id ); |
  | 226 |  | self::$decrypted\_key = ''; |
  | 227 |  | } |
  | 228 |  |  |
  | 229 |  | return $key; |
  |  | 170 | \* Clears the value of the decrypted key |
  |  | 171 | \* |
  |  | 172 | \* @return void |
  |  | 173 | \* |
  |  | 174 | \* @since 2.6.0 |
  |  | 175 | \*/ |
  |  | 176 | public static function clear\_decrypted\_key() { |
  |  | 177 | self::$decrypted\_key = ''; |
  | 230 | 178 | } |
  | 231 | 179 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=2940688#L316) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922#L264) |  |
  | 316 | 264 | ) % pow( 10, $digits ); |
  | 317 | 265 |  |
  | 318 |  | return str\_pad( $code, $digits, '0', STR\_PAD\_LEFT ); |
  |  | 266 | return str\_pad( (string) $code, $digits, '0', STR\_PAD\_LEFT ); |
  | 319 | 267 | } |
  | 320 | 268 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=2940688#L463) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922#L411) |  |
  | 463 | 411 | self::clear\_login\_attempts( $user ); |
  | 464 | 412 |  |
  | 465 |  | \delete\_transient( 'wp2fa\_code\_login\_' . $user\_id ); |
  |  | 413 | \delete\_transient( 'wp\_2fa\_code\_login\_' . $user\_id ); |
  | 466 | 414 |  |
  | 467 | 415 | return true; |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=2940688#L596) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-authentication.php?rev=3009922#L544) |  |
  | 596 | 544 | \*/ |
  | 597 | 545 | public static function decrypt\_key\_if\_needed( string &$key ): string { |
  | 598 |  | if ( '' === trim( self::$decrypted\_key ) ) { |
  |  | 546 | if ( '' === trim( (string) self::$decrypted\_key ) ) { |
  | 599 | 547 | if ( Open\_SSL::is\_ssl\_available() && false !== \strpos( $key, Open\_SSL::SECRET\_KEY\_PREFIX ) ) { |
  | 600 | 548 | $key = self::$decrypted\_key = Open\_SSL::decrypt( substr( $key, 4 ) ); // phpcs:ignore |
* ## [wp-2fa/trunk/includes/classes/Authenticator/class-login.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Authenticator/class-login.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Authenticator/class-login.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  |  | 13 |  |
  | 12 | 14 | namespace WP2FA\Authenticator; |
  | 13 | 15 |  |
  | 14 |  | use \WP2FA\WP2FA; |
  | 15 |  | use \WP2FA\Admin\Setup\_Wizard; |
  | 16 |  | use WP2FA\Admin\Settings\_Page; |
  |  | 16 | use WP2FA\WP2FA; |
  |  | 17 | use WP2FA\Methods\TOTP; |
  |  | 18 | use WP2FA\Methods\Email; |
  |  | 19 | use WP2FA\Admin\Setup\_Wizard; |
  | 17 | 20 | use WP2FA\Methods\Backup\_Codes; |
  | 18 |  | ~~use WP2FA\Utils\Date\_Time\_Utils;~~ |
  | 19 | 21 | use WP2FA\Admin\Helpers\WP\_Helper; |
  |  | 22 | use WP2FA\Admin\Controllers\Methods; |
  | 20 | 23 | use WP2FA\Admin\Helpers\User\_Helper; |
  | 21 | 24 | use WP2FA\Admin\Controllers\Settings; |
  |  | 25 | use WP2FA\Authenticator\Authentication; |
  |  | 26 | use WP2FA\Methods\Wizards\TOTP\_Wizard\_Steps; |
  |  | 27 | use WP2FA\Admin\Views\Grace\_Period\_Notifications; |
  | 22 | 28 | use WP2FA\Admin\SettingsPages\Settings\_Page\_Policies; |
  | 23 |  | ~~use \WP2FA\Authenticator\Authentication;~~ |
  | 24 |  | ~~use WP2FA\Admin\Views\Grace\_Period\_Notifications;~~ |
  | 25 |  | ~~use WP2FA\Extensions\RoleSettings\Role\_Settings\_Controller;~~ |
  | 26 |  | ~~use WP2FA\Admin\Controllers\Methods;~~ |
  | 27 | 29 |  |
  | 28 | 30 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L70) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L72) |  |
  | 70 | 72 |  |
  | 71 | 73 | /\*\* |
  |  | 74 | \* Leave the memberpress alone |
  |  | 75 | \* |
  |  | 76 | \* @return bool |
  |  | 77 | \* |
  |  | 78 | \* @since 2.6.0 |
  |  | 79 | \*/ |
  |  | 80 | public static function mepr\_login(): bool { |
  |  | 81 | \remove\_action( 'wp\_login', array( '\WP2FA\Authenticator\Login', 'wp\_login' ), 20, 2 ); |
  |  | 82 |  |
  |  | 83 | return true; |
  |  | 84 | } |
  |  | 85 | /\*\* |
  | 72 | 86 | \* Handle the browser-based login. |
  | 73 | 87 | \* |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L109) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L123) |  |
  | 109 | 123 | } |
  | 110 | 124 | // Flywheel auto login end. |
  |  | 125 |  |
  |  | 126 | global $wp\_current\_filter; |
  |  | 127 |  |
  |  | 128 | if ( isset( $wp\_current\_filter ) && ! empty( $wp\_current\_filter ) && \is\_array( $wp\_current\_filter ) ) { |
  |  | 129 | foreach ( $wp\_current\_filter as $filter ) { |
  |  | 130 | if ( 'wp\_ajax\_nopriv\_mepr\_stripe\_confirm\_payment' === $filter ) { |
  |  | 131 | // That request comes from unprivileged user (maybe new), lets skip our checks in that case. |
  |  | 132 | return; |
  |  | 133 | } |
  |  | 134 | } |
  |  | 135 | } |
  | 111 | 136 |  |
  | 112 | 137 | $user\_status = User\_Helper::get\_2fa\_status( $user ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L141) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L166) |  |
  | 141 | 166 | Settings::is\_provider\_enabled\_for\_role( User\_Helper::get\_user\_role(), User\_Helper::get\_enabled\_method\_for\_user( $user ) ); |
  | 142 | 167 | self::clear\_session\_and\_show\_2fa\_form( $user ); |
  |  | 168 | return; |
  | 143 | 169 | } catch ( \Exception $e ) { |
  | 144 | 170 | return; |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L202) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L228) |  |
  | 202 | 228 |  |
  | 203 | 229 | $provider = User\_Helper::get\_enabled\_method\_for\_user( $user ); |
  | 204 |  | if ( '' === trim( $provider ) ) { |
  |  | 230 | if ( '' === trim( (string) $provider ) ) { |
  | 205 | 231 | return; |
  | 206 | 232 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L221) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L247) |  |
  | 221 | 247 | public static function show\_2fa\_form\_grace\_form( $user, $login\_nonce, $redirect\_to, $error\_msg = '' ) { |
  | 222 | 248 | $interim\_login   = isset( $\_REQUEST['interim-login'] ) ? filter\_var( wp\_unslash( $\_REQUEST['interim-login'] ), FILTER\_VALIDATE\_BOOLEAN ) : false; //phpcs:ignore |
  | 223 |  | $rememberme     = intval( self::rememberme() ); |
  | 224 |  | $global\_methods = Methods::get\_available\_2fa\_methods(); |
  | 225 |  | $users\_method   = User\_Helper::get\_enabled\_method\_for\_user( $user ); |
  |  | 249 | $rememberme     = intval( self::rememberme() ); |
  |  | 250 | $global\_methods = Methods::get\_available\_2fa\_methods(); |
  |  | 251 | $users\_method   = User\_Helper::get\_enabled\_method\_for\_user( $user ); |
  | 226 | 252 |  |
  | 227 | 253 | if ( ! function\_exists( 'login\_header' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L283) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L309) |  |
  | 283 | 309 | ?> |
  | 284 | 310 | <div class="clear"></div> |
  | 285 |  | <?php wp\_print\_scripts( 'jquery' ); ?> |
  |  | 311 | <?php wp\_print\_scripts( 'jquery' ); ?> |
  | 286 | 312 | <script> |
  | 287 | 313 | jQuery( document ).on( 'click', '.dismiss-user-configure-nag', function(e) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L362) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L388) |  |
  | 362 | 388 |  |
  | 363 | 389 | // Lets check for multisite first and if that is the case - lets search for that page on the user's default blog. |
  | 364 |  | if ( WP\_Helper::is\_multisite() && false !=~~Settings::get\_role\_or\_default\_setting( 'separate-multisite-page-url', $user~~ ) ) { |
  |  | 390 | if ( WP\_Helper::is\_multisite() && false !== Settings::get\_role\_or\_default\_setting( 'separate-multisite-page-url', $user ) && ! empty( $page\_slug ) ) { |
  | 365 | 391 | $blog\_id = User\_Helper::get\_user\_default\_blog( $user ); |
  | 366 | 392 | if ( 0 === $blog\_id ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L393) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L419) |  |
  | 393 | 419 | } else { |
  | 394 | 420 | $page\_exists = Settings\_Page\_Policies::get\_post\_by\_post\_name( $page\_slug, 'page' ); |
  | 395 |  | ~~// if ( false === $page\_exists ) {~~ |
  | 396 |  |  |
  | 397 |  | ~~// $result = Settings\_Page\_Policies::generate\_custom\_user\_profile\_page( $page\_slug, User\_Helper::get\_user\_role( $user ) );~~ |
  | 398 |  |  |
  | 399 |  | ~~// if ( $result && ! is\_wp\_error( $result ) ) {~~ |
  | 400 |  | ~~// $new\_page\_permalink = get\_permalink( $result );~~ |
  | 401 |  | ~~// }~~ |
  | 402 |  | ~~// } else {~~ |
  | 403 |  | ~~// $new\_page\_permalink = get\_permalink( $page\_exists->ID );~~ |
  | 404 |  | ~~// }~~ |
  | 405 | 421 |  |
  | 406 | 422 | if ( $page\_exists instanceof \WP\_Post ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L614) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L630) |  |
  | 614 | 630 | \*/ |
  | 615 | 631 | public static function login\_html( $user, $login\_nonce, $redirect\_to, $error\_msg = '', $provider = null ) { |
  | 616 |  | if ( ! $provider || ( ~~'backup\_codes' === $provider && ! Settings\_Page::are\_backup\_codes\_enabled~~( User\_Helper::get\_user\_role( $user ) ) ) ) { |
  |  | 632 | if ( ! $provider || ( Backup\_Codes::METHOD\_NAME === $provider && ! Backup\_Codes::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ) ) ) { |
  | 617 | 633 | $provider = User\_Helper::get\_enabled\_method\_for\_user( $user ); |
  | 618 | 634 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L630) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L646) |  |
  | 630 | 646 |  |
  | 631 | 647 | if ( ! empty( $error\_msg ) ) { |
  | 632 |  | echo '<div id="login\_error"><strong>' . apply\_filters( 'login\_errors', esc\_html( $error\_msg ) ) . '</strong><br /></div>'; |
  |  | 648 | echo '<div id="login\_error"><strong>' . apply\_filters( 'login\_errors', esc\_html( $error\_msg ) ) . '</strong><br /></div>'; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  | 633 | 649 | } |
  | 634 | 650 | ?> |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L646) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L662) |  |
  | 646 | 662 | <?php |
  | 647 | 663 | // Check to see what provider is set and give the relevant authentication page. |
  | 648 |  | if ( ~~'totp'~~ === $provider ) { |
  | 649 |  | ~~self~~::totp\_authentication\_page( $user ); |
  | 650 |  | } elseif ( ~~'email'~~ === $provider ) { |
  |  | 664 | if ( TOTP::METHOD\_NAME === $provider ) { |
  |  | 665 | TOTP\_Wizard\_Steps::totp\_authentication\_page( $user ); |
  |  | 666 | } elseif ( Email::METHOD\_NAME === $provider ) { |
  | 651 | 667 | self::email\_authentication\_page( $user ); |
  | 652 |  | } elseif ( ~~'backup\_codes'~~ === $provider ) { |
  |  | 668 | } elseif ( Backup\_Codes::METHOD\_NAME === $provider ) { |
  | 653 | 669 | self::backup\_codes\_authentication\_page( $user ); |
  | 654 | 670 | } else { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L714) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L730) |  |
  | 714 | 730 | </p> |
  | 715 | 731 | <?php |
  | 716 |  | if ( ~~'email'~~ === $provider ) { |
  |  | 732 | if ( Email::METHOD\_NAME === $provider ) { |
  | 717 | 733 | ?> |
  | 718 | 734 | <p class="2fa-email-resend"> |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L738) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L754) |  |
  | 738 | 754 |  |
  | 739 | 755 | <?php |
  | 740 |  | if ( ~~'backup\_codes' !== $provider && Settings\_Page::are\_backup\_codes\_enabled~~( User\_Helper::get\_user\_role( $user ) ) && isset( $codes\_remaining ) && $codes\_remaining > 0 ) { |
  |  | 756 | if ( Backup\_Codes::METHOD\_NAME !== $provider && Backup\_Codes::are\_backup\_codes\_enabled\_for\_role( User\_Helper::get\_user\_role( $user ) ) && isset( $codes\_remaining ) && $codes\_remaining > 0 ) { |
  | 741 | 757 | $login\_url = self::login\_url( |
  | 742 | 758 | array( |
  | 743 | 759 | 'action'        => 'backup\_2fa', |
  | 744 |  | 'provider'      => ~~'backup\_codes'~~, |
  |  | 760 | 'provider'      => Backup\_Codes::METHOD\_NAME, |
  | 745 | 761 | 'wp-auth-id'    => $user->ID, |
  | 746 | 762 | 'wp-auth-nonce' => $login\_nonce, |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L937) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L953) |  |
  | 937 | 953 |  |
  | 938 | 954 | // If this is an email login, or if the user failed validation previously, lets send the code to the user. |
  | 939 |  | if ( ~~'email'~~ === $provider && true !== self::pre\_process\_email\_authentication( $user ) ) { |
  |  | 955 | if ( Email::METHOD\_NAME === $provider && true !== self::pre\_process\_email\_authentication( $user ) ) { |
  | 940 | 956 | $login\_nonce = self::create\_login\_nonce( $user->ID ); |
  | 941 | 957 | if ( ! $login\_nonce ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L945) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L961) |  |
  | 945 | 961 |  |
  | 946 | 962 | // Validate TOTP. |
  | 947 |  | if ( ~~'totp' === $provider && true !== self~~::validate\_totp\_authentication( $user ) ) { |
  |  | 963 | if ( TOTP::METHOD\_NAME === $provider && true !== TOTP::validate\_totp\_authentication( $user ) ) { |
  | 948 | 964 | do\_action( |
  | 949 | 965 | 'wp\_login\_failed', |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L963) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L979) |  |
  | 963 | 979 | self::login\_html( $user, $login\_nonce['key'], esc\_url\_raw( wp\_unslash( $\_REQUEST['redirect\_to'] ) ), esc\_html\_\_( 'ERROR: Invalid verification code.', 'wp-2fa' ), $provider ); // phpcs:ignore |
  | 964 | 980 | } else { |
  |  | 981 | // Reached the maximum number of attempts - clear the attempts and redirect the user to the login page. |
  | 965 | 982 | Authentication::clear\_login\_attempts( $user ); |
  | 966 | 983 | \wp\_redirect( \wp\_login\_url() ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L970) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L987) |  |
  | 970 | 987 |  |
  | 971 | 988 | // Backup Codes. |
  | 972 |  | if ( ~~'backup\_codes' === $provider && true !== self~~::validate\_backup\_codes( $user ) ) { |
  |  | 989 | if ( Backup\_Codes::METHOD\_NAME === $provider && true !== Backup\_Codes::validate\_backup\_codes( $user ) ) { |
  | 973 | 990 | do\_action( |
  | 974 | 991 | 'wp\_login\_failed', |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L995) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L1012) |  |
  | 995 | 1012 |  |
  | 996 | 1013 | // Validate Email. |
  | 997 |  | if ( ~~'email'~~ === $provider && true !== self::validate\_email\_authentication( $user ) ) { |
  |  | 1014 | if ( Email::METHOD\_NAME === $provider && true !== self::validate\_email\_authentication( $user ) ) { |
  | 998 | 1015 | do\_action( |
  | 999 | 1016 | 'wp\_login\_failed', |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L1099) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L1116) |  |
  | 1099 | 1116 | } |
  | 1100 | 1117 |  |
  |  | 1118 | $redirect\_to = apply\_filters( WP\_2FA\_PREFIX . 'post\_login\_orphan\_user\_redirect', $redirect\_to, $user ); |
  |  | 1119 |  |
  | 1101 | 1120 | wp\_redirect( $redirect\_to ); |
  | 1102 | 1121 | exit; |
  | 1103 | 1122 | } |
  |  | 1123 |  |
  |  | 1124 | $redirect\_to = apply\_filters( WP\_2FA\_PREFIX . 'post\_login\_user\_redirect', $redirect\_to, $user ); |
  | 1104 | 1125 |  |
  | 1105 | 1126 | wp\_safe\_redirect( $redirect\_to ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L1133) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L1154) |  |
  | 1133 | 1154 | \* Prints the form that prompts the user to authenticate. |
  | 1134 | 1155 | \* |
  | 1135 |  | ~~\* @param \WP\_User $user \WP\_User object of the logged-in user.~~ |
  | 1136 |  | ~~\*/~~ |
  | 1137 |  | ~~public static function totp\_authentication\_page( $user ) {~~ |
  | 1138 |  | ~~require\_once ABSPATH . '/wp-admin/includes/template.php';~~ |
  | 1139 |  | ~~?>~~ |
  | 1140 |  | ~~<?php echo WP2FA::get\_wp2fa\_white\_label\_setting( 'default-text-code-page', true ); // phpcs:ignore ?>~~ |
  | 1141 |  | ~~<p>~~ |
  | 1142 |  | ~~</br>~~ |
  | 1143 |  | ~~<label for="authcode"><?php esc\_html\_e( 'Authentication Code:', 'wp-2fa' ); ?></label>~~ |
  | 1144 |  | ~~<input type="tel" name="authcode" id="authcode" class="input" value="" size="20" pattern="[0-9]\*" autocomplete="off" />~~ |
  | 1145 |  | ~~<script>~~ |
  | 1146 |  | ~~const authcode = document.getElementById('authcode');~~ |
  | 1147 |  | ~~authcode.addEventListener('input', function() {~~ |
  | 1148 |  | ~~this.value = this.value.trim();~~ |
  | 1149 |  | ~~});~~ |
  | 1150 |  | ~~</script>~~ |
  | 1151 |  | ~~</p>~~ |
  | 1152 |  | ~~<?php~~ |
  | 1153 |  | ~~}~~ |
  | 1154 |  |  |
  | 1155 |  | ~~/\*\*~~ |
  | 1156 |  | ~~\* Validates authentication.~~ |
  | 1157 |  | ~~\*~~ |
  | 1158 |  | ~~\* @param \WP\_User $user - The WP user, if presented.~~ |
  | 1159 |  | ~~\*~~ |
  | 1160 |  | ~~\* @return bool Whether the user gave a valid code~~ |
  | 1161 |  | ~~\*/~~ |
  | 1162 |  | ~~public static function validate\_totp\_authentication( \WP\_User $user = null ) {~~ |
  | 1163 |  | ~~if ( ! empty( $\_REQUEST['authcode'] ) ) {  //phpcs:ignore~~ |
  | 1164 |  | ~~$valid = Authentication::is\_valid\_authcode(~~ |
  | 1165 |  | ~~User\_Helper::get\_totp\_key( $user ),~~ |
  | 1166 |  | ~~sanitize\_text\_field( \wp\_unslash( $\_REQUEST['authcode'] ) )~~ |
  | 1167 |  | ~~);~~ |
  | 1168 |  | ~~if ( $valid ) {~~ |
  | 1169 |  | ~~Authentication::clear\_login\_attempts( $user );~~ |
  | 1170 |  | ~~} else {~~ |
  | 1171 |  | ~~Authentication::increase\_login\_attempts( $user );~~ |
  | 1172 |  | ~~}~~ |
  | 1173 |  | ~~return $valid;~~ |
  | 1174 |  | ~~}~~ |
  | 1175 |  |  |
  | 1176 |  | ~~return false;~~ |
  | 1177 |  | ~~}~~ |
  | 1178 |  |  |
  | 1179 |  | ~~/\*\*~~ |
  | 1180 |  | ~~\* Prints the form that prompts the user to authenticate.~~ |
  | 1181 |  | ~~\*~~ |
  | 1182 | 1156 | \* @since 0.1-dev |
  | 1183 | 1157 | \* |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L1189) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L1163) |  |
  | 1189 | 1163 | } |
  | 1190 | 1164 |  |
  | 1191 |  | $code\_sent       = (bool) User\_Helper::get\_meta( WP\_2FA\_PREFIX . 'code\_sent' ); |
  | 1192 |  | $text\_to\_display = ( $is\_reset\_protection ) ? 'default-text-pw-reset-code-page' : 'default-text-code-page'; |
  |  | 1165 | $code\_sent       = (bool) User\_Helper::get\_meta( WP\_2FA\_PREFIX . 'code\_sent' ); |
  |  | 1166 | $use\_default     = ( 'use-custom' == WP2FA::get\_wp2fa\_white\_label\_setting( 'use\_custom\_2fa\_message' ) ) ? 'custom-text-email-code-page' : 'default-text-code-page'; |
  |  | 1167 | $text\_to\_display = ( $is\_reset\_protection ) ? 'default-text-pw-reset-code-page' : $use\_default; |
  | 1193 | 1168 |  |
  | 1194 | 1169 | if ( ! $code\_sent && ! isset( $\_REQUEST[ self::INPUT\_NAME\_RESEND\_CODE ] ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=2940688#L1271) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-login.php?rev=3009922#L1246) |  |
  | 1271 | 1246 |  |
  | 1272 | 1247 | /\*\* |
  | 1273 |  | ~~\* Validates a backup code.~~ |
  | 1274 |  | ~~\*~~ |
  | 1275 |  | ~~\* Backup Codes are single use and are deleted upon a successful validation.~~ |
  | 1276 |  | ~~\*~~ |
  | 1277 |  | ~~\* @since 0.1-dev~~ |
  | 1278 |  | ~~\*~~ |
  | 1279 |  | ~~\* @param \WP\_User $user \WP\_User object of the logged-in user.~~ |
  | 1280 |  | ~~\*~~ |
  | 1281 |  | ~~\* @return boolean~~ |
  | 1282 |  | ~~\*/~~ |
  | 1283 |  | ~~public static function validate\_backup\_codes( $user ) {~~ |
  | 1284 |  | ~~if ( ! isset( $user->ID ) || ! isset( $\_REQUEST['wp-2fa-backup-code'] ) ) { //phpcs:ignore~~ |
  | 1285 |  | ~~return false;~~ |
  | 1286 |  | ~~}~~ |
  | 1287 |  | ~~return Backup\_Codes::validate\_code( $user, \sanitize\_text\_field( \wp\_unslash( $\_REQUEST['wp-2fa-backup-code'] ) ) );~~ |
  | 1288 |  | ~~}~~ |
  | 1289 |  |  |
  | 1290 |  | ~~/\*\*~~ |
  | 1291 | 1248 | \* Removes GoDaddy style which causing the form elements to be shown |
  | 1292 | 1249 | \* |
* ## [wp-2fa/trunk/includes/classes/Authenticator/class-open-ssl.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Authenticator/class-open-ssl.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Authenticator/class-open-ssl.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-open-ssl.php?rev=2940688#L8 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-open-ssl.php?rev=3009922#L8 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* @link      https://wordpress.org/plugins/wp-2fa/ |
  | 9 | 9 | \*/ |
  |  | 10 |  |
  |  | 11 | declare(strict\_types=1); |
  | 10 | 12 |  |
  | 11 | 13 | namespace WP2FA\Authenticator; |
* ## [wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=2940688#L16 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=3009922#L16 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 16 | 16 | namespace WP2FA\Authenticator; |
  | 17 | 17 |  |
  |  | 18 | use WP2FA\Methods\Email; |
  | 18 | 19 | use WP2FA\Authenticator\Login; |
  | 19 | 20 | use WP2FA\Admin\Helpers\User\_Helper; |
  |  | 21 | use WP2FA\Admin\Controllers\Settings; |
  |  | 22 | use WP2FA\Admin\Views\Password\_Reset\_2FA; |
  | 20 | 23 | use WP2FA\Extensions\RoleSettings\Role\_Settings\_Controller; |
  | 21 |  | ~~use WP2FA\Admin\Controllers\Settings;~~ |
  | 22 |  | ~~use \WP2FA\Admin\Views\Password\_Reset\_2FA;~~ |
  | 23 | 24 |  |
  | 24 | 25 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=2940688#L187) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=3009922#L188) |  |
  | 187 | 188 | } |
  | 188 | 189 |  |
  | 189 |  | $provider = ~~'email'~~; |
  |  | 190 | $provider = Email::METHOD\_NAME; |
  | 190 | 191 |  |
  | 191 | 192 | // If this is an email login, or if the user failed validation previously, lets send the code to the user. |
  | 192 |  | if ( ~~'email'~~ === $provider && true !== Login::pre\_process\_email\_authentication( $user ) ) { |
  |  | 193 | if ( Email::METHOD\_NAME === $provider && true !== Login::pre\_process\_email\_authentication( $user ) ) { |
  | 193 | 194 | $login\_nonce = Login::create\_login\_nonce( $user->ID ); |
  | 194 | 195 | if ( ! $login\_nonce ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=2940688#L198) | […](/browser/wp-2fa/trunk/includes/classes/Authenticator/class-reset-passord.php?rev=3009922#L199) |  |
  | 198 | 199 |  |
  | 199 | 200 | // Validate Email. |
  | 200 |  | if ( ~~'email'~~ === $provider && true !== Login::validate\_email\_authentication( $user ) ) { |
  |  | 201 | if ( Email::METHOD\_NAME === $provider && true !== Login::validate\_email\_authentication( $user ) ) { |
  | 201 | 202 | do\_action( |
  | 202 | 203 | 'wp\_login\_failed', |
* ## [wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  |  | 13 |  |
  | 12 | 14 | namespace WP2FA\Shortcodes; |
  | 13 | 15 |  |
  | 14 |  | use ~~\WP2FA\WP2FA as~~ WP2FA; |
  | 15 |  | use ~~\WP2FA\Core as~~ Core; |
  | 16 |  | use ~~\WP2FA\Admin\User\_Profile as~~ User\_Profile; |
  | 17 |  | use ~~\WP2FA\Admin\User\_Notices as~~ User\_Notices; |
  |  | 16 | use WP2FA\WP2FA; |
  |  | 17 | use WP2FA\Core; |
  |  | 18 | use WP2FA\Admin\User\_Profile; |
  |  | 19 | use WP2FA\Admin\User\_Notices; |
  | 18 | 20 | use WP2FA\Admin\Controllers\Settings; |
  | 19 | 21 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=2940688#L68) | […](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=3009922#L70) |  |
  | 68 | 70 | $role                        = array\_key\_first( WP2FA::wp\_2fa\_get\_roles() ); |
  | 69 | 71 | $redirect\_page               = Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page-global', 'current', $role ); |
  | 70 |  | $data\_array['redirectToUrl'] = ( '' !== trim( $redirect\_page ) ) ? \trailingslashit( get\_site\_url() ) . $redirect\_page : ''; |
  |  | 72 | $data\_array['redirectToUrl'] = ( '' !== trim( (string) $redirect\_page ) ) ? \trailingslashit( get\_site\_url() ) . $redirect\_page : ''; |
  | 71 | 73 | // Check and override if custom redirect page is selected and custom redirect is set. |
  | 72 | 74 | if ( |
  | […](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=2940688#L74) | […](/browser/wp-2fa/trunk/includes/classes/Shortcodes/class-shortcodes.php?rev=3009922#L76) |  |
  | 74 | 76 | 'yes' === Settings::get\_role\_or\_default\_setting( 'create-custom-user-page' ) ) { |
  | 75 | 77 | if ( |
  | 76 |  | '' !== trim( Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page', 'current', $role ) ) || |
  | 77 |  | '' !== trim( Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page' ) ) ) { |
  |  | 78 | '' !== trim( (string) Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page', 'current', $role ) ) || |
  |  | 79 | '' !== trim( (string) Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page' ) ) ) { |
  | 78 | 80 | if ( 'yes' === Settings::get\_role\_or\_default\_setting( 'create-custom-user-page', 'current', $role ) ) { |
  | 79 | 81 | $data\_array['redirectToUrl'] = trailingslashit( get\_site\_url() ) . Settings::get\_role\_or\_default\_setting( 'redirect-user-custom-page', 'current', $role ); |
* ## [wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  |  | 13 |  |
  | 12 | 14 | namespace WP2FA\Utils; |
  | 13 | 15 |  |
  | 14 |  | use WP2FA\Utils\Settings\_Utils~~as Settings\_Utils~~; |
  |  | 16 | use WP2FA\Utils\Settings\_Utils; |
  | 15 | 17 |  |
  | 16 | 18 | defined( 'ABSPATH' ) || exit; // Exit if accessed directly. |
  | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=2940688#L106) | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=3009922#L108) |  |
  | 106 | 108 | $migrate\_methods = array\_filter( |
  | 107 | 109 | $method\_as\_version\_numbers, |
  | 108 |  | function( $method, $key ) use ( &$stored\_version\_as\_number, &$target\_version\_as\_number ) { |
  |  | 110 | function ( $method, $key ) use ( &$stored\_version\_as\_number, &$target\_version\_as\_number ) { |
  | 109 | 111 | if ( $target\_version\_as\_number > $stored\_version\_as\_number ) { |
  | 110 | 112 | return ( in\_array( $key, range( $stored\_version\_as\_number, $target\_version\_as\_number ), true ) ); |
  | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=2940688#L146) | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=3009922#L148) |  |
  | 146 | 148 | private static function get\_stored\_version() { |
  | 147 | 149 |  |
  | 148 |  | if ( '' === trim( static::$stored\_version ) ) { |
  | 149 |  | static::$stored\_version = Settings\_Utils::get\_option( static::$version\_option\_name, '0.0.0' ); |
  |  | 150 | if ( '' === trim( (string) static::$stored\_version ) ) { |
  |  | 151 | static::$stored\_version = (string) Settings\_Utils::get\_option( static::$version\_option\_name, '0.0.0' ); |
  | 150 | 152 | } |
  | 151 | 153 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=2940688#L180) | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-abstract-migration.php?rev=3009922#L182) |  |
  | 180 | 182 | $version\_as\_number = (int) filter\_var( $version, FILTER\_SANITIZE\_NUMBER\_INT ); |
  | 181 | 183 |  |
  | 182 |  | if ( self::$pad\_length > strlen( $version\_as\_number ) ) { |
  | 183 |  | $version\_as\_number = str\_pad( $version\_as\_number, static::$pad\_length, '0', STR\_PAD\_RIGHT ); |
  |  | 184 | if ( self::$pad\_length > strlen( (string) $version\_as\_number ) ) { |
  |  | 185 | $version\_as\_number = str\_pad( (string) $version\_as\_number, static::$pad\_length, '0', STR\_PAD\_RIGHT ); |
  | 184 | 186 | } |
  | 185 | 187 |  |
* ## [wp-2fa/trunk/includes/classes/Utils/class-date-time-utils.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-date-time-utils.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-date-time-utils.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-date-time-utils.php?rev=2940688#L9 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-date-time-utils.php?rev=3009922#L9 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | \* @link       https://wordpress.org/plugins/wp-2fa/ |
  | 10 | 10 | \*/ |
  |  | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  | 11 | 13 |  |
  | 12 | 14 | namespace WP2FA\Utils; |
* ## [wp-2fa/trunk/includes/classes/Utils/class-debugging.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-debugging.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-debugging.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-debugging.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-debugging.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \* @since 1.4.2 |
  | 11 | 11 | \*/ |
  |  | 12 |  |
  |  | 13 | declare(strict\_types=1); |
  | 12 | 14 |  |
  | 13 | 15 | namespace WP2FA\Utils; |
* ## [wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  |  | 13 |  |
  | 12 | 14 | namespace WP2FA\Utils; |
  | 13 | 15 |  |
  | 14 |  | use ~~\WP2FA\WP2FA as~~ WP2FA; |
  |  | 16 | use WP2FA\WP2FA; |
  | 15 | 17 |  |
  | 16 | 18 | if ( ! class\_exists( '\WP2FA\Utils\Generate\_Modal' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php?rev=2940688#L76) | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-generate-modal.php?rev=3009922#L78) |  |
  | 76 | 78 | return $modal; |
  | 77 | 79 | } |
  | 78 |  |  |
  | 79 | 80 | } |
  | 80 | 81 | } |
* ## [wp-2fa/trunk/includes/classes/Utils/class-migration.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-migration.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-migration.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-migration.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-migration.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  |  | 13 |  |
  | 12 | 14 | namespace WP2FA\Utils; |
  | 13 | 15 |  |
  | 14 | 16 | use WP2FA\Utils\Abstract\_Migration; |
  | 15 |  | use ~~\WP2FA\Utils\User\_Utils as~~ User\_Utils; |
  | 16 |  | use WP2FA\Utils\Settings\_Utils~~as Settings\_Utils~~; |
  |  | 17 | use WP2FA\Utils\User\_Utils; |
  |  | 18 | use WP2FA\Utils\Settings\_Utils; |
  | 17 | 19 |  |
  | 18 | 20 | defined( 'ABSPATH' ) || exit; // Exit if accessed directly. |
* ## [wp-2fa/trunk/includes/classes/Utils/class-request-utils.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-request-utils.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-request-utils.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-request-utils.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-request-utils.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \* @since      2.0.0 |
  | 11 | 11 | \*/ |
  |  | 12 |  |
  |  | 13 | declare(strict\_types=1); |
  | 12 | 14 |  |
  | 13 | 15 | namespace WP2FA\Utils; |
  | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-request-utils.php?rev=2940688#L64) | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-request-utils.php?rev=3009922#L66) |  |
  | 64 | 66 | } |
  | 65 | 67 |  |
  | 66 |  | return trim( $\_SERVER['HTTP\_USER\_AGENT'] ); // phpcs:ignore |
  |  | 68 | return trim( (string) $\_SERVER['HTTP\_USER\_AGENT'] ); // phpcs:ignore |
  | 67 | 69 | } |
  | 68 | 70 | } |
* ## [wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \*/ |
  | 11 | 11 |  |
  |  | 12 | declare(strict\_types=1); |
  |  | 13 |  |
  | 12 | 14 | namespace WP2FA\Utils; |
  | 13 | 15 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php?rev=2940688#L20) | […](/browser/wp-2fa/trunk/includes/classes/Utils/class-settings-utils.php?rev=3009922#L22) |  |
  | 20 | 22 | \* |
  | 21 | 23 | \* @package WP2FA\Utils |
  |  | 24 | \* |
  | 22 | 25 | \* @since 1.7.0 |
  | 23 | 26 | \*/ |
* ## [wp-2fa/trunk/includes/classes/Utils/class-user-utils.php](/changeset/3009922/wp-2fa/trunk/includes/classes/Utils/class-user-utils.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/Utils/class-user-utils.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/Utils/class-user-utils.php?rev=2940688#L11 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/Utils/class-user-utils.php?rev=3009922#L11 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | \* @see       https://wordpress.org/plugins/wp-2fa/ |
  | 12 | 12 | \*/ |
  |  | 13 |  |
  |  | 14 | declare(strict\_types=1); |
  | 13 | 15 |  |
  | 14 | 16 | namespace WP2FA\Utils; |
* ## [wp-2fa/trunk/includes/classes/class-wp2fa.php](/changeset/3009922/wp-2fa/trunk/includes/classes/class-wp2fa.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/classes/class-wp2fa.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L15 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L15 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | use WP2FA\Admin\Settings\_Page; |
  | 16 | 16 | use WP2FA\Utils\Request\_Utils; |
  | 17 |  | use WP2FA\~~Methods\Backup\_Code~~s; |
  |  | 17 | use WP2FA\Utils\Settings\_Utils; |
  | 18 | 18 | use WP2FA\Shortcodes\Shortcodes; |
  | 19 | 19 | use WP2FA\Utils\Date\_Time\_Utils; |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L27) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L27) |  |
  | 27 | 27 | use WP2FA\Admin\Controllers\Settings; |
  | 28 | 28 | use WP2FA\Admin\Helpers\Classes\_Helper; |
  |  | 29 | use WP2FA\Admin\Helpers\Methods\_Helper; |
  |  | 30 | use WP2FA\Admin\Views\Password\_Reset\_2FA; |
  | 29 | 31 | use WP2FA\Admin\Views\Grace\_Period\_Notifications; |
  | 30 |  | ~~use WP2FA\Utils\Settings\_Utils;~~ |
  | 31 |  | ~~use WP2FA\Admin\SettingsPages\Settings\_Page\_Email;~~ |
  | 32 |  | ~~use WP2FA\Admin\Views\Password\_Reset\_2FA;~~ |
  | 33 | 32 |  |
  | 34 | 33 | if ( ! class\_exists( '\WP2FA\WP2FA' ) ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L39) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L38) |  |
  | 39 | 38 |  |
  | 40 | 39 | /\*\* |
  | 41 |  | \* Holds the global plugin secret key~~for storing the TOTP~~ |
  |  | 40 | \* Holds the global plugin secret key |
  | 42 | 41 | \* |
  | 43 | 42 | \* @var string |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L72) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L71) |  |
  | 72 | 71 | public static function get\_default\_settings() { |
  | 73 | 72 | $default\_settings = array( |
  | 74 |  | ~~'enable\_totp'                          => 'enable\_totp',~~ |
  | 75 |  | ~~'enable\_email'                         => 'enable\_email',~~ |
  | 76 |  | ~~'backup\_codes\_enabled'                 => 'yes',~~ |
  | 77 | 73 | 'enforcement-policy'                   => 'do-not-enforce', |
  | 78 | 74 | 'excluded\_users'                       => array(), |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L106) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L102) |  |
  | 106 | 102 | 'default-2fa-required-notice'          => '<p>' . \_\_( 'This website\'s administrator requires you to enable two-factor authentication (2FA) {grace\_period\_remaining}.', 'wp-2fa' ) . '</p><br><p>' . \_\_( 'Failing to configure 2FA within this time period will result in a locked account. For more information, please contact your website administrator.', 'wp-2fa' ) . '</p>', |
  | 107 | 103 | 'default-2fa-resetup-required-notice'  => '<p>' . \_\_( 'This website\'s administrator requires you to enable two-factor authentication (2FA) {grace\_period\_remaining}.', 'wp-2fa' ) . '</p><br><p>' . \_\_( 'Failing to configure 2FA within this time period will result in a locked account. For more information, please contact your website administrator.', 'wp-2fa' ) . '</p>', |
  | 108 |  | 'specify-email\_hotp'                   => '', |
  |  | 104 | 'custom-text-authy-code-page-intro'    => \_\_( 'If you are using the Authy app approve the OneTouch request to log in.', 'wp-2fa' ), |
  |  | 105 | 'custom-text-authy-code-page-awaiting' => \_\_( 'Waiting for approval from application...', 'wp-2fa' ), |
  |  | 106 | 'custom-text-authy-code-page'          => \_\_( 'Manually enter the code from the mobile app.', 'wp-2fa' ), |
  |  | 107 | 'custom-text-twilio-code-page'         => \_\_( 'Enter the 2FA code you have received over SMS.', 'wp-2fa' ), |
  |  | 108 | 'custom-text-app-code-page'            => '<p>' . \_\_( 'Please enter the two-factor authentication (2FA) verification code below to login. Depending on your 2FA setup, you can get the code from the 2FA app or it was sent to you by email.', 'wp-2fa' ) . '</p><p><strong>' . \_\_( 'Note: if you are supposed to receive an email but did not receive any, please click the Resend Code button to request another code.', 'wp-2fa' ) . '</strong></p>', |
  |  | 109 | 'custom-text-email-code-page'          => '<p>' . \_\_( 'Please enter the two-factor authentication (2FA) verification code below to login. Depending on your 2FA setup, you can get the code from the 2FA app or it was sent to you by email.', 'wp-2fa' ) . '</p><p><strong>' . \_\_( 'Note: if you are supposed to receive an email but did not receive any, please click the Resend Code button to request another code.', 'wp-2fa' ) . '</strong></p>', |
  |  | 110 |  |
  |  | 111 |  |
  | 109 | 112 | 'default-backup-code-page'             => \_\_( 'Enter a backup verification code.', 'wp-2fa' ), |
  | 110 | 113 | 'method\_invalid\_setting'               => 'login\_block', |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L116) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L119) |  |
  | 116 | 119 | 'method\_selection'                     => '<h3>' . \_\_( 'Choose the 2FA method', 'wp-2fa' ) . '</h3>' . Methods::get\_number\_of\_methods\_text(), |
  | 117 | 120 | 'method\_selection\_single'              => '<h3>' . \_\_( 'Choose the 2FA method', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Only the below 2FA method is allowed on this website:', 'wp-2fa' ) . '</p>', |
  | 118 |  | ~~'method\_help\_totp\_intro'               => '<h3>' . \_\_( 'Setting up TOTP', 'wp-2fa' ) . '</h3>',~~ |
  | 119 |  | ~~'method\_help\_totp\_step\_1'              => \_\_( 'Download and start the application of your choice', 'wp-2fa' ),~~ |
  | 120 |  | ~~'method\_help\_totp\_step\_2'              => \_\_( 'From within the application scan the QR code provided on the left. Otherwise, enter the following code manually in the application:', 'wp-2fa' ),~~ |
  | 121 |  | ~~'method\_help\_totp\_step\_3'              => \_\_( 'Click the "I\'m ready" button below when you complete the application setup process to proceed with the wizard.', 'wp-2fa' ),~~ |
  | 122 |  | ~~'method\_help\_hotp\_intro'               => '<h3>' . \_\_( 'Setting up HOTP', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please select the email address where the one-time code should be sent:', 'wp-2fa' ) . '</p>',~~ |
  | 123 | 121 | 'method\_help\_authy\_intro'              => '<h3>' . \_\_( 'Setting up Push notifications', 'wp-2fa' ) . '</h3><p>' . \_\_( 'To enable push notifications enter the country and cellphone number in order to use it with this account.', 'wp-2fa' ) . '</p>', |
  | 124 | 122 | 'method\_help\_twilio\_intro'             => '<h3>' . \_\_( 'Setting up 2FA over SMS', 'wp-2fa' ) . '</h3><p>' . \_\_( 'When you use 2FA over SMS to log in to this website you will receive your one-time code via an SMS on your cellphone. Therefore please enter the cellphone number of where you would like to receive the SMS below.', 'wp-2fa' ) . '</p>', |
  | 125 | 123 | 'method\_help\_oob\_intro'                => '<h3>' . \_\_( 'Setting up Link over email 2FA', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please select the email address to where the out-of-band link should be sent:', 'wp-2fa' ) . '</p>', |
  | 126 |  | ~~'method\_verification\_totp\_pre'         => '<h3>' . \_\_( 'Almost there…', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please type in the one-time code from your chosen authentication app to finalize the setup.', 'wp-2fa' ) . '</p>',~~ |
  | 127 |  | ~~'method\_verification\_hotp\_pre'         => '<h3>' . \_\_( 'Almost there…', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please type in the one-time code sent to your email address to finalize the setup', 'wp-2fa' ) . '</p>',~~ |
  | 128 | 124 | 'method\_verification\_oob\_pre'          => '<h3>' . \_\_( 'Almost there…', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please type in the one-time code sent to your email address to finalize the setup. Once the code is confirmed and 2FA is set up, you only have to verify a login by clicking on a link sent to you via email.', 'wp-2fa' ) . '</p>', |
  | 129 | 125 | 'method\_verification\_authy\_pre'        => '<h3>' . \_\_( 'Almost there…', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please type in the code from your Authy application with name {authy\_name}', 'wp-2fa' ) . '</p>', |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L136) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L132) |  |
  | 136 | 132 | 'no\_further\_action'                    => '<h3>' . \_\_( 'Congratulations! You are all set.', 'wp-2fa' ), |
  | 137 | 133 | '2fa\_required\_intro'                   => '<h3>' . \_\_( 'You are required to configure 2FA.', 'wp-2fa' ) . '</h3><p>' . \_\_( 'In order to keep this site - and your details secure, this website’s administrator requires you to enable 2FA authentication to continue.', 'wp-2fa' ) . '</p><p>' . \_\_( 'Two factor authentication ensures only you have access to your account by creating an added layer of security when logging in -', 'wp-2fa' ) . ' <a href="https://melapress.com/wordpress-2fa/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank" rel="noopener">' . \_\_( 'Learn more', 'wp-2fa' ) . '</a></p>', |
  | 138 |  | ~~'totp\_reconfigure\_intro'               => '<h3>' . \_\_( '{reconfigure\_or\_configure\_capitalized} the 2FA App', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Click the below button to {reconfigure\_or\_configure} the current 2FA method. Note that once reset you will have to re-scan the QR code on all devices you want this to work on because the previous codes will stop working.', 'wp-2fa' ) . '</p>',~~ |
  | 139 |  | ~~'hotp\_reconfigure\_intro'               => '<h3>' . \_\_( '{reconfigure\_or\_configure\_capitalized} one-time code over email method', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please select the email address where the one-time code should be sent:', 'wp-2fa' ) . '</p>',~~ |
  | 140 | 134 | 'authy\_reconfigure\_intro'              => '<h3>' . \_\_( '{reconfigure\_or\_configure\_capitalized} push notification method', 'wp-2fa' ) . '</h3><p>' . \_\_( 'Please select the phone where link should be send:', 'wp-2fa' ) . '</p>', |
  | 141 | 135 | 'authy\_reconfigure\_intro\_unavailable'  => '<h3>' . \_\_( '{reconfigure\_or\_configure\_capitalized} push notification method', 'wp-2fa' ) . '</h3><p>' . \_\_( 'The 2FA service you want to use is currently unavailable. Please try again later or restart the wizard to choose another method.', 'wp-2fa' ) . '</p>', |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L150) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L144) |  |
  | 150 | 144 | 'user-profile-form-preamble-title'     => \_\_( 'Two-factor authentication settings', 'wp-2fa' ), |
  | 151 | 145 | 'user-profile-form-preamble-desc'      => \_\_( 'Add two-factor authentication to strengthen the security of your user account.', 'wp-2fa' ), |
  |  | 146 | 'use\_custom\_2fa\_message'               => 'use-defaults', |
  | 152 | 147 |  |
  | 153 | 148 | ); |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L165) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L160) |  |
  | 165 | 160 |  |
  | 166 | 161 | /\*\* |
  | 167 |  | \* Fire up classes. |
  |  | 162 | \* Inits the plugin related classes and settings |
  |  | 163 | \* |
  |  | 164 | \* @return void |
  |  | 165 | \* |
  |  | 166 | \* @since 2.6.0 |
  | 168 | 167 | \*/ |
  | 169 | 168 | public static function init() { |
  |  | 169 |  |
  |  | 170 | Methods\_Helper::init(); |
  | 170 | 171 |  |
  | 171 | 172 | self::$plugin\_settings[ WP\_2FA\_POLICY\_SETTINGS\_NAME ]      = Settings\_Utils::get\_option( WP\_2FA\_POLICY\_SETTINGS\_NAME, array() ); |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L187) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L188) |  |
  | 187 | 188 | } |
  | 188 | 189 |  |
  | 189 |  | ~~// Activation/Deactivation.~~ |
  | 190 |  | ~~register\_activation\_hook( WP\_2FA\_FILE, '\WP2FA\Core\activate' );~~ |
  | 191 |  | ~~register\_deactivation\_hook( WP\_2FA\_FILE, '\WP2FA\Core\deactivate' );~~ |
  | 192 |  | ~~// Register our uninstallation hook.~~ |
  | 193 |  | ~~register\_uninstall\_hook( WP\_2FA\_FILE, '\WP2FA\Core\uninstall' );~~ |
  | 194 |  |  |
  | 195 | 190 |  |
  | 196 | 191 | WP\_Helper::init(); |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L198) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L193) |  |
  | 198 | 193 | // Bootstrap. |
  | 199 | 194 | Core\setup(); |
  | 200 |  | ~~Backup\_Codes::init();~~ |
  | 201 | 195 |  |
  | 202 | 196 | if ( is\_admin() ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L225) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L219) |  |
  | 225 | 219 |  |
  | 226 | 220 | /\*\* |
  | 227 |  | \* Add our plugins actions. |
  |  | 221 | \* Inits all the plugin hooks |
  |  | 222 | \* |
  |  | 223 | \* @return void |
  |  | 224 | \* |
  |  | 225 | \* @since 2.6.0 |
  | 228 | 226 | \*/ |
  | 229 | 227 | public static function add\_actions() { |
  | 230 | 228 | // Plugin redirect on activation, only if we have no settings currently saved. |
  | 231 |  | if ( ! isset( self::$plugin\_settings[ WP\_2FA\_POLICY\_SETTINGS\_NAME ] ) || empty( self::$plugin\_settings[ WP\_2FA\_POLICY\_SETTINGS\_NAME ] ) ) { |
  |  | 229 | if ( ! isset( self::$plugin\_settings[ WP\_2FA\_POLICY\_SETTINGS\_NAME ] ) || empty( self::$plugin\_settings[ WP\_2FA\_POLICY\_SETTINGS\_NAME ] ) || Settings\_Utils::get\_option( 'redirect\_on\_activate', false ) ) { |
  | 232 | 230 | add\_action( 'admin\_init', array( \_\_CLASS\_\_, 'setup\_redirect' ), 10 ); |
  |  | 231 |  |
  |  | 232 | self::update\_plugin\_settings( self::get\_default\_settings() ); |
  |  | 233 | } elseif ( ! \is\_array( Settings\_Utils::get\_option( WP\_2FA\_POLICY\_SETTINGS\_NAME ) ) ) { |
  |  | 234 | Settings\_Utils::delete\_option( WP\_2FA\_POLICY\_SETTINGS\_NAME ); |
  |  | 235 | self::update\_plugin\_settings( self::get\_default\_settings() ); |
  | 233 | 236 | } |
  | 234 | 237 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L245) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L248) |  |
  | 245 | 248 | add\_action( 'admin\_notices', array( \_\_CLASS\_\_, 'wp\_not\_writable' ) ); |
  | 246 | 249 | } |
  | 247 |  | \add\_action( 'wp\_ajax\_nopriv\_set\_salt\_key', array( \_\_CLASS\_\_, 'set\_salt\_key' ) ); |
  | 248 |  | \add\_action( 'wp\_ajax\_set\_salt\_key', array( \_\_CLASS\_\_, 'set\_salt\_key' ) ); |
  | 249 |  |  |
  | 250 |  | add\_action( 'wp\_ajax\_get\_all\_users', array( '\WP2FA\Admin\Settings\_Page', 'get\_all\_users' ) ); |
  | 251 |  | add\_action( 'wp\_ajax\_get\_all\_network\_sites', array( '\WP2FA\Admin\Settings\_Page', 'get\_all\_network\_sites' ) ); |
  | 252 |  | add\_action( 'wp\_ajax\_unlock\_account', array( '\WP2FA\Admin\Settings\_Page', 'unlock\_account' ), 10, 1 ); |
  | 253 |  | add\_action( 'admin\_action\_unlock\_account', array( '\WP2FA\Admin\Settings\_Page', 'unlock\_account' ), 10, 1 ); |
  | 254 |  | add\_action( 'admin\_action\_remove\_user\_2fa', array( '\WP2FA\Admin\Settings\_Page', 'remove\_user\_2fa' ), 10, 1 ); |
  | 255 |  | add\_action( 'wp\_ajax\_remove\_user\_2fa', array( '\WP2FA\Admin\Settings\_Page', 'remove\_user\_2fa' ), 10, 1 ); |
  |  | 250 | add\_action( 'wp\_ajax\_wp2fa\_dismiss\_notice\_mail\_domain', array( '\WP2FA\Admin\Settings\_Page', 'dismiss\_notice\_mail\_domain' ) ); |
  |  | 251 | \add\_action( 'wp\_ajax\_nopriv\_set\_salt\_key', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'set\_salt\_key' ) ); |
  |  | 252 | \add\_action( 'wp\_ajax\_set\_salt\_key', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'set\_salt\_key' ) ); |
  |  | 253 |  |
  |  | 254 | add\_action( 'wp\_ajax\_wp\_2fa\_get\_all\_users', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'get\_all\_users' ) ); |
  |  | 255 | add\_action( 'wp\_ajax\_wp\_2fa\_get\_all\_roles', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'get\_ajax\_user\_roles' ) ); |
  |  | 256 | add\_action( 'wp\_ajax\_wp\_2fa\_get\_all\_network\_sites', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'get\_all\_network\_sites' ) ); |
  |  | 257 | add\_action( 'wp\_ajax\_unlock\_account', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'unlock\_account' ), 10, 1 ); |
  |  | 258 | add\_action( 'admin\_action\_unlock\_account', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'unlock\_account' ), 10, 1 ); |
  |  | 259 | add\_action( 'admin\_action\_remove\_user\_2fa', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'remove\_user\_2fa' ), 10, 1 ); |
  |  | 260 | add\_action( 'wp\_ajax\_remove\_user\_2fa', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'remove\_user\_2fa' ), 10, 1 ); |
  | 256 | 261 | add\_action( 'admin\_menu', array( '\WP2FA\Admin\Settings\_Page', 'hide\_settings' ), 999 ); |
  | 257 | 262 | add\_action( 'plugin\_action\_links\_' . WP\_2FA\_BASE, array( '\WP2FA\Admin\Settings\_Page', 'add\_plugin\_action\_links' ) ); |
  | 258 | 263 | add\_filter( 'display\_post\_states', array( '\WP2FA\Admin\Settings\_Page', 'add\_display\_post\_states' ), 10, 2 ); |
  | 259 |  |  |
  | 260 |  | ~~// Setup\_Wizard.~~ |
  | 261 |  | ~~if ( WP\_Helper::is\_multisite() ) {~~ |
  | 262 |  | ~~add\_action( 'network\_admin\_menu', array( '\WP2FA\Admin\Setup\_Wizard', 'network\_admin\_menus' ), 10 );~~ |
  | 263 |  | ~~add\_action( 'admin\_menu', array( '\WP2FA\Admin\Setup\_Wizard', 'admin\_menus' ), 10 );~~ |
  | 264 |  | ~~} else {~~ |
  | 265 |  | ~~add\_action( 'admin\_menu', array( '\WP2FA\Admin\Setup\_Wizard', 'admin\_menus' ), 10 );~~ |
  | 266 |  | ~~}~~ |
  | 267 |  | ~~add\_action( 'plugins\_loaded', array( \_\_CLASS\_\_, 'add\_wizard\_actions' ), 10 );~~ |
  | 268 | 264 | add\_action( 'wp\_ajax\_send\_authentication\_setup\_email', array( '\WP2FA\Admin\Setup\_Wizard', 'send\_authentication\_setup\_email' ) ); |
  | 269 |  | add\_action( 'wp\_ajax\_send\_backup\_codes\_email', array( '\WP2FA\~~Admin\Setup\_Wizard~~', 'send\_backup\_codes\_email' ) ); |
  | 270 |  | add\_action( 'wp\_ajax\_regenerate\_authentication\_key', array( '\WP2FA\~~Admin\Setup\_Wizard~~', 'regenerate\_authentication\_key' ) ); |
  |  | 265 | add\_action( 'wp\_ajax\_send\_backup\_codes\_email', array( '\WP2FA\Methods\Backup\_Codes', 'send\_backup\_codes\_email' ) ); |
  |  | 266 | add\_action( 'wp\_ajax\_regenerate\_authentication\_key', array( '\WP2FA\Methods\TOTP', 'regenerate\_authentication\_key' ) ); |
  | 271 | 267 |  |
  | 272 | 268 | // User\_Notices. |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L289) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L285) |  |
  | 289 | 285 | } |
  | 290 | 286 | add\_action( 'wp\_ajax\_validate\_authcode\_via\_ajax', array( '\WP2FA\Admin\User\_Profile', 'validate\_authcode\_via\_ajax' ) ); |
  | 291 |  | add\_action( 'wp\_ajax\_wp2fa\_test\_email', array( ~~\_\_CLASS\_\_~~, 'handle\_send\_test\_email\_ajax' ) ); |
  |  | 287 | add\_action( 'wp\_ajax\_wp2fa\_test\_email', array( '\WP2FA\Admin\Helpers\Ajax\_Helper', 'handle\_send\_test\_email\_ajax' ) ); |
  | 292 | 288 |  |
  | 293 | 289 | // Login. |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L338) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L334) |  |
  | 338 | 334 |  |
  | 339 | 335 | \add\_action( WP\_2FA\_PREFIX . 'user\_authenticated', array( \_\_CLASS\_\_, 'clear\_user\_after\_login' ), 10, 1 ); |
  |  | 336 |  |
  |  | 337 | \add\_filter( 'mepr-auto-login', array( '\WP2FA\Authenticator\Login', 'mepr\_login' ) ); |
  | 340 | 338 | } |
  | 341 | 339 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L609) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L607) |  |
  | 609 | 607 | 'reset\_password\_code\_email\_subject'   => $reset\_password\_code\_subject, |
  | 610 | 608 | 'reset\_password\_code\_email\_body'      => $reset\_password\_code\_body, |
  |  | 609 | 'login\_code\_setup\_email\_subject'      => $login\_code\_subject, |
  | 611 | 610 | 'login\_code\_setup\_email\_body'         => $login\_code\_setup\_body, |
  | 612 | 611 | 'user\_account\_locked\_email\_subject'   => $user\_locked\_subject, |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L618) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L617) |  |
  | 618 | 617 | 'send\_account\_locked\_email'           => 'enable\_account\_locked\_email', |
  | 619 | 618 | 'send\_account\_unlocked\_email'         => 'enable\_account\_unlocked\_email', |
  |  | 619 | 'send\_login\_code\_email'               => 'enable\_send\_login\_code\_email', |
  |  | 620 | 'send\_reset\_password\_code\_email'      => 'enable\_send\_reset\_password\_code\_email', |
  | 620 | 621 | ); |
  | 621 | 622 |  |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L644) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L645) |  |
  | 644 | 645 | public static function replace\_email\_strings( $input = '', $user\_id = '', $token = '', $override\_grace\_period = '' ) { |
  | 645 | 646 |  |
  | 646 |  | $token = trim( $token ); |
  |  | 647 | $token = trim( (string) $token ); |
  | 647 | 648 |  |
  | 648 | 649 | // Gather grace period. |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L722) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L723) |  |
  | 722 | 723 | public static function contextual\_reconfigure\_text( $input = '', $user\_id = '', $method\_to\_check = '' ) { |
  | 723 | 724 |  |
  | 724 |  | if ( empty( trim( $input ) ) ) { |
  |  | 725 | if ( empty( trim( (string) $input ) ) ) { |
  | 725 | 726 | return $input; |
  | 726 | 727 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L761) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L762) |  |
  | 761 | 762 | \*/ |
  | 762 | 763 | public static function replace\_remaining\_grace\_period( $input = '', $grace\_expiry = -1 ) { |
  | 763 |  | if ( empty( trim( ~~$input ) ) || empty( trim(~~ $grace\_expiry ) ) ) { |
  |  | 764 | if ( empty( trim( (string) $input ) ) || empty( trim( (string) $grace\_expiry ) ) ) { |
  | 764 | 765 | return $input; |
  | 765 | 766 | } |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L825) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L826) |  |
  | 825 | 826 | $redirect = User\_Licensing::enable\_2fa\_user\_setting( true ); |
  | 826 | 827 | } |
  |  | 828 |  |
  | 827 | 829 |  |
  | 828 | 830 | if ( $redirect ) { |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L977) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L979) |  |
  | 977 | 979 |  |
  | 978 | 980 | /\*\* |
  | 979 |  | ~~\* Handles AJAX calls for sending test emails.~~ |
  | 980 |  | ~~\*/~~ |
  | 981 |  | ~~public static function handle\_send\_test\_email\_ajax() {~~ |
  | 982 |  |  |
  | 983 |  | ~~// check user permissions.~~ |
  | 984 |  | ~~if ( ! current\_user\_can( 'manage\_options' ) ) {~~ |
  | 985 |  | ~~wp\_send\_json\_error();~~ |
  | 986 |  | ~~}~~ |
  | 987 |  |  |
  | 988 |  | ~~// check email id.~~ |
  | 989 |  | ~~$email\_id = isset( $\_POST['email\_id'] ) ? sanitize\_text\_field( \wp\_unslash( $\_POST['email\_id'] ) ) : null;~~ |
  | 990 |  | ~~if ( null === $email\_id || false === $email\_id ) {~~ |
  | 991 |  | ~~wp\_send\_json\_error();~~ |
  | 992 |  | ~~}~~ |
  | 993 |  |  |
  | 994 |  | ~~// check nonce.~~ |
  | 995 |  | ~~$nonce = isset( $\_POST['\_wpnonce'] ) ? sanitize\_text\_field( \wp\_unslash( $\_POST['\_wpnonce'] ) ) : null;~~ |
  | 996 |  | ~~if ( null === $nonce || false === $nonce || ! wp\_verify\_nonce( $nonce, 'wp-2fa-email-test-' . $email\_id ) ) {~~ |
  | 997 |  | ~~wp\_send\_json\_error();~~ |
  | 998 |  | ~~}~~ |
  | 999 |  |  |
  | 1000 |  | ~~$user\_id = get\_current\_user\_id();~~ |
  | 1001 |  | ~~// Grab user data.~~ |
  | 1002 |  | ~~$user = get\_userdata( $user\_id );~~ |
  | 1003 |  | ~~// Grab user email.~~ |
  | 1004 |  | ~~$email = $user->user\_email;~~ |
  | 1005 |  |  |
  | 1006 |  | ~~if ( 'config\_test' === $email\_id ) {~~ |
  | 1007 |  | ~~$email\_sent = Settings\_Page::send\_email(~~ |
  | 1008 |  | ~~$email,~~ |
  | 1009 |  | ~~esc\_html\_\_( 'Test email from WP 2FA', 'wp-2fa' ),~~ |
  | 1010 |  | ~~esc\_html\_\_( 'This email was sent by the WP 2FA plugin to test the email delivery.', 'wp-2fa' )~~ |
  | 1011 |  | ~~);~~ |
  | 1012 |  | ~~if ( $email\_sent ) {~~ |
  | 1013 |  | ~~wp\_send\_json\_success( 'Test email was successfully sent to <strong>' . $email . '</strong>' );~~ |
  | 1014 |  | ~~}~~ |
  | 1015 |  |  |
  | 1016 |  | ~~wp\_send\_json\_error();~~ |
  | 1017 |  | ~~}~~ |
  | 1018 |  |  |
  | 1019 |  | ~~/\*\*~~ |
  | 1020 |  | ~~\* All email templates~~ |
  | 1021 |  | ~~\*~~ |
  | 1022 |  | ~~\*  @var Email\_Template[] $email\_templates~~ |
  | 1023 |  | ~~\*/~~ |
  | 1024 |  | ~~$email\_templates = Settings\_Page\_Email::get\_email\_notification\_definitions();~~ |
  | 1025 |  | ~~foreach ( $email\_templates as $email\_template ) {~~ |
  | 1026 |  | ~~if ( $email\_id === $email\_template->get\_email\_content\_id() ) {~~ |
  | 1027 |  | ~~// send the test email.~~ |
  | 1028 |  |  |
  | 1029 |  | ~~// Setup the email contents.~~ |
  | 1030 |  | ~~$subject = wp\_strip\_all\_tags( self::replace\_email\_strings( self::get\_wp2fa\_email\_templates( $email\_id . '\_email\_subject' ) ) );~~ |
  | 1031 |  | ~~$message = wpautop( self::replace\_email\_strings( self::get\_wp2fa\_email\_templates( $email\_id . '\_email\_body' ), $user\_id ) );~~ |
  | 1032 |  |  |
  | 1033 |  | ~~$email\_sent = Settings\_Page::send\_email( $email, $subject, $message );~~ |
  | 1034 |  | ~~if ( $email\_sent ) {~~ |
  | 1035 |  | ~~wp\_send\_json\_success( 'Test email <strong>' . $email\_template->get\_title() . '</strong> was successfully sent to <strong>' . $email . '</strong>' );~~ |
  | 1036 |  | ~~}~~ |
  | 1037 |  |  |
  | 1038 |  | ~~wp\_send\_json\_error();~~ |
  | 1039 |  | ~~}~~ |
  | 1040 |  | ~~}~~ |
  | 1041 |  | ~~}~~ |
  | 1042 |  |  |
  | 1043 |  | ~~/\*\*~~ |
  | 1044 | 981 | \* Returns currently stored settings |
  | 1045 | 982 | \* |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L1117) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L1054) |  |
  | 1117 | 1054 |  |
  | 1118 | 1055 | /\*\* |
  | 1119 |  | \* Getter for the ~~TOTP s~~ecret key of the plugin for the current instance |
  |  | 1056 | \* Getter for the ecret key of the plugin for the current instance |
  | 1120 | 1057 | \* |
  | 1121 | 1058 | \* Note: that is legacy code and will be removed. |
  | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=2940688#L1135) | […](/browser/wp-2fa/trunk/includes/classes/class-wp2fa.php?rev=3009922#L1072) |  |
  | 1135 | 1072 |  |
  | 1136 | 1073 | return self::$secret\_key; |
  | 1137 |  | ~~}~~ |
  | 1138 |  |  |
  | 1139 |  | ~~/\*\*~~ |
  | 1140 |  | ~~\* Sets the salt key into the wp-config.php file via AJAX request.~~ |
  | 1141 |  | ~~\*~~ |
  | 1142 |  | ~~\* @return void~~ |
  | 1143 |  | ~~\*~~ |
  | 1144 |  | ~~\* @since 2.4.0~~ |
  | 1145 |  | ~~\*/~~ |
  | 1146 |  | ~~public static function set\_salt\_key() {~~ |
  | 1147 |  | ~~if ( \wp\_doing\_ajax() ) {~~ |
  | 1148 |  | ~~if ( isset( $\_REQUEST['\_wpnonce'] ) ) {~~ |
  | 1149 |  | ~~$nonce\_check = \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_REQUEST['\_wpnonce'] ) ), 'wp-2fa-set-salt-nonce' );~~ |
  | 1150 |  | ~~if ( ! $nonce\_check ) {~~ |
  | 1151 |  | ~~\wp\_send\_json\_error( new \WP\_Error( 500, \esc\_html\_\_( 'Nonce checking failed', 'wp-2fa' ) ), 400 );~~ |
  | 1152 |  | ~~} elseif ( \current\_user\_can( 'manage\_options' ) ) {~~ |
  | 1153 |  | ~~if ( ! File\_Writer::can\_write\_to\_file( File\_Writer::get\_wp\_config\_file\_path() ) ) {~~ |
  | 1154 |  | ~~\wp\_send\_json\_error(~~ |
  | 1155 |  | ~~new \WP\_Error(~~ |
  | 1156 |  | ~~500,~~ |
  | 1157 |  | ~~\esc\_html\_\_(~~ |
  | 1158 |  | ~~'Unable to write to wp-config.php',~~ |
  | 1159 |  | ~~'wp-2fa'~~ |
  | 1160 |  | ~~)~~ |
  | 1161 |  | ~~),~~ |
  | 1162 |  | ~~400~~ |
  | 1163 |  | ~~);~~ |
  | 1164 |  | ~~} else {~~ |
  | 1165 |  | ~~$secret\_key = Settings\_Utils::get\_option( 'secret\_key' );~~ |
  | 1166 |  | ~~if ( ! empty( $secret\_key ) ) {~~ |
  | 1167 |  | ~~File\_Writer::save\_secret\_key( $secret\_key );~~ |
  | 1168 |  | ~~Settings\_Utils::delete\_option( 'secret\_key' );~~ |
  | 1169 |  | ~~\wp\_send\_json\_success(~~ |
  | 1170 |  | ~~\esc\_html\_\_(~~ |
  | 1171 |  | ~~'wp-config.php successfully update, global setting deleted',~~ |
  | 1172 |  | ~~'wp-2fa'~~ |
  | 1173 |  | ~~)~~ |
  | 1174 |  | ~~);~~ |
  | 1175 |  | ~~} else {~~ |
  | 1176 |  | ~~\wp\_send\_json\_error(~~ |
  | 1177 |  | ~~new \WP\_Error(~~ |
  | 1178 |  | ~~500,~~ |
  | 1179 |  | ~~\esc\_html\_\_(~~ |
  | 1180 |  | ~~'Unable to find global secret key',~~ |
  | 1181 |  | ~~'wp-2fa'~~ |
  | 1182 |  | ~~)~~ |
  | 1183 |  | ~~),~~ |
  | 1184 |  | ~~400~~ |
  | 1185 |  | ~~);~~ |
  | 1186 |  | ~~}~~ |
  | 1187 |  | ~~}~~ |
  | 1188 |  | ~~}~~ |
  | 1189 |  | ~~}~~ |
  | 1190 |  | ~~}~~ |
  | 1191 | 1074 | } |
  | 1192 | 1075 |  |
* ## [wp-2fa/trunk/includes/functions/core.php](/changeset/3009922/wp-2fa/trunk/includes/functions/core.php "Show the changeset 3009922 restricted to wp-2fa/trunk/includes/functions/core.php")

  | [r2940688](/browser/wp-2fa/trunk/includes/functions/core.php?rev=2940688#L10 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/includes/functions/core.php?rev=3009922#L10 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | use WP2FA\WP2FA; |
  | 11 | 11 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 12 |  | use WP2FA\Utils\Settings\_Utils~~as Settings\_Utils~~; |
  |  | 12 | use WP2FA\Utils\Settings\_Utils; |
  | 13 | 13 |  |
  | 14 | 14 | /\*\* |
  | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=2940688#L18) | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=3009922#L18) |  |
  | 18 | 18 | \*/ |
  | 19 | 19 | function setup() { |
  | 20 |  | $n = function( $function ) { |
  |  | 20 | $n = function ( $function ) { |
  | 21 | 21 | return \_\_NAMESPACE\_\_ . "\\$function"; |
  | 22 | 22 | }; |
  | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=2940688#L100) | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=3009922#L100) |  |
  | 100 | 100 | \*/ |
  | 101 | 101 | function uninstall() { |
  |  | 102 | WP2FA::init(); |
  | 102 | 103 | if ( ! empty( WP2FA::get\_wp2fa\_general\_setting( 'delete\_data\_upon\_uninstall' ) ) ) { |
  | 103 | 104 | // Delete settings from wp\_options. |
  | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=2940688#L225) | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=3009922#L226) |  |
  | 225 | 226 | enqueue\_select2\_scripts(); |
  | 226 | 227 |  |
  | 227 |  | ~~if ( WP\_Helper::is\_multisite() ) {~~ |
  | 228 |  | ~~enqueue\_multi\_select\_scripts();~~ |
  | 229 |  | ~~}~~ |
  | 230 |  |  |
  | 231 | 228 | // Data array. |
  | 232 | 229 | $data\_array = array( |
  | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=2940688#L257) | […](/browser/wp-2fa/trunk/includes/functions/core.php?rev=3009922#L254) |  |
  | 257 | 254 |  |
  | 258 | 255 | /\*\* |
  | 259 |  | ~~\* Enqueue multi select for multinetwork WP~~ |
  | 260 |  | ~~\*~~ |
  | 261 |  | ~~\* @return void~~ |
  | 262 |  | ~~\*/~~ |
  | 263 |  | ~~function enqueue\_multi\_select\_scripts() {~~ |
  | 264 |  | ~~wp\_enqueue\_script( 'multi-site-select', script\_url( 'multi-site-select', 'admin' ), array( 'jquery', 'select2' ), WP\_2FA\_VERSION, false );~~ |
  | 265 |  | ~~}~~ |
  | 266 |  |  |
  | 267 |  | ~~/\*\*~~ |
  | 268 | 256 | \* Enqueue Select2 jQuery library |
  | 269 | 257 | \* |
* ## [wp-2fa/trunk/languages/wp-2fa.pot](/changeset/3009922/wp-2fa/trunk/languages/wp-2fa.pot "Show the changeset 3009922 restricted to wp-2fa/trunk/languages/wp-2fa.pot")

  | [r2940688](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L3 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L3 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | msgid "" |
  | 4 | 4 | msgstr "" |
  | 5 |  | "Project-Id-Version: WP 2FA - Two-factor authentication for WordPress 2.~~5~~.0\n" |
  |  | 5 | "Project-Id-Version: WP 2FA - Two-factor authentication for WordPress 2.6.0\n" |
  | 6 | 6 | "Report-Msgid-Bugs-To: https://wordpress.org/support/plugin/wp-2fa\n" |
  | 7 | 7 | "Last-Translator: WP White Security <info@wpwhitesecurity.com>\n" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L10) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L10) |  |
  | 10 | 10 | "Content-Type: text/plain; charset=UTF-8\n" |
  | 11 | 11 | "Content-Transfer-Encoding: 8bit\n" |
  | 12 |  | "POT-Creation-Date: 2023-~~07-18T12:20:43~~+00:00\n" |
  |  | 12 | "POT-Creation-Date: 2023-12-13T15:14:18+00:00\n" |
  | 13 | 13 | "PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n" |
  | 14 |  | "X-Generator: WP-CLI 2.~~7.1~~\n" |
  |  | 14 | "X-Generator: WP-CLI 2.9.0\n" |
  | 15 | 15 | "X-Domain: wp-2fa\n" |
  | 16 | 16 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L41) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L41) |  |
  | 41 | 41 | msgstr "" |
  | 42 | 42 |  |
  | 43 |  | #: extensions/authy/class-authy-render.php:5~~5~~ |
  |  | 43 | #: extensions/authy/class-authy-render.php:56 |
  | 44 | 44 | msgid "Authy application / service integration settings" |
  | 45 | 45 | msgstr "" |
  | 46 | 46 |  |
  | 47 | 47 | #. Translators: Authy service documentation |
  | 48 |  | #: extensions/authy/class-authy-render.php:6~~0~~ |
  |  | 48 | #: extensions/authy/class-authy-render.php:61 |
  | 49 | 49 | msgid "Here you can specify your Authy Production API Key or change an existing one. You can get the key from the Twilio console. Refer to the KB article %s for more information and instructions on how to get your key." |
  | 50 | 50 | msgstr "" |
  | 51 | 51 |  |
  | 52 |  | #: extensions/authy/class-authy-render.php:6~~1~~ |
  |  | 52 | #: extensions/authy/class-authy-render.php:62 |
  | 53 | 53 | msgid "how to get the Authy Production API key" |
  | 54 | 54 | msgstr "" |
  | 55 | 55 |  |
  | 56 |  | #: extensions/authy/class-authy-render.php:6~~8~~ |
  |  | 56 | #: extensions/authy/class-authy-render.php:69 |
  | 57 | 57 | #: extensions/authy/class-authy.php:278 |
  | 58 | 58 | msgid "Authy Production API key" |
  | 59 | 59 | msgstr "" |
  | 60 | 60 |  |
  | 61 |  | #: extensions/authy/class-authy-render.php:7~~2~~ |
  | 62 |  | #: extensions/authy/class-~~wizard-steps-authy.php:285~~ |
  |  | 61 | #: extensions/authy/class-authy-render.php:73 |
  |  | 62 | #: extensions/authy/class-authy-wizard-steps.php:330 |
  | 63 | 63 | msgid "Verify the Production API Key" |
  | 64 | 64 | msgstr "" |
  | 65 | 65 |  |
  |  | 66 | #: extensions/authy/class-authy-render.php:120 |
  |  | 67 | #: extensions/twilio/class-twilio-render.php:140 |
  |  | 68 | msgid "The primary 2FA service that you are using is unavailable. Please click the button below to login using the secondary backup method." |
  |  | 69 | msgstr "" |
  |  | 70 |  |
  |  | 71 | #: extensions/authy/class-authy-render.php:140 |
  |  | 72 | msgid "OR" |
  |  | 73 | msgstr "" |
  |  | 74 |  |
  | 66 | 75 | #: extensions/authy/class-authy-render.php:143 |
  | 67 |  | #: extensions/email-backup/class-email-backup-render.php:14~~2~~ |
  | 68 |  | #: includes/classes/Authenticator/class-login.php:1~~206~~ |
  | 69 |  | #: includes/classes/Authenticator/class-login.php:12~~60~~ |
  |  | 76 | #: extensions/email-backup/class-email-backup-render.php:144 |
  |  | 77 | #: includes/classes/Authenticator/class-login.php:1181 |
  |  | 78 | #: includes/classes/Authenticator/class-login.php:1235 |
  | 70 | 79 | msgid "Verification Code:" |
  | 71 | 80 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L75) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L84) |  |
  | 75 | 84 | msgstr "" |
  | 76 | 85 |  |
  | 77 |  | #: extensions/authy/class-authy-user.php:238 |
  |  | 86 | #: extensions/authy/class-authy-user.php:144 |
  |  | 87 | #: extensions/authy/class-authy-user.php:221 |
  |  | 88 | #: extensions/authy/class-authy-user.php:391 |
  |  | 89 | #: extensions/authy/class-authy.php:390 |
  |  | 90 | #: extensions/authy/class-authy.php:477 |
  |  | 91 | #: extensions/authy/class-authy.php:741 |
  |  | 92 | #: extensions/out-of-band/class-out-of-band.php:404 |
  |  | 93 | #: extensions/twilio/class-twilio-user.php:139 |
  |  | 94 | #: extensions/twilio/class-twilio-user.php:211 |
  |  | 95 | #: extensions/twilio/class-twilio.php:164 |
  |  | 96 | #: extensions/twilio/class-twilio.php:214 |
  |  | 97 | #: extensions/twilio/class-twilio.php:791 |
  |  | 98 | #: includes/classes/Admin/class-setup-wizard.php:549 |
  |  | 99 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:187 |
  |  | 100 | msgid "Nonce checking failed" |
  |  | 101 | msgstr "" |
  |  | 102 |  |
  |  | 103 | #: extensions/authy/class-authy-user.php:147 |
  |  | 104 | #: extensions/authy/class-authy-user.php:224 |
  |  | 105 | #: extensions/authy/class-authy-user.php:394 |
  |  | 106 | #: extensions/authy/class-authy.php:393 |
  |  | 107 | #: extensions/authy/class-authy.php:480 |
  |  | 108 | #: extensions/authy/class-authy.php:744 |
  |  | 109 | #: extensions/out-of-band/class-out-of-band.php:407 |
  |  | 110 | #: extensions/twilio/class-twilio-user.php:142 |
  |  | 111 | #: extensions/twilio/class-twilio-user.php:214 |
  |  | 112 | #: extensions/twilio/class-twilio.php:167 |
  |  | 113 | #: extensions/twilio/class-twilio.php:217 |
  |  | 114 | #: extensions/twilio/class-twilio.php:794 |
  |  | 115 | msgid "Nonce is not provided" |
  |  | 116 | msgstr "" |
  |  | 117 |  |
  |  | 118 | #: extensions/authy/class-authy-user.php:150 |
  |  | 119 | #: extensions/authy/class-authy-user.php:227 |
  |  | 120 | #: extensions/authy/class-authy-user.php:397 |
  |  | 121 | #: extensions/authy/class-authy-user.php:402 |
  |  | 122 | #: extensions/authy/class-authy-user.php:407 |
  |  | 123 | #: extensions/authy/class-authy.php:396 |
  |  | 124 | #: extensions/authy/class-authy.php:483 |
  |  | 125 | #: extensions/authy/class-authy.php:747 |
  |  | 126 | #: extensions/twilio/class-twilio-user.php:145 |
  |  | 127 | #: extensions/twilio/class-twilio-user.php:217 |
  |  | 128 | #: extensions/twilio/class-twilio.php:170 |
  |  | 129 | #: extensions/twilio/class-twilio.php:199 |
  |  | 130 | #: extensions/twilio/class-twilio.php:220 |
  |  | 131 | #: extensions/twilio/class-twilio.php:797 |
  |  | 132 | #: includes/classes/Utils/class-user-utils.php:358 |
  |  | 133 | msgid "Not allowed" |
  |  | 134 | msgstr "" |
  |  | 135 |  |
  |  | 136 | #: extensions/authy/class-authy-user.php:237 |
  | 78 | 137 | #: extensions/twilio/class-twilio-user.php:226 |
  | 79 | 138 | msgid "Wrong or no token" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L81) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L140) |  |
  | 81 | 140 |  |
  | 82 | 141 | #. translators: $s the site name. |
  | 83 |  | #: extensions/authy/class-authy-user.php:30~~1~~ |
  |  | 142 | #: extensions/authy/class-authy-user.php:300 |
  | 84 | 143 | msgid "Login request to %s site" |
  | 85 | 144 | msgstr "" |
  | 86 | 145 |  |
  |  | 146 | #: extensions/authy/class-authy-user.php:306 |
  |  | 147 | msgid "Username" |
  |  | 148 | msgstr "" |
  |  | 149 |  |
  | 87 | 150 | #: extensions/authy/class-authy-user.php:307 |
  | 88 |  | ~~msgid "Username"~~ |
  | 89 |  | ~~msgstr ""~~ |
  | 90 |  |  |
  | 91 |  | ~~#: extensions/authy/class-authy-user.php:308~~ |
  | 92 | 151 | msgid "IP Address" |
  | 93 | 152 | msgstr "" |
  | 94 | 153 |  |
  | 95 |  | #: extensions/authy/class-authy-user.php:31~~2~~ |
  |  | 154 | #: extensions/authy/class-authy-user.php:311 |
  | 96 | 155 | msgid "Email" |
  | 97 | 156 | msgstr "" |
  | 98 | 157 |  |
  | 99 |  | #: extensions/authy/class-authy-user.php:31~~6~~ |
  |  | 158 | #: extensions/authy/class-authy-user.php:315 |
  | 100 | 159 | msgid "Name" |
  |  | 160 | msgstr "" |
  |  | 161 |  |
  |  | 162 | #: extensions/authy/class-authy-wizard-steps.php:104 |
  |  | 163 | #: extensions/email-backup/class-email-backup-render.php:108 |
  |  | 164 | #: extensions/twilio/class-twilio-wizard-steps.php:106 |
  |  | 165 | #: includes/classes/Admin/Views/class-wizard-steps.php:175 |
  |  | 166 | #: includes/classes/Admin/Views/class-wizard-steps.php:181 |
  |  | 167 | #: includes/classes/Admin/Views/class-wizard-steps.php:318 |
  |  | 168 | #: includes/classes/Admin/Views/class-wizard-steps.php:343 |
  |  | 169 | msgid "Close wizard" |
  |  | 170 | msgstr "" |
  |  | 171 |  |
  |  | 172 | #: extensions/authy/class-authy-wizard-steps.php:116 |
  |  | 173 | #: extensions/authy/class-authy-wizard-steps.php:194 |
  |  | 174 | #: extensions/out-of-band/class-oob-wizard-steps.php:103 |
  |  | 175 | #: extensions/out-of-band/class-oob-wizard-steps.php:202 |
  |  | 176 | #: extensions/twilio/class-twilio-wizard-steps.php:118 |
  |  | 177 | #: extensions/twilio/class-twilio-wizard-steps.php:193 |
  |  | 178 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:96 |
  |  | 179 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:320 |
  |  | 180 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:262 |
  |  | 181 | msgid "I'm Ready" |
  |  | 182 | msgstr "" |
  |  | 183 |  |
  |  | 184 | #: extensions/authy/class-authy-wizard-steps.php:116 |
  |  | 185 | #: extensions/twilio/class-twilio-wizard-steps.php:118 |
  |  | 186 | msgid "Change phone" |
  |  | 187 | msgstr "" |
  |  | 188 |  |
  |  | 189 | #: extensions/authy/class-authy-wizard-steps.php:187 |
  |  | 190 | msgid "Authy phone" |
  |  | 191 | msgstr "" |
  |  | 192 |  |
  |  | 193 | #: extensions/authy/class-authy-wizard-steps.php:195 |
  |  | 194 | #: extensions/authy/class-authy-wizard-steps.php:216 |
  |  | 195 | #: extensions/out-of-band/class-oob-wizard-steps.php:203 |
  |  | 196 | #: extensions/out-of-band/class-oob-wizard-steps.php:229 |
  |  | 197 | #: extensions/settings-import-export/class-settings-import-export.php:398 |
  |  | 198 | #: extensions/twilio/class-twilio-wizard-steps.php:210 |
  |  | 199 | #: includes/classes/Admin/class-user-profile.php:432 |
  |  | 200 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:321 |
  |  | 201 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:347 |
  |  | 202 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:263 |
  |  | 203 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:286 |
  |  | 204 | #: includes/classes/Admin/Views/class-wizard-steps.php:65 |
  |  | 205 | msgid "Cancel" |
  |  | 206 | msgstr "" |
  |  | 207 |  |
  |  | 208 | #: extensions/authy/class-authy-wizard-steps.php:199 |
  |  | 209 | #: extensions/out-of-band/class-oob-wizard-steps.php:207 |
  |  | 210 | #: extensions/twilio/class-twilio-wizard-steps.php:197 |
  |  | 211 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:325 |
  |  | 212 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:266 |
  |  | 213 | msgid "Verify configuration" |
  |  | 214 | msgstr "" |
  |  | 215 |  |
  |  | 216 | #: extensions/authy/class-authy-wizard-steps.php:209 |
  |  | 217 | msgid "code" |
  |  | 218 | msgstr "" |
  |  | 219 |  |
  |  | 220 | #: extensions/authy/class-authy-wizard-steps.php:215 |
  |  | 221 | #: extensions/out-of-band/class-oob-wizard-steps.php:225 |
  |  | 222 | #: extensions/twilio/class-twilio-wizard-steps.php:209 |
  |  | 223 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:343 |
  |  | 224 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:285 |
  |  | 225 | msgid "Validate & Save" |
  |  | 226 | msgstr "" |
  |  | 227 |  |
  |  | 228 | #: extensions/authy/class-authy-wizard-steps.php:290 |
  |  | 229 | #: extensions/twilio/class-twilio-wizard-steps.php:285 |
  |  | 230 | msgid "Please verify credentials to enable." |
  |  | 231 | msgstr "" |
  |  | 232 |  |
  |  | 233 | #: extensions/authy/class-authy-wizard-steps.php:293 |
  |  | 234 | msgid "Push notification via Authy App" |
  |  | 235 | msgstr "" |
  |  | 236 |  |
  |  | 237 | #: extensions/authy/class-authy-wizard-steps.php:299 |
  |  | 238 | msgid "When using this method, users will receive a notification on their Authy app to confirm the log in. " |
  |  | 239 | msgstr "" |
  |  | 240 |  |
  |  | 241 | #. Translators: Authy service documentation |
  |  | 242 | #: extensions/authy/class-authy-wizard-steps.php:303 |
  |  | 243 | msgid "Once they tap / approve the notification they log in to the website. Refer to the %s for more information on how to use the Authy with WP 2FA for two-factor authentication on your website." |
  |  | 244 | msgstr "" |
  |  | 245 |  |
  |  | 246 | #: extensions/authy/class-authy-wizard-steps.php:304 |
  |  | 247 | msgid "Authy integration documentation" |
  |  | 248 | msgstr "" |
  |  | 249 |  |
  |  | 250 | #: extensions/authy/class-authy-wizard-steps.php:313 |
  |  | 251 | #: extensions/twilio/class-twilio-wizard-steps.php:308 |
  |  | 252 | #: includes/classes/Admin/class-settings-page.php:63 |
  |  | 253 | #: includes/classes/Admin/class-settings-page.php:138 |
  |  | 254 | msgid "Settings" |
  |  | 255 | msgstr "" |
  |  | 256 |  |
  |  | 257 | #: extensions/authy/class-authy-wizard-steps.php:315 |
  |  | 258 | #: extensions/twilio/class-twilio-wizard-steps.php:310 |
  |  | 259 | msgid "Configure connection details" |
  |  | 260 | msgstr "" |
  |  | 261 |  |
  |  | 262 | #: extensions/authy/class-authy-wizard-steps.php:315 |
  |  | 263 | #: extensions/twilio/class-twilio-wizard-steps.php:310 |
  |  | 264 | msgid "Delete connection details" |
  |  | 265 | msgstr "" |
  |  | 266 |  |
  |  | 267 | #: extensions/authy/class-authy-wizard-steps.php:326 |
  |  | 268 | msgid "Authy Production API" |
  | 101 | 269 | msgstr "" |
  | 102 | 270 |  |
  | 103 | 271 | #: extensions/authy/class-authy.php:269 |
  | 104 | 272 | #: extensions/authy/class-authy.php:273 |
  | 105 |  | #: extensions/twilio/class-twilio.php:387 |
  |  | 273 | #: extensions/twilio/class-twilio.php:389 |
  |  | 274 | #: extensions/twilio/class-twilio.php:393 |
  |  | 275 | msgid "Invalid number" |
  |  | 276 | msgstr "" |
  |  | 277 |  |
  |  | 278 | #: extensions/authy/class-authy.php:270 |
  |  | 279 | #: extensions/twilio/class-twilio.php:390 |
  |  | 280 | msgid "Invalid country code" |
  |  | 281 | msgstr "" |
  |  | 282 |  |
  |  | 283 | #: extensions/authy/class-authy.php:271 |
  | 106 | 284 | #: extensions/twilio/class-twilio.php:391 |
  | 107 |  | ~~msgid "Invalid number"~~ |
  | 108 |  | ~~msgstr ""~~ |
  | 109 |  |  |
  | 110 |  | ~~#: extensions/authy/class-authy.php:270~~ |
  | 111 |  | ~~#: extensions/twilio/class-twilio.php:388~~ |
  | 112 |  | ~~msgid "Invalid country code"~~ |
  | 113 |  | ~~msgstr ""~~ |
  | 114 |  |  |
  | 115 |  | ~~#: extensions/authy/class-authy.php:271~~ |
  | 116 |  | ~~#: extensions/twilio/class-twilio.php:389~~ |
  | 117 | 285 | msgid "Too short" |
  | 118 | 286 | msgstr "" |
  | 119 | 287 |  |
  | 120 | 288 | #: extensions/authy/class-authy.php:272 |
  | 121 |  | #: extensions/twilio/class-twilio.php:39~~0~~ |
  |  | 289 | #: extensions/twilio/class-twilio.php:392 |
  | 122 | 290 | msgid "Too long" |
  | 123 | 291 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L128) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L296) |  |
  | 128 | 296 |  |
  | 129 | 297 | #: extensions/authy/class-authy.php:321 |
  | 130 |  | #: extensions/authy/class-authy.php:61~~2~~ |
  |  | 298 | #: extensions/authy/class-authy.php:613 |
  | 131 | 299 | msgid "Authy" |
  | 132 | 300 | msgstr "" |
  | 133 | 301 |  |
  | 134 | 302 | #: extensions/authy/class-authy.php:325 |
  | 135 |  | #: extensions/twilio/class-twilio.php:44~~6~~ |
  | 136 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:12~~1~~ |
  |  | 303 | #: extensions/twilio/class-twilio.php:448 |
  |  | 304 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:123 |
  | 137 | 305 | #: includes/classes/Admin/SettingsPages/class-settings-page-render.php:130 |
  | 138 | 306 | #: includes/classes/Admin/SettingsPages/class-settings-page-render.php:151 |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L142) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L310) |  |
  | 142 | 310 | #: extensions/authy/class-authy.php:326 |
  | 143 | 311 | #: extensions/integrations/class-wp2fa-integrations.php:103 |
  | 144 |  | #: extensions/twilio/class-twilio.php:447 |
  |  | 312 | #: extensions/settings-import-export/class-settings-import-exporter.php:237 |
  |  | 313 | #: extensions/twilio/class-twilio.php:449 |
  | 145 | 314 | #: extensions/user-licensing/class-wp2fa-user-licensing.php:70 |
  | 146 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:12~~2~~ |
  |  | 315 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:124 |
  | 147 | 316 | #: includes/classes/Admin/SettingsPages/class-settings-page-render.php:131 |
  | 148 | 317 | #: includes/classes/Admin/SettingsPages/class-settings-page-render.php:152 |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L151) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L320) |  |
  | 151 | 320 | msgstr "" |
  | 152 | 321 |  |
  | 153 |  | #: extensions/authy/class-authy.php:637 |
  | 154 |  | #: extensions/email-backup/class-email-backup.php:332 |
  | 155 |  | #: extensions/twilio/class-twilio.php:722 |
  | 156 |  | #: includes/classes/Authenticator/class-login.php:953 |
  | 157 |  | #: includes/classes/Authenticator/class-login.php:978 |
  | 158 |  | #: includes/classes/Authenticator/class-login.php:1003 |
  | 159 |  | #: includes/classes/Authenticator/class-reset-passord.php:206 |
  |  | 322 | #: extensions/authy/class-authy.php:548 |
  |  | 323 | msgid "Push notification via Authy app" |
  |  | 324 | msgstr "" |
  |  | 325 |  |
  |  | 326 | #: extensions/authy/class-authy.php:638 |
  |  | 327 | #: extensions/email-backup/class-email-backup.php:341 |
  |  | 328 | #: extensions/twilio/class-twilio.php:728 |
  |  | 329 | #: includes/classes/Authenticator/class-login.php:969 |
  |  | 330 | #: includes/classes/Authenticator/class-login.php:995 |
  |  | 331 | #: includes/classes/Authenticator/class-login.php:1020 |
  |  | 332 | #: includes/classes/Authenticator/class-reset-passord.php:207 |
  | 160 | 333 | msgid "<strong>Error</strong>: User can not be authenticated." |
  | 161 | 334 | msgstr "" |
  | 162 | 335 |  |
  | 163 |  | #: extensions/authy/class-authy.php:64~~3~~ |
  | 164 |  | #: extensions/email-backup/class-email-backup.php:3~~38~~ |
  | 165 |  | #: extensions/twilio/class-twilio.php:7~~28~~ |
  | 166 |  | #: includes/classes/Authenticator/class-login.php:~~189~~ |
  | 167 |  | #: includes/classes/Authenticator/class-login.php:5~~40~~ |
  | 168 |  | #: includes/classes/Authenticator/class-login.php:9~~42~~ |
  | 169 |  | #: includes/classes/Authenticator/class-login.php:9~~59~~ |
  | 170 |  | #: includes/classes/Authenticator/class-login.php:~~983~~ |
  | 171 |  | #: includes/classes/Authenticator/class-login.php:10~~09~~ |
  | 172 |  | #: includes/classes/Authenticator/class-reset-passord.php:~~79~~ |
  | 173 |  | #: includes/classes/Authenticator/class-reset-passord.php:19~~5~~ |
  | 174 |  | #: includes/classes/Authenticator/class-reset-passord.php:21~~2~~ |
  |  | 336 | #: extensions/authy/class-authy.php:644 |
  |  | 337 | #: extensions/email-backup/class-email-backup.php:347 |
  |  | 338 | #: extensions/twilio/class-twilio.php:734 |
  |  | 339 | #: includes/classes/Authenticator/class-login.php:215 |
  |  | 340 | #: includes/classes/Authenticator/class-login.php:556 |
  |  | 341 | #: includes/classes/Authenticator/class-login.php:958 |
  |  | 342 | #: includes/classes/Authenticator/class-login.php:975 |
  |  | 343 | #: includes/classes/Authenticator/class-login.php:1000 |
  |  | 344 | #: includes/classes/Authenticator/class-login.php:1026 |
  |  | 345 | #: includes/classes/Authenticator/class-reset-passord.php:80 |
  |  | 346 | #: includes/classes/Authenticator/class-reset-passord.php:196 |
  |  | 347 | #: includes/classes/Authenticator/class-reset-passord.php:213 |
  | 175 | 348 | msgid "Failed to create a login nonce." |
  | 176 | 349 | msgstr "" |
  | 177 | 350 |  |
  | 178 |  | #: extensions/authy/class-authy.php:64~~7~~ |
  | 179 |  | #: extensions/email-backup/class-email-backup.php:3~~42~~ |
  | 180 |  | #: extensions/twilio/class-twilio.php:73~~2~~ |
  |  | 351 | #: extensions/authy/class-authy.php:648 |
  |  | 352 | #: extensions/email-backup/class-email-backup.php:351 |
  |  | 353 | #: extensions/twilio/class-twilio.php:738 |
  | 181 | 354 | msgid "One of the required parameters is missing." |
  | 182 | 355 | msgstr "" |
  | 183 | 356 |  |
  | 184 |  | #: extensions/authy/class-authy.php:65~~0~~ |
  | 185 |  | #: extensions/email-backup/class-email-backup.php:3~~48~~ |
  | 186 |  | #: extensions/twilio/class-twilio.php:7~~35~~ |
  | 187 |  | #: includes/classes/Authenticator/class-login.php:9~~63~~ |
  | 188 |  | #: includes/classes/Authenticator/class-login.php:10~~15~~ |
  | 189 |  | #: includes/classes/Authenticator/class-reset-passord.php:21~~8~~ |
  |  | 357 | #: extensions/authy/class-authy.php:651 |
  |  | 358 | #: extensions/email-backup/class-email-backup.php:357 |
  |  | 359 | #: extensions/twilio/class-twilio.php:741 |
  |  | 360 | #: includes/classes/Authenticator/class-login.php:979 |
  |  | 361 | #: includes/classes/Authenticator/class-login.php:1032 |
  |  | 362 | #: includes/classes/Authenticator/class-reset-passord.php:219 |
  | 190 | 363 | msgid "ERROR: Invalid verification code." |
  | 191 | 364 | msgstr "" |
  | 192 | 365 |  |
  | 193 | 366 | #. translators: hyperlink "contact our support team". |
  | 194 |  | #: extensions/authy/class-authy.php:68~~6~~ |
  |  | 367 | #: extensions/authy/class-authy.php:687 |
  | 195 | 368 | msgid "The %1$s 2FA service is unavailable. Please check the configuration and the service's dashboard to restore functionality. If the problem persists, %2$s." |
  | 196 | 369 | msgstr "" |
  | 197 | 370 |  |
  | 198 |  | #: extensions/authy/class-authy.php:69~~1~~ |
  |  | 371 | #: extensions/authy/class-authy.php:692 |
  | 199 | 372 | msgid "contact our support team" |
  | 200 | 373 | msgstr "" |
  | 201 | 374 |  |
  | 202 |  | #: extensions/authy/class-wizard-steps-authy.php:76 |
  | 203 |  | msgid "Push notification via Authy app" |
  | 204 |  | msgstr "" |
  | 205 |  |  |
  | 206 |  | #: extensions/authy/class-wizard-steps-authy.php:99 |
  | 207 |  | #: extensions/email-backup/class-email-backup-render.php:106 |
  | 208 |  | #: extensions/twilio/class-wizard-steps-twilio.php:101 |
  | 209 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:509 |
  | 210 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:515 |
  | 211 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:650 |
  | 212 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:675 |
  | 213 |  | msgid "Close wizard" |
  | 214 |  | msgstr "" |
  | 215 |  |  |
  | 216 |  | #: extensions/authy/class-wizard-steps-authy.php:112 |
  | 217 |  | #: extensions/authy/class-wizard-steps-authy.php:152 |
  | 218 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:108 |
  | 219 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:161 |
  | 220 |  | #: extensions/twilio/class-wizard-steps-twilio.php:114 |
  | 221 |  | #: extensions/twilio/class-wizard-steps-twilio.php:151 |
  | 222 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:237 |
  | 223 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:336 |
  | 224 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:427 |
  | 225 |  | msgid "I'm Ready" |
  | 226 |  | msgstr "" |
  | 227 |  |  |
  | 228 |  | #: extensions/authy/class-wizard-steps-authy.php:112 |
  | 229 |  | #: extensions/twilio/class-wizard-steps-twilio.php:114 |
  | 230 |  | msgid "Change phone" |
  | 231 |  | msgstr "" |
  | 232 |  |  |
  | 233 |  | #: extensions/authy/class-wizard-steps-authy.php:145 |
  | 234 |  | msgid "Authy phone" |
  | 235 |  | msgstr "" |
  | 236 |  |  |
  | 237 |  | #: extensions/authy/class-wizard-steps-authy.php:156 |
  | 238 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:166 |
  | 239 |  | #: extensions/twilio/class-wizard-steps-twilio.php:155 |
  | 240 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:339 |
  | 241 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:432 |
  | 242 |  | msgid "Verify configuration" |
  | 243 |  | msgstr "" |
  | 244 |  |  |
  | 245 |  | #: extensions/authy/class-wizard-steps-authy.php:166 |
  | 246 |  | msgid "code" |
  | 247 |  | msgstr "" |
  | 248 |  |  |
  | 249 |  | #: extensions/authy/class-wizard-steps-authy.php:172 |
  | 250 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:184 |
  | 251 |  | #: extensions/twilio/class-wizard-steps-twilio.php:167 |
  | 252 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:358 |
  | 253 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:450 |
  | 254 |  | msgid "Validate & Save" |
  | 255 |  | msgstr "" |
  | 256 |  |  |
  | 257 |  | #: extensions/authy/class-wizard-steps-authy.php:173 |
  | 258 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:188 |
  | 259 |  | #: extensions/twilio/class-wizard-steps-twilio.php:168 |
  | 260 |  | #: includes/classes/Admin/class-user-profile.php:443 |
  | 261 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:82 |
  | 262 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:359 |
  | 263 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:454 |
  | 264 |  | msgid "Cancel" |
  | 265 |  | msgstr "" |
  | 266 |  |  |
  | 267 |  | #: extensions/authy/class-wizard-steps-authy.php:245 |
  | 268 |  | #: extensions/twilio/class-wizard-steps-twilio.php:240 |
  | 269 |  | msgid "Please verify credentials to enable." |
  | 270 |  | msgstr "" |
  | 271 |  |  |
  | 272 |  | #: extensions/authy/class-wizard-steps-authy.php:248 |
  | 273 |  | msgid "Push notification via Authy App" |
  | 274 |  | msgstr "" |
  | 275 |  |  |
  | 276 |  | #: extensions/authy/class-wizard-steps-authy.php:254 |
  | 277 |  | msgid "When using this method, users will receive a notification on their Authy app to confirm the log in. " |
  | 278 |  | msgstr "" |
  | 279 |  |  |
  | 280 |  | #. Translators: Authy service documentation |
  | 281 |  | #: extensions/authy/class-wizard-steps-authy.php:258 |
  | 282 |  | msgid "Once they tap / approve the notification they log in to the website. Refer to the %s for more information on how to use the Authy with WP 2FA for two-factor authentication on your website." |
  | 283 |  | msgstr "" |
  | 284 |  |  |
  | 285 |  | #: extensions/authy/class-wizard-steps-authy.php:259 |
  | 286 |  | msgid "Authy integration documentation" |
  | 287 |  | msgstr "" |
  | 288 |  |  |
  | 289 |  | #: extensions/authy/class-wizard-steps-authy.php:268 |
  | 290 |  | #: extensions/twilio/class-wizard-steps-twilio.php:263 |
  | 291 |  | #: includes/classes/Admin/class-settings-page.php:72 |
  | 292 |  | #: includes/classes/Admin/class-settings-page.php:145 |
  | 293 |  | msgid "Settings" |
  | 294 |  | msgstr "" |
  | 295 |  |  |
  | 296 |  | #: extensions/authy/class-wizard-steps-authy.php:270 |
  | 297 |  | #: extensions/twilio/class-wizard-steps-twilio.php:265 |
  | 298 |  | msgid "Configure connection details" |
  | 299 |  | msgstr "" |
  | 300 |  |  |
  | 301 |  | #: extensions/authy/class-wizard-steps-authy.php:270 |
  | 302 |  | #: extensions/twilio/class-wizard-steps-twilio.php:265 |
  | 303 |  | msgid "Delete connection details" |
  | 304 |  | msgstr "" |
  | 305 |  |  |
  | 306 |  | #: extensions/authy/class-wizard-steps-authy.php:281 |
  | 307 |  | msgid "Authy Production API" |
  | 308 |  | msgstr "" |
  | 309 |  |  |
  | 310 |  | #: extensions/email-backup/class-email-backup-render.php:84 |
  |  | 375 | #: extensions/email-backup/class-email-backup-render.php:86 |
  | 311 | 376 | msgid "Use my user email " |
  | 312 | 377 | msgstr "" |
  | 313 | 378 |  |
  | 314 |  | #: extensions/email-backup/class-email-backup-render.php:9~~3~~ |
  | 315 |  | #: extensions/out-of-band/class-~~wizard-steps-oob.php:152~~ |
  | 316 |  | #: includes/classes/Admin/~~Views/class-wizard-steps.php:399~~ |
  |  | 379 | #: extensions/email-backup/class-email-backup-render.php:95 |
  |  | 380 | #: extensions/out-of-band/class-oob-wizard-steps.php:193 |
  |  | 381 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:292 |
  | 317 | 382 | msgid "Use a different email address:" |
  | 318 | 383 | msgstr "" |
  | 319 | 384 |  |
  | 320 |  | #: extensions/email-backup/class-email-backup-render.php:9~~4~~ |
  | 321 |  | #: extensions/out-of-band/class-~~wizard-steps-oob.php:153~~ |
  | 322 |  | #: includes/classes/Admin/~~Views/class-wizard-steps.php:400~~ |
  |  | 385 | #: extensions/email-backup/class-email-backup-render.php:96 |
  |  | 386 | #: extensions/out-of-band/class-oob-wizard-steps.php:194 |
  |  | 387 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:293 |
  | 323 | 388 | msgid "Email address" |
  | 324 | 389 | msgstr "" |
  | 325 | 390 |  |
  | 326 |  | #: extensions/email-backup/class-email-backup-render.php:10~~2~~ |
  |  | 391 | #: extensions/email-backup/class-email-backup-render.php:104 |
  | 327 | 392 | msgid "Save email backup options" |
  | 328 | 393 | msgstr "" |
  | 329 | 394 |  |
  | 330 |  | #: extensions/email-backup/class-email-backup-render.php:10~~3~~ |
  |  | 395 | #: extensions/email-backup/class-email-backup-render.php:105 |
  | 331 | 396 | msgid "Save 2FA backup email address" |
  | 332 | 397 | msgstr "" |
  | 333 | 398 |  |
  | 334 |  | #: extensions/email-backup/class-email-backup-render.php:18~~4~~ |
  |  | 399 | #: extensions/email-backup/class-email-backup-render.php:186 |
  | 335 | 400 | msgid "Or, send me a code to my email." |
  | 336 | 401 | msgstr "" |
  | 337 | 402 |  |
  | 338 |  | #: extensions/email-backup/class-email-backup-render.php:2~~39~~ |
  |  | 403 | #: extensions/email-backup/class-email-backup-render.php:241 |
  | 339 | 404 | msgid "Allow users to use email based 2FA as secondary backup method to" |
  | 340 | 405 | msgstr "" |
  | 341 | 406 |  |
  | 342 |  | #: extensions/email-backup/class-email-backup-render.php:24~~2~~ |
  |  | 407 | #: extensions/email-backup/class-email-backup-render.php:244 |
  | 343 | 408 | msgid "By enabling this feature users can also configure and use the \"one-time code via email\" 2FA method as a secondary backup method. This allows them to receive a one-time login code via email if they need to login to the website and cannot generate the login code from their 2FA app. This feature only applies to users who are using smartphone / app 2FA methods." |
  | 344 | 409 | msgstr "" |
  | 345 | 410 |  |
  | 346 |  | #: extensions/email-backup/class-email-backup-render.php:245 |
  | 347 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:286 |
  | 348 |  | #: extensions/role-settings/class-role-settings-render.php:256 |
  | 349 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:114 |
  |  | 411 | #: extensions/email-backup/class-email-backup-render.php:247 |
  |  | 412 | #: extensions/out-of-band/class-oob-wizard-steps.php:329 |
  |  | 413 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:205 |
  | 350 | 414 | msgid "Allow user to specify the email address of choice" |
  | 351 | 415 | msgstr "" |
  | 352 | 416 |  |
  | 353 |  | #: extensions/email-backup/class-email-backup-render.php:25~~1~~ |
  | 354 |  | #: extensions/~~out-of-band/class-wizard-steps-oob.php:292~~ |
  | 355 |  | #: extensions/~~role-settings/class-role-settings-render.php:262~~ |
  | 356 |  | #: extensions/role-settings/class-role-settings-render.php:~~621~~ |
  | 357 |  | #: includes/classes/Admin/class-user-profile.php:3~~82~~ |
  | 358 |  | #: includes/classes/Admin/class-user-profile.php:5~~31~~ |
  | 359 |  | #: includes/classes/Admin/~~SettingsPages/class-settings-page-policies.php:699~~ |
  | 360 |  | #: includes/classes/Admin/~~Views/class-first-time-wizard-steps.php:120~~ |
  |  | 417 | #: extensions/email-backup/class-email-backup-render.php:253 |
  |  | 418 | #: extensions/email-backup/class-email-backup-render.php:309 |
  |  | 419 | #: extensions/out-of-band/class-oob-wizard-steps.php:335 |
  |  | 420 | #: extensions/role-settings/class-role-settings-render.php:545 |
  |  | 421 | #: includes/classes/Admin/class-user-profile.php:374 |
  |  | 422 | #: includes/classes/Admin/class-user-profile.php:518 |
  |  | 423 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:211 |
  |  | 424 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:697 |
  | 361 | 425 | msgid "Yes" |
  | 362 | 426 | msgstr "" |
  | 363 | 427 |  |
  | 364 |  | #: extensions/email-backup/class-email-backup-render.php:25~~5~~ |
  | 365 |  | #: extensions/~~out-of-band/class-wizard-steps-oob.php:296~~ |
  | 366 |  | #: extensions/~~role-settings/class-role-settings-render.php:266~~ |
  | 367 |  | #: extensions/role-settings/class-role-settings-render.php:~~631~~ |
  | 368 |  | #: includes/classes/Admin/class-user-profile.php:3~~83~~ |
  | 369 |  | #: includes/classes/Admin/class-user-profile.php:5~~32~~ |
  | 370 |  | #: includes/classes/Admin/~~SettingsPages/class-settings-page-policies.php:706~~ |
  | 371 |  | #: includes/classes/Admin/~~Views/class-first-time-wizard-steps.php:12~~4 |
  |  | 428 | #: extensions/email-backup/class-email-backup-render.php:257 |
  |  | 429 | #: extensions/email-backup/class-email-backup-render.php:310 |
  |  | 430 | #: extensions/out-of-band/class-oob-wizard-steps.php:339 |
  |  | 431 | #: extensions/role-settings/class-role-settings-render.php:555 |
  |  | 432 | #: includes/classes/Admin/class-user-profile.php:375 |
  |  | 433 | #: includes/classes/Admin/class-user-profile.php:519 |
  |  | 434 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:215 |
  |  | 435 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:704 |
  | 372 | 436 | msgid "No" |
  | 373 | 437 | msgstr "" |
  | 374 | 438 |  |
  | 375 |  | #: extensions/email-backup/class-email-backup-render.php:29~~7~~ |
  |  | 439 | #: extensions/email-backup/class-email-backup-render.php:298 |
  | 376 | 440 | msgid "Configure backup email" |
  | 377 | 441 | msgstr "" |
  | 378 | 442 |  |
  | 379 |  | #: extensions/email-backup/class-email-backup-render.php:~~299~~ |
  |  | 443 | #: extensions/email-backup/class-email-backup-render.php:300 |
  | 380 | 444 | msgid "Remove backup email method" |
  | 381 | 445 | msgstr "" |
  | 382 | 446 |  |
  | 383 |  | #: extensions/email-backup/class-email-backup-render.php:30~~5~~ |
  |  | 447 | #: extensions/email-backup/class-email-backup-render.php:306 |
  | 384 | 448 | msgid "Remove 2FA backup mail?" |
  | 385 | 449 | msgstr "" |
  | 386 | 450 |  |
  | 387 |  | #: extensions/email-backup/class-email-backup-render.php:30~~6~~ |
  |  | 451 | #: extensions/email-backup/class-email-backup-render.php:307 |
  | 388 | 452 | msgid "Are you sure you want to remove the backup email method?" |
  | 389 | 453 | msgstr "" |
  | 390 | 454 |  |
  | 391 |  | #: extensions/email-backup/class-email-backup-render.php:35~~3~~ |
  |  | 455 | #: extensions/email-backup/class-email-backup-render.php:354 |
  | 392 | 456 | msgid "Email backup page text" |
  | 393 | 457 | msgstr "" |
  | 394 | 458 |  |
  | 395 |  | #: extensions/email-backup/class-email-backup-render.php:358 |
  | 396 |  | #: extensions/out-of-band/class-out-of-band.php:933 |
  | 397 |  | #: extensions/twilio/class-twilio.php:817 |
  | 398 |  | #: extensions/twilio/class-twilio.php:826 |
  | 399 |  | #: extensions/white-labeling/class-white-labeling-render.php:610 |
  | 400 |  | #: includes/classes/Admin/class-user-notices.php:199 |
  | 401 |  | #: includes/classes/Admin/class-user-notices.php:208 |
  | 402 |  | #: includes/classes/Admin/class-user-notices.php:217 |
  | 403 |  | #: includes/classes/Admin/class-user-notices.php:226 |
  | 404 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:286 |
  | 405 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:297 |
  |  | 459 | #: extensions/email-backup/class-email-backup-render.php:359 |
  |  | 460 | #: extensions/twilio/class-twilio.php:823 |
  |  | 461 | #: extensions/twilio/class-twilio.php:832 |
  |  | 462 | #: extensions/white-labeling/class-white-labeling-render.php:598 |
  |  | 463 | #: includes/classes/Admin/class-user-notices.php:200 |
  |  | 464 | #: includes/classes/Admin/class-user-notices.php:209 |
  |  | 465 | #: includes/classes/Admin/class-user-notices.php:218 |
  |  | 466 | #: includes/classes/Admin/class-user-notices.php:227 |
  |  | 467 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:375 |
  |  | 468 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:387 |
  | 406 | 469 | msgid "Note:" |
  | 407 | 470 | msgstr "" |
  | 408 | 471 |  |
  | 409 |  | #: extensions/email-backup/class-email-backup-render.php:358 |
  | 410 |  | #: extensions/out-of-band/class-out-of-band.php:933 |
  | 411 |  | #: extensions/twilio/class-twilio.php:817 |
  | 412 |  | #: extensions/twilio/class-twilio.php:826 |
  | 413 |  | #: includes/classes/Admin/class-user-notices.php:199 |
  | 414 |  | #: includes/classes/Admin/class-user-notices.php:208 |
  | 415 |  | #: includes/classes/Admin/class-user-notices.php:217 |
  | 416 |  | #: includes/classes/Admin/class-user-notices.php:226 |
  | 417 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:286 |
  | 418 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:297 |
  |  | 472 | #: extensions/email-backup/class-email-backup-render.php:359 |
  |  | 473 | #: extensions/twilio/class-twilio.php:823 |
  |  | 474 | #: extensions/twilio/class-twilio.php:832 |
  |  | 475 | #: includes/classes/Admin/class-user-notices.php:200 |
  |  | 476 | #: includes/classes/Admin/class-user-notices.php:209 |
  |  | 477 | #: includes/classes/Admin/class-user-notices.php:218 |
  |  | 478 | #: includes/classes/Admin/class-user-notices.php:227 |
  |  | 479 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:375 |
  |  | 480 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:387 |
  | 419 | 481 | msgid "Only plain text is allowed." |
  | 420 | 482 | msgstr "" |
  | 421 | 483 |  |
  | 422 |  | #: extensions/email-backup/class-email-backup.php:~~72~~ |
  |  | 484 | #: extensions/email-backup/class-email-backup.php:67 |
  | 423 | 485 | msgid "Enter a backup email code." |
  | 424 | 486 | msgstr "" |
  | 425 | 487 |  |
  | 426 |  | #: extensions/email-backup/class-email-backup.php:1~~03~~ |
  |  | 488 | #: extensions/email-backup/class-email-backup.php:114 |
  | 427 | 489 | msgid "Backup Email" |
  | 428 | 490 | msgstr "" |
  | 429 | 491 |  |
  | 430 |  | #: extensions/email-backup/class-email-backup.php:1~~84~~ |
  |  | 492 | #: extensions/email-backup/class-email-backup.php:193 |
  | 431 | 493 | msgid "Receive code over email: you will receive a one-time code via email which you need to login and you cannot generate a code from the app." |
  | 432 | 494 | msgstr "" |
  | 433 | 495 |  |
  | 434 |  | #: extensions/email-backup/class-email-backup.php:273 |
  | 435 |  | #: includes/classes/Admin/class-settings-page.php:178 |
  | 436 |  | #: includes/classes/Admin/class-settings-page.php:222 |
  | 437 |  | #: includes/classes/Admin/class-settings-page.php:271 |
  | 438 |  | #: includes/classes/Admin/class-settings-page.php:309 |
  | 439 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:239 |
  |  | 496 | #: extensions/email-backup/class-email-backup.php:282 |
  |  | 497 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:55 |
  |  | 498 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:101 |
  |  | 499 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:152 |
  |  | 500 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:244 |
  |  | 501 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:278 |
  |  | 502 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:249 |
  | 440 | 503 | msgid "Nonce verification failed." |
  | 441 | 504 | msgstr "" |
  | 442 | 505 |  |
  | 443 |  | #: extensions/email-backup/class-email-backup.php:3~~46~~ |
  | 444 |  | #: includes/classes/Authenticator/class-login.php:10~~13~~ |
  | 445 |  | #: includes/classes/Authenticator/class-reset-passord.php:21~~6~~ |
  |  | 506 | #: extensions/email-backup/class-email-backup.php:355 |
  |  | 507 | #: includes/classes/Authenticator/class-login.php:1030 |
  |  | 508 | #: includes/classes/Authenticator/class-reset-passord.php:217 |
  | 446 | 509 | msgid "A new code has been sent." |
  | 447 | 510 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L466) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L529) |  |
  | 466 | 529 |  |
  | 467 | 530 | #: extensions/integrations/plugins/class-integrations-plugins-base.php:109 |
  | 468 |  | msgid "~~Add this help text right under WooCommerce:~~ Enable this integration so a 2FA configuration entry is automatically added in the menu of your WooCommerce's user portal." |
  | 469 |  | msgstr "" |
  | 470 |  |  |
  | 471 |  | #: extensions/integrations/plugins/class-woocommerce.php:1~~67~~ |
  |  | 531 | msgid "Enable this integration so a 2FA configuration entry is automatically added in the menu of your WooCommerce's user portal." |
  |  | 532 | msgstr "" |
  |  | 533 |  |
  |  | 534 | #: extensions/integrations/plugins/class-woocommerce.php:175 |
  | 472 | 535 | msgid "Enable" |
  | 473 | 536 | msgstr "" |
  | 474 | 537 |  |
  | 475 |  | #: extensions/integrations/plugins/class-woocommerce.php:1~~73~~ |
  |  | 538 | #: extensions/integrations/plugins/class-woocommerce.php:181 |
  | 476 | 539 | msgid "Custom 2FA endpoint" |
  | 477 | 540 | msgstr "" |
  | 478 | 541 |  |
  | 479 |  | #: extensions/integrations/plugins/class-woocommerce.php:1~~79~~ |
  |  | 542 | #: extensions/integrations/plugins/class-woocommerce.php:187 |
  | 480 | 543 | msgid "Custom 2FA menu label in account page" |
  | 481 | 544 | msgstr "" |
  | 482 | 545 |  |
  | 483 |  | #: extensions/out-of-band/class-out-of-band.php:460 |
  |  | 546 | #: extensions/out-of-band/class-oob-wizard-steps.php:103 |
  |  | 547 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:96 |
  |  | 548 | msgid "Change email address" |
  |  | 549 | msgstr "" |
  |  | 550 |  |
  |  | 551 | #: extensions/out-of-band/class-oob-wizard-steps.php:184 |
  |  | 552 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:283 |
  |  | 553 | msgid "Use my user email (" |
  |  | 554 | msgstr "" |
  |  | 555 |  |
  |  | 556 | #: extensions/out-of-band/class-oob-wizard-steps.php:184 |
  |  | 557 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:283 |
  |  | 558 | msgid ")" |
  |  | 559 | msgstr "" |
  |  | 560 |  |
  |  | 561 | #: extensions/out-of-band/class-oob-wizard-steps.php:200 |
  |  | 562 | msgid "Note: you should be able to access the mailbox of the email address to complete the following step." |
  |  | 563 | msgstr "" |
  |  | 564 |  |
  |  | 565 | #: extensions/out-of-band/class-oob-wizard-steps.php:213 |
  |  | 566 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:331 |
  |  | 567 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:272 |
  |  | 568 | msgid "Authentication Code" |
  |  | 569 | msgstr "" |
  |  | 570 |  |
  |  | 571 | #: extensions/out-of-band/class-oob-wizard-steps.php:227 |
  |  | 572 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:345 |
  |  | 573 | msgid "Send me another code" |
  |  | 574 | msgstr "" |
  |  | 575 |  |
  |  | 576 | #: extensions/out-of-band/class-oob-wizard-steps.php:296 |
  |  | 577 | #: extensions/out-of-band/class-out-of-band.php:542 |
  |  | 578 | msgid "Link via email" |
  |  | 579 | msgstr "" |
  |  | 580 |  |
  |  | 581 | #. translators: link to the knowledge base website |
  |  | 582 | #: extensions/out-of-band/class-oob-wizard-steps.php:304 |
  |  | 583 | msgid "When using this method, users will receive a link in an email, and once they click on the link they log in. Therefore, email deliverability is very important. Users using this method should whitelist the address from which the emails are sent. By default, this is the email address configured in your WordPress. You can run an email test from the plugin's settings to confirm email deliverability. If you have had email deliverability / reliability issues, we highly recommend you to install the free plugin %s. Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone." |
  |  | 584 | msgstr "" |
  |  | 585 |  |
  |  | 586 | #: extensions/out-of-band/class-oob-wizard-steps.php:305 |
  |  | 587 | msgid "WP Mail SMTP" |
  |  | 588 | msgstr "" |
  |  | 589 |  |
  |  | 590 | #: extensions/out-of-band/class-oob-wizard-steps.php:321 |
  |  | 591 | msgid "Link will be valid for: " |
  |  | 592 | msgstr "" |
  |  | 593 |  |
  |  | 594 | #: extensions/out-of-band/class-oob-wizard-steps.php:323 |
  |  | 595 | msgid "minutes" |
  |  | 596 | msgstr "" |
  |  | 597 |  |
  |  | 598 | #: extensions/out-of-band/class-oob-wizard-steps.php:401 |
  |  | 599 | msgid "When using this method email deliverability is very important. If you are not sure your website's email systems works well, refer to the guide on " |
  |  | 600 | msgstr "" |
  |  | 601 |  |
  |  | 602 | #: extensions/out-of-band/class-oob-wizard-steps.php:401 |
  |  | 603 | msgid "how to improve and ensure email deliverability on WordPress websites" |
  |  | 604 | msgstr "" |
  |  | 605 |  |
  |  | 606 | #: extensions/out-of-band/class-oob-wizard-steps.php:401 |
  |  | 607 | msgid "to ensure you can receive emails" |
  |  | 608 | msgstr "" |
  |  | 609 |  |
  |  | 610 | #: extensions/out-of-band/class-out-of-band.php:374 |
  |  | 611 | msgid "Usage of this filter is deprecated." |
  |  | 612 | msgstr "" |
  |  | 613 |  |
  |  | 614 | #: extensions/out-of-band/class-out-of-band.php:421 |
  |  | 615 | #: extensions/out-of-band/class-out-of-band.php:473 |
  |  | 616 | msgid "User is not provided" |
  |  | 617 | msgstr "" |
  |  | 618 |  |
  |  | 619 | #: extensions/out-of-band/class-out-of-band.php:445 |
  |  | 620 | msgid "Your 2FA setup code" |
  |  | 621 | msgstr "" |
  |  | 622 |  |
  |  | 623 | #. translators: Test oob code. |
  |  | 624 | #: extensions/out-of-band/class-out-of-band.php:449 |
  |  | 625 | msgid "Please enter this code to confirm the 2FA setup: %s" |
  |  | 626 | msgstr "" |
  |  | 627 |  |
  |  | 628 | #: extensions/out-of-band/class-out-of-band.php:459 |
  | 484 | 629 | msgid "this link" |
  |  | 630 | msgstr "" |
  |  | 631 |  |
  |  | 632 | #: extensions/out-of-band/class-out-of-band.php:541 |
  |  | 633 | msgid "An email with a verification link has been sent to your email address. If you are using the same browser and device, please click on the link to verify the login. If you are not, please copy the link and paste it in the address bar above." |
  | 485 | 634 | msgstr "" |
  | 486 | 635 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L489) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L638) |  |
  | 489 | 638 | msgstr "" |
  | 490 | 639 |  |
  |  | 640 | #: extensions/out-of-band/class-out-of-band.php:596 |
  |  | 641 | msgid "Someone from {user\_ip\_address} is trying to log in to {site\_name}." |
  |  | 642 | msgstr "" |
  |  | 643 |  |
  |  | 644 | #. translators: The login code |
  |  | 645 | #: extensions/out-of-band/class-out-of-band.php:600 |
  |  | 646 | msgid "Verify the login by clicking %1$s. If this is not you, please ignore this email and contact your website administrator." |
  |  | 647 | msgstr "" |
  |  | 648 |  |
  |  | 649 | #: extensions/out-of-band/class-out-of-band.php:604 |
  |  | 650 | msgid "Note: as a security precaution, the login verification link only works when the link is clicked from the same browser and device combination from where you are trying to log in. If this is not the same browser and device, please copy the link and manually paste it in the address bar of the browser which you are using to log in to the website." |
  |  | 651 | msgstr "" |
  |  | 652 |  |
  |  | 653 | #: extensions/out-of-band/class-out-of-band.php:605 |
  |  | 654 | #: includes/classes/class-wp2fa.php:527 |
  |  | 655 | #: includes/classes/class-wp2fa.php:556 |
  |  | 656 | #: includes/classes/class-wp2fa.php:574 |
  |  | 657 | #: includes/classes/class-wp2fa.php:588 |
  |  | 658 | #: includes/classes/class-wp2fa.php:598 |
  |  | 659 | msgid "Email sent by" |
  |  | 660 | msgstr "" |
  |  | 661 |  |
  | 491 | 662 | #: extensions/out-of-band/class-out-of-band.php:606 |
  | 492 |  | #: includes/classes/class-wp2fa.php:5~~30~~ |
  | 493 |  | #: includes/classes/class-wp2fa.php:55~~9~~ |
  | 494 |  | #: includes/classes/class-wp2fa.php:57~~7~~ |
  |  | 663 | #: includes/classes/class-wp2fa.php:528 |
  |  | 664 | #: includes/classes/class-wp2fa.php:557 |
  |  | 665 | #: includes/classes/class-wp2fa.php:575 |
  | 495 | 666 | msgid "WP 2FA plugin." |
  |  | 667 | msgstr "" |
  |  | 668 |  |
  |  | 669 | #: extensions/out-of-band/class-out-of-band.php:628 |
  |  | 670 | #: includes/classes/Admin/class-user-profile.php:695 |
  |  | 671 | msgid "No form" |
  |  | 672 | msgstr "" |
  |  | 673 |  |
  |  | 674 | #: extensions/out-of-band/class-out-of-band.php:639 |
  |  | 675 | #: extensions/out-of-band/class-out-of-band.php:646 |
  |  | 676 | #: includes/classes/Admin/class-user-profile.php:718 |
  |  | 677 | msgid "Invalid Two Factor Authentication code." |
  |  | 678 | msgstr "" |
  |  | 679 |  |
  |  | 680 | #: extensions/out-of-band/class-out-of-band.php:644 |
  |  | 681 | #: includes/classes/Admin/class-user-profile.php:730 |
  |  | 682 | msgid "Please enter the code to finalize the 2FA setup." |
  |  | 683 | msgstr "" |
  |  | 684 |  |
  |  | 685 | #: extensions/out-of-band/class-out-of-band.php:670 |
  |  | 686 | msgid "No code is presented." |
  | 496 | 687 | msgstr "" |
  | 497 | 688 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L508) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L699) |  |
  | 508 | 699 | msgstr "" |
  | 509 | 700 |  |
  | 510 |  | #: extensions/out-of-band/class-out-of-band.php:928 |
  | 511 |  | msgid "Out of band page text" |
  | 512 |  | msgstr "" |
  | 513 |  |  |
  | 514 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:73 |
  | 515 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:253 |
  | 516 |  | msgid "Link via email" |
  | 517 |  | msgstr "" |
  | 518 |  |  |
  | 519 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:108 |
  | 520 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:237 |
  | 521 |  | msgid "Change email address" |
  | 522 |  | msgstr "" |
  | 523 |  |  |
  | 524 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:143 |
  | 525 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:390 |
  | 526 |  | msgid "Use my user email (" |
  | 527 |  | msgstr "" |
  | 528 |  |  |
  | 529 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:143 |
  | 530 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:390 |
  | 531 |  | msgid ")" |
  | 532 |  | msgstr "" |
  | 533 |  |  |
  | 534 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:159 |
  | 535 |  | msgid "Note: you should be able to access the mailbox of the email address to complete the following step." |
  | 536 |  | msgstr "" |
  | 537 |  |  |
  | 538 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:172 |
  | 539 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:345 |
  | 540 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:438 |
  | 541 |  | msgid "Authentication Code" |
  | 542 |  | msgstr "" |
  | 543 |  |  |
  | 544 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:186 |
  | 545 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:452 |
  | 546 |  | msgid "Send me another code" |
  | 547 |  | msgstr "" |
  | 548 |  |  |
  | 549 |  | #. translators: link to the knowledge base website |
  | 550 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:261 |
  | 551 |  | msgid "When using this method, users will receive a link in an email, and once they click on the link they log in. Therefore, email deliverability is very important. Users using this method should whitelist the address from which the emails are sent. By default, this is the email address configured in your WordPress. You can run an email test from the plugin's settings to confirm email deliverability. If you have had email deliverability / reliability issues, we highly recommend you to install the free plugin %s. Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone." |
  | 552 |  | msgstr "" |
  | 553 |  |  |
  | 554 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:262 |
  | 555 |  | msgid "WP Mail SMTP" |
  | 556 |  | msgstr "" |
  | 557 |  |  |
  | 558 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:278 |
  | 559 |  | msgid "Link will be valid for: " |
  | 560 |  | msgstr "" |
  | 561 |  |  |
  | 562 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:280 |
  | 563 |  | #: extensions/role-settings/class-role-settings-render.php:250 |
  | 564 |  | msgid "minutes" |
  | 565 |  | msgstr "" |
  | 566 |  |  |
  | 567 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:352 |
  | 568 |  | msgid "When using this method email deliverability is very important. If you are not sure your website's email systems works well, refer to the guide on " |
  | 569 |  | msgstr "" |
  | 570 |  |  |
  | 571 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:352 |
  | 572 |  | msgid "how to improve and ensure email deliverability on WordPress websites" |
  | 573 |  | msgstr "" |
  | 574 |  |  |
  | 575 |  | #: extensions/out-of-band/class-wizard-steps-oob.php:352 |
  | 576 |  | msgid "to ensure you can receive emails" |
  | 577 |  | msgstr "" |
  | 578 |  |  |
  | 579 |  | #: extensions/reporting/class-abstract-report.php:93 |
  |  | 701 | #: extensions/reporting/class-abstract-report.php:89 |
  | 580 | 702 | msgid "Role" |
  | 581 | 703 | msgstr "" |
  | 582 | 704 |  |
  | 583 |  | #: extensions/reporting/class-abstract-report.php:9~~4~~ |
  |  | 705 | #: extensions/reporting/class-abstract-report.php:90 |
  | 584 | 706 | msgid "Total" |
  | 585 | 707 | msgstr "" |
  | 586 | 708 |  |
  | 587 |  | #: extensions/reporting/class-methods-report.php:~~40~~ |
  |  | 709 | #: extensions/reporting/class-methods-report.php:39 |
  | 588 | 710 | msgid "2FA methods and backup codes" |
  | 589 | 711 | msgstr "" |
  | 590 | 712 |  |
  | 591 |  | #: extensions/reporting/class-reporting.php:~~79~~ |
  | 592 |  | #: extensions/reporting/class-reporting.php:8~~0~~ |
  | 593 |  | #: extensions/reporting/class-reporting.php:1~~07~~ |
  |  | 713 | #: extensions/reporting/class-reporting.php:85 |
  |  | 714 | #: extensions/reporting/class-reporting.php:86 |
  |  | 715 | #: extensions/reporting/class-reporting.php:113 |
  | 594 | 716 | msgid "Reports" |
  | 595 | 717 | msgstr "" |
  | 596 | 718 |  |
  | 597 |  | #: extensions/reporting/class-reporting.php:1~~05~~ |
  |  | 719 | #: extensions/reporting/class-reporting.php:111 |
  | 598 | 720 | #: includes/classes/Admin/class-help-contact-us.php:59 |
  | 599 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:~~98~~ |
  |  | 721 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:100 |
  | 600 | 722 | #: includes/classes/Admin/SettingsPages/class-settings-page-render.php:47 |
  | 601 | 723 | msgid "These settings have been disabled by your site administrator, please contact them for further assistance." |
  | 602 | 724 | msgstr "" |
  | 603 | 725 |  |
  | 604 |  | #: extensions/reporting/class-reporting.php:1~~09~~ |
  |  | 726 | #: extensions/reporting/class-reporting.php:115 |
  | 605 | 727 | msgid "In this page you will find a number of reports which allow you to get a better overview of the current state of 2FA on your website." |
  | 606 | 728 | msgstr "" |
  | 607 | 729 |  |
  | 608 |  | #: extensions/reporting/class-user-status-report.php:40 |
  |  | 730 | #: extensions/reporting/class-reporting.php:137 |
  |  | 731 | msgid "Your report is preparing, please wait as it could take some time. Once ready it will automatically refresh the page." |
  |  | 732 | msgstr "" |
  |  | 733 |  |
  |  | 734 | #: extensions/reporting/class-reporting.php:138 |
  |  | 735 | msgid "Processed users:" |
  |  | 736 | msgstr "" |
  |  | 737 |  |
  |  | 738 | #: extensions/reporting/class-reporting.php:138 |
  |  | 739 | msgid "of" |
  |  | 740 | msgstr "" |
  |  | 741 |  |
  |  | 742 | #: extensions/reporting/class-reporting.php:138 |
  |  | 743 | msgid "total users " |
  |  | 744 | msgstr "" |
  |  | 745 |  |
  |  | 746 | #: extensions/reporting/class-reporting.php:186 |
  |  | 747 | msgid "Reports data" |
  |  | 748 | msgstr "" |
  |  | 749 |  |
  |  | 750 | #: extensions/reporting/class-user-status-report.php:42 |
  | 609 | 751 | msgid "2FA users setup attribute" |
  | 610 | 752 | msgstr "" |
  | 611 | 753 |  |
  | 612 |  | #: extensions/role-settings/class-role-settings-render.php:171 |
  |  | 754 | #. translators: Test oob code. |
  |  | 755 | #: extensions/role-settings/class-role-settings-controller.php:196 |
  |  | 756 | msgid "Grace period must be at least 1 day/hour for role %s." |
  |  | 757 | msgstr "" |
  |  | 758 |  |
  |  | 759 | #. translators: Test oob code. |
  |  | 760 | #: extensions/role-settings/class-role-settings-controller.php:238 |
  |  | 761 | msgid "You must provide a new page slug for role %s." |
  |  | 762 | msgstr "" |
  |  | 763 |  |
  |  | 764 | #: extensions/role-settings/class-role-settings-render.php:100 |
  |  | 765 | msgid "Site-wide policies" |
  |  | 766 | msgstr "" |
  |  | 767 |  |
  |  | 768 | #: extensions/role-settings/class-role-settings-render.php:174 |
  | 613 | 769 | msgid "Configure different 2FA settings for this user role" |
  | 614 | 770 | msgstr "" |
  | 615 | 771 |  |
  | 616 |  | #: extensions/role-settings/class-role-settings-render.php:1~~88~~ |
  | 617 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:5~~2~~ |
  |  | 772 | #: extensions/role-settings/class-role-settings-render.php:191 |
  |  | 773 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:55 |
  | 618 | 774 | msgid "Which of the below 2FA methods can users use?" |
  | 619 | 775 | msgstr "" |
  | 620 | 776 |  |
  | 621 |  | #: extensions/role-settings/class-role-settings-render.php:191 |
  |  | 777 | #: extensions/role-settings/class-role-settings-render.php:194 |
  |  | 778 | msgid "You can change the order of the 2FA methods and how they appear for the users with drag and drop. Simply hover the mouse over the method, click the mouse button and drag that method to where you'd like it to appear in the list. Once you are ready save the settings." |
  |  | 779 | msgstr "" |
  |  | 780 |  |
  |  | 781 | #: extensions/role-settings/class-role-settings-render.php:197 |
  | 622 | 782 | msgid "Select the allowed primary 2FA methods" |
  | 623 | 783 | msgstr "" |
  | 624 | 784 |  |
  | 625 |  | #: extensions/role-settings/class-role-settings-render.php:~~194~~ |
  | 626 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~59~~ |
  |  | 785 | #: extensions/role-settings/class-role-settings-render.php:200 |
  |  | 786 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:62 |
  | 627 | 787 | msgid "Primary 2FA methods:" |
  | 628 | 788 | msgstr "" |
  | 629 | 789 |  |
  | 630 |  | #: extensions/role-settings/class-role-settings-render.php:202 |
  | 631 |  | msgid "One-time code via 2FA App (TOTP) - " |
  | 632 |  | msgstr "" |
  | 633 |  |  |
  | 634 |  | #: extensions/role-settings/class-role-settings-render.php:202 |
  | 635 |  | msgid "complete list of supported 2FA apps." |
  | 636 |  | msgstr "" |
  | 637 |  |  |
  | 638 |  | #. translators: link to the knowledge base website |
  | 639 |  | #: extensions/role-settings/class-role-settings-render.php:208 |
  | 640 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:163 |
  | 641 |  | msgid "Refer to the %s for more information on how to setup these apps and which apps are supported." |
  | 642 |  | msgstr "" |
  | 643 |  |  |
  | 644 |  | #: extensions/role-settings/class-role-settings-render.php:209 |
  | 645 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:75 |
  | 646 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:164 |
  | 647 |  | msgid "guide on how to set up 2FA apps" |
  | 648 |  | msgstr "" |
  | 649 |  |  |
  | 650 |  | #: extensions/role-settings/class-role-settings-render.php:234 |
  |  | 790 | #: extensions/role-settings/class-role-settings-render.php:218 |
  |  | 791 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:84 |
  |  | 792 | msgid "Secondary 2FA methods:" |
  |  | 793 | msgstr "" |
  |  | 794 |  |
  |  | 795 | #: extensions/role-settings/class-role-settings-render.php:244 |
  |  | 796 | #: includes/classes/Admin/Methods/class-backup-codes.php:228 |
  |  | 797 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:93 |
  |  | 798 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:171 |
  |  | 799 | msgid "Backup codes" |
  |  | 800 | msgstr "" |
  |  | 801 |  |
  |  | 802 | #: extensions/role-settings/class-role-settings-render.php:246 |
  | 651 | 803 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:99 |
  | 652 |  | ~~msgid "One-time code via email (HOTP)"~~ |
  | 653 |  | ~~msgstr ""~~ |
  | 654 |  |  |
  | 655 |  | ~~#: extensions/role-settings/class-role-settings-render.php:235~~ |
  | 656 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:100~~ |
  | 657 |  | ~~msgid " - ensure email deliverability with the free plugin "~~ |
  | 658 |  | ~~msgstr ""~~ |
  | 659 |  |  |
  | 660 |  | ~~#: extensions/role-settings/class-role-settings-render.php:248~~ |
  | 661 |  | ~~msgid "The code will be valid for: "~~ |
  | 662 |  | ~~msgstr ""~~ |
  | 663 |  |  |
  | 664 |  | ~~#: extensions/role-settings/class-role-settings-render.php:305~~ |
  | 665 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:152~~ |
  | 666 |  | ~~msgid "Secondary 2FA methods:"~~ |
  | 667 |  | ~~msgstr ""~~ |
  | 668 |  |  |
  | 669 |  | ~~#: extensions/role-settings/class-role-settings-render.php:331~~ |
  | 670 |  | ~~#: includes/classes/Admin/Controllers/class-settings.php:363~~ |
  | 671 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:161~~ |
  | 672 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:239~~ |
  | 673 |  | ~~msgid "Backup codes"~~ |
  | 674 |  | ~~msgstr ""~~ |
  | 675 |  |  |
  | 676 |  | ~~#: extensions/role-settings/class-role-settings-render.php:333~~ |
  | 677 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:167~~ |
  | 678 | 804 | msgid "Backup codes are a secondary method which you can use to log in to the website in case the primary 2FA method is unavailable. Therefore they can't be enabled and used as a primary method." |
  | 679 | 805 | msgstr "" |
  | 680 | 806 |  |
  | 681 |  | #: extensions/role-settings/class-role-settings-render.php:4~~80~~ |
  | 682 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:89~~2~~ |
  | 683 |  | msgid "Should users be asked to setup 2FA instantly or should they have a grace period~~?~~" |
  | 684 |  | msgstr "" |
  | 685 |  |  |
  | 686 |  | #: extensions/role-settings/class-role-settings-render.php:4~~82~~ |
  | 687 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:89~~4~~ |
  |  | 807 | #: extensions/role-settings/class-role-settings-render.php:404 |
  |  | 808 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:891 |
  |  | 809 | msgid "Should users be asked to setup 2FA instantly or should they have a grace period" |
  |  | 810 | msgstr "" |
  |  | 811 |  |
  |  | 812 | #: extensions/role-settings/class-role-settings-render.php:406 |
  |  | 813 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:893 |
  | 688 | 814 | msgid "When you enforce 2FA on users they have a grace period to configure 2FA. If they fail to configure it within the configured stipulated time, their account will be locked and have to be unlocked manually. Note that user accounts cannot be unlocked automatically, even if you change the settings. As a security precaution they always have to be unlocked them manually. Maximum grace period is 10 days." |
  | 689 | 815 | msgstr "" |
  | 690 | 816 |  |
  | 691 |  | #: extensions/role-settings/class-role-settings-render.php:4~~82~~ |
  | 692 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:89~~4~~ |
  | 693 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:2~~85~~ |
  |  | 817 | #: extensions/role-settings/class-role-settings-render.php:406 |
  |  | 818 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:893 |
  |  | 819 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:217 |
  | 694 | 820 | msgid "Learn more." |
  | 695 | 821 | msgstr "" |
  | 696 | 822 |  |
  | 697 |  | #: extensions/role-settings/class-role-settings-render.php:4~~88~~ |
  | 698 |  | #: includes/classes/Admin/class-setup-wizard.php:49~~2~~ |
  | 699 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:~~900~~ |
  |  | 823 | #: extensions/role-settings/class-role-settings-render.php:412 |
  |  | 824 | #: includes/classes/Admin/class-setup-wizard.php:494 |
  |  | 825 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:899 |
  | 700 | 826 | msgid "Grace period" |
  | 701 | 827 | msgstr "" |
  | 702 | 828 |  |
  | 703 |  | #: extensions/role-settings/class-role-settings-render.php:~~500~~ |
  | 704 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~602~~ |
  |  | 829 | #: extensions/role-settings/class-role-settings-render.php:424 |
  |  | 830 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:534 |
  | 705 | 831 | msgid "Users have to configure 2FA straight away." |
  | 706 | 832 | msgstr "" |
  | 707 | 833 |  |
  | 708 |  | #: extensions/role-settings/class-role-settings-render.php:~~509~~ |
  | 709 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~609~~ |
  |  | 834 | #: extensions/role-settings/class-role-settings-render.php:433 |
  |  | 835 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:541 |
  | 710 | 836 | msgid "Give users a grace period to configure 2FA" |
  | 711 | 837 | msgstr "" |
  | 712 | 838 |  |
  | 713 |  | #: extensions/role-settings/class-role-settings-render.php:~~518~~ |
  | 714 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~618~~ |
  |  | 839 | #: extensions/role-settings/class-role-settings-render.php:442 |
  |  | 840 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:550 |
  | 715 | 841 | msgid "hours" |
  | 716 | 842 | msgstr "" |
  | 717 | 843 |  |
  | 718 |  | #: extensions/role-settings/class-role-settings-render.php:~~525~~ |
  | 719 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~624~~ |
  |  | 844 | #: extensions/role-settings/class-role-settings-render.php:449 |
  |  | 845 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:556 |
  | 720 | 846 | msgid "days" |
  | 721 | 847 | msgstr "" |
  | 722 | 848 |  |
  | 723 |  | #: extensions/role-settings/class-role-settings-render.php:565 |
  | 724 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:809 |
  |  | 849 | #: extensions/role-settings/class-role-settings-render.php:489 |
  | 725 | 850 | msgid "Do you want to redirect the user to a specific page after completing the 2FA setup wizard?" |
  | 726 | 851 | msgstr "" |
  | 727 | 852 |  |
  | 728 |  | #: extensions/role-settings/class-role-settings-render.php:~~567~~ |
  | 729 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:81~~1~~ |
  |  | 853 | #: extensions/role-settings/class-role-settings-render.php:491 |
  |  | 854 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:810 |
  | 730 | 855 | msgid "Specify a URL of a page where you want to redirect the users once they complete the 2FA setup wizard. Leave empty for default behaviour, in which users are redirected back to the page from where they launched the wizard." |
  | 731 | 856 | msgstr "" |
  | 732 | 857 |  |
  | 733 |  | #: extensions/role-settings/class-role-settings-render.php:~~572~~ |
  | 734 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:81~~6~~ |
  |  | 858 | #: extensions/role-settings/class-role-settings-render.php:496 |
  |  | 859 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:815 |
  | 735 | 860 | msgid "Redirect users after 2FA setup to" |
  | 736 | 861 | msgstr "" |
  | 737 | 862 |  |
  |  | 863 | #: extensions/role-settings/class-role-settings-render.php:528 |
  |  | 864 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:683 |
  |  | 865 | msgid "Can users access the WordPress dashboard or you have custom profile pages? " |
  |  | 866 | msgstr "" |
  |  | 867 |  |
  |  | 868 | #: extensions/role-settings/class-role-settings-render.php:530 |
  |  | 869 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:685 |
  |  | 870 | msgid "If your users do not have access to the WordPress dashboard (because you use custom user profile pages) enable this option. Once enabled, the plugin creates a page which ONLY authenticated users can access to configure their user 2FA settings. A link to this page is sent in the 2FA welcome email." |
  |  | 871 | msgstr "" |
  |  | 872 |  |
  |  | 873 | #: extensions/role-settings/class-role-settings-render.php:535 |
  |  | 874 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:690 |
  |  | 875 | msgid "Frontend 2FA settings page" |
  |  | 876 | msgstr "" |
  |  | 877 |  |
  |  | 878 | #: extensions/role-settings/class-role-settings-render.php:561 |
  |  | 879 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:710 |
  |  | 880 | msgid "Frontend 2FA settings page URL" |
  |  | 881 | msgstr "" |
  |  | 882 |  |
  |  | 883 | #: extensions/role-settings/class-role-settings-render.php:596 |
  |  | 884 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:743 |
  |  | 885 | msgid "Edit Page" |
  |  | 886 | msgstr "" |
  |  | 887 |  |
  |  | 888 | #: extensions/role-settings/class-role-settings-render.php:596 |
  |  | 889 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:743 |
  |  | 890 | msgid "View Page" |
  |  | 891 | msgstr "" |
  |  | 892 |  |
  | 738 | 893 | #: extensions/role-settings/class-role-settings-render.php:604 |
  | 739 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:685 |
  | 740 |  | msgid "Can users access the WordPress dashboard or you have custom profile pages? " |
  | 741 |  | msgstr "" |
  | 742 |  |  |
  | 743 |  | #: extensions/role-settings/class-role-settings-render.php:606 |
  | 744 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:687 |
  | 745 |  | msgid "If your users do not have access to the WordPress dashboard (because you use custom user profile pages) enable this option. Once enabled, the plugin creates a page which ONLY authenticated users can access to configure their user 2FA settings. A link to this page is sent in the 2FA welcome email." |
  | 746 |  | msgstr "" |
  | 747 |  |  |
  | 748 |  | #: extensions/role-settings/class-role-settings-render.php:611 |
  | 749 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:692 |
  | 750 |  | msgid "Frontend 2FA settings page" |
  | 751 |  | msgstr "" |
  | 752 |  |  |
  | 753 |  | #: extensions/role-settings/class-role-settings-render.php:637 |
  | 754 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:712 |
  | 755 |  | msgid "Frontend 2FA settings page URL" |
  | 756 |  | msgstr "" |
  | 757 |  |  |
  | 758 |  | #: extensions/role-settings/class-role-settings-render.php:672 |
  | 759 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:745 |
  | 760 |  | msgid "Edit Page" |
  | 761 |  | msgstr "" |
  | 762 |  |  |
  | 763 |  | #: extensions/role-settings/class-role-settings-render.php:672 |
  | 764 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:745 |
  | 765 |  | msgid "View Page" |
  | 766 |  | msgstr "" |
  | 767 |  |  |
  | 768 |  | #: extensions/role-settings/class-role-settings-render.php:680 |
  | 769 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:753 |
  |  | 894 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:751 |
  | 770 | 895 | msgid "Create separate pages on multisite network" |
  | 771 | 896 | msgstr "" |
  | 772 | 897 |  |
  | 773 |  | #: extensions/role-settings/class-role-settings-render.php:696 |
  | 774 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:768 |
  |  | 898 | #: extensions/role-settings/class-role-settings-render.php:614 |
  |  | 899 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:760 |
  |  | 900 | msgid "Create User settings page separately for every site" |
  |  | 901 | msgstr "" |
  |  | 902 |  |
  |  | 903 | #: extensions/role-settings/class-role-settings-render.php:615 |
  |  | 904 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:761 |
  |  | 905 | msgid "When you enable this setting a page with the same slug is created on each site on the network, so the users of each sub site can use this page on their website to configure 2FA." |
  |  | 906 | msgstr "" |
  |  | 907 |  |
  |  | 908 | #: extensions/role-settings/class-role-settings-render.php:621 |
  |  | 909 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:767 |
  | 775 | 910 | msgid "Specify the page where you want to redirect your users to after they complete the 2FA setup. This will override the global redirect setting." |
  | 776 | 911 | msgstr "" |
  | 777 | 912 |  |
  | 778 |  | #: extensions/role-settings/class-role-settings-render.php:6~~99~~ |
  | 779 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:77~~1~~ |
  |  | 913 | #: extensions/role-settings/class-role-settings-render.php:624 |
  |  | 914 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:770 |
  | 780 | 915 | msgid "Redirect users after 2FA setup" |
  | 781 | 916 | msgstr "" |
  | 782 | 917 |  |
  | 783 |  | #: extensions/role-settings/class-role-settings-render.php:~~733~~ |
  | 784 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:93~~3~~ |
  | 785 |  | msgid "Should users be able to disable 2FA on their user profile~~?~~" |
  | 786 |  | msgstr "" |
  | 787 |  |  |
  | 788 |  | #: extensions/role-settings/class-role-settings-render.php:~~735~~ |
  | 789 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:93~~5~~ |
  |  | 918 | #: extensions/role-settings/class-role-settings-render.php:658 |
  |  | 919 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:932 |
  |  | 920 | msgid "Should users be able to disable 2FA on their user profile" |
  |  | 921 | msgstr "" |
  |  | 922 |  |
  |  | 923 | #: extensions/role-settings/class-role-settings-render.php:660 |
  |  | 924 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:934 |
  | 790 | 925 | msgid "Users can configure and also disable 2FA on their profile by clicking the \"Remove 2FA\" button. Enable this setting to disable the Remove 2FA button so users cannot disable 2FA from their user profile." |
  | 791 | 926 | msgstr "" |
  | 792 | 927 |  |
  | 793 |  | #: extensions/role-settings/class-role-settings-render.php:~~740~~ |
  | 794 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:9~~40~~ |
  |  | 928 | #: extensions/role-settings/class-role-settings-render.php:665 |
  |  | 929 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:939 |
  | 795 | 930 | msgid "Hide the Remove 2FA button" |
  | 796 | 931 | msgstr "" |
  | 797 | 932 |  |
  | 798 |  | #: extensions/role-settings/class-role-settings-render.php:~~749~~ |
  | 799 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:94~~6~~ |
  |  | 933 | #: extensions/role-settings/class-role-settings-render.php:674 |
  |  | 934 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:945 |
  | 800 | 935 | msgid "Hide the Remove 2FA button on user profile pages" |
  |  | 936 | msgstr "" |
  |  | 937 |  |
  |  | 938 | #: extensions/settings-import-export/class-settings-import-export.php:132 |
  |  | 939 | msgid "From here you can export the plugin's settings configuration and also import them from an export file. Use the export file to keep a backup of the plugin's configuration or to import the same settings configuration to another website." |
  |  | 940 | msgstr "" |
  |  | 941 |  |
  |  | 942 | #: extensions/settings-import-export/class-settings-import-export.php:140 |
  |  | 943 | msgid "Export settings" |
  |  | 944 | msgstr "" |
  |  | 945 |  |
  |  | 946 | #: extensions/settings-import-export/class-settings-import-export.php:150 |
  |  | 947 | #: extensions/settings-import-export/class-settings-import-export.php:161 |
  |  | 948 | msgid "site-specific" |
  |  | 949 | msgstr "" |
  |  | 950 |  |
  |  | 951 | #: extensions/settings-import-export/class-settings-import-export.php:151 |
  |  | 952 | msgid "Also export the site specific settings as enforced users and roles (the policy will be set to Do not enforce if left unchecked)" |
  |  | 953 | msgstr "" |
  |  | 954 |  |
  |  | 955 | #: extensions/settings-import-export/class-settings-import-export.php:162 |
  |  | 956 | msgid "Add the custom from email to the export" |
  |  | 957 | msgstr "" |
  |  | 958 |  |
  |  | 959 | #: extensions/settings-import-export/class-settings-import-export.php:167 |
  |  | 960 | msgid "Export" |
  |  | 961 | msgstr "" |
  |  | 962 |  |
  |  | 963 | #: extensions/settings-import-export/class-settings-import-export.php:170 |
  |  | 964 | msgid "Once the settings are exported a download will automatically start. The settings are exported to a JSON file." |
  |  | 965 | msgstr "" |
  |  | 966 |  |
  |  | 967 | #: extensions/settings-import-export/class-settings-import-export.php:177 |
  |  | 968 | msgid "Import settings" |
  |  | 969 | msgstr "" |
  |  | 970 |  |
  |  | 971 | #: extensions/settings-import-export/class-settings-import-export.php:184 |
  |  | 972 | msgid "Validate & Import" |
  |  | 973 | msgstr "" |
  |  | 974 |  |
  |  | 975 | #: extensions/settings-import-export/class-settings-import-export.php:186 |
  |  | 976 | msgid "Once you choose a JSON settings file, it will be checked prior to being imported to alert you of any issues, if there are any." |
  |  | 977 | msgstr "" |
  |  | 978 |  |
  |  | 979 | #: extensions/settings-import-export/class-settings-import-export.php:213 |
  |  | 980 | #: extensions/settings-import-export/class-settings-import-export.php:240 |
  |  | 981 | msgid "Nonce Verification Failed." |
  |  | 982 | msgstr "" |
  |  | 983 |  |
  |  | 984 | #: extensions/settings-import-export/class-settings-import-export.php:275 |
  |  | 985 | msgid "User not found: " |
  |  | 986 | msgstr "" |
  |  | 987 |  |
  |  | 988 | #: extensions/settings-import-export/class-settings-import-export.php:285 |
  |  | 989 | msgid "Role not found: " |
  |  | 990 | msgstr "" |
  |  | 991 |  |
  |  | 992 | #: extensions/settings-import-export/class-settings-import-export.php:295 |
  |  | 993 | msgid "Post type not found: " |
  |  | 994 | msgstr "" |
  |  | 995 |  |
  |  | 996 | #: extensions/settings-import-export/class-settings-import-export.php:321 |
  |  | 997 | msgid "Setting updated" |
  |  | 998 | msgstr "" |
  |  | 999 |  |
  |  | 1000 | #: extensions/settings-import-export/class-settings-import-export.php:321 |
  |  | 1001 | msgid "Setting created" |
  |  | 1002 | msgstr "" |
  |  | 1003 |  |
  |  | 1004 | #: extensions/settings-import-export/class-settings-import-export.php:388 |
  |  | 1005 | msgid "Checking import contents" |
  |  | 1006 | msgstr "" |
  |  | 1007 |  |
  |  | 1008 | #: extensions/settings-import-export/class-settings-import-export.php:389 |
  |  | 1009 | msgid "Ready to import" |
  |  | 1010 | msgstr "" |
  |  | 1011 |  |
  |  | 1012 | #: extensions/settings-import-export/class-settings-import-export.php:390 |
  |  | 1013 | msgid "Issues found" |
  |  | 1014 | msgstr "" |
  |  | 1015 |  |
  |  | 1016 | #: extensions/settings-import-export/class-settings-import-export.php:391 |
  |  | 1017 | msgid "Importing settings" |
  |  | 1018 | msgstr "" |
  |  | 1019 |  |
  |  | 1020 | #: extensions/settings-import-export/class-settings-import-export.php:392 |
  |  | 1021 | msgid "Settings imported" |
  |  | 1022 | msgstr "" |
  |  | 1023 |  |
  |  | 1024 | #: extensions/settings-import-export/class-settings-import-export.php:393 |
  |  | 1025 | #: includes/classes/Admin/class-help-contact-us.php:63 |
  |  | 1026 | #: includes/classes/Admin/class-help-contact-us.php:71 |
  |  | 1027 | msgid "Help" |
  |  | 1028 | msgstr "" |
  |  | 1029 |  |
  |  | 1030 | #: extensions/settings-import-export/class-settings-import-export.php:394 |
  |  | 1031 | msgid "The role, user or post type contained in your settings are not currently found in this website. Importing such settings could lead to abnormal behavior. For more information and / or if you require assistance, please" |
  |  | 1032 | msgstr "" |
  |  | 1033 |  |
  |  | 1034 | #: extensions/settings-import-export/class-settings-import-export.php:395 |
  |  | 1035 | msgid "Currently this data is not supported by our export/import wizard." |
  |  | 1036 | msgstr "" |
  |  | 1037 |  |
  |  | 1038 | #: extensions/settings-import-export/class-settings-import-export.php:396 |
  |  | 1039 | msgid "To avoid accidental lock-out, this setting is not imported." |
  |  | 1040 | msgstr "" |
  |  | 1041 |  |
  |  | 1042 | #: extensions/settings-import-export/class-settings-import-export.php:397 |
  |  | 1043 | msgid "Please upload a valid JSON file." |
  |  | 1044 | msgstr "" |
  |  | 1045 |  |
  |  | 1046 | #: extensions/settings-import-export/class-settings-import-export.php:399 |
  |  | 1047 | msgid "The settings file has been tested and the configuration is ready to be imported. Would you like to proceed?" |
  |  | 1048 | msgstr "" |
  |  | 1049 |  |
  |  | 1050 | #: extensions/settings-import-export/class-settings-import-export.php:400 |
  |  | 1051 | msgid "The configuration has been successfully imported. Click OK to close this window" |
  |  | 1052 | msgstr "" |
  |  | 1053 |  |
  |  | 1054 | #: extensions/settings-import-export/class-settings-import-export.php:401 |
  |  | 1055 | msgid "Proceed" |
  |  | 1056 | msgstr "" |
  |  | 1057 |  |
  |  | 1058 | #: extensions/settings-import-export/class-settings-import-export.php:402 |
  |  | 1059 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:204 |
  |  | 1060 | msgid "OK" |
  |  | 1061 | msgstr "" |
  |  | 1062 |  |
  |  | 1063 | #: extensions/settings-import-export/class-settings-import-export.php:404 |
  |  | 1064 | msgid "Contact Us" |
  |  | 1065 | msgstr "" |
  |  | 1066 |  |
  |  | 1067 | #: extensions/settings-import-export/class-settings-import-exporter.php:182 |
  |  | 1068 | msgid "Settings access" |
  |  | 1069 | msgstr "" |
  |  | 1070 |  |
  |  | 1071 | #: extensions/settings-import-export/class-settings-import-exporter.php:232 |
  |  | 1072 | msgid "Export/import settings" |
  |  | 1073 | msgstr "" |
  |  | 1074 |  |
  |  | 1075 | #: extensions/settings-import-export/class-settings-import-exporter.php:236 |
  |  | 1076 | msgid "Use the settings below to import / export the plugins settings. If you have any questions send us an email at" |
  | 801 | 1077 | msgstr "" |
  | 802 | 1078 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L810) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1086) |  |
  | 810 | 1086 |  |
  | 811 | 1087 | #. Translators: The number of days |
  | 812 |  | #: extensions/trusted-devices/class-core.php:8~~4~~ |
  |  | 1088 | #: extensions/trusted-devices/class-core.php:88 |
  | 813 | 1089 | msgid "Remember this device for %d days" |
  | 814 | 1090 | msgstr "" |
  | 815 | 1091 |  |
  | 816 | 1092 | #: extensions/trusted-devices/class-settings.php:155 |
  | 817 |  | msgid "Allow users to have trusted devices so they are not asked for a 2FA code during login~~?~~" |
  |  | 1093 | msgid "Allow users to have trusted devices so they are not asked for a 2FA code during login" |
  | 818 | 1094 | msgstr "" |
  | 819 | 1095 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L828) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1104) |  |
  | 828 | 1104 |  |
  | 829 | 1105 | #: extensions/trusted-devices/class-settings.php:183 |
  | 830 |  | msgid "For how long should the plugin remember a device~~?~~" |
  |  | 1106 | msgid "For how long should the plugin remember a device" |
  | 831 | 1107 | msgstr "" |
  | 832 | 1108 |  |
  | 833 | 1109 | #: extensions/trusted-devices/class-settings.php:203 |
  | 834 |  | msgid "When should users be prompted for 2FA code on trusted devices~~?~~" |
  |  | 1110 | msgid "When should users be prompted for 2FA code on trusted devices" |
  | 835 | 1111 | msgstr "" |
  | 836 | 1112 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L856) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1132) |  |
  | 856 | 1132 | msgstr "" |
  | 857 | 1133 |  |
  | 858 |  | #: extensions/twilio/class-twilio-render.php:5~~8~~ |
  |  | 1134 | #: extensions/twilio/class-twilio-render.php:59 |
  | 859 | 1135 | msgid "Twilio application / service integration settings" |
  | 860 | 1136 | msgstr "" |
  | 861 | 1137 |  |
  | 862 | 1138 | #. Translators: Twilio service documentation |
  | 863 |  | #: extensions/twilio/class-twilio-render.php:6~~3~~ |
  |  | 1139 | #: extensions/twilio/class-twilio-render.php:64 |
  | 864 | 1140 | msgid "Here you can specify your Twilio Production SID Key, Auth and number / ID or change an existing ones. You can get the them from the Twilio console. Refer to the article %s for more information and instructions on how to get your keys." |
  | 865 | 1141 | msgstr "" |
  | 866 | 1142 |  |
  | 867 |  | #: extensions/twilio/class-twilio-render.php:6~~4~~ |
  |  | 1143 | #: extensions/twilio/class-twilio-render.php:65 |
  | 868 | 1144 | msgid "how to get the Twilio Production SID key" |
  | 869 | 1145 | msgstr "" |
  | 870 | 1146 |  |
  | 871 |  | #: extensions/twilio/class-twilio-render.php:7~~1~~ |
  | 872 |  | #: extensions/twilio/class-~~wizard-steps-twilio.php:276~~ |
  |  | 1147 | #: extensions/twilio/class-twilio-render.php:72 |
  |  | 1148 | #: extensions/twilio/class-twilio-wizard-steps.php:321 |
  | 873 | 1149 | msgid "Account SID" |
  | 874 | 1150 | msgstr "" |
  | 875 | 1151 |  |
  | 876 |  | #: extensions/twilio/class-twilio-render.php:~~79~~ |
  | 877 |  | #: extensions/twilio/class-~~wizard-steps-twilio.php:284~~ |
  |  | 1152 | #: extensions/twilio/class-twilio-render.php:80 |
  |  | 1153 | #: extensions/twilio/class-twilio-wizard-steps.php:329 |
  | 878 | 1154 | msgid "Auth token" |
  | 879 | 1155 | msgstr "" |
  | 880 | 1156 |  |
  | 881 |  | #: extensions/twilio/class-twilio-render.php:8~~7~~ |
  | 882 |  | #: extensions/twilio/class-~~wizard-steps-twilio.php:292~~ |
  |  | 1157 | #: extensions/twilio/class-twilio-render.php:88 |
  |  | 1158 | #: extensions/twilio/class-twilio-wizard-steps.php:337 |
  | 883 | 1159 | msgid "Twilio number or Alphanumeric ID" |
  | 884 | 1160 | msgstr "" |
  | 885 | 1161 |  |
  | 886 |  | #: extensions/twilio/class-twilio-render.php:9~~5~~ |
  | 887 |  | #: extensions/twilio/class-~~wizard-steps-twilio.php:300~~ |
  |  | 1162 | #: extensions/twilio/class-twilio-render.php:96 |
  |  | 1163 | #: extensions/twilio/class-twilio-wizard-steps.php:345 |
  | 888 | 1164 | msgid "Verify the details" |
  | 889 | 1165 | msgstr "" |
  | 890 | 1166 |  |
  | 891 |  | #: extensions/twilio/class-twilio-render.php:9~~7~~ |
  | 892 |  | #: extensions/twilio/class-~~wizard-steps-twilio.php:302~~ |
  |  | 1167 | #: extensions/twilio/class-twilio-render.php:98 |
  |  | 1168 | #: extensions/twilio/class-twilio-wizard-steps.php:347 |
  | 893 | 1169 | msgid "Verify the Twilio keys" |
  | 894 | 1170 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L898) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1174) |  |
  | 898 | 1174 | msgstr "" |
  | 899 | 1175 |  |
  |  | 1176 | #: extensions/twilio/class-twilio-render.php:174 |
  |  | 1177 | msgid "Unfortunately there is a problem with Twilio configuration. Contact the Administrator for further assistance." |
  |  | 1178 | msgstr "" |
  |  | 1179 |  |
  | 900 | 1180 | #: extensions/twilio/class-twilio-user.php:90 |
  | 901 | 1181 | msgid "SMS sending failed" |
  | 902 | 1182 | msgstr "" |
  | 903 | 1183 |  |
  | 904 |  | #: extensions/twilio/class-twilio.php:395 |
  |  | 1184 | #: extensions/twilio/class-twilio-wizard-steps.php:186 |
  |  | 1185 | msgid "Phone number" |
  |  | 1186 | msgstr "" |
  |  | 1187 |  |
  |  | 1188 | #: extensions/twilio/class-twilio-wizard-steps.php:288 |
  |  | 1189 | msgid "One-time code via SMS (with Twilio)" |
  |  | 1190 | msgstr "" |
  |  | 1191 |  |
  |  | 1192 | #: extensions/twilio/class-twilio-wizard-steps.php:294 |
  |  | 1193 | msgid "When using this method, users will receive an SMS message with the one-time code. " |
  |  | 1194 | msgstr "" |
  |  | 1195 |  |
  |  | 1196 | #. Translators: Twilio service documentation |
  |  | 1197 | #: extensions/twilio/class-twilio-wizard-steps.php:298 |
  |  | 1198 | msgid "Refer to the %s for more information on how to use the Twilio with WP 2FA for two-factor authentication on your website." |
  |  | 1199 | msgstr "" |
  |  | 1200 |  |
  |  | 1201 | #: extensions/twilio/class-twilio-wizard-steps.php:299 |
  |  | 1202 | msgid "Twilio integration documentation" |
  |  | 1203 | msgstr "" |
  |  | 1204 |  |
  |  | 1205 | #: extensions/twilio/class-twilio.php:294 |
  |  | 1206 | msgid "Provided Twilio settings are invalid" |
  |  | 1207 | msgstr "" |
  |  | 1208 |  |
  |  | 1209 | #: extensions/twilio/class-twilio.php:397 |
  | 905 | 1210 | msgid "The Twilio connection has been configured successfully." |
  | 906 | 1211 | msgstr "" |
  | 907 | 1212 |  |
  | 908 |  | #: extensions/twilio/class-twilio.php:39~~6~~ |
  |  | 1213 | #: extensions/twilio/class-twilio.php:398 |
  | 909 | 1214 | msgid "Twilio SMS service configuration" |
  | 910 | 1215 | msgstr "" |
  | 911 | 1216 |  |
  | 912 |  | #: extensions/twilio/class-twilio.php:442 |
  | 913 |  | #: extensions/twilio/class-twilio.php:697 |
  | 914 |  | msgid "Twilio" |
  | 915 |  | msgstr "" |
  | 916 |  |  |
  | 917 |  | #: extensions/twilio/class-twilio.php:812 |
  |  | 1217 | #: extensions/twilio/class-twilio.php:640 |
  |  | 1218 | msgid "One-time code via SMS" |
  |  | 1219 | msgstr "" |
  |  | 1220 |  |
  |  | 1221 | #: extensions/twilio/class-twilio.php:818 |
  | 918 | 1222 | msgid "SMS Registration text" |
  | 919 | 1223 | msgstr "" |
  | 920 | 1224 |  |
  | 921 |  | #: extensions/twilio/class-twilio.php:82~~1~~ |
  |  | 1225 | #: extensions/twilio/class-twilio.php:827 |
  | 922 | 1226 | msgid "SMS Code text" |
  | 923 |  | ~~msgstr ""~~ |
  | 924 |  |  |
  | 925 |  | ~~#: extensions/twilio/class-wizard-steps-twilio.php:78~~ |
  | 926 |  | ~~msgid "One-time code via SMS"~~ |
  | 927 |  | ~~msgstr ""~~ |
  | 928 |  |  |
  | 929 |  | ~~#: extensions/twilio/class-wizard-steps-twilio.php:144~~ |
  | 930 |  | ~~msgid "Phone number"~~ |
  | 931 |  | ~~msgstr ""~~ |
  | 932 |  |  |
  | 933 |  | ~~#: extensions/twilio/class-wizard-steps-twilio.php:243~~ |
  | 934 |  | ~~msgid "One-time code via SMS (with Twilio)"~~ |
  | 935 |  | ~~msgstr ""~~ |
  | 936 |  |  |
  | 937 |  | ~~#: extensions/twilio/class-wizard-steps-twilio.php:249~~ |
  | 938 |  | ~~msgid "When using this method, users will receive an SMS message with the one-time code. "~~ |
  | 939 |  | ~~msgstr ""~~ |
  | 940 |  |  |
  | 941 |  | ~~#. Translators: Twilio service documentation~~ |
  | 942 |  | ~~#: extensions/twilio/class-wizard-steps-twilio.php:253~~ |
  | 943 |  | ~~msgid "Refer to the %s for more information on how to use the Twilio with WP 2FA for two-factor authentication on your website."~~ |
  | 944 |  | ~~msgstr ""~~ |
  | 945 |  |  |
  | 946 |  | ~~#: extensions/twilio/class-wizard-steps-twilio.php:254~~ |
  | 947 |  | ~~msgid "Twilio integration documentation"~~ |
  | 948 | 1227 | msgstr "" |
  | 949 | 1228 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L968) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1247) |  |
  | 968 | 1247 | msgstr "" |
  | 969 | 1248 |  |
  | 970 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~4~~ |
  |  | 1249 | #: extensions/white-labeling/class-white-labeling-render.php:63 |
  | 971 | 1250 | msgid "Log in" |
  | 972 | 1251 | msgstr "" |
  | 973 | 1252 |  |
  | 974 |  | #: extensions/white-labeling/class-white-labeling-render.php:161 |
  |  | 1253 | #. translators: support email. |
  |  | 1254 | #: extensions/white-labeling/class-white-labeling-render.php:154 |
  |  | 1255 | msgid "Use the settings below to customize the looks of the 2FA code page so it meets your branding requirements. If you have any questions send us an email at %1$s." |
  |  | 1256 | msgstr "" |
  |  | 1257 |  |
  |  | 1258 | #: extensions/white-labeling/class-white-labeling-render.php:160 |
  | 975 | 1259 | msgid "Change the background color" |
  | 976 | 1260 | msgstr "" |
  | 977 | 1261 |  |
  | 978 |  | #: extensions/white-labeling/class-white-labeling-render.php:16~~3~~ |
  |  | 1262 | #: extensions/white-labeling/class-white-labeling-render.php:162 |
  | 979 | 1263 | msgid "This is the background color selector, from here you can change the form background color." |
  | 980 | 1264 | msgstr "" |
  | 981 | 1265 |  |
  | 982 |  | #: extensions/white-labeling/class-white-labeling-render.php:16~~8~~ |
  |  | 1266 | #: extensions/white-labeling/class-white-labeling-render.php:167 |
  | 983 | 1267 | msgid "2FA background color" |
  | 984 | 1268 | msgstr "" |
  | 985 | 1269 |  |
  | 986 |  | #: extensions/white-labeling/class-white-labeling-render.php:17~~7~~ |
  |  | 1270 | #: extensions/white-labeling/class-white-labeling-render.php:176 |
  | 987 | 1271 | msgid "Change the logo" |
  | 988 | 1272 | msgstr "" |
  | 989 | 1273 |  |
  | 990 |  | #: extensions/white-labeling/class-white-labeling-render.php:17~~9~~ |
  |  | 1274 | #: extensions/white-labeling/class-white-labeling-render.php:178 |
  | 991 | 1275 | msgid "This is the logo image selector, from here you can change the form logo." |
  | 992 | 1276 | msgstr "" |
  | 993 | 1277 |  |
  | 994 |  | #: extensions/white-labeling/class-white-labeling-render.php:18~~4~~ |
  |  | 1278 | #: extensions/white-labeling/class-white-labeling-render.php:183 |
  | 995 | 1279 | msgid "Logo on page" |
  | 996 | 1280 | msgstr "" |
  | 997 | 1281 |  |
  | 998 |  | #: extensions/white-labeling/class-white-labeling-render.php:19~~1~~ |
  |  | 1282 | #: extensions/white-labeling/class-white-labeling-render.php:190 |
  | 999 | 1283 | msgid "Select" |
  | 1000 | 1284 | msgstr "" |
  | 1001 | 1285 |  |
  | 1002 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~21~~ |
  |  | 1286 | #: extensions/white-labeling/class-white-labeling-render.php:209 |
  | 1003 | 1287 | msgid "Change the font type" |
  | 1004 | 1288 | msgstr "" |
  | 1005 | 1289 |  |
  | 1006 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~23~~ |
  |  | 1290 | #: extensions/white-labeling/class-white-labeling-render.php:211 |
  | 1007 | 1291 | msgid "This is the font type color selector, from here you can change the form font type." |
  | 1008 | 1292 | msgstr "" |
  | 1009 | 1293 |  |
  | 1010 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~28~~ |
  |  | 1294 | #: extensions/white-labeling/class-white-labeling-render.php:216 |
  | 1011 | 1295 | msgid "Font type" |
  | 1012 | 1296 | msgstr "" |
  | 1013 | 1297 |  |
  | 1014 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~37~~ |
  |  | 1298 | #: extensions/white-labeling/class-white-labeling-render.php:225 |
  | 1015 | 1299 | msgid "Change the button color" |
  | 1016 | 1300 | msgstr "" |
  | 1017 | 1301 |  |
  | 1018 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~39~~ |
  |  | 1302 | #: extensions/white-labeling/class-white-labeling-render.php:227 |
  | 1019 | 1303 | msgid "This is the button color selector, from here you can change the form button color." |
  | 1020 | 1304 | msgstr "" |
  | 1021 | 1305 |  |
  | 1022 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~44~~ |
  |  | 1306 | #: extensions/white-labeling/class-white-labeling-render.php:232 |
  | 1023 | 1307 | msgid "2FA button background color" |
  | 1024 | 1308 | msgstr "" |
  | 1025 | 1309 |  |
  | 1026 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~53~~ |
  |  | 1310 | #: extensions/white-labeling/class-white-labeling-render.php:241 |
  | 1027 | 1311 | msgid "Change the button text on 2FA code page" |
  | 1028 | 1312 | msgstr "" |
  | 1029 | 1313 |  |
  | 1030 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~55~~ |
  |  | 1314 | #: extensions/white-labeling/class-white-labeling-render.php:243 |
  | 1031 | 1315 | msgid "This is the button text, from here you can change the form button text." |
  | 1032 | 1316 | msgstr "" |
  | 1033 | 1317 |  |
  |  | 1318 | #: extensions/white-labeling/class-white-labeling-render.php:248 |
  |  | 1319 | msgid "Button text" |
  |  | 1320 | msgstr "" |
  |  | 1321 |  |
  |  | 1322 | #: extensions/white-labeling/class-white-labeling-render.php:258 |
  |  | 1323 | msgid "Change the styling of the code input area" |
  |  | 1324 | msgstr "" |
  |  | 1325 |  |
  | 1034 | 1326 | #: extensions/white-labeling/class-white-labeling-render.php:260 |
  | 1035 |  | ~~msgid "Button text"~~ |
  | 1036 |  | ~~msgstr ""~~ |
  | 1037 |  |  |
  | 1038 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:270~~ |
  | 1039 |  | ~~msgid "Change the styling of the code input area?"~~ |
  | 1040 |  | ~~msgstr ""~~ |
  | 1041 |  |  |
  | 1042 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:272~~ |
  | 1043 | 1327 | msgid "By default, the user code entry screen uses the default WP CSS, use the below field to add your own CSS to this area." |
  | 1044 | 1328 | msgstr "" |
  | 1045 | 1329 |  |
  | 1046 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~78~~ |
  |  | 1330 | #: extensions/white-labeling/class-white-labeling-render.php:266 |
  | 1047 | 1331 | msgid "Login Custom CSS" |
  | 1048 | 1332 | msgstr "" |
  | 1049 | 1333 |  |
  | 1050 |  | #: extensions/white-labeling/class-white-labeling-render.php:2~~85~~ |
  |  | 1334 | #: extensions/white-labeling/class-white-labeling-render.php:273 |
  | 1051 | 1335 | msgid "- Text above code field" |
  | 1052 | 1336 | msgstr "" |
  | 1053 | 1337 |  |
  | 1054 |  | #: extensions/white-labeling/class-white-labeling-render.php:3~~26~~ |
  | 1055 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~56~~ |
  |  | 1338 | #: extensions/white-labeling/class-white-labeling-render.php:314 |
  |  | 1339 | #: extensions/white-labeling/class-white-labeling-render.php:444 |
  | 1056 | 1340 | msgid "Welcome & Initial Message" |
  | 1057 | 1341 | msgstr "" |
  | 1058 | 1342 |  |
  | 1059 |  | #: extensions/white-labeling/class-white-labeling-render.php:3~~27~~ |
  | 1060 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~57~~ |
  |  | 1343 | #: extensions/white-labeling/class-white-labeling-render.php:315 |
  |  | 1344 | #: extensions/white-labeling/class-white-labeling-render.php:445 |
  | 1061 | 1345 | msgid "2FA Method Selection" |
  | 1062 | 1346 | msgstr "" |
  | 1063 | 1347 |  |
  | 1064 |  | #: extensions/white-labeling/class-white-labeling-render.php:3~~28~~ |
  | 1065 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~58~~ |
  |  | 1348 | #: extensions/white-labeling/class-white-labeling-render.php:316 |
  |  | 1349 | #: extensions/white-labeling/class-white-labeling-render.php:446 |
  | 1066 | 1350 | msgid "2FA Method Verification" |
  | 1067 | 1351 | msgstr "" |
  | 1068 | 1352 |  |
  | 1069 |  | #: extensions/white-labeling/class-white-labeling-render.php:3~~29~~ |
  | 1070 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~59~~ |
  |  | 1353 | #: extensions/white-labeling/class-white-labeling-render.php:317 |
  |  | 1354 | #: extensions/white-labeling/class-white-labeling-render.php:447 |
  | 1071 | 1355 | msgid "Backup Codes & Final Steps" |
  | 1072 | 1356 | msgstr "" |
  | 1073 | 1357 |  |
  | 1074 |  | #: extensions/white-labeling/class-white-labeling-render.php:3~~30~~ |
  | 1075 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~60~~ |
  |  | 1358 | #: extensions/white-labeling/class-white-labeling-render.php:318 |
  |  | 1359 | #: extensions/white-labeling/class-white-labeling-render.php:448 |
  | 1076 | 1360 | msgid "2FA Method Reconfiguration" |
  | 1077 | 1361 | msgstr "" |
  | 1078 | 1362 |  |
  | 1079 |  | #: extensions/white-labeling/class-white-labeling-render.php:3~~31~~ |
  | 1080 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~608~~ |
  |  | 1363 | #: extensions/white-labeling/class-white-labeling-render.php:319 |
  |  | 1364 | #: extensions/white-labeling/class-white-labeling-render.php:596 |
  | 1081 | 1365 | msgid "Custom CSS & Styling" |
  | 1082 | 1366 | msgstr "" |
  | 1083 | 1367 |  |
  | 1084 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~403~~ |
  |  | 1368 | #: extensions/white-labeling/class-white-labeling-render.php:391 |
  | 1085 | 1369 | msgid "Here you can control the look and feel of user areas as well as their content. Use the settings under 2FA Code page design to customize the styling of user wizards and log in messages. To edit the content of the wizard steps, select an area from the dropdown provided and use the text editors to set the content as you wish." |
  | 1086 | 1370 | msgstr "" |
  | 1087 | 1371 |  |
  | 1088 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~12~~ |
  |  | 1372 | #: extensions/white-labeling/class-white-labeling-render.php:400 |
  | 1089 | 1373 | msgid "2FA Code page design" |
  | 1090 | 1374 | msgstr "" |
  | 1091 | 1375 |  |
  | 1092 |  | #: extensions/white-labeling/class-white-labeling-render.php:4~~21~~ |
  |  | 1376 | #: extensions/white-labeling/class-white-labeling-render.php:409 |
  | 1093 | 1377 | msgid "User 2FA setup wizard" |
  | 1094 | 1378 | msgstr "" |
  | 1095 | 1379 |  |
  | 1096 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~510~~ |
  |  | 1380 | #: extensions/white-labeling/class-white-labeling-render.php:498 |
  | 1097 | 1381 | msgid "Optional welcome & initial message" |
  | 1098 | 1382 | msgstr "" |
  | 1099 | 1383 |  |
  | 1100 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~511~~ |
  |  | 1384 | #: extensions/white-labeling/class-white-labeling-render.php:499 |
  | 1101 | 1385 | msgid "You can add an extra slide at the beginning of the user 2FA wizard. This slide will be shown to the users as the first slide when they launch the 2FA configuration wizard to configure 2FA for their users." |
  | 1102 | 1386 | msgstr "" |
  | 1103 | 1387 |  |
  |  | 1388 | #: extensions/white-labeling/class-white-labeling-render.php:503 |
  |  | 1389 | msgid "Enable \"Welcome & initial message\"" |
  |  | 1390 | msgstr "" |
  |  | 1391 |  |
  |  | 1392 | #: extensions/white-labeling/class-white-labeling-render.php:509 |
  |  | 1393 | msgid "Enable to display optional welcome message." |
  |  | 1394 | msgstr "" |
  |  | 1395 |  |
  | 1104 | 1396 | #: extensions/white-labeling/class-white-labeling-render.php:515 |
  | 1105 |  | ~~msgid "Enable \"Welcome & initial message\""~~ |
  | 1106 |  | ~~msgstr ""~~ |
  | 1107 |  |  |
  | 1108 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:521~~ |
  | 1109 |  | ~~msgid "Enable to display optional welcome message."~~ |
  | 1110 |  | ~~msgstr ""~~ |
  | 1111 |  |  |
  | 1112 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:527~~ |
  | 1113 | 1397 | msgid "Optional welcome content" |
  | 1114 | 1398 | msgstr "" |
  | 1115 | 1399 |  |
  | 1116 |  | #: extensions/white-labeling/class-white-labeling-render.php:5~~30~~ |
  |  | 1400 | #: extensions/white-labeling/class-white-labeling-render.php:518 |
  | 1117 | 1401 | msgid "Use the below editor to enter the text that is to be used in the first slide." |
  | 1118 | 1402 | msgstr "" |
  | 1119 | 1403 |  |
  | 1120 |  | #: extensions/white-labeling/class-white-labeling-render.php:5~~56~~ |
  |  | 1404 | #: extensions/white-labeling/class-white-labeling-render.php:544 |
  | 1121 | 1405 | msgid "2FA Code page design settings" |
  | 1122 | 1406 | msgstr "" |
  | 1123 | 1407 |  |
  | 1124 |  | #: extensions/white-labeling/class-white-labeling-render.php:5~~59~~ |
  | 1125 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:~~248~~ |
  | 1126 |  | msgid "Change the styling of the user 2FA wizards~~?~~" |
  | 1127 |  | msgstr "" |
  | 1128 |  |  |
  | 1129 |  | #: extensions/white-labeling/class-white-labeling-render.php:5~~61~~ |
  | 1130 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:~~250~~ |
  |  | 1408 | #: extensions/white-labeling/class-white-labeling-render.php:547 |
  |  | 1409 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:415 |
  |  | 1410 | msgid "Change the styling of the user 2FA wizards" |
  |  | 1411 | msgstr "" |
  |  | 1412 |  |
  |  | 1413 | #: extensions/white-labeling/class-white-labeling-render.php:549 |
  |  | 1414 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:417 |
  | 1131 | 1415 | msgid "By default, the user 2FA wizards which the users see and use to set up 2FA have our own styling. Disable the below setting so the wizards use the styling of your website's theme." |
  | 1132 | 1416 | msgstr "" |
  | 1133 | 1417 |  |
  | 1134 |  | #: extensions/white-labeling/class-white-labeling-render.php:5~~66~~ |
  | 1135 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~26~~ |
  | 1136 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:~~255~~ |
  |  | 1418 | #: extensions/white-labeling/class-white-labeling-render.php:554 |
  |  | 1419 | #: extensions/white-labeling/class-white-labeling-render.php:763 |
  |  | 1420 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:422 |
  | 1137 | 1421 | msgid "Enable styling" |
  | 1138 | 1422 | msgstr "" |
  | 1139 | 1423 |  |
  |  | 1424 | #: extensions/white-labeling/class-white-labeling-render.php:560 |
  |  | 1425 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:428 |
  |  | 1426 | msgid "Enable our CSS within user wizards" |
  |  | 1427 | msgstr "" |
  |  | 1428 |  |
  |  | 1429 | #: extensions/white-labeling/class-white-labeling-render.php:567 |
  |  | 1430 | msgid "Display logo in the user 2FA wizards" |
  |  | 1431 | msgstr "" |
  |  | 1432 |  |
  |  | 1433 | #. translators: Link to logo settings in the plugin. |
  | 1140 | 1434 | #: extensions/white-labeling/class-white-labeling-render.php:572 |
  | 1141 |  | ~~#: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:261~~ |
  | 1142 |  | ~~msgid "Enable our CSS within user wizards"~~ |
  | 1143 |  | ~~msgstr ""~~ |
  | 1144 |  |  |
  | 1145 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:579~~ |
  | 1146 |  | ~~msgid "Display logo in the user 2FA wizards?"~~ |
  | 1147 |  | ~~msgstr ""~~ |
  | 1148 |  |  |
  | 1149 |  | ~~#. translators: Link to logo settings in the plugin.~~ |
  | 1150 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:584~~ |
  | 1151 | 1435 | msgid "Enable this setting to display your logo in the user 2FA wizards. To provide a logo, please use the Logo settings on the %s." |
  | 1152 | 1436 | msgstr "" |
  | 1153 | 1437 |  |
  | 1154 |  | #: extensions/white-labeling/class-white-labeling-render.php:5~~95~~ |
  |  | 1438 | #: extensions/white-labeling/class-white-labeling-render.php:583 |
  | 1155 | 1439 | msgid "Display logo" |
  | 1156 | 1440 | msgstr "" |
  | 1157 | 1441 |  |
  | 1158 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~601~~ |
  |  | 1442 | #: extensions/white-labeling/class-white-labeling-render.php:589 |
  | 1159 | 1443 | msgid "Display logo on user 2FA modals" |
  | 1160 | 1444 | msgstr "" |
  | 1161 | 1445 |  |
  | 1162 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~609~~ |
  |  | 1446 | #: extensions/white-labeling/class-white-labeling-render.php:597 |
  | 1163 | 1447 | msgid "In this section you can add your own styling to the user 2FA setup wizard via CSS. For your reference we have included a number of easy to use selectors. They are listed below the Custom CSS placeholder." |
  | 1164 | 1448 | msgstr "" |
  | 1165 | 1449 |  |
  |  | 1450 | #: extensions/white-labeling/class-white-labeling-render.php:598 |
  |  | 1451 | msgid "Only plain text CSS is allowed. Use of \"!important\" is recommended." |
  |  | 1452 | msgstr "" |
  |  | 1453 |  |
  |  | 1454 | #: extensions/white-labeling/class-white-labeling-render.php:603 |
  |  | 1455 | msgid "Custom CSS" |
  |  | 1456 | msgstr "" |
  |  | 1457 |  |
  | 1166 | 1458 | #: extensions/white-labeling/class-white-labeling-render.php:610 |
  | 1167 |  | msgid "Only plain text CSS is allowed. Use of \"!important\" is recommended." |
  | 1168 |  | msgstr "" |
  | 1169 |  |  |
  | 1170 |  | #: extensions/white-labeling/class-white-labeling-render.php:615 |
  | 1171 |  | msgid "Custom CSS" |
  | 1172 |  | msgstr "" |
  | 1173 |  |  |
  | 1174 |  | #: extensions/white-labeling/class-white-labeling-render.php:622 |
  | 1175 |  | #: extensions/white-labeling/class-white-labeling-render.php:623 |
  |  | 1459 | #: extensions/white-labeling/class-white-labeling-render.php:611 |
  | 1176 | 1460 | msgid "- Primary button selector" |
  | 1177 | 1461 | msgstr "" |
  | 1178 | 1462 |  |
  | 1179 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~24~~ |
  |  | 1463 | #: extensions/white-labeling/class-white-labeling-render.php:612 |
  | 1180 | 1464 | msgid "- Common heading text (unless altered with custom markup)" |
  | 1181 | 1465 | msgstr "" |
  | 1182 | 1466 |  |
  | 1183 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~25~~ |
  |  | 1467 | #: extensions/white-labeling/class-white-labeling-render.php:613 |
  | 1184 | 1468 | msgid "- Common content text (unless altered with custom markup)" |
  | 1185 | 1469 | msgstr "" |
  | 1186 | 1470 |  |
  | 1187 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~45~~ |
  |  | 1471 | #: extensions/white-labeling/class-white-labeling-render.php:633 |
  | 1188 | 1472 | msgid "2FA method selection" |
  | 1189 | 1473 | msgstr "" |
  | 1190 | 1474 |  |
  | 1191 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~46~~ |
  |  | 1475 | #: extensions/white-labeling/class-white-labeling-render.php:634 |
  | 1192 | 1476 | msgid "Here you can customize the messages shown to users when selecting, settings up and reconfiguring 2FA." |
  | 1193 | 1477 | msgstr "" |
  | 1194 | 1478 |  |
  | 1195 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~51~~ |
  |  | 1479 | #: extensions/white-labeling/class-white-labeling-render.php:639 |
  | 1196 | 1480 | msgid "2FA required" |
  | 1197 | 1481 | msgstr "" |
  | 1198 | 1482 |  |
  | 1199 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~54~~ |
  |  | 1483 | #: extensions/white-labeling/class-white-labeling-render.php:642 |
  | 1200 | 1484 | msgid "This message is shown to users when logging in when 2FA is required." |
  | 1201 | 1485 | msgstr "" |
  | 1202 | 1486 |  |
  | 1203 |  | #: extensions/white-labeling/class-white-labeling-render.php:6~~62~~ |
  |  | 1487 | #: extensions/white-labeling/class-white-labeling-render.php:650 |
  | 1204 | 1488 | msgid "Inital setup text" |
  | 1205 | 1489 | msgstr "" |
  | 1206 | 1490 |  |
  |  | 1491 | #: extensions/white-labeling/class-white-labeling-render.php:653 |
  |  | 1492 | msgid "This message is shown to users when configuring 2FA with no previous configuration." |
  |  | 1493 | msgstr "" |
  |  | 1494 |  |
  |  | 1495 | #: extensions/white-labeling/class-white-labeling-render.php:658 |
  |  | 1496 | msgid "this displays the number of 2FA methods available." |
  |  | 1497 | msgstr "" |
  |  | 1498 |  |
  | 1207 | 1499 | #: extensions/white-labeling/class-white-labeling-render.php:665 |
  | 1208 |  | ~~msgid "This message is shown to users when configuring 2FA with no previous configuration."~~ |
  | 1209 |  | ~~msgstr ""~~ |
  | 1210 |  |  |
  | 1211 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:670~~ |
  | 1212 |  | ~~msgid "this displays the number of 2FA methods available."~~ |
  | 1213 |  | ~~msgstr ""~~ |
  | 1214 |  |  |
  | 1215 |  | ~~#: extensions/white-labeling/class-white-labeling-render.php:677~~ |
  | 1216 | 1500 | msgid "This message is shown to users when configuring 2FA with no previous configuration and one single method is available to them." |
  | 1217 | 1501 | msgstr "" |
  | 1218 | 1502 |  |
  | 1219 |  | #: extensions/white-labeling/class-white-labeling-render.php:686 |
  |  | 1503 | #: extensions/white-labeling/class-white-labeling-render.php:674 |
  |  | 1504 | msgid "Method selection label" |
  |  | 1505 | msgstr "" |
  |  | 1506 |  |
  |  | 1507 | #: extensions/white-labeling/class-white-labeling-render.php:675 |
  |  | 1508 | msgid "Here you can customize the label shown for each method when choosing a 2FA method." |
  |  | 1509 | msgstr "" |
  |  | 1510 |  |
  |  | 1511 | #: extensions/white-labeling/class-white-labeling-render.php:681 |
  |  | 1512 | msgid "Wizard option labels" |
  |  | 1513 | msgstr "" |
  |  | 1514 |  |
  |  | 1515 | #: extensions/white-labeling/class-white-labeling-render.php:684 |
  |  | 1516 | msgid "TOTP Option label" |
  |  | 1517 | msgstr "" |
  |  | 1518 |  |
  |  | 1519 | #: extensions/white-labeling/class-white-labeling-render.php:691 |
  |  | 1520 | msgid "Email Option label" |
  |  | 1521 | msgstr "" |
  |  | 1522 |  |
  |  | 1523 | #: extensions/white-labeling/class-white-labeling-render.php:698 |
  |  | 1524 | msgid "OOB Option label" |
  |  | 1525 | msgstr "" |
  |  | 1526 |  |
  |  | 1527 | #: extensions/white-labeling/class-white-labeling-render.php:705 |
  |  | 1528 | msgid "Authy Option label" |
  |  | 1529 | msgstr "" |
  |  | 1530 |  |
  |  | 1531 | #: extensions/white-labeling/class-white-labeling-render.php:712 |
  |  | 1532 | msgid "Twilio Option label" |
  |  | 1533 | msgstr "" |
  |  | 1534 |  |
  |  | 1535 | #: extensions/white-labeling/class-white-labeling-render.php:723 |
  | 1220 | 1536 | msgid "Method help text" |
  | 1221 | 1537 | msgstr "" |
  | 1222 | 1538 |  |
  | 1223 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~687~~ |
  |  | 1539 | #: extensions/white-labeling/class-white-labeling-render.php:724 |
  | 1224 | 1540 | msgid "Here you can customize the help text shown when setting up a chosen method to suit your needs." |
  | 1225 | 1541 | msgstr "" |
  | 1226 | 1542 |  |
  | 1227 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~693~~ |
  |  | 1543 | #: extensions/white-labeling/class-white-labeling-render.php:730 |
  | 1228 | 1544 | msgid "One-time code via 2FA app help text" |
  | 1229 | 1545 | msgstr "" |
  | 1230 | 1546 |  |
  | 1231 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~696~~ |
  |  | 1547 | #: extensions/white-labeling/class-white-labeling-render.php:733 |
  | 1232 | 1548 | msgid "This message is shown to users when configuring one-time code via 2FA App" |
  | 1233 | 1549 | msgstr "" |
  | 1234 | 1550 |  |
  | 1235 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~01~~ |
  |  | 1551 | #: extensions/white-labeling/class-white-labeling-render.php:738 |
  | 1236 | 1552 | msgid "One-time code via 2FA app help step 1" |
  | 1237 | 1553 | msgstr "" |
  | 1238 | 1554 |  |
  | 1239 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~07~~ |
  |  | 1555 | #: extensions/white-labeling/class-white-labeling-render.php:744 |
  | 1240 | 1556 | msgid "One-time code via 2FA app help step 2" |
  | 1241 | 1557 | msgstr "" |
  | 1242 | 1558 |  |
  | 1243 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~13~~ |
  |  | 1559 | #: extensions/white-labeling/class-white-labeling-render.php:750 |
  | 1244 | 1560 | msgid "One-time code via 2FA app help step 3" |
  | 1245 | 1561 | msgstr "" |
  | 1246 | 1562 |  |
  | 1247 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~32~~ |
  |  | 1563 | #: extensions/white-labeling/class-white-labeling-render.php:769 |
  | 1248 | 1564 | msgid "Show the help text to assist users with the 2FA app configuration." |
  | 1249 | 1565 | msgstr "" |
  | 1250 | 1566 |  |
  | 1251 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~43~~ |
  |  | 1567 | #: extensions/white-labeling/class-white-labeling-render.php:780 |
  | 1252 | 1568 | msgid "One-time code via email help text" |
  | 1253 | 1569 | msgstr "" |
  | 1254 | 1570 |  |
  | 1255 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~46~~ |
  |  | 1571 | #: extensions/white-labeling/class-white-labeling-render.php:783 |
  | 1256 | 1572 | msgid "This message is shown to users when configuring One-time code via email." |
  | 1257 | 1573 | msgstr "" |
  | 1258 | 1574 |  |
  | 1259 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~59~~ |
  |  | 1575 | #: extensions/white-labeling/class-white-labeling-render.php:796 |
  | 1260 | 1576 | msgid "Authy 2FA service help text" |
  | 1261 | 1577 | msgstr "" |
  | 1262 | 1578 |  |
  | 1263 |  | #: extensions/white-labeling/class-white-labeling-render.php:7~~62~~ |
  |  | 1579 | #: extensions/white-labeling/class-white-labeling-render.php:799 |
  | 1264 | 1580 | msgid "This message is shown to users when configuring Authy 2FA service." |
  | 1265 | 1581 | msgstr "" |
  | 1266 | 1582 |  |
  | 1267 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~775~~ |
  |  | 1583 | #: extensions/white-labeling/class-white-labeling-render.php:812 |
  | 1268 | 1584 | msgid "Twilio 2FA service help text" |
  | 1269 | 1585 | msgstr "" |
  | 1270 | 1586 |  |
  | 1271 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~778~~ |
  |  | 1587 | #: extensions/white-labeling/class-white-labeling-render.php:815 |
  | 1272 | 1588 | msgid "This message is shown to users when configuring Twilio 2FA service." |
  | 1273 | 1589 | msgstr "" |
  | 1274 | 1590 |  |
  | 1275 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~791~~ |
  |  | 1591 | #: extensions/white-labeling/class-white-labeling-render.php:828 |
  | 1276 | 1592 | msgid "Link via email help text" |
  | 1277 | 1593 | msgstr "" |
  | 1278 | 1594 |  |
  | 1279 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~794~~ |
  |  | 1595 | #: extensions/white-labeling/class-white-labeling-render.php:831 |
  | 1280 | 1596 | msgid "This message is shown to users when configuring Link via email." |
  | 1281 | 1597 | msgstr "" |
  | 1282 | 1598 |  |
  | 1283 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~15~~ |
  |  | 1599 | #: extensions/white-labeling/class-white-labeling-render.php:852 |
  | 1284 | 1600 | msgid "2FA method reconfiguration" |
  | 1285 | 1601 | msgstr "" |
  | 1286 | 1602 |  |
  | 1287 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~16~~ |
  |  | 1603 | #: extensions/white-labeling/class-white-labeling-render.php:853 |
  | 1288 | 1604 | msgid "From here you can customize the wizard text shown to users when they already have 2FA configured and they want to reconfigure 2FA from their user profile page." |
  | 1289 | 1605 | msgstr "" |
  | 1290 | 1606 |  |
  | 1291 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~21~~ |
  |  | 1607 | #: extensions/white-labeling/class-white-labeling-render.php:858 |
  | 1292 | 1608 | msgid "Reconfigure one-time code via 2FA App intro" |
  | 1293 | 1609 | msgstr "" |
  | 1294 | 1610 |  |
  | 1295 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~24~~ |
  | 1296 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~45~~ |
  | 1297 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~866~~ |
  | 1298 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~897~~ |
  | 1299 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~29~~ |
  | 1300 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:4~~09~~ |
  |  | 1611 | #: extensions/white-labeling/class-white-labeling-render.php:861 |
  |  | 1612 | #: extensions/white-labeling/class-white-labeling-render.php:882 |
  |  | 1613 | #: extensions/white-labeling/class-white-labeling-render.php:903 |
  |  | 1614 | #: extensions/white-labeling/class-white-labeling-render.php:934 |
  |  | 1615 | #: extensions/white-labeling/class-white-labeling-render.php:966 |
  |  | 1616 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:446 |
  | 1301 | 1617 | msgid "Available template tags:" |
  | 1302 | 1618 | msgstr "" |
  | 1303 | 1619 |  |
  | 1304 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~33~~ |
  |  | 1620 | #: extensions/white-labeling/class-white-labeling-render.php:870 |
  | 1305 | 1621 | msgid "This message is shown to users when reconfiguring One-time code via 2FA app." |
  | 1306 | 1622 | msgstr "" |
  | 1307 | 1623 |  |
  | 1308 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~42~~ |
  |  | 1624 | #: extensions/white-labeling/class-white-labeling-render.php:879 |
  | 1309 | 1625 | msgid "Reconfigure one-time code via email intro" |
  | 1310 | 1626 | msgstr "" |
  | 1311 | 1627 |  |
  | 1312 |  | #: extensions/white-labeling/class-white-labeling-render.php:8~~54~~ |
  |  | 1628 | #: extensions/white-labeling/class-white-labeling-render.php:891 |
  | 1313 | 1629 | msgid "This message is shown to users when reconfiguring One-time code via email." |
  | 1314 | 1630 | msgstr "" |
  | 1315 | 1631 |  |
  | 1316 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~863~~ |
  |  | 1632 | #: extensions/white-labeling/class-white-labeling-render.php:900 |
  | 1317 | 1633 | msgid "Reconfigure Authy 2FA service intro" |
  | 1318 | 1634 | msgstr "" |
  | 1319 | 1635 |  |
  | 1320 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~875~~ |
  |  | 1636 | #: extensions/white-labeling/class-white-labeling-render.php:912 |
  | 1321 | 1637 | msgid "This message is shown to users when reconfiguring Authy 2FA service." |
  | 1322 | 1638 | msgstr "" |
  | 1323 | 1639 |  |
  | 1324 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~885~~ |
  |  | 1640 | #: extensions/white-labeling/class-white-labeling-render.php:922 |
  | 1325 | 1641 | msgid "This message is shown to users when reconfiguring Authy 2FA service, but Authy 2FA service service is unavailable." |
  | 1326 | 1642 | msgstr "" |
  | 1327 | 1643 |  |
  | 1328 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~894~~ |
  |  | 1644 | #: extensions/white-labeling/class-white-labeling-render.php:931 |
  | 1329 | 1645 | msgid "Reconfigure Twilio 2FA service intro" |
  | 1330 | 1646 | msgstr "" |
  | 1331 | 1647 |  |
  | 1332 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~06~~ |
  |  | 1648 | #: extensions/white-labeling/class-white-labeling-render.php:943 |
  | 1333 | 1649 | msgid "This message is shown to users when reconfiguring Twilio 2FA service." |
  | 1334 | 1650 | msgstr "" |
  | 1335 | 1651 |  |
  | 1336 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~16~~ |
  |  | 1652 | #: extensions/white-labeling/class-white-labeling-render.php:953 |
  | 1337 | 1653 | msgid "This message is shown to users when reconfiguring Twilio 2FA service, but SMS 2FA service service is unavailable." |
  | 1338 | 1654 | msgstr "" |
  | 1339 | 1655 |  |
  | 1340 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~26~~ |
  |  | 1656 | #: extensions/white-labeling/class-white-labeling-render.php:963 |
  | 1341 | 1657 | msgid "Reconfigure Link via email intro" |
  | 1342 | 1658 | msgstr "" |
  | 1343 | 1659 |  |
  | 1344 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~38~~ |
  |  | 1660 | #: extensions/white-labeling/class-white-labeling-render.php:975 |
  | 1345 | 1661 | msgid "This message is shown to users when reconfiguring Link via email." |
  | 1346 | 1662 | msgstr "" |
  | 1347 | 1663 |  |
  | 1348 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~59~~ |
  |  | 1664 | #: extensions/white-labeling/class-white-labeling-render.php:996 |
  | 1349 | 1665 | msgid "2FA method verification" |
  | 1350 | 1666 | msgstr "" |
  | 1351 | 1667 |  |
  | 1352 |  | #: extensions/white-labeling/class-white-labeling-render.php:9~~60~~ |
  |  | 1668 | #: extensions/white-labeling/class-white-labeling-render.php:997 |
  | 1353 | 1669 | msgid "Here you can customize the messages shown to users when during the submission and verification of codes during setup." |
  | 1354 | 1670 | msgstr "" |
  | 1355 | 1671 |  |
  | 1356 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~965~~ |
  |  | 1672 | #: extensions/white-labeling/class-white-labeling-render.php:1002 |
  | 1357 | 1673 | msgid "One-time code via 2FA app pre-submission text" |
  | 1358 | 1674 | msgstr "" |
  | 1359 | 1675 |  |
  | 1360 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~968~~ |
  |  | 1676 | #: extensions/white-labeling/class-white-labeling-render.php:1005 |
  | 1361 | 1677 | msgid "This message is shown to users prior to configuring one-time code via 2FA app method." |
  | 1362 | 1678 | msgstr "" |
  | 1363 | 1679 |  |
  | 1364 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~981~~ |
  |  | 1680 | #: extensions/white-labeling/class-white-labeling-render.php:1018 |
  | 1365 | 1681 | msgid "One-time code via email pre-submission text" |
  | 1366 | 1682 | msgstr "" |
  | 1367 | 1683 |  |
  | 1368 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~984~~ |
  |  | 1684 | #: extensions/white-labeling/class-white-labeling-render.php:1021 |
  | 1369 | 1685 | msgid "This message is shown to users prior to configuring one-time code via email method." |
  | 1370 | 1686 | msgstr "" |
  | 1371 | 1687 |  |
  | 1372 |  | #: extensions/white-labeling/class-white-labeling-render.php:~~997~~ |
  |  | 1688 | #: extensions/white-labeling/class-white-labeling-render.php:1034 |
  | 1373 | 1689 | msgid "Link via email pre-submission text" |
  | 1374 | 1690 | msgstr "" |
  | 1375 | 1691 |  |
  | 1376 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~00~~ |
  |  | 1692 | #: extensions/white-labeling/class-white-labeling-render.php:1037 |
  | 1377 | 1693 | msgid "This message is shown to users prior to configuring Link via email method." |
  | 1378 | 1694 | msgstr "" |
  | 1379 | 1695 |  |
  | 1380 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~13~~ |
  |  | 1696 | #: extensions/white-labeling/class-white-labeling-render.php:1050 |
  | 1381 | 1697 | msgid "Authy 2FA service pre-submission text" |
  | 1382 | 1698 | msgstr "" |
  | 1383 | 1699 |  |
  | 1384 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~21~~ |
  |  | 1700 | #: extensions/white-labeling/class-white-labeling-render.php:1058 |
  | 1385 | 1701 | msgid "This message is shown to users prior to configuring Authy 2FA service method." |
  | 1386 | 1702 | msgstr "" |
  | 1387 | 1703 |  |
  | 1388 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~34~~ |
  |  | 1704 | #: extensions/white-labeling/class-white-labeling-render.php:1071 |
  | 1389 | 1705 | msgid "Twilio 2FA service pre-submission text" |
  | 1390 | 1706 | msgstr "" |
  | 1391 | 1707 |  |
  | 1392 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~37~~ |
  |  | 1708 | #: extensions/white-labeling/class-white-labeling-render.php:1074 |
  | 1393 | 1709 | msgid "This message is shown to users prior to configuring Twilio 2FA service method." |
  | 1394 | 1710 | msgstr "" |
  | 1395 | 1711 |  |
  | 1396 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~58~~ |
  |  | 1712 | #: extensions/white-labeling/class-white-labeling-render.php:1095 |
  | 1397 | 1713 | msgid "Backup 2FA methods & final steps" |
  | 1398 | 1714 | msgstr "" |
  | 1399 | 1715 |  |
  | 1400 |  | #: extensions/white-labeling/class-white-labeling-render.php:10~~59~~ |
  |  | 1716 | #: extensions/white-labeling/class-white-labeling-render.php:1096 |
  | 1401 | 1717 | msgid "Here you can customize the messages shown to users once setup is complete." |
  | 1402 | 1718 | msgstr "" |
  | 1403 | 1719 |  |
  | 1404 |  | #: extensions/white-labeling/class-white-labeling-render.php:1~~065~~ |
  |  | 1720 | #: extensions/white-labeling/class-white-labeling-render.php:1102 |
  | 1405 | 1721 | msgid "No further action" |
  | 1406 | 1722 | msgstr "" |
  | 1407 | 1723 |  |
  | 1408 |  | #: extensions/white-labeling/class-white-labeling-render.php:1~~068~~ |
  |  | 1724 | #: extensions/white-labeling/class-white-labeling-render.php:1105 |
  | 1409 | 1725 | msgid "This message is shown to users when 2FA has been configured and no further actions are available." |
  | 1410 | 1726 | msgstr "" |
  | 1411 | 1727 |  |
  | 1412 |  | #: extensions/white-labeling/class-white-labeling-render.php:1~~081~~ |
  |  | 1728 | #: extensions/white-labeling/class-white-labeling-render.php:1118 |
  | 1413 | 1729 | msgid "Choose backup method" |
  | 1414 | 1730 | msgstr "" |
  | 1415 | 1731 |  |
  | 1416 |  | #: extensions/white-labeling/class-white-labeling-render.php:1~~084~~ |
  |  | 1732 | #: extensions/white-labeling/class-white-labeling-render.php:1121 |
  | 1417 | 1733 | msgid "This message is shown to users when more than one backup method is available." |
  | 1418 | 1734 | msgstr "" |
  | 1419 | 1735 |  |
  | 1420 |  | #: extensions/white-labeling/class-white-labeling-render.php:1~~093~~ |
  |  | 1736 | #: extensions/white-labeling/class-white-labeling-render.php:1130 |
  | 1421 | 1737 | msgid "This message is shown to users when once setup is complete and backup codes are not available." |
  | 1422 | 1738 | msgstr "" |
  | 1423 | 1739 |  |
  | 1424 |  | #: extensions/white-labeling/class-white-labeling-render.php:11~~02~~ |
  |  | 1740 | #: extensions/white-labeling/class-white-labeling-render.php:1139 |
  | 1425 | 1741 | msgid "This message is shown to users when once setup is complete and backup codes are optional." |
  | 1426 | 1742 | msgstr "" |
  | 1427 | 1743 |  |
  | 1428 |  | #: extensions/white-labeling/class-white-labeling-render.php:11~~11~~ |
  |  | 1744 | #: extensions/white-labeling/class-white-labeling-render.php:1148 |
  | 1429 | 1745 | msgid "This message is shown to users when only email 2FA backup is available." |
  | 1430 | 1746 | msgstr "" |
  | 1431 | 1747 |  |
  | 1432 |  | #: extensions/white-labeling/class-white-labeling-render.php:11~~24~~ |
  |  | 1748 | #: extensions/white-labeling/class-white-labeling-render.php:1161 |
  | 1433 | 1749 | msgid "Back codes generation intro" |
  | 1434 | 1750 | msgstr "" |
  | 1435 | 1751 |  |
  | 1436 |  | #: extensions/white-labeling/class-white-labeling-render.php:11~~27~~ |
  |  | 1752 | #: extensions/white-labeling/class-white-labeling-render.php:1164 |
  | 1437 | 1753 | msgid "This message is shown to users prior to generatrion of backup codes." |
  | 1438 | 1754 | msgstr "" |
  | 1439 | 1755 |  |
  | 1440 |  | #: extensions/white-labeling/class-white-labeling-render.php:11~~36~~ |
  |  | 1756 | #: extensions/white-labeling/class-white-labeling-render.php:1173 |
  | 1441 | 1757 | msgid "Back codes generated" |
  | 1442 | 1758 | msgstr "" |
  | 1443 | 1759 |  |
  | 1444 |  | #: extensions/white-labeling/class-white-labeling-render.php:11~~39~~ |
  |  | 1760 | #: extensions/white-labeling/class-white-labeling-render.php:1176 |
  | 1445 | 1761 | msgid "This message is shown to users when backup codes have been generated." |
  | 1446 | 1762 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L1449) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1765) |  |
  | 1449 | 1765 | #: includes/classes/Admin/class-help-contact-us.php:35 |
  | 1450 | 1766 | msgid "Help & Contact Us" |
  | 1451 |  | ~~msgstr ""~~ |
  | 1452 |  |  |
  | 1453 |  | ~~#: includes/classes/Admin/class-help-contact-us.php:63~~ |
  | 1454 |  | ~~#: includes/classes/Admin/class-help-contact-us.php:71~~ |
  | 1455 |  | ~~msgid "Help"~~ |
  | 1456 | 1767 | msgstr "" |
  | 1457 | 1768 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L1581) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1892) |  |
  | 1581 | 1892 |  |
  | 1582 | 1893 | #: includes/classes/Admin/class-premium-features.php:60 |
  | 1583 |  | #: includes/classes/Admin/class-premium-features.php:39~~3~~ |
  |  | 1894 | #: includes/classes/Admin/class-premium-features.php:391 |
  | 1584 | 1895 | msgid "No Ads!" |
  | 1585 | 1896 | msgstr "" |
  | 1586 | 1897 |  |
  | 1587 | 1898 | #: includes/classes/Admin/class-premium-features.php:61 |
  | 1588 |  | msgid "Get a Free 14-day trial" |
  | 1589 |  | msgstr "" |
  | 1590 |  |  |
  | 1591 |  | #: includes/classes/Admin/class-premium-features.php:61 |
  | 1592 |  | msgid "Upgrade now" |
  |  | 1899 | #: includes/classes/Admin/class-premium-features.php:204 |
  |  | 1900 | #: includes/classes/Admin/class-premium-features.php:404 |
  |  | 1901 | #: includes/classes/Admin/class-settings-page.php:213 |
  |  | 1902 | msgid "Upgrade to Premium" |
  | 1593 | 1903 | msgstr "" |
  | 1594 | 1904 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L1625) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L1935) |  |
  | 1625 | 1935 | msgstr "" |
  | 1626 | 1936 |  |
  | 1627 |  | #: includes/classes/Admin/class-premium-features.php:204 |
  | 1628 |  | #: includes/classes/Admin/class-premium-features.php:406 |
  | 1629 |  | msgid "Get the Free 14-day trial" |
  | 1630 |  | msgstr "" |
  | 1631 |  |  |
  | 1632 |  | #: includes/classes/Admin/class-premium-features.php:205 |
  | 1633 |  | #: includes/classes/Admin/class-premium-features.php:407 |
  | 1634 |  | msgid "UPGRADE NOW" |
  | 1635 |  | msgstr "" |
  | 1636 |  |  |
  | 1637 |  | #: includes/classes/Admin/class-premium-features.php:206 |
  | 1638 |  | #: includes/classes/Admin/class-premium-features.php:408 |
  | 1639 |  | msgid "\* No credit card or payment details required for the trial." |
  | 1640 |  | msgstr "" |
  | 1641 |  |  |
  | 1642 |  | #: includes/classes/Admin/class-premium-features.php:210 |
  |  | 1937 | #: includes/classes/Admin/class-premium-features.php:208 |
  | 1643 | 1938 | msgid "WP 2FA plugin features" |
  | 1644 | 1939 | msgstr "" |
  | 1645 | 1940 |  |
  | 1646 |  | #: includes/classes/Admin/class-premium-features.php:2~~11~~ |
  |  | 1941 | #: includes/classes/Admin/class-premium-features.php:209 |
  | 1647 | 1942 | msgid "Take advantage of these benefits and many others, with prices starting from as little as $29 for 5 users per year. " |
  | 1648 | 1943 | msgstr "" |
  | 1649 | 1944 |  |
  | 1650 |  | #: includes/classes/Admin/class-premium-features.php:21~~9~~ |
  |  | 1945 | #: includes/classes/Admin/class-premium-features.php:217 |
  | 1651 | 1946 | msgid "Premium" |
  | 1652 | 1947 | msgstr "" |
  | 1653 | 1948 |  |
  | 1654 |  | #: includes/classes/Admin/class-premium-features.php:22~~2~~ |
  |  | 1949 | #: includes/classes/Admin/class-premium-features.php:220 |
  | 1655 | 1950 | msgid "Free" |
  | 1656 | 1951 | msgstr "" |
  | 1657 | 1952 |  |
  | 1658 |  | #: includes/classes/Admin/class-premium-features.php:22~~7~~ |
  |  | 1953 | #: includes/classes/Admin/class-premium-features.php:225 |
  | 1659 | 1954 | msgid "Support" |
  | 1660 | 1955 | msgstr "" |
  | 1661 | 1956 |  |
  | 1662 |  | #: includes/classes/Admin/class-premium-features.php:2~~30~~ |
  |  | 1957 | #: includes/classes/Admin/class-premium-features.php:228 |
  | 1663 | 1958 | msgid "1-to-1 emails, forums" |
  | 1664 | 1959 | msgstr "" |
  | 1665 | 1960 |  |
  | 1666 |  | #: includes/classes/Admin/class-premium-features.php:23~~3~~ |
  |  | 1961 | #: includes/classes/Admin/class-premium-features.php:231 |
  | 1667 | 1962 | msgid "forums" |
  | 1668 | 1963 | msgstr "" |
  | 1669 | 1964 |  |
  | 1670 |  | #: includes/classes/Admin/class-premium-features.php:23~~8~~ |
  |  | 1965 | #: includes/classes/Admin/class-premium-features.php:236 |
  | 1671 | 1966 | msgid "Out of the box support for e-commerce, membership & third party plugins (no code required)" |
  | 1672 | 1967 | msgstr "" |
  | 1673 | 1968 |  |
  | 1674 |  | #: includes/classes/Admin/class-premium-features.php:24~~9~~ |
  |  | 1969 | #: includes/classes/Admin/class-premium-features.php:247 |
  | 1675 | 1970 | msgid "2FA code via mobile app" |
  | 1676 | 1971 | msgstr "" |
  | 1677 | 1972 |  |
  | 1678 |  | #: includes/classes/Admin/class-premium-features.php:260 |
  |  | 1973 | #: includes/classes/Admin/class-premium-features.php:258 |
  |  | 1974 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:316 |
  | 1679 | 1975 | msgid "2FA code over email" |
  | 1680 | 1976 | msgstr "" |
  | 1681 | 1977 |  |
  | 1682 |  | #: includes/classes/Admin/class-premium-features.php:2~~71~~ |
  |  | 1978 | #: includes/classes/Admin/class-premium-features.php:269 |
  | 1683 | 1979 | msgid "2FA login with push notification (Authy)" |
  | 1684 | 1980 | msgstr "" |
  | 1685 | 1981 |  |
  | 1686 |  | #: includes/classes/Admin/class-premium-features.php:28~~2~~ |
  |  | 1982 | #: includes/classes/Admin/class-premium-features.php:280 |
  | 1687 | 1983 | msgid "2FA Login with SMS (with Twilio)" |
  | 1688 | 1984 | msgstr "" |
  | 1689 | 1985 |  |
  | 1690 |  | #: includes/classes/Admin/class-premium-features.php:29~~4~~ |
  |  | 1986 | #: includes/classes/Admin/class-premium-features.php:292 |
  | 1691 | 1987 | msgid "One-click 2FA login" |
  | 1692 | 1988 | msgstr "" |
  | 1693 | 1989 |  |
  | 1694 |  | #: includes/classes/Admin/class-premium-features.php:30~~5~~ |
  |  | 1990 | #: includes/classes/Admin/class-premium-features.php:303 |
  | 1695 | 1991 | msgid "Different 2FA policies per user role" |
  | 1696 | 1992 | msgstr "" |
  | 1697 | 1993 |  |
  | 1698 |  | #: includes/classes/Admin/class-premium-features.php:31~~6~~ |
  |  | 1994 | #: includes/classes/Admin/class-premium-features.php:314 |
  | 1699 | 1995 | msgid "Trusted devices (remember devices)" |
  | 1700 | 1996 | msgstr "" |
  | 1701 | 1997 |  |
  | 1702 |  | #: includes/classes/Admin/class-premium-features.php:32~~7~~ |
  |  | 1998 | #: includes/classes/Admin/class-premium-features.php:325 |
  | 1703 | 1999 | msgid "Alternative 2FA methods" |
  | 1704 | 2000 | msgstr "" |
  | 1705 | 2001 |  |
  | 1706 |  | #: includes/classes/Admin/class-premium-features.php:33~~3~~ |
  |  | 2002 | #: includes/classes/Admin/class-premium-features.php:331 |
  | 1707 | 2003 | msgid "Backup codes only" |
  | 1708 | 2004 | msgstr "" |
  | 1709 | 2005 |  |
  | 1710 |  | #: includes/classes/Admin/class-premium-features.php:33~~8~~ |
  |  | 2006 | #: includes/classes/Admin/class-premium-features.php:336 |
  | 1711 | 2007 | msgid "White labeling (logo, wizards, email, colours, fonts & custom CSS)" |
  | 1712 | 2008 | msgstr "" |
  | 1713 | 2009 |  |
  | 1714 |  | #: includes/classes/Admin/class-premium-features.php:34~~9~~ |
  |  | 2010 | #: includes/classes/Admin/class-premium-features.php:347 |
  | 1715 | 2011 | msgid "One-click 2FA integration in WooCommerce user page" |
  | 1716 | 2012 | msgstr "" |
  | 1717 | 2013 |  |
  | 1718 |  | #: includes/classes/Admin/class-premium-features.php:3~~60~~ |
  |  | 2014 | #: includes/classes/Admin/class-premium-features.php:358 |
  | 1719 | 2015 | msgid "Reports & Statistics" |
  | 1720 | 2016 | msgstr "" |
  | 1721 | 2017 |  |
  | 1722 |  | #: includes/classes/Admin/class-premium-features.php:3~~71~~ |
  |  | 2018 | #: includes/classes/Admin/class-premium-features.php:369 |
  | 1723 | 2019 | msgid "Configurable 2FA code expiration time" |
  | 1724 | 2020 | msgstr "" |
  | 1725 | 2021 |  |
  | 1726 |  | #: includes/classes/Admin/class-premium-features.php:38~~2~~ |
  |  | 2022 | #: includes/classes/Admin/class-premium-features.php:380 |
  | 1727 | 2023 | msgid "Sortable users' 2FA status" |
  | 1728 | 2024 | msgstr "" |
  | 1729 | 2025 |  |
  | 1730 | 2026 | #. translators: 1: Link to our site 2: Link to our contact page |
  | 1731 |  | #: includes/classes/Admin/class-premium-features.php:41~~7~~ |
  |  | 2027 | #: includes/classes/Admin/class-premium-features.php:413 |
  | 1732 | 2028 | msgid "Visit the WP 2FA %1$s for more information or %2$s  with any questions you might have. We look forward to hearing from you." |
  | 1733 | 2029 | msgstr "" |
  | 1734 | 2030 |  |
  | 1735 |  | #: includes/classes/Admin/class-premium-features.php:41~~8~~ |
  |  | 2031 | #: includes/classes/Admin/class-premium-features.php:414 |
  | 1736 | 2032 | msgid "plugin website" |
  | 1737 | 2033 | msgstr "" |
  | 1738 | 2034 |  |
  | 1739 |  | #: includes/classes/Admin/class-premium-features.php:419 |
  |  | 2035 | #: includes/classes/Admin/class-premium-features.php:415 |
  |  | 2036 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:138 |
  | 1740 | 2037 | msgid "contact us" |
  | 1741 | 2038 | msgstr "" |
  | 1742 | 2039 |  |
  | 1743 |  | #: includes/classes/Admin/class-settings-page.php:~~50~~ |
  | 1744 |  | #: includes/classes/Admin/class-settings-page.php:~~51~~ |
  | 1745 |  | #: includes/classes/Admin/class-settings-page.php:1~~24~~ |
  | 1746 |  | #: includes/classes/Admin/class-setup-wizard.php:34~~6~~ |
  |  | 2040 | #: includes/classes/Admin/class-settings-page.php:41 |
  |  | 2041 | #: includes/classes/Admin/class-settings-page.php:42 |
  |  | 2042 | #: includes/classes/Admin/class-settings-page.php:117 |
  |  | 2043 | #: includes/classes/Admin/class-setup-wizard.php:348 |
  | 1747 | 2044 | msgid "WP 2FA" |
  | 1748 | 2045 | msgstr "" |
  | 1749 | 2046 |  |
  | 1750 |  | #: includes/classes/Admin/class-settings-page.php:61 |
  |  | 2047 | #: includes/classes/Admin/class-settings-page.php:52 |
  |  | 2048 | #: includes/classes/Admin/class-settings-page.php:53 |
  |  | 2049 | #: includes/classes/Admin/class-settings-page.php:127 |
  |  | 2050 | #: includes/classes/Admin/class-settings-page.php:128 |
  |  | 2051 | msgid "2FA Policies" |
  |  | 2052 | msgstr "" |
  |  | 2053 |  |
  | 1751 | 2054 | #: includes/classes/Admin/class-settings-page.php:62 |
  | 1752 |  | #: includes/classes/Admin/class-settings-page.php:134 |
  | 1753 |  | #: includes/classes/Admin/class-settings-page.php:135 |
  | 1754 |  | msgid "2FA Policies" |
  | 1755 |  | msgstr "" |
  | 1756 |  |  |
  | 1757 |  | #: includes/classes/Admin/class-settings-page.php:71 |
  | 1758 |  | #: includes/classes/Admin/class-settings-page.php:123 |
  | 1759 |  | #: includes/classes/Admin/class-settings-page.php:144 |
  | 1760 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:94 |
  |  | 2055 | #: includes/classes/Admin/class-settings-page.php:116 |
  |  | 2056 | #: includes/classes/Admin/class-settings-page.php:137 |
  |  | 2057 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:96 |
  | 1761 | 2058 | #: includes/classes/Admin/SettingsPages/class-settings-page-render.php:42 |
  | 1762 | 2059 | msgid "WP 2FA Settings" |
  | 1763 | 2060 | msgstr "" |
  | 1764 | 2061 |  |
  | 1765 |  | #: includes/classes/Admin/class-settings-page.php:387 |
  | 1766 |  | msgid "Free 14-day Premium Trial" |
  | 1767 |  | msgstr "" |
  | 1768 |  |  |
  | 1769 |  | #: includes/classes/Admin/class-settings-page.php:397 |
  |  | 2062 | #: includes/classes/Admin/class-settings-page.php:223 |
  | 1770 | 2063 | msgid "Configure 2FA Settings" |
  | 1771 | 2064 | msgstr "" |
  | 1772 | 2065 |  |
  | 1773 |  | #: includes/classes/Admin/class-settings-page.php:411 |
  | 1774 |  | msgid "User account successfully unlocked. User can login again." |
  | 1775 |  | msgstr "" |
  | 1776 |  |  |
  | 1777 |  | #: includes/classes/Admin/class-settings-page.php:413 |
  | 1778 |  | #: includes/classes/Admin/class-settings-page.php:427 |
  | 1779 |  | #: includes/classes/Admin/class-settings-page.php:441 |
  |  | 2066 | #: includes/classes/Admin/class-settings-page.php:268 |
  |  | 2067 | #: includes/classes/Admin/class-settings-page.php:346 |
  |  | 2068 | msgid "2FA Settings Updated" |
  |  | 2069 | msgstr "" |
  |  | 2070 |  |
  |  | 2071 | #: includes/classes/Admin/class-settings-page.php:270 |
  |  | 2072 | #: includes/classes/Admin/class-settings-page.php:283 |
  |  | 2073 | #: includes/classes/Admin/class-settings-page.php:290 |
  |  | 2074 | #: includes/classes/Admin/class-settings-page.php:313 |
  |  | 2075 | #: includes/classes/Admin/class-settings-page.php:338 |
  |  | 2076 | #: includes/classes/Admin/class-settings-page.php:348 |
  |  | 2077 | #: includes/classes/Admin/class-settings-page.php:359 |
  |  | 2078 | #: includes/classes/Admin/class-settings-page.php:369 |
  |  | 2079 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:378 |
  |  | 2080 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:394 |
  |  | 2081 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:410 |
  |  | 2082 | msgid "Dismiss this notice." |
  |  | 2083 | msgstr "" |
  |  | 2084 |  |
  |  | 2085 | #: includes/classes/Admin/class-settings-page.php:288 |
  |  | 2086 | #: includes/classes/Admin/class-settings-page.php:357 |
  |  | 2087 | msgid "Please ensure both custom email address and display name are provided." |
  |  | 2088 | msgstr "" |
  |  | 2089 |  |
  |  | 2090 | #: includes/classes/Admin/class-settings-page.php:388 |
  |  | 2091 | msgid "WP 2FA User Page" |
  |  | 2092 | msgstr "" |
  |  | 2093 |  |
  | 1780 | 2094 | #: includes/classes/Admin/class-settings-page.php:486 |
  | 1781 |  | #: includes/classes/Admin/class-settings-page.php:499 |
  | 1782 |  | #: includes/classes/Admin/class-settings-page.php:506 |
  | 1783 |  | #: includes/classes/Admin/class-settings-page.php:529 |
  | 1784 |  | #: includes/classes/Admin/class-settings-page.php:554 |
  | 1785 |  | #: includes/classes/Admin/class-settings-page.php:564 |
  | 1786 |  | #: includes/classes/Admin/class-settings-page.php:575 |
  | 1787 |  | #: includes/classes/Admin/class-settings-page.php:585 |
  | 1788 |  | msgid "Dismiss this notice." |
  | 1789 |  | msgstr "" |
  | 1790 |  |  |
  | 1791 |  | #: includes/classes/Admin/class-settings-page.php:425 |
  | 1792 |  | msgid "Your 2FA settings have been removed." |
  | 1793 |  | msgstr "" |
  | 1794 |  |  |
  | 1795 |  | #: includes/classes/Admin/class-settings-page.php:439 |
  | 1796 |  | msgid "User 2FA settings have been removed." |
  | 1797 |  | msgstr "" |
  | 1798 |  |  |
  | 1799 |  | #: includes/classes/Admin/class-settings-page.php:484 |
  | 1800 |  | #: includes/classes/Admin/class-settings-page.php:562 |
  | 1801 |  | msgid "2FA Settings Updated" |
  | 1802 |  | msgstr "" |
  | 1803 |  |  |
  | 1804 |  | #: includes/classes/Admin/class-settings-page.php:504 |
  | 1805 |  | #: includes/classes/Admin/class-settings-page.php:573 |
  | 1806 |  | msgid "Please ensure both custom email address and display name are provided." |
  | 1807 |  | msgstr "" |
  | 1808 |  |  |
  | 1809 |  | #: includes/classes/Admin/class-settings-page.php:604 |
  | 1810 |  | msgid "WP 2FA User Page" |
  | 1811 |  | msgstr "" |
  | 1812 |  |  |
  | 1813 |  | #: includes/classes/Admin/class-setup-wizard.php:113 |
  |  | 2095 | msgid "By default, the plugin uses the Administrator's email address as configured in WordPress settings as the \"from address\" when sending emails with the 2FA code for users to log in. This email address is currently configured as: " |
  |  | 2096 | msgstr "" |
  |  | 2097 |  |
  |  | 2098 | #: includes/classes/Admin/class-settings-page.php:488 |
  |  | 2099 | msgid "Configure email address now" |
  |  | 2100 | msgstr "" |
  |  | 2101 |  |
  |  | 2102 | #: includes/classes/Admin/class-settings-page.php:490 |
  |  | 2103 | msgid "Use the Administrator's email address." |
  |  | 2104 | msgstr "" |
  |  | 2105 |  |
  |  | 2106 | #: includes/classes/Admin/class-setup-wizard.php:120 |
  | 1814 | 2107 | msgid "Welcome" |
  | 1815 | 2108 | msgstr "" |
  | 1816 | 2109 |  |
  | 1817 |  | #: includes/classes/Admin/class-setup-wizard.php:1~~18~~ |
  |  | 2110 | #: includes/classes/Admin/class-setup-wizard.php:125 |
  | 1818 | 2111 | msgid "Configure 2FA methods & Policies" |
  | 1819 | 2112 | msgstr "" |
  | 1820 | 2113 |  |
  | 1821 |  | #: includes/classes/Admin/class-setup-wizard.php:1~~24~~ |
  |  | 2114 | #: includes/classes/Admin/class-setup-wizard.php:131 |
  | 1822 | 2115 | msgid "Setup Finish" |
  | 1823 | 2116 | msgstr "" |
  | 1824 | 2117 |  |
  | 1825 |  | #: includes/classes/Admin/class-setup-wizard.php:24~~3~~ |
  | 1826 |  | #: includes/classes/Shortcodes/class-shortcodes.php:5~~4~~ |
  | 1827 |  | #: includes/classes/Shortcodes/class-shortcodes.php:6~~4~~ |
  | 1828 |  | #: includes/functions/core.php:2~~42~~ |
  |  | 2118 | #: includes/classes/Admin/class-setup-wizard.php:246 |
  |  | 2119 | #: includes/classes/Shortcodes/class-shortcodes.php:56 |
  |  | 2120 | #: includes/classes/Shortcodes/class-shortcodes.php:66 |
  |  | 2121 | #: includes/functions/core.php:239 |
  | 1829 | 2122 | msgid "Please use a valid email address" |
  | 1830 | 2123 | msgstr "" |
  | 1831 | 2124 |  |
  | 1832 |  | #: includes/classes/Admin/class-setup-wizard.php:24~~4~~ |
  | 1833 |  | #: includes/classes/Shortcodes/class-shortcodes.php:6~~5~~ |
  | 1834 |  | #: includes/functions/core.php:25~~3~~ |
  |  | 2125 | #: includes/classes/Admin/class-setup-wizard.php:247 |
  |  | 2126 | #: includes/classes/Shortcodes/class-shortcodes.php:67 |
  |  | 2127 | #: includes/functions/core.php:250 |
  | 1835 | 2128 | msgid "Backup codes sent" |
  | 1836 | 2129 | msgstr "" |
  | 1837 | 2130 |  |
  | 1838 |  | #: includes/classes/Admin/class-setup-wizard.php:252 |
  | 1839 |  | #: includes/classes/Shortcodes/class-shortcodes.php:48 |
  | 1840 |  | #: includes/classes/Shortcodes/class-shortcodes.php:61 |
  | 1841 |  | #: includes/classes/Shortcodes/class-shortcodes.php:178 |
  | 1842 |  | #: includes/functions/core.php:250 |
  | 1843 |  | msgid "These are the 2FA backup codes for the user" |
  | 1844 |  | msgstr "" |
  | 1845 |  |  |
  | 1846 |  | #: includes/classes/Admin/class-setup-wizard.php:253 |
  | 1847 |  | #: includes/classes/Shortcodes/class-shortcodes.php:49 |
  | 1848 |  | #: includes/classes/Shortcodes/class-shortcodes.php:62 |
  | 1849 |  | #: includes/classes/Shortcodes/class-shortcodes.php:179 |
  | 1850 |  | #: includes/functions/core.php:251 |
  | 1851 |  | msgid "I'm ready" |
  | 1852 |  | msgstr "" |
  | 1853 |  |  |
  | 1854 |  | #: includes/classes/Admin/class-setup-wizard.php:254 |
  |  | 2131 | #: includes/classes/Admin/class-setup-wizard.php:255 |
  | 1855 | 2132 | #: includes/classes/Shortcodes/class-shortcodes.php:50 |
  | 1856 | 2133 | #: includes/classes/Shortcodes/class-shortcodes.php:63 |
  | 1857 | 2134 | #: includes/classes/Shortcodes/class-shortcodes.php:180 |
  | 1858 |  | #: includes/functions/core.php:252 |
  |  | 2135 | #: includes/functions/core.php:247 |
  |  | 2136 | msgid "These are the 2FA backup codes for the user" |
  |  | 2137 | msgstr "" |
  |  | 2138 |  |
  |  | 2139 | #: includes/classes/Admin/class-setup-wizard.php:256 |
  |  | 2140 | #: includes/classes/Shortcodes/class-shortcodes.php:51 |
  |  | 2141 | #: includes/classes/Shortcodes/class-shortcodes.php:64 |
  |  | 2142 | #: includes/classes/Shortcodes/class-shortcodes.php:181 |
  |  | 2143 | #: includes/functions/core.php:248 |
  |  | 2144 | msgid "I'm ready" |
  |  | 2145 | msgstr "" |
  |  | 2146 |  |
  |  | 2147 | #: includes/classes/Admin/class-setup-wizard.php:257 |
  |  | 2148 | #: includes/classes/Shortcodes/class-shortcodes.php:52 |
  |  | 2149 | #: includes/classes/Shortcodes/class-shortcodes.php:65 |
  |  | 2150 | #: includes/classes/Shortcodes/class-shortcodes.php:182 |
  |  | 2151 | #: includes/functions/core.php:249 |
  | 1859 | 2152 | msgid "New code sent" |
  | 1860 | 2153 | msgstr "" |
  | 1861 | 2154 |  |
  | 1862 |  | #: includes/classes/Admin/class-setup-wizard.php:29~~3~~ |
  |  | 2155 | #: includes/classes/Admin/class-setup-wizard.php:296 |
  | 1863 | 2156 | msgid "WP 2FA &rsaquo; Setup Wizard" |
  | 1864 | 2157 | msgstr "" |
  | 1865 | 2158 |  |
  | 1866 |  | #: includes/classes/Admin/class-setup-wizard.php:33~~2~~ |
  | 1867 |  | #: includes/classes/Shortcodes/class-shortcodes.php:5~~3~~ |
  | 1868 |  | #: includes/classes/Shortcodes/class-shortcodes.php:18~~3~~ |
  |  | 2159 | #: includes/classes/Admin/class-setup-wizard.php:334 |
  |  | 2160 | #: includes/classes/Shortcodes/class-shortcodes.php:55 |
  |  | 2161 | #: includes/classes/Shortcodes/class-shortcodes.php:185 |
  | 1869 | 2162 | msgid "Close Wizard" |
  | 1870 | 2163 | msgstr "" |
  | 1871 | 2164 |  |
  | 1872 |  | #: includes/classes/Admin/class-setup-wizard.php:34~~6~~ |
  |  | 2165 | #: includes/classes/Admin/class-setup-wizard.php:348 |
  | 1873 | 2166 | msgid "If you cancel this wizard, the default plugin settings will be applied. You can always configure the plugin settings and two-factor authentication policies at a later stage from the " |
  | 1874 | 2167 | msgstr "" |
  | 1875 | 2168 |  |
  | 1876 |  | #: includes/classes/Admin/class-setup-wizard.php:34~~6~~ |
  |  | 2169 | #: includes/classes/Admin/class-setup-wizard.php:348 |
  | 1877 | 2170 | msgid " entry in your WordPress dashboard menu." |
  | 1878 | 2171 | msgstr "" |
  | 1879 | 2172 |  |
  | 1880 |  | #: includes/classes/Admin/class-setup-wizard.php:3~~48~~ |
  |  | 2173 | #: includes/classes/Admin/class-setup-wizard.php:350 |
  | 1881 | 2174 | msgid "OK, close wizard" |
  | 1882 | 2175 | msgstr "" |
  | 1883 | 2176 |  |
  | 1884 |  | #: includes/classes/Admin/class-setup-wizard.php:3~~49~~ |
  |  | 2177 | #: includes/classes/Admin/class-setup-wizard.php:351 |
  | 1885 | 2178 | msgid "Continue with wizard" |
  | 1886 | 2179 | msgstr "" |
  | 1887 | 2180 |  |
  | 1888 |  | #: includes/classes/Admin/class-setup-wizard.php:45~~7~~ |
  |  | 2181 | #: includes/classes/Admin/class-setup-wizard.php:459 |
  | 1889 | 2182 | msgid "2FA methods" |
  | 1890 | 2183 | msgstr "" |
  | 1891 | 2184 |  |
  | 1892 |  | #: includes/classes/Admin/class-setup-wizard.php:46~~0~~ |
  | 1893 |  | #: includes/classes/Admin/class-setup-wizard.php:46~~6~~ |
  | 1894 |  | #: includes/classes/Admin/class-setup-wizard.php:47~~2~~ |
  | 1895 |  | #: includes/classes/Admin/class-setup-wizard.php:4~~79~~ |
  | 1896 |  | #: includes/classes/Admin/class-setup-wizard.php:48~~7~~ |
  |  | 2185 | #: includes/classes/Admin/class-setup-wizard.php:462 |
  |  | 2186 | #: includes/classes/Admin/class-setup-wizard.php:468 |
  |  | 2187 | #: includes/classes/Admin/class-setup-wizard.php:474 |
  |  | 2188 | #: includes/classes/Admin/class-setup-wizard.php:481 |
  |  | 2189 | #: includes/classes/Admin/class-setup-wizard.php:489 |
  | 1897 | 2190 | msgid "Continue Setup" |
  | 1898 | 2191 | msgstr "" |
  | 1899 | 2192 |  |
  | 1900 |  | #: includes/classes/Admin/class-setup-wizard.php:46~~3~~ |
  |  | 2193 | #: includes/classes/Admin/class-setup-wizard.php:465 |
  | 1901 | 2194 | msgid "Alternative methods" |
  | 1902 | 2195 | msgstr "" |
  | 1903 | 2196 |  |
  | 1904 |  | #: includes/classes/Admin/class-setup-wizard.php:4~~69~~ |
  |  | 2197 | #: includes/classes/Admin/class-setup-wizard.php:471 |
  | 1905 | 2198 | msgid "2FA policy" |
  | 1906 | 2199 | msgstr "" |
  | 1907 | 2200 |  |
  | 1908 |  | #: includes/classes/Admin/class-setup-wizard.php:47~~3~~ |
  | 1909 |  | #: includes/classes/Admin/class-setup-wizard.php:49~~7~~ |
  |  | 2201 | #: includes/classes/Admin/class-setup-wizard.php:475 |
  |  | 2202 | #: includes/classes/Admin/class-setup-wizard.php:499 |
  | 1910 | 2203 | msgid "All done" |
  | 1911 | 2204 | msgstr "" |
  | 1912 | 2205 |  |
  | 1913 |  | #: includes/classes/Admin/class-setup-wizard.php:47~~6~~ |
  |  | 2206 | #: includes/classes/Admin/class-setup-wizard.php:478 |
  | 1914 | 2207 | msgid "Exclude users" |
  | 1915 | 2208 | msgstr "" |
  | 1916 | 2209 |  |
  | 1917 |  | #: includes/classes/Admin/class-setup-wizard.php:48~~4~~ |
  |  | 2210 | #: includes/classes/Admin/class-setup-wizard.php:486 |
  | 1918 | 2211 | msgid "Exclude sites" |
  | 1919 | 2212 | msgstr "" |
  | 1920 | 2213 |  |
  | 1921 |  | #: includes/classes/Admin/class-setup-wizard.php:49~~3~~ |
  |  | 2214 | #: includes/classes/Admin/class-setup-wizard.php:495 |
  | 1922 | 2215 | msgid "How long should the grace period for your users be?" |
  | 1923 | 2216 | msgstr "" |
  | 1924 | 2217 |  |
  | 1925 |  | #: includes/classes/Admin/class-setup-wizard.php:49~~4~~ |
  |  | 2218 | #: includes/classes/Admin/class-setup-wizard.php:496 |
  | 1926 | 2219 | msgid "When you configure the 2FA policies and require users to configure 2FA, they can either have a grace period to configure 2FA, or can be required to configure 2FA before the next time they login. Choose which method you'd like to use:" |
  | 1927 | 2220 | msgstr "" |
  | 1928 | 2221 |  |
  | 1929 |  | #: includes/classes/Admin/class-setup-wizard.php:695 |
  |  | 2222 | #: includes/classes/Admin/class-setup-wizard.php:601 |
  |  | 2223 | msgid "Email sending failed" |
  |  | 2224 | msgstr "" |
  |  | 2225 |  |
  |  | 2226 | #: includes/classes/Admin/class-setup-wizard.php:621 |
  | 1930 | 2227 | msgid "Welcome to WP 2FA" |
  | 1931 | 2228 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L1936) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2233) |  |
  | 1936 | 2233 |  |
  | 1937 | 2234 | #: includes/classes/Admin/class-user-listing.php:139 |
  | 1938 |  | #: includes/classes/Admin/class-user-profile.php:158 |
  | 1939 |  | #: includes/classes/Admin/class-user-profile.php:202 |
  |  | 2235 | #: includes/classes/Admin/class-user-profile.php:135 |
  | 1940 | 2236 | msgid "Remove 2FA" |
  | 1941 | 2237 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L1956) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2252) |  |
  | 1956 | 2252 | msgstr "" |
  | 1957 | 2253 |  |
  | 1958 |  | #: includes/classes/Admin/class-user-notices.php:13~~8~~ |
  | 1959 |  | #: includes/classes/Admin/class-user-notices.php:1~~59~~ |
  | 1960 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~684~~ |
  | 1961 |  | #: includes/classes/Authenticator/class-login.php:2~~64~~ |
  |  | 2254 | #: includes/classes/Admin/class-user-notices.php:139 |
  |  | 2255 | #: includes/classes/Admin/class-user-notices.php:160 |
  |  | 2256 | #: includes/classes/Admin/Views/class-wizard-steps.php:352 |
  |  | 2257 | #: includes/classes/Authenticator/class-login.php:290 |
  | 1962 | 2258 | msgid "Configure 2FA now" |
  | 1963 | 2259 | msgstr "" |
  | 1964 | 2260 |  |
  | 1965 |  | #: includes/classes/Admin/class-user-notices.php:1~~39~~ |
  |  | 2261 | #: includes/classes/Admin/class-user-notices.php:140 |
  | 1966 | 2262 | msgid "Remind me on next login" |
  | 1967 | 2263 | msgstr "" |
  | 1968 | 2264 |  |
  | 1969 |  | #: includes/classes/Admin/class-user-notices.php:15~~6~~ |
  |  | 2265 | #: includes/classes/Admin/class-user-notices.php:157 |
  | 1970 | 2266 | msgid "The 2FA method you were using is no longer allowed on this website. Please reconfigure 2FA using one of the supported methods." |
  | 1971 | 2267 | msgstr "" |
  | 1972 | 2268 |  |
  | 1973 |  | #: includes/classes/Admin/class-user-notices.php:16~~0~~ |
  | 1974 |  | #: includes/classes/Authenticator/class-login.php:2~~65~~ |
  |  | 2269 | #: includes/classes/Admin/class-user-notices.php:161 |
  |  | 2270 | #: includes/classes/Authenticator/class-login.php:291 |
  | 1975 | 2271 | msgid "I'll do it later" |
  | 1976 | 2272 | msgstr "" |
  | 1977 | 2273 |  |
  | 1978 |  | #: includes/classes/Admin/class-user-notices.php:19~~4~~ |
  |  | 2274 | #: includes/classes/Admin/class-user-notices.php:195 |
  | 1979 | 2275 | msgid "2FA mandatory notice" |
  | 1980 | 2276 | msgstr "" |
  | 1981 | 2277 |  |
  | 1982 |  | #: includes/classes/Admin/class-user-notices.php:20~~3~~ |
  |  | 2278 | #: includes/classes/Admin/class-user-notices.php:204 |
  | 1983 | 2279 | msgid "2FA reconfiguration mandatory notice" |
  | 1984 | 2280 | msgstr "" |
  | 1985 | 2281 |  |
  | 1986 |  | #: includes/classes/Admin/class-user-notices.php:21~~2~~ |
  |  | 2282 | #: includes/classes/Admin/class-user-notices.php:213 |
  | 1987 | 2283 | msgid "User profile 2FA configuration area title" |
  | 1988 | 2284 | msgstr "" |
  | 1989 | 2285 |  |
  | 1990 |  | #: includes/classes/Admin/class-user-notices.php:22~~1~~ |
  |  | 2286 | #: includes/classes/Admin/class-user-notices.php:222 |
  | 1991 | 2287 | msgid "User profile 2FA configuration area description" |
  | 1992 | 2288 | msgstr "" |
  | 1993 | 2289 |  |
  | 1994 |  | #: includes/classes/Admin/class-user-profile.php:8~~5~~ |
  |  | 2290 | #: includes/classes/Admin/class-user-profile.php:87 |
  | 1995 | 2291 | msgid "This user is required to setup 2FA but has not yet done so." |
  | 1996 | 2292 | msgstr "" |
  | 1997 | 2293 |  |
  | 1998 |  | #: includes/classes/Admin/class-user-profile.php:~~89~~ |
  |  | 2294 | #: includes/classes/Admin/class-user-profile.php:91 |
  | 1999 | 2295 | msgid "This user is excluded from configuring 2FA." |
  | 2000 | 2296 | msgstr "" |
  | 2001 | 2297 |  |
  | 2002 |  | #: includes/classes/Admin/class-user-profile.php:154 |
  | 2003 |  | msgid "Change 2FA Settings" |
  | 2004 |  | msgstr "" |
  | 2005 |  |  |
  | 2006 |  | #: includes/classes/Admin/class-user-profile.php:164 |
  | 2007 |  | msgid "Generate list of Backup Codes" |
  | 2008 |  | msgstr "" |
  | 2009 |  |  |
  | 2010 |  | #: includes/classes/Admin/class-user-profile.php:168 |
  |  | 2298 | #: includes/classes/Admin/class-user-profile.php:131 |
  |  | 2299 | msgid "Change 2FA settings" |
  |  | 2300 | msgstr "" |
  |  | 2301 |  |
  |  | 2302 | #: includes/classes/Admin/class-user-profile.php:143 |
  |  | 2303 | msgid "unused backup codes remaining." |
  |  | 2304 | msgstr "" |
  |  | 2305 |  |
  |  | 2306 | #: includes/classes/Admin/class-user-profile.php:145 |
  |  | 2307 | msgid "Learn more about backup codes" |
  |  | 2308 | msgstr "" |
  |  | 2309 |  |
  |  | 2310 | #: includes/classes/Admin/class-user-profile.php:206 |
  |  | 2311 | msgid "Configure 2FA" |
  |  | 2312 | msgstr "" |
  |  | 2313 |  |
  | 2011 | 2314 | #: includes/classes/Admin/class-user-profile.php:210 |
  | 2012 |  | msgid "unused backup codes remaining." |
  | 2013 |  | msgstr "" |
  | 2014 |  |  |
  | 2015 |  | #: includes/classes/Admin/class-user-profile.php:170 |
  | 2016 |  | #: includes/classes/Admin/class-user-profile.php:212 |
  | 2017 |  | msgid "Learn more about backup codes" |
  | 2018 |  | msgstr "" |
  | 2019 |  |  |
  | 2020 |  | #: includes/classes/Admin/class-user-profile.php:198 |
  | 2021 |  | msgid "Change 2FA settings" |
  | 2022 |  | msgstr "" |
  | 2023 |  |  |
  | 2024 |  | #: includes/classes/Admin/class-user-profile.php:273 |
  | 2025 |  | msgid "Configure 2FA" |
  |  | 2315 | msgid "Configure Two-factor authentication (2FA)" |
  |  | 2316 | msgstr "" |
  |  | 2317 |  |
  |  | 2318 | #: includes/classes/Admin/class-user-profile.php:218 |
  |  | 2319 | msgid "The user has already configured 2FA. When you reset the user's current 2FA configuration, the user can log back in with just the username and password." |
  |  | 2320 | msgstr "" |
  |  | 2321 |  |
  |  | 2322 | #: includes/classes/Admin/class-user-profile.php:230 |
  |  | 2323 | msgid "Reset 2FA configuration" |
  |  | 2324 | msgstr "" |
  |  | 2325 |  |
  |  | 2326 | #: includes/classes/Admin/class-user-profile.php:243 |
  |  | 2327 | msgid "Unlock user and reset the grace period" |
  |  | 2328 | msgstr "" |
  |  | 2329 |  |
  |  | 2330 | #: includes/classes/Admin/class-user-profile.php:263 |
  |  | 2331 | msgid "No enabled primary method" |
  |  | 2332 | msgstr "" |
  |  | 2333 |  |
  |  | 2334 | #: includes/classes/Admin/class-user-profile.php:265 |
  |  | 2335 | msgid "No enabled backup methods" |
  |  | 2336 | msgstr "" |
  |  | 2337 |  |
  |  | 2338 | #: includes/classes/Admin/class-user-profile.php:271 |
  |  | 2339 | msgid "Currently configured:" |
  | 2026 | 2340 | msgstr "" |
  | 2027 | 2341 |  |
  | 2028 | 2342 | #: includes/classes/Admin/class-user-profile.php:277 |
  | 2029 |  | msgid "~~Configure Two-factor authentication (2FA)~~" |
  |  | 2343 | msgid "Primary method:" |
  | 2030 | 2344 | msgstr "" |
  | 2031 | 2345 |  |
  | 2032 | 2346 | #: includes/classes/Admin/class-user-profile.php:285 |
  | 2033 |  | msgid "The user has already configured 2FA. When you reset the user's current 2FA configuration, the user can log back in with just the username and password." |
  | 2034 |  | msgstr "" |
  | 2035 |  |  |
  | 2036 |  | #: includes/classes/Admin/class-user-profile.php:297 |
  | 2037 |  | msgid "Reset 2FA configuration" |
  | 2038 |  | msgstr "" |
  | 2039 |  |  |
  | 2040 |  | #: includes/classes/Admin/class-user-profile.php:310 |
  | 2041 |  | msgid "Unlock user and reset the grace period" |
  | 2042 |  | msgstr "" |
  | 2043 |  |  |
  | 2044 |  | #: includes/classes/Admin/class-user-profile.php:332 |
  |  | 2347 | msgid "Secondary method(s):" |
  |  | 2348 | msgstr "" |
  |  | 2349 |  |
  |  | 2350 | #: includes/classes/Admin/class-user-profile.php:295 |
  |  | 2351 | msgid "2FA configuration:" |
  |  | 2352 | msgstr "" |
  |  | 2353 |  |
  |  | 2354 | #: includes/classes/Admin/class-user-profile.php:305 |
  |  | 2355 | msgid "Show QR code" |
  |  | 2356 | msgstr "" |
  |  | 2357 |  |
  |  | 2358 | #: includes/classes/Admin/class-user-profile.php:311 |
  |  | 2359 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:240 |
  |  | 2360 | msgid "COPY" |
  |  | 2361 | msgstr "" |
  |  | 2362 |  |
  |  | 2363 | #: includes/classes/Admin/class-user-profile.php:324 |
  | 2045 | 2364 | msgid "2FA Setup:" |
  | 2046 | 2365 | msgstr "" |
  | 2047 | 2366 |  |
  | 2048 |  | #: includes/classes/Admin/class-user-profile.php:37~~9~~ |
  |  | 2367 | #: includes/classes/Admin/class-user-profile.php:371 |
  | 2049 | 2368 | msgid "Are you sure?" |
  | 2050 | 2369 | msgstr "" |
  | 2051 | 2370 |  |
  | 2052 |  | #: includes/classes/Admin/class-user-profile.php:3~~80~~ |
  |  | 2371 | #: includes/classes/Admin/class-user-profile.php:372 |
  | 2053 | 2372 | msgid "Any unsaved changes will be lost!" |
  | 2054 | 2373 | msgstr "" |
  | 2055 | 2374 |  |
  | 2056 |  | #: includes/classes/Admin/class-user-profile.php:4~~12~~ |
  |  | 2375 | #: includes/classes/Admin/class-user-profile.php:404 |
  | 2057 | 2376 | msgid "No available 2FA methods set" |
  | 2058 | 2377 | msgstr "" |
  | 2059 | 2378 |  |
  | 2060 |  | #: includes/classes/Admin/class-user-profile.php:4~~12~~ |
  |  | 2379 | #: includes/classes/Admin/class-user-profile.php:404 |
  | 2061 | 2380 | msgid "Ask your administrator to enable 2FA methods" |
  | 2062 | 2381 | msgstr "" |
  | 2063 | 2382 |  |
  | 2064 |  | #: includes/classes/Admin/class-user-profile.php:4~~39~~ |
  | 2065 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~81~~ |
  |  | 2383 | #: includes/classes/Admin/class-user-profile.php:428 |
  |  | 2384 | #: includes/classes/Admin/Views/class-wizard-steps.php:64 |
  | 2066 | 2385 | msgid "Next Step" |
  | 2067 | 2386 | msgstr "" |
  | 2068 | 2387 |  |
  | 2069 |  | #: includes/classes/Admin/class-user-profile.php:5~~28~~ |
  |  | 2388 | #: includes/classes/Admin/class-user-profile.php:515 |
  | 2070 | 2389 | msgid "Remove 2FA?" |
  | 2071 | 2390 | msgstr "" |
  | 2072 | 2391 |  |
  | 2073 |  | #: includes/classes/Admin/class-user-profile.php:5~~29~~ |
  |  | 2392 | #: includes/classes/Admin/class-user-profile.php:516 |
  | 2074 | 2393 | msgid "Are you sure you want to remove two-factor authentication and lower the security of your user account?" |
  | 2075 | 2394 | msgstr "" |
  | 2076 | 2395 |  |
  | 2077 |  | #: includes/classes/Admin/class-user-profile.php:~~605~~ |
  |  | 2396 | #: includes/classes/Admin/class-user-profile.php:592 |
  | 2078 | 2397 | msgid "Unlock user" |
  | 2079 | 2398 | msgstr "" |
  | 2080 | 2399 |  |
  | 2081 |  | #: includes/classes/Admin/class-user-profile.php:712 |
  | 2082 |  | msgid "No form" |
  | 2083 |  | msgstr "" |
  | 2084 |  |  |
  | 2085 |  | #: includes/classes/Admin/class-user-profile.php:735 |
  | 2086 |  | msgid "Invalid Two Factor Authentication code." |
  | 2087 |  | msgstr "" |
  | 2088 |  |  |
  | 2089 |  | #: includes/classes/Admin/class-user-profile.php:738 |
  |  | 2400 | #: includes/classes/Admin/class-user-profile.php:721 |
  | 2090 | 2401 | msgid "Invalid Two Factor Authentication secret key." |
  | 2091 | 2402 | msgstr "" |
  | 2092 | 2403 |  |
  | 2093 |  | #: includes/classes/Admin/class-user-profile.php:7~~44~~ |
  |  | 2404 | #: includes/classes/Admin/class-user-profile.php:727 |
  | 2094 | 2405 | msgid "Invalid Email Authentication code." |
  | 2095 | 2406 | msgstr "" |
  | 2096 | 2407 |  |
  | 2097 |  | #: includes/classes/Admin/class-user-profile.php:747 |
  | 2098 |  | msgid "Please enter the code to finalize the 2FA setup." |
  | 2099 |  | msgstr "" |
  | 2100 |  |  |
  | 2101 |  | #: includes/classes/Admin/class-user-profile.php:765 |
  |  | 2408 | #: includes/classes/Admin/class-user-profile.php:748 |
  | 2102 | 2409 | msgid "Error processing form" |
  | 2103 | 2410 | msgstr "" |
  | 2104 | 2411 |  |
  | 2105 |  | #: includes/classes/Admin/Controllers/class-methods.php:1~~13~~ |
  |  | 2412 | #: includes/classes/Admin/Controllers/class-methods.php:108 |
  | 2106 | 2413 | msgid "There are {available\_methods\_count} methods available to choose from for 2FA:" |
  | 2107 | 2414 | msgstr "" |
  | 2108 | 2415 |  |
  | 2109 |  | #: includes/classes/Admin/Controllers/class-settings.php:361 |
  | 2110 |  | msgid "TOTP (App)" |
  | 2111 |  | msgstr "" |
  | 2112 |  |  |
  | 2113 |  | #: includes/classes/Admin/Controllers/class-settings.php:362 |
  | 2114 |  | msgid "HOTP (Email)" |
  |  | 2416 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:193 |
  |  | 2417 | msgid "Unable to write to wp-config.php" |
  |  | 2418 | msgstr "" |
  |  | 2419 |  |
  |  | 2420 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:206 |
  |  | 2421 | msgid "wp-config.php successfully update, global setting deleted" |
  |  | 2422 | msgstr "" |
  |  | 2423 |  |
  |  | 2424 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:215 |
  |  | 2425 | msgid "Unable to find global secret key" |
  |  | 2426 | msgstr "" |
  |  | 2427 |  |
  |  | 2428 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:334 |
  |  | 2429 | msgid "Test email from WP 2FA" |
  |  | 2430 | msgstr "" |
  |  | 2431 |  |
  |  | 2432 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:335 |
  |  | 2433 | msgid "This email was sent by the WP 2FA plugin to test the email delivery." |
  |  | 2434 | msgstr "" |
  |  | 2435 |  |
  |  | 2436 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:376 |
  |  | 2437 | msgid "Your 2FA settings have been removed." |
  |  | 2438 | msgstr "" |
  |  | 2439 |  |
  |  | 2440 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:392 |
  |  | 2441 | msgid "User 2FA settings have been removed." |
  |  | 2442 | msgstr "" |
  |  | 2443 |  |
  |  | 2444 | #: includes/classes/Admin/Helpers/class-ajax-helper.php:408 |
  |  | 2445 | msgid "User account successfully unlocked. User can login again." |
  |  | 2446 | msgstr "" |
  |  | 2447 |  |
  |  | 2448 | #: includes/classes/Admin/Helpers/class-file-writer.php:410 |
  |  | 2449 | msgid "The base of WSAL working directory cannot be determined. Custom path is invalid or there is some other issue with your WordPress installation." |
  |  | 2450 | msgstr "" |
  |  | 2451 |  |
  |  | 2452 | #. translators: %s: Directory path. |
  |  | 2453 | #: includes/classes/Admin/Helpers/class-file-writer.php:433 |
  |  | 2454 | msgid "Unable to create directory %s. Is its parent directory writable by the server?" |
  |  | 2455 | msgstr "" |
  |  | 2456 |  |
  |  | 2457 | #. translators: the name of the file. |
  |  | 2458 | #: includes/classes/Admin/Helpers/class-file-writer.php:464 |
  |  | 2459 | msgid "The file %s could not be removed as the unlink() function is disabled. This is a system configuration issue." |
  |  | 2460 | msgstr "" |
  |  | 2461 |  |
  |  | 2462 | #. translators: the name of the file. |
  |  | 2463 | #: includes/classes/Admin/Helpers/class-file-writer.php:480 |
  |  | 2464 | msgid "Unable to remove %s due to an unknown error." |
  | 2115 | 2465 | msgstr "" |
  | 2116 | 2466 |  |
  | 2117 | 2467 | #. translators: %s: count |
  | 2118 |  | #: includes/classes/Admin/Methods/class-backup-codes.php:~~157~~ |
  |  | 2468 | #: includes/classes/Admin/Methods/class-backup-codes.php:266 |
  | 2119 | 2469 | msgid "%s unused code remaining." |
  | 2120 | 2470 | msgid\_plural "%s unused codes remaining." |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2123) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2473) |  |
  | 2123 | 2473 |  |
  | 2124 | 2474 | #. translators: %s: the site's domain |
  | 2125 |  | #: includes/classes/Admin/Methods/class-backup-codes.php:~~162~~ |
  |  | 2475 | #: includes/classes/Admin/Methods/class-backup-codes.php:271 |
  | 2126 | 2476 | msgid "Two-Factor Backup Codes for %s" |
  | 2127 | 2477 | msgstr "" |
  | 2128 | 2478 |  |
  | 2129 | 2479 | #. translators: URL with more information about the backup codes |
  | 2130 |  | #: includes/classes/Admin/Methods/class-backup-codes.php:~~248~~ |
  |  | 2480 | #: includes/classes/Admin/Methods/class-backup-codes.php:363 |
  | 2131 | 2481 | msgid "Login with a backup code: you will get 10 backup codes and you can use one of them when you need to login and you cannot generate a code from the app. %s" |
  | 2132 | 2482 | msgstr "" |
  | 2133 | 2483 |  |
  | 2134 |  | #: includes/classes/Admin/Methods/class-backup-codes.php:~~249~~ |
  |  | 2484 | #: includes/classes/Admin/Methods/class-backup-codes.php:364 |
  | 2135 | 2485 | msgid "More information." |
  | 2136 | 2486 | msgstr "" |
  | 2137 | 2487 |  |
  | 2138 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:42 |
  |  | 2488 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:183 |
  |  | 2489 | msgid "One-time code via email (HOTP)" |
  |  | 2490 | msgstr "" |
  |  | 2491 |  |
  |  | 2492 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:184 |
  |  | 2493 | msgid " - ensure email deliverability with the free plugin " |
  |  | 2494 | msgstr "" |
  |  | 2495 |  |
  |  | 2496 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:190 |
  |  | 2497 | msgid "When using this method, users will receive the one-time login code over email. Therefore, email deliverability is very important. Users using this method should whitelist the address from which the codes are sent. By default, this is the email address configured in your WordPress. You can run an email test from the plugin's settings to confirm email deliverability. If you have had email deliverability / reliability issues, we highly recommend you to install the free plugin " |
  |  | 2498 | msgstr "" |
  |  | 2499 |  |
  |  | 2500 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:190 |
  |  | 2501 | msgid "Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone." |
  |  | 2502 | msgstr "" |
  |  | 2503 |  |
  |  | 2504 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:301 |
  |  | 2505 | msgid "To complete the 2FA configuration you will be sent a one-time code over email, therefore you should have access to the mailbox of this email address. If you do not receive the email with the one-time code please check your spam folder and contact your administrator." |
  |  | 2506 | msgstr "" |
  |  | 2507 |  |
  |  | 2508 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:313 |
  |  | 2509 | msgid "IMPORTANT: " |
  |  | 2510 | msgstr "" |
  |  | 2511 |  |
  |  | 2512 | #: includes/classes/Admin/Methods/class-email-wizard-steps.php:314 |
  |  | 2513 | msgid "To ensure you always receive the one-time code whitelist the email address from which the codes are sent. This is " |
  |  | 2514 | msgstr "" |
  |  | 2515 |  |
  |  | 2516 | #: includes/classes/Admin/Methods/class-email.php:110 |
  |  | 2517 | msgid "HOTP (Email)" |
  |  | 2518 | msgstr "" |
  |  | 2519 |  |
  |  | 2520 | #: includes/classes/Admin/Methods/class-email.php:142 |
  |  | 2521 | msgid "Setting up HOTP" |
  |  | 2522 | msgstr "" |
  |  | 2523 |  |
  |  | 2524 | #: includes/classes/Admin/Methods/class-email.php:142 |
  |  | 2525 | #: includes/classes/Admin/Methods/class-email.php:144 |
  |  | 2526 | msgid "Please select the email address where the one-time code should be sent:" |
  |  | 2527 | msgstr "" |
  |  | 2528 |  |
  |  | 2529 | #: includes/classes/Admin/Methods/class-email.php:143 |
  |  | 2530 | #: includes/classes/Admin/Methods/class-totp.php:328 |
  |  | 2531 | #: includes/classes/class-wp2fa.php:124 |
  |  | 2532 | #: includes/classes/class-wp2fa.php:125 |
  |  | 2533 | #: includes/classes/class-wp2fa.php:126 |
  |  | 2534 | msgid "Almost there…" |
  |  | 2535 | msgstr "" |
  |  | 2536 |  |
  |  | 2537 | #: includes/classes/Admin/Methods/class-email.php:143 |
  |  | 2538 | msgid "Please type in the one-time code sent to your email address to finalize the setup" |
  |  | 2539 | msgstr "" |
  |  | 2540 |  |
  |  | 2541 | #: includes/classes/Admin/Methods/class-email.php:144 |
  |  | 2542 | msgid "{reconfigure\_or\_configure\_capitalized} one-time code over email method" |
  |  | 2543 | msgstr "" |
  |  | 2544 |  |
  |  | 2545 | #: includes/classes/Admin/Methods/class-email.php:145 |
  |  | 2546 | msgid "One-time code via email" |
  |  | 2547 | msgstr "" |
  |  | 2548 |  |
  |  | 2549 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:97 |
  |  | 2550 | msgid "Reset Key" |
  |  | 2551 | msgstr "" |
  |  | 2552 |  |
  |  | 2553 | #. translators: link to the knowledge base website |
  |  | 2554 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:135 |
  |  | 2555 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:350 |
  |  | 2556 | msgid "Refer to the %s for more information on how to setup these apps and which apps are supported." |
  |  | 2557 | msgstr "" |
  |  | 2558 |  |
  |  | 2559 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:136 |
  |  | 2560 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:342 |
  |  | 2561 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:351 |
  |  | 2562 | msgid "guide on how to set up 2FA apps" |
  |  | 2563 | msgstr "" |
  |  | 2564 |  |
  |  | 2565 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:253 |
  |  | 2566 | msgid "Click on the icon of the app that you are using for a detailed guide on how to set it up." |
  |  | 2567 | msgstr "" |
  |  | 2568 |  |
  |  | 2569 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:334 |
  |  | 2570 | msgid "One-time code via 2FA App (TOTP) - " |
  |  | 2571 | msgstr "" |
  |  | 2572 |  |
  |  | 2573 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:334 |
  |  | 2574 | msgid "complete list of supported 2FA apps." |
  |  | 2575 | msgstr "" |
  |  | 2576 |  |
  |  | 2577 | #. translators: link to the knowledge base website |
  |  | 2578 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:341 |
  |  | 2579 | msgid "When using this method, users will need to configure a 2FA app to get the one-time login code. The plugin supports all standard 2FA apps. Refer to the %s for more information. Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone." |
  |  | 2580 | msgstr "" |
  |  | 2581 |  |
  |  | 2582 | #: includes/classes/Admin/Methods/class-totp-wizard-steps.php:385 |
  |  | 2583 | msgid "Authentication Code:" |
  |  | 2584 | msgstr "" |
  |  | 2585 |  |
  |  | 2586 | #: includes/classes/Admin/Methods/class-totp.php:126 |
  |  | 2587 | msgid "TOTP (App)" |
  |  | 2588 | msgstr "" |
  |  | 2589 |  |
  |  | 2590 | #: includes/classes/Admin/Methods/class-totp.php:324 |
  |  | 2591 | msgid "Setting up TOTP" |
  |  | 2592 | msgstr "" |
  |  | 2593 |  |
  |  | 2594 | #: includes/classes/Admin/Methods/class-totp.php:325 |
  |  | 2595 | msgid "Download and start the application of your choice" |
  |  | 2596 | msgstr "" |
  |  | 2597 |  |
  |  | 2598 | #: includes/classes/Admin/Methods/class-totp.php:326 |
  |  | 2599 | msgid "From within the application scan the QR code provided on the left. Otherwise, enter the following code manually in the application:" |
  |  | 2600 | msgstr "" |
  |  | 2601 |  |
  |  | 2602 | #: includes/classes/Admin/Methods/class-totp.php:327 |
  |  | 2603 | msgid "Click the \"I'm ready\" button below when you complete the application setup process to proceed with the wizard." |
  |  | 2604 | msgstr "" |
  |  | 2605 |  |
  |  | 2606 | #: includes/classes/Admin/Methods/class-totp.php:328 |
  |  | 2607 | msgid "Please type in the one-time code from your chosen authentication app to finalize the setup." |
  |  | 2608 | msgstr "" |
  |  | 2609 |  |
  |  | 2610 | #: includes/classes/Admin/Methods/class-totp.php:329 |
  |  | 2611 | msgid "{reconfigure\_or\_configure\_capitalized} the 2FA App" |
  |  | 2612 | msgstr "" |
  |  | 2613 |  |
  |  | 2614 | #: includes/classes/Admin/Methods/class-totp.php:329 |
  |  | 2615 | msgid "Click the below button to {reconfigure\_or\_configure} the current 2FA method. Note that once reset you will have to re-scan the QR code on all devices you want this to work on because the previous codes will stop working." |
  |  | 2616 | msgstr "" |
  |  | 2617 |  |
  |  | 2618 | #: includes/classes/Admin/Methods/class-totp.php:330 |
  |  | 2619 | msgid "One-time code via 2FA app" |
  |  | 2620 | msgstr "" |
  |  | 2621 |  |
  |  | 2622 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:43 |
  | 2139 | 2623 | msgid "Save email settings and templates" |
  | 2140 | 2624 | msgstr "" |
  | 2141 | 2625 |  |
  | 2142 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~99~~ |
  |  | 2626 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:100 |
  | 2143 | 2627 | msgid "Which email address should the plugin use as a from address?" |
  | 2144 | 2628 | msgstr "" |
  | 2145 | 2629 |  |
  | 2146 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:10~~1~~ |
  |  | 2630 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:102 |
  | 2147 | 2631 | msgid "Use these settings to customize the \"from\" name and email address for all correspondence sent from our plugin." |
  | 2148 | 2632 | msgstr "" |
  | 2149 | 2633 |  |
  | 2150 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:10~~6~~ |
  |  | 2634 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:107 |
  | 2151 | 2635 | msgid "From email & name" |
  | 2152 | 2636 | msgstr "" |
  | 2153 | 2637 |  |
  | 2154 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:11~~4~~ |
  |  | 2638 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:115 |
  | 2155 | 2639 | msgid "Use the email address from the WordPress general settings." |
  | 2156 | 2640 | msgstr "" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2161) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2645) |  |
  | 2161 | 2645 |  |
  | 2162 | 2646 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:126 |
  |  | 2647 | msgid "A 'From email' address with a domain different than that of your website domain name, or with a domain that the hosting does not relay might cause the notification emails to be blocked, marked as spam, or not delivered at all. If you are not 100% sure about this change, consult with your web host." |
  |  | 2648 | msgstr "" |
  |  | 2649 |  |
  |  | 2650 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:129 |
  | 2163 | 2651 | msgid "Email Address:" |
  | 2164 | 2652 | msgstr "" |
  | 2165 | 2653 |  |
  | 2166 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~27~~ |
  |  | 2654 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:130 |
  | 2167 | 2655 | msgid "Display Name:" |
  | 2168 | 2656 | msgstr "" |
  | 2169 | 2657 |  |
  | 2170 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:139 |
  |  | 2658 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:138 |
  |  | 2659 | msgid "Tip: The 'From email' address should match your website domain. If the \"from address\" does not match your website domain, the emails may be blocked or marked as spam. If you are not sure about this please consult with your website administrator / developer or " |
  |  | 2660 | msgstr "" |
  |  | 2661 |  |
  |  | 2662 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:138 |
  |  | 2663 | msgid "for more information." |
  |  | 2664 | msgstr "" |
  |  | 2665 |  |
  |  | 2666 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:142 |
  | 2171 | 2667 | msgid "Email delivery test" |
  | 2172 | 2668 | msgstr "" |
  | 2173 | 2669 |  |
  | 2174 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:14~~1~~ |
  |  | 2670 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:144 |
  | 2175 | 2671 | msgid "The plugin sends emails with one-time codes, blocked account notifications and more. Use the button below to confirm the plugin can successfully send emails." |
  | 2176 | 2672 | msgstr "" |
  | 2177 | 2673 |  |
  | 2178 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~48~~ |
  |  | 2674 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:151 |
  | 2179 | 2675 | msgid "Test email delivery" |
  | 2180 | 2676 | msgstr "" |
  | 2181 | 2677 |  |
  | 2182 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~69~~ |
  |  | 2678 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:172 |
  | 2183 | 2679 | msgid "User backup codes email" |
  | 2184 | 2680 | msgstr "" |
  | 2185 | 2681 |  |
  | 2186 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:17~~0~~ |
  |  | 2682 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:173 |
  | 2187 | 2683 | msgid "This email can be sent a user once backup codes are generated." |
  | 2188 | 2684 | msgstr "" |
  | 2189 | 2685 |  |
  | 2190 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:177 |
  |  | 2686 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:180 |
  |  | 2687 | msgid "2FA setup code email" |
  |  | 2688 | msgstr "" |
  |  | 2689 |  |
  |  | 2690 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:181 |
  |  | 2691 | msgid "This is the email sent to a user when setting up 2FA via email." |
  |  | 2692 | msgstr "" |
  |  | 2693 |  |
  |  | 2694 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:185 |
  | 2191 | 2695 | msgid "Login code email" |
  | 2192 | 2696 | msgstr "" |
  | 2193 | 2697 |  |
  | 2194 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~78~~ |
  |  | 2698 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:186 |
  | 2195 | 2699 | msgid "This is the email sent to a user when a login code is required." |
  | 2196 | 2700 | msgstr "" |
  | 2197 | 2701 |  |
  | 2198 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~82~~ |
  |  | 2702 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:190 |
  | 2199 | 2703 | msgid "User account locked email" |
  | 2200 | 2704 | msgstr "" |
  | 2201 | 2705 |  |
  | 2202 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~83~~ |
  |  | 2706 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:191 |
  | 2203 | 2707 | msgid "This is the email sent to a user upon grace period expiry." |
  | 2204 | 2708 | msgstr "" |
  | 2205 | 2709 |  |
  | 2206 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~87~~ |
  |  | 2710 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:195 |
  | 2207 | 2711 | msgid "User account unlocked email" |
  | 2208 | 2712 | msgstr "" |
  | 2209 | 2713 |  |
  | 2210 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:1~~88~~ |
  |  | 2714 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:196 |
  | 2211 | 2715 | msgid "This is the email sent to a user when the user's account has been unlocked." |
  | 2212 | 2716 | msgstr "" |
  | 2213 | 2717 |  |
  | 2214 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~192~~ |
  |  | 2718 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:200 |
  | 2215 | 2719 | msgid "User reset password code email" |
  | 2216 | 2720 | msgstr "" |
  | 2217 | 2721 |  |
  | 2218 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~193~~ |
  |  | 2722 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:201 |
  | 2219 | 2723 | msgid "This is the email sent to a user when a password reset is requested." |
  | 2220 | 2724 | msgstr "" |
  | 2221 | 2725 |  |
  | 2222 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:2~~5~~2 |
  |  | 2726 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:262 |
  | 2223 | 2727 | msgid "Please provide an email address" |
  | 2224 | 2728 | msgstr "" |
  | 2225 | 2729 |  |
  | 2226 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:2~~6~~2 |
  |  | 2730 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:272 |
  | 2227 | 2731 | msgid "Please provide a display name." |
  | 2228 | 2732 | msgstr "" |
  | 2229 | 2733 |  |
  | 2230 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:2~~7~~3 |
  |  | 2734 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:283 |
  | 2231 | 2735 | msgid "Please provide a valid email address. Your email address has not been updated." |
  | 2232 | 2736 | msgstr "" |
  | 2233 | 2737 |  |
  | 2234 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~287~~ |
  |  | 2738 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:303 |
  | 2235 | 2739 | msgid "Please only use alphanumeric text. Your display name has not been updated." |
  | 2236 | 2740 | msgstr "" |
  | 2237 | 2741 |  |
  | 2238 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~376~~ |
  |  | 2742 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:413 |
  | 2239 | 2743 | msgid "Email Templates" |
  | 2240 | 2744 | msgstr "" |
  | 2241 | 2745 |  |
  | 2242 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~385~~ |
  |  | 2746 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:422 |
  | 2243 | 2747 | msgid "Send this email" |
  | 2244 | 2748 | msgstr "" |
  | 2245 | 2749 |  |
  | 2246 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~391~~ |
  |  | 2750 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:428 |
  | 2247 | 2751 | msgid "Uncheck to disable this message." |
  | 2248 | 2752 | msgstr "" |
  | 2249 | 2753 |  |
  | 2250 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:~~398~~ |
  |  | 2754 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:435 |
  | 2251 | 2755 | msgid "Email subject" |
  | 2252 | 2756 | msgstr "" |
  | 2253 | 2757 |  |
  | 2254 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:4~~07~~ |
  |  | 2758 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:444 |
  | 2255 | 2759 | msgid "Email body" |
  | 2256 | 2760 | msgstr "" |
  | 2257 | 2761 |  |
  | 2258 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:4~~47~~ |
  |  | 2762 | #: includes/classes/Admin/SettingsPages/class-settings-page-email.php:485 |
  | 2259 | 2763 | msgid "Send test email" |
  | 2260 | 2764 | msgstr "" |
  | 2261 | 2765 |  |
  | 2262 | 2766 | #: includes/classes/Admin/SettingsPages/class-settings-page-general.php:182 |
  | 2263 |  | msgid "Do you want to delete the plugin data from the database upon uninstall~~?~~" |
  |  | 2767 | msgid "Do you want to delete the plugin data from the database upon uninstall" |
  | 2264 | 2768 | msgstr "" |
  | 2265 | 2769 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2277) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2781) |  |
  | 2277 | 2781 |  |
  | 2278 | 2782 | #: includes/classes/Admin/SettingsPages/class-settings-page-general.php:220 |
  | 2279 |  | msgid "Limit 2FA settings access~~?~~" |
  |  | 2783 | msgid "Limit 2FA settings access" |
  | 2280 | 2784 | msgstr "" |
  | 2281 | 2785 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2293) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2797) |  |
  | 2293 | 2797 |  |
  | 2294 | 2798 | #: includes/classes/Admin/SettingsPages/class-settings-page-general.php:252 |
  | 2295 |  | msgid "Disable 2FA code brute force protection~~?~~" |
  |  | 2799 | msgid "Disable 2FA code brute force protection" |
  | 2296 | 2800 | msgstr "" |
  | 2297 | 2801 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2304) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2808) |  |
  | 2304 | 2808 | msgstr "" |
  | 2305 | 2809 |  |
  |  | 2810 | #. translators: support email. |
  |  | 2811 | #: includes/classes/Admin/SettingsPages/class-settings-page-general.php:286 |
  |  | 2812 | msgid "Use this setting below to configure the properties of the two-factor authentication on your website and how users use it. If you have any questions send us an email at %1$s." |
  |  | 2813 | msgstr "" |
  |  | 2814 |  |
  | 2306 | 2815 | #: includes/classes/Admin/SettingsPages/class-settings-page-general.php:291 |
  | 2307 |  | msgid "What should the plugin do if the 2FA method used during a user login is unavailable~~?~~" |
  |  | 2816 | msgid "What should the plugin do if the 2FA method used during a user login is unavailable" |
  | 2308 | 2817 | msgstr "" |
  | 2309 | 2818 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2324) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2833) |  |
  | 2324 | 2833 | msgstr "" |
  | 2325 | 2834 |  |
  | 2326 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:7~~6~~ |
  |  | 2835 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:78 |
  | 2327 | 2836 | msgid "Exclude yourself?" |
  | 2328 | 2837 | msgstr "" |
  | 2329 | 2838 |  |
  | 2330 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:7~~7~~ |
  |  | 2839 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:79 |
  | 2331 | 2840 | msgid "You are about to enforce 2FA instantly on all users, including yourself, however you have not yet configured your own 2FA method. What would you like to do?" |
  | 2332 | 2841 | msgstr "" |
  | 2333 | 2842 |  |
  | 2334 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:8~~4~~ |
  |  | 2843 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:86 |
  | 2335 | 2844 | msgid "Continue anyway" |
  | 2336 | 2845 | msgstr "" |
  | 2337 | 2846 |  |
  | 2338 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:8~~5~~ |
  |  | 2847 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:87 |
  | 2339 | 2848 | msgid "Exclude myself from 2FA policies" |
  | 2340 | 2849 | msgstr "" |
  | 2341 | 2850 |  |
  | 2342 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:18~~6~~ |
  |  | 2851 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:188 |
  | 2343 | 2852 | msgid "The plugin created the 2FA settings page with the URL:" |
  | 2344 | 2853 | msgstr "" |
  | 2345 | 2854 |  |
  | 2346 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:1~~88~~ |
  |  | 2855 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:190 |
  | 2347 | 2856 | msgid "You can edit this page using the page editor, like you do with all other pages." |
  | 2348 | 2857 | msgstr "" |
  | 2349 | 2858 |  |
  | 2350 | 2859 | #. translators: %s: tag name. |
  | 2351 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:19~~2~~ |
  |  | 2860 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:194 |
  | 2352 | 2861 | msgid "Use the %s html tag in the email templates to include the URL of the 2FA configuration page when notifying the users to configure two-factor authentication." |
  | 2353 | 2862 | msgstr "" |
  | 2354 | 2863 |  |
  | 2355 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:202 |
  | 2356 |  | msgid "OK" |
  | 2357 |  | msgstr "" |
  | 2358 |  |  |
  | 2359 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:251 |
  |  | 2864 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:253 |
  | 2360 | 2865 | msgid "No global 2FA methods enabled." |
  | 2361 | 2866 | msgstr "" |
  | 2362 | 2867 |  |
  | 2363 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:3~~48~~ |
  |  | 2868 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:335 |
  | 2364 | 2869 | msgid "You must specify at least one sub-site" |
  | 2365 | 2870 | msgstr "" |
  | 2366 | 2871 |  |
  | 2367 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:3~~68~~ |
  |  | 2872 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:355 |
  | 2368 | 2873 | msgid "Grace period must be at least 1 day/hour" |
  | 2369 | 2874 | msgstr "" |
  | 2370 | 2875 |  |
  | 2371 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:4~~39~~ |
  |  | 2876 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:417 |
  | 2372 | 2877 | msgid "You must provide a new page slug." |
  | 2373 | 2878 | msgstr "" |
  | 2374 | 2879 |  |
  | 2375 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:4~~69~~ |
  |  | 2880 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:447 |
  | 2376 | 2881 | msgid "You must specify at least one role or user" |
  | 2377 | 2882 | msgstr "" |
  | 2378 | 2883 |  |
  | 2379 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:~~600~~ |
  |  | 2884 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:598 |
  | 2380 | 2885 | msgid "Page generated by" |
  | 2381 | 2886 | msgstr "" |
  | 2382 | 2887 |  |
  | 2383 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:~~601~~ |
  |  | 2888 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:599 |
  | 2384 | 2889 | msgid "WP 2FA Plugin" |
  |  | 2890 | msgstr "" |
  |  | 2891 |  |
  |  | 2892 | #: includes/classes/Admin/SettingsPages/class-settings-page-policies.php:808 |
  |  | 2893 | msgid "Do you want to redirect the user to a specific page after completing the 2FA setup wizard" |
  | 2385 | 2894 | msgstr "" |
  | 2386 | 2895 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2401) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L2910) |  |
  | 2401 | 2910 | msgstr "" |
  | 2402 | 2911 |  |
  | 2403 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:1~~32~~ |
  |  | 2912 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:168 |
  | 2404 | 2913 | msgid "Markup is not allowed in Login area CSS." |
  | 2405 | 2914 | msgstr "" |
  | 2406 | 2915 |  |
  | 2407 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:271 |
  | 2408 |  | msgid "Change the default text used in the 2FA code page?" |
  | 2409 |  | msgstr "" |
  | 2410 |  |  |
  | 2411 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:273 |
  |  | 2916 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:282 |
  |  | 2917 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:367 |
  |  | 2918 | msgid "2FA code page text" |
  |  | 2919 | msgstr "" |
  |  | 2920 |  |
  |  | 2921 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:284 |
  |  | 2922 | msgid "Use these settings to customize message shown to users upon login when a 2FA verification code is requested." |
  |  | 2923 | msgstr "" |
  |  | 2924 |  |
  |  | 2925 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:289 |
  |  | 2926 | msgid "Customize code page text" |
  |  | 2927 | msgstr "" |
  |  | 2928 |  |
  |  | 2929 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:297 |
  |  | 2930 | msgid "Show this generic message to all users regardless of the 2FA method they are using." |
  |  | 2931 | msgstr "" |
  |  | 2932 |  |
  |  | 2933 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:305 |
  |  | 2934 | msgid "Show a message that is specific to the method that the user is using." |
  |  | 2935 | msgstr "" |
  |  | 2936 |  |
  |  | 2937 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:310 |
  |  | 2938 | msgid "2FA via app" |
  |  | 2939 | msgstr "" |
  |  | 2940 |  |
  |  | 2941 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:322 |
  |  | 2942 | msgid "2FA link over email" |
  |  | 2943 | msgstr "" |
  |  | 2944 |  |
  |  | 2945 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:328 |
  |  | 2946 | msgid "2FA code over SMS" |
  |  | 2947 | msgstr "" |
  |  | 2948 |  |
  |  | 2949 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:334 |
  |  | 2950 | msgid "2FA with Push Notification - Intro" |
  |  | 2951 | msgstr "" |
  |  | 2952 |  |
  |  | 2953 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:340 |
  |  | 2954 | msgid "2FA with Push Notification - Awaiting Response" |
  |  | 2955 | msgstr "" |
  |  | 2956 |  |
  |  | 2957 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:346 |
  |  | 2958 | msgid "2FA with Push Notification" |
  |  | 2959 | msgstr "" |
  |  | 2960 |  |
  |  | 2961 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:359 |
  |  | 2962 | msgid "Change the default text used in the 2FA code page" |
  |  | 2963 | msgstr "" |
  |  | 2964 |  |
  |  | 2965 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:361 |
  | 2412 | 2966 | msgid "This is the text shown to the users on the page when they are asked to enter the 2FA code. To change the default text, simply type it in the below placeholder." |
  | 2413 | 2967 | msgstr "" |
  | 2414 | 2968 |  |
  | 2415 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:279 |
  | 2416 |  | msgid "2FA code page text" |
  | 2417 |  | msgstr "" |
  | 2418 |  |  |
  | 2419 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:290 |
  |  | 2969 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:379 |
  | 2420 | 2970 | msgid "Backup code page text" |
  | 2421 | 2971 | msgstr "" |
  | 2422 | 2972 |  |
  | 2423 |  | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:3~~0~~2 |
  |  | 2973 | #: includes/classes/Admin/SettingsPages/class-settings-page-white-label.php:392 |
  | 2424 | 2974 | msgid "Text for logged out users trying to access the 2FA configuration page" |
  | 2425 | 2975 | msgstr "" |
  | 2426 | 2976 |  |
  | 2427 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:4~~1~~ |
  |  | 2977 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:44 |
  | 2428 | 2978 | msgid "Which 2FA methods can your users use?" |
  | 2429 | 2979 | msgstr "" |
  | 2430 | 2980 |  |
  | 2431 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:4~~3~~ |
  |  | 2981 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:46 |
  | 2432 | 2982 | msgid "When you uncheck any of the below 2FA methods it won't be available for your users to use. You can always change this later on from the plugin's settings." |
  | 2433 | 2983 | msgstr "" |
  | 2434 | 2984 |  |
  | 2435 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:5~~5~~ |
  |  | 2985 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:58 |
  | 2436 | 2986 | msgid "Select the methods" |
  | 2437 | 2987 | msgstr "" |
  | 2438 | 2988 |  |
  | 2439 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:66 |
  | 2440 |  | msgid "One-time code via 2FA App (TOTP)" |
  | 2441 |  | msgstr "" |
  | 2442 |  |  |
  | 2443 |  | #. translators: link to the knowledge base website |
  | 2444 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:74 |
  | 2445 |  | msgid "When using this method, users will need to configure a 2FA app to get the one-time login code. The plugin supports all standard 2FA apps. Refer to the %s for more information. Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone." |
  | 2446 |  | msgstr "" |
  | 2447 |  |  |
  | 2448 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:108 |
  | 2449 |  | msgid "When using this method, users will receive the one-time login code over email. Therefore, email deliverability is very important. Users using this method should whitelist the address from which the codes are sent. By default, this is the email address configured in your WordPress. You can run an email test from the plugin's settings to confirm email deliverability. If you have had email deliverability / reliability issues, we highly recommend you to install the free plugin " |
  | 2450 |  | msgstr "" |
  | 2451 |  |  |
  | 2452 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:108 |
  | 2453 |  | msgid "Allowing users to set up a secondary 2FA method is highly recommended. You can do this in the next step of the wizard. This will allow users to log in using an alternative method should they, for example lose access to their phone." |
  | 2454 |  | msgstr "" |
  | 2455 |  |  |
  | 2456 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:224 |
  |  | 2989 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:156 |
  | 2457 | 2990 | msgid "Which alternative 2FA methods can users use?" |
  | 2458 | 2991 | msgstr "" |
  | 2459 | 2992 |  |
  | 2460 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~226~~ |
  |  | 2993 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:158 |
  | 2461 | 2994 | msgid "An alternative 2FA method allows users to configure another 2FA method that can be used as a backup should the primary 2FA method fail. This can happen if, for example, a user forgets their smartphone, the smartphone runs out of battery, or there are email deliverability problems." |
  | 2462 | 2995 | msgstr "" |
  | 2463 | 2996 |  |
  | 2464 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~229~~ |
  |  | 2997 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:161 |
  | 2465 | 2998 | msgid "It is highly recommended to have an alternative 2FA method configured at all times. Below is a list of alternative 2FA methods available through this plugin:" |
  | 2466 | 2999 | msgstr "" |
  | 2467 | 3000 |  |
  | 2468 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~246~~ |
  |  | 3001 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:178 |
  | 2469 | 3002 | msgid "Backup codes allow users to log in to WordPress should they find themselves unable to log in via the primary 2FA method. Backup codes are enabled by default and are generated during the 2FA configuration process. Each backup code can be used only once. Once the initial list is exhausted, more backup codes can be generated through the user’s WordPress profile page - " |
  | 2470 | 3003 | msgstr "" |
  | 2471 | 3004 |  |
  | 2472 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~247~~ |
  |  | 3005 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:179 |
  | 2473 | 3006 | msgid "More information" |
  | 2474 | 3007 | msgstr "" |
  | 2475 | 3008 |  |
  | 2476 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~256~~ |
  |  | 3009 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:188 |
  | 2477 | 3010 | msgid "Upgrade to WP 2FA Premium for" |
  | 2478 | 3011 | msgstr "" |
  | 2479 | 3012 |  |
  | 2480 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~257~~ |
  |  | 3013 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:189 |
  | 2481 | 3014 | msgid "more alternative 2FA methods" |
  | 2482 | 3015 | msgstr "" |
  | 2483 | 3016 |  |
  | 2484 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~258~~ |
  |  | 3017 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:190 |
  | 2485 | 3018 | msgid "to give your users more options." |
  | 2486 | 3019 | msgstr "" |
  | 2487 | 3020 |  |
  | 2488 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:2~~83~~ |
  |  | 3021 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:215 |
  | 2489 | 3022 | msgid "Do you want to enforce 2FA for some, or all the users? " |
  | 2490 | 3023 | msgstr "" |
  | 2491 | 3024 |  |
  | 2492 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:2~~85~~ |
  |  | 3025 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:217 |
  | 2493 | 3026 | msgid "When you enforce 2FA the users will be prompted to configure 2FA the next time they login. Users have a grace period for configuring 2FA. You can configure the grace period and also exclude user(s) or role(s) in this settings page. " |
  | 2494 | 3027 | msgstr "" |
  | 2495 | 3028 |  |
  | 2496 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:2~~93~~ |
  |  | 3029 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:225 |
  | 2497 | 3030 | msgid "Enforce 2FA on" |
  | 2498 | 3031 | msgstr "" |
  | 2499 | 3032 |  |
  | 2500 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~301~~ |
  |  | 3033 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:233 |
  | 2501 | 3034 | msgid "All users" |
  | 2502 | 3035 | msgstr "" |
  | 2503 | 3036 |  |
  | 2504 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~308~~ |
  |  | 3037 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:240 |
  | 2505 | 3038 | msgid "Only super admins" |
  | 2506 | 3039 | msgstr "" |
  | 2507 | 3040 |  |
  | 2508 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~313~~ |
  |  | 3041 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:245 |
  | 2509 | 3042 | msgid "Only super admins and site admins" |
  | 2510 | 3043 | msgstr "" |
  | 2511 | 3044 |  |
  | 2512 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~322~~ |
  |  | 3045 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:254 |
  | 2513 | 3046 | msgid "Only for specific users and roles" |
  | 2514 | 3047 | msgstr "" |
  | 2515 | 3048 |  |
  | 2516 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~327~~ |
  |  | 3049 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:259 |
  | 2517 | 3050 | msgid "Users :" |
  | 2518 | 3051 | msgstr "" |
  | 2519 | 3052 |  |
  | 2520 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~343~~ |
  |  | 3053 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:275 |
  | 2521 | 3054 | msgid "Roles :" |
  | 2522 | 3055 | msgstr "" |
  | 2523 | 3056 |  |
  | 2524 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~365~~ |
  |  | 3057 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:297 |
  | 2525 | 3058 | msgid "Also enforce 2FA on network users with super admin privileges" |
  | 2526 | 3059 | msgstr "" |
  | 2527 | 3060 |  |
  | 2528 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:3~~75~~ |
  |  | 3061 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:307 |
  | 2529 | 3062 | msgid "These sub-sites" |
  | 2530 | 3063 | msgstr "" |
  | 2531 | 3064 |  |
  |  | 3065 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:311 |
  |  | 3066 | msgid "Sites :" |
  |  | 3067 | msgstr "" |
  |  | 3068 |  |
  |  | 3069 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:339 |
  |  | 3070 | msgid "Do not enforce on any users" |
  |  | 3071 | msgstr "" |
  |  | 3072 |  |
  |  | 3073 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:366 |
  |  | 3074 | msgid "Do you want to exclude any users or roles from 2FA? " |
  |  | 3075 | msgstr "" |
  |  | 3076 |  |
  |  | 3077 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:368 |
  |  | 3078 | msgid "If you are enforcing 2FA on all users but for some reason you would like to exclude individual user(s) or users with a specific role, you can exclude them below" |
  |  | 3079 | msgstr "" |
  |  | 3080 |  |
  |  | 3081 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:376 |
  | 2532 | 3082 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:379 |
  | 2533 |  | ~~msgid "Sites :"~~ |
  | 2534 |  | ~~msgstr ""~~ |
  | 2535 |  |  |
  | 2536 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:407~~ |
  | 2537 |  | ~~msgid "Do not enforce on any users"~~ |
  | 2538 |  | ~~msgstr ""~~ |
  | 2539 |  |  |
  | 2540 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:434~~ |
  | 2541 |  | ~~msgid "Do you want to exclude any users or roles from 2FA? "~~ |
  | 2542 |  | ~~msgstr ""~~ |
  | 2543 |  |  |
  | 2544 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:436~~ |
  | 2545 |  | ~~msgid "If you are enforcing 2FA on all users but for some reason you would like to exclude individual user(s) or users with a specific role, you can exclude them below"~~ |
  | 2546 |  | ~~msgstr ""~~ |
  | 2547 |  |  |
  | 2548 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:444~~ |
  | 2549 |  | ~~#: includes/classes/Admin/Views/class-first-time-wizard-steps.php:447~~ |
  | 2550 | 3083 | msgid "Exclude the following users" |
  | 2551 | 3084 | msgstr "" |
  | 2552 | 3085 |  |
  | 2553 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:4~~69~~ |
  | 2554 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:4~~74~~ |
  |  | 3086 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:401 |
  |  | 3087 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:406 |
  | 2555 | 3088 | msgid "Exclude the following roles" |
  | 2556 | 3089 | msgstr "" |
  | 2557 | 3090 |  |
  | 2558 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:4~~96~~ |
  |  | 3091 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:428 |
  | 2559 | 3092 | msgid "Also exclude users with super admin privilege" |
  | 2560 | 3093 | msgstr "" |
  | 2561 | 3094 |  |
  | 2562 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~522~~ |
  |  | 3095 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:454 |
  | 2563 | 3096 | msgid "Do you want to exclude all the users of a site from 2FA? " |
  | 2564 | 3097 | msgstr "" |
  | 2565 | 3098 |  |
  | 2566 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~524~~ |
  |  | 3099 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:456 |
  | 2567 | 3100 | msgid "If you are enforcing 2FA on all users but for some reason you do not want to enforce it on a specific sub site, specify the sub site name below:" |
  | 2568 | 3101 | msgstr "" |
  | 2569 | 3102 |  |
  | 2570 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~532~~ |
  | 2571 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~541~~ |
  |  | 3103 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:464 |
  |  | 3104 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:473 |
  | 2572 | 3105 | msgid "Exclude the following sites" |
  | 2573 | 3106 | msgstr "" |
  | 2574 | 3107 |  |
  | 2575 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~654~~ |
  |  | 3108 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:586 |
  | 2576 | 3109 | msgid "Seconds" |
  | 2577 | 3110 | msgstr "" |
  | 2578 | 3111 |  |
  | 2579 |  | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:~~666~~ |
  |  | 3112 | #: includes/classes/Admin/Views/class-first-time-wizard-steps.php:598 |
  | 2580 | 3113 | msgid "Note: If users do not configure it within the configured stipulated time, their account will be locked and have to be unlocked manually." |
  | 2581 | 3114 | msgstr "" |
  | 2582 | 3115 |  |
  |  | 3116 | #: includes/classes/Admin/Views/class-grace-period-notifications.php:71 |
  |  | 3117 | msgid "How do you want users to be informed they are enforced to setup 2FA?" |
  |  | 3118 | msgstr "" |
  |  | 3119 |  |
  |  | 3120 | #: includes/classes/Admin/Views/class-grace-period-notifications.php:79 |
  |  | 3121 | msgid "Show an admin notice in the dashboard" |
  |  | 3122 | msgstr "" |
  |  | 3123 |  |
  |  | 3124 | #: includes/classes/Admin/Views/class-grace-period-notifications.php:89 |
  |  | 3125 | msgid "Show a notification on a page on its own after the user authenticates and before accessing the dashboard" |
  |  | 3126 | msgstr "" |
  |  | 3127 |  |
  |  | 3128 | #: includes/classes/Admin/Views/class-passord-reset-2fa.php:75 |
  |  | 3129 | msgid "Require 2FA on password reset" |
  |  | 3130 | msgstr "" |
  |  | 3131 |  |
  | 2583 | 3132 | #: includes/classes/Admin/Views/class-passord-reset-2fa.php:132 |
  | 2584 |  | msgid "Do you want to require 2FA when users reset their password~~?~~" |
  |  | 3133 | msgid "Do you want to require 2FA when users reset their password" |
  | 2585 | 3134 | msgstr "" |
  | 2586 | 3135 |  |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L2593) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L3142) |  |
  | 2593 | 3142 | msgstr "" |
  | 2594 | 3143 |  |
  | 2595 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~107~~ |
  | 2596 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~108~~ |
  |  | 3144 | #: includes/classes/Admin/Views/class-wizard-steps.php:90 |
  |  | 3145 | #: includes/classes/Admin/Views/class-wizard-steps.php:91 |
  | 2597 | 3146 | msgid "Next" |
  | 2598 | 3147 | msgstr "" |
  | 2599 | 3148 |  |
  | 2600 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:1~~28~~ |
  |  | 3149 | #: includes/classes/Admin/Views/class-wizard-steps.php:111 |
  | 2601 | 3150 | msgid "Let us help you get started" |
  | 2602 | 3151 | msgstr "" |
  | 2603 | 3152 |  |
  | 2604 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:1~~29~~ |
  |  | 3153 | #: includes/classes/Admin/Views/class-wizard-steps.php:112 |
  | 2605 | 3154 | msgid "Thank you for installing the WP 2FA plugin. This quick wizard will assist you with configuring the plugin and the two-factor authentication (2FA) settings for your user and the users on this website." |
  | 2606 | 3155 | msgstr "" |
  | 2607 | 3156 |  |
  | 2608 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:1~~34~~ |
  |  | 3157 | #: includes/classes/Admin/Views/class-wizard-steps.php:117 |
  | 2609 | 3158 | msgid "Let’s get started!" |
  | 2610 | 3159 | msgstr "" |
  | 2611 | 3160 |  |
  | 2612 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:1~~38~~ |
  |  | 3161 | #: includes/classes/Admin/Views/class-wizard-steps.php:121 |
  | 2613 | 3162 | msgid "Skip Wizard - I know how to do this" |
  | 2614 | 3163 | msgstr "" |
  | 2615 | 3164 |  |
  | 2616 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:157 |
  | 2617 |  | msgid "One-time code via 2FA app" |
  | 2618 |  | msgstr "" |
  | 2619 |  |  |
  | 2620 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:186 |
  | 2621 |  | msgid "One-time code via email" |
  | 2622 |  | msgstr "" |
  | 2623 |  |  |
  | 2624 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:213 |
  | 2625 |  | msgid "Reset Key" |
  | 2626 |  | msgstr "" |
  | 2627 |  |  |
  | 2628 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:314 |
  | 2629 |  | msgid "COPY" |
  | 2630 |  | msgstr "" |
  | 2631 |  |  |
  | 2632 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:327 |
  | 2633 |  | msgid "Click on the icon of the app that you are using for a detailed guide on how to set it up." |
  | 2634 |  | msgstr "" |
  | 2635 |  |  |
  | 2636 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:408 |
  | 2637 |  | msgid "To complete the 2FA configuration you will be sent a one-time code over email, therefore you should have access to the mailbox of this email address. If you do not receive the email with the one-time code please check your spam folder and contact your administrator." |
  | 2638 |  | msgstr "" |
  | 2639 |  |  |
  | 2640 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:420 |
  | 2641 |  | msgid "IMPORTANT: " |
  | 2642 |  | msgstr "" |
  | 2643 |  |  |
  | 2644 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:421 |
  | 2645 |  | msgid "To ensure you always receive the one-time code whitelist the email address from which the codes are sent. This is " |
  | 2646 |  | msgstr "" |
  | 2647 |  |  |
  | 2648 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:488 |
  | 2649 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:540 |
  |  | 3165 | #: includes/classes/Admin/Views/class-wizard-steps.php:154 |
  |  | 3166 | #: includes/classes/Admin/Views/class-wizard-steps.php:204 |
  | 2650 | 3167 | msgid "Generate backup codes" |
  | 2651 | 3168 | msgstr "" |
  | 2652 | 3169 |  |
  | 2653 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~489~~ |
  | 2654 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~541~~ |
  | 2655 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~568~~ |
  | 2656 |  | #: includes/classes/class-wp2fa.php:13~~4~~ |
  |  | 3170 | #: includes/classes/Admin/Views/class-wizard-steps.php:155 |
  |  | 3171 | #: includes/classes/Admin/Views/class-wizard-steps.php:205 |
  |  | 3172 | #: includes/classes/Admin/Views/class-wizard-steps.php:237 |
  |  | 3173 | #: includes/classes/class-wp2fa.php:130 |
  | 2657 | 3174 | msgid "Generate list of backup codes" |
  | 2658 | 3175 | msgstr "" |
  | 2659 | 3176 |  |
  | 2660 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~495~~ |
  | 2661 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~500~~ |
  | 2662 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~501~~ |
  | 2663 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~543~~ |
  | 2664 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~544~~ |
  |  | 3177 | #: includes/classes/Admin/Views/class-wizard-steps.php:161 |
  |  | 3178 | #: includes/classes/Admin/Views/class-wizard-steps.php:166 |
  |  | 3179 | #: includes/classes/Admin/Views/class-wizard-steps.php:167 |
  |  | 3180 | #: includes/classes/Admin/Views/class-wizard-steps.php:207 |
  |  | 3181 | #: includes/classes/Admin/Views/class-wizard-steps.php:208 |
  | 2665 | 3182 | msgid "I’ll generate them later" |
  | 2666 | 3183 | msgstr "" |
  | 2667 | 3184 |  |
  | 2668 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~535~~ |
  |  | 3185 | #: includes/classes/Admin/Views/class-wizard-steps.php:199 |
  | 2669 | 3186 | msgid "Generate codes" |
  | 2670 | 3187 | msgstr "" |
  | 2671 | 3188 |  |
  | 2672 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~560~~ |
  |  | 3189 | #: includes/classes/Admin/Views/class-wizard-steps.php:224 |
  | 2673 | 3190 | msgid "Backup 2FA methods:" |
  | 2674 | 3191 | msgstr "" |
  | 2675 | 3192 |  |
  | 2676 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~586~~ |
  |  | 3193 | #: includes/classes/Admin/Views/class-wizard-steps.php:254 |
  | 2677 | 3194 | msgid "Your backup codes" |
  | 2678 | 3195 | msgstr "" |
  | 2679 | 3196 |  |
  | 2680 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~595~~ |
  | 2681 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~599~~ |
  | 2682 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~600~~ |
  |  | 3197 | #: includes/classes/Admin/Views/class-wizard-steps.php:263 |
  |  | 3198 | #: includes/classes/Admin/Views/class-wizard-steps.php:267 |
  |  | 3199 | #: includes/classes/Admin/Views/class-wizard-steps.php:268 |
  | 2683 | 3200 | msgid "Download" |
  | 2684 | 3201 | msgstr "" |
  | 2685 | 3202 |  |
  | 2686 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~596~~ |
  |  | 3203 | #: includes/classes/Admin/Views/class-wizard-steps.php:264 |
  | 2687 | 3204 | msgid "Copy" |
  | 2688 | 3205 | msgstr "" |
  | 2689 | 3206 |  |
  | 2690 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~603~~ |
  | 2691 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~604~~ |
  |  | 3207 | #: includes/classes/Admin/Views/class-wizard-steps.php:271 |
  |  | 3208 | #: includes/classes/Admin/Views/class-wizard-steps.php:272 |
  | 2692 | 3209 | msgid "Print" |
  | 2693 | 3210 | msgstr "" |
  | 2694 | 3211 |  |
  | 2695 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~607~~ |
  | 2696 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~608~~ |
  |  | 3212 | #: includes/classes/Admin/Views/class-wizard-steps.php:275 |
  |  | 3213 | #: includes/classes/Admin/Views/class-wizard-steps.php:276 |
  | 2697 | 3214 | msgid "Send me the codes via email" |
  | 2698 | 3215 | msgstr "" |
  | 2699 | 3216 |  |
  | 2700 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~614~~ |
  | 2701 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~620~~ |
  |  | 3217 | #: includes/classes/Admin/Views/class-wizard-steps.php:282 |
  |  | 3218 | #: includes/classes/Admin/Views/class-wizard-steps.php:288 |
  | 2702 | 3219 | msgid "I'm ready, close the wizard" |
  | 2703 | 3220 | msgstr "" |
  | 2704 | 3221 |  |
  | 2705 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~665~~ |
  |  | 3222 | #: includes/classes/Admin/Views/class-wizard-steps.php:333 |
  | 2706 | 3223 | msgid "Congratulations." |
  | 2707 | 3224 | msgstr "" |
  | 2708 | 3225 |  |
  | 2709 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~665~~ |
  |  | 3226 | #: includes/classes/Admin/Views/class-wizard-steps.php:333 |
  | 2710 | 3227 | msgid "Congratulations, you're almost there..." |
  | 2711 | 3228 | msgstr "" |
  | 2712 | 3229 |  |
  | 2713 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~668~~ |
  |  | 3230 | #: includes/classes/Admin/Views/class-wizard-steps.php:336 |
  | 2714 | 3231 | msgid "Great job, the plugin and 2FA policies are now configured. You can always change the plugin settings and 2FA policies at a later stage from the WP 2FA entry in the WordPress menu." |
  | 2715 | 3232 | msgstr "" |
  | 2716 | 3233 |  |
  | 2717 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~681~~ |
  |  | 3234 | #: includes/classes/Admin/Views/class-wizard-steps.php:349 |
  | 2718 | 3235 | msgid "Now you need to configure 2FA for your own user account. You can do this now (recommended) or later." |
  | 2719 | 3236 | msgstr "" |
  | 2720 | 3237 |  |
  | 2721 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~687~~ |
  | 2722 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~764~~ |
  |  | 3238 | #: includes/classes/Admin/Views/class-wizard-steps.php:355 |
  |  | 3239 | #: includes/classes/Admin/Views/class-wizard-steps.php:413 |
  | 2723 | 3240 | msgid "Close wizard & configure 2FA later" |
  | 2724 | 3241 | msgstr "" |
  | 2725 | 3242 |  |
  | 2726 |  | #: includes/classes/Admin/Views/class-wizard-steps.php:~~761~~ |
  |  | 3243 | #: includes/classes/Admin/Views/class-wizard-steps.php:410 |
  | 2727 | 3244 | msgid "Configure backup 2FA method" |
  | 2728 | 3245 | msgstr "" |
  | 2729 | 3246 |  |
  | 2730 |  | #: includes/classes/Authenticator/class-login.php:456 |
  |  | 3247 | #: includes/classes/App/grace-period/class-grace-period.php:159 |
  |  | 3248 | msgid "What should the plugin do with users who do not configure 2FA within the grace period?" |
  |  | 3249 | msgstr "" |
  |  | 3250 |  |
  |  | 3251 | #: includes/classes/App/grace-period/class-grace-period.php:167 |
  |  | 3252 | msgid "Do not let them access the dashboard / user page once they log in until they configure 2FA" |
  |  | 3253 | msgstr "" |
  |  | 3254 |  |
  |  | 3255 | #: includes/classes/App/grace-period/class-grace-period.php:177 |
  |  | 3256 | msgid "Block the user (administrators have to manually unblock them)" |
  |  | 3257 | msgstr "" |
  |  | 3258 |  |
  |  | 3259 | #: includes/classes/Authenticator/class-login.php:472 |
  | 2731 | 3260 | msgid "Error: API login for user disabled." |
  | 2732 | 3261 | msgstr "" |
  | 2733 | 3262 |  |
  | 2734 |  | #: includes/classes/Authenticator/class-login.php:~~494~~ |
  |  | 3263 | #: includes/classes/Authenticator/class-login.php:510 |
  | 2735 | 3264 | msgid "Your user account has been locked because you have not configured 2FA within the grace period. Please contact the website administrator to unlock your user and you can configure 2FA." |
  | 2736 | 3265 | msgstr "" |
  | 2737 | 3266 |  |
  | 2738 |  | #: includes/classes/Authenticator/class-login.php:~~594~~ |
  |  | 3267 | #: includes/classes/Authenticator/class-login.php:610 |
  | 2739 | 3268 | msgid "Cheatin&#8217; uh?" |
  | 2740 | 3269 | msgstr "" |
  | 2741 | 3270 |  |
  | 2742 |  | #: includes/classes/Authenticator/class-login.php:~~699~~ |
  |  | 3271 | #: includes/classes/Authenticator/class-login.php:715 |
  | 2743 | 3272 | msgid "Log In" |
  | 2744 | 3273 | msgstr "" |
  | 2745 | 3274 |  |
  | 2746 |  | #: includes/classes/Authenticator/class-login.php:7~~21~~ |
  | 2747 |  | #: includes/classes/Authenticator/class-reset-passord.php:15~~5~~ |
  |  | 3275 | #: includes/classes/Authenticator/class-login.php:737 |
  |  | 3276 | #: includes/classes/Authenticator/class-reset-passord.php:156 |
  | 2748 | 3277 | msgid "Resend Code" |
  | 2749 | 3278 | msgstr "" |
  | 2750 | 3279 |  |
  | 2751 |  | #: includes/classes/Authenticator/class-login.php:7~~55~~ |
  |  | 3280 | #: includes/classes/Authenticator/class-login.php:771 |
  | 2752 | 3281 | msgid "Or, use a backup code." |
  | 2753 | 3282 | msgstr "" |
  | 2754 | 3283 |  |
  | 2755 |  | #: includes/classes/Authenticator/class-login.php:7~~78~~ |
  |  | 3284 | #: includes/classes/Authenticator/class-login.php:794 |
  | 2756 | 3285 | msgid "Are you lost?" |
  | 2757 | 3286 | msgstr "" |
  | 2758 | 3287 |  |
  | 2759 | 3288 | #. translators: %s: site name. |
  | 2760 |  | #: includes/classes/Authenticator/class-login.php:7~~83~~ |
  |  | 3289 | #: includes/classes/Authenticator/class-login.php:799 |
  | 2761 | 3290 | msgid "&larr; Back to %s" |
  | 2762 | 3291 | msgstr "" |
  | 2763 | 3292 |  |
  | 2764 |  | #: includes/classes/Authenticator/class-login.php:9~~35~~ |
  |  | 3293 | #: includes/classes/Authenticator/class-login.php:951 |
  | 2765 | 3294 | msgid "<p> <strong>WP-2FA</strong>: Please contact the administrator for further assistance!</p>" |
  | 2766 | 3295 | msgstr "" |
  | 2767 | 3296 |  |
  | 2768 |  | #: includes/classes/Authenticator/class-login.php:9~~35~~ |
  |  | 3297 | #: includes/classes/Authenticator/class-login.php:951 |
  | 2769 | 3298 | msgid "Invalid provider." |
  | 2770 | 3299 | msgstr "" |
  | 2771 | 3300 |  |
  | 2772 |  | #: includes/classes/Authenticator/class-login.php:~~988~~ |
  |  | 3301 | #: includes/classes/Authenticator/class-login.php:1005 |
  | 2773 | 3302 | msgid "ERROR: Invalid backup code." |
  | 2774 | 3303 | msgstr "" |
  | 2775 | 3304 |  |
  | 2776 |  | #: includes/classes/Authenticator/class-login.php:10~~17~~ |
  |  | 3305 | #: includes/classes/Authenticator/class-login.php:1034 |
  | 2777 | 3306 | msgid " For security reasons you have been sent a new code via email. Please use this new code to log in." |
  | 2778 | 3307 | msgstr "" |
  | 2779 | 3308 |  |
  | 2780 |  | #: includes/classes/Authenticator/class-login.php:10~~62~~ |
  |  | 3309 | #: includes/classes/Authenticator/class-login.php:1079 |
  | 2781 | 3310 | msgid "You have logged in successfully." |
  | 2782 | 3311 | msgstr "" |
  | 2783 | 3312 |  |
  | 2784 |  | #: includes/classes/Authenticator/class-login.php:1143 |
  | 2785 |  | msgid "Authentication Code:" |
  | 2786 |  | msgstr "" |
  | 2787 |  |  |
  | 2788 |  | #: includes/classes/Authenticator/class-reset-passord.php:144 |
  |  | 3313 | #: includes/classes/Authenticator/class-reset-passord.php:145 |
  | 2789 | 3314 | msgid "Get New Password" |
  | 2790 | 3315 | msgstr "" |
  | 2791 | 3316 |  |
  |  | 3317 | #: includes/classes/class-wp2fa.php:100 |
  |  | 3318 | #: includes/classes/class-wp2fa.php:108 |
  |  | 3319 | #: includes/classes/class-wp2fa.php:109 |
  |  | 3320 | msgid "Please enter the two-factor authentication (2FA) verification code below to login. Depending on your 2FA setup, you can get the code from the 2FA app or it was sent to you by email." |
  |  | 3321 | msgstr "" |
  |  | 3322 |  |
  |  | 3323 | #: includes/classes/class-wp2fa.php:100 |
  |  | 3324 | #: includes/classes/class-wp2fa.php:108 |
  |  | 3325 | #: includes/classes/class-wp2fa.php:109 |
  |  | 3326 | msgid "Note: if you are supposed to receive an email but did not receive any, please click the Resend Code button to request another code." |
  |  | 3327 | msgstr "" |
  |  | 3328 |  |
  |  | 3329 | #: includes/classes/class-wp2fa.php:101 |
  |  | 3330 | msgid "You have been sent a one-time code via email. Please enter the code below and then click Get New Password to proceed with the password reset." |
  |  | 3331 | msgstr "" |
  |  | 3332 |  |
  |  | 3333 | #: includes/classes/class-wp2fa.php:101 |
  |  | 3334 | msgid "Note: If you have not received the code please click the button Resend Code. If you still do not get the code after pressing the button, please contact the website's administrator." |
  |  | 3335 | msgstr "" |
  |  | 3336 |  |
  |  | 3337 | #: includes/classes/class-wp2fa.php:102 |
  |  | 3338 | #: includes/classes/class-wp2fa.php:103 |
  |  | 3339 | msgid "This website's administrator requires you to enable two-factor authentication (2FA) {grace\_period\_remaining}." |
  |  | 3340 | msgstr "" |
  |  | 3341 |  |
  |  | 3342 | #: includes/classes/class-wp2fa.php:102 |
  |  | 3343 | #: includes/classes/class-wp2fa.php:103 |
  |  | 3344 | msgid "Failing to configure 2FA within this time period will result in a locked account. For more information, please contact your website administrator." |
  |  | 3345 | msgstr "" |
  |  | 3346 |  |
  | 2792 | 3347 | #: includes/classes/class-wp2fa.php:104 |
  | 2793 |  | msgid "Please enter the two-factor authentication (2FA) verification code below to login. Depending on your 2FA setup, you can get the code from the 2FA app or it was sent to you by email." |
  | 2794 |  | msgstr "" |
  | 2795 |  |  |
  | 2796 |  | #: includes/classes/class-wp2fa.php:104 |
  | 2797 |  | msgid "Note: if you are supposed to receive an email but did not receive any, please click the Resend Code button to request another code." |
  |  | 3348 | msgid "If you are using the Authy app approve the OneTouch request to log in." |
  | 2798 | 3349 | msgstr "" |
  | 2799 | 3350 |  |
  | 2800 | 3351 | #: includes/classes/class-wp2fa.php:105 |
  | 2801 |  | msgid "You have been sent a one-time code via email. Please enter the code below and then click Get New Password to proceed with the password reset." |
  | 2802 |  | msgstr "" |
  | 2803 |  |  |
  | 2804 |  | #: includes/classes/class-wp2fa.php:105 |
  | 2805 |  | msgid "Note: If you have not received the code please click the button Resend Code. If you still do not get the code after pressing the button, please contact the website's administrator." |
  |  | 3352 | msgid "Waiting for approval from application..." |
  | 2806 | 3353 | msgstr "" |
  | 2807 | 3354 |  |
  | 2808 | 3355 | #: includes/classes/class-wp2fa.php:106 |
  |  | 3356 | msgid "Manually enter the code from the mobile app." |
  |  | 3357 | msgstr "" |
  |  | 3358 |  |
  | 2809 | 3359 | #: includes/classes/class-wp2fa.php:107 |
  | 2810 |  | msgid "This website's administrator requires you to enable two-factor authentication (2FA) {grace\_period\_remaining}." |
  | 2811 |  | msgstr "" |
  | 2812 |  |  |
  | 2813 |  | #: includes/classes/class-wp2fa.php:106 |
  | 2814 |  | #: includes/classes/class-wp2fa.php:107 |
  | 2815 |  | msgid "Failing to configure 2FA within this time period will result in a locked account. For more information, please contact your website administrator." |
  | 2816 |  | msgstr "" |
  | 2817 |  |  |
  | 2818 |  | #: includes/classes/class-wp2fa.php:109 |
  |  | 3360 | msgid "Enter the 2FA code you have received over SMS." |
  |  | 3361 | msgstr "" |
  |  | 3362 |  |
  |  | 3363 | #: includes/classes/class-wp2fa.php:112 |
  | 2819 | 3364 | msgid "Enter a backup verification code." |
  | 2820 | 3365 | msgstr "" |
  | 2821 | 3366 |  |
  | 2822 |  | #: includes/classes/class-wp2fa.php:11~~6~~ |
  | 2823 |  | #: includes/classes/class-wp2fa.php:1~~17~~ |
  |  | 3367 | #: includes/classes/class-wp2fa.php:119 |
  |  | 3368 | #: includes/classes/class-wp2fa.php:120 |
  | 2824 | 3369 | msgid "Choose the 2FA method" |
  | 2825 | 3370 | msgstr "" |
  | 2826 | 3371 |  |
  | 2827 |  | #: includes/classes/class-wp2fa.php:1~~17~~ |
  |  | 3372 | #: includes/classes/class-wp2fa.php:120 |
  | 2828 | 3373 | msgid "Only the below 2FA method is allowed on this website:" |
  | 2829 | 3374 | msgstr "" |
  | 2830 | 3375 |  |
  | 2831 |  | ~~#: includes/classes/class-wp2fa.php:118~~ |
  | 2832 |  | ~~msgid "Setting up TOTP"~~ |
  | 2833 |  | ~~msgstr ""~~ |
  | 2834 |  |  |
  | 2835 |  | ~~#: includes/classes/class-wp2fa.php:119~~ |
  | 2836 |  | ~~msgid "Download and start the application of your choice"~~ |
  | 2837 |  | ~~msgstr ""~~ |
  | 2838 |  |  |
  | 2839 |  | ~~#: includes/classes/class-wp2fa.php:120~~ |
  | 2840 |  | ~~msgid "From within the application scan the QR code provided on the left. Otherwise, enter the following code manually in the application:"~~ |
  | 2841 |  | ~~msgstr ""~~ |
  | 2842 |  |  |
  | 2843 | 3376 | #: includes/classes/class-wp2fa.php:121 |
  | 2844 |  | msgid "Click the \"I'm ready\" button below when you complete the application setup process to proceed with the wizard." |
  |  | 3377 | msgid "Setting up Push notifications" |
  |  | 3378 | msgstr "" |
  |  | 3379 |  |
  |  | 3380 | #: includes/classes/class-wp2fa.php:121 |
  |  | 3381 | msgid "To enable push notifications enter the country and cellphone number in order to use it with this account." |
  | 2845 | 3382 | msgstr "" |
  | 2846 | 3383 |  |
  | 2847 | 3384 | #: includes/classes/class-wp2fa.php:122 |
  | 2848 |  | msgid "Setting up ~~HOTP~~" |
  |  | 3385 | msgid "Setting up 2FA over SMS" |
  | 2849 | 3386 | msgstr "" |
  | 2850 | 3387 |  |
  | 2851 | 3388 | #: includes/classes/class-wp2fa.php:122 |
  | 2852 |  | #: includes/classes/class-wp2fa.php:139 |
  | 2853 |  | msgid "Please select the email address where the one-time code should be sent:" |
  |  | 3389 | msgid "When you use 2FA over SMS to log in to this website you will receive your one-time code via an SMS on your cellphone. Therefore please enter the cellphone number of where you would like to receive the SMS below." |
  | 2854 | 3390 | msgstr "" |
  | 2855 | 3391 |  |
  | 2856 | 3392 | #: includes/classes/class-wp2fa.php:123 |
  | 2857 |  | msgid "Setting up ~~Push notifications~~" |
  |  | 3393 | msgid "Setting up Link over email 2FA" |
  | 2858 | 3394 | msgstr "" |
  | 2859 | 3395 |  |
  | 2860 | 3396 | #: includes/classes/class-wp2fa.php:123 |
  | 2861 |  | msgid "~~To enable push notifications enter the country and cellphone number in order to use it with this account.~~" |
  |  | 3397 | msgid "Please select the email address to where the out-of-band link should be sent:" |
  | 2862 | 3398 | msgstr "" |
  | 2863 | 3399 |  |
  | 2864 | 3400 | #: includes/classes/class-wp2fa.php:124 |
  | 2865 |  | msgid "Setting up 2FA over SMS" |
  | 2866 |  | msgstr "" |
  | 2867 |  |  |
  | 2868 |  | #: includes/classes/class-wp2fa.php:124 |
  | 2869 |  | msgid "When you use 2FA over SMS to log in to this website you will receive your one-time code via an SMS on your cellphone. Therefore please enter the cellphone number of where you would like to receive the SMS below." |
  |  | 3401 | msgid "Please type in the one-time code sent to your email address to finalize the setup. Once the code is confirmed and 2FA is set up, you only have to verify a login by clicking on a link sent to you via email." |
  | 2870 | 3402 | msgstr "" |
  | 2871 | 3403 |  |
  | 2872 | 3404 | #: includes/classes/class-wp2fa.php:125 |
  | 2873 |  | msgid "Setting up Link over email 2FA" |
  | 2874 |  | msgstr "" |
  | 2875 |  |  |
  | 2876 |  | #: includes/classes/class-wp2fa.php:125 |
  | 2877 |  | msgid "Please select the email address to where the out-of-band link should be sent:" |
  |  | 3405 | msgid "Please type in the code from your Authy application with name {authy\_name}" |
  | 2878 | 3406 | msgstr "" |
  | 2879 | 3407 |  |
  | 2880 | 3408 | #: includes/classes/class-wp2fa.php:126 |
  |  | 3409 | msgid "Please type in the one-time code sent via SMS to your phone to confirm your phone number." |
  |  | 3410 | msgstr "" |
  |  | 3411 |  |
  | 2881 | 3412 | #: includes/classes/class-wp2fa.php:127 |
  | 2882 | 3413 | #: includes/classes/class-wp2fa.php:128 |
  | 2883 | 3414 | #: includes/classes/class-wp2fa.php:129 |
  |  | 3415 | #: includes/classes/class-wp2fa.php:143 |
  |  | 3416 | msgid "Your login just got more secure" |
  |  | 3417 | msgstr "" |
  |  | 3418 |  |
  |  | 3419 | #: includes/classes/class-wp2fa.php:127 |
  |  | 3420 | msgid "It is recommended to have a backup 2FA method in case you cannot generate a code from your 2FA app and you need to log in. You can configure any of the below. You can always configure any or both from your user profile page later." |
  |  | 3421 | msgstr "" |
  |  | 3422 |  |
  |  | 3423 | #: includes/classes/class-wp2fa.php:128 |
  |  | 3424 | #: includes/classes/class-wp2fa.php:129 |
  |  | 3425 | msgid "Congratulations! You have enabled two-factor authentication for your user. You’ve just helped towards making this website more secure!" |
  |  | 3426 | msgstr "" |
  |  | 3427 |  |
  |  | 3428 | #: includes/classes/class-wp2fa.php:129 |
  |  | 3429 | msgid "You should now generate the list of backup method. Although this is optional, it is highly recommended to have a secondary 2FA method. This can be used as a backup should the primary 2FA method fail. This can happen if, for example, you forget your smartphone, the smartphone runs out of battery, or there are email deliverability problems." |
  |  | 3430 | msgstr "" |
  |  | 3431 |  |
  | 2884 | 3432 | #: includes/classes/class-wp2fa.php:130 |
  | 2885 |  | msgid "Almost there…" |
  | 2886 |  | msgstr "" |
  | 2887 |  |  |
  | 2888 |  | #: includes/classes/class-wp2fa.php:126 |
  | 2889 |  | msgid "Please type in the one-time code from your chosen authentication app to finalize the setup." |
  | 2890 |  | msgstr "" |
  | 2891 |  |  |
  | 2892 |  | #: includes/classes/class-wp2fa.php:127 |
  | 2893 |  | msgid "Please type in the one-time code sent to your email address to finalize the setup" |
  | 2894 |  | msgstr "" |
  | 2895 |  |  |
  | 2896 |  | #: includes/classes/class-wp2fa.php:128 |
  | 2897 |  | msgid "Please type in the one-time code sent to your email address to finalize the setup. Once the code is confirmed and 2FA is set up, you only have to verify a login by clicking on a link sent to you via email." |
  | 2898 |  | msgstr "" |
  | 2899 |  |  |
  | 2900 |  | #: includes/classes/class-wp2fa.php:129 |
  | 2901 |  | msgid "Please type in the code from your Authy application with name {authy\_name}" |
  | 2902 |  | msgstr "" |
  | 2903 |  |  |
  | 2904 |  | #: includes/classes/class-wp2fa.php:130 |
  | 2905 |  | msgid "Please type in the one-time code sent via SMS to your phone to confirm your phone number." |
  |  | 3433 | msgid "It is recommended to generate and print some backup codes in case you lose access to your primary 2FA method." |
  | 2906 | 3434 | msgstr "" |
  | 2907 | 3435 |  |
  | 2908 | 3436 | #: includes/classes/class-wp2fa.php:131 |
  |  | 3437 | msgid "Backup codes generated" |
  |  | 3438 | msgstr "" |
  |  | 3439 |  |
  |  | 3440 | #: includes/classes/class-wp2fa.php:131 |
  |  | 3441 | msgid "Here are your backup codes:" |
  |  | 3442 | msgstr "" |
  |  | 3443 |  |
  | 2909 | 3444 | #: includes/classes/class-wp2fa.php:132 |
  |  | 3445 | msgid "Congratulations! You are all set." |
  |  | 3446 | msgstr "" |
  |  | 3447 |  |
  | 2910 | 3448 | #: includes/classes/class-wp2fa.php:133 |
  | 2911 |  | #: includes/classes/class-wp2fa.php:149 |
  | 2912 |  | msgid "Your login just got more secure" |
  | 2913 |  | msgstr "" |
  | 2914 |  |  |
  | 2915 |  | #: includes/classes/class-wp2fa.php:131 |
  | 2916 |  | msgid "It is recommended to have a backup 2FA method in case you cannot generate a code from your 2FA app and you need to log in. You can configure any of the below. You can always configure any or both from your user profile page later." |
  | 2917 |  | msgstr "" |
  | 2918 |  |  |
  | 2919 |  | #: includes/classes/class-wp2fa.php:132 |
  |  | 3449 | msgid "You are required to configure 2FA." |
  |  | 3450 | msgstr "" |
  |  | 3451 |  |
  | 2920 | 3452 | #: includes/classes/class-wp2fa.php:133 |
  | 2921 |  | msgid "~~Congratulations! You have enabled two-factor authentication for your user. You’ve just helped towards making this website more secure!~~" |
  |  | 3453 | msgid "In order to keep this site - and your details secure, this website’s administrator requires you to enable 2FA authentication to continue." |
  | 2922 | 3454 | msgstr "" |
  | 2923 | 3455 |  |
  | 2924 | 3456 | #: includes/classes/class-wp2fa.php:133 |
  | 2925 |  | msgid "You should now generate the list of backup method. Although this is optional, it is highly recommended to have a secondary 2FA method. This can be used as a backup should the primary 2FA method fail. This can happen if, for example, you forget your smartphone, the smartphone runs out of battery, or there are email deliverability problems." |
  |  | 3457 | msgid "Two factor authentication ensures only you have access to your account by creating an added layer of security when logging in -" |
  |  | 3458 | msgstr "" |
  |  | 3459 |  |
  |  | 3460 | #: includes/classes/class-wp2fa.php:133 |
  |  | 3461 | msgid "Learn more" |
  | 2926 | 3462 | msgstr "" |
  | 2927 | 3463 |  |
  | 2928 | 3464 | #: includes/classes/class-wp2fa.php:134 |
  | 2929 |  | ~~msgid "It is recommended to generate and print some backup codes in case you lose access to your primary 2FA method."~~ |
  | 2930 |  | ~~msgstr ""~~ |
  | 2931 |  |  |
  | 2932 | 3465 | #: includes/classes/class-wp2fa.php:135 |
  | 2933 |  | msgid "Backup codes generated" |
  |  | 3466 | msgid "{reconfigure\_or\_configure\_capitalized} push notification method" |
  |  | 3467 | msgstr "" |
  |  | 3468 |  |
  |  | 3469 | #: includes/classes/class-wp2fa.php:134 |
  |  | 3470 | msgid "Please select the phone where link should be send:" |
  | 2934 | 3471 | msgstr "" |
  | 2935 | 3472 |  |
  | 2936 | 3473 | #: includes/classes/class-wp2fa.php:135 |
  | 2937 |  | msgid "~~Here are your backup codes:~~" |
  |  | 3474 | msgid "The 2FA service you want to use is currently unavailable. Please try again later or restart the wizard to choose another method." |
  | 2938 | 3475 | msgstr "" |
  | 2939 | 3476 |  |
  | 2940 | 3477 | #: includes/classes/class-wp2fa.php:136 |
  | 2941 |  | ~~msgid "Congratulations! You are all set."~~ |
  | 2942 |  | ~~msgstr ""~~ |
  | 2943 |  |  |
  | 2944 | 3478 | #: includes/classes/class-wp2fa.php:137 |
  | 2945 |  | msgid "You are required to configure 2FA." |
  |  | 3479 | msgid "{reconfigure\_or\_configure\_capitalized} SMS method" |
  |  | 3480 | msgstr "" |
  |  | 3481 |  |
  |  | 3482 | #: includes/classes/class-wp2fa.php:136 |
  |  | 3483 | msgid "Please select the phone where code should be send:" |
  | 2946 | 3484 | msgstr "" |
  | 2947 | 3485 |  |
  | 2948 | 3486 | #: includes/classes/class-wp2fa.php:137 |
  | 2949 |  | msgid "In order to keep this site - and your details secure, this website’s administrator requires you to enable 2FA authentication to continue." |
  | 2950 |  | msgstr "" |
  | 2951 |  |  |
  | 2952 |  | #: includes/classes/class-wp2fa.php:137 |
  | 2953 |  | msgid "Two factor authentication ensures only you have access to your account by creating an added layer of security when logging in -" |
  | 2954 |  | msgstr "" |
  | 2955 |  |  |
  | 2956 |  | #: includes/classes/class-wp2fa.php:137 |
  | 2957 |  | msgid "Learn more" |
  |  | 3487 | msgid "The 2FA over SMS service you want to use is currently unavailable. Please try again later or restart the wizard to choose another method." |
  | 2958 | 3488 | msgstr "" |
  | 2959 | 3489 |  |
  | 2960 | 3490 | #: includes/classes/class-wp2fa.php:138 |
  | 2961 |  | msgid "{reconfigure\_or\_configure\_capitalized} ~~the 2FA App~~" |
  |  | 3491 | msgid "{reconfigure\_or\_configure\_capitalized} link over email method" |
  | 2962 | 3492 | msgstr "" |
  | 2963 | 3493 |  |
  | 2964 | 3494 | #: includes/classes/class-wp2fa.php:138 |
  | 2965 |  | msgid "Click the below button to {reconfigure\_or\_configure} the current 2FA method. Note that once reset you will have to re-scan the QR code on all devices you want this to work on because the previous codes will stop working." |
  | 2966 |  | msgstr "" |
  | 2967 |  |  |
  | 2968 |  | #: includes/classes/class-wp2fa.php:139 |
  | 2969 |  | msgid "{reconfigure\_or\_configure\_capitalized} one-time code over email method" |
  | 2970 |  | msgstr "" |
  | 2971 |  |  |
  | 2972 |  | #: includes/classes/class-wp2fa.php:140 |
  | 2973 |  | #: includes/classes/class-wp2fa.php:141 |
  | 2974 |  | msgid "{reconfigure\_or\_configure\_capitalized} push notification method" |
  | 2975 |  | msgstr "" |
  | 2976 |  |  |
  | 2977 |  | #: includes/classes/class-wp2fa.php:140 |
  | 2978 |  | msgid "Please select the phone where link should be send:" |
  | 2979 |  | msgstr "" |
  | 2980 |  |  |
  | 2981 |  | #: includes/classes/class-wp2fa.php:141 |
  | 2982 |  | msgid "The 2FA service you want to use is currently unavailable. Please try again later or restart the wizard to choose another method." |
  |  | 3495 | msgid "Please select the email address where the OOB code should be sent:" |
  | 2983 | 3496 | msgstr "" |
  | 2984 | 3497 |  |
  | 2985 | 3498 | #: includes/classes/class-wp2fa.php:142 |
  |  | 3499 | msgid "You must be logged in to view this page. {login\_url}" |
  |  | 3500 | msgstr "" |
  |  | 3501 |  |
  | 2986 | 3502 | #: includes/classes/class-wp2fa.php:143 |
  | 2987 |  | msgid "{reconfigure\_or\_configure\_capitalized} SMS method" |
  | 2988 |  | msgstr "" |
  | 2989 |  |  |
  | 2990 |  | #: includes/classes/class-wp2fa.php:142 |
  | 2991 |  | msgid "Please select the phone where code should be send:" |
  | 2992 |  | msgstr "" |
  | 2993 |  |  |
  | 2994 |  | #: includes/classes/class-wp2fa.php:143 |
  | 2995 |  | msgid "The 2FA over SMS service you want to use is currently unavailable. Please try again later or restart the wizard to choose another method." |
  |  | 3503 | msgid "Well done on configuring 2FA, your login has just got more secure. To make sure you never get locked out you are required to confirm your email address and use email as an alternative and backup 2FA method in case your primary method is unavailable. Please confirm your email address below" |
  | 2996 | 3504 | msgstr "" |
  | 2997 | 3505 |  |
  | 2998 | 3506 | #: includes/classes/class-wp2fa.php:144 |
  | 2999 |  | ~~msgid "{reconfigure\_or\_configure\_capitalized} link over email method"~~ |
  | 3000 |  | ~~msgstr ""~~ |
  | 3001 |  |  |
  | 3002 |  | ~~#: includes/classes/class-wp2fa.php:144~~ |
  | 3003 |  | ~~msgid "Please select the email address where the OOB code should be sent:"~~ |
  | 3004 |  | ~~msgstr ""~~ |
  | 3005 |  |  |
  | 3006 |  | ~~#: includes/classes/class-wp2fa.php:148~~ |
  | 3007 |  | ~~msgid "You must be logged in to view this page. {login\_url}"~~ |
  | 3008 |  | ~~msgstr ""~~ |
  | 3009 |  |  |
  | 3010 |  | ~~#: includes/classes/class-wp2fa.php:149~~ |
  | 3011 |  | ~~msgid "Well done on configuring 2FA, your login has just got more secure. To make sure you never get locked out you are required to confirm your email address and use email as an alternative and backup 2FA method in case your primary method is unavailable. Please confirm your email address below"~~ |
  | 3012 |  | ~~msgstr ""~~ |
  | 3013 |  |  |
  | 3014 |  | ~~#: includes/classes/class-wp2fa.php:150~~ |
  | 3015 | 3507 | msgid "Two-factor authentication settings" |
  | 3016 | 3508 | msgstr "" |
  | 3017 | 3509 |  |
  | 3018 |  | #: includes/classes/class-wp2fa.php:1~~51~~ |
  |  | 3510 | #: includes/classes/class-wp2fa.php:145 |
  | 3019 | 3511 | msgid "Add two-factor authentication to strengthen the security of your user account." |
  | 3020 | 3512 | msgstr "" |
  | 3021 | 3513 |  |
  | 3022 |  | #: includes/classes/class-wp2fa.php:5~~20~~ |
  |  | 3514 | #: includes/classes/class-wp2fa.php:518 |
  | 3023 | 3515 | msgid "Your login confirmation code for {site\_name}" |
  | 3024 | 3516 | msgstr "" |
  | 3025 | 3517 |  |
  | 3026 | 3518 | #. translators: The login code provided from the plugin. |
  | 3027 |  | #: includes/classes/class-wp2fa.php:52~~4~~ |
  |  | 3519 | #: includes/classes/class-wp2fa.php:522 |
  | 3028 | 3520 | msgid "Enter %1$1s to log in." |
  | 3029 | 3521 | msgstr "" |
  | 3030 | 3522 |  |
  | 3031 |  | #: includes/classes/class-wp2fa.php:52~~8~~ |
  | 3032 |  | #: includes/classes/class-wp2fa.php:55~~7~~ |
  | 3033 |  | #: includes/classes/class-wp2fa.php:57~~5~~ |
  | 3034 |  | #: includes/classes/class-wp2fa.php:5~~90~~ |
  |  | 3523 | #: includes/classes/class-wp2fa.php:526 |
  |  | 3524 | #: includes/classes/class-wp2fa.php:555 |
  |  | 3525 | #: includes/classes/class-wp2fa.php:573 |
  |  | 3526 | #: includes/classes/class-wp2fa.php:588 |
  | 3035 | 3527 | msgid "Thank you." |
  | 3036 | 3528 | msgstr "" |
  | 3037 | 3529 |  |
  | 3038 |  | #: includes/classes/class-wp2fa.php:529 |
  | 3039 |  | #: includes/classes/class-wp2fa.php:558 |
  | 3040 |  | #: includes/classes/class-wp2fa.php:576 |
  | 3041 |  | #: includes/classes/class-wp2fa.php:590 |
  | 3042 |  | #: includes/classes/class-wp2fa.php:600 |
  | 3043 |  | msgid "Email sent by" |
  |  | 3530 | #: includes/classes/class-wp2fa.php:532 |
  |  | 3531 | msgid "2FA code for password reset" |
  | 3044 | 3532 | msgstr "" |
  | 3045 | 3533 |  |
  | 3046 | 3534 | #: includes/classes/class-wp2fa.php:534 |
  | 3047 |  | msgid "2FA code for password reset" |
  | 3048 |  | msgstr "" |
  | 3049 |  |  |
  | 3050 |  | #: includes/classes/class-wp2fa.php:536 |
  | 3051 |  | #: includes/classes/class-wp2fa.php:584 |
  | 3052 |  | #: includes/classes/class-wp2fa.php:596 |
  |  | 3535 | #: includes/classes/class-wp2fa.php:582 |
  |  | 3536 | #: includes/classes/class-wp2fa.php:594 |
  | 3053 | 3537 | msgid "Hello," |
  | 3054 | 3538 | msgstr "" |
  | 3055 | 3539 |  |
  | 3056 | 3540 | #. translators: The login code provided from the plugin. |
  | 3057 |  | #: includes/classes/class-wp2fa.php:5~~40~~ |
  |  | 3541 | #: includes/classes/class-wp2fa.php:538 |
  | 3058 | 3542 | msgid "Someone from the IP address %1$1s has requested a password reset for the user %2$2s on the website %3$3s. If this was you please use the below code to proceed with the password reset:" |
  | 3059 | 3543 | msgstr "" |
  | 3060 | 3544 |  |
  | 3061 |  | #: includes/classes/class-wp2fa.php:54~~9~~ |
  |  | 3545 | #: includes/classes/class-wp2fa.php:547 |
  | 3062 | 3546 | msgid "If this was not you, ignore this email and contact your website administrator." |
  | 3063 | 3547 | msgstr "" |
  | 3064 | 3548 |  |
  | 3065 | 3549 | #. translators: The login code provided from the plugin. |
  | 3066 |  | #: includes/classes/class-wp2fa.php:55~~3~~ |
  |  | 3550 | #: includes/classes/class-wp2fa.php:551 |
  | 3067 | 3551 | msgid "Please enter this code to confirm 2FA setup: %1$1s" |
  | 3068 | 3552 | msgstr "" |
  | 3069 | 3553 |  |
  |  | 3554 | #: includes/classes/class-wp2fa.php:561 |
  |  | 3555 | msgid "Your user on {site\_name} has been locked" |
  |  | 3556 | msgstr "" |
  |  | 3557 |  |
  | 3070 | 3558 | #: includes/classes/class-wp2fa.php:563 |
  | 3071 |  | ~~msgid "Your user on {site\_name} has been locked"~~ |
  | 3072 |  | ~~msgstr ""~~ |
  | 3073 |  |  |
  | 3074 |  | ~~#: includes/classes/class-wp2fa.php:565~~ |
  | 3075 | 3559 | msgid "Hello." |
  | 3076 | 3560 | msgstr "" |
  | 3077 | 3561 |  |
  | 3078 | 3562 | #. translators: %2s - the name of the site. |
  | 3079 |  | #: includes/classes/class-wp2fa.php:56~~9~~ |
  |  | 3563 | #: includes/classes/class-wp2fa.php:567 |
  | 3080 | 3564 | msgid "Since you have not enabled two-factor authentication for the user %1$1s on the website %2$2s within the grace period, your account has been locked." |
  | 3081 | 3565 | msgstr "" |
  | 3082 | 3566 |  |
  | 3083 |  | #: includes/classes/class-wp2fa.php:57~~4~~ |
  |  | 3567 | #: includes/classes/class-wp2fa.php:572 |
  | 3084 | 3568 | msgid "Contact your website administrator to unlock your account." |
  | 3085 | 3569 | msgstr "" |
  | 3086 | 3570 |  |
  | 3087 |  | #: includes/classes/class-wp2fa.php:5~~81~~ |
  |  | 3571 | #: includes/classes/class-wp2fa.php:579 |
  | 3088 | 3572 | msgid "Your user on {site\_name} has been unlocked" |
  | 3089 | 3573 | msgstr "" |
  | 3090 | 3574 |  |
  | 3091 |  | #: includes/classes/class-wp2fa.php:58~~4~~ |
  |  | 3575 | #: includes/classes/class-wp2fa.php:582 |
  | 3092 | 3576 | msgid "Your user" |
  | 3093 | 3577 | msgstr "" |
  | 3094 | 3578 |  |
  | 3095 |  | #: includes/classes/class-wp2fa.php:58~~4~~ |
  | 3096 |  | #: includes/classes/class-wp2fa.php:59~~6~~ |
  |  | 3579 | #: includes/classes/class-wp2fa.php:582 |
  |  | 3580 | #: includes/classes/class-wp2fa.php:594 |
  | 3097 | 3581 | msgid "on the website" |
  | 3098 | 3582 | msgstr "" |
  | 3099 | 3583 |  |
  | 3100 |  | #: includes/classes/class-wp2fa.php:58~~4~~ |
  |  | 3584 | #: includes/classes/class-wp2fa.php:582 |
  | 3101 | 3585 | msgid "has been unlocked. Please configure two-factor authentication within the grace period, otherwise your account will be locked again." |
  | 3102 | 3586 | msgstr "" |
  | 3103 | 3587 |  |
  | 3104 |  | #: includes/classes/class-wp2fa.php:58~~7~~ |
  |  | 3588 | #: includes/classes/class-wp2fa.php:585 |
  | 3105 | 3589 | msgid "You can configure 2FA from this page:" |
  | 3106 | 3590 | msgstr "" |
  | 3107 | 3591 |  |
  | 3108 |  | #: includes/classes/class-wp2fa.php:5~~90~~ |
  | 3109 |  | #: includes/classes/class-wp2fa.php:~~600~~ |
  |  | 3592 | #: includes/classes/class-wp2fa.php:588 |
  |  | 3593 | #: includes/classes/class-wp2fa.php:598 |
  | 3110 | 3594 | msgid "WP 2FA plugin" |
  | 3111 | 3595 | msgstr "" |
  | 3112 | 3596 |  |
  | 3113 |  | #: includes/classes/class-wp2fa.php:59~~3~~ |
  |  | 3597 | #: includes/classes/class-wp2fa.php:591 |
  | 3114 | 3598 | msgid "2FA backup codes for user {user\_login\_name} on {site\_name}" |
  | 3115 | 3599 | msgstr "" |
  | 3116 | 3600 |  |
  | 3117 |  | #: includes/classes/class-wp2fa.php:59~~6~~ |
  |  | 3601 | #: includes/classes/class-wp2fa.php:594 |
  | 3118 | 3602 | msgid "Below please find the 2FA backup codes for your user" |
  | 3119 | 3603 | msgstr "" |
  | 3120 | 3604 |  |
  | 3121 |  | #: includes/classes/class-wp2fa.php:59~~6~~ |
  |  | 3605 | #: includes/classes/class-wp2fa.php:594 |
  | 3122 | 3606 | msgid "The website's URL is" |
  | 3123 | 3607 | msgstr "" |
  | 3124 | 3608 |  |
  | 3125 |  | #: includes/classes/class-wp2fa.php:~~600~~ |
  |  | 3609 | #: includes/classes/class-wp2fa.php:598 |
  | 3126 | 3610 | msgid "Thank you for enabling 2FA on your account and helping us keeping the website secure." |
  | 3127 | 3611 | msgstr "" |
  | 3128 | 3612 |  |
  | 3129 |  | #: includes/classes/class-wp2fa.php:73~~0~~ |
  |  | 3613 | #: includes/classes/class-wp2fa.php:731 |
  | 3130 | 3614 | msgid "Reconfigure" |
  | 3131 | 3615 | msgstr "" |
  | 3132 | 3616 |  |
  | 3133 |  | #: includes/classes/class-wp2fa.php:73~~0~~ |
  |  | 3617 | #: includes/classes/class-wp2fa.php:731 |
  | 3134 | 3618 | msgid "Configure" |
  | 3135 | 3619 | msgstr "" |
  | 3136 | 3620 |  |
  | 3137 | 3621 | #. translators: The username. |
  | 3138 |  | #: includes/classes/class-wp2fa.php:92~~3~~ |
  |  | 3622 | #: includes/classes/class-wp2fa.php:925 |
  | 3139 | 3623 | msgid "User %1$s logged in without 2FA" |
  | 3140 | 3624 | msgstr "" |
  | 3141 | 3625 |  |
  | 3142 | 3626 | #. translators: the site name. |
  | 3143 |  | #: includes/classes/class-wp2fa.php:93~~3~~ |
  |  | 3627 | #: includes/classes/class-wp2fa.php:935 |
  | 3144 | 3628 | msgid "2FA is enforced on the user %1$s on the website %2$s. However, since the WP 2FA plugin has not been configured properly it cannot enforce the user to configure 2FA, so the user logged in without 2FA." |
  | 3145 | 3629 | msgstr "" |
  | 3146 | 3630 |  |
  | 3147 | 3631 | #. translators: the support e-mail. |
  | 3148 |  | #: includes/classes/class-wp2fa.php:94~~3~~ |
  |  | 3632 | #: includes/classes/class-wp2fa.php:945 |
  | 3149 | 3633 | msgid "To enforce 2FA on users logging in from non default WordPress login pages please configure the %1$s. If you need assistance, please contact us at %2$s." |
  | 3150 | 3634 | msgstr "" |
  | 3151 | 3635 |  |
  | 3152 |  | #: includes/classes/class-wp2fa.php:1009 |
  | 3153 |  | msgid "Test email from WP 2FA" |
  | 3154 |  | msgstr "" |
  | 3155 |  |  |
  | 3156 |  | #: includes/classes/class-wp2fa.php:1010 |
  | 3157 |  | msgid "This email was sent by the WP 2FA plugin to test the email delivery." |
  | 3158 |  | msgstr "" |
  | 3159 |  |  |
  | 3160 |  | #: includes/classes/class-wp2fa.php:1226 |
  |  | 3636 | #: includes/classes/class-wp2fa.php:1109 |
  | 3161 | 3637 | msgid "For security reasons WP 2FA needs to store the private key in the wp-config.php file. However, it is unable to. This can happen because of restrictive permissions, or the file is not in the default location. To fix this you can:" |
  | 3162 | 3638 | msgstr "" |
  | 3163 | 3639 |  |
  | 3164 |  | #: includes/classes/class-wp2fa.php:1~~228~~ |
  |  | 3640 | #: includes/classes/class-wp2fa.php:1111 |
  | 3165 | 3641 | msgid "Option A) allow the plugin to write to the wp-config.php file temporarily by changing the wp-config.php permissions to 755. Once ready, click the button to proceed." |
  | 3166 | 3642 | msgstr "" |
  | 3167 | 3643 |  |
  | 3168 |  | #: includes/classes/class-wp2fa.php:1~~230~~ |
  |  | 3644 | #: includes/classes/class-wp2fa.php:1113 |
  | 3169 | 3645 | msgid "Option B) Add the encryption key to the wp-config.php file yourself by " |
  | 3170 | 3646 | msgstr "" |
  | 3171 | 3647 |  |
  | 3172 |  | #: includes/classes/class-wp2fa.php:1~~231~~ |
  |  | 3648 | #: includes/classes/class-wp2fa.php:1114 |
  | 3173 | 3649 | msgid "following these instructions." |
  | 3174 | 3650 | msgstr "" |
  | 3175 | 3651 |  |
  | 3176 |  | #: includes/classes/class-wp2fa.php:1~~232~~ |
  |  | 3652 | #: includes/classes/class-wp2fa.php:1115 |
  | 3177 | 3653 | msgid "" |
  | 3178 | 3654 | "Once you complete any of the above, please click the button below.\n" |
  | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=2940688#L3180) | […](/browser/wp-2fa/trunk/languages/wp-2fa.pot?rev=3009922#L3656) |  |
  | 3180 | 3656 | msgstr "" |
  | 3181 | 3657 |  |
  | 3182 |  | #: includes/classes/class-wp2fa.php:1~~241~~ |
  |  | 3658 | #: includes/classes/class-wp2fa.php:1124 |
  | 3183 | 3659 | msgid "Write key to file now / Check for the key in file" |
  | 3184 | 3660 | msgstr "" |
  | 3185 | 3661 |  |
  | 3186 |  | #: includes/classes/Shortcodes/class-shortcodes.php:5~~1~~ |
  | 3187 |  | #: includes/classes/Shortcodes/class-shortcodes.php:18~~1~~ |
  |  | 3662 | #: includes/classes/Shortcodes/class-shortcodes.php:53 |
  |  | 3663 | #: includes/classes/Shortcodes/class-shortcodes.php:183 |
  | 3188 | 3664 | msgid "All done." |
  | 3189 | 3665 | msgstr "" |
  | 3190 | 3666 |  |
  | 3191 |  | #: includes/classes/Shortcodes/class-shortcodes.php:5~~2~~ |
  | 3192 |  | #: includes/classes/Shortcodes/class-shortcodes.php:18~~2~~ |
  |  | 3667 | #: includes/classes/Shortcodes/class-shortcodes.php:54 |
  |  | 3668 | #: includes/classes/Shortcodes/class-shortcodes.php:184 |
  | 3193 | 3669 | msgid "Your login just got more secure." |
  | 3194 | 3670 | msgstr "" |
  | 3195 | 3671 |  |
  | 3196 |  | #: includes/classes/Shortcodes/class-shortcodes.php:14~~0~~ |
  |  | 3672 | #: includes/classes/Shortcodes/class-shortcodes.php:142 |
  | 3197 | 3673 | msgid "Login here." |
  | 3198 | 3674 | msgstr "" |
  | 3199 | 3675 |  |
  | 3200 |  | #: includes/classes/Utils/class-date-time-utils.php:~~39~~ |
  |  | 3676 | #: includes/classes/Utils/class-date-time-utils.php:41 |
  | 3201 | 3677 | msgid "no grace period" |
  | 3202 | 3678 | msgstr "" |
  | 3203 | 3679 |  |
  | 3204 | 3680 | #. translators: Grace period expiration label. %s: Date and time formatted using WordPress date and time formats. |
  | 3205 |  | #: includes/classes/Utils/class-date-time-utils.php:6~~4~~ |
  |  | 3681 | #: includes/classes/Utils/class-date-time-utils.php:66 |
  | 3206 | 3682 | msgid "before %s" |
  | 3207 | 3683 | msgstr "" |
  | 3208 | 3684 |  |
  | 3209 |  | #: includes/classes/Utils/class-debugging.php:5~~4~~ |
  |  | 3685 | #: includes/classes/Utils/class-debugging.php:56 |
  | 3210 | 3686 | msgid "Current memory usage: " |
  | 3211 | 3687 | msgstr "" |
  | 3212 | 3688 |  |
  | 3213 |  | #: includes/classes/Utils/class-user-utils.php:35~~2~~ |
  |  | 3689 | #: includes/classes/Utils/class-user-utils.php:354 |
  | 3214 | 3690 | msgid "Configured" |
  | 3215 | 3691 | msgstr "" |
  | 3216 | 3692 |  |
  | 3217 |  | #: includes/classes/Utils/class-user-utils.php:35~~3~~ |
  |  | 3693 | #: includes/classes/Utils/class-user-utils.php:355 |
  | 3218 | 3694 | msgid "Required but not configured" |
  | 3219 | 3695 | msgstr "" |
  | 3220 | 3696 |  |
  | 3221 |  | #: includes/classes/Utils/class-user-utils.php:35~~4~~ |
  |  | 3697 | #: includes/classes/Utils/class-user-utils.php:356 |
  | 3222 | 3698 | msgid "Configured (but not required)" |
  | 3223 | 3699 | msgstr "" |
  | 3224 | 3700 |  |
  | 3225 |  | #: includes/classes/Utils/class-user-utils.php:35~~5~~ |
  |  | 3701 | #: includes/classes/Utils/class-user-utils.php:357 |
  | 3226 | 3702 | msgid "Not required & not configured" |
  | 3227 | 3703 | msgstr "" |
  | 3228 | 3704 |  |
  | 3229 |  | #: includes/classes/Utils/class-user-utils.php:356 |
  | 3230 |  | msgid "Not allowed" |
  | 3231 |  | msgstr "" |
  | 3232 |  |  |
  | 3233 |  | #: includes/classes/Utils/class-user-utils.php:357 |
  |  | 3705 | #: includes/classes/Utils/class-user-utils.php:359 |
  | 3234 | 3706 | msgid "Locked" |
  | 3235 | 3707 | msgstr "" |
  | 3236 | 3708 |  |
  | 3237 |  | #: includes/classes/Utils/class-user-utils.php:3~~58~~ |
  |  | 3709 | #: includes/classes/Utils/class-user-utils.php:360 |
  | 3238 | 3710 | msgid "User has not logged in yet, 2FA status is unknown" |
  | 3239 | 3711 | msgstr "" |
  | 3240 | 3712 |  |
  |  | 3713 | #: includes/functions/core.php:233 |
  |  | 3714 | msgid "Congratulations" |
  |  | 3715 | msgstr "" |
  |  | 3716 |  |
  |  | 3717 | #: includes/functions/core.php:234 |
  |  | 3718 | msgid "Your account just got more secure" |
  |  | 3719 | msgstr "" |
  |  | 3720 |  |
  |  | 3721 | #: includes/functions/core.php:235 |
  |  | 3722 | msgid "Close Wizard & Refresh" |
  |  | 3723 | msgstr "" |
  |  | 3724 |  |
  | 3241 | 3725 | #: includes/functions/core.php:236 |
  | 3242 |  | msgid "~~Congratulations~~" |
  |  | 3726 | msgid "Processing Update" |
  | 3243 | 3727 | msgstr "" |
  | 3244 | 3728 |  |
  | 3245 | 3729 | #: includes/functions/core.php:237 |
  | 3246 |  | msgid "~~Your account just got more secure~~" |
  |  | 3730 | msgid "Email successfully sent" |
  | 3247 | 3731 | msgstr "" |
  | 3248 | 3732 |  |
  | 3249 | 3733 | #: includes/functions/core.php:238 |
  | 3250 |  | msgid "Close Wizard & Refresh" |
  | 3251 |  | msgstr "" |
  | 3252 |  |  |
  | 3253 |  | #: includes/functions/core.php:239 |
  | 3254 |  | msgid "Processing Update" |
  |  | 3734 | msgid "Email delivery failed" |
  | 3255 | 3735 | msgstr "" |
  | 3256 | 3736 |  |
  | 3257 | 3737 | #: includes/functions/core.php:240 |
  | 3258 |  | ~~msgid "Email successfully sent"~~ |
  | 3259 |  | ~~msgstr ""~~ |
  | 3260 |  |  |
  | 3261 |  | ~~#: includes/functions/core.php:241~~ |
  | 3262 |  | ~~msgid "Email delivery failed"~~ |
  | 3263 |  | ~~msgstr ""~~ |
  | 3264 |  |  |
  | 3265 |  | ~~#: includes/functions/core.php:243~~ |
  | 3266 | 3738 | msgid "Validating your license, please wait..." |
  | 3267 | 3739 | msgstr "" |
  | 3268 | 3740 |  |
  | 3269 |  | #: wp-2fa.php:1~~51~~ |
  |  | 3741 | #: wp-2fa.php:164 |
  | 3270 | 3742 | msgid "This plugin requires OpenSSL. Contact your web host or website administrator so they can enable OpenSSL. Re-activate the plugin once the library has been enabled." |
  | 3271 | 3743 | msgstr "" |
* ## [wp-2fa/trunk/license.txt](/changeset/3009922/wp-2fa/trunk/license.txt "Show the changeset 3009922 restricted to wp-2fa/trunk/license.txt")

  | [r2656653](/browser/wp-2fa/trunk/license.txt?rev=2656653#L619 "Show revision 2656653 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/license.txt?rev=3009922#L619 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 619 | 619 | copy of the Program in return for a fee. |
  | 620 | 620 |  |
  |  | 621 | 18. Additional terms in accordance with Section 7. |
  |  | 622 |  |
  |  | 623 | In accordance with Section 7 of this License, the following additional |
  |  | 624 | terms apply: |
  |  | 625 |  |
  |  | 626 | a) You are prohibited from misrepresenting the the origin of the |
  |  | 627 | covered work. Modified versions of the covered work must be clearly |
  |  | 628 | marked as being different from the original version of the covered |
  |  | 629 | work; |
  |  | 630 |  |
  |  | 631 | b) Unless expressly agreed otherwise, you are not allowed to use the |
  |  | 632 | names of the author(s) or any of its licensors for publicity or |
  |  | 633 | marketing purposes; |
  |  | 634 |  |
  |  | 635 | c) Unless expressly agreed otherwise, you do not receive any rights |
  |  | 636 | with respect to trademark law, trade name law or comparable laws |
  |  | 637 | whatsoever. Unless expressly agreed otherwise, you are not entitled to |
  |  | 638 | use any trade name, trademark, service mark or similar belonging to the |
  |  | 639 | author(s) or its licensors for any purpose. |
  |  | 640 |  |
  |  | 641 | d) In the event you choose to convey the covered work or modified |
  |  | 642 | versions thereof, you are required to indemnify and hold harmless the |
  |  | 643 | author(s) and its licensors against any costs resulting from any |
  |  | 644 | contractual assumptions of liability of the author(s) or its licensors |
  |  | 645 | with regard to the covered work agreed on or implied by you. |
  |  | 646 |  |
  |  | 647 |  |
  | 621 | 648 | END OF TERMS AND CONDITIONS |
  | 622 | 649 |  |
* ## [wp-2fa/trunk/readme.txt](/changeset/3009922/wp-2fa/trunk/readme.txt "Show the changeset 3009922 restricted to wp-2fa/trunk/readme.txt")

  | [r3000342](/browser/wp-2fa/trunk/readme.txt?rev=3000342#L6 "Show revision 3000342 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/readme.txt?rev=3009922#L6 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tags: 2FA, two-factor authentication, multi-step authentication, 2-factor authentication, WordPress authentication, two-step authentication |
  | 7 | 7 | Requires at least: 5.0 |
  | 8 |  | Tested up to: 6.4.~~1~~ |
  | 9 |  | Stable tag: 2.~~5~~.0 |
  |  | 8 | Tested up to: 6.4.2 |
  |  | 9 | Stable tag: 2.6.0 |
  | 10 | 10 | Requires PHP: 7.2.0 |
  | 11 | 11 |  |
  | […](/browser/wp-2fa/trunk/readme.txt?rev=3000342#L115) | […](/browser/wp-2fa/trunk/readme.txt?rev=3009922#L115) |  |
  | 115 | 115 | == Changelog == |
  | 116 | 116 |  |
  | 117 |  | ~~= 2.5.0 (2023-07-20~~) = |
  |  | 117 | 2.6.0 (2023-12-14) = |
  | 118 | 118 |  |
  | 119 |  | Release notes: [~~2FA for password resets, more branding options for the 2FA code page &~~ much more](https://melapress.com/wordpress-2fa/releases/) |
  |  | 119 | Release notes: [QR Code viewer, plugin settings export/import tool, and much more](https://melapress.com/wordpress-2fa/releases/) |
  | 120 | 120 |  |
  | 121 | 121 | \* \*\*New features\*\* |
  | 122 |  | \* Require 2FA on user reset password. |
  | 123 |  | \* CSS editor for the 2FA code page, allowing users to also apply their CSS to the 2FA login page. |
  | 124 |  | \* Front-end 2FA support for multisite network - the plugin creates a front-end 2FA page for every subsite on the network. |
  | 125 |  | \* User licensing tab in the plugin settings, allowing admins to see the number of users and websites using user-activations. |
  |  | 122 | \* QR code viewer - users can now see the QR code used to set up TOTP, allowing them to add their user 2FA setup on multiple devices. |
  |  | 123 | \* New setting to show generic message VS method specific message in the 2FA code page. |
  |  | 124 |  |
  |  | 125 | \* \*\*Security fixes\*\* |
  |  | 126 | \* Fixed an Insecure direct object through which a subscriber-level attacker can email arbitrary users on the site - reported by Ulyses Saicha. |
  |  | 127 | \* Fixed a Cross-site request forgery which makes it possible for unauthenticated attackers to send emails with arbitrary content to registered users via a forged request and can trick a users into clicking on a link - reported by Ulyses Saicha. |
  | 126 | 128 |  |
  | 127 | 129 | \* \*\*Improvements\*\* |
  | 128 |  | \* Disabled auto complete in the 2FA code placeholder. |
  | 129 |  | \* User private key is regenerated each time they start the 2FA setup process and they do not finish it. |
  | 130 |  | \* Backup code email template added to editable email templates. |
  | 131 |  | \* Email tags are populated even test emails. |
  | 132 |  | \* Updated the "user count" licensing logic on multisite networks - now the plugin counts the users on the network (more accurate). |
  | 133 |  | \* Full compatability with Flywheel's and WP Engine's seamless sign-on (no sign on is required). |
  | 134 |  | \* Revised and improved the text used in the 2FA SMS login process. |
  | 135 |  | \* Added all SMS 2FA text (used in wizards, login pages etc) to the whitelabelling options. |
  | 136 |  | \* Removed the 2FA plugin menu completely when access to the plugin is restricted to certain website admins. |
  | 137 |  | \* Added more strings to the Whitelabelling options. |
  | 138 |  | \* Removed a number of font files from the QR library since no text is used and it makes the plugin size smaller. |
  | 139 |  | \* Select2 library is now shipped directly with the plugin instead of it being downloaded from a CDN. |
  | 140 |  | \* Applied a number of performance improvements to the plugin - the loading mechanism is more efficient and determining when the plugin is needed and when not. |
  | 141 |  | \* Plugin no longer loads on the front-end part of the website - only on the shortcode page. |
  | 142 |  | \* Removed a number of JS and CSS scripts that were loading on the frontend and were made redundand. |
  | 143 |  | \* Full support for multsite networks using different domains for subsites - users are no longer required to access the network dashboad to set up 2FA. |
  | 144 |  | \* Improved the CSS in the whitelabelling settings so all the text in the 2FA code page can be edited, recoloured etc. |
  | 145 |  | \* Removed some code that was left in the plugin for backward compatability (no longer required at this stage). |
  | 146 |  | \* Removed all third party's admin notices from the plugin settings pages. |
  | 147 |  | \* The 2FA usage reports have also been improved so they report accurate numbers on a multsite network. |
  | 148 |  | \* Improved a number of error and users messages in the plugin. |
  | 149 |  | \* Updated the CSS of the backup codes wizard page to have the buttons all in one line. |
  | 150 |  | \* Plugin now automatically removes the extra space at the end of the one-time code if entered in the 2FA code prompt. |
  | 151 |  | \* Updated the CSS of the plugin's own admin notices so they fit better within the plugin's UI. |
  | 152 |  | \* Improved the text used in the wizards, especially the text used when setting up alternative 2FA methods. |
  | 153 |  | \* All plugin strings are now available on WPML. |
  | 154 |  | \* Plugin now displays the Twilio service error directly in the wizard when there are issues with the Twilio setup. |
  |  | 130 | \* Added "from-email address" checks + notifications to help improve email deliverability (and user configuration). |
  |  | 131 | \* Updated plugin code so it is compatible with WP Activity Log (in preparation for activity logs for WP 2FA). |
  |  | 132 | \* Changed the text fields placeholders in the White labeling section of the free edition to the standard WordPress editor. |
  |  | 133 | \* Improved support for Memberpress plugin - now the plugin has out-of-the-box support for Memberpress. |
  |  | 134 | \* Added JSON errors and improved JS for handling emails (required to report back email problems to user). |
  |  | 135 | \* Added user ID extraction in the settings store logic for more efficiency. |
  |  | 136 | \* 2FA user setup information now shown in user profile page. |
  |  | 137 | \* Added the Cancel button to all modals (accessibility improvement). |
  |  | 138 | \* Return key can be used now as a click (accessibility improvement). |
  |  | 139 | \* Made more strings available in the translation files. |
  |  | 140 | \* Standardized more components in the UI, such as drop down menu's, placeholders etc. |
  |  | 141 | \* Removed pluggable.php (WordPress core file) from the plugin. |
  |  | 142 | \* Added more UI checks in the 2FA policies section to improve UX. |
  |  | 143 | \* Added more sanitaziation checks to placeholders in the install wizard to improve the UX. |
  |  | 144 | \* Updated the Help page with new plugin icons and branding. |
  |  | 145 | \* Added more checks in the 2FA policies configuration so the same role or user cannot be included and excluded at the same time. |
  |  | 146 | \* Unified / centralized all nonce code - now we have just one mothed used to generate / manage nonce when needed. |
  |  | 147 | \* Improved the text and help text in the plugin. |
  |  | 148 | \* Improved support for WP Engine's Smart plugin manager. |
  |  | 149 | \* Updated the License.txt file with the latest version. |
  | 155 | 150 |  |
  | 156 | 151 | \* \*\*Bug fixes\*\* |
  | 157 |  | \* Fixed: Cannot change the users phone number on Twilio unless you reset the 2FA configuration. |
  | 158 |  | \* Fixed: In some edge cases admins were unable to access the plugin settings, instead they were shown the policies page. |
  | 159 |  | \* Fixed: WP 2FA disconnects ManageWP sessions. |
  | 160 |  | \* Fixed: Rest 2FA configuration button in user profile missing when the license quota is reached. |
  | 161 |  | \* Fixed: Premium plugin ads still showing when Premium edition is activated on a multisite network. |
  | 162 |  | \* Fixed: The 2FA code page styling was not being saved when only changing the 2FA button colour. |
  | 163 |  | \* Fixed: Number of PHP warnings are triggered when WP 2FA is installed alongside Melapress Login Security. |
  | 164 |  | \* Fixed: Expired license on multisite network leads to a blockage of logins. |
  | 165 |  | \* Fixed: "Remember this device for 0 days" string shows up on the login page after rebranding the page (whitelabelling). |
  | 166 |  | \* Fixed: On some cases the users were not prompted for 2FA in the /my-account page on WooCommerce. |
  | 167 |  | \* Fixed: Plugin's private key not stored in wp-config.php file after permissions are updated. |
  | 168 |  | \* Fixed: Subscribers are not asked to set up 2FA even when 2FA is enforced when registering on a multisite network without subsites. |
  | 169 |  | \* Fixed a number of PHP notices when running the plugin on a multisite network with a specific PHP version (older versions). |
  | 170 |  | \* Fixed: Users can't set up SMS 2FA (over Twilio) after the grace period expires. |
  | 171 |  |  |
  |  | 152 | \* Fixed: fatal error when using Advanced Custom Fields Pro + WP 2FA and enforce 2FA on users. |
  |  | 153 | \* Fixed: user's email address not updated after user set 2FA and changed the email address. |
  |  | 154 | \* Fixed: User's 2FA email address not updated when the WordPress user email address is changed. |
  |  | 155 | \* Fixed: "Settings saved" prompt only goes away on refresh, cannot be closed by clicking the close "x" icon. |
  |  | 156 | \* Fixed: users on multisite who already authenticated via 2FA asked for 2FA code when switching between subsites. |
  |  | 157 | \* Fixed: in some edge cases, the super admin of a multisite network cannot remove own 2FA configuration or reconfigure. |
  |  | 158 | \* Fixed: in certain setups users are shown 2FA enforcement message when 2FA is enforced and they log in via a trusted device. |
  |  | 159 | \* Fixed a number of PHP warnings (improving compatability with PHP 8.X). |
  |  | 160 | \* Fixed: fatal error accessing website via InstaWP's magic login feature. |
  |  | 161 | \* The WP 2FA's custom CSS feature can now be disabled on multisites. |
  |  | 162 | \* Fixed: Front end 2FA page URL on 2FA notice "configure 2FA now" button was not updated dynamically once changed. |
  |  | 163 | \* Fixed: Some edge case scenarios on multi sites  where "Subscriber" was not enforced 2FA on first-time log in. |
  |  | 164 |  |
  | 172 | 165 | Refer to the complete [plugin changelog](https://melapress.com/support/kb/wp-2fa-plugin-changelog/?utm\_source=wordpress.org&utm\_medium=referral&utm\_campaign=WP2FA&utm\_content=plugin+repos+description) for more detailed information about what was new, improved and fixed in previous version updates of WP 2FA. |
* ## [wp-2fa/trunk/vendor/autoload.php](/changeset/3009922/wp-2fa/trunk/vendor/autoload.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/autoload.php")

  | [r2940688](/browser/wp-2fa/trunk/vendor/autoload.php?rev=2940688#L23 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/autoload.php?rev=3009922#L23 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 24 | 24 |  |
  | 25 |  | return ComposerAutoloaderInit~~4fd7a1761d28d8acd2e03dc52649fc30~~::getLoader(); |
  |  | 25 | return ComposerAutoloaderInit7308e0c95228d04f55d9943b5008262f::getLoader(); |
* ## [wp-2fa/trunk/vendor/composer/ClassLoader.php](/changeset/3009922/wp-2fa/trunk/vendor/composer/ClassLoader.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/ClassLoader.php")

  | [r2934352](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L46 "Show revision 2934352 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L46 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 46 | 46 | private static $includeFile; |
  | 47 | 47 |  |
  | 48 |  | /\*\* @var ~~?string~~ \*/ |
  |  | 48 | /\*\* @var string|null \*/ |
  | 49 | 49 | private $vendorDir; |
  | 50 | 50 |  |
  | 51 | 51 | // PSR-4 |
  | 52 | 52 | /\*\* |
  | 53 |  | \* @var array[] |
  | 54 |  | \* @psalm-var array<string, array<string, int>> |
  |  | 53 | \* @var array<string, array<string, int>> |
  | 55 | 54 | \*/ |
  | 56 | 55 | private $prefixLengthsPsr4 = array(); |
  | 57 | 56 | /\*\* |
  | 58 |  | \* @var array[] |
  | 59 |  | \* @psalm-var array<string, array<int, string>> |
  |  | 57 | \* @var array<string, list<string>> |
  | 60 | 58 | \*/ |
  | 61 | 59 | private $prefixDirsPsr4 = array(); |
  | 62 | 60 | /\*\* |
  | 63 |  | \* @var array[] |
  | 64 |  | \* @psalm-var array<string, string> |
  |  | 61 | \* @var list<string> |
  | 65 | 62 | \*/ |
  | 66 | 63 | private $fallbackDirsPsr4 = array(); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L68) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L65) |  |
  | 68 | 65 | // PSR-0 |
  | 69 | 66 | /\*\* |
  | 70 |  | \* @var array[] |
  | 71 |  | \* @psalm-var array<string, array<string, string[]>> |
  |  | 67 | \* List of PSR-0 prefixes |
  |  | 68 | \* |
  |  | 69 | \* Structured as array('F (first letter)' => array('Foo\Bar (full prefix)' => array('path', 'path2'))) |
  |  | 70 | \* |
  |  | 71 | \* @var array<string, array<string, list<string>>> |
  | 72 | 72 | \*/ |
  | 73 | 73 | private $prefixesPsr0 = array(); |
  | 74 | 74 | /\*\* |
  | 75 |  | \* @var array[] |
  | 76 |  | \* @psalm-var array<string, string> |
  |  | 75 | \* @var list<string> |
  | 77 | 76 | \*/ |
  | 78 | 77 | private $fallbackDirsPsr0 = array(); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L82) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L81) |  |
  | 82 | 81 |  |
  | 83 | 82 | /\*\* |
  | 84 |  | \* @var string[] |
  | 85 |  | \* @psalm-var array<string, string> |
  |  | 83 | \* @var array<string, string> |
  | 86 | 84 | \*/ |
  | 87 | 85 | private $classMap = array(); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L91) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L89) |  |
  | 91 | 89 |  |
  | 92 | 90 | /\*\* |
  | 93 |  | \* @var bool[] |
  | 94 |  | \* @psalm-var array<string, bool> |
  |  | 91 | \* @var array<string, bool> |
  | 95 | 92 | \*/ |
  | 96 | 93 | private $missingClasses = array(); |
  | 97 | 94 |  |
  | 98 |  | /\*\* @var ~~?string~~ \*/ |
  |  | 95 | /\*\* @var string|null \*/ |
  | 99 | 96 | private $apcuPrefix; |
  | 100 | 97 |  |
  | 101 | 98 | /\*\* |
  | 102 |  | \* @var ~~self[]~~ |
  |  | 99 | \* @var array<string, self> |
  | 103 | 100 | \*/ |
  | 104 | 101 | private static $registeredLoaders = array(); |
  | 105 | 102 |  |
  | 106 | 103 | /\*\* |
  | 107 |  | \* @param ~~?string~~ $vendorDir |
  |  | 104 | \* @param string|null $vendorDir |
  | 108 | 105 | \*/ |
  | 109 | 106 | public function \_\_construct($vendorDir = null) |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L114) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L111) |  |
  | 114 | 111 |  |
  | 115 | 112 | /\*\* |
  | 116 |  | \* @return ~~string[]~~ |
  |  | 113 | \* @return array<string, list<string>> |
  | 117 | 114 | \*/ |
  | 118 | 115 | public function getPrefixes() |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L126) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L123) |  |
  | 126 | 123 |  |
  | 127 | 124 | /\*\* |
  | 128 |  | \* @return array[] |
  | 129 |  | \* @psalm-return array<string, array<int, string>> |
  |  | 125 | \* @return array<string, list<string>> |
  | 130 | 126 | \*/ |
  | 131 | 127 | public function getPrefixesPsr4() |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L135) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L131) |  |
  | 135 | 131 |  |
  | 136 | 132 | /\*\* |
  | 137 |  | \* @return array[] |
  | 138 |  | \* @psalm-return array<string, string> |
  |  | 133 | \* @return list<string> |
  | 139 | 134 | \*/ |
  | 140 | 135 | public function getFallbackDirs() |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L144) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L139) |  |
  | 144 | 139 |  |
  | 145 | 140 | /\*\* |
  | 146 |  | \* @return array[] |
  | 147 |  | \* @psalm-return array<string, string> |
  |  | 141 | \* @return list<string> |
  | 148 | 142 | \*/ |
  | 149 | 143 | public function getFallbackDirsPsr4() |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L153) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L147) |  |
  | 153 | 147 |  |
  | 154 | 148 | /\*\* |
  | 155 |  | \* @return string[] Array of classname => path |
  | 156 |  | \* @psalm-return array<string, string> |
  |  | 149 | \* @return array<string, string> Array of classname => path |
  | 157 | 150 | \*/ |
  | 158 | 151 | public function getClassMap() |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L162) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L155) |  |
  | 162 | 155 |  |
  | 163 | 156 | /\*\* |
  | 164 |  | \* @param string[] $classMap Class to filename map |
  | 165 |  | \* @psalm-param array<string, string> $classMap |
  |  | 157 | \* @param array<string, string> $classMap Class to filename map |
  | 166 | 158 | \* |
  | 167 | 159 | \* @return void |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L180) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L172) |  |
  | 180 | 172 | \* appending or prepending to the ones previously set for this prefix. |
  | 181 | 173 | \* |
  | 182 |  | \* @param string          $prefix  The prefix |
  | 183 |  | \* @param ~~string[]~~|string $paths   The PSR-0 root directories |
  | 184 |  | \* @param bool            $prepend Whether to prepend the directories |
  |  | 174 | \* @param string              $prefix  The prefix |
  |  | 175 | \* @param list<string>|string $paths   The PSR-0 root directories |
  |  | 176 | \* @param bool                $prepend Whether to prepend the directories |
  | 185 | 177 | \* |
  | 186 | 178 | \* @return void |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L188) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L180) |  |
  | 188 | 180 | public function add($prefix, $paths, $prepend = false) |
  | 189 | 181 | { |
  |  | 182 | $paths = (array) $paths; |
  | 190 | 183 | if (!$prefix) { |
  | 191 | 184 | if ($prepend) { |
  | 192 | 185 | $this->fallbackDirsPsr0 = array\_merge( |
  | 193 |  | ~~(array)~~ $paths, |
  |  | 186 | $paths, |
  | 194 | 187 | $this->fallbackDirsPsr0 |
  | 195 | 188 | ); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L197) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L190) |  |
  | 197 | 190 | $this->fallbackDirsPsr0 = array\_merge( |
  | 198 | 191 | $this->fallbackDirsPsr0, |
  | 199 |  | ~~(array)~~ $paths |
  |  | 192 | $paths |
  | 200 | 193 | ); |
  | 201 | 194 | } |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L206) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L199) |  |
  | 206 | 199 | $first = $prefix[0]; |
  | 207 | 200 | if (!isset($this->prefixesPsr0[$first][$prefix])) { |
  | 208 |  | $this->prefixesPsr0[$first][$prefix] = ~~(array)~~ $paths; |
  |  | 201 | $this->prefixesPsr0[$first][$prefix] = $paths; |
  | 209 | 202 |  |
  | 210 | 203 | return; |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L212) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L205) |  |
  | 212 | 205 | if ($prepend) { |
  | 213 | 206 | $this->prefixesPsr0[$first][$prefix] = array\_merge( |
  | 214 |  | ~~(array)~~ $paths, |
  |  | 207 | $paths, |
  | 215 | 208 | $this->prefixesPsr0[$first][$prefix] |
  | 216 | 209 | ); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L218) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L211) |  |
  | 218 | 211 | $this->prefixesPsr0[$first][$prefix] = array\_merge( |
  | 219 | 212 | $this->prefixesPsr0[$first][$prefix], |
  | 220 |  | ~~(array)~~ $paths |
  |  | 213 | $paths |
  | 221 | 214 | ); |
  | 222 | 215 | } |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L227) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L220) |  |
  | 227 | 220 | \* appending or prepending to the ones previously set for this namespace. |
  | 228 | 221 | \* |
  | 229 |  | \* @param string          $prefix  The prefix/namespace, with trailing '\\' |
  | 230 |  | \* @param ~~string[]~~|string $paths   The PSR-4 base directories |
  | 231 |  | \* @param bool            $prepend Whether to prepend the directories |
  |  | 222 | \* @param string              $prefix  The prefix/namespace, with trailing '\\' |
  |  | 223 | \* @param list<string>|string $paths   The PSR-4 base directories |
  |  | 224 | \* @param bool                $prepend Whether to prepend the directories |
  | 232 | 225 | \* |
  | 233 | 226 | \* @throws \InvalidArgumentException |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L237) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L230) |  |
  | 237 | 230 | public function addPsr4($prefix, $paths, $prepend = false) |
  | 238 | 231 | { |
  |  | 232 | $paths = (array) $paths; |
  | 239 | 233 | if (!$prefix) { |
  | 240 | 234 | // Register directories for the root namespace. |
  | 241 | 235 | if ($prepend) { |
  | 242 | 236 | $this->fallbackDirsPsr4 = array\_merge( |
  | 243 |  | ~~(array)~~ $paths, |
  |  | 237 | $paths, |
  | 244 | 238 | $this->fallbackDirsPsr4 |
  | 245 | 239 | ); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L247) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L241) |  |
  | 247 | 241 | $this->fallbackDirsPsr4 = array\_merge( |
  | 248 | 242 | $this->fallbackDirsPsr4, |
  | 249 |  | ~~(array)~~ $paths |
  |  | 243 | $paths |
  | 250 | 244 | ); |
  | 251 | 245 | } |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L257) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L251) |  |
  | 257 | 251 | } |
  | 258 | 252 | $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length; |
  | 259 |  | $this->prefixDirsPsr4[$prefix] = ~~(array)~~ $paths; |
  |  | 253 | $this->prefixDirsPsr4[$prefix] = $paths; |
  | 260 | 254 | } elseif ($prepend) { |
  | 261 | 255 | // Prepend directories for an already registered namespace. |
  | 262 | 256 | $this->prefixDirsPsr4[$prefix] = array\_merge( |
  | 263 |  | ~~(array)~~ $paths, |
  |  | 257 | $paths, |
  | 264 | 258 | $this->prefixDirsPsr4[$prefix] |
  | 265 | 259 | ); |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L268) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L262) |  |
  | 268 | 262 | $this->prefixDirsPsr4[$prefix] = array\_merge( |
  | 269 | 263 | $this->prefixDirsPsr4[$prefix], |
  | 270 |  | ~~(array)~~ $paths |
  |  | 264 | $paths |
  | 271 | 265 | ); |
  | 272 | 266 | } |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L277) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L271) |  |
  | 277 | 271 | \* replacing any others previously set for this prefix. |
  | 278 | 272 | \* |
  | 279 |  | \* @param string          $prefix The prefix |
  | 280 |  | \* @param ~~string[]~~|string $paths  The PSR-0 base directories |
  |  | 273 | \* @param string              $prefix The prefix |
  |  | 274 | \* @param list<string>|string $paths  The PSR-0 base directories |
  | 281 | 275 | \* |
  | 282 | 276 | \* @return void |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L295) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L289) |  |
  | 295 | 289 | \* replacing any others previously set for this namespace. |
  | 296 | 290 | \* |
  | 297 |  | \* @param string          $prefix The prefix/namespace, with trailing '\\' |
  | 298 |  | \* @param ~~string[]~~|string $paths  The PSR-4 base directories |
  |  | 291 | \* @param string              $prefix The prefix/namespace, with trailing '\\' |
  |  | 292 | \* @param list<string>|string $paths  The PSR-4 base directories |
  | 299 | 293 | \* |
  | 300 | 294 | \* @throws \InvalidArgumentException |
  | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=2934352#L482) | […](/browser/wp-2fa/trunk/vendor/composer/ClassLoader.php?rev=3009922#L476) |  |
  | 482 | 476 |  |
  | 483 | 477 | /\*\* |
  | 484 |  | \* Returns the currently registered loaders ~~index~~ed by their corresponding vendor directories. |
  | 485 |  | \* |
  | 486 |  | \* @return ~~self[]~~ |
  |  | 478 | \* Returns the currently registered loaders keyed by their corresponding vendor directories. |
  |  | 479 | \* |
  |  | 480 | \* @return array<string, self> |
  | 487 | 481 | \*/ |
  | 488 | 482 | public static function getRegisteredLoaders() |
* ## [wp-2fa/trunk/vendor/composer/InstalledVersions.php](/changeset/3009922/wp-2fa/trunk/vendor/composer/InstalledVersions.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/InstalledVersions.php")

  | [r2940688](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=2940688#L88 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=3009922#L88 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 88 | 88 | foreach (self::getInstalled() as $installed) { |
  | 89 | 89 | if (isset($installed['versions'][$packageName])) { |
  | 90 |  | return $includeDevRequirements || ~~empty($installed['versions'][$packageName]['dev\_requirement'])~~; |
  |  | 90 | return $includeDevRequirements || !isset($installed['versions'][$packageName]['dev\_requirement']) || $installed['versions'][$packageName]['dev\_requirement'] === \false; |
  | 91 | 91 | } |
  | 92 | 92 | } |
  | […](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=2940688#L107) | […](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=3009922#L107) |  |
  | 107 | 107 | public static function satisfies(VersionParser $parser, $packageName, $constraint) |
  | 108 | 108 | { |
  | 109 |  | $constraint = $parser->parseConstraints($constraint); |
  |  | 109 | $constraint = $parser->parseConstraints((string) $constraint); |
  | 110 | 110 | $provided = $parser->parseConstraints(self::getVersionRanges($packageName)); |
  | 111 | 111 | return $provided->matches($constraint); |
  | […](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=2940688#L286) | […](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=3009922#L286) |  |
  | 286 | 286 | $installed[] = self::$installedByVendor[$vendorDir]; |
  | 287 | 287 | } elseif (\is\_file($vendorDir . '/composer/installed.php')) { |
  | 288 |  | $installed[] = self::$installedByVendor[$vendorDir] = (require $vendorDir . '/composer/installed.php'); |
  |  | 288 | /\*\* @var array{root: array{name: string, pretty\_version: string, version: string, reference: string|null, type: string, install\_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty\_version?: string, version?: string, reference?: string|null, type?: string, install\_path?: string, aliases?: string[], dev\_requirement: bool, replaced?: string[], provided?: string[]}>} $required \*/ |
  |  | 289 | $required = (require $vendorDir . '/composer/installed.php'); |
  |  | 290 | $installed[] = self::$installedByVendor[$vendorDir] = $required; |
  | 289 | 291 | if (null === self::$installed && \strtr($vendorDir . '/composer', '\\', '/') === \strtr(\_\_DIR\_\_, '\\', '/')) { |
  | 290 | 292 | self::$installed = $installed[\count($installed) - 1]; |
  | […](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=2940688#L297) | […](/browser/wp-2fa/trunk/vendor/composer/InstalledVersions.php?rev=3009922#L299) |  |
  | 297 | 299 | // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937 |
  | 298 | 300 | if (\substr(\_\_DIR\_\_, -8, 1) !== 'C') { |
  | 299 |  | self::$installed = (require \_\_DIR\_\_ . '/installed.php'); |
  |  | 301 | /\*\* @var array{root: array{name: string, pretty\_version: string, version: string, reference: string|null, type: string, install\_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty\_version?: string, version?: string, reference?: string|null, type?: string, install\_path?: string, aliases?: string[], dev\_requirement: bool, replaced?: string[], provided?: string[]}>} $required \*/ |
  |  | 302 | $required = (require \_\_DIR\_\_ . '/installed.php'); |
  |  | 303 | self::$installed = $required; |
  | 300 | 304 | } else { |
  | 301 | 305 | self::$installed = array(); |
  | 302 | 306 | } |
  | 303 | 307 | } |
  | 304 |  | $installed[] = self::$installed; |
  |  | 308 | if (self::$installed !== array()) { |
  |  | 309 | $installed[] = self::$installed; |
  |  | 310 | } |
  | 305 | 311 | return $installed; |
  | 306 | 312 | } |
* ## [wp-2fa/trunk/vendor/composer/autoload\_classmap.php](/changeset/3009922/wp-2fa/trunk/vendor/composer/autoload_classmap.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/autoload_classmap.php")

  | [r2940688](/browser/wp-2fa/trunk/vendor/composer/autoload_classmap.php?rev=2940688#L11 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/autoload_classmap.php?rev=3009922#L11 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | 'WP2FA\\Admin\\Controllers\\Settings' => $baseDir . '/includes/classes/Admin/Controllers/class-settings.php', |
  | 12 | 12 | 'WP2FA\\Admin\\Help\_Contact\_Us' => $baseDir . '/includes/classes/Admin/class-help-contact-us.php', |
  |  | 13 | 'WP2FA\\Admin\\Helpers\\Ajax\_Helper' => $baseDir . '/includes/classes/Admin/Helpers/class-ajax-helper.php', |
  | 13 | 14 | 'WP2FA\\Admin\\Helpers\\Classes\_Helper' => $baseDir . '/includes/classes/Admin/Helpers/class-classes-helper.php', |
  | 14 | 15 | 'WP2FA\\Admin\\Helpers\\File\_Writer' => $baseDir . '/includes/classes/Admin/Helpers/class-file-writer.php', |
  |  | 16 | 'WP2FA\\Admin\\Helpers\\Methods\_Helper' => $baseDir . '/includes/classes/Admin/Helpers/class-methods-helper.php', |
  | 15 | 17 | 'WP2FA\\Admin\\Helpers\\PHP\_Helper' => $baseDir . '/includes/classes/Admin/Helpers/class-php-helper.php', |
  | 16 | 18 | 'WP2FA\\Admin\\Helpers\\User\_Helper' => $baseDir . '/includes/classes/Admin/Helpers/class-user-helper.php', |
  | 17 | 19 | 'WP2FA\\Admin\\Helpers\\WP\_Helper' => $baseDir . '/includes/classes/Admin/Helpers/class-wp-helper.php', |
  | 18 | 20 | 'WP2FA\\Admin\\Methods\\Traits\\Login\_Attempts' => $baseDir . '/includes/classes/Admin/Methods/Traits/class-login-attempts.php', |
  |  | 21 | 'WP2FA\\Admin\\Methods\\Traits\\Methods\_Wizards\_Trait' => $baseDir . '/includes/classes/Admin/Methods/Traits/class-methods-wizards-trait.php', |
  | 19 | 22 | 'WP2FA\\Admin\\Premium\_Features' => $baseDir . '/includes/classes/Admin/class-premium-features.php', |
  | 20 | 23 | 'WP2FA\\Admin\\SettingsPages\\Settings\_Page\_Email' => $baseDir . '/includes/classes/Admin/SettingsPages/class-settings-page-email.php', |
  | […](/browser/wp-2fa/trunk/vendor/composer/autoload_classmap.php?rev=2940688#L74) | […](/browser/wp-2fa/trunk/vendor/composer/autoload_classmap.php?rev=3009922#L77) |  |
  | 74 | 77 |  |
  | 75 | 78 |  |
  |  | 79 |  |
  |  | 80 |  |
  | 76 | 81 | 'WP2FA\\Methods\\Backup\_Codes' => $baseDir . '/includes/classes/Admin/Methods/class-backup-codes.php', |
  |  | 82 | 'WP2FA\\Methods\\Email' => $baseDir . '/includes/classes/Admin/Methods/class-email.php', |
  |  | 83 | 'WP2FA\\Methods\\TOTP' => $baseDir . '/includes/classes/Admin/Methods/class-totp.php', |
  |  | 84 | 'WP2FA\\Methods\\Wizards\\Email\_Wizard\_Steps' => $baseDir . '/includes/classes/Admin/Methods/class-email-wizard-steps.php', |
  |  | 85 | 'WP2FA\\Methods\\Wizards\\TOTP\_Wizard\_Steps' => $baseDir . '/includes/classes/Admin/Methods/class-totp-wizard-steps.php', |
  | 77 | 86 | 'WP2FA\\Shortcodes\\Shortcodes' => $baseDir . '/includes/classes/Shortcodes/class-shortcodes.php', |
  | 78 | 87 | 'WP2FA\\Utils\\Abstract\_Migration' => $baseDir . '/includes/classes/Utils/class-abstract-migration.php', |
* ## [wp-2fa/trunk/vendor/composer/autoload\_real.php](/changeset/3009922/wp-2fa/trunk/vendor/composer/autoload_real.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/autoload_real.php")

  | [r2940688](/browser/wp-2fa/trunk/vendor/composer/autoload_real.php?rev=2940688#L3 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/autoload_real.php?rev=3009922#L3 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_real.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | class ComposerAutoloaderInit~~4fd7a1761d28d8acd2e03dc52649fc30~~ |
  |  | 5 | class ComposerAutoloaderInit7308e0c95228d04f55d9943b5008262f |
  | 6 | 6 | { |
  | 7 | 7 | private static $loader; |
  | […](/browser/wp-2fa/trunk/vendor/composer/autoload_real.php?rev=2940688#L25) | […](/browser/wp-2fa/trunk/vendor/composer/autoload_real.php?rev=3009922#L25) |  |
  | 25 | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  | 26 | 26 |  |
  | 27 |  | spl\_autoload\_register(array('ComposerAutoloaderInit~~4fd7a1761d28d8acd2e03dc52649fc30~~', 'loadClassLoader'), true, true); |
  |  | 27 | spl\_autoload\_register(array('ComposerAutoloaderInit7308e0c95228d04f55d9943b5008262f', 'loadClassLoader'), true, true); |
  | 28 | 28 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\_\_DIR\_\_)); |
  | 29 |  | spl\_autoload\_unregister(array('ComposerAutoloaderInit~~4fd7a1761d28d8acd2e03dc52649fc30~~', 'loadClassLoader')); |
  |  | 29 | spl\_autoload\_unregister(array('ComposerAutoloaderInit7308e0c95228d04f55d9943b5008262f', 'loadClassLoader')); |
  | 30 | 30 |  |
  | 31 | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 32 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInit~~4fd7a1761d28d8acd2e03dc52649fc30~~::getInitializer($loader)); |
  |  | 32 | call\_user\_func(\Composer\Autoload\ComposerStaticInit7308e0c95228d04f55d9943b5008262f::getInitializer($loader)); |
  | 33 | 33 |  |
  | 34 | 34 | $loader->register(true); |
  | 35 | 35 |  |
  | 36 |  | $filesToLoad = \Composer\Autoload\ComposerStaticInit~~4fd7a1761d28d8acd2e03dc52649fc30~~::$files; |
  |  | 36 | $filesToLoad = \Composer\Autoload\ComposerStaticInit7308e0c95228d04f55d9943b5008262f::$files; |
  | 37 | 37 | $requireFile = \Closure::bind(static function ($fileIdentifier, $file) { |
  | 38 | 38 | if (empty($GLOBALS['\_\_composer\_autoload\_files'][$fileIdentifier])) { |
* ## [wp-2fa/trunk/vendor/composer/autoload\_static.php](/changeset/3009922/wp-2fa/trunk/vendor/composer/autoload_static.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/autoload_static.php")

  | [r2940688](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=2940688#L5 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=3009922#L5 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | namespace Composer\Autoload; |
  | 6 | 6 |  |
  | 7 |  | class ComposerStaticInit~~4fd7a1761d28d8acd2e03dc52649fc30~~ |
  |  | 7 | class ComposerStaticInit7308e0c95228d04f55d9943b5008262f |
  | 8 | 8 | { |
  | 9 | 9 | public static $files = array ( |
  | […](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=2940688#L80) | […](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=3009922#L80) |  |
  | 80 | 80 | 'WP2FA\\Admin\\Controllers\\Settings' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Controllers/class-settings.php', |
  | 81 | 81 | 'WP2FA\\Admin\\Help\_Contact\_Us' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/class-help-contact-us.php', |
  |  | 82 | 'WP2FA\\Admin\\Helpers\\Ajax\_Helper' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-ajax-helper.php', |
  | 82 | 83 | 'WP2FA\\Admin\\Helpers\\Classes\_Helper' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-classes-helper.php', |
  | 83 | 84 | 'WP2FA\\Admin\\Helpers\\File\_Writer' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-file-writer.php', |
  |  | 85 | 'WP2FA\\Admin\\Helpers\\Methods\_Helper' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-methods-helper.php', |
  | 84 | 86 | 'WP2FA\\Admin\\Helpers\\PHP\_Helper' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-php-helper.php', |
  | 85 | 87 | 'WP2FA\\Admin\\Helpers\\User\_Helper' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-user-helper.php', |
  | 86 | 88 | 'WP2FA\\Admin\\Helpers\\WP\_Helper' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Helpers/class-wp-helper.php', |
  | 87 | 89 | 'WP2FA\\Admin\\Methods\\Traits\\Login\_Attempts' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/Traits/class-login-attempts.php', |
  |  | 90 | 'WP2FA\\Admin\\Methods\\Traits\\Methods\_Wizards\_Trait' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/Traits/class-methods-wizards-trait.php', |
  | 88 | 91 | 'WP2FA\\Admin\\Premium\_Features' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/class-premium-features.php', |
  | 89 | 92 | 'WP2FA\\Admin\\SettingsPages\\Settings\_Page\_Email' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/SettingsPages/class-settings-page-email.php', |
  | […](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=2940688#L143) | […](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=3009922#L146) |  |
  | 143 | 146 |  |
  | 144 | 147 |  |
  |  | 148 |  |
  |  | 149 |  |
  | 145 | 150 | 'WP2FA\\Methods\\Backup\_Codes' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/class-backup-codes.php', |
  |  | 151 | 'WP2FA\\Methods\\Email' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/class-email.php', |
  |  | 152 | 'WP2FA\\Methods\\TOTP' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/class-totp.php', |
  |  | 153 | 'WP2FA\\Methods\\Wizards\\Email\_Wizard\_Steps' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/class-email-wizard-steps.php', |
  |  | 154 | 'WP2FA\\Methods\\Wizards\\TOTP\_Wizard\_Steps' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Admin/Methods/class-totp-wizard-steps.php', |
  | 146 | 155 | 'WP2FA\\Shortcodes\\Shortcodes' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Shortcodes/class-shortcodes.php', |
  | 147 | 156 | 'WP2FA\\Utils\\Abstract\_Migration' => \_\_DIR\_\_ . '/../..' . '/includes/classes/Utils/class-abstract-migration.php', |
  | […](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=2940688#L160) | […](/browser/wp-2fa/trunk/vendor/composer/autoload_static.php?rev=3009922#L169) |  |
  | 160 | 169 | { |
  | 161 | 170 | return \Closure::bind(function () use ($loader) { |
  | 162 |  | $loader->prefixLengthsPsr4 = ComposerStaticInit~~4fd7a1761d28d8acd2e03dc52649fc30~~::$prefixLengthsPsr4; |
  | 163 |  | $loader->prefixDirsPsr4 = ComposerStaticInit~~4fd7a1761d28d8acd2e03dc52649fc30~~::$prefixDirsPsr4; |
  | 164 |  | $loader->classMap = ComposerStaticInit~~4fd7a1761d28d8acd2e03dc52649fc30~~::$classMap; |
  |  | 171 | $loader->prefixLengthsPsr4 = ComposerStaticInit7308e0c95228d04f55d9943b5008262f::$prefixLengthsPsr4; |
  |  | 172 | $loader->prefixDirsPsr4 = ComposerStaticInit7308e0c95228d04f55d9943b5008262f::$prefixDirsPsr4; |
  |  | 173 | $loader->classMap = ComposerStaticInit7308e0c95228d04f55d9943b5008262f::$classMap; |
  | 165 | 174 |  |
  | 166 | 175 | }, null, ClassLoader::class); |
* ## [wp-2fa/trunk/vendor/composer/installed.json](/changeset/3009922/wp-2fa/trunk/vendor/composer/installed.json "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/installed.json")

  | [r2940688](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=2940688#L60 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=3009922#L60 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 60 | 60 | { |
  | 61 | 61 | "name": "dasprid\/enum", |
  | 62 |  | "version": "1.0.~~4~~", |
  | 63 |  | "version\_normalized": "1.0.~~4~~.0", |
  |  | 62 | "version": "1.0.5", |
  |  | 63 | "version\_normalized": "1.0.5.0", |
  | 64 | 64 | "source": { |
  | 65 | 65 | "type": "git", |
  | 66 | 66 | "url": "https:\/\/github.com\/DASPRiD\/Enum.git", |
  | 67 |  | "reference": "~~8e6b6ea76eabbf19ea2bf5b67b98e1860474012f~~" |
  | 68 |  | }, |
  | 69 |  | "dist": { |
  | 70 |  | "type": "zip", |
  | 71 |  | "url": "https:\/\/api.github.com\/repos\/DASPRiD\/Enum\/zipball\/~~8e6b6ea76eabbf19ea2bf5b67b98e1860474012f~~", |
  | 72 |  | "reference": "~~8e6b6ea76eabbf19ea2bf5b67b98e1860474012f~~", |
  |  | 67 | "reference": "6faf451159fb8ba4126b925ed2d78acfce0dc016" |
  |  | 68 | }, |
  |  | 69 | "dist": { |
  |  | 70 | "type": "zip", |
  |  | 71 | "url": "https:\/\/api.github.com\/repos\/DASPRiD\/Enum\/zipball\/6faf451159fb8ba4126b925ed2d78acfce0dc016", |
  |  | 72 | "reference": "6faf451159fb8ba4126b925ed2d78acfce0dc016", |
  | 73 | 73 | "shasum": "" |
  | 74 | 74 | }, |
  | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=2940688#L80) | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=3009922#L80) |  |
  | 80 | 80 | "squizlabs\/php\_codesniffer": "\*" |
  | 81 | 81 | }, |
  | 82 |  | "time": "2023-0~~3-01T18:44:03~~+00:00", |
  |  | 82 | "time": "2023-08-25T16:18:39+00:00", |
  | 83 | 83 | "type": "library", |
  | 84 | 84 | "installation-source": "dist", |
  | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=2940688#L107) | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=3009922#L107) |  |
  | 107 | 107 | "support": { |
  | 108 | 108 | "issues": "https:\/\/github.com\/DASPRiD\/Enum\/issues", |
  | 109 |  | "source": "https:\/\/github.com\/DASPRiD\/Enum\/tree\/1.0.~~4~~" |
  |  | 109 | "source": "https:\/\/github.com\/DASPRiD\/Enum\/tree\/1.0.5" |
  | 110 | 110 | }, |
  | 111 | 111 | "install-path": "..\/dasprid\/enum" |
  | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=2940688#L251) | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=3009922#L251) |  |
  | 251 | 251 | { |
  | 252 | 252 | "name": "freemius\/wordpress-sdk", |
  | 253 |  | "version": "2.~~5.10~~", |
  | 254 |  | "version\_normalized": "2.~~5.10~~.0", |
  |  | 253 | "version": "2.6.1", |
  |  | 254 | "version\_normalized": "2.6.1.0", |
  | 255 | 255 | "source": { |
  | 256 | 256 | "type": "git", |
  | 257 | 257 | "url": "https:\/\/github.com\/Freemius\/wordpress-sdk.git", |
  | 258 |  | "reference": "~~05bac841008b705bff9636f782c96fb0a73e615b~~" |
  | 259 |  | }, |
  | 260 |  | "dist": { |
  | 261 |  | "type": "zip", |
  | 262 |  | "url": "https:\/\/api.github.com\/repos\/Freemius\/wordpress-sdk\/zipball\/~~05bac841008b705bff9636f782c96fb0a73e615b~~", |
  | 263 |  | "reference": "~~05bac841008b705bff9636f782c96fb0a73e615b~~", |
  | 264 |  | "shasum": "" |
  | 265 |  | }, |
  | 266 |  | "require": { |
  | 267 |  | "php": ">=5.~~2~~" |
  |  | 258 | "reference": "9fb47e3b864a0039c0cd96312a638b8324c0c30a" |
  |  | 259 | }, |
  |  | 260 | "dist": { |
  |  | 261 | "type": "zip", |
  |  | 262 | "url": "https:\/\/api.github.com\/repos\/Freemius\/wordpress-sdk\/zipball\/9fb47e3b864a0039c0cd96312a638b8324c0c30a", |
  |  | 263 | "reference": "9fb47e3b864a0039c0cd96312a638b8324c0c30a", |
  |  | 264 | "shasum": "" |
  |  | 265 | }, |
  |  | 266 | "require": { |
  |  | 267 | "php": ">=5.6" |
  | 268 | 268 | }, |
  | 269 | 269 | "require-dev": { |
  | 270 | 270 | "dealerdirect\/phpcodesniffer-composer-installer": "^1.0", |
  |  | 271 | "phpcompatibility\/php-compatibility": "^9.3", |
  |  | 272 | "phpcompatibility\/phpcompatibility-wp": "^2.1", |
  |  | 273 | "phpstan\/extension-installer": "^1.3", |
  |  | 274 | "squizlabs\/php\_codesniffer": "^3.7", |
  |  | 275 | "szepeviktor\/phpstan-wordpress": "^1.3", |
  | 271 | 276 | "wp-coding-standards\/wpcs": "^2.3" |
  | 272 | 277 | }, |
  | 273 |  | "time": "2023-~~07-18T06:35:08~~+00:00", |
  |  | 278 | "time": "2023-12-03T15:10:12+00:00", |
  | 274 | 279 | "type": "library", |
  | 275 | 280 | "installation-source": "dist", |
  | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=2940688#L291) | […](/browser/wp-2fa/trunk/vendor/composer/installed.json?rev=3009922#L296) |  |
  | 291 | 296 | "support": { |
  | 292 | 297 | "issues": "https:\/\/github.com\/Freemius\/wordpress-sdk\/issues", |
  | 293 |  | "source": "https:\/\/github.com\/Freemius\/wordpress-sdk\/tree\/2.~~5.10~~" |
  |  | 298 | "source": "https:\/\/github.com\/Freemius\/wordpress-sdk\/tree\/2.6.1" |
  | 294 | 299 | }, |
  | 295 | 300 | "install-path": "..\/freemius\/wordpress-sdk" |
* ## [wp-2fa/trunk/vendor/composer/installed.php](/changeset/3009922/wp-2fa/trunk/vendor/composer/installed.php "Show the changeset 3009922 restricted to wp-2fa/trunk/vendor/composer/installed.php")

  | [r2940688](/browser/wp-2fa/trunk/vendor/composer/installed.php?rev=2940688#L3 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/vendor/composer/installed.php?rev=3009922#L3 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | namespace WP2FA\_Vendor; |
  | 4 | 4 |  |
  | 5 |  | return array('root' => array('name' => 'wp-white-security/wp-2fa', 'pretty\_version' => '2.2.0', 'version' => '2.2.0.0', 'reference' => NULL, 'type' => 'wordpress-plugin', 'install\_path' => \_\_DIR\_\_ . '/../../', 'aliases' => array(), 'dev' => \false), 'versions' => array('bacon/bacon-qr-code' => array('pretty\_version' => '2.0.8', 'version' => '2.0.8.0', 'reference' => '8674e51bb65af933a5ffaf1c308a660387c35c22', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../bacon/bacon-qr-code', 'aliases' => array(), 'dev\_requirement' => \false), 'dasprid/enum' => array('pretty\_version' => '1.0.~~4', 'version' => '1.0.4.0', 'reference' => '8e6b6ea76eabbf19ea2bf5b67b98e1860474012f', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../dasprid/enum', 'aliases' => array(), 'dev\_requirement' => \false), 'endroid/qr-code' => array('pretty\_version' => '3.9.7', 'version' => '3.9.7.0', 'reference' => '94563d7b3105288e6ac53a67ae720e3669fac1f6', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../endroid/qr-code', 'aliases' => array(), 'dev\_requirement' => \false), 'firebase/php-jwt' => array('pretty\_version' => 'v5.5.1', 'version' => '5.5.1.0', 'reference' => '83b609028194aa042ea33b5af2d41a7427de80e6', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../firebase/php-jwt', 'aliases' => array(), 'dev\_requirement' => \false), 'freemius/wordpress-sdk' => array('pretty\_version' => '2.5.10', 'version' => '2.5.10.0', 'reference' => '05bac841008b705bff9636f782c96fb0a73e615b~~', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../freemius/wordpress-sdk', 'aliases' => array(), 'dev\_requirement' => \false), 'khanamiryan/qrcode-detector-decoder' => array('pretty\_version' => '1.0.6', 'version' => '1.0.6.0', 'reference' => '45326fb83a2a375065dbb3a134b5b8a5872da569', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../khanamiryan/qrcode-detector-decoder', 'aliases' => array(), 'dev\_requirement' => \false), 'myclabs/php-enum' => array('pretty\_version' => '1.8.4', 'version' => '1.8.4.0', 'reference' => 'a867478eae49c9f59ece437ae7f9506bfaa27483', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../myclabs/php-enum', 'aliases' => array(), 'dev\_requirement' => \false), 'symfony/inflector' => array('pretty\_version' => 'v5.0.11', 'version' => '5.0.11.0', 'reference' => '7eff2643934179cd0e5a6609a583fc22fc495fc4', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../symfony/inflector', 'aliases' => array(), 'dev\_requirement' => \false), 'symfony/options-resolver' => array('dev\_requirement' => \false, 'replaced' => array(0 => 'v5.0.11')), 'symfony/polyfill-ctype' => array('dev\_requirement' => \false, 'replaced' => array(0 => 'v1.20.0')), 'symfony/property-access' => array('pretty\_version' => 'v5.0.11', 'version' => '5.0.11.0', 'reference' => 'fdc47c3780ebb29077c3421c6253ccc91040c24a', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../symfony/property-access', 'aliases' => array(), 'dev\_requirement' => \false), 'symfony/string' => array('dev\_requirement' => \false, 'replaced' => array(0 => 'v5.0.11')), 'twilio/sdk' => array('pretty\_version' => '6.44.4', 'version' => '6.44.4.0', 'reference' => '08aad5f377e2245b9cd7508e7762d95e7392fa4d', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../twilio/sdk', 'aliases' => array(), 'dev\_requirement' => \false), 'wp-white-security/wp-2fa' => array('pretty\_version' => '2.2.0', 'version' => '2.2.0.0', 'reference' => NULL, 'type' => 'wordpress-plugin', 'install\_path' => \_\_DIR\_\_ . '/../../', 'aliases' => array(), 'dev\_requirement' => \false))); |
  |  | 5 | return array('root' => array('name' => 'wp-white-security/wp-2fa', 'pretty\_version' => '2.2.0', 'version' => '2.2.0.0', 'reference' => NULL, 'type' => 'wordpress-plugin', 'install\_path' => \_\_DIR\_\_ . '/../../', 'aliases' => array(), 'dev' => \false), 'versions' => array('bacon/bacon-qr-code' => array('pretty\_version' => '2.0.8', 'version' => '2.0.8.0', 'reference' => '8674e51bb65af933a5ffaf1c308a660387c35c22', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../bacon/bacon-qr-code', 'aliases' => array(), 'dev\_requirement' => \false), 'dasprid/enum' => array('pretty\_version' => '1.0.5', 'version' => '1.0.5.0', 'reference' => '6faf451159fb8ba4126b925ed2d78acfce0dc016', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../dasprid/enum', 'aliases' => array(), 'dev\_requirement' => \false), 'endroid/qr-code' => array('pretty\_version' => '3.9.7', 'version' => '3.9.7.0', 'reference' => '94563d7b3105288e6ac53a67ae720e3669fac1f6', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../endroid/qr-code', 'aliases' => array(), 'dev\_requirement' => \false), 'firebase/php-jwt' => array('pretty\_version' => 'v5.5.1', 'version' => '5.5.1.0', 'reference' => '83b609028194aa042ea33b5af2d41a7427de80e6', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../firebase/php-jwt', 'aliases' => array(), 'dev\_requirement' => \false), 'freemius/wordpress-sdk' => array('pretty\_version' => '2.6.1', 'version' => '2.6.1.0', 'reference' => '9fb47e3b864a0039c0cd96312a638b8324c0c30a', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../freemius/wordpress-sdk', 'aliases' => array(), 'dev\_requirement' => \false), 'khanamiryan/qrcode-detector-decoder' => array('pretty\_version' => '1.0.6', 'version' => '1.0.6.0', 'reference' => '45326fb83a2a375065dbb3a134b5b8a5872da569', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../khanamiryan/qrcode-detector-decoder', 'aliases' => array(), 'dev\_requirement' => \false), 'myclabs/php-enum' => array('pretty\_version' => '1.8.4', 'version' => '1.8.4.0', 'reference' => 'a867478eae49c9f59ece437ae7f9506bfaa27483', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../myclabs/php-enum', 'aliases' => array(), 'dev\_requirement' => \false), 'symfony/inflector' => array('pretty\_version' => 'v5.0.11', 'version' => '5.0.11.0', 'reference' => '7eff2643934179cd0e5a6609a583fc22fc495fc4', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../symfony/inflector', 'aliases' => array(), 'dev\_requirement' => \false), 'symfony/options-resolver' => array('dev\_requirement' => \false, 'replaced' => array(0 => 'v5.0.11')), 'symfony/polyfill-ctype' => array('dev\_requirement' => \false, 'replaced' => array(0 => 'v1.20.0')), 'symfony/property-access' => array('pretty\_version' => 'v5.0.11', 'version' => '5.0.11.0', 'reference' => 'fdc47c3780ebb29077c3421c6253ccc91040c24a', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../symfony/property-access', 'aliases' => array(), 'dev\_requirement' => \false), 'symfony/string' => array('dev\_requirement' => \false, 'replaced' => array(0 => 'v5.0.11')), 'twilio/sdk' => array('pretty\_version' => '6.44.4', 'version' => '6.44.4.0', 'reference' => '08aad5f377e2245b9cd7508e7762d95e7392fa4d', 'type' => 'library', 'install\_path' => \_\_DIR\_\_ . '/../twilio/sdk', 'aliases' => array(), 'dev\_requirement' => \false), 'wp-white-security/wp-2fa' => array('pretty\_version' => '2.2.0', 'version' => '2.2.0.0', 'reference' => NULL, 'type' => 'wordpress-plugin', 'install\_path' => \_\_DIR\_\_ . '/../../', 'aliases' => array(), 'dev\_requirement' => \false))); |
* ## [wp-2fa/trunk/wp-2fa.php](/changeset/3009922/wp-2fa/trunk/wp-2fa.php "Show the changeset 3009922 restricted to wp-2fa/trunk/wp-2fa.php")

  | [r2940688](/browser/wp-2fa/trunk/wp-2fa.php?rev=2940688#L8 "Show revision 2940688 of this file in browser") | [r3009922](/browser/wp-2fa/trunk/wp-2fa.php?rev=3009922#L8 "Show revision 3009922 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* @wordpress-plugin |
  | 9 | 9 | \* Plugin Name: WP 2FA - Two-factor authentication for WordPress |
  | 10 |  | \* Version:     2.~~5~~.0 |
  |  | 10 | \* Version:     2.6.0 |
  | 11 | 11 | \* Plugin URI:  https://melapress.com/ |
  | 12 | 12 | \* Description: Easily add an additional layer of security to your WordPress login pages. Enable Two-Factor Authentication for you and all your website users with this easy to use plugin. |
  | […](/browser/wp-2fa/trunk/wp-2fa.php?rev=2940688#L38) | […](/browser/wp-2fa/trunk/wp-2fa.php?rev=3009922#L38) |  |
  | 38 | 38 | \*/ |
  | 39 | 39 |  |
  |  | 40 | use WP2FA\WP2FA; |
  |  | 41 | use WP2FA\Utils\Migration; |
  |  | 42 | use WP2FA\Admin\Helpers\WP\_Helper; |
  | 40 | 43 | use WP2FA\Admin\Helpers\File\_Writer; |
  | 41 |  | ~~use WP2FA\Utils\Migration;~~ |
  | 42 |  | ~~use WP2FA\WP2FA;~~ |
  | 43 | 44 |  |
  | 44 | 45 | if ( ! defined( 'ABSPATH' ) ) { |
  | […](/browser/wp-2fa/trunk/wp-2fa.php?rev=2940688#L52) | […](/browser/wp-2fa/trunk/wp-2fa.php?rev=3009922#L53) |  |
  | 52 | 53 | // Useful global constants. |
  | 53 | 54 | if ( ! defined( 'WP\_2FA\_VERSION' ) ) { |
  | 54 |  | define( 'WP\_2FA\_VERSION', '2.~~5~~.0' ); |
  |  | 55 | define( 'WP\_2FA\_VERSION', '2.6.0' ); |
  | 55 | 56 | define( 'WP\_2FA\_BASE', plugin\_basename( \_\_FILE\_\_ ) ); |
  | 56 | 57 | define( 'WP\_2FA\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) ); |
  | […](/browser/wp-2fa/trunk/wp-2fa.php?rev=2940688#L80) | […](/browser/wp-2fa/trunk/wp-2fa.php?rev=3009922#L81) |  |
  | 80 | 81 | } |
  | 81 | 82 |  |
  | 82 |  | ~~// if ( file\_exists( WP\_2FA\_PATH . 'third-party/vendor/autoload.php' ) ) {~~ |
  | 83 |  | ~~// require\_once WP\_2FA\_PATH . 'third-party/vendor/autoload.php';~~ |
  | 84 |  | ~~// }~~ |
  | 85 |  |  |
  | 86 | 83 | // run any required update routines. |
  | 87 | 84 | Migration::migrate(); |
  | 88 | 85 |  |
  | 89 |  | WP2FA::init(); |
  |  | 86 | // Setup\_Wizard. |
  |  | 87 | if ( WP\_Helper::is\_multisite() ) { |
  |  | 88 | add\_action( 'network\_admin\_menu', array( '\WP2FA\Admin\Setup\_Wizard', 'network\_admin\_menus' ), 10 ); |
  |  | 89 | add\_action( 'admin\_menu', array( '\WP2FA\Admin\Setup\_Wizard', 'admin\_menus' ), 10 ); |
  |  | 90 | } else { |
  |  | 91 | add\_action( 'admin\_menu', array( '\WP2FA\Admin\Setup\_Wizard', 'admin\_menus' ), 10 ); |
  |  | 92 | } |
  |  | 93 |  |
  |  | 94 | // Activation/Deactivation. |
  |  | 95 | register\_activation\_hook( WP\_2FA\_FILE, '\WP2FA\Core\activate' ); |
  |  | 96 | register\_deactivation\_hook( WP\_2FA\_FILE, '\WP2FA\Core\deactivate' ); |
  |  | 97 | // Register our uninstallation hook. |
  |  | 98 | register\_uninstall\_hook( WP\_2FA\_FILE, '\WP2FA\Core\uninstall' ); |
  |  | 99 |  |
  |  | 100 | add\_filter( 'plugins\_loaded', array( '\WP2FA\WP2FA', 'init' ) ); |
  |  | 101 | add\_action( 'plugins\_loaded', array( '\WP2FA\WP2FA', 'add\_wizard\_actions' ), 10 ); |
  |  | 102 |  |
  | 90 | 103 | // phpcs:disable |
  | 91 | 104 | // phpcs:enable |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3009922)
* [Zip Archive](?format=zip&new=3009922)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_bea9ea0d_20250115_084048.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwp-2fa%2Ftrunk%2Fincludes%2Fclasses%2FAdmin%2Fclass-setup-wizard.php%3Frev%3D2940688)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2866477 "Revision 2866477")
* [Latest Revision](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php)
* [Next Revision](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=3009922 "Revision 3009922") →
* [Blame](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?annotate=blame&rev=2940688 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688)

---

# [source:](/browser?rev=2940688&order=name "Go to repository root") [wp-2fa](/browser/wp-2fa?rev=2940688&order=name "View wp-2fa")/[trunk](/browser/wp-2fa/trunk?rev=2940688&order=name "View trunk")/[includes](/browser/wp-2fa/trunk/includes?rev=2940688&order=name "View includes")/[classes](/browser/wp-2fa/trunk/includes/classes?rev=2940688&order=name "View classes")/[Admin](/browser/wp-2fa/trunk/includes/classes/Admin?rev=2940688&order=name "View Admin")/[class-setup-wizard.php](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688&order=name "View class-setup-wizard.php") @ [2940688](/changeset/2940688/ "View changeset 2940688")

View diff against:

View revision:

| [Last change](/changeset/2940688/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php "View differences") on this file since 2940688 was [2940688](/changeset/2940688/ "View changeset 2940688"), checked in by WPWhiteSecurity, [18 months ago](/timeline?from=2023-07-20T08%3A27%3A37Z&precision=second "See timeline at 07/20/2023 08:27:37 AM") |
| --- |
| Uploading 2.5.0 |
| **File size:** 24.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Setup wizard rendering class. |
| [4](#L4) | \* |
| [5](#L5) | \* @package    wp2fa |
| [6](#L6) | \* @subpackage setup |
| [7](#L7) | \* @copyright  %%YEAR%% Melapress |
| [8](#L8) | \* @license    https://www.apache.org/licenses/LICENSE-2.0 Apache License 2.0 |
| [9](#L9) | \* @link       https://wordpress.org/plugins/wp-2fa/ |
| [10](#L10) | \*/ |
| [11](#L11) |  |
| [12](#L12) | namespace WP2FA\Admin; |
| [13](#L13) |  |
| [14](#L14) | use \WP2FA\Core as Core; |
| [15](#L15) | use \WP2FA\WP2FA as WP2FA; |
| [16](#L16) | use WP2FA\Admin\Helpers\WP\_Helper; |
| [17](#L17) | use WP2FA\Admin\Views\Wizard\_Steps; |
| [18](#L18) | use WP2FA\Admin\Helpers\User\_Helper; |
| [19](#L19) | use WP2FA\Admin\Controllers\Settings; |
| [20](#L20) | use \WP2FA\Utils\User\_Utils as User\_Utils; |
| [21](#L21) | use WP2FA\Admin\Views\First\_Time\_Wizard\_Steps; |
| [22](#L22) | use \WP2FA\Admin\Settings\_Page as Settings\_Page; |
| [23](#L23) | use WP2FA\Utils\Settings\_Utils as Settings\_Utils; |
| [24](#L24) | use \WP2FA\Utils\Generate\_Modal as Generate\_Modal; |
| [25](#L25) | use \WP2FA\Admin\SettingsPages\Settings\_Page\_Policies; |
| [26](#L26) | use \WP2FA\Authenticator\Authentication as Authentication; |
| [27](#L27) |  |
| [28](#L28) | /\*\* |
| [29](#L29) | \* Setup\_Wizard class for the wizard steps setup |
| [30](#L30) | \* |
| [31](#L31) | \* @since 2.4.0 |
| [32](#L32) | \*/ |
| [33](#L33) | if ( ! class\_exists( '\WP2FA\Admin\Setup\_Wizard' ) ) { |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Our class for creating a step by step wizard for easy configuration. |
| [36](#L36) | \*/ |
| [37](#L37) | class Setup\_Wizard { |
| [38](#L38) |  |
| [39](#L39) | /\*\* |
| [40](#L40) | \* Wizard Steps |
| [41](#L41) | \* |
| [42](#L42) | \* @var array |
| [43](#L43) | \*/ |
| [44](#L44) | private static $wizard\_steps; |
| [45](#L45) |  |
| [46](#L46) | /\*\* |
| [47](#L47) | \* Current Step |
| [48](#L48) | \* |
| [49](#L49) | \* @var string |
| [50](#L50) | \*/ |
| [51](#L51) | private static $current\_step; |
| [52](#L52) |  |
| [53](#L53) | /\*\* |
| [54](#L54) | \* Add setup admin page. This is empty on purpose. |
| [55](#L55) | \*/ |
| [56](#L56) | public static function admin\_menus() { |
| [57](#L57) | add\_dashboard\_page( '', '', 'read', 'wp-2fa-setup', '' ); |
| [58](#L58) | } |
| [59](#L59) |  |
| [60](#L60) | /\*\* |
| [61](#L61) | \* Adding menus for multisite install |
| [62](#L62) | \* |
| [63](#L63) | \* @return void |
| [64](#L64) | \* |
| [65](#L65) | \* @since 2.2.0 |
| [66](#L66) | \*/ |
| [67](#L67) | public static function network\_admin\_menus() { |
| [68](#L68) | add\_dashboard\_page( 'index.php', '', 'read', 'wp-2fa-setup', '' ); |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | /\*\* |
| [72](#L72) | \* Setup Page Start. |
| [73](#L73) | \* |
| [74](#L74) | \* @SuppressWarnings(PHPMD.ExitExpression) |
| [75](#L75) | \*/ |
| [76](#L76) | public static function setup\_page() { |
| [77](#L77) |  |
| [78](#L78) | // Get page argument from $\_GET array. |
| [79](#L79) | $page = ( isset( $\_GET['page'] ) ) ? \sanitize\_text\_field( \wp\_unslash( $\_GET['page'] ) ) : ''; // phpcs:ignore |
| [80](#L80) | if ( empty( $page ) || 'wp-2fa-setup' !== $page ) { |
| [81](#L81) | return; |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | // Clear out any old notices. |
| [85](#L85) | $user = wp\_get\_current\_user(); |
| [86](#L86) |  |
| [87](#L87) | // First lets check if any options have been saved. |
| [88](#L88) | $settings\_saved = true; |
| [89](#L89) | $settings       = WP2FA::get\_wp2fa\_setting(); |
| [90](#L90) | if ( empty( $settings ) || ! isset( $settings ) ) { |
| [91](#L91) | $settings\_saved = false; |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) | /\*\* |
| [95](#L95) | \* Wizard Steps. |
| [96](#L96) | \*/ |
| [97](#L97) | $get\_array = filter\_input\_array( INPUT\_GET ); |
| [98](#L98) | if ( isset( $get\_array['wizard\_type'] ) ) { |
| [99](#L99) | $wizard\_type = sanitize\_text\_field( $get\_array['wizard\_type'] ); |
| [100](#L100) | } else { |
| [101](#L101) | $wizard\_type = 'default'; |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | $is\_user\_forced\_to\_setup = User\_Helper::get\_user\_enforced\_instantly( $user ); |
| [105](#L105) | if ( ! empty( $is\_user\_forced\_to\_setup ) ) { |
| [106](#L106) | add\_filter( 'wp\_2fa\_wizard\_default\_steps', array( \_\_CLASS\_\_, 'wp\_2fa\_add\_intro\_step' ) ); |
| [107](#L107) | } |
| [108](#L108) |  |
| [109](#L109) | $user\_type = User\_Utils::determine\_user\_2fa\_status( $user ); |
| [110](#L110) |  |
| [111](#L111) | $wizard\_steps = array( |
| [112](#L112) | 'welcome'                => array( |
| [113](#L113) | 'name'        => esc\_html\_\_( 'Welcome', 'wp-2fa' ), |
| [114](#L114) | 'content'     => array( \_\_CLASS\_\_, 'wp\_2fa\_step\_welcome' ), |
| [115](#L115) | 'wizard\_type' => 'welcome\_wizard', |
| [116](#L116) | ), |
| [117](#L117) | 'settings\_configuration' => array( |
| [118](#L118) | 'name'        => esc\_html\_\_( 'Configure 2FA methods & Policies', 'wp-2fa' ), |
| [119](#L119) | 'content'     => array( \_\_CLASS\_\_, 'wp\_2fa\_step\_global\_2fa\_methods' ), |
| [120](#L120) | 'save'        => array( \_\_CLASS\_\_, 'wp\_2fa\_step\_global\_2fa\_methods\_save' ), |
| [121](#L121) | 'wizard\_type' => 'welcome\_wizard', |
| [122](#L122) | ), |
| [123](#L123) | 'finish'                 => array( |
| [124](#L124) | 'name'        => esc\_html\_\_( 'Setup Finish', 'wp-2fa' ), |
| [125](#L125) | 'content'     => array( \_\_CLASS\_\_, 'wp\_2fa\_step\_finish' ), |
| [126](#L126) | 'save'        => array( \_\_CLASS\_\_, 'wp\_2fa\_step\_finish\_save' ), |
| [127](#L127) | 'wizard\_type' => 'welcome\_wizard', |
| [128](#L128) | ), |
| [129](#L129) | ); |
| [130](#L130) |  |
| [131](#L131) | // Admin user setting up fresh install of 2FA plugin. |
| [132](#L132) | if ( in\_array( 'can\_manage\_options', $user\_type, true ) && ! $settings\_saved ) { |
| [133](#L133) | unset( $wizard\_steps['user\_choose\_2fa\_method'] ); |
| [134](#L134) | unset( $wizard\_steps['reconfigure\_method'] ); |
| [135](#L135) | } |
| [136](#L136) |  |
| [137](#L137) | // We will use this setting to determine if defaults have already been saved to the DB. |
| [138](#L138) | $have\_defaults\_been\_applied = Settings\_Utils::get\_option( 'default\_settings\_applied', false ); |
| [139](#L139) | // If we have settings, but they are the defaults, then we want to consider the settings to be unsaved at this point. |
| [140](#L140) | if ( in\_array( 'can\_manage\_options', $user\_type, true ) && $settings\_saved && $have\_defaults\_been\_applied ) { |
| [141](#L141) | $settings\_saved = false; |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | // Ensure user has minimum capabitlies needed to be here. |
| [145](#L145) | if ( in\_array( 'can\_read', $user\_type, true ) && $settings\_saved ) { |
| [146](#L146) |  |
| [147](#L147) | switch ( $wizard\_type ) { |
| [148](#L148) | case 'user\_2fa\_config': |
| [149](#L149) | $wizard\_steps = array\_intersect\_key( $wizard\_steps, array\_flip( array( 'user\_choose\_2fa\_method', 'setup\_method', 'finish', 'backup\_codes' ) ) ); |
| [150](#L150) | break; |
| [151](#L151) |  |
| [152](#L152) | case 'backup\_codes\_config': |
| [153](#L153) | $wizard\_steps = array\_intersect\_key( $wizard\_steps, array\_flip( array( 'backup\_codes' ) ) ); |
| [154](#L154) | break; |
| [155](#L155) |  |
| [156](#L156) | case 'user\_reconfigure\_config': |
| [157](#L157) | $wizard\_steps = array\_intersect\_key( $wizard\_steps, array\_flip( array( 'reconfigure\_method' ) ) ); |
| [158](#L158) | break; |
| [159](#L159) |  |
| [160](#L160) | default: |
| [161](#L161) | $wizard\_steps = array\_intersect\_key( $wizard\_steps, array\_flip( array( 'choose\_2fa\_method', 'setup\_method', 'finish', 'backup\_codes', 'reconfigure\_method' ) ) ); |
| [162](#L162) | } |
| [163](#L163) |  |
| [164](#L164) | // Remove 1st step if only one method is available. |
| [165](#L165) | if ( empty( WP2FA::get\_wp2fa\_setting( 'enable\_totp' ) ) || empty( WP2FA::get\_wp2fa\_setting( 'enable\_email' ) ) ) { |
| [166](#L166) | unset( $wizard\_steps['choose\_2fa\_method'] ); |
| [167](#L167) | } |
| [168](#L168) |  |
| [169](#L169) | // If the user has codes setup already, no need to add the slide. |
| [170](#L170) | if ( ! in\_array( 'user\_needs\_to\_setup\_backup\_codes', $user\_type, true ) && 'backup\_codes\_config' !== $wizard\_type ) { |
| [171](#L171) | unset( $wizard\_steps['backup\_codes'] ); |
| [172](#L172) | } |
| [173](#L173) | } |
| [174](#L174) |  |
| [175](#L175) | /\*\* |
| [176](#L176) | \* Filter: `Wizard Default Steps` |
| [177](#L177) | \* |
| [178](#L178) | \* WSAL filter to filter wizard steps before they are displayed. |
| [179](#L179) | \* |
| [180](#L180) | \* @param array $wizard\_steps – Wizard Steps. |
| [181](#L181) | \*/ |
| [182](#L182) | self::$wizard\_steps = apply\_filters( WP\_2FA\_PREFIX . 'wizard\_default\_steps', $wizard\_steps ); |
| [183](#L183) |  |
| [184](#L184) | // Set current step. |
| [185](#L185) | $current\_step       = ( isset( $\_GET['current-step'] ) ) ? \sanitize\_text\_field( \wp\_unslash( $\_GET['current-step'] ) ) : ''; // phpcs:ignore |
| [186](#L186) | self::$current\_step = ! empty( $current\_step ) ? $current\_step : current( array\_keys( self::$wizard\_steps ) ); |
| [187](#L187) |  |
| [188](#L188) | if ( 'backup\_codes' === self::$current\_step && ! Settings\_Page::are\_backup\_codes\_enabled( User\_Helper::get\_user\_role( $user ) ) ) { |
| [189](#L189) |  |
| [190](#L190) | $redirect\_to\_finish = add\_query\_arg( |
| [191](#L191) | array( |
| [192](#L192) | 'current-step' => 'finish', |
| [193](#L193) | 'all-set'      => 1, |
| [194](#L194) | ) |
| [195](#L195) | ); |
| [196](#L196) | wp\_safe\_redirect( esc\_url\_raw( $redirect\_to\_finish ) ); |
| [197](#L197) | } |
| [198](#L198) |  |
| [199](#L199) | /\*\* |
| [200](#L200) | \* Enqueue Scripts. |
| [201](#L201) | \*/ |
| [202](#L202) | wp\_enqueue\_style( |
| [203](#L203) | 'wp\_2fa\_setup\_wizard', |
| [204](#L204) | Core\style\_url( 'setup-wizard', 'admin' ), |
| [205](#L205) | array( 'select2' ), |
| [206](#L206) | WP\_2FA\_VERSION |
| [207](#L207) | ); |
| [208](#L208) |  |
| [209](#L209) | wp\_enqueue\_style( |
| [210](#L210) | 'wp\_2fa\_admin-style', |
| [211](#L211) | Core\style\_url( 'admin-style', 'admin' ), |
| [212](#L212) | array(), |
| [213](#L213) | WP\_2FA\_VERSION |
| [214](#L214) | ); |
| [215](#L215) |  |
| [216](#L216) | \WP2FA\Core\enqueue\_select2\_scripts(); |
| [217](#L217) |  |
| [218](#L218) | if ( \WP2FA\Admin\Helpers\WP\_Helper::is\_multisite() ) { |
| [219](#L219) | \WP2FA\Core\enqueue\_multi\_select\_scripts(); |
| [220](#L220) | } |
| [221](#L221) |  |
| [222](#L222) | wp\_enqueue\_script( |
| [223](#L223) | 'wp\_2fa\_admin', |
| [224](#L224) | Core\script\_url( 'admin', 'admin' ), |
| [225](#L225) | array( 'jquery-ui-widget', 'jquery-ui-core', 'jquery-ui-autocomplete', 'select2' ), |
| [226](#L226) | WP\_2FA\_VERSION, |
| [227](#L227) | true |
| [228](#L228) | ); |
| [229](#L229) |  |
| [230](#L230) | wp\_enqueue\_script( |
| [231](#L231) | 'wp\_2fa\_micromodal', |
| [232](#L232) | Core\script\_url( 'micromodal', 'admin', 'select2' ), |
| [233](#L233) | array(), |
| [234](#L234) | WP\_2FA\_VERSION, |
| [235](#L235) | true |
| [236](#L236) | ); |
| [237](#L237) |  |
| [238](#L238) | // Data array. |
| [239](#L239) | $data\_array = array( |
| [240](#L240) | 'ajaxURL'         => admin\_url( 'admin-ajax.php' ), |
| [241](#L241) | 'roles'           => WP2FA::wp\_2fa\_get\_roles(), |
| [242](#L242) | 'nonce'           => wp\_create\_nonce( 'wp-2fa-settings-nonce' ), |
| [243](#L243) | 'invalidEmail   ' => esc\_html\_\_( 'Please use a valid email address', 'wp-2fa' ), |
| [244](#L244) | 'backupCodesSent' => esc\_html\_\_( 'Backup codes sent', 'wp-2fa' ), |
| [245](#L245) | ); |
| [246](#L246) | wp\_localize\_script( 'wp\_2fa\_admin', 'wp2faData', $data\_array ); |
| [247](#L247) |  |
| [248](#L248) | // Data array. |
| [249](#L249) | $data\_array = array( |
| [250](#L250) | 'ajaxURL'        => admin\_url( 'admin-ajax.php' ), |
| [251](#L251) | 'nonce'          => wp\_create\_nonce( 'wp2fa-verify-wizard-page' ), |
| [252](#L252) | 'codesPreamble'  => esc\_html\_\_( 'These are the 2FA backup codes for the user', 'wp-2fa' ), |
| [253](#L253) | 'readyText'      => esc\_html\_\_( 'I\'m ready', 'wp-2fa' ), |
| [254](#L254) | 'codeReSentText' => esc\_html\_\_( 'New code sent', 'wp-2fa' ), |
| [255](#L255) | ); |
| [256](#L256) |  |
| [257](#L257) | /\*\* |
| [258](#L258) | \* Gives the ability to change the default JS wizard settings. |
| [259](#L259) | \* |
| [260](#L260) | \* @param int $data\_array - The array with all the JS wizard settings. |
| [261](#L261) | \* |
| [262](#L262) | \* @since 2.2.0 |
| [263](#L263) | \*/ |
| [264](#L264) | $data\_array = apply\_filters( WP\_2FA\_PREFIX . 'js\_wizard\_settings', $data\_array ); |
| [265](#L265) | wp\_localize\_script( 'wp\_2fa\_admin', 'wp2faWizardData', $data\_array ); |
| [266](#L266) |  |
| [267](#L267) | /\*\* |
| [268](#L268) | \* Save Wizard Settings. |
| [269](#L269) | \*/ |
| [270](#L270) | $save\_step = ( isset( $\_POST['save\_step'] ) ) ? \sanitize\_text\_field( \wp\_unslash( $\_POST['save\_step'] ) ) : ''; // phpcs:ignore |
| [271](#L271) | if ( ! empty( $save\_step ) && ! empty( self::$wizard\_steps[ self::$current\_step ]['save'] ) ) { |
| [272](#L272) | call\_user\_func( self::$wizard\_steps[ self::$current\_step ]['save'] ); |
| [273](#L273) | } |
| [274](#L274) |  |
| [275](#L275) | self::setup\_page\_header(); |
| [276](#L276) | self::setup\_page\_steps(); |
| [277](#L277) | self::setup\_page\_content(); |
| [278](#L278) | self::setup\_page\_footer(); |
| [279](#L279) |  |
| [280](#L280) | exit(); |
| [281](#L281) | } |
| [282](#L282) |  |
| [283](#L283) | /\*\* |
| [284](#L284) | \* Setup Page Header. |
| [285](#L285) | \*/ |
| [286](#L286) | private static function setup\_page\_header() { |
| [287](#L287) | ?> |
| [288](#L288) | <!DOCTYPE html> |
| [289](#L289) | <html <?php language\_attributes(); ?>> |
| [290](#L290) | <head> |
| [291](#L291) | <meta name="viewport" content="width=device-width" /> |
| [292](#L292) | <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> |
| [293](#L293) | <title><?php esc\_html\_e( 'WP 2FA &rsaquo; Setup Wizard', 'wp-2fa' ); ?></title> |
| [294](#L294) | <?php wp\_print\_scripts( 'jquery' ); ?> |
| [295](#L295) | <?php wp\_print\_scripts( 'jquery-ui-core' ); ?> |
| [296](#L296) | <?php wp\_print\_scripts( 'wp\_2fa\_setup\_wizard' ); ?> |
| [297](#L297) | <?php wp\_print\_scripts( 'wp\_2fa\_micromodal' ); ?> |
| [298](#L298) | <?php wp\_print\_scripts( 'wp\_2fa\_admin' ); ?> |
| [299](#L299) | <?php wp\_print\_scripts( 'multi-site-select' ); ?> |
| [300](#L300) | <?php |
| [301](#L301) | /\*\* |
| [302](#L302) | \* Gives the ability for 3rd party scripts to add their own JS to the plugin setup page. |
| [303](#L303) | \* |
| [304](#L304) | \* @since 2.2.0 |
| [305](#L305) | \*/ |
| [306](#L306) | \do\_action( WP\_2FA\_PREFIX . 'setup\_page\_scripts' ); |
| [307](#L307) | ?> |
| [308](#L308) | <?php wp\_print\_styles( 'common' ); ?> |
| [309](#L309) | <?php wp\_print\_styles( 'forms' ); ?> |
| [310](#L310) | <?php wp\_print\_styles( 'buttons' ); ?> |
| [311](#L311) | <?php wp\_print\_styles( 'wp-jquery-ui-dialog' ); ?> |
| [312](#L312) | <?php wp\_print\_styles( 'wp\_2fa\_admin' ); ?> |
| [313](#L313) | <?php do\_action( 'admin\_print\_styles' ); ?> |
| [314](#L314) | </head> |
| [315](#L315) | <body class="wp2fa-setup wp-core-ui"> |
| [316](#L316) | <div class="setup-wizard-wrapper wp-2fa-settings-wrapper wp2fa-form-styles"> |
| [317](#L317) | <h1 id="wp2fa-logo"><a href="https://melapress.com/wordpress-2fa/?&utm\_source=plugins&utm\_medium=link&utm\_campaign=wp2fa" target="\_blank"><img style="max-width: 80px;" src="<?php echo esc\_url( WP\_2FA\_URL . 'dist/images/wp-2fa-color\_opt.png' ); ?>"></a></h1> |
| [318](#L318) | <?php |
| [319](#L319) | } |
| [320](#L320) |  |
| [321](#L321) | /\*\* |
| [322](#L322) | \* Setup Page Footer. |
| [323](#L323) | \*/ |
| [324](#L324) | private static function setup\_page\_footer() { |
| [325](#L325) | $user = wp\_get\_current\_user(); |
| [326](#L326) |  |
| [327](#L327) | $redirect = Settings::get\_settings\_page\_link(); |
| [328](#L328) | ?> |
| [329](#L329) | <div class="wp2fa-setup-footer"> |
| [330](#L330) | <?php if ( 'welcome' !== self::$current\_step && 'finish' !== self::$current\_step ) { // Don't show the link on the first & last step. ?> |
| [331](#L331) | <?php if ( ! User\_Helper::get\_user\_enforced\_instantly( $user ) ) { ?> |
| [332](#L332) | <a class="close-wizard-link" href="<?php echo esc\_url( $redirect ); ?>"><?php esc\_html\_e( 'Close Wizard', 'wp-2fa' ); ?></a> |
| [333](#L333) | <?php |
| [334](#L334) | } |
| [335](#L335) | } |
| [336](#L336) | ?> |
| [337](#L337) | </div> |
| [338](#L338) | </div> |
| [339](#L339) | </body> |
| [340](#L340) | </html> |
| [341](#L341) | <?php |
| [342](#L342) | // phpcs:ignore |
| [343](#L343) | echo Generate\_Modal::generate\_modal( |
| [344](#L344) | 'notify-admin-settings-page', |
| [345](#L345) | '', |
| [346](#L346) | \_\_( 'If you cancel this wizard, the default plugin settings will be applied. You can always configure the plugin settings and two-factor authentication policies at a later stage from the ', 'wp-2fa' ) . ' <b>' . \_\_( 'WP 2FA', 'wp-2fa' ) . '</b>' . \_\_( ' entry in your WordPress dashboard menu.', 'wp-2fa' ), |
| [347](#L347) | array( |
| [348](#L348) | '<a href="#" id="close-settings" class="button button-primary wp-2fa-button-primary" data-redirect-url="' . esc\_url( $redirect ) . '">' . \_\_( 'OK, close wizard', 'wp-2fa' ) . '</a>', |
| [349](#L349) | '<a href="#" class="button button-secondary wp-2fa-button-secondary wp-2fa-button-secondary" data-close-2fa-modal>' . \_\_( 'Continue with wizard', 'wp-2fa' ) . '</a>', |
| [350](#L350) | ), |
| [351](#L351) | '', |
| [352](#L352) | '580px' |
| [353](#L353) | ); |
| [354](#L354) | ?> |
| [355](#L355) | <?php |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | /\*\* |
| [359](#L359) | \* Setup Page Steps. |
| [360](#L360) | \*/ |
| [361](#L361) | private static function setup\_page\_steps() { |
| [362](#L362) | ?> |
| [363](#L363) | <ul class="steps"> |
| [364](#L364) | <?php |
| [365](#L365) | foreach ( self::$wizard\_steps as $key => $step ) : |
| [366](#L366) | if ( 'welcome\_wizard' === $step['wizard\_type'] || is\_array( $step['wizard\_type'] ) && in\_array( 'welcome\_wizard', $step['wizard\_type'], true ) ) : |
| [367](#L367) | if ( $key === self::$current\_step ) : |
| [368](#L368) | ?> |
| [369](#L369) | <li class="is-active"><?php echo esc\_html( $step['name'] ); ?></li> |
| [370](#L370) | <?php |
| [371](#L371) | else : |
| [372](#L372) | ?> |
| [373](#L373) | <li><?php echo esc\_html( $step['name'] ); ?></li> |
| [374](#L374) | <?php |
| [375](#L375) | endif; |
| [376](#L376) | endif; |
| [377](#L377) | endforeach; |
| [378](#L378) | ?> |
| [379](#L379) | </ul> |
| [380](#L380) | <?php |
| [381](#L381) | } |
| [382](#L382) |  |
| [383](#L383) | /\*\* |
| [384](#L384) | \* Get Next Step URL. |
| [385](#L385) | \* |
| [386](#L386) | \* @return string |
| [387](#L387) | \*/ |
| [388](#L388) | private static function get\_next\_step() { |
| [389](#L389) | // Get current step. |
| [390](#L390) | $current\_step = self::$current\_step; |
| [391](#L391) |  |
| [392](#L392) | // Array of step keys. |
| [393](#L393) | $keys = array\_keys( self::$wizard\_steps ); |
| [394](#L394) | if ( end( $keys ) === $current\_step ) { // If last step is active then return WP Admin URL. |
| [395](#L395) | return admin\_url(); |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | // Search for step index in step keys. |
| [399](#L399) | $step\_index = array\_search( $current\_step, $keys, true ); |
| [400](#L400) | if ( false === $step\_index ) { // If index is not found then return empty string. |
| [401](#L401) | return ''; |
| [402](#L402) | } |
| [403](#L403) |  |
| [404](#L404) | // Return next step. |
| [405](#L405) | return add\_query\_arg( 'current-step', $keys[ $step\_index + 1 ] ); |
| [406](#L406) | } |
| [407](#L407) |  |
| [408](#L408) | /\*\* |
| [409](#L409) | \* Setup Page Content. |
| [410](#L410) | \*/ |
| [411](#L411) | private static function setup\_page\_content() { |
| [412](#L412) | ?> |
| [413](#L413) | <div class="wp2fa-setup-content"> |
| [414](#L414) | <?php |
| [415](#L415) | if ( ! empty( self::$wizard\_steps[ self::$current\_step ]['content'] ) ) { |
| [416](#L416) | call\_user\_func( self::$wizard\_steps[ self::$current\_step ]['content'] ); |
| [417](#L417) | } |
| [418](#L418) | ?> |
| [419](#L419) | </div> |
| [420](#L420) | <?php |
| [421](#L421) | } |
| [422](#L422) |  |
| [423](#L423) | /\*\* |
| [424](#L424) | \* Step View: `Welcome` |
| [425](#L425) | \*/ |
| [426](#L426) | private static function wp\_2fa\_step\_welcome() { |
| [427](#L427) | Wizard\_Steps::welcome\_step( self::get\_next\_step() ); |
| [428](#L428) | } |
| [429](#L429) |  |
| [430](#L430) | /\*\* |
| [431](#L431) | \* Step View: `Finish` |
| [432](#L432) | \*/ |
| [433](#L433) | private static function wp\_2fa\_step\_finish() { |
| [434](#L434) | User\_Helper::remove\_user\_needs\_to\_reconfigure\_2fa( User\_Helper::get\_user\_object() ); |
| [435](#L435) | Wizard\_Steps::congratulations\_step( true ); |
| [436](#L436) | } |
| [437](#L437) |  |
| [438](#L438) | /\*\* |
| [439](#L439) | \* Step Save: `Finish` |
| [440](#L440) | \* |
| [441](#L441) | \* @SuppressWarnings(PHPMD.ExitExpression) |
| [442](#L442) | \*/ |
| [443](#L443) | private static function wp\_2fa\_step\_finish\_save() { |
| [444](#L444) | // Verify nonce. |
| [445](#L445) | check\_admin\_referer( 'wp2fa-step-finish' ); |
| [446](#L446) | wp\_safe\_redirect( esc\_url\_raw( self::get\_next\_step() ) ); |
| [447](#L447) | exit(); |
| [448](#L448) | } |
| [449](#L449) |  |
| [450](#L450) | /\*\* |
| [451](#L451) | \* Step View: `Choose Methods` |
| [452](#L452) | \*/ |
| [453](#L453) | private static function wp\_2fa\_step\_global\_2fa\_methods() { |
| [454](#L454) | ?> |
| [455](#L455) | <form method="post" class="wp2fa-setup-form wp2fa-form-styles" autocomplete="off"> |
| [456](#L456) | <?php wp\_nonce\_field( 'wp2fa-step-choose-method' ); ?> |
| [457](#L457) | <div class="step-setting-wrapper active" data-step-title="<?php esc\_html\_e( '2FA methods', 'wp-2fa' ); ?>"> |
| [458](#L458) | <?php First\_Time\_Wizard\_Steps::select\_method( true ); ?> |
| [459](#L459) | <div class="wp2fa-setup-actions"> |
| [460](#L460) | <a class="button button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Continue Setup', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'Continue Setup', 'wp-2fa' ); ?></a> |
| [461](#L461) | </div> |
| [462](#L462) | </div> |
| [463](#L463) | <div class="step-setting-wrapper" data-step-title="<?php esc\_html\_e( 'Alternative methods', 'wp-2fa' ); ?>"> |
| [464](#L464) | <?php First\_Time\_Wizard\_Steps::backup\_method( true ); ?> |
| [465](#L465) | <div class="wp2fa-setup-actions"> |
| [466](#L466) | <a class="button button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Continue Setup', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'Continue Setup', 'wp-2fa' ); ?></a> |
| [467](#L467) | </div> |
| [468](#L468) | </div> |
| [469](#L469) | <div class="step-setting-wrapper" data-step-title="<?php esc\_html\_e( '2FA policy', 'wp-2fa' ); ?>"> |
| [470](#L470) | <?php First\_Time\_Wizard\_Steps::enforcement\_policy( true ); ?> |
| [471](#L471) | <div class="wp2fa-setup-actions"> |
| [472](#L472) | <a class="button button-primary continue-wizard hidden" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Continue Setup', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'Continue Setup', 'wp-2fa' ); ?></a> |
| [473](#L473) | <button class="button button-primary save-wizard" type="submit" name="save\_step" value="<?php esc\_attr\_e( 'All done', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'All done', 'wp-2fa' ); ?></button> |
| [474](#L474) | </div> |
| [475](#L475) | </div> |
| [476](#L476) | <div class="step-setting-wrapper hidden" data-step-title="<?php esc\_html\_e( 'Exclude users', 'wp-2fa' ); ?>"> |
| [477](#L477) | <?php First\_Time\_Wizard\_Steps::exclude\_users( true ); ?> |
| [478](#L478) | <div class="wp2fa-setup-actions"> |
| [479](#L479) | <a class="button button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Continue Setup', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'Continue Setup', 'wp-2fa' ); ?></a> |
| [480](#L480) | </div> |
| [481](#L481) | </div> |
| [482](#L482) |  |
| [483](#L483) | <?php if ( WP\_Helper::is\_multisite() ) : ?> |
| [484](#L484) | <div class="step-setting-wrapper" data-step-title="<?php esc\_html\_e( 'Exclude sites', 'wp-2fa' ); ?>"> |
| [485](#L485) | <?php First\_Time\_Wizard\_Steps::excluded\_network\_sites( true ); ?> |
| [486](#L486) | <div class="wp2fa-setup-actions"> |
| [487](#L487) | <a class="button button-primary" name="next\_step\_setting" value="<?php esc\_attr\_e( 'Continue Setup', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'Continue Setup', 'wp-2fa' ); ?></a> |
| [488](#L488) | </div> |
| [489](#L489) | </div> |
| [490](#L490) | <?php endif; ?> |
| [491](#L491) |  |
| [492](#L492) | <div class="step-setting-wrapper" data-step-title="<?php esc\_html\_e( 'Grace period', 'wp-2fa' ); ?>"> |
| [493](#L493) | <h3><?php esc\_html\_e( 'How long should the grace period for your users be?', 'wp-2fa' ); ?></h3> |
| [494](#L494) | <p class="description"><?php esc\_html\_e( 'When you configure the 2FA policies and require users to configure 2FA, they can either have a grace period to configure 2FA, or can be required to configure 2FA before the next time they login. Choose which method you\'d like to use:', 'wp-2fa' ); ?></p> |
| [495](#L495) | <?php First\_Time\_Wizard\_Steps::grace\_period( true ); ?> |
| [496](#L496) | <div class="wp2fa-setup-actions"> |
| [497](#L497) | <button class="button button-primary save-wizard" type="submit" name="save\_step" value="<?php esc\_attr\_e( 'All done', 'wp-2fa' ); ?>"><?php esc\_html\_e( 'All done', 'wp-2fa' ); ?></button> |
| [498](#L498) | </div> |
| [499](#L499) | </div> |
| [500](#L500) |  |
| [501](#L501) | </form> |
| [502](#L502) | <?php |
| [503](#L503) | } |
| [504](#L504) |  |
| [505](#L505) | /\*\* |
| [506](#L506) | \* Step Save: `Choose Method` |
| [507](#L507) | \* |
| [508](#L508) | \* @SuppressWarnings(PHPMD.ExitExpression) |
| [509](#L509) | \*/ |
| [510](#L510) | private static function wp\_2fa\_step\_global\_2fa\_methods\_save() { |
| [511](#L511) | // Check nonce. |
| [512](#L512) | check\_admin\_referer( 'wp2fa-step-choose-method' ); |
| [513](#L513) |  |
| [514](#L514) | $input = ( isset( $\_POST[ WP\_2FA\_POLICY\_SETTINGS\_NAME ] ) ) ? wp\_unslash( $\_POST[ WP\_2FA\_POLICY\_SETTINGS\_NAME ] ) : array(); // phpcs:ignore |
| [515](#L515) |  |
| [516](#L516) | if ( ! WP\_Helper::is\_multisite() ) { |
| [517](#L517) | unregister\_setting( |
| [518](#L518) | WP\_2FA\_POLICY\_SETTINGS\_NAME, |
| [519](#L519) | WP\_2FA\_POLICY\_SETTINGS\_NAME |
| [520](#L520) | ); |
| [521](#L521) | } |
| [522](#L522) | $settings\_page      = new Settings\_Page\_Policies(); |
| [523](#L523) | $sanitized\_settings = $settings\_page->validate\_and\_sanitize( $input, 'setup\_wizard' ); |
| [524](#L524) | WP2FA::update\_plugin\_settings( $sanitized\_settings ); |
| [525](#L525) |  |
| [526](#L526) | wp\_safe\_redirect( esc\_url\_raw( self::get\_next\_step() ) ); |
| [527](#L527) | exit(); |
| [528](#L528) | } |
| [529](#L529) |  |
| [530](#L530) | /\*\* |
| [531](#L531) | \* Send email with fresh code, or to setup email 2fa. |
| [532](#L532) | \* |
| [533](#L533) | \* @param int    $user\_id User id we want to send the message to. |
| [534](#L534) | \* @param string $nominated\_email\_address - The user custom address to use (name of the meta key to check for). |
| [535](#L535) | \* |
| [536](#L536) | \* @return bool |
| [537](#L537) | \* |
| [538](#L538) | \* @SuppressWarnings(PHPMD.ExitExpression) |
| [539](#L539) | \*/ |
| [540](#L540) | public static function send\_authentication\_setup\_email( $user\_id, $nominated\_email\_address = 'nominated\_email\_address', $is\_reset\_protection = false ) { |
| [541](#L541) |  |
| [542](#L542) | // If we have a nonce posted, check it. |
| [543](#L543) | if ( \wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
| [544](#L544) | $nonce\_check = \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_POST['nonce'] ) ), 'wp-2fa-send-setup-email' ); |
| [545](#L545) | if ( ! $nonce\_check ) { |
| [546](#L546) | return false; |
| [547](#L547) | } |
| [548](#L548) | } |
| [549](#L549) |  |
| [550](#L550) | if ( isset( $\_POST['user\_id'] ) ) { |
| [551](#L551) | $user = get\_userdata( intval( $\_POST['user\_id'] ) ); |
| [552](#L552) | } else { |
| [553](#L553) | $user = get\_userdata( $user\_id ); |
| [554](#L554) | } |
| [555](#L555) |  |
| [556](#L556) | // Grab email address is its provided. |
| [557](#L557) | if ( isset( $\_POST['email\_address'] ) ) { |
| [558](#L558) | $email = sanitize\_email( \wp\_unslash( $\_POST['email\_address'] ) ); |
| [559](#L559) | } else { |
| [560](#L560) | $email = sanitize\_email( $user->user\_email ); |
| [561](#L561) | } |
| [562](#L562) |  |
| [563](#L563) | if ( wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
| [564](#L564) | update\_user\_meta( $user->ID, WP\_2FA\_PREFIX . 'nominated\_email\_address', $email ); |
| [565](#L565) | } |
| [566](#L566) |  |
| [567](#L567) | $enabled\_email\_address = ''; |
| [568](#L568) | if ( ! empty( $nominated\_email\_address ) ) { |
| [569](#L569) | $enabled\_email\_address = get\_user\_meta( $user->ID, WP\_2FA\_PREFIX . $nominated\_email\_address, true ); |
| [570](#L570) | } |
| [571](#L571) |  |
| [572](#L572) | // Generate a token and setup email. |
| [573](#L573) | $token = Authentication::generate\_token( $user->ID ); |
| [574](#L574) |  |
| [575](#L575) |  |
| [576](#L576) | if ( $is\_reset\_protection ) { |
| [577](#L577) | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'reset\_password\_code\_email\_subject' ), $user->ID ) ); |
| [578](#L578) | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'reset\_password\_code\_email\_body' ), $user->ID, $token ) ); |
| [579](#L579) | } else if ( wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
| [580](#L580) | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_email\_subject' ), $user->ID ) ); |
| [581](#L581) | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_setup\_email\_body' ), $user->ID, $token ) ); |
| [582](#L582) | } else { |
| [583](#L583) | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_email\_subject' ), $user->ID ) ); |
| [584](#L584) | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'login\_code\_email\_body' ), $user->ID, $token ) ); |
| [585](#L585) | } |
| [586](#L586) |  |
| [587](#L587) | if ( ! empty( $enabled\_email\_address ) ) { |
| [588](#L588) | $email\_address = $enabled\_email\_address; |
| [589](#L589) | } else { |
| [590](#L590) | $email\_address = $user->user\_email; |
| [591](#L591) | } |
| [592](#L592) |  |
| [593](#L593) | return Settings\_Page::send\_email( $email\_address, $subject, $message ); |
| [594](#L594) | } |
| [595](#L595) |  |
| [596](#L596) | /\*\* |
| [597](#L597) | \* Send email with fresh code, or to setup email 2fa. |
| [598](#L598) | \* |
| [599](#L599) | \* @param int    $user\_id User id we want to send the message to. |
| [600](#L600) | \* @param string $nominated\_email\_address - The user custom address to use (name of the meta key to check for). |
| [601](#L601) | \* |
| [602](#L602) | \* @return bool |
| [603](#L603) | \* |
| [604](#L604) | \* @SuppressWarnings(PHPMD.ExitExpression) |
| [605](#L605) | \*/ |
| [606](#L606) | public static function send\_backup\_codes\_email( $user\_id, $nominated\_email\_address = 'nominated\_email\_address' ) { |
| [607](#L607) |  |
| [608](#L608) | // If we have a nonce posted, check it. |
| [609](#L609) | if ( \wp\_doing\_ajax() && isset( $\_POST['nonce'] ) ) { |
| [610](#L610) | $nonce\_check = \wp\_verify\_nonce( \sanitize\_text\_field( \wp\_unslash( $\_POST['nonce'] ) ), 'wp-2fa-send-backup-codes-email-nonce' ); |
| [611](#L611) | if ( ! $nonce\_check ) { |
| [612](#L612) | return false; |
| [613](#L613) | } |
| [614](#L614) | } |
| [615](#L615) |  |
| [616](#L616) | if ( isset( $\_POST['user\_id'] ) ) { |
| [617](#L617) | $user = get\_userdata( intval( $\_POST['user\_id'] ) ); |
| [618](#L618) | } else { |
| [619](#L619) | $user = get\_userdata( $user\_id ); |
| [620](#L620) | } |
| [621](#L621) |  |
| [622](#L622) | // Grab email address is its provided. |
| [623](#L623) | if ( isset( $\_POST['email\_address'] ) ) { |
| [624](#L624) | $email = sanitize\_email( \wp\_unslash( $\_POST['email\_address'] ) ); |
| [625](#L625) | } else { |
| [626](#L626) | $email = sanitize\_email( $user->user\_email ); |
| [627](#L627) | } |
| [628](#L628) |  |
| [629](#L629) | $enabled\_email\_address = ''; |
| [630](#L630) | if ( ! empty( $nominated\_email\_address ) ) { |
| [631](#L631) | $enabled\_email\_address = get\_user\_meta( $user->ID, WP\_2FA\_PREFIX . $nominated\_email\_address, true ); |
| [632](#L632) | } |
| [633](#L633) |  |
| [634](#L634) | $codes = substr( str\_replace( '\\n', '<br>', \sanitize\_text\_field( \wp\_unslash( $\_POST['codes'] ) ) ), 1, -1 ); |
| [635](#L635) |  |
| [636](#L636) | $subject = wp\_strip\_all\_tags( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'user\_backup\_codes\_email\_subject' ), $user->ID ) ); |
| [637](#L637) | $message = wpautop( WP2FA::replace\_email\_strings( WP2FA::get\_wp2fa\_email\_templates( 'user\_backup\_codes\_email\_body' ), $user->ID ) ); |
| [638](#L638) |  |
| [639](#L639) | $final\_output = str\_replace( '{backup\_codes}', $codes, $message ); |
| [640](#L640) |  |
| [641](#L641) | if ( ! empty( $enabled\_email\_address ) ) { |
| [642](#L642) | $email\_address = $enabled\_email\_address; |
| [643](#L643) | } else { |
| [644](#L644) | $email\_address = $user->user\_email; |
| [645](#L645) | } |
| [646](#L646) |  |
| [647](#L647) | return Settings\_Page::send\_email( $email\_address, $subject, $final\_output ); |
| [648](#L648) | } |
| [649](#L649) |  |
| [650](#L650) | /\*\* |
| [651](#L651) | \* Regenerates the TOTP key for the user |
| [652](#L652) | \* |
| [653](#L653) | \* @return void - JSON - object with "key" - stores the new key and "qr" - stores the new QR code. |
| [654](#L654) | \* |
| [655](#L655) | \* @since 2.5.0 |
| [656](#L656) | \*/ |
| [657](#L657) | public static function regenerate\_authentication\_key() { |
| [658](#L658) | // Grab current user. |
| [659](#L659) | $user = wp\_get\_current\_user(); |
| [660](#L660) |  |
| [661](#L661) | $key = Authentication::generate\_key(); |
| [662](#L662) |  |
| [663](#L663) | $site\_name = site\_url(); |
| [664](#L664) | $site\_name = trim( str\_replace( array( 'http://', 'https://' ), '', $site\_name ), '/' ); |
| [665](#L665) |  |
| [666](#L666) | /\*\* |
| [667](#L667) | \* Changing the title of the login screen for the TOTP method. |
| [668](#L668) | \* |
| [669](#L669) | \* @param string $title - The default title. |
| [670](#L670) | \* @param \WP\_User $user - The WP user. |
| [671](#L671) | \* |
| [672](#L672) | \* @since 2.0.0 |
| [673](#L673) | \*/ |
| [674](#L674) | $totp\_title = apply\_filters( WP\_2FA\_PREFIX . 'totp\_title', $site\_name . ':' . $user->user\_login, $user ); |
| [675](#L675) | $new\_qr     = Authentication::get\_google\_qr\_code( $totp\_title, $key, $site\_name ); |
| [676](#L676) |  |
| [677](#L677) | wp\_send\_json\_success( |
| [678](#L678) | array( |
| [679](#L679) | 'key' => Authentication::decrypt\_key\_if\_needed( $key ), |
| [680](#L680) | 'qr'  => $new\_qr, |
| [681](#L681) | ) |
| [682](#L682) | ); |
| [683](#L683) | } |
| [684](#L684) |  |
| [685](#L685) | /\*\* |
| [686](#L686) | \* 3rd Party plugins |
| [687](#L687) | \* |
| [688](#L688) | \* @param array $wizard\_steps - Array with the current wizard steps. |
| [689](#L689) | \* |
| [690](#L690) | \* @return array |
| [691](#L691) | \*/ |
| [692](#L692) | public static function wp\_2fa\_add\_intro\_step( $wizard\_steps ) { |
| [693](#L693) | $new\_wizard\_steps = array( |
| [694](#L694) | 'test' => array( |
| [695](#L695) | 'name'        => \_\_( 'Welcome to WP 2FA', 'wp-2fa' ), |
| [696](#L696) | 'content'     => array( \_\_CLASS\_\_, 'introduction\_step' ), |
| [697](#L697) | 'save'        => array( \_\_CLASS\_\_, 'introduction\_step\_save' ), |
| [698](#L698) | 'wizard\_type' => 'welcome\_wizard', |
| [699](#L699) | ), |
| [700](#L700) | ); |
| [701](#L701) |  |
| [702](#L702) | // combine the two arrays. |
| [703](#L703) | $wizard\_steps = $new\_wizard\_steps + $wizard\_steps; |
| [704](#L704) |  |
| [705](#L705) | return $wizard\_steps; |
| [706](#L706) | } |
| [707](#L707) |  |
| [708](#L708) | /\*\* |
| [709](#L709) | \* Shows introduction step of the wizard |
| [710](#L710) | \* |
| [711](#L711) | \* @return void |
| [712](#L712) | \*/ |
| [713](#L713) | private static function introduction\_step() { |
| [714](#L714) | Wizard\_Steps::introduction\_step(); |
| [715](#L715) | } |
| [716](#L716) |  |
| [717](#L717) | /\*\* |
| [718](#L718) | \* Step Save: `Addons` |
| [719](#L719) | \* |
| [720](#L720) | \* @SuppressWarnings(PHPMD.ExitExpression) |
| [721](#L721) | \*/ |
| [722](#L722) | private static function introduction\_step\_save() { |
| [723](#L723) | // Check nonce. |
| [724](#L724) | check\_admin\_referer( 'wp2fa-step-addon' ); |
| [725](#L725) |  |
| [726](#L726) | wp\_safe\_redirect( esc\_url\_raw( self::get\_next\_step() ) ); |
| [727](#L727) | exit(); |
| [728](#L728) | } |
| [729](#L729) | } |
| [730](#L730) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688&format=txt)
* [Original Format](/export/2940688/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_65aaa456_20250115_084331.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WP 2FA – Two-factor authentication for WordPress <= 2.5.0 - Cross-Site Request Forgery

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WP 2FA – Two-factor authentication for WordPress <= 2.5.0 - Cross-Site Request Forgery

4.3

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

| CVE | [CVE-2023-6520](https://www.cve.org/CVERecord?id=CVE-2023-6520) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | January 2, 2024 |
| Last Updated | January 22, 2024 |
| Researcher | [Ulyses Saicha](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/ulyses-saicha) |

### Description

The WP 2FA – Two-factor authentication for WordPress plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.5.0. This is due to missing or incorrect nonce validation on the send\_backup\_codes\_email function. This makes it possible for unauthenticated attackers to send emails with arbitrary content to registered users via a forged request granted they can trick a site administrator or other registered user into performing an action such as clicking on a link. While a nonce check is present, it is only executed if a nonce is set. By omitting a nonce from the request, the check can be bypassed.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wp-2fa/trunk/includes/classes/Admin/class-setup-wizard.php?rev=2940688#L606)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3009922%40wp-2fa&new=3009922%40wp-2fa&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-2fa%2Fwp-2fa-two-factor-authentication-for-wordpress-250-cross-site-request-forgery&t=WP%202FA%20%E2%80%93%20Two-factor%20authentication%20for%20WordPress%20%3C%3D%202.5.0%20-%20Cross-Site%20Request%20Forgery "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-2fa%2Fwp-2fa-two-factor-authentication-for-wordpress-250-cross-site-request-forgery&text=WP%202FA%20%E2%80%93%20Two-factor%20authentication%20for%20WordPress%20%3C%3D%202.5.0%20-%20Cross-Site%20Request%20Forgery "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwp-2fa%2Fwp-2fa-two-factor-authentication-for-wordpress-250-cross-site-request-forgery "LinkedIn")
Email

## Vulnerability Details for WP 2FA – Two-factor authentication for WordPress

#### [WP 2FA – Two-factor authentication for WordPress](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-2fa)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wp-2fa [(view on wordpress.org)](https://wordpress.org/plugins/wp-2fa) |
| Patched? | Yes |
| Remediation | Update to version 2.6.0, or a newer patched version |
| Affected Version | * <= 2.5.0 |
| Patched Version | * 2.6.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


