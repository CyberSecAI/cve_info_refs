=== Content from discuss.elastic.co_45661813_20250115_102633.html ===


[Discuss the Elastic Stack](/)

# [Beats and Elastic Agent 8.11.3 / 7.17.16 Security Update (ESA-2023-30)](/t/beats-and-elastic-agent-8-11-3-7-17-16-security-update-esa-2023-30/349180)

[Announcements](/c/announcements/security-announcements/31)

[Security Announcements](/c/announcements/security-announcements/31)

[ismisepaul](https://discuss.elastic.co/u/ismisepaul)
(Paul)

December 12, 2023, 5:00pm

1

## Beats and Elastic Agent Insertion of Sensitive Information into Log File

An issue was discovered by Elastic whereby Beats and Elastic Agent would log a raw event in its own logs at the `WARN` or `ERROR` level if ingesting that event to Elasticsearch failed with any `4xx` HTTP status code except `409` or `429`. Depending on the nature of the event that Beats or Elastic Agent attempted to ingest, this could lead to the insertion of sensitive or private information in the Beats or Elastic Agent logs. Elastic has released 8.11.3 and 7.17.16 that prevents this issue by limiting these types of logs to `DEBUG` level logging, which is disabled by default.

### Affected Versions:

* Beats and Elastic Agent versions on or after 7.0.0 and before 7.17.16
* Beats and Elastic Agent versions on or after 8.0.0 and before 8.11.3

### Solutions and Mitigations:

The issue is resolved in version 7.17.16 and 8.11.3.

### Reviewing Logs for Sensitive Information

Users can search for instances of these events and determine whether any sensitive information has been leaked in Beats or Elastic Agent logs by searching for the following string

`Cannot index event publisher.Event`

### Workarounds for Users Who Cannot Upgrade

This log line is logged at the `WARN` level, changing the log level to `ERROR` will suppress these logs. For Beats and standalone Elastic Agent the log level can be changed in the configuration file, see:

* [https://www.elastic.co/guide/en/beats/filebeat/current/configuration-logging.html#leve](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-logging.html#level)
* [Configure logging for standalone Elastic Agents | Fleet and Elastic Agent Guide [8.11] | Elastic](https://www.elastic.co/guide/en/fleet/current/elastic-agent-standalone-logging-config.html)

For Fleet managed Elastic Agents the log level for each agent can be changed in the Fleet UI as described in [Monitor Elastic Agents | Fleet and Elastic Agent Guide [8.11] | Elastic](https://www.elastic.co/guide/en/fleet/current/monitor-elastic-agent.html#change-logging-level). The log level can also be changed using the

Fleet API, for example:

```
curl 'https://<KIBANA>/api/fleet/agents/<AGENT-ID>/actions' \
    --data-raw '{"action":{"type":"SETTINGS","data":{"log_level":"debug"}}}' \
    -H "kbn-xsrf:kibana" \
    -u <user granted to change Fleet settings, preferably elastic user>

```

**Severity:** CVSSv3: 6.8(Medium) - [AV:A/AC:L/PR:L/UI:N/S:CC:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N)

**CVE IDs**

* CVE-2023-49922 (Beats)
* CVE-2023-6687 (Elastic Agent)

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Change log level for beats deployed by fleet managed elastic-agent](https://discuss.elastic.co/t/change-log-level-for-beats-deployed-by-fleet-managed-elastic-agent/338473)  [Elasticsearch](/c/elastic-stack/elasticsearch/6) [fleet](https://discuss.elastic.co/tag/fleet) | 3 | 558 | August 21, 2023 |
| [Change Log Levels for Standalone Elastic Agent](https://discuss.elastic.co/t/change-log-levels-for-standalone-elastic-agent/324243)  [Elastic Agent](/c/elastic-stack/elastic-agent/91) | 1 | 148 | February 27, 2023 |
| [Elastic Agent 8.15.0 Security Update (ESA-2024-23)](https://discuss.elastic.co/t/elastic-agent-8-15-0-security-update-esa-2024-23/364635)  [Security Announcements](/c/announcements/security-announcements/31) | 0 | 1185 | August 8, 2024 |
| [Filebeat Components ignores logging level](https://discuss.elastic.co/t/filebeat-components-ignores-logging-level/351260)  [Elastic Agent](/c/elastic-stack/elastic-agent/91) [filebeat](https://discuss.elastic.co/tag/filebeat) | 1 | 184 | February 14, 2024 |
| [Get agent event logs via Elastic Agent Integration](https://discuss.elastic.co/t/get-agent-event-logs-via-elastic-agent-integration/372860)  [Elastic Agent](/c/elastic-stack/elastic-agent/91) [filebeat](https://discuss.elastic.co/tag/filebeat) ,  [metricbeat](https://discuss.elastic.co/tag/metricbeat) ,  [integrations](https://discuss.elastic.co/tag/integrations) | 2 | 29 | January 6, 2025 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.elastic.co/legal/terms-of-use)
* [Privacy Policy](https://www.elastic.co/legal/privacy-policy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


