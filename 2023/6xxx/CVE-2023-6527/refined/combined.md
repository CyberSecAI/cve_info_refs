=== Content from plugins.trac.wordpress.org_2270a898_20250114_221820.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Femail-subscribe%2Ftags%2F1.2.19%2Fwp-email-subscription.php%3Frev%3D3005188)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← Previous Revision
* [Latest Revision](/browser/email-subscribe/tags/1.2.19/wp-email-subscription.php)
* Next Revision →
* [Blame](/browser/email-subscribe/tags/1.2.19/wp-email-subscription.php?annotate=blame&rev=3005188 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/email-subscribe/tags/1.2.19/wp-email-subscription.php?rev=3005188)

---

# [source:](/browser?rev=3005188&order=name "Go to repository root") [email-subscribe](/browser/email-subscribe?rev=3005188&order=name "View email-subscribe")/[tags](/browser/email-subscribe/tags?rev=3005188&order=name "View tags")/[1.2.19](/browser/email-subscribe/tags/1.2.19?rev=3005188&order=name "View 1.2.19")/[wp-email-subscription.php](/browser/email-subscribe/tags/1.2.19/wp-email-subscription.php?rev=3005188&order=name "View wp-email-subscription.php") @ [3005188](/changeset/3005188/ "View changeset 3005188")

View diff against:

View revision:

| [Last change](/changeset/3005188/email-subscribe/tags/1.2.19/wp-email-subscription.php "View differences") on this file since 3005188 was [3005188](/changeset/3005188/ "View changeset 3005188"), checked in by nik00726, [14 months ago](/timeline?from=2023-12-04T16%3A09%3A00Z&precision=second "See timeline at 12/04/2023 04:09:00 PM") |
| --- |
| Fixed referer was not escaped |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 132.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: email subscription popup |
| [4](#L4) | Plugin URI:https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/ |
| [5](#L5) | Author URI:https://www.i13websolution.com/ |
| [6](#L6) | Description: This is beautiful email subscription modal popup plugin for wordpress.Each time new user visit your site user will see modal popup for email subscription.Even you can setup email subscription form by widget. |
| [7](#L7) | Author:I Thirteen Web Solution |
| [8](#L8) | Version:1.2.19 |
| [9](#L9) | Text Domain:email-subscribe |
| [10](#L10) | Domain Path: /languages |
| [11](#L11) | \*/ |
| [12](#L12) |  |
| [13](#L13) | add\_action('admin\_menu', 'email\_subscription\_popup\_admin\_menu'); |
| [14](#L14) | //add\_action( 'admin\_init', 'email\_subscription\_popup\_admin\_admin\_init' ); |
| [15](#L15) | register\_activation\_hook(\_\_FILE\_\_,'install\_email\_subscription\_popup\_admin'); |
| [16](#L16) | register\_deactivation\_hook(\_\_FILE\_\_,'es\_email\_subscribe\_remove\_access\_capabilities'); |
| [17](#L17) | add\_action('wp\_enqueue\_scripts', 'email\_subscription\_popup\_load\_styles\_and\_js'); |
| [18](#L18) | if(!is\_admin()){ |
| [19](#L19) | add\_action('wp\_footer','addModalPopupHtmlToWpFooter'); |
| [20](#L20) | } |
| [21](#L21) | add\_action('wp\_head','unsubscribe\_user\_func'); |
| [22](#L22) | add\_action( 'wp\_ajax\_getEmailTemplate', 'getEmailTemplate' ); |
| [23](#L23) | add\_action( 'widgets\_init', 'nksnewslettersubscriberSet' ); |
| [24](#L24) | add\_action( 'wp\_ajax\_store\_email', 'store\_email\_callback' ); |
| [25](#L25) | add\_action( 'wp\_ajax\_nopriv\_store\_email', 'store\_email\_callback' ); |
| [26](#L26) | add\_action('plugins\_loaded', 'load\_lang\_for\_email\_subscription\_popup'); |
| [27](#L27) |  |
| [28](#L28) | add\_filter( 'wp\_default\_editor', 'force\_default\_editor\_email\_subscriber' ); |
| [29](#L29) | add\_filter( 'user\_has\_cap', 'es\_email\_subscribe\_admin\_cap\_list' , 10, 4 ); |
| [30](#L30) | function force\_default\_editor\_email\_subscriber() { |
| [31](#L31) | //allowed: tinymce, html |
| [32](#L32) | return 'tinymce'; |
| [33](#L33) | } |
| [34](#L34) |  |
| [35](#L35) |  |
| [36](#L36) |  |
| [37](#L37) | function load\_lang\_for\_email\_subscription\_popup() { |
| [38](#L38) |  |
| [39](#L39) | load\_plugin\_textdomain( 'email-subscribe', false, basename( dirname( \_\_FILE\_\_ ) ) . '/languages/' ); |
| [40](#L40) | add\_filter( 'map\_meta\_cap',  'map\_es\_email\_subscribe\_meta\_caps', 10, 4 ); |
| [41](#L41) | } |
| [42](#L42) |  |
| [43](#L43) | function es\_email\_subscribe\_admin\_cap\_list($allcaps, $caps, $args, $user){ |
| [44](#L44) |  |
| [45](#L45) |  |
| [46](#L46) | if ( ! in\_array( 'administrator', $user->roles ) ) { |
| [47](#L47) |  |
| [48](#L48) | return $allcaps; |
| [49](#L49) | } |
| [50](#L50) | else{ |
| [51](#L51) |  |
| [52](#L52) | if(!isset($allcaps['es\_email\_subscribe\_settings'])){ |
| [53](#L53) |  |
| [54](#L54) | $allcaps['es\_email\_subscribe\_settings']=true; |
| [55](#L55) | } |
| [56](#L56) |  |
| [57](#L57) | if(!isset($allcaps['es\_email\_subscribe\_view\_subscribers'])){ |
| [58](#L58) |  |
| [59](#L59) | $allcaps['es\_email\_subscribe\_view\_subscribers']=true; |
| [60](#L60) | } |
| [61](#L61) | if(!isset($allcaps['es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'])){ |
| [62](#L62) |  |
| [63](#L63) | $allcaps['es\_email\_subscribe\_send\_email\_to\_selected\_subscribers']=true; |
| [64](#L64) | } |
| [65](#L65) | if(!isset($allcaps['es\_email\_subscribe\_send\_email\_to\_all\_subscribers'])){ |
| [66](#L66) |  |
| [67](#L67) | $allcaps['es\_email\_subscribe\_send\_email\_to\_all\_subscribers']=true; |
| [68](#L68) | } |
| [69](#L69) | if(!isset($allcaps['es\_email\_subscribe\_delete\_subscribers'])){ |
| [70](#L70) |  |
| [71](#L71) | $allcaps['es\_email\_subscribe\_delete\_subscribers']=true; |
| [72](#L72) | } |
| [73](#L73) |  |
| [74](#L74) | if(!isset($allcaps['es\_email\_subscribe\_view\_unsubscribers'])){ |
| [75](#L75) |  |
| [76](#L76) | $allcaps['es\_email\_subscribe\_view\_unsubscribers']=true; |
| [77](#L77) | } |
| [78](#L78) |  |
| [79](#L79) | if(!isset($allcaps['es\_email\_subscribe\_delete\_unsubscribers'])){ |
| [80](#L80) |  |
| [81](#L81) | $allcaps['es\_email\_subscribe\_delete\_unsubscribers']=true; |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | if(!isset($allcaps['es\_email\_subscribe\_re\_subscriber\_unsubscribers'])){ |
| [85](#L85) |  |
| [86](#L86) | $allcaps['es\_email\_subscribe\_re\_subscriber\_unsubscribers']=true; |
| [87](#L87) | } |
| [88](#L88) |  |
| [89](#L89) |  |
| [90](#L90) |  |
| [91](#L91) | } |
| [92](#L92) |  |
| [93](#L93) | return $allcaps; |
| [94](#L94) |  |
| [95](#L95) | } |
| [96](#L96) |  |
| [97](#L97) | function map\_es\_email\_subscribe\_meta\_caps( array $caps, $cap, $user\_id, array $args  ) { |
| [98](#L98) |  |
| [99](#L99) |  |
| [100](#L100) | if ( ! in\_array( $cap, array( |
| [101](#L101) | 'es\_email\_subscribe\_settings', |
| [102](#L102) | 'es\_email\_subscribe\_view\_subscribers', |
| [103](#L103) | 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers', |
| [104](#L104) | 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers', |
| [105](#L105) | 'es\_email\_subscribe\_delete\_subscribers', |
| [106](#L106) | 'es\_email\_subscribe\_view\_unsubscribers', |
| [107](#L107) | 'es\_email\_subscribe\_delete\_unsubscribers', |
| [108](#L108) | 'es\_email\_subscribe\_re\_subscriber\_unsubscribers', |
| [109](#L109) |  |
| [110](#L110) | ), true ) ) { |
| [111](#L111) |  |
| [112](#L112) | return $caps; |
| [113](#L113) | } |
| [114](#L114) |  |
| [115](#L115) |  |
| [116](#L116) |  |
| [117](#L117) |  |
| [118](#L118) | $caps = array(); |
| [119](#L119) |  |
| [120](#L120) | switch ( $cap ) { |
| [121](#L121) |  |
| [122](#L122) | case 'es\_email\_subscribe\_settings': |
| [123](#L123) | $caps[] = 'es\_email\_subscribe\_settings'; |
| [124](#L124) | break; |
| [125](#L125) |  |
| [126](#L126) | case 'es\_email\_subscribe\_view\_subscribers': |
| [127](#L127) | $caps[] = 'es\_email\_subscribe\_view\_subscribers'; |
| [128](#L128) | break; |
| [129](#L129) |  |
| [130](#L130) | case 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers': |
| [131](#L131) | $caps[] = 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'; |
| [132](#L132) | break; |
| [133](#L133) |  |
| [134](#L134) | case 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers': |
| [135](#L135) | $caps[] = 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers'; |
| [136](#L136) | break; |
| [137](#L137) |  |
| [138](#L138) | case 'es\_email\_subscribe\_delete\_subscribers': |
| [139](#L139) | $caps[] = 'es\_email\_subscribe\_delete\_subscribers'; |
| [140](#L140) | break; |
| [141](#L141) |  |
| [142](#L142) | case 'es\_email\_subscribe\_view\_unsubscribers': |
| [143](#L143) | $caps[] = 'es\_email\_subscribe\_view\_unsubscribers'; |
| [144](#L144) | break; |
| [145](#L145) |  |
| [146](#L146) | case 'es\_email\_subscribe\_delete\_unsubscribers': |
| [147](#L147) | $caps[] = 'es\_email\_subscribe\_delete\_unsubscribers'; |
| [148](#L148) | break; |
| [149](#L149) |  |
| [150](#L150) | case 'es\_email\_subscribe\_re\_subscriber\_unsubscribers': |
| [151](#L151) | $caps[] = 'es\_email\_subscribe\_re\_subscriber\_unsubscribers'; |
| [152](#L152) | break; |
| [153](#L153) |  |
| [154](#L154) | default: |
| [155](#L155) |  |
| [156](#L156) | $caps[] = 'do\_not\_allow'; |
| [157](#L157) | break; |
| [158](#L158) | } |
| [159](#L159) |  |
| [160](#L160) |  |
| [161](#L161) | return apply\_filters( 'es\_email\_subscribe\_meta\_caps', $caps, $cap, $user\_id, $args ); |
| [162](#L162) | } |
| [163](#L163) |  |
| [164](#L164) | function es\_email\_subscribe\_add\_access\_capabilities() { |
| [165](#L165) |  |
| [166](#L166) | // Capabilities for all roles. |
| [167](#L167) | $roles = array( 'administrator' ); |
| [168](#L168) | foreach ( $roles as $role ) { |
| [169](#L169) |  |
| [170](#L170) | $role = get\_role( $role ); |
| [171](#L171) | if ( empty( $role ) ) { |
| [172](#L172) | continue; |
| [173](#L173) | } |
| [174](#L174) |  |
| [175](#L175) |  |
| [176](#L176) | if(!$role->has\_cap( 'es\_email\_subscribe\_settings' ) ){ |
| [177](#L177) |  |
| [178](#L178) | $role->add\_cap( 'es\_email\_subscribe\_settings' ); |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | if(!$role->has\_cap( 'es\_email\_subscribe\_view\_subscribers' ) ){ |
| [182](#L182) |  |
| [183](#L183) | $role->add\_cap( 'es\_email\_subscribe\_view\_subscribers' ); |
| [184](#L184) | } |
| [185](#L185) |  |
| [186](#L186) |  |
| [187](#L187) | if(!$role->has\_cap( 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers' ) ){ |
| [188](#L188) |  |
| [189](#L189) | $role->add\_cap( 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers' ); |
| [190](#L190) | } |
| [191](#L191) |  |
| [192](#L192) | if(!$role->has\_cap( 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers' ) ){ |
| [193](#L193) |  |
| [194](#L194) | $role->add\_cap( 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers' ); |
| [195](#L195) | } |
| [196](#L196) |  |
| [197](#L197) | if(!$role->has\_cap( 'es\_email\_subscribe\_delete\_subscribers' ) ){ |
| [198](#L198) |  |
| [199](#L199) | $role->add\_cap( 'es\_email\_subscribe\_delete\_subscribers' ); |
| [200](#L200) | } |
| [201](#L201) |  |
| [202](#L202) | if(!$role->has\_cap( 'es\_email\_subscribe\_view\_unsubscribers' ) ){ |
| [203](#L203) |  |
| [204](#L204) | $role->add\_cap( 'es\_email\_subscribe\_view\_unsubscribers' ); |
| [205](#L205) | } |
| [206](#L206) |  |
| [207](#L207) | if(!$role->has\_cap( 'es\_email\_subscribe\_delete\_unsubscribers' ) ){ |
| [208](#L208) |  |
| [209](#L209) | $role->add\_cap( 'es\_email\_subscribe\_delete\_unsubscribers' ); |
| [210](#L210) | } |
| [211](#L211) |  |
| [212](#L212) | if(!$role->has\_cap( 'es\_email\_subscribe\_re\_subscriber\_unsubscribers' ) ){ |
| [213](#L213) |  |
| [214](#L214) | $role->add\_cap( 'es\_email\_subscribe\_re\_subscriber\_unsubscribers' ); |
| [215](#L215) | } |
| [216](#L216) |  |
| [217](#L217) |  |
| [218](#L218) |  |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | $user = wp\_get\_current\_user(); |
| [222](#L222) | $user->get\_role\_caps(); |
| [223](#L223) |  |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) | function es\_email\_subscribe\_remove\_access\_capabilities(){ |
| [227](#L227) |  |
| [228](#L228) | global $wp\_roles; |
| [229](#L229) |  |
| [230](#L230) | if ( ! isset( $wp\_roles ) ) { |
| [231](#L231) | $wp\_roles = new WP\_Roles(); |
| [232](#L232) | } |
| [233](#L233) |  |
| [234](#L234) | if (isset($wp\_roles) && $wp\_roles!=NULL && is\_object($wp\_roles) && 0>count($wp\_roles->roles)) { |
| [235](#L235) |  |
| [236](#L236) | foreach ( $wp\_roles->roles as $role => $details ) { |
| [237](#L237) | $role = $wp\_roles->get\_role( $role ); |
| [238](#L238) | if ( empty( $role ) ) { |
| [239](#L239) | continue; |
| [240](#L240) | } |
| [241](#L241) |  |
| [242](#L242) | $role->remove\_cap( 'es\_email\_subscribe\_settings'); |
| [243](#L243) | $role->remove\_cap( 'es\_email\_subscribe\_view\_subscribers'); |
| [244](#L244) | $role->remove\_cap( 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers'); |
| [245](#L245) | $role->remove\_cap( 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers'); |
| [246](#L246) | $role->remove\_cap( 'es\_email\_subscribe\_delete\_subscribers'); |
| [247](#L247) | $role->remove\_cap( 'es\_email\_subscribe\_view\_unsubscribers'); |
| [248](#L248) | $role->remove\_cap( 'es\_email\_subscribe\_delete\_unsubscribers'); |
| [249](#L249) | $role->remove\_cap( 'es\_email\_subscribe\_re\_subscriber\_unsubscribers'); |
| [250](#L250) |  |
| [251](#L251) |  |
| [252](#L252) | } |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | // Refresh current set of capabilities of the user, to be able to directly use the new caps. |
| [256](#L256) | $user = wp\_get\_current\_user(); |
| [257](#L257) | $user->get\_role\_caps(); |
| [258](#L258) |  |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) |  |
| [262](#L262) | function nksnewslettersubscriberSet() { |
| [263](#L263) |  |
| [264](#L264) | register\_widget( 'nksnewslettersubscriber' ); |
| [265](#L265) |  |
| [266](#L266) | } |
| [267](#L267) |  |
| [268](#L268) | function install\_email\_subscription\_popup\_admin(){ |
| [269](#L269) |  |
| [270](#L270) |  |
| [271](#L271) | global $wpdb; |
| [272](#L272) | $table\_name = $wpdb->prefix . "nl\_subscriptions"; |
| [273](#L273) | $table\_name2 = $wpdb->prefix . "newsletters\_management"; |
| [274](#L274) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [275](#L275) |  |
| [276](#L276) | $sql = "CREATE TABLE IF NOT EXISTS  " . $table\_name . " ( |
| [277](#L277) | `id` int(10) unsigned NOT NULL AUTO\_INCREMENT, |
| [278](#L278) | `name` varchar(200) NOT NULL, |
| [279](#L279) | `email` varchar(250) NOT NULL, |
| [280](#L280) | `subscribed\_on` datetime NOT NULL, |
| [281](#L281) | `is\_subscribed` tinyint(1) NOT NULL DEFAULT '1', |
| [282](#L282) | `unsubs\_key` varchar(100) NOT NULL, |
| [283](#L283) | PRIMARY KEY  (id) |
| [284](#L284) | ) $charset\_collate;"; |
| [285](#L285) | require\_once(ABSPATH . 'wp-admin/includes/upgrade.php'); |
| [286](#L286) | dbDelta($sql); |
| [287](#L287) |  |
| [288](#L288) |  |
| [289](#L289) | $wp\_news\_letter\_settings=array( |
| [290](#L290) |  |
| [291](#L291) | 'newsletter\_show\_on'=>'any', |
| [292](#L292) | 'newsletter\_cookie'=>'1', |
| [293](#L293) | 'heading'=>'Subscribe to our newsletter', |
| [294](#L294) | 'subheading'=>'Want to be notified when our article is published? Enter your email address and name below to be the first to know.', |
| [295](#L295) | 'email'=>'Email', |
| [296](#L296) | 'name'=>'Name', |
| [297](#L297) | 'submitbtn'=>'SIGN UP FOR NEWSLETTER NOW', |
| [298](#L298) | 'requiredfield'=>'This field is required.', |
| [299](#L299) | 'iinvalidemail'=>'Please enter valid email address.', |
| [300](#L300) | 'wait'=>'Please wait...', |
| [301](#L301) | 'invalid\_request'=>'Invalid request.', |
| [302](#L302) | 'email\_exist'=>'This email is already exist.', |
| [303](#L303) | 'success'=>'You have successfully subscribed to our Newsletter!', |
| [304](#L304) | 'outgoing\_email\_limit'=>'150', |
| [305](#L305) | 'unsubscribe\_message'=>'You have successfully unsubscribed from email newsletter.Thank you...', |
| [306](#L306) | 'show\_name\_field'=>'1', |
| [307](#L307) | 'show\_agreement'=>'0', |
| [308](#L308) | 'agreement\_text'=>'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>', |
| [309](#L309) | 'agreement\_error'=>'Please read and agree to our terms & conditions.', |
| [310](#L310) | 'additional\_css'=>'' |
| [311](#L311) |  |
| [312](#L312) | ); |
| [313](#L313) |  |
| [314](#L314) | $existingopt=get\_option('wp\_news\_letter\_settings'); |
| [315](#L315) | if(!is\_array($existingopt)){ |
| [316](#L316) |  |
| [317](#L317) | update\_option('wp\_news\_letter\_settings', $wp\_news\_letter\_settings); |
| [318](#L318) |  |
| [319](#L319) | } |
| [320](#L320) | else{ |
| [321](#L321) |  |
| [322](#L322) | $flag=false; |
| [323](#L323) | if(!isset($existingopt['unsubscribe\_message'])){ |
| [324](#L324) |  |
| [325](#L325) | $flag=true; |
| [326](#L326) | $existingopt['unsubscribe\_message']='You have successfully unsubscribed from email newsletter.Thank you...'; |
| [327](#L327) |  |
| [328](#L328) | } |
| [329](#L329) | if(!isset($existingopt['show\_name\_field'])){ |
| [330](#L330) |  |
| [331](#L331) | $flag=true; |
| [332](#L332) | $existingopt['show\_name\_field']='1'; |
| [333](#L333) |  |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | if(!isset($existingopt['show\_agreement'])){ |
| [337](#L337) |  |
| [338](#L338) | $flag=true; |
| [339](#L339) | $existingopt['show\_agreement']='0'; |
| [340](#L340) |  |
| [341](#L341) | } |
| [342](#L342) |  |
| [343](#L343) | if(!isset($existingopt['agreement\_text'])){ |
| [344](#L344) |  |
| [345](#L345) | $flag=true; |
| [346](#L346) | $existingopt['agreement\_text']='I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>'; |
| [347](#L347) |  |
| [348](#L348) | } |
| [349](#L349) |  |
| [350](#L350) | if(!isset($existingopt['agreement\_error'])){ |
| [351](#L351) |  |
| [352](#L352) | $flag=true; |
| [353](#L353) | $existingopt['agreement\_error']='Please read and agree to our terms & conditions.'; |
| [354](#L354) |  |
| [355](#L355) | } |
| [356](#L356) |  |
| [357](#L357) | if(!isset($existingopt['additional\_css'])){ |
| [358](#L358) | $flag=true; |
| [359](#L359) | $existingopt['additional\_css']=''; |
| [360](#L360) |  |
| [361](#L361) | } |
| [362](#L362) |  |
| [363](#L363) | if($flag==true){ |
| [364](#L364) |  |
| [365](#L365) | update\_option('wp\_news\_letter\_settings', $existingopt); |
| [366](#L366) | } |
| [367](#L367) |  |
| [368](#L368) | } |
| [369](#L369) |  |
| [370](#L370) | es\_email\_subscribe\_add\_access\_capabilities(); |
| [371](#L371) |  |
| [372](#L372) | } |
| [373](#L373) |  |
| [374](#L374) | function email\_subscription\_popup\_admin\_menu(){ |
| [375](#L375) |  |
| [376](#L376) |  |
| [377](#L377) | $hook\_suffix=add\_menu\_page( \_\_( 'Email Subscription','email-subscribe'), \_\_( 'Email Subscription','email-subscribe'), 'es\_email\_subscribe\_settings', 'email\_subscription\_popup', 'email\_subscription\_popup\_admin\_options' ); |
| [378](#L378) | $hook\_suffix=add\_submenu\_page( 'email\_subscription\_popup', \_\_( 'Email Subscription Form Setting','email-subscribe'), \_\_( 'Email Subscription Form Setting','email-subscribe' ),'es\_email\_subscribe\_settings', 'email\_subscription\_popup', 'email\_subscription\_popup\_admin\_options' ); |
| [379](#L379) | $hook\_suffix\_subscriber=add\_submenu\_page( 'email\_subscription\_popup', \_\_( 'Manage Subscribers','email-subscribe'), \_\_( 'Manage Subscribers','email-subscribe'),'es\_email\_subscribe\_view\_subscribers', 'email\_subscription\_popup\_subscribers\_management', 'massEmailToEmail\_Subscriber\_Func' ); |
| [380](#L380) | $hook\_suffix\_unsubscriber=add\_submenu\_page( 'email\_subscription\_popup', \_\_( 'Unsubscribers List','email-subscribe'), \_\_( 'Unsubscribers List','email-subscribe'),'es\_email\_subscribe\_view\_unsubscribers', 'Newssletter-Email-Unsubscriber', 'email\_subscription\_unsubscribers\_func' ); |
| [381](#L381) |  |
| [382](#L382) | add\_action( 'load-' . $hook\_suffix , 'email\_subscription\_popup\_admin\_admin\_init' ); |
| [383](#L383) | add\_action( 'load-' . $hook\_suffix\_subscriber , 'email\_subscription\_popup\_admin\_admin\_init' ); |
| [384](#L384) | add\_action( 'load-' . $hook\_suffix\_unsubscriber , 'email\_subscription\_popup\_admin\_admin\_init' ); |
| [385](#L385) |  |
| [386](#L386) |  |
| [387](#L387) | } |
| [388](#L388) |  |
| [389](#L389) | function email\_subscription\_popup\_admin\_admin\_init(){ |
| [390](#L390) |  |
| [391](#L391) |  |
| [392](#L392) | wp\_enqueue\_style ( 'email-subscribe-admin-css', plugins\_url ( '/css/styles.css', \_\_FILE\_\_ ) ); |
| [393](#L393) | wp\_enqueue\_script('jquery'); |
| [394](#L394) | wp\_enqueue\_script ( 'email-subscribe-jquery.validate', plugins\_url ( '/js/jqueryValidate.js', \_\_FILE\_\_ ) ); |
| [395](#L395) |  |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | function unsubscribe\_user\_func(){ |
| [399](#L399) |  |
| [400](#L400) |  |
| [401](#L401) | if(isset($\_GET) and isset($\_GET['action']) and isset($\_GET['unsc'])){ |
| [402](#L402) |  |
| [403](#L403) | if(trim($\_GET['unsc'])!=''){ |
| [404](#L404) |  |
| [405](#L405) | $unsubscriberEmail=trim(urldecode($\_GET['unsc'])); |
| [406](#L406) | $wp\_news\_letter\_settings=get\_option('wp\_news\_letter\_settings'); |
| [407](#L407) | $wp\_news\_letter\_settings=stripslashes\_deep($wp\_news\_letter\_settings); |
| [408](#L408) | $unsubscriberEmail=sanitize\_text\_field($unsubscriberEmail); |
| [409](#L409) | $unsubscriberEmail=esc\_html($unsubscriberEmail); |
| [410](#L410) |  |
| [411](#L411) | global $wpdb; |
| [412](#L412) | $query = $wpdb->prepare('SELECT \* FROM '.$wpdb->prefix.'nl\_subscriptions where unsubs\_key = %s',array($unsubscriberEmail)); |
| [413](#L413) | $myrow  = $wpdb->get\_row($query); |
| [414](#L414) |  |
| [415](#L415) | if(is\_object($myrow)){ |
| [416](#L416) |  |
| [417](#L417) | $key = md5(uniqid(rand(), true)); |
| [418](#L418) |  |
| [419](#L419) | $wpdb->update( |
| [420](#L420) |  |
| [421](#L421) | $wpdb->prefix.'nl\_subscriptions', |
| [422](#L422) | array( |
| [423](#L423) | 'is\_subscribed' => 0,       // column & new value |
| [424](#L424) | 'unsubs\_key' => $key        // column & new value |
| [425](#L425) | ), |
| [426](#L426) | array( |
| [427](#L427) | 'unsubs\_key' => $unsubscriberEmail,          // where clause(s) |
| [428](#L428) |  |
| [429](#L429) | ), |
| [430](#L430) | array( |
| [431](#L431) | '%d', |
| [432](#L432) | '%s' |
| [433](#L433) | ), |
| [434](#L434) | array( |
| [435](#L435) | '%s' |
| [436](#L436) | ) |
| [437](#L437) | ); |
| [438](#L438) |  |
| [439](#L439) | echo "<script>alert('".$wp\_news\_letter\_settings['unsubscribe\_message']."')</script>"; |
| [440](#L440) | $url=get\_bloginfo( 'url' ); |
| [441](#L441) | echo "<script>window.location.href='".$url."';</script>"; |
| [442](#L442) | exit; |
| [443](#L443) |  |
| [444](#L444) | } |
| [445](#L445) |  |
| [446](#L446) |  |
| [447](#L447) | } |
| [448](#L448) | } |
| [449](#L449) | } |
| [450](#L450) |  |
| [451](#L451) | function email\_subscription\_unsubscribers\_func(){ |
| [452](#L452) |  |
| [453](#L453) |  |
| [454](#L454) | $selfpage=wp\_get\_referer() ; |
| [455](#L455) |  |
| [456](#L456) | $action=''; |
| [457](#L457) | if(isset($\_REQUEST['action'])){ |
| [458](#L458) | $action=$\_REQUEST['action']; |
| [459](#L459) | } |
| [460](#L460) | ?> |
| [461](#L461) |  |
| [462](#L462) | <?php |
| [463](#L463) | switch($action){ |
| [464](#L464) |  |
| [465](#L465) | default: |
| [466](#L466) |  |
| [467](#L467) | if(isset($\_POST['deleteEmails'])){ |
| [468](#L468) |  |
| [469](#L469) | if(!check\_admin\_referer('action\_resubscribe\_add\_edit','resubscribe\_and\_delete\_subsciber')){ |
| [470](#L470) |  |
| [471](#L471) | wp\_die('Security check fail'); |
| [472](#L472) | } |
| [473](#L473) |  |
| [474](#L474) | if ( ! current\_user\_can( 'es\_email\_subscribe\_delete\_unsubscribers' ) ) { |
| [475](#L475) |  |
| [476](#L476) | wp\_die( \_\_( "Access Denied", "video-grid" ) ); |
| [477](#L477) |  |
| [478](#L478) | } |
| [479](#L479) |  |
| [480](#L480) | global $wpdb; |
| [481](#L481) | $subscribersSelectedEmails=$\_POST['ckboxs']; |
| [482](#L482) | $mass\_email\_queue=get\_option('mass\_email\_queue\_news\_subscriber'); |
| [483](#L483) | foreach($subscribersSelectedEmails as $em){ |
| [484](#L484) |  |
| [485](#L485) | $em=htmlentities(strip\_tags(sanitize\_email($em)),ENT\_QUOTES); |
| [486](#L486) | if($em!=""){ |
| [487](#L487) |  |
| [488](#L488) | $query = "delete from  ".$wpdb->prefix."nl\_subscriptions where email='$em'"; |
| [489](#L489) | $wpdb->query($query); |
| [490](#L490) | if(is\_array($mass\_email\_queue)){ |
| [491](#L491) |  |
| [492](#L492) | $key=(int)array\_search($em,$mass\_email\_queue); |
| [493](#L493) | if(array\_search($em,$mass\_email\_queue)>=0){ |
| [494](#L494) |  |
| [495](#L495) | unset($mass\_email\_queue[$key]); |
| [496](#L496) | } |
| [497](#L497) | } |
| [498](#L498) | } |
| [499](#L499) |  |
| [500](#L500) | } |
| [501](#L501) |  |
| [502](#L502) | update\_option( 'mass\_email\_subscribers\_succ',\_\_( 'Selected subscribers deleted successfully.','email-subscribe') ); |
| [503](#L503) | update\_option('mass\_email\_queue\_news\_subscriber',$mass\_email\_queue); |
| [504](#L504) |  |
| [505](#L505) |  |
| [506](#L506) | }else if(isset($\_POST['resubscribe'])){ |
| [507](#L507) |  |
| [508](#L508) |  |
| [509](#L509) | if(!check\_admin\_referer('action\_resubscribe\_add\_edit','resubscribe\_and\_delete\_subsciber')){ |
| [510](#L510) |  |
| [511](#L511) | wp\_die('Security check fail'); |
| [512](#L512) | } |
| [513](#L513) |  |
| [514](#L514) | if ( ! current\_user\_can( 'es\_email\_subscribe\_re\_subscriber\_unsubscribers' ) ) { |
| [515](#L515) |  |
| [516](#L516) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [517](#L517) |  |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | global $wpdb; |
| [521](#L521) | $subscribersSelectedEmails=$\_POST['ckboxs']; |
| [522](#L522) | foreach($subscribersSelectedEmails as $em){ |
| [523](#L523) |  |
| [524](#L524) | $em=htmlentities(strip\_tags(sanitize\_email($em)),ENT\_QUOTES); |
| [525](#L525) | if($em!=""){ |
| [526](#L526) |  |
| [527](#L527) | $query = "update ".$wpdb->prefix."nl\_subscriptions set is\_subscribed=1  where email='$em'"; |
| [528](#L528) | $wpdb->query($query); |
| [529](#L529) | } |
| [530](#L530) | } |
| [531](#L531) |  |
| [532](#L532) | update\_option( 'mass\_email\_subscribers\_succ', \_\_('Selected subscribers successfully re-subscribed.','email-subscribe') ); |
| [533](#L533) |  |
| [534](#L534) |  |
| [535](#L535) | } |
| [536](#L536) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [537](#L537) | $url = str\_replace("\\","/",$url); |
| [538](#L538) |  |
| [539](#L539) | if ( ! current\_user\_can( 'es\_email\_subscribe\_view\_unsubscribers' ) ) { |
| [540](#L540) |  |
| [541](#L541) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [542](#L542) |  |
| [543](#L543) | } |
| [544](#L544) | ?> |
| [545](#L545) | <div style="width: 100%;"> |
| [546](#L546) | <div style="float:left;width:65%;" > |
| [547](#L547) |  |
| [548](#L548) | <?php |
| [549](#L549) |  |
| [550](#L550) | global $wpdb; |
| [551](#L551) |  |
| [552](#L552) | $query="SELECT \* from ".$wpdb->prefix."nl\_subscriptions where is\_subscribed=0 "; |
| [553](#L553) | $queryCount="SELECT count(\*) from ".$wpdb->prefix."nl\_subscriptions where is\_subscribed=0 "; |
| [554](#L554) |  |
| [555](#L555) | if(isset($\_GET['searchuser']) and $\_GET['searchuser']!=''){ |
| [556](#L556) |  |
| [557](#L557) | $term=sanitize\_text\_field(urldecode(esc\_sql($\_GET['searchuser']))); |
| [558](#L558) | $query.="  and ( name like '%$term%' or email like '%$term%'  )  " ; |
| [559](#L559) | $queryCount.="  and ( name like '%$term%' or email like '%$term%'  )  " ; |
| [560](#L560) | } |
| [561](#L561) |  |
| [562](#L562) |  |
| [563](#L563) |  |
| [564](#L564) | $totalRecordForQuery=$wpdb->get\_var($queryCount); |
| [565](#L565) | $selfPage=wp\_get\_referer().'?page=Newssletter-Email-Unsubscriber'; |
| [566](#L566) | global $wp\_rewrite; |
| [567](#L567) |  |
| [568](#L568) | $rows\_per\_page = 10; |
| [569](#L569) | if(isset($\_GET['setPerPage']) and $\_GET['setPerPage']!=""){ |
| [570](#L570) |  |
| [571](#L571) | $rows\_per\_page=intval($\_GET['setPerPage']); |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) |  |
| [575](#L575) | $current = (isset($\_GET['entrant'])) ? (intval($\_GET['entrant'])) : 1; |
| [576](#L576) | $pagination\_args = array( |
| [577](#L577) | 'base' => @add\_query\_arg('entrant','%#%'), |
| [578](#L578) | 'format' => '', |
| [579](#L579) | 'total' => ceil($totalRecordForQuery/$rows\_per\_page), |
| [580](#L580) | 'current' => $current, |
| [581](#L581) | 'show\_all' => false, |
| [582](#L582) | 'type' => 'plain', |
| [583](#L583) | ); |
| [584](#L584) |  |
| [585](#L585) |  |
| [586](#L586) |  |
| [587](#L587) |  |
| [588](#L588) | $selfpage=wp\_get\_referer() ; |
| [589](#L589) |  |
| [590](#L590) | if($totalRecordForQuery>0){ |
| [591](#L591) |  |
| [592](#L592) |  |
| [593](#L593) |  |
| [594](#L594) | ?> |
| [595](#L595) | <?php |
| [596](#L596) |  |
| [597](#L597) | $SuccMsg=get\_option('mass\_email\_subscribers\_succ'); |
| [598](#L598) | update\_option( 'mass\_email\_subscribers\_succ', '' ); |
| [599](#L599) |  |
| [600](#L600) | $errMsg=get\_option('mass\_email\_subscribers\_err'); |
| [601](#L601) | update\_option( 'mass\_email\_subscribers\_err', '' ); |
| [602](#L602) | ?> |
| [603](#L603) |  |
| [604](#L604) |  |
| [605](#L605) | <?php if($SuccMsg!=""){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $SuccMsg; echo "</p></div>";$SuccMsg="";}?> |
| [606](#L606) | <?php if($errMsg!=""){ echo "<div class='notice notice-error is-dismissible' ><p>"; \_e($errMsg); echo "</p></div>";$errMsg="";}?> |
| [607](#L607) |  |
| [608](#L608) | <h3><?php echo \_\_( 'Unsubscribers','email-subscribe');?> </h3> |
| [609](#L609) | <?php |
| [610](#L610) |  |
| [611](#L611) | $order\_by='name'; |
| [612](#L612) | $order\_pos="asc"; |
| [613](#L613) | $setacrionpage='admin.php?page=Newssletter-Email-Unsubscriber'; |
| [614](#L614) |  |
| [615](#L615) | if(isset($\_GET['entrant']) and $\_GET['entrant']!=""){ |
| [616](#L616) | $setacrionpage.='&entrant='.intval($\_GET['entrant']); |
| [617](#L617) | } |
| [618](#L618) |  |
| [619](#L619) | if(isset($\_GET['setPerPage']) and $\_GET['setPerPage']!=""){ |
| [620](#L620) | $setacrionpage.='&setPerPage='.intval($\_GET['setPerPage']); |
| [621](#L621) | } |
| [622](#L622) |  |
| [623](#L623) | $seval=""; |
| [624](#L624) | if(isset($\_GET['searchuser']) and $\_GET['searchuser']!=""){ |
| [625](#L625) | $seval=esc\_html($\_GET['searchuser']); |
| [626](#L626) | } |
| [627](#L627) |  |
| [628](#L628) | $search\_term\_=''; |
| [629](#L629) | if(isset($\_GET['searchuser'])){ |
| [630](#L630) |  |
| [631](#L631) | $search\_term\_='&searchuser='.urlencode(sanitize\_text\_field($\_GET['searchuser'])); |
| [632](#L632) | } |
| [633](#L633) |  |
| [634](#L634) | if(isset($\_GET['order\_by'])){ |
| [635](#L635) |  |
| [636](#L636) | $order\_by=trim($\_GET['order\_by']); |
| [637](#L637) | } |
| [638](#L638) |  |
| [639](#L639) | if(isset($\_GET['order\_pos'])){ |
| [640](#L640) |  |
| [641](#L641) | $order\_pos=trim($\_GET['order\_pos']); |
| [642](#L642) | } |
| [643](#L643) |  |
| [644](#L644) | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [645](#L645) | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [646](#L646) | $setacrionpage=esc\_html($setacrionpage); |
| [647](#L647) |  |
| [648](#L648) | ?> |
| [649](#L649) | <div style="padding-top:5px;padding-bottom:5px"><b><?php echo \_\_( 'Search User','email-subscribe');?>: </b><input type="text" value="<?php echo $seval;?>" id="searchuser" name="searchuser">&nbsp;<input type='submit'  value='Search Unsubscribers' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp;<input type='submit'  value='Reset Search' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" ></div> |
| [650](#L650) | <script type="text/javascript" > |
| [651](#L651) | function SearchredirectTO(){ |
| [652](#L652) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [653](#L653) | var searchval=jQuery('#searchuser').val(); |
| [654](#L654) | redirectto=redirectto+'&searchuser='+jQuery.trim(encodeURIComponent(searchval))+'&entrant=1'; |
| [655](#L655) | window.location.href=redirectto; |
| [656](#L656) | } |
| [657](#L657) | function ResetSearch(){ |
| [658](#L658) |  |
| [659](#L659) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [660](#L660) | window.location.href=redirectto; |
| [661](#L661) | } |
| [662](#L662) | </script> |
| [663](#L663) | <form method="post" action="" id="sendemail" name="sendemail"> |
| [664](#L664) | <input type="hidden" value="sendEmailForm" name="action" id="action"> |
| [665](#L665) |  |
| [666](#L666) | <table class="widefat fixed" cellspacing="0" style="width:97% !important" > |
| [667](#L667) | <thead> |
| [668](#L668) | <tr> |
| [669](#L669) | <?php if($order\_by=="email" and $order\_pos=="asc"):?> |
| [670](#L670) |  |
| [671](#L671) | <th> |
| [672](#L672) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [673](#L673) | <a href="<?php echo $setacrionpage;?>&order\_by=email&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Email','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a> |
| [674](#L674) | </th> |
| [675](#L675) | <?php else:?> |
| [676](#L676) | <?php if($order\_by=="email"):?> |
| [677](#L677) | <th> |
| [678](#L678) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [679](#L679) | <a href="<?php echo $setacrionpage;?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Email','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a> |
| [680](#L680) | </th> |
| [681](#L681) | <?php else:?> |
| [682](#L682) | <th> |
| [683](#L683) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [684](#L684) | <a href="<?php echo $setacrionpage;?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Email','email-subscribe');?></a> |
| [685](#L685) | </th> |
| [686](#L686) | <?php endif;?> |
| [687](#L687) | <?php endif;?> |
| [688](#L688) |  |
| [689](#L689) | <?php if($order\_by=="name" and $order\_pos=="asc"):?> |
| [690](#L690) | <th><a href="<?php echo $setacrionpage;?>&order\_by=name&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Name','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [691](#L691) | <?php else:?> |
| [692](#L692) | <?php if($order\_by=="name"):?> |
| [693](#L693) | <th><a href="<?php echo $setacrionpage;?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Name','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [694](#L694) | <?php else:?> |
| [695](#L695) | <th><a href="<?php echo $setacrionpage;?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Name','email-subscribe');?></a></th> |
| [696](#L696) | <?php endif;?> |
| [697](#L697) | <?php endif;?> |
| [698](#L698) |  |
| [699](#L699) |  |
| [700](#L700) | </tr> |
| [701](#L701) | </thead> |
| [702](#L702) |  |
| [703](#L703) | <tfoot> |
| [704](#L704) | <tr> |
| [705](#L705) | <th scope="col" id="name" class="manage-column column-name" style=""><input onclick="chkAll(this)" type="checkbox" name="chkallfooter" id='chkallfooter'>&nbsp;<?php echo \_\_( 'Select All Emails','email-subscribe');?></th> |
| [706](#L706) | <th scope="col" id="name" class="manage-column column-name" style=""><?php echo \_\_( 'Name','email-subscribe');?></th> |
| [707](#L707) |  |
| [708](#L708) |  |
| [709](#L709) | </tr> |
| [710](#L710) | </tfoot> |
| [711](#L711) |  |
| [712](#L712) | <tbody id="the-list" class="list:cat"> |
| [713](#L713) | <?php |
| [714](#L714) |  |
| [715](#L715) | $offset = ($current - 1) \* $rows\_per\_page; |
| [716](#L716) | $query.=" order by $order\_by $order\_pos"; |
| [717](#L717) | $query.=" limit $offset, $rows\_per\_page"; |
| [718](#L718) | $emails=$wpdb->get\_results($query,ARRAY\_A); |
| [719](#L719) |  |
| [720](#L720) | foreach ( $emails as $vemail) |
| [721](#L721) | { |
| [722](#L722) |  |
| [723](#L723) | if($vemail!=null){ |
| [724](#L724) |  |
| [725](#L725) | $userId=$vemail['id']; |
| [726](#L726) | $name= sanitize\_text\_field($vemail['name']); |
| [727](#L727) | $email=sanitize\_email($vemail['email']); |
| [728](#L728) |  |
| [729](#L729) |  |
| [730](#L730) | $checked=""; |
| [731](#L731) |  |
| [732](#L732) |  |
| [733](#L733) | echo"<tr class='iedit alternate'> |
| [734](#L734) | <td  class='name column-name' style='border:1px solid #DBDBDB;padding-left:13px;'><input type='checkBox' name='ckboxs[]' $checked  value='".$email."'>&nbsp;".$email."</td>"; |
| [735](#L735) | echo "<td  class='name column-name' style='border:1px solid #DBDBDB;'> ".stripslashes($name)."</td>"; |
| [736](#L736) | echo "</tr>"; |
| [737](#L737) | } |
| [738](#L738) |  |
| [739](#L739) | } |
| [740](#L740) |  |
| [741](#L741) |  |
| [742](#L742) |  |
| [743](#L743) | ?> |
| [744](#L744) | </tbody> |
| [745](#L745) | </table> |
| [746](#L746) | <table> |
| [747](#L747) | <tr> |
| [748](#L748) | <td> |
| [749](#L749) | <?php |
| [750](#L750) | if($totalRecordForQuery>0){ |
| [751](#L751) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [752](#L752) | echo paginate\_links($pagination\_args); |
| [753](#L753) | echo "</div>"; |
| [754](#L754) | } |
| [755](#L755) |  |
| [756](#L756) | ?> |
| [757](#L757) |  |
| [758](#L758) | </td> |
| [759](#L759) | <td> |
| [760](#L760) | <b>&nbsp;&nbsp;<?php echo \_\_( 'Per Page','email-subscribe');?> : </b> |
| [761](#L761) | <?php |
| [762](#L762) | $setPerPageadmin='admin.php?page=Newssletter-Email-Unsubscriber'; |
| [763](#L763) | $setPerPageadmin.='&setPerPage='; |
| [764](#L764) | ?> |
| [765](#L765) | <select name="setPerPage" onchange="document.location.href='<?php echo $setPerPageadmin;?>' + this.options[this.selectedIndex].value + ''"> |
| [766](#L766) | <option <?php if($rows\_per\_page=="10"): ?>selected="selected"<?php endif;?>  value="10">10</option> |
| [767](#L767) | <option <?php if($rows\_per\_page=="20"): ?>selected="selected"<?php endif;?> value="20">20</option> |
| [768](#L768) | <option <?php if($rows\_per\_page=="30"): ?>selected="selected"<?php endif;?>value="30">30</option> |
| [769](#L769) | <option <?php if($rows\_per\_page=="40"): ?>selected="selected"<?php endif;?> value="40">40</option> |
| [770](#L770) | <option <?php if($rows\_per\_page=="50"): ?>selected="selected"<?php endif;?> value="50">50</option> |
| [771](#L771) | <option <?php if($rows\_per\_page=="60"): ?>selected="selected"<?php endif;?> value="60">60</option> |
| [772](#L772) | <option <?php if($rows\_per\_page=="70"): ?>selected="selected"<?php endif;?> value="70">70</option> |
| [773](#L773) | <option <?php if($rows\_per\_page=="80"): ?>selected="selected"<?php endif;?> value="80">80</option> |
| [774](#L774) | <option <?php if($rows\_per\_page=="90"): ?>selected="selected"<?php endif;?> value="90">90</option> |
| [775](#L775) | <option <?php if($rows\_per\_page=="100"): ?>selected="selected"<?php endif;?> value="100">100</option> |
| [776](#L776) | <option <?php if($rows\_per\_page=="500"): ?>selected="selected"<?php endif;?> value="500">500</option> |
| [777](#L777) | <option <?php if($rows\_per\_page=="1000"): ?>selected="selected"<?php endif;?> value="1000">1000</option> |
| [778](#L778) | <option <?php if($rows\_per\_page=="2000"): ?>selected="selected"<?php endif;?> value="2000">2000</option> |
| [779](#L779) | <option <?php if($rows\_per\_page=="3000"): ?>selected="selected"<?php endif;?> value="3000">3000</option> |
| [780](#L780) | <option <?php if($rows\_per\_page=="4000"): ?>selected="selected"<?php endif;?> value="4000">4000</option> |
| [781](#L781) | <option <?php if($rows\_per\_page=="5000"): ?>selected="selected"<?php endif;?> value="5000">5000</option> |
| [782](#L782) | </select> |
| [783](#L783) | </td> |
| [784](#L784) | </tr> |
| [785](#L785) | </table> |
| [786](#L786) | <table> |
| [787](#L787) | <tr> |
| [788](#L788) | <td class='name column-name' style='padding-top:15px;padding-left:10px;'> |
| [789](#L789) |  |
| [790](#L790) | <script type="text/javascript"> |
| [791](#L791) | function sendEmailToAll(obj){ |
| [792](#L792) |  |
| [793](#L793) | var txt; |
| [794](#L794) | var r = confirm("<?php echo \_\_( 'It is not recommaded to send email to all at once as there is always hosting server limit for send emails hourly basis. Most of hosting providers allow 250 emails per hour. Please upgrade to pro version and use cron job newsletter to send email automatically. Do you still want to continue ?','email-subscribe');?>"); |
| [795](#L795) | if (r == true) { |
| [796](#L796) | return true; |
| [797](#L797) | } else { |
| [798](#L798) | return false; |
| [799](#L799) | } |
| [800](#L800) |  |
| [801](#L801) |  |
| [802](#L802) | } |
| [803](#L803) | </script> |
| [804](#L804) | <?php wp\_nonce\_field('action\_resubscribe\_add\_edit','resubscribe\_and\_delete\_subsciber'); ?> |
| [805](#L805) | <input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_( 'Re-subscribe selected subscribers','email-subscribe');?>' name='resubscribe' class='button-primary' id='resubscribe' >&nbsp;&nbsp;<input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_( 'Delete Selected Subscribers','email-subscribe');?>' name='deleteEmails' class='button-primary' id='deleteEmails' ></td> |
| [806](#L806) | </tr> |
| [807](#L807) |  |
| [808](#L808) | </table> |
| [809](#L809) | </form> |
| [810](#L810) |  |
| [811](#L811) |  |
| [812](#L812) | <?php |
| [813](#L813) |  |
| [814](#L814) | } |
| [815](#L815) | else |
| [816](#L816) | { |
| [817](#L817) | echo '<center><div style="padding-bottom:50pxpadding-top:50px;"><h3>'.\_\_( 'No Email Unsubscribers Found','email-subscribe').'</h3></div></center>'; |
| [818](#L818) |  |
| [819](#L819) |  |
| [820](#L820) | } |
| [821](#L821) | ?> |
| [822](#L822) | </div> |
| [823](#L823) | <div id="postbox-container-1" class="postbox-container" style="float:right;width:35%;margin-top: 50px" > |
| [824](#L824) |  |
| [825](#L825) | <div class="postbox"> |
| [826](#L826) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'New AI based DIVI Theme','email-subscribe');?></h3> </center> |
| [827](#L827) | <div class="inside"> |
| [828](#L828) | <center><a href="https://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715&url=80806" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/divi\_300x250.jpg', \_\_FILE\_\_ ) ;?>" width="250" height="250"></a></center> |
| [829](#L829) |  |
| [830](#L830) | <div style="margin:10px 5px"> |
| [831](#L831) |  |
| [832](#L832) | </div> |
| [833](#L833) | </div></div> |
| [834](#L834) | <div class="postbox"> |
| [835](#L835) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','email-subscribe');?></h3> </center> |
| [836](#L836) | <div class="inside"> |
| [837](#L837) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px" src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ ) ;?>" width="" height="250" border="0"></a></center> |
| [838](#L838) | <div style="margin:10px 5px"> |
| [839](#L839) | </div> |
| [840](#L840) | </div></div> |
| [841](#L841) |  |
| [842](#L842) | </div> |
| [843](#L843) | <div class="clear"></div> |
| [844](#L844) |  |
| [845](#L845) | <?php |
| [846](#L846) | break; |
| [847](#L847) |  |
| [848](#L848) | } |
| [849](#L849) |  |
| [850](#L850) | ?> |
| [851](#L851) | <script type="text/javascript" > |
| [852](#L852) |  |
| [853](#L853) | jQuery("input[name='ckboxs[]']").click(function() { |
| [854](#L854) | uncheckedmanagement(this); |
| [855](#L855) |  |
| [856](#L856) | }); |
| [857](#L857) |  |
| [858](#L858) | function uncheckedmanagement(elementset){ |
| [859](#L859) |  |
| [860](#L860) | //alert(jQuery(this).is(':checked')); |
| [861](#L861) |  |
| [862](#L862) | if(jQuery("#uncheckedemails").length>0){ |
| [863](#L863) |  |
| [864](#L864) | var hiddenvals=jQuery("#uncheckedemails").val(); |
| [865](#L865) |  |
| [866](#L866) | } |
| [867](#L867) | else |
| [868](#L868) | hiddenvals="|||"; |
| [869](#L869) |  |
| [870](#L870) | var emailval=jQuery(elementset).val(); |
| [871](#L871) | var emailsUn= hiddenvals.split('|||'); |
| [872](#L872) |  |
| [873](#L873) | if(jQuery(elementset).is(':checked')){ |
| [874](#L874) |  |
| [875](#L875) | if(jQuery.isArray(emailsUn)==true){ |
| [876](#L876) |  |
| [877](#L877) | emailsUn.splice(jQuery.inArray(emailval, emailsUn),1); |
| [878](#L878) | var strconvert=emailsUn.join('|||'); |
| [879](#L879) | jQuery("#uncheckedemails").val(strconvert); |
| [880](#L880) |  |
| [881](#L881) | } |
| [882](#L882) | else{ |
| [883](#L883) |  |
| [884](#L884) | var addtohidden=emailval.toString()+'|||'; |
| [885](#L885) | jQuery("#uncheckedemails").val(addtohidden); |
| [886](#L886) | } |
| [887](#L887) |  |
| [888](#L888) | } |
| [889](#L889) | else{ |
| [890](#L890) |  |
| [891](#L891) | if(jQuery.isArray(emailsUn)==true){ |
| [892](#L892) |  |
| [893](#L893) | if(jQuery.inArray(emailval, emailsUn)<=0){ |
| [894](#L894) | emailsUn.push(emailval); |
| [895](#L895) | var strconvert=emailsUn.join('|||'); |
| [896](#L896) | jQuery("#uncheckedemails").val(strconvert); |
| [897](#L897) | } |
| [898](#L898) |  |
| [899](#L899) | } |
| [900](#L900) | else{ |
| [901](#L901) | var addtohidden=emailval.toString()+'|||'; |
| [902](#L902) | jQuery("#uncheckedemails").val(addtohidden); |
| [903](#L903) |  |
| [904](#L904) | } |
| [905](#L905) | } |
| [906](#L906) |  |
| [907](#L907) |  |
| [908](#L908) | } |
| [909](#L909) |  |
| [910](#L910) | function chkAll(id){ |
| [911](#L911) |  |
| [912](#L912) | if(id.name=='chkallfooter'){ |
| [913](#L913) |  |
| [914](#L914) | var chlOrnot=id.checked; |
| [915](#L915) | document.getElementById('chkallHeader').checked= chlOrnot; |
| [916](#L916) |  |
| [917](#L917) | } |
| [918](#L918) | else if(id.name=='chkallHeader'){ |
| [919](#L919) |  |
| [920](#L920) | var chlOrnot=id.checked; |
| [921](#L921) | document.getElementById('chkallfooter').checked= chlOrnot; |
| [922](#L922) |  |
| [923](#L923) | } |
| [924](#L924) |  |
| [925](#L925) | if(id.checked){ |
| [926](#L926) |  |
| [927](#L927) | var objs=document.getElementsByName("ckboxs[]"); |
| [928](#L928) |  |
| [929](#L929) | for(var i=0; i < objs.length; i++) |
| [930](#L930) | { |
| [931](#L931) | objs[i].checked=true; |
| [932](#L932) | uncheckedmanagement(objs[i]); |
| [933](#L933) | } |
| [934](#L934) |  |
| [935](#L935) |  |
| [936](#L936) | } |
| [937](#L937) | else { |
| [938](#L938) |  |
| [939](#L939) | var objs=document.getElementsByName("ckboxs[]"); |
| [940](#L940) |  |
| [941](#L941) | for(var i=0; i < objs.length; i++) |
| [942](#L942) | { |
| [943](#L943) | objs[i].checked=false; |
| [944](#L944) | uncheckedmanagement(objs[i]); |
| [945](#L945) | } |
| [946](#L946) | } |
| [947](#L947) | } |
| [948](#L948) |  |
| [949](#L949) | function validateSendEmailAndDeleteEmail(idobj){ |
| [950](#L950) |  |
| [951](#L951) | var objs=document.getElementsByName("ckboxs[]"); |
| [952](#L952) | var ischkBoxChecked=false; |
| [953](#L953) | for(var i=0; i < objs.length; i++){ |
| [954](#L954) | if(objs[i].checked==true){ |
| [955](#L955) |  |
| [956](#L956) | ischkBoxChecked=true; |
| [957](#L957) | break; |
| [958](#L958) | } |
| [959](#L959) |  |
| [960](#L960) | } |
| [961](#L961) |  |
| [962](#L962) | if(ischkBoxChecked==false) |
| [963](#L963) | { |
| [964](#L964) | if(idobj.name=='resubscribe'){ |
| [965](#L965) |  |
| [966](#L966) | alert('<?php echo \_\_('Please select atleast one email.', 'email-subscribe'); ?>')  ; |
| [967](#L967) | return false; |
| [968](#L968) |  |
| [969](#L969) | } |
| [970](#L970) | else if(idobj.name=='deleteEmails') |
| [971](#L971) | { |
| [972](#L972) | alert('<?php echo \_\_('Please select atleast one email to delete.', 'email-subscribe'); ?>') |
| [973](#L973) | return false; |
| [974](#L974) | } |
| [975](#L975) | } |
| [976](#L976) | else{ |
| [977](#L977) |  |
| [978](#L978) | if(idobj.name=='deleteEmails') { |
| [979](#L979) |  |
| [980](#L980) |  |
| [981](#L981) | var r = confirm("<?php echo \_\_('Are you sure to delete selected subscribers ?', 'email-subscribe'); ?>"); |
| [982](#L982) | if (r == true) { |
| [983](#L983) | return true; |
| [984](#L984) | }else{ |
| [985](#L985) |  |
| [986](#L986) | return false; |
| [987](#L987) | } |
| [988](#L988) |  |
| [989](#L989) | } |
| [990](#L990) |  |
| [991](#L991) |  |
| [992](#L992) | } |
| [993](#L993) |  |
| [994](#L994) | } |
| [995](#L995) |  |
| [996](#L996) | </script> |
| [997](#L997) |  |
| [998](#L998) | <?php |
| [999](#L999) |  |
| [1000](#L1000) | } |
| [1001](#L1001) |  |
| [1002](#L1002) | function email\_subscription\_popup\_load\_styles\_and\_js(){ |
| [1003](#L1003) |  |
| [1004](#L1004) | wp\_register\_style( 'wp-email-subscription-popup', plugins\_url('/css/wp-email-subscription-popup.css', \_\_FILE\_\_),array(),'1.2.11' ); |
| [1005](#L1005) | wp\_register\_script('wp-email-subscription-popup-js',plugins\_url('/js/wp-email-subscription-popup-js.js', \_\_FILE\_\_),array('jquery'),'1.2.11'); |
| [1006](#L1006) | wp\_register\_script('subscribe-popup',plugins\_url('/js/subscribe-popup.js', \_\_FILE\_\_),array('jquery'),'1.2.15'); |
| [1007](#L1007) | wp\_register\_style('subscribe-popup',plugins\_url('/css/subscribe-popup.css', \_\_FILE\_\_),array(),'1.2.11'); |
| [1008](#L1008) |  |
| [1009](#L1009) |  |
| [1010](#L1010) | } |
| [1011](#L1011) |  |
| [1012](#L1012) | function addModalPopupHtmlToWpFooter(){ |
| [1013](#L1013) |  |
| [1014](#L1014) |  |
| [1015](#L1015) | $imgUrl=plugin\_dir\_url(\_\_FILE\_\_)."images/"; |
| [1016](#L1016) |  |
| [1017](#L1017) | $loader=$imgUrl.'AjaxLoader.gif'; |
| [1018](#L1018) | $wp\_news\_letter\_settings=get\_option('wp\_news\_letter\_settings'); |
| [1019](#L1019) | $wp\_news\_letter\_settings=stripslashes\_deep($wp\_news\_letter\_settings); |
| [1020](#L1020) |  |
| [1021](#L1021) | wp\_enqueue\_script('jquery'); |
| [1022](#L1022) | wp\_enqueue\_style( 'wp-email-subscription-popup'); |
| [1023](#L1023) | wp\_enqueue\_script('wp-email-subscription-popup-js'); |
| [1024](#L1024) | wp\_enqueue\_script('subscribe-popup'); |
| [1025](#L1025) | wp\_enqueue\_style('subscribe-popup'); |
| [1026](#L1026) |  |
| [1027](#L1027) |  |
| [1028](#L1028) | ob\_start(); |
| [1029](#L1029) | ?> |
| [1030](#L1030) | <div class="overlay\_i13" id="mainoverlayDiv" ></div> |
| [1031](#L1031) |  |
| [1032](#L1032) | <div class="mydiv" id='formFormEmail' style="display:none" > |
| [1033](#L1033) | <div class="container\_n"> |
| [1034](#L1034) |  |
| [1035](#L1035) | <form id="newsletter\_signup" name="newsletter\_signup"> |
| [1036](#L1036) |  |
| [1037](#L1037) |  |
| [1038](#L1038) | <div class="header"> |
| [1039](#L1039) | <div class="AjaxLoader"><img src="<?php echo $loader;?>"/><?php echo $wp\_news\_letter\_settings['wait'];?></div> |
| [1040](#L1040) | <div id="myerror\_msg" class="myerror\_msg"></div> |
| [1041](#L1041) | <div id="mysuccess\_msg" class="mysuccess\_msg"></div> |
| [1042](#L1042) |  |
| [1043](#L1043) | <h3><?php echo $wp\_news\_letter\_settings['heading'];?></h3> |
| [1044](#L1044) |  |
| [1045](#L1045) | <div class="subheading"><?php echo $wp\_news\_letter\_settings['subheading'];?></div> |
| [1046](#L1046) |  |
| [1047](#L1047) | </div> |
| [1048](#L1048) |  |
| [1049](#L1049) | <div class="sep"></div> |
| [1050](#L1050) |  |
| [1051](#L1051) | <div class="inputs"> |
| [1052](#L1052) |  |
| [1053](#L1053) | <input type="email" class="textfield"  onblur="restoreInput(this,'<?php echo $wp\_news\_letter\_settings['email'];?>')" onfocus="return clearInput(this,'<?php echo $wp\_news\_letter\_settings['email'];?>');"  value="<?php echo $wp\_news\_letter\_settings['email'];?>" name="youremail" id="youremail"  /> |
| [1054](#L1054) | <div style="clear:both"></div> |
| [1055](#L1055) | <div class="errorinput"></div> |
| [1056](#L1056) | <?php if($wp\_news\_letter\_settings['show\_name\_field']):?> |
| [1057](#L1057) | <input type="text" class="textfield" id="yourname" onblur="restoreInput(this,'<?php echo $wp\_news\_letter\_settings['name'];?>')" onfocus="return clearInput(this,'<?php echo $wp\_news\_letter\_settings['name'];?>');"  value="<?php echo $wp\_news\_letter\_settings['name'];?>" name="yourname" /> |
| [1058](#L1058) | <div style="clear:both"></div> |
| [1059](#L1059) | <div class="errorinput"></div> |
| [1060](#L1060) | <?php endif;?> |
| [1061](#L1061) | <?php if($wp\_news\_letter\_settings['show\_agreement']):?> |
| [1062](#L1062) | <input type="checkbox"  id="chkagreeornot" value="1" name="chkagreeornot" style="display:inline" /><span class="agree\_term"> <?php echo html\_entity\_decode ($wp\_news\_letter\_settings['agreement\_text']);?></span> |
| [1063](#L1063) | <div style="clear:both"></div> |
| [1064](#L1064) | <div class="errorinput"></div> |
| [1065](#L1065) | <?php endif;?> |
| [1066](#L1066) | <a id="submit\_newsletter"  onclick="submit\_newsletter();" name="submit\_newsletter"><?php echo $wp\_news\_letter\_settings['submitbtn'];?></a> |
| [1067](#L1067) |  |
| [1068](#L1068) | </div> |
| [1069](#L1069) |  |
| [1070](#L1070) | </form> |
| [1071](#L1071) |  |
| [1072](#L1072) | </div> |
| [1073](#L1073) | </div> |
| [1074](#L1074) | <script type='text/javascript'> |
| [1075](#L1075) |  |
| [1076](#L1076) | var htmlpopup=''; |
| [1077](#L1077) |  |
| [1078](#L1078) | function clearInput(source, initialValue) { |
| [1079](#L1079) |  |
| [1080](#L1080) | if (source.value.toUpperCase() == initialValue.toUpperCase()) |
| [1081](#L1081) | source.value = ''; |
| [1082](#L1082) |  |
| [1083](#L1083) | return false; |
| [1084](#L1084) | } |
| [1085](#L1085) |  |
| [1086](#L1086) | function restoreInput(source, initialValue) { |
| [1087](#L1087) | if (source.value == '') |
| [1088](#L1088) | source.value = initialValue; |
| [1089](#L1089) |  |
| [1090](#L1090) | return false; |
| [1091](#L1091) | } |
| [1092](#L1092) |  |
| [1093](#L1093) |  |
| [1094](#L1094) |  |
| [1095](#L1095) |  |
| [1096](#L1096) | function submit\_newsletter() { |
| [1097](#L1097) |  |
| [1098](#L1098) | var emailAdd = jQuery.trim(jQuery("#youremail").val()); |
| [1099](#L1099) | var yourname = jQuery.trim(jQuery("#yourname").val()); |
| [1100](#L1100) |  |
| [1101](#L1101) | var returnval = false; |
| [1102](#L1102) | var isvalidName = false; |
| [1103](#L1103) | var isvalidEmail = false; |
| [1104](#L1104) | var is\_agreed = false; |
| [1105](#L1105) | if (jQuery('#yourname').length > 0) { |
| [1106](#L1106) |  |
| [1107](#L1107) | var yourname = jQuery.trim(jQuery("#yourname").val()); |
| [1108](#L1108) | if (yourname != "" && yourname != null && yourname.toLowerCase() != '<?php echo $wp\_news\_letter\_settings['name'];?>'.toLowerCase()) { |
| [1109](#L1109) |  |
| [1110](#L1110) | var element = jQuery("#yourname").next().next(); |
| [1111](#L1111) | isvalidName = true; |
| [1112](#L1112) | jQuery(element).html(''); |
| [1113](#L1113) | } else { |
| [1114](#L1114) | var element = jQuery("#yourname").next().next(); |
| [1115](#L1115) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['requiredfield'];?></div>'); |
| [1116](#L1116) | // emailAdd=false; |
| [1117](#L1117) |  |
| [1118](#L1118) | } |
| [1119](#L1119) |  |
| [1120](#L1120) | } else { |
| [1121](#L1121) |  |
| [1122](#L1122) | isvalidName = true; |
| [1123](#L1123) |  |
| [1124](#L1124) | } |
| [1125](#L1125) |  |
| [1126](#L1126) | if (emailAdd != "") { |
| [1127](#L1127) |  |
| [1128](#L1128) |  |
| [1129](#L1129) | var element = jQuery("#youremail").next().next(); |
| [1130](#L1130) | if (emailAdd.toLowerCase() == '<?php echo $wp\_news\_letter\_settings['email'];?>'.toLowerCase()) { |
| [1131](#L1131) |  |
| [1132](#L1132) | jQuery(element).html('<div  class="image\_error"><?php echo $wp\_news\_letter\_settings['requiredfield'];?></div>'); |
| [1133](#L1133) | isvalidEmail = false; |
| [1134](#L1134) | } else { |
| [1135](#L1135) |  |
| [1136](#L1136) | var JsRegExPatern = /^\w+([-+.']\w+)\*@\w+([-.]\w+)\*\.\w+([-.]\w+)\*$/ |
| [1137](#L1137) |  |
| [1138](#L1138) | if (JsRegExPatern.test(emailAdd)) { |
| [1139](#L1139) |  |
| [1140](#L1140) | isvalidEmail = true; |
| [1141](#L1141) | jQuery(element).html(''); |
| [1142](#L1142) |  |
| [1143](#L1143) | } else { |
| [1144](#L1144) |  |
| [1145](#L1145) | var element = jQuery("#youremail").next().next(); |
| [1146](#L1146) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['iinvalidemail'];?></div>'); |
| [1147](#L1147) | isvalidEmail = false; |
| [1148](#L1148) |  |
| [1149](#L1149) | } |
| [1150](#L1150) |  |
| [1151](#L1151) | } |
| [1152](#L1152) |  |
| [1153](#L1153) | } else { |
| [1154](#L1154) |  |
| [1155](#L1155) | var element = jQuery("#yourname").next().next(); |
| [1156](#L1156) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['requiredfield'];?></div>'); |
| [1157](#L1157) | isvalidEmail = false; |
| [1158](#L1158) |  |
| [1159](#L1159) | } |
| [1160](#L1160) |  |
| [1161](#L1161) | if (jQuery('#chkagreeornot').length > 0) { |
| [1162](#L1162) |  |
| [1163](#L1163) | if (jQuery("#chkagreeornot").is(':checked')) { |
| [1164](#L1164) |  |
| [1165](#L1165) | var element = jQuery("#chkagreeornot").next().next(); |
| [1166](#L1166) | jQuery(element).html(''); |
| [1167](#L1167) | is\_agreed = true; |
| [1168](#L1168) | } else { |
| [1169](#L1169) |  |
| [1170](#L1170) |  |
| [1171](#L1171) | var element = jQuery("#chkagreeornot").next().next(); |
| [1172](#L1172) | jQuery(element).html('<div class="image\_error"><?php echo $wp\_news\_letter\_settings['agreement\_error'];?></div>'); |
| [1173](#L1173) | is\_agreed = false; |
| [1174](#L1174) |  |
| [1175](#L1175) | } |
| [1176](#L1176) | } else { |
| [1177](#L1177) |  |
| [1178](#L1178) | is\_agreed = true; |
| [1179](#L1179) | } |
| [1180](#L1180) |  |
| [1181](#L1181) |  |
| [1182](#L1182) | if (isvalidName == true && isvalidEmail == true && is\_agreed == true) { |
| [1183](#L1183) |  |
| [1184](#L1184) | jQuery(".AjaxLoader").show(); |
| [1185](#L1185) | jQuery('#mysuccess\_msg').html(''); |
| [1186](#L1186) | jQuery('#mysuccess\_msg').hide(); |
| [1187](#L1187) | jQuery('#myerror\_msg').html(''); |
| [1188](#L1188) | jQuery('#myerror\_msg').hide(); |
| [1189](#L1189) |  |
| [1190](#L1190) | var name = ""; |
| [1191](#L1191) | if (jQuery('#yourname').length > 0) { |
| [1192](#L1192) |  |
| [1193](#L1193) | name = jQuery("#yourname").val(); |
| [1194](#L1194) | } |
| [1195](#L1195) | var nonce = '<?php echo wp\_create\_nonce('newsletter-nonce'); ?>'; |
| [1196](#L1196) | var url = '<?php echo plugin\_dir\_url(\_\_FILE\_\_);?>'; |
| [1197](#L1197) | var email = jQuery("#youremail").val(); |
| [1198](#L1198) | var str = "action=store\_email&email=" + email + '&name=' + name + '&is\_agreed=' + is\_agreed + '&sec\_string=' + nonce; |
| [1199](#L1199) | jQuery.ajax({ |
| [1200](#L1200) | type: "POST", |
| [1201](#L1201) | url: '<?php echo admin\_url('admin-ajax.php'); ?>', |
| [1202](#L1202) | data: str, |
| [1203](#L1203) | async: true, |
| [1204](#L1204) | success: function (msg) { |
| [1205](#L1205) | if (msg != '') { |
| [1206](#L1206) |  |
| [1207](#L1207) | var result = msg.split("|"); |
| [1208](#L1208) | if (result[0] == 'success') { |
| [1209](#L1209) |  |
| [1210](#L1210) | jQuery(".AjaxLoader").hide(); |
| [1211](#L1211) | jQuery('#mysuccess\_msg').html(result[1]); |
| [1212](#L1212) | jQuery('#mysuccess\_msg').show(); |
| [1213](#L1213) |  |
| [1214](#L1214) | setTimeout(function () { |
| [1215](#L1215) |  |
| [1216](#L1216) | jQuery.fancybox\_ns.close(); |
| [1217](#L1217) |  |
| [1218](#L1218) |  |
| [1219](#L1219) |  |
| [1220](#L1220) | }, 2000); |
| [1221](#L1221) |  |
| [1222](#L1222) | } else { |
| [1223](#L1223) | jQuery(".AjaxLoader").hide(); |
| [1224](#L1224) | jQuery('#myerror\_msg').html(result[1]); |
| [1225](#L1225) | jQuery('#myerror\_msg').show(); |
| [1226](#L1226) | } |
| [1227](#L1227) |  |
| [1228](#L1228) | } |
| [1229](#L1229) |  |
| [1230](#L1230) | } |
| [1231](#L1231) | }); |
| [1232](#L1232) |  |
| [1233](#L1233) | } |
| [1234](#L1234) |  |
| [1235](#L1235) |  |
| [1236](#L1236) |  |
| [1237](#L1237) |  |
| [1238](#L1238) |  |
| [1239](#L1239) | } |
| [1240](#L1240) |  |
| [1241](#L1241) |  |
| [1242](#L1242) | <?php $intval= uniqid('interval\_');?> |
| [1243](#L1243) |  |
| [1244](#L1244) | var <?php echo $intval;?> = setInterval(function() { |
| [1245](#L1245) |  |
| [1246](#L1246) | if(document.readyState === 'complete') { |
| [1247](#L1247) |  |
| [1248](#L1248) | clearInterval(<?php echo $intval;?>); |
| [1249](#L1249) | /\* if ( jQuery.browser.msie && jQuery.browser.version >= 9 ) |
| [1250](#L1250) | { |
| [1251](#L1251) | jQuery.support.noCloneEvent = true |
| [1252](#L1252) | }\*/ |
| [1253](#L1253) |  |
| [1254](#L1254) | var htmlpopup = jQuery("#formFormEmail").html(); |
| [1255](#L1255) | jQuery("#formFormEmail").remove(); |
| [1256](#L1256) |  |
| [1257](#L1257) | jQuery('body').on('click', '.shownewsletterbox', function () { |
| [1258](#L1258) |  |
| [1259](#L1259) | jQuery.fancybox\_ns({ |
| [1260](#L1260) |  |
| [1261](#L1261) | 'overlayColor': '#000000', |
| [1262](#L1262) | 'hideOnOverlayClick': false, |
| [1263](#L1263) | 'padding': 10, |
| [1264](#L1264) | 'autoScale': true, |
| [1265](#L1265) | 'showCloseButton': true, |
| [1266](#L1266) | 'content': htmlpopup, |
| [1267](#L1267) | 'transitionIn': 'fade', |
| [1268](#L1268) | 'transitionOut': 'elastic', |
| [1269](#L1269) | 'width': 560, |
| [1270](#L1270) | 'height': 360 |
| [1271](#L1271) | }); |
| [1272](#L1272) |  |
| [1273](#L1273) | }); |
| [1274](#L1274) |  |
| [1275](#L1275) | <?php if($wp\_news\_letter\_settings['newsletter\_show\_on']=='any'): ?> |
| [1276](#L1276) |  |
| [1277](#L1277) |  |
| [1278](#L1278) | jQuery(document).ready(function () { |
| [1279](#L1279) |  |
| [1280](#L1280) | if (readCookie('newsLatterPopup') == null) { |
| [1281](#L1281) |  |
| [1282](#L1282) | setTimeout(function(){ |
| [1283](#L1283) |  |
| [1284](#L1284) | jQuery.fancybox\_ns({ |
| [1285](#L1285) |  |
| [1286](#L1286) | 'overlayColor': '#000000', |
| [1287](#L1287) | 'hideOnOverlayClick': false, |
| [1288](#L1288) | 'padding': 10, |
| [1289](#L1289) | 'autoScale': true, |
| [1290](#L1290) | 'showCloseButton': true, |
| [1291](#L1291) | 'content': htmlpopup, |
| [1292](#L1292) | 'transitionIn': 'fade', |
| [1293](#L1293) | 'transitionOut': 'elastic', |
| [1294](#L1294) | 'width': 560, |
| [1295](#L1295) | 'height': 360 |
| [1296](#L1296) | }); |
| [1297](#L1297) |  |
| [1298](#L1298) |  |
| [1299](#L1299) | createCookie('newsLatterPopup', 'donotshow', <?php echo $wp\_news\_letter\_settings['newsletter\_cookie'];?>); |
| [1300](#L1300) |  |
| [1301](#L1301) | },1500); |
| [1302](#L1302) |  |
| [1303](#L1303) |  |
| [1304](#L1304) | } |
| [1305](#L1305) | }); |
| [1306](#L1306) | <?php elseif($wp\_news\_letter\_settings['newsletter\_show\_on']=='home'):?> |
| [1307](#L1307) | <?php if(is\_front\_page()):?> |
| [1308](#L1308) |  |
| [1309](#L1309) | jQuery(document).ready(function () { |
| [1310](#L1310) |  |
| [1311](#L1311) | if (readCookie('newsLatterPopup') == null) { |
| [1312](#L1312) |  |
| [1313](#L1313) |  |
| [1314](#L1314) | jQuery.fancybox\_ns({ |
| [1315](#L1315) |  |
| [1316](#L1316) | 'overlayColor': '#000000', |
| [1317](#L1317) | 'hideOnOverlayClick': false, |
| [1318](#L1318) | 'padding': 10, |
| [1319](#L1319) | 'autoScale': true, |
| [1320](#L1320) | 'showCloseButton': true, |
| [1321](#L1321) | 'content': htmlpopup, |
| [1322](#L1322) | 'transitionIn': 'fade', |
| [1323](#L1323) | 'transitionOut': 'elastic', |
| [1324](#L1324) | 'width': 560, |
| [1325](#L1325) | 'height': 360 |
| [1326](#L1326) | }); |
| [1327](#L1327) |  |
| [1328](#L1328) |  |
| [1329](#L1329) | createCookie('newsLatterPopup', 'donotshow', <?php echo $wp\_news\_letter\_settings['newsletter\_cookie'];?>); |
| [1330](#L1330) |  |
| [1331](#L1331) | } |
| [1332](#L1332) | }); |
| [1333](#L1333) |  |
| [1334](#L1334) | <?php endif;?> |
| [1335](#L1335) | <?php endif;?> |
| [1336](#L1336) |  |
| [1337](#L1337) |  |
| [1338](#L1338) | } |
| [1339](#L1339) | }, 100); |
| [1340](#L1340) |  |
| [1341](#L1341) |  |
| [1342](#L1342) | </script> |
| [1343](#L1343) |  |
| [1344](#L1344) | <style> |
| [1345](#L1345) | <?php echo html\_entity\_decode($wp\_news\_letter\_settings['additional\_css'],ENT\_QUOTES);?> |
| [1346](#L1346) | </style> |
| [1347](#L1347) |  |
| [1348](#L1348) | <?php |
| [1349](#L1349) | $output = ob\_get\_clean(); |
| [1350](#L1350) | echo $output; |
| [1351](#L1351) |  |
| [1352](#L1352) | } |
| [1353](#L1353) |  |
| [1354](#L1354) |  |
| [1355](#L1355) | function email\_subscription\_popup\_admin\_options(){ |
| [1356](#L1356) |  |
| [1357](#L1357) | if(isset($\_POST['btnsave'])){ |
| [1358](#L1358) |  |
| [1359](#L1359) | if(!check\_admin\_referer( 'action\_settings\_add\_edit','add\_edit\_nonce' )){ |
| [1360](#L1360) |  |
| [1361](#L1361) | wp\_die('Security check fail'); |
| [1362](#L1362) | } |
| [1363](#L1363) |  |
| [1364](#L1364) | if ( ! current\_user\_can( 'es\_email\_subscribe\_settings' ) ) { |
| [1365](#L1365) |  |
| [1366](#L1366) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [1367](#L1367) |  |
| [1368](#L1368) | } |
| [1369](#L1369) |  |
| [1370](#L1370) | $newsletter\_show\_on='none'; |
| [1371](#L1371) | $newsletter\_cookie=0; |
| [1372](#L1372) | if(isset($\_POST['newsletter\_show\_on'])){ |
| [1373](#L1373) |  |
| [1374](#L1374) | $newsletter\_show\_on=htmlentities(strip\_tags($\_POST['newsletter\_show\_on']),ENT\_QUOTES); |
| [1375](#L1375) | if($newsletter\_show\_on=='home') |
| [1376](#L1376) | $newsletter\_cookie=htmlentities(strip\_tags($\_POST['cookieTimeUpUniqueHomePage']),ENT\_QUOTES); |
| [1377](#L1377) | else if($newsletter\_show\_on=='any') |
| [1378](#L1378) | $newsletter\_cookie=htmlentities(strip\_tags($\_POST['cookieTimeUpUniqueAnyPage']),ENT\_QUOTES); |
| [1379](#L1379) |  |
| [1380](#L1380) |  |
| [1381](#L1381) | } |
| [1382](#L1382) |  |
| [1383](#L1383) | $options=array(); |
| [1384](#L1384) | $options['newsletter\_cookie']          =intval($newsletter\_cookie); |
| [1385](#L1385) | $options['newsletter\_show\_on']          =sanitize\_text\_field($newsletter\_show\_on); |
| [1386](#L1386) | $options['heading']                     =trim(htmlentities(sanitize\_text\_field($\_POST['heading']),ENT\_QUOTES)); |
| [1387](#L1387) | $options['subheading']                  =trim(htmlentities(sanitize\_textarea\_field($\_POST['subheading']),ENT\_QUOTES)); |
| [1388](#L1388) | $options['email']                       =trim(htmlentities(sanitize\_text\_field($\_POST['email']),ENT\_QUOTES)); |
| [1389](#L1389) | $options['name']                        =trim(htmlentities(sanitize\_text\_field($\_POST['name']),ENT\_QUOTES)); |
| [1390](#L1390) | $options['submitbtn']                   =trim(htmlentities(sanitize\_text\_field($\_POST['submitbtn']),ENT\_QUOTES)); |
| [1391](#L1391) | $options['requiredfield']               =trim(htmlentities(sanitize\_text\_field($\_POST['requiredfield']),ENT\_QUOTES)); |
| [1392](#L1392) | $options['iinvalidemail']               =trim(htmlentities(sanitize\_text\_field($\_POST['iinvalidemail']),ENT\_QUOTES)); |
| [1393](#L1393) | $options['wait']                        =trim(htmlentities(sanitize\_text\_field($\_POST['wait']),ENT\_QUOTES)); |
| [1394](#L1394) | $options['invalid\_request']             =trim(htmlentities(sanitize\_text\_field($\_POST['invalid\_request']),ENT\_QUOTES)); |
| [1395](#L1395) | $options['email\_exist']                 =trim(htmlentities(sanitize\_text\_field($\_POST['email\_exist']),ENT\_QUOTES)); |
| [1396](#L1396) | $options['success']                     =trim(htmlentities(sanitize\_text\_field($\_POST['success']),ENT\_QUOTES)); |
| [1397](#L1397) | $options['unsubscribe\_message']         =trim(htmlentities(sanitize\_text\_field($\_POST['unsubscribe\_message']),ENT\_QUOTES)); |
| [1398](#L1398) | $options['show\_name\_field']             =trim(htmlentities(sanitize\_text\_field($\_POST['show\_name\_field']),ENT\_QUOTES)); |
| [1399](#L1399) | $options['show\_agreement']              =trim(htmlentities(sanitize\_text\_field($\_POST['show\_agreement']),ENT\_QUOTES)); |
| [1400](#L1400) | $options['agreement\_text']              =trim(htmlentities(strip\_tags(stripslashes( $\_POST['agreement\_text']),'<a><b><p><strong><em><i>'),ENT\_QUOTES)); |
| [1401](#L1401) | $options['agreement\_error']              =trim(htmlentities(sanitize\_text\_field($\_POST['agreement\_error']),ENT\_QUOTES)); |
| [1402](#L1402) | $options['additional\_css']              =trim(htmlentities(strip\_tags($\_POST['additional\_css']),ENT\_QUOTES)); |
| [1403](#L1403) |  |
| [1404](#L1404) | $settings=update\_option('wp\_news\_letter\_settings',$options); |
| [1405](#L1405) | $email\_subscription\_popup\_messages=array(); |
| [1406](#L1406) | $email\_subscription\_popup\_messages['type']='succ'; |
| [1407](#L1407) | $email\_subscription\_popup\_messages['message']='Settings saved successfully.'; |
| [1408](#L1408) | update\_option('email\_subscription\_popup\_messages', $email\_subscription\_popup\_messages); |
| [1409](#L1409) |  |
| [1410](#L1410) |  |
| [1411](#L1411) |  |
| [1412](#L1412) | } |
| [1413](#L1413) | $wp\_news\_letter\_settings=get\_option('wp\_news\_letter\_settings'); |
| [1414](#L1414) |  |
| [1415](#L1415) | if(! isset($wp\_news\_letter\_settings['unsubscribe\_message'])){ |
| [1416](#L1416) |  |
| [1417](#L1417) | $wp\_news\_letter\_settings['unsubscribe\_message']='You have successfully unsubscribed from email newsletter.Thank you...'; |
| [1418](#L1418) | } |
| [1419](#L1419) |  |
| [1420](#L1420) | if(! isset($wp\_news\_letter\_settings['subscribe\_message'])){ |
| [1421](#L1421) |  |
| [1422](#L1422) | $wp\_news\_letter\_settings['subscribe\_message']='You have successfully subscribed for email newsletter.Thank you...'; |
| [1423](#L1423) | } |
| [1424](#L1424) |  |
| [1425](#L1425) | if(! isset($wp\_news\_letter\_settings['show\_name\_field'])){ |
| [1426](#L1426) |  |
| [1427](#L1427) | $wp\_news\_letter\_settings['show\_name\_field']='1'; |
| [1428](#L1428) | } |
| [1429](#L1429) |  |
| [1430](#L1430) | if(! isset($wp\_news\_letter\_settings['show\_agreement'])){ |
| [1431](#L1431) |  |
| [1432](#L1432) | $wp\_news\_letter\_settings['show\_agreement']='0'; |
| [1433](#L1433) | } |
| [1434](#L1434) |  |
| [1435](#L1435) |  |
| [1436](#L1436) | if(! isset($wp\_news\_letter\_settings['agreement\_text'])){ |
| [1437](#L1437) |  |
| [1438](#L1438) |  |
| [1439](#L1439) | $wp\_news\_letter\_settings['agreement\_text']='I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>'; |
| [1440](#L1440) | } |
| [1441](#L1441) |  |
| [1442](#L1442) | if(!isset($wp\_news\_letter\_settings['agreement\_error'])){ |
| [1443](#L1443) |  |
| [1444](#L1444) | $wp\_news\_letter\_settings['agreement\_error']='Please read and agree to our terms & conditions.'; |
| [1445](#L1445) |  |
| [1446](#L1446) | } |
| [1447](#L1447) |  |
| [1448](#L1448) |  |
| [1449](#L1449) | if(!isset($wp\_news\_letter\_settings['additional\_css'])){ |
| [1450](#L1450) |  |
| [1451](#L1451) | $wp\_news\_letter\_settings['additional\_css']=''; |
| [1452](#L1452) |  |
| [1453](#L1453) | } |
| [1454](#L1454) |  |
| [1455](#L1455) | $wp\_news\_letter\_settings=stripslashes\_deep($wp\_news\_letter\_settings); |
| [1456](#L1456) |  |
| [1457](#L1457) | $url = plugin\_dir\_url(\_\_FILE\_\_);?> |
| [1458](#L1458) | <style type=""> |
| [1459](#L1459) | .fieldsetAdmin { |
| [1460](#L1460) | margin: 10px 0px; |
| [1461](#L1461) | padding: 10px; |
| [1462](#L1462) | border: 1px solid rgb(221, 221, 221); |
| [1463](#L1463) | font-size: 15px; |
| [1464](#L1464) | } |
| [1465](#L1465) | .fieldsetAdmin legend { |
| [1466](#L1466) | font-weight: bold; |
| [1467](#L1467) | color: #222222; |
| [1468](#L1468) |  |
| [1469](#L1469) | } |
| [1470](#L1470) | </style> |
| [1471](#L1471) | <div style="width: 100%;"> |
| [1472](#L1472) | <div style="float:left;width:65%;"> |
| [1473](#L1473) | <div class="wrap"> |
| [1474](#L1474) |  |
| [1475](#L1475) | <?php |
| [1476](#L1476) | $messages=get\_option('email\_subscription\_popup\_messages'); |
| [1477](#L1477) | $type=''; |
| [1478](#L1478) | $message=''; |
| [1479](#L1479) | if(isset($messages['type']) and $messages['type']!=""){ |
| [1480](#L1480) |  |
| [1481](#L1481) | $type=$messages['type']; |
| [1482](#L1482) | $message=$messages['message']; |
| [1483](#L1483) |  |
| [1484](#L1484) | } |
| [1485](#L1485) |  |
| [1486](#L1486) |  |
| [1487](#L1487) | if($type=='err'){ echo "<div class='notice notice-error is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [1488](#L1488) | else if($type=='succ'){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $message; echo "</p></div>";} |
| [1489](#L1489) |  |
| [1490](#L1490) |  |
| [1491](#L1491) | update\_option('email\_subscription\_popup\_messages', array()); |
| [1492](#L1492) | ?> |
| [1493](#L1493) | <table><tr><td> |
| [1494](#L1494) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [1495](#L1495) | <div id="fb-root"></div> |
| [1496](#L1496) | <script>(function(d, s, id) { |
| [1497](#L1497) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [1498](#L1498) | if (d.getElementById(id)) return; |
| [1499](#L1499) | js = d.createElement(s); js.id = id; |
| [1500](#L1500) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [1501](#L1501) | fjs.parentNode.insertBefore(js, fjs); |
| [1502](#L1502) | }(document, 'script', 'facebook-jssdk'));</script> |
| [1503](#L1503) | </td> |
| [1504](#L1504) | <td> |
| [1505](#L1505) | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [1506](#L1506) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [1507](#L1507) | </a> |
| [1508](#L1508) | </td> |
| [1509](#L1509) | </tr> |
| [1510](#L1510) | </table> |
| [1511](#L1511) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/">UPGRADE TO PRO VERSION</a></h3></span> |
| [1512](#L1512) |  |
| [1513](#L1513) | <h2><?php echo \_\_( 'Settings','email-subscribe');?></h2> |
| [1514](#L1514) | <br> |
| [1515](#L1515) | <div id="poststuff"> |
| [1516](#L1516) | <div id="post-body" class="metabox-holder columns-2"> |
| [1517](#L1517) | <div id="post-body-content"> |
| [1518](#L1518) | <form method="post" action="" id="subscriptionFrmsettiings" name="subscriptionFrmsettiings" > |
| [1519](#L1519) | <fieldset class="fieldsetAdmin"> |
| [1520](#L1520) | <legend><?php echo \_\_( 'Email Lightbox Popup Settings','email-subscribe');?></legend> |
| [1521](#L1521) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1522](#L1522) | <h3><label><?php echo \_\_( 'Show Modal Popup On','email-subscribe');?></label></h3> |
| [1523](#L1523) | <div class="inside"> |
| [1524](#L1524) | <table> |
| [1525](#L1525) | <tr> |
| [1526](#L1526) | <td> |
| [1527](#L1527) | <table> |
| [1528](#L1528) | <tr> |
| [1529](#L1529) | <td style="vertical-align: top"> |
| [1530](#L1530) | <input type="radio" name="newsletter\_show\_on" id="unique\_home\_page" value="home" style="width:10px"> |
| [1531](#L1531) | </td> |
| [1532](#L1532) | <td> |
| [1533](#L1533) | <b><?php echo \_\_( 'Show newsletter modal popup on unique request only on home page','email-subscribe');?></b> |
| [1534](#L1534) | <br/> |
| [1535](#L1535) | <div id="cookTimeHomepageRequest" style="display:none"> |
| [1536](#L1536) | <?php echo \_\_( 'Cookie Time :','email-subscribe');?> |
| [1537](#L1537) | <input style="width:50px" type="text" size="5" name="cookieTimeUpUniqueHomePage" value="<?php echo $wp\_news\_letter\_settings['newsletter\_cookie'];?>"  id="cookieTimeUpUniqueHomePage"/> <?php echo \_\_( 'In Days','email-subscribe');?> |
| [1538](#L1538) | <div style="clear:both"></div> |
| [1539](#L1539) | <div></div> |
| [1540](#L1540) | </div> |
| [1541](#L1541) | <script> |
| [1542](#L1542) |  |
| [1543](#L1543) | jQuery( "#unique\_home\_page" ).click(function() { |
| [1544](#L1544) |  |
| [1545](#L1545) | jQuery("#cookTimeAnypageRequest").hide(); |
| [1546](#L1546) | jQuery("#cookTimeHomepageRequest").show(); |
| [1547](#L1547) | }); |
| [1548](#L1548) | </script> |
| [1549](#L1549) | </td> |
| [1550](#L1550) | </tr> |
| [1551](#L1551) |  |
| [1552](#L1552) | <tr> |
| [1553](#L1553) | <td style="vertical-align: top"> |
| [1554](#L1554) | <input type="radio" name="newsletter\_show\_on" id="unique\_any" value="any" style="width:10px"> |
| [1555](#L1555) | </td> |
| [1556](#L1556) | <td> |
| [1557](#L1557) | <b><?php echo \_\_( 'Show newsletter modal popup on unique request for any page','email-subscribe');?></b> |
| [1558](#L1558) | <br/> |
| [1559](#L1559) | <div id="cookTimeAnypageRequest" style="display:none"> |
| [1560](#L1560) | <?php echo \_\_( 'Cookie Time :','email-subscribe');?> |
| [1561](#L1561) | <input style="width:50px" type="text" size="5" name="cookieTimeUpUniqueAnyPage" value="<?php echo $wp\_news\_letter\_settings['newsletter\_cookie'];?>" id="cookieTimeUpUniqueAnyPage"/> <?php echo \_\_( 'In Days','email-subscribe');?> |
| [1562](#L1562) | <div style="clear:both"></div> |
| [1563](#L1563) | <div></div> |
| [1564](#L1564) | </div> |
| [1565](#L1565) | <script> |
| [1566](#L1566) |  |
| [1567](#L1567) | jQuery( "#unique\_any" ).click(function() { |
| [1568](#L1568) | jQuery("#cookTimeHomepageRequest").hide(); |
| [1569](#L1569) | jQuery("#cookTimeAnypageRequest").show(); |
| [1570](#L1570) |  |
| [1571](#L1571) | }); |
| [1572](#L1572) | </script> |
| [1573](#L1573) |  |
| [1574](#L1574) | </td> |
| [1575](#L1575) | </tr> |
| [1576](#L1576) | <tr> |
| [1577](#L1577) | <td style="vertical-align: top"> |
| [1578](#L1578) | <input  type="radio" name="newsletter\_show\_on" value="none" id="show\_none" style="width:10px"> |
| [1579](#L1579) |  |
| [1580](#L1580) | </td> |
| [1581](#L1581) | <td> |
| [1582](#L1582) | <b><?php echo \_\_( 'No, I will use my custom link','email-subscribe');?></b> |
| [1583](#L1583) | <script> |
| [1584](#L1584) |  |
| [1585](#L1585) | jQuery( "#show\_none" ).click(function() { |
| [1586](#L1586) | jQuery("#cookTimeHomepageRequest").hide(); |
| [1587](#L1587) | jQuery("#cookTimeAnypageRequest").hide(); |
| [1588](#L1588) |  |
| [1589](#L1589) | }); |
| [1590](#L1590) | </script> |
| [1591](#L1591) | </td> |
| [1592](#L1592) | </tr> |
| [1593](#L1593) | <tr> |
| [1594](#L1594) | <td> |
| [1595](#L1595) |  |
| [1596](#L1596) |  |
| [1597](#L1597) | </td> |
| [1598](#L1598) | <td> |
| [1599](#L1599) | <br/> |
| [1600](#L1600) | <b><?php echo \_\_( 'To show Newsletter modal Popup On Custom Link Click Use','email-subscribe');?> <i>shownewsletterbox</i> css class</b> |
| [1601](#L1601) | <br/> |
| [1602](#L1602) | <br/> |
| [1603](#L1603) | <b><?php echo \_\_( 'Example :','email-subscribe');?> </b> |
| [1604](#L1604) | <pre><?php echo htmlspecialchars('<a href="#" class="shownewsletterbox">Subscribe to Newsletter</a>');?></pre> |
| [1605](#L1605) | </td> |
| [1606](#L1606) |  |
| [1607](#L1607) | </tr> |
| [1608](#L1608) |  |
| [1609](#L1609) | </table> |
| [1610](#L1610) | <hr/> |
| [1611](#L1611) | <table> |
| [1612](#L1612) | <tr> |
| [1613](#L1613) | <td class="label" style="width:35%"> |
| [1614](#L1614) | <h3 style="font-size: 13px"><label for="show\_name\_field"><?php echo \_\_('Show Name Field In Newsletter Popup ?','email-subscribe');?> <span class="required">\*</span></label></h3> |
| [1615](#L1615) | </td> |
| [1616](#L1616) | <td class="value" style="width:65%"> |
| [1617](#L1617) | <select id="show\_name\_field" name="show\_name\_field" class="select"> |
| [1618](#L1618) | <option value=""><?php echo \_\_('Select','email-subscribe');?></option> |
| [1619](#L1619) | <option <?php if($wp\_news\_letter\_settings['show\_name\_field']=='1'):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_('Yes','email-subscribe');?></option> |
| [1620](#L1620) | <option <?php if($wp\_news\_letter\_settings['show\_name\_field']=='0'):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_('No','email-subscribe');?></option> |
| [1621](#L1621) | </select> |
| [1622](#L1622) | <div style="clear:both"></div> |
| [1623](#L1623) | <div class="error\_label"></div> |
| [1624](#L1624) | </td> |
| [1625](#L1625) | </tr> |
| [1626](#L1626) | <tr> |
| [1627](#L1627) | <td class="label" style="width:35%"> |
| [1628](#L1628) | <h3 style="font-size: 13px"><label for="show\_agreement"><?php echo \_\_('Show Checkbox For Terms and Conditions Agreement','email-subscribe');?> <span class="required">\*</span></label></h3> |
| [1629](#L1629) | </td> |
| [1630](#L1630) | <td class="value" style="width:65%"> |
| [1631](#L1631) | <select id="show\_agreement" name="show\_agreement" class="select"> |
| [1632](#L1632) | <option value=""><?php echo \_\_('Select','email-subscribe');?></option> |
| [1633](#L1633) | <option <?php if($wp\_news\_letter\_settings['show\_agreement']=='1'):?> selected="selected" <?php endif;?>  value="1" ><?php echo \_\_('Yes','email-subscribe');?></option> |
| [1634](#L1634) | <option <?php if($wp\_news\_letter\_settings['show\_agreement']=='0'):?> selected="selected" <?php endif;?>  value="0"><?php echo \_\_('No','email-subscribe');?></option> |
| [1635](#L1635) | </select> |
| [1636](#L1636) | <div style="clear:both"></div> |
| [1637](#L1637) | <div class="error\_label"></div> |
| [1638](#L1638) | </td> |
| [1639](#L1639) | </tr> |
| [1640](#L1640) | <tr> |
| [1641](#L1641) | <td class="label" style="width:35%"> |
| [1642](#L1642) | <h3 style="font-size: 13px"><label for="agreement\_text"><?php echo \_\_('Agreement Text','email-subscribe');?> <span class="required">\*</span></label></h3> |
| [1643](#L1643) | </td> |
| [1644](#L1644) | <td class="value" style="width:65%"> |
| [1645](#L1645) | <textarea name="agreement\_text" id="agreement\_text" style="width: 100%;height: 74px;"><?php echo html\_entity\_decode($wp\_news\_letter\_settings['agreement\_text']);?></textarea> |
| [1646](#L1646) | <div style="clear:both;font-size: 12px;color:black"><?php echo \_\_('Replace # with your Terms of Service and Privacy Policy full Url.','email-subscribe');?></div> |
| [1647](#L1647) | <div class="error\_label"></div> |
| [1648](#L1648) | </td> |
| [1649](#L1649) | </tr> |
| [1650](#L1650) | </table> |
| [1651](#L1651) | <div style="clear:both"></div> |
| [1652](#L1652) | <div></div> |
| [1653](#L1653) |  |
| [1654](#L1654) | </td> |
| [1655](#L1655) | </tr> |
| [1656](#L1656) | </table> |
| [1657](#L1657) | <div style="clear:both"></div> |
| [1658](#L1658) | <script> |
| [1659](#L1659) | <?php if($wp\_news\_letter\_settings['newsletter\_show\_on']=='any'): ?> |
| [1660](#L1660) | jQuery('#unique\_any').trigger('click'); |
| [1661](#L1661) | <?php elseif($wp\_news\_letter\_settings['newsletter\_show\_on']=='home'): ?> |
| [1662](#L1662) | jQuery('#unique\_home\_page').trigger('click'); |
| [1663](#L1663) | <?php else: ?> |
| [1664](#L1664) | jQuery("#show\_none").trigger('click'); |
| [1665](#L1665) | <?php endif;?> |
| [1666](#L1666) | </script> |
| [1667](#L1667) | </div> |
| [1668](#L1668) | </div> |
| [1669](#L1669) |  |
| [1670](#L1670) | </fieldset> |
| [1671](#L1671) | <fieldset class="fieldsetAdmin"> |
| [1672](#L1672) | <legend><?php echo \_\_( 'Subscription Form Settings Messages & Label Settings','email-subscribe');?></legend> |
| [1673](#L1673) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1674](#L1674) | <h3><label><?php echo \_\_( 'Heading','email-subscribe');?></label></h3> |
| [1675](#L1675) | <div class="inside"> |
| [1676](#L1676) | <table> |
| [1677](#L1677) | <tr> |
| [1678](#L1678) | <td> |
| [1679](#L1679) | <input type="text" id="heading" size="50" name="heading" value="<?php echo $wp\_news\_letter\_settings['heading'];?>" style="width:550px;"> |
| [1680](#L1680) | <div style="clear:both"></div> |
| [1681](#L1681) | <div></div> |
| [1682](#L1682) | </td> |
| [1683](#L1683) | </tr> |
| [1684](#L1684) | </table> |
| [1685](#L1685) | <div style="clear:both"></div> |
| [1686](#L1686) | </div> |
| [1687](#L1687) | </div> |
| [1688](#L1688) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1689](#L1689) | <h3><label><?php echo \_\_( 'Subheading','email-subscribe');?></label></h3> |
| [1690](#L1690) | <div class="inside"> |
| [1691](#L1691) | <table> |
| [1692](#L1692) | <tr> |
| [1693](#L1693) | <td> |
| [1694](#L1694) | <textarea id="subheading" style="width:550px;height:60px" size="50" name="subheading" ><?php echo $wp\_news\_letter\_settings['subheading'];?></textarea> |
| [1695](#L1695) | <div style="clear:both"></div> |
| [1696](#L1696) | <div></div> |
| [1697](#L1697) | </td> |
| [1698](#L1698) | </tr> |
| [1699](#L1699) | </table> |
| [1700](#L1700) | <div style="clear:both"></div> |
| [1701](#L1701) | </div> |
| [1702](#L1702) | </div> |
| [1703](#L1703) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1704](#L1704) | <h3><label><?php echo \_\_( 'Email Label','email-subscribe');?></label></h3> |
| [1705](#L1705) | <div class="inside"> |
| [1706](#L1706) | <table> |
| [1707](#L1707) | <tr> |
| [1708](#L1708) | <td> |
| [1709](#L1709) | <input type="text" id="email" size="50" name="email" value="<?php echo $wp\_news\_letter\_settings['email'];?>" style="width:550px;"> |
| [1710](#L1710) | <div style="clear:both"></div> |
| [1711](#L1711) | <div></div> |
| [1712](#L1712) | </td> |
| [1713](#L1713) | </tr> |
| [1714](#L1714) | </table> |
| [1715](#L1715) | <div style="clear:both"></div> |
| [1716](#L1716) | </div> |
| [1717](#L1717) | </div> |
| [1718](#L1718) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1719](#L1719) | <h3><label><?php echo \_\_( 'Name Label','email-subscribe');?></label></h3> |
| [1720](#L1720) | <div class="inside"> |
| [1721](#L1721) | <table> |
| [1722](#L1722) | <tr> |
| [1723](#L1723) | <td> |
| [1724](#L1724) | <input type="text" id="name" size="50" name="name" value="<?php echo $wp\_news\_letter\_settings['name'];?>" style="width:550px;"> |
| [1725](#L1725) | <div style="clear:both"></div> |
| [1726](#L1726) | <div></div> |
| [1727](#L1727) | </td> |
| [1728](#L1728) | </tr> |
| [1729](#L1729) | </table> |
| [1730](#L1730) | <div style="clear:both"></div> |
| [1731](#L1731) | </div> |
| [1732](#L1732) | </div> |
| [1733](#L1733) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1734](#L1734) | <h3><label><?php echo \_\_( 'Submit Button Label','email-subscribe');?></label></h3> |
| [1735](#L1735) | <div class="inside"> |
| [1736](#L1736) | <table> |
| [1737](#L1737) | <tr> |
| [1738](#L1738) | <td> |
| [1739](#L1739) | <input type="text" id="submitbtn" size="50" name="submitbtn" value="<?php echo $wp\_news\_letter\_settings['submitbtn'];?>" style="width:550px;"> |
| [1740](#L1740) | <div style="clear:both"></div> |
| [1741](#L1741) | <div></div> |
| [1742](#L1742) | </td> |
| [1743](#L1743) | </tr> |
| [1744](#L1744) | </table> |
| [1745](#L1745) | <div style="clear:both"></div> |
| [1746](#L1746) | </div> |
| [1747](#L1747) | </div> |
| [1748](#L1748) | </fieldset> |
| [1749](#L1749) | <fieldset class="fieldsetAdmin"> |
| [1750](#L1750) | <legend><?php echo \_\_( 'Errors & validation Messages Settings','email-subscribe');?></legend> |
| [1751](#L1751) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1752](#L1752) | <h3><label><?php echo \_\_( 'Required Field Message','email-subscribe');?></label></h3> |
| [1753](#L1753) | <div class="inside"> |
| [1754](#L1754) | <table> |
| [1755](#L1755) | <tr> |
| [1756](#L1756) | <td> |
| [1757](#L1757) | <input type="text" id="requiredfield" size="50" name="requiredfield" value="<?php echo $wp\_news\_letter\_settings['requiredfield'];?>" style="width:550px;"> |
| [1758](#L1758) | <div style="clear:both"></div> |
| [1759](#L1759) | <div></div> |
| [1760](#L1760) | </td> |
| [1761](#L1761) | </tr> |
| [1762](#L1762) | </table> |
| [1763](#L1763) | <div style="clear:both"></div> |
| [1764](#L1764) | </div> |
| [1765](#L1765) | </div> |
| [1766](#L1766) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1767](#L1767) | <h3><label><?php echo \_\_( 'Invalid Email Message','email-subscribe');?></label></h3> |
| [1768](#L1768) | <div class="inside"> |
| [1769](#L1769) | <table> |
| [1770](#L1770) | <tr> |
| [1771](#L1771) | <td> |
| [1772](#L1772) | <input type="text" id="iinvalidemail" size="50" name="iinvalidemail" value="<?php echo $wp\_news\_letter\_settings['iinvalidemail'];?>" style="width:550px;"> |
| [1773](#L1773) | <div style="clear:both"></div> |
| [1774](#L1774) | <div></div> |
| [1775](#L1775) | </td> |
| [1776](#L1776) | </tr> |
| [1777](#L1777) | </table> |
| [1778](#L1778) | <div style="clear:both"></div> |
| [1779](#L1779) | </div> |
| [1780](#L1780) | </div> |
| [1781](#L1781) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1782](#L1782) | <h3><label><?php echo \_\_( 'Invalid Request Message','email-subscribe');?></label></h3> |
| [1783](#L1783) | <div class="inside"> |
| [1784](#L1784) | <table> |
| [1785](#L1785) | <tr> |
| [1786](#L1786) | <td> |
| [1787](#L1787) | <input type="text" id="invalid\_request" size="50" name="invalid\_request" value="<?php echo $wp\_news\_letter\_settings['invalid\_request'];?>" style="width:550px;"> |
| [1788](#L1788) | <div style="clear:both"></div> |
| [1789](#L1789) | <div></div> |
| [1790](#L1790) | </td> |
| [1791](#L1791) | </tr> |
| [1792](#L1792) | </table> |
| [1793](#L1793) | <div style="clear:both"></div> |
| [1794](#L1794) | </div> |
| [1795](#L1795) | </div> |
| [1796](#L1796) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1797](#L1797) | <h3><label><?php echo \_\_( 'Email Exist Message','email-subscribe');?></label></h3> |
| [1798](#L1798) | <div class="inside"> |
| [1799](#L1799) | <table> |
| [1800](#L1800) | <tr> |
| [1801](#L1801) | <td> |
| [1802](#L1802) | <input type="text" id="email\_exist" size="50" name="email\_exist" value="<?php echo $wp\_news\_letter\_settings['email\_exist'];?>" style="width:550px;"> |
| [1803](#L1803) | <div style="clear:both"></div> |
| [1804](#L1804) | <div></div> |
| [1805](#L1805) | </td> |
| [1806](#L1806) | </tr> |
| [1807](#L1807) | </table> |
| [1808](#L1808) | <div style="clear:both"></div> |
| [1809](#L1809) | </div> |
| [1810](#L1810) | </div> |
| [1811](#L1811) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1812](#L1812) | <h3><label><?php echo \_\_( 'Agreement Error','email-subscribe');?></label></h3> |
| [1813](#L1813) | <div class="inside"> |
| [1814](#L1814) | <table> |
| [1815](#L1815) | <tr> |
| [1816](#L1816) | <td> |
| [1817](#L1817) | <input type="text" id="agreement\_error" size="50" name="agreement\_error" value="<?php echo $wp\_news\_letter\_settings['agreement\_error'];?>" style="width:550px;"> |
| [1818](#L1818) | <div style="clear:both"></div> |
| [1819](#L1819) | <div></div> |
| [1820](#L1820) | </td> |
| [1821](#L1821) | </tr> |
| [1822](#L1822) | </table> |
| [1823](#L1823) | <div style="clear:both"></div> |
| [1824](#L1824) | </div> |
| [1825](#L1825) | </div> |
| [1826](#L1826) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1827](#L1827) | <h3><label><?php echo \_\_( 'Success Message','email-subscribe');?></label></h3> |
| [1828](#L1828) | <div class="inside"> |
| [1829](#L1829) | <table> |
| [1830](#L1830) | <tr> |
| [1831](#L1831) | <td> |
| [1832](#L1832) | <input type="text" id="success" size="50" name="success" value="<?php echo $wp\_news\_letter\_settings['success'];?>" style="width:550px;"> |
| [1833](#L1833) | <div style="clear:both"></div> |
| [1834](#L1834) | <div></div> |
| [1835](#L1835) | </td> |
| [1836](#L1836) | </tr> |
| [1837](#L1837) | </table> |
| [1838](#L1838) | <div style="clear:both"></div> |
| [1839](#L1839) | </div> |
| [1840](#L1840) | </div> |
| [1841](#L1841) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1842](#L1842) | <h3><label><?php echo \_\_( 'Unsubscribe Message','email-subscribe');?></label></h3> |
| [1843](#L1843) | <div class="inside"> |
| [1844](#L1844) | <table> |
| [1845](#L1845) | <tr> |
| [1846](#L1846) | <td> |
| [1847](#L1847) | <input type="text" id="unsubscribe\_message" size="50" name="unsubscribe\_message" value="<?php echo $wp\_news\_letter\_settings['unsubscribe\_message'];?>" style="width:550px;"> |
| [1848](#L1848) | <div style="clear:both"></div> |
| [1849](#L1849) | <div></div> |
| [1850](#L1850) | </td> |
| [1851](#L1851) | </tr> |
| [1852](#L1852) | </table> |
| [1853](#L1853) | <div style="clear:both"></div> |
| [1854](#L1854) | </div> |
| [1855](#L1855) | </div> |
| [1856](#L1856) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1857](#L1857) | <h3><label><?php echo \_\_( 'Wait Message','email-subscribe');?></label></h3> |
| [1858](#L1858) | <div class="inside"> |
| [1859](#L1859) | <table> |
| [1860](#L1860) | <tr> |
| [1861](#L1861) | <td> |
| [1862](#L1862) | <input type="text" id="wait" size="50" name="wait" value="<?php echo $wp\_news\_letter\_settings['wait'];?>" style="width:550px;"> |
| [1863](#L1863) | <div style="clear:both"></div> |
| [1864](#L1864) | <div></div> |
| [1865](#L1865) | </td> |
| [1866](#L1866) | </tr> |
| [1867](#L1867) | </table> |
| [1868](#L1868) | <div style="clear:both"></div> |
| [1869](#L1869) | </div> |
| [1870](#L1870) | </div> |
| [1871](#L1871) | </fieldset> |
| [1872](#L1872) | <fieldset class="fieldsetAdmin"> |
| [1873](#L1873) | <legend><?php echo \_\_( 'Additional CSS','email-subscribe');?></legend> |
| [1874](#L1874) | <div class="stuffbox" id="namediv" style="min-width:550px;"> |
| [1875](#L1875) | <h3><label><?php echo \_\_( 'Add CSS','email-subscribe');?></label></h3> |
| [1876](#L1876) | <div class="inside"> |
| [1877](#L1877) | <table> |
| [1878](#L1878) | <tr> |
| [1879](#L1879) | <td> |
| [1880](#L1880) | <textarea style="width:550px;height:200px" id="additional\_css" size="50" name="additional\_css" ><?php echo $wp\_news\_letter\_settings['additional\_css'];?></textarea> |
| [1881](#L1881) | <div style="clear:both;font-size: 12px;color:black"><?php echo \_\_("Don't, use style tag. Just add css",'email-subscribe');?></div> |
| [1882](#L1882) | <div></div> |
| [1883](#L1883) | </td> |
| [1884](#L1884) | </tr> |
| [1885](#L1885) | </table> |
| [1886](#L1886) | <div style="clear:both"></div> |
| [1887](#L1887) | </div> |
| [1888](#L1888) | </div> |
| [1889](#L1889) | </fieldset> |
| [1890](#L1890) | <?php wp\_nonce\_field('action\_settings\_add\_edit','add\_edit\_nonce' ); ?> |
| [1891](#L1891) | <input type="submit"   name="btnsave" id="btnsave" value="<?php echo \_\_( 'Save Changes','email-subscribe');?>" class="button-primary"> |
| [1892](#L1892) |  |
| [1893](#L1893) | </form> |
| [1894](#L1894) | <script type="text/javascript"> |
| [1895](#L1895) |  |
| [1896](#L1896) |  |
| [1897](#L1897) | jQuery(document).ready(function() { |
| [1898](#L1898) |  |
| [1899](#L1899) | jQuery.validator.addMethod("checkHomeCookie", function(value, element) { |
| [1900](#L1900) |  |
| [1901](#L1901) |  |
| [1902](#L1902) | if(jQuery('input[name="newsletter\_show\_on"]:checked').val()=='home' && jQuery.trim(jQuery("#cookieTimeUpUniqueHomePage").val())==''){ |
| [1903](#L1903) | return false; |
| [1904](#L1904) | } |
| [1905](#L1905) | else{ |
| [1906](#L1906) | return true; |
| [1907](#L1907) | } |
| [1908](#L1908) |  |
| [1909](#L1909) |  |
| [1910](#L1910) | }, "Please enter cookie value"); |
| [1911](#L1911) |  |
| [1912](#L1912) | jQuery.validator.addMethod("checkanypageCookie", function(value, element) { |
| [1913](#L1913) |  |
| [1914](#L1914) | if(jQuery('input[name="newsletter\_show\_on"]:checked').val()=='any' && jQuery.trim(jQuery("#cookieTimeUpUniqueAnyPage").val())==''){ |
| [1915](#L1915) | return false; |
| [1916](#L1916) | } |
| [1917](#L1917) | else{ |
| [1918](#L1918) | return true; |
| [1919](#L1919) | } |
| [1920](#L1920) |  |
| [1921](#L1921) |  |
| [1922](#L1922) | }, "Please enter cookie value"); |
| [1923](#L1923) | jQuery("#subscriptionFrmsettiings").validate({ |
| [1924](#L1924) | rules: { |
| [1925](#L1925) | cookieTimeUpUniqueHomePage: { |
| [1926](#L1926) | checkHomeCookie:true, |
| [1927](#L1927) | digits:true |
| [1928](#L1928) |  |
| [1929](#L1929) | }, |
| [1930](#L1930) | cookieTimeUpUniqueAnyPage: { |
| [1931](#L1931) | checkanypageCookie:true, |
| [1932](#L1932) | digits:true |
| [1933](#L1933) |  |
| [1934](#L1934) | }, |
| [1935](#L1935) | heading: { |
| [1936](#L1936) | required:true |
| [1937](#L1937) | },subheading: { |
| [1938](#L1938) | required:true |
| [1939](#L1939) | }, |
| [1940](#L1940) | email:{ |
| [1941](#L1941) | required:true |
| [1942](#L1942) | }, |
| [1943](#L1943) | name:{ |
| [1944](#L1944) | required:true |
| [1945](#L1945) | }, |
| [1946](#L1946) | submitbtn:{ |
| [1947](#L1947) | required:true |
| [1948](#L1948) | }, |
| [1949](#L1949) | requiredfield:{ |
| [1950](#L1950) | required:true |
| [1951](#L1951) | }, |
| [1952](#L1952) | iinvalidemail:{ |
| [1953](#L1953) | required:true |
| [1954](#L1954) | }, |
| [1955](#L1955) | invalid\_request:{ |
| [1956](#L1956) | required:true |
| [1957](#L1957) | }, |
| [1958](#L1958) | email\_exist:{ |
| [1959](#L1959) | required:true |
| [1960](#L1960) | }, |
| [1961](#L1961) | success:{ |
| [1962](#L1962) | required:true |
| [1963](#L1963) | }, |
| [1964](#L1964) | success:{ |
| [1965](#L1965) | required:true |
| [1966](#L1966) | }, |
| [1967](#L1967) | unsubscribe\_message:{ |
| [1968](#L1968) | required:true |
| [1969](#L1969) | } |
| [1970](#L1970) | ,wait:{ |
| [1971](#L1971) | required:true |
| [1972](#L1972) | } |
| [1973](#L1973) |  |
| [1974](#L1974) | }, |
| [1975](#L1975) | errorClass: "image\_error", |
| [1976](#L1976) | errorPlacement: function(error, element) { |
| [1977](#L1977) | error.appendTo( element.next().next()); |
| [1978](#L1978) | } |
| [1979](#L1979) |  |
| [1980](#L1980) |  |
| [1981](#L1981) | }) |
| [1982](#L1982) | }); |
| [1983](#L1983) |  |
| [1984](#L1984) | </script> |
| [1985](#L1985) |  |
| [1986](#L1986) | </div> |
| [1987](#L1987) | </div> |
| [1988](#L1988) | </div> |
| [1989](#L1989) | </div> |
| [1990](#L1990) | </div> |
| [1991](#L1991) | <div id="postbox-container-1" class="postbox-container" style="float:right;width:35%;margin-top: 50px" > |
| [1992](#L1992) |  |
| [1993](#L1993) | <div class="postbox"> |
| [1994](#L1994) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'New AI based DIVI Theme','email-subscribe');?></h3> </center> |
| [1995](#L1995) | <div class="inside"> |
| [1996](#L1996) | <center><a href="https://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715&url=80806" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/divi\_300x250.jpg', \_\_FILE\_\_ ) ;?>" width="250" height="250"></a></center> |
| [1997](#L1997) |  |
| [1998](#L1998) | <div style="margin:10px 5px"> |
| [1999](#L1999) |  |
| [2000](#L2000) | </div> |
| [2001](#L2001) | </div></div> |
| [2002](#L2002) | <div class="postbox"> |
| [2003](#L2003) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','email-subscribe');?></h3> </center> |
| [2004](#L2004) | <div class="inside"> |
| [2005](#L2005) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px" src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ ) ;?>" width="" height="250" border="0"></a></center> |
| [2006](#L2006) | <div style="margin:10px 5px"> |
| [2007](#L2007) | </div> |
| [2008](#L2008) | </div></div> |
| [2009](#L2009) |  |
| [2010](#L2010) | </div> |
| [2011](#L2011) | <div class="clear"></div></div> |
| [2012](#L2012) | <?php |
| [2013](#L2013) | } |
| [2014](#L2014) |  |
| [2015](#L2015) | function massEmailToEmail\_Subscriber\_Func(){ |
| [2016](#L2016) |  |
| [2017](#L2017) |  |
| [2018](#L2018) | $selfpage=wp\_get\_referer() ; |
| [2019](#L2019) |  |
| [2020](#L2020) | $action=''; |
| [2021](#L2021) | if(isset($\_REQUEST['action'])){ |
| [2022](#L2022) | $action=$\_REQUEST['action']; |
| [2023](#L2023) | } |
| [2024](#L2024) | ?> |
| [2025](#L2025) |  |
| [2026](#L2026) | <?php |
| [2027](#L2027) | switch($action){ |
| [2028](#L2028) |  |
| [2029](#L2029) |  |
| [2030](#L2030) | case 'sendEmailSend': |
| [2031](#L2031) |  |
| [2032](#L2032) | if ( !check\_admin\_referer( 'action\_settings\_add\_edit','sendEmailSend')){ |
| [2033](#L2033) |  |
| [2034](#L2034) | wp\_die('Security check fail'); |
| [2035](#L2035) | } |
| [2036](#L2036) |  |
| [2037](#L2037) | set\_time\_limit(5000); |
| [2038](#L2038) | $emailTo= preg\_replace('/\s\s+/', ' ', $\_POST['emailTo']); |
| [2039](#L2039) | $toSendEmail=explode(",",$emailTo); |
| [2040](#L2040) | global $wpdb; |
| [2041](#L2041) |  |
| [2042](#L2042) | $flag=false; |
| [2043](#L2043) | foreach($toSendEmail as $key=>$val){ |
| [2044](#L2044) |  |
| [2045](#L2045) | $val=trim(htmlentities(sanitize\_email($val),ENT\_QUOTES)); |
| [2046](#L2046) |  |
| [2047](#L2047) | $subject=stripslashes($\_POST['email\_subject']); |
| [2048](#L2048) | //$subject=trim(htmlentities(strip\_tags($subject),ENT\_QUOTES)); |
| [2049](#L2049) | $from\_name=stripslashes($\_POST['email\_From\_name']); |
| [2050](#L2050) | // $from\_name=trim(htmlentities(strip\_tags($from\_name),ENT\_QUOTES)); |
| [2051](#L2051) |  |
| [2052](#L2052) | $from\_email=htmlentities(sanitize\_email($\_POST['email\_From']),ENT\_QUOTES); |
| [2053](#L2053) | $emailBody=$\_POST['txtArea']; |
| [2054](#L2054) |  |
| [2055](#L2055) | $query="SELECT \* FROM ".$wpdb->prefix."nl\_subscriptions WHERE email='$val'"; |
| [2056](#L2056) |  |
| [2057](#L2057) | $userInfo  = $wpdb->get\_row($query); |
| [2058](#L2058) | $user\_full\_name=""; |
| [2059](#L2059) | $user\_email=""; |
| [2060](#L2060) | $unsubscribeLinkHtml=""; |
| [2061](#L2061) | $unsubscribeLinkPlain=""; |
| [2062](#L2062) |  |
| [2063](#L2063) | if(is\_object($userInfo)){ |
| [2064](#L2064) |  |
| [2065](#L2065) | $uerIdunsbs=  urldecode($userInfo->unsubs\_key); |
| [2066](#L2066) | $user\_email=$userInfo->email; |
| [2067](#L2067) | $user\_full\_name = stripslashes($userInfo->name); |
| [2068](#L2068) |  |
| [2069](#L2069) | } |
| [2070](#L2070) | $url = get\_home\_url(); |
| [2071](#L2071) | $unsubs=$url.'?action=nks\_unsubscribeuser&unsc='.$uerIdunsbs; |
| [2072](#L2072) | $unsubscribeLinkHtml='<a href="'.$unsubs.'" target="\_blank">Unsubscribe me from all email messages</a>'; |
| [2073](#L2073) | $unsubscribeLinkPlain=$unsubs; |
| [2074](#L2074) |  |
| [2075](#L2075) |  |
| [2076](#L2076) | $emailBody=stripslashes($emailBody); |
| [2077](#L2077) |  |
| [2078](#L2078) | $emailBody=str\_replace('[user\_full\_name]',$user\_full\_name,$emailBody); |
| [2079](#L2079) | $emailBody=str\_replace('[user\_email]',$user\_email,$emailBody); |
| [2080](#L2080) | $emailBody=str\_replace('[unsubscribe\_link\_plain]',$unsubscribeLinkPlain,$emailBody); |
| [2081](#L2081) | $emailBody=str\_replace('[unsubscribe\_link\_html]',$unsubscribeLinkHtml,$emailBody); |
| [2082](#L2082) |  |
| [2083](#L2083) | $charSet=get\_bloginfo('charset'); |
| [2084](#L2084) |  |
| [2085](#L2085) | $mailheaders=''; |
| [2086](#L2086) | //$mailheaders .= "X-Priority: 1\n"; |
| [2087](#L2087) | $mailheaders .= "Content-Type: text/html; charset=\"$charSet\"\n"; |
| [2088](#L2088) | $mailheaders .= "From: $from\_name <$from\_email>" . "\r\n"; |
| [2089](#L2089) | //$mailheaders .= "Bcc: $emailTo" . "\r\n"; |
| [2090](#L2090) |  |
| [2091](#L2091) | // $message=nl2br($message,true); |
| [2092](#L2092) | $emailBody=wpautop($emailBody); |
| [2093](#L2093) | $emailBody='<!DOCTYPE html><html '.get\_language\_attributes().'><head> <meta http-equiv="Content-Type" content="text/html; charset='. get\_bloginfo( "charset" ).'" /><title>'.get\_bloginfo( 'name', 'display' ).'</title></head><body>'.$emailBody.'</body></html>'; |
| [2094](#L2094) |  |
| [2095](#L2095) | $Rreturns=wp\_mail($val, $subject, $emailBody, $mailheaders); |
| [2096](#L2096) |  |
| [2097](#L2097) | if($Rreturns) |
| [2098](#L2098) | $flag=true; |
| [2099](#L2099) |  |
| [2100](#L2100) | } |
| [2101](#L2101) | $adminUrl=get\_admin\_url(); |
| [2102](#L2102) | if($flag){ |
| [2103](#L2103) |  |
| [2104](#L2104) | update\_option( 'mass\_email\_subscribers\_succ', \_\_('Email sent successfully.','email-subscribe') ); |
| [2105](#L2105) | $entrant=empty($\_POST['entrant'])?1:(int)$\_POST['entrant']; |
| [2106](#L2106) | $setPerPage=empty($\_POST['setPerPage'])?10:(int)$\_POST['setPerPage']; |
| [2107](#L2107) | $searchuser=htmlentities(strip\_tags($\_POST['searchuser']),ENT\_QUOTES); |
| [2108](#L2108) |  |
| [2109](#L2109) | echo "<script>window.location.href='". $adminUrl."admin.php?page=email\_subscription\_popup\_subscribers\_management&entrant=$entrant&setPerPage=$setPerPage&searchuser=$searchuser"."';</script>"; |
| [2110](#L2110) | exit; |
| [2111](#L2111) |  |
| [2112](#L2112) | } |
| [2113](#L2113) | else{ |
| [2114](#L2114) |  |
| [2115](#L2115) | $entrant=empty($\_POST['entrant'])?1:(int)$\_POST['entrant']; |
| [2116](#L2116) | $setPerPage=empty($\_POST['setPerPage'])?10:(int)$\_POST['setPerPage']; |
| [2117](#L2117) | $searchuser=htmlentities(strip\_tags($\_POST['searchuser']),ENT\_QUOTES); |
| [2118](#L2118) |  |
| [2119](#L2119) | update\_option( 'mass\_email\_subscribers\_err', \_\_('Unable to send email to newsletter subscribers.','email-subscribe') ); |
| [2120](#L2120) | echo "<script>window.location.href='". $adminUrl."admin.php?page=email\_subscription\_popup\_subscribers\_management&entrant=$entrant&setPerPage=$setPerPage&searchuser=$searchuser"."';</script>"; |
| [2121](#L2121) | exit; |
| [2122](#L2122) | } |
| [2123](#L2123) | break; |
| [2124](#L2124) |  |
| [2125](#L2125) | case 'sendEmailForm' : |
| [2126](#L2126) | $referer=wp\_get\_referer() ; |
| [2127](#L2127) |  |
| [2128](#L2128) |  |
| [2129](#L2129) | if(isset($\_POST['deleteEmails'])){ |
| [2130](#L2130) |  |
| [2131](#L2131) | if ( !check\_admin\_referer( 'action\_settings\_add\_edit','queue\_and\_delete\_subsciber')){ |
| [2132](#L2132) |  |
| [2133](#L2133) | wp\_die('Security check fail'); |
| [2134](#L2134) | } |
| [2135](#L2135) |  |
| [2136](#L2136) | if ( ! current\_user\_can( 'es\_email\_subscribe\_delete\_subscribers' ) ) { |
| [2137](#L2137) |  |
| [2138](#L2138) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [2139](#L2139) |  |
| [2140](#L2140) | } |
| [2141](#L2141) |  |
| [2142](#L2142) | global $wpdb; |
| [2143](#L2143) | $subscribersSelectedEmails=$\_POST['ckboxs']; |
| [2144](#L2144) | $mass\_email\_queue=get\_option('mass\_email\_queue\_news\_subscriber'); |
| [2145](#L2145) | foreach($subscribersSelectedEmails as $em){ |
| [2146](#L2146) |  |
| [2147](#L2147) | $em=sanitize\_email($em); |
| [2148](#L2148) | if($em!=""){ |
| [2149](#L2149) |  |
| [2150](#L2150) | $query = "delete from  ".$wpdb->prefix."nl\_subscriptions where email='$em'"; |
| [2151](#L2151) | $wpdb->query($query); |
| [2152](#L2152) | if(is\_array($mass\_email\_queue)){ |
| [2153](#L2153) |  |
| [2154](#L2154) | $key=(int)array\_search($em,$mass\_email\_queue); |
| [2155](#L2155) | if(array\_search($em,$mass\_email\_queue)>=0){ |
| [2156](#L2156) |  |
| [2157](#L2157) | unset($mass\_email\_queue[$key]); |
| [2158](#L2158) | } |
| [2159](#L2159) | } |
| [2160](#L2160) | } |
| [2161](#L2161) |  |
| [2162](#L2162) | } |
| [2163](#L2163) |  |
| [2164](#L2164) | update\_option( 'mass\_email\_subscribers\_succ', \_\_( 'Selected subscribers deleted successfully.','email-subscribe') ); |
| [2165](#L2165) | update\_option('mass\_email\_queue\_news\_subscriber',$mass\_email\_queue); |
| [2166](#L2166) | echo "<script>location.href='".$referer."';</script>"; |
| [2167](#L2167) | exit; |
| [2168](#L2168) |  |
| [2169](#L2169) | } |
| [2170](#L2170) | else if(isset($\_POST['resetemailqueue'])){ |
| [2171](#L2171) |  |
| [2172](#L2172) | if ( !check\_admin\_referer( 'action\_settings\_add\_edit','queue\_and\_delete\_subsciber')){ |
| [2173](#L2173) |  |
| [2174](#L2174) | wp\_die('Security check fail'); |
| [2175](#L2175) | } |
| [2176](#L2176) | update\_option('mass\_email\_queue\_news\_subscriber',false); |
| [2177](#L2177) | update\_option( 'mass\_email\_subscribers\_succ', \_\_( 'Email queue reseted successfully.','email-subscribe')); |
| [2178](#L2178) | $setacrionpage='admin.php?page=email\_subscription\_popup\_subscribers\_management'; |
| [2179](#L2179) | echo "<script>location.href='".$setacrionpage."';</script>"; |
| [2180](#L2180) | exit; |
| [2181](#L2181) |  |
| [2182](#L2182) | } |
| [2183](#L2183) |  |
| [2184](#L2184) | if(isset($\_POST['sendEmailAll'])){ |
| [2185](#L2185) |  |
| [2186](#L2186) | global $wpdb; |
| [2187](#L2187) |  |
| [2188](#L2188) | if ( ! current\_user\_can( 'es\_email\_subscribe\_send\_email\_to\_all\_subscribers' ) ) { |
| [2189](#L2189) |  |
| [2190](#L2190) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [2191](#L2191) |  |
| [2192](#L2192) | } |
| [2193](#L2193) |  |
| [2194](#L2194) | $query="SELECT email as emails from ".$wpdb->prefix."nl\_subscriptions where is\_subscribed=1"; |
| [2195](#L2195) |  |
| [2196](#L2196) | $emails=$wpdb->get\_results($query,'OBJECT'); |
| [2197](#L2197) | $convertToString=''; |
| [2198](#L2198) | $count=0; |
| [2199](#L2199) | foreach($emails as $mail){ |
| [2200](#L2200) |  |
| [2201](#L2201) | $convertToString.=$mail->emails.",\n"; |
| [2202](#L2202) | $count++; |
| [2203](#L2203) | } |
| [2204](#L2204) | $convertToString=trim($convertToString,",\n"); |
| [2205](#L2205) |  |
| [2206](#L2206) | } |
| [2207](#L2207) | else{ |
| [2208](#L2208) | if(isset($\_POST['sendEmailQueue'])){ |
| [2209](#L2209) |  |
| [2210](#L2210) | if ( ! current\_user\_can( 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers' ) ) { |
| [2211](#L2211) |  |
| [2212](#L2212) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [2213](#L2213) |  |
| [2214](#L2214) | } |
| [2215](#L2215) | $convertToString=$\_POST['queueemails']; |
| [2216](#L2216) |  |
| [2217](#L2217) | } |
| [2218](#L2218) | else{ |
| [2219](#L2219) |  |
| [2220](#L2220) | if ( ! current\_user\_can( 'es\_email\_subscribe\_send\_email\_to\_selected\_subscribers' ) ) { |
| [2221](#L2221) |  |
| [2222](#L2222) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [2223](#L2223) |  |
| [2224](#L2224) | } |
| [2225](#L2225) | $subscribersSelectedEmails=$\_POST['ckboxs']; |
| [2226](#L2226) | $convertToString=implode(",\n",$subscribersSelectedEmails); |
| [2227](#L2227) | } |
| [2228](#L2228) | } |
| [2229](#L2229) | ?> |
| [2230](#L2230) |  |
| [2231](#L2231) | <table><tr><td> |
| [2232](#L2232) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [2233](#L2233) | <div id="fb-root"></div> |
| [2234](#L2234) | <script>(function(d, s, id) { |
| [2235](#L2235) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [2236](#L2236) | if (d.getElementById(id)) return; |
| [2237](#L2237) | js = d.createElement(s); js.id = id; |
| [2238](#L2238) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [2239](#L2239) | fjs.parentNode.insertBefore(js, fjs); |
| [2240](#L2240) | }(document, 'script', 'facebook-jssdk'));</script> |
| [2241](#L2241) | </td> |
| [2242](#L2242) | <td> |
| [2243](#L2243) | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [2244](#L2244) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [2245](#L2245) | </a> |
| [2246](#L2246) | </td> |
| [2247](#L2247) | </tr> |
| [2248](#L2248) | </table> |
| [2249](#L2249) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/">UPGRADE TO PRO VERSION</a></h3></span> |
| [2250](#L2250) |  |
| [2251](#L2251) | <h3><?php echo \_\_( 'Send Email To Newsletter Subscribers','email-subscribe');?> </h3> |
| [2252](#L2252) | <?php  $url = plugin\_dir\_url(\_\_FILE\_\_);?> |
| [2253](#L2253) | <form name="frmSendEmailsToUserSend" id='frmSendEmailsToUserSend' method="post" action="" > |
| [2254](#L2254) | <input type="hidden" value="sendEmailSend" name="action"> |
| [2255](#L2255) | <?php wp\_nonce\_field('action\_settings\_add\_edit','sendEmailSend'); ?> |
| [2256](#L2256) | <input type="hidden" value="<?php echo @$entrant; ?>" name="entrant"> |
| [2257](#L2257) | <input type="hidden" value="<?php echo @$setPerPage; ?>" name="setPerPage"> |
| [2258](#L2258) | <input type="hidden" value="<?php echo @$searchuser; ?>" name="searchuser"> |
| [2259](#L2259) | <table class="form-table" style="width:100%" > |
| [2260](#L2260) | <tbody> |
| [2261](#L2261) |  |
| [2262](#L2262) | <tr valign="top" id="subject"> |
| [2263](#L2263) | <th scope="row" style="width:30%;text-align: right;"><?php echo \_\_( 'Subject','email-subscribe');?> \*</th> |
| [2264](#L2264) | <td> |
| [2265](#L2265) | <input type="text" id="email\_subject" name="email\_subject"  class="valid" size="70"> |
| [2266](#L2266) | <div style="clear: both;"></div><div></div> |
| [2267](#L2267) | </td> |
| [2268](#L2268) | </tr> |
| [2269](#L2269) | <tr valign="top" id="subject"> |
| [2270](#L2270) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_( 'Email From Name','email-subscribe');?> \*</th> |
| [2271](#L2271) | <td> |
| [2272](#L2272) | <input type="text" id="email\_From\_name" name="email\_From\_name"  class="valid" size="70"> |
| [2273](#L2273) | <br/><?php echo  \_\_( '(ex. admin)','email-subscribe');?> |
| [2274](#L2274) | <div style="clear: both;"></div><div></div> |
| [2275](#L2275) |  |
| [2276](#L2276) | </td> |
| [2277](#L2277) | </tr> |
| [2278](#L2278) | <tr valign="top" id="subject"> |
| [2279](#L2279) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_( 'Email From','email-subscribe');?> \*</th> |
| [2280](#L2280) | <td> |
| [2281](#L2281) | <input type="text" id="email\_From" name="email\_From"  class="valid" size="70"> |
| [2282](#L2282) | <br/><?php echo  \_\_( '(ex. admin@yoursite.com) ','email-subscribe');?> |
| [2283](#L2283) | <div style="clear: both;"></div><div></div> |
| [2284](#L2284) |  |
| [2285](#L2285) | </td> |
| [2286](#L2286) | </tr> |
| [2287](#L2287) | <tr valign="top" id="subject"> |
| [2288](#L2288) | <th scope="row" style="width:30%;text-align: right"><?php echo  \_\_( 'Email To','email-subscribe');?> \*</th> |
| [2289](#L2289) | <td> |
| [2290](#L2290) | <textarea id='emailTo'  name="emailTo" cols="58" rows="4"><?php echo $convertToString;?></textarea> |
| [2291](#L2291) | <div style="clear: both;"></div><div></div> |
| [2292](#L2292) | </td> |
| [2293](#L2293) | </tr> |
| [2294](#L2294) | <tr valign="top" id="subject"> |
| [2295](#L2295) | <th scope="row" style="width:30%;text-align: right"><?php echo \_\_( 'Email Body','email-subscribe');?> \*</th> |
| [2296](#L2296) | <td> |
| [2297](#L2297) | <div class="wrap"> |
| [2298](#L2298) | <?php wp\_editor( '', 'txtArea' );?> |
| [2299](#L2299) | <input type="hidden" name="editor\_val" id="editor\_val" /> |
| [2300](#L2300) | <div style="clear: both;"></div><div></div> |
| [2301](#L2301) | <?php echo \_\_( 'you can use [user\_full\_name],[user\_email],[unsubscribe\_link\_plain],[unsubscribe\_link\_html] place holder into email content','email-subscribe');?> |
| [2302](#L2302) | </div> |
| [2303](#L2303) | </td> |
| [2304](#L2304) | </tr> |
| [2305](#L2305) |  |
| [2306](#L2306) | <tr valign="top" id="subject"> |
| [2307](#L2307) | <th scope="row" style="width:30%"></th> |
| [2308](#L2308) | <td> |
| [2309](#L2309) |  |
| [2310](#L2310) | <input type='submit'  value='<?php echo \_\_( 'Send Email','email-subscribe');?>' name='sendEmailsend' class='button-primary' id='sendEmailsend' > |
| [2311](#L2311) | </td> |
| [2312](#L2312) | </tr> |
| [2313](#L2313) |  |
| [2314](#L2314) | </table> |
| [2315](#L2315) | </form> |
| [2316](#L2316) | <script type="text/javascript"> |
| [2317](#L2317) |  |
| [2318](#L2318) |  |
| [2319](#L2319) | jQuery(document).ready(function() { |
| [2320](#L2320) |  |
| [2321](#L2321) | jQuery.validator.addMethod("chkCont", function(value, element) { |
| [2322](#L2322) |  |
| [2323](#L2323) |  |
| [2324](#L2324) |  |
| [2325](#L2325) | var editorcontent=tinyMCE.get('txtArea').getContent(); |
| [2326](#L2326) |  |
| [2327](#L2327) | if (editorcontent.length){ |
| [2328](#L2328) | return true; |
| [2329](#L2329) | } |
| [2330](#L2330) | else{ |
| [2331](#L2331) | return false; |
| [2332](#L2332) | } |
| [2333](#L2333) |  |
| [2334](#L2334) |  |
| [2335](#L2335) | }, |
| [2336](#L2336) | "Please enter email content" |
| [2337](#L2337) | ); |
| [2338](#L2338) |  |
| [2339](#L2339) | jQuery("#frmSendEmailsToUserSend").validate({ |
| [2340](#L2340) | errorClass: "error\_admin\_massemail", |
| [2341](#L2341) | rules: { |
| [2342](#L2342) | email\_subject: { |
| [2343](#L2343) | required: true |
| [2344](#L2344) | }, |
| [2345](#L2345) | email\_From\_name: { |
| [2346](#L2346) | required: true |
| [2347](#L2347) | }, |
| [2348](#L2348) | email\_From: { |
| [2349](#L2349) | required: true ,email:true |
| [2350](#L2350) | }, |
| [2351](#L2351) | emailTo:{ |
| [2352](#L2352) |  |
| [2353](#L2353) | required: true |
| [2354](#L2354) | }, |
| [2355](#L2355) | editor\_val:{ |
| [2356](#L2356) | chkCont: true |
| [2357](#L2357) | } |
| [2358](#L2358) |  |
| [2359](#L2359) | }, |
| [2360](#L2360) |  |
| [2361](#L2361) | errorPlacement: function(error, element) { |
| [2362](#L2362) | error.appendTo( element.next().next()); |
| [2363](#L2363) | } |
| [2364](#L2364) |  |
| [2365](#L2365) | }); |
| [2366](#L2366) |  |
| [2367](#L2367) |  |
| [2368](#L2368) | }); |
| [2369](#L2369) |  |
| [2370](#L2370) | </script> |
| [2371](#L2371) | <?php |
| [2372](#L2372) | break; |
| [2373](#L2373) | default: |
| [2374](#L2374) |  |
| [2375](#L2375) | if ( ! current\_user\_can( 'es\_email\_subscribe\_view\_subscribers' ) ) { |
| [2376](#L2376) |  |
| [2377](#L2377) | wp\_die( \_\_( "Access Denied", "email-subscribe",403 ) ); |
| [2378](#L2378) |  |
| [2379](#L2379) | } |
| [2380](#L2380) | $url = plugin\_dir\_url(\_\_FILE\_\_); |
| [2381](#L2381) | $url = str\_replace("\\","/",$url); |
| [2382](#L2382) | ?> |
| [2383](#L2383) | <div style="width: 100%;"> |
| [2384](#L2384) | <div style="float:left;width:65%;" > |
| [2385](#L2385) | <?php |
| [2386](#L2386) | global $wpdb; |
| [2387](#L2387) |  |
| [2388](#L2388) | $query="SELECT \* from ".$wpdb->prefix."nl\_subscriptions where is\_subscribed=1 "; |
| [2389](#L2389) | $queryCount="SELECT count(\*) from ".$wpdb->prefix."nl\_subscriptions where is\_subscribed=1 "; |
| [2390](#L2390) |  |
| [2391](#L2391) | if(isset($\_GET['searchuser']) and $\_GET['searchuser']!=''){ |
| [2392](#L2392) | $term=trim(urldecode(esc\_sql($\_GET['searchuser']))); |
| [2393](#L2393) | $query.="  and ( name like '%$term%' or email like '%$term%'  )  " ; |
| [2394](#L2394) | $queryCount.="  and ( name like '%$term%' or email like '%$term%'  )  " ; |
| [2395](#L2395) | } |
| [2396](#L2396) |  |
| [2397](#L2397) | $totalRecordForQuery=$wpdb->get\_var($queryCount); |
| [2398](#L2398) | $selfPage=wp\_get\_referer() .'?page=email\_subscription\_popup\_subscribers\_management'; |
| [2399](#L2399) | global $wp\_rewrite; |
| [2400](#L2400) |  |
| [2401](#L2401) | $rows\_per\_page = 10; |
| [2402](#L2402) | if(isset($\_GET['setPerPage']) and $\_GET['setPerPage']!=""){ |
| [2403](#L2403) |  |
| [2404](#L2404) | $rows\_per\_page=intval($\_GET['setPerPage']); |
| [2405](#L2405) | } |
| [2406](#L2406) |  |
| [2407](#L2407) | $current = (isset($\_GET['entrant'])) ? (intval($\_GET['entrant'])) : 1; |
| [2408](#L2408) | $pagination\_args = array( |
| [2409](#L2409) | 'base' => @add\_query\_arg('entrant','%#%'), |
| [2410](#L2410) | 'format' => '', |
| [2411](#L2411) | 'total' => ceil($totalRecordForQuery/$rows\_per\_page), |
| [2412](#L2412) | 'current' => $current, |
| [2413](#L2413) | 'show\_all' => false, |
| [2414](#L2414) | 'type' => 'plain', |
| [2415](#L2415) | ); |
| [2416](#L2416) |  |
| [2417](#L2417) |  |
| [2418](#L2418) | $selfpage=wp\_get\_referer() ; |
| [2419](#L2419) |  |
| [2420](#L2420) | if($totalRecordForQuery>0){ |
| [2421](#L2421) |  |
| [2422](#L2422) |  |
| [2423](#L2423) |  |
| [2424](#L2424) | ?> |
| [2425](#L2425) | <?php |
| [2426](#L2426) | $SuccMsg=get\_option('mass\_email\_subscribers\_succ'); |
| [2427](#L2427) | update\_option( 'mass\_email\_subscribers\_succ', '' ); |
| [2428](#L2428) |  |
| [2429](#L2429) | $errMsg=get\_option('mass\_email\_subscribers\_err'); |
| [2430](#L2430) | update\_option( 'mass\_email\_subscribers\_err', '' ); |
| [2431](#L2431) | ?> |
| [2432](#L2432) |  |
| [2433](#L2433) | <?php if($SuccMsg!=""){ echo "<div class='notice notice-success is-dismissible'><p>"; echo $SuccMsg; echo "</p></div>";$SuccMsg="";}?> |
| [2434](#L2434) | <?php if($errMsg!=""){ echo "<div class='notice notice-error is-dismissible' ></p>"; \_e($errMsg); echo "</p></div>";$errMsg="";}?> |
| [2435](#L2435) |  |
| [2436](#L2436) | <table><tr><td> |
| [2437](#L2437) | <div class="fb-like" data-href="https://www.facebook.com/i13websolution" data-layout="button" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div> |
| [2438](#L2438) | <div id="fb-root"></div> |
| [2439](#L2439) | <script>(function(d, s, id) { |
| [2440](#L2440) | var js, fjs = d.getElementsByTagName(s)[0]; |
| [2441](#L2441) | if (d.getElementById(id)) return; |
| [2442](#L2442) | js = d.createElement(s); js.id = id; |
| [2443](#L2443) | js.src = 'https://connect.facebook.net/en\_US/sdk.js#xfbml=1&version=v3.2&appId=158817690866061&autoLogAppEvents=1'; |
| [2444](#L2444) | fjs.parentNode.insertBefore(js, fjs); |
| [2445](#L2445) | }(document, 'script', 'facebook-jssdk'));</script> |
| [2446](#L2446) | </td> |
| [2447](#L2447) | <td> |
| [2448](#L2448) | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
| [2449](#L2449) | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
| [2450](#L2450) | </a> |
| [2451](#L2451) | </td> |
| [2452](#L2452) | </tr> |
| [2453](#L2453) | </table> |
| [2454](#L2454) | <span><h3 style="color: blue;"><a target="\_blank" href="https://www.i13websolution.com/product/wordpress-newsletter-subscription-pro-plugin/">UPGRADE TO PRO VERSION</a></h3></span> |
| [2455](#L2455) |  |
| [2456](#L2456) | <h3><?php echo \_\_( 'Send Email To Newsletter Subscribers','email-subscribe');?></h3> |
| [2457](#L2457) | <?php |
| [2458](#L2458) |  |
| [2459](#L2459) | $order\_by='name'; |
| [2460](#L2460) | $order\_pos="asc"; |
| [2461](#L2461) |  |
| [2462](#L2462) | $setacrionpage='admin.php?page=email\_subscription\_popup\_subscribers\_management'; |
| [2463](#L2463) |  |
| [2464](#L2464) | if(isset($\_GET['entrant']) and $\_GET['entrant']!=""){ |
| [2465](#L2465) | $setacrionpage.='&entrant='.intval($\_GET['entrant']); |
| [2466](#L2466) | } |
| [2467](#L2467) |  |
| [2468](#L2468) | if(isset($\_GET['setPerPage']) and $\_GET['setPerPage']!=""){ |
| [2469](#L2469) | $setacrionpage.='&setPerPage='.intval($\_GET['setPerPage']); |
| [2470](#L2470) | } |
| [2471](#L2471) |  |
| [2472](#L2472) | $seval=""; |
| [2473](#L2473) | if(isset($\_GET['searchuser']) and $\_GET['searchuser']!=""){ |
| [2474](#L2474) | $seval=sanitize\_text\_field($\_GET['searchuser']); |
| [2475](#L2475) | } |
| [2476](#L2476) |  |
| [2477](#L2477) | $search\_term\_=''; |
| [2478](#L2478) | if(isset($\_GET['searchuser'])){ |
| [2479](#L2479) |  |
| [2480](#L2480) | $search\_term\_='&searchuser='.urlencode(sanitize\_text\_field($\_GET['searchuser'])); |
| [2481](#L2481) | } |
| [2482](#L2482) |  |
| [2483](#L2483) | if(isset($\_GET['order\_by'])){ |
| [2484](#L2484) |  |
| [2485](#L2485) | $order\_by=trim($\_GET['order\_by']); |
| [2486](#L2486) | } |
| [2487](#L2487) |  |
| [2488](#L2488) | if(isset($\_GET['order\_pos'])){ |
| [2489](#L2489) |  |
| [2490](#L2490) | $order\_pos=trim($\_GET['order\_pos']); |
| [2491](#L2491) | } |
| [2492](#L2492) |  |
| [2493](#L2493) | $order\_by=sanitize\_text\_field(sanitize\_sql\_orderby($order\_by)); |
| [2494](#L2494) | $order\_pos=sanitize\_text\_field(sanitize\_sql\_orderby($order\_pos)); |
| [2495](#L2495) | $setacrionpage=esc\_html($setacrionpage); |
| [2496](#L2496) | ?> |
| [2497](#L2497) | <div style="padding-top:5px;padding-bottom:5px"><b><?php echo \_\_( 'Search User','email-subscribe');?> : </b><input type="text" value="<?php echo $seval;?>" id="searchuser" name="searchuser">&nbsp;<input type='submit'  value='<?php echo \_\_( 'Search Subscribers','email-subscribe');?>' name='searchusrsubmit' class='button-primary' id='searchusrsubmit' onclick="SearchredirectTO();" >&nbsp;<input type='submit'  value='<?php echo \_\_( 'Reset Search','email-subscribe');?>' name='searchreset' class='button-primary' id='searchreset' onclick="ResetSearch();" ></div> |
| [2498](#L2498) | <script type="text/javascript" > |
| [2499](#L2499) | function SearchredirectTO(){ |
| [2500](#L2500) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [2501](#L2501) | var searchval=jQuery('#searchuser').val(); |
| [2502](#L2502) | redirectto=redirectto+'&searchuser='+jQuery.trim(encodeURIComponent(searchval))+'&entrant=1'; |
| [2503](#L2503) | window.location.href=redirectto; |
| [2504](#L2504) | } |
| [2505](#L2505) | function ResetSearch(){ |
| [2506](#L2506) |  |
| [2507](#L2507) | var redirectto='<?php echo $setacrionpage; ?>'; |
| [2508](#L2508) | window.location.href=redirectto; |
| [2509](#L2509) | exit; |
| [2510](#L2510) | } |
| [2511](#L2511) | </script> |
| [2512](#L2512) | <form method="post" action="" id="sendemail" name="sendemail"> |
| [2513](#L2513) | <input type="hidden" value="sendEmailForm" name="action" id="action"> |
| [2514](#L2514) |  |
| [2515](#L2515) | <table class="widefat fixed" cellspacing="0" style="width:97% !important" > |
| [2516](#L2516) | <thead> |
| [2517](#L2517) | <tr> |
| [2518](#L2518) | <?php if($order\_by=="email" and $order\_pos=="asc"):?> |
| [2519](#L2519) |  |
| [2520](#L2520) | <th> |
| [2521](#L2521) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [2522](#L2522) | <a href="<?php echo $setacrionpage;?>&order\_by=email&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Email','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a> |
| [2523](#L2523) | </th> |
| [2524](#L2524) | <?php else:?> |
| [2525](#L2525) | <?php if($order\_by=="email"):?> |
| [2526](#L2526) | <th> |
| [2527](#L2527) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [2528](#L2528) | <a href="<?php echo $setacrionpage;?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Email','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a> |
| [2529](#L2529) | </th> |
| [2530](#L2530) | <?php else:?> |
| [2531](#L2531) | <th> |
| [2532](#L2532) | <input onclick="chkAll(this)" type="checkbox" name="chkallHeader" id='chkallHeader'>&nbsp; |
| [2533](#L2533) | <a href="<?php echo $setacrionpage;?>&order\_by=email&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Email','email-subscribe');?></a> |
| [2534](#L2534) | </th> |
| [2535](#L2535) | <?php endif;?> |
| [2536](#L2536) | <?php endif;?> |
| [2537](#L2537) |  |
| [2538](#L2538) | <?php if($order\_by=="name" and $order\_pos=="asc"):?> |
| [2539](#L2539) | <th><a href="<?php echo $setacrionpage;?>&order\_by=name&order\_pos=desc<?php echo $search\_term\_;?>"><?php echo \_\_('Name','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/desc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [2540](#L2540) | <?php else:?> |
| [2541](#L2541) | <?php if($order\_by=="name"):?> |
| [2542](#L2542) | <th><a href="<?php echo $setacrionpage;?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Name','email-subscribe');?><img style="vertical-align:middle" src="<?php echo plugins\_url('/images/asc.png', \_\_FILE\_\_); ?>"/></a></th> |
| [2543](#L2543) | <?php else:?> |
| [2544](#L2544) | <th><a href="<?php echo $setacrionpage;?>&order\_by=name&order\_pos=asc<?php echo $search\_term\_;?>"><?php echo \_\_('Name','email-subscribe');?></a></th> |
| [2545](#L2545) | <?php endif;?> |
| [2546](#L2546) | <?php endif;?> |
| [2547](#L2547) |  |
| [2548](#L2548) |  |
| [2549](#L2549) | </tr> |
| [2550](#L2550) | </thead> |
| [2551](#L2551) |  |
| [2552](#L2552) | <tfoot> |
| [2553](#L2553) | <tr> |
| [2554](#L2554) | <th scope="col" id="name" class="manage-column column-name" style=""><input onclick="chkAll(this)" type="checkbox" name="chkallfooter" id='chkallfooter'>&nbsp;<?php  echo \_\_( 'Select All Emails','email-subscribe');?></th> |
| [2555](#L2555) | <th scope="col" id="name" class="manage-column column-name" style=""><?php  echo \_\_( 'Name','email-subscribe');?></th> |
| [2556](#L2556) |  |
| [2557](#L2557) |  |
| [2558](#L2558) | </tr> |
| [2559](#L2559) | </tfoot> |
| [2560](#L2560) |  |
| [2561](#L2561) | <tbody id="the-list" class="list:cat"> |
| [2562](#L2562) | <?php |
| [2563](#L2563) | $mass\_email\_queue=array(); |
| [2564](#L2564) | if(get\_option('mass\_email\_queue\_news\_subscriber')!=false and is\_array(get\_option('mass\_email\_queue\_news\_subscriber'))) |
| [2565](#L2565) | $mass\_email\_queue=get\_option('mass\_email\_queue\_news\_subscriber'); |
| [2566](#L2566) |  |
| [2567](#L2567) | $offset = ($current - 1) \* $rows\_per\_page; |
| [2568](#L2568) | $query.=" order by $order\_by $order\_pos"; |
| [2569](#L2569) | $query.=" limit $offset, $rows\_per\_page"; |
| [2570](#L2570) | $emails=$wpdb->get\_results($query,ARRAY\_A); |
| [2571](#L2571) |  |
| [2572](#L2572) | foreach ( $emails as $vemail) |
| [2573](#L2573) | { |
| [2574](#L2574) |  |
| [2575](#L2575) | if($vemail!=null){ |
| [2576](#L2576) |  |
| [2577](#L2577) | $userId=$vemail['id']; |
| [2578](#L2578) | $name=$vemail['name']; |
| [2579](#L2579) | $email=sanitize\_email($vemail['email']); |
| [2580](#L2580) |  |
| [2581](#L2581) | if(in\_array($email,$mass\_email\_queue)) |
| [2582](#L2582) | $checked="checked='checked'"; |
| [2583](#L2583) | else |
| [2584](#L2584) | $checked=""; |
| [2585](#L2585) |  |
| [2586](#L2586) |  |
| [2587](#L2587) | echo"<tr class='iedit alternate'> |
| [2588](#L2588) | <td  class='name column-name' style='border:1px solid #DBDBDB;padding-left:13px;'><input type='checkBox' name='ckboxs[]' $checked  value='".$email."'>&nbsp;".$email."</td>"; |
| [2589](#L2589) | echo "<td  class='name column-name' style='border:1px solid #DBDBDB;'> ".stripslashes($name)."</td>"; |
| [2590](#L2590) | echo "</tr>"; |
| [2591](#L2591) | } |
| [2592](#L2592) |  |
| [2593](#L2593) | } |
| [2594](#L2594) |  |
| [2595](#L2595) | ?> |
| [2596](#L2596) | </tbody> |
| [2597](#L2597) | </table> |
| [2598](#L2598) | <table> |
| [2599](#L2599) | <tr> |
| [2600](#L2600) | <td> |
| [2601](#L2601) | <?php |
| [2602](#L2602) | if($totalRecordForQuery>0){ |
| [2603](#L2603) | echo "<div class='pagination' style='padding-top:10px'>"; |
| [2604](#L2604) | echo paginate\_links($pagination\_args); |
| [2605](#L2605) | echo "</div>"; |
| [2606](#L2606) | } |
| [2607](#L2607) |  |
| [2608](#L2608) | ?> |
| [2609](#L2609) |  |
| [2610](#L2610) | </td> |
| [2611](#L2611) | <td> |
| [2612](#L2612) | <b>&nbsp;&nbsp;<?php echo \_\_( 'Per Page :','email-subscribe');?> </b> |
| [2613](#L2613) | <?php |
| [2614](#L2614) | $setPerPageadmin='admin.php?page=email\_subscription\_popup\_subscribers\_management'; |
| [2615](#L2615) | /\*if(isset($\_GET['entrant']) and $\_GET['entrant']!=""){ |
| [2616](#L2616) | $setPerPageadmin.='&entrant='.(int)trim($\_GET['entrant']); |
| [2617](#L2617) | }\*/ |
| [2618](#L2618) | $setPerPageadmin.='&setPerPage='; |
| [2619](#L2619) | ?> |
| [2620](#L2620) | <select name="setPerPage" onchange="document.location.href='<?php echo $setPerPageadmin;?>' + this.options[this.selectedIndex].value + ''"> |
| [2621](#L2621) | <option <?php if($rows\_per\_page=="10"): ?>selected="selected"<?php endif;?>  value="10">10</option> |
| [2622](#L2622) | <option <?php if($rows\_per\_page=="20"): ?>selected="selected"<?php endif;?> value="20">20</option> |
| [2623](#L2623) | <option <?php if($rows\_per\_page=="30"): ?>selected="selected"<?php endif;?>value="30">30</option> |
| [2624](#L2624) | <option <?php if($rows\_per\_page=="40"): ?>selected="selected"<?php endif;?> value="40">40</option> |
| [2625](#L2625) | <option <?php if($rows\_per\_page=="50"): ?>selected="selected"<?php endif;?> value="50">50</option> |
| [2626](#L2626) | <option <?php if($rows\_per\_page=="60"): ?>selected="selected"<?php endif;?> value="60">60</option> |
| [2627](#L2627) | <option <?php if($rows\_per\_page=="70"): ?>selected="selected"<?php endif;?> value="70">70</option> |
| [2628](#L2628) | <option <?php if($rows\_per\_page=="80"): ?>selected="selected"<?php endif;?> value="80">80</option> |
| [2629](#L2629) | <option <?php if($rows\_per\_page=="90"): ?>selected="selected"<?php endif;?> value="90">90</option> |
| [2630](#L2630) | <option <?php if($rows\_per\_page=="100"): ?>selected="selected"<?php endif;?> value="100">100</option> |
| [2631](#L2631) | <option <?php if($rows\_per\_page=="500"): ?>selected="selected"<?php endif;?> value="500">500</option> |
| [2632](#L2632) | <option <?php if($rows\_per\_page=="1000"): ?>selected="selected"<?php endif;?> value="1000">1000</option> |
| [2633](#L2633) | <option <?php if($rows\_per\_page=="2000"): ?>selected="selected"<?php endif;?> value="2000">2000</option> |
| [2634](#L2634) | <option <?php if($rows\_per\_page=="3000"): ?>selected="selected"<?php endif;?> value="3000">3000</option> |
| [2635](#L2635) | <option <?php if($rows\_per\_page=="4000"): ?>selected="selected"<?php endif;?> value="4000">4000</option> |
| [2636](#L2636) | <option <?php if($rows\_per\_page=="5000"): ?>selected="selected"<?php endif;?> value="5000">5000</option> |
| [2637](#L2637) | </select> |
| [2638](#L2638) | </td> |
| [2639](#L2639) | </tr> |
| [2640](#L2640) | </table> |
| [2641](#L2641) | <table> |
| [2642](#L2642) | <tr> |
| [2643](#L2643) | <td class='name column-name' style='padding-top:15px;padding-left:10px;'> |
| [2644](#L2644) |  |
| [2645](#L2645) | <script type="text/javascript"> |
| [2646](#L2646) | function sendEmailToAll(obj){ |
| [2647](#L2647) |  |
| [2648](#L2648) | var txt; |
| [2649](#L2649) | var r = confirm("<?php echo \_\_( 'It is not recommaded to send email to all at once as there is always hosting server limit for send emails hourly basis. Most of hosting providers allow 250 emails per hour. Please upgrade to pro version and use cron job newsletter to send email automatically. Do you still want to continue ?','email-subscribe');?>"); |
| [2650](#L2650) | if (r == true) { |
| [2651](#L2651) | return true; |
| [2652](#L2652) | } else { |
| [2653](#L2653) | return false; |
| [2654](#L2654) | } |
| [2655](#L2655) |  |
| [2656](#L2656) |  |
| [2657](#L2657) | } |
| [2658](#L2658) | </script> |
| [2659](#L2659) | <?php wp\_nonce\_field('action\_settings\_add\_edit','queue\_and\_delete\_subsciber'); ?> |
| [2660](#L2660) | <input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_( 'Send Email To Selected Subscribers','email-subscribe');?>' name='sendEmail' class='button-primary' id='sendEmail' >&nbsp;<input onclick="return sendEmailToAll(this)" type='submit' value='<?php echo \_\_( 'Send Email To All Subscribers','email-subscribe');?>' name='sendEmailAll' class='button-primary' id='sendEmailAll' >&nbsp;<input onclick="return validateSendEmailAndDeleteEmail(this)" type='submit' value='<?php echo \_\_( 'Delete Selected Subscribers','email-subscribe');?>' name='deleteEmails' class='button-primary' id='deleteEmails' ></td> |
| [2661](#L2661) | </tr> |
| [2662](#L2662) |  |
| [2663](#L2663) | <?php |
| [2664](#L2664) | $mass\_email\_queue=get\_option('mass\_email\_queue\_news\_subscriber'); |
| [2665](#L2665) | if($mass\_email\_queue!=false and $mass\_email\_queue!=null ){ |
| [2666](#L2666) | if(is\_array($mass\_email\_queue)){ ?> |
| [2667](#L2667) | <tr> |
| [2668](#L2668) | <td> |
| [2669](#L2669) | <h3><?php echo \_\_( 'Emails In Queue','email-subscribe');?></h3> |
| [2670](#L2670) | <textarea readonly="readonly" name="queueemails" id="queueemails" cols="70" rows="10"><?php |
| [2671](#L2671) | foreach($mass\_email\_queue as $email\_){ |
| [2672](#L2672) | echo "$email\_".",\n"; |
| [2673](#L2673) | } |
| [2674](#L2674) | ?></textarea> |
| [2675](#L2675) | <br/> |
| [2676](#L2676) | <input type="hidden" name="uncheckedemails" id="uncheckedemails" value=""> |
| [2677](#L2677) | <input  type='submit' value='<?php echo \_\_( 'Send Email To Subscribers In Queue','email-subscribe');?>' name='sendEmailQueue' class='button-primary' id='sendEmailQueue' >&nbsp;<input  type='submit' value='<?php echo \_\_( 'Reset Email Queue','email-subscribe');?>' name='resetemailqueue' class='button-primary' id='resetemailqueue' > |
| [2678](#L2678) | </td> |
| [2679](#L2679) | </tr> |
| [2680](#L2680) | <?php } |
| [2681](#L2681) | } |
| [2682](#L2682) | ?> |
| [2683](#L2683) | </table> |
| [2684](#L2684) | </form> |
| [2685](#L2685) |  |
| [2686](#L2686) |  |
| [2687](#L2687) | <?php |
| [2688](#L2688) |  |
| [2689](#L2689) | } |
| [2690](#L2690) | else |
| [2691](#L2691) | { |
| [2692](#L2692) | echo '<center><div style="padding-bottom:50pxpadding-top:50px;"><h3>'.\_\_( 'No Email Subscription Found','email-subscribe').'</h3></div></center>'; |
| [2693](#L2693) |  |
| [2694](#L2694) | //echo '<center><div style="padding-bottom:50pxpadding-top:50px;"><h3><a href="admin.php?page=email\_subscription\_popup\_subscribers\_management">Click Here To Continue..</a></h3></div></center>'; |
| [2695](#L2695) | ?> |
| [2696](#L2696) | <?php |
| [2697](#L2697) | $exportUrl=plugin\_dir\_url(\_\_FILE\_\_); |
| [2698](#L2698) | $exportUrl.='export\_subscribers.php'; |
| [2699](#L2699) | $importUrl = admin\_url( 'admin.php?page=email\_subscription\_popup\_subscribers\_management&action=importform' ); |
| [2700](#L2700) | $subscriberUlr = admin\_url( 'admin.php?page=email\_subscription\_popup\_subscribers\_management' ); |
| [2701](#L2701) | ?> |
| [2702](#L2702) |  |
| [2703](#L2703) | <?php |
| [2704](#L2704) | } |
| [2705](#L2705) | ?> |
| [2706](#L2706) | </div> |
| [2707](#L2707) | <div id="postbox-container-1" class="postbox-container" style="float:right;width:35%;margin-top: 50px" > |
| [2708](#L2708) |  |
| [2709](#L2709) | <div class="postbox"> |
| [2710](#L2710) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Access All Themes In One Price','email-subscribe');?></h3> </center> |
| [2711](#L2711) | <div class="inside"> |
| [2712](#L2712) | <center><a href="https://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715&url=80806" target="\_blank"><img border="0" src="<?php echo plugins\_url( 'images/divi\_300x250.jpg', \_\_FILE\_\_ ) ;?>" width="250" height="250"></a></center> |
| [2713](#L2713) |  |
| [2714](#L2714) | <div style="margin:10px 5px"> |
| [2715](#L2715) |  |
| [2716](#L2716) | </div> |
| [2717](#L2717) | </div></div> |
| [2718](#L2718) | <div class="postbox"> |
| [2719](#L2719) | <center><h3 class="hndle"><span></span><?php echo \_\_( 'Google For Business','email-subscribe');?></h3> </center> |
| [2720](#L2720) | <div class="inside"> |
| [2721](#L2721) | <center><a target="\_blank" href="https://goo.gl/OJBuHT"><img style="max-width:350px" src="<?php echo plugins\_url( 'images/g-suite-promo-code-4.png', \_\_FILE\_\_ ) ;?>" width="" height="250" border="0"></a></center> |
| [2722](#L2722) | <div style="margin:10px 5px"> |
| [2723](#L2723) | </div> |
| [2724](#L2724) | </div></div> |
| [2725](#L2725) |  |
| [2726](#L2726) | </div> |
| [2727](#L2727) | <div class="clear"> |
| [2728](#L2728) | </div> |
| [2729](#L2729) |  |
| [2730](#L2730) | <?php |
| [2731](#L2731) | break; |
| [2732](#L2732) |  |
| [2733](#L2733) | } |
| [2734](#L2734) |  |
| [2735](#L2735) | ?> |
| [2736](#L2736) | <script type="text/javascript" > |
| [2737](#L2737) |  |
| [2738](#L2738) | jQuery("input[name='ckboxs[]']").click(function() { |
| [2739](#L2739) | uncheckedmanagement(this); |
| [2740](#L2740) |  |
| [2741](#L2741) | }); |
| [2742](#L2742) |  |
| [2743](#L2743) | function uncheckedmanagement(elementset){ |
| [2744](#L2744) |  |
| [2745](#L2745) | //alert(jQuery(this).is(':checked')); |
| [2746](#L2746) |  |
| [2747](#L2747) | if(jQuery("#uncheckedemails").length>0){ |
| [2748](#L2748) | var hiddenvals=jQuery("#uncheckedemails").val(); |
| [2749](#L2749) | } |
| [2750](#L2750) | else |
| [2751](#L2751) | hiddenvals="|||"; |
| [2752](#L2752) |  |
| [2753](#L2753) | var emailval=jQuery(elementset).val(); |
| [2754](#L2754) | var emailsUn= hiddenvals.split('|||'); |
| [2755](#L2755) |  |
| [2756](#L2756) | if(jQuery(elementset).is(':checked')){ |
| [2757](#L2757) |  |
| [2758](#L2758) | if(jQuery.isArray(emailsUn)==true){ |
| [2759](#L2759) |  |
| [2760](#L2760) | emailsUn.splice(jQuery.inArray(emailval, emailsUn),1); |
| [2761](#L2761) | var strconvert=emailsUn.join('|||'); |
| [2762](#L2762) | jQuery("#uncheckedemails").val(strconvert); |
| [2763](#L2763) | } |
| [2764](#L2764) | else{ |
| [2765](#L2765) |  |
| [2766](#L2766) | var addtohidden=emailval.toString()+'|||'; |
| [2767](#L2767) | jQuery("#uncheckedemails").val(addtohidden); |
| [2768](#L2768) | } |
| [2769](#L2769) |  |
| [2770](#L2770) | } |
| [2771](#L2771) | else{ |
| [2772](#L2772) |  |
| [2773](#L2773) | if(jQuery.isArray(emailsUn)==true){ |
| [2774](#L2774) |  |
| [2775](#L2775) | if(jQuery.inArray(emailval, emailsUn)<=0){ |
| [2776](#L2776) | emailsUn.push(emailval); |
| [2777](#L2777) | var strconvert=emailsUn.join('|||'); |
| [2778](#L2778) | jQuery("#uncheckedemails").val(strconvert); |
| [2779](#L2779) | } |
| [2780](#L2780) |  |
| [2781](#L2781) | } |
| [2782](#L2782) | else{ |
| [2783](#L2783) | var addtohidden=emailval.toString()+'|||'; |
| [2784](#L2784) | jQuery("#uncheckedemails").val(addtohidden); |
| [2785](#L2785) |  |
| [2786](#L2786) | } |
| [2787](#L2787) | } |
| [2788](#L2788) |  |
| [2789](#L2789) |  |
| [2790](#L2790) | } |
| [2791](#L2791) |  |
| [2792](#L2792) | function chkAll(id){ |
| [2793](#L2793) |  |
| [2794](#L2794) | if(id.name=='chkallfooter'){ |
| [2795](#L2795) |  |
| [2796](#L2796) | var chlOrnot=id.checked; |
| [2797](#L2797) | document.getElementById('chkallHeader').checked= chlOrnot; |
| [2798](#L2798) |  |
| [2799](#L2799) | } |
| [2800](#L2800) | else if(id.name=='chkallHeader'){ |
| [2801](#L2801) |  |
| [2802](#L2802) | var chlOrnot=id.checked; |
| [2803](#L2803) | document.getElementById('chkallfooter').checked= chlOrnot; |
| [2804](#L2804) |  |
| [2805](#L2805) | } |
| [2806](#L2806) |  |
| [2807](#L2807) | if(id.checked){ |
| [2808](#L2808) |  |
| [2809](#L2809) | var objs=document.getElementsByName("ckboxs[]"); |
| [2810](#L2810) |  |
| [2811](#L2811) | for(var i=0; i < objs.length; i++) |
| [2812](#L2812) | { |
| [2813](#L2813) | objs[i].checked=true; |
| [2814](#L2814) | uncheckedmanagement(objs[i]); |
| [2815](#L2815) | } |
| [2816](#L2816) |  |
| [2817](#L2817) |  |
| [2818](#L2818) | } |
| [2819](#L2819) | else { |
| [2820](#L2820) |  |
| [2821](#L2821) | var objs=document.getElementsByName("ckboxs[]"); |
| [2822](#L2822) |  |
| [2823](#L2823) | for(var i=0; i < objs.length; i++) |
| [2824](#L2824) | { |
| [2825](#L2825) | objs[i].checked=false; |
| [2826](#L2826) | uncheckedmanagement(objs[i]); |
| [2827](#L2827) | } |
| [2828](#L2828) | } |
| [2829](#L2829) | } |
| [2830](#L2830) |  |
| [2831](#L2831) | function validateSendEmailAndDeleteEmail(idobj){ |
| [2832](#L2832) |  |
| [2833](#L2833) | var objs=document.getElementsByName("ckboxs[]"); |
| [2834](#L2834) | var ischkBoxChecked=false; |
| [2835](#L2835) | for(var i=0; i < objs.length; i++){ |
| [2836](#L2836) | if(objs[i].checked==true){ |
| [2837](#L2837) |  |
| [2838](#L2838) | ischkBoxChecked=true; |
| [2839](#L2839) | break; |
| [2840](#L2840) | } |
| [2841](#L2841) |  |
| [2842](#L2842) | } |
| [2843](#L2843) |  |
| [2844](#L2844) | if(ischkBoxChecked==false) |
| [2845](#L2845) | { |
| [2846](#L2846) | if(idobj.name=='sendEmail' || idobj.name=='sendEmailqueue' || idobj.name=='exportSelected'){ |
| [2847](#L2847) | alert('<?php echo \_\_( 'Please select atleast one email.','email-subscribe');?>')  ; |
| [2848](#L2848) | return false; |
| [2849](#L2849) |  |
| [2850](#L2850) | } |
| [2851](#L2851) | else if(idobj.name=='deleteEmails') |
| [2852](#L2852) | { |
| [2853](#L2853) | alert('<?php echo \_\_( 'Please select atleast one email to delete.','email-subscribe');?>') |
| [2854](#L2854) | return false; |
| [2855](#L2855) | } |
| [2856](#L2856) | } |
| [2857](#L2857) | else{ |
| [2858](#L2858) | if(idobj.name=='deleteEmails') { |
| [2859](#L2859) |  |
| [2860](#L2860) | var r = confirm("<?php echo \_\_( 'Are you sure to delete selected subscribers?','email-subscribe');?>"); |
| [2861](#L2861) | if (r == true) { |
| [2862](#L2862) | return true; |
| [2863](#L2863) | }else{ |
| [2864](#L2864) |  |
| [2865](#L2865) | return false; |
| [2866](#L2866) | } |
| [2867](#L2867) |  |
| [2868](#L2868) | } |
| [2869](#L2869) |  |
| [2870](#L2870) | } |
| [2871](#L2871) |  |
| [2872](#L2872) | } |
| [2873](#L2873) |  |
| [2874](#L2874) | </script> |
| [2875](#L2875) |  |
| [2876](#L2876) | <?php |
| [2877](#L2877) |  |
| [2878](#L2878) | } |
| [2879](#L2879) |  |
| [2880](#L2880) | class nksnewslettersubscriber extends WP\_Widget { |
| [2881](#L2881) |  |
| [2882](#L2882) |  |
| [2883](#L2883) |  |
| [2884](#L2884) | function \_\_construct() { |
| [2885](#L2885) |  |
| [2886](#L2886) | $widget\_ops = array('classname' => 'nksnewslettersubscriber', 'description' => 'Nks WordPress Newsletter'); |
| [2887](#L2887) | parent::\_\_construct('nksnewslettersubscriber', 'Newsletter Subscribe',$widget\_ops); |
| [2888](#L2888) | } |
| [2889](#L2889) |  |
| [2890](#L2890) | function widget( $args, $instance ) { |
| [2891](#L2891) |  |
| [2892](#L2892) | if(is\_array($args)){ |
| [2893](#L2893) |  |
| [2894](#L2894) | extract( $args ); |
| [2895](#L2895) | } |
| [2896](#L2896) |  |
| [2897](#L2897) | $Heading = apply\_filters('widget\_title', empty( $instance['Heading'] ) ? 'Subscribe to our newsletter' :sanitize\_text\_field($instance['Heading'])); |
| [2898](#L2898) | include\_once(ABSPATH . WPINC . '/feed.php'); |
| [2899](#L2899) | echo @$before\_widget; |
| [2900](#L2900) | echo @$before\_title.$Heading.$after\_title; |
| [2901](#L2901) | $Subheading=empty( $instance['Subheading'] ) ? 'Want to be notified when our article is published? Enter your email address and name below to be the first to know.' :sanitize\_textarea\_field($instance['Subheading']); |
| [2902](#L2902) | $EmailLabel=empty( $instance['EmailLabel'] ) ? 'Email' :sanitize\_text\_field($instance['EmailLabel']); |
| [2903](#L2903) | $NameLabel=empty( $instance['NameLabel'] ) ? 'Name' :sanitize\_text\_field($instance['NameLabel']); |
| [2904](#L2904) | $SubmitButtonLabel=empty( $instance['SubmitButtonLabel'] ) ? 'SIGN UP FOR NEWSLETTER NOW' :sanitize\_text\_field($instance['SubmitButtonLabel']); |
| [2905](#L2905) | $RequiredFieldMessage=empty( $instance['RequiredFieldMessage'] ) ? 'This field is required.' :sanitize\_text\_field($instance['RequiredFieldMessage']); |
| [2906](#L2906) | $InvalidEmailMessage=empty( $instance['InvalidEmailMessage'] ) ? 'Please enter valid email address.' :sanitize\_text\_field($instance['InvalidEmailMessage']); |
| [2907](#L2907) | $InvalidRequestMessage=empty( $instance['InvalidRequestMessage'] ) ? 'Invalid request.' :sanitize\_text\_field($instance['InvalidRequestMessage']); |
| [2908](#L2908) | $EmailExistMessage=empty( $instance['EmailExistMessage'] ) ? 'This email is already exist.' :sanitize\_text\_field($instance['EmailExistMessage']); |
| [2909](#L2909) | $SuccessMessage=empty( $instance['SuccessMessage'] ) ? 'You have successfully subscribed to our Newsletter!' :sanitize\_text\_field($instance['SuccessMessage']); |
| [2910](#L2910) | $WaitMessage=empty( $instance['WaitMessage'] ) ? 'Please wait...' :sanitize\_text\_field($instance['WaitMessage']); |
| [2911](#L2911) | $ShowNameField=empty( $instance['ShowNameField'] ) ? 1 :intval($instance['ShowNameField']); |
| [2912](#L2912) | $show\_agreement=empty( $instance['show\_agreement'] ) ? 0 :intval($instance['show\_agreement']); |
| [2913](#L2913) | $agreement\_text=empty( $instance['agreement\_text'] ) ? 'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>' :$instance['agreement\_text']; |
| [2914](#L2914) | $agreement\_error=empty( $instance['agreement\_error'] ) ? 'Please read and agree to our terms & conditions.' :sanitize\_text\_field($instance['agreement\_error']); |
| [2915](#L2915) | $imgUrl=plugin\_dir\_url(\_\_FILE\_\_)."images/"; |
| [2916](#L2916) | $loader=$imgUrl.'AjaxLoader.gif'; |
| [2917](#L2917) | $rand=uniqid('filed\_'); |
| [2918](#L2918) | $rand\_func=uniqid('fun'); |
| [2919](#L2919) | $wp\_news\_letter\_settings=get\_option('wp\_news\_letter\_settings'); |
| [2920](#L2920) | $wp\_news\_letter\_settings=stripslashes\_deep($wp\_news\_letter\_settings); |
| [2921](#L2921) | ?> |
| [2922](#L2922) |  |
| [2923](#L2923) | <div class="<?php echo $rand;?>\_AjaxLoader ajaxLoaderWidget"  id="<?php echo $rand;?>\_AjaxLoader"><img src="<?php echo $loader;?>"/><?php echo $WaitMessage;?></div> |
| [2924](#L2924) | <div class="<?php echo $rand;?>\_myerror\_msg myerror\_msg" id="<?php echo $rand;?>\_myerror\_msg"></div> |
| [2925](#L2925) | <div class="<?php echo $rand;?>\_mysuccess\_msg mysuccess\_msg" id="<?php echo $rand;?>\_mysuccess\_msg"></div> |
| [2926](#L2926) | <div class="Nknewsletter\_description"><?php echo $Subheading;?></div> |
| [2927](#L2927) | <div class="Nknewsletter-widget"> |
| [2928](#L2928) | <input type="text" name="<?php echo $rand;?>\_youremail" id="<?php echo $rand;?>\_youremail" class="Nknewsletter\_email"  value="<?php echo $EmailLabel;?>" onfocus="return clearInput(this,'<?php echo $EmailLabel;?>');" onblur="restoreInput(this,'<?php echo $EmailLabel;?>')"/> |
| [2929](#L2929) | <div class="" id="<?php echo $rand;?>\_errorinput\_email"></div> |
| [2930](#L2930) |  |
| [2931](#L2931) | <?php if($ShowNameField=="1"):?> |
| [2932](#L2932) | <div class="Nknewsletter\_space" id="<?php echo $rand;?>\_name\_Nknewsletter\_space" ></div> |
| [2933](#L2933) | <input type="text" name="<?php echo $rand;?>\_yourname" id="<?php echo $rand;?>\_yourname" class="Nknewsletter\_name" value="<?php echo $NameLabel;?>" onfocus="return clearInput(this,'<?php echo $NameLabel;?>');" onblur="restoreInput(this,'<?php echo $NameLabel;?>')" /> |
| [2934](#L2934) | <div class="errorinput\_widget" id="<?php echo $rand;?>\_errorinput\_name"></div> |
| [2935](#L2935) | <div class="Nknewsletter\_space" id="<?php echo $rand;?>\_name\_Nknewsletter\_space" ></div> |
| [2936](#L2936) | <?php else:?> |
| [2937](#L2937) | <div class="Nknewsletter\_space" id="<?php echo $rand;?>\_name\_Nknewsletter\_space" ></div> |
| [2938](#L2938) | <?php endif;?> |
| [2939](#L2939) |  |
| [2940](#L2940) | <?php if($show\_agreement=="1"):?> |
| [2941](#L2941) | <input class="nk\_newsletter\_agree" style="display:inline-block" type="checkbox"  id="<?php echo $rand;?>\_agree" value="1" name="<?php echo $rand;?>\_agree" /><span class="nk\_newslteer\_agree\_term"> <?php echo html\_entity\_decode ($agreement\_text);?></span> |
| [2942](#L2942) | <div style="clear:both"></div> |
| [2943](#L2943) | <div class="errorinput\_widget" id="<?php echo $rand;?>\_errorinput\_agree"></div> |
| [2944](#L2944) |  |
| [2945](#L2945) | <?php else:?> |
| [2946](#L2946) | <div class="Nknewsletter\_space" id="<?php echo $rand;?>\_agree\_Nknewsletter\_space" ></div> |
| [2947](#L2947) | <?php endif;?> |
| [2948](#L2948) |  |
| [2949](#L2949) | <div class="Nknewsletter\_space" id="<?php echo $rand;?>submit\_space" ></div> |
| [2950](#L2950) | <input class="Nknewsletter\_space\_submit" type="submit" value="<?php echo $SubmitButtonLabel;?>" onclick="return <?php echo $rand\_func;?>\_submit\_newsletter();" name="<?php echo $rand;?>\_submit" /> |
| [2951](#L2951) | </div> |
| [2952](#L2952) | <script> |
| [2953](#L2953) |  |
| [2954](#L2954) | function <?php echo $rand\_func;?>\_submit\_newsletter(){ |
| [2955](#L2955) |  |
| [2956](#L2956) |  |
| [2957](#L2957) | var emailAdd=jQuery.trim(jQuery("#<?php echo $rand;?>\_youremail").val()); |
| [2958](#L2958) | var yourname=jQuery.trim(jQuery("#<?php echo $rand;?>\_yourname").val()); |
| [2959](#L2959) |  |
| [2960](#L2960) | var returnval=false; |
| [2961](#L2961) | var isvalidName=false; |
| [2962](#L2962) | var isvalidEmail=false; |
| [2963](#L2963) | var isagree=false; |
| [2964](#L2964) |  |
| [2965](#L2965) | if(jQuery("#<?php echo $rand;?>\_yourname").length >0){ |
| [2966](#L2966) |  |
| [2967](#L2967) |  |
| [2968](#L2968) | var yourname=jQuery.trim(jQuery("#<?php echo $rand;?>\_yourname").val()); |
| [2969](#L2969) |  |
| [2970](#L2970) | if(yourname!="" && yourname!=null && yourname.toLowerCase()!='<?php echo $NameLabel;?>'.toLowerCase()){ |
| [2971](#L2971) |  |
| [2972](#L2972) | var element=jQuery("#<?php echo $rand;?>\_yourname").next().next(); |
| [2973](#L2973) | isvalidName=true; |
| [2974](#L2974) | jQuery(element).html(''); |
| [2975](#L2975) | } |
| [2976](#L2976) | else{ |
| [2977](#L2977) | var element=jQuery("#<?php echo $rand;?>\_yourname").next().next(); |
| [2978](#L2978) | jQuery(element).html('<div class="image\_error"><?php echo $RequiredFieldMessage;?></div>'); |
| [2979](#L2979) | jQuery("#<?php echo $rand;?>\_name\_Nknewsletter\_space").css( { marginBottom : "20px" } ); |
| [2980](#L2980) | // emailAdd=false; |
| [2981](#L2981) |  |
| [2982](#L2982) | } |
| [2983](#L2983) |  |
| [2984](#L2984) |  |
| [2985](#L2985) | } |
| [2986](#L2986) | else{ |
| [2987](#L2987) | isvalidName=true; |
| [2988](#L2988) |  |
| [2989](#L2989) | } |
| [2990](#L2990) |  |
| [2991](#L2991) | if(jQuery("#<?php echo $rand;?>\_agree").length >0){ |
| [2992](#L2992) |  |
| [2993](#L2993) | if(jQuery("#<?php echo $rand;?>\_agree").is(':checked')){ |
| [2994](#L2994) |  |
| [2995](#L2995) | var element=jQuery("#<?php echo $rand;?>\_agree").next().next(); |
| [2996](#L2996) | jQuery(element).html(''); |
| [2997](#L2997) | isagree=true; |
| [2998](#L2998) | } |
| [2999](#L2999) | else{ |
| [3000](#L3000) |  |
| [3001](#L3001) |  |
| [3002](#L3002) | var element=jQuery("#<?php echo $rand;?>\_agree").next().next(); |
| [3003](#L3003) | jQuery(element).html('<div class="image\_error"><?php echo $agreement\_error;?></div>'); |
| [3004](#L3004) | jQuery("#<?php echo $rand;?>\_email\_Nknewsletter\_space").css( { marginBottom : "0px" } ); |
| [3005](#L3005) | isagree=false; |
| [3006](#L3006) |  |
| [3007](#L3007) | } |
| [3008](#L3008) | } |
| [3009](#L3009) | else{ |
| [3010](#L3010) |  |
| [3011](#L3011) | isagree=true; |
| [3012](#L3012) |  |
| [3013](#L3013) | } |
| [3014](#L3014) |  |
| [3015](#L3015) |  |
| [3016](#L3016) | if(emailAdd!=""){ |
| [3017](#L3017) |  |
| [3018](#L3018) |  |
| [3019](#L3019) | var element=jQuery("#<?php echo $rand;?>\_youremail").next().next(); |
| [3020](#L3020) | if(emailAdd.toLowerCase()=='<?php echo $EmailLabel;?>'.toLowerCase()){ |
| [3021](#L3021) |  |
| [3022](#L3022) | jQuery(element).html('<div  class="image\_error"><?php echo $RequiredFieldMessage;?></div>'); |
| [3023](#L3023) | isvalidEmail=false; |
| [3024](#L3024) |  |
| [3025](#L3025) | jQuery("#<?php echo $rand;?>\_email\_Nknewsletter\_space").css( { marginBottom : "0px" } ); |
| [3026](#L3026) |  |
| [3027](#L3027) | }else{ |
| [3028](#L3028) |  |
| [3029](#L3029) | var JsRegExPatern = /^\w+([-+.']\w+)\*@\w+([-.]\w+)\*\.\w+([-.]\w+)\*$/ |
| [3030](#L3030) | if(JsRegExPatern.test(emailAdd)){ |
| [3031](#L3031) |  |
| [3032](#L3032) | isvalidEmail=true; |
| [3033](#L3033) | jQuery("#<?php echo $rand;?>\_email\_Nknewsletter\_space").css( { marginBottom : "20px" } ); |
| [3034](#L3034) | jQuery(element).html(''); |
| [3035](#L3035) |  |
| [3036](#L3036) | }else{ |
| [3037](#L3037) |  |
| [3038](#L3038) | var element=jQuery("#<?php echo $rand;?>\_youremail").next().next(); |
| [3039](#L3039) | jQuery(element).html('<div class="image\_error"><?php echo $InvalidEmailMessage;?></div>'); |
| [3040](#L3040) | jQuery("#<?php echo $rand;?>\_email\_Nknewsletter\_space").css( { marginBottom : "0px" } ); |
| [3041](#L3041) | isvalidEmail=false; |
| [3042](#L3042) |  |
| [3043](#L3043) | } |
| [3044](#L3044) |  |
| [3045](#L3045) | } |
| [3046](#L3046) |  |
| [3047](#L3047) | }else{ |
| [3048](#L3048) |  |
| [3049](#L3049) | var element=jQuery("#<?php echo $rand;?>\_yourname").next().next(); |
| [3050](#L3050) | jQuery(element).html('<div class="image\_error"><?php echo $RequiredFieldMessage;?></div>'); |
| [3051](#L3051) | jQuery("#<?php echo $rand;?>\_email\_Nknewsletter\_space").css( { marginBottom : "0px" } ); |
| [3052](#L3052) | isvalidEmail=false; |
| [3053](#L3053) |  |
| [3054](#L3054) | } |
| [3055](#L3055) |  |
| [3056](#L3056) | if(isvalidName==true && isvalidEmail==true && isagree==true){ |
| [3057](#L3057) |  |
| [3058](#L3058) | jQuery("#<?php echo $rand;?>\_name\_Nknewsletter\_space").css( { marginBottom : "20px" } ); |
| [3059](#L3059) | jQuery("<?php echo $rand;?>\_email\_Nknewsletter\_space").css( { marginBottom : "20px" } ); |
| [3060](#L3060) |  |
| [3061](#L3061) | jQuery("#<?php echo $rand;?>\_AjaxLoader").show(); |
| [3062](#L3062) | jQuery('#<?php echo $rand;?>\_mysuccess\_msg').html(''); |
| [3063](#L3063) | jQuery('#<?php echo $rand;?>\_mysuccess\_msg').hide(); |
| [3064](#L3064) | jQuery('#<?php echo $rand;?>\_myerror\_msg').html(''); |
| [3065](#L3065) | jQuery('#<?php echo $rand;?>\_myerror\_msg').hide(); |
| [3066](#L3066) |  |
| [3067](#L3067) | var nonce ='<?php echo wp\_create\_nonce('newsletter-nonce'); ?>'; |
| [3068](#L3068) | var url = '<?php echo plugin\_dir\_url(\_\_FILE\_\_);?>'; |
| [3069](#L3069) | var email=jQuery("#<?php echo $rand;?>\_youremail").val(); |
| [3070](#L3070) | var name=""; |
| [3071](#L3071) | if(jQuery("#<?php echo $rand;?>\_yourname").length >0){ |
| [3072](#L3072) |  |
| [3073](#L3073) | name =jQuery("#<?php echo $rand;?>\_yourname").val(); |
| [3074](#L3074) | } |
| [3075](#L3075) | var str="action=store\_email&email="+email+'&name='+name+'&is\_agreed='+isagree+'&sec\_string='+nonce; |
| [3076](#L3076) | jQuery.ajax({ |
| [3077](#L3077) | type: "POST", |
| [3078](#L3078) | url: '<?php echo admin\_url('admin-ajax.php'); ?>', |
| [3079](#L3079) | data:str, |
| [3080](#L3080) | async:true, |
| [3081](#L3081) | success: function(msg){ |
| [3082](#L3082) | if(msg!=''){ |
| [3083](#L3083) |  |
| [3084](#L3084) | var result=msg.split("|"); |
| [3085](#L3085) | if(result[0]=='success'){ |
| [3086](#L3086) |  |
| [3087](#L3087) | jQuery("#<?php echo $rand;?>\_AjaxLoader").hide(); |
| [3088](#L3088) | jQuery('.<?php echo $rand;?>\_mysuccess\_msg').html(result[1]); |
| [3089](#L3089) | jQuery('.<?php echo $rand;?>\_mysuccess\_msg').show(); |
| [3090](#L3090) | setTimeout(function(){ |
| [3091](#L3091) |  |
| [3092](#L3092) | jQuery('#<?php echo $rand;?>\_mysuccess\_msg').hide(); |
| [3093](#L3093) | jQuery('#<?php echo $rand;?>\_mysuccess\_msg').html(''); |
| [3094](#L3094) | jQuery("#<?php echo $rand;?>\_youremail").val('<?php echo $EmailLabel;?>'); |
| [3095](#L3095) | jQuery("#<?php echo $rand;?>\_yourname").val('<?php echo $NameLabel;?>'); |
| [3096](#L3096) |  |
| [3097](#L3097) |  |
| [3098](#L3098) | },2000); |
| [3099](#L3099) |  |
| [3100](#L3100) |  |
| [3101](#L3101) |  |
| [3102](#L3102) |  |
| [3103](#L3103) | } |
| [3104](#L3104) | else{ |
| [3105](#L3105) | jQuery("#<?php echo $rand;?>\_AjaxLoader").hide(); |
| [3106](#L3106) | jQuery('#<?php echo $rand;?>\_myerror\_msg').html(result[1]); |
| [3107](#L3107) | jQuery('#<?php echo $rand;?>\_myerror\_msg').show(); |
| [3108](#L3108) | setTimeout(function(){ |
| [3109](#L3109) |  |
| [3110](#L3110) | jQuery('#<?php echo $rand;?>\_myerror\_msg').hide(); |
| [3111](#L3111) | jQuery('#<?php echo $rand;?>\_myerror\_msg').html(''); |
| [3112](#L3112) |  |
| [3113](#L3113) |  |
| [3114](#L3114) |  |
| [3115](#L3115) |  |
| [3116](#L3116) | },2000); |
| [3117](#L3117) |  |
| [3118](#L3118) | } |
| [3119](#L3119) |  |
| [3120](#L3120) | } |
| [3121](#L3121) |  |
| [3122](#L3122) | } |
| [3123](#L3123) | }); |
| [3124](#L3124) |  |
| [3125](#L3125) | } |
| [3126](#L3126) |  |
| [3127](#L3127) |  |
| [3128](#L3128) |  |
| [3129](#L3129) |  |
| [3130](#L3130) |  |
| [3131](#L3131) | } |
| [3132](#L3132) | </script> |
| [3133](#L3133) | <style> |
| [3134](#L3134) | <?php echo html\_entity\_decode($wp\_news\_letter\_settings['additional\_css'],ENT\_QUOTES);?> |
| [3135](#L3135) | </style> |
| [3136](#L3136) | <?php |
| [3137](#L3137) | echo $after\_widget; |
| [3138](#L3138) | } |
| [3139](#L3139) |  |
| [3140](#L3140) |  |
| [3141](#L3141) |  |
| [3142](#L3142) | function update( $new\_instance, $old\_instance ) { |
| [3143](#L3143) |  |
| [3144](#L3144) |  |
| [3145](#L3145) | $instance = $old\_instance; |
| [3146](#L3146) | $instance['Heading'] = sanitize\_text\_field($new\_instance['Heading']); |
| [3147](#L3147) | $instance['Subheading'] = sanitize\_textarea\_field($new\_instance['Subheading']); |
| [3148](#L3148) | $instance['EmailLabel'] = sanitize\_text\_field($new\_instance['EmailLabel']); |
| [3149](#L3149) | $instance['NameLabel'] = sanitize\_text\_field($new\_instance['NameLabel']); |
| [3150](#L3150) | $instance['SubmitButtonLabel'] = sanitize\_text\_field($new\_instance['SubmitButtonLabel']); |
| [3151](#L3151) | $instance['RequiredFieldMessage'] = sanitize\_text\_field($new\_instance['RequiredFieldMessage']); |
| [3152](#L3152) | $instance['InvalidEmailMessage'] = sanitize\_text\_field($new\_instance['InvalidEmailMessage']); |
| [3153](#L3153) | $instance['InvalidRequestMessage'] = sanitize\_text\_field($new\_instance['InvalidRequestMessage']); |
| [3154](#L3154) | $instance['EmailExistMessage'] = sanitize\_text\_field($new\_instance['EmailExistMessage']); |
| [3155](#L3155) | $instance['SuccessMessage'] = sanitize\_text\_field($new\_instance['SuccessMessage']); |
| [3156](#L3156) | $instance['WaitMessage'] = sanitize\_text\_field($new\_instance['WaitMessage']); |
| [3157](#L3157) | $instance['ShowNameField'] = intval($new\_instance['ShowNameField']); |
| [3158](#L3158) | $instance['show\_agreement'] = isset($new\_instance['show\_agreement']) ? intval($new\_instance['show\_agreement']):0; |
| [3159](#L3159) | $instance['agreement\_text'] = trim(strip\_tags(stripslashes( $new\_instance['agreement\_text']),'<a><b><p><strong><em><i>')); |
| [3160](#L3160) | $instance['agreement\_error'] = sanitize\_text\_field($new\_instance['agreement\_error']); |
| [3161](#L3161) |  |
| [3162](#L3162) | return $instance; |
| [3163](#L3163) |  |
| [3164](#L3164) |  |
| [3165](#L3165) | } |
| [3166](#L3166) | function form( $instance ) { |
| [3167](#L3167) |  |
| [3168](#L3168) | //Defaults |
| [3169](#L3169) | $instance = wp\_parse\_args( (array) $instance, array( |
| [3170](#L3170) | 'Heading'=>'Subscribe to our newsletter', |
| [3171](#L3171) | 'Subheading'=>'Want to be notified when our article is published? Enter your email address and name below to be the first to know.', |
| [3172](#L3172) | 'EmailLabel'=>'Email', |
| [3173](#L3173) | 'NameLabel' => 'Name', |
| [3174](#L3174) | 'SubmitButtonLabel' => 'SIGN UP FOR NEWSLETTER NOW', |
| [3175](#L3175) | 'RequiredFieldMessage' => 'This field is required.', |
| [3176](#L3176) | 'InvalidEmailMessage' => 'Please enter valid email address.', |
| [3177](#L3177) | 'InvalidRequestMessage'=>'Invalid request.', |
| [3178](#L3178) | 'EmailExistMessage'=>'This email is already exist.', |
| [3179](#L3179) | 'SuccessMessage'=>'You have successfully subscribed to our Newsletter!', |
| [3180](#L3180) | 'WaitMessage'=>'Please wait...', |
| [3181](#L3181) | 'ShowNameField'=>"1", |
| [3182](#L3182) | 'show\_agreement'=>'1', |
| [3183](#L3183) | 'agreement\_text'=>'I agree to <a href="#" target="\_blank">Terms of Service</a> and <a href="#" target="\_blank">Privacy Policy</a>', |
| [3184](#L3184) | 'agreement\_error'=>'Please read and agree to our terms & conditions.', |
| [3185](#L3185) |  |
| [3186](#L3186) | ) |
| [3187](#L3187) | ); |
| [3188](#L3188) |  |
| [3189](#L3189) |  |
| [3190](#L3190) | ?> |
| [3191](#L3191) | <p> |
| [3192](#L3192) | <label for="<?php echo $this->get\_field\_id('ShowNameField'); ?>"><b><?php echo \_\_( 'Show Name Field','email-subscribe');?>:</b></label><br/> |
| [3193](#L3193) | <input <?php if($instance['ShowNameField']=='1'){?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('ShowNameField');?>"  id="s\_type\_show\_field\_yes" value="1"> Yes |
| [3194](#L3194) | <input <?php if($instance['ShowNameField']=='2'){?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('ShowNameField');?>"   id="s\_type\_show\_field\_no" value="2"> No |
| [3195](#L3195) | </p> |
| [3196](#L3196) | <p> |
| [3197](#L3197) | <label for="<?php echo $this->get\_field\_id('show\_agreement'); ?>"><b><?php echo \_\_( 'Show Agreement','email-subscribe');?>:</b></label><br/> |
| [3198](#L3198) | <input <?php if($instance['show\_agreement']=='1'){?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('show\_agreement');?>"  id="s\_type\_show\_agreement\_yes" value="1"> Yes |
| [3199](#L3199) | <input <?php if($instance['show\_agreement']=='2'){?>checked="checked" <?php } ?> type="radio" name="<?php echo $this->get\_field\_name('show\_agreement');?>"   id="s\_type\_show\_agreement\_no" value="2"> No |
| [3200](#L3200) | </p> |
| [3201](#L3201) | <p> |
| [3202](#L3202) | <label for="<?php echo $this->get\_field\_id('Heading'); ?>"><b><?php echo \_\_( 'Heading:','email-subscribe');?></b></label> |
| [3203](#L3203) | <input class="widefat" id="<?php echo $this->get\_field\_id('Heading'); ?>" |
| [3204](#L3204) | name="<?php echo $this->get\_field\_name('Heading'); ?>" type="text" value="<?php echo $instance['Heading']; ?>" /> |
| [3205](#L3205) | </p> |
| [3206](#L3206) | <p> |
| [3207](#L3207) | <label for="<?php echo $this->get\_field\_id('Subheading'); ?>"><b><?php echo \_\_( 'Subheading:','email-subscribe');?></b></label><br/> |
| [3208](#L3208) | <textarea rows="4" cols="30" name="<?php echo $this->get\_field\_name('Subheading');?>" id="Subheading"><?php echo $instance['Subheading'];?></textarea> |
| [3209](#L3209) | </p> |
| [3210](#L3210) | <p> |
| [3211](#L3211) | <label for="<?php echo $this->get\_field\_id('EmailLabel'); ?>"><b><?php echo \_\_( 'Email Label:','email-subscribe');?></b></label> |
| [3212](#L3212) | <input class="widefat" id="<?php echo $this->get\_field\_id('EmailLabel'); ?>" |
| [3213](#L3213) | name="<?php echo $this->get\_field\_name('EmailLabel'); ?>" type="text" value="<?php echo $instance['EmailLabel']; ?>" /> |
| [3214](#L3214) | </p> |
| [3215](#L3215) | <p> |
| [3216](#L3216) | <label for="<?php echo $this->get\_field\_id('NameLabel'); ?>"><b><?php echo \_\_( 'Name Label:','email-subscribe');?></b></label> |
| [3217](#L3217) | <input class="widefat" id="<?php echo $this->get\_field\_id('NameLabel'); ?>" |
| [3218](#L3218) | name="<?php echo $this->get\_field\_name('NameLabel'); ?>" type="text" value="<?php echo $instance['NameLabel']; ?>" /> |
| [3219](#L3219) | </p> |
| [3220](#L3220) | <p> |
| [3221](#L3221) | <label for="<?php echo $this->get\_field\_id('SubmitButtonLabel'); ?>"><b><?php echo \_\_( 'Submit Button Label:','email-subscribe');?></b></label> |
| [3222](#L3222) | <input class="widefat" id="<?php echo $this->get\_field\_id('SubmitButtonLabel'); ?>" |
| [3223](#L3223) | name="<?php echo $this->get\_field\_name('SubmitButtonLabel'); ?>" type="text" value="<?php echo $instance['SubmitButtonLabel']; ?>" /> |
| [3224](#L3224) | </p> |
| [3225](#L3225) | <p> |
| [3226](#L3226) | <label for="<?php echo $this->get\_field\_id('RequiredFieldMessage'); ?>"><b><?php echo \_\_( 'Required Field Message:','email-subscribe');?></b></label> |
| [3227](#L3227) | <input class="widefat" id="<?php echo $this->get\_field\_id('RequiredFieldMessage'); ?>" |
| [3228](#L3228) | name="<?php echo $this->get\_field\_name('RequiredFieldMessage'); ?>" type="text" value="<?php echo $instance['RequiredFieldMessage']; ?>" /> |
| [3229](#L3229) | </p> |
| [3230](#L3230) |  |
| [3231](#L3231) | <p> |
| [3232](#L3232) | <label for="<?php echo $this->get\_field\_id('InvalidEmailMessage'); ?>"><b><?php echo \_\_( 'Invalid Email Message:','email-subscribe');?></b></label> |
| [3233](#L3233) | <input class="widefat" id="<?php echo $this->get\_field\_id('InvalidEmailMessage'); ?>" |
| [3234](#L3234) | name="<?php echo $this->get\_field\_name('InvalidEmailMessage'); ?>" type="text" value="<?php echo $instance['InvalidEmailMessage']; ?>" /> |
| [3235](#L3235) | </p> |
| [3236](#L3236) | <p> |
| [3237](#L3237) | <label for="<?php echo $this->get\_field\_id('InvalidRequestMessage'); ?>"><b><?php echo \_\_( 'Invalid Request Message:','email-subscribe');?></b></label> |
| [3238](#L3238) | <input class="widefat" id="<?php echo $this->get\_field\_id('InvalidRequestMessage'); ?>" |
| [3239](#L3239) | name="<?php echo $this->get\_field\_name('InvalidRequestMessage'); ?>" type="text" value="<?php echo $instance['InvalidRequestMessage']; ?>" /> |
| [3240](#L3240) | </p> |
| [3241](#L3241) | <p> |
| [3242](#L3242) | <label for="<?php echo $this->get\_field\_id('EmailExistMessage'); ?>"><b><?php echo \_\_( 'Email Exist Message:','email-subscribe');?></b></label> |
| [3243](#L3243) | <input class="widefat" id="<?php echo $this->get\_field\_id('EmailExistMessage'); ?>" |
| [3244](#L3244) | name="<?php echo $this->get\_field\_name('EmailExistMessage'); ?>" type="text" value="<?php echo $instance['EmailExistMessage']; ?>" /> |
| [3245](#L3245) | </p> |
| [3246](#L3246) | <p> |
| [3247](#L3247) | <label for="<?php echo $this->get\_field\_id('SuccessMessage'); ?>"><b><?php echo \_\_( 'Success Message:','email-subscribe');?></b></label> |
| [3248](#L3248) | <input class="widefat" id="<?php echo $this->get\_field\_id('SuccessMessage'); ?>" |
| [3249](#L3249) | name="<?php echo $this->get\_field\_name('SuccessMessage'); ?>" type="text" value="<?php echo $instance['SuccessMessage']; ?>" /> |
| [3250](#L3250) | </p> |
| [3251](#L3251) | <p> |
| [3252](#L3252) | <label for="<?php echo $this->get\_field\_id('WaitMessage'); ?>"><b><?php echo \_\_( 'Wait Message:','email-subscribe');?></b></label> |
| [3253](#L3253) | <input class="widefat" id="<?php echo $this->get\_field\_id('WaitMessage'); ?>" |
| [3254](#L3254) | name="<?php echo $this->get\_field\_name('WaitMessage'); ?>" type="text" value="<?php echo $instance['WaitMessage']; ?>" /> |
| [3255](#L3255) | </p> |
| [3256](#L3256) | <p> |
| [3257](#L3257) | <label for="<?php echo $this->get\_field\_id('agreement\_text'); ?>"><b><?php echo \_\_( 'Agreement Text:','email-subscribe');?></b></label> |
| [3258](#L3258) | <textarea class="widefat" id="<?php echo $this->get\_field\_id('agreement\_text'); ?>" |
| [3259](#L3259) | name="<?php echo $this->get\_field\_name('agreement\_text'); ?>" ><?php echo $instance['agreement\_text']; ?></textarea> |
| [3260](#L3260) | </p> |
| [3261](#L3261) | <p> |
| [3262](#L3262) | <label for="<?php echo $this->get\_field\_id('agreement\_error'); ?>"><b><?php echo \_\_( 'Agreement Message:','email-subscribe');?></b></label> |
| [3263](#L3263) | <input class="widefat" id="<?php echo $this->get\_field\_id('agreement\_error'); ?>" |
| [3264](#L3264) | name="<?php echo $this->get\_field\_name('agreement\_error'); ?>" type="text" value="<?php echo $instance['agreement\_error']; ?>" /> |
| [3265](#L3265) | </p> |
| [3266](#L3266) |  |
| [3267](#L3267) | <?php |
| [3268](#L3268) | } // function form |
| [3269](#L3269) | } // widget class |
| [3270](#L3270) |  |
| [3271](#L3271) |  |
| [3272](#L3272) | function store\_email\_callback(){ |
| [3273](#L3273) |  |
| [3274](#L3274) | if(isset($\_POST['email']) and  isset($\_POST['name']) and isset($\_POST['sec\_string'])){ |
| [3275](#L3275) |  |
| [3276](#L3276) | $wp\_news\_letter\_settings=get\_option('wp\_news\_letter\_settings'); |
| [3277](#L3277) | $nonce = $\_POST['sec\_string']; |
| [3278](#L3278) | $is\_agreed=sanitize\_text\_field($\_POST['is\_agreed']); |
| [3279](#L3279) | $is\_agreed=esc\_html($is\_agreed); |
| [3280](#L3280) | if (wp\_verify\_nonce( $nonce, 'newsletter-nonce' ) and $is\_agreed==true ) { |
| [3281](#L3281) |  |
| [3282](#L3282) | global $wpdb; |
| [3283](#L3283) | $email=sanitize\_email($\_POST['email']); |
| [3284](#L3284) | $name=sanitize\_text\_field($\_POST['name']); |
| [3285](#L3285) | $name=esc\_html($name); |
| [3286](#L3286) |  |
| [3287](#L3287) | if(is\_email($email)){ |
| [3288](#L3288) |  |
| [3289](#L3289) |  |
| [3290](#L3290) | $subscribed\_on=date('Y-m-d h:i:s'); |
| [3291](#L3291) | if(function\_exists('date\_i18n')){ |
| [3292](#L3292) |  |
| [3293](#L3293) | $subscribed\_on=date\_i18n('Y-m-d'.' '.get\_option('time\_format') ,false,false); |
| [3294](#L3294) | if(get\_option('time\_format')=='H:i') |
| [3295](#L3295) | $subscribed\_on=date('Y-m-d H:i:s',strtotime($subscribed\_on)); |
| [3296](#L3296) | else |
| [3297](#L3297) | $subscribed\_on=date('Y-m-d h:i:s',strtotime($subscribed\_on)); |
| [3298](#L3298) |  |
| [3299](#L3299) | } |
| [3300](#L3300) |  |
| [3301](#L3301) | $query = $wpdb->prepare('SELECT \* FROM '.$wpdb->prefix.'nl\_subscriptions where email = %s',array($email)); |
| [3302](#L3302) | $myrow  = $wpdb->get\_row($query); |
| [3303](#L3303) |  |
| [3304](#L3304) | if(is\_object($myrow)){ |
| [3305](#L3305) |  |
| [3306](#L3306) | echo 'error|'.$wp\_news\_letter\_settings['email\_exist']; |
| [3307](#L3307) |  |
| [3308](#L3308) | }else{ |
| [3309](#L3309) | try{ |
| [3310](#L3310) |  |
| [3311](#L3311) | $key = md5(uniqid(rand(), true)); |
| [3312](#L3312) |  |
| [3313](#L3313) | $wpdb->insert( |
| [3314](#L3314) | $wpdb->prefix."nl\_subscriptions", |
| [3315](#L3315) | array( 'name' => $name, 'email' => $email,'subscribed\_on'=> $subscribed\_on,'is\_subscribed'=>1,'unsubs\_key'=>$key), |
| [3316](#L3316) | array( '%s', '%s','%s','%d','%s' ) |
| [3317](#L3317) | ); |
| [3318](#L3318) | echo 'success|'.$wp\_news\_letter\_settings['success']; |
| [3319](#L3319) | } |
| [3320](#L3320) | catch(Exception $e){ |
| [3321](#L3321) |  |
| [3322](#L3322) | echo 'error|'.$e->getMessage(); |
| [3323](#L3323) |  |
| [3324](#L3324) | } |
| [3325](#L3325) |  |
| [3326](#L3326) | } |
| [3327](#L3327) |  |
| [3328](#L3328) | } |
| [3329](#L3329) | else{ |
| [3330](#L3330) |  |
| [3331](#L3331) | echo 'error|'.$wp\_news\_letter\_settings['iinvalidemail'] ; |
| [3332](#L3332) |  |
| [3333](#L3333) | } |
| [3334](#L3334) | } |
| [3335](#L3335) | else{ |
| [3336](#L3336) |  |
| [3337](#L3337) | echo 'error|'.$wp\_news\_letter\_settings['invalid\_request'] ; |
| [3338](#L3338) | } |
| [3339](#L3339) | } |
| [3340](#L3340) | else{ |
| [3341](#L3341) |  |
| [3342](#L3342) | echo 'error|'.$wp\_news\_letter\_settings['invalid\_request']; |
| [3343](#L3343) | } |
| [3344](#L3344) |  |
| [3345](#L3345) | die; |
| [3346](#L3346) |  |
| [3347](#L3347) | } |
| [3348](#L3348) |  |
| [3349](#L3349) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/email-subscribe/tags/1.2.19/wp-email-subscription.php?rev=3005188&format=txt)
* [Original Format](/export/3005188/email-subscribe/tags/1.2.19/wp-email-subscription.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_1f400ddc_20250114_221822.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Email Subscription Popup <= 1.2.18 - Reflected Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Email Subscription Popup <= 1.2.18 - Reflected Cross-Site Scripting

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2023-6527](https://www.cve.org/CVERecord?id=CVE-2023-6527) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | December 5, 2023 |
| Last Updated | December 6, 2023 |
| Researcher | [0x9567b](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/0x9567b) |

### Description

The Email Subscription Popup plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the HTTP\_REFERER header in all versions up to, and including, 1.2.18 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/email-subscribe/tags/1.2.19/wp-email-subscription.php?rev=3005188#L2125)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Femail-subscribe%2Femail-subscription-popup-1218-reflected-cross-site-scripting&t=Email%20Subscription%20Popup%20%3C%3D%201.2.18%20-%20%20Reflected%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Femail-subscribe%2Femail-subscription-popup-1218-reflected-cross-site-scripting&text=Email%20Subscription%20Popup%20%3C%3D%201.2.18%20-%20%20Reflected%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Femail-subscribe%2Femail-subscription-popup-1218-reflected-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Email Subscription Popup

#### [Email Subscription Popup](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/email-subscribe)

| Software Type | Plugin |
| --- | --- |
| Software Slug | email-subscribe [(view on wordpress.org)](https://wordpress.org/plugins/email-subscribe) |
| Patched? | Yes |
| Remediation | Update to version 1.2.19, or a newer patched version |
| Affected Version | * <= 1.2.18 |
| Patched Version | * 1.2.19 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


