=== Content from www.mozilla.org_f22f7fdc_20250115_094518.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-54

## Security Vulnerabilities fixed in Firefox ESR 115.6

Announced
December 19, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.6

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6862: Use-after-free in nsDNSService](#CVE-2023-6862)

Reporter
Randell Jesup
Impact
moderate
##### Description

A use-after-free was identified in the `nsDNSService::Init`. This issue appears to manifest rarely during start-up.

##### References

* [Bug 1868042](https://bugzilla.mozilla.org/show_bug.cgi?id=1868042)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Karl Tomlinson, Valentin Gosu, Randell Jesup, Yury Delendik, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862089%2C1862777%2C1864015)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.debian.org_b46871c9_20250115_094517.html ===


---

[[Date Prev](msg00278.html)][[Date Next](msg00280.html)]
[[Thread Prev](msg00278.html)][[Thread Next](msg00280.html)]
[[Date Index](maillist.html#00279)]
[[Thread Index](threads.html#00279)]

# [SECURITY] [DSA 5582-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5582-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 21 Dec 2023 19:33:01 +0000
* *Message-id*: <[[🔎]](/msgid-search/ZYSS7fpGzNyfLUqM%40seger.debian.org) [ZYSS7fpGzNyfLUqM@seger.debian.org](msg00279.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5582-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 21, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6864
                 CVE-2023-6873 CVE-2023-50761 CVE-2023-50762

Multiple security issues were discovered in Thunderbird, which could
result in denial of service, the execution of arbitrary code or spoofing
of signed PGP/MIME and SMIME emails.

For the oldstable distribution (bullseye), these problems have been fixed
in version 1:115.6.0-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 1:115.6.0-1~deb12u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmWEkCEACgkQEMKTtsN8
TjYB8xAAiSFGWOK6s+7YGuc28bu4EEUHG2sUXJ9g43AD9DftxhVlz1fh2GbyXxpL
Dyoq3rrZU3n8bVQTWLcfRcdLYOZlMNEaxN8K89lGRfh+864anLQIGGII3gsCC8qS
3Wx96W9Ydh4++iM55Yopc9SNAFKUKXONYU8dxolSYsDAwkhw4iU97TjURsImOTzm
npyAIvVbG7Uf3HEnyb98KRr8OgbzdkJpg/JFKj5NLxX8QJ1kKpV9/8uYKRxdehNh
ljlYXt2j5fqaL1jXXcOMkEuMgXjUl5Hq2dh6owEPkfHDRMMLLypsuCXDz+i4mAyY
QGgrdNYshf876OT4cmf2O3d/lXExWdcALWGRd3/tLSB7KIoRUtit/+OZT6/jVvSj
r4g4vfQvQHC7JlvUmrglmKrHQ3J4b0TEeMN3GIrUadMFSVG2C8pfS23e91AtF6Jy
eg00ZvP8/voUiHWymJTgJesDxHsHK1ZRMqulaIHwNuS+DieOW2mqNmb/exuJ4v35
XwIFCrMBzmOkxDrfdiSLciXA2+qcdKW7QM+hK2hEzZBaw31OHgHTPZwzd2sMx9UD
rKaejR/xKIMRgscqQcdISdsQTCmbFO98/iyiUXUF+j+itvdqrnaAn8ZEMtPj1dm5
4YzDuuZrWDrQ/IYxUz66x7NzQFAZKJc41toPY3u5aIx+lXOQZyA=
=DbG4
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_9c451470_20250115_094517.html ===


---

[[Date Prev](msg00277.html)][[Date Next](msg00279.html)]
[[Thread Prev](msg00277.html)][[Thread Next](msg00279.html)]
[[Date Index](maillist.html#00278)]
[[Thread Index](threads.html#00278)]

# [SECURITY] [DSA 5581-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5581-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 20 Dec 2023 19:23:51 +0000
* *Message-id*: <ZYM/R0NEjTJhvwBy@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5581-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 20, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6863
                 CVE-2023-6864 CVE-2023-6865 CVE-2023-6867

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, sandbox escape or clickjacking.

For the oldstable distribution (bullseye), these problems have been fixed
in version 115.6.0esr-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 115.6.0esr-1~deb12u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmWDPxAACgkQEMKTtsN8
TjYfeRAAql+aZ6PpAM1Fq4Cp1IlvDQc8BYNuKrjn9/4xYgq/bAnQyRGj1I0viHP2
dUdZl6CcndqE6NVgm1mYpCQ/TZJpwSSxnoXf46bB/lGNg17Cw7T8gWI5uUSs1K63
UOYNMr8HlCF35qZpU0+TrsL+q3qRdkOQOxRLSFHNhxuUQ+44pUJYKDVg6vKjHU91
oQEfjzmcgn2Z+tL/zyrt4s57XUGpZNm6Vmg/TUftXL5+CDodCNPRnIw0JBYWu2yf
J3tj6cuCw6jDAcAouAsDcd8CbK28Bf6h2zUossRGVjSfNWeoshK2qe9L3/wlQB62
s0wrJ1MimP9k1y9xS4Iy85vf2BDDnVQBNgMR8mKnwt63Jhngpx8JW8oTbBKzx1oi
EZkShw3CDWuCx7ooMnR8glwybPJqXMyZbt8H7dMO3IFEwD2dfNzVfwyEUq4JAOzC
PasLEwCekXrTTxeZoYdTW4y8c5c4GEd9nvO8Hdk9iV/zbD1uhpgy0g6oQXciAzSH
6Rm92u2+HPwNOFjZAJMOi9eyqtdj9PqwHZ1uraXhtqCz8peD/Sg+YZCAXt0lLyVM
+WbQqJOyH5n1POeEHbEikv1iMLXRw+Vkkbzr3u9laTdQ9Yn1b/ZfVblG6/N+hhlL
LXYBXyYfrU4L6DMTnUave299Cq1fb8RPWVefcqAv6DoQX0P1GHc=
=8/zE
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_1e922315_20250115_094515.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 3698-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3698-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 29 Dec 2023 11:11:37 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20231229101137.2CD1F2A00FB%40andromeda) [20231229101137.2CD1F2A00FB@andromeda](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3698-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.6.0-1~deb10u1
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6864
                 CVE-2023-6873 CVE-2023-50761 CVE-2023-50762

Multiple security issues were discovered in Thunderbird, which could
result in denial of service, the execution of arbitrary code or spoofing
of signed PGP/MIME and SMIME emails.

For Debian 10 buster, these problems have been fixed in version
1:115.6.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWOm1kACgkQnUbEiOQ2
gwIMSQ//akgeGKZJRMxhWlIhr6l4QGytlZACPYzs6iCuxU9o8AP5tI3suobFfk3d
ZSIWTj3l9bORw1Zfwr/gRQMXnk8oNPLHblqyKaHozoqoKjuCQW89pclXbDZVml3N
OAofqzbAtFlSB9r0pSq7Edn9FH90iFnE4CHeJoRLbq1Qr1Ee2nzk/UoiaPSlymrp
3pKlSzlmSRmDGFUWZIkTdwLsg8j0YSlMrTRqlkbldlbXxJxxknXL5TO9A6YRPt1B
d5wndr1hYVPmWJ0PGcuk7dSDfvOktBhvdKa/KdUpSaaPFsN7xPzGtRBtHwcvtK3f
G+747I3xD8g2dKYpOWkZlm9KiQZ0AwsapJsfLFc5QpWD25aTryUpOzqRiXkLTDQR
Wob1GWUrrTaVNbeVkrwhvKHSQl6QPI3BoTn3Ejx6qHJjf69RG6255/ZqJsJO0JPa
awf9dZPymdfl0MlfzSrkRls2qXj0L0bTxbtIXRkY5aHxfOVy6hPp1h23fX1GE8KU
4bwmrKLEexoqFHbFfjDuHj6Wdu2UdZQ8uibV2cHh1Hxrur0DlkPGrdItCtxqRMHO
NZ57IbH87PpNzz+iMnK0MUBck5aX7PcCnyIDzTqodT968al2BLJ60IuPr4zvjPmp
dXIWEjTKFv+CC1xvudbJ4wENmTStMRACyiLpyBT2cBUhwJhB8cE=
=9fdH
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_91aad87a_20250115_094515.html ===


---

[[Date Prev](msg00019.html)][[Date Next](msg00021.html)]
[[Thread Prev](msg00019.html)][[Thread Next](msg00021.html)]
[[Date Index](maillist.html#00020)]
[[Thread Index](threads.html#00020)]

# [SECURITY] [DLA 3697-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3697-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 29 Dec 2023 11:08:44 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20231229100844.B99042A00FB%40andromeda) [20231229100844.B99042A00FB@andromeda](msg00020.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3697-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.6.0esr-1~deb10u1
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6863
                 CVE-2023-6864 CVE-2023-6865 CVE-2023-6867

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, sandbox escape or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.6.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWOmqoACgkQnUbEiOQ2
gwKefhAAoZQBSJoZAdBQQsntXnHOjR09PpxPBhtc+Rl8OkjDlYrCUXiXBTtdvPit
+q1XLz5W2yxGptoqI8iMzkk4y9MpX6c6ncTSVLkDwBA9t91P+omKnC8IPUwsFRyT
4L7dncZsm0vuiJwHJWCigpSreEt1zlQhSULgj0g4h/bRAwDMz5zQ/qFmPe2ocLfn
0Lx+8xpcd/n+/jTI1lqAy62lAqIhKLzhotWrrmBV8V1jLLscjTAX5uhJc6yaHhfW
01kvZpY4X+YSpqYoCWlZP2LXnG4JGRpQk4kX3Xt8F3wZVqA+t8yquyK/PloEqdVO
emChkZTPzzfOhR1CgdVi3P4VAw8xaq9CiHAr5xhhEyHDtW5AIAxNN9676B9P6cAg
5XVfQ2Yb4tMboG7y4ojxKXSAUEsOT55RVtAHK6iGyjUX0C4qPltJErJrno255ErT
GtleR8pqXWr72lZWioul9BI3EB5EJw8JCw7WL7/ixUBZGwcrJj9hR5G0/dPSUDbe
KajpGYN1LrMf2ZpLE5pF5IDD+63zQBqzk+iQa/ghmrkXCW9B0Q2yYBFpmZc7Wt5W
LCoKQzSME0ft1uRL9ZooWtH19mV+SSmu++nb0lGkdQDdLG1qt/ZPh4Brz+9jXJ6E
f65JpUC3tUopHTNxJAn4R2Adl422xt7rplwOlc/UMM30+rGnkz8=
=1jYk
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_a3ed1ff2_20250115_094514.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1864118)
* [XML](/show_bug.cgi?ctype=xml&id=1864118)

Closed
[Bug 1864118](/show_bug.cgi?id=1864118)
(CVE-2023-6861)

Opened 1 year ago
Closed 1 year ago

# heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode

## Categories

### (Core :: Widget: Win32, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Widget%3A%20Win32#Widget%3A%20Win32)

Widget: Win32
▾

Core :: Widget: Win32
Mapping of cross platform widget interfaces to Win32 platform APIs.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Widget%3A%20Win32)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

122 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [121+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=121%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox119 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified) |
| firefox122 | [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 121+ | verified |
| firefox-esr128 | --- | --- |
| firefox119 |  | wontfix |
| firefox120 |  | wontfix |
| firefox121 | + | verified |
| firefox122 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: m.cooolie, Assigned: rkraesig)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/605ee8cd1c9a74704916c7bdc4e4865d?d=mm&size=40)  [rkraesig](/user_profile?user_id=699639)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a2afc3e713a960c7119ae73ca1cd5e8e?d=mm&size=40)  [m.cooolie](/user_profile?user_id=689709)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/605ee8cd1c9a74704916c7bdc4e4865d?d=mm&size=40)  [rkraesig](/user_profile?user_id=699639)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main121+][adv-esr115.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6861

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main121+][adv-esr115.6+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1597388_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [poc.html](/attachment.cgi?id=9362965)  [1 year ago](#c0)  [m.cooolie](/user_profile?user_id=689709)   202 bytes, text/html |  | [Details](/attachment.cgi?id=9362965&action=edit) |
| --- | --- | --- |
| [Bug 1864118 - deny attempts to open a Windows file picker in headless mode r?#win-reviewers](/attachment.cgi?id=9363081)  [1 year ago](#c2)  [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c15 "1 year ago")  RyanVM : [approval-mozilla-esr115+](#c17 "1 year ago")  tjr : [sec-approval+](#c8 "1 year ago") | [Details](/attachment.cgi?id=9363081&action=edit) | [Review](/attachment.cgi?id=9363081) |
| [prefs.js](/attachment.cgi?id=9363815)  [1 year ago](#c7)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   10.05 KB, application/x-javascript |  | [Details](/attachment.cgi?id=9363815&action=edit) |
| [advisory.txt](/attachment.cgi?id=9367960)  [1 year ago](#c22)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   221 bytes, text/plain |  | [Details](/attachment.cgi?id=9367960&action=edit) |
| [advisory.txt](/attachment.cgi?id=9367967)  [1 year ago](#c23)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   236 bytes, text/plain |  | [Details](/attachment.cgi?id=9367967&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1864118#c0)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1864118&comment_id=16661393 "1 revision") |
|  | |

Attached file
[poc.html](attachment.cgi?id=9362965)
— [Details](attachment.cgi?id=9362965&action=edit)

#Reproduce

OS:win X64

121.0a1 (2023-11-06) (64-bit)

1. python -m http.server 1337
2. python -m ffpuppet firefox --headless -p prefs.js -d -u <http://localhost:1337/poc.html>

#Analysis

Not yet

#ASAN

```
==36900==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x12959aa2c548 at pc 0x7ffdb43a10c9 bp 0x00b1a35fc010 sp 0x00b1a35fc058
READ of size 4 at 0x12959aa2c548 thread T0
    #0 0x7ffdb43a10c8 in nsWindow::PickerOpen(void) /builds/worker/checkouts/gecko/widget/windows/nsWindow.cpp:8197
    #1 0x7ffdb41fe18d in AutoWidgetPickerState::PickerState /builds/worker/checkouts/gecko/widget/windows/nsFilePicker.cpp:68
    #2 0x7ffdb41fe18d in AutoWidgetPickerState::AutoWidgetPickerState /builds/worker/checkouts/gecko/widget/windows/nsFilePicker.cpp:59
    #3 0x7ffdb41fe18d in nsFilePicker::ShowFilePicker(class nsTString<char16_t> const &) /builds/worker/checkouts/gecko/widget/windows/nsFilePicker.cpp:490
    #4 0x7ffdb420128c in nsFilePicker::ShowW(enum nsIFilePicker::ResultCode *) /builds/worker/checkouts/gecko/widget/windows/nsFilePicker.cpp:566
    #5 0x7ffdb40d368b in nsBaseFilePicker::AsyncShowFilePicker::Run(void) /builds/worker/checkouts/gecko/widget/nsBaseFilePicker.cpp:86
    #6 0x7ffdaa3057ce in mozilla::RunnableTask::Run(void) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:549
    #7 0x7ffdaa2e7675 in mozilla::TaskController::DoExecuteNextTaskOnlyMainThreadInternal(class mozilla::detail::BaseAutoLock<class mozilla::Mutex &> const &) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:876
    #8 0x7ffdaa2e2dc5 in mozilla::TaskController::ExecuteNextTaskOnlyMainThreadInternal(class mozilla::detail::BaseAutoLock<class mozilla::Mutex &> const &) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:699
    #9 0x7ffdaa2e3a14 in mozilla::TaskController::ProcessPendingMTTask(bool) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:485
    #10 0x7ffdaa309111 in mozilla::TaskController::TaskController::<lambda_5>::operator() /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:211
    #11 0x7ffdaa309111 in mozilla::detail::RunnableFunction<`lambda at /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:211:7'>::Run /builds/worker/checkouts/gecko/xpcom/threads/nsThreadUtils.h:548
    #12 0x7ffdaa339bc5 in nsThread::ProcessNextEvent(bool, bool *) /builds/worker/checkouts/gecko/xpcom/threads/nsThread.cpp:1198
    #13 0x7ffdaa34aa8a in NS_ProcessNextEvent(class nsIThread *, bool) /builds/worker/checkouts/gecko/xpcom/threads/nsThreadUtils.cpp:480
    #14 0x7ffdaba43477 in mozilla::ipc::MessagePump::Run(class base::MessagePump::Delegate *) /builds/worker/checkouts/gecko/ipc/glue/MessagePump.cpp:85
    #15 0x7ffdab960483 in MessageLoop::RunInternal /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:370
    #16 0x7ffdab960483 in MessageLoop::RunHandler(void) /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:363
    #17 0x7ffdab96024a in MessageLoop::Run(void) /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:345
    #18 0x7ffdb40b3a1c in nsBaseAppShell::Run(void) /builds/worker/checkouts/gecko/widget/nsBaseAppShell.cpp:148
    #19 0x7ffdb42f6487 in nsAppShell::Run(void) /builds/worker/checkouts/gecko/widget/windows/nsAppShell.cpp:824
    #20 0x7ffdb894682b in nsAppStartup::Run(void) /builds/worker/checkouts/gecko/toolkit/components/startup/nsAppStartup.cpp:296
    #21 0x7ffdb8c90586 in XREMain::XRE_mainRun(void) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5680
    #22 0x7ffdb8c95b17 in XREMain::XRE_main(int, char **const, struct mozilla::BootstrapConfig const &) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5889
    #23 0x7ffdb8c96c3f in XRE_main(int, char **const, struct mozilla::BootstrapConfig const &) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5945
    #24 0x7ff74be320d8 in do_main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:227
    #25 0x7ff74be320d8 in NS_internal_main(int, char **, char **) /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:445
    #26 0x7ff74be314d8 in wmain /builds/worker/checkouts/gecko/toolkit/xre/nsWindowsWMain.cpp:151
    #27 0x7ff74bf14207 in invoke_main D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl:90
    #28 0x7ff74bf14207 in __scrt_common_main_seh D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl:288
    #29 0x7ffe18107343  (C:\WINDOWS\System32\KERNEL32.DLL+0x180017343)
    #30 0x7ffe192e26b0  (C:\WINDOWS\SYSTEM32\ntdll.dll+0x1800526b0)

0x12959aa2c548 is located 56 bytes before 608-byte region [0x12959aa2c580,0x12959aa2c7e0)
allocated by thread T0 here:
    #0 0x7ffdc70150e4 in calloc /builds/worker/fetches/llvm-project/compiler-rt/lib/asan/asan_malloc_win.cpp:114
    #1 0x7ffdaa17a054 in PLDHashTable::MakeEntryHandle(void const *, struct std::nothrow_t const &) /builds/worker/checkouts/gecko/xpcom/ds/PLDHashTable.cpp:630
    #2 0x7ffdaa17b080 in PLDHashTable::MakeEntryHandle(void const *) /builds/worker/checkouts/gecko/xpcom/ds/PLDHashTable.cpp:674
    #3 0x7ffdad9047bc in PLDHashTable::WithEntryHandle<class `protected: class mozilla::IdentifierMapEntry * __cdecl nsTHashtable<class mozilla::IdentifierMapEntry>::WithEntryHandle<class `public: class mozilla::IdentifierMapEntry * __cdecl nsTHashtable<class mozilla::IdentifierMapEntry>::PutEntry(struct mozilla::IdentifierMapEntry::DependentAtomOrString const &)'::`1'::<lambda_1>>(struct mozilla::IdentifierMapEntry::DependentAtomOrString const &, class `public: class mozilla::IdentifierMapEntry * __cdecl nsTHashtable<class mozilla::IdentifierMapEntry>::PutEntry(struct mozilla::IdentifierMapEntry::DependentAtomOrString const &)'::`1'::<lambda_1> &&)'::`1'::<lambda_1>>(void const *, class `protected: class mozilla::IdentifierMapEntry * __cdecl nsTHashtable<class mozilla::IdentifierMapEntry>::WithEntryHandle<class `public: class mozilla::IdentifierMapEntry * __cdecl nsTHashtable<class mozilla::IdentifierMapEntry>::PutEntry(struct mozilla::IdentifierMapEntry::DependentAtomOrString const &)'::`1'::<lambda_1>>(struct mozilla::IdentifierMapEntry::DependentAtomOrString const &, class `public: class mozilla::IdentifierMapEntry * __cdecl nsTHashtable<class mozilla::IdentifierMapEntry>::PutEntry(struct mozilla::IdentifierMapEntry::DependentAtomOrString const &)'::`1'::<lambda_1> &&)'::`1'::<lambda_1> &&) /builds/worker/checkouts/gecko/xpcom/ds/PLDHashTable.h:605
    #4 0x7ffdad8c7437 in nsTHashtable<mozilla::IdentifierMapEntry>::WithEntryHandle /builds/worker/checkouts/gecko/xpcom/ds/nsTHashtable.h:434
    #5 0x7ffdad8c7437 in nsTHashtable<mozilla::IdentifierMapEntry>::PutEntry /builds/worker/checkouts/gecko/xpcom/ds/nsTHashtable.h:306
    #6 0x7ffdad8c7437 in mozilla::dom::ShadowRoot::AddToIdTable(class mozilla::dom::Element *, class nsAtom *) /builds/worker/checkouts/gecko/dom/base/ShadowRoot.cpp:553
    #7 0x7ffdad736a6b in mozilla::dom::Element::AddToIdTable /builds/worker/checkouts/gecko/dom/base/Element.cpp:1136
    #8 0x7ffdad736a6b in mozilla::dom::Element::BindToTree(struct mozilla::dom::BindContext &, class nsINode &) /builds/worker/checkouts/gecko/dom/base/Element.cpp:1921
    #9 0x7ffdad5895fa in nsStyledElement::BindToTree(struct mozilla::dom::BindContext &, class nsINode &) /builds/worker/checkouts/gecko/dom/base/nsStyledElement.cpp:210
    #10 0x7ffdb105236a in nsGenericHTMLElement::BindToTree(struct mozilla::dom::BindContext &, class nsINode &) /builds/worker/checkouts/gecko/dom/html/nsGenericHTMLElement.cpp:466
    #11 0x7ffdada4edaf in nsINode::InsertChildBefore(class nsIContent *, class nsIContent *, bool, class mozilla::ErrorResult &) /builds/worker/checkouts/gecko/dom/base/nsINode.cpp:1613
    #12 0x7ffdb4a35013 in nsINode::AppendChildTo /builds/worker/checkouts/gecko/dom/base/nsINode.h:967
    #13 0x7ffdb4a35013 in mozilla::AccessibleCaret::CreateCaretElement::<lambda_1>::operator() /builds/worker/checkouts/gecko/layout/base/AccessibleCaret.cpp:237
    #14 0x7ffdb4a35013 in mozilla::AccessibleCaret::CreateCaretElement(void) const /builds/worker/checkouts/gecko/layout/base/AccessibleCaret.cpp:240
    #15 0x7ffdb4a31d44 in mozilla::AccessibleCaret::InjectCaretElement(class mozilla::dom::Document *) /builds/worker/checkouts/gecko/layout/base/AccessibleCaret.cpp:199
    #16 0x7ffdb4a3ba06 in mozilla::AccessibleCaret::AccessibleCaret /builds/worker/checkouts/gecko/layout/base/AccessibleCaret.cpp:82
    #17 0x7ffdb4a3ba06 in mozilla::MakeUnique<class mozilla::AccessibleCaret, class mozilla::PresShell *&>(class mozilla::PresShell *&) /builds/worker/workspace/obj-build/dist/include/mozilla/UniquePtr.h:605
    #18 0x7ffdb4a37baa in mozilla::AccessibleCaretManager::AccessibleCaretManager /builds/worker/checkouts/gecko/layout/base/AccessibleCaretManager.cpp:86
    #19 0x7ffdb4a37baa in mozilla::MakeUnique /builds/worker/workspace/obj-build/dist/include/mozilla/UniquePtr.h:605
    #20 0x7ffdb4a37baa in mozilla::AccessibleCaretEventHub::Init(void) /builds/worker/checkouts/gecko/layout/base/AccessibleCaretEventHub.cpp:365
    #21 0x7ffdb4a7d9fa in mozilla::PresShell::Init(class nsPresContext *, class nsViewManager *) /builds/worker/checkouts/gecko/layout/base/PresShell.cpp:907
    #22 0x7ffdad68ca47 in mozilla::dom::Document::CreatePresShell(class nsPresContext *, class nsViewManager *) /builds/worker/checkouts/gecko/dom/base/Document.cpp:6948
    #23 0x7ffdb4bb1924 in nsDocumentViewer::InitPresentationStuff(bool) /builds/worker/checkouts/gecko/layout/base/nsDocumentViewer.cpp:702
    #24 0x7ffdb4bb1279 in nsDocumentViewer::InitInternal(class nsIWidget *, class nsISupports *, class mozilla::dom::WindowGlobalChild *, struct mozilla::gfx::IntRectTyped<struct mozilla::gfx::UnknownUnits> const &, bool, bool, bool) /builds/worker/checkouts/gecko/layout/base/nsDocumentViewer.cpp:909
    #25 0x7ffdb4bb08bf in nsDocumentViewer::Init(class nsIWidget *, struct mozilla::gfx::IntRectTyped<struct mozilla::gfx::UnknownUnits> const &, class mozilla::dom::WindowGlobalChild *) /builds/worker/checkouts/gecko/layout/base/nsDocumentViewer.cpp:675
    #26 0x7ffdb7d25722 in nsDocShell::SetupNewViewer(class nsIContentViewer *, class mozilla::dom::WindowGlobalChild *) /builds/worker/checkouts/gecko/docshell/base/nsDocShell.cpp:8129
    #27 0x7ffdb7d23f5c in nsDocShell::Embed(class nsIContentViewer *, class mozilla::dom::WindowGlobalChild *, bool, bool, class nsIRequest *, class nsIURI *) /builds/worker/checkouts/gecko/docshell/base/nsDocShell.cpp:5603
    #28 0x7ffdb7d32fa2 in nsDocShell::CreateAboutBlankContentViewer(class nsIPrincipal *, class nsIPrincipal *, class nsIContentSecurityPolicy *, class nsIURI *, bool, class mozilla::Maybe<enum nsILoadInfo::CrossOriginEmbedderPolicy> const &, bool, bool, class mozilla::dom::WindowGlobalChild *) /builds/worker/checkouts/gecko/docshell/base/nsDocShell.cpp:6685
    #29 0x7ffdb7e8065f in nsAppShellService::JustCreateTopWindow(class nsIAppWindow *, class nsIURI *, unsigned int, int, int, bool, class mozilla::AppWindow **) /builds/worker/checkouts/gecko/xpfe/appshell/nsAppShellService.cpp:716
    #30 0x7ffdb7e812a4 in nsAppShellService::CreateTopLevelWindow(class nsIAppWindow *, class nsIURI *, unsigned int, int, int, class nsIAppWindow **) /builds/worker/checkouts/gecko/xpfe/appshell/nsAppShellService.cpp:179
    #31 0x7ffdb8949c5d in nsAppStartup::CreateChromeWindow(class nsIWebBrowserChrome *, unsigned int, class nsIOpenWindowInfo *, bool *, class nsIWebBrowserChrome **) /builds/worker/checkouts/gecko/toolkit/components/startup/nsAppStartup.cpp:757
    #32 0x7ffdb8b00951 in nsWindowWatcher::CreateChromeWindow(class nsIWebBrowserChrome *, unsigned int, class nsIOpenWindowInfo *, class nsIWebBrowserChrome **) /builds/worker/checkouts/gecko/toolkit/components/windowwatcher/nsWindowWatcher.cpp:437
    #33 0x7ffdb8afc3ca in nsWindowWatcher::OpenWindowInternal(class mozIDOMWindowProxy *, class nsTSubstring<char> const &, class nsTSubstring<char> const &, class nsTSubstring<char> const &, bool, bool, bool, class nsIArray *, bool, bool, bool, enum nsPIWindowWatcher::PrintKind, class nsDocShellLoadState *, class mozilla::dom::BrowsingContext **) /builds/worker/checkouts/gecko/toolkit/components/windowwatcher/nsWindowWatcher.cpp:1045
    #34 0x7ffdb8af7e36 in nsWindowWatcher::OpenWindow(class mozIDOMWindowProxy *, class nsTSubstring<char> const &, class nsTSubstring<char> const &, class nsTSubstring<char> const &, class nsISupports *, class mozIDOMWindowProxy **) /builds/worker/checkouts/gecko/toolkit/components/windowwatcher/nsWindowWatcher.cpp:293
    #35 0x7ffdbc685471 in XPTC__InvokebyIndex (E:\firefox_asan\target\firefox\xul.dll+0x193015471)

SUMMARY: AddressSanitizer: heap-buffer-overflow /builds/worker/checkouts/gecko/widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void)
Shadow bytes around the buggy address:
  0x12959aa2c280: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c300: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c480: 00 00 00 00 00 fa fa fa fa fa fa fa fa fa fa fa
=>0x12959aa2c500: fa fa fa fa fa fa fa fa fa[fa]fa fa fa fa fa fa
  0x12959aa2c580: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c680: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c700: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x12959aa2c780: 00 00 00 00 00 00 00 00 00 00 00 00 fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==36900==ABORTING

```
Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a23819_159069)• 1 year ago |

Group: firefox-core-security → dom-core-securityComponent: Security → Widget: Win32Product: Firefox → Core

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1864118#c1)• 1 year ago |
|  | |

Well, that's not good. ~~It looks like a file-picker is being opened for a window after the window has been destroyed. That shouldn't be possible -- the `nsFilePicker` should have a RefPtr to the nsWindow. The POC is too simplistic to be some destruction-order thing...~~

... ah, it's running in headless mode. In that case, there's no `nsWindow` above the `nsIWidget` and it's instead pointing off into someone else's internals. The relevant `static_cast<>` is [here](https://searchfox.org/mozilla-central/rev/236aff736d092e69cdf9638a026be326ecec7e07/widget/windows/nsFilePicker.cpp#58) — although it's been around since [at least 2011](https://searchfox.org/mozilla-central/rev/4b15d87e2990d8827a50058c4d8625d50994b6b0/widget/src/windows/nsFilePicker.cpp#144), so I assume I've exposed it outside its old context somehow.

Assignee: nobody → rkraesig

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1864118#c2)• 1 year ago |
|  | |

Attached file
[Bug 1864118 - deny attempts to open a Windows file picker in headless mode r?#win-reviewers](attachment.cgi?id=9363081)
— [Details](attachment.cgi?id=9363081&action=edit)

We don't necessarily even have access to a user-accessible desktop in

headless mode. Opening a file dialog isn't going to work out.

In practice, file-dialog invocations will typically be intercepted by

Puppeteer before they ever get here (see MockFilePicker.sys.mjs), but

that's configuration-dependent. Explicitly check whether we're in

headless mode before proceeding.

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1864118#c3)• 1 year ago |
|  | |

Adding #win-reviewers members to CC for review purposes.

For security-triage purposes:

* I believe this bug can only occur in headless mode. If so, it can't be triggered by an ordinary user... unless there's some way to trick `--backgroundtask` into loading dynamic web-provided content. (Maybe as an element of a privilege-escalation chain?)
* I don't *see* any reason this couldn't happen before [bug 1837079](/show_bug.cgi?id=1837079 "RESOLVED FIXED - Out-of-process Win32 file picker"), but under the circumstances I'm very reluctant to say it could.

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1864118#c4)• 1 year ago |
|  | |

Comment on [attachment 9363081](/attachment.cgi?id=9363081 "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") [[details]](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers")

[Bug 1864118](/show_bug.cgi?id=1864118 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") - deny attempts to open a Windows file picker in headless mode r?#win-reviewers

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: I don't think this can be exploited remotely. At least one additional exploit would be needed to do so, and I think *that* exploit would be sec-critical all on its own.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Trivial. The patch should apply cleanly.
* **How likely is this patch to cause regressions; how much testing does it need?**: Virtually no chance of user-visible regressions. Small chance of regressions in automated testing.
* **Is Android affected?**: Yes
[Attachment #9363081](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") -
Flags: sec-approval?

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1864118#c5)• 1 year ago |
|  | |

(In reply to Ray Kraesig [:rkraesig] from [comment #3](/show_bug.cgi?id=1864118#c3 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode"))

> * I don't *see* any reason this couldn't happen before [bug 1837079](/show_bug.cgi?id=1837079 "RESOLVED FIXED - Out-of-process Win32 file picker"), but under the circumstances I'm very reluctant to say it could.

I'm less reluctant to say it could, now, though I haven't managed to repro locally.

At any rate, if they're unaffected but the attached patch is uplifted anyway, there should be no deleterious effects.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a305464_75935)• 1 year ago |

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix)
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox121](/buglist.cgi?f1=cf_tracking_firefox121&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [121+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=121%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1864118#c6)• 1 year ago |
|  | |

calling this sec-moderate because of headless mode. Normal users won't be using that, but this could still theoretically be used as a targeted booby-trap for some kind of automated browser/ web-scanner.

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1864118#c7)• 1 year ago |
|  | |

Attached file
[prefs.js](attachment.cgi?id=9363815)
— [Details](attachment.cgi?id=9363815&action=edit)

This does not reproduce on m-c or esr without a custom prefs.js file.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1864118#c8)• 1 year ago |
|  | |

Comment on [attachment 9363081](/attachment.cgi?id=9363081 "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") [[details]](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers")

[Bug 1864118](/show_bug.cgi?id=1864118 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") - deny attempts to open a Windows file picker in headless mode r?#win-reviewers

Approved to land and uplift

[Attachment #9363081](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") -
Flags: sec-approval? → sec-approval+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1864118#c9)• 1 year ago |
|  | |

Pushed by rkraesig@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/706dc0292edf>
deny attempts to open a Windows file picker in headless mode r=win-reviewers,gstoll,cmartin

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1864118#c10)• 1 year ago |
|  | |

Comment on [attachment 9363081](/attachment.cgi?id=9363081 "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") [[details]](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers")

[Bug 1864118](/show_bug.cgi?id=1864118 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") - deny attempts to open a Windows file picker in headless mode r?#win-reviewers

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-moderate, approved
* **User impact if declined**: None to ordinary users; but see [bug 1864118 comment 6](/show_bug.cgi?id=1864118#c6 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") (:dveditz)
* **Fix Landed on Version**: 122
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: not risky; simple, non-intrusive check
[Attachment #9363081](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") -
Flags: approval-mozilla-esr115?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1864118#c11)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/706dc0292edf>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 1 year ago
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 122 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1864118#c12)• 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:rkraesig, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox121` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(rkraesig)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a1157649_695136)• 1 year ago |

[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B)

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1864118#c13)• 1 year ago |
|  | |

Comment on [attachment 9363081](/attachment.cgi?id=9363081 "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") [[details]](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers")

[Bug 1864118](/show_bug.cgi?id=1864118 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") - deny attempts to open a Windows file picker in headless mode r?#win-reviewers

### Beta/Release Uplift Approval Request

* **User impact if declined**: None to ordinary users; but see [bug 1864118 comment 6](/show_bug.cgi?id=1864118#c6 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") (:dveditz)
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: described in [comment 0](/show_bug.cgi?id=1864118#c0 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode"), with `poc.html` and `prefs.js` provided as attachments to the bug
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: not risky; simple, non-intrusive check
* **String changes made/needed**: N/A
* **Is Android affected?**: No
Flags: needinfo?(rkraesig)
[Attachment #9363081](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") -
Flags: approval-mozilla-beta?

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a1517069_699639)• 1 year ago |

Flags: qe-verify+

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1864118#c14)• 1 year ago |
|  | |

(In reply to BugBot [:suhaib / :marco/ :calixte] from [comment #12](/show_bug.cgi?id=1864118#c12 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode"))

> :rkraesig, is this bug important enough to require an uplift?

I have no strong opinion on the matter, and will leave it to the discretion of the relevant release manager(s).

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1864118#c15)• 1 year ago |
|  | |

Comment on [attachment 9363081](/attachment.cgi?id=9363081 "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") [[details]](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers")

[Bug 1864118](/show_bug.cgi?id=1864118 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") - deny attempts to open a Windows file picker in headless mode r?#win-reviewers

Approved for 121.0b5.

[Attachment #9363081](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a1520522_75935)• 1 year ago |

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1864118#c16)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/25c467ebfdfd>

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a1562374_553429)• 1 year ago |

QA Whiteboard: [qa-triaged]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1864118#c17)• 1 year ago |
|  | |

Comment on [attachment 9363081](/attachment.cgi?id=9363081 "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") [[details]](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers")

[Bug 1864118](/show_bug.cgi?id=1864118 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode") - deny attempts to open a Windows file picker in headless mode r?#win-reviewers

Approved for 115.6esr.

[Attachment #9363081](/attachment.cgi?id=9363081&action=edit "Bug 1864118 - deny attempts to open a Windows file picker in headless mode  r?#win-reviewers") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1864118#c18)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/056b65ce1087>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a1577550_75935)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a1597388_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+Summary: heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) → heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1864118#c19)• 1 year ago |
|  | |

We weren’t able to reproduce this error. Nothing happens after Launching Firefox and Running Firefox messages. We tried with all the Windows 2012 x64 asan builds 121.0a1 (2023-11-06) from [treeherder](https://treeherder.mozilla.org/jobs?repo=mozilla-central&revision=925231a8fb5eccf055afb3e9921596d8f990128b). Is there maybe some details that we missed or could some interaction be at fault? Thank you!

Flags: needinfo?(rkraesig)

|  | [Ray Kraesig [:rkraesig]](/user_profile?user_id=699639)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1864118#c20)• 1 year ago |
|  | |

Well, that's odd. I get similar behavior with the Python HTTP server, but it works fine (*i.e.*, correctly reproduces the bug) if you skip that and access the file directly:

`ffpuppet.exe "C:/Users/Ray Kraesig/Downloads/target-asan-2023-11-06/firefox/firefox.exe" --headless -p 1864118-prefs.js -d -u 1864118-poc.html`

I was able to reproduce consistently (n=5) with [this build](https://treeherder.mozilla.org/jobs?repo=mozilla-central&revision=925231a8fb5eccf055afb3e9921596d8f990128b&selectedTaskRun=K6F3EBq0RtensVgfdpen4g.0).

Flags: needinfo?(rkraesig)

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1864118#c21)• 1 year ago |
|  | |

(In reply to Ray Kraesig [:rkraesig] from [comment #20](/show_bug.cgi?id=1864118#c20 "VERIFIED FIXED - heap-buffer-overflow widget/windows/nsWindow.cpp:8197 in nsWindow::PickerOpen(void) in headless mode"))

> Well, that's odd. I get similar behavior with the Python HTTP server, but it works fine (*i.e.*, correctly reproduces the bug) if you skip that and access the file directly:
>
> `ffpuppet.exe "C:/Users/Ray Kraesig/Downloads/target-asan-2023-11-06/firefox/firefox.exe" --headless -p 1864118-prefs.js -d -u 1864118-poc.html`
>
> I was able to reproduce consistently (n=5) with [this build](https://treeherder.mozilla.org/jobs?repo=mozilla-central&revision=925231a8fb5eccf055afb3e9921596d8f990128b&selectedTaskRun=K6F3EBq0RtensVgfdpen4g.0).

Thank you for this additional information.

I've reproduced the error with Fx 121.0a1 (2023-11-06) on Windows 10 (but only after I've uninstalled the antivirus).

Verified fixed with Fx 122.0a1 (2023-12-04) and Fx 121.0b7 on Windows 10.

Status: RESOLVED → VERIFIED
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=verified)Flags: qe-verify+

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a2701885_586683)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main121+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a2704387_586683)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main121+] → [reporter-external] [client-bounty-form] [verif?][adv-main121+][adv-esr115.6+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1864118#c22)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367960) (obsolete)
— [Details](attachment.cgi?id=9367960&action=edit)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1864118#c23)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367967)
— [Details](attachment.cgi?id=9367967&action=edit)

[Attachment #9367960](/attachment.cgi?id=9367960&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1864118#c24)• 1 year ago |
|  | |

Verified fixed with Fx 115.6esr on Windows 10.

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a3061879_578488)• 1 year ago |

Alias: CVE-2023-6861

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1864118#c25)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864118#a17489402_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1864118&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [m.cooolie](/user_profile?user_id=689709)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_49d17580_20250115_094519.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-56

## Security Vulnerabilities fixed in Firefox 121

Announced
December 19, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 121

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6135: NSS susceptible to "Minerva" attack](#CVE-2023-6135)

Reporter
George Pantela (Red Hat) and Hubert Kario (Red Hat)
Impact
high
##### Description

Multiple NSS NIST curves were susceptible to a side-channel attack known as "Minerva". This attack could potentially allow an attacker to recover the private key.

##### References

* [Bug 1853908](https://bugzilla.mozilla.org/show_bug.cgi?id=1853908)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6866: TypedArrays lack sufficient exception handling](#CVE-2023-6866)

Reporter
Tom Schuster
Impact
moderate
##### Description

TypedArrays can be fallible and lacked proper exception handling. This could lead to abuse in other APIs which expect TypedArrays to always succeed.

##### References

* [Bug 1849037](https://bugzilla.mozilla.org/show_bug.cgi?id=1849037)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6868: WebPush requests on Firefox for Android did not require VAPID key](#CVE-2023-6868)

Reporter
John-Mark Gurney
Impact
moderate
##### Description

In some instances, the user-agent would allow push requests which lacked a valid VAPID even though the push manager subscription defined one. This could allow empty messages to be sent from unauthorized parties.
*This bug only affects Firefox on Android.*

##### References

* [Bug 1865488](https://bugzilla.mozilla.org/show_bug.cgi?id=1865488)

#### [#CVE-2023-6869: Content can paint outside of sandboxed iframe](#CVE-2023-6869)

Reporter
Oriol Brufau
Impact
low
##### Description

A `<dialog>` element could have been manipulated to paint content outside of a sandboxed iframe. This could allow untrusted content to display under the guise of trusted content.

##### References

* [Bug 1799036](https://bugzilla.mozilla.org/show_bug.cgi?id=1799036)

#### [#CVE-2023-6870: Android Toast notifications may obscure fullscreen event notifications](#CVE-2023-6870)

Reporter
Hafiizh
Impact
low
##### Description

Applications which spawn a Toast notification in a background thread may have obscured fullscreen notifications displayed by Firefox.
*This issue only affects Android versions of Firefox and Firefox Focus.*

##### References

* [Bug 1823316](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316)

#### [#CVE-2023-6871: Lack of protocol handler warning in some instances](#CVE-2023-6871)

Reporter
Edward "JankhJankh" Prior
Impact
low
##### Description

Under certain conditions, Firefox did not display a warning when a user attempted to navigate to a new protocol handler.

##### References

* [Bug 1828334](https://bugzilla.mozilla.org/show_bug.cgi?id=1828334)

#### [#CVE-2023-6872: Browsing history leaked to syslogs via GNOME](#CVE-2023-6872)

Reporter
honorton via Tor Browser
Impact
low
##### Description

Browser tab titles were being leaked by GNOME to system logs. This could potentially expose the browsing habits of users running in a private tab.

##### References

* [Bug 1849186](https://bugzilla.mozilla.org/show_bug.cgi?id=1849186)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Randell Jesup, Valentin Gosu, Karl Tomlinson, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862777%2C1864015)

#### [#CVE-2023-6873: Memory safety bugs fixed in Firefox 121](#CVE-2023-6873)

Reporter
Andrew McCreight, Yury Delendik
Impact
high
##### Description

Memory safety bugs present in Firefox 120. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855327%2C1862089%2C1862723)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_897e22ca_20250115_094516.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_395a26ad_20250115_094518.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-55

## Security Vulnerabilities fixed in Thunderbird 115.6

Announced
December 19, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.6

#### [#CVE-2023-50762: Truncated signed text was shown with a valid OpenPGP signature](#CVE-2023-50762)

Reporter
Marcus Brinkmann
Impact
high
##### Description

When processing a PGP/MIME payload that contains digitally signed text, the first paragraph of the text was never shown to the user. This is because the text was interpreted as a MIME message and the first paragraph was always treated as an email header section. A digitally signed text from a different context, such as a signed GIT commit, could be used to spoof an email message.

##### References

* [Bug 1862625](https://bugzilla.mozilla.org/show_bug.cgi?id=1862625)

#### [#CVE-2023-50761: S/MIME signature accepted despite mismatching message date](#CVE-2023-50761)

Reporter
Marcus Brinkmann
Impact
high
##### Description

The signature of a digitally signed S/MIME email message may optionally specify the signature creation date and time. If present, Thunderbird did not compare the signature creation date with the message date and time, and displayed a valid signature despite a date or time mismatch. This could be used to give recipients the impression that a message was sent at a different date or time.

##### References

* [Bug 1865647](https://bugzilla.mozilla.org/show_bug.cgi?id=1865647)

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Thunderbird on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Thunderbird was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6862: Use-after-free in nsDNSService](#CVE-2023-6862)

Reporter
Randell Jesup
Impact
moderate
##### Description

A use-after-free was identified in the `nsDNSService::Init`. This issue appears to manifest rarely during start-up.

##### References

* [Bug 1868042](https://bugzilla.mozilla.org/show_bug.cgi?id=1868042)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Karl Tomlinson, Valentin Gosu, Randell Jesup, Yury Delendik, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862089%2C1862777%2C1864015)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


