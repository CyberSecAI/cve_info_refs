=== Content from www.mozilla.org_c8ea4c9e_20250114_232804.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-52

## Security Vulnerabilities fixed in Thunderbird 115.5

Announced
November 21, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.5

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-6204: Out-of-bound memory access in WebGL2 blitFramebuffer](#CVE-2023-6204)

Reporter
JSec of Hayyim Security
Impact
high
##### Description

On some systemsâ€”depending on the graphics settings and driversâ€”it was possible to force an out-of-bounds read and leak memory data into the images created on the canvas element.

##### References

* [Bug 1841050](https://bugzilla.mozilla.org/show_bug.cgi?id=1841050)

#### [#CVE-2023-6205: Use-after-free in MessagePort::Entangled](#CVE-2023-6205)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

It was possible to cause the use of a MessagePort after it had already
been freed, which could potentially have led to an exploitable crash.

##### References

* [Bug 1854076](https://bugzilla.mozilla.org/show_bug.cgi?id=1854076)

#### [#CVE-2023-6206: Clickjacking permission prompts using the fullscreen transition](#CVE-2023-6206)

Reporter
Hafiizh
Impact
high
##### Description

The black fade animation when exiting fullscreen is roughly
the length of the anti-clickjacking delay on permission prompts.
It was possible to use this fact to surprise users by luring them
to click where the permission grant button would be about to appear.

##### References

* [Bug 1857430](https://bugzilla.mozilla.org/show_bug.cgi?id=1857430)

#### [#CVE-2023-6207: Use-after-free in ReadableByteStreamQueueEntry::Buffer](#CVE-2023-6207)

Reporter
M. Coolie
Impact
high
##### Description

Ownership mismanagement led to a use-after-free in ReadableByteStreams

##### References

* [Bug 1861344](https://bugzilla.mozilla.org/show_bug.cgi?id=1861344)

#### [#CVE-2023-6208: Using Selection API would copy contents into X11 primary selection.](#CVE-2023-6208)

Reporter
turistu
Impact
moderate
##### Description

When using X11, text selected by the page using the Selection API was erroneously copied into the primary selection, a temporary storage not unlike the clipboard.
*This bug only affects Thunderbird on X11. Other systems are unaffected.*

##### References

* [Bug 1855345](https://bugzilla.mozilla.org/show_bug.cgi?id=1855345)

#### [#CVE-2023-6209: Incorrect parsing of relative URLs starting with "///"](#CVE-2023-6209)

Reporter
Rachmat Abdul Rokhim
Impact
moderate
##### Description

Relative URLs starting with three slashes were incorrectly parsed, and a
path-traversal "/../" part in the path could be used to override the
specified host. This could contribute to security problems in web sites.

##### References

* [Bug 1858570](https://bugzilla.mozilla.org/show_bug.cgi?id=1858570)

#### [#CVE-2023-6212: Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](#CVE-2023-6212)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1658432%2C1820983%2C1829252%2C1856072%2C1856091%2C1859030%2C1860943%2C1862782)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_8af6ca9e_20250114_232802.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-50

## Security Vulnerabilities fixed in Firefox ESR 115.5.0

Announced
November 21, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.5

#### [#CVE-2023-6204: Out-of-bound memory access in WebGL2 blitFramebuffer](#CVE-2023-6204)

Reporter
JSec of Hayyim Security
Impact
high
##### Description

On some systemsâ€”depending on the graphics settings and driversâ€”it was possible to force an out-of-bounds read and leak memory data into the images created on the canvas element.

##### References

* [Bug 1841050](https://bugzilla.mozilla.org/show_bug.cgi?id=1841050)

#### [#CVE-2023-6205: Use-after-free in MessagePort::Entangled](#CVE-2023-6205)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

It was possible to cause the use of a MessagePort after it had already
been freed, which could potentially have led to an exploitable crash.

##### References

* [Bug 1854076](https://bugzilla.mozilla.org/show_bug.cgi?id=1854076)

#### [#CVE-2023-6206: Clickjacking permission prompts using the fullscreen transition](#CVE-2023-6206)

Reporter
Hafiizh
Impact
high
##### Description

The black fade animation when exiting fullscreen is roughly
the length of the anti-clickjacking delay on permission prompts.
It was possible to use this fact to surprise users by luring them
to click where the permission grant button would be about to appear.

##### References

* [Bug 1857430](https://bugzilla.mozilla.org/show_bug.cgi?id=1857430)

#### [#CVE-2023-6207: Use-after-free in ReadableByteStreamQueueEntry::Buffer](#CVE-2023-6207)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

Ownership mismanagement led to a use-after-free in ReadableByteStreams

##### References

* [Bug 1861344](https://bugzilla.mozilla.org/show_bug.cgi?id=1861344)

#### [#CVE-2023-6208: Using Selection API would copy contents into X11 primary selection.](#CVE-2023-6208)

Reporter
turistu
Impact
moderate
##### Description

When using X11, text selected by the page using the Selection API was erroneously copied into the primary selection, a temporary storage not unlike the clipboard.
*This bug only affects Firefox on X11. Other systems are unaffected.*

##### References

* [Bug 1855345](https://bugzilla.mozilla.org/show_bug.cgi?id=1855345)

#### [#CVE-2023-6209: Incorrect parsing of relative URLs starting with "///"](#CVE-2023-6209)

Reporter
Rachmat Abdul Rokhim
Impact
moderate
##### Description

Relative URLs starting with three slashes were incorrectly parsed, and a
path-traversal "/../" part in the path could be used to override the
specified host. This could contribute to security problems in web sites.

##### References

* [Bug 1858570](https://bugzilla.mozilla.org/show_bug.cgi?id=1858570)

#### [#CVE-2023-6212: Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](#CVE-2023-6212)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1658432%2C1820983%2C1829252%2C1856072%2C1856091%2C1859030%2C1860943%2C1862782)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.debian.org_5a0d939f_20250114_232758.html ===


---

[[Date Prev](msg00256.html)][[Date Next](msg00258.html)]
[[Thread Prev](msg00256.html)][[Thread Next](msg00258.html)]
[[Date Index](maillist.html#00257)]
[[Thread Index](threads.html#00257)]

# [SECURITY] [DSA 5561-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5561-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 22 Nov 2023 19:19:54 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/ZV5UWjv1z3EDpYay%40seger.debian.org)Â [ZV5UWjv1z3EDpYay@seger.debian.org](msg00257.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5561-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
November 22, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2023-6204 CVE-2023-6205 CVE-2023-6206 CVE-2023-6207
                 CVE-2023-6208 CVE-2023-6209 CVE-2023-6212

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, information leaks or clickjacking.

For the oldstable distribution (bullseye), these problems have been fixed
in version 115.5.0esr-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 115.5.0esr-1~deb12u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmVeU2MACgkQEMKTtsN8
TjYaBQ//Q0UIc5rK8lkm+CPkloFz8UCwFthZyP5d32mjMI/LzO0mk/JqYc/8n/NI
+eJ34GLzLW1oaF/puNSGtITtwWL3908/qXiE/EfEZSW+NBUV2wRZrchUYuwXSP+S
xxxXKE0+LcuQhfLja/LZMvvB8CNPAT1+zaLmG/CRu/8VN++e8wE+daBbaYg0KOKd
vgDtYDNX+3aV7CEuDfQLbRPJh+RN0AGusDXhMLJdn5FQC4q3mielHIxCm8dMf/DV
PR5ugVPxCIhm4r13zAaTsqI4zQzIAEKss/PZ09Jv0Rn30kFWRr5Jmhv2yWX0HhAg
bx2Ot/LySgHoQkfHjREkYrdV7tS3lh2qraiDZUChuNIR5QxUwn/TA6mXLSCUDk7o
sXTJa/+lAOo0a838cFPNBLYgQxYopWUo6OAu4331nJyNPpvlPbTdZnUpH4UOgBUj
oD/mEq41JwDPkjweP4bYV5TmdHAlPBxnv2ELLcsEavAJRiCcroqEl26rd8CPUFH0
eO1UgSdGZw9HOjW0+OOZQQVYeLHLdMIrbUL5jIPpix1N1aa/IEc7aXzYa8O1F5Qk
I5bcFJ/7yLy7NZs+jXWs53z78bJc1mRoQWs45KQlfAGXtljFYhXIvHy6O45jWi6R
/yr5DJYZhOPhfCkXjh8tWUcKcLhFF5jzZImjPk97TSjkeCoidMI=
=q4yZ
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_5dc69d60_20250114_232800.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-49

## Security Vulnerabilities fixed in Firefox 120

Announced
November 21, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 120

#### [#CVE-2023-6204: Out-of-bound memory access in WebGL2 blitFramebuffer](#CVE-2023-6204)

Reporter
JSec of Hayyim Security
Impact
high
##### Description

On some systemsâ€”depending on the graphics settings and driversâ€”it was possible to force an out-of-bounds read and leak memory data into the images created on the canvas element.

##### References

* [Bug 1841050](https://bugzilla.mozilla.org/show_bug.cgi?id=1841050)

#### [#CVE-2023-6205: Use-after-free in MessagePort::Entangled](#CVE-2023-6205)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

It was possible to cause the use of a MessagePort after it had already
been freed, which could potentially have led to an exploitable crash.

##### References

* [Bug 1854076](https://bugzilla.mozilla.org/show_bug.cgi?id=1854076)

#### [#CVE-2023-6206: Clickjacking permission prompts using the fullscreen transition](#CVE-2023-6206)

Reporter
Hafiizh
Impact
high
##### Description

The black fade animation when exiting fullscreen is roughly
the length of the anti-clickjacking delay on permission prompts.
It was possible to use this fact to surprise users by luring them
to click where the permission grant button would be about to appear.

##### References

* [Bug 1857430](https://bugzilla.mozilla.org/show_bug.cgi?id=1857430)

#### [#CVE-2023-6207: Use-after-free in ReadableByteStreamQueueEntry::Buffer](#CVE-2023-6207)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

Ownership mismanagement led to a use-after-free in ReadableByteStreams

##### References

* [Bug 1861344](https://bugzilla.mozilla.org/show_bug.cgi?id=1861344)

#### [#CVE-2023-6208: Using Selection API would copy contents into X11 primary selection.](#CVE-2023-6208)

Reporter
turistu
Impact
moderate
##### Description

When using X11, text selected by the page using the Selection API was erroneously copied into the primary selection, a temporary storage not unlike the clipboard.
*This bug only affects Firefox on X11. Other systems are unaffected.*

##### References

* [Bug 1855345](https://bugzilla.mozilla.org/show_bug.cgi?id=1855345)

#### [#CVE-2023-6209: Incorrect parsing of relative URLs starting with "///"](#CVE-2023-6209)

Reporter
Rachmat Abdul Rokhim
Impact
moderate
##### Description

Relative URLs starting with three slashes were incorrectly parsed, and a
path-traversal "/../" part in the path could be used to override the
specified host. This could contribute to security problems in web sites.

##### References

* [Bug 1858570](https://bugzilla.mozilla.org/show_bug.cgi?id=1858570)

#### [#CVE-2023-6210: Mixed-content resources not blocked in a javascript: pop-up](#CVE-2023-6210)

Reporter
Godson Bastin
Impact
low
##### Description

When an https: web page created a pop-up from a "javascript:" URL,
that pop-up was incorrectly allowed to load blockable content such
as iframes from insecure http: URLs

##### References

* [Bug 1801501](https://bugzilla.mozilla.org/show_bug.cgi?id=1801501)

#### [#CVE-2023-6211: Clickjacking to load insecure pages in HTTPS-only mode](#CVE-2023-6211)

Reporter
Muneaki Nishimura
Impact
low
##### Description

If an attacker needed a user to load an insecure http: page and knew
that user had enabled HTTPS-only mode, the attacker could have
tricked the user into clicking to grant an HTTPS-only exception
if they could get the user to participate in a clicking game.

##### References

* [Bug 1850200](https://bugzilla.mozilla.org/show_bug.cgi?id=1850200)

#### [#CVE-2023-6212: Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](#CVE-2023-6212)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119, Firefox ESR 115.4, and Thunderbird 115.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1658432%2C1820983%2C1829252%2C1856072%2C1856091%2C1859030%2C1860943%2C1862782)

#### [#CVE-2023-6213: Memory safety bugs fixed in Firefox 120](#CVE-2023-6213)

Reporter
Mozilla Developers
Impact
high
##### Description

Memory safety bugs present in Firefox 119. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 120](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1849265%2C1851118%2C1854911)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_0167f1f6_20250114_232756.html ===


---

[[Date Prev](msg00029.html)][[Date Next](msg00031.html)]
[[Thread Prev](msg00029.html)][[Thread Next](msg00031.html)]
[[Date Index](maillist.html#00030)]
[[Thread Index](threads.html#00030)]

# [SECURITY] [DLA 3674-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3674-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 30 Nov 2023 14:26:11 +0000 (GMT)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20231130142611.2FBF12A00F1%40andromeda)Â [20231130142611.2FBF12A00F1@andromeda](msg00030.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3674-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
November 30, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.5.0-1~deb10u1
CVE ID         : CVE-2023-6204 CVE-2023-6205 CVE-2023-6206 CVE-2023-6207
                 CVE-2023-6208 CVE-2023-6209 CVE-2023-6212

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.5.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmVom4AACgkQnUbEiOQ2
gwIsRg/8DPpGw7lm6m9KnWU1B1HLHBk0qiBslBOTF3n8G2P+N3yZ6WxVC1cBIzkC
AkhAxxr4DKIr0vPH5LDx6QpcN/uk8UwYPPBPfqw2pu1cO5gpduNKNEeHyboLhrn6
wH4J9LK62VqPcsRtwm/H+wl/fOPw0+U5j66lMHKCWRhxizlBYqHhZOxnkianAyoM
zpRuz6zXE5a9JT8SdDuLnMXztziowjfyghAZM0vgDlyM4r/UxUisyH3zBip6845q
EjCdCdEUN4uUk5ngELNICiwt/ociRLpIN7NXdAH108qGmBUIDB/mJHIdDOECfiZr
wrM/lg0HqOupHZ8dVfTv9wxXbVmEcVhFx78frIM0Pi1trWrNNN4X5uceZ2GrWiKz
h1tQBcbRA1LVgno2Jdfdk9IA2XSksFEpYHvwte9gp0kc8dGpwkSZJwKjxj+VHg7D
X1/Ldmuqd6D81yKa8Rm84wqgsU9HpXAYWl2amWxLRceeZ1QKIxLrV+p3SdQwMQEe
W2e08hRT4ProNa2e13HL2DWMIcl4ga9H6gVRPpR6NFWR2+RT9NCQtIE6eAbjtcvz
chPbtXXJCRpszxpp/0YAZ9EdRLwhiTFme/RasNBgy7okDfUB5oR0j8+HnpCAN5fs
uZvSijNmtwprIc2TrpUl0tPcc2T8rnO1WRneoXzja8vJoz2yXEg=
=kU0m
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_e50204b0_20250114_232753.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1855345)
* [XML](/show_bug.cgi?ctype=xml&id=1855345)

Closed
[Bug 1855345](/show_bug.cgi?id=1855345)
(CVE-2023-6208)

Opened 1 year ago
Closed 1 year ago

# On X11, any page can freely write to the primary selection

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

On X11, any page can freely write to the primary selection

## Categories

### (Core :: DOM: Selection, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Selection#DOM%3A%20Selection)

DOM: Selection
â–¾

Core :: DOM: Selection
This component includes bugs for selection handling from <https://w3c.github.io/selection-api/>.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Selection&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Selection&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Selection)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

121 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [120+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=120%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox118 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix) |
| firefox119 | [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix) |
| firefox120 | [+](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=verified) |
| firefox121 | [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 120+ | verified |
| firefox-esr128 | --- | --- |
| firefox118 |  | wontfix |
| firefox119 | + | wontfix |
| firefox120 | + | verified |
| firefox121 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: u734064, Assigned: masayuki)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/900caab146bc7a489b3854cf10acf93f?d=mm&size=40)  [masayuki](/user_profile?user_id=34283)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/18f6d6c8377d2b21a49a5824381b4116?d=mm&size=40)  [u734064](/user_profile?user_id=734064)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

22 people

## References

### ( [URL](https://www.openwall.com/lists/oss-security/2023/10/17/1 "https://www.openwall.com/lists/oss-security/2023/10/17/1") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[openwall.com/lists/oss-security/2023/...](https://www.openwall.com/lists/oss-security/2023/10/17/1 "https://www.openwall.com/lists/oss-security/2023/10/17/1")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-moderate, X11, Whiteboard: [adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6208

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[X11](/buglist.cgi?keywords=X11&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c42 "1 year ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [sec-bounty-hof](#c46 "7 months ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty-hof | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 1 obsolete file)

| [example.html](/attachment.cgi?id=9355227)  [1 year ago](#c1)  [u734064](/user_profile?user_id=734064)   427 bytes, text/html |  | [Details](/attachment.cgi?id=9355227&action=edit) |
| --- | --- | --- |
| [simplified example](/attachment.cgi?id=9355450)  [1 year ago](#c8)  [u734064](/user_profile?user_id=734064)   318 bytes, text/html |  | [Details](/attachment.cgi?id=9355450&action=edit) |
| [diff against 759223:bdfdb575f9a9](/attachment.cgi?id=9357281)  [1 year ago](#c19)  [u734064](/user_profile?user_id=734064)   4.18 KB, text/plain |  | [Details](/attachment.cgi?id=9357281&action=edit) |
| [Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!](/attachment.cgi?id=9359698)  [1 year ago](#c26)  [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-beta+](#c33 "1 year ago")  dmeehan : [approval-mozilla-release-](#c40 "1 year ago")  diannaS : [approval-mozilla-esr115+](#c36 "1 year ago") | [Details](/attachment.cgi?id=9359698&action=edit) | [Review](/attachment.cgi?id=9359698) |
| [loremipsum.html](/attachment.cgi?id=9359999)  [1 year ago](#c28)  [Kagami Rosylight [:saschanaz] (they/them)](/user_profile?user_id=473060)   900 bytes, text/html |  | [Details](/attachment.cgi?id=9359999&action=edit) |
| [advisory.txt](/attachment.cgi?id=9364415)  [1 year ago](#c43)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   315 bytes, text/plain |  | [Details](/attachment.cgi?id=9364415&action=edit) |
| [advisory.txt](/attachment.cgi?id=9364421)  [1 year ago](#c44)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   343 bytes, text/plain |  | [Details](/attachment.cgi?id=9364421&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1855345#c0)â€¢ 1 year ago |
|  | |

In Firefox running on X11, any script from any page can write to the

primary selection -- which on X11 is the main and most used copy-paste

mechanism.

No "secure context", "transient activation", extra permissions or any other

prerequisites (as required by the much less valuable Clipboard.writeText())

are needed.

This basically means that any visited page can take over the victim's system

the first time she tries to paste something in the terminal.

With prior knowledge of the user's workflow and preferences, devising a

succesful attack is a matter of minutes. Getting something that works

reliably for most Linux/Users users is more complicated but still orders

of magnitude easier than exploiting some memory corruption or similar bug.

=== Example ===

Load the following html snippet inside a Firefox running on top of Xorg

(Xorg, not Wayland, see below why). The protocol (http:, file:, etc) or

whether this runs inside an iframe does not matter.

Then switch to a gnome-terminal or xterm window, and press the middle

button of the mouse or shift-Insert to paste the selection.

Every 500ms you'll get a new text made up of the current time and the

page's url.

------------------x-------------------

<!doctype html>

<title>write to the primary selection</title>

intentionally left blank

<script>

function setXPrimary(text){

let d = document.body.appendChild(document.createElement('pre'));

d.style.fontSize = 0;

setTimeout(function(){

d.textContent = text;

getSelection().selectAllChildren(d);

d.remove();

}, 0);

}

setInterval(function(){

setXPrimary(Date.now() / 1000 + ' ' + document.location)

}, 500);

</script>

------------------x-------------------

=== NON-mitigating factors ===

1. Wayland only allows the window having the keyboard focus to write to

   the primary selection. This complicates things a bit, but not for much; I

   think it's possible to detect via timing DOM calls, etc. whether the main

   firefox window has acquired the focus and only then write the selection,

   even if it's not the tab or iframe the script runs in that has the focus.
2. The "bracketed paste" feature of the terminal and shell (the default

   in recent bash) means that you cannot just use "setXPrimary('rm -fr ~\n')"

   and be done: it's the user who has to press the Enter for it to run.

However, even naive workarounds like

```
setXPrimary("\n" + "echo reboot" + "\n".repeat(100) +
	" ".repeat(30) + "\n".repeat(100))

```

which will confuse the user with a screen like

```
dummy@ohzd:~$ echo first
first
dummy@ohzd:~$ true
dummy@ohzd:~$
#	<-- cursor here, most users will hit Enter to get a new prompt

```

will do for it most of the time.

Flags: sec-bounty?

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1855345#c1)â€¢ 1 year ago |
|  | |

Attached file
[example.html](attachment.cgi?id=9355227)
â€” [Details](attachment.cgi?id=9355227&action=edit)

looks like the example html snippet was mangled in the description; here is the same example, as an attachment

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1855345#c2)â€¢ 1 year ago |
|  | |

I'll start this off in DOM Selection, but maybe there's a Widget GTK component to this.

Group: firefox-core-security â†’ dom-core-securityComponent: Security â†’ DOM: SelectionProduct: Firefox â†’ Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a37744_406194)â€¢ 1 year ago |

OS: Unspecified â†’ LinuxHardware: Unspecified â†’ All

|  | [Emilio Cobos Ãlvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1855345#c3)â€¢ 1 year ago |
|  | |

We should probably only set the primary clipboard if there's a user interaction or so, perhaps?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1855345#c4)â€¢ 1 year ago |
|  | |

(In reply to Emilio Cobos Ãlvarez (:emilio) from [comment #3](/show_bug.cgi?id=1855345#c3 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> We should probably only set the primary clipboard if there's a user interaction or so, perhaps?

Yes, that seems the most plausible option. It'd also be interesting to know what other browsers do here...

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1855345#c5)â€¢ 1 year ago |
|  | |

`watch -n 1 xsel` may be useful.

Different behavior was [reported](https://bugzilla.mozilla.org/show_bug.cgi?id=1567160#c2) for `HTMLInputElement.setSelectionRange()`. I wonder why `Selection.selectAllChildren()` would be different.

With `MOZ_DISABLE_CONTENT_SANDBOX=1 mozregression --launch 2021-01-01`, I see similar behavior but the selection is often being set to empty, for reasons I do not know.

[Chromium at least tests for user-input](https://bugzilla.mozilla.org/show_bug.cgi?id=1567160#c5).

Odd that sites have wanted this behavior for a long time but haven't discovered it.

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1855345#c6)â€¢ 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #4](/show_bug.cgi?id=1855345#c4 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> (In reply to Emilio Cobos Ãlvarez (:emilio) from [comment #3](/show_bug.cgi?id=1855345#c3 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))
>
> > We should probably only set the primary clipboard if there's a user interaction or so, perhaps?
>
> Yes, that seems the most plausible option. It'd also be interesting to know what other browsers do here...

I would *very* much prefer to have it as an option of `Clipboard.writeText()` or a separate method that I could catch and block from an extension's content script with [`exportFunction()`](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts#exportfunction). That would also be more straightforward to use from apps like editors and such.

Having the primary selection set as a hidden side effect of using the Selection API is still icky, even if gated by user interaction checks or similar.

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1855345#c7)â€¢ 1 year ago |
|  | |

(In reply to Karl Tomlinson (:karlt) from [comment #5](/show_bug.cgi?id=1855345#c5 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> With `MOZ_DISABLE_CONTENT_SANDBOX=1 mozregression --launch 2021-01-01`, I see similar behavior but the selection is often being set to empty, for reasons I do not know.

That's probably because of some race triggered by my badly over-engineered example (sorry).

Here's a simplified example which should work more reliably in all versions from at least firefox-42.0 through the lates nightly (120.0a1).

```
<!DOCTYPE HTML>
<html lang=en>
<title>write to the primary selection (#2 take)</title>
<pre id=pre style=font-size:0></pre>
intentionally left blank
<script>
setInterval(function(){
        pre.textContent = Date.now() / 1000 + ' ' + document.location + '\n';
        getSelection().selectAllChildren(pre);
}, 500)
</script>

```

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1855345#c8)â€¢ 1 year ago |
|  | |

Attached file
[simplified example](attachment.cgi?id=9355450)
â€” [Details](attachment.cgi?id=9355450&action=edit)

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1855345#c9)â€¢ 1 year ago |
|  | |

`Selection.selectAllChildren` [is mapped to `Selection::SelectAllChildrenJS`](https://searchfox.org/mozilla-central/rev/118283c2e3eb393e9b1ca00a0c328e32eeab1c40/dom/webidl/Selection.webidl#67-68). [The method sets `mCalledByJS` to `true`](https://searchfox.org/mozilla-central/rev/118283c2e3eb393e9b1ca00a0c328e32eeab1c40/dom/base/Selection.cpp#3012). Then, [`AutoCopyListener::OnSelectionChange` is called with `nsISelectionListener::JS_REASON | nsISelectionListener::SELECTALL_REASON`](https://searchfox.org/mozilla-central/rev/118283c2e3eb393e9b1ca00a0c328e32eeab1c40/dom/base/Selection.cpp#3513,3555-3556,3562). Finally, [only `nsISelectionListener::SELECTALL_REASON` is checked to consider whether the primary selection is updated](https://searchfox.org/mozilla-central/rev/118283c2e3eb393e9b1ca00a0c328e32eeab1c40/layout/generic/nsFrameSelection.cpp#3342,3344,3365-3367).

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1855345#c10)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855345&comment_id=16596624 "1 revision") |
|  | |

I'll post a patch for just avoiding that only `Selection.selectAllChildren` can update the clipboard. I think that we should discuss better handling in [bug 1567160](/show_bug.cgi?id=1567160 "NEW - Under Linux, selected text is not copied in primary clipboard on some code view textboxes (jsfiddle, codepen, ...)").

Assignee: nobody â†’ masayukiStatus: UNCONFIRMED â†’ ASSIGNEDEver confirmed: true

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1855345#c11)â€¢ 1 year ago |
|  | |

(In reply to turistu from [comment #6](/show_bug.cgi?id=1855345#c6 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> Having the primary selection set as a hidden side effect of using the Selection API is still icky, even if gated by user interaction checks or similar.

What do you think should happen instead?

If a website has a "select all" button (or context menu entry...) next to a rich text editor (contenteditable), that uses the selection API to select text, wouldn't the expected behaviour on X11 and similar be that this makes it to the primary selection?

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1855345#c12)â€¢ 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #11](/show_bug.cgi?id=1855345#c11 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> (In reply to turistu from [comment #6](/show_bug.cgi?id=1855345#c6 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))
>
> > Having the primary selection set as a hidden side effect of using the Selection API is still icky, even if gated by user interaction checks or similar.
>
> What do you think should happen instead?

Highlight the text without putting it into the primary selection.

AFAICS, there are 4 ways out of this.

1. Only allow the Selection API functions when called as a result of user action (the so called "transient activation") and only from secure contexts. Totally unacceptable as it would break a lot of sites which are using the Selection API just for highlighting search results and other text (instead of inserting `<span>` elements or other ugly kludge).
2. Allow the Selection API to be used at any time, but only set the primary selection when some conditions like "transient activation", https, etc are met. A script could call `addRange()` and `selectAllChildren()` in the *hope* that that would also copy the text to the clipboard, but would have no way to know if that actually *happened at all* (unlike with `Clipboard.writeText()`, which returns a promise). Writing non-visible or non-highlighted text to the selection would require sordid hacks like transparent elements. Malware would still be able to abuse it to write to selection something else than what the user has selected. Extensions would not be able to block them without breaking things in the same way 1. would.
3. Allow the Selection API to be used at any time (and continue to work as a precursor to windows-style Ctrl-C and `execCommand('copy')` as it does now) but **without affecting the primary selection in any way**. Implement copying to the primary selection either as an option of `Clipboard.writeText()`, a separate Clipboard API function (subject to the same or more stringent conditions than `writeText()`), or make `writeText()` set both `X_PRIMARY` and `X_CLIPBOARD` by default. For most Linux/BSD users, the "Copy" buttons will instantly start to work on most sites (or could be easily made to) in the same way "Copy outerHTML" does in the firefox's own web dev pane. Extensions would be able to *selectively* block that API from a content script with `exportFunction()`.
4. Keep things as they are and just document them (so that people know what to expect and make their own assessment).

> If a website has a "select all" button (or context menu entry...) next to a rich text editor (contenteditable), that uses the selection API to select text, wouldn't the expected behaviour on X11 and similar be that this makes it to the primary selection?

Yes it would be nice it that just worked as expected, but letting that work via 2. is too dangerous (yet not at all reliable!), while 3. would easily allow to achieve that in a simple and obvious way.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1855345#c13)â€¢ 1 year ago |
|  | |

The security considerations should be the same as for the regular clipboard API write: only from a secure context, only with a user activation.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1855345#c14)â€¢ 1 year ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #13](/show_bug.cgi?id=1855345#c13 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> The security considerations should be the same as for the regular clipboard API write: only from a secure context, only with a user activation.

I find the sec-moderate label COMPLETELY INNACURATE -- for a bug which allows any visited site to simply take over the user's machine without them even having to interact in any way with the site.

Also the linux-only tag: this actually works on \*BSD and Solaris too.

And also, because the way it's used and the way it works, writing to the primary selection on X11/Unix is much more dangerous than writing to the clipboard on Windows or Mac.

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1855345#c15)â€¢ 1 year ago |
|  | |

(In reply to Karl Tomlinson (:karlt) from [comment #5](/show_bug.cgi?id=1855345#c5 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> `watch -n 1 xsel` may be useful.

FWIW, the Xfixes X11 extension allow you to monitor selection changes in real time, no need to poll for it every second or so.

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1855345#c16)â€¢ 1 year ago |
|  | |

(In reply to turistu from [comment #14](/show_bug.cgi?id=1855345#c14 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> I find the sec-moderate label COMPLETELY INNACURATE

Sorry for the misspelling, so that should've read INACCURATE

> the way it works, writing to the primary selection on X11/Unix

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) â†’ [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[X11](/buglist.cgi?keywords=X11&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1855345#c17)â€¢ 1 year ago |
|  | |

Please do not adjust the sec severity flags yourself.

Needinfo'ing Dan for consideration of [comment #14](/show_bug.cgi?id=1855345#c14 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") re: sec-severity.

Flags: needinfo?(dveditz)Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) â†’ [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1855345#c18)â€¢ 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #17](/show_bug.cgi?id=1855345#c17 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> Please do not adjust the sec severity flags yourself.

And why not, if the interface allows it?

I've just corrected a bogus flag. It's not like I can take over your "processes" or force you to do anything by just pushing buttons here (or could I?).

The [descriptions](https://bugzilla.mozilla.org/describekeywords.cgi) of the severity flags say:

> `sec-moderate` Vulnerabilities which can provide an attacker additional information or positioning that could be used in combination with other vulnerabilities.
>
> `sec-high` Obtain confidential data from other sites the user is visiting or the local machine, or inject data or code into those sites, requiring no more than normal browsing actions. Exploitable web vulnerabilities that can lead to the targeted compromise of a small number of users.
>
> `sec-critical` Exploitable vulnerabilities which can lead to the widespread compromise of many users.

This is a bug where a random page from a background tab can run arbitrary code on the user's computer (possibly with root privileges, if the user is into `sudo` or `doas`), without the user having to interact with the page in any way. There are systems (Alpine Linux, OpenBSD, etc) where even the cartoon version of the exploit (`writeXPrimary('rm -fr ~\r')`) works 100% in their *default* configuration.

Bypassing hurdles like the bracketed-paste feature of readline/bash or zsh requires more skill than that, but it's still easy. If you think that that is a big hurdle, or that the lack of such of such feature qualifies itself as a vulnerability -- i.e. each program (but firefox itself, of course) should treat any user input as potentially hostile, remote-controlled data, then please state it clearly to have it on record here.

> Needinfo'ing Dan for consideration of [comment #14](/show_bug.cgi?id=1855345#c14 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") re: sec-severity.

No info is forthcoming. There are 10 days already with **0 technical engagement** (besides the odd vacuous statement) from your part. It looks more and more like sharing this info with you was a horrible terrible mistake from my part.

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1855345#c19)â€¢ 1 year ago |
|  | |

Attached file
[diff against 759223:bdfdb575f9a9](attachment.cgi?id=9357281)
â€” [Details](attachment.cgi?id=9357281&action=edit)

(In reply to turistu from [comment #12](/show_bug.cgi?id=1855345#c12 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))
> AFAICS, there are 4 ways out of this.
>
> 3. Allow the Selection API to be used at any time (and continue to work as a precursor to windows-style Ctrl-C and `execCommand('copy')` as it does now) but \*\*without affecting the primary selection in any way\*\*. Implement copying to the primary selection either as an option of `Clipboard.writeText()`, a separate Clipboard API function (subject to the same or more stringent conditions than `writeText()`), or make `writeText()` set both `X\_PRIMARY` and `X\_CLIPBOARD` by default. For most Linux/BSD users, the "Copy" buttons will instantly start to work on most sites (or could be easily made to) in the same way "Copy outerHTML" does in the firefox's own web dev pane. Extensions would be able to \*selectively\* block that API from a content script with `exportFunction()`.
Just for the record, here is a patch implementing this.
The first part remove javascript's ability to indirectly mess with the system's clipboard. AFAIK this should only affect `Selection.selectAllChildren()`; other functions of the Selection API ('.addRange()`, etc) or `HTMLInputElement.setSelectionRange()` were \*\*already broken\*\*, so this does not really change anything, beside fixing the vulnerability. The only code that this would break is probably my own little extension.
The second parts adds an option to use the primary selection to `Clipboard.write()` and `.writeText()`. Sample usage is:
```
navigator.clipboard.writeText(some\_text, {useX11Primary: true})
```
Should you take this seriously, I can do the same for `.read()`, and also write some tests and such.
```
```

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1855345#c20)â€¢ 1 year ago |
|  | |

> Needinfo'ing Dan for consideration of [comment #14](/show_bug.cgi?id=1855345#c14 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") re: sec-severity

I obviously don't understand how the X11 Primary Clipboard is used well enough to rate this.

Flags: needinfo?(dveditz)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1855345#c21)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855345&comment_id=16619104 "1 revision") |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

[]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1855345#c22)â€¢ 1 year ago |
|  | |

While it is true that if the attacker pulls it off, they can do basically anything, it does require some specific steps from the user, which reduces the danger a bit. The user has to go to a console and hit paste (and possibly enter), while the attacker payload is still in the buffer.

If the user goes to hit paste in the console, they'd presumably be hitting copy themselves at some point for the text they want, which will replace the attacker payload. If we assume they aren't selecting text themselves from the attacker page (because if they were, the ability to bypass the user interaction requirement would matter less), then that means the attacker page is more likely to be in the background, and we throttle setInterval and other ways to run script when a page is in the background (to reduce energy usage), so it would be harder for the page to re-overwrite the buffer during that time.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [u734064](/user_profile?user_id=734064)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1855345#c23)â€¢ 1 year ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #22](/show_bug.cgi?id=1855345#c22 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> While it is true that if the attacker pulls it off, they can do basically anything, it does require some specific steps from the user,

Yes, the most *specific* step of which is using firefox at all

> which reduces the danger a bit. The user has to go to a console and hit paste (and possibly enter), while the attacker payload is still in the buffer.

There's of course no clipboard "buffer" whatsoever on X11. Neither for the primary nor for the clipboard selection.

> If the user goes to hit paste in the console, they'd presumably be hitting copy themselves at some point for the text they want, which will replace the attacker payload

What are you talking about "going to paste in the console" and "hitting copy"? Have you even read my bug report? Are you even using an X11 system at all?

The user is happily working in their terminal or editor, and then --without having to do anything out of the ordinary-- she gets powned by a page from a background tab from a minimized firefox window which has hijacked the selection just in between a copy and a paste. That's it.

> then that means the attacker page is more likely to be in the background, and we throttle setInterval and other ways to run script when a page is in the background (to reduce energy usage)

Throttling does not matter at all -- in fact, trying to hijack the selection faster than 500ms or so would be counterproductive, because the user will immediately notice that she's not able to select anything. Unlike firefox, most X11 program will de-highlight the text upon losing the primary selection's ownership. And 500ms-3s is exactly the sweet spot between selecting and pasting for most users.

But all that's about my silly example, which was only meant as an illustration. But there is at least one terminal emulator with at least a couple thousand users where even karlt's example (`watch -n1 xsel`) is more than enough to run arbitrary code on the user's machine.

> so it would be harder for the page to re-overwrite the buffer during that time.

Yes, keep pounding on that "buffer". Maybe it will come into existence by just believing in it.

I for one am done with this here.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1855345#c24)â€¢ 1 year ago |
|  | |

(Sorry for the delay to put the patch, my Linux environment was broken, and not yet recovered/rebuilt.)

Severity: -- â†’ S2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1855345#c25)â€¢ 1 year ago |
|  | |

It looks like the original reporter of this bug [has posted this vulnerability publicly](https://www.openwall.com/lists/oss-security/2023/10/17/1), on October 17.

[Tracking Requested - why for this release]: sec-moderate, but the issue has been made public and there's a clear path to fixing this, so we want to get it out in a timely fashion.

URL: [https://www.openwall.com/lists/oss-se...](https://www.openwall.com/lists/oss-security/2023/10/17/1)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected)
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox119](/buglist.cgi?f1=cf_tracking_firefox119&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%3F)
[tracking-firefox120](/buglist.cgi?f1=cf_tracking_firefox120&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%3F)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=%3F)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2137283_406194)â€¢ 1 year ago |

Group: dom-core-security â†’ core-security-release

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2163831_690067)â€¢ 1 year ago |

[tracking-firefox119](/buglist.cgi?f1=cf_tracking_firefox119&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B)
[tracking-firefox120](/buglist.cgi?f1=cf_tracking_firefox120&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%2B)

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1855345#c26)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!](attachment.cgi?id=9359698)
â€” [Details](attachment.cgi?id=9359698&action=edit)

Even though there is a reasonable usabe like [bug 1567160](/show_bug.cgi?id=1567160 "NEW - Under Linux, selected text is not copied in primary clipboard on some code view textboxes (jsfiddle, codepen, ...)"), we should

ensure that `AutoCopyListener` never update clipboard when the selection

change is caused by a Selection API call.

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1855345#c27)â€¢ 1 year ago |
|  | |

(I'll be offline Thu and Wed. Therefore, feel free to steal and/or land the patch. I think that it's enough safe to uplift even into ESR.)

|  | [Kagami Rosylight [:saschanaz] (they/them)](/user_profile?user_id=473060) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1855345#c28)â€¢ 1 year ago |
|  | |

Attached file
[loremipsum.html](attachment.cgi?id=9359999)
â€” [Details](attachment.cgi?id=9359999&action=edit)

A repro for mstange's question for macOS behavior in Phab:

1. Open the attached file
2. Select some random text in the lorem ipsum paragraph
3. Soon after that `consetetur` will be selected by the script
4. Tap "Firefox Nightly -> Services -> Look Up in Dictionary"
5. See which text shows up

Nightly: consetetur

The patch with JS\_REASON: the random text you selected before the selection change

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1855345#c29)â€¢ 1 year ago |
|  | |

Pushed by masayuki@d-toybox.com:
<https://hg.mozilla.org/integration/autoland/rev/88e0043c5aa4>
Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt,smaug

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1855345#c30)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359698](/attachment.cgi?id=9359698 "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") [[details]](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!")

[Bug 1855345](/show_bug.cgi?id=1855345 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!

### Beta/Release Uplift Approval Request

* **User impact if declined**: The "primary" buffer is automatically updated by JS with a Selection API, `Selection.selectAllChildren()`.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: 1. Run Firefox on Linux

2. Type a word in the search bar or URL bar then, select it
3. Open the testcase
4. Middle click in the search bar or URL bar

Then, the middle click should paste the word you selected in the search bar or URL bar. Note that if you touch the test case, e.g., click in the test case, the primary buffer is still updated even after the patch is applied.

* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch makes `AutoCopyListener` do nothing if it comes from a Selection API call. If some web apps use this path for updating the primary buffer without any malice, the feature would be broken, but it should be restored once [bug 1567160](/show_bug.cgi?id=1567160 "NEW - Under Linux, selected text is not copied in primary clipboard on some code view textboxes (jsfiddle, codepen, ...)") is fixed later.
* **String changes made/needed**:
* **Is Android affected?**: Yes

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This bug is really annoying because web apps can change the primary buffer content without users' operation. And this issue has already been published.
* **User impact if declined**: The "primary" buffer is automatically updated by JS with a Selection API, `Selection.selectAllChildren()`.
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch makes `AutoCopyListener` do nothing if it comes from a Selection API call. If some web apps use this path for updating the primary buffer without any malice, the feature would be broken.
[Attachment #9359698](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") -
Flags: approval-mozilla-release?
[Attachment #9359698](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") -
Flags: approval-mozilla-esr115?
[Attachment #9359698](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") -
Flags: approval-mozilla-beta?

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2512770_34283)â€¢ 1 year ago |

Flags: qe-verify+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1855345#c31)â€¢ 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/88e0043c5aa4>

Status: ASSIGNED â†’ RESOLVEDClosed: 1 year ago
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 121 Branch

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2605511_553429)â€¢ 1 year ago |

QA Whiteboard: [qa-triaged]

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1855345#c32)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855345&comment_id=16641276 "1 revision") |
|  | |

I am attempting to understand how to reproduce/verify this, but I am having trouble with it; @Masayuki Nakano can you clear up some confusion related to the steps in the uplift request?

1. Regarding step 2: does it matter how the word is selected? Is primary selection not done a certain way? (CTRL+A? double-click? triple-click?)
2. Regarding step 3: Which test case should we use? example.html or another?
3. how do you suggest opening the test case? (I think we should definitely not copy-paste it considering it might erase the current primary selection) Does it matter?
4. Regarding step 4: Should we perform the middle-click in a new tab? Or over the test case's URL?

   Thank you for the help!

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2620900_616104)â€¢ 1 year ago |

Flags: needinfo?(masayuki)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2634309_75935)â€¢ 1 year ago |

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix)
[tracking-firefox121](/buglist.cgi?f1=cf_tracking_firefox121&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=%3F) â†’ [120+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=120%2B)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1855345#c33)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359698](/attachment.cgi?id=9359698 "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") [[details]](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!")

[Bug 1855345](/show_bug.cgi?id=1855345 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!

Approved for 120.0b4

[Attachment #9359698](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1855345#c34)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/80eca9d3eeb0>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2647056_690067)â€¢ 1 year ago |

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fixed)

|  | [Masayuki Nakano [:masayuki] (he/him)(JST, +0900)](/user_profile?user_id=34283)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1855345#c35)â€¢ 1 year ago |
|  | |

(In reply to Daniel Bodea [:danibodea] from [comment #32](/show_bug.cgi?id=1855345#c32 "VERIFIED FIXED - On X11, any page can freely write to the primary selection"))

> 1. Regarding step 2: does it matter how the word is selected? Is primary selection not done a certain way? (CTRL+A? double-click? triple-click?)

Either can update the primary selection. It's currently intended only for user interaction.

> 2. Regarding step 3: Which test case should we use? example.html or another?

[Attachment 9355227](/attachment.cgi?id=9355227 "example.html") [[details]](/attachment.cgi?id=9355227&action=edit "example.html") which is the original test case of this report. The script in the test case should not update selection when user does not interact with the document. In other words, currently, we unintentionally allow it updates primary selection when user mouse up on the document. It's traditional issue and out of scope of this bug.

> 3. how do you suggest opening the test case? (I think we should definitely not copy-paste it considering it might erase the current primary selection) Does it matter?

Just open the test case into the new (active) tab. Either is fine if you don't break the primary selection. I used the history to open it.

> 4. Regarding step 4: Should we perform the middle-click in a new tab? Or over the test case's URL?

Middle-click in the search bar or URL bar. Before applying the patch, the test case updates primary selection even during inactive. The patch avoids web apps to update primary selection with any API calls. However, the selection changes during mouse button down and mouse button up is used at mouse up because it's just not cared by the current design. Therefore, if you click in the test case, you keep seeing unexpected primary selection changes.

Sorry for my unclear comment and confused you.

Flags: needinfo?(masayuki)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1855345#c36)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359698](/attachment.cgi?id=9359698 "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") [[details]](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!")

[Bug 1855345](/show_bug.cgi?id=1855345 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!

Approved for 115.5esr

[Attachment #9359698](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1855345#c37)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/db1c17fea00f>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a2887808_690067)â€¢ 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1855345#c38)â€¢ 1 year ago |
|  | |

Verified as fixed on Ubuntu 20.04 x64.

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=verified)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1855345#c39)â€¢ 1 year ago |
|  | |

Setting Fx119 to wontfix and will reject the release-uplift request.

This will ride the trains with Fx120 and 115.5esr

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1855345#c40)â€¢ 1 year ago |
|  | |

Comment on [attachment 9359698](/attachment.cgi?id=9359698 "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") [[details]](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!")

[Bug 1855345](/show_bug.cgi?id=1855345 "VERIFIED FIXED - On X11, any page can freely write to the primary selection") - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!

See [Comment 39](/show_bug.cgi?id=1855345#c39 "VERIFIED FIXED - On X11, any page can freely write to the primary selection")

[Attachment #9359698](/attachment.cgi?id=9359698&action=edit "Bug 1855345 - Make `AutoCopyListener` ignore any selection changes caused by Selection API r=karlt!") -
Flags: approval-mozilla-release? â†’ approval-mozilla-release-

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1855345#c41)â€¢ 1 year ago |
|  | |

Verified as fixed on Firefox 115.5.0esr(Treeherder build) on Ubuntu 20.04 x64.

Status: RESOLVED â†’ VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1855345#c42)â€¢ 1 year ago |
|  | |

I guess the reporter removed themselves from the Bug Bounty program by deleting their account

Flags: sec-bounty? â†’ sec-bounty-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a4350953_1689)â€¢ 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] â†’ [adv-main120+][adv-esr115.5+][reporter-external] [client-bounty-form] [verif?]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1855345#c43)â€¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9364415)
â€” [Details](attachment.cgi?id=9364415&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a4684465_428608)â€¢ 1 year ago |

[Attachment #9364415](/attachment.cgi?id=9364415&action=edit "advisory.txt") -
Attachment description: advsiory.txt â†’ advisory.txt

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1855345#c44)â€¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9364421) (obsolete)
â€” [Details](attachment.cgi?id=9364421&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a4685366_1689)â€¢ 1 year ago |

[Attachment #9364421](/attachment.cgi?id=9364421&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a4702430_428608)â€¢ 1 year ago |

Alias: CVE-2023-6208

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1855345#c45)â€¢ 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a21307792_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855345#a22410903_578488)â€¢ 7 months ago |

Flags: sec-bounty-hof+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1855345#c46)â€¢ 2 months ago |
|  | |

Reporter asked to be removed from the HoF via email to security@

Flags: sec-bounty-hof+ â†’ sec-bounty-hof-
You need to [log in](/show_bug.cgi?id=1855345&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [u734064](/user_profile?user_id=734064)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.debian.org_bb4a7e76_20250114_232755.html ===


---

[[Date Prev](msg00016.html)][[Date Next](msg00018.html)]
[[Thread Prev](msg00016.html)][[Thread Next](msg00018.html)]
[[Date Index](maillist.html#00017)]
[[Thread Index](threads.html#00017)]

# [SECURITY] [DLA 3661-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3661-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 23 Nov 2023 23:42:30 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20231123224230.101062A00DC%40andromeda)Â [20231123224230.101062A00DC@andromeda](msg00017.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3661-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
November 23, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.5.0esr-1~deb10u1
CVE ID         : CVE-2023-6204 CVE-2023-6205 CVE-2023-6206 CVE-2023-6207
                 CVE-2023-6208 CVE-2023-6209 CVE-2023-6212

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, information leaks or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.5.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmVf1VMACgkQnUbEiOQ2
gwKx2g//cqVwCVC+aoRuCgS8+4sqTngnc0uNIaRmGIDH7AzQiKzUlpeRgytHXbqn
l5BUjdfPFyNH/HVNlArklkyyCIfoRRuF/Ts6oEGUDdQlT5gRwFIf1HRSajE+VcGW
4cK1urBuATPTQiBaVpVz21liVKdnWCxpf2ELOzp2/4z2uiI78OZJgNvprcWcNa5T
fhQK2KIhv4S/4d0E43olBSp4sm4v37PUmKXvEbn7C84qox9RUJL/eFF7YauXX2zz
KTwJBPfmwshhgbWIVDwv8msI7zvJPTtZlqqyRhLOpyPsTCawr8DYJvyKd4ErB5Sz
tYvuHezd7M5LzU+dhG402oG2hjMXaUvD9wsGvEbMaZYjDjYi+9Ep3gZO6D8a5/rJ
U/hAg+gIRl3NSrBJ3E/RDp4FKKMdaTQAYUQyzruGOrkROgxXAF2909aCIK7dFbBR
VwjeyJWeWvcE9rg8ea1my3gu0/7t3EkkCba9e81I/lDE16cRyD5F7WAvQbxkm3FH
fNlHaUn6gxW3jk2T+9deGq7CQFaGwmAiuPn/MDFDzXNG92SNG3FYPUryne7Lz06D
CRtI3Hq/asww2++hG9HKvGXPJh7F6MBVCik87ShuHD5jGFMy9vu1D5wuIPY5dZys
l00Bz3iddvQyGhoBwixFICrI1NKgbvn5nJZpxblQ6wwJW4ytKPg=
=zSdd
-----END PGP SIGNATURE-----

```

---


