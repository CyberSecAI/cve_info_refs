=== Content from plugins.trac.wordpress.org_461dc479_20250114_182844.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3019572%2540contact-form-7-dynamic-text-extension%252Ftrunk%26old%3D2968460%2540contact-form-7-dynamic-text-extension%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/2968460/contact-form-7-dynamic-text-extension/trunk?old=3019572&old_path=%2Fcontact-form-7-dynamic-text-extension%2Ftrunk)

---

# Changes in [contact-form-7-dynamic-text-extension/trunk](/browser/contact-form-7-dynamic-text-extension/trunk?rev=3019572 "Show entry in browser") [[2968460:3019572]](/log/contact-form-7-dynamic-text-extension/trunk?rev=3019572&stop_rev=2968460 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[contact-form-7-dynamic-text-extension/trunk](/browser/contact-form-7-dynamic-text-extension/trunk?rev=3019572)
Files:

3 added
9 edited

* [assets/scripts/dtx.min.js](/browser/contact-form-7-dynamic-text-extension/trunk/assets/scripts/dtx.min.js?rev=3019572 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [assets/scripts/tag-generator.min.js](/browser/contact-form-7-dynamic-text-extension/trunk/assets/scripts/tag-generator.min.js?rev=3019572 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [changelog.txt](/browser/contact-form-7-dynamic-text-extension/trunk/changelog.txt?rev=3019572 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [contact-form-7-dynamic-text-extension.php](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=3019572 "Show entry in browser")
  (modified)
  ([4 diffs](#file4 "Show differences"))
* [includes/admin](/browser/contact-form-7-dynamic-text-extension/trunk/includes/admin?rev=3019572 "Show entry in browser")
  (added)
* [includes/admin.php](/browser/contact-form-7-dynamic-text-extension/trunk/includes/admin.php?rev=3019572 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/admin/settings.php](/browser/contact-form-7-dynamic-text-extension/trunk/includes/admin/settings.php?rev=3019572 "Show entry in browser")
  (added)
* [includes/admin/update-check.php](/browser/contact-form-7-dynamic-text-extension/trunk/includes/admin/update-check.php?rev=3019572 "Show entry in browser")
  (added)
* [includes/shortcodes.php](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=3019572 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [includes/utilities.php](/browser/contact-form-7-dynamic-text-extension/trunk/includes/utilities.php?rev=3019572 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [includes/validation.php](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=3019572 "Show entry in browser")
  (modified)
  ([3 diffs](#file11 "Show differences"))
* [readme.txt](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=3019572 "Show entry in browser")
  (modified)
  ([4 diffs](#file12 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [contact-form-7-dynamic-text-extension/trunk/assets/scripts/dtx.min.js](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/assets/scripts/dtx.min.js?old=2968460&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fassets%2Fscripts%2Fdtx.min.js "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/assets/scripts/dtx.min.js")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/assets/scripts/dtx.min.js?rev=2968460#L1 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/assets/scripts/dtx.min.js?rev=3019572#L1 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | /\*! Do not edit, this file is generated automatically - 202~~3-09-18 14:09:50 ED~~T \*/ |
  |  | 1 | /\*! Do not edit, this file is generated automatically - 2024-01-09 15:01:30 MST \*/ |
  | 2 | 2 | var $=jQuery.noConflict(),dtx={queue:[],init:function(){var e=$("input.dtx-pageload[data-dtx-value]");e.length&&(e.each(function(e,t){var r=$(t),a=r.attr("data-dtx-value"),o=decodeURIComponent(a).split(" ");if(o.length){var n=o[0],c={};if(1<o.length)for(var u=1;u<o.length;u++){var i=o[u].split("="),d;2===i.length&&(c[i[0]]=i[1].split("'").join(""))}var s="";switch(n){case"CF7\_GET":s=dtx.get(c);break;case"CF7\_referrer":s=dtx.referrer(c);break;case"CF7\_URL":s=dtx.current\_url(c);break;case"CF7\_get\_cookie":s=dtx.get\_cookie(c);break;case"CF7\_guid":s=dtx.guid();break;case"CF7\_get\_current\_var":if(!dtx.validKey(c,"key")||"url"!=c.key)return;s=dtx.current\_url(c);break;case"CF7\_get\_post\_var":case"CF7\_get\_custom\_field":case"CF7\_get\_taxonomy":case"CF7\_get\_attachment":case"CF7\_bloginfo":case"CF7\_get\_theme\_option":return;default:return void(n&&dtx.queue.push({value:a,multiline:r.is("textarea")}))}dtx.set(r,s)}}),dtx.queue.length)&&setTimeout(function(){$.ajax({type:"POST",url:dtx\_obj.ajax\_url,dataType:"json",data:{action:"wpcf7dtx",shortcodes:dtx.queue},cache:!1,error:function(e,t,r){},success:function(e,t,r){"object"==typeof e&&e.length&&$.each(e,function(e,t){var r=$('.wpcf7 form input.dtx-pageload[data-dtx-value="'+t.raw\_value+'"]');r.length&&(dtx.set(r,t.value),r.addClass("dtx-ajax-loaded"))})}})},10)},validKey:function(e,t){return e.hasOwnProperty(t)&&"string"==typeof e[t]&&e[t].trim()},obfuscate:function(e,t){if(e=e.trim(),dtx.validKey(t,"obfuscate")&&t.obfuscate){for(var r="",a=0;a<e.length;a++)r+="&#"+e.codePointAt(a)+";";return r}return e},set:function(e,t){e.attr("value",t).addClass("dtx-loaded")},get:function(e){if(dtx.validKey(e,"key")){var t=window.location.search;if(t)return t=new URLSearchParams(t),dtx.obfuscate(t.get(e.key).trim(),e)}return""},referrer:function(e){return dtx.obfuscate(document.referrer,e)},current\_url:function(e){if(!e.hasOwnProperty("part"))return dtx.obfuscate(window.location.href,e);var t;if(["scheme","host","port","path","query","fragment"].includes(e.part))switch(e.part){case"scheme":return dtx.obfuscate(window.location.protocol.replace(":",""),e);case"host":return dtx.obfuscate(window.location.host,e);case"port":return dtx.obfuscate(window.location.port,e);case"path":return dtx.obfuscate(window.location.pathname,e);case"query":return dtx.obfuscate(window.location.search.replace("?",""),e);case"fragment":return dtx.obfuscate(window.location.hash.replace("#",""),e)}return""},get\_cookie:function(e){var t;return e.hasOwnProperty("key")&&"string"==typeof e.key&&""!=e.key.trim()&&(t=document.cookie.match("(^|;) ?"+e.key.trim()+"=([^;]\*)(;|$)"))?dtx.obfuscate(t[2],e):""},guid:function(){var r,a;return(void 0!==window.crypto&&void 0!==window.crypto.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)):(r=(new Date).getTime(),a="undefined"!=typeof performance&&performance.now&&1e3\*performance.now()||0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16\*Math.random();return 0<r?(t=(r+t)%16|0,r=Math.floor(r/16)):(t=(a+t)%16|0,a=Math.floor(a/16)),("x"===e?t:3&t|8).toString(16).toUpperCase()}))).toUpperCase()}};$(document).ready(dtx.init); |
* ## [contact-form-7-dynamic-text-extension/trunk/assets/scripts/tag-generator.min.js](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/assets/scripts/tag-generator.min.js?old=2968460&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fassets%2Fscripts%2Ftag-generator.min.js "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/assets/scripts/tag-generator.min.js")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/assets/scripts/tag-generator.min.js?rev=2968460#L1 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/assets/scripts/tag-generator.min.js?rev=3019572#L1 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | /\*! Do not edit, this file is generated automatically - 202~~3-09-18 14:09:50 ED~~T \*/ |
  |  | 1 | /\*! Do not edit, this file is generated automatically - 2024-01-09 15:01:30 MST \*/ |
  | 2 | 2 | !function(n){"use strict";"undefined"!=typeof wpcf7&&null!==wpcf7&&(window.wpcf7dtx=window.wpcf7dtx||{},wpcf7dtx.taggen={},wpcf7dtx.taggen.escapeRegExp=function(e){return e.replace(/([.\*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},wpcf7dtx.taggen.replaceAll=function(e,t,n,a){var c;return null!=e&&"string"==typeof e&&""!==e.trim()&&-1<e.indexOf(t)?(c=new RegExp(wpcf7dtx.taggen.escapeRegExp(t),"g"),a&&(c=new RegExp(t,"g")),e.replace(c,n)):e},wpcf7dtx.taggen.updateOption=function(e){var e=n(e.currentTarget),t=encodeURIComponent(wpcf7dtx.taggen.replaceAll(e.val(),"'","&#39;"));e.siblings('input[type="hidden"].option').val(t)},n(function(){n("form.tag-generator-panel .dtx-option").on("change keyup click",wpcf7dtx.taggen.updateOption),n('.contact-form-editor-panel #tag-generator-list a.thickbox.button[href\*="inlineId=tag-generator-panel-dynamic\_"]').each(function(){var e=n(this),t=e.text();e.addClass("dtx-form-tag"),"dynamic drop-down menu"!=t&&"dynamic checkboxes"!=t&&"dynamic radio buttons"!=t||e.attr("href",e.attr("href").replace("height=500","height=750"))})}))}(jQuery); |
* ## [contact-form-7-dynamic-text-extension/trunk/changelog.txt](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/changelog.txt?old=2968460&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fchangelog.txt "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/changelog.txt")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/changelog.txt?rev=2968460#L1 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/changelog.txt?rev=3019572#L1 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | == Changelog == |
  |  | 2 |  |
  |  | 3 | = 4.2.0 = |
  |  | 4 |  |
  |  | 5 | \* Security Update: \*\* Please be sure to review this doc, as you may need to adjust the settings: https://sevenspark.com/docs/contact-form-7-dynamic-text-extension/allow-data-access \*\* |
  |  | 6 | \* Feature: Added Settings Screen with Allow Lists |
  |  | 7 | \* Feature: Added Form Scanner |
  |  | 8 | \* Feature: Added Allow List key validation in CF7 Form Validator |
  | 2 | 9 |  |
  | 3 | 10 | = 4.1.0 = |
* ## [contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?old=2968460&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fcontact-form-7-dynamic-text-extension.php "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=2968460#L5 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=3019572#L5 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* Plugin URI: https://sevenspark.com/goods/contact-form-7-dynamic-text-extension |
  | 6 | 6 | \* Description: This plugin extends Contact Form 7 by adding dynamic form fields that accept any shortcode to generate default values and placeholder text. Requires Contact Form 7. |
  | 7 |  | \* Version: 4.~~1~~.0 |
  |  | 7 | \* Version: 4.2.0 |
  | 8 | 8 | \* Author: SevenSpark, AuRise Creative |
  | 9 | 9 | \* Author URI: https://sevenspark.com |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=2968460#L15) | […](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=3019572#L15) |  |
  | 15 | 15 |  |
  | 16 | 16 | /\* |
  | 17 |  | Copyright 2010-202~~3~~ Chris Mavricos, SevenSpark <https://sevenspark.com> |
  | 18 |  | Copyright 2022-202~~3~~ Tessa Watkins, AuRise Creative <https://aurisecreative.com> |
  |  | 17 | Copyright 2010-2024 Chris Mavricos, SevenSpark <https://sevenspark.com> |
  |  | 18 | Copyright 2022-2024 Tessa Watkins, AuRise Creative <https://aurisecreative.com> |
  | 19 | 19 |  |
  | 20 | 20 | This program is free software; you can redistribute it and/or modify |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=2968460#L33) | […](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=3019572#L33) |  |
  | 33 | 33 |  |
  | 34 | 34 | // Define current version |
  | 35 |  | define('WPCF7DTX\_VERSION', '4.~~1~~.0'); |
  |  | 35 | define('WPCF7DTX\_VERSION', '4.2.0'); |
  | 36 | 36 |  |
  | 37 | 37 | // Define root directory |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=2968460#L40) | […](/browser/contact-form-7-dynamic-text-extension/trunk/contact-form-7-dynamic-text-extension.php?rev=3019572#L40) |  |
  | 40 | 40 | // Define root file |
  | 41 | 41 | defined('WPCF7DTX\_FILE') || define('WPCF7DTX\_FILE', \_\_FILE\_\_); |
  |  | 42 |  |
  |  | 43 | define( 'WPCF7DTX\_DATA\_ACCESS\_KB\_URL', 'https://sevenspark.com/docs/contact-form-7-dynamic-text-extension/allow-data-access' ); |
  | 42 | 44 |  |
  | 43 | 45 | /\*\* |
* ## [contact-form-7-dynamic-text-extension/trunk/includes/admin.php](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/includes/admin.php?old=2956991&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fincludes%2Fadmin.php "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/includes/admin.php")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/includes/admin.php?rev=2956991#L1 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/includes/admin.php?rev=3019572#L1 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  |  | 2 |  |
  |  | 3 | // Include the Settings Page & Update Check |
  |  | 4 | include\_once( 'admin/settings.php' ); |
  |  | 5 | include\_once( 'admin/update-check.php' ); |
  | 2 | 6 |  |
  | 3 | 7 | /\*\* |
* ## [contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?old=2948878&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fincludes%2Fshortcodes.php "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=2948878#L215 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=3019572#L215 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 215 | 215 | 'obfuscate' => '' |
  | 216 | 216 | ), array\_change\_key\_case((array)$atts, CASE\_LOWER))); |
  |  | 217 |  |
  |  | 218 | // If this key can't be accessed |
  |  | 219 | if( !wpcf7dtx\_post\_meta\_key\_access\_is\_allowed( $key ) ){ |
  |  | 220 | // Trigger a warning if a denied key is in use |
  |  | 221 | wpcf7dtx\_access\_denied\_alert( $key, 'post\_meta' ); |
  |  | 222 | return ''; |
  |  | 223 | } |
  |  | 224 |  |
  | 217 | 225 | $post\_id = wpcf7dtx\_get\_post\_id($post\_id); |
  | 218 | 226 | $key = apply\_filters('wpcf7dtx\_sanitize', $key, 'text'); |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=2948878#L344) | […](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=3019572#L352) |  |
  | 344 | 352 | ), array\_change\_key\_case((array)$atts, CASE\_LOWER))); |
  | 345 | 353 | if (is\_user\_logged\_in()) { |
  |  | 354 |  |
  |  | 355 | // If this key can't be accessed |
  |  | 356 | if( !wpcf7dtx\_user\_data\_access\_is\_allowed( $key ) ){ |
  |  | 357 | // Trigger a warning if a denied key is in use |
  |  | 358 | wpcf7dtx\_access\_denied\_alert( $key, 'user\_data' ); |
  |  | 359 | return ''; |
  |  | 360 | } |
  |  | 361 |  |
  | 346 | 362 | $user = wp\_get\_current\_user(); |
  | 347 | 363 | return apply\_filters('wpcf7dtx\_escape', $user->get($key), $obfuscate); |
* ## [contact-form-7-dynamic-text-extension/trunk/includes/utilities.php](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/includes/utilities.php?old=2956991&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fincludes%2Futilities.php "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/includes/utilities.php")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/includes/utilities.php?rev=2956991#L662 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/includes/utilities.php?rev=3019572#L662 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 662 | 662 | return $default; |
  | 663 | 663 | } |
  |  | 664 |  |
  |  | 665 |  |
  |  | 666 | /\*\* |
  |  | 667 | \* Check if admin has allowed access to a specific post meta key |
  |  | 668 | \* |
  |  | 669 | \* @since 4.2.0 |
  |  | 670 | \* |
  |  | 671 | \* @param string $meta\_key The post meta key to test |
  |  | 672 | \* |
  |  | 673 | \* @return bool True if this key can be accessed, false otherwise |
  |  | 674 | \*/ |
  |  | 675 | function wpcf7dtx\_post\_meta\_key\_access\_is\_allowed($meta\_key) |
  |  | 676 | { |
  |  | 677 |  |
  |  | 678 | // Get the DTX Settings |
  |  | 679 | $settings = wpcf7dtx\_get\_settings();get\_option('cf7dtx\_settings', []); |
  |  | 680 |  |
  |  | 681 | // Has access to all metadata been enabled? |
  |  | 682 | if( isset($settings['post\_meta\_allow\_all']) && $settings['post\_meta\_allow\_all'] === 'enabled' ){ |
  |  | 683 | return true; |
  |  | 684 | } |
  |  | 685 |  |
  |  | 686 | // If not, check the Allow List |
  |  | 687 |  |
  |  | 688 | $allowed\_keys; |
  |  | 689 |  |
  |  | 690 | // No key list from settings |
  |  | 691 | if( !isset($settings['post\_meta\_allow\_keys'] ) || !is\_string($settings['post\_meta\_allow\_keys'])){ |
  |  | 692 | $allowed\_keys = []; |
  |  | 693 | } |
  |  | 694 | // Extract allowed keys from setting text area |
  |  | 695 | else{ |
  |  | 696 | // $allowed\_keys = preg\_split('/\r\n|\r|\n/', $settings['post\_meta\_allow\_keys']); |
  |  | 697 | $allowed\_keys = wpcf7dtx\_parse\_allowed\_keys( $settings['post\_meta\_allow\_keys'] ); |
  |  | 698 | } |
  |  | 699 |  |
  |  | 700 | // Allow custom filters |
  |  | 701 | $allowed\_keys = apply\_filters( 'wpcf7dtx\_post\_meta\_key\_allow\_list', $allowed\_keys ); |
  |  | 702 |  |
  |  | 703 | // Check if the key is in the allow list |
  |  | 704 | if( in\_array( $meta\_key, $allowed\_keys ) ){ |
  |  | 705 | return true; // The key is allowed |
  |  | 706 | } |
  |  | 707 |  |
  |  | 708 | // Everything is disallowed by default |
  |  | 709 | return false; |
  |  | 710 |  |
  |  | 711 | } |
  |  | 712 |  |
  |  | 713 |  |
  |  | 714 | /\*\* |
  |  | 715 | \* Check if admin has allowed access to a specific user data |
  |  | 716 | \* |
  |  | 717 | \* @since 4.2.0 |
  |  | 718 | \* |
  |  | 719 | \* @param string $key The user data key to test |
  |  | 720 | \* |
  |  | 721 | \* @return bool True if this key can be accessed, false otherwise |
  |  | 722 | \*/ |
  |  | 723 | function wpcf7dtx\_user\_data\_access\_is\_allowed( $key ) |
  |  | 724 | { |
  |  | 725 |  |
  |  | 726 | // Get the DTX Settings |
  |  | 727 | $settings = wpcf7dtx\_get\_settings(); //get\_option('cf7dtx\_settings', []); |
  |  | 728 |  |
  |  | 729 | // Has access to all metadata been enabled? |
  |  | 730 | if( isset($settings['user\_data\_allow\_all']) && $settings['user\_data\_allow\_all'] === 'enabled' ){ |
  |  | 731 | return true; |
  |  | 732 | } |
  |  | 733 |  |
  |  | 734 | // If not, check the Allow List |
  |  | 735 |  |
  |  | 736 | $allowed\_keys; |
  |  | 737 |  |
  |  | 738 | // No key list from settings |
  |  | 739 | if( !isset($settings['user\_data\_allow\_keys'] ) || !is\_string($settings['user\_data\_allow\_keys'])){ |
  |  | 740 | $allowed\_keys = []; |
  |  | 741 | } |
  |  | 742 | // Extract allowed keys from setting text area |
  |  | 743 | else{ |
  |  | 744 | // $allowed\_keys = preg\_split('/\r\n|\r|\n/', $settings['user\_data\_allow\_keys']); |
  |  | 745 | $allowed\_keys = wpcf7dtx\_parse\_allowed\_keys($settings['user\_data\_allow\_keys']); |
  |  | 746 | } |
  |  | 747 |  |
  |  | 748 | // Allow custom filters |
  |  | 749 | $allowed\_keys = apply\_filters( 'wpcf7dtx\_user\_data\_key\_allow\_list', $allowed\_keys ); |
  |  | 750 |  |
  |  | 751 | // Check if the key is in the allow list |
  |  | 752 | if( in\_array( $key, $allowed\_keys ) ){ |
  |  | 753 | return true; // The key is allowed |
  |  | 754 | } |
  |  | 755 |  |
  |  | 756 |  |
  |  | 757 | // Everything is disallowed by default |
  |  | 758 | return false; |
  |  | 759 |  |
  |  | 760 | } |
  |  | 761 |  |
  |  | 762 |  |
  |  | 763 | /\*\* |
  |  | 764 | \* Take the string saved in the options array from the allow list textarea and parse it into an array by newlines. |
  |  | 765 | \* Also strip whitespace |
  |  | 766 | \* |
  |  | 767 | \* @param string $allowlist The string of allowed keys stored in the DB |
  |  | 768 | \* |
  |  | 769 | \* @return array Array of allowed keys |
  |  | 770 | \*/ |
  |  | 771 | function wpcf7dtx\_parse\_allowed\_keys( $allowlist ){ |
  |  | 772 | // Split by newlines |
  |  | 773 | $keys = wpcf7dtx\_split\_newlines( $allowlist ); |
  |  | 774 | // Trim whitespace |
  |  | 775 | $keys = array\_map( 'trim' , $keys ); |
  |  | 776 | return $keys; |
  |  | 777 | } |
  |  | 778 |  |
  |  | 779 | /\*\* |
  |  | 780 | \* Used to parse strings stored in the database that are from text areas with one element per line into an array of strings |
  |  | 781 | \* |
  |  | 782 | \* @param string $str The multi-line string to be parsed into an array |
  |  | 783 | \* |
  |  | 784 | \* @return array Array of parsed strings |
  |  | 785 | \*/ |
  |  | 786 | function wpcf7dtx\_split\_newlines( $str ){ |
  |  | 787 | return preg\_split('/\r\n|\r|\n/', $str); |
  |  | 788 | } |
  |  | 789 |  |
  |  | 790 | /\*\* |
  |  | 791 | \* Gets the CF7 DTX settings field from the WP options table.  Returns an empty array if option has not previously been set |
  |  | 792 | \* |
  |  | 793 | \* @return array The settings array |
  |  | 794 | \*/ |
  |  | 795 | function wpcf7dtx\_get\_settings(){ |
  |  | 796 | return get\_option('cf7dtx\_settings', []); |
  |  | 797 | } |
  |  | 798 |  |
  |  | 799 | /\*\* |
  |  | 800 | \* Updates the CF7 DTX settings in the WP options table |
  |  | 801 | \* |
  |  | 802 | \* @param array $settings The settings array |
  |  | 803 | \* |
  |  | 804 | \*/ |
  |  | 805 | function wpcf7dtx\_update\_settings($settings){ |
  |  | 806 | update\_option( 'cf7dtx\_settings', $settings ); |
  |  | 807 | } |
  |  | 808 |  |
  |  | 809 |  |
  |  | 810 | /\*\* |
  |  | 811 | \* Outputs a useful PHP Warning message to users on how to allow-list denied meta and user keys |
  |  | 812 | \* |
  |  | 813 | \* @param string $key The post meta or user key to which access is currently denied |
  |  | 814 | \* @param string $type Either 'post\_meta' or 'user\_data', used to display an appropriate message to the user |
  |  | 815 | \*/ |
  |  | 816 | function wpcf7dtx\_access\_denied\_alert( $key, $type ){ |
  |  | 817 |  |
  |  | 818 | // Only check on the front end |
  |  | 819 | if( is\_admin() || wp\_doing\_ajax() || wp\_is\_json\_request() ) return; |
  |  | 820 |  |
  |  | 821 | $shortcode = ''; |
  |  | 822 | $list\_name = ''; |
  |  | 823 |  |
  |  | 824 | switch( $type ){ |
  |  | 825 | case 'post\_meta': |
  |  | 826 | $shortcode = 'CF7\_get\_custom\_field'; |
  |  | 827 | $list\_name = \_\_('Meta Key Allow List', 'contact-form-7-dynamic-text-extension'); |
  |  | 828 | break; |
  |  | 829 | case 'user\_data': |
  |  | 830 | $shortcode = 'CF7\_get\_current\_user'; |
  |  | 831 | $list\_name = \_\_('User Data Key Allow List', 'contact-form-7-dynamic-text-extension'); |
  |  | 832 | break; |
  |  | 833 | default: |
  |  | 834 | } |
  |  | 835 |  |
  |  | 836 | $settings\_page\_url = admin\_url('admin.php?page=cf7dtx\_settings'); |
  |  | 837 |  |
  |  | 838 | $msg = sprintf( |
  |  | 839 | \_\_('CF7 DTX: Access denied to key: "%1$s" in dynamic contact form shortcode: [%2$s].  Please add this key to the %3$s at %4$s','contact-form-7-dynamic-text-extension'), |
  |  | 840 | $key, |
  |  | 841 | $shortcode, |
  |  | 842 | $list\_name, |
  |  | 843 | $settings\_page\_url |
  |  | 844 | ); |
  |  | 845 |  |
  |  | 846 | trigger\_error( $msg, E\_USER\_WARNING ); |
  |  | 847 | } |
  |  | 848 |  |
  |  | 849 |  |
  |  | 850 | /\*\* |
  |  | 851 | \* Helper function to output array and object data |
  |  | 852 | \*/ |
  |  | 853 | /\* |
  |  | 854 | function dtxpretty ($var, $print=true, $privobj=false) { |
  |  | 855 |  |
  |  | 856 | $type = gettype($var); |
  |  | 857 |  |
  |  | 858 | if( $privobj && $type === 'object' ){ |
  |  | 859 | $p = '<pre>'.print\_r($var, true).'</pre>'; |
  |  | 860 | } |
  |  | 861 | else { |
  |  | 862 | $p = '<pre>'.$type . ' ' . json\_encode( |
  |  | 863 | $var, |
  |  | 864 | JSON\_UNESCAPED\_SLASHES | |
  |  | 865 | JSON\_UNESCAPED\_UNICODE | |
  |  | 866 | JSON\_PRETTY\_PRINT | |
  |  | 867 | JSON\_PARTIAL\_OUTPUT\_ON\_ERROR | |
  |  | 868 | JSON\_INVALID\_UTF8\_SUBSTITUTE |
  |  | 869 | ).'</pre>'; |
  |  | 870 | } |
  |  | 871 | if( $print ) { |
  |  | 872 | echo $p; |
  |  | 873 | } |
  |  | 874 | return $p; |
  |  | 875 | } |
  |  | 876 | \*/ |
* ## [contact-form-7-dynamic-text-extension/trunk/includes/validation.php](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?old=2956991&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Fincludes%2Fvalidation.php "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/includes/validation.php")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=2956991#L34 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=3019572#L34 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 34 | 34 |  |
  | 35 | 35 | /\*\* |
  |  | 36 | \* Add DTX Error Code to Config Validator |
  |  | 37 | \* |
  |  | 38 | \* @since 5.0.0 |
  |  | 39 | \* |
  |  | 40 | \* @param array $error\_codes A sequential array of available error codes in Contact Form 7. |
  |  | 41 | \* |
  |  | 42 | \* @return array A modified sequential array of available error codes in Contact Form 7. |
  |  | 43 | \*/ |
  |  | 44 | function wpcf7dtx\_config\_validator\_available\_error\_codes($error\_codes) |
  |  | 45 | { |
  |  | 46 | $dtx\_errors = array('dtx\_disallowed'); |
  |  | 47 | return array\_merge($error\_codes, $dtx\_errors); |
  |  | 48 | } |
  |  | 49 | add\_filter('wpcf7\_config\_validator\_available\_error\_codes', 'wpcf7dtx\_config\_validator\_available\_error\_codes'); |
  |  | 50 |  |
  |  | 51 | /\*\* |
  | 36 | 52 | \* Validate DTX Form Fields |
  | 37 | 53 | \* |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=2956991#L168) | […](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=3019572#L184) |  |
  | 168 | 184 | function wpcf7dtx\_validate($validator) |
  | 169 | 185 | { |
  |  | 186 | // Check for sensitive form tags |
  |  | 187 | $manager = WPCF7\_FormTagsManager::get\_instance(); |
  |  | 188 | $contact\_form = $validator->contact\_form(); |
  |  | 189 | $form = $contact\_form->prop('form'); |
  |  | 190 | if (wpcf7\_autop\_or\_not()) { |
  |  | 191 | $form = $manager->replace\_with\_placeholders($form); |
  |  | 192 | $form = wpcf7\_autop($form); |
  |  | 193 | $form = $manager->restore\_from\_placeholders($form); |
  |  | 194 | } |
  |  | 195 | $form = $manager->replace\_all($form); |
  |  | 196 | $tags = $manager->get\_scanned\_tags(); |
  |  | 197 | foreach ($tags as $tag) { |
  |  | 198 | /\*\* @var WPCF7\_FormTag $tag \*/ |
  |  | 199 |  |
  |  | 200 | // Only validate DTX formtags |
  |  | 201 | if (in\_array($tag->basetype, array\_merge( |
  |  | 202 | array('dynamictext', 'dynamichidden'), // Deprecated DTX form tags |
  |  | 203 | array\_keys(wpcf7dtx\_config()) // DTX form tags |
  |  | 204 | ))) { |
  |  | 205 | // Check value for sensitive data |
  |  | 206 | $default = $tag->get\_option('defaultvalue', '', true); |
  |  | 207 | if (!$default) { |
  |  | 208 | $default = $tag->get\_default\_option(strval(reset($tag->values))); |
  |  | 209 | } |
  |  | 210 | if ( |
  |  | 211 | !empty($value = trim(wpcf7\_get\_hangover($tag->name, $default))) && // Has value |
  |  | 212 | ($result = wpcf7dtx\_validate\_sensitive\_value($value))['status'] // Has sensitive data |
  |  | 213 | ) { |
  |  | 214 | $validator->add\_error('form.body', 'dtx\_disallowed', array( |
  |  | 215 | 'message' => sprintf( |
  |  | 216 | \_\_('[%1$s %2$s]: Access to key "%3$s" in shortcode "%4$s" is disallowed by default. To allow access, add "%3$s" to the %5$s Allow List.', 'contact-form-7-dynamic-text-extension'), |
  |  | 217 | esc\_html($tag->basetype), |
  |  | 218 | esc\_html($tag->name), |
  |  | 219 | esc\_html($result['key']), |
  |  | 220 | esc\_html($result['shortcode']), |
  |  | 221 | esc\_html($result['shortcode'] == 'CF7\_get\_current\_user' ? \_\_('User Data Key', 'contact-form-7-dynamic-text-extension') : \_\_('Meta Key', 'contact-form-7-dynamic-text-extension')) |
  |  | 222 | ), |
  |  | 223 | 'link' => wpcf7dtx\_get\_admin\_settings\_screen\_url() |
  |  | 224 | )); |
  |  | 225 | } |
  |  | 226 |  |
  |  | 227 | // Check placeholder for sensitive data |
  |  | 228 | if ( |
  |  | 229 | ($tag->has\_option('placeholder') || $tag->has\_option('watermark')) && // Using placeholder |
  |  | 230 | !empty($placeholder = trim(html\_entity\_decode(urldecode($tag->get\_option('placeholder', '', true)), ENT\_QUOTES))) && // Has value |
  |  | 231 | ($result = wpcf7dtx\_validate\_sensitive\_value($placeholder))['status'] // Has sensitive data |
  |  | 232 | ) { |
  |  | 233 | $validator->add\_error('form.body', 'dtx\_disallowed', array( |
  |  | 234 | 'message' => sprintf( |
  |  | 235 | \_\_('[%1$s %2$s]: Access to key "%3$s" in shortcode "%4$s" is disallowed by default. To allow access, add "%3$s" to the %5$s Allow List.', 'contact-form-7-dynamic-text-extension'), |
  |  | 236 | esc\_html($tag->basetype), |
  |  | 237 | esc\_html($tag->name), |
  |  | 238 | esc\_html($result['key']), |
  |  | 239 | esc\_html($result['shortcode']), |
  |  | 240 | esc\_html($result['shortcode'] == 'CF7\_get\_current\_user' ? \_\_('User Data Key', 'contact-form-7-dynamic-text-extension') : \_\_('Meta Key', 'contact-form-7-dynamic-text-extension')) |
  |  | 241 | ), |
  |  | 242 | 'link' => wpcf7dtx\_get\_admin\_settings\_screen\_url() |
  |  | 243 | )); |
  |  | 244 | } |
  |  | 245 | } |
  |  | 246 | } |
  |  | 247 |  |
  |  | 248 | // Validate email address |
  | 170 | 249 | if (!$validator->is\_valid()) { |
  | 171 | 250 | $contact\_form = null; |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=2956991#L232) | […](/browser/contact-form-7-dynamic-text-extension/trunk/includes/validation.php?rev=3019572#L311) |  |
  | 232 | 311 | } |
  | 233 | 312 | add\_action('wpcf7\_config\_validator\_validate', 'wpcf7dtx\_validate'); |
  |  | 313 |  |
  |  | 314 | /\*\* |
  |  | 315 | \* Validate Field Value for Sensitive Data |
  |  | 316 | \* |
  |  | 317 | \* @since 5.0.0 |
  |  | 318 | \* |
  |  | 319 | \* @see https://developer.wordpress.org/reference/functions/get\_bloginfo/#description |
  |  | 320 | \* |
  |  | 321 | \* @param string $content The string to validate. |
  |  | 322 | \* |
  |  | 323 | \* @return array An associative array with keys `status` (bool), `shortcode` (string), and `key` (string). |
  |  | 324 | \* The value of `status` is true if the content is a shortcode that is attempting to access sensitive data. False |
  |  | 325 | \* otherwise. The value of `shortcode` is the the shortcode that is making the attempt if `status` is true. The |
  |  | 326 | \* value of `key` is the shortcode's `key` attribute of the attempt being made if `status` is true. |
  |  | 327 | \*/ |
  |  | 328 | function wpcf7dtx\_validate\_sensitive\_value($content) |
  |  | 329 | { |
  |  | 330 | $r = array( |
  |  | 331 | 'status' => false, |
  |  | 332 | 'shortcode' => '', |
  |  | 333 | 'key' => '' |
  |  | 334 | ); |
  |  | 335 |  |
  |  | 336 | // Parse the attributes.  [0] is the shortcode name. ['key'] is the key attribute |
  |  | 337 | $atts = shortcode\_parse\_atts($content); |
  |  | 338 |  |
  |  | 339 | // If we can't extract the atts, or the shortcode or `key` is not an att, don't validate |
  |  | 340 | if( !is\_array($atts) || !array\_key\_exists('key', $atts) || !array\_key\_exists('0', $atts) ) return $r; |
  |  | 341 |  |
  |  | 342 | // Find the key and shortcode in question |
  |  | 343 | $key = sanitize\_text\_field($atts['key']); |
  |  | 344 | $shortcode = sanitize\_text\_field($atts['0']); |
  |  | 345 |  |
  |  | 346 | // If the shortcode or key value does not exist, don't validate |
  |  | 347 | if( empty($shortcode) || empty($key) ) return $r; |
  |  | 348 |  |
  |  | 349 | $allowed = true; |
  |  | 350 | switch( $shortcode ){ |
  |  | 351 | case 'CF7\_get\_custom\_field': |
  |  | 352 | $allowed = wpcf7dtx\_post\_meta\_key\_access\_is\_allowed( $key ); |
  |  | 353 | break; |
  |  | 354 | case 'CF7\_get\_current\_user': |
  |  | 355 | $allowed = wpcf7dtx\_user\_data\_access\_is\_allowed( $key ); |
  |  | 356 | break; |
  |  | 357 | default: |
  |  | 358 |  |
  |  | 359 | } |
  |  | 360 |  |
  |  | 361 | if( !$allowed ){ |
  |  | 362 | $r['status'] = true; |
  |  | 363 | $r['shortcode'] = $shortcode; |
  |  | 364 | $r['key'] = $key; |
  |  | 365 | } |
  |  | 366 |  |
  |  | 367 | return $r; |
  |  | 368 |  |
  |  | 369 | } |
* ## [contact-form-7-dynamic-text-extension/trunk/readme.txt](/changeset/3019572/contact-form-7-dynamic-text-extension/trunk/readme.txt?old=2968460&old_path=contact-form-7-dynamic-text-extension%2Ftrunk%2Freadme.txt "Show the [2968460:3019572] differences restricted to contact-form-7-dynamic-text-extension/trunk/readme.txt")

  | [r2968460](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=2968460#L3 "Show revision 2968460 of this file in browser") | [r3019572](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=3019572#L3 "Show revision 3019572 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Donate link: https://just1voice.com/donate/ |
  | 4 | 4 | Tags: Contact Form 7, autofill, prepopulate, input, form field, contact form, text, hidden, input, dynamic, GET, POST, title, slug, auto-fill, pre-populate |
  | 5 |  | Tested up to: 6.~~3~~ |
  | 6 |  | Stable tag: 4.~~1~~.0 |
  |  | 5 | Tested up to: 6.4.2 |
  |  | 6 | Stable tag: 4.2.0 |
  | 7 | 7 |  |
  | 8 | 8 | This plugin provides additional form tags for the Contact Form 7 plugin. It allows dynamic generation of content for text-based input fields like text, hidden, and email, checkboxes, radio buttons, and drop-down selections using any shortcode. |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=2968460#L199) | […](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=3019572#L199) |  |
  | 199 | 199 | Retrieve custom fields from the current post/page. Just set the custom field as the key in the shortcode. |
  | 200 | 200 |  |
  |  | 201 | Note: You must add any meta keys that you want to allow access to to the allow list in your admin panel > Contact > Dynamic Text Extension > Meta Key Allow List.  [More Information](https://sevenspark.com/docs/contact-form-7-dynamic-text-extension/allow-data-access) |
  |  | 202 |  |
  | 201 | 203 | The dynamic value input becomes: `CF7\_get\_custom\_field key='my\_custom\_field'` |
  | 202 | 204 |  |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=2968460#L238) | […](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=3019572#L240) |  |
  | 238 | 240 | Dynamic value: `CF7\_get\_current\_user key='user\_displayname'` |
  | 239 | 241 | CF7 Tag: `[dynamictext dynamicname "CF7\_get\_current\_user"]` |
  |  | 242 |  |
  |  | 243 | Note: You must add any user keys that you want to allow access to to the allow list in your admin panel > Contact > Dynamic Text Extension > User Data Key Allow List.  [More Information](https://sevenspark.com/docs/contact-form-7-dynamic-text-extension/allow-data-access) |
  | 240 | 244 |  |
  | 241 | 245 | Valid values for `key` include: |
  | […](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=2968460#L377) | […](/browser/contact-form-7-dynamic-text-extension/trunk/readme.txt?rev=3019572#L381) |  |
  | 377 | 381 | == Upgrade Notice == |
  | 378 | 382 |  |
  | 379 |  | = 4.~~1~~.0 = |
  |  | 383 | = 4.2.0 = |
  | 380 | 384 | Extend functionality without losing your work! |
  | 381 | 385 |  |
  | 382 | 386 | == Changelog == |
  |  | 387 |  |
  |  | 388 | = 4.2.0 = |
  |  | 389 |  |
  |  | 390 | \* Security Update: \*\* Please be sure to review this doc, as you may need to adjust the settings: https://sevenspark.com/docs/contact-form-7-dynamic-text-extension/allow-data-access \*\* |
  |  | 391 | \* Feature: Added Settings Screen with Allow Lists |
  |  | 392 | \* Feature: Added Form Scanner |
  |  | 393 | \* Feature: Added Allow List key validation in CF7 Form Validator |
  | 383 | 394 |  |
  | 384 | 395 | = 4.1.0 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3019572&old=2968460&new_path=%2Fcontact-form-7-dynamic-text-extension%2Ftrunk&old_path=%2Fcontact-form-7-dynamic-text-extension%2Ftrunk)
* [Zip Archive](?format=zip&new=3019572&old=2968460&new_path=%2Fcontact-form-7-dynamic-text-extension%2Ftrunk&old_path=%2Fcontact-form-7-dynamic-text-extension%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_b49b37a4_20250114_182846.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Contact Form 7 – Dynamic Text Extension <= 4.1.0 - Insecure Direct Object Reference

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Contact Form 7 – Dynamic Text Extension <= 4.1.0 - Insecure Direct Object Reference

4.3

**Exposure of Private Personal Information to an Unauthorized Actor**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2023-6630](https://www.cve.org/CVERecord?id=CVE-2023-6630) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | January 10, 2024 |
| Last Updated | January 11, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Contact Form 7 – Dynamic Text Extension plugin for WordPress is vulnerable to Insecure Direct Object Reference in all versions up to, and including, 4.1.0 via the CF7\_get\_custom\_field and CF7\_get\_current\_user shortcodes due to missing validation on a user controlled key. This makes it possible for authenticated attackers with contributor access or higher to access arbitrary metadata of any post type, referencing the post by id and the meta by key.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3019572%40contact-form-7-dynamic-text-extension%2Ftrunk&old=2968460%40contact-form-7-dynamic-text-extension%2Ftrunk&sfp_email=&sfph_mail=#file4)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7-dynamic-text-extension%2Fcontact-form-7-dynamic-text-extension-410-insecure-direct-object-reference&t=Contact%20Form%207%20%E2%80%93%20Dynamic%20Text%20Extension%20%3C%3D%204.1.0%20-%20Insecure%20Direct%20Object%20Reference "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7-dynamic-text-extension%2Fcontact-form-7-dynamic-text-extension-410-insecure-direct-object-reference&text=Contact%20Form%207%20%E2%80%93%20Dynamic%20Text%20Extension%20%3C%3D%204.1.0%20-%20Insecure%20Direct%20Object%20Reference "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7-dynamic-text-extension%2Fcontact-form-7-dynamic-text-extension-410-insecure-direct-object-reference "LinkedIn")
Email

## Vulnerability Details for Contact Form 7 – Dynamic Text Extension

#### [Contact Form 7 – Dynamic Text Extension](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/contact-form-7-dynamic-text-extension)

| Software Type | Plugin |
| --- | --- |
| Software Slug | contact-form-7-dynamic-text-extension [(view on wordpress.org)](https://wordpress.org/plugins/contact-form-7-dynamic-text-extension) |
| Patched? | Yes |
| Remediation | Update to version 4.2.0, or a newer patched version |
| Affected Version | * <= 4.1.0 |
| Patched Version | * 4.2.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


