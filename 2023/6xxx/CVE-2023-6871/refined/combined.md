=== Content from www.mozilla.org_49d17580_20250115_100634.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-56

## Security Vulnerabilities fixed in Firefox 121

Announced
December 19, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 121

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6135: NSS susceptible to "Minerva" attack](#CVE-2023-6135)

Reporter
George Pantela (Red Hat) and Hubert Kario (Red Hat)
Impact
high
##### Description

Multiple NSS NIST curves were susceptible to a side-channel attack known as "Minerva". This attack could potentially allow an attacker to recover the private key.

##### References

* [Bug 1853908](https://bugzilla.mozilla.org/show_bug.cgi?id=1853908)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6866: TypedArrays lack sufficient exception handling](#CVE-2023-6866)

Reporter
Tom Schuster
Impact
moderate
##### Description

TypedArrays can be fallible and lacked proper exception handling. This could lead to abuse in other APIs which expect TypedArrays to always succeed.

##### References

* [Bug 1849037](https://bugzilla.mozilla.org/show_bug.cgi?id=1849037)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6868: WebPush requests on Firefox for Android did not require VAPID key](#CVE-2023-6868)

Reporter
John-Mark Gurney
Impact
moderate
##### Description

In some instances, the user-agent would allow push requests which lacked a valid VAPID even though the push manager subscription defined one. This could allow empty messages to be sent from unauthorized parties.
*This bug only affects Firefox on Android.*

##### References

* [Bug 1865488](https://bugzilla.mozilla.org/show_bug.cgi?id=1865488)

#### [#CVE-2023-6869: Content can paint outside of sandboxed iframe](#CVE-2023-6869)

Reporter
Oriol Brufau
Impact
low
##### Description

A `<dialog>` element could have been manipulated to paint content outside of a sandboxed iframe. This could allow untrusted content to display under the guise of trusted content.

##### References

* [Bug 1799036](https://bugzilla.mozilla.org/show_bug.cgi?id=1799036)

#### [#CVE-2023-6870: Android Toast notifications may obscure fullscreen event notifications](#CVE-2023-6870)

Reporter
Hafiizh
Impact
low
##### Description

Applications which spawn a Toast notification in a background thread may have obscured fullscreen notifications displayed by Firefox.
*This issue only affects Android versions of Firefox and Firefox Focus.*

##### References

* [Bug 1823316](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316)

#### [#CVE-2023-6871: Lack of protocol handler warning in some instances](#CVE-2023-6871)

Reporter
Edward "JankhJankh" Prior
Impact
low
##### Description

Under certain conditions, Firefox did not display a warning when a user attempted to navigate to a new protocol handler.

##### References

* [Bug 1828334](https://bugzilla.mozilla.org/show_bug.cgi?id=1828334)

#### [#CVE-2023-6872: Browsing history leaked to syslogs via GNOME](#CVE-2023-6872)

Reporter
honorton via Tor Browser
Impact
low
##### Description

Browser tab titles were being leaked by GNOME to system logs. This could potentially expose the browsing habits of users running in a private tab.

##### References

* [Bug 1849186](https://bugzilla.mozilla.org/show_bug.cgi?id=1849186)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Randell Jesup, Valentin Gosu, Karl Tomlinson, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862777%2C1864015)

#### [#CVE-2023-6873: Memory safety bugs fixed in Firefox 121](#CVE-2023-6873)

Reporter
Andrew McCreight, Yury Delendik
Impact
high
##### Description

Memory safety bugs present in Firefox 120. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855327%2C1862089%2C1862723)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_897e22ca_20250115_100633.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_89a34be9_20250115_100633.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1828334)
* [XML](/show_bug.cgi?ctype=xml&id=1828334)

Closed
[Bug 1828334](/show_bug.cgi?id=1828334)
(CVE-2023-6871)

Opened 2 years ago
Closed 1 year ago

# Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)

## Categories

### (Firefox :: Security, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Security#Security)

Security
▾

Firefox :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

121 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix) |
| firefox119 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox116 |  | wontfix |
| firefox117 |  | wontfix |
| firefox118 |  | wontfix |
| firefox119 |  | wontfix |
| firefox120 |  | wontfix |
| firefox121 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Roy.Gunsen, Assigned: sclements)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a5c64c086e83ba611b034ee859d843d4?d=mm&size=40)  [sclements](/user_profile?user_id=603840)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/12fcc345697389dacf73cb1779260ca5?d=mm&size=40)  [Roy.Gunsen](/user_profile?user_id=725591)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fe2c2192f4fabf01f2d2e700631bb8fe?d=mm&size=40)  [manuel](/user_profile?user_id=688976)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

### (Depends on 1 open bug, URL )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1780484](/show_bug.cgi?id=1780484 "NEW - Homepage and NewTab values do not appear to be validated")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2023-32214](/show_bug.cgi?id=1828716 "RESOLVED FIXED - “ms-cxh” and “ms-cxh-full” protocol handlers considered harmful")

Dependency [tree](/showdependencytree.cgi?id=1828334&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1828334)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1844788](/show_bug.cgi?id=1844788 "RESOLVED DUPLICATE - No prompt before opening external protocol if \"user entered\" (typed, middle-click, or drag and drop)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

about:preferences#home

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1878648](/show_bug.cgi?id=1878648 "NEW - Open link with Extension asks for confirmation every time")

[1780484](/show_bug.cgi?id=1780484 "NEW - Homepage and NewTab values do not appear to be validated")

## Details

### (5 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main121+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6871

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main121+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a17728564_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files)

| [Protocol Handler Warning Bypass.pdf](/attachment.cgi?id=9328716)  [2 years ago](#c0)  [Roy.Gunsen](/user_profile?user_id=725591)   1.79 MB, application/pdf |  | [Details](/attachment.cgi?id=9328716&action=edit) |
| --- | --- | --- |
| [Holo2.PNG](/attachment.cgi?id=9329160)  [2 years ago](#c7)  [Roy.Gunsen](/user_profile?user_id=725591)   1.75 MB, image/png |  | [Details](/attachment.cgi?id=9329160&action=edit) |
| [Holo1.PNG](/attachment.cgi?id=9329161)  [2 years ago](#c8)  [Roy.Gunsen](/user_profile?user_id=725591)   17.16 KB, image/png |  | [Details](/attachment.cgi?id=9329161&action=edit) |
| [Screenshot 2023-08-07 at 2.57.19 pm.png](/attachment.cgi?id=9347710)  [1 years ago](#c21)  [Sarah Clements [:sclements]](/user_profile?user_id=603840)   57.17 KB, image/png |  | [Details](/attachment.cgi?id=9347710&action=edit) |
| [Screenshot 2023-08-07 at 6.33.38 pm.png](/attachment.cgi?id=9347727)  [1 years ago](#c22)  [Sarah Clements [:sclements]](/user_profile?user_id=603840)   45.26 KB, image/png |  | [Details](/attachment.cgi?id=9347727&action=edit) |
| [Bug 1828334 r=Gijs,dveditz](/attachment.cgi?id=9347926)  [1 years ago](#c24)  [Sarah Clements [:sclements]](/user_profile?user_id=603840)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9347926&action=edit) | [Review](/attachment.cgi?id=9347926) |
| [WIP: Bug 1828334 - Test fix](/attachment.cgi?id=9356738)  [1 year ago](#c30)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9356738&action=edit) | [Review](/attachment.cgi?id=9356738) |
| [advisory.txt](/attachment.cgi?id=9367982)  [1 year ago](#c47)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   184 bytes, text/plain |  | [Details](/attachment.cgi?id=9367982&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1828334#c0)• 2 years ago |
|  | |

Attached file
[Protocol Handler Warning Bypass.pdf](attachment.cgi?id=9328716)
— [Details](attachment.cgi?id=9328716&action=edit)

A full copy of this bug bounty submission with full screenshots can be found in the attached PDF file. I have also attached a video recording of the persistent soft lock. However, as this can't be recorded on the soft-locked device, the recording quality is quite low.

Issue Context

A protocol handler is an application that knows how to interpret particular types of links: for example, a mail client is a protocol handler for "mailto:" links. This allows external applications to be opened via a browser by navigating to a link such as “mailto:client@domainname.internal”.

Upon navigating to a protocol handler URL such as “calculator:calc” or “microsoft.windows.camera:aaaa”, browsers warn the user prior to triggering the protocol handler. This is due to how protocol handlers allow for the execution of programs outside of the browser context, and the security of these protocol handlers is outside of the browsers control.

Firefox will raise a warning prior to triggering the protocol handler in the following circumstances:

~ Navigation to a URL via an “<a>” tag.

~ A JavaScript redirect, such as window.open("calculator:calc").

~ Header based-redirects.

Issue description

Despite using a warning if a protocol handler URL is navigated to via the previously specified method, Firefox skips this check if the URL is directly navigated to directly via the URL bar. This can be done by entering it into the URL bar and pressing the “enter” key, or by setting the browser homepage to a URL containing a protocol handler and then re-opening Firefox.

One caveat to the above description is that the first time Firefox encounters a new protocol handler, it appears to silently ignore the request, and then upon any subsequent request it will automatically open.

This effectively circumvents the protection to prevent users from inadvertently executing protocol handlers.

Impact

Windows protocol handlers have been vulnerable to a number of remote code execution vulnerabilities in the past, any of which could have been leveraged in combination with this to function as a zero-click remote code execution vulnerability. Three such vulnerabilities are shown below:

~ <https://positive.security/blog/ms-officecmd-rce>

~ <https://blog.doyensec.com/2018/05/24/electron-win-protocol-handler-bug-bypass.html>

~ <https://www.bleepingcomputer.com/news/security/new-windows-search-zero-day-added-to-microsoft-protocol-nightmare/>

Zero-click Remote Code Execution

Real world situations where this is able to be leveraged as a zero-click remote code execution would include:

~ Social engineering, where a user is coerced into copy-pasting a URL into Firefox.

~ Compromising a cloud-sync session and setting the user's homepage to a protocol handler URL.

~ Lateral movement within a network, where a user can modify a user’s homepage via modifying config files on a victim's machine via an SMB share functionality.

~ User or system level persistence on a device via modifying either the Firefox configuration files or the windows registry keys to allow setting the user’s homepage.

If an attacker has file access to the victim machine machine, such as the previous two examples, this can be done without the need for a protocol handler vulnerability, as the user can simply add an unsafe protocol handler with user level privileges.

One-click Remote Code Execution

Alternatively for a one-click remote code execution, an attacker could use the Java Network Launch Protocol if Java is installed upon the host. Further information on this can be found in the following whitepaper:

<https://cybir.com/wp-content/uploads/2021/06/JNLP-Injection-and-Attacks-Release.pdf>

A example of this attack is the the following URL

“jnlp:[https://docs.oracle.com/javase/tutorialJWS/samples/deployment/dynamictree\_webstartJWSProject/dynamictree\_webstart.jnlp”](https://docs.oracle.com/javase/tutorialJWS/samples/deployment/dynamictree_webstartJWSProject/dynamictree_webstart.jnlp%E2%80%9D):

Upon clicking the run button, the Jar file referenced in the URL above is executed, in this case, opening a sample application.

Persistent Denial of Service

Another notable use for this vulnerability would be via the use of the “ms-cxh” and “ms-cxh-full” protocol handlers which can softlock some windows versions by creating a persistent black screen. This can be fixed through a series of commands found in the paper below, but is usually fixed with a full system reboot.

<https://papers.vx-underground.org/papers/Windows/Analysis%20and%20Internals/2022-01-16%20-%20Notes%20on%20Windows%20MS-CXH%20and%20MS-CXH-FULL%20handlers.pdf>

This was confirmed on an up-to-date windows version found here:

Edition: Windows 10 Home

Version: 21H2

OS Build: 19044.2846

Experience: Windows Feature Experience Pack 120.2212.4190.0

Once this setting is saved and Firefox is closed, every subsequent reopening of Firefox will soft-lock the computer. This will prevent all use of Firefox on the device without changing the specific file system configuration, as Firefox cannot be opened to remove this homepage setting. As this is a saved configuration, this will persist between reboots. To remove this soft-lock, the prefs.js file must be modified to remove the browser.startup.homepage value.

Steps to Replicate

Submit a protocol handler into the URL bar and press the “enter” key. If no applications open, re-submit the value and press the “enter” key again.

Here are three sample protocol handlers that will open an application on a default windows machine:

~ ms-photos:photos

~ microsoft.windows.camera:camera

~ ldap:ldap

To observe the homepage functionality, set the homepage at about:preferences#home to one of the above settings, then close and reopen Firefox. Once again, if no application opens on first reboot, close and reopen Firefox.

Remediation

Implement a protocol handler warning on all instances where a protocol handler is triggered from Firefox.

Flags: sec-bounty?

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1828334#c1)• 2 years ago |
|  | |

I realized the recording is too large for upload, should I upload a multi-part zip, or is another method more useful?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1828334#c2)• 2 years ago |
|  | |

We don't need a video—in fact prefer not taking up the space—unless the description is hard to understand or we can't reproduce the problem. Your PDF with screenshots is nicely done.

> Real world situations where this is able to be leveraged as a zero-click remote code execution would include:
>
> ~ Social engineering, where a user is coerced into copy-pasting a URL into Firefox.

Social engineering is about the furthest thing from a "zero-click" attack. "zero-click" meaning the user doesn't have to do ***anything*** to get compromised, not even clicking on an evil link. Examples include some of the iPhone vulnerabilities where someone could send a malicious iMessage and compromise your phone just by receiving it, without you even unlocking the phone to read it. Or the Samsung "Voice over LTE" issue in Exynos chips. Social engineering is high engagement.

> ~ Compromising a cloud-sync session and setting the user's homepage to a protocol handler URL.
>
> ~ Lateral movement within a network, where a user can modify a user’s homepage via modifying config files on a victim's machine via an SMB share functionality.
>
> ~ User or system level persistence on a device via modifying either the Firefox configuration files or the windows registry keys to allow setting the user’s homepage.

These three attacks are orders of magnitude more serious than changing someone's home page. Yes, you could do that, but if you've pulled off one of these attacks why would you bother rather than directly do whatever this homepage attack might accomplish for you?

> This effectively circumvents the protection to prevent users from inadvertently executing protocol handlers.

This seems to be a philosophical difference between Firefox and Chrome. Our warning is not to prevent the user from opening a protocol handler they've asked for, it's to warn them that a web page is trying to do something unusual and potentially dangerous. That does mean there's more risk of social engineering for Firefox users, but in practice we've seen these kind of social engineering (with other similar kinds of warnings) just tell people to expect the warning and click "OK" so I'm not sure it's a difference in practice.

Your point about Firefox allowing these as a home page is a good one. I'm not convinced it's an "attack" given the capabilities the attacker would have to have to get there, but there's no good reason for it and we could restrict the homepage to a "web-safe" set (and include `about:` and `moz-extension`).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1828334#c3)• 2 years ago |
|  | |

A more generic version of the homepage problem was stated as [bug 1780484](/show_bug.cgi?id=1780484 "NEW - Homepage and NewTab values do not appear to be validated") (validate the URLs) but without noting the problems that could be caused by external protocol handlers causing a hang.

I don't think we have any desire to change the lack of a warning when a user explicitly enters the external scheme into the address bar and don't consider it a security problem (Gijs: what do you think?)

It would be good to restrict and validate the homepage URLs, but I'm not convinced the lack of doing so is a security problem in itself. Web extensions can only register their own pages as home pages, users can make terrible setting choices that break their browser in many ways, and locally-running programs messing with preferences is outside a realistic threat model on a personal computer.

Depends on: [1780484](/show_bug.cgi?id=1780484 "NEW - Homepage and NewTab values do not appear to be validated")Flags: needinfo?(gijskruitbosch+bugs)See Also: → [1780484](/show_bug.cgi?id=1780484 "NEW - Homepage and NewTab values do not appear to be validated")

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1828334#c4)• 2 years ago |
|  | |

Hi Daniel,

Thanks for your thorough response.

That is a fair point, I intended to say that it could lead to a zero-click in the cloud-sync, lateral movement, and local persistence methods, not via copy-pasting a malicious URL.

As you mention, it wouldn't be a "zero-click" as the user would need to open Firefox, but I do think it is worth considering the cloud-sync avenue for setting the homepage, as the only user interaction required is to already have cloud-sync enabled, and to open reopen Firefox.

The persistence and lateral movement points are another consideration as to why a warning might be helpful, but I agree the only realistic attack scenario via cloud-sync settings.

Regarding the following point:

* "These three attacks are orders of magnitude more serious than changing someone's home page. Yes, you could do that, but if you've pulled off one of these attacks why would you bother rather than directly do whatever this homepage attack might accomplish for you?"

From my research the only other way to get remote-code execution from a cloud-sync browser session without any user interaction outside of opening the cloud-synced browser is via a malicious extension, which to the best of my knowledge has its own security vetting to avoid misuse. I have done some research into this if you would like me to provide further insight, but I presumed that malicious extensions were considered a separate issue due to the vetting process.

As far as additional context on homepage URL safety, Edge and Chrome both have an explicit blocklist of URLs you can not set the homepage to, such as "chrome://kill". I haven't looked too deeply into the Firefox equivalent, but this may also be worth considering.

Let me know if you have any further questions or comments.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1828334#c5)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #3](/show_bug.cgi?id=1828334#c3 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> I don't think we have any desire to change the lack of a warning when a user explicitly enters the external scheme into the address bar and don't consider it a security problem (Gijs: what do you think?)

I concur it's not a serious security problem.

However, I think this is a relatively recent change. I think previously there was a prompt to confirm the app to use for the protocol. This changed with [bug 1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler"). This switched us from 2 to 1 prompt for websites, but it also switched from 1 to 0 prompts for the address bar.

I don't think it's a big deal to switch that back for the address bar / system principal if we so desire, so the user gets prompted the first time a given protocol is invoked. Dan, wdyt?

> locally-running programs messing with preferences is outside a realistic threat model on a personal computer.

(In reply to Roy.Gunsen from [comment #4](/show_bug.cgi?id=1828334#c4 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> As you mention, it wouldn't be a "zero-click" as the user would need to open Firefox, but I do think it is worth considering the cloud-sync avenue for setting the homepage, as the only user interaction required is to already have cloud-sync enabled, and to open reopen Firefox.

I'm confused, wouldn't the user also need to have a local program installed that listens for this protocol?

If the attacker is able to install this program locally on the user's machine, they can clearly run arbitrary code on that machine anyway. So what does adding the indirection via Firefox and the protocol handler add?

(Obviously this doesn't help for protocols that ship with the OS, but if the OS ships protocol handlers that do dodgy stuff by default then that's an issue to take up with the OS vendors, IMO - as Dan said, it's pretty easy to convince browser users to click "yeah sure" in dialogs. On the browser side we can block them entirely on a case-by-case basis where appropriate, though it's a little whack-a-mole.)

> One caveat to the above description is that the first time Firefox encounters a new protocol handler, it appears to silently ignore the request, and then upon any subsequent request it will automatically open.

I can't reproduce this and would appreciate more specific steps about what you mean by this, because it sounds like a separate issue.

> Another notable use for this vulnerability would be via the use of the “ms-cxh” and “ms-cxh-full” protocol handlers which can softlock some windows versions by creating a persistent black screen.

We can block these protocol handlers altogether in a separate bug, which seems reasonable anyway, based on this description, separate from any filtering we might want to do for the homepage.

Depends on: [1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler")Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(dveditz)Flags: needinfo?(Roy.Gunsen)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a179861_159069)• 2 years ago |

Blocks: [CVE-2023-32214](/show_bug.cgi?id=1828716 "RESOLVED FIXED - “ms-cxh” and “ms-cxh-full” protocol handlers considered harmful")

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1828334#c6)• 2 years ago |
|  | |

* I'm confused, wouldn't the user also need to have a local program installed that listens for this protocol?

I think my major concern is in apps that ship with windows, or are commonly installed such as Zoom, Java, Teams, etc. Teams has had RCE in it in the past, as has default windows protocol handlers such as ms-search. Java currently has RCE in it after an additional prompt is raised.

* I can't reproduce this and would appreciate more specific steps about what you mean by this, because it sounds like a separate issue.

The first time I submit a protocol handler URL to Firefox, rather than trigger the protocol handler, it does nothing. Leaving me on a blank page with the URL still containing the link to the protocol handler. Here are three protocol handlers this functionality worked for me on:

* calculator:calc
* ms-holographicfirstrun:aaa
* ms-get-started:aaa

I've attached two screenshots, but its a bit hard to show. I can send through a screen recording if needed.

Flags: needinfo?(Roy.Gunsen)

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1828334#c7)• 2 years ago |
|  | |

Attached image
[Holo2.PNG](attachment.cgi?id=9329160)
— [Details](attachment.cgi?id=9329160&action=edit)

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1828334#c8)• 2 years ago |
|  | |

Attached image
[Holo1.PNG](attachment.cgi?id=9329161)
— [Details](attachment.cgi?id=9329161&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a283612_1689)• 2 years ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1828334#c9)• 2 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

Hi Gijs,

I saw you submitted the Dos from within this as [CVE-2023-32214](https://www.cve.org/CVERecord?id=CVE-2023-32214).

Can I be added as a reporter for it? Under the name "Edward Prior" ideally.

I would have posted it in the other thread, but I don't appear to be able to post in a closed thread.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1828334#c10)• 2 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to Roy.Gunsen from [comment #9](/show_bug.cgi?id=1828334#c9 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> Hi Gijs,
>
> I saw you submitted the Dos from within this as [CVE-2023-32214](https://www.cve.org/CVERecord?id=CVE-2023-32214).

I don't deal with CVEs so this wasn't me. Passing the below request to Tom instead.

> Can I be added as a reporter for it? Under the name "Edward Prior" ideally.

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(tom)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1828334#c11)• 2 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to Roy.Gunsen from [comment #9](/show_bug.cgi?id=1828334#c9 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> I would have posted it in the other thread, but I don't appear to be able to post in a closed thread.

For future reference, for things like CVE issues, you are probably better off emailing security@mozilla.org.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1828334#c12)• 2 years ago |
| off-topic | |

| Comment hidden (off-topic) |  |
| --- | --- |

(In reply to Andrew McCreight [:mccr8] from [comment #11](/show_bug.cgi?id=1828334#c11 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> (In reply to Roy.Gunsen from [comment #9](/show_bug.cgi?id=1828334#c9 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))
>
> > I would have posted it in the other thread, but I don't appear to be able to post in a closed thread.
>
> For future reference, for things like CVE issues, you are probably better off emailing security@mozilla.org.

Yes. To close my needinfo - I corrected the oversight in <https://github.com/mozilla/foundation-security-advisories/commit/a6d5e678789ab730e3e9c0f77a05f0d4aa08f32f> - thanks and sorry.

Flags: needinfo?(tom)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a9365894_1689)• 1 years ago |

Duplicate of this bug: [1844788](/show_bug.cgi?id=1844788 "RESOLVED DUPLICATE - No prompt before opening external protocol if \"user entered\" (typed, middle-click, or drag and drop)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1828334#c14)• 1 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #5](/show_bug.cgi?id=1828334#c5 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> previously there was a prompt to confirm the app to use for the protocol. This changed with [bug 1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler"). This switched us from 2 to 1 prompt for websites, but it also switched from 1 to 0 prompts for the address bar.
>
> I don't think it's a big deal to switch that back for the address bar / system principal if we so desire, so the user gets prompted the first time a given protocol is invoked. Dan, wdyt?

I think we do have to put this friction back into the browser. It doesn't "solve" the problem because some number of users are going to open it anyway, but the unexpected prompt might give a lot of them time to have a second thought about it.

Are you proposing just to bring back the old dialog with the same options? That works for me. If not we might have to argue about what you mean by "first time". If the attacker just has to run the attack twice to get through then that's not much protection. I agree users should have the option to remember the choice, but users need to have the option to NOT remember that's easier than having to go into preferences and manually change the option every time they encounter a new protocol.

This doesn't solve Roy's concern about someone hacking a cloud-sync profile. If you can hack it to change someone's home page then you could also change their preferences to "remember" to use that protocol without asking. That seems outside the scope of what we can reasonably expect to protect against. Our own Sync product encrypts the shared data on the client so that it can't possibly be modified or read even if our sync servers do get hacked. Does Chrome or Edge have a solution for this problem?

> (Obviously this doesn't help for protocols that ship with the OS, but if the OS ships protocol handlers that do dodgy stuff by default then that's an issue to take up with the OS vendors, IMO - as Dan said, it's pretty easy to convince browser users to click "yeah sure" in dialogs. On the browser side we can block them entirely on a case-by-case basis where appropriate, though it's a little whack-a-mole.)

Way too many programs that the user never chose to put on their machine advertise themselves as URL handlers, and many of them are in "barely maintenance mode" but can't be removed because Microsoft supports old customer use-cases practically forever. Remember those `.diagcab` files that caused us trouble? The Microsoft Support Diagnostic Tool is [officially deprecated](https://support.microsoft.com/en-us/windows/deprecation-of-microsoft-support-diagnostic-tool-msdt-and-msdt-troubleshooters-0c5ac9a2-1600-4539-b9d0-069e71f9040a) but won't actually be removed from anyone's machines until 2025 (not clear if that even applies to Windows 10 or only Windows 11).

We should do what we can to make it hard to get to these uncommon handlers unintentionally. As the recent Google Security post on [the state of 0-days in 2022](https://security.googleblog.com/2023/07/the-ups-and-downs-of-0-days-year-in.html) notes,

> Advances in the defenses of the top browsers is likely influencing the push to other components as the initial vector in an exploit chain.
>
> ...
>
> In 2022, more attackers began moving to using 0-click exploits instead, exploits that require no user interaction to trigger. 0-clicks tend to target device components other than browsers.

This doesn't fit their definition of "0-click" in any way, but it does illustrate attackers are looking for vectors that get around the browser, and that they are sensitive to the number of interactions required to launch.

Status: UNCONFIRMED → NEWNo longer depends on: [1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler")Ever confirmed: trueFlags: needinfo?(dveditz)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler")

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1828334#c15)• 1 years ago |
|  | |

I think the simplest solution to reduce the likelihood of a user getting compromised via this is to bring the prompt back.

I do agree that the circumstance where this could be considered a 0-Click is very contrived. I think the more likely circumstance is attackers would leverage cloud-sync to send users to phishing sites. But that's basically impossible to prevent with the current setup.

My thoughts for other changes are:

* Limit the starting page to a regex match of ^https?:// , or potentially a regex that allows local file locations as well. Note, Chrome and Edge have a blocklist for this. Eg, you cant set your homepage to edge://restart/ in Edge because it would force a boot loop. I don't believe I saw one on Firefox.
* Consider swapping to an allowlist of trusted application handlers.

I noticed Firefox doesn't synchronise a lot of sensitive settings such as remembering protocol usage, and the location downloaded files are saved to disk. It could be worth going through the list of synced settings and checking for anything problematic.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1828334#c16)• 1 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler")

:sclements, since you are the author of the regressor, [bug 1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler"), could you take a look? Also, could you set the severity field?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#needinfo_regression_author.py).

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Flags: needinfo?(sclements)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1828334#c17)• 1 years ago |
|  | |

(Note: the linked Google Blog post currently doesn't load in Firefox for a lot of people -- a jQuery regexp in the page is timing out and throwing a "too much recursion" exception. We're aware and people are looking into it)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1828334#c18)• 1 years ago |
|  | |

To clarify, is the proposed solution to bring back the prompt *just* for the address bar? I need these requirements nailed down before I can work on a fix. I also need an opinion on severity since this is clearly a security issue but this bug was also filed 4 months ago.

Flags: needinfo?(sclements) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1828334#c19)• 1 years ago |
|  | |

(In reply to Sarah Clements [:sclements] from [comment #18](/show_bug.cgi?id=1828334#c18 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> To clarify, is the proposed solution to bring back the prompt *just* for the address bar?

Just for system principal. Which is the address bar, some of the drag & drop cases, etc. But not "normal" link clicks in websites.

> I need these requirements nailed down before I can work on a fix. I also need an opinion on severity since this is clearly a security issue but this bug was also filed 4 months ago.

It's marked `sec-low`, so it's not high/critical severity, but it's also (I think) a relatively small patch. Specifically, I think [this condition](https://searchfox.org/mozilla-central/rev/cb045e3330e3fa479c5568c738a770ac5b3efe2a/toolkit/mozapps/handling/ContentDispatchChooser.sys.mjs#155-165) could be updated to add `!aPrincipal?.isSystemPrincipal`, so that in that case we don't skip the dialog.

(In reply to Roy.Gunsen from [comment #15](/show_bug.cgi?id=1828334#c15 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> * Limit the starting page to a regex match of ^https?:// , or potentially a regex that allows local file locations as well. Note, Chrome and Edge have a blocklist for this. Eg, you cant set your homepage to edge://restart/ in Edge because it would force a boot loop. I don't believe I saw one on Firefox.

It would be useful to file a separate bug for this. I agree it would be a reasonable improvement.

> * Consider swapping to an allowlist of trusted application handlers.

Unfortunately, I don't think this is feasible. Every app and their competitor has one of these protocols, and only allowlisting the common ones would effectively help create an oligopoly for the existing players in a given market (e.g. MS teams, zoom, cisco, meet.google.com, for video conferencing; apple music, spotify and windows' music stuff for music; etc.). We try to avoid doing this (ie preferring large companies that are already in a space in terms of how the browser treats them) in general. There is currently an allowlist for protocols that websites are allowed to register, but there is [active work to change that, arguing that browsers should not be responsible for maintaining that list](https://github.com/whatwg/html/issues/9158), and that is therefore likely to switch to a block- rather than allowlist in future.

> I noticed Firefox doesn't synchronise a lot of sensitive settings such as remembering protocol usage, and the location downloaded files are saved to disk. It could be worth going through the list of synced settings and checking for anything problematic.

The download destination probably isn't synced because syncing paths across devices is a recipe for failure (they might not exist, or even be legal paths, on the other device which may run a different OS or have different file system restrictions). Protocol usage isn't synced, for one because it's not in the prefs storage but elsewhere (`handlers.json`) and for another because it suffers from the same issue (you can configure custom handling executables and those have paths so we're back to the same problem).

In general the sync/fxa team should be bearing some of this stuff in mind when deciding what prefs get synced, and we have made changes there over time for security reasons as well. I'm not sure that a new audit would find anything new - though of course, if you think there are things that *are* synced that shouldn't be, filing separate bugs would be useful.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1828334#c20)• 1 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #19](/show_bug.cgi?id=1828334#c19 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> (In reply to Sarah Clements [:sclements] from [comment #18](/show_bug.cgi?id=1828334#c18 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))
>
> > To clarify, is the proposed solution to bring back the prompt *just* for the address bar?
>
> Just for system principal. Which is the address bar, some of the drag & drop cases, etc. But not "normal" link clicks in websites.
>
> > I need these requirements nailed down before I can work on a fix. I also need an opinion on severity since this is clearly a security issue but this bug was also filed 4 months ago.
>
> It's marked `sec-low`, so it's not high/critical severity, but it's also (I think) a relatively small patch. Specifically, I think [this condition](https://searchfox.org/mozilla-central/rev/cb045e3330e3fa479c5568c738a770ac5b3efe2a/toolkit/mozapps/handling/ContentDispatchChooser.sys.mjs#155-165) could be updated to add `!aPrincipal?.isSystemPrincipal`, so that in that case we don't skip the dialog.

Thanks for clarifying.

Assignee: nobody → sclementsSeverity: -- → S3Status: NEW → ASSIGNEDPriority: -- → P1

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1828334#c21)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1828334&comment_id=16528665 "3 revisions") |
|  | |

Attached image
[Screenshot 2023-08-07 at 2.57.19 pm.png](attachment.cgi?id=9347710)
— [Details](attachment.cgi?id=9347710&action=edit)

So after digging into this, it seems that the issue is specifically protocol handlers where there is a system protocol, so ms-specific protocols per the STR and itunes: on mac. With protocol handlers where there's a default app, that's also where I see that typing it into the url bar and hitting enter doesn't always open the app right away, you do have to hit enter twice sometimes.

For protocols where you need to download the app, say zoom, I can easily verify that if I open firefox with a new profile, copy/paste a zoom meeting url into the address bar and hit enter, I do in fact see this protocol prompt show up (on both mac and windows). And if for example, I don't have zoom installed yet, the protocol handler doesn't open, instead you see a web page from zoom prompting the user to download the app and/or click the web link instead.

So to confirm this is the change we want: if a user uses a protocol where there is a system app, we don't skip the permission dialog, we show it unless that user hits the "Always allow" checkbox (same as what we do for other protocols). On Edge, if I type "ms-photos:photos" in the url bar it shows the prompt that the website is trying to open Photos with an "open" or "cancel" option, so there's never an option to "always allow" and bypass it.

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a9771502_603840)• 1 years ago |

Summary: Protocol Handler Warning Bypass Leading To Remote Code Execution Conditions → Protocol handler warning should not be skipped for system-specific protocols

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1828334#c22)• 1 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1828334&comment_id=16528779 "3 revisions") |
|  | |

Attached image
[Screenshot 2023-08-07 at 6.33.38 pm.png](attachment.cgi?id=9347727)
— [Details](attachment.cgi?id=9347727&action=edit)

We can get back to this screen for system-specific protocols but either way I think that means we modify`_hasProtocolHandlerPermission` [used here](https://searchfox.org/mozilla-central/source/toolkit/mozapps/handling/ContentDispatchChooser.sys.mjs#48-51) that was added in [bug 1565574](/show_bug.cgi?id=1565574 "VERIFIED FIXED - 'Always allow' for external protocol / scheme handling should be a per-origin permission").

Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(dveditz)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a9773038_603840)• 1 years ago |

No longer regressed by: [1731898](/show_bug.cgi?id=1731898 "RESOLVED FIXED - Skip the application chooser dialog step when a non-standard protocol has registered handler")

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1828334#c23)• 1 years ago |
|  | |

Aha! What we need is to add `!aPrincipal.isSystemPrincipal` to [here](https://searchfox.org/mozilla-central/source/toolkit/mozapps/handling/ContentDispatchChooser.sys.mjs#70). That should bring the dialog back.

Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(dveditz)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1828334#c24)• 1 years ago |
|  | |

Attached file
[Bug 1828334 r=Gijs,dveditz](attachment.cgi?id=9347926)
— [Details](attachment.cgi?id=9347926&action=edit)

* Add condition for aPrincipal.isSystemPrincipal in \_hasProtocolHandlerPermission

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a10447041_690067)• 1 year ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a10583755_75935)• 1 year ago |

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1828334#c25)• 1 year ago |
|  | |

(In reply to Sarah Clements [:sclements] from [comment #21](/show_bug.cgi?id=1828334#c21 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> For protocols where you need to download the app, say zoom, I can easily verify that if I open firefox with a new profile, copy/paste a zoom meeting url into the address bar and hit enter,

I think here you're using `https://blah.zoom.us/<morethings>` as the "meeting url".

But "behind the scenes" that opens `zoommtg:...` URLs. If you discover that precise URL (you can find it in the debugger when the dialog is shown, for instance, but IIRC once you know the format and know the room #, it's pretty straightforward to predict), and paste that `zoommtg:...` string in the URL bar and hit enter, that will behave the same as the `itunes:` and `ms-blah` URLs.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1828334#c26)• 1 year ago |
|  | |

Sarah, is there something I can do to help you move forward here?

Flags: needinfo?(sclements)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1828334#c27)• 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #26](/show_bug.cgi?id=1828334#c26 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> Sarah, is there something I can do to help you move forward here?

Sorry for the delay, I've been swamped with release work. I should be able to get back to this next week.

Flags: needinfo?(sclements)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1828334#c28)• 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #25](/show_bug.cgi?id=1828334#c25 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> (In reply to Sarah Clements [:sclements] from [comment #21](/show_bug.cgi?id=1828334#c21 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))
>
> > For protocols where you need to download the app, say zoom, I can easily verify that if I open firefox with a new profile, copy/paste a zoom meeting url into the address bar and hit enter,
>
> I think here you're using `https://blah.zoom.us/<morethings>` as the "meeting url".
>
> But "behind the scenes" that opens `zoommtg:...` URLs. If you discover that precise URL (you can find it in the debugger when the dialog is shown, for instance, but IIRC once you know the format and know the room #, it's pretty straightforward to predict), and paste that `zoommtg:...` string in the URL bar and hit enter, that will behave the same as the `itunes:` and `ms-blah` URLs.

Ah, right - `zoommtg` does indeed behave the same way.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1828334#c29)• 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #19](/show_bug.cgi?id=1828334#c19 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> (In reply to Roy.Gunsen from [comment #15](/show_bug.cgi?id=1828334#c15 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))
>
> > * Limit the starting page to a regex match of ^https?:// , or potentially a regex that allows local file locations as well. Note, Chrome and Edge have a blocklist for this. Eg, you cant set your homepage to edge://restart/ in Edge because it would force a boot loop. I don't believe I saw one on Firefox.
>
> It would be useful to file a separate bug for this. I agree it would be a reasonable improvement.

[bug 1780484](/show_bug.cgi?id=1780484 "NEW - Homepage and NewTab values do not appear to be validated") is intended to cover that. If it's not clear enough please add comments

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a14688950_75935)• 1 year ago |

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fix-optional)
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fix-optional)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1828334#c30)• 1 year ago |
|  | |

Attached file
[WIP: Bug 1828334 - Test fix](attachment.cgi?id=9356738)
— [Details](attachment.cgi?id=9356738&action=edit)

|  | [Roy.Gunsen](/user_profile?user_id=725591)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1828334#c31)• 1 year ago |
|  | |

Hi All,

I have been approved to talk at Blackhat regarding how Cloud-Synchronization affects browser security, I am hoping to discuss this vulnerability (amongst others), as a part of that talk.

Would it be possible to get this patched prior to the 6th of December? Or could I get the okay to discuss it if it is still unpatched?

Sorry for the late notice, I only found out recently and have been busy getting other things sorted for it.

Regards,

Ed.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1828334#c32)• 1 year ago |
|  | |

It looks like 120 will be released on November 21, so that will be the version we'd have to fix this in to have it done by December 6th.

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1828334#c33)• 1 year ago |
|  | |

I'll continue work on this tomorrow, but no promises - there is test bustage to work through.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1828334#c34)• 1 year ago |
|  | |

(In reply to Roy.Gunsen from [comment #31](/show_bug.cgi?id=1828334#c31 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> I have been approved to talk at Blackhat regarding how Cloud-Synchronization affects browser security, I am hoping to discuss this vulnerability (amongst others), as a part of that talk.

Congratulations!

> Would it be possible to get this patched prior to the 6th of December? Or could I get the okay to discuss it if it is still unpatched?

We'd prefer if you could keep the details hidden until we have had the chance to protect our users. Our full stance on disclosure is in the bug bounty FAQ at <https://www.mozilla.org/en-US/security/bug-bounty/faq/#nondisclosure>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a16666976_600971)• 1 year ago |

[Attachment #9347926](/attachment.cgi?id=9347926&action=edit "Bug 1828334  r=Gijs,dveditz") -
Attachment description: WIP: Bug 1828334 - Change permission condition for protocol handler r=Gijs,dveditz → Bug 1828334 - Change permission condition for protocol handler r=Gijs,dveditz

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a17269758_600971)• 1 year ago |

[Attachment #9347926](/attachment.cgi?id=9347926&action=edit "Bug 1828334  r=Gijs,dveditz") -
Attachment description: Bug 1828334 - Change permission condition for protocol handler r=Gijs,dveditz → Bug 1828334 r=Gijs,dveditz

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1828334#c35)• 1 year ago |
|  | |

Pushed by sclements@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/d7ba64895091>
r=Gijs,dveditz,extension-reviewers,fluent-reviewers,flod,robwu

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1828334#c36)• 1 year ago |
|  | |

Backout by csabou@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/36f2efb02d43>
Backed out changeset d7ba64895091 for causing talos damp hangs.

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1828334#c37)• 1 year ago |
|  | |

Backed out for causing [talos hangs](https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception&searchStr=talos&revision=94e5f553d8ee5632338645c8928e3cc1454d7b5b&selectedTaskRun=JU-uPs2bTuqUOY_7RkqpFw.0)

* [Backout link](https://hg.mozilla.org/integration/autoland/rev/36f2efb02d43)
* the Runs hang for 1hr after this [line in the log](https://treeherder.mozilla.org/logviewer?job_id=434757906&repo=autoland&lineNumber=1461)
Flags: needinfo?(sclements)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1828334#c38)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1828334&comment_id=16651815 "1 revision") |
|  | |

I can see why that damp test failed locally, when I run `./mach talos-test --suite damp --subtests webconsole --cycles 1 --tppagecycles 1`. We now see a permission dialog asking to "Open the ext+damp link with damp protocol", and that's causing the test to hang and time out. I've traced that to this [manifest](https://searchfox.org/mozilla-central/source/testing/talos/talos/tests/devtools/addon/manifest.json#14) but since I'm neither familiar with devtools/addons code nor damp/talos performance tests so this is very confusing to debug.

Since this test seems to be about performance of the page load, my initial thought is in order to by-pass the dialog we could add some sort of value/arg to that manifest of `triggeredExternally: true` so as to bypass the dialog. But I can't quite figure out where the `handleURI` of `ContentDispatchChooser` is called and whether that manifest file is the right place to do so. It seems like it might be part of set up, before even the damp.html is loaded based on what I'm seeing in the terminal:

```
started process 14848 (/Users/sarah/mozilla-unified/objdir-frontend/dist/Nightly.app/Contents/MacOS/firefox -foreground --no-remote -profile /var/folders/n4/xbx64n7n093f0f1j2749s34w0000gn/T/tmprb2n5yv3/profile)
16:35:36     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:36     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new Error("Unexpected content-type \"text/plain;charset=US-ASCII\"", "resource://services-settings/Utils.sys.mjs", 399))
16:35:37     INFO -  PID 14848 | console.error: (new InvalidStateError("JSWindowActorParent.sendAsyncMessage: JSWindowActorParent cannot send at the moment", (void 0), 536))
16:35:37     INFO -  PID 14848 | console.error: (new InvalidStateError("JSWindowActorParent.sendAsyncMessage: JSWindowActorParent cannot send at the moment", (void 0), 536))

```

^It hangs here until you click the "open link" button in the dialog, so then it looks like `damp.html` is loaded and thus the scripts from `driver.js` and `api.js`.

```
16:35:40     INFO -  PID 14848 | [damp-api] Retrieve the main DevTools loader
16:35:40     INFO -  PID 14848 | [damp-api] Retrieve the DAMP runner and start the test
16:35:40     INFO -  PID 14848 | [DampLoad helper] Register DampLoad actors
16:35:41     INFO -  PID 14848 | Garbage collect
16:35:42     INFO -  PID 14848 | Loading test 'webconsole/cold-open.js'
16:35:42     INFO -  PID 14848 | Executing test 'webconsole/cold-open.js'

```

:robwu and :Gijs, please let me know if you have some suggestions or insight into this test.

Flags: needinfo?(sclements)Flags: needinfo?(rob)Flags: needinfo?(gijskruitbosch+bugs)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1828334#c39)• 1 year ago |
|  | |

I'm not familiar with that specific test, but would setting the `open-protocol-handler` permission for the test site work?

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1828334#c40)• 1 year ago |
|  | |

The issue is not specific to damp tests. There are two instances that register a custom protocol that are going to be handled by the extension. That is, these two protocols redirect to a moz-extension:-URL:

* ext+damp at <https://searchfox.org/mozilla-central/rev/8acfbe4ba09b46b91c862dc2fbc064d4fc1bac9a/testing/talos/talos/tests/devtools/addon/manifest.json#14>
* ext+twinopen at <https://searchfox.org/mozilla-central/rev/8acfbe4ba09b46b91c862dc2fbc064d4fc1bac9a/testing/talos/talos/tests/twinopen/manifest.json#14>

Judging by the failure and the change in the patch, it looks like these schemes are opened from a system principal, and the `open-protocol-handler^ext+damp` and `open-protocol-handler^ext+twinopen` permissions aren't working because that check is skipped by the patch, by <https://hg.mozilla.org/integration/autoland/rev/d7ba64895091#l3.52>

If we return to the drawing board - the purpose of the patch to this bug is to prevent external protocol handlers from being triggered without user interaction. I think that it is safe to keep the current behavior for protocols that are handled within the browser ("safe schemes" from registerProtocolHandler and certain schemes with the ext+ and web+ prefix - see [extension\_protocol\_handlers.json](https://searchfox.org/mozilla-central/rev/8acfbe4ba09b46b91c862dc2fbc064d4fc1bac9a/toolkit/components/extensions/schemas/extension_protocol_handlers.json#15-52)) . Or at the very least, we can prioritize the fix for external protocol handlers and defer the behavioral change for these internal schemes to a follow-up.

There is no guarantee that the URL is going to be opened in Firefox, even if the protocol handler is in the format described above. One of the ways to determine whether a protocol is going to open internally, is to look up the protocol handler and see if it maps to a URL that starts with http(s): or moz-extension:. The extension-registered protocol handlers are [implemented in ext-protocolHandlers.js](https://searchfox.org/mozilla-central/rev/8acfbe4ba09b46b91c862dc2fbc064d4fc1bac9a/toolkit/components/extensions/parent/ext-protocolHandlers.js#44-66). To detect them, you'd have to add a check that mirrors that logic. It looks like that logic exists at <https://searchfox.org/mozilla-central/rev/8acfbe4ba09b46b91c862dc2fbc064d4fc1bac9a/toolkit/mozapps/handling/ContentDispatchChooser.sys.mjs#58-62> , but only to skip a prompt loop. I suppose that you could add a similar check to weaken the condition that you've added in the patch. When you do, ask Gijs for another review.

Flags: needinfo?(rob)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1828334#c41)• 1 year ago |
|  | |

I don't love specialcasing web+/ext+ schemes.

An alternative could be setting `security.external_protocol_requires_permission` to false for these performance tests.

Does that work? If so, it seems simpler and avoids changing code-under-test just for the performance test weirdness. Though ideally at some point we get rid of the pref so we'll need to reconsider this then, it seems more expedient than deferring fixing ext/web. Yes, ext/web protocols were not the original point of this bug (rather, issues/vulnerabilities in protocols implemented by other *apps* on the machine were), a priori there is no particular reason the same type of vulnerability couldn't exist with web- or extension-implemented protocols (albeit limited by virtue of the in-browser execution context vs. the unsandboxed OS-level app execution).

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1828334#c42)• 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #41](/show_bug.cgi?id=1828334#c41 "RESOLVED FIXED - Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)"))

> I don't love specialcasing web+/ext+ schemes.
>
> An alternative could be setting `security.external_protocol_requires_permission` to false for these performance tests.
>
> Does that work?

Yes, adding that pref to `testing/profiles/perf/user.js` gets the twinopen and damp tests passing locally.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1828334#c43)• 1 year ago |
|  | |

Pushed by sclements@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/89a118c58786>
r=Gijs,dveditz,extension-reviewers,fluent-reviewers,flod,robwu,perftest-reviewers

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1828334#c44)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/89a118c58786>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 121 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1828334#c45)• 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:sclements, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox120` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(sclements)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a17715980_75935)• 1 year ago |

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix)

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1828334#c46)• 1 year ago |
|  | |

I chatted with Gijs and because of the types of changes in this patch, it'd probably be best to let this ride the train for 121 rather than trying to uplift to beta.

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)Flags: needinfo?(sclements)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a17728564_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+Summary: Protocol handler warning should not be skipped for system-specific protocols → Protocol handler warning should not be skipped for external scheme URLs entered directly in the addressbar (or other UI)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a17890211_75935)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a20019190_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a20650164_586683)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main121+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1828334#c47)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367982)
— [Details](attachment.cgi?id=9367982&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a21008256_578488)• 1 year ago |

Alias: CVE-2023-6871

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a25500240_447061)• 11 months ago |

Regressions: [1878648](/show_bug.cgi?id=1878648 "NEW - Open link with Extension asks for confirmation every time")

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a25586950_603840)• 11 months ago |

No longer regressions: [1878648](/show_bug.cgi?id=1878648 "NEW - Open link with Extension asks for confirmation every time")

|  | [Sarah Clements [:sclements]](/user_profile?user_id=603840)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a25586974_603840)• 11 months ago |

See Also: → [1878648](/show_bug.cgi?id=1878648 "NEW - Open link with Extension asks for confirmation every time")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1828334#c48)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1828334#a35435398_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1828334&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Roy.Gunsen](/user_profile?user_id=725591)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


