=== Content from www.mozilla.org_f22f7fdc_20250114_200419.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-54

## Security Vulnerabilities fixed in Firefox ESR 115.6

Announced
December 19, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.6

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6862: Use-after-free in nsDNSService](#CVE-2023-6862)

Reporter
Randell Jesup
Impact
moderate
##### Description

A use-after-free was identified in the `nsDNSService::Init`. This issue appears to manifest rarely during start-up.

##### References

* [Bug 1868042](https://bugzilla.mozilla.org/show_bug.cgi?id=1868042)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Karl Tomlinson, Valentin Gosu, Randell Jesup, Yury Delendik, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862089%2C1862777%2C1864015)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.debian.org_9c451470_20250114_200416.html ===


---

[[Date Prev](msg00277.html)][[Date Next](msg00279.html)]
[[Thread Prev](msg00277.html)][[Thread Next](msg00279.html)]
[[Date Index](maillist.html#00278)]
[[Thread Index](threads.html#00278)]

# [SECURITY] [DSA 5581-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5581-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 20 Dec 2023 19:23:51 +0000
* *Message-id*: <ZYM/R0NEjTJhvwBy@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5581-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 20, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6863
                 CVE-2023-6864 CVE-2023-6865 CVE-2023-6867

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, sandbox escape or clickjacking.

For the oldstable distribution (bullseye), these problems have been fixed
in version 115.6.0esr-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 115.6.0esr-1~deb12u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmWDPxAACgkQEMKTtsN8
TjYfeRAAql+aZ6PpAM1Fq4Cp1IlvDQc8BYNuKrjn9/4xYgq/bAnQyRGj1I0viHP2
dUdZl6CcndqE6NVgm1mYpCQ/TZJpwSSxnoXf46bB/lGNg17Cw7T8gWI5uUSs1K63
UOYNMr8HlCF35qZpU0+TrsL+q3qRdkOQOxRLSFHNhxuUQ+44pUJYKDVg6vKjHU91
oQEfjzmcgn2Z+tL/zyrt4s57XUGpZNm6Vmg/TUftXL5+CDodCNPRnIw0JBYWu2yf
J3tj6cuCw6jDAcAouAsDcd8CbK28Bf6h2zUossRGVjSfNWeoshK2qe9L3/wlQB62
s0wrJ1MimP9k1y9xS4Iy85vf2BDDnVQBNgMR8mKnwt63Jhngpx8JW8oTbBKzx1oi
EZkShw3CDWuCx7ooMnR8glwybPJqXMyZbt8H7dMO3IFEwD2dfNzVfwyEUq4JAOzC
PasLEwCekXrTTxeZoYdTW4y8c5c4GEd9nvO8Hdk9iV/zbD1uhpgy0g6oQXciAzSH
6Rm92u2+HPwNOFjZAJMOi9eyqtdj9PqwHZ1uraXhtqCz8peD/Sg+YZCAXt0lLyVM
+WbQqJOyH5n1POeEHbEikv1iMLXRw+Vkkbzr3u9laTdQ9Yn1b/ZfVblG6/N+hhlL
LXYBXyYfrU4L6DMTnUave299Cq1fb8RPWVefcqAv6DoQX0P1GHc=
=8/zE
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_91aad87a_20250114_200413.html ===


---

[[Date Prev](msg00019.html)][[Date Next](msg00021.html)]
[[Thread Prev](msg00019.html)][[Thread Next](msg00021.html)]
[[Date Index](maillist.html#00020)]
[[Thread Index](threads.html#00020)]

# [SECURITY] [DLA 3697-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3697-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 29 Dec 2023 11:08:44 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20231229100844.B99042A00FB%40andromeda)Â [20231229100844.B99042A00FB@andromeda](msg00020.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3697-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.6.0esr-1~deb10u1
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6863
                 CVE-2023-6864 CVE-2023-6865 CVE-2023-6867

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, sandbox escape or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.6.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWOmqoACgkQnUbEiOQ2
gwKefhAAoZQBSJoZAdBQQsntXnHOjR09PpxPBhtc+Rl8OkjDlYrCUXiXBTtdvPit
+q1XLz5W2yxGptoqI8iMzkk4y9MpX6c6ncTSVLkDwBA9t91P+omKnC8IPUwsFRyT
4L7dncZsm0vuiJwHJWCigpSreEt1zlQhSULgj0g4h/bRAwDMz5zQ/qFmPe2ocLfn
0Lx+8xpcd/n+/jTI1lqAy62lAqIhKLzhotWrrmBV8V1jLLscjTAX5uhJc6yaHhfW
01kvZpY4X+YSpqYoCWlZP2LXnG4JGRpQk4kX3Xt8F3wZVqA+t8yquyK/PloEqdVO
emChkZTPzzfOhR1CgdVi3P4VAw8xaq9CiHAr5xhhEyHDtW5AIAxNN9676B9P6cAg
5XVfQ2Yb4tMboG7y4ojxKXSAUEsOT55RVtAHK6iGyjUX0C4qPltJErJrno255ErT
GtleR8pqXWr72lZWioul9BI3EB5EJw8JCw7WL7/ixUBZGwcrJj9hR5G0/dPSUDbe
KajpGYN1LrMf2ZpLE5pF5IDD+63zQBqzk+iQa/ghmrkXCW9B0Q2yYBFpmZc7Wt5W
LCoKQzSME0ft1uRL9ZooWtH19mV+SSmu++nb0lGkdQDdLG1qt/ZPh4Brz+9jXJ6E
f65JpUC3tUopHTNxJAn4R2Adl422xt7rplwOlc/UMM30+rGnkz8=
=1jYk
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_897e22ca_20250114_200414.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities â€” GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_49d17580_20250114_200420.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-56

## Security Vulnerabilities fixed in Firefox 121

Announced
December 19, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 121

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6135: NSS susceptible to "Minerva" attack](#CVE-2023-6135)

Reporter
George Pantela (Red Hat) and Hubert Kario (Red Hat)
Impact
high
##### Description

Multiple NSS NIST curves were susceptible to a side-channel attack known as "Minerva". This attack could potentially allow an attacker to recover the private key.

##### References

* [Bug 1853908](https://bugzilla.mozilla.org/show_bug.cgi?id=1853908)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6866: TypedArrays lack sufficient exception handling](#CVE-2023-6866)

Reporter
Tom Schuster
Impact
moderate
##### Description

TypedArrays can be fallible and lacked proper exception handling. This could lead to abuse in other APIs which expect TypedArrays to always succeed.

##### References

* [Bug 1849037](https://bugzilla.mozilla.org/show_bug.cgi?id=1849037)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6868: WebPush requests on Firefox for Android did not require VAPID key](#CVE-2023-6868)

Reporter
John-Mark Gurney
Impact
moderate
##### Description

In some instances, the user-agent would allow push requests which lacked a valid VAPID even though the push manager subscription defined one. This could allow empty messages to be sent from unauthorized parties.
*This bug only affects Firefox on Android.*

##### References

* [Bug 1865488](https://bugzilla.mozilla.org/show_bug.cgi?id=1865488)

#### [#CVE-2023-6869: Content can paint outside of sandboxed iframe](#CVE-2023-6869)

Reporter
Oriol Brufau
Impact
low
##### Description

A `<dialog>` element could have been manipulated to paint content outside of a sandboxed iframe. This could allow untrusted content to display under the guise of trusted content.

##### References

* [Bug 1799036](https://bugzilla.mozilla.org/show_bug.cgi?id=1799036)

#### [#CVE-2023-6870: Android Toast notifications may obscure fullscreen event notifications](#CVE-2023-6870)

Reporter
Hafiizh
Impact
low
##### Description

Applications which spawn a Toast notification in a background thread may have obscured fullscreen notifications displayed by Firefox.
*This issue only affects Android versions of Firefox and Firefox Focus.*

##### References

* [Bug 1823316](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316)

#### [#CVE-2023-6871: Lack of protocol handler warning in some instances](#CVE-2023-6871)

Reporter
Edward "JankhJankh" Prior
Impact
low
##### Description

Under certain conditions, Firefox did not display a warning when a user attempted to navigate to a new protocol handler.

##### References

* [Bug 1828334](https://bugzilla.mozilla.org/show_bug.cgi?id=1828334)

#### [#CVE-2023-6872: Browsing history leaked to syslogs via GNOME](#CVE-2023-6872)

Reporter
honorton via Tor Browser
Impact
low
##### Description

Browser tab titles were being leaked by GNOME to system logs. This could potentially expose the browsing habits of users running in a private tab.

##### References

* [Bug 1849186](https://bugzilla.mozilla.org/show_bug.cgi?id=1849186)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Randell Jesup, Valentin Gosu, Karl Tomlinson, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862777%2C1864015)

#### [#CVE-2023-6873: Memory safety bugs fixed in Firefox 121](#CVE-2023-6873)

Reporter
Andrew McCreight, Yury Delendik
Impact
high
##### Description

Memory safety bugs present in Firefox 120. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855327%2C1862089%2C1862723)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_c8869ca8_20250114_200413.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1864123)
* [XML](/show_bug.cgi?ctype=xml&id=1864123)

Closed
[Bug 1864123](/show_bug.cgi?id=1864123)
(CVE-2023-6865)

Opened 1 year ago
Closed 1 year ago

# EncryptingOutputStream can write random contents of memory to its base stream

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

EncryptingOutputStream can write random contents of memory to its base stream

## Categories

### (Core :: Storage: Quota Manager, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Storage%3A%20Quota%20Manager#Storage%3A%20Quota%20Manager)

Storage: Quota Manager
â–¾

Core :: Storage: Quota Manager
For bugs in Gecko's centralized management of storage and disk usage quota in user profiles.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20Quota%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Storage%3A%20Quota%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Storage%3A%20Quota%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

122 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [121+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=121%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox119 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=unaffected) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) |
| firefox122 | [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 121+ | fixed |
| firefox-esr128 | --- | --- |
| firefox119 |  | unaffected |
| firefox120 |  | wontfix |
| firefox121 | + | fixed |
| firefox122 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: janv, Assigned: janv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/eceeadad4a0ed64f00f8e691ad14b59d?d=mm&size=40)  [janv](/user_profile?user_id=8340)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/eceeadad4a0ed64f00f8e691ad14b59d?d=mm&size=40)  [janv](/user_profile?user_id=8340)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1690111](/show_bug.cgi?id=1690111 "RESOLVED FIXED - DOM bindings can generate code that holds an invalidatable typed array / array buffer live across a GC")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1714354](/show_bug.cgi?id=1714354 "RESOLVED FIXED - Support Cache API in Private Browsing mode (with encrypted disk storage)"), [1867394](/show_bug.cgi?id=1867394 "RESOLVED FIXED - Ensure EncryptingOutputStream zero initializes the first cache line's data")

Dependency [tree](/showdependencytree.cgi?id=1864123&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1864123)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1850008](/show_bug.cgi?id=1850008 "RESOLVED FIXED - Reduce allocation poisoning in mozjemalloc in release")

[1634436](/show_bug.cgi?id=1634436 "RESOLVED FIXED - Add an encrypted IPC serializable stream implementation")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uninitialized, regression, sec-high, Whiteboard: [adv-main121+][adv-esr115.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6865

[Keywords:](/describekeywords.cgi)

[csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main121+][adv-esr115.6+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2071563_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Bug 1864123 - Optimize flushing to base stream; r=#dom-storage](/attachment.cgi?id=9362989)  [1 year ago](#c2)  [Jan Varga [:janv]](/user_profile?user_id=8340)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c8 "1 year ago") | [Details](/attachment.cgi?id=9362989&action=edit) | [Review](/attachment.cgi?id=9362989) |
| --- | --- | --- |
| [Bug 1864123 - Optimize flushing to base stream; r=#dom-storage](/attachment.cgi?id=9366183)  [1 year ago](#c15)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c17 "1 year ago") | [Details](/attachment.cgi?id=9366183&action=edit) | [Review](/attachment.cgi?id=9366183) |
| [Bug 1864123 - Optimize flushing to base stream; r=#dom-storage](/attachment.cgi?id=9366186)  [1 year ago](#c18)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c20 "1 year ago") | [Details](/attachment.cgi?id=9366186&action=edit) | [Review](/attachment.cgi?id=9366186) |
| [advisory.txt](/attachment.cgi?id=9367956)  [1 year ago](#c27)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   285 bytes, text/plain |  | [Details](/attachment.cgi?id=9367956&action=edit) |
| [advisory.txt](/attachment.cgi?id=9368018)  [1 year ago](#c28)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   303 bytes, text/plain |  | [Details](/attachment.cgi?id=9368018&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1864123#c0)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1864123&comment_id=16661428 "1 revision") |
|  | |

EncryptingOutputStream can write random contents of memory to its base stream. This can happen when original data is smaller than 4K. The stream encrypts only actual payload, but data is written to the base stream in whole 4K blocks. EncryptingOutputStream is used by IndexedDB and CacheAPI to store data on disk for private browsing, so the base stream in that case is quota::FileOutputStream, so random contents of memory can end up being stored on disk.

We have a fix for this which fills unused payload with random values.

We suggest to treat this as sec-other since Cache API in private browsing is still gated by a pref and it' still disabled by default. The issue is more serious in the Cache API case, because files stored on disk are fundamental part of the implementation. IndexedDB stores data in separate files only to support storing of DOM Blobs/Files which is not used so often.

IndexedDB in private browsing shipped in FF 115, so the fix might need to be uplifted even to ESR 115.

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1864123#c1)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1864123&comment_id=16661441 "2 revisions") |
|  | |

Please note also, that until [bug 1850008](/show_bug.cgi?id=1850008 "RESOLVED FIXED - Reduce allocation poisoning in mozjemalloc in release") landed the written memory was poisoned, so in ESR we do not see the potential to really expose uninitialized memory on disk, the written files just show less entropy than expected for full encryption.

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1864123#c2)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1864123 - Optimize flushing to base stream; r=#dom-storage](attachment.cgi?id=9362989)
â€” [Details](attachment.cgi?id=9362989&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a289417_406194)â€¢ 1 year ago |

Group: core-security â†’ dom-core-security

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1864123#c3)â€¢ 1 year ago |
|  | |

I'm classifying this as sec-moderate on the basis of "Disclosure of sensitive information that represents a violation of privacy but by itself does not expose sensitive user data or uniquily identify the user." from [the severity ratings](https://wiki.mozilla.org/Security_Severity_Ratings/Client). This may still be higher than necessary as there is no way to see this data without read access to the user's profile directory which generally is not something our threat models protect against in general but is a factor of concern in private browsing threat models. The key thing is to correctly characterize that this is not sec-high and should be landable now. To recap the situation here:

* For the encrypted data we write to disk for currently enabled-by-default IDB blob storage and for soon-to-be-enabled Cache API storage, we write the data in 4k chunks, post-snappy-compression. If we have less payload data than 4k in our final chunk of a Response we are writing, we fully encrypt that payload data, but we ended up writing uninitialized memory for the remainder of that 4k chunk. With poisoning active, this means we would be writing the poison values. [Bug 1850008](/show_bug.cgi?id=1850008 "RESOLVED FIXED - Reduce allocation poisoning in mozjemalloc in release") changed poisoning behavior in Fx120 so that we still poison all freed memory in `EARLY_BETA_OR_EARLIER` but that we only poison 64 bytes (`kCacheLineSize`) in late beta and release.
  + This does mean that Fx120 which is currently in RC would be experiencing this problem and so we will want to request uplift to 120, but we do not believe it justifies releases of its own.
* The write process happens in the parent process which means it's parent process memory that would be written to disk.
* The data buffer in question is expected to be 4k and so would not fall into the same jemalloc allocation size class as any keying material (`std::array<uint8_t, 32>`). The size class is likely to line up with bulk data.
* The fix is a minimal change to ensure we are writing initialized values for all data above the 64 byte poison line. We write a cryptographically random stream for entropy purposes versus truncation because it is 1) less risky/complex of a change, 2) we intend to change our behavior in this case to effectively pad the plaintext so that the ciphertext is quantized / rounded upwards as an anti-fingerprinting measure.
* The uninitialized data is never available to content absent a security exploit that allows arbitrary execution of code in the content process. Consumption of Cache API Response objects inherently involves providing the file descriptor of the file to the content process and in that case a compromised content process could read the extra data into memory. I have not done a full analysis of buffering at play, it's possible that a SPECTRE attack could read the contents of the data.
* Otherwise, an attacker would need read access to the user's profile directory, which usually would correlate with complete control of the computer, but if the attacker only had read access to the profile and no access to any other data/aspect of the computer, would at least correlate with a more serious loss of privacy given access to the places history database, the cookies database, the password store, etc.
Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1864123#c4)â€¢ 1 year ago |
|  | |

At DOM sec-bug triage we discussed this and the potential of exposure of parent process memory to the content process indirectly does make this sec-high, although such an exploit would be quite difficult.

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) â†’ [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1864123#c5)â€¢ 1 year ago |
|  | |

Comment on [attachment 9362989](/attachment.cgi?id=9362989 "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") [[details]](/attachment.cgi?id=9362989&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage")

[Bug 1864123](/show_bug.cgi?id=1864123 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream") - Optimize flushing to base stream; r=#dom-storage

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Extremely difficult. An attacker would also need to convince the user to use private browsing mode if they are not already using it. An attacker would probably need to do a lot of work to get the uninitialized memory written to disk to have a high probability of having data they want.

In terms of vulnerable versions, there are 2 things going on here:

1. Fx having enabled PrivateBrowsing for IndexedDB in v115 in [bug 1831058](/show_bug.cgi?id=1831058 "RESOLVED FIXED - Enable IndexedDB in Private Browsing Mode by default") surfaced the functionality that writes uninitialized memory to disk. This was mitigated by freed memory poisoning in release.
2. Fx having limited free poisoning to 64 bytes in v120 in [bug 1850008](/show_bug.cgi?id=1850008 "RESOLVED FIXED - Reduce allocation poisoning in mozjemalloc in release"). This makes the data written to disk actually uninitialized memory in late beta and release rather than poison bytes.

So Firefox 120 is the first version there is a problem on.

We would want this fix on ESR even though it's not vulnerable.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: 120
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1850008](/show_bug.cgi?id=1850008 "RESOLVED FIXED - Reduce allocation poisoning in mozjemalloc in release")
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Very little chance of regressions.
* **Is Android affected?**: Yes
[Attachment #9362989](/attachment.cgi?id=9362989&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") -
Flags: sec-approval?

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a387453_151407)â€¢ 1 year ago |

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- â†’ [unaffected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=unaffected)
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1864123#c6)â€¢ 1 year ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:janv, could you consider increasing the severity of this security bug?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#severity_high_security.py).

Flags: needinfo?(jvarga)

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a449851_8340)â€¢ 1 year ago |

Severity: S3 â†’ S2Flags: needinfo?(jvarga)Priority: P2 â†’ P1

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a468002_75935)â€¢ 1 year ago |

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)
[tracking-firefox121](/buglist.cgi?f1=cf_tracking_firefox121&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a468049_75935)â€¢ 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected) â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [121+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=121%2B)

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a520417_8340)â€¢ 1 year ago |

Regressed by: [1831058](/show_bug.cgi?id=1831058 "RESOLVED FIXED - Enable IndexedDB in Private Browsing Mode by default")

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a520489_8340)â€¢ 1 year ago |

Regressed by: [1850008](/show_bug.cgi?id=1850008 "RESOLVED FIXED - Reduce allocation poisoning in mozjemalloc in release")
No longer regressed by: [1831058](/show_bug.cgi?id=1831058 "RESOLVED FIXED - Enable IndexedDB in Private Browsing Mode by default")

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1864123#c7)â€¢ 1 year ago |
|  | |

Are we going to file a follow-up for ensuring we're 0-initing or otherwise consistently initing the first cache line's worth of data? (The poisoning means it's 0xe5 now.) Alternately should the existing patch be revised to do that?

Flags: needinfo?(jvarga)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1864123#c8)â€¢ 1 year ago |
|  | |

Comment on [attachment 9362989](/attachment.cgi?id=9362989 "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") [[details]](/attachment.cgi?id=9362989&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage")

[Bug 1864123](/show_bug.cgi?id=1864123 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream") - Optimize flushing to base stream; r=#dom-storage

Approved to land and uplift

[Attachment #9362989](/attachment.cgi?id=9362989&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") -
Flags: sec-approval? â†’ sec-approval+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a1141243_695136)â€¢ 1 year ago |

[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=affected)
[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B)

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1864123#c9)â€¢ 1 year ago |
|  | |

(In reply to Andrew Sutherland [:asuth] (he/him) from [comment #7](/show_bug.cgi?id=1864123#c7 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream"))

> Are we going to file a follow-up for ensuring we're 0-initing or otherwise consistently initing the first cache line's worth of data? (The poisoning means it's 0xe5 now.) Alternately should the existing patch be revised to do that?

Yeah, that's probably a good idea, but I think you have more context for filing a bug for that.

Can you please do that ?

Thank you.

Flags: needinfo?(jvarga)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1864123#c10)â€¢ 1 year ago |
|  | |

Pushed by jvarga@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/9a6e753295d9>
Optimize flushing to base stream; r=dom-storage-reviewers,asuth,hsingh

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1864123#c11)â€¢ 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/9a6e753295d9>

Group: dom-core-security â†’ core-security-releaseStatus: ASSIGNED â†’ RESOLVEDClosed: 1 year ago
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 122 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1864123#c12)â€¢ 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:janv, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox121` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(jvarga)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1864123#c13)â€¢ 1 year ago |
|  | |

(In reply to Jan Varga [:janv] from [comment #9](/show_bug.cgi?id=1864123#c9 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream"))

> Yeah, that's probably a good idea, but I think you have more context for filing a bug for that.
>
> Can you please do that ?

Did this happen?

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a1690958_151407)â€¢ 1 year ago |

Blocks: [1867394](/show_bug.cgi?id=1867394 "RESOLVED FIXED - Ensure EncryptingOutputStream zero initializes the first cache line's data")

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1864123#c14)â€¢ 1 year ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #13](/show_bug.cgi?id=1864123#c13 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream"))

> Did this happen?

I have filed [Bug 1867394](/show_bug.cgi?id=1867394 "RESOLVED FIXED - Ensure EncryptingOutputStream zero initializes the first cache line's data") to this end.

I am going to fill out the uplift permission request now.

Flags: needinfo?(jvarga)Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1864123#c15)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1864123 - Optimize flushing to base stream; r=#dom-storage](attachment.cgi?id=9366183)
â€” [Details](attachment.cgi?id=9366183&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D193286>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a1691237_600971)â€¢ 1 year ago |

[Attachment #9366183](/attachment.cgi?id=9366183&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1864123#c16)â€¢ 1 year ago |
|  | |

# Uplift Approval Request

* **Code covered by automated testing**: yes
* **Is Android affected?**: yes
* **Steps to reproduce for manual QE testing**: n/a
* **Explanation of risk level**: Patch was intentionally strucured to minimize
* **Fix verified in Nightly**: yes
* **User impact if declined**: Please see the sec-approval details at <https://bugzilla.mozilla.org/show_bug.cgi?id=1864123#c5> but to recap: an attacker who compromises a content process could escalate their privileges without this fix. Note that the bug currently has this marked as wontfix on 120 but it would be pretty good to have this on 120 if it can ride along.
* **String changes made/needed**: no
* **Needs manual QE test**: no
* **Risk associated with taking this patch**: Very low.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1864123#c17)â€¢ 1 year ago |
|  | |

Comment on [attachment 9366183](/attachment.cgi?id=9366183 "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") [[details]](/attachment.cgi?id=9366183&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage")

[Bug 1864123](/show_bug.cgi?id=1864123 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream") - Optimize flushing to base stream; r=#dom-storage

Approved for 121.0b6.

[Attachment #9366183](/attachment.cgi?id=9366183&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a1693127_640478)â€¢ 1 year ago |

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1864123#c18)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1864123 - Optimize flushing to base stream; r=#dom-storage](attachment.cgi?id=9366186)
â€” [Details](attachment.cgi?id=9366186&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D193286>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a1693267_600971)â€¢ 1 year ago |

[Attachment #9366186](/attachment.cgi?id=9366186&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1864123#c19)â€¢ 1 year ago |
|  | |

# Uplift Approval Request

* **Fix verified in Nightly**: yes
* **User impact if declined**: Please see the sec-approval details at <https://bugzilla.mozilla.org/show_bug.cgi?id=1864123#c5> but to recap: an attacker who compromises a content process could escalate their privileges without this fix.
* **Needs manual QE test**: no
* **String changes made/needed**: no
* **Risk associated with taking this patch**: Very low
* **Code covered by automated testing**: yes
* **Is Android affected?**: yes
* **Explanation of risk level**: Patch was intentionally strucured to minimize
* **Steps to reproduce for manual QE testing**: n/a

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1864123#c20)â€¢ 1 year ago |
|  | |

Comment on [attachment 9366186](/attachment.cgi?id=9366186 "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") [[details]](/attachment.cgi?id=9366186&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage")

[Bug 1864123](/show_bug.cgi?id=1864123 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream") - Optimize flushing to base stream; r=#dom-storage

Approved for 115.6esr.

[Attachment #9366186](/attachment.cgi?id=9366186&action=edit "Bug 1864123 - Optimize flushing to base stream; r=#dom-storage") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a1694111_640478)â€¢ 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1864123#c21)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ca8ce1830705>

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1864123#c22)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/8cc3a3bb4ea0>

|  | [Iulian Moraru](/user_profile?user_id=682863) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1864123#c23)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1864123&comment_id=16689989 "1 revision") |
|  | |

Backed out changeset 8cc3a3bb4ea0 ([bug 1864123](/show_bug.cgi?id=1864123 "RESOLVED FIXED - EncryptingOutputStream can write random contents of memory to its base stream")) for causing mass build bustages on EncryptingOutputStream\_impl.h. Backed out from esr115.

* [Push with failures](https://treeherder.mozilla.org/jobs?repo=mozilla-esr115&group_state=expanded&resultStatus=success%2Ctestfailed%2Cbusted%2Cexception%2Crunnable&revision=8cc3a3bb4ea04add5c469c2b32f47b8f7f34c988&selectedTaskRun=C5qIwVcnRoe1_j8eOxgbcg.0)
* [Failure log](https://treeherder.mozilla.org/logviewer?job_id=438216169&repo=mozilla-esr115&lineNumber=13236)
* [Backout link](https://hg.mozilla.org/releases/mozilla-esr115/rev/9504b353d4ad97d101cf0102acc47ab182877aca)

```
[task 2023-11-30T00:10:54.295Z] 00:10:54     INFO -  gmake[4]: Entering directory '/builds/worker/workspace/obj-build/dom/indexedDB'
[task 2023-11-30T00:10:54.298Z] 00:10:54     INFO -  /builds/worker/fetches/sccache/sccache /builds/worker/fetches/clang/bin/clang++ --sysroot /builds/worker/fetches/sysroot-i686-linux-gnu -m32 -o ActorsParent.o -c  -I/builds/worker/workspace/obj-build/dist/stl_wrappers -I/builds/worker/workspace/obj-build/dist/system_wrappers -include /builds/worker/checkouts/gecko/config/gcc_hidden.h -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fstack-protector-strong -fstack-clash-protection -DDEBUG=1 -DOS_POSIX=1 -DOS_LINUX=1 -DMOZ_HAS_MOZGLUE -DMOZILLA_INTERNAL_API -DIMPL_LIBXUL -DSTATIC_EXPORTABLE_JS_API -I/builds/worker/checkouts/gecko/dom/indexedDB -I/builds/worker/workspace/obj-build/dom/indexedDB -I/builds/worker/workspace/obj-build/ipc/ipdl/_ipdlheaders -I/builds/worker/checkouts/gecko/ipc/chromium/src -I/builds/worker/checkouts/gecko/dom/base -I/builds/worker/checkouts/gecko/dom/storage -I/builds/worker/checkouts/gecko/ipc/glue -I/builds/worker/checkouts/gecko/third_party/sqlite3/src -I/builds/worker/checkouts/gecko/xpcom/build -I/builds/worker/workspace/obj-build/dist/include -I/builds/worker/workspace/obj-build/dist/include/nspr -I/builds/worker/workspace/obj-build/dist/include/nss -DMOZILLA_CLIENT -include /builds/worker/workspace/obj-build/mozilla-config.h -fno-sized-deallocation -fno-aligned-new -fcrash-diagnostics-dir=/builds/worker/artifacts -march=pentium-m -msse -msse2 -mfpmath=sse -fno-exceptions -fPIC -fno-rtti -ffunction-sections -fdata-sections -fno-exceptions -fno-math-errno -pthread -pipe -gdwarf-4 -Xclang -load -Xclang /builds/worker/workspace/obj-build/build/clang-plugin/libclang-plugin.so -Xclang -add-plugin -Xclang moz-check -O2 -gline-tables-only -fno-omit-frame-pointer -funwind-tables -Werror -Wall -Wbitfield-enum-conversion -Wdeprecated-this-capture -Wempty-body -Wformat-type-confusion -Wignored-qualifiers -Wpointer-arith -Wshadow-field-in-constructor-modified -Wsign-compare -Wtautological-constant-in-range-compare -Wtype-limits -Wno-error=tautological-type-limit-compare -Wunreachable-code -Wunreachable-code-return -Wunused-but-set-parameter -Wno-invalid-offsetof -Wclass-varargs -Wempty-init-stmt -Wfloat-overflow-conversion -Wfloat-zero-conversion -Wloop-analysis -Wno-range-loop-analysis -Wc++2a-compat -Wenum-compare-conditional -Wenum-float-conversion -Wno-error=deprecated -Wno-error=deprecated-anon-enum-enum-conversion -Wno-error=deprecated-enum-enum-conversion -Wno-error=deprecated-pragma -Wno-error=deprecated-this-capture -Wcomma -Wimplicit-fallthrough -Wstring-conversion -Wno-inline-new-delete -Wno-error=deprecated-declarations -Wno-error=array-bounds -Wno-error=free-nonheap-object -Wno-error=atomic-alignment -Wno-error=deprecated-builtins -Wformat -Wformat-security -Wno-psabi -Wthread-safety -Wno-error=builtin-macro-redefined -Wno-unknown-warning-option -fno-strict-aliasing -ffp-contract=off  -MD -MP -MF .deps/ActorsParent.o.pp   /builds/worker/checkouts/gecko/dom/indexedDB/ActorsParent.cpp
[task 2023-11-30T00:10:54.299Z] 00:10:54     INFO -  In file included from /builds/worker/checkouts/gecko/dom/indexedDB/ActorsParent.cpp:24:
[task 2023-11-30T00:10:54.299Z] 00:10:54     INFO -  In file included from /builds/worker/checkouts/gecko/dom/indexedDB/DatabaseFileInfo.h:12:
[task 2023-11-30T00:10:54.299Z] 00:10:54     INFO -  In file included from /builds/worker/checkouts/gecko/dom/indexedDB/DatabaseFileManager.h:11:
[task 2023-11-30T00:10:54.299Z] 00:10:54     INFO -  In file included from /builds/worker/checkouts/gecko/dom/indexedDB/IndexedDBCipherKeyManager.h:11:
[task 2023-11-30T00:10:54.300Z] 00:10:54     INFO -  In file included from /builds/worker/workspace/obj-build/dist/include/mozilla/dom/quota/IPCStreamCipherStrategy.h:10:
[task 2023-11-30T00:10:54.300Z] 00:10:54     INFO -  In file included from /builds/worker/workspace/obj-build/dist/include/mozilla/dom/quota/NSSCipherStrategy.h:20:
[task 2023-11-30T00:10:54.300Z] 00:10:54  WARNING -  /builds/worker/workspace/obj-build/dist/include/ScopedNSSTypes.h:283:22: warning: result of comparison 'index_type' (aka 'unsigned int') > 4294967295 is always false [-Wtautological-type-limit-compare]
[task 2023-11-30T00:10:54.300Z] 00:10:54     INFO -      if (key.Length() > std::numeric_limits<unsigned int>::max()) {
[task 2023-11-30T00:10:54.301Z] 00:10:54     INFO -          ~~~~~~~~~~~~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[task 2023-11-30T00:10:54.301Z] 00:10:54     INFO -  In file included from /builds/worker/checkouts/gecko/dom/indexedDB/ActorsParent.cpp:129:
[task 2023-11-30T00:10:54.301Z] 00:10:54    ERROR -  /builds/worker/workspace/obj-build/dist/include/mozilla/dom/quota/EncryptingOutputStream_impl.h:225:37: error: no member named 'GenerateRandomBytesInto' in 'nsIRandomGenerator'; did you mean 'GenerateRandomBytes'?
[task 2023-11-30T00:10:54.302Z] 00:10:54     INFO -      nsresult rv = mRandomGenerator->GenerateRandomBytesInto(
[task 2023-11-30T00:10:54.302Z] 00:10:54     INFO -                                      ^~~~~~~~~~~~~~~~~~~~~~~
[task 2023-11-30T00:10:54.303Z] 00:10:54     INFO -                                      GenerateRandomBytes
[task 2023-11-30T00:10:54.303Z] 00:10:54     INFO -  /builds/worker/workspace/obj-build/dist/include/nsIRandomGenerator.h:34:36: note: 'GenerateRandomBytes' declared here
[task 2023-11-30T00:10:54.303Z] 00:10:54     INFO -    JS_HAZ_CAN_RUN_SCRIPT NS_IMETHOD GenerateRandomBytes(uint32_t aLength, uint8_t **aBuffer) = 0;
[task 2023-11-30T00:10:54.304Z] 00:10:54     INFO -                                     ^
[task 2023-11-30T00:10:54.304Z] 00:10:54     INFO -  In file included from /builds/worker/checkouts/gecko/dom/indexedDB/ActorsParent.cpp:129:
[task 2023-11-30T00:10:54.304Z] 00:10:54    ERROR -  /builds/worker/workspace/obj-build/dist/include/mozilla/dom/quota/EncryptingOutputStream_impl.h:226:9: error: cannot initialize a parameter of type 'uint32_t' (aka 'unsigned int') with an rvalue of type 'pointer' (aka 'unsigned char *')
[task 2023-11-30T00:10:54.305Z] 00:10:54     INFO -          unusedPayload.Elements(), unusedPayload.Length());
[task 2023-11-30T00:10:54.305Z] 00:10:54     INFO -          ^~~~~~~~~~~~~~~~~~~~~~~~
[task 2023-11-30T00:10:54.306Z] 00:10:54     INFO -  /builds/worker/workspace/obj-build/dist/include/mozilla/dom/quota/EncryptingOutputStream_impl.h:71:17: note: in instantiation of member function 'mozilla::dom::quota::EncryptingOutputStream<mozilla::dom::quota::NSSCipherStrategy>::FlushToBaseStream' requested here
[task 2023-11-30T00:10:54.306Z] 00:10:54     INFO -    nsresult rv = FlushToBaseStream();
[task 2023-11-30T00:10:54.306Z] 00:10:54     INFO -                  ^
[task 2023-11-30T00:10:54.306Z] 00:10:54     INFO -  /builds/worker/workspace/obj-build/dist/include/mozilla/dom/quota/EncryptingOutputStream.h:68:12: note: in instantiation of member function 'mozilla::dom::quota::EncryptingOutputStream<mozilla::dom::quota::NSSCipherStrategy>::Close' requested here
[task 2023-11-30T00:10:54.307Z] 00:10:54     INFO -    explicit EncryptingOutputStream(nsCOMPtr<nsIOutputStream> aBaseStream,
[task 2023-11-30T00:10:54.307Z] 00:10:54     INFO -             ^
[task 2023-11-30T00:10:54.307Z] 00:10:54     INFO -  /builds/worker/workspace/obj-build/dist/include/mozilla/RefPtr.h:642:19: note: in instantiation of member function 'mozilla::dom::quota::EncryptingOutputStream<mozilla::dom::quota::NSSCipherStrategy>::EncryptingOutputStream' requested here
[task 2023-11-30T00:10:54.308Z] 00:10:54     INFO -    RefPtr<T> p(new T(std::forward<Args>(aArgs)...));
[task 2023-11-30T00:10:54.308Z] 00:10:54     INFO -                    ^
[task 2023-11-30T00:10:54.308Z] 00:10:54     INFO -  /builds/worker/checkouts/gecko/dom/indexedDB/ActorsParent.cpp:20698:11: note: in instantiation of function template specialization 'mozilla::MakeRefPtr<mozilla::dom::quota::EncryptingOutputStream<mozilla::dom::quota::NSSCipherStrategy>, nsCOMPtr<nsIOutputStream>, const unsigned int &, const std::array<unsigned char, 32> &>' requested here
[task 2023-11-30T00:10:54.309Z] 00:10:54     INFO -            MakeRefPtr<EncryptingOutputStream<IndexedDBCipherStrategy>>(
[task 2023-11-30T00:10:54.309Z] 00:10:54     INFO -            ^
[task 2023-11-30T00:10:54.309Z] 00:10:54     INFO -  /builds/worker/workspace/obj-build/dist/include/nsIRandomGenerator.h:34:65: note: passing argument to parameter 'aLength' here
[task 2023-11-30T00:10:54.309Z] 00:10:54     INFO -    JS_HAZ_CAN_RUN_SCRIPT NS_IMETHOD GenerateRandomBytes(uint32_t aLength, uint8_t **aBuffer) = 0;
[task 2023-11-30T00:10:54.309Z] 00:10:54     INFO -                                                                  ^
[task 2023-11-30T00:10:54.310Z] 00:10:54     INFO -  1 warning and 2 errors generated.
[task 2023-11-30T00:10:54.310Z] 00:10:54    ERROR -  gmake[4]: *** [/builds/worker/checkouts/gecko/config/rules.mk:665: ActorsParent.o] Error 1
[task 2023-11-30T00:10:54.310Z] 00:10:54     INFO -  gmake[4]: Leaving directory '/builds/worker/workspace/obj-build/dom/indexedDB'

```
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1864123#c24)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1864123&comment_id=16689992 "1 revision") |
|  | |

Per Slack discussion with asuth, this patch as-written depends on the patches from [bug 1690111](/show_bug.cgi?id=1690111 "RESOLVED FIXED - DOM bindings can generate code that holds an invalidatable typed array / array buffer live across a GC"). While we are intending to get those uplifted to ESR eventually still, they've been blocked on some lingering stability issues. I'm not sure if we want to try waiting on those patches to get uplifted or rework the ESR uplift around them.

Depends on: [1690111](/show_bug.cgi?id=1690111 "RESOLVED FIXED - DOM bindings can generate code that holds an invalidatable typed array / array buffer live across a GC")Flags: needinfo?(ryanvm) â†’ needinfo?(jvarga)

|  | [Jan Varga [:janv]](/user_profile?user_id=8340)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1864123#c25)â€¢ 1 year ago |
|  | |

In theory, we don't need [bug 1690111](/show_bug.cgi?id=1690111 "RESOLVED FIXED - DOM bindings can generate code that holds an invalidatable typed array / array buffer live across a GC") for this. It's just that random bytes would have to be generated into a temporary buffer and then copied, instead of generating them directly to the intended place.

Flags: needinfo?(jvarga)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a2071563_488993)â€¢ 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1864123#c26)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/b66eb4c63b10>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a2359771_75935)â€¢ 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a2700186_586683)â€¢ 1 year ago |

Whiteboard: [adv-main121+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a2702778_586683)â€¢ 1 year ago |

Whiteboard: [adv-main121+] â†’ [adv-main121+][adv-esr115.6+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1864123#c27)â€¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367956) (obsolete)
â€” [Details](attachment.cgi?id=9367956&action=edit)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1864123#c28)â€¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9368018)
â€” [Details](attachment.cgi?id=9368018&action=edit)

[Attachment #9367956](/attachment.cgi?id=9367956&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a3060293_578488)â€¢ 1 year ago |

Alias: CVE-2023-6865

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1864123#a6348426_406194)â€¢ 1 year ago |

Keywords: [csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1864123#c29)â€¢ 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1864123&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Jan Varga [:janv]](/user_profile?user_id=8340)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


