=== Content from bugzilla.mozilla.org_0ec32020_20250114_183627.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1843782)
* [XML](/show_bug.cgi?ctype=xml&id=1843782)

Closed
[Bug 1843782](/show_bug.cgi?id=1843782)
(CVE-2023-6856)

Opened 2 years ago
Closed 1 year ago

# Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)

## Categories

### (Core :: Graphics: CanvasWebGL, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20CanvasWebGL#Graphics%3A%20CanvasWebGL)

Graphics: CanvasWebGL
▾

Core :: Graphics: CanvasWebGL
Bugs with the WebGL Canvas Context.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20CanvasWebGL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 115

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

122 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [121+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=121%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox119 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix) |
| firefox120 | [+](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified) |
| firefox122 | [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 121+ | verified |
| firefox-esr128 | --- | --- |
| firefox119 |  | wontfix |
| firefox120 | + | wontfix |
| firefox121 | + | verified |
| firefox122 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: d4ni31, Assigned: ahale)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8c78c371fa9a40753be0e245499b5474?d=mm&size=40)  [ahale](/user_profile?user_id=706885)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9f3fb4858f5405493513e52dfce6dc62?d=mm&size=40)  [d4ni31](/user_profile?user_id=683497)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ca6a57abf052ac63d917d5dae1cc0f00?d=mm&size=40)  [jgilbert](/user_profile?user_id=419431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1865531](/show_bug.cgi?id=1865531 "RESOLVED DUPLICATE - Firefox WebGL raw_fDrawArraysInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)"), [1866209](/show_bug.cgi?id=1866209 "RESOLVED DUPLICATE - Firefox WebGL DrawArrays Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

Dependency [tree](/showdependencytree.cgi?id=1843782&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1843782)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1865531](/show_bug.cgi?id=1865531 "RESOLVED DUPLICATE - Firefox WebGL raw_fDrawArraysInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)"), [1866209](/show_bug.cgi?id=1866209 "RESOLVED DUPLICATE - Firefox WebGL DrawArrays Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2023-29531](/show_bug.cgi?id=1794292 "RESOLVED FIXED - Firefox WebGL glvmInterpretFPTransformFour Memory Corruption Vulnerability"), [CVE-2023-4582](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability"), [1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing"), [1865531](/show_bug.cgi?id=1865531 "RESOLVED DUPLICATE - Firefox WebGL raw_fDrawArraysInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)"), [1912404](/show_bug.cgi?id=1912404 "RESOLVED FIXED - bevyengine.org - The animation is not displayed")

## Details

### (6 keywords, Whiteboard: [disclosure deadline 2023-12-19][adv-main121+][adv-esr115.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6856

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[disclosure deadline 2023-12-19][adv-main121+][adv-esr115.6+]

QA Whiteboard:

[post-critsmash-triage][qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a15301151_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (11 files, 4 obsolete files)

| [poc.html](/attachment.cgi?id=9344057)  [2 years ago](#c0)  [D4ni31 [:d4ni31]](/user_profile?user_id=683497)   2.51 KB, text/html |  | [Details](/attachment.cgi?id=9344057&action=edit) |
| --- | --- | --- |
| [about:support (json format)](/attachment.cgi?id=9359904)  [1 year ago](#c21)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   43.98 KB, application/json |  | [Details](/attachment.cgi?id=9359904&action=edit) |
| [about:support (text format)](/attachment.cgi?id=9359905)  [1 year ago](#c22)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   27.12 KB, text/plain |  | [Details](/attachment.cgi?id=9359905&action=edit) |
| [Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](/attachment.cgi?id=9360544)  [1 year ago](#c27)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c74 "1 year ago") | [Details](/attachment.cgi?id=9360544&action=edit) | [Review](/attachment.cgi?id=9360544) |
| [wip patch](/attachment.cgi?id=9361824)  [1 year ago](#c43)  [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117)   1.23 KB, patch |  | [Details](/attachment.cgi?id=9361824&action=edit) | [Diff](/attachment.cgi?id=9361824&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1843782&attachment=9361824) |
| [Bug 1843782 - [don't land] Limit max var size to 4k words (16k bytes) on Mesa.](/attachment.cgi?id=9363405)  [1 year ago](#c60)  [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9363405&action=edit) | [Review](/attachment.cgi?id=9363405) |
| [Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](/attachment.cgi?id=9365731)  [1 year ago](#c78)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9365731&action=edit) | [Review](/attachment.cgi?id=9365731) |
| [Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](/attachment.cgi?id=9366501)  [1 year ago](#c100)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c104 "1 year ago") | [Details](/attachment.cgi?id=9366501&action=edit) | [Review](/attachment.cgi?id=9366501) |
| [Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](/attachment.cgi?id=9366633)  [1 year ago](#c102)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c105 "1 year ago") | [Details](/attachment.cgi?id=9366633&action=edit) | [Review](/attachment.cgi?id=9366633) |
| [Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](/attachment.cgi?id=9367185)  [1 year ago](#c108)  [Ashley Hale [:ahale]](/user_profile?user_id=706885)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115-](#c0 "1 year ago") | [Details](/attachment.cgi?id=9367185&action=edit) | [Review](/attachment.cgi?id=9367185) |
| [advisory.txt](/attachment.cgi?id=9367978)  [1 year ago](#c114)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   337 bytes, text/plain |  | [Details](/attachment.cgi?id=9367978&action=edit) |
| [advisory.txt](/attachment.cgi?id=9368016)  [1 year ago](#c115)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   338 bytes, text/plain |  | [Details](/attachment.cgi?id=9368016&action=edit) |
| [advisory.txt](/attachment.cgi?id=9368017)  [1 year ago](#c116)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   341 bytes, text/plain |  | [Details](/attachment.cgi?id=9368017&action=edit) |
| [about:support from 120.0.1 (version with crash)](/attachment.cgi?id=9369270)  [1 year ago](#c120)  [Yannis Juglaret [:yannis]](/user_profile?user_id=712696)   69.34 KB, application/json |  | [Details](/attachment.cgi?id=9369270&action=edit) |
| [about:support for 121.0 (no crash, with patch)](/attachment.cgi?id=9369272)  [1 year ago](#c121)  [Yannis Juglaret [:yannis]](/user_profile?user_id=712696)   70.76 KB, application/json |  | [Details](/attachment.cgi?id=9369272&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1843782#c0)• 2 years ago |
|  | |

Attached file
[poc.html](attachment.cgi?id=9344057)
— [Details](attachment.cgi?id=9344057&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36

Steps to reproduce:

## **Title**

* Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Vulnerability

## **Summary**

* A Heap-Buffer-Overflow vulnerability exists in the WebGL DrawElementsInstanced
* The browser process crashes when triggering this bug.

## **Test environment**

* Product : Firefox Stable & Firefox ASan Build Opt
* VM : Virtualbox 7.0.8
* GUEST OS : Ubuntu Desktop 23.04

## ASan

```
=================================================================
==11034==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6310051f36c8 at pc 0x5569d5ba3671 bp 0x7f3dd59f9880 sp 0x7f3dd59f9040
READ of size 84704 at 0x6310051f36c8 thread T36
    #0 0x5569d5ba3670 in memcpy /builds/worker/fetches/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:875:5
    #1 0x7f3d98459ee4  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa59ee4) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #2 0x7f3d9846a4f4  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa6a4f4) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #3 0x7f3d98445dfc  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa45dfc) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #4 0x7f3d98449fba  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa49fba) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #5 0x7f3d98446612  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa46612) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #6 0x7f3d984466cf  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa466cf) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #7 0x7f3d98446733  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa46733) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #8 0x7f3d9843a24c  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa3a24c) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #9 0x7f3d97cf20aa  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0x2f20aa) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #10 0x7f3d97cf3885  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0x2f3885) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)
    #11 0x7f3dfc619bfb in raw_fDrawElements /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:1076:5
    #12 0x7f3dfc619bfb in mozilla::gl::GLContext::fDrawElements(unsigned int, int, unsigned int, void const*) /builds/worker/checkouts/gecko/gfx/gl/GLContext.h:1090:5
    #13 0x7f3dfc6193ab in mozilla::WebGLContext::DrawElementsInstanced(unsigned int, int, unsigned int, long, int) /builds/worker/checkouts/gecko/dom/canvas/WebGLContextDraw.cpp:1057:15
    #14 0x7f3dfc6f17f0 in DrawElementsInstanced /builds/worker/checkouts/gecko/dom/canvas/HostWebGLContext.h:755:15
    #15 0x7f3dfc6f17f0 in auto bool mozilla::MethodDispatcher<mozilla::WebGLMethodDispatcher, 101ul, void (mozilla::HostWebGLContext::*)(unsigned int, int, unsigned int, long, int) const, &mozilla::HostWebGLContext::DrawElementsInstanced(unsigned int, int, unsigned int, long, int) const>::DispatchCommand<mozilla::HostWebGLContext>(mozilla::HostWebGLContext&, unsigned long, mozilla::webgl::RangeConsumerView&)::'lambda'(auto&...)::operator()<unsigned int, int, unsigned int, long, int>(auto&...) const /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:253:13
    #16 0x7f3dfc69c9c5 in __invoke_impl<bool, (lambda at /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:245:11), unsigned int &, int &, unsigned int &, long &, int &> /builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/invoke.h:60:14
    #17 0x7f3dfc69c9c5 in __invoke<(lambda at /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:245:11), unsigned int &, int &, unsigned int &, long &, int &> /builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/invoke.h:95:14
    #18 0x7f3dfc69c9c5 in __apply_impl<(lambda at /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:245:11), std::tuple<unsigned int, int, unsigned int, long, int> &, 0UL, 1UL, 2UL, 3UL, 4UL> /builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/tuple:1678:14
    #19 0x7f3dfc69c9c5 in apply<(lambda at /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:245:11), std::tuple<unsigned int, int, unsigned int, long, int> &> /builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/tuple:1687:14
    #20 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:244:14
    #21 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #22 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #23 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #24 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #25 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #26 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #27 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #28 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #29 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #30 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #31 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #32 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #33 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #34 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #35 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #36 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #37 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #38 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #39 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #40 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #41 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #42 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #43 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #44 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #45 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #46 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #47 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #48 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #49 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #50 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #51 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #52 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #53 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #54 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #55 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #56 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #57 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #58 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #59 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #60 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #61 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #62 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #63 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #64 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #65 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #66 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #67 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #68 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #69 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #70 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #71 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #72 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #73 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #74 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #75 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #76 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #77 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #78 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #79 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #80 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #81 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #82 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #83 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #84 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #85 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #86 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #87 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #88 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #89 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #90 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #91 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #92 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #93 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #94 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #95 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #96 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #97 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #98 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #99 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #100 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #101 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #102 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #103 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #104 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #105 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #106 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #107 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #108 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #109 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #110 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #111 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #112 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #113 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #114 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #115 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #116 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #117 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #118 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #119 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #120 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #121 0x7f3dfc69c9c5 in DispatchCommand<mozilla::HostWebGLContext> /builds/worker/checkouts/gecko/dom/canvas/WebGLCommandQueue.h:258:12
    #122 0x7f3dfc69c9c5 in mozilla::dom::WebGLParent::RecvDispatchCommands(mozilla::ipc::BigBuffer&&, unsigned long) /builds/worker/checkouts/gecko/dom/canvas/WebGLParent.cpp:62:21
    #123 0x7f3dfc7c811a in mozilla::dom::PWebGLParent::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/obj-build/ipc/ipdl/PWebGLParent.cpp:229:79
    #124 0x7f3df8f9ff94 in mozilla::gfx::PCanvasManagerParent::OnMessageReceived(IPC::Message const&) /builds/worker/workspace/obj-build/ipc/ipdl/PCanvasManagerParent.cpp:214:32
    #125 0x7f3df7a6141d in mozilla::ipc::MessageChannel::DispatchAsyncMessage(mozilla::ipc::ActorLifecycleProxy*, IPC::Message const&) /builds/worker/checkouts/gecko/ipc/glue/MessageChannel.cpp:1811:25
    #126 0x7f3df7a5df13 in mozilla::ipc::MessageChannel::DispatchMessage(mozilla::ipc::ActorLifecycleProxy*, mozilla::UniquePtr<IPC::Message, mozilla::DefaultDelete<IPC::Message>>) /builds/worker/checkouts/gecko/ipc/glue/MessageChannel.cpp:1736:9
    #127 0x7f3df7a5f02b in mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::ActorLifecycleProxy*, mozilla::ipc::MessageChannel::MessageTask&) /builds/worker/checkouts/gecko/ipc/glue/MessageChannel.cpp:1536:3
    #128 0x7f3df7a60022 in mozilla::ipc::MessageChannel::MessageTask::Run() /builds/worker/checkouts/gecko/ipc/glue/MessageChannel.cpp:1634:14
    #129 0x7f3df6048aff in nsThread::ProcessNextEvent(bool, bool*) /builds/worker/checkouts/gecko/xpcom/threads/nsThread.cpp:1193:16
    #130 0x7f3df6056464 in NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/checkouts/gecko/xpcom/threads/nsThreadUtils.cpp:480:10
    #131 0x7f3df7a69f8a in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) /builds/worker/checkouts/gecko/ipc/glue/MessagePump.cpp:330:5
    #132 0x7f3df78b9a0a in RunInternal /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:370:10
    #133 0x7f3df78b9a0a in RunHandler /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:363:3
    #134 0x7f3df78b9a0a in MessageLoop::Run() /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:345:3
    #135 0x7f3df603fb2f in nsThread::ThreadFunc(void*) /builds/worker/checkouts/gecko/xpcom/threads/nsThread.cpp:391:10
    #136 0x7f3e146b4b3f in _pt_root /builds/worker/checkouts/gecko/nsprpub/pr/src/pthreads/ptthread.c:201:5
    #137 0x7f3e1448f189 in start_thread nptl/pthread_create.c:444:8
    #138 0x7f3e1451dbcf in clone3 misc/../sysdeps/unix/sysv/linux/x86_64/clone3.S:81

0x6310051f36c8 is located 0 bytes after 77512-byte region [0x6310051e0800,0x6310051f36c8)
allocated by thread T36 here:
    #0 0x5569d5c20458 in calloc /builds/worker/fetches/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:77:3
    #1 0x7f3d98469542  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0xa69542) (BuildId: 60cea14709f13d122c75908469400dbfeb094a60)

Thread T36 created by T0 here:
    #0 0x5569d5c0849a in pthread_create /builds/worker/fetches/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:208:3
    #1 0x7f3e146a32a4 in _PR_CreateThread /builds/worker/checkouts/gecko/nsprpub/pr/src/pthreads/ptthread.c:458:14
    #2 0x7f3e14690e9e in PR_CreateThread /builds/worker/checkouts/gecko/nsprpub/pr/src/pthreads/ptthread.c:533:12
    #3 0x7f3df604382c in nsThread::Init(nsTSubstring<char> const&) /builds/worker/checkouts/gecko/xpcom/threads/nsThread.cpp:634:18
    #4 0x7f3df6053c0e in nsThreadManager::NewNamedThread(nsTSubstring<char> const&, nsIThreadManager::ThreadCreationOptions, nsIThread**) /builds/worker/checkouts/gecko/xpcom/threads/nsThreadManager.cpp:550:12
    #5 0x7f3df6061afc in NS_NewNamedThread(nsTSubstring<char> const&, nsIThread**, already_AddRefed<nsIRunnable>, nsIThreadManager::ThreadCreationOptions) /builds/worker/checkouts/gecko/xpcom/threads/nsThreadUtils.cpp:176:57
    #6 0x7f3df8f5b315 in NS_NewNamedThread<15UL> /builds/worker/checkouts/gecko/xpcom/threads/nsThreadUtils.h:76:10
    #7 0x7f3df8f5b315 in mozilla::gfx::CanvasRenderThread::Start() /builds/worker/checkouts/gecko/gfx/ipc/CanvasRenderThread.cpp:55:17
    #8 0x7f3df8d862b0 in gfxPlatform::InitLayersIPC() /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:1315:9
    #9 0x7f3df8d7f290 in gfxPlatform::Init() /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:974:3
    #10 0x7f3df8d85ccf in GetPlatform /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:464:5
    #11 0x7f3df8d85ccf in gfxPlatform::InitializeCMS() /builds/worker/checkouts/gecko/gfx/thebes/gfxPlatform.cpp:2109:9
    #12 0x7f3e0086198b in EnsureCMSInitialized /builds/worker/workspace/obj-build/dist/include/gfxPlatform.h:968:7
    #13 0x7f3e0086198b in GetCMSMode /builds/worker/workspace/obj-build/dist/include/gfxPlatform.h:519:5
    #14 0x7f3e0086198b in nsXPLookAndFeel::GetUncachedColor(mozilla::StyleSystemColor, mozilla::ColorScheme, mozilla::LookAndFeel::UseStandins) /builds/worker/checkouts/gecko/widget/nsXPLookAndFeel.cpp:1012:9
    #15 0x7f3e00860d6f in nsXPLookAndFeel::GetColorValue(mozilla::StyleSystemColor, mozilla::ColorScheme, mozilla::LookAndFeel::UseStandins, unsigned int&) /builds/worker/checkouts/gecko/widget/nsXPLookAndFeel.cpp:992:17
    #16 0x7f3e00866856 in mozilla::LookAndFeel::GetColor(mozilla::StyleSystemColor, mozilla::ColorScheme, mozilla::LookAndFeel::UseStandins) /builds/worker/checkouts/gecko/widget/nsXPLookAndFeel.cpp:1436:47
    #17 0x7f3e0079836c in Color /builds/worker/workspace/obj-build/dist/include/mozilla/LookAndFeel.h:465:12
    #18 0x7f3e0079836c in GetAccentColor /builds/worker/checkouts/gecko/widget/ThemeColors.cpp:91:7
    #19 0x7f3e0079836c in mozilla::widget::ThemeColors::RecomputeAccentColors() /builds/worker/checkouts/gecko/widget/ThemeColors.cpp:195:20
    #20 0x7f3e00797dfd in mozilla::widget::Theme::LookAndFeelChanged() /builds/worker/checkouts/gecko/widget/Theme.cpp:183:3
    #21 0x7f3e0085e90f in nsXPLookAndFeel::GetInstance() /builds/worker/checkouts/gecko/widget/nsXPLookAndFeel.cpp:408:3
    #22 0x7f3e00867325 in mozilla::LookAndFeel::GetThemeInfo(nsTSubstring<char>&) /builds/worker/checkouts/gecko/widget/nsXPLookAndFeel.cpp:1549:3
    #23 0x7f3df5e5a7b7 in nsSystemInfo::Init() /builds/worker/checkouts/gecko/xpcom/base/nsSystemInfo.cpp:1081:5
    #24 0x7f3df5fafc6f in mozilla::xpcom::CreateInstanceImpl(mozilla::xpcom::ModuleID, nsID const&, void**) /builds/worker/workspace/obj-build/xpcom/components/StaticComponents.cpp:10279:7
    #25 0x7f3df5fdb212 in CreateInstance /builds/worker/checkouts/gecko/xpcom/components/nsComponentManager.cpp:184:46
    #26 0x7f3df5fdb212 in nsComponentManagerImpl::GetServiceLocked(mozilla::Maybe<mozilla::detail::BaseMonitorAutoLock<mozilla::Monitor>>&, (anonymous namespace)::EntryWrapper&, nsID const&, void**) /builds/worker/checkouts/gecko/xpcom/components/nsComponentManager.cpp:971:17
    #27 0x7f3df5fdc74f in nsComponentManagerImpl::GetService(mozilla::xpcom::ModuleID, nsID const&, void**) /builds/worker/checkouts/gecko/xpcom/components/nsComponentManager.cpp:1061:10
    #28 0x7f3df5fc323d in mozilla::xpcom::GetServiceHelper::operator()(nsID const&, void**) const /builds/worker/workspace/obj-build/xpcom/components/StaticComponents.cpp:13058:50
    #29 0x7f3df7db11ea in assign_from_helper /builds/worker/workspace/obj-build/dist/include/nsCOMPtr.h:897:7
    #30 0x7f3df7db11ea in nsCOMPtr /builds/worker/workspace/obj-build/dist/include/nsCOMPtr.h:533:5
    #31 0x7f3df7db11ea in GetServiceImpl /builds/worker/checkouts/gecko/js/xpconnect/src/JSServices.cpp:83:32
    #32 0x7f3df7db11ea in GetService /builds/worker/checkouts/gecko/js/xpconnect/src/JSServices.cpp:130:8
    #33 0x7f3df7db11ea in xpc::Services_Resolve(JSContext*, JS::Handle<JSObject*>, JS::Handle<JS::PropertyKey>, bool*) /builds/worker/checkouts/gecko/js/xpconnect/src/JSServices.cpp:153:25
    #34 0x7f3e06ae326b in CallResolveOp /builds/worker/checkouts/gecko/js/src/vm/NativeObject-inl.h:683:8
    #35 0x7f3e06ae326b in NativeLookupOwnPropertyInline<(js::AllowGC)1, (js::LookupResolveMode)1> /builds/worker/checkouts/gecko/js/src/vm/NativeObject-inl.h:795:14
    #36 0x7f3e06ae326b in NativeGetPropertyInline<(js::AllowGC)1> /builds/worker/checkouts/gecko/js/src/vm/NativeObject.cpp:2239:10
    #37 0x7f3e06ae326b in js::NativeGetProperty(JSContext*, JS::Handle<js::NativeObject*>, JS::Handle<JS::Value>, JS::Handle<JS::PropertyKey>, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/NativeObject.cpp:2287:10
    #38 0x7f3e067703f9 in GetProperty /builds/worker/checkouts/gecko/js/src/vm/ObjectOperations-inl.h:118:10
    #39 0x7f3e067703f9 in GetProperty /builds/worker/checkouts/gecko/js/src/vm/ObjectOperations-inl.h:125:10
    #40 0x7f3e067703f9 in js::GetProperty(JSContext*, JS::Handle<JS::Value>, JS::Handle<js::PropertyName*>, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:4787:10
    #41 0x7f3e06742b2c in GetPropertyOperation /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:245:10
    #42 0x7f3e06742b2c in js::Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3050:12
    #43 0x7f3e0672814b in MaybeEnterInterpreterTrampoline /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:400:10
    #44 0x7f3e0672814b in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:458:13
    #45 0x7f3e0672958c in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:612:13
    #46 0x7f3e0672b506 in InternalCall /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:647:10
    #47 0x7f3e0672b506 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:679:8
    #48 0x7f3e0672d356 in js::CallGetter(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:801:10
    #49 0x7f3e06ae3bdd in CallGetter /builds/worker/checkouts/gecko/js/src/vm/NativeObject.cpp:2080:12
    #50 0x7f3e06ae3bdd in GetExistingProperty<(js::AllowGC)1> /builds/worker/checkouts/gecko/js/src/vm/NativeObject.cpp:2108:12
    #51 0x7f3e06ae3bdd in NativeGetPropertyInline<(js::AllowGC)1> /builds/worker/checkouts/gecko/js/src/vm/NativeObject.cpp:2256:14
    #52 0x7f3e06ae3bdd in js::NativeGetProperty(JSContext*, JS::Handle<js::NativeObject*>, JS::Handle<JS::Value>, JS::Handle<JS::PropertyKey>, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/NativeObject.cpp:2287:10
    #53 0x7f3e067703f9 in GetProperty /builds/worker/checkouts/gecko/js/src/vm/ObjectOperations-inl.h:118:10
    #54 0x7f3e067703f9 in GetProperty /builds/worker/checkouts/gecko/js/src/vm/ObjectOperations-inl.h:125:10
    #55 0x7f3e067703f9 in js::GetProperty(JSContext*, JS::Handle<JS::Value>, JS::Handle<js::PropertyName*>, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:4787:10
    #56 0x7f3e06742b2c in GetPropertyOperation /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:245:10
    #57 0x7f3e06742b2c in js::Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3050:12
    #58 0x7f3e0672814b in MaybeEnterInterpreterTrampoline /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:400:10
    #59 0x7f3e0672814b in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:458:13
    #60 0x7f3e0672958c in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:612:13
    #61 0x7f3e0672b506 in InternalCall /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:647:10
    #62 0x7f3e0672b506 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:679:8
    #63 0x7f3e0687ddc2 in JS_CallFunctionValue(JSContext*, JS::Handle<JSObject*>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/CallAndConstruct.cpp:53:10
    #64 0x7f3df7df415d in nsXPCWrappedJS::CallMethod(unsigned short, nsXPTMethodInfo const*, nsXPTCMiniVariant*) /builds/worker/checkouts/gecko/js/xpconnect/src/XPCWrappedJSClass.cpp:918:17
    #65 0x7f3df60a1959 in PrepareAndDispatch /builds/worker/checkouts/gecko/xpcom/reflect/xptcall/md/unix/xptcstubs_x86_64_linux.cpp:115:37
    #66 0x7f3df60a065a in SharedStub xptcstubs_x86_64_linux.cpp
    #67 0x7f3df5fd3f30 in NS_CreateServicesFromCategory(char const*, nsISupports*, char const*, char16_t const*) /builds/worker/checkouts/gecko/xpcom/components/nsCategoryManager.cpp:682:19
    #68 0x7f3e0635e5a9 in nsXREDirProvider::DoStartup() /builds/worker/checkouts/gecko/toolkit/xre/nsXREDirProvider.cpp:830:11
    #69 0x7f3e0633a74e in XREMain::XRE_mainRun() /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5406:18
    #70 0x7f3e0633d254 in XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5862:8
    #71 0x7f3e0633e451 in XRE_main(int, char**, mozilla::BootstrapConfig const&) /builds/worker/checkouts/gecko/toolkit/xre/nsAppRunner.cpp:5918:21
    #72 0x5569d5c5dfb4 in do_main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:227:22
    #73 0x5569d5c5dfb4 in main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:445:16
    #74 0x7f3e14423a8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16

SUMMARY: AddressSanitizer: heap-buffer-overflow /builds/worker/fetches/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:875:5 in memcpy
Shadow bytes around the buggy address:
  0x6310051f3400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x6310051f3480: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x6310051f3500: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x6310051f3580: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x6310051f3600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x6310051f3680: 00 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa fa
  0x6310051f3700: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x6310051f3780: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x6310051f3800: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x6310051f3880: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x6310051f3900: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==11034==ABORTING
Exiting due to channel error.
Exiting due to channel error.
Exiting due to channel error.
Exiting due to channel error.
Exiting due to channel error.
Exiting due to channel error.

```
## **Proof-of-Concept**

* Please check the attached file!
* This has the same PoC as 1794292 I previously reported. This has been confirmed to work on Linux as well as macOS.

## **Reproduce**

* open a poc.html in Firefox
* Wait a few seconds.

## **CREDIT Information**

* Dohyun Lee (@l33d0hyun) of PK Security

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1843782#c1)• 2 years ago |
|  | |

Since this also conflicts with the Linux Driver, there is a possibility of Sandbox Escape, and since the previously reported information of 1794292 ([CVE-2023-29531](https://www.cve.org/CVERecord?id=CVE-2023-29531)) has been published, the possibility of ITW (in-the-wild) exists, so a quick patch is needed.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1843782#c2)• 1 years ago |
|  | |

> This has been confirmed to work on Linux as well as macOS.

If by "work" you mean "crash", I can't reproduce that on my Mac (on Firefox 115.0.2 which is what I assume you mean by "Firefox Stable", nor a recent Nightly build). What version of macOS?

On the Linux crash, could you open about:support and share the "Graphics" section?

Group: firefox-core-security → gfx-core-securityComponent: Untriaged → Graphics: CanvasWebGLFlags: needinfo?(dlehgus1023)Product: Firefox → CoreSee Also: → [CVE-2023-29531](/show_bug.cgi?id=1794292 "RESOLVED FIXED - Firefox WebGL glvmInterpretFPTransformFour Memory Corruption Vulnerability")

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1843782#c3)• 1 years ago |
|  | |

## Test environment

Product : Firefox 117.0a1 asan build

VM : Virtualbox 7.0.8

GUEST OS : Ubuntu Desktop 23.04

asan download : <https://firefox-ci-tc.services.mozilla.com/api/index/v1/task/gecko.v2.mozilla-central.latest.firefox.linux64-asan-opt/artifacts/public/build/target.tar.bz2>

```
Graphics
Features
Window Device Pixel Ratios	1
Compositing	WebRender (Software)
Asynchronous Pan/Zoom	wheel input enabled; scrollbar drag enabled; keyboard enabled; autoscroll enabled; smooth pinch-zoom enabled
WebGL 1 Driver WSI Info	EGL_VENDOR: Mesa Project
EGL_VERSION: 1.4
EGL_EXTENSIONS: EGL_ANDROID_blob_cache EGL_ANDROID_native_fence_sync EGL_EXT_buffer_age EGL_EXT_image_dma_buf_import EGL_EXT_image_dma_buf_import_modifiers EGL_EXT_present_opaque EGL_EXT_swap_buffers_with_damage EGL_KHR_cl_event2 EGL_KHR_config_attribs EGL_KHR_context_flush_control EGL_KHR_create_context EGL_KHR_create_context_no_error EGL_KHR_fence_sync EGL_KHR_get_all_proc_addresses EGL_KHR_gl_colorspace EGL_KHR_gl_renderbuffer_image EGL_KHR_gl_texture_2D_image EGL_KHR_gl_texture_3D_image EGL_KHR_gl_texture_cubemap_image EGL_KHR_image_base EGL_KHR_no_config_context EGL_KHR_reusable_sync EGL_KHR_surfaceless_context EGL_KHR_swap_buffers_with_damage EGL_EXT_pixel_format_float EGL_KHR_wait_sync EGL_MESA_configless_context EGL_MESA_drm_image EGL_MESA_image_dma_buf_export EGL_MESA_query_driver EGL_WL_bind_wayland_display EGL_WL_create_wayland_buffer_from_image
EGL_EXTENSIONS(nullptr): EGL_EXT_device_base EGL_EXT_device_enumeration EGL_EXT_device_query EGL_EXT_platform_base EGL_KHR_client_get_all_proc_addresses EGL_EXT_client_extensions EGL_KHR_debug EGL_EXT_platform_device EGL_EXT_platform_wayland EGL_KHR_platform_wayland EGL_EXT_platform_x11 EGL_KHR_platform_x11 EGL_EXT_platform_xcb EGL_MESA_platform_gbm EGL_KHR_platform_gbm EGL_MESA_platform_surfaceless
IsWebglOutOfProcessEnabled: 1
WebGL 1 Driver Renderer	VMware, Inc. -- SVGA3D; build: RELEASE;  LLVM;
WebGL 1 Driver Version	3.3 (Compatibility Profile) Mesa 23.0.2
WebGL 1 Driver Extensions	GL_ARB_multisample GL_EXT_abgr GL_EXT_bgra GL_EXT_blend_color GL_EXT_blend_minmax GL_EXT_blend_subtract GL_EXT_copy_texture GL_EXT_subtexture GL_EXT_texture_object GL_EXT_vertex_array GL_EXT_compiled_vertex_array GL_EXT_texture GL_EXT_texture3D GL_IBM_rasterpos_clip GL_ARB_point_parameters GL_EXT_draw_range_elements GL_EXT_packed_pixels GL_EXT_point_parameters GL_EXT_rescale_normal GL_EXT_separate_specular_color GL_EXT_texture_edge_clamp GL_SGIS_generate_mipmap GL_SGIS_texture_border_clamp GL_SGIS_texture_edge_clamp GL_SGIS_texture_lod GL_ARB_framebuffer_sRGB GL_ARB_multitexture GL_EXT_framebuffer_sRGB GL_IBM_multimode_draw_arrays GL_IBM_texture_mirrored_repeat GL_ARB_texture_cube_map GL_ARB_texture_env_add GL_ARB_transpose_matrix GL_EXT_blend_func_separate GL_EXT_fog_coord GL_EXT_multi_draw_arrays GL_EXT_secondary_color GL_EXT_texture_env_add GL_EXT_texture_filter_anisotropic GL_EXT_texture_lod_bias GL_INGR_blend_func_separate GL_NV_blend_square GL_NV_light_max_exponent GL_NV_texgen_reflection GL_NV_texture_env_combine4 GL_S3_s3tc GL_SUN_multi_draw_arrays GL_ARB_texture_border_clamp GL_ARB_texture_compression GL_EXT_framebuffer_object GL_EXT_texture_compression_s3tc GL_EXT_texture_env_combine GL_EXT_texture_env_dot3 GL_MESA_window_pos GL_NV_packed_depth_stencil GL_NV_texture_rectangle GL_ARB_depth_texture GL_ARB_occlusion_query GL_ARB_shadow GL_ARB_texture_env_combine GL_ARB_texture_env_crossbar GL_ARB_texture_env_dot3 GL_ARB_texture_mirrored_repeat GL_ARB_window_pos GL_ATI_fragment_shader GL_EXT_stencil_two_side GL_EXT_texture_cube_map GL_NV_depth_clamp GL_NV_fog_distance GL_NV_half_float GL_APPLE_packed_pixels GL_ARB_draw_buffers GL_ARB_fragment_program GL_ARB_fragment_shader GL_ARB_shader_objects GL_ARB_vertex_program GL_ARB_vertex_shader GL_ATI_draw_buffers GL_ATI_texture_env_combine3 GL_ATI_texture_float GL_EXT_shadow_funcs GL_EXT_stencil_wrap GL_MESA_pack_invert GL_NV_primitive_restart GL_ARB_depth_clamp GL_ARB_fragment_program_shadow GL_ARB_half_float_pixel GL_ARB_occlusion_query2 GL_ARB_point_sprite GL_ARB_shading_language_100 GL_ARB_sync GL_ARB_texture_non_power_of_two GL_ARB_vertex_buffer_object GL_ATI_blend_equation_separate GL_EXT_blend_equation_separate GL_OES_read_format GL_ARB_color_buffer_float GL_ARB_pixel_buffer_object GL_ARB_texture_compression_rgtc GL_ARB_texture_float GL_ARB_texture_rectangle GL_EXT_packed_float GL_EXT_pixel_buffer_object GL_EXT_texture_compression_dxt1 GL_EXT_texture_compression_rgtc GL_EXT_texture_rectangle GL_EXT_texture_sRGB GL_EXT_texture_shared_exponent GL_ARB_framebuffer_object GL_EXT_framebuffer_blit GL_EXT_framebuffer_multisample GL_EXT_packed_depth_stencil GL_ARB_vertex_array_object GL_ATI_separate_stencil GL_EXT_draw_buffers2 GL_EXT_draw_instanced GL_EXT_gpu_program_parameters GL_EXT_gpu_shader4 GL_EXT_texture_array GL_EXT_texture_integer GL_EXT_texture_sRGB_decode GL_EXT_timer_query GL_OES_EGL_image GL_EXT_texture_buffer_object GL_ARB_copy_buffer GL_ARB_depth_buffer_float GL_ARB_draw_instanced GL_ARB_half_float_vertex GL_ARB_instanced_arrays GL_ARB_map_buffer_range GL_ARB_texture_buffer_object GL_ARB_texture_rg GL_ARB_texture_swizzle GL_ARB_vertex_array_bgra GL_EXT_texture_swizzle GL_EXT_vertex_array_bgra GL_NV_conditional_render GL_AMD_conservative_depth GL_ARB_ES2_compatibility GL_ARB_blend_func_extended GL_ARB_compatibility GL_ARB_debug_output GL_ARB_draw_elements_base_vertex GL_ARB_explicit_attrib_location GL_ARB_fragment_coord_conventions GL_ARB_provoking_vertex GL_ARB_sampler_objects GL_ARB_seamless_cube_map GL_ARB_shader_texture_lod GL_ARB_texture_buffer_object_rgb32 GL_ARB_texture_multisample GL_ARB_texture_rgb10_a2ui GL_ARB_uniform_buffer_object GL_ARB_vertex_type_2_10_10_10_rev GL_EXT_provoking_vertex GL_EXT_texture_snorm GL_MESA_texture_signed_rgba GL_NV_copy_image GL_ARB_get_program_binary GL_ARB_robustness GL_ARB_separate_shader_objects GL_ARB_shader_bit_encoding GL_ARB_shader_subroutine GL_ARB_timer_query GL_ARB_viewport_array GL_EXT_direct_state_access GL_ANGLE_texture_compression_dxt3 GL_ANGLE_texture_compression_dxt5 GL_ARB_compressed_texture_pixel_storage GL_ARB_conservative_depth GL_ARB_internalformat_query GL_ARB_map_buffer_alignment GL_ARB_shading_language_420pack GL_ARB_shading_language_packing GL_ARB_texture_storage GL_EXT_framebuffer_multisample_blit_scaled GL_EXT_transform_feedback GL_AMD_shader_trinary_minmax GL_ARB_ES3_compatibility GL_ARB_arrays_of_arrays GL_ARB_clear_buffer_object GL_ARB_copy_image GL_ARB_explicit_uniform_location GL_ARB_fragment_layer_viewport GL_ARB_invalidate_subdata GL_ARB_program_interface_query GL_ARB_stencil_texturing GL_ARB_texture_buffer_range GL_ARB_texture_query_levels GL_ARB_texture_storage_multisample GL_ARB_vertex_attrib_binding GL_KHR_debug GL_KHR_texture_compression_astc_ldr GL_ARB_buffer_storage GL_ARB_clear_texture GL_ARB_internalformat_query2 GL_ARB_multi_bind GL_ARB_shading_language_include GL_ARB_texture_stencil8 GL_EXT_debug_label GL_EXT_shader_integer_mix GL_ARB_direct_state_access GL_ARB_get_texture_sub_image GL_KHR_context_flush_control GL_ARB_parallel_shader_compile GL_KHR_no_error GL_KHR_texture_compression_astc_sliced_3d GL_MESA_shader_integer_functions GL_ARB_texture_filter_anisotropic GL_KHR_parallel_shader_compile GL_EXT_EGL_image_storage GL_EXT_EGL_sync GL_NV_ES1_1_compatibility
WebGL 1 Extensions	ANGLE_instanced_arrays EXT_blend_minmax EXT_color_buffer_half_float EXT_float_blend EXT_frag_depth EXT_shader_texture_lod EXT_sRGB EXT_texture_compression_rgtc EXT_texture_filter_anisotropic MOZ_debug OES_element_index_uint OES_fbo_render_mipmap OES_standard_derivatives OES_texture_float OES_texture_float_linear OES_texture_half_float OES_texture_half_float_linear OES_vertex_array_object WEBGL_color_buffer_float WEBGL_compressed_texture_astc WEBGL_compressed_texture_etc WEBGL_compressed_texture_s3tc WEBGL_compressed_texture_s3tc_srgb WEBGL_debug_renderer_info WEBGL_debug_shaders WEBGL_depth_texture WEBGL_draw_buffers WEBGL_lose_context
WebGL 2 Driver WSI Info	-
WebGL 2 Driver Renderer	WebGL creation failed:
* WebGL 2 requires support for the following features:
  transform_feedback2 (FEATURE_FAILURE_WEBGL2_OCCL)
WebGL 2 Driver Version	-
WebGL 2 Driver Extensions	-
WebGL 2 Extensions	-
Window Protocol	wayland
Desktop Environment	ubuntu:gnome
Target Frame Rate	60
WebGPU Default Adapter	{
  "navigator.gpu.requestAdapter({})": {
    "isFallbackAdapter": true,
    "requestAdapterInfo()": {
      "architecture": "",
      "description": "",
      "device": "",
      "vendor": "",
      "wgpuBackend": "Vulkan",
      "wgpuDevice": 0,
      "wgpuDeviceType": "Cpu",
      "wgpuDriver": "llvmpipe",
      "wgpuDriverInfo": "Mesa 23.0.2 (LLVM 15.0.7)",
      "wgpuName": "llvmpipe (LLVM 15.0.7, 128 bits)",
      "wgpuVendor": 65541
    },
    "features": [
      "depth-clip-control",
      "depth32float-stencil8",
      "indirect-first-instance",
      "rg11b10ufloat-renderable",
      "texture-compression-bc",
      "timestamp-query"
    ],
    "limits": {
      "maxBindGroups": 8,
      "maxBindGroupsPlusVertexBuffers": 24,
      "maxBindingsPerBindGroup": 640,
      "maxBufferSize": 2147483647,
      "maxColorAttachmentBytesPerSample": 32,
      "maxColorAttachments": 8,
      "maxComputeInvocationsPerWorkgroup": 1024,
      "maxComputeWorkgroupSizeX": 1024,
      "maxComputeWorkgroupSizeY": 1024,
      "maxComputeWorkgroupSizeZ": 1024,
      "maxComputeWorkgroupStorageSize": 32768,
      "maxComputeWorkgroupsPerDimension": 65535,
      "maxDynamicStorageBuffersPerPipelineLayout": 256,
      "maxDynamicUniformBuffersPerPipelineLayout": 256,
      "maxInterStageShaderComponents": 128,
      "maxInterStageShaderVariables": 16,
      "maxSampledTexturesPerShaderStage": 128,
      "maxSamplersPerShaderStage": 32,
      "maxStorageBufferBindingSize": 134217728,
      "maxStorageBuffersPerShaderStage": 32,
      "maxStorageTexturesPerShaderStage": 64,
      "maxTextureArrayLayers": 2048,
      "maxTextureDimension1D": 16384,
      "maxTextureDimension2D": 16384,
      "maxTextureDimension3D": 4096,
      "maxUniformBufferBindingSize": 65536,
      "maxUniformBuffersPerShaderStage": 15,
      "maxVertexAttributes": 32,
      "maxVertexBufferArrayStride": 2048,
      "maxVertexBuffers": 16,
      "minStorageBufferOffsetAlignment": 32,
      "minUniformBufferOffsetAlignment": 32
    }
  }
}
WebGPU Fallback Adapter	{
  "navigator.gpu.requestAdapter({\"forceFallbackAdapter\":true})": {
    "isFallbackAdapter": true,
    "requestAdapterInfo()": {
      "architecture": "",
      "description": "",
      "device": "",
      "vendor": "",
      "wgpuBackend": "Vulkan",
      "wgpuDevice": 0,
      "wgpuDeviceType": "Cpu",
      "wgpuDriver": "llvmpipe",
      "wgpuDriverInfo": "Mesa 23.0.2 (LLVM 15.0.7)",
      "wgpuName": "llvmpipe (LLVM 15.0.7, 128 bits)",
      "wgpuVendor": 65541
    },
    "features": [
      "depth-clip-control",
      "depth32float-stencil8",
      "indirect-first-instance",
      "rg11b10ufloat-renderable",
      "texture-compression-bc",
      "timestamp-query"
    ],
    "limits": {
      "maxBindGroups": 8,
      "maxBindGroupsPlusVertexBuffers": 24,
      "maxBindingsPerBindGroup": 640,
      "maxBufferSize": 2147483647,
      "maxColorAttachmentBytesPerSample": 32,
      "maxColorAttachments": 8,
      "maxComputeInvocationsPerWorkgroup": 1024,
      "maxComputeWorkgroupSizeX": 1024,
      "maxComputeWorkgroupSizeY": 1024,
      "maxComputeWorkgroupSizeZ": 1024,
      "maxComputeWorkgroupStorageSize": 32768,
      "maxComputeWorkgroupsPerDimension": 65535,
      "maxDynamicStorageBuffersPerPipelineLayout": 256,
      "maxDynamicUniformBuffersPerPipelineLayout": 256,
      "maxInterStageShaderComponents": 128,
      "maxInterStageShaderVariables": 16,
      "maxSampledTexturesPerShaderStage": 128,
      "maxSamplersPerShaderStage": 32,
      "maxStorageBufferBindingSize": 134217728,
      "maxStorageBuffersPerShaderStage": 32,
      "maxStorageTexturesPerShaderStage": 64,
      "maxTextureArrayLayers": 2048,
      "maxTextureDimension1D": 16384,
      "maxTextureDimension2D": 16384,
      "maxTextureDimension3D": 4096,
      "maxUniformBufferBindingSize": 65536,
      "maxUniformBuffersPerShaderStage": 15,
      "maxVertexAttributes": 32,
      "maxVertexBufferArrayStride": 2048,
      "maxVertexBuffers": 16,
      "minStorageBufferOffsetAlignment": 32,
      "minUniformBufferOffsetAlignment": 32
    }
  }
}
GPU #1
Active	Yes
Description	SVGA3D; build: RELEASE;  LLVM;
Vendor ID	0x15ad
Device ID	0x0405
Driver Vendor	mesa/vmwgfx
Driver Version	23.0.2.0
RAM	0
Diagnostics
AzureCanvasBackend	skia
AzureContentBackend	skia
AzureFallbackCanvasBackend	skia
CMSOutputProfile	Empty profile data
Display0	1920x970@60Hz scales:1.000000|1.000000
DisplayCount	1
Device Reset
Decision Log
HW_COMPOSITING
default	available
env	blocked	Acceleration blocked by platform
OPENGL_COMPOSITING
default	unavailable	Hardware compositing is disabled	Blocklisted; failure code FEATURE_FAILURE_OPENGL_NEED_HWCOMP
WEBRENDER
default	available
env	blocklisted	Blocklisted by gfxInfo	Blocklisted; failure code FEATURE_FAILURE_SOFTWARE_GL
WEBRENDER_COMPOSITOR
default	disabled	Disabled by default	Blocklisted; failure code FEATURE_FAILURE_DISABLED
env	blocklisted	Blocklisted by gfxInfo	Blocklisted; failure code FEATURE_FAILURE_WEBRENDER_COMPOSITOR_DISABLED
WEBRENDER_PARTIAL
default	available
WEBRENDER_SHADER_CACHE
default	disabled	Disabled by default	Blocklisted; failure code FEATURE_FAILURE_DISABLED
runtime	unavailable	WebRender disabled	Blocklisted; failure code FEATURE_FAILURE_WR_DISABLED
WEBRENDER_OPTIMIZED_SHADERS
default	available
runtime	unavailable	WebRender disabled	Blocklisted; failure code FEATURE_FAILURE_WR_DISABLED
WEBRENDER_ANGLE
default	available
env	unavailable	OS not supported	Blocklisted; failure code FEATURE_FAILURE_OS_NOT_SUPPORTED
WEBRENDER_DCOMP_PRESENT
default	available
user	disabled	User disabled via pref	Blocklisted; failure code FEATURE_FAILURE_DCOMP_PREF_DISABLED
env	unavailable	Requires GPU process	Blocklisted; failure code FEATURE_FAILURE_NO_GPU_PROCESS
runtime	unavailable	Requires ANGLE	Blocklisted; failure code FEATURE_FAILURE_DCOMP_NOT_ANGLE
WEBRENDER_SCISSORED_CACHE_CLEARS
default	available
WEBGPU
default	available
X11_EGL
default	available
DMABUF
default	available
HARDWARE_VIDEO_DECODING
default	available
runtime	unavailable	Force disabled by gfxInfo	Blocklisted; failure code FEATURE_FAILURE_VIDEO_DECODING_TEST_FAILED
DMABUF_SURFACE_EXPORT
default	available
BACKDROP_FILTER
default	available
CANVAS_RENDERER_THREAD
default	available
ACCELERATED_CANVAS2D
default	available
env	blocked	Disabled by Software WebRender	Blocklisted; failure code FEATURE_FAILURE_DISABLED_BY_SOFTWARE_WEBRENDER

```
Flags: needinfo?(dlehgus1023)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1843782#c4)• 1 years ago |
|  | |

Might be a driver bug, but calling it sec-high to start assuming it might be our problem.

Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a357357_309398)• 1 years ago |

Assignee: nobody → jgilbert

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1843782#c5)• 1 years ago |
|  | |

Any updates on this report?

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1843782#c6)• 1 years ago |
|  | |

The severity field is not set for this bug.

:jgilbert, could you have a look please?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#workflow.2Fno_severity.py).

Flags: needinfo?(jgilbert)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1843782#c7)• 1 years ago |
|  | |

I will add a disclosure deadline.

```
This bug is subject to a 90-day disclosure deadline. If a fix for this
issue is made available to users before the end of the 90-day deadline,
this bug report will become public 30 days after the fix was made
available. Otherwise, this bug report will become public at the deadline.
The scheduled deadline is 2023-11-06.

```

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a2511020_1689)• 1 year ago |

Whiteboard: [disclosure deadline 2023-11-06]

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1843782#c8)• 1 year ago |
|  | |

I do believe this is a driver bug but it's going to take some digging into.

Maybe poor driver handling of u8 index buffers? u8 index buffers probably aren't natively supported by hardware and need to be polyfilled by driver, but that's my only lead here.

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a2589423_419431)• 1 year ago |

Severity: -- → S3Priority: -- → P1

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1843782#c9)• 1 year ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:jgilbert, could you consider increasing the severity of this security bug?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#severity_high_security.py).

Flags: needinfo?(jgilbert)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1843782#c10)• 1 year ago |
|  | |

Hi jgilbert,

Any update to this case?

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1843782#c11)• 1 year ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Hello?

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1843782#c12)• 1 year ago |
|  | |

any update?

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1843782#c13)• 1 year ago |
|  | |

No update yet.

It needs to be repro'd an dug into, but all signs point towards "bad driver" so far.

The index buffer (casted to u8) doesn't seem suspicious:

```
0: 167
1: 213
2: 235
3: 65
4: 35
5: 34
6: 248
7: 101
8: 67
9: 157
10: 207
11: 4
12: 20
13: 40
14: 90
15: 109
16: 135
17: 165
18: 112
19: 64
20: 61
21: 134
22: 133
23: 107
24: 196
25: 62
26: 72
27: 190
28: 114
29: 118
30: 242
31: 244
32: 190
33: 63
34: 52
35: 112
36: 232
37: 223
38: 113
39: 45
40: 21
41: 193
42: 65
43: 157
44: 10
45: 132
46: 178
47: 38
48: 4
49: 2
50: 220
51: 169
52: 248
53: 142
54: 53
55: 133
56: 89
57: 196
58: 70
59: 181
60: 142
61: 14
62: 61
63: 230
64: 195
65: 74
66: 186
67: 13
68: 252
69: 50
70: 28
71: 66
72: 223
73: 18
74: 67
75: 26
76: 153
77: 111
78: 112
79: 18

```

Looks like a range of [2,252].

There's no vertex attrib array set, so these should all be pulling from generic (uniform) vertex attribs.

Vertex shader has no declared inputs, but that is supposed to be fine.

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1843782#c14)• 1 year ago |
|  | |

```
gl1.drawElements(gl1.POINTS, 2, gl1.UNSIGNED_BYTE,0);

```

This should just be asking for the first two values, so vert-id list is really just [167, 213].

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a5799115_419431)• 1 year ago |

Keywords: [sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1843782#c15)• 1 year ago |
|  | |

This needs repro on Linux.

Blocks: [gfx-triage](/show_bug.cgi?id=1632611 "NEW - [Meta] Graphics Triage Tracker")Flags: needinfo?(bhood)

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1843782#c16)• 1 year ago |
|  | |

It tried this on Ubuntu 22.04 LTS using Fx118.x on NVIDIA driver v535 (2080 Ti GPU). Opening the attached `poc.html` resulted in a noticeable looping effect (the text in the awesome bar kept flashing), and nothing being drawn on the main screen. I let it run for several minutes, and this behavior persisted until I closed the browser.

No *application* crashing was evident.

Flags: needinfo?(bhood)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1843782#c17)• 1 year ago |
|  | |

The trigger for this bug operates in certain environments.

Since it operates in an environment that uses mesa, we would appreciate it if you could refer to #c3.

Additionally, there is almost a month left until the deadline for this bug.

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1843782#c18)• 1 year ago |
|  | |

Crashed instantly on Ubuntu 22.04 using Mesa 23.0.4 and Fx118.0.1 in a VMware appliance with "Accelerate 3D graphics" enabled (same system mentioned above with the 2080 Ti GPU).

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a7009381_697075)• 1 year ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1843782#c19)• 1 year ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

any update?

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1843782#c20)• 1 year ago |
|  | |

My WebGL lead is not currently available, but I am discussing it with another team member who can pick it up after she finishes her current priority.

Assignee: jgilbert → ahale

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a7613988_309398)• 1 year ago |

No longer blocks: [gfx-triage](/show_bug.cgi?id=1632611 "NEW - [Meta] Graphics Triage Tracker")

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1843782#c21)• 1 year ago |
|  | |

Attached file
[about:support (json format)](attachment.cgi?id=9359904)
— [Details](attachment.cgi?id=9359904&action=edit)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1843782#c22)• 1 year ago |
|  | |

Attached file
[about:support (text format)](attachment.cgi?id=9359905)
— [Details](attachment.cgi?id=9359905&action=edit)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1843782#c23)• 1 year ago |
|  | |

In terms of protecting users from unexpected threats, I'm inclined to simply blocklist the SVGA3D driver for WebGL, since the vendor does not appear to have security-hardening in mind on either side of the VM boundary. Blocking individual exploits based on invalid OpenGL state vector validation is an option but unless there is demand for high performance WebGL in VirtualBox/VMWare it doesn't seem necessary to have the Enable 3D Acceleration feature work in Firefox in a Linux guest.

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1843782#c24)• 1 year ago |
|  | |

Hi ahale,

There are two weeks left until the disclosure date for this vulnerability.

Is it possible to alleviate this within two weeks?

If necessary, an extension of an additional two weeks may be offered.

I think it would be a good idea to blocklist SVGA3D itself inside the VM as mentioned in the comment above.

There seems to be no reason to use the 3D Acceleration feature in Linux guests unless specifically required.

There seems to be more of a need for security threats that arise from using that feature.

In particular, I believe that the vulnerability that arises while accessing the driver can be used for Sandbox Escape as well.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1843782#c25)• 1 year ago |
|  | |

We actually did put a blocklist in place for WebRender on this driver in <https://bugzilla.mozilla.org/show_bug.cgi?id=1815481> but it doesn't seem to affect WebGL, so I'm working to correct the blocklist behavior so it is more comprehensive for this case - WebGL should be blocked on any WebRender software compositing mode because of copy back from GPU being slow anyway.

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1843782#c26)• 1 year ago |
|  | |

Hi ahale,

I see. Thank you for your hard work.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1843782#c27)• 1 year ago |
|  | |

Attached file
[Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](attachment.cgi?id=9360544)
— [Details](attachment.cgi?id=9360544&action=edit)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1843782#c28)• 1 year ago |
|  | |

For now, let's disable WebGL on this driver, there's a more general discussion I'd like to start on whether WebGL should be blocked by blocklists affecting WebRender (because if WebRender is blocked, we're using software compositing, so hardware WebGL is of more dubious value than it would be if WebRender was not blocked), but that discussion is more on the topic of performance and robustness, not really relevant to this security bug.

The patch I attached blocks the feature correctly but seems to present obtuse error messages users (both would ideally cite FEATURE\_FAILURE\_MESA\_VM as their reason for blocking, but instead they complain about software rendering, and lack of WebGL backends respectively).

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1843782#c29)• 1 year ago |
|  | |

Just to surface one of my concerns as I've spent a non-trivial amount of time thinking about this, it is reasonably likely that as soon as the WebGL blocking is landed in a stable release we will get bugs filed by web developers who are testing their WebGL websites in Linux in a virtual machine and expect it to work, I'm not sure what magnitude of reports that will be however.

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a8897930_279663)• 1 year ago |

Summary: Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Vulnerability → Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1843782#c30)• 1 year ago |
|  | |

I'm still spending a fair amount of time in gdb trying to figure out how we select an EGL device and how we could pick a software one deliberately on this configuration (alternative approaches exist, like setting the LIBGL\_ALWAYS\_SOFTWARE=1 environment variable when this driver is detected, but it feels like that would be hacky and possibly not thread safe). Per discussion in the team we want to keep WebGL viable by punting it to software rendering which should have a better security stance than the vmwgfx driver, but not disable it completely.

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1843782#c31)• 1 year ago |
|  | |

Hello,

There are 7 days left until the deadline for this report. Additional extensions are possible upon request. How much more time do you need?

Flags: needinfo?(dveditz)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1843782#c32)• 1 year ago |
|  | |

I would like to have the two extra weeks you offered.

While I am confident I can get the code done before the original deadline, there's a chance of breakages that would cause it to bounce after landing, and we need to uplift the change to beta and then release which itself takes a little time.

In terms of release schedule the ideal scenario is that we verify this is stable in Nightly 120, then uplift to Beta 120, then regular release of stable 120 is scheduled for November 21, which fits within your offer for extended time but not in the original deadline. Uplifting to stable is of course possible before the original deadline but it has to be in nightly and beta first and that is a very tight window.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1843782#c33)• 1 year ago |
|  | |

Needinfo for stransky:

I'm looking at changing <https://searchfox.org/mozilla-central/rev/01a0d864a9442d0fe2dbd4beee5c88b9b46e96bd/gfx/gl/GLLibraryEGL.cpp#897> to have a case for blocked GL drivers which would use our device enumeration to find a device with an empty name which I believe should get us llvmpipe or softpipe, rather than calling gdk\_display\_get\_default().

I'm trying to figure out how we would determine if the driver is blocked at this point in initialization, ideally hooking into the regular blocklist feature failure system.

Do you know if the blocklist has been initialized by this point? And any tips on doing this would be appreciated.

I'm going to continue prototyping this change but it's nice to know if I'm on the wrong path.

Flags: needinfo?(stransky)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1843782#c34)• 1 year ago |
|  | |

I think it would actually be cleaner if we enumerate devices and simply skip ones that are known to be unstable drivers, pick the one we are looking for (gfx::gfxVars::DrmRenderDevice), and if we exhaust the options pick the software one. I have been prototyping this logic as a change to GetAndInitDeviceDisplay and calling it first before falling back to gdk\_display\_get\_default(), it would only return nullptr if the device enumeration fails, or there are no devices after filtering out unstable ones.

I'm really not sure what the implications of this will be on startup, because I'm not familiar with each of the approaches we are iterating through in the fallback order we use, but I can see there have been a few bugs that were fixed by rearranging the startup order and this would be changing it yet again.

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a9278819_683497)• 1 year ago |

Flags: sec-bounty?Whiteboard: [disclosure deadline 2023-11-06] → [disclosure deadline 2023-11-20]

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1843782#c35)• 1 year ago |
|  | |

Hello,

I will accept your offer. We are extending the deadline by another two weeks.

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a9278902_683497)• 1 year ago |

Whiteboard: [disclosure deadline 2023-11-20] → [disclosure deadline 2023-11-21]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1843782#c36)• 1 year ago |
|  | |

Thank you!

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1843782#c37)• 1 year ago |
|  | |

Ashley: I'm assuming this also affects ESR-115 and we'd want an uplift. Please correct me if 115 is unaffected or if some big change between 115 and now would make the proposed fix not work on the ESR branch or be too risky for some reason. This was reported pretty close to the branching point so the chances seem good this would be easy to apply.

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox120](/buglist.cgi?f1=cf_tracking_firefox120&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox120&o1=equals&v1=%2B)
[tracking-firefox121](/buglist.cgi?f1=cf_tracking_firefox121&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox121&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [120+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=120%2B)Flags: needinfo?(ahale)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1843782#c38)• 1 year ago |
|  | |

The bug is marked as tracked for firefox120 (beta) and tracked for firefox121 (nightly). However, the bug still has low severity.

:bhood, could you please increase the severity for this tracked bug? If you disagree with the tracking decision, please talk with the release managers.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#tracked_attention.py).

Flags: needinfo?(bhood)

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a9318165_697075)• 1 year ago |

Flags: needinfo?(bhood)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1843782#c39)• 1 year ago |
|  | |

Likely the same issue as [bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability"), possible dupe, or at least leverageable.

See Also: → [CVE-2023-4582](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability")

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1843782#c40)• 1 year ago |
|  | |

Here's a nearby place where we check the blocklist: <https://searchfox.org/mozilla-central/source/gfx/gl/GLLibraryEGL.cpp#359>

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1843782#c41)• 1 year ago |
|  | |

Hi,

If this case is the same as [bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability") according to [comment 39](/show_bug.cgi?id=1843782#c39 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"), this may mean an incomplete patch of [bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability").

However, [bug 1773874](/show_bug.cgi?id=1773874 "VERIFIED FIXED - WebGL glGetProgramiv Buffer Overflow Vulnerability") was a case where stack\_chk\_fail occurred due to stack buffer overflow, but this case was not alleviated and heap overflow occurred in memcpy.

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1843782#c42)• 1 year ago |
|  | |

(In reply to Ashley Hale [:ahale] from [comment #33](/show_bug.cgi?id=1843782#c33 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> Needinfo for stransky:
>
> I'm looking at changing <https://searchfox.org/mozilla-central/rev/01a0d864a9442d0fe2dbd4beee5c88b9b46e96bd/gfx/gl/GLLibraryEGL.cpp#897> to have a case for blocked GL drivers which would use our device enumeration to find a device with an empty name which I believe should get us llvmpipe or softpipe, rather than calling gdk\_display\_get\_default().
>
> I'm trying to figure out how we would determine if the driver is blocked at this point in initialization, ideally hooking into the regular blocklist feature failure system.

AFAIK There are two possible options:

1. Set LIBGL\_ALWAYS\_SOFTWARE=1 around eglInitialize (and remove it after it). This is a generic way and IMHO the easy one.
2. Use EGL\_EXT\_device\_enumeration/EGL\_EXT\_platform\_device to enumerate devices and select software one. eglinfo lists all available devices and swrast is available as a second device of vmwgfx under VirtualBox. On bare metal/AMD swrast is also available for EGL\_MESA\_platform\_gbm.

GL Mesa driver is selected from DRM node by drmGetVersion() so MESA select default driver for given fd according to actual kernel driver. So we'll get vmwgfx as it's the kernel driver used for such device, no matter if you create GL context surfaceless/based on display or directly for the file descriptor. Also we don't set gfxVars::DrmRenderDevice() if dmabuf is disabled which is wrong. Filled [Bug 1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing") for it.

If we set LIBGL\_ALWAYS\_SOFTWARE MESA uses swrast over drm node and doesn't check an actual underlying driver.

Note that you need to explicitly check '3D acceleration' in VirtualBox to get vmwgfx, SW driver is used instead.

Flags: needinfo?(stransky)

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1843782#c43)• 1 year ago |
|  | |

Attached patch

[wip patch](attachment.cgi?id=9361824&action=diff)
— [Details](attachment.cgi?id=9361824&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1843782&attachment=9361824)

Sets LIBGL\_ALWAYS\_SOFTWARE for DriverVendor::MesaVM. If we go this way we may set it somewhere else to make sure it's thread safe. Os use forceSoftware implentation as base for SW device selection.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a9493324_75935)• 1 year ago |

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=wontfix)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1843782#c44)• 1 year ago |
|  | |

Yeah thread-safety is the reason I opted to develop a patch for egl device enumeration instead, it's delicate-looking code though so I have been going over it meticulously, and per discussion with Kelsey I'm looking at checking the blocklist first and then using a device enumeration that searches for swrast based on the blocklist decision, which should be more extensible in the long run than blocking this specific driver in the EGL enumeration.

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1843782#c45)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16656601 "1 revision") |
|  | |

(In reply to Ashley Hale [:ahale] from [comment #44](/show_bug.cgi?id=1843782#c44 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> Yeah thread-safety is the reason I opted to develop a patch for egl device enumeration instead.

I think the egl device enumeration is not very reliable. Also if we know the driver is broken we may not be concerned to set LIBGL\_ALWAYS\_SOFTWARE global wide as it may affects other applications. We launch glxtest utility to get GFX renderer & co here:

<https://searchfox.org/mozilla-central/rev/e94bcd536a2a4caad0597d1b2d624342e6a389c4/toolkit/xre/nsAppRunner.cpp#5151>

it may be possible to just open render node and get driver name directly from it as MESA does:

```
static char *loader_get_kernel_driver_name(int fd)
{
#if HAVE_LIBDRM
   char *driver;
   drmVersionPtr version = drmGetVersion(fd);

   if (!version) {
      log_(_LOADER_WARNING, "failed to get driver name for fd %d\n", fd);
      return NULL;
   }

   driver = strndup(version->name, version->name_len);
   log_(driver ? _LOADER_DEBUG : _LOADER_WARNING, "using driver %s for %d\n",
        driver, fd);

   drmFreeVersion(version);
   return driver;
#else
   return NULL;
#endif
}

```

while fd is for /dev/dri/renderD128 (that's first gfx card on the system which may cover VM scenario).

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1843782#c46)• 1 year ago |
|  | |

I mean using the blocklist to decide to put WebGL in software mode, then acting on that in egl device selection to pick the first device that has no DRM render device. In my debugging this was consistent.

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1843782#c47)• 1 year ago |
|  | |

Guys, Mesa folks are interested to look at it.

Is it already reported there? (<https://gitlab.freedesktop.org/mesa/mesa/-/issues>). Can I report that as security issue there?

Thanks.

Flags: needinfo?(dlehgus1023)

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a9812764_263117)• 1 year ago |

Flags: needinfo?(dveditz)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1843782#c48)• 1 year ago |
|  | |

Hello,

Did not report to Mesa.

We'd appreciate it if you could also report this to Mesa!

Flags: needinfo?(dlehgus1023)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1843782#c49)• 1 year ago |
|  | |

Additionally, there are 14 days left until the deadline for this report.

Please commit the patch quickly.

Thanks.

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1843782#c50)• 1 year ago |
|  | |

[Bug 1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing") sets drm device regardless of dmabuf state. That may help to enumerate mesa devices.

See Also: → [1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing")

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1843782#c51)• 1 year ago |
|  | |

CC: Red Hat/Mesa folk Jose.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1843782#c52)• 1 year ago |
|  | |

> Can I report that as security issue [to Mesa folks]?

yes, please do.

Flags: needinfo?(dveditz)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1843782#c53)• 1 year ago |
|  | |

Confirmed patch for [bug 1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing"). Please mark if this bug has been fixed.

Flags: needinfo?(stransky)

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1843782#c54)• 1 year ago |
|  | |

(In reply to DoHyun Lee [:l33d0hyun] from [comment #53](/show_bug.cgi?id=1843782#c53 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> Confirmed patch for [bug 1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing"). Please mark if this bug has been fixed.

[Bug 1862957](/show_bug.cgi?id=1862957 "RESOLVED FIXED - If dmabuf is disabled (due to drivers etc.) gfxVars::DrmRenderDevice() is missing") allows to enumerate MESA devices at GetAndInitDeviceDisplay() as we always set DRM device:

<https://searchfox.org/mozilla-central/rev/01a0d864a9442d0fe2dbd4beee5c88b9b46e96bd/gfx/gl/GLLibraryEGL.cpp#175>

but it doesn't fix this bug.

Flags: needinfo?(stransky)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1843782#c55)• 1 year ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

Hello,

Any update?

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1843782#c56)• 1 year ago |
|  | |

Moving tracking to another cycle, please change/NI me if anything changes for the 120 cycle.

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[120+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=120%2B) → [121+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=121%2B)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1843782#c57)• 1 year ago |
|  | |

Hello dveditz,

There are 7 days left until the disclosure deadline.

Please update quickly.

Flags: needinfo?(dveditz)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1843782#c58)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16665947 "1 revision") |
|  | |

I've tried to get egl device selection to resolve this problem (by picking a mesa software device) but I have not gotten it to work despite extensive experimentation and debugging, it always ends up failing in eglChooseConfig to find any configs and hence webgl gets disabled (which is admittedly a safe outcome but not one we want).

The other method we have within easy reach is to set the environment variable LIBGL\_ALWAYS\_SOFTWARE=1, but we need to set that before any threads are created (because setenv is not very thread-safe), which I am not sure is the case when we detect this hardware, detection may need to happen earlier in startup if threads are going at this point. We could just try [comment #43](/show_bug.cgi?id=1843782#c43 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") and hope that setenv doesn't cause a crash. XUL may have a thread-safe wrapper for setenv/getenv however and I am going to be looking for that now (I think I saw one) that I have pivoted to this approach.

I am actively working on a patch for this that I do want to land in firefox 120 (and of course esr115) before the disclosure deadline.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1843782#c59)• 1 year ago |
|  | |

<https://searchfox.org/mozilla-central/source/mozglue/interposers/env_interposer.cpp> appears to be our thread-safe wrappers, so I think I can use setenv reasonably.

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1843782#c60)• 1 year ago |
|  | |

Attached file
[Bug 1843782 - [don't land] Limit max var size to 4k words (16k bytes) on Mesa.](attachment.cgi?id=9363405)
— [Details](attachment.cgi?id=9363405&action=edit)

Don't land this because it changes ANGLE without doing a cherry-pick+vendor.

Probably don't backport this because it has a low likelihood of breaking existing

content.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a10411957_600971)• 1 year ago |

[Attachment #9360544](/attachment.cgi?id=9360544&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Attachment description: Bug 1843782 - disable WebGL on Mesa VM drivers r?#gfx-reviewers → Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1843782#c61)• 1 year ago |
|  | |

Clearing my needinfo: Ashley's [comment 58](/show_bug.cgi?id=1843782#c58 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") while I was on vacation seems to be the update DoHyun was asking for. Realistically we could get this fixed on Beta by the deadline, but Fx 120 may not be realistic (we already have Release Candidate builds in testing). Not sure what the point-release schedule is.

Flags: needinfo?(dveditz)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1843782#c62)• 1 year ago |
|  | |

Per discussion with dveditz, we want to let the software rendering blocklist ride the trains for Fx121 (December 19), it is possible we could pull it into the Fx120 dot release (December 5) after it has been live in Nightly, but it isn't really realistic to uplift this into Fx120 (November 18) and esr115 until it has been tested in Nightly for some time.

The diff at hand alters egl device selection to pick software rendering for WebGL, which doesn't really point to the mechanism you will be disclosing.

What do you think?

Flags: needinfo?(ahale) → needinfo?(dlehgus1023)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1843782#c63)• 1 year ago |
|  | |

Hello ahale,

In that case, we will extend the final disclosure deadline until December 19th.

The patch must be provided within this period.

Flags: needinfo?(dlehgus1023)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a10486676_683497)• 1 year ago |

Whiteboard: [disclosure deadline 2023-11-21] → [disclosure deadline 2023-12-19]

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1843782#c64)• 1 year ago |
|  | |

This is the final extend and no further extensions are possible.

Details about this vulnerability will be disclosure on December 19th.

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1843782#c65)• 1 year ago |
|  | |

Thank you very much. :)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1843782#c66)• 1 year ago |
|  | |

That is very generous, thank you :)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1843782#c67)• 1 year ago |
|  | |

It's evident that Mozilla is meticulously addressing each issue, and developers are putting in significant effort.

Thank you to the Mozilla team for all their hard work!

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1843782#c68)• 1 year ago |
|  | |

Comment on [attachment 9360544](/attachment.cgi?id=9360544 "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") [[details]](/attachment.cgi?id=9360544&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers")

[Bug 1843782](/show_bug.cgi?id=1843782 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not at all easily - the patch blocklists the mesa/vmwgfx driver with a comment citing instability (and we had already blocklisted this driver for WebRender, which makes that even less interesting), nothing points to a shader compiler bug. This should be able to ride the trains for Fx121.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all - driver bug
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Backports should be easy, this code has not changed much in months if not years.
* **How likely is this patch to cause regressions; how much testing does it need?**: As far as I know we do not have automated testing for virtualbox and vmware, so this needs to be tested in Nightly. Manual testing was performed on Ubuntu 23.04 in vmware where it successfully switched WebGL to mesa/llvmpipe software rendering, some prior testing was performed in virtualbox and I can do that again if needed but it is the same driver version with the same bug, testing on a real Ubuntu 23.04 system with AMD graphics worked as normal.
* **Is Android affected?**: No
[Attachment #9360544](/attachment.cgi?id=9360544&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: sec-approval?

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1843782#c69)• 1 year ago |
|  | |

For those interested, I've performed manual testing of my patch on:

* Windows 11 PC:
  + VMWare running Ubuntu 23.04 - behaved as expected, blocklist worked and caused it to use software webgl
  + VirtualBox running Ubuntu 23.04 - tested a previous version of patch, have not tested this latest implementation, however it is the same driver as in VMWare so I expect the same detection and mitigation to work as the crash is entirely in the Mesa driver with no apparent effect on the VM host.
* Linux AMD PC:
  + Ubuntu 23.04 - behaved as expected, full WebGL acceleration as normal

Not tested on NVIDIA proprietary drivers, but I can if needed.

The riskiest part of this patch is the addition of a code path to use EGL\_KHR\_surfaceless\_context + EGL\_KHR\_no\_config\_context in combination, we previously had not been using this combination of extensions but both have existed for around a decade in mesa and nvidia driver stacks, and they exactly serve our need for setting up a WebGL context, this code path is necessary to get the software device to work. If either is missing (which I can't imagine in practice) it retains the old code path. If this code path fails the outcome is WebGL being disabled, which is still a safe failure mode (but not one we want).

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1843782#c70)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16669710 "2 revisions") |
|  | |

On the Mesa side I think the bug is in <https://cgit.freedesktop.org/mesa/mesa/tree/src/gallium/drivers/svga/svga_tgsi_vgpu10.c?id=ccb4ea5a43e89fcc93fff98c881639223f1538e5#n5130> where it isn't asserting that first+count <= VGPU10\_MAX\_TEMPS (which is defined as 4096 in <https://cgit.freedesktop.org/mesa/mesa/tree/src/gallium/drivers/svga/include/VGPU10ShaderTokens.h?id=ccb4ea5a43e89fcc93fff98c881639223f1538e5#n43> ).

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1843782#c71)• 1 year ago |
|  | |

Needinfo ryanvm - once we get sec approval and other reviews sorted, can we expect to get this into Fx121 to meet the disclosure deadline?

Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1843782#c72)• 1 year ago |
|  | |

(In reply to Ashley Hale [:ahale] from [comment #71](/show_bug.cgi?id=1843782#c71 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> Needinfo ryanvm - once we get sec approval and other reviews sorted, can we expect to get this into Fx121 to meet the disclosure deadline?

Shouldn't be an issue.

Flags: needinfo?(ryanvm)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1843782#c73)• 1 year ago |
|  | |

I believe I've resolved all comments on the diff and reviews are green, so I'd like to get this landed in Nightly for a few days and uplift to Beta for Fx121 so it can make it to release.

Flags: needinfo?(dveditz)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1843782#c74)• 1 year ago |
|  | |

Comment on [attachment 9360544](/attachment.cgi?id=9360544 "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") [[details]](/attachment.cgi?id=9360544&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers")

[Bug 1843782](/show_bug.cgi?id=1843782 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers

Approved to land and uplift if desired

[Attachment #9360544](/attachment.cgi?id=9360544&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: sec-approval? → sec-approval+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11165142_406194)• 1 year ago |

See Also: → [1865531](/show_bug.cgi?id=1865531 "RESOLVED DUPLICATE - Firefox WebGL raw_fDrawArraysInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11187143_683497)• 1 year ago |

Blocks: [1866209](/show_bug.cgi?id=1866209 "RESOLVED DUPLICATE - Firefox WebGL DrawArrays Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11187168_683497)• 1 year ago |

Blocks: [1865531](/show_bug.cgi?id=1865531 "RESOLVED DUPLICATE - Firefox WebGL raw_fDrawArraysInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11217587_695136)• 1 year ago |

[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=affected)
[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1843782#c75)• 1 year ago |
|  | |

Hello ahale,

When you're ready, commit this and change it to fixed status!

Flags: needinfo?(ahale)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1843782#c76)• 1 year ago |
|  | |

Ashley, you're free to land this after it gets security approval. I've gone ahead and done so in the interest of getting this baking on Nightly, but please don't hesitate to do so yourself next time. Go ahead and request Beta and ESR115 approval when you get a chance also.

Flags: needinfo?(dveditz)Flags: needinfo?(ahale)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1843782#c77)• 1 year ago |
|  | |

Lando hit conflicts trying to push this to autoland. Please update the patch and re-queue it.

Flags: needinfo?(ahale)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1843782#c78)• 1 year ago |
|  | |

Attached file
[Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](attachment.cgi?id=9365731) (obsolete)
— [Details](attachment.cgi?id=9365731&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D192039>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11598675_600971)• 1 year ago |

[Attachment #9365731](/attachment.cgi?id=9365731&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-beta?

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1843782#c79)• 1 year ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #76](/show_bug.cgi?id=1843782#c76 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> Ashley, you're free to land this after it gets security approval. I've gone ahead and done so in the interest of getting this baking on Nightly, but please don't hesitate to do so yourself next time. Go ahead and request Beta and ESR115 approval when you get a chance also.

I actually did press the button in Lando on Nov 21 (Tuesday), and checked back on it a couple times later in the night and saw no progress, so I was not sure if lando was broken.

Trying again today after I rebased it, and will request uplift.

Flags: needinfo?(ahale)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1843782#c80)• 1 year ago |
|  | |

Pushed by ahale@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/c1e95a42b8d7>
WebGL software rendering when mesa/vmwgfx driver detected r=gfx-reviewers,bradwerth,jrmuizel,jgilbert

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1843782#c81)• 1 year ago |
|  | |

Backed out for webgl failures:

<https://hg.mozilla.org/integration/autoland/rev/408199adade8e9db1d93d2b1d55f27ba4f8072f3>

[Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&selectedTaskRun=ceLKvJ-kTFOy6ibavXua1g.0&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunnable&revision=fd41e77c123e109733f30c89274855bae3b51241)

[Failure log gv-junit](https://treeherder.mozilla.org/logviewer?job_id=437897363&repo=autoland)

[Failure log webgl](https://treeherder.mozilla.org/logviewer?job_id=437897867&repo=autoland)

[Failure log reftest](https://treeherder.mozilla.org/logviewer?job_id=437897375&repo=autoland)

Flags: needinfo?(ahale)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=1843782#c82)• 1 year ago |
|  | |

Hello ahale,

Now that the commit is complete, please change the status to fixed.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=1843782#c83)• 1 year ago |
|  | |

Per our standard practices, the bug will be closed when the patch merges to mozilla-central. There is no need for to ask the developer to do so.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=1843782#c84)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16688262 "1 revision") |
|  | |

I am not entirely sure why context creation with no surface and no config is failing on ANGLE and Android but I will change my new approach to only happen with MOZ\_WIDGET\_GTK and that should clear up the failures.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11688287_600971)• 1 year ago |

[Attachment #9365731](/attachment.cgi?id=9365731&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Attachment is obsolete: true
[Attachment #9365731](/attachment.cgi?id=9365731&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-beta?

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=1843782#c85)• 1 year ago |
|  | |

Pushed by ahale@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/8d11a3a0d707>
WebGL software rendering when mesa/vmwgfx driver detected r=gfx-reviewers,bradwerth,jrmuizel,jgilbert

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=1843782#c86)• 1 year ago |
|  | |

Backout by abutkovits@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/70924ad2b7e3>
Backed out changeset 8d11a3a0d707 for causing failures complaining about RemoteProcessMonitor . CLOSED TREE

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=1843782#c87)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16688496 "1 revision") |
|  | |

Backed out for causing backout for causing failures complaining about RemoteProcessMonitor

[Backout link](https://hg.mozilla.org/integration/autoland/rev/70924ad2b7e37f2b089ee12d766f600a1f7465bf)

[Failure log 1](https://treeherder.mozilla.org/logviewer?job_id=438077712&repo=autoland&lineNumber=2807)

[Failure log 2](https://treeherder.mozilla.org/logviewer?job_id=438078281&repo=autoland&lineNumber=2131)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=1843782#c88)• 1 year ago |
|  | |

I've now refactored the diff heavily to minimize changes to off-target platforms, and have automatic fallbacks for the new code paths, so it should never fail now, I've kicked off a try run in <https://treeherder.mozilla.org/jobs?repo=try&revision=6f0f8be0c6a0c2575d217c84ce7216bf12eb0751> to see if it is landable.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=1843782#c89)• 1 year ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/695a7557e6a1e5869c81b93036e4a80b708bf755>

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=1843782#c90)• 1 year ago |
|  | |

So it has landed and not been backed out this time? :)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=1843782#c91)• 1 year ago |
|  | |

Yes, no backout. There had been issues with pulsebot posting in bugs.

<https://hg.mozilla.org/mozilla-central/rev/695a7557e6a1>

Group: gfx-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 1 year ago
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 122 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=1843782#c92)• 1 year ago |
|  | |

Looks like this is ready for Beta & ESR approval requests?

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=1843782#c93)• 1 year ago |
|  | |

I think we had discussed having the OP test the fix in Nightly before going there. Ashley?

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11853267_419431)• 1 year ago |

Duplicate of this bug: [1866209](/show_bug.cgi?id=1866209 "RESOLVED DUPLICATE - Firefox WebGL DrawArrays Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11853312_419431)• 1 year ago |

Duplicate of this bug: [1865531](/show_bug.cgi?id=1865531 "RESOLVED DUPLICATE - Firefox WebGL raw_fDrawArraysInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux)")

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=1843782#c96)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16691662 "1 revision") |
|  | |

I've downloaded and tested the latest nightly in VMware (which uses this same mesa/vmwgfx driver) and it correctly reports llvmpipe, the poc does not work anymore as far as I can tell, it did work on the stable version of Firefox in the same VM.

Can you confirm this is fixed?

If so I'll proceed to requesting the Beta uplift so that it rides the trains for Firefox 121 and meets the Dec 19 target.

Flags: needinfo?(ahale) → needinfo?(dlehgus1023)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=1843782#c97)• 1 year ago |
|  | |

I also confirmed that this was resolved!

Flags: needinfo?(dlehgus1023)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=1843782#c98)• 1 year ago |
|  | |

The poc did not work in a patched environment.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=1843782#c99)• 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:ahale, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox121` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(ahale)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=1843782#c100)• 1 year ago |
|  | |

Attached file
[Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](attachment.cgi?id=9366501)
— [Details](attachment.cgi?id=9366501&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D192039>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11910102_600971)• 1 year ago |

[Attachment #9366501](/attachment.cgi?id=9366501&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=1843782#c101)• 1 year ago |
|  | |

# Uplift Approval Request

* **Explanation of risk level**: Relatively low because we already blocklisted hardware WebRender when using this driver, so performance is already degraded more broadly
* **Steps to reproduce for manual QE testing**: Run Firefox nightly in a Linux distro, verify it does not crash on startup. To repro the vulnerability open a Ubuntu running in VMware workstation (on any host OS), load the poc from the bug and if the browser crashes the bug is present, if the browser just cycles loading the tab the mitigation is effective.
* **Is Android affected?**: no
* **Code covered by automated testing**: yes
* **Risk associated with taking this patch**: Performance is noticeably degraded in VMware and VirtualBox guest VMs when viewing WebGL content (e.g. Google Maps)
* **String changes made/needed**: N/A?
* **Needs manual QE test**: no
* **User impact if declined**: Vulnerability in WebGL could be exploited, possibly leading to sandbox escape from guest vm to host machine in VMware and/or VirtualBox
* **Fix verified in Nightly**: yes

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=1843782#c102)• 1 year ago |
|  | |

Attached file
[Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](attachment.cgi?id=9366633)
— [Details](attachment.cgi?id=9366633&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D192039>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11954579_600971)• 1 year ago |

[Attachment #9366633](/attachment.cgi?id=9366633&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=1843782#c103)• 1 year ago |
|  | |

# Uplift Approval Request

* **Risk associated with taking this patch**: Performance is noticeably degraded in VMware and VirtualBox guest VMs when viewing WebGL content (e.g. Google Maps)
* **Needs manual QE test**: no
* **String changes made/needed**: N/A?
* **User impact if declined**: Vulnerability in WebGL could be exploited, possibly leading to sandbox escape from guest vm to host machine in VMware and/or VirtualBox
* **Fix verified in Nightly**: yes
* **Steps to reproduce for manual QE testing**: Run Firefox nightly in a Linux distro such as Ubuntu running in VMware workstation (on any host OS), load the poc from the bug and if the browser crashes the bug is present, if the browser just cycles loading the tab the mitigation is effective.
* **Explanation of risk level**: Relatively low because we already blocklisted hardware WebRender when using this driver, so performance is already degraded more broadly
* **Is Android affected?**: no
* **Code covered by automated testing**: yes

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a11975578_683497)• 1 year ago |

Summary: Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Vulnerability (Mesa VM driver / Linux) → Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=1843782#c104)• 1 year ago |
|  | |

Comment on [attachment 9366501](/attachment.cgi?id=9366501 "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") [[details]](/attachment.cgi?id=9366501&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers")

[Bug 1843782](/show_bug.cgi?id=1843782 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers

Approved for 121.0b7.

Flags: needinfo?(ahale)
[Attachment #9366501](/attachment.cgi?id=9366501&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=1843782#c105)• 1 year ago |
|  | |

Comment on [attachment 9366633](/attachment.cgi?id=9366633 "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") [[details]](/attachment.cgi?id=9366633&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers")

[Bug 1843782](/show_bug.cgi?id=1843782 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers

Approved for 115.6esr.

[Attachment #9366633](/attachment.cgi?id=9366633&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12002177_640478)• 1 year ago |

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=1843782#c106)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/804fcc8f051c>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12144837_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12144852_488993)• 1 year ago |

Flags: qe-verify- → qe-verify+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12258635_553429)• 1 year ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][qa-triaged]

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=1843782#c107)• 1 year ago |
|  | |

Hello dveditz,

Can I get a bounty for this report?

Flags: needinfo?(dveditz)

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=1843782#c108)• 1 year ago |
|  | |

Attached file
[Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers](attachment.cgi?id=9367185) (obsolete)
— [Details](attachment.cgi?id=9367185&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D192039>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12296197_600971)• 1 year ago |

[Attachment #9367185](/attachment.cgi?id=9367185&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 109](/show_bug.cgi?id=1843782#c109)• 1 year ago |
|  | |

# Uplift Approval Request

* **Code covered by automated testing**: yes
* **Explanation of risk level**: Relatively low because we already blocklisted hardware WebRender when using this driver, so performance is already degraded more broadly
* **User impact if declined**: Vulnerability in WebGL could be exploited, possibly leading to sandbox escape from guest vm to host machine in VMware and/or VirtualBox
* **Needs manual QE test**: no
* **Risk associated with taking this patch**: Performance is noticeably degraded in VMware and VirtualBox guest VMs when viewing WebGL content (e.g. Google Maps)
* **Steps to reproduce for manual QE testing**: Run Firefox nightly in a Linux distro, verify it does not crash on startup. To repro the vulnerability open a Ubuntu running in VMware workstation (on any host OS), load the poc from the bug and if the browser crashes the bug is present, if the browser just cycles loading the tab the mitigation is effective.
* **Fix verified in Nightly**: yes
* **String changes made/needed**: N/A?
* **Is Android affected?**: no

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 110](/show_bug.cgi?id=1843782#c110)• 1 year ago |
|  | |

# Uplift Approval Request

* **Needs manual QE test**: no
* **User impact if declined**: Vulnerability in WebGL could be exploited, possibly leading to sandbox escape from guest vm to host machine in VMware and/or VirtualBox
* **Risk associated with taking this patch**: Performance is noticeably degraded in VMware and VirtualBox guest VMs when viewing WebGL content (e.g. Google Maps)
* **Code covered by automated testing**: yes
* **Explanation of risk level**: Relatively low because we already blocklisted hardware WebRender when using this driver, so performance is already degraded more broadly
* **Is Android affected?**: no
* **String changes made/needed**: N/A?
* **Steps to reproduce for manual QE testing**: Run Firefox nightly in a Linux distro, verify it does not crash on startup. To repro the vulnerability open a Ubuntu running in VMware workstation (on any host OS), load the poc from the bug and if the browser crashes the bug is present, if the browser just cycles loading the tab the mitigation is effective.
* **Fix verified in Nightly**: yes

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12299075_600971)• 1 year ago |

[Attachment #9367185](/attachment.cgi?id=9367185&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Attachment is obsolete: true
[Attachment #9367185](/attachment.cgi?id=9367185&action=edit "Bug 1843782 - WebGL software rendering when mesa/vmwgfx driver detected r?#gfx-reviewers") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115-

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 111](/show_bug.cgi?id=1843782#c111)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/76b0caa7a62d>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12299192_640478)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 112](/show_bug.cgi?id=1843782#c112)• 1 year ago |
|  | |

(In reply to DoHyun Lee [:l33d0hyun] from [comment #107](/show_bug.cgi?id=1843782#c107 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> Can I get a bounty for this report?

The bug is properly flagged for consideration by the bounty team, and now that it is resolved it's in the queue. I could point to the bounty decisions on bugs that look similar, but I can't answer your question as an individual before the team meets and makes that decision.

Flags: needinfo?(dveditz)

|  | [Anca Soncutean, Desktop QA](/user_profile?user_id=606068) |  |
| --- | --- | --- |
| [Comment 113](/show_bug.cgi?id=1843782#c113)• 1 year ago |
|  | |

I've reproduced this "heap-buffer-overflow" crash signature on startup with Fx 119.0a1 (2023-09-19) in VirtualBox by running Ubuntu 23.04, using Mesa 23.0.4 and "Accelerate 3D graphics" enabled.

No crash on my end with Fx 122.0a1 (2023-12-07), Fx 121.0b7 and 115.6.0esr.

Status: RESOLVED → VERIFIED
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=verified)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=verified)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12778146_586683)• 1 year ago |

Whiteboard: [disclosure deadline 2023-12-19] → [disclosure deadline 2023-12-19][adv-main121+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a12779723_586683)• 1 year ago |

Whiteboard: [disclosure deadline 2023-12-19][adv-main121+] → [disclosure deadline 2023-12-19][adv-main121+][adv-esr115.6+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 114](/show_bug.cgi?id=1843782#c114)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367978) (obsolete)
— [Details](attachment.cgi?id=9367978&action=edit)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 115](/show_bug.cgi?id=1843782#c115)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9368016) (obsolete)
— [Details](attachment.cgi?id=9368016&action=edit)

[Attachment #9367978](/attachment.cgi?id=9367978&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 116](/show_bug.cgi?id=1843782#c116)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9368017)
— [Details](attachment.cgi?id=9368017&action=edit)

[Attachment #9368016](/attachment.cgi?id=9368016&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a13136561_578488)• 1 year ago |

Alias: CVE-2023-6856

|  | [Yannis Juglaret [:yannis]](/user_profile?user_id=712696) |  |
| --- | --- | --- |
| [Comment 117](/show_bug.cgi?id=1843782#c117)• 1 year ago |
|  | |

Just curious: I have found consistent STR for [bug 1855686](/show_bug.cgi?id=1855686 "RESOLVED FIXED - Crash in [@ tc_draw_vbo]") (where the crash stack also involves `DrawElementsInstanced`) on my work machine running Ubuntu 22.04. These STR lead to a crash in Firefox 120.0.1, but not in Nightly. Running mozregression suggests that it is the patch from [comment 89](/show_bug.cgi?id=1843782#c89 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)") that fixed this crash for me. However I am not running in a VM, so is it expected that this patch can affect my setup?

Flags: needinfo?(ahale)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 118](/show_bug.cgi?id=1843782#c118)• 1 year ago |
|  | |

This is very interesting. Does this vulnerability also occur on systems using the Mesa driver? This issue can occur if the Mesa driver is used on the host as well as the VM.

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 119](/show_bug.cgi?id=1843782#c119)• 1 year ago |
|  | |

The patch for this bug disables the Mesa Driver. This may have alleviated bugs for all similar cases involved.

|  | [Yannis Juglaret [:yannis]](/user_profile?user_id=712696) |  |
| --- | --- | --- |
| [Comment 120](/show_bug.cgi?id=1843782#c120)• 1 year ago |
|  | |

Attached file
[about:support from 120.0.1 (version with crash)](attachment.cgi?id=9369270)
— [Details](attachment.cgi?id=9369270&action=edit)

This is my `about:support` in Firefox 120.0.1 on the machine where I can reproduce the crash from [bug 1855686](/show_bug.cgi?id=1855686 "RESOLVED FIXED - Crash in [@ tc_draw_vbo]"). Reproducing the crash from [bug 1855686](/show_bug.cgi?id=1855686 "RESOLVED FIXED - Crash in [@ tc_draw_vbo]") in 120.0.1 ASAN crashes in the same way as non-ASAN (null pointer deref, same call stack). Running `poc.html` in 120.0.1 ASAN does not crash Firefox on this machine.

STR for reproducing the crash from [bug 1855686](/show_bug.cgi?id=1855686 "RESOLVED FIXED - Crash in [@ tc_draw_vbo]") (Ubuntu 22.04, also crashes with up-to-date mesa custom build):

* Open [skisporet.no](https://www.skisporet.no/map).
* Maximize the window.
* Zoom into Sauda area little by little (one scroll event per second).
* By the time you can see multiple ski stations, you should notice weird glitches. If you wait a bit, the browser should crash.

I have also had [an instance](https://crash-stats.mozilla.org/report/index/eb71ddd2-19eb-42ff-b596-a75fe0231218) of the crash from [bug 1855688](/show_bug.cgi?id=1855688 "NEW - Crash in [@ _mesa_buffer_sub_data]") with exactly the same STR.

|  | [Yannis Juglaret [:yannis]](/user_profile?user_id=712696) |  |
| --- | --- | --- |
| [Comment 121](/show_bug.cgi?id=1843782#c121)• 1 year ago |
|  | |

Attached file
[about:support for 121.0 (no crash, with patch)](attachment.cgi?id=9369272)
— [Details](attachment.cgi?id=9369272&action=edit)

This is my `about:support` in 121.0rc1 which does not reproduce any crash when following the STR.

|  | [Yannis Juglaret [:yannis]](/user_profile?user_id=712696) |  |
| --- | --- | --- |
| [Comment 122](/show_bug.cgi?id=1843782#c122)• 1 year ago |
|  | |

See [bug 1855686 comment 1](/show_bug.cgi?id=1855686#c1 "RESOLVED FIXED - Crash in [@ tc_draw_vbo]") for more details about that crash. I did not include the STR there for the moment in case there is a link to this sec bug.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747) |  |
| --- | --- | --- |
| [Comment 123](/show_bug.cgi?id=1843782#c123)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1843782&comment_id=16718722 "1 revision") |
|  | |

It might be worth evaluating the effect that [bug 1862039](/show_bug.cgi?id=1862039 "RESOLVED FIXED - Consider not using GL_CONTEXT_FLAG_NO_ERROR_BIT to avoid crashes in Mesa") had on this. I've encountered several crashes over the past few months that were caused by lack of validation on Mesa's side because we were setting `GL_CONTEXT_FLAG_NO_ERROR_BIT`. Most of those crashes were NULL pointer accesses because we lost a particular element when the GL context was gone, but some were definitely out-of-bounds type of accesses (such as accessing a mip-map level that had disappeared). I'll try and dig out the corresponding crashes, anyway the fix for [bug 1862039](/show_bug.cgi?id=1862039 "RESOLVED FIXED - Consider not using GL_CONTEXT_FLAG_NO_ERROR_BIT to avoid crashes in Mesa") should have put an end to all of them, losing the GL shouldn't cause us to break invariants Mesa expects and it might thus be worth uplifting.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 124](/show_bug.cgi?id=1843782#c124)• 1 year ago |
|  | |

I just tried with my mitigations disabled and the poc still works, so [bug 1862039](/show_bug.cgi?id=1862039 "RESOLVED FIXED - Consider not using GL_CONTEXT_FLAG_NO_ERROR_BIT to avoid crashes in Mesa") did not prevent this - Mesa may not have an actual error check for number of shader temp variables, whereas Firefox does (ANGLE shader validation) but isn't set to the correct threshold to prevent this bug on this driver, and Mesa would be the better place to prevent that.

How do you think we should proceed with uplift of [bug 1862039](/show_bug.cgi?id=1862039 "RESOLVED FIXED - Consider not using GL_CONTEXT_FLAG_NO_ERROR_BIT to avoid crashes in Mesa")?

Flags: needinfo?(ahale) → needinfo?(gsvelto)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747) |  |
| --- | --- | --- |
| [Comment 125](/show_bug.cgi?id=1843782#c125)• 1 year ago |
|  | |

I think uplifting it doesn't hurt, we've hit issues related to it more than once and it's going to benefit users.

Flags: needinfo?(gsvelto)

|  | [D4ni31 [:d4ni31]](/user_profile?user_id=683497)  Reporter |  |
| --- | --- | --- |
| [Comment 126](/show_bug.cgi?id=1843782#c126)• 1 year ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

Hello dveditz,

When will the bounty decision for this report be completed?

Happy New Year :-)

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 127](/show_bug.cgi?id=1843782#c127)• 1 year ago |
| offtopic | |

| Comment hidden (offtopic) |  |
| --- | --- |

The bounty team meets weekly, but we've missed about 3 due to the holidays

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a15301151_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747) |  |
| --- | --- | --- |
| [Comment 128](/show_bug.cgi?id=1843782#c128)• 1 year ago |
|  | |

(In reply to Ashley Hale [:ahale] from [comment #30](/show_bug.cgi?id=1843782#c30 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> I'm still spending a fair amount of time in gdb trying to figure out how we select an EGL device and how we could pick a software one deliberately on this configuration (alternative approaches exist, like setting the LIBGL\_ALWAYS\_SOFTWARE=1 environment variable when this driver is detected, but it feels like that would be hacky and possibly not thread safe).

I had missed this comment: note that since [bug 1752703](/show_bug.cgi?id=1752703 "RESOLVED FIXED - Crash in [@ __GI_getenv]") landed calling `setenv()` (or any other environment manipulation functions) is thread-safe.

|  | [Ashley Hale [:ahale]](/user_profile?user_id=706885)  Assignee |  |
| --- | --- | --- |
| [Comment 129](/show_bug.cgi?id=1843782#c129)• 1 year ago |
|  | |

(In reply to Gabriele Svelto [:gsvelto] from [comment #128](/show_bug.cgi?id=1843782#c128 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> (In reply to Ashley Hale [:ahale] from [comment #30](/show_bug.cgi?id=1843782#c30 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))
>
> > I'm still spending a fair amount of time in gdb trying to figure out how we select an EGL device and how we could pick a software one deliberately on this configuration (alternative approaches exist, like setting the LIBGL\_ALWAYS\_SOFTWARE=1 environment variable when this driver is detected, but it feels like that would be hacky and possibly not thread safe).
>
> I had missed this comment: note that since [bug 1752703](/show_bug.cgi?id=1752703 "RESOLVED FIXED - Crash in [@ __GI_getenv]") landed calling `setenv()` (or any other environment manipulation functions) is thread-safe.

Good to know! I saw the code for this when I was investigating the possibility of using setenv, but I wasn't sure of the dynamic library overload order and where to look at to confirm - the getenv is in Mesa, so if they don't get our threadsafe env functions then it's still not thread safe, which I didn't articulate in describing it in the comment.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747) |  |
| --- | --- | --- |
| [Comment 130](/show_bug.cgi?id=1843782#c130)• 1 year ago |
|  | |

(In reply to Ashley Hale [:ahale] from [comment #129](/show_bug.cgi?id=1843782#c129 "VERIFIED FIXED - Firefox WebGL DrawElementsInstanced Heap-Buffer-Overflow Possibly leading to Sandbox Escape Vulnerability (Mesa VM driver / Linux)"))

> the getenv is in Mesa, so if they don't get our threadsafe env functions then it's still not thread safe, which I didn't articulate in describing it in the comment.

We inject the interposers before libc, so Mesa gets to use our functions instead of libc's. The motivation behind this was to fix the races between Firefox' setenv()s and Mesa's getenv()s which were causing frequent crashes.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 131](/show_bug.cgi?id=1843782#c131)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a27563931_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1843782#a36630883_419431)• 4 months ago |

See Also: → [1912404](/show_bug.cgi?id=1912404 "RESOLVED FIXED - bevyengine.org - The animation is not displayed")
You need to [log in](/show_bug.cgi?id=1843782&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [D4ni31 [:d4ni31]](/user_profile?user_id=683497)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.debian.org_91aad87a_20250114_183627.html ===


---

[[Date Prev](msg00019.html)][[Date Next](msg00021.html)]
[[Thread Prev](msg00019.html)][[Thread Next](msg00021.html)]
[[Date Index](maillist.html#00020)]
[[Thread Index](threads.html#00020)]

# [SECURITY] [DLA 3697-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3697-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 29 Dec 2023 11:08:44 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20231229100844.B99042A00FB%40andromeda) [20231229100844.B99042A00FB@andromeda](msg00020.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3697-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.6.0esr-1~deb10u1
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6863
                 CVE-2023-6864 CVE-2023-6865 CVE-2023-6867

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, sandbox escape or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.6.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWOmqoACgkQnUbEiOQ2
gwKefhAAoZQBSJoZAdBQQsntXnHOjR09PpxPBhtc+Rl8OkjDlYrCUXiXBTtdvPit
+q1XLz5W2yxGptoqI8iMzkk4y9MpX6c6ncTSVLkDwBA9t91P+omKnC8IPUwsFRyT
4L7dncZsm0vuiJwHJWCigpSreEt1zlQhSULgj0g4h/bRAwDMz5zQ/qFmPe2ocLfn
0Lx+8xpcd/n+/jTI1lqAy62lAqIhKLzhotWrrmBV8V1jLLscjTAX5uhJc6yaHhfW
01kvZpY4X+YSpqYoCWlZP2LXnG4JGRpQk4kX3Xt8F3wZVqA+t8yquyK/PloEqdVO
emChkZTPzzfOhR1CgdVi3P4VAw8xaq9CiHAr5xhhEyHDtW5AIAxNN9676B9P6cAg
5XVfQ2Yb4tMboG7y4ojxKXSAUEsOT55RVtAHK6iGyjUX0C4qPltJErJrno255ErT
GtleR8pqXWr72lZWioul9BI3EB5EJw8JCw7WL7/ixUBZGwcrJj9hR5G0/dPSUDbe
KajpGYN1LrMf2ZpLE5pF5IDD+63zQBqzk+iQa/ghmrkXCW9B0Q2yYBFpmZc7Wt5W
LCoKQzSME0ft1uRL9ZooWtH19mV+SSmu++nb0lGkdQDdLG1qt/ZPh4Brz+9jXJ6E
f65JpUC3tUopHTNxJAn4R2Adl422xt7rplwOlc/UMM30+rGnkz8=
=1jYk
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_f22f7fdc_20250114_183628.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-54

## Security Vulnerabilities fixed in Firefox ESR 115.6

Announced
December 19, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.6

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6862: Use-after-free in nsDNSService](#CVE-2023-6862)

Reporter
Randell Jesup
Impact
moderate
##### Description

A use-after-free was identified in the `nsDNSService::Init`. This issue appears to manifest rarely during start-up.

##### References

* [Bug 1868042](https://bugzilla.mozilla.org/show_bug.cgi?id=1868042)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Karl Tomlinson, Valentin Gosu, Randell Jesup, Yury Delendik, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862089%2C1862777%2C1864015)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_395a26ad_20250114_183628.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-55

## Security Vulnerabilities fixed in Thunderbird 115.6

Announced
December 19, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.6

#### [#CVE-2023-50762: Truncated signed text was shown with a valid OpenPGP signature](#CVE-2023-50762)

Reporter
Marcus Brinkmann
Impact
high
##### Description

When processing a PGP/MIME payload that contains digitally signed text, the first paragraph of the text was never shown to the user. This is because the text was interpreted as a MIME message and the first paragraph was always treated as an email header section. A digitally signed text from a different context, such as a signed GIT commit, could be used to spoof an email message.

##### References

* [Bug 1862625](https://bugzilla.mozilla.org/show_bug.cgi?id=1862625)

#### [#CVE-2023-50761: S/MIME signature accepted despite mismatching message date](#CVE-2023-50761)

Reporter
Marcus Brinkmann
Impact
high
##### Description

The signature of a digitally signed S/MIME email message may optionally specify the signature creation date and time. If present, Thunderbird did not compare the signature creation date with the message date and time, and displayed a valid signature despite a date or time mismatch. This could be used to give recipients the impression that a message was sent at a different date or time.

##### References

* [Bug 1865647](https://bugzilla.mozilla.org/show_bug.cgi?id=1865647)

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Thunderbird on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Thunderbird was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6862: Use-after-free in nsDNSService](#CVE-2023-6862)

Reporter
Randell Jesup
Impact
moderate
##### Description

A use-after-free was identified in the `nsDNSService::Init`. This issue appears to manifest rarely during start-up.

##### References

* [Bug 1868042](https://bugzilla.mozilla.org/show_bug.cgi?id=1868042)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Karl Tomlinson, Valentin Gosu, Randell Jesup, Yury Delendik, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862089%2C1862777%2C1864015)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.debian.org_9c451470_20250114_183628.html ===


---

[[Date Prev](msg00277.html)][[Date Next](msg00279.html)]
[[Thread Prev](msg00277.html)][[Thread Next](msg00279.html)]
[[Date Index](maillist.html#00278)]
[[Thread Index](threads.html#00278)]

# [SECURITY] [DSA 5581-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5581-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 20 Dec 2023 19:23:51 +0000
* *Message-id*: <ZYM/R0NEjTJhvwBy@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5581-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 20, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6863
                 CVE-2023-6864 CVE-2023-6865 CVE-2023-6867

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, sandbox escape or clickjacking.

For the oldstable distribution (bullseye), these problems have been fixed
in version 115.6.0esr-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 115.6.0esr-1~deb12u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmWDPxAACgkQEMKTtsN8
TjYfeRAAql+aZ6PpAM1Fq4Cp1IlvDQc8BYNuKrjn9/4xYgq/bAnQyRGj1I0viHP2
dUdZl6CcndqE6NVgm1mYpCQ/TZJpwSSxnoXf46bB/lGNg17Cw7T8gWI5uUSs1K63
UOYNMr8HlCF35qZpU0+TrsL+q3qRdkOQOxRLSFHNhxuUQ+44pUJYKDVg6vKjHU91
oQEfjzmcgn2Z+tL/zyrt4s57XUGpZNm6Vmg/TUftXL5+CDodCNPRnIw0JBYWu2yf
J3tj6cuCw6jDAcAouAsDcd8CbK28Bf6h2zUossRGVjSfNWeoshK2qe9L3/wlQB62
s0wrJ1MimP9k1y9xS4Iy85vf2BDDnVQBNgMR8mKnwt63Jhngpx8JW8oTbBKzx1oi
EZkShw3CDWuCx7ooMnR8glwybPJqXMyZbt8H7dMO3IFEwD2dfNzVfwyEUq4JAOzC
PasLEwCekXrTTxeZoYdTW4y8c5c4GEd9nvO8Hdk9iV/zbD1uhpgy0g6oQXciAzSH
6Rm92u2+HPwNOFjZAJMOi9eyqtdj9PqwHZ1uraXhtqCz8peD/Sg+YZCAXt0lLyVM
+WbQqJOyH5n1POeEHbEikv1iMLXRw+Vkkbzr3u9laTdQ9Yn1b/ZfVblG6/N+hhlL
LXYBXyYfrU4L6DMTnUave299Cq1fb8RPWVefcqAv6DoQX0P1GHc=
=8/zE
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_49d17580_20250114_183629.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-56

## Security Vulnerabilities fixed in Firefox 121

Announced
December 19, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 121

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6135: NSS susceptible to "Minerva" attack](#CVE-2023-6135)

Reporter
George Pantela (Red Hat) and Hubert Kario (Red Hat)
Impact
high
##### Description

Multiple NSS NIST curves were susceptible to a side-channel attack known as "Minerva". This attack could potentially allow an attacker to recover the private key.

##### References

* [Bug 1853908](https://bugzilla.mozilla.org/show_bug.cgi?id=1853908)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6866: TypedArrays lack sufficient exception handling](#CVE-2023-6866)

Reporter
Tom Schuster
Impact
moderate
##### Description

TypedArrays can be fallible and lacked proper exception handling. This could lead to abuse in other APIs which expect TypedArrays to always succeed.

##### References

* [Bug 1849037](https://bugzilla.mozilla.org/show_bug.cgi?id=1849037)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6868: WebPush requests on Firefox for Android did not require VAPID key](#CVE-2023-6868)

Reporter
John-Mark Gurney
Impact
moderate
##### Description

In some instances, the user-agent would allow push requests which lacked a valid VAPID even though the push manager subscription defined one. This could allow empty messages to be sent from unauthorized parties.
*This bug only affects Firefox on Android.*

##### References

* [Bug 1865488](https://bugzilla.mozilla.org/show_bug.cgi?id=1865488)

#### [#CVE-2023-6869: Content can paint outside of sandboxed iframe](#CVE-2023-6869)

Reporter
Oriol Brufau
Impact
low
##### Description

A `<dialog>` element could have been manipulated to paint content outside of a sandboxed iframe. This could allow untrusted content to display under the guise of trusted content.

##### References

* [Bug 1799036](https://bugzilla.mozilla.org/show_bug.cgi?id=1799036)

#### [#CVE-2023-6870: Android Toast notifications may obscure fullscreen event notifications](#CVE-2023-6870)

Reporter
Hafiizh
Impact
low
##### Description

Applications which spawn a Toast notification in a background thread may have obscured fullscreen notifications displayed by Firefox.
*This issue only affects Android versions of Firefox and Firefox Focus.*

##### References

* [Bug 1823316](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316)

#### [#CVE-2023-6871: Lack of protocol handler warning in some instances](#CVE-2023-6871)

Reporter
Edward "JankhJankh" Prior
Impact
low
##### Description

Under certain conditions, Firefox did not display a warning when a user attempted to navigate to a new protocol handler.

##### References

* [Bug 1828334](https://bugzilla.mozilla.org/show_bug.cgi?id=1828334)

#### [#CVE-2023-6872: Browsing history leaked to syslogs via GNOME](#CVE-2023-6872)

Reporter
honorton via Tor Browser
Impact
low
##### Description

Browser tab titles were being leaked by GNOME to system logs. This could potentially expose the browsing habits of users running in a private tab.

##### References

* [Bug 1849186](https://bugzilla.mozilla.org/show_bug.cgi?id=1849186)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Randell Jesup, Valentin Gosu, Karl Tomlinson, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862777%2C1864015)

#### [#CVE-2023-6873: Memory safety bugs fixed in Firefox 121](#CVE-2023-6873)

Reporter
Andrew McCreight, Yury Delendik
Impact
high
##### Description

Memory safety bugs present in Firefox 120. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855327%2C1862089%2C1862723)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_897e22ca_20250114_183627.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_b46871c9_20250114_183628.html ===


---

[[Date Prev](msg00278.html)][[Date Next](msg00280.html)]
[[Thread Prev](msg00278.html)][[Thread Next](msg00280.html)]
[[Date Index](maillist.html#00279)]
[[Thread Index](threads.html#00279)]

# [SECURITY] [DSA 5582-1] thunderbird security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5582-1] thunderbird security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 21 Dec 2023 19:33:01 +0000
* *Message-id*: <[[🔎]](/msgid-search/ZYSS7fpGzNyfLUqM%40seger.debian.org) [ZYSS7fpGzNyfLUqM@seger.debian.org](msg00279.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5582-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
December 21, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : thunderbird
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6864
                 CVE-2023-6873 CVE-2023-50761 CVE-2023-50762

Multiple security issues were discovered in Thunderbird, which could
result in denial of service, the execution of arbitrary code or spoofing
of signed PGP/MIME and SMIME emails.

For the oldstable distribution (bullseye), these problems have been fixed
in version 1:115.6.0-1~deb11u1.

For the stable distribution (bookworm), these problems have been fixed in
version 1:115.6.0-1~deb12u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmWEkCEACgkQEMKTtsN8
TjYB8xAAiSFGWOK6s+7YGuc28bu4EEUHG2sUXJ9g43AD9DftxhVlz1fh2GbyXxpL
Dyoq3rrZU3n8bVQTWLcfRcdLYOZlMNEaxN8K89lGRfh+864anLQIGGII3gsCC8qS
3Wx96W9Ydh4++iM55Yopc9SNAFKUKXONYU8dxolSYsDAwkhw4iU97TjURsImOTzm
npyAIvVbG7Uf3HEnyb98KRr8OgbzdkJpg/JFKj5NLxX8QJ1kKpV9/8uYKRxdehNh
ljlYXt2j5fqaL1jXXcOMkEuMgXjUl5Hq2dh6owEPkfHDRMMLLypsuCXDz+i4mAyY
QGgrdNYshf876OT4cmf2O3d/lXExWdcALWGRd3/tLSB7KIoRUtit/+OZT6/jVvSj
r4g4vfQvQHC7JlvUmrglmKrHQ3J4b0TEeMN3GIrUadMFSVG2C8pfS23e91AtF6Jy
eg00ZvP8/voUiHWymJTgJesDxHsHK1ZRMqulaIHwNuS+DieOW2mqNmb/exuJ4v35
XwIFCrMBzmOkxDrfdiSLciXA2+qcdKW7QM+hK2hEzZBaw31OHgHTPZwzd2sMx9UD
rKaejR/xKIMRgscqQcdISdsQTCmbFO98/iyiUXUF+j+itvdqrnaAn8ZEMtPj1dm5
4YzDuuZrWDrQ/IYxUz66x7NzQFAZKJc41toPY3u5aIx+lXOQZyA=
=DbG4
-----END PGP SIGNATURE-----

```

---



=== Content from lists.debian.org_1e922315_20250114_183627.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 3698-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3698-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 29 Dec 2023 11:11:37 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20231229101137.2CD1F2A00FB%40andromeda) [20231229101137.2CD1F2A00FB@andromeda](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3698-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
December 29, 2023                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.6.0-1~deb10u1
CVE ID         : CVE-2023-6856 CVE-2023-6857 CVE-2023-6858 CVE-2023-6859
                 CVE-2023-6860 CVE-2023-6861 CVE-2023-6862 CVE-2023-6864
                 CVE-2023-6873 CVE-2023-50761 CVE-2023-50762

Multiple security issues were discovered in Thunderbird, which could
result in denial of service, the execution of arbitrary code or spoofing
of signed PGP/MIME and SMIME emails.

For Debian 10 buster, these problems have been fixed in version
1:115.6.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWOm1kACgkQnUbEiOQ2
gwIMSQ//akgeGKZJRMxhWlIhr6l4QGytlZACPYzs6iCuxU9o8AP5tI3suobFfk3d
ZSIWTj3l9bORw1Zfwr/gRQMXnk8oNPLHblqyKaHozoqoKjuCQW89pclXbDZVml3N
OAofqzbAtFlSB9r0pSq7Edn9FH90iFnE4CHeJoRLbq1Qr1Ee2nzk/UoiaPSlymrp
3pKlSzlmSRmDGFUWZIkTdwLsg8j0YSlMrTRqlkbldlbXxJxxknXL5TO9A6YRPt1B
d5wndr1hYVPmWJ0PGcuk7dSDfvOktBhvdKa/KdUpSaaPFsN7xPzGtRBtHwcvtK3f
G+747I3xD8g2dKYpOWkZlm9KiQZ0AwsapJsfLFc5QpWD25aTryUpOzqRiXkLTDQR
Wob1GWUrrTaVNbeVkrwhvKHSQl6QPI3BoTn3Ejx6qHJjf69RG6255/ZqJsJO0JPa
awf9dZPymdfl0MlfzSrkRls2qXj0L0bTxbtIXRkY5aHxfOVy6hPp1h23fX1GE8KU
4bwmrKLEexoqFHbFfjDuHj6Wdu2UdZQ8uibV2cHh1Hxrur0DlkPGrdItCtxqRMHO
NZ57IbH87PpNzz+iMnK0MUBck5aX7PcCnyIDzTqodT968al2BLJ60IuPr4zvjPmp
dXIWEjTKFv+CC1xvudbJ4wENmTStMRACyiLpyBT2cBUhwJhB8cE=
=9fdH
-----END PGP SIGNATURE-----

```

---


