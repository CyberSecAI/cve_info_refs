- **Root cause of vulnerability:** The vulnerability stems from the lack of proper sanitization of user-supplied input within the `name` parameter when creating an IPsec policy via the web interface. This unsanitized input is directly passed to a shell command, leading to command injection.
- **Weaknesses/vulnerabilities present:** OS Command Injection (CWE-78). The application fails to neutralize special elements used in an OS command.
- **Impact of exploitation:** An attacker can execute arbitrary commands on the device with root privileges. This could lead to full control of the router, data exfiltration, or other malicious activities.
- **Attack vectors:** An attacker needs to make an authenticated HTTP POST request to the `/cgi-bin/luci/;stok=<token>/admin/ipsec?form=conn` endpoint with a specially crafted `name` parameter in the request body.
- **Required attacker capabilities/position:** The attacker needs administrative access to the device's web interface to exploit the vulnerability, which includes a valid session token (e.g. `sysauth` cookie).