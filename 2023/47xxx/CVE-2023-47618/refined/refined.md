- **Root cause of vulnerability:** The `uhttpd` service, which manages the web interface of the TP-Link ER7206 Omada Gigabit VPN Router, uses an unsanitized user-controlled input (`time` parameter) within a shell command when creating web filtering policies. This allows for command injection.
- **Weaknesses/vulnerabilities present:**
    - OS Command Injection (CWE-78): The application fails to properly neutralize special elements used in an OS command.
    - Lack of input sanitization: The `time` parameter is directly used in shell commands without sanitization.
- **Impact of exploitation:** An attacker can execute arbitrary OS commands on the router with root privileges. This would lead to complete compromise of the device.
- **Attack vectors:**
    - The vulnerability is triggered by sending a crafted HTTP POST request to the `/cgi-bin/luci/;stok=.../admin/webfilter?form=webfilter_list` endpoint.
    - The vulnerable parameter is the `time` parameter in the request body
- **Required attacker capabilities/position:**
    - The attacker needs to be authenticated as an administrator to trigger the vulnerability.
    - The attacker needs to be able to send HTTP requests to the device's web interface (port 80/443).