```text
 Guidelines:
1. First verify if the content relates to the CVE specified based on the official description
2. If the content does not relate to this CVE, respond with "UNRELATED"
3. If no useful vulnerability information is found, respond with "NOINFO" 
4. For relevant content, extract:
   - Root cause of vulnerability
   - Weaknesses/vulnerabilities present
   - Impact of exploitation
   - Attack vectors
   - Required attacker capabilities/position

Additional instructions:
- Preserve original technical details and descriptions
- Remove unrelated content
- Translate non-English content to English
- Note if the content provides more detail than the official CVE description

```
## Content from github.com_4477fbe6_20250115_192644.html

```text
## Description

### Summary

When a request is sent to Traefik with a URL fragment, Traefik automatically URL encodes and forwards the fragment to the backend server. This violates the RFC because in the origin-form the URL should only contain the absolute path and the query.

When this is combined with another frontend proxy like Nginx, it can be used to bypass frontend proxy URI-based access control

restrictions.

### Details

For example, we have this Nginx configuration:

```
location /admin {
     deny all;
     return 403;
}

```

This can be bypassed when the attacker is requesting to /#/../admin

This won’t be vulnerable if the backend server follows the RFC and ignores any characters after the fragment.

However, if Nginx is chained with another reverse proxy which automatically URL encode the character # (Traefik) the URL will become

/%23/../admin

And allow the attacker to completely bypass the Access Restriction from the Nginx Front-End proxy.

Here is a diagram to summarize the attack:

[![image](https://user-images.githubusercontent.com/47447167/278849578-34ca0546-99b4-44c8-8fc8-8e799c1f5069.png)](https://user-images.githubusercontent.com/47447167/278849578-34ca0546-99b4-44c8-8fc8-8e799c1f5069.png)

### PoC

[![image (1)](https://user-images.githubusercontent.com/47447167/278849597-280f2e80-f2d7-4dd9-9662-b8f488fd5ff2.png)](https://user-images.githubusercontent.com/47447167/278849597-280f2e80-f2d7-4dd9-9662-b8f488fd5ff2.png)

This is the POC docker I've set up. It contains Nginx, Traefik proxies and a backend server running PHP.

<https://drive.google.com/file/d/1vLnA0g7N7ZKhLNmHmuJ4JJjV_J2akNMt/view?usp=sharing>

### Impact

This allows the attacker to completely bypass the Access Restriction from Front-End proxy.

### Severity

Low

### CVE ID

CVE-2023-47106

### Weaknesses

[CWE-177](/advisories?query=cwe%3A177)
```
**Root cause of vulnerability**: Traefik incorrectly processes URL fragments by encoding them and forwarding them to the backend, which violates RFC 7230.

**Weaknesses/vulnerabilities present**:
- Improper handling of URL fragments.
- Inconsistent behavior between frontend proxies (like Nginx) and backend servers regarding URL fragments.

**Impact of exploitation**: Bypassing frontend proxy access restrictions, potentially leading to unauthorized access to backend resources.

**Attack vectors**:
- Sending a crafted URL containing a fragment to a Traefik instance.
- Chaining Traefik with a frontend proxy like Nginx where the frontend proxy has URI-based access controls.

**Required attacker capabilities/position**:
- Ability to send HTTP requests to a Traefik instance.
- Knowledge of the backend infrastructure and the presence of a chained frontend proxy enforcing access controls.
```

## Content from github.com_a86f5565_20250115_192645.html

```text
**Bug fixes:**

*   **[acme]** Remove backoff for http challenge ([CVE-2023-47124](https://github.com/advisories/GHSA-8g85-whqh-cr2f "CVE-2023-47124")) ([#10224](https://github.com/traefik/traefik/pull/10224) by [youkoulayley](https://github.com/youkoulayley))
*   **[consul,consulcatalog]** Update github.com/hashicorp/consul/api ([#10220](https://github.com/traefik/traefik/pull/10220) by [kevinpollet](https://github.com/kevinpollet))
*   **[http3]** Update quic-go to v0.39.1 ([#10171](https://github.com/traefik/traefik/pull/10171) by [tomMoulard](https://github.com/tomMoulard))
*   **[middleware]** Fix stripPrefix middleware is not applied to retried attempts ([#10255](https://github.com/traefik/traefik/pull/10255) by [niki-timofe](https://github.com/niki-timofe))
*   **[provider]** Refuse recursive requests ([CVE-2023-47633](https://github.com/advisories/GHSA-6fwg-jrfw-ff7p "CVE-2023-47633")) ([#10242](https://github.com/traefik/traefik/pull/10242) by [rtribotte](https://github.com/rtribotte))
*   **[server]** Deny request with fragment in URL path ([CVE-2023-47106](https://github.com/advisories/GHSA-fvhj-4qfh-q2hm "CVE-2023-47106")) ([#10229](https://github.com/traefik/traefik/pull/10229) by [lbenguigui](https://github.com/lbenguigui))
*   **[tracing]** Remove deprecated code usage for datadog tracer ([#10196](https://github.com/traefik/traefik/pull/10196) by [mmatur](https://github.com/mmatur))
```
This content confirms that the fix for CVE-2023-47106 was included in Traefik v2.10.6.
It also reiterates the incorrect handling of the URL fragment issue described in other sources.
The commit history in the document also confirms that the fix for CVE-2023-47106 was done in pull request #10229.
```
**Root cause of vulnerability**: Traefik incorrectly processes URL fragments.

**Weaknesses/vulnerabilities present**:
- Improper handling of URL fragments, specifically with encoding and forwarding them to the backend.

**Impact of exploitation**: The vulnerability allows bypassing access restrictions when chained with other proxies.

**Attack vectors**: Sending specially crafted URL with fragment to traefik proxy.

**Required attacker capabilities/position**:
- Ability to send HTTP requests to a Traefik instance.
- Knowledge of the backend infrastructure and the presence of a chained frontend proxy enforcing access controls.
```
## Content from github.com_058ec53b_20250115_192646.html
```text
### What does this PR do?

This PR rejects requests that include a fragment in the URL path by returning a 400.

### Motivation

When go receives an HTTP request, it assumes the absence of fragment URL.

However, it is still possible to send a fragment in the request.

In this case, Traefik will encode the '#' character, altering the request's intended meaning.
```
This content describes the fix implemented for CVE-2023-47106
It explains that the fix involves rejecting requests with fragments by returning a 400 error code.

**Root cause of vulnerability**: Traefik's incorrect handling of URL fragments where it would encode the '#' character leading to a different interpretation of the URL than intended

**Weaknesses/vulnerabilities present**:
- Incorrect handling of URL fragments, where they are encoded instead of being discarded, leading to potential bypass.

**Impact of exploitation**: Allows bypassing of front-end proxy URL based access control restrictions.

**Attack vectors**: Sending a crafted HTTP request with fragment in the URL path.

**Required attacker capabilities/position**:
- Ability to send HTTP requests to a Traefik instance.
- Knowledge of the backend infrastructure and the presence of a chained frontend proxy enforcing access controls.
```
## Content from github.com_fc112ba7_20250115_192642.html
```text
*   **[server]** Deny request with fragment in URL path ([CVE-2023-47106](https://github.com/advisories/GHSA-fvhj-4qfh-q2hm "CVE-2023-47106")) ([#10229](https://github.com/traefik/traefik/pull/10229) by [lbenguigui](https://github.com/lbenguigui))
```
This content confirms that the fix for CVE-2023-47106 is present in the mentioned traefik release.
**Root cause of vulnerability**: Traefik's incorrect handling of URL fragments.

**Weaknesses/vulnerabilities present**: Improper handling of URL fragments.

**Impact of exploitation**: Allows bypassing of front-end proxy URL based access control restrictions.

**Attack vectors**: Sending a crafted HTTP request with fragment in the URL path.

**Required attacker capabilities/position**:
- Ability to send HTTP requests to a Traefik instance.
- Knowledge of the backend infrastructure and the presence of a chained frontend proxy enforcing access controls.
```
## Content from github.com_85bb903b_20250115_192648.html
```text
### Summary

When a request is sent to Traefik with a URL fragment, Traefik automatically URL encodes and forwards the fragment to the backend server. This violates the RFC because in the origin-form the URL should only contain the absolute path and the query.

When this is combined with another frontend proxy like Nginx, it can be used to bypass frontend proxy URI-based access control

restrictions.

### Details

For example, we have this Nginx configuration:

```
location /admin {
     deny all;
     return 403;
}

```

This can be bypassed when the attacker is requesting to /#/../admin

This won’t be vulnerable if the backend server follows the RFC and ignores any characters after the fragment.

However, if Nginx is chained with another reverse proxy which automatically URL encode the character # (Traefik) the URL will become

/%23/../admin

And allow the attacker to completely bypass the Access Restriction from the Nginx Front-End proxy.

Here is a diagram to summarize the attack:

[![image](https://user-images.githubusercontent.com/47447167/278849578-34ca0546-99b4-44c8-8fc8-8e799c1f5069.png)](https://user-images.githubusercontent.com/47447167/278849578-34ca0546-99b4-44c8-8fc8-8e799c1f5069.png)

### Impact

This allows the attacker to completely bypass the Access Restriction from Front-End proxy.

### References

* [GHSA-fvhj-4qfh-q2hm](https://github.com/traefik/traefik/security/advisories/GHSA-fvhj-4qfh-q2hm "GHSA-fvhj-4qfh-q2hm")
* <https://nvd.nist.gov/vuln/detail/CVE-2023-47106>
* <https://datatracker.ietf.org/doc/html/rfc7230#section-5.3.1>
* <https://github.com/traefik/traefik/releases/tag/v2.10.6>
* <https://github.com/traefik/traefik/releases/tag/v3.0.0-beta5>
```
This content provides the most useful details.

**Root cause of vulnerability**: Traefik incorrectly processes URL fragments in HTTP requests by URL encoding them and forwarding them to the backend server. This violates RFC 7230 which states that the URL in origin-form should only contain absolute path and query components.

**Weaknesses/vulnerabilities present**:
- Improper handling of URL fragments: Instead of stripping or ignoring the fragment, Traefik URL encodes it, thus altering the request's meaning.
- Chained proxy vulnerability: When used in conjunction with a frontend proxy (like Nginx) that relies on URI-based access controls, this behavior allows bypassing of the controls when a URL fragment is present.

**Impact of exploitation**: Complete bypass of access restrictions implemented by front-end proxies. Allows an attacker to access resources that should be protected by the front-end proxy.

**Attack vectors**:
- Crafted URL: Attacker sends a request with a specially crafted URL containing a fragment (e.g., `/path/#/../admin`).
- Chained Proxy Exploitation: Exploiting a setup where Traefik is behind a frontend proxy like Nginx that is responsible for enforcing access controls.

**Required attacker capabilities/position**:
- Ability to send crafted HTTP requests to the Traefik instance.
- Knowledge of the infrastructure, specifically the use of a frontend proxy for access controls.
```

## Content from github.com_e8b1b2e2_20250115_192651.html
```text
### What does this PR do?

This PR introduces an internal middleware that is automatically appended to the default rule's routers, to stop request recursion on Traefik.
```
This content is related to another CVE and is therefore, `UNRELATED`

## Content from github.com_dba769c8_20250115_192637.html
This content is not related to the CVE, and therefore is `UNRELATED`

## Content from github.com_86065a3c_20250115_192649.html
This content is not related to the CVE, and therefore is `UNRELATED`

## Content from datatracker.ietf.org_81b8fb51_20250115_192640.html
This content is an RFC document and does not describe specific vulnerabilities, and therefore is `UNRELATED`

## Content from avatars.githubusercontent.com_88309453_20250115_192645.html
This content is an avatar image and does not contain any useful vulnerability information, therefore is `NOINFO`

## Content from avatars.githubusercontent.com_4392f3b4_20250115_192652.html
This content is an avatar image and does not contain any useful vulnerability information, therefore is `NOINFO`

## Content from github.com_1046d818_20250115_192635.html
This content is a profile page and does not contain any useful vulnerability information, therefore is `NOINFO`

## Content from github.com_a1b59367_20250115_192636.html
This content is a features page and does not contain any useful vulnerability information, therefore is `NOINFO`

## Content from github.com_863aebf1_20250115_192652.html
This content is a profile page and does not contain any useful vulnerability information, therefore is `NOINFO`