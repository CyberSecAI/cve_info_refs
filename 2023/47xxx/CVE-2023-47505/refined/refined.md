Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the `get_inline_svg` function in the Elementor plugin not properly sanitizing or validating the content of SVG files. It fetches the file content and directly returns the raw string without checks, leading to the possibility of injecting malicious code.
* The `import` function which is used to upload files does have a check for SVG files, but allows other image files such as png or jpeg to be uploaded. An attacker can then embed XSS payloads within the metadata of the uploaded image.

**Weaknesses/Vulnerabilities:**

*   **Cross-Site Scripting (XSS):** The primary vulnerability is a reflected XSS, which allows attackers to inject arbitrary JavaScript code. This occurs because the raw file content is directly outputted in the HTML context in the `render_accordion_icons` function.
*   **Inadequate Input Sanitization:** The `get_inline_svg` function lacks proper sanitization, allowing arbitrary code to be included in the file content.
*   **Unrestricted File Upload:** The plugin allows Contributor role users to upload files (including those with malicious metadata) through the Template import feature, which bypasses the usual upload restrictions for lower-privileged users. The `import` function has an SVG file check, but it fails to prevent XSS if the attacker uploads a different file with embedded metadata that contains malicious code.
*   **Insufficient Privilege Check:** The vulnerability can be exploited by users with the Contributor role, which has limited permissions by default. This is achieved by utilizing the draft template feature.

**Impact of Exploitation:**

*   **Malicious Script Injection:** Attackers can inject malicious scripts into the website.
*   **Information Theft:** Attackers could potentially steal sensitive information via the injected scripts.
*   **Privilege Escalation:** In some cases, XSS can be leveraged to escalate privileges within the WordPress site.
*   **Website Manipulation:** Malicious scripts could be used to redirect users, display unwanted content (advertisements), or manipulate the website's appearance.

**Attack Vectors:**

*   **Uploaded SVG files:** Although SVG files should not be uploaded without the `unfiltered_upload` permission, the vulnerability can still be triggered by uploading other file types (such as PNG or JPEG files) with a malicious XSS payload embedded in the file metadata.
*   **Elementor Template Import:** A contributor role user can use the "Draft Template" feature to import a template that contains a malicious attachment.
*   **Accordion/Tabs widget:** The vulnerability is triggered by embedding the uploaded attachment as the SVG icon in an elementor widget (e.g., Accordion or Tabs).

**Required Attacker Capabilities/Position:**

*   **WordPress Account:** Attackers need a WordPress account with at least the Contributor role.
*   **Elementor Plugin:** The target website must have the vulnerable Elementor plugin installed (versions <= 3.16.4).
*   **File Upload Capability:** Attackers leverage the "Draft Template" import feature to upload the malicious files, thus bypassing the typical restrictions on the contributor role.

**Additional Notes:**
* The vulnerability is assigned both CVE-2023-47504 and CVE-2023-47505, with the XSS vulnerability specifically related to CVE-2023-47505.
* Patchstack issued a virtual patch to mitigate the vulnerability until users update to the fixed version.
* The vulnerability is classified as low priority but has a CVSS score of 6.5.
* The fix implemented a custom SVG sanitizer.