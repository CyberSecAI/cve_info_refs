Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2023-47115

**Root Cause:**
The root cause is the lack of server-side validation of the file extension of uploaded avatar images in Label Studio, combined with the use of Django's `serve` view for serving these files. This view determines the `Content-Type` of the response based on the file extension in the URL path.

**Weaknesses/Vulnerabilities:**
- **Insufficient server-side file extension validation:** The application only validates the file type (MIME type) and image dimensions but does not validate the file extension server-side. Client-side validation is easily bypassed.
- **Insecure file serving:** The application uses Django's built-in `serve` view for serving media files, which is not recommended for production use. This view relies on the file extension in the URL to determine the `Content-Type`.
- **Lack of sanitization of user-controlled input:** HTML code injected into the image metadata is not sanitized, allowing for the injection of arbitrary JavaScript when the image is served with a `.html` extension.

**Impact of Exploitation:**
- **Cross-Site Scripting (XSS):** An attacker can upload a crafted image containing malicious HTML code, rename it with an `.html` extension using a proxy during the upload process, and then trick other users into accessing this crafted avatar URL. This would allow the attacker to execute arbitrary JavaScript code within the context of the Label Studio website in the victim's browser.
- **Potential for malicious actions:** An attacker could perform actions on behalf of a victim, such as adding new users with administrative privileges.

**Attack Vectors:**
- **Network:** The attack occurs over the network through the web application.
- **User interaction:** The user needs to visit the URL of the crafted avatar image to trigger the XSS.

**Required Attacker Capabilities/Position:**
- **Authenticated user:** The attacker needs to be an authenticated user of the Label Studio platform to upload an avatar.
- **Ability to intercept and modify requests:** The attacker needs to be able to intercept the avatar upload request using a tool like Burp Suite to modify the filename to have a `.html` extension.
- **Social engineering (indirect):** To exploit other users, the attacker needs to trick them into visiting the crafted avatar URL.

**Additional Information from the provided files:**
- The vulnerable code is located in `label_studio/users/functions.py` in versions prior to 1.9.2.
- The file serving logic is in `label_studio/users/urls.py`, using Django's `serve` view.
- The fix involved using `sanitize-html` to prevent rendering of potentially malicious HTML in multiple locations.

This information is more detailed than the basic CVE description, providing insights into the specific code locations and attack steps.