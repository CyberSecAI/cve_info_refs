=== Content from boltonshield.com_c0252a41_20250114_221404.html ===

[Skip to content](#content)

[![](data:image/svg+xml...)](/)

* [About Us](https://boltonshield.com/en/company/)
  #### [Company](https://boltonshield.com/en/company/)

  ### [About Us](https://boltonshield.com/en/company/about-us/)

  ### [Events](https://boltonshield.com/en/company/events/)

  ### [References](https://boltonshield.com/en/company/references/)

  ### [Cybersecurity Certifications](https://boltonshield.com/en/company/cybersecurity-certifications/)
* [Solutions](https://boltonshield.com/en/?page_id=345)
  ### [Boltonshield Platform](https://boltonshield.com/en/platform/)

  ### [Penetration Testing](https://boltonshield.com/en/penetration-testing/)

  ### [Red Teaming](https://boltonshield.com/en/red-teaming/)

  ### [Vulnerability Assessment](https://boltonshield.com/en/vulnerability-assessment/)

  ### [Internal Infrastructure Testing](https://boltonshield.com/en/internal-infrastructure-testing/)

  ### [External Infrastructure Testing](https://boltonshield.com/en/external-infrastructure-testing/)

  ### [Security Operations Center](https://boltonshield.com/en/security-operations-center/)

  ### [Managed Security Services](https://boltonshield.com/en/managed-security-services/)

  ### [Incident Response](https://boltonshield.com/en/incident-response/)

  ### [Governance, Risk, and Compliance](https://boltonshield.com/en/governance-risk-and-compliance/)
* [Resources](https://boltonshield.com/en/resources/)
  #### Resources

  + [Blog](/en/category/news-articles/)
  + [Case Studies](/en/category/case-studies/)
  + [Whitepapers](/en/whitepaper/)
* [English](https://boltonshield.com/en/cve/cve-2023-47315/)

[![](data:image/svg+xml...)](/)

* Company
  + [About Us](https://boltonshield.com/en/company/about-us/)
  + [Events](https://boltonshield.com/en/company/events/)
  + [References](https://boltonshield.com/en/company/references/)
  + [Cybersecurity Certifications](https://boltonshield.com/en/company/cybersecurity-certifications/)
* Solutions
  + [Boltonshield Platform](https://boltonshield.com/en/platform/)
  + [Penetration Testing](https://boltonshield.com/en/penetration-testing/)
  + [Red Teaming](https://boltonshield.com/en/red-teaming3/)
  + [Vulnerability Assessment](https://boltonshield.com/en/vulnerability-assessment/)
  + [External Infrastructure Testing](https://boltonshield.com/en/external-infrastructure-testing/)
  + [Internal Infrastructure Testing](https://boltonshield.com/en/internal-infrastructure-testing/)
  + Defensive Cybersecurity
    - [Security Operations Center](https://boltonshield.com/en/cybersecurity-services/defensive-services/security-operations-center/)
    - [Incident Response](https://boltonshield.com/en/incident-response/)
    - [Managed Security Services](https://boltonshield.com/en/cybersecurity-services/defensive-services/managed-security-services/)
* Resources
  + [Blog](/en/category/news-articles)
  + [Case Studies](https://boltonshield.com/category/case-studies/)
  + [Whitepapers](https://boltonshield.com/en/whitepapers/)
* [English](https://boltonshield.com/en/cve/cve-2023-47315/)

* Company
  + [About Us](https://boltonshield.com/en/company/about-us/)
  + [Events](https://boltonshield.com/en/company/events/)
  + [References](https://boltonshield.com/en/company/references/)
  + [Cybersecurity Certifications](https://boltonshield.com/en/company/cybersecurity-certifications/)
* Solutions
  + [Boltonshield Platform](https://boltonshield.com/en/platform/)
  + [Penetration Testing](https://boltonshield.com/en/penetration-testing/)
  + [Red Teaming](https://boltonshield.com/en/red-teaming3/)
  + [Vulnerability Assessment](https://boltonshield.com/en/vulnerability-assessment/)
  + [External Infrastructure Testing](https://boltonshield.com/en/external-infrastructure-testing/)
  + [Internal Infrastructure Testing](https://boltonshield.com/en/internal-infrastructure-testing/)
  + Defensive Cybersecurity
    - [Security Operations Center](https://boltonshield.com/en/cybersecurity-services/defensive-services/security-operations-center/)
    - [Incident Response](https://boltonshield.com/en/incident-response/)
    - [Managed Security Services](https://boltonshield.com/en/cybersecurity-services/defensive-services/managed-security-services/)
* Resources
  + [Blog](/en/category/news-articles)
  + [Case Studies](https://boltonshield.com/category/case-studies/)
  + [Whitepapers](https://boltonshield.com/en/whitepapers/)
* [English](https://boltonshield.com/en/cve/cve-2023-47315/)

## CVE-2023-47315 – Headwind MDM Web panel 5.22.1 – Hardcoded JWT Secret

Published CVE numbers:

* <https://www.cve.org/CVERecord?id=CVE-2023-47315>
* <https://nvd.nist.gov/vuln/detail/CVE-2023-47315>

Headwind MDM Web panel 5.22.1 is vulnerable to Incorrect Access Control due to a hard-coded JWT Secret.

The secret is hardcoded into the source code available to anyone on Git Hub. This secret is used to sign the application’s JWT token and verify the incoming user-supplied tokens.

![Hardcoded JWT secret](https://boltonshield.com/wp-content/uploads/2023/11/xhardcoded_jwt_credential.png.pagespeed.ic.LRQk7P7Xci.webp)

Hardcoded JWT secret

Affected URL to the source code:

* <https://github.com/h-mdm/hmdm-server/blob/master/jwt/src/main/java/com/hmdm/security/jwt/TokenProvider.java>

By exploiting this issue, attackers may craft their own JWT tokens on behalf of arbitrary users.

JWT token structure:

```
 {
   "sub": "<username>",
   "token": "<authToken>",
   "exp": <when_expired_in_unix_timestamp>
 }
```
### Exploitation’s steps

Authentication: Required (A low-level user access is enough to obtain the authToken of the targeted user)

* Getting a sample JWT token by calling the API endpoint of the target web panel instance `/rest/public/jwt/login` (POST).
* Modifying the JWT token by setting the *sub* parameter to *admin* and the parameter *token* to the current *authToken* of the admin user, then signing the JWT token with the hardcoded secret. Important note: due to an authorization issue affecting the web panel (CVE-2023-47316), the *authToken* of other users can also be retrieved even by a low-level user by calling the `/rest/private/users/all` (GET) API endpoint.

![Crafting a new JWT token](https://boltonshield.com/wp-content/uploads/2023/11/xmodified_jwt_token.png.pagespeed.ic.w3jxAJ4FqO.webp)

Crafting a new JWT token

* Putting the crafted JWT token into the Authorization header of the HTTP request targeting the victim’s H-MDM web panel:

![Using the crafted JWT token](https://boltonshield.com/wp-content/uploads/2023/11/xaccess_with_the_crafted_jwt_token.png.pagespeed.ic.dz4cIXM5yt.webp)

Using the crafted JWT token

​

## Would you like to learn more about our platform?

Book your demo with us!

![](data:image/svg+xml...)

Company

* [About Us](https://boltonshield.com/company/about-us/)
* [Events](https://boltonshield.com/company/events/)
* [References](https://boltonshield.com/company/references/)
* [Cybersecurity Certifications](https://boltonshield.com/company/cybersecurity-certifications/)

Solutions

* [Boltonshield Platform](https://boltonshield.com/platform/)
* [Penetration Testing](https://boltonshield.com/penetration-testing/)
* [Red Teaming](https://boltonshield.com/red-teaming/)
* [Vulnerability Assessment](https://boltonshield.com/vulnerability-assessment/)
* [Internal Infrastructure Testing](https://boltonshield.com/internal-infrastructure-testing/)
* [External Infrastructure Testing](https://boltonshield.com/external-infrastructure-testing/)

Solutions by Industry

* [Payment Service Providers](https://boltonshield.com/psp/)
* [Forex Companies (CIF’s)](https://boltonshield.com/forex/)
* [FinTech](https://boltonshield.com/fintech/)
* [Crypto Exchanges](https://boltonshield.com/crypto-exchanges/)
* [Finance](https://boltonshield.com/cybersecurity-solutions/solutions-by-industry/finance/)
* [Telecommunications](https://boltonshield.com/cybersecurity-solutions/solutions-by-industry/telecommunications/)
* [Software Development](https://boltonshield.com/cybersecurity-solutions/solutions-by-industry/software-development/)
* [Manufacturing](http://Manufacturing)
* [E-commerce](https://boltonshield.com/cybersecurity-solutions/solutions-by-industry/e-commerce/)

[Resources](https://boltonshield.com/resources/)

Contact us

[Privacy Policy](https://boltonshield.com/en/privacy-policy/)

* info@boltonshield.com
* [Linkedin](https://www.linkedin.com/company/boltonshield)
* [Boltonshield AG — Minervastrasse 3, 8032 Zurich, Switzerland](https://goo.gl/maps/ixZAH9j4k9rpCzPCA)

![](data:image/svg+xml...)

![](data:image/svg+xml...)

![](data:image/svg+xml...)

© copyright 2024 Boltonshield

## [This website uses cookies to ensure you get the best experience on our website.](/en/privacy-policy/)

[I agree](#elementor-action%3Aaction%3Dpopup%3Aclose%26settings%3DeyJkb19ub3Rfc2hvd19hZ2FpbiI6IiJ9)


